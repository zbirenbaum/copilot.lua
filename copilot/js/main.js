"use strict";var CTt=Object.create;var _4=Object.defineProperty;var UDe=Object.getOwnPropertyDescriptor;var vTt=Object.getOwnPropertyNames;var xTt=Object.getPrototypeOf,ETt=Object.prototype.hasOwnProperty;var ODe=(t,e)=>(e=Symbol[t])?e:Symbol.for("Symbol."+t),QDe=t=>{throw TypeError(t)};var s=(t,e)=>_4(t,"name",{value:e,configurable:!0});var Fm=(t,e)=>()=>(t&&(e=t(t=0)),e);var H=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),Ia=(t,e)=>{for(var r in e)_4(t,r,{get:e[r],enumerable:!0})},qDe=(t,e,r,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of vTt(e))!ETt.call(t,i)&&i!==r&&_4(t,i,{get:()=>e[i],enumerable:!(n=UDe(e,i))||n.enumerable});return t};var Be=(t,e,r)=>(r=t!=null?CTt(xTt(t)):{},qDe(e||!t||!t.__esModule?_4(r,"default",{value:t,enumerable:!0}):r,t)),bTt=t=>qDe(_4({},"__esModule",{value:!0}),t),uf=(t,e,r,n)=>{for(var i=n>1?void 0:n?UDe(e,r):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(n?a(e,r,i):a(i))||i);return n&&i&&_4(e,r,i),i},Ta=(t,e)=>(r,n)=>e(r,n,t);var xfe=(t,e,r)=>{if(e!=null){typeof e!="object"&&typeof e!="function"&&QDe("Object expected");var n,i;r&&(n=e[ODe("asyncDispose")]),n===void 0&&(n=e[ODe("dispose")],r&&(i=n)),typeof n!="function"&&QDe("Object not disposable"),i&&(n=function(){try{i.call(this)}catch(o){return Promise.reject(o)}}),t.push([r,n,e])}else r&&t.push([r]);return e},Efe=(t,e,r)=>{var n=typeof SuppressedError=="function"?SuppressedError:function(a,c,l,u){return u=Error(l),u.name="SuppressedError",u.error=a,u.suppressed=c,u},i=a=>e=r?new n(a,e,"An error was suppressed during disposal"):(r=!0,a),o=a=>{for(;a=t.pop();)try{var c=a[1]&&a[1].call(a[2]);if(a[0])return Promise.resolve(c).then(o,l=>(i(l),o()))}catch(l){i(l)}if(r)throw e};return o()};var importMetaUrlShim,d=Fm(()=>{"use strict";importMetaUrlShim=typeof document>"u"?require("node:url").pathToFileURL(__filename).href:importMetaUrlShim});var $De=H(bfe=>{d();var HDe="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split("");bfe.encode=function(t){if(0<=t&&t<HDe.length)return HDe[t];throw new TypeError("Must be between 0 and 63: "+t)};bfe.decode=function(t){var e=65,r=90,n=97,i=122,o=48,a=57,c=43,l=47,u=26,f=52;return e<=t&&t<=r?t-e:n<=t&&t<=i?t-n+u:o<=t&&t<=a?t-o+f:t==c?62:t==l?63:-1}});var wfe=H(Tfe=>{d();var WDe=$De(),Ife=5,jDe=1<<Ife,GDe=jDe-1,VDe=jDe;function ITt(t){return t<0?(-t<<1)+1:(t<<1)+0}s(ITt,"toVLQSigned");function TTt(t){var e=(t&1)===1,r=t>>1;return e?-r:r}s(TTt,"fromVLQSigned");Tfe.encode=s(function(e){var r="",n,i=ITt(e);do n=i&GDe,i>>>=Ife,i>0&&(n|=VDe),r+=WDe.encode(n);while(i>0);return r},"base64VLQ_encode");Tfe.decode=s(function(e,r,n){var i=e.length,o=0,a=0,c,l;do{if(r>=i)throw new Error("Expected more digits in base 64 VLQ value.");if(l=WDe.decode(e.charCodeAt(r++)),l===-1)throw new Error("Invalid base64 digit: "+e.charAt(r-1));c=!!(l&VDe),l&=GDe,o=o+(l<<a),a+=Ife}while(c);n.value=TTt(o),n.rest=r},"base64VLQ_decode")});var P4=H(Id=>{d();function wTt(t,e,r){if(e in t)return t[e];if(arguments.length===3)return r;throw new Error('"'+e+'" is a required argument.')}s(wTt,"getArg");Id.getArg=wTt;var zDe=/^(?:([\w+\-.]+):)?\/\/(?:(\w+:\w+)@)?([\w.-]*)(?::(\d+))?(.*)$/,STt=/^data:.+\,.+$/;function PF(t){var e=t.match(zDe);return e?{scheme:e[1],auth:e[2],host:e[3],port:e[4],path:e[5]}:null}s(PF,"urlParse");Id.urlParse=PF;function R4(t){var e="";return t.scheme&&(e+=t.scheme+":"),e+="//",t.auth&&(e+=t.auth+"@"),t.host&&(e+=t.host),t.port&&(e+=":"+t.port),t.path&&(e+=t.path),e}s(R4,"urlGenerate");Id.urlGenerate=R4;function Sfe(t){var e=t,r=PF(t);if(r){if(!r.path)return t;e=r.path}for(var n=Id.isAbsolute(e),i=e.split(/\/+/),o,a=0,c=i.length-1;c>=0;c--)o=i[c],o==="."?i.splice(c,1):o===".."?a++:a>0&&(o===""?(i.splice(c+1,a),a=0):(i.splice(c,2),a--));return e=i.join("/"),e===""&&(e=n?"/":"."),r?(r.path=e,R4(r)):e}s(Sfe,"normalize");Id.normalize=Sfe;function KDe(t,e){t===""&&(t="."),e===""&&(e=".");var r=PF(e),n=PF(t);if(n&&(t=n.path||"/"),r&&!r.scheme)return n&&(r.scheme=n.scheme),R4(r);if(r||e.match(STt))return e;if(n&&!n.host&&!n.path)return n.host=e,R4(n);var i=e.charAt(0)==="/"?e:Sfe(t.replace(/\/+$/,"")+"/"+e);return n?(n.path=i,R4(n)):i}s(KDe,"join");Id.join=KDe;Id.isAbsolute=function(t){return t.charAt(0)==="/"||zDe.test(t)};function _Tt(t,e){t===""&&(t="."),t=t.replace(/\/$/,"");for(var r=0;e.indexOf(t+"/")!==0;){var n=t.lastIndexOf("/");if(n<0||(t=t.slice(0,n),t.match(/^([^\/]+:\/)?\/*$/)))return e;++r}return Array(r+1).join("../")+e.substr(t.length+1)}s(_Tt,"relative");Id.relative=_Tt;var YDe=function(){var t=Object.create(null);return!("__proto__"in t)}();function JDe(t){return t}s(JDe,"identity");function RTt(t){return XDe(t)?"$"+t:t}s(RTt,"toSetString");Id.toSetString=YDe?JDe:RTt;function kTt(t){return XDe(t)?t.slice(1):t}s(kTt,"fromSetString");Id.fromSetString=YDe?JDe:kTt;function XDe(t){if(!t)return!1;var e=t.length;if(e<9||t.charCodeAt(e-1)!==95||t.charCodeAt(e-2)!==95||t.charCodeAt(e-3)!==111||t.charCodeAt(e-4)!==116||t.charCodeAt(e-5)!==111||t.charCodeAt(e-6)!==114||t.charCodeAt(e-7)!==112||t.charCodeAt(e-8)!==95||t.charCodeAt(e-9)!==95)return!1;for(var r=e-10;r>=0;r--)if(t.charCodeAt(r)!==36)return!1;return!0}s(XDe,"isProtoString");function PTt(t,e,r){var n=k4(t.source,e.source);return n!==0||(n=t.originalLine-e.originalLine,n!==0)||(n=t.originalColumn-e.originalColumn,n!==0||r)||(n=t.generatedColumn-e.generatedColumn,n!==0)||(n=t.generatedLine-e.generatedLine,n!==0)?n:k4(t.name,e.name)}s(PTt,"compareByOriginalPositions");Id.compareByOriginalPositions=PTt;function DTt(t,e,r){var n=t.generatedLine-e.generatedLine;return n!==0||(n=t.generatedColumn-e.generatedColumn,n!==0||r)||(n=k4(t.source,e.source),n!==0)||(n=t.originalLine-e.originalLine,n!==0)||(n=t.originalColumn-e.originalColumn,n!==0)?n:k4(t.name,e.name)}s(DTt,"compareByGeneratedPositionsDeflated");Id.compareByGeneratedPositionsDeflated=DTt;function k4(t,e){return t===e?0:t===null?1:e===null?-1:t>e?1:-1}s(k4,"strcmp");function BTt(t,e){var r=t.generatedLine-e.generatedLine;return r!==0||(r=t.generatedColumn-e.generatedColumn,r!==0)||(r=k4(t.source,e.source),r!==0)||(r=t.originalLine-e.originalLine,r!==0)||(r=t.originalColumn-e.originalColumn,r!==0)?r:k4(t.name,e.name)}s(BTt,"compareByGeneratedPositionsInflated");Id.compareByGeneratedPositionsInflated=BTt;function NTt(t){return JSON.parse(t.replace(/^\)]}'[^\n]*\n/,""))}s(NTt,"parseSourceMapInput");Id.parseSourceMapInput=NTt;function MTt(t,e,r){if(e=e||"",t&&(t[t.length-1]!=="/"&&e[0]!=="/"&&(t+="/"),e=t+e),r){var n=PF(r);if(!n)throw new Error("sourceMapURL could not be parsed");if(n.path){var i=n.path.lastIndexOf("/");i>=0&&(n.path=n.path.substring(0,i+1))}e=KDe(R4(n),e)}return Sfe(e)}s(MTt,"computeSourceURL");Id.computeSourceURL=MTt});var kfe=H(ZDe=>{d();var _fe=P4(),Rfe=Object.prototype.hasOwnProperty,M_=typeof Map<"u";function kv(){this._array=[],this._set=M_?new Map:Object.create(null)}s(kv,"ArraySet");kv.fromArray=s(function(e,r){for(var n=new kv,i=0,o=e.length;i<o;i++)n.add(e[i],r);return n},"ArraySet_fromArray");kv.prototype.size=s(function(){return M_?this._set.size:Object.getOwnPropertyNames(this._set).length},"ArraySet_size");kv.prototype.add=s(function(e,r){var n=M_?e:_fe.toSetString(e),i=M_?this.has(e):Rfe.call(this._set,n),o=this._array.length;(!i||r)&&this._array.push(e),i||(M_?this._set.set(e,o):this._set[n]=o)},"ArraySet_add");kv.prototype.has=s(function(e){if(M_)return this._set.has(e);var r=_fe.toSetString(e);return Rfe.call(this._set,r)},"ArraySet_has");kv.prototype.indexOf=s(function(e){if(M_){var r=this._set.get(e);if(r>=0)return r}else{var n=_fe.toSetString(e);if(Rfe.call(this._set,n))return this._set[n]}throw new Error('"'+e+'" is not in the set.')},"ArraySet_indexOf");kv.prototype.at=s(function(e){if(e>=0&&e<this._array.length)return this._array[e];throw new Error("No element indexed by "+e)},"ArraySet_at");kv.prototype.toArray=s(function(){return this._array.slice()},"ArraySet_toArray");ZDe.ArraySet=kv});var rBe=H(tBe=>{d();var eBe=P4();function LTt(t,e){var r=t.generatedLine,n=e.generatedLine,i=t.generatedColumn,o=e.generatedColumn;return n>r||n==r&&o>=i||eBe.compareByGeneratedPositionsInflated(t,e)<=0}s(LTt,"generatedPositionAfter");function PW(){this._array=[],this._sorted=!0,this._last={generatedLine:-1,generatedColumn:0}}s(PW,"MappingList");PW.prototype.unsortedForEach=s(function(e,r){this._array.forEach(e,r)},"MappingList_forEach");PW.prototype.add=s(function(e){LTt(this._last,e)?(this._last=e,this._array.push(e)):(this._sorted=!1,this._array.push(e))},"MappingList_add");PW.prototype.toArray=s(function(){return this._sorted||(this._array.sort(eBe.compareByGeneratedPositionsInflated),this._sorted=!0),this._array},"MappingList_toArray");tBe.MappingList=PW});var Pfe=H(nBe=>{d();var DF=wfe(),Jc=P4(),DW=kfe().ArraySet,FTt=rBe().MappingList;function Om(t){t||(t={}),this._file=Jc.getArg(t,"file",null),this._sourceRoot=Jc.getArg(t,"sourceRoot",null),this._skipValidation=Jc.getArg(t,"skipValidation",!1),this._sources=new DW,this._names=new DW,this._mappings=new FTt,this._sourcesContents=null}s(Om,"SourceMapGenerator");Om.prototype._version=3;Om.fromSourceMap=s(function(e){var r=e.sourceRoot,n=new Om({file:e.file,sourceRoot:r});return e.eachMapping(function(i){var o={generated:{line:i.generatedLine,column:i.generatedColumn}};i.source!=null&&(o.source=i.source,r!=null&&(o.source=Jc.relative(r,o.source)),o.original={line:i.originalLine,column:i.originalColumn},i.name!=null&&(o.name=i.name)),n.addMapping(o)}),e.sources.forEach(function(i){var o=i;r!==null&&(o=Jc.relative(r,i)),n._sources.has(o)||n._sources.add(o);var a=e.sourceContentFor(i);a!=null&&n.setSourceContent(i,a)}),n},"SourceMapGenerator_fromSourceMap");Om.prototype.addMapping=s(function(e){var r=Jc.getArg(e,"generated"),n=Jc.getArg(e,"original",null),i=Jc.getArg(e,"source",null),o=Jc.getArg(e,"name",null);this._skipValidation||this._validateMapping(r,n,i,o),i!=null&&(i=String(i),this._sources.has(i)||this._sources.add(i)),o!=null&&(o=String(o),this._names.has(o)||this._names.add(o)),this._mappings.add({generatedLine:r.line,generatedColumn:r.column,originalLine:n!=null&&n.line,originalColumn:n!=null&&n.column,source:i,name:o})},"SourceMapGenerator_addMapping");Om.prototype.setSourceContent=s(function(e,r){var n=e;this._sourceRoot!=null&&(n=Jc.relative(this._sourceRoot,n)),r!=null?(this._sourcesContents||(this._sourcesContents=Object.create(null)),this._sourcesContents[Jc.toSetString(n)]=r):this._sourcesContents&&(delete this._sourcesContents[Jc.toSetString(n)],Object.keys(this._sourcesContents).length===0&&(this._sourcesContents=null))},"SourceMapGenerator_setSourceContent");Om.prototype.applySourceMap=s(function(e,r,n){var i=r;if(r==null){if(e.file==null)throw new Error(`SourceMapGenerator.prototype.applySourceMap requires either an explicit source file, or the source map's "file" property. Both were omitted.`);i=e.file}var o=this._sourceRoot;o!=null&&(i=Jc.relative(o,i));var a=new DW,c=new DW;this._mappings.unsortedForEach(function(l){if(l.source===i&&l.originalLine!=null){var u=e.originalPositionFor({line:l.originalLine,column:l.originalColumn});u.source!=null&&(l.source=u.source,n!=null&&(l.source=Jc.join(n,l.source)),o!=null&&(l.source=Jc.relative(o,l.source)),l.originalLine=u.line,l.originalColumn=u.column,u.name!=null&&(l.name=u.name))}var f=l.source;f!=null&&!a.has(f)&&a.add(f);var p=l.name;p!=null&&!c.has(p)&&c.add(p)},this),this._sources=a,this._names=c,e.sources.forEach(function(l){var u=e.sourceContentFor(l);u!=null&&(n!=null&&(l=Jc.join(n,l)),o!=null&&(l=Jc.relative(o,l)),this.setSourceContent(l,u))},this)},"SourceMapGenerator_applySourceMap");Om.prototype._validateMapping=s(function(e,r,n,i){if(r&&typeof r.line!="number"&&typeof r.column!="number")throw new Error("original.line and original.column are not numbers -- you probably meant to omit the original mapping entirely and only map the generated position. If so, pass null for the original mapping instead of an object with empty or null values.");if(!(e&&"line"in e&&"column"in e&&e.line>0&&e.column>=0&&!r&&!n&&!i)){if(e&&"line"in e&&"column"in e&&r&&"line"in r&&"column"in r&&e.line>0&&e.column>=0&&r.line>0&&r.column>=0&&n)return;throw new Error("Invalid mapping: "+JSON.stringify({generated:e,source:n,original:r,name:i}))}},"SourceMapGenerator_validateMapping");Om.prototype._serializeMappings=s(function(){for(var e=0,r=1,n=0,i=0,o=0,a=0,c="",l,u,f,p,m=this._mappings.toArray(),h=0,g=m.length;h<g;h++){if(u=m[h],l="",u.generatedLine!==r)for(e=0;u.generatedLine!==r;)l+=";",r++;else if(h>0){if(!Jc.compareByGeneratedPositionsInflated(u,m[h-1]))continue;l+=","}l+=DF.encode(u.generatedColumn-e),e=u.generatedColumn,u.source!=null&&(p=this._sources.indexOf(u.source),l+=DF.encode(p-a),a=p,l+=DF.encode(u.originalLine-1-i),i=u.originalLine-1,l+=DF.encode(u.originalColumn-n),n=u.originalColumn,u.name!=null&&(f=this._names.indexOf(u.name),l+=DF.encode(f-o),o=f)),c+=l}return c},"SourceMapGenerator_serializeMappings");Om.prototype._generateSourcesContent=s(function(e,r){return e.map(function(n){if(!this._sourcesContents)return null;r!=null&&(n=Jc.relative(r,n));var i=Jc.toSetString(n);return Object.prototype.hasOwnProperty.call(this._sourcesContents,i)?this._sourcesContents[i]:null},this)},"SourceMapGenerator_generateSourcesContent");Om.prototype.toJSON=s(function(){var e={version:this._version,sources:this._sources.toArray(),names:this._names.toArray(),mappings:this._serializeMappings()};return this._file!=null&&(e.file=this._file),this._sourceRoot!=null&&(e.sourceRoot=this._sourceRoot),this._sourcesContents&&(e.sourcesContent=this._generateSourcesContent(e.sources,e.sourceRoot)),e},"SourceMapGenerator_toJSON");Om.prototype.toString=s(function(){return JSON.stringify(this.toJSON())},"SourceMapGenerator_toString");nBe.SourceMapGenerator=Om});var iBe=H(L_=>{d();L_.GREATEST_LOWER_BOUND=1;L_.LEAST_UPPER_BOUND=2;function Dfe(t,e,r,n,i,o){var a=Math.floor((e-t)/2)+t,c=i(r,n[a],!0);return c===0?a:c>0?e-a>1?Dfe(a,e,r,n,i,o):o==L_.LEAST_UPPER_BOUND?e<n.length?e:-1:a:a-t>1?Dfe(t,a,r,n,i,o):o==L_.LEAST_UPPER_BOUND?a:t<0?-1:t}s(Dfe,"recursiveSearch");L_.search=s(function(e,r,n,i){if(r.length===0)return-1;var o=Dfe(-1,r.length,e,r,n,i||L_.GREATEST_LOWER_BOUND);if(o<0)return-1;for(;o-1>=0&&n(r[o],r[o-1],!0)===0;)--o;return o},"search")});var sBe=H(oBe=>{d();function Bfe(t,e,r){var n=t[e];t[e]=t[r],t[r]=n}s(Bfe,"swap");function OTt(t,e){return Math.round(t+Math.random()*(e-t))}s(OTt,"randomIntInRange");function Nfe(t,e,r,n){if(r<n){var i=OTt(r,n),o=r-1;Bfe(t,i,n);for(var a=t[n],c=r;c<n;c++)e(t[c],a)<=0&&(o+=1,Bfe(t,o,c));Bfe(t,o+1,c);var l=o+1;Nfe(t,e,r,l-1),Nfe(t,e,l+1,n)}}s(Nfe,"doQuickSort");oBe.quickSort=function(t,e){Nfe(t,e,0,t.length-1)}});var cBe=H(BW=>{d();var qr=P4(),Mfe=iBe(),D4=kfe().ArraySet,QTt=wfe(),BF=sBe().quickSort;function Ys(t,e){var r=t;return typeof t=="string"&&(r=qr.parseSourceMapInput(t)),r.sections!=null?new zg(r,e):new Fu(r,e)}s(Ys,"SourceMapConsumer");Ys.fromSourceMap=function(t,e){return Fu.fromSourceMap(t,e)};Ys.prototype._version=3;Ys.prototype.__generatedMappings=null;Object.defineProperty(Ys.prototype,"_generatedMappings",{configurable:!0,enumerable:!0,get:s(function(){return this.__generatedMappings||this._parseMappings(this._mappings,this.sourceRoot),this.__generatedMappings},"get")});Ys.prototype.__originalMappings=null;Object.defineProperty(Ys.prototype,"_originalMappings",{configurable:!0,enumerable:!0,get:s(function(){return this.__originalMappings||this._parseMappings(this._mappings,this.sourceRoot),this.__originalMappings},"get")});Ys.prototype._charIsMappingSeparator=s(function(e,r){var n=e.charAt(r);return n===";"||n===","},"SourceMapConsumer_charIsMappingSeparator");Ys.prototype._parseMappings=s(function(e,r){throw new Error("Subclasses must implement _parseMappings")},"SourceMapConsumer_parseMappings");Ys.GENERATED_ORDER=1;Ys.ORIGINAL_ORDER=2;Ys.GREATEST_LOWER_BOUND=1;Ys.LEAST_UPPER_BOUND=2;Ys.prototype.eachMapping=s(function(e,r,n){var i=r||null,o=n||Ys.GENERATED_ORDER,a;switch(o){case Ys.GENERATED_ORDER:a=this._generatedMappings;break;case Ys.ORIGINAL_ORDER:a=this._originalMappings;break;default:throw new Error("Unknown order of iteration.")}var c=this.sourceRoot;a.map(function(l){var u=l.source===null?null:this._sources.at(l.source);return u=qr.computeSourceURL(c,u,this._sourceMapURL),{source:u,generatedLine:l.generatedLine,generatedColumn:l.generatedColumn,originalLine:l.originalLine,originalColumn:l.originalColumn,name:l.name===null?null:this._names.at(l.name)}},this).forEach(e,i)},"SourceMapConsumer_eachMapping");Ys.prototype.allGeneratedPositionsFor=s(function(e){var r=qr.getArg(e,"line"),n={source:qr.getArg(e,"source"),originalLine:r,originalColumn:qr.getArg(e,"column",0)};if(n.source=this._findSourceIndex(n.source),n.source<0)return[];var i=[],o=this._findMapping(n,this._originalMappings,"originalLine","originalColumn",qr.compareByOriginalPositions,Mfe.LEAST_UPPER_BOUND);if(o>=0){var a=this._originalMappings[o];if(e.column===void 0)for(var c=a.originalLine;a&&a.originalLine===c;)i.push({line:qr.getArg(a,"generatedLine",null),column:qr.getArg(a,"generatedColumn",null),lastColumn:qr.getArg(a,"lastGeneratedColumn",null)}),a=this._originalMappings[++o];else for(var l=a.originalColumn;a&&a.originalLine===r&&a.originalColumn==l;)i.push({line:qr.getArg(a,"generatedLine",null),column:qr.getArg(a,"generatedColumn",null),lastColumn:qr.getArg(a,"lastGeneratedColumn",null)}),a=this._originalMappings[++o]}return i},"SourceMapConsumer_allGeneratedPositionsFor");BW.SourceMapConsumer=Ys;function Fu(t,e){var r=t;typeof t=="string"&&(r=qr.parseSourceMapInput(t));var n=qr.getArg(r,"version"),i=qr.getArg(r,"sources"),o=qr.getArg(r,"names",[]),a=qr.getArg(r,"sourceRoot",null),c=qr.getArg(r,"sourcesContent",null),l=qr.getArg(r,"mappings"),u=qr.getArg(r,"file",null);if(n!=this._version)throw new Error("Unsupported version: "+n);a&&(a=qr.normalize(a)),i=i.map(String).map(qr.normalize).map(function(f){return a&&qr.isAbsolute(a)&&qr.isAbsolute(f)?qr.relative(a,f):f}),this._names=D4.fromArray(o.map(String),!0),this._sources=D4.fromArray(i,!0),this._absoluteSources=this._sources.toArray().map(function(f){return qr.computeSourceURL(a,f,e)}),this.sourceRoot=a,this.sourcesContent=c,this._mappings=l,this._sourceMapURL=e,this.file=u}s(Fu,"BasicSourceMapConsumer");Fu.prototype=Object.create(Ys.prototype);Fu.prototype.consumer=Ys;Fu.prototype._findSourceIndex=function(t){var e=t;if(this.sourceRoot!=null&&(e=qr.relative(this.sourceRoot,e)),this._sources.has(e))return this._sources.indexOf(e);var r;for(r=0;r<this._absoluteSources.length;++r)if(this._absoluteSources[r]==t)return r;return-1};Fu.fromSourceMap=s(function(e,r){var n=Object.create(Fu.prototype),i=n._names=D4.fromArray(e._names.toArray(),!0),o=n._sources=D4.fromArray(e._sources.toArray(),!0);n.sourceRoot=e._sourceRoot,n.sourcesContent=e._generateSourcesContent(n._sources.toArray(),n.sourceRoot),n.file=e._file,n._sourceMapURL=r,n._absoluteSources=n._sources.toArray().map(function(h){return qr.computeSourceURL(n.sourceRoot,h,r)});for(var a=e._mappings.toArray().slice(),c=n.__generatedMappings=[],l=n.__originalMappings=[],u=0,f=a.length;u<f;u++){var p=a[u],m=new aBe;m.generatedLine=p.generatedLine,m.generatedColumn=p.generatedColumn,p.source&&(m.source=o.indexOf(p.source),m.originalLine=p.originalLine,m.originalColumn=p.originalColumn,p.name&&(m.name=i.indexOf(p.name)),l.push(m)),c.push(m)}return BF(n.__originalMappings,qr.compareByOriginalPositions),n},"SourceMapConsumer_fromSourceMap");Fu.prototype._version=3;Object.defineProperty(Fu.prototype,"sources",{get:s(function(){return this._absoluteSources.slice()},"get")});function aBe(){this.generatedLine=0,this.generatedColumn=0,this.source=null,this.originalLine=null,this.originalColumn=null,this.name=null}s(aBe,"Mapping");Fu.prototype._parseMappings=s(function(e,r){for(var n=1,i=0,o=0,a=0,c=0,l=0,u=e.length,f=0,p={},m={},h=[],g=[],A,y,E,b,S;f<u;)if(e.charAt(f)===";")n++,f++,i=0;else if(e.charAt(f)===",")f++;else{for(A=new aBe,A.generatedLine=n,b=f;b<u&&!this._charIsMappingSeparator(e,b);b++);if(y=e.slice(f,b),E=p[y],E)f+=y.length;else{for(E=[];f<b;)QTt.decode(e,f,m),S=m.value,f=m.rest,E.push(S);if(E.length===2)throw new Error("Found a source, but no line and column");if(E.length===3)throw new Error("Found a source and line, but no column");p[y]=E}A.generatedColumn=i+E[0],i=A.generatedColumn,E.length>1&&(A.source=c+E[1],c+=E[1],A.originalLine=o+E[2],o=A.originalLine,A.originalLine+=1,A.originalColumn=a+E[3],a=A.originalColumn,E.length>4&&(A.name=l+E[4],l+=E[4])),g.push(A),typeof A.originalLine=="number"&&h.push(A)}BF(g,qr.compareByGeneratedPositionsDeflated),this.__generatedMappings=g,BF(h,qr.compareByOriginalPositions),this.__originalMappings=h},"SourceMapConsumer_parseMappings");Fu.prototype._findMapping=s(function(e,r,n,i,o,a){if(e[n]<=0)throw new TypeError("Line must be greater than or equal to 1, got "+e[n]);if(e[i]<0)throw new TypeError("Column must be greater than or equal to 0, got "+e[i]);return Mfe.search(e,r,o,a)},"SourceMapConsumer_findMapping");Fu.prototype.computeColumnSpans=s(function(){for(var e=0;e<this._generatedMappings.length;++e){var r=this._generatedMappings[e];if(e+1<this._generatedMappings.length){var n=this._generatedMappings[e+1];if(r.generatedLine===n.generatedLine){r.lastGeneratedColumn=n.generatedColumn-1;continue}}r.lastGeneratedColumn=1/0}},"SourceMapConsumer_computeColumnSpans");Fu.prototype.originalPositionFor=s(function(e){var r={generatedLine:qr.getArg(e,"line"),generatedColumn:qr.getArg(e,"column")},n=this._findMapping(r,this._generatedMappings,"generatedLine","generatedColumn",qr.compareByGeneratedPositionsDeflated,qr.getArg(e,"bias",Ys.GREATEST_LOWER_BOUND));if(n>=0){var i=this._generatedMappings[n];if(i.generatedLine===r.generatedLine){var o=qr.getArg(i,"source",null);o!==null&&(o=this._sources.at(o),o=qr.computeSourceURL(this.sourceRoot,o,this._sourceMapURL));var a=qr.getArg(i,"name",null);return a!==null&&(a=this._names.at(a)),{source:o,line:qr.getArg(i,"originalLine",null),column:qr.getArg(i,"originalColumn",null),name:a}}}return{source:null,line:null,column:null,name:null}},"SourceMapConsumer_originalPositionFor");Fu.prototype.hasContentsOfAllSources=s(function(){return this.sourcesContent?this.sourcesContent.length>=this._sources.size()&&!this.sourcesContent.some(function(e){return e==null}):!1},"BasicSourceMapConsumer_hasContentsOfAllSources");Fu.prototype.sourceContentFor=s(function(e,r){if(!this.sourcesContent)return null;var n=this._findSourceIndex(e);if(n>=0)return this.sourcesContent[n];var i=e;this.sourceRoot!=null&&(i=qr.relative(this.sourceRoot,i));var o;if(this.sourceRoot!=null&&(o=qr.urlParse(this.sourceRoot))){var a=i.replace(/^file:\/\//,"");if(o.scheme=="file"&&this._sources.has(a))return this.sourcesContent[this._sources.indexOf(a)];if((!o.path||o.path=="/")&&this._sources.has("/"+i))return this.sourcesContent[this._sources.indexOf("/"+i)]}if(r)return null;throw new Error('"'+i+'" is not in the SourceMap.')},"SourceMapConsumer_sourceContentFor");Fu.prototype.generatedPositionFor=s(function(e){var r=qr.getArg(e,"source");if(r=this._findSourceIndex(r),r<0)return{line:null,column:null,lastColumn:null};var n={source:r,originalLine:qr.getArg(e,"line"),originalColumn:qr.getArg(e,"column")},i=this._findMapping(n,this._originalMappings,"originalLine","originalColumn",qr.compareByOriginalPositions,qr.getArg(e,"bias",Ys.GREATEST_LOWER_BOUND));if(i>=0){var o=this._originalMappings[i];if(o.source===n.source)return{line:qr.getArg(o,"generatedLine",null),column:qr.getArg(o,"generatedColumn",null),lastColumn:qr.getArg(o,"lastGeneratedColumn",null)}}return{line:null,column:null,lastColumn:null}},"SourceMapConsumer_generatedPositionFor");BW.BasicSourceMapConsumer=Fu;function zg(t,e){var r=t;typeof t=="string"&&(r=qr.parseSourceMapInput(t));var n=qr.getArg(r,"version"),i=qr.getArg(r,"sections");if(n!=this._version)throw new Error("Unsupported version: "+n);this._sources=new D4,this._names=new D4;var o={line:-1,column:0};this._sections=i.map(function(a){if(a.url)throw new Error("Support for url field in sections not implemented.");var c=qr.getArg(a,"offset"),l=qr.getArg(c,"line"),u=qr.getArg(c,"column");if(l<o.line||l===o.line&&u<o.column)throw new Error("Section offsets must be ordered and non-overlapping.");return o=c,{generatedOffset:{generatedLine:l+1,generatedColumn:u+1},consumer:new Ys(qr.getArg(a,"map"),e)}})}s(zg,"IndexedSourceMapConsumer");zg.prototype=Object.create(Ys.prototype);zg.prototype.constructor=Ys;zg.prototype._version=3;Object.defineProperty(zg.prototype,"sources",{get:s(function(){for(var t=[],e=0;e<this._sections.length;e++)for(var r=0;r<this._sections[e].consumer.sources.length;r++)t.push(this._sections[e].consumer.sources[r]);return t},"get")});zg.prototype.originalPositionFor=s(function(e){var r={generatedLine:qr.getArg(e,"line"),generatedColumn:qr.getArg(e,"column")},n=Mfe.search(r,this._sections,function(o,a){var c=o.generatedLine-a.generatedOffset.generatedLine;return c||o.generatedColumn-a.generatedOffset.generatedColumn}),i=this._sections[n];return i?i.consumer.originalPositionFor({line:r.generatedLine-(i.generatedOffset.generatedLine-1),column:r.generatedColumn-(i.generatedOffset.generatedLine===r.generatedLine?i.generatedOffset.generatedColumn-1:0),bias:e.bias}):{source:null,line:null,column:null,name:null}},"IndexedSourceMapConsumer_originalPositionFor");zg.prototype.hasContentsOfAllSources=s(function(){return this._sections.every(function(e){return e.consumer.hasContentsOfAllSources()})},"IndexedSourceMapConsumer_hasContentsOfAllSources");zg.prototype.sourceContentFor=s(function(e,r){for(var n=0;n<this._sections.length;n++){var i=this._sections[n],o=i.consumer.sourceContentFor(e,!0);if(o)return o}if(r)return null;throw new Error('"'+e+'" is not in the SourceMap.')},"IndexedSourceMapConsumer_sourceContentFor");zg.prototype.generatedPositionFor=s(function(e){for(var r=0;r<this._sections.length;r++){var n=this._sections[r];if(n.consumer._findSourceIndex(qr.getArg(e,"source"))!==-1){var i=n.consumer.generatedPositionFor(e);if(i){var o={line:i.line+(n.generatedOffset.generatedLine-1),column:i.column+(n.generatedOffset.generatedLine===i.line?n.generatedOffset.generatedColumn-1:0)};return o}}}return{line:null,column:null}},"IndexedSourceMapConsumer_generatedPositionFor");zg.prototype._parseMappings=s(function(e,r){this.__generatedMappings=[],this.__originalMappings=[];for(var n=0;n<this._sections.length;n++)for(var i=this._sections[n],o=i.consumer._generatedMappings,a=0;a<o.length;a++){var c=o[a],l=i.consumer._sources.at(c.source);l=qr.computeSourceURL(i.consumer.sourceRoot,l,this._sourceMapURL),this._sources.add(l),l=this._sources.indexOf(l);var u=null;c.name&&(u=i.consumer._names.at(c.name),this._names.add(u),u=this._names.indexOf(u));var f={source:l,generatedLine:c.generatedLine+(i.generatedOffset.generatedLine-1),generatedColumn:c.generatedColumn+(i.generatedOffset.generatedLine===c.generatedLine?i.generatedOffset.generatedColumn-1:0),originalLine:c.originalLine,originalColumn:c.originalColumn,name:u};this.__generatedMappings.push(f),typeof f.originalLine=="number"&&this.__originalMappings.push(f)}BF(this.__generatedMappings,qr.compareByGeneratedPositionsDeflated),BF(this.__originalMappings,qr.compareByOriginalPositions)},"IndexedSourceMapConsumer_parseMappings");BW.IndexedSourceMapConsumer=zg});var uBe=H(lBe=>{d();var UTt=Pfe().SourceMapGenerator,NW=P4(),qTt=/(\r?\n)/,HTt=10,B4="$$$isSourceNode$$$";function f0(t,e,r,n,i){this.children=[],this.sourceContents={},this.line=t??null,this.column=e??null,this.source=r??null,this.name=i??null,this[B4]=!0,n!=null&&this.add(n)}s(f0,"SourceNode");f0.fromStringWithSourceMap=s(function(e,r,n){var i=new f0,o=e.split(qTt),a=0,c=s(function(){var m=g(),h=g()||"";return m+h;function g(){return a<o.length?o[a++]:void 0}},"shiftNextLine"),l=1,u=0,f=null;return r.eachMapping(function(m){if(f!==null)if(l<m.generatedLine)p(f,c()),l++,u=0;else{var h=o[a]||"",g=h.substr(0,m.generatedColumn-u);o[a]=h.substr(m.generatedColumn-u),u=m.generatedColumn,p(f,g),f=m;return}for(;l<m.generatedLine;)i.add(c()),l++;if(u<m.generatedColumn){var h=o[a]||"";i.add(h.substr(0,m.generatedColumn)),o[a]=h.substr(m.generatedColumn),u=m.generatedColumn}f=m},this),a<o.length&&(f&&p(f,c()),i.add(o.splice(a).join(""))),r.sources.forEach(function(m){var h=r.sourceContentFor(m);h!=null&&(n!=null&&(m=NW.join(n,m)),i.setSourceContent(m,h))}),i;function p(m,h){if(m===null||m.source===void 0)i.add(h);else{var g=n?NW.join(n,m.source):m.source;i.add(new f0(m.originalLine,m.originalColumn,g,h,m.name))}}s(p,"addMappingWithCode")},"SourceNode_fromStringWithSourceMap");f0.prototype.add=s(function(e){if(Array.isArray(e))e.forEach(function(r){this.add(r)},this);else if(e[B4]||typeof e=="string")e&&this.children.push(e);else throw new TypeError("Expected a SourceNode, string, or an array of SourceNodes and strings. Got "+e);return this},"SourceNode_add");f0.prototype.prepend=s(function(e){if(Array.isArray(e))for(var r=e.length-1;r>=0;r--)this.prepend(e[r]);else if(e[B4]||typeof e=="string")this.children.unshift(e);else throw new TypeError("Expected a SourceNode, string, or an array of SourceNodes and strings. Got "+e);return this},"SourceNode_prepend");f0.prototype.walk=s(function(e){for(var r,n=0,i=this.children.length;n<i;n++)r=this.children[n],r[B4]?r.walk(e):r!==""&&e(r,{source:this.source,line:this.line,column:this.column,name:this.name})},"SourceNode_walk");f0.prototype.join=s(function(e){var r,n,i=this.children.length;if(i>0){for(r=[],n=0;n<i-1;n++)r.push(this.children[n]),r.push(e);r.push(this.children[n]),this.children=r}return this},"SourceNode_join");f0.prototype.replaceRight=s(function(e,r){var n=this.children[this.children.length-1];return n[B4]?n.replaceRight(e,r):typeof n=="string"?this.children[this.children.length-1]=n.replace(e,r):this.children.push("".replace(e,r)),this},"SourceNode_replaceRight");f0.prototype.setSourceContent=s(function(e,r){this.sourceContents[NW.toSetString(e)]=r},"SourceNode_setSourceContent");f0.prototype.walkSourceContents=s(function(e){for(var r=0,n=this.children.length;r<n;r++)this.children[r][B4]&&this.children[r].walkSourceContents(e);for(var i=Object.keys(this.sourceContents),r=0,n=i.length;r<n;r++)e(NW.fromSetString(i[r]),this.sourceContents[i[r]])},"SourceNode_walkSourceContents");f0.prototype.toString=s(function(){var e="";return this.walk(function(r){e+=r}),e},"SourceNode_toString");f0.prototype.toStringWithSourceMap=s(function(e){var r={code:"",line:1,column:0},n=new UTt(e),i=!1,o=null,a=null,c=null,l=null;return this.walk(function(u,f){r.code+=u,f.source!==null&&f.line!==null&&f.column!==null?((o!==f.source||a!==f.line||c!==f.column||l!==f.name)&&n.addMapping({source:f.source,original:{line:f.line,column:f.column},generated:{line:r.line,column:r.column},name:f.name}),o=f.source,a=f.line,c=f.column,l=f.name,i=!0):i&&(n.addMapping({generated:{line:r.line,column:r.column}}),o=null,i=!1);for(var p=0,m=u.length;p<m;p++)u.charCodeAt(p)===HTt?(r.line++,r.column=0,p+1===m?(o=null,i=!1):i&&n.addMapping({source:f.source,original:{line:f.line,column:f.column},generated:{line:r.line,column:r.column},name:f.name})):r.column++}),this.walkSourceContents(function(u,f){n.setSourceContent(u,f)}),{code:r.code,map:n}},"SourceNode_toStringWithSourceMap");lBe.SourceNode=f0});var dBe=H(MW=>{d();MW.SourceMapGenerator=Pfe().SourceMapGenerator;MW.SourceMapConsumer=cBe().SourceMapConsumer;MW.SourceNode=uBe().SourceNode});var pBe=H((J5r,fBe)=>{d();var $Tt=Object.prototype.toString,Lfe=typeof Buffer<"u"&&typeof Buffer.alloc=="function"&&typeof Buffer.allocUnsafe=="function"&&typeof Buffer.from=="function";function WTt(t){return $Tt.call(t).slice(8,-1)==="ArrayBuffer"}s(WTt,"isArrayBuffer");function jTt(t,e,r){e>>>=0;var n=t.byteLength-e;if(n<0)throw new RangeError("'offset' is out of bounds");if(r===void 0)r=n;else if(r>>>=0,r>n)throw new RangeError("'length' is out of bounds");return Lfe?Buffer.from(t.slice(e,e+r)):new Buffer(new Uint8Array(t.slice(e,e+r)))}s(jTt,"fromArrayBuffer");function GTt(t,e){if((typeof e!="string"||e==="")&&(e="utf8"),!Buffer.isEncoding(e))throw new TypeError('"encoding" must be a valid string encoding');return Lfe?Buffer.from(t,e):new Buffer(t,e)}s(GTt,"fromString");function VTt(t,e,r){if(typeof t=="number")throw new TypeError('"value" argument must not be a number');return WTt(t)?jTt(t,e,r):typeof t=="string"?GTt(t,e):Lfe?Buffer.from(t):new Buffer(t)}s(VTt,"bufferFrom");fBe.exports=VTt});var xBe=H((O_,Ufe)=>{d();var zTt=dBe().SourceMapConsumer,Ffe=require("path"),rC;try{rC=require("fs"),(!rC.existsSync||!rC.readFileSync)&&(rC=null)}catch{}var KTt=pBe();function mBe(t,e){return t.require(e)}s(mBe,"dynamicRequire");var hBe=!1,gBe=!1,Ofe=!1,NF="auto",F_={},MF={},YTt=/^data:application\/json[^,]+base64,/,pI=[],mI=[];function qfe(){return NF==="browser"?!0:NF==="node"?!1:typeof window<"u"&&typeof XMLHttpRequest=="function"&&!(window.require&&window.module&&window.process&&window.process.type==="renderer")}s(qfe,"isInBrowser");function JTt(){return typeof process=="object"&&process!==null&&typeof process.on=="function"}s(JTt,"hasGlobalProcessEventEmitter");function XTt(){return typeof process=="object"&&process!==null?process.version:""}s(XTt,"globalProcessVersion");function ZTt(){if(typeof process=="object"&&process!==null)return process.stderr}s(ZTt,"globalProcessStderr");function ewt(t){if(typeof process=="object"&&process!==null&&typeof process.exit=="function")return process.exit(t)}s(ewt,"globalProcessExit");function LW(t){return function(e){for(var r=0;r<t.length;r++){var n=t[r](e);if(n)return n}return null}}s(LW,"handlerExec");var Hfe=LW(pI);pI.push(function(t){if(t=t.trim(),/^file:/.test(t)&&(t=t.replace(/file:\/\/\/(\w:)?/,function(n,i){return i?"":"/"})),t in F_)return F_[t];var e="";try{if(rC)rC.existsSync(t)&&(e=rC.readFileSync(t,"utf8"));else{var r=new XMLHttpRequest;r.open("GET",t,!1),r.send(null),r.readyState===4&&r.status===200&&(e=r.responseText)}}catch{}return F_[t]=e});function Qfe(t,e){if(!t)return e;var r=Ffe.dirname(t),n=/^\w+:\/\/[^\/]*/.exec(r),i=n?n[0]:"",o=r.slice(i.length);return i&&/^\/\w\:/.test(o)?(i+="/",i+Ffe.resolve(r.slice(i.length),e).replace(/\\/g,"/")):i+Ffe.resolve(r.slice(i.length),e)}s(Qfe,"supportRelativeURL");function twt(t){var e;if(qfe())try{var r=new XMLHttpRequest;r.open("GET",t,!1),r.send(null),e=r.readyState===4?r.responseText:null;var n=r.getResponseHeader("SourceMap")||r.getResponseHeader("X-SourceMap");if(n)return n}catch{}e=Hfe(t);for(var i=/(?:\/\/[@#][\s]*sourceMappingURL=([^\s'"]+)[\s]*$)|(?:\/\*[@#][\s]*sourceMappingURL=([^\s*'"]+)[\s]*(?:\*\/)[\s]*$)/mg,o,a;a=i.exec(e);)o=a;return o?o[1]:null}s(twt,"retrieveSourceMapURL");var $fe=LW(mI);mI.push(function(t){var e=twt(t);if(!e)return null;var r;if(YTt.test(e)){var n=e.slice(e.indexOf(",")+1);r=KTt(n,"base64").toString(),e=t}else e=Qfe(t,e),r=Hfe(e);return r?{url:e,map:r}:null});function Wfe(t){var e=MF[t.source];if(!e){var r=$fe(t.source);r?(e=MF[t.source]={url:r.url,map:new zTt(r.map)},e.map.sourcesContent&&e.map.sources.forEach(function(i,o){var a=e.map.sourcesContent[o];if(a){var c=Qfe(e.url,i);F_[c]=a}})):e=MF[t.source]={url:null,map:null}}if(e&&e.map&&typeof e.map.originalPositionFor=="function"){var n=e.map.originalPositionFor(t);if(n.source!==null)return n.source=Qfe(e.url,n.source),n}return t}s(Wfe,"mapSourcePosition");function yBe(t){var e=/^eval at ([^(]+) \((.+):(\d+):(\d+)\)$/.exec(t);if(e){var r=Wfe({source:e[2],line:+e[3],column:e[4]-1});return"eval at "+e[1]+" ("+r.source+":"+r.line+":"+(r.column+1)+")"}return e=/^eval at ([^(]+) \((.+)\)$/.exec(t),e?"eval at "+e[1]+" ("+yBe(e[2])+")":t}s(yBe,"mapEvalOrigin");function rwt(){var t,e="";if(this.isNative())e="native";else{t=this.getScriptNameOrSourceURL(),!t&&this.isEval()&&(e=this.getEvalOrigin(),e+=", "),t?e+=t:e+="<anonymous>";var r=this.getLineNumber();if(r!=null){e+=":"+r;var n=this.getColumnNumber();n&&(e+=":"+n)}}var i="",o=this.getFunctionName(),a=!0,c=this.isConstructor(),l=!(this.isToplevel()||c);if(l){var u=this.getTypeName();u==="[object Object]"&&(u="null");var f=this.getMethodName();o?(u&&o.indexOf(u)!=0&&(i+=u+"."),i+=o,f&&o.indexOf("."+f)!=o.length-f.length-1&&(i+=" [as "+f+"]")):i+=u+"."+(f||"<anonymous>")}else c?i+="new "+(o||"<anonymous>"):o?i+=o:(i+=e,a=!1);return a&&(i+=" ("+e+")"),i}s(rwt,"CallSiteToString");function ABe(t){var e={};return Object.getOwnPropertyNames(Object.getPrototypeOf(t)).forEach(function(r){e[r]=/^(?:is|get)/.test(r)?function(){return t[r].call(t)}:t[r]}),e.toString=rwt,e}s(ABe,"cloneCallSite");function CBe(t,e){if(e===void 0&&(e={nextPosition:null,curPosition:null}),t.isNative())return e.curPosition=null,t;var r=t.getFileName()||t.getScriptNameOrSourceURL();if(r){var n=t.getLineNumber(),i=t.getColumnNumber()-1,o=/^v(10\.1[6-9]|10\.[2-9][0-9]|10\.[0-9]{3,}|1[2-9]\d*|[2-9]\d|\d{3,}|11\.11)/,a=o.test(XTt())?0:62;n===1&&i>a&&!qfe()&&!t.isEval()&&(i-=a);var c=Wfe({source:r,line:n,column:i});e.curPosition=c,t=ABe(t);var l=t.getFunctionName;return t.getFunctionName=function(){return e.nextPosition==null?l():e.nextPosition.name||l()},t.getFileName=function(){return c.source},t.getLineNumber=function(){return c.line},t.getColumnNumber=function(){return c.column+1},t.getScriptNameOrSourceURL=function(){return c.source},t}var u=t.isEval()&&t.getEvalOrigin();return u&&(u=yBe(u),t=ABe(t),t.getEvalOrigin=function(){return u}),t}s(CBe,"wrapCallSite");function nwt(t,e){Ofe&&(F_={},MF={});for(var r=t.name||"Error",n=t.message||"",i=r+": "+n,o={nextPosition:null,curPosition:null},a=[],c=e.length-1;c>=0;c--)a.push(`
    at `+CBe(e[c],o)),o.nextPosition=o.curPosition;return o.curPosition=o.nextPosition=null,i+a.reverse().join("")}s(nwt,"prepareStackTrace");function vBe(t){var e=/\n    at [^(]+ \((.*):(\d+):(\d+)\)/.exec(t.stack);if(e){var r=e[1],n=+e[2],i=+e[3],o=F_[r];if(!o&&rC&&rC.existsSync(r))try{o=rC.readFileSync(r,"utf8")}catch{o=""}if(o){var a=o.split(/(?:\r\n|\r|\n)/)[n-1];if(a)return r+":"+n+`
`+a+`
`+new Array(i).join(" ")+"^"}}return null}s(vBe,"getErrorSource");function iwt(t){var e=vBe(t),r=ZTt();r&&r._handle&&r._handle.setBlocking&&r._handle.setBlocking(!0),e&&(console.error(),console.error(e)),console.error(t.stack),ewt(1)}s(iwt,"printErrorAndExit");function owt(){var t=process.emit;process.emit=function(e){if(e==="uncaughtException"){var r=arguments[1]&&arguments[1].stack,n=this.listeners(e).length>0;if(r&&!n)return iwt(arguments[1])}return t.apply(this,arguments)}}s(owt,"shimEmitUncaughtException");var swt=pI.slice(0),awt=mI.slice(0);O_.wrapCallSite=CBe;O_.getErrorSource=vBe;O_.mapSourcePosition=Wfe;O_.retrieveSourceMap=$fe;O_.install=function(t){if(t=t||{},t.environment&&(NF=t.environment,["node","browser","auto"].indexOf(NF)===-1))throw new Error("environment "+NF+" was unknown. Available options are {auto, browser, node}");if(t.retrieveFile&&(t.overrideRetrieveFile&&(pI.length=0),pI.unshift(t.retrieveFile)),t.retrieveSourceMap&&(t.overrideRetrieveSourceMap&&(mI.length=0),mI.unshift(t.retrieveSourceMap)),t.hookRequire&&!qfe()){var e=mBe(Ufe,"module"),r=e.prototype._compile;r.__sourceMapSupport||(e.prototype._compile=function(o,a){return F_[a]=o,MF[a]=void 0,r.call(this,o,a)},e.prototype._compile.__sourceMapSupport=!0)}if(Ofe||(Ofe="emptyCacheBetweenOperations"in t?t.emptyCacheBetweenOperations:!1),hBe||(hBe=!0,Error.prepareStackTrace=nwt),!gBe){var n="handleUncaughtExceptions"in t?t.handleUncaughtExceptions:!0;try{var i=mBe(Ufe,"worker_threads");i.isMainThread===!1&&(n=!1)}catch{}n&&JTt()&&(gBe=!0,owt())}};O_.resetRetrieveHandlers=function(){pI.length=0,mI.length=0,pI=swt.slice(0),mI=awt.slice(0),$fe=LW(mI),Hfe=LW(pI)}});var so=H((QW,TBe)=>{d();(function(t,e){typeof QW=="object"?TBe.exports=QW=e():typeof define=="function"&&define.amd?define([],e):t.CryptoJS=e()})(QW,function(){var t=t||function(e,r){var n;if(typeof window<"u"&&window.crypto&&(n=window.crypto),typeof self<"u"&&self.crypto&&(n=self.crypto),typeof globalThis<"u"&&globalThis.crypto&&(n=globalThis.crypto),!n&&typeof window<"u"&&window.msCrypto&&(n=window.msCrypto),!n&&typeof global<"u"&&global.crypto&&(n=global.crypto),!n&&typeof require=="function")try{n=require("crypto")}catch{}var i=s(function(){if(n){if(typeof n.getRandomValues=="function")try{return n.getRandomValues(new Uint32Array(1))[0]}catch{}if(typeof n.randomBytes=="function")try{return n.randomBytes(4).readInt32LE()}catch{}}throw new Error("Native crypto module could not be used to get secure random number.")},"cryptoSecureRandomInt"),o=Object.create||function(){function E(){}return s(E,"F"),function(b){var S;return E.prototype=b,S=new E,E.prototype=null,S}}(),a={},c=a.lib={},l=c.Base=function(){return{extend:s(function(E){var b=o(this);return E&&b.mixIn(E),(!b.hasOwnProperty("init")||this.init===b.init)&&(b.init=function(){b.$super.init.apply(this,arguments)}),b.init.prototype=b,b.$super=this,b},"extend"),create:s(function(){var E=this.extend();return E.init.apply(E,arguments),E},"create"),init:s(function(){},"init"),mixIn:s(function(E){for(var b in E)E.hasOwnProperty(b)&&(this[b]=E[b]);E.hasOwnProperty("toString")&&(this.toString=E.toString)},"mixIn"),clone:s(function(){return this.init.prototype.extend(this)},"clone")}}(),u=c.WordArray=l.extend({init:s(function(E,b){E=this.words=E||[],b!=r?this.sigBytes=b:this.sigBytes=E.length*4},"init"),toString:s(function(E){return(E||p).stringify(this)},"toString"),concat:s(function(E){var b=this.words,S=E.words,R=this.sigBytes,B=E.sigBytes;if(this.clamp(),R%4)for(var L=0;L<B;L++){var O=S[L>>>2]>>>24-L%4*8&255;b[R+L>>>2]|=O<<24-(R+L)%4*8}else for(var Y=0;Y<B;Y+=4)b[R+Y>>>2]=S[Y>>>2];return this.sigBytes+=B,this},"concat"),clamp:s(function(){var E=this.words,b=this.sigBytes;E[b>>>2]&=4294967295<<32-b%4*8,E.length=e.ceil(b/4)},"clamp"),clone:s(function(){var E=l.clone.call(this);return E.words=this.words.slice(0),E},"clone"),random:s(function(E){for(var b=[],S=0;S<E;S+=4)b.push(i());return new u.init(b,E)},"random")}),f=a.enc={},p=f.Hex={stringify:s(function(E){for(var b=E.words,S=E.sigBytes,R=[],B=0;B<S;B++){var L=b[B>>>2]>>>24-B%4*8&255;R.push((L>>>4).toString(16)),R.push((L&15).toString(16))}return R.join("")},"stringify"),parse:s(function(E){for(var b=E.length,S=[],R=0;R<b;R+=2)S[R>>>3]|=parseInt(E.substr(R,2),16)<<24-R%8*4;return new u.init(S,b/2)},"parse")},m=f.Latin1={stringify:s(function(E){for(var b=E.words,S=E.sigBytes,R=[],B=0;B<S;B++){var L=b[B>>>2]>>>24-B%4*8&255;R.push(String.fromCharCode(L))}return R.join("")},"stringify"),parse:s(function(E){for(var b=E.length,S=[],R=0;R<b;R++)S[R>>>2]|=(E.charCodeAt(R)&255)<<24-R%4*8;return new u.init(S,b)},"parse")},h=f.Utf8={stringify:s(function(E){try{return decodeURIComponent(escape(m.stringify(E)))}catch{throw new Error("Malformed UTF-8 data")}},"stringify"),parse:s(function(E){return m.parse(unescape(encodeURIComponent(E)))},"parse")},g=c.BufferedBlockAlgorithm=l.extend({reset:s(function(){this._data=new u.init,this._nDataBytes=0},"reset"),_append:s(function(E){typeof E=="string"&&(E=h.parse(E)),this._data.concat(E),this._nDataBytes+=E.sigBytes},"_append"),_process:s(function(E){var b,S=this._data,R=S.words,B=S.sigBytes,L=this.blockSize,O=L*4,Y=B/O;E?Y=e.ceil(Y):Y=e.max((Y|0)-this._minBufferSize,0);var V=Y*L,z=e.min(V*4,B);if(V){for(var Q=0;Q<V;Q+=L)this._doProcessBlock(R,Q);b=R.splice(0,V),S.sigBytes-=z}return new u.init(b,z)},"_process"),clone:s(function(){var E=l.clone.call(this);return E._data=this._data.clone(),E},"clone"),_minBufferSize:0}),A=c.Hasher=g.extend({cfg:l.extend(),init:s(function(E){this.cfg=this.cfg.extend(E),this.reset()},"init"),reset:s(function(){g.reset.call(this),this._doReset()},"reset"),update:s(function(E){return this._append(E),this._process(),this},"update"),finalize:s(function(E){E&&this._append(E);var b=this._doFinalize();return b},"finalize"),blockSize:512/32,_createHelper:s(function(E){return function(b,S){return new E.init(S).finalize(b)}},"_createHelper"),_createHmacHelper:s(function(E){return function(b,S){return new y.HMAC.init(E,S).finalize(b)}},"_createHmacHelper")}),y=a.algo={};return a}(Math);return t})});var QF=H((UW,wBe)=>{d();(function(t,e){typeof UW=="object"?wBe.exports=UW=e(so()):typeof define=="function"&&define.amd?define(["./core"],e):e(t.CryptoJS)})(UW,function(t){return function(e){var r=t,n=r.lib,i=n.Base,o=n.WordArray,a=r.x64={},c=a.Word=i.extend({init:s(function(u,f){this.high=u,this.low=f},"init")}),l=a.WordArray=i.extend({init:s(function(u,f){u=this.words=u||[],f!=e?this.sigBytes=f:this.sigBytes=u.length*8},"init"),toX32:s(function(){for(var u=this.words,f=u.length,p=[],m=0;m<f;m++){var h=u[m];p.push(h.high),p.push(h.low)}return o.create(p,this.sigBytes)},"toX32"),clone:s(function(){for(var u=i.clone.call(this),f=u.words=this.words.slice(0),p=f.length,m=0;m<p;m++)f[m]=f[m].clone();return u},"clone")})}(),t})});var _Be=H((qW,SBe)=>{d();(function(t,e){typeof qW=="object"?SBe.exports=qW=e(so()):typeof define=="function"&&define.amd?define(["./core"],e):e(t.CryptoJS)})(qW,function(t){return function(){if(typeof ArrayBuffer=="function"){var e=t,r=e.lib,n=r.WordArray,i=n.init,o=n.init=function(a){if(a instanceof ArrayBuffer&&(a=new Uint8Array(a)),(a instanceof Int8Array||typeof Uint8ClampedArray<"u"&&a instanceof Uint8ClampedArray||a instanceof Int16Array||a instanceof Uint16Array||a instanceof Int32Array||a instanceof Uint32Array||a instanceof Float32Array||a instanceof Float64Array)&&(a=new Uint8Array(a.buffer,a.byteOffset,a.byteLength)),a instanceof Uint8Array){for(var c=a.byteLength,l=[],u=0;u<c;u++)l[u>>>2]|=a[u]<<24-u%4*8;i.call(this,l,c)}else i.apply(this,arguments)};o.prototype=n}}(),t.lib.WordArray})});var kBe=H((HW,RBe)=>{d();(function(t,e){typeof HW=="object"?RBe.exports=HW=e(so()):typeof define=="function"&&define.amd?define(["./core"],e):e(t.CryptoJS)})(HW,function(t){return function(){var e=t,r=e.lib,n=r.WordArray,i=e.enc,o=i.Utf16=i.Utf16BE={stringify:s(function(c){for(var l=c.words,u=c.sigBytes,f=[],p=0;p<u;p+=2){var m=l[p>>>2]>>>16-p%4*8&65535;f.push(String.fromCharCode(m))}return f.join("")},"stringify"),parse:s(function(c){for(var l=c.length,u=[],f=0;f<l;f++)u[f>>>1]|=c.charCodeAt(f)<<16-f%2*16;return n.create(u,l*2)},"parse")};i.Utf16LE={stringify:s(function(c){for(var l=c.words,u=c.sigBytes,f=[],p=0;p<u;p+=2){var m=a(l[p>>>2]>>>16-p%4*8&65535);f.push(String.fromCharCode(m))}return f.join("")},"stringify"),parse:s(function(c){for(var l=c.length,u=[],f=0;f<l;f++)u[f>>>1]|=a(c.charCodeAt(f)<<16-f%2*16);return n.create(u,l*2)},"parse")};function a(c){return c<<8&4278255360|c>>>8&16711935}s(a,"swapEndian")}(),t.enc.Utf16})});var gI=H(($W,PBe)=>{d();(function(t,e){typeof $W=="object"?PBe.exports=$W=e(so()):typeof define=="function"&&define.amd?define(["./core"],e):e(t.CryptoJS)})($W,function(t){return function(){var e=t,r=e.lib,n=r.WordArray,i=e.enc,o=i.Base64={stringify:s(function(c){var l=c.words,u=c.sigBytes,f=this._map;c.clamp();for(var p=[],m=0;m<u;m+=3)for(var h=l[m>>>2]>>>24-m%4*8&255,g=l[m+1>>>2]>>>24-(m+1)%4*8&255,A=l[m+2>>>2]>>>24-(m+2)%4*8&255,y=h<<16|g<<8|A,E=0;E<4&&m+E*.75<u;E++)p.push(f.charAt(y>>>6*(3-E)&63));var b=f.charAt(64);if(b)for(;p.length%4;)p.push(b);return p.join("")},"stringify"),parse:s(function(c){var l=c.length,u=this._map,f=this._reverseMap;if(!f){f=this._reverseMap=[];for(var p=0;p<u.length;p++)f[u.charCodeAt(p)]=p}var m=u.charAt(64);if(m){var h=c.indexOf(m);h!==-1&&(l=h)}return a(c,l,f)},"parse"),_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="};function a(c,l,u){for(var f=[],p=0,m=0;m<l;m++)if(m%4){var h=u[c.charCodeAt(m-1)]<<m%4*2,g=u[c.charCodeAt(m)]>>>6-m%4*2,A=h|g;f[p>>>2]|=A<<24-p%4*8,p++}return n.create(f,p)}s(a,"parseLoop")}(),t.enc.Base64})});var BBe=H((WW,DBe)=>{d();(function(t,e){typeof WW=="object"?DBe.exports=WW=e(so()):typeof define=="function"&&define.amd?define(["./core"],e):e(t.CryptoJS)})(WW,function(t){return function(){var e=t,r=e.lib,n=r.WordArray,i=e.enc,o=i.Base64url={stringify:s(function(c,l){l===void 0&&(l=!0);var u=c.words,f=c.sigBytes,p=l?this._safe_map:this._map;c.clamp();for(var m=[],h=0;h<f;h+=3)for(var g=u[h>>>2]>>>24-h%4*8&255,A=u[h+1>>>2]>>>24-(h+1)%4*8&255,y=u[h+2>>>2]>>>24-(h+2)%4*8&255,E=g<<16|A<<8|y,b=0;b<4&&h+b*.75<f;b++)m.push(p.charAt(E>>>6*(3-b)&63));var S=p.charAt(64);if(S)for(;m.length%4;)m.push(S);return m.join("")},"stringify"),parse:s(function(c,l){l===void 0&&(l=!0);var u=c.length,f=l?this._safe_map:this._map,p=this._reverseMap;if(!p){p=this._reverseMap=[];for(var m=0;m<f.length;m++)p[f.charCodeAt(m)]=m}var h=f.charAt(64);if(h){var g=c.indexOf(h);g!==-1&&(u=g)}return a(c,u,p)},"parse"),_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",_safe_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"};function a(c,l,u){for(var f=[],p=0,m=0;m<l;m++)if(m%4){var h=u[c.charCodeAt(m-1)]<<m%4*2,g=u[c.charCodeAt(m)]>>>6-m%4*2,A=h|g;f[p>>>2]|=A<<24-p%4*8,p++}return n.create(f,p)}s(a,"parseLoop")}(),t.enc.Base64url})});var AI=H((jW,NBe)=>{d();(function(t,e){typeof jW=="object"?NBe.exports=jW=e(so()):typeof define=="function"&&define.amd?define(["./core"],e):e(t.CryptoJS)})(jW,function(t){return function(e){var r=t,n=r.lib,i=n.WordArray,o=n.Hasher,a=r.algo,c=[];(function(){for(var h=0;h<64;h++)c[h]=e.abs(e.sin(h+1))*4294967296|0})();var l=a.MD5=o.extend({_doReset:s(function(){this._hash=new i.init([1732584193,4023233417,2562383102,271733878])},"_doReset"),_doProcessBlock:s(function(h,g){for(var A=0;A<16;A++){var y=g+A,E=h[y];h[y]=(E<<8|E>>>24)&16711935|(E<<24|E>>>8)&4278255360}var b=this._hash.words,S=h[g+0],R=h[g+1],B=h[g+2],L=h[g+3],O=h[g+4],Y=h[g+5],V=h[g+6],z=h[g+7],Q=h[g+8],U=h[g+9],Z=h[g+10],J=h[g+11],j=h[g+12],W=h[g+13],X=h[g+14],oe=h[g+15],te=b[0],re=b[1],pe=b[2],Ae=b[3];te=u(te,re,pe,Ae,S,7,c[0]),Ae=u(Ae,te,re,pe,R,12,c[1]),pe=u(pe,Ae,te,re,B,17,c[2]),re=u(re,pe,Ae,te,L,22,c[3]),te=u(te,re,pe,Ae,O,7,c[4]),Ae=u(Ae,te,re,pe,Y,12,c[5]),pe=u(pe,Ae,te,re,V,17,c[6]),re=u(re,pe,Ae,te,z,22,c[7]),te=u(te,re,pe,Ae,Q,7,c[8]),Ae=u(Ae,te,re,pe,U,12,c[9]),pe=u(pe,Ae,te,re,Z,17,c[10]),re=u(re,pe,Ae,te,J,22,c[11]),te=u(te,re,pe,Ae,j,7,c[12]),Ae=u(Ae,te,re,pe,W,12,c[13]),pe=u(pe,Ae,te,re,X,17,c[14]),re=u(re,pe,Ae,te,oe,22,c[15]),te=f(te,re,pe,Ae,R,5,c[16]),Ae=f(Ae,te,re,pe,V,9,c[17]),pe=f(pe,Ae,te,re,J,14,c[18]),re=f(re,pe,Ae,te,S,20,c[19]),te=f(te,re,pe,Ae,Y,5,c[20]),Ae=f(Ae,te,re,pe,Z,9,c[21]),pe=f(pe,Ae,te,re,oe,14,c[22]),re=f(re,pe,Ae,te,O,20,c[23]),te=f(te,re,pe,Ae,U,5,c[24]),Ae=f(Ae,te,re,pe,X,9,c[25]),pe=f(pe,Ae,te,re,L,14,c[26]),re=f(re,pe,Ae,te,Q,20,c[27]),te=f(te,re,pe,Ae,W,5,c[28]),Ae=f(Ae,te,re,pe,B,9,c[29]),pe=f(pe,Ae,te,re,z,14,c[30]),re=f(re,pe,Ae,te,j,20,c[31]),te=p(te,re,pe,Ae,Y,4,c[32]),Ae=p(Ae,te,re,pe,Q,11,c[33]),pe=p(pe,Ae,te,re,J,16,c[34]),re=p(re,pe,Ae,te,X,23,c[35]),te=p(te,re,pe,Ae,R,4,c[36]),Ae=p(Ae,te,re,pe,O,11,c[37]),pe=p(pe,Ae,te,re,z,16,c[38]),re=p(re,pe,Ae,te,Z,23,c[39]),te=p(te,re,pe,Ae,W,4,c[40]),Ae=p(Ae,te,re,pe,S,11,c[41]),pe=p(pe,Ae,te,re,L,16,c[42]),re=p(re,pe,Ae,te,V,23,c[43]),te=p(te,re,pe,Ae,U,4,c[44]),Ae=p(Ae,te,re,pe,j,11,c[45]),pe=p(pe,Ae,te,re,oe,16,c[46]),re=p(re,pe,Ae,te,B,23,c[47]),te=m(te,re,pe,Ae,S,6,c[48]),Ae=m(Ae,te,re,pe,z,10,c[49]),pe=m(pe,Ae,te,re,X,15,c[50]),re=m(re,pe,Ae,te,Y,21,c[51]),te=m(te,re,pe,Ae,j,6,c[52]),Ae=m(Ae,te,re,pe,L,10,c[53]),pe=m(pe,Ae,te,re,Z,15,c[54]),re=m(re,pe,Ae,te,R,21,c[55]),te=m(te,re,pe,Ae,Q,6,c[56]),Ae=m(Ae,te,re,pe,oe,10,c[57]),pe=m(pe,Ae,te,re,V,15,c[58]),re=m(re,pe,Ae,te,W,21,c[59]),te=m(te,re,pe,Ae,O,6,c[60]),Ae=m(Ae,te,re,pe,J,10,c[61]),pe=m(pe,Ae,te,re,B,15,c[62]),re=m(re,pe,Ae,te,U,21,c[63]),b[0]=b[0]+te|0,b[1]=b[1]+re|0,b[2]=b[2]+pe|0,b[3]=b[3]+Ae|0},"_doProcessBlock"),_doFinalize:s(function(){var h=this._data,g=h.words,A=this._nDataBytes*8,y=h.sigBytes*8;g[y>>>5]|=128<<24-y%32;var E=e.floor(A/4294967296),b=A;g[(y+64>>>9<<4)+15]=(E<<8|E>>>24)&16711935|(E<<24|E>>>8)&4278255360,g[(y+64>>>9<<4)+14]=(b<<8|b>>>24)&16711935|(b<<24|b>>>8)&4278255360,h.sigBytes=(g.length+1)*4,this._process();for(var S=this._hash,R=S.words,B=0;B<4;B++){var L=R[B];R[B]=(L<<8|L>>>24)&16711935|(L<<24|L>>>8)&4278255360}return S},"_doFinalize"),clone:s(function(){var h=o.clone.call(this);return h._hash=this._hash.clone(),h},"clone")});function u(h,g,A,y,E,b,S){var R=h+(g&A|~g&y)+E+S;return(R<<b|R>>>32-b)+g}s(u,"FF");function f(h,g,A,y,E,b,S){var R=h+(g&y|A&~y)+E+S;return(R<<b|R>>>32-b)+g}s(f,"GG");function p(h,g,A,y,E,b,S){var R=h+(g^A^y)+E+S;return(R<<b|R>>>32-b)+g}s(p,"HH");function m(h,g,A,y,E,b,S){var R=h+(A^(g|~y))+E+S;return(R<<b|R>>>32-b)+g}s(m,"II"),r.MD5=o._createHelper(l),r.HmacMD5=o._createHmacHelper(l)}(Math),t.MD5})});var Vfe=H((GW,MBe)=>{d();(function(t,e){typeof GW=="object"?MBe.exports=GW=e(so()):typeof define=="function"&&define.amd?define(["./core"],e):e(t.CryptoJS)})(GW,function(t){return function(){var e=t,r=e.lib,n=r.WordArray,i=r.Hasher,o=e.algo,a=[],c=o.SHA1=i.extend({_doReset:s(function(){this._hash=new n.init([1732584193,4023233417,2562383102,271733878,3285377520])},"_doReset"),_doProcessBlock:s(function(l,u){for(var f=this._hash.words,p=f[0],m=f[1],h=f[2],g=f[3],A=f[4],y=0;y<80;y++){if(y<16)a[y]=l[u+y]|0;else{var E=a[y-3]^a[y-8]^a[y-14]^a[y-16];a[y]=E<<1|E>>>31}var b=(p<<5|p>>>27)+A+a[y];y<20?b+=(m&h|~m&g)+1518500249:y<40?b+=(m^h^g)+1859775393:y<60?b+=(m&h|m&g|h&g)-1894007588:b+=(m^h^g)-899497514,A=g,g=h,h=m<<30|m>>>2,m=p,p=b}f[0]=f[0]+p|0,f[1]=f[1]+m|0,f[2]=f[2]+h|0,f[3]=f[3]+g|0,f[4]=f[4]+A|0},"_doProcessBlock"),_doFinalize:s(function(){var l=this._data,u=l.words,f=this._nDataBytes*8,p=l.sigBytes*8;return u[p>>>5]|=128<<24-p%32,u[(p+64>>>9<<4)+14]=Math.floor(f/4294967296),u[(p+64>>>9<<4)+15]=f,l.sigBytes=u.length*4,this._process(),this._hash},"_doFinalize"),clone:s(function(){var l=i.clone.call(this);return l._hash=this._hash.clone(),l},"clone")});e.SHA1=i._createHelper(c),e.HmacSHA1=i._createHmacHelper(c)}(),t.SHA1})});var zW=H((VW,LBe)=>{d();(function(t,e){typeof VW=="object"?LBe.exports=VW=e(so()):typeof define=="function"&&define.amd?define(["./core"],e):e(t.CryptoJS)})(VW,function(t){return function(e){var r=t,n=r.lib,i=n.WordArray,o=n.Hasher,a=r.algo,c=[],l=[];(function(){function p(A){for(var y=e.sqrt(A),E=2;E<=y;E++)if(!(A%E))return!1;return!0}s(p,"isPrime");function m(A){return(A-(A|0))*4294967296|0}s(m,"getFractionalBits");for(var h=2,g=0;g<64;)p(h)&&(g<8&&(c[g]=m(e.pow(h,1/2))),l[g]=m(e.pow(h,1/3)),g++),h++})();var u=[],f=a.SHA256=o.extend({_doReset:s(function(){this._hash=new i.init(c.slice(0))},"_doReset"),_doProcessBlock:s(function(p,m){for(var h=this._hash.words,g=h[0],A=h[1],y=h[2],E=h[3],b=h[4],S=h[5],R=h[6],B=h[7],L=0;L<64;L++){if(L<16)u[L]=p[m+L]|0;else{var O=u[L-15],Y=(O<<25|O>>>7)^(O<<14|O>>>18)^O>>>3,V=u[L-2],z=(V<<15|V>>>17)^(V<<13|V>>>19)^V>>>10;u[L]=Y+u[L-7]+z+u[L-16]}var Q=b&S^~b&R,U=g&A^g&y^A&y,Z=(g<<30|g>>>2)^(g<<19|g>>>13)^(g<<10|g>>>22),J=(b<<26|b>>>6)^(b<<21|b>>>11)^(b<<7|b>>>25),j=B+J+Q+l[L]+u[L],W=Z+U;B=R,R=S,S=b,b=E+j|0,E=y,y=A,A=g,g=j+W|0}h[0]=h[0]+g|0,h[1]=h[1]+A|0,h[2]=h[2]+y|0,h[3]=h[3]+E|0,h[4]=h[4]+b|0,h[5]=h[5]+S|0,h[6]=h[6]+R|0,h[7]=h[7]+B|0},"_doProcessBlock"),_doFinalize:s(function(){var p=this._data,m=p.words,h=this._nDataBytes*8,g=p.sigBytes*8;return m[g>>>5]|=128<<24-g%32,m[(g+64>>>9<<4)+14]=e.floor(h/4294967296),m[(g+64>>>9<<4)+15]=h,p.sigBytes=m.length*4,this._process(),this._hash},"_doFinalize"),clone:s(function(){var p=o.clone.call(this);return p._hash=this._hash.clone(),p},"clone")});r.SHA256=o._createHelper(f),r.HmacSHA256=o._createHmacHelper(f)}(Math),t.SHA256})});var OBe=H((KW,FBe)=>{d();(function(t,e,r){typeof KW=="object"?FBe.exports=KW=e(so(),zW()):typeof define=="function"&&define.amd?define(["./core","./sha256"],e):e(t.CryptoJS)})(KW,function(t){return function(){var e=t,r=e.lib,n=r.WordArray,i=e.algo,o=i.SHA256,a=i.SHA224=o.extend({_doReset:s(function(){this._hash=new n.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])},"_doReset"),_doFinalize:s(function(){var c=o._doFinalize.call(this);return c.sigBytes-=4,c},"_doFinalize")});e.SHA224=o._createHelper(a),e.HmacSHA224=o._createHmacHelper(a)}(),t.SHA224})});var zfe=H((YW,QBe)=>{d();(function(t,e,r){typeof YW=="object"?QBe.exports=YW=e(so(),QF()):typeof define=="function"&&define.amd?define(["./core","./x64-core"],e):e(t.CryptoJS)})(YW,function(t){return function(){var e=t,r=e.lib,n=r.Hasher,i=e.x64,o=i.Word,a=i.WordArray,c=e.algo;function l(){return o.create.apply(o,arguments)}s(l,"X64Word_create");var u=[l(1116352408,3609767458),l(1899447441,602891725),l(3049323471,3964484399),l(3921009573,2173295548),l(961987163,4081628472),l(1508970993,3053834265),l(2453635748,2937671579),l(2870763221,3664609560),l(3624381080,2734883394),l(310598401,1164996542),l(607225278,1323610764),l(1426881987,3590304994),l(1925078388,4068182383),l(2162078206,991336113),l(2614888103,633803317),l(3248222580,3479774868),l(3835390401,2666613458),l(4022224774,944711139),l(264347078,2341262773),l(604807628,2007800933),l(770255983,1495990901),l(1249150122,1856431235),l(1555081692,3175218132),l(1996064986,2198950837),l(2554220882,3999719339),l(2821834349,766784016),l(2952996808,2566594879),l(3210313671,3203337956),l(3336571891,1034457026),l(3584528711,2466948901),l(113926993,3758326383),l(338241895,168717936),l(666307205,1188179964),l(773529912,1546045734),l(1294757372,1522805485),l(1396182291,2643833823),l(1695183700,2343527390),l(1986661051,1014477480),l(2177026350,1206759142),l(2456956037,344077627),l(2730485921,1290863460),l(2820302411,3158454273),l(3259730800,3505952657),l(3345764771,106217008),l(3516065817,3606008344),l(3600352804,1432725776),l(4094571909,1467031594),l(275423344,851169720),l(430227734,3100823752),l(506948616,1363258195),l(659060556,3750685593),l(883997877,3785050280),l(958139571,3318307427),l(1322822218,3812723403),l(1537002063,2003034995),l(1747873779,3602036899),l(1955562222,1575990012),l(2024104815,1125592928),l(2227730452,2716904306),l(2361852424,442776044),l(2428436474,593698344),l(2756734187,3733110249),l(3204031479,2999351573),l(3329325298,3815920427),l(3391569614,3928383900),l(3515267271,566280711),l(3940187606,3454069534),l(4118630271,4000239992),l(116418474,1914138554),l(174292421,2731055270),l(289380356,3203993006),l(460393269,320620315),l(685471733,587496836),l(852142971,1086792851),l(1017036298,365543100),l(1126000580,2618297676),l(1288033470,3409855158),l(1501505948,4234509866),l(1607167915,987167468),l(1816402316,1246189591)],f=[];(function(){for(var m=0;m<80;m++)f[m]=l()})();var p=c.SHA512=n.extend({_doReset:s(function(){this._hash=new a.init([new o.init(1779033703,4089235720),new o.init(3144134277,2227873595),new o.init(1013904242,4271175723),new o.init(2773480762,1595750129),new o.init(1359893119,2917565137),new o.init(2600822924,725511199),new o.init(528734635,4215389547),new o.init(1541459225,327033209)])},"_doReset"),_doProcessBlock:s(function(m,h){for(var g=this._hash.words,A=g[0],y=g[1],E=g[2],b=g[3],S=g[4],R=g[5],B=g[6],L=g[7],O=A.high,Y=A.low,V=y.high,z=y.low,Q=E.high,U=E.low,Z=b.high,J=b.low,j=S.high,W=S.low,X=R.high,oe=R.low,te=B.high,re=B.low,pe=L.high,Ae=L.low,Oe=O,Te=Y,Je=V,Fe=z,lt=Q,_t=U,xt=Z,gt=J,ue=j,Ue=W,ye=X,$e=oe,ae=te,le=re,qe=pe,Ne=Ae,Ee=0;Ee<80;Ee++){var je,tt,mt=f[Ee];if(Ee<16)tt=mt.high=m[h+Ee*2]|0,je=mt.low=m[h+Ee*2+1]|0;else{var Ft=f[Ee-15],Jt=Ft.high,Qt=Ft.low,zr=(Jt>>>1|Qt<<31)^(Jt>>>8|Qt<<24)^Jt>>>7,Br=(Qt>>>1|Jt<<31)^(Qt>>>8|Jt<<24)^(Qt>>>7|Jt<<25),un=f[Ee-2],ve=un.high,Ge=un.low,pt=(ve>>>19|Ge<<13)^(ve<<3|Ge>>>29)^ve>>>6,Tt=(Ge>>>19|ve<<13)^(Ge<<3|ve>>>29)^(Ge>>>6|ve<<26),or=f[Ee-7],Zt=or.high,Tr=or.low,fr=f[Ee-16],rr=fr.high,ur=fr.low;je=Br+Tr,tt=zr+Zt+(je>>>0<Br>>>0?1:0),je=je+Tt,tt=tt+pt+(je>>>0<Tt>>>0?1:0),je=je+ur,tt=tt+rr+(je>>>0<ur>>>0?1:0),mt.high=tt,mt.low=je}var nr=ue&ye^~ue&ae,Mr=Ue&$e^~Ue&le,Kr=Oe&Je^Oe&lt^Je&lt,sn=Te&Fe^Te&_t^Fe&_t,Cn=(Oe>>>28|Te<<4)^(Oe<<30|Te>>>2)^(Oe<<25|Te>>>7),ii=(Te>>>28|Oe<<4)^(Te<<30|Oe>>>2)^(Te<<25|Oe>>>7),Rn=(ue>>>14|Ue<<18)^(ue>>>18|Ue<<14)^(ue<<23|Ue>>>9),ti=(Ue>>>14|ue<<18)^(Ue>>>18|ue<<14)^(Ue<<23|ue>>>9),an=u[Ee],Jn=an.high,Pe=an.low,K=Ne+ti,Ce=qe+Rn+(K>>>0<Ne>>>0?1:0),K=K+Mr,Ce=Ce+nr+(K>>>0<Mr>>>0?1:0),K=K+Pe,Ce=Ce+Jn+(K>>>0<Pe>>>0?1:0),K=K+je,Ce=Ce+tt+(K>>>0<je>>>0?1:0),Ie=ii+sn,F=Cn+Kr+(Ie>>>0<ii>>>0?1:0);qe=ae,Ne=le,ae=ye,le=$e,ye=ue,$e=Ue,Ue=gt+K|0,ue=xt+Ce+(Ue>>>0<gt>>>0?1:0)|0,xt=lt,gt=_t,lt=Je,_t=Fe,Je=Oe,Fe=Te,Te=K+Ie|0,Oe=Ce+F+(Te>>>0<K>>>0?1:0)|0}Y=A.low=Y+Te,A.high=O+Oe+(Y>>>0<Te>>>0?1:0),z=y.low=z+Fe,y.high=V+Je+(z>>>0<Fe>>>0?1:0),U=E.low=U+_t,E.high=Q+lt+(U>>>0<_t>>>0?1:0),J=b.low=J+gt,b.high=Z+xt+(J>>>0<gt>>>0?1:0),W=S.low=W+Ue,S.high=j+ue+(W>>>0<Ue>>>0?1:0),oe=R.low=oe+$e,R.high=X+ye+(oe>>>0<$e>>>0?1:0),re=B.low=re+le,B.high=te+ae+(re>>>0<le>>>0?1:0),Ae=L.low=Ae+Ne,L.high=pe+qe+(Ae>>>0<Ne>>>0?1:0)},"_doProcessBlock"),_doFinalize:s(function(){var m=this._data,h=m.words,g=this._nDataBytes*8,A=m.sigBytes*8;h[A>>>5]|=128<<24-A%32,h[(A+128>>>10<<5)+30]=Math.floor(g/4294967296),h[(A+128>>>10<<5)+31]=g,m.sigBytes=h.length*4,this._process();var y=this._hash.toX32();return y},"_doFinalize"),clone:s(function(){var m=n.clone.call(this);return m._hash=this._hash.clone(),m},"clone"),blockSize:1024/32});e.SHA512=n._createHelper(p),e.HmacSHA512=n._createHmacHelper(p)}(),t.SHA512})});var qBe=H((JW,UBe)=>{d();(function(t,e,r){typeof JW=="object"?UBe.exports=JW=e(so(),QF(),zfe()):typeof define=="function"&&define.amd?define(["./core","./x64-core","./sha512"],e):e(t.CryptoJS)})(JW,function(t){return function(){var e=t,r=e.x64,n=r.Word,i=r.WordArray,o=e.algo,a=o.SHA512,c=o.SHA384=a.extend({_doReset:s(function(){this._hash=new i.init([new n.init(3418070365,3238371032),new n.init(1654270250,914150663),new n.init(2438529370,812702999),new n.init(355462360,4144912697),new n.init(1731405415,4290775857),new n.init(2394180231,1750603025),new n.init(3675008525,1694076839),new n.init(1203062813,3204075428)])},"_doReset"),_doFinalize:s(function(){var l=a._doFinalize.call(this);return l.sigBytes-=16,l},"_doFinalize")});e.SHA384=a._createHelper(c),e.HmacSHA384=a._createHmacHelper(c)}(),t.SHA384})});var $Be=H((XW,HBe)=>{d();(function(t,e,r){typeof XW=="object"?HBe.exports=XW=e(so(),QF()):typeof define=="function"&&define.amd?define(["./core","./x64-core"],e):e(t.CryptoJS)})(XW,function(t){return function(e){var r=t,n=r.lib,i=n.WordArray,o=n.Hasher,a=r.x64,c=a.Word,l=r.algo,u=[],f=[],p=[];(function(){for(var g=1,A=0,y=0;y<24;y++){u[g+5*A]=(y+1)*(y+2)/2%64;var E=A%5,b=(2*g+3*A)%5;g=E,A=b}for(var g=0;g<5;g++)for(var A=0;A<5;A++)f[g+5*A]=A+(2*g+3*A)%5*5;for(var S=1,R=0;R<24;R++){for(var B=0,L=0,O=0;O<7;O++){if(S&1){var Y=(1<<O)-1;Y<32?L^=1<<Y:B^=1<<Y-32}S&128?S=S<<1^113:S<<=1}p[R]=c.create(B,L)}})();var m=[];(function(){for(var g=0;g<25;g++)m[g]=c.create()})();var h=l.SHA3=o.extend({cfg:o.cfg.extend({outputLength:512}),_doReset:s(function(){for(var g=this._state=[],A=0;A<25;A++)g[A]=new c.init;this.blockSize=(1600-2*this.cfg.outputLength)/32},"_doReset"),_doProcessBlock:s(function(g,A){for(var y=this._state,E=this.blockSize/2,b=0;b<E;b++){var S=g[A+2*b],R=g[A+2*b+1];S=(S<<8|S>>>24)&16711935|(S<<24|S>>>8)&4278255360,R=(R<<8|R>>>24)&16711935|(R<<24|R>>>8)&4278255360;var B=y[b];B.high^=R,B.low^=S}for(var L=0;L<24;L++){for(var O=0;O<5;O++){for(var Y=0,V=0,z=0;z<5;z++){var B=y[O+5*z];Y^=B.high,V^=B.low}var Q=m[O];Q.high=Y,Q.low=V}for(var O=0;O<5;O++)for(var U=m[(O+4)%5],Z=m[(O+1)%5],J=Z.high,j=Z.low,Y=U.high^(J<<1|j>>>31),V=U.low^(j<<1|J>>>31),z=0;z<5;z++){var B=y[O+5*z];B.high^=Y,B.low^=V}for(var W=1;W<25;W++){var Y,V,B=y[W],X=B.high,oe=B.low,te=u[W];te<32?(Y=X<<te|oe>>>32-te,V=oe<<te|X>>>32-te):(Y=oe<<te-32|X>>>64-te,V=X<<te-32|oe>>>64-te);var re=m[f[W]];re.high=Y,re.low=V}var pe=m[0],Ae=y[0];pe.high=Ae.high,pe.low=Ae.low;for(var O=0;O<5;O++)for(var z=0;z<5;z++){var W=O+5*z,B=y[W],Oe=m[W],Te=m[(O+1)%5+5*z],Je=m[(O+2)%5+5*z];B.high=Oe.high^~Te.high&Je.high,B.low=Oe.low^~Te.low&Je.low}var B=y[0],Fe=p[L];B.high^=Fe.high,B.low^=Fe.low}},"_doProcessBlock"),_doFinalize:s(function(){var g=this._data,A=g.words,y=this._nDataBytes*8,E=g.sigBytes*8,b=this.blockSize*32;A[E>>>5]|=1<<24-E%32,A[(e.ceil((E+1)/b)*b>>>5)-1]|=128,g.sigBytes=A.length*4,this._process();for(var S=this._state,R=this.cfg.outputLength/8,B=R/8,L=[],O=0;O<B;O++){var Y=S[O],V=Y.high,z=Y.low;V=(V<<8|V>>>24)&16711935|(V<<24|V>>>8)&4278255360,z=(z<<8|z>>>24)&16711935|(z<<24|z>>>8)&4278255360,L.push(z),L.push(V)}return new i.init(L,R)},"_doFinalize"),clone:s(function(){for(var g=o.clone.call(this),A=g._state=this._state.slice(0),y=0;y<25;y++)A[y]=A[y].clone();return g},"clone")});r.SHA3=o._createHelper(h),r.HmacSHA3=o._createHmacHelper(h)}(Math),t.SHA3})});var jBe=H((ZW,WBe)=>{d();(function(t,e){typeof ZW=="object"?WBe.exports=ZW=e(so()):typeof define=="function"&&define.amd?define(["./core"],e):e(t.CryptoJS)})(ZW,function(t){return function(e){var r=t,n=r.lib,i=n.WordArray,o=n.Hasher,a=r.algo,c=i.create([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),l=i.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),u=i.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),f=i.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),p=i.create([0,1518500249,1859775393,2400959708,2840853838]),m=i.create([1352829926,1548603684,1836072691,2053994217,0]),h=a.RIPEMD160=o.extend({_doReset:s(function(){this._hash=i.create([1732584193,4023233417,2562383102,271733878,3285377520])},"_doReset"),_doProcessBlock:s(function(R,B){for(var L=0;L<16;L++){var O=B+L,Y=R[O];R[O]=(Y<<8|Y>>>24)&16711935|(Y<<24|Y>>>8)&4278255360}var V=this._hash.words,z=p.words,Q=m.words,U=c.words,Z=l.words,J=u.words,j=f.words,W,X,oe,te,re,pe,Ae,Oe,Te,Je;pe=W=V[0],Ae=X=V[1],Oe=oe=V[2],Te=te=V[3],Je=re=V[4];for(var Fe,L=0;L<80;L+=1)Fe=W+R[B+U[L]]|0,L<16?Fe+=g(X,oe,te)+z[0]:L<32?Fe+=A(X,oe,te)+z[1]:L<48?Fe+=y(X,oe,te)+z[2]:L<64?Fe+=E(X,oe,te)+z[3]:Fe+=b(X,oe,te)+z[4],Fe=Fe|0,Fe=S(Fe,J[L]),Fe=Fe+re|0,W=re,re=te,te=S(oe,10),oe=X,X=Fe,Fe=pe+R[B+Z[L]]|0,L<16?Fe+=b(Ae,Oe,Te)+Q[0]:L<32?Fe+=E(Ae,Oe,Te)+Q[1]:L<48?Fe+=y(Ae,Oe,Te)+Q[2]:L<64?Fe+=A(Ae,Oe,Te)+Q[3]:Fe+=g(Ae,Oe,Te)+Q[4],Fe=Fe|0,Fe=S(Fe,j[L]),Fe=Fe+Je|0,pe=Je,Je=Te,Te=S(Oe,10),Oe=Ae,Ae=Fe;Fe=V[1]+oe+Te|0,V[1]=V[2]+te+Je|0,V[2]=V[3]+re+pe|0,V[3]=V[4]+W+Ae|0,V[4]=V[0]+X+Oe|0,V[0]=Fe},"_doProcessBlock"),_doFinalize:s(function(){var R=this._data,B=R.words,L=this._nDataBytes*8,O=R.sigBytes*8;B[O>>>5]|=128<<24-O%32,B[(O+64>>>9<<4)+14]=(L<<8|L>>>24)&16711935|(L<<24|L>>>8)&4278255360,R.sigBytes=(B.length+1)*4,this._process();for(var Y=this._hash,V=Y.words,z=0;z<5;z++){var Q=V[z];V[z]=(Q<<8|Q>>>24)&16711935|(Q<<24|Q>>>8)&4278255360}return Y},"_doFinalize"),clone:s(function(){var R=o.clone.call(this);return R._hash=this._hash.clone(),R},"clone")});function g(R,B,L){return R^B^L}s(g,"f1");function A(R,B,L){return R&B|~R&L}s(A,"f2");function y(R,B,L){return(R|~B)^L}s(y,"f3");function E(R,B,L){return R&L|B&~L}s(E,"f4");function b(R,B,L){return R^(B|~L)}s(b,"f5");function S(R,B){return R<<B|R>>>32-B}s(S,"rotl"),r.RIPEMD160=o._createHelper(h),r.HmacRIPEMD160=o._createHmacHelper(h)}(Math),t.RIPEMD160})});var tj=H((ej,GBe)=>{d();(function(t,e){typeof ej=="object"?GBe.exports=ej=e(so()):typeof define=="function"&&define.amd?define(["./core"],e):e(t.CryptoJS)})(ej,function(t){(function(){var e=t,r=e.lib,n=r.Base,i=e.enc,o=i.Utf8,a=e.algo,c=a.HMAC=n.extend({init:s(function(l,u){l=this._hasher=new l.init,typeof u=="string"&&(u=o.parse(u));var f=l.blockSize,p=f*4;u.sigBytes>p&&(u=l.finalize(u)),u.clamp();for(var m=this._oKey=u.clone(),h=this._iKey=u.clone(),g=m.words,A=h.words,y=0;y<f;y++)g[y]^=1549556828,A[y]^=909522486;m.sigBytes=h.sigBytes=p,this.reset()},"init"),reset:s(function(){var l=this._hasher;l.reset(),l.update(this._iKey)},"reset"),update:s(function(l){return this._hasher.update(l),this},"update"),finalize:s(function(l){var u=this._hasher,f=u.finalize(l);u.reset();var p=u.finalize(this._oKey.clone().concat(f));return p},"finalize")})})()})});var zBe=H((rj,VBe)=>{d();(function(t,e,r){typeof rj=="object"?VBe.exports=rj=e(so(),zW(),tj()):typeof define=="function"&&define.amd?define(["./core","./sha256","./hmac"],e):e(t.CryptoJS)})(rj,function(t){return function(){var e=t,r=e.lib,n=r.Base,i=r.WordArray,o=e.algo,a=o.SHA256,c=o.HMAC,l=o.PBKDF2=n.extend({cfg:n.extend({keySize:128/32,hasher:a,iterations:25e4}),init:s(function(u){this.cfg=this.cfg.extend(u)},"init"),compute:s(function(u,f){for(var p=this.cfg,m=c.create(p.hasher,u),h=i.create(),g=i.create([1]),A=h.words,y=g.words,E=p.keySize,b=p.iterations;A.length<E;){var S=m.update(f).finalize(g);m.reset();for(var R=S.words,B=R.length,L=S,O=1;O<b;O++){L=m.finalize(L),m.reset();for(var Y=L.words,V=0;V<B;V++)R[V]^=Y[V]}h.concat(S),y[0]++}return h.sigBytes=E*4,h},"compute")});e.PBKDF2=function(u,f,p){return l.create(p).compute(u,f)}}(),t.PBKDF2})});var Dv=H((nj,KBe)=>{d();(function(t,e,r){typeof nj=="object"?KBe.exports=nj=e(so(),Vfe(),tj()):typeof define=="function"&&define.amd?define(["./core","./sha1","./hmac"],e):e(t.CryptoJS)})(nj,function(t){return function(){var e=t,r=e.lib,n=r.Base,i=r.WordArray,o=e.algo,a=o.MD5,c=o.EvpKDF=n.extend({cfg:n.extend({keySize:128/32,hasher:a,iterations:1}),init:s(function(l){this.cfg=this.cfg.extend(l)},"init"),compute:s(function(l,u){for(var f,p=this.cfg,m=p.hasher.create(),h=i.create(),g=h.words,A=p.keySize,y=p.iterations;g.length<A;){f&&m.update(f),f=m.update(l).finalize(u),m.reset();for(var E=1;E<y;E++)f=m.finalize(f),m.reset();h.concat(f)}return h.sigBytes=A*4,h},"compute")});e.EvpKDF=function(l,u,f){return c.create(f).compute(l,u)}}(),t.EvpKDF})});var Rl=H((ij,YBe)=>{d();(function(t,e,r){typeof ij=="object"?YBe.exports=ij=e(so(),Dv()):typeof define=="function"&&define.amd?define(["./core","./evpkdf"],e):e(t.CryptoJS)})(ij,function(t){t.lib.Cipher||function(e){var r=t,n=r.lib,i=n.Base,o=n.WordArray,a=n.BufferedBlockAlgorithm,c=r.enc,l=c.Utf8,u=c.Base64,f=r.algo,p=f.EvpKDF,m=n.Cipher=a.extend({cfg:i.extend(),createEncryptor:s(function(Q,U){return this.create(this._ENC_XFORM_MODE,Q,U)},"createEncryptor"),createDecryptor:s(function(Q,U){return this.create(this._DEC_XFORM_MODE,Q,U)},"createDecryptor"),init:s(function(Q,U,Z){this.cfg=this.cfg.extend(Z),this._xformMode=Q,this._key=U,this.reset()},"init"),reset:s(function(){a.reset.call(this),this._doReset()},"reset"),process:s(function(Q){return this._append(Q),this._process()},"process"),finalize:s(function(Q){Q&&this._append(Q);var U=this._doFinalize();return U},"finalize"),keySize:128/32,ivSize:128/32,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(){function Q(U){return typeof U=="string"?z:O}return s(Q,"selectCipherStrategy"),function(U){return{encrypt:s(function(Z,J,j){return Q(J).encrypt(U,Z,J,j)},"encrypt"),decrypt:s(function(Z,J,j){return Q(J).decrypt(U,Z,J,j)},"decrypt")}}}()}),h=n.StreamCipher=m.extend({_doFinalize:s(function(){var Q=this._process(!0);return Q},"_doFinalize"),blockSize:1}),g=r.mode={},A=n.BlockCipherMode=i.extend({createEncryptor:s(function(Q,U){return this.Encryptor.create(Q,U)},"createEncryptor"),createDecryptor:s(function(Q,U){return this.Decryptor.create(Q,U)},"createDecryptor"),init:s(function(Q,U){this._cipher=Q,this._iv=U},"init")}),y=g.CBC=function(){var Q=A.extend();Q.Encryptor=Q.extend({processBlock:s(function(Z,J){var j=this._cipher,W=j.blockSize;U.call(this,Z,J,W),j.encryptBlock(Z,J),this._prevBlock=Z.slice(J,J+W)},"processBlock")}),Q.Decryptor=Q.extend({processBlock:s(function(Z,J){var j=this._cipher,W=j.blockSize,X=Z.slice(J,J+W);j.decryptBlock(Z,J),U.call(this,Z,J,W),this._prevBlock=X},"processBlock")});function U(Z,J,j){var W,X=this._iv;X?(W=X,this._iv=e):W=this._prevBlock;for(var oe=0;oe<j;oe++)Z[J+oe]^=W[oe]}return s(U,"xorBlock"),Q}(),E=r.pad={},b=E.Pkcs7={pad:s(function(Q,U){for(var Z=U*4,J=Z-Q.sigBytes%Z,j=J<<24|J<<16|J<<8|J,W=[],X=0;X<J;X+=4)W.push(j);var oe=o.create(W,J);Q.concat(oe)},"pad"),unpad:s(function(Q){var U=Q.words[Q.sigBytes-1>>>2]&255;Q.sigBytes-=U},"unpad")},S=n.BlockCipher=m.extend({cfg:m.cfg.extend({mode:y,padding:b}),reset:s(function(){var Q;m.reset.call(this);var U=this.cfg,Z=U.iv,J=U.mode;this._xformMode==this._ENC_XFORM_MODE?Q=J.createEncryptor:(Q=J.createDecryptor,this._minBufferSize=1),this._mode&&this._mode.__creator==Q?this._mode.init(this,Z&&Z.words):(this._mode=Q.call(J,this,Z&&Z.words),this._mode.__creator=Q)},"reset"),_doProcessBlock:s(function(Q,U){this._mode.processBlock(Q,U)},"_doProcessBlock"),_doFinalize:s(function(){var Q,U=this.cfg.padding;return this._xformMode==this._ENC_XFORM_MODE?(U.pad(this._data,this.blockSize),Q=this._process(!0)):(Q=this._process(!0),U.unpad(Q)),Q},"_doFinalize"),blockSize:128/32}),R=n.CipherParams=i.extend({init:s(function(Q){this.mixIn(Q)},"init"),toString:s(function(Q){return(Q||this.formatter).stringify(this)},"toString")}),B=r.format={},L=B.OpenSSL={stringify:s(function(Q){var U,Z=Q.ciphertext,J=Q.salt;return J?U=o.create([1398893684,1701076831]).concat(J).concat(Z):U=Z,U.toString(u)},"stringify"),parse:s(function(Q){var U,Z=u.parse(Q),J=Z.words;return J[0]==1398893684&&J[1]==1701076831&&(U=o.create(J.slice(2,4)),J.splice(0,4),Z.sigBytes-=16),R.create({ciphertext:Z,salt:U})},"parse")},O=n.SerializableCipher=i.extend({cfg:i.extend({format:L}),encrypt:s(function(Q,U,Z,J){J=this.cfg.extend(J);var j=Q.createEncryptor(Z,J),W=j.finalize(U),X=j.cfg;return R.create({ciphertext:W,key:Z,iv:X.iv,algorithm:Q,mode:X.mode,padding:X.padding,blockSize:Q.blockSize,formatter:J.format})},"encrypt"),decrypt:s(function(Q,U,Z,J){J=this.cfg.extend(J),U=this._parse(U,J.format);var j=Q.createDecryptor(Z,J).finalize(U.ciphertext);return j},"decrypt"),_parse:s(function(Q,U){return typeof Q=="string"?U.parse(Q,this):Q},"_parse")}),Y=r.kdf={},V=Y.OpenSSL={execute:s(function(Q,U,Z,J,j){if(J||(J=o.random(64/8)),j)var W=p.create({keySize:U+Z,hasher:j}).compute(Q,J);else var W=p.create({keySize:U+Z}).compute(Q,J);var X=o.create(W.words.slice(U),Z*4);return W.sigBytes=U*4,R.create({key:W,iv:X,salt:J})},"execute")},z=n.PasswordBasedCipher=O.extend({cfg:O.cfg.extend({kdf:V}),encrypt:s(function(Q,U,Z,J){J=this.cfg.extend(J);var j=J.kdf.execute(Z,Q.keySize,Q.ivSize,J.salt,J.hasher);J.iv=j.iv;var W=O.encrypt.call(this,Q,U,j.key,J);return W.mixIn(j),W},"encrypt"),decrypt:s(function(Q,U,Z,J){J=this.cfg.extend(J),U=this._parse(U,J.format);var j=J.kdf.execute(Z,Q.keySize,Q.ivSize,U.salt,J.hasher);J.iv=j.iv;var W=O.decrypt.call(this,Q,U,j.key,J);return W},"decrypt")})}()})});var XBe=H((oj,JBe)=>{d();(function(t,e,r){typeof oj=="object"?JBe.exports=oj=e(so(),Rl()):typeof define=="function"&&define.amd?define(["./core","./cipher-core"],e):e(t.CryptoJS)})(oj,function(t){return t.mode.CFB=function(){var e=t.lib.BlockCipherMode.extend();e.Encryptor=e.extend({processBlock:s(function(n,i){var o=this._cipher,a=o.blockSize;r.call(this,n,i,a,o),this._prevBlock=n.slice(i,i+a)},"processBlock")}),e.Decryptor=e.extend({processBlock:s(function(n,i){var o=this._cipher,a=o.blockSize,c=n.slice(i,i+a);r.call(this,n,i,a,o),this._prevBlock=c},"processBlock")});function r(n,i,o,a){var c,l=this._iv;l?(c=l.slice(0),this._iv=void 0):c=this._prevBlock,a.encryptBlock(c,0);for(var u=0;u<o;u++)n[i+u]^=c[u]}return s(r,"generateKeystreamAndEncrypt"),e}(),t.mode.CFB})});var e3e=H((sj,ZBe)=>{d();(function(t,e,r){typeof sj=="object"?ZBe.exports=sj=e(so(),Rl()):typeof define=="function"&&define.amd?define(["./core","./cipher-core"],e):e(t.CryptoJS)})(sj,function(t){return t.mode.CTR=function(){var e=t.lib.BlockCipherMode.extend(),r=e.Encryptor=e.extend({processBlock:s(function(n,i){var o=this._cipher,a=o.blockSize,c=this._iv,l=this._counter;c&&(l=this._counter=c.slice(0),this._iv=void 0);var u=l.slice(0);o.encryptBlock(u,0),l[a-1]=l[a-1]+1|0;for(var f=0;f<a;f++)n[i+f]^=u[f]},"processBlock")});return e.Decryptor=r,e}(),t.mode.CTR})});var r3e=H((aj,t3e)=>{d();(function(t,e,r){typeof aj=="object"?t3e.exports=aj=e(so(),Rl()):typeof define=="function"&&define.amd?define(["./core","./cipher-core"],e):e(t.CryptoJS)})(aj,function(t){return t.mode.CTRGladman=function(){var e=t.lib.BlockCipherMode.extend();function r(o){if((o>>24&255)===255){var a=o>>16&255,c=o>>8&255,l=o&255;a===255?(a=0,c===255?(c=0,l===255?l=0:++l):++c):++a,o=0,o+=a<<16,o+=c<<8,o+=l}else o+=1<<24;return o}s(r,"incWord");function n(o){return(o[0]=r(o[0]))===0&&(o[1]=r(o[1])),o}s(n,"incCounter");var i=e.Encryptor=e.extend({processBlock:s(function(o,a){var c=this._cipher,l=c.blockSize,u=this._iv,f=this._counter;u&&(f=this._counter=u.slice(0),this._iv=void 0),n(f);var p=f.slice(0);c.encryptBlock(p,0);for(var m=0;m<l;m++)o[a+m]^=p[m]},"processBlock")});return e.Decryptor=i,e}(),t.mode.CTRGladman})});var i3e=H((cj,n3e)=>{d();(function(t,e,r){typeof cj=="object"?n3e.exports=cj=e(so(),Rl()):typeof define=="function"&&define.amd?define(["./core","./cipher-core"],e):e(t.CryptoJS)})(cj,function(t){return t.mode.OFB=function(){var e=t.lib.BlockCipherMode.extend(),r=e.Encryptor=e.extend({processBlock:s(function(n,i){var o=this._cipher,a=o.blockSize,c=this._iv,l=this._keystream;c&&(l=this._keystream=c.slice(0),this._iv=void 0),o.encryptBlock(l,0);for(var u=0;u<a;u++)n[i+u]^=l[u]},"processBlock")});return e.Decryptor=r,e}(),t.mode.OFB})});var s3e=H((lj,o3e)=>{d();(function(t,e,r){typeof lj=="object"?o3e.exports=lj=e(so(),Rl()):typeof define=="function"&&define.amd?define(["./core","./cipher-core"],e):e(t.CryptoJS)})(lj,function(t){return t.mode.ECB=function(){var e=t.lib.BlockCipherMode.extend();return e.Encryptor=e.extend({processBlock:s(function(r,n){this._cipher.encryptBlock(r,n)},"processBlock")}),e.Decryptor=e.extend({processBlock:s(function(r,n){this._cipher.decryptBlock(r,n)},"processBlock")}),e}(),t.mode.ECB})});var c3e=H((uj,a3e)=>{d();(function(t,e,r){typeof uj=="object"?a3e.exports=uj=e(so(),Rl()):typeof define=="function"&&define.amd?define(["./core","./cipher-core"],e):e(t.CryptoJS)})(uj,function(t){return t.pad.AnsiX923={pad:s(function(e,r){var n=e.sigBytes,i=r*4,o=i-n%i,a=n+o-1;e.clamp(),e.words[a>>>2]|=o<<24-a%4*8,e.sigBytes+=o},"pad"),unpad:s(function(e){var r=e.words[e.sigBytes-1>>>2]&255;e.sigBytes-=r},"unpad")},t.pad.Ansix923})});var u3e=H((dj,l3e)=>{d();(function(t,e,r){typeof dj=="object"?l3e.exports=dj=e(so(),Rl()):typeof define=="function"&&define.amd?define(["./core","./cipher-core"],e):e(t.CryptoJS)})(dj,function(t){return t.pad.Iso10126={pad:s(function(e,r){var n=r*4,i=n-e.sigBytes%n;e.concat(t.lib.WordArray.random(i-1)).concat(t.lib.WordArray.create([i<<24],1))},"pad"),unpad:s(function(e){var r=e.words[e.sigBytes-1>>>2]&255;e.sigBytes-=r},"unpad")},t.pad.Iso10126})});var f3e=H((fj,d3e)=>{d();(function(t,e,r){typeof fj=="object"?d3e.exports=fj=e(so(),Rl()):typeof define=="function"&&define.amd?define(["./core","./cipher-core"],e):e(t.CryptoJS)})(fj,function(t){return t.pad.Iso97971={pad:s(function(e,r){e.concat(t.lib.WordArray.create([2147483648],1)),t.pad.ZeroPadding.pad(e,r)},"pad"),unpad:s(function(e){t.pad.ZeroPadding.unpad(e),e.sigBytes--},"unpad")},t.pad.Iso97971})});var m3e=H((pj,p3e)=>{d();(function(t,e,r){typeof pj=="object"?p3e.exports=pj=e(so(),Rl()):typeof define=="function"&&define.amd?define(["./core","./cipher-core"],e):e(t.CryptoJS)})(pj,function(t){return t.pad.ZeroPadding={pad:s(function(e,r){var n=r*4;e.clamp(),e.sigBytes+=n-(e.sigBytes%n||n)},"pad"),unpad:s(function(e){for(var r=e.words,n=e.sigBytes-1,n=e.sigBytes-1;n>=0;n--)if(r[n>>>2]>>>24-n%4*8&255){e.sigBytes=n+1;break}},"unpad")},t.pad.ZeroPadding})});var g3e=H((mj,h3e)=>{d();(function(t,e,r){typeof mj=="object"?h3e.exports=mj=e(so(),Rl()):typeof define=="function"&&define.amd?define(["./core","./cipher-core"],e):e(t.CryptoJS)})(mj,function(t){return t.pad.NoPadding={pad:s(function(){},"pad"),unpad:s(function(){},"unpad")},t.pad.NoPadding})});var y3e=H((hj,A3e)=>{d();(function(t,e,r){typeof hj=="object"?A3e.exports=hj=e(so(),Rl()):typeof define=="function"&&define.amd?define(["./core","./cipher-core"],e):e(t.CryptoJS)})(hj,function(t){return function(e){var r=t,n=r.lib,i=n.CipherParams,o=r.enc,a=o.Hex,c=r.format,l=c.Hex={stringify:s(function(u){return u.ciphertext.toString(a)},"stringify"),parse:s(function(u){var f=a.parse(u);return i.create({ciphertext:f})},"parse")}}(),t.format.Hex})});var v3e=H((gj,C3e)=>{d();(function(t,e,r){typeof gj=="object"?C3e.exports=gj=e(so(),gI(),AI(),Dv(),Rl()):typeof define=="function"&&define.amd?define(["./core","./enc-base64","./md5","./evpkdf","./cipher-core"],e):e(t.CryptoJS)})(gj,function(t){return function(){var e=t,r=e.lib,n=r.BlockCipher,i=e.algo,o=[],a=[],c=[],l=[],u=[],f=[],p=[],m=[],h=[],g=[];(function(){for(var E=[],b=0;b<256;b++)b<128?E[b]=b<<1:E[b]=b<<1^283;for(var S=0,R=0,b=0;b<256;b++){var B=R^R<<1^R<<2^R<<3^R<<4;B=B>>>8^B&255^99,o[S]=B,a[B]=S;var L=E[S],O=E[L],Y=E[O],V=E[B]*257^B*16843008;c[S]=V<<24|V>>>8,l[S]=V<<16|V>>>16,u[S]=V<<8|V>>>24,f[S]=V;var V=Y*16843009^O*65537^L*257^S*16843008;p[B]=V<<24|V>>>8,m[B]=V<<16|V>>>16,h[B]=V<<8|V>>>24,g[B]=V,S?(S=L^E[E[E[Y^L]]],R^=E[E[R]]):S=R=1}})();var A=[0,1,2,4,8,16,32,64,128,27,54],y=i.AES=n.extend({_doReset:s(function(){var E;if(!(this._nRounds&&this._keyPriorReset===this._key)){for(var b=this._keyPriorReset=this._key,S=b.words,R=b.sigBytes/4,B=this._nRounds=R+6,L=(B+1)*4,O=this._keySchedule=[],Y=0;Y<L;Y++)Y<R?O[Y]=S[Y]:(E=O[Y-1],Y%R?R>6&&Y%R==4&&(E=o[E>>>24]<<24|o[E>>>16&255]<<16|o[E>>>8&255]<<8|o[E&255]):(E=E<<8|E>>>24,E=o[E>>>24]<<24|o[E>>>16&255]<<16|o[E>>>8&255]<<8|o[E&255],E^=A[Y/R|0]<<24),O[Y]=O[Y-R]^E);for(var V=this._invKeySchedule=[],z=0;z<L;z++){var Y=L-z;if(z%4)var E=O[Y];else var E=O[Y-4];z<4||Y<=4?V[z]=E:V[z]=p[o[E>>>24]]^m[o[E>>>16&255]]^h[o[E>>>8&255]]^g[o[E&255]]}}},"_doReset"),encryptBlock:s(function(E,b){this._doCryptBlock(E,b,this._keySchedule,c,l,u,f,o)},"encryptBlock"),decryptBlock:s(function(E,b){var S=E[b+1];E[b+1]=E[b+3],E[b+3]=S,this._doCryptBlock(E,b,this._invKeySchedule,p,m,h,g,a);var S=E[b+1];E[b+1]=E[b+3],E[b+3]=S},"decryptBlock"),_doCryptBlock:s(function(E,b,S,R,B,L,O,Y){for(var V=this._nRounds,z=E[b]^S[0],Q=E[b+1]^S[1],U=E[b+2]^S[2],Z=E[b+3]^S[3],J=4,j=1;j<V;j++){var W=R[z>>>24]^B[Q>>>16&255]^L[U>>>8&255]^O[Z&255]^S[J++],X=R[Q>>>24]^B[U>>>16&255]^L[Z>>>8&255]^O[z&255]^S[J++],oe=R[U>>>24]^B[Z>>>16&255]^L[z>>>8&255]^O[Q&255]^S[J++],te=R[Z>>>24]^B[z>>>16&255]^L[Q>>>8&255]^O[U&255]^S[J++];z=W,Q=X,U=oe,Z=te}var W=(Y[z>>>24]<<24|Y[Q>>>16&255]<<16|Y[U>>>8&255]<<8|Y[Z&255])^S[J++],X=(Y[Q>>>24]<<24|Y[U>>>16&255]<<16|Y[Z>>>8&255]<<8|Y[z&255])^S[J++],oe=(Y[U>>>24]<<24|Y[Z>>>16&255]<<16|Y[z>>>8&255]<<8|Y[Q&255])^S[J++],te=(Y[Z>>>24]<<24|Y[z>>>16&255]<<16|Y[Q>>>8&255]<<8|Y[U&255])^S[J++];E[b]=W,E[b+1]=X,E[b+2]=oe,E[b+3]=te},"_doCryptBlock"),keySize:256/32});e.AES=n._createHelper(y)}(),t.AES})});var E3e=H((Aj,x3e)=>{d();(function(t,e,r){typeof Aj=="object"?x3e.exports=Aj=e(so(),gI(),AI(),Dv(),Rl()):typeof define=="function"&&define.amd?define(["./core","./enc-base64","./md5","./evpkdf","./cipher-core"],e):e(t.CryptoJS)})(Aj,function(t){return function(){var e=t,r=e.lib,n=r.WordArray,i=r.BlockCipher,o=e.algo,a=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],c=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],l=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],u=[{0:8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{0:1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,369098752:540688,385875968:16384,402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{0:260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{0:2151682048,65536:2147487808,131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{0:128,4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{0:268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{0:1048576,16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{0:134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],f=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679],p=o.DES=i.extend({_doReset:s(function(){for(var A=this._key,y=A.words,E=[],b=0;b<56;b++){var S=a[b]-1;E[b]=y[S>>>5]>>>31-S%32&1}for(var R=this._subKeys=[],B=0;B<16;B++){for(var L=R[B]=[],O=l[B],b=0;b<24;b++)L[b/6|0]|=E[(c[b]-1+O)%28]<<31-b%6,L[4+(b/6|0)]|=E[28+(c[b+24]-1+O)%28]<<31-b%6;L[0]=L[0]<<1|L[0]>>>31;for(var b=1;b<7;b++)L[b]=L[b]>>>(b-1)*4+3;L[7]=L[7]<<5|L[7]>>>27}for(var Y=this._invSubKeys=[],b=0;b<16;b++)Y[b]=R[15-b]},"_doReset"),encryptBlock:s(function(A,y){this._doCryptBlock(A,y,this._subKeys)},"encryptBlock"),decryptBlock:s(function(A,y){this._doCryptBlock(A,y,this._invSubKeys)},"decryptBlock"),_doCryptBlock:s(function(A,y,E){this._lBlock=A[y],this._rBlock=A[y+1],m.call(this,4,252645135),m.call(this,16,65535),h.call(this,2,858993459),h.call(this,8,16711935),m.call(this,1,1431655765);for(var b=0;b<16;b++){for(var S=E[b],R=this._lBlock,B=this._rBlock,L=0,O=0;O<8;O++)L|=u[O][((B^S[O])&f[O])>>>0];this._lBlock=B,this._rBlock=R^L}var Y=this._lBlock;this._lBlock=this._rBlock,this._rBlock=Y,m.call(this,1,1431655765),h.call(this,8,16711935),h.call(this,2,858993459),m.call(this,16,65535),m.call(this,4,252645135),A[y]=this._lBlock,A[y+1]=this._rBlock},"_doCryptBlock"),keySize:64/32,ivSize:64/32,blockSize:64/32});function m(A,y){var E=(this._lBlock>>>A^this._rBlock)&y;this._rBlock^=E,this._lBlock^=E<<A}s(m,"exchangeLR");function h(A,y){var E=(this._rBlock>>>A^this._lBlock)&y;this._lBlock^=E,this._rBlock^=E<<A}s(h,"exchangeRL"),e.DES=i._createHelper(p);var g=o.TripleDES=i.extend({_doReset:s(function(){var A=this._key,y=A.words;if(y.length!==2&&y.length!==4&&y.length<6)throw new Error("Invalid key length - 3DES requires the key length to be 64, 128, 192 or >192.");var E=y.slice(0,2),b=y.length<4?y.slice(0,2):y.slice(2,4),S=y.length<6?y.slice(0,2):y.slice(4,6);this._des1=p.createEncryptor(n.create(E)),this._des2=p.createEncryptor(n.create(b)),this._des3=p.createEncryptor(n.create(S))},"_doReset"),encryptBlock:s(function(A,y){this._des1.encryptBlock(A,y),this._des2.decryptBlock(A,y),this._des3.encryptBlock(A,y)},"encryptBlock"),decryptBlock:s(function(A,y){this._des3.decryptBlock(A,y),this._des2.encryptBlock(A,y),this._des1.decryptBlock(A,y)},"decryptBlock"),keySize:192/32,ivSize:64/32,blockSize:64/32});e.TripleDES=i._createHelper(g)}(),t.TripleDES})});var I3e=H((yj,b3e)=>{d();(function(t,e,r){typeof yj=="object"?b3e.exports=yj=e(so(),gI(),AI(),Dv(),Rl()):typeof define=="function"&&define.amd?define(["./core","./enc-base64","./md5","./evpkdf","./cipher-core"],e):e(t.CryptoJS)})(yj,function(t){return function(){var e=t,r=e.lib,n=r.StreamCipher,i=e.algo,o=i.RC4=n.extend({_doReset:s(function(){for(var l=this._key,u=l.words,f=l.sigBytes,p=this._S=[],m=0;m<256;m++)p[m]=m;for(var m=0,h=0;m<256;m++){var g=m%f,A=u[g>>>2]>>>24-g%4*8&255;h=(h+p[m]+A)%256;var y=p[m];p[m]=p[h],p[h]=y}this._i=this._j=0},"_doReset"),_doProcessBlock:s(function(l,u){l[u]^=a.call(this)},"_doProcessBlock"),keySize:256/32,ivSize:0});function a(){for(var l=this._S,u=this._i,f=this._j,p=0,m=0;m<4;m++){u=(u+1)%256,f=(f+l[u])%256;var h=l[u];l[u]=l[f],l[f]=h,p|=l[(l[u]+l[f])%256]<<24-m*8}return this._i=u,this._j=f,p}s(a,"generateKeystreamWord"),e.RC4=n._createHelper(o);var c=i.RC4Drop=o.extend({cfg:o.cfg.extend({drop:192}),_doReset:s(function(){o._doReset.call(this);for(var l=this.cfg.drop;l>0;l--)a.call(this)},"_doReset")});e.RC4Drop=n._createHelper(c)}(),t.RC4})});var w3e=H((Cj,T3e)=>{d();(function(t,e,r){typeof Cj=="object"?T3e.exports=Cj=e(so(),gI(),AI(),Dv(),Rl()):typeof define=="function"&&define.amd?define(["./core","./enc-base64","./md5","./evpkdf","./cipher-core"],e):e(t.CryptoJS)})(Cj,function(t){return function(){var e=t,r=e.lib,n=r.StreamCipher,i=e.algo,o=[],a=[],c=[],l=i.Rabbit=n.extend({_doReset:s(function(){for(var f=this._key.words,p=this.cfg.iv,m=0;m<4;m++)f[m]=(f[m]<<8|f[m]>>>24)&16711935|(f[m]<<24|f[m]>>>8)&4278255360;var h=this._X=[f[0],f[3]<<16|f[2]>>>16,f[1],f[0]<<16|f[3]>>>16,f[2],f[1]<<16|f[0]>>>16,f[3],f[2]<<16|f[1]>>>16],g=this._C=[f[2]<<16|f[2]>>>16,f[0]&4294901760|f[1]&65535,f[3]<<16|f[3]>>>16,f[1]&4294901760|f[2]&65535,f[0]<<16|f[0]>>>16,f[2]&4294901760|f[3]&65535,f[1]<<16|f[1]>>>16,f[3]&4294901760|f[0]&65535];this._b=0;for(var m=0;m<4;m++)u.call(this);for(var m=0;m<8;m++)g[m]^=h[m+4&7];if(p){var A=p.words,y=A[0],E=A[1],b=(y<<8|y>>>24)&16711935|(y<<24|y>>>8)&4278255360,S=(E<<8|E>>>24)&16711935|(E<<24|E>>>8)&4278255360,R=b>>>16|S&4294901760,B=S<<16|b&65535;g[0]^=b,g[1]^=R,g[2]^=S,g[3]^=B,g[4]^=b,g[5]^=R,g[6]^=S,g[7]^=B;for(var m=0;m<4;m++)u.call(this)}},"_doReset"),_doProcessBlock:s(function(f,p){var m=this._X;u.call(this),o[0]=m[0]^m[5]>>>16^m[3]<<16,o[1]=m[2]^m[7]>>>16^m[5]<<16,o[2]=m[4]^m[1]>>>16^m[7]<<16,o[3]=m[6]^m[3]>>>16^m[1]<<16;for(var h=0;h<4;h++)o[h]=(o[h]<<8|o[h]>>>24)&16711935|(o[h]<<24|o[h]>>>8)&4278255360,f[p+h]^=o[h]},"_doProcessBlock"),blockSize:128/32,ivSize:64/32});function u(){for(var f=this._X,p=this._C,m=0;m<8;m++)a[m]=p[m];p[0]=p[0]+1295307597+this._b|0,p[1]=p[1]+3545052371+(p[0]>>>0<a[0]>>>0?1:0)|0,p[2]=p[2]+886263092+(p[1]>>>0<a[1]>>>0?1:0)|0,p[3]=p[3]+1295307597+(p[2]>>>0<a[2]>>>0?1:0)|0,p[4]=p[4]+3545052371+(p[3]>>>0<a[3]>>>0?1:0)|0,p[5]=p[5]+886263092+(p[4]>>>0<a[4]>>>0?1:0)|0,p[6]=p[6]+1295307597+(p[5]>>>0<a[5]>>>0?1:0)|0,p[7]=p[7]+3545052371+(p[6]>>>0<a[6]>>>0?1:0)|0,this._b=p[7]>>>0<a[7]>>>0?1:0;for(var m=0;m<8;m++){var h=f[m]+p[m],g=h&65535,A=h>>>16,y=((g*g>>>17)+g*A>>>15)+A*A,E=((h&4294901760)*h|0)+((h&65535)*h|0);c[m]=y^E}f[0]=c[0]+(c[7]<<16|c[7]>>>16)+(c[6]<<16|c[6]>>>16)|0,f[1]=c[1]+(c[0]<<8|c[0]>>>24)+c[7]|0,f[2]=c[2]+(c[1]<<16|c[1]>>>16)+(c[0]<<16|c[0]>>>16)|0,f[3]=c[3]+(c[2]<<8|c[2]>>>24)+c[1]|0,f[4]=c[4]+(c[3]<<16|c[3]>>>16)+(c[2]<<16|c[2]>>>16)|0,f[5]=c[5]+(c[4]<<8|c[4]>>>24)+c[3]|0,f[6]=c[6]+(c[5]<<16|c[5]>>>16)+(c[4]<<16|c[4]>>>16)|0,f[7]=c[7]+(c[6]<<8|c[6]>>>24)+c[5]|0}s(u,"nextState"),e.Rabbit=n._createHelper(l)}(),t.Rabbit})});var _3e=H((vj,S3e)=>{d();(function(t,e,r){typeof vj=="object"?S3e.exports=vj=e(so(),gI(),AI(),Dv(),Rl()):typeof define=="function"&&define.amd?define(["./core","./enc-base64","./md5","./evpkdf","./cipher-core"],e):e(t.CryptoJS)})(vj,function(t){return function(){var e=t,r=e.lib,n=r.StreamCipher,i=e.algo,o=[],a=[],c=[],l=i.RabbitLegacy=n.extend({_doReset:s(function(){var f=this._key.words,p=this.cfg.iv,m=this._X=[f[0],f[3]<<16|f[2]>>>16,f[1],f[0]<<16|f[3]>>>16,f[2],f[1]<<16|f[0]>>>16,f[3],f[2]<<16|f[1]>>>16],h=this._C=[f[2]<<16|f[2]>>>16,f[0]&4294901760|f[1]&65535,f[3]<<16|f[3]>>>16,f[1]&4294901760|f[2]&65535,f[0]<<16|f[0]>>>16,f[2]&4294901760|f[3]&65535,f[1]<<16|f[1]>>>16,f[3]&4294901760|f[0]&65535];this._b=0;for(var g=0;g<4;g++)u.call(this);for(var g=0;g<8;g++)h[g]^=m[g+4&7];if(p){var A=p.words,y=A[0],E=A[1],b=(y<<8|y>>>24)&16711935|(y<<24|y>>>8)&4278255360,S=(E<<8|E>>>24)&16711935|(E<<24|E>>>8)&4278255360,R=b>>>16|S&4294901760,B=S<<16|b&65535;h[0]^=b,h[1]^=R,h[2]^=S,h[3]^=B,h[4]^=b,h[5]^=R,h[6]^=S,h[7]^=B;for(var g=0;g<4;g++)u.call(this)}},"_doReset"),_doProcessBlock:s(function(f,p){var m=this._X;u.call(this),o[0]=m[0]^m[5]>>>16^m[3]<<16,o[1]=m[2]^m[7]>>>16^m[5]<<16,o[2]=m[4]^m[1]>>>16^m[7]<<16,o[3]=m[6]^m[3]>>>16^m[1]<<16;for(var h=0;h<4;h++)o[h]=(o[h]<<8|o[h]>>>24)&16711935|(o[h]<<24|o[h]>>>8)&4278255360,f[p+h]^=o[h]},"_doProcessBlock"),blockSize:128/32,ivSize:64/32});function u(){for(var f=this._X,p=this._C,m=0;m<8;m++)a[m]=p[m];p[0]=p[0]+1295307597+this._b|0,p[1]=p[1]+3545052371+(p[0]>>>0<a[0]>>>0?1:0)|0,p[2]=p[2]+886263092+(p[1]>>>0<a[1]>>>0?1:0)|0,p[3]=p[3]+1295307597+(p[2]>>>0<a[2]>>>0?1:0)|0,p[4]=p[4]+3545052371+(p[3]>>>0<a[3]>>>0?1:0)|0,p[5]=p[5]+886263092+(p[4]>>>0<a[4]>>>0?1:0)|0,p[6]=p[6]+1295307597+(p[5]>>>0<a[5]>>>0?1:0)|0,p[7]=p[7]+3545052371+(p[6]>>>0<a[6]>>>0?1:0)|0,this._b=p[7]>>>0<a[7]>>>0?1:0;for(var m=0;m<8;m++){var h=f[m]+p[m],g=h&65535,A=h>>>16,y=((g*g>>>17)+g*A>>>15)+A*A,E=((h&4294901760)*h|0)+((h&65535)*h|0);c[m]=y^E}f[0]=c[0]+(c[7]<<16|c[7]>>>16)+(c[6]<<16|c[6]>>>16)|0,f[1]=c[1]+(c[0]<<8|c[0]>>>24)+c[7]|0,f[2]=c[2]+(c[1]<<16|c[1]>>>16)+(c[0]<<16|c[0]>>>16)|0,f[3]=c[3]+(c[2]<<8|c[2]>>>24)+c[1]|0,f[4]=c[4]+(c[3]<<16|c[3]>>>16)+(c[2]<<16|c[2]>>>16)|0,f[5]=c[5]+(c[4]<<8|c[4]>>>24)+c[3]|0,f[6]=c[6]+(c[5]<<16|c[5]>>>16)+(c[4]<<16|c[4]>>>16)|0,f[7]=c[7]+(c[6]<<8|c[6]>>>24)+c[5]|0}s(u,"nextState"),e.RabbitLegacy=n._createHelper(l)}(),t.RabbitLegacy})});var k3e=H((xj,R3e)=>{d();(function(t,e,r){typeof xj=="object"?R3e.exports=xj=e(so(),gI(),AI(),Dv(),Rl()):typeof define=="function"&&define.amd?define(["./core","./enc-base64","./md5","./evpkdf","./cipher-core"],e):e(t.CryptoJS)})(xj,function(t){return function(){var e=t,r=e.lib,n=r.BlockCipher,i=e.algo;let o=16,a=[608135816,2242054355,320440878,57701188,2752067618,698298832,137296536,3964562569,1160258022,953160567,3193202383,887688300,3232508343,3380367581,1065670069,3041331479,2450970073,2306472731],c=[[3509652390,2564797868,805139163,3491422135,3101798381,1780907670,3128725573,4046225305,614570311,3012652279,134345442,2240740374,1667834072,1901547113,2757295779,4103290238,227898511,1921955416,1904987480,2182433518,2069144605,3260701109,2620446009,720527379,3318853667,677414384,3393288472,3101374703,2390351024,1614419982,1822297739,2954791486,3608508353,3174124327,2024746970,1432378464,3864339955,2857741204,1464375394,1676153920,1439316330,715854006,3033291828,289532110,2706671279,2087905683,3018724369,1668267050,732546397,1947742710,3462151702,2609353502,2950085171,1814351708,2050118529,680887927,999245976,1800124847,3300911131,1713906067,1641548236,4213287313,1216130144,1575780402,4018429277,3917837745,3693486850,3949271944,596196993,3549867205,258830323,2213823033,772490370,2760122372,1774776394,2652871518,566650946,4142492826,1728879713,2882767088,1783734482,3629395816,2517608232,2874225571,1861159788,326777828,3124490320,2130389656,2716951837,967770486,1724537150,2185432712,2364442137,1164943284,2105845187,998989502,3765401048,2244026483,1075463327,1455516326,1322494562,910128902,469688178,1117454909,936433444,3490320968,3675253459,1240580251,122909385,2157517691,634681816,4142456567,3825094682,3061402683,2540495037,79693498,3249098678,1084186820,1583128258,426386531,1761308591,1047286709,322548459,995290223,1845252383,2603652396,3431023940,2942221577,3202600964,3727903485,1712269319,422464435,3234572375,1170764815,3523960633,3117677531,1434042557,442511882,3600875718,1076654713,1738483198,4213154764,2393238008,3677496056,1014306527,4251020053,793779912,2902807211,842905082,4246964064,1395751752,1040244610,2656851899,3396308128,445077038,3742853595,3577915638,679411651,2892444358,2354009459,1767581616,3150600392,3791627101,3102740896,284835224,4246832056,1258075500,768725851,2589189241,3069724005,3532540348,1274779536,3789419226,2764799539,1660621633,3471099624,4011903706,913787905,3497959166,737222580,2514213453,2928710040,3937242737,1804850592,3499020752,2949064160,2386320175,2390070455,2415321851,4061277028,2290661394,2416832540,1336762016,1754252060,3520065937,3014181293,791618072,3188594551,3933548030,2332172193,3852520463,3043980520,413987798,3465142937,3030929376,4245938359,2093235073,3534596313,375366246,2157278981,2479649556,555357303,3870105701,2008414854,3344188149,4221384143,3956125452,2067696032,3594591187,2921233993,2428461,544322398,577241275,1471733935,610547355,4027169054,1432588573,1507829418,2025931657,3646575487,545086370,48609733,2200306550,1653985193,298326376,1316178497,3007786442,2064951626,458293330,2589141269,3591329599,3164325604,727753846,2179363840,146436021,1461446943,4069977195,705550613,3059967265,3887724982,4281599278,3313849956,1404054877,2845806497,146425753,1854211946],[1266315497,3048417604,3681880366,3289982499,290971e4,1235738493,2632868024,2414719590,3970600049,1771706367,1449415276,3266420449,422970021,1963543593,2690192192,3826793022,1062508698,1531092325,1804592342,2583117782,2714934279,4024971509,1294809318,4028980673,1289560198,2221992742,1669523910,35572830,157838143,1052438473,1016535060,1802137761,1753167236,1386275462,3080475397,2857371447,1040679964,2145300060,2390574316,1461121720,2956646967,4031777805,4028374788,33600511,2920084762,1018524850,629373528,3691585981,3515945977,2091462646,2486323059,586499841,988145025,935516892,3367335476,2599673255,2839830854,265290510,3972581182,2759138881,3795373465,1005194799,847297441,406762289,1314163512,1332590856,1866599683,4127851711,750260880,613907577,1450815602,3165620655,3734664991,3650291728,3012275730,3704569646,1427272223,778793252,1343938022,2676280711,2052605720,1946737175,3164576444,3914038668,3967478842,3682934266,1661551462,3294938066,4011595847,840292616,3712170807,616741398,312560963,711312465,1351876610,322626781,1910503582,271666773,2175563734,1594956187,70604529,3617834859,1007753275,1495573769,4069517037,2549218298,2663038764,504708206,2263041392,3941167025,2249088522,1514023603,1998579484,1312622330,694541497,2582060303,2151582166,1382467621,776784248,2618340202,3323268794,2497899128,2784771155,503983604,4076293799,907881277,423175695,432175456,1378068232,4145222326,3954048622,3938656102,3820766613,2793130115,2977904593,26017576,3274890735,3194772133,1700274565,1756076034,4006520079,3677328699,720338349,1533947780,354530856,688349552,3973924725,1637815568,332179504,3949051286,53804574,2852348879,3044236432,1282449977,3583942155,3416972820,4006381244,1617046695,2628476075,3002303598,1686838959,431878346,2686675385,1700445008,1080580658,1009431731,832498133,3223435511,2605976345,2271191193,2516031870,1648197032,4164389018,2548247927,300782431,375919233,238389289,3353747414,2531188641,2019080857,1475708069,455242339,2609103871,448939670,3451063019,1395535956,2413381860,1841049896,1491858159,885456874,4264095073,4001119347,1565136089,3898914787,1108368660,540939232,1173283510,2745871338,3681308437,4207628240,3343053890,4016749493,1699691293,1103962373,3625875870,2256883143,3830138730,1031889488,3479347698,1535977030,4236805024,3251091107,2132092099,1774941330,1199868427,1452454533,157007616,2904115357,342012276,595725824,1480756522,206960106,497939518,591360097,863170706,2375253569,3596610801,1814182875,2094937945,3421402208,1082520231,3463918190,2785509508,435703966,3908032597,1641649973,2842273706,3305899714,1510255612,2148256476,2655287854,3276092548,4258621189,236887753,3681803219,274041037,1734335097,3815195456,3317970021,1899903192,1026095262,4050517792,356393447,2410691914,3873677099,3682840055],[3913112168,2491498743,4132185628,2489919796,1091903735,1979897079,3170134830,3567386728,3557303409,857797738,1136121015,1342202287,507115054,2535736646,337727348,3213592640,1301675037,2528481711,1895095763,1721773893,3216771564,62756741,2142006736,835421444,2531993523,1442658625,3659876326,2882144922,676362277,1392781812,170690266,3921047035,1759253602,3611846912,1745797284,664899054,1329594018,3901205900,3045908486,2062866102,2865634940,3543621612,3464012697,1080764994,553557557,3656615353,3996768171,991055499,499776247,1265440854,648242737,3940784050,980351604,3713745714,1749149687,3396870395,4211799374,3640570775,1161844396,3125318951,1431517754,545492359,4268468663,3499529547,1437099964,2702547544,3433638243,2581715763,2787789398,1060185593,1593081372,2418618748,4260947970,69676912,2159744348,86519011,2512459080,3838209314,1220612927,3339683548,133810670,1090789135,1078426020,1569222167,845107691,3583754449,4072456591,1091646820,628848692,1613405280,3757631651,526609435,236106946,48312990,2942717905,3402727701,1797494240,859738849,992217954,4005476642,2243076622,3870952857,3732016268,765654824,3490871365,2511836413,1685915746,3888969200,1414112111,2273134842,3281911079,4080962846,172450625,2569994100,980381355,4109958455,2819808352,2716589560,2568741196,3681446669,3329971472,1835478071,660984891,3704678404,4045999559,3422617507,3040415634,1762651403,1719377915,3470491036,2693910283,3642056355,3138596744,1364962596,2073328063,1983633131,926494387,3423689081,2150032023,4096667949,1749200295,3328846651,309677260,2016342300,1779581495,3079819751,111262694,1274766160,443224088,298511866,1025883608,3806446537,1145181785,168956806,3641502830,3584813610,1689216846,3666258015,3200248200,1692713982,2646376535,4042768518,1618508792,1610833997,3523052358,4130873264,2001055236,3610705100,2202168115,4028541809,2961195399,1006657119,2006996926,3186142756,1430667929,3210227297,1314452623,4074634658,4101304120,2273951170,1399257539,3367210612,3027628629,1190975929,2062231137,2333990788,2221543033,2438960610,1181637006,548689776,2362791313,3372408396,3104550113,3145860560,296247880,1970579870,3078560182,3769228297,1714227617,3291629107,3898220290,166772364,1251581989,493813264,448347421,195405023,2709975567,677966185,3703036547,1463355134,2715995803,1338867538,1343315457,2802222074,2684532164,233230375,2599980071,2000651841,3277868038,1638401717,4028070440,3237316320,6314154,819756386,300326615,590932579,1405279636,3267499572,3150704214,2428286686,3959192993,3461946742,1862657033,1266418056,963775037,2089974820,2263052895,1917689273,448879540,3550394620,3981727096,150775221,3627908307,1303187396,508620638,2975983352,2726630617,1817252668,1876281319,1457606340,908771278,3720792119,3617206836,2455994898,1729034894,1080033504],[976866871,3556439503,2881648439,1522871579,1555064734,1336096578,3548522304,2579274686,3574697629,3205460757,3593280638,3338716283,3079412587,564236357,2993598910,1781952180,1464380207,3163844217,3332601554,1699332808,1393555694,1183702653,3581086237,1288719814,691649499,2847557200,2895455976,3193889540,2717570544,1781354906,1676643554,2592534050,3230253752,1126444790,2770207658,2633158820,2210423226,2615765581,2414155088,3127139286,673620729,2805611233,1269405062,4015350505,3341807571,4149409754,1057255273,2012875353,2162469141,2276492801,2601117357,993977747,3918593370,2654263191,753973209,36408145,2530585658,25011837,3520020182,2088578344,530523599,2918365339,1524020338,1518925132,3760827505,3759777254,1202760957,3985898139,3906192525,674977740,4174734889,2031300136,2019492241,3983892565,4153806404,3822280332,352677332,2297720250,60907813,90501309,3286998549,1016092578,2535922412,2839152426,457141659,509813237,4120667899,652014361,1966332200,2975202805,55981186,2327461051,676427537,3255491064,2882294119,3433927263,1307055953,942726286,933058658,2468411793,3933900994,4215176142,1361170020,2001714738,2830558078,3274259782,1222529897,1679025792,2729314320,3714953764,1770335741,151462246,3013232138,1682292957,1483529935,471910574,1539241949,458788160,3436315007,1807016891,3718408830,978976581,1043663428,3165965781,1927990952,4200891579,2372276910,3208408903,3533431907,1412390302,2931980059,4132332400,1947078029,3881505623,4168226417,2941484381,1077988104,1320477388,886195818,18198404,3786409e3,2509781533,112762804,3463356488,1866414978,891333506,18488651,661792760,1628790961,3885187036,3141171499,876946877,2693282273,1372485963,791857591,2686433993,3759982718,3167212022,3472953795,2716379847,445679433,3561995674,3504004811,3574258232,54117162,3331405415,2381918588,3769707343,4154350007,1140177722,4074052095,668550556,3214352940,367459370,261225585,2610173221,4209349473,3468074219,3265815641,314222801,3066103646,3808782860,282218597,3406013506,3773591054,379116347,1285071038,846784868,2669647154,3771962079,3550491691,2305946142,453669953,1268987020,3317592352,3279303384,3744833421,2610507566,3859509063,266596637,3847019092,517658769,3462560207,3443424879,370717030,4247526661,2224018117,4143653529,4112773975,2788324899,2477274417,1456262402,2901442914,1517677493,1846949527,2295493580,3734397586,2176403920,1280348187,1908823572,3871786941,846861322,1172426758,3287448474,3383383037,1655181056,3139813346,901632758,1897031941,2986607138,3066810236,3447102507,1393639104,373351379,950779232,625454576,3124240540,4148612726,2007998917,544563296,2244738638,2330496472,2058025392,1291430526,424198748,50039436,29584100,3605783033,2429876329,2791104160,1057563949,3255363231,3075367218,3463963227,1469046755,985887462]];var l={pbox:[],sbox:[]};function u(g,A){let y=A>>24&255,E=A>>16&255,b=A>>8&255,S=A&255,R=g.sbox[0][y]+g.sbox[1][E];return R=R^g.sbox[2][b],R=R+g.sbox[3][S],R}s(u,"F");function f(g,A,y){let E=A,b=y,S;for(let R=0;R<o;++R)E=E^g.pbox[R],b=u(g,E)^b,S=E,E=b,b=S;return S=E,E=b,b=S,b=b^g.pbox[o],E=E^g.pbox[o+1],{left:E,right:b}}s(f,"BlowFish_Encrypt");function p(g,A,y){let E=A,b=y,S;for(let R=o+1;R>1;--R)E=E^g.pbox[R],b=u(g,E)^b,S=E,E=b,b=S;return S=E,E=b,b=S,b=b^g.pbox[1],E=E^g.pbox[0],{left:E,right:b}}s(p,"BlowFish_Decrypt");function m(g,A,y){for(let B=0;B<4;B++){g.sbox[B]=[];for(let L=0;L<256;L++)g.sbox[B][L]=c[B][L]}let E=0;for(let B=0;B<o+2;B++)g.pbox[B]=a[B]^A[E],E++,E>=y&&(E=0);let b=0,S=0,R=0;for(let B=0;B<o+2;B+=2)R=f(g,b,S),b=R.left,S=R.right,g.pbox[B]=b,g.pbox[B+1]=S;for(let B=0;B<4;B++)for(let L=0;L<256;L+=2)R=f(g,b,S),b=R.left,S=R.right,g.sbox[B][L]=b,g.sbox[B][L+1]=S;return!0}s(m,"BlowFishInit");var h=i.Blowfish=n.extend({_doReset:s(function(){if(this._keyPriorReset!==this._key){var g=this._keyPriorReset=this._key,A=g.words,y=g.sigBytes/4;m(l,A,y)}},"_doReset"),encryptBlock:s(function(g,A){var y=f(l,g[A],g[A+1]);g[A]=y.left,g[A+1]=y.right},"encryptBlock"),decryptBlock:s(function(g,A){var y=p(l,g[A],g[A+1]);g[A]=y.left,g[A+1]=y.right},"decryptBlock"),blockSize:64/32,keySize:128/32,ivSize:64/32});e.Blowfish=n._createHelper(h)}(),t.Blowfish})});var yI=H((Ej,P3e)=>{d();(function(t,e,r){typeof Ej=="object"?P3e.exports=Ej=e(so(),QF(),_Be(),kBe(),gI(),BBe(),AI(),Vfe(),zW(),OBe(),zfe(),qBe(),$Be(),jBe(),tj(),zBe(),Dv(),Rl(),XBe(),e3e(),r3e(),i3e(),s3e(),c3e(),u3e(),f3e(),m3e(),g3e(),y3e(),v3e(),E3e(),I3e(),w3e(),_3e(),k3e()):typeof define=="function"&&define.amd?define(["./core","./x64-core","./lib-typedarrays","./enc-utf16","./enc-base64","./enc-base64url","./md5","./sha1","./sha256","./sha224","./sha512","./sha384","./sha3","./ripemd160","./hmac","./pbkdf2","./evpkdf","./cipher-core","./mode-cfb","./mode-ctr","./mode-ctr-gladman","./mode-ofb","./mode-ecb","./pad-ansix923","./pad-iso10126","./pad-iso97971","./pad-zeropadding","./pad-nopadding","./format-hex","./aes","./tripledes","./rc4","./rabbit","./rabbit-legacy","./blowfish"],e):t.CryptoJS=e(t.CryptoJS)})(Ej,function(t){return t})});var dD=H(Dd=>{"use strict";d();Object.defineProperty(Dd,"__esModule",{value:!0});Dd.stringArray=Dd.array=Dd.func=Dd.error=Dd.number=Dd.string=Dd.boolean=void 0;function b5t(t){return t===!0||t===!1}s(b5t,"boolean");Dd.boolean=b5t;function xMe(t){return typeof t=="string"||t instanceof String}s(xMe,"string");Dd.string=xMe;function I5t(t){return typeof t=="number"||t instanceof Number}s(I5t,"number");Dd.number=I5t;function T5t(t){return t instanceof Error}s(T5t,"error");Dd.error=T5t;function w5t(t){return typeof t=="function"}s(w5t,"func");Dd.func=w5t;function EMe(t){return Array.isArray(t)}s(EMe,"array");Dd.array=EMe;function S5t(t){return EMe(t)&&t.every(e=>xMe(e))}s(S5t,"stringArray");Dd.stringArray=S5t});var I0e=H(fn=>{"use strict";d();Object.defineProperty(fn,"__esModule",{value:!0});fn.Message=fn.NotificationType9=fn.NotificationType8=fn.NotificationType7=fn.NotificationType6=fn.NotificationType5=fn.NotificationType4=fn.NotificationType3=fn.NotificationType2=fn.NotificationType1=fn.NotificationType0=fn.NotificationType=fn.RequestType9=fn.RequestType8=fn.RequestType7=fn.RequestType6=fn.RequestType5=fn.RequestType4=fn.RequestType3=fn.RequestType2=fn.RequestType1=fn.RequestType=fn.RequestType0=fn.AbstractMessageSignature=fn.ParameterStructures=fn.ResponseError=fn.ErrorCodes=void 0;var t2=dD(),e0e;(function(t){t.ParseError=-32700,t.InvalidRequest=-32600,t.MethodNotFound=-32601,t.InvalidParams=-32602,t.InternalError=-32603,t.jsonrpcReservedErrorRangeStart=-32099,t.serverErrorStart=-32099,t.MessageWriteError=-32099,t.MessageReadError=-32098,t.PendingResponseRejected=-32097,t.ConnectionInactive=-32096,t.ServerNotInitialized=-32002,t.UnknownErrorCode=-32001,t.jsonrpcReservedErrorRangeEnd=-32e3,t.serverErrorEnd=-32e3})(e0e||(fn.ErrorCodes=e0e={}));var t0e=class t extends Error{static{s(this,"ResponseError")}constructor(e,r,n){super(r),this.code=t2.number(e)?e:e0e.UnknownErrorCode,this.data=n,Object.setPrototypeOf(this,t.prototype)}toJson(){let e={code:this.code,message:this.message};return this.data!==void 0&&(e.data=this.data),e}};fn.ResponseError=t0e;var cp=class t{static{s(this,"ParameterStructures")}constructor(e){this.kind=e}static is(e){return e===t.auto||e===t.byName||e===t.byPosition}toString(){return this.kind}};fn.ParameterStructures=cp;cp.auto=new cp("auto");cp.byPosition=new cp("byPosition");cp.byName=new cp("byName");var ra=class{static{s(this,"AbstractMessageSignature")}constructor(e,r){this.method=e,this.numberOfParams=r}get parameterStructures(){return cp.auto}};fn.AbstractMessageSignature=ra;var r0e=class extends ra{static{s(this,"RequestType0")}constructor(e){super(e,0)}};fn.RequestType0=r0e;var n0e=class extends ra{static{s(this,"RequestType")}constructor(e,r=cp.auto){super(e,1),this._parameterStructures=r}get parameterStructures(){return this._parameterStructures}};fn.RequestType=n0e;var i0e=class extends ra{static{s(this,"RequestType1")}constructor(e,r=cp.auto){super(e,1),this._parameterStructures=r}get parameterStructures(){return this._parameterStructures}};fn.RequestType1=i0e;var o0e=class extends ra{static{s(this,"RequestType2")}constructor(e){super(e,2)}};fn.RequestType2=o0e;var s0e=class extends ra{static{s(this,"RequestType3")}constructor(e){super(e,3)}};fn.RequestType3=s0e;var a0e=class extends ra{static{s(this,"RequestType4")}constructor(e){super(e,4)}};fn.RequestType4=a0e;var c0e=class extends ra{static{s(this,"RequestType5")}constructor(e){super(e,5)}};fn.RequestType5=c0e;var l0e=class extends ra{static{s(this,"RequestType6")}constructor(e){super(e,6)}};fn.RequestType6=l0e;var u0e=class extends ra{static{s(this,"RequestType7")}constructor(e){super(e,7)}};fn.RequestType7=u0e;var d0e=class extends ra{static{s(this,"RequestType8")}constructor(e){super(e,8)}};fn.RequestType8=d0e;var f0e=class extends ra{static{s(this,"RequestType9")}constructor(e){super(e,9)}};fn.RequestType9=f0e;var p0e=class extends ra{static{s(this,"NotificationType")}constructor(e,r=cp.auto){super(e,1),this._parameterStructures=r}get parameterStructures(){return this._parameterStructures}};fn.NotificationType=p0e;var m0e=class extends ra{static{s(this,"NotificationType0")}constructor(e){super(e,0)}};fn.NotificationType0=m0e;var h0e=class extends ra{static{s(this,"NotificationType1")}constructor(e,r=cp.auto){super(e,1),this._parameterStructures=r}get parameterStructures(){return this._parameterStructures}};fn.NotificationType1=h0e;var g0e=class extends ra{static{s(this,"NotificationType2")}constructor(e){super(e,2)}};fn.NotificationType2=g0e;var A0e=class extends ra{static{s(this,"NotificationType3")}constructor(e){super(e,3)}};fn.NotificationType3=A0e;var y0e=class extends ra{static{s(this,"NotificationType4")}constructor(e){super(e,4)}};fn.NotificationType4=y0e;var C0e=class extends ra{static{s(this,"NotificationType5")}constructor(e){super(e,5)}};fn.NotificationType5=C0e;var v0e=class extends ra{static{s(this,"NotificationType6")}constructor(e){super(e,6)}};fn.NotificationType6=v0e;var x0e=class extends ra{static{s(this,"NotificationType7")}constructor(e){super(e,7)}};fn.NotificationType7=x0e;var E0e=class extends ra{static{s(this,"NotificationType8")}constructor(e){super(e,8)}};fn.NotificationType8=E0e;var b0e=class extends ra{static{s(this,"NotificationType9")}constructor(e){super(e,9)}};fn.NotificationType9=b0e;var bMe;(function(t){function e(i){let o=i;return o&&t2.string(o.method)&&(t2.string(o.id)||t2.number(o.id))}s(e,"isRequest"),t.isRequest=e;function r(i){let o=i;return o&&t2.string(o.method)&&i.id===void 0}s(r,"isNotification"),t.isNotification=r;function n(i){let o=i;return o&&(o.result!==void 0||!!o.error)&&(t2.string(o.id)||t2.number(o.id)||o.id===null)}s(n,"isResponse"),t.isResponse=n})(bMe||(fn.Message=bMe={}))});var w0e=H(kI=>{"use strict";d();var IMe;Object.defineProperty(kI,"__esModule",{value:!0});kI.LRUCache=kI.LinkedMap=kI.Touch=void 0;var Bd;(function(t){t.None=0,t.First=1,t.AsOld=t.First,t.Last=2,t.AsNew=t.Last})(Bd||(kI.Touch=Bd={}));var dG=class{static{s(this,"LinkedMap")}constructor(){this[IMe]="LinkedMap",this._map=new Map,this._head=void 0,this._tail=void 0,this._size=0,this._state=0}clear(){this._map.clear(),this._head=void 0,this._tail=void 0,this._size=0,this._state++}isEmpty(){return!this._head&&!this._tail}get size(){return this._size}get first(){return this._head?.value}get last(){return this._tail?.value}has(e){return this._map.has(e)}get(e,r=Bd.None){let n=this._map.get(e);if(n)return r!==Bd.None&&this.touch(n,r),n.value}set(e,r,n=Bd.None){let i=this._map.get(e);if(i)i.value=r,n!==Bd.None&&this.touch(i,n);else{switch(i={key:e,value:r,next:void 0,previous:void 0},n){case Bd.None:this.addItemLast(i);break;case Bd.First:this.addItemFirst(i);break;case Bd.Last:this.addItemLast(i);break;default:this.addItemLast(i);break}this._map.set(e,i),this._size++}return this}delete(e){return!!this.remove(e)}remove(e){let r=this._map.get(e);if(r)return this._map.delete(e),this.removeItem(r),this._size--,r.value}shift(){if(!this._head&&!this._tail)return;if(!this._head||!this._tail)throw new Error("Invalid list");let e=this._head;return this._map.delete(e.key),this.removeItem(e),this._size--,e.value}forEach(e,r){let n=this._state,i=this._head;for(;i;){if(r?e.bind(r)(i.value,i.key,this):e(i.value,i.key,this),this._state!==n)throw new Error("LinkedMap got modified during iteration.");i=i.next}}keys(){let e=this._state,r=this._head,n={[Symbol.iterator]:()=>n,next:s(()=>{if(this._state!==e)throw new Error("LinkedMap got modified during iteration.");if(r){let i={value:r.key,done:!1};return r=r.next,i}else return{value:void 0,done:!0}},"next")};return n}values(){let e=this._state,r=this._head,n={[Symbol.iterator]:()=>n,next:s(()=>{if(this._state!==e)throw new Error("LinkedMap got modified during iteration.");if(r){let i={value:r.value,done:!1};return r=r.next,i}else return{value:void 0,done:!0}},"next")};return n}entries(){let e=this._state,r=this._head,n={[Symbol.iterator]:()=>n,next:s(()=>{if(this._state!==e)throw new Error("LinkedMap got modified during iteration.");if(r){let i={value:[r.key,r.value],done:!1};return r=r.next,i}else return{value:void 0,done:!0}},"next")};return n}[(IMe=Symbol.toStringTag,Symbol.iterator)](){return this.entries()}trimOld(e){if(e>=this.size)return;if(e===0){this.clear();return}let r=this._head,n=this.size;for(;r&&n>e;)this._map.delete(r.key),r=r.next,n--;this._head=r,this._size=n,r&&(r.previous=void 0),this._state++}addItemFirst(e){if(!this._head&&!this._tail)this._tail=e;else if(this._head)e.next=this._head,this._head.previous=e;else throw new Error("Invalid list");this._head=e,this._state++}addItemLast(e){if(!this._head&&!this._tail)this._head=e;else if(this._tail)e.previous=this._tail,this._tail.next=e;else throw new Error("Invalid list");this._tail=e,this._state++}removeItem(e){if(e===this._head&&e===this._tail)this._head=void 0,this._tail=void 0;else if(e===this._head){if(!e.next)throw new Error("Invalid list");e.next.previous=void 0,this._head=e.next}else if(e===this._tail){if(!e.previous)throw new Error("Invalid list");e.previous.next=void 0,this._tail=e.previous}else{let r=e.next,n=e.previous;if(!r||!n)throw new Error("Invalid list");r.previous=n,n.next=r}e.next=void 0,e.previous=void 0,this._state++}touch(e,r){if(!this._head||!this._tail)throw new Error("Invalid list");if(!(r!==Bd.First&&r!==Bd.Last)){if(r===Bd.First){if(e===this._head)return;let n=e.next,i=e.previous;e===this._tail?(i.next=void 0,this._tail=i):(n.previous=i,i.next=n),e.previous=void 0,e.next=this._head,this._head.previous=e,this._head=e,this._state++}else if(r===Bd.Last){if(e===this._tail)return;let n=e.next,i=e.previous;e===this._head?(n.previous=void 0,this._head=n):(n.previous=i,i.next=n),e.next=void 0,e.previous=this._tail,this._tail.next=e,this._tail=e,this._state++}}}toJSON(){let e=[];return this.forEach((r,n)=>{e.push([n,r])}),e}fromJSON(e){this.clear();for(let[r,n]of e)this.set(r,n)}};kI.LinkedMap=dG;var T0e=class extends dG{static{s(this,"LRUCache")}constructor(e,r=1){super(),this._limit=e,this._ratio=Math.min(Math.max(0,r),1)}get limit(){return this._limit}set limit(e){this._limit=e,this.checkTrim()}get ratio(){return this._ratio}set ratio(e){this._ratio=Math.min(Math.max(0,e),1),this.checkTrim()}get(e,r=Bd.AsNew){return super.get(e,r)}peek(e){return super.get(e,Bd.None)}set(e,r){return super.set(e,r,Bd.Last),this.checkTrim(),this}checkTrim(){this.size>this._limit&&this.trimOld(Math.round(this._limit*this._ratio))}};kI.LRUCache=T0e});var wMe=H(fG=>{"use strict";d();Object.defineProperty(fG,"__esModule",{value:!0});fG.Disposable=void 0;var TMe;(function(t){function e(r){return{dispose:r}}s(e,"create"),t.create=e})(TMe||(fG.Disposable=TMe={}))});var PI=H(R0e=>{"use strict";d();Object.defineProperty(R0e,"__esModule",{value:!0});var S0e;function _0e(){if(S0e===void 0)throw new Error("No runtime abstraction layer installed");return S0e}s(_0e,"RAL");(function(t){function e(r){if(r===void 0)throw new Error("No runtime abstraction layer provided");S0e=r}s(e,"install"),t.install=e})(_0e||(_0e={}));R0e.default=_0e});var pD=H(fD=>{"use strict";d();Object.defineProperty(fD,"__esModule",{value:!0});fD.Emitter=fD.Event=void 0;var _5t=PI(),SMe;(function(t){let e={dispose(){}};t.None=function(){return e}})(SMe||(fD.Event=SMe={}));var k0e=class{static{s(this,"CallbackList")}add(e,r=null,n){this._callbacks||(this._callbacks=[],this._contexts=[]),this._callbacks.push(e),this._contexts.push(r),Array.isArray(n)&&n.push({dispose:s(()=>this.remove(e,r),"dispose")})}remove(e,r=null){if(!this._callbacks)return;let n=!1;for(let i=0,o=this._callbacks.length;i<o;i++)if(this._callbacks[i]===e)if(this._contexts[i]===r){this._callbacks.splice(i,1),this._contexts.splice(i,1);return}else n=!0;if(n)throw new Error("When adding a listener with a context, you should remove it with the same context")}invoke(...e){if(!this._callbacks)return[];let r=[],n=this._callbacks.slice(0),i=this._contexts.slice(0);for(let o=0,a=n.length;o<a;o++)try{r.push(n[o].apply(i[o],e))}catch(c){(0,_5t.default)().console.error(c)}return r}isEmpty(){return!this._callbacks||this._callbacks.length===0}dispose(){this._callbacks=void 0,this._contexts=void 0}},pG=class t{static{s(this,"Emitter")}constructor(e){this._options=e}get event(){return this._event||(this._event=(e,r,n)=>{this._callbacks||(this._callbacks=new k0e),this._options&&this._options.onFirstListenerAdd&&this._callbacks.isEmpty()&&this._options.onFirstListenerAdd(this),this._callbacks.add(e,r);let i={dispose:s(()=>{this._callbacks&&(this._callbacks.remove(e,r),i.dispose=t._noop,this._options&&this._options.onLastListenerRemove&&this._callbacks.isEmpty()&&this._options.onLastListenerRemove(this))},"dispose")};return Array.isArray(n)&&n.push(i),i}),this._event}fire(e){this._callbacks&&this._callbacks.invoke.call(this._callbacks,e)}dispose(){this._callbacks&&(this._callbacks.dispose(),this._callbacks=void 0)}};fD.Emitter=pG;pG._noop=function(){}});var gG=H(mD=>{"use strict";d();Object.defineProperty(mD,"__esModule",{value:!0});mD.CancellationTokenSource=mD.CancellationToken=void 0;var R5t=PI(),k5t=dD(),P0e=pD(),mG;(function(t){t.None=Object.freeze({isCancellationRequested:!1,onCancellationRequested:P0e.Event.None}),t.Cancelled=Object.freeze({isCancellationRequested:!0,onCancellationRequested:P0e.Event.None});function e(r){let n=r;return n&&(n===t.None||n===t.Cancelled||k5t.boolean(n.isCancellationRequested)&&!!n.onCancellationRequested)}s(e,"is"),t.is=e})(mG||(mD.CancellationToken=mG={}));var P5t=Object.freeze(function(t,e){let r=(0,R5t.default)().timer.setTimeout(t.bind(e),0);return{dispose(){r.dispose()}}}),hG=class{static{s(this,"MutableToken")}constructor(){this._isCancelled=!1}cancel(){this._isCancelled||(this._isCancelled=!0,this._emitter&&(this._emitter.fire(void 0),this.dispose()))}get isCancellationRequested(){return this._isCancelled}get onCancellationRequested(){return this._isCancelled?P5t:(this._emitter||(this._emitter=new P0e.Emitter),this._emitter.event)}dispose(){this._emitter&&(this._emitter.dispose(),this._emitter=void 0)}},D0e=class{static{s(this,"CancellationTokenSource")}get token(){return this._token||(this._token=new hG),this._token}cancel(){this._token?this._token.cancel():this._token=mG.Cancelled}dispose(){this._token?this._token instanceof hG&&this._token.dispose():this._token=mG.None}};mD.CancellationTokenSource=D0e});var _Me=H(hD=>{"use strict";d();Object.defineProperty(hD,"__esModule",{value:!0});hD.SharedArrayReceiverStrategy=hD.SharedArraySenderStrategy=void 0;var D5t=gG(),s9;(function(t){t.Continue=0,t.Cancelled=1})(s9||(s9={}));var B0e=class{static{s(this,"SharedArraySenderStrategy")}constructor(){this.buffers=new Map}enableCancellation(e){if(e.id===null)return;let r=new SharedArrayBuffer(4),n=new Int32Array(r,0,1);n[0]=s9.Continue,this.buffers.set(e.id,r),e.$cancellationData=r}async sendCancellation(e,r){let n=this.buffers.get(r);if(n===void 0)return;let i=new Int32Array(n,0,1);Atomics.store(i,0,s9.Cancelled)}cleanup(e){this.buffers.delete(e)}dispose(){this.buffers.clear()}};hD.SharedArraySenderStrategy=B0e;var N0e=class{static{s(this,"SharedArrayBufferCancellationToken")}constructor(e){this.data=new Int32Array(e,0,1)}get isCancellationRequested(){return Atomics.load(this.data,0)===s9.Cancelled}get onCancellationRequested(){throw new Error("Cancellation over SharedArrayBuffer doesn't support cancellation events")}},M0e=class{static{s(this,"SharedArrayBufferCancellationTokenSource")}constructor(e){this.token=new N0e(e)}cancel(){}dispose(){}},L0e=class{static{s(this,"SharedArrayReceiverStrategy")}constructor(){this.kind="request"}createCancellationTokenSource(e){let r=e.$cancellationData;return r===void 0?new D5t.CancellationTokenSource:new M0e(r)}};hD.SharedArrayReceiverStrategy=L0e});var O0e=H(AG=>{"use strict";d();Object.defineProperty(AG,"__esModule",{value:!0});AG.Semaphore=void 0;var B5t=PI(),F0e=class{static{s(this,"Semaphore")}constructor(e=1){if(e<=0)throw new Error("Capacity must be greater than 0");this._capacity=e,this._active=0,this._waiting=[]}lock(e){return new Promise((r,n)=>{this._waiting.push({thunk:e,resolve:r,reject:n}),this.runNext()})}get active(){return this._active}runNext(){this._waiting.length===0||this._active===this._capacity||(0,B5t.default)().timer.setImmediate(()=>this.doRunNext())}doRunNext(){if(this._waiting.length===0||this._active===this._capacity)return;let e=this._waiting.shift();if(this._active++,this._active>this._capacity)throw new Error("To many thunks active");try{let r=e.thunk();r instanceof Promise?r.then(n=>{this._active--,e.resolve(n),this.runNext()},n=>{this._active--,e.reject(n),this.runNext()}):(this._active--,e.resolve(r),this.runNext())}catch(r){this._active--,e.reject(r),this.runNext()}}};AG.Semaphore=F0e});var kMe=H(DI=>{"use strict";d();Object.defineProperty(DI,"__esModule",{value:!0});DI.ReadableStreamMessageReader=DI.AbstractMessageReader=DI.MessageReader=void 0;var U0e=PI(),gD=dD(),Q0e=pD(),N5t=O0e(),RMe;(function(t){function e(r){let n=r;return n&&gD.func(n.listen)&&gD.func(n.dispose)&&gD.func(n.onError)&&gD.func(n.onClose)&&gD.func(n.onPartialMessage)}s(e,"is"),t.is=e})(RMe||(DI.MessageReader=RMe={}));var yG=class{static{s(this,"AbstractMessageReader")}constructor(){this.errorEmitter=new Q0e.Emitter,this.closeEmitter=new Q0e.Emitter,this.partialMessageEmitter=new Q0e.Emitter}dispose(){this.errorEmitter.dispose(),this.closeEmitter.dispose()}get onError(){return this.errorEmitter.event}fireError(e){this.errorEmitter.fire(this.asError(e))}get onClose(){return this.closeEmitter.event}fireClose(){this.closeEmitter.fire(void 0)}get onPartialMessage(){return this.partialMessageEmitter.event}firePartialMessage(e){this.partialMessageEmitter.fire(e)}asError(e){return e instanceof Error?e:new Error(`Reader received error. Reason: ${gD.string(e.message)?e.message:"unknown"}`)}};DI.AbstractMessageReader=yG;var q0e;(function(t){function e(r){let n,i,o,a=new Map,c,l=new Map;if(r===void 0||typeof r=="string")n=r??"utf-8";else{if(n=r.charset??"utf-8",r.contentDecoder!==void 0&&(o=r.contentDecoder,a.set(o.name,o)),r.contentDecoders!==void 0)for(let u of r.contentDecoders)a.set(u.name,u);if(r.contentTypeDecoder!==void 0&&(c=r.contentTypeDecoder,l.set(c.name,c)),r.contentTypeDecoders!==void 0)for(let u of r.contentTypeDecoders)l.set(u.name,u)}return c===void 0&&(c=(0,U0e.default)().applicationJson.decoder,l.set(c.name,c)),{charset:n,contentDecoder:o,contentDecoders:a,contentTypeDecoder:c,contentTypeDecoders:l}}s(e,"fromOptions"),t.fromOptions=e})(q0e||(q0e={}));var H0e=class extends yG{static{s(this,"ReadableStreamMessageReader")}constructor(e,r){super(),this.readable=e,this.options=q0e.fromOptions(r),this.buffer=(0,U0e.default)().messageBuffer.create(this.options.charset),this._partialMessageTimeout=1e4,this.nextMessageLength=-1,this.messageToken=0,this.readSemaphore=new N5t.Semaphore(1)}set partialMessageTimeout(e){this._partialMessageTimeout=e}get partialMessageTimeout(){return this._partialMessageTimeout}listen(e){this.nextMessageLength=-1,this.messageToken=0,this.partialMessageTimer=void 0,this.callback=e;let r=this.readable.onData(n=>{this.onData(n)});return this.readable.onError(n=>this.fireError(n)),this.readable.onClose(()=>this.fireClose()),r}onData(e){try{for(this.buffer.append(e);;){if(this.nextMessageLength===-1){let n=this.buffer.tryReadHeaders(!0);if(!n)return;let i=n.get("content-length");if(!i){this.fireError(new Error(`Header must provide a Content-Length property.
${JSON.stringify(Object.fromEntries(n))}`));return}let o=parseInt(i);if(isNaN(o)){this.fireError(new Error(`Content-Length value must be a number. Got ${i}`));return}this.nextMessageLength=o}let r=this.buffer.tryReadBody(this.nextMessageLength);if(r===void 0){this.setPartialMessageTimer();return}this.clearPartialMessageTimer(),this.nextMessageLength=-1,this.readSemaphore.lock(async()=>{let n=this.options.contentDecoder!==void 0?await this.options.contentDecoder.decode(r):r,i=await this.options.contentTypeDecoder.decode(n,this.options);this.callback(i)}).catch(n=>{this.fireError(n)})}}catch(r){this.fireError(r)}}clearPartialMessageTimer(){this.partialMessageTimer&&(this.partialMessageTimer.dispose(),this.partialMessageTimer=void 0)}setPartialMessageTimer(){this.clearPartialMessageTimer(),!(this._partialMessageTimeout<=0)&&(this.partialMessageTimer=(0,U0e.default)().timer.setTimeout((e,r)=>{this.partialMessageTimer=void 0,e===this.messageToken&&(this.firePartialMessage({messageToken:e,waitingTime:r}),this.setPartialMessageTimer())},this._partialMessageTimeout,this.messageToken,this._partialMessageTimeout))}};DI.ReadableStreamMessageReader=H0e});var MMe=H(BI=>{"use strict";d();Object.defineProperty(BI,"__esModule",{value:!0});BI.WriteableStreamMessageWriter=BI.AbstractMessageWriter=BI.MessageWriter=void 0;var PMe=PI(),a9=dD(),M5t=O0e(),DMe=pD(),L5t="Content-Length: ",BMe=`\r
`,NMe;(function(t){function e(r){let n=r;return n&&a9.func(n.dispose)&&a9.func(n.onClose)&&a9.func(n.onError)&&a9.func(n.write)}s(e,"is"),t.is=e})(NMe||(BI.MessageWriter=NMe={}));var CG=class{static{s(this,"AbstractMessageWriter")}constructor(){this.errorEmitter=new DMe.Emitter,this.closeEmitter=new DMe.Emitter}dispose(){this.errorEmitter.dispose(),this.closeEmitter.dispose()}get onError(){return this.errorEmitter.event}fireError(e,r,n){this.errorEmitter.fire([this.asError(e),r,n])}get onClose(){return this.closeEmitter.event}fireClose(){this.closeEmitter.fire(void 0)}asError(e){return e instanceof Error?e:new Error(`Writer received error. Reason: ${a9.string(e.message)?e.message:"unknown"}`)}};BI.AbstractMessageWriter=CG;var $0e;(function(t){function e(r){return r===void 0||typeof r=="string"?{charset:r??"utf-8",contentTypeEncoder:(0,PMe.default)().applicationJson.encoder}:{charset:r.charset??"utf-8",contentEncoder:r.contentEncoder,contentTypeEncoder:r.contentTypeEncoder??(0,PMe.default)().applicationJson.encoder}}s(e,"fromOptions"),t.fromOptions=e})($0e||($0e={}));var W0e=class extends CG{static{s(this,"WriteableStreamMessageWriter")}constructor(e,r){super(),this.writable=e,this.options=$0e.fromOptions(r),this.errorCount=0,this.writeSemaphore=new M5t.Semaphore(1),this.writable.onError(n=>this.fireError(n)),this.writable.onClose(()=>this.fireClose())}async write(e){return this.writeSemaphore.lock(async()=>this.options.contentTypeEncoder.encode(e,this.options).then(n=>this.options.contentEncoder!==void 0?this.options.contentEncoder.encode(n):n).then(n=>{let i=[];return i.push(L5t,n.byteLength.toString(),BMe),i.push(BMe),this.doWrite(e,i,n)},n=>{throw this.fireError(n),n}))}async doWrite(e,r,n){try{return await this.writable.write(r.join(""),"ascii"),this.writable.write(n)}catch(i){return this.handleError(i,e),Promise.reject(i)}}handleError(e,r){this.errorCount++,this.fireError(e,r,this.errorCount)}end(){this.writable.end()}};BI.WriteableStreamMessageWriter=W0e});var LMe=H(vG=>{"use strict";d();Object.defineProperty(vG,"__esModule",{value:!0});vG.AbstractMessageBuffer=void 0;var F5t=13,O5t=10,Q5t=`\r
`,j0e=class{static{s(this,"AbstractMessageBuffer")}constructor(e="utf-8"){this._encoding=e,this._chunks=[],this._totalLength=0}get encoding(){return this._encoding}append(e){let r=typeof e=="string"?this.fromString(e,this._encoding):e;this._chunks.push(r),this._totalLength+=r.byteLength}tryReadHeaders(e=!1){if(this._chunks.length===0)return;let r=0,n=0,i=0,o=0;e:for(;n<this._chunks.length;){let u=this._chunks[n];for(i=0;i<u.length;){switch(u[i]){case F5t:switch(r){case 0:r=1;break;case 2:r=3;break;default:r=0}break;case O5t:switch(r){case 1:r=2;break;case 3:r=4,i++;break e;default:r=0}break;default:r=0}i++}o+=u.byteLength,n++}if(r!==4)return;let a=this._read(o+i),c=new Map,l=this.toString(a,"ascii").split(Q5t);if(l.length<2)return c;for(let u=0;u<l.length-2;u++){let f=l[u],p=f.indexOf(":");if(p===-1)throw new Error(`Message header must separate key and value using ':'
${f}`);let m=f.substr(0,p),h=f.substr(p+1).trim();c.set(e?m.toLowerCase():m,h)}return c}tryReadBody(e){if(!(this._totalLength<e))return this._read(e)}get numberOfBytes(){return this._totalLength}_read(e){if(e===0)return this.emptyBuffer();if(e>this._totalLength)throw new Error("Cannot read so many bytes!");if(this._chunks[0].byteLength===e){let o=this._chunks[0];return this._chunks.shift(),this._totalLength-=e,this.asNative(o)}if(this._chunks[0].byteLength>e){let o=this._chunks[0],a=this.asNative(o,e);return this._chunks[0]=o.slice(e),this._totalLength-=e,a}let r=this.allocNative(e),n=0,i=0;for(;e>0;){let o=this._chunks[i];if(o.byteLength>e){let a=o.slice(0,e);r.set(a,n),n+=e,this._chunks[i]=o.slice(e),this._totalLength-=e,e-=e}else r.set(o,n),n+=o.byteLength,this._chunks.shift(),this._totalLength-=o.byteLength,e-=o.byteLength}return r}};vG.AbstractMessageBuffer=j0e});var qMe=H(mi=>{"use strict";d();Object.defineProperty(mi,"__esModule",{value:!0});mi.createMessageConnection=mi.ConnectionOptions=mi.MessageStrategy=mi.CancellationStrategy=mi.CancellationSenderStrategy=mi.CancellationReceiverStrategy=mi.RequestCancellationReceiverStrategy=mi.IdCancellationReceiverStrategy=mi.ConnectionStrategy=mi.ConnectionError=mi.ConnectionErrors=mi.LogTraceNotification=mi.SetTraceNotification=mi.TraceFormat=mi.TraceValues=mi.Trace=mi.NullLogger=mi.ProgressType=mi.ProgressToken=void 0;var FMe=PI(),za=dD(),qn=I0e(),OMe=w0e(),c9=pD(),G0e=gG(),d9;(function(t){t.type=new qn.NotificationType("$/cancelRequest")})(d9||(d9={}));var V0e;(function(t){function e(r){return typeof r=="string"||typeof r=="number"}s(e,"is"),t.is=e})(V0e||(mi.ProgressToken=V0e={}));var l9;(function(t){t.type=new qn.NotificationType("$/progress")})(l9||(l9={}));var z0e=class{static{s(this,"ProgressType")}constructor(){}};mi.ProgressType=z0e;var K0e;(function(t){function e(r){return za.func(r)}s(e,"is"),t.is=e})(K0e||(K0e={}));mi.NullLogger=Object.freeze({error:s(()=>{},"error"),warn:s(()=>{},"warn"),info:s(()=>{},"info"),log:s(()=>{},"log")});var Yo;(function(t){t[t.Off=0]="Off",t[t.Messages=1]="Messages",t[t.Compact=2]="Compact",t[t.Verbose=3]="Verbose"})(Yo||(mi.Trace=Yo={}));var QMe;(function(t){t.Off="off",t.Messages="messages",t.Compact="compact",t.Verbose="verbose"})(QMe||(mi.TraceValues=QMe={}));(function(t){function e(n){if(!za.string(n))return t.Off;switch(n=n.toLowerCase(),n){case"off":return t.Off;case"messages":return t.Messages;case"compact":return t.Compact;case"verbose":return t.Verbose;default:return t.Off}}s(e,"fromString"),t.fromString=e;function r(n){switch(n){case t.Off:return"off";case t.Messages:return"messages";case t.Compact:return"compact";case t.Verbose:return"verbose";default:return"off"}}s(r,"toString"),t.toString=r})(Yo||(mi.Trace=Yo={}));var E0;(function(t){t.Text="text",t.JSON="json"})(E0||(mi.TraceFormat=E0={}));(function(t){function e(r){return za.string(r)?(r=r.toLowerCase(),r==="json"?t.JSON:t.Text):t.Text}s(e,"fromString"),t.fromString=e})(E0||(mi.TraceFormat=E0={}));var Y0e;(function(t){t.type=new qn.NotificationType("$/setTrace")})(Y0e||(mi.SetTraceNotification=Y0e={}));var xG;(function(t){t.type=new qn.NotificationType("$/logTrace")})(xG||(mi.LogTraceNotification=xG={}));var u9;(function(t){t[t.Closed=1]="Closed",t[t.Disposed=2]="Disposed",t[t.AlreadyListening=3]="AlreadyListening"})(u9||(mi.ConnectionErrors=u9={}));var AD=class t extends Error{static{s(this,"ConnectionError")}constructor(e,r){super(r),this.code=e,Object.setPrototypeOf(this,t.prototype)}};mi.ConnectionError=AD;var J0e;(function(t){function e(r){let n=r;return n&&za.func(n.cancelUndispatched)}s(e,"is"),t.is=e})(J0e||(mi.ConnectionStrategy=J0e={}));var EG;(function(t){function e(r){let n=r;return n&&(n.kind===void 0||n.kind==="id")&&za.func(n.createCancellationTokenSource)&&(n.dispose===void 0||za.func(n.dispose))}s(e,"is"),t.is=e})(EG||(mi.IdCancellationReceiverStrategy=EG={}));var X0e;(function(t){function e(r){let n=r;return n&&n.kind==="request"&&za.func(n.createCancellationTokenSource)&&(n.dispose===void 0||za.func(n.dispose))}s(e,"is"),t.is=e})(X0e||(mi.RequestCancellationReceiverStrategy=X0e={}));var bG;(function(t){t.Message=Object.freeze({createCancellationTokenSource(r){return new G0e.CancellationTokenSource}});function e(r){return EG.is(r)||X0e.is(r)}s(e,"is"),t.is=e})(bG||(mi.CancellationReceiverStrategy=bG={}));var IG;(function(t){t.Message=Object.freeze({sendCancellation(r,n){return r.sendNotification(d9.type,{id:n})},cleanup(r){}});function e(r){let n=r;return n&&za.func(n.sendCancellation)&&za.func(n.cleanup)}s(e,"is"),t.is=e})(IG||(mi.CancellationSenderStrategy=IG={}));var TG;(function(t){t.Message=Object.freeze({receiver:bG.Message,sender:IG.Message});function e(r){let n=r;return n&&bG.is(n.receiver)&&IG.is(n.sender)}s(e,"is"),t.is=e})(TG||(mi.CancellationStrategy=TG={}));var wG;(function(t){function e(r){let n=r;return n&&za.func(n.handleMessage)}s(e,"is"),t.is=e})(wG||(mi.MessageStrategy=wG={}));var UMe;(function(t){function e(r){let n=r;return n&&(TG.is(n.cancellationStrategy)||J0e.is(n.connectionStrategy)||wG.is(n.messageStrategy))}s(e,"is"),t.is=e})(UMe||(mi.ConnectionOptions=UMe={}));var lA;(function(t){t[t.New=1]="New",t[t.Listening=2]="Listening",t[t.Closed=3]="Closed",t[t.Disposed=4]="Disposed"})(lA||(lA={}));function U5t(t,e,r,n){let i=r!==void 0?r:mi.NullLogger,o=0,a=0,c=0,l="2.0",u,f=new Map,p,m=new Map,h=new Map,g,A=new OMe.LinkedMap,y=new Map,E=new Set,b=new Map,S=Yo.Off,R=E0.Text,B,L=lA.New,O=new c9.Emitter,Y=new c9.Emitter,V=new c9.Emitter,z=new c9.Emitter,Q=new c9.Emitter,U=n&&n.cancellationStrategy?n.cancellationStrategy:TG.Message;function Z(ve){if(ve===null)throw new Error("Can't send requests with id null since the response can't be correlated.");return"req-"+ve.toString()}s(Z,"createRequestQueueKey");function J(ve){return ve===null?"res-unknown-"+(++c).toString():"res-"+ve.toString()}s(J,"createResponseQueueKey");function j(){return"not-"+(++a).toString()}s(j,"createNotificationQueueKey");function W(ve,Ge){qn.Message.isRequest(Ge)?ve.set(Z(Ge.id),Ge):qn.Message.isResponse(Ge)?ve.set(J(Ge.id),Ge):ve.set(j(),Ge)}s(W,"addMessageToQueue");function X(ve){}s(X,"cancelUndispatched");function oe(){return L===lA.Listening}s(oe,"isListening");function te(){return L===lA.Closed}s(te,"isClosed");function re(){return L===lA.Disposed}s(re,"isDisposed");function pe(){(L===lA.New||L===lA.Listening)&&(L=lA.Closed,Y.fire(void 0))}s(pe,"closeHandler");function Ae(ve){O.fire([ve,void 0,void 0])}s(Ae,"readErrorHandler");function Oe(ve){O.fire(ve)}s(Oe,"writeErrorHandler"),t.onClose(pe),t.onError(Ae),e.onClose(pe),e.onError(Oe);function Te(){g||A.size===0||(g=(0,FMe.default)().timer.setImmediate(()=>{g=void 0,Fe()}))}s(Te,"triggerMessageQueue");function Je(ve){qn.Message.isRequest(ve)?_t(ve):qn.Message.isNotification(ve)?gt(ve):qn.Message.isResponse(ve)?xt(ve):ue(ve)}s(Je,"handleMessage");function Fe(){if(A.size===0)return;let ve=A.shift();try{let Ge=n?.messageStrategy;wG.is(Ge)?Ge.handleMessage(ve,Je):Je(ve)}finally{Te()}}s(Fe,"processMessageQueue");let lt=s(ve=>{try{if(qn.Message.isNotification(ve)&&ve.method===d9.type.method){let Ge=ve.params.id,pt=Z(Ge),Tt=A.get(pt);if(qn.Message.isRequest(Tt)){let Zt=n?.connectionStrategy,Tr=Zt&&Zt.cancelUndispatched?Zt.cancelUndispatched(Tt,X):void 0;if(Tr&&(Tr.error!==void 0||Tr.result!==void 0)){A.delete(pt),b.delete(Ge),Tr.id=Tt.id,ae(Tr,ve.method,Date.now()),e.write(Tr).catch(()=>i.error("Sending response for canceled message failed."));return}}let or=b.get(Ge);if(or!==void 0){or.cancel(),qe(ve);return}else E.add(Ge)}W(A,ve)}finally{Te()}},"callback");function _t(ve){if(re())return;function Ge(rr,ur,nr){let Mr={jsonrpc:l,id:ve.id};rr instanceof qn.ResponseError?Mr.error=rr.toJson():Mr.result=rr===void 0?null:rr,ae(Mr,ur,nr),e.write(Mr).catch(()=>i.error("Sending response failed."))}s(Ge,"reply");function pt(rr,ur,nr){let Mr={jsonrpc:l,id:ve.id,error:rr.toJson()};ae(Mr,ur,nr),e.write(Mr).catch(()=>i.error("Sending response failed."))}s(pt,"replyError");function Tt(rr,ur,nr){rr===void 0&&(rr=null);let Mr={jsonrpc:l,id:ve.id,result:rr};ae(Mr,ur,nr),e.write(Mr).catch(()=>i.error("Sending response failed."))}s(Tt,"replySuccess"),le(ve);let or=f.get(ve.method),Zt,Tr;or&&(Zt=or.type,Tr=or.handler);let fr=Date.now();if(Tr||u){let rr=ve.id??String(Date.now()),ur=EG.is(U.receiver)?U.receiver.createCancellationTokenSource(rr):U.receiver.createCancellationTokenSource(ve);ve.id!==null&&E.has(ve.id)&&ur.cancel(),ve.id!==null&&b.set(rr,ur);try{let nr;if(Tr)if(ve.params===void 0){if(Zt!==void 0&&Zt.numberOfParams!==0){pt(new qn.ResponseError(qn.ErrorCodes.InvalidParams,`Request ${ve.method} defines ${Zt.numberOfParams} params but received none.`),ve.method,fr);return}nr=Tr(ur.token)}else if(Array.isArray(ve.params)){if(Zt!==void 0&&Zt.parameterStructures===qn.ParameterStructures.byName){pt(new qn.ResponseError(qn.ErrorCodes.InvalidParams,`Request ${ve.method} defines parameters by name but received parameters by position`),ve.method,fr);return}nr=Tr(...ve.params,ur.token)}else{if(Zt!==void 0&&Zt.parameterStructures===qn.ParameterStructures.byPosition){pt(new qn.ResponseError(qn.ErrorCodes.InvalidParams,`Request ${ve.method} defines parameters by position but received parameters by name`),ve.method,fr);return}nr=Tr(ve.params,ur.token)}else u&&(nr=u(ve.method,ve.params,ur.token));let Mr=nr;nr?Mr.then?Mr.then(Kr=>{b.delete(rr),Ge(Kr,ve.method,fr)},Kr=>{b.delete(rr),Kr instanceof qn.ResponseError?pt(Kr,ve.method,fr):Kr&&za.string(Kr.message)?pt(new qn.ResponseError(qn.ErrorCodes.InternalError,`Request ${ve.method} failed with message: ${Kr.message}`),ve.method,fr):pt(new qn.ResponseError(qn.ErrorCodes.InternalError,`Request ${ve.method} failed unexpectedly without providing any details.`),ve.method,fr)}):(b.delete(rr),Ge(nr,ve.method,fr)):(b.delete(rr),Tt(nr,ve.method,fr))}catch(nr){b.delete(rr),nr instanceof qn.ResponseError?Ge(nr,ve.method,fr):nr&&za.string(nr.message)?pt(new qn.ResponseError(qn.ErrorCodes.InternalError,`Request ${ve.method} failed with message: ${nr.message}`),ve.method,fr):pt(new qn.ResponseError(qn.ErrorCodes.InternalError,`Request ${ve.method} failed unexpectedly without providing any details.`),ve.method,fr)}}else pt(new qn.ResponseError(qn.ErrorCodes.MethodNotFound,`Unhandled method ${ve.method}`),ve.method,fr)}s(_t,"handleRequest");function xt(ve){if(!re())if(ve.id===null)ve.error?i.error(`Received response message without id: Error is: 
${JSON.stringify(ve.error,void 0,4)}`):i.error("Received response message without id. No further error information provided.");else{let Ge=ve.id,pt=y.get(Ge);if(Ne(ve,pt),pt!==void 0){y.delete(Ge);try{if(ve.error){let Tt=ve.error;pt.reject(new qn.ResponseError(Tt.code,Tt.message,Tt.data))}else if(ve.result!==void 0)pt.resolve(ve.result);else throw new Error("Should never happen.")}catch(Tt){Tt.message?i.error(`Response handler '${pt.method}' failed with message: ${Tt.message}`):i.error(`Response handler '${pt.method}' failed unexpectedly.`)}}}}s(xt,"handleResponse");function gt(ve){if(re())return;let Ge,pt;if(ve.method===d9.type.method){let Tt=ve.params.id;E.delete(Tt),qe(ve);return}else{let Tt=m.get(ve.method);Tt&&(pt=Tt.handler,Ge=Tt.type)}if(pt||p)try{if(qe(ve),pt)if(ve.params===void 0)Ge!==void 0&&Ge.numberOfParams!==0&&Ge.parameterStructures!==qn.ParameterStructures.byName&&i.error(`Notification ${ve.method} defines ${Ge.numberOfParams} params but received none.`),pt();else if(Array.isArray(ve.params)){let Tt=ve.params;ve.method===l9.type.method&&Tt.length===2&&V0e.is(Tt[0])?pt({token:Tt[0],value:Tt[1]}):(Ge!==void 0&&(Ge.parameterStructures===qn.ParameterStructures.byName&&i.error(`Notification ${ve.method} defines parameters by name but received parameters by position`),Ge.numberOfParams!==ve.params.length&&i.error(`Notification ${ve.method} defines ${Ge.numberOfParams} params but received ${Tt.length} arguments`)),pt(...Tt))}else Ge!==void 0&&Ge.parameterStructures===qn.ParameterStructures.byPosition&&i.error(`Notification ${ve.method} defines parameters by position but received parameters by name`),pt(ve.params);else p&&p(ve.method,ve.params)}catch(Tt){Tt.message?i.error(`Notification handler '${ve.method}' failed with message: ${Tt.message}`):i.error(`Notification handler '${ve.method}' failed unexpectedly.`)}else V.fire(ve)}s(gt,"handleNotification");function ue(ve){if(!ve){i.error("Received empty message.");return}i.error(`Received message which is neither a response nor a notification message:
${JSON.stringify(ve,null,4)}`);let Ge=ve;if(za.string(Ge.id)||za.number(Ge.id)){let pt=Ge.id,Tt=y.get(pt);Tt&&Tt.reject(new Error("The received response has neither a result nor an error property."))}}s(ue,"handleInvalidMessage");function Ue(ve){if(ve!=null)switch(S){case Yo.Verbose:return JSON.stringify(ve,null,4);case Yo.Compact:return JSON.stringify(ve);default:return}}s(Ue,"stringifyTrace");function ye(ve){if(!(S===Yo.Off||!B))if(R===E0.Text){let Ge;(S===Yo.Verbose||S===Yo.Compact)&&ve.params&&(Ge=`Params: ${Ue(ve.params)}

`),B.log(`Sending request '${ve.method} - (${ve.id})'.`,Ge)}else Ee("send-request",ve)}s(ye,"traceSendingRequest");function $e(ve){if(!(S===Yo.Off||!B))if(R===E0.Text){let Ge;(S===Yo.Verbose||S===Yo.Compact)&&(ve.params?Ge=`Params: ${Ue(ve.params)}

`:Ge=`No parameters provided.

`),B.log(`Sending notification '${ve.method}'.`,Ge)}else Ee("send-notification",ve)}s($e,"traceSendingNotification");function ae(ve,Ge,pt){if(!(S===Yo.Off||!B))if(R===E0.Text){let Tt;(S===Yo.Verbose||S===Yo.Compact)&&(ve.error&&ve.error.data?Tt=`Error data: ${Ue(ve.error.data)}

`:ve.result?Tt=`Result: ${Ue(ve.result)}

`:ve.error===void 0&&(Tt=`No result returned.

`)),B.log(`Sending response '${Ge} - (${ve.id})'. Processing request took ${Date.now()-pt}ms`,Tt)}else Ee("send-response",ve)}s(ae,"traceSendingResponse");function le(ve){if(!(S===Yo.Off||!B))if(R===E0.Text){let Ge;(S===Yo.Verbose||S===Yo.Compact)&&ve.params&&(Ge=`Params: ${Ue(ve.params)}

`),B.log(`Received request '${ve.method} - (${ve.id})'.`,Ge)}else Ee("receive-request",ve)}s(le,"traceReceivedRequest");function qe(ve){if(!(S===Yo.Off||!B||ve.method===xG.type.method))if(R===E0.Text){let Ge;(S===Yo.Verbose||S===Yo.Compact)&&(ve.params?Ge=`Params: ${Ue(ve.params)}

`:Ge=`No parameters provided.

`),B.log(`Received notification '${ve.method}'.`,Ge)}else Ee("receive-notification",ve)}s(qe,"traceReceivedNotification");function Ne(ve,Ge){if(!(S===Yo.Off||!B))if(R===E0.Text){let pt;if((S===Yo.Verbose||S===Yo.Compact)&&(ve.error&&ve.error.data?pt=`Error data: ${Ue(ve.error.data)}

`:ve.result?pt=`Result: ${Ue(ve.result)}

`:ve.error===void 0&&(pt=`No result returned.

`)),Ge){let Tt=ve.error?` Request failed: ${ve.error.message} (${ve.error.code}).`:"";B.log(`Received response '${Ge.method} - (${ve.id})' in ${Date.now()-Ge.timerStart}ms.${Tt}`,pt)}else B.log(`Received response ${ve.id} without active response promise.`,pt)}else Ee("receive-response",ve)}s(Ne,"traceReceivedResponse");function Ee(ve,Ge){if(!B||S===Yo.Off)return;let pt={isLSPMessage:!0,type:ve,message:Ge,timestamp:Date.now()};B.log(pt)}s(Ee,"logLSPMessage");function je(){if(te())throw new AD(u9.Closed,"Connection is closed.");if(re())throw new AD(u9.Disposed,"Connection is disposed.")}s(je,"throwIfClosedOrDisposed");function tt(){if(oe())throw new AD(u9.AlreadyListening,"Connection is already listening")}s(tt,"throwIfListening");function mt(){if(!oe())throw new Error("Call listen() first.")}s(mt,"throwIfNotListening");function Ft(ve){return ve===void 0?null:ve}s(Ft,"undefinedToNull");function Jt(ve){if(ve!==null)return ve}s(Jt,"nullToUndefined");function Qt(ve){return ve!=null&&!Array.isArray(ve)&&typeof ve=="object"}s(Qt,"isNamedParam");function zr(ve,Ge){switch(ve){case qn.ParameterStructures.auto:return Qt(Ge)?Jt(Ge):[Ft(Ge)];case qn.ParameterStructures.byName:if(!Qt(Ge))throw new Error("Received parameters by name but param is not an object literal.");return Jt(Ge);case qn.ParameterStructures.byPosition:return[Ft(Ge)];default:throw new Error(`Unknown parameter structure ${ve.toString()}`)}}s(zr,"computeSingleParam");function Br(ve,Ge){let pt,Tt=ve.numberOfParams;switch(Tt){case 0:pt=void 0;break;case 1:pt=zr(ve.parameterStructures,Ge[0]);break;default:pt=[];for(let or=0;or<Ge.length&&or<Tt;or++)pt.push(Ft(Ge[or]));if(Ge.length<Tt)for(let or=Ge.length;or<Tt;or++)pt.push(null);break}return pt}s(Br,"computeMessageParams");let un={sendNotification:s((ve,...Ge)=>{je();let pt,Tt;if(za.string(ve)){pt=ve;let Zt=Ge[0],Tr=0,fr=qn.ParameterStructures.auto;qn.ParameterStructures.is(Zt)&&(Tr=1,fr=Zt);let rr=Ge.length,ur=rr-Tr;switch(ur){case 0:Tt=void 0;break;case 1:Tt=zr(fr,Ge[Tr]);break;default:if(fr===qn.ParameterStructures.byName)throw new Error(`Received ${ur} parameters for 'by Name' notification parameter structure.`);Tt=Ge.slice(Tr,rr).map(nr=>Ft(nr));break}}else{let Zt=Ge;pt=ve.method,Tt=Br(ve,Zt)}let or={jsonrpc:l,method:pt,params:Tt};return $e(or),e.write(or).catch(Zt=>{throw i.error("Sending notification failed."),Zt})},"sendNotification"),onNotification:s((ve,Ge)=>{je();let pt;return za.func(ve)?p=ve:Ge&&(za.string(ve)?(pt=ve,m.set(ve,{type:void 0,handler:Ge})):(pt=ve.method,m.set(ve.method,{type:ve,handler:Ge}))),{dispose:s(()=>{pt!==void 0?m.delete(pt):p=void 0},"dispose")}},"onNotification"),onProgress:s((ve,Ge,pt)=>{if(h.has(Ge))throw new Error(`Progress handler for token ${Ge} already registered`);return h.set(Ge,pt),{dispose:s(()=>{h.delete(Ge)},"dispose")}},"onProgress"),sendProgress:s((ve,Ge,pt)=>un.sendNotification(l9.type,{token:Ge,value:pt}),"sendProgress"),onUnhandledProgress:z.event,sendRequest:s((ve,...Ge)=>{je(),mt();let pt,Tt,or;if(za.string(ve)){pt=ve;let rr=Ge[0],ur=Ge[Ge.length-1],nr=0,Mr=qn.ParameterStructures.auto;qn.ParameterStructures.is(rr)&&(nr=1,Mr=rr);let Kr=Ge.length;G0e.CancellationToken.is(ur)&&(Kr=Kr-1,or=ur);let sn=Kr-nr;switch(sn){case 0:Tt=void 0;break;case 1:Tt=zr(Mr,Ge[nr]);break;default:if(Mr===qn.ParameterStructures.byName)throw new Error(`Received ${sn} parameters for 'by Name' request parameter structure.`);Tt=Ge.slice(nr,Kr).map(Cn=>Ft(Cn));break}}else{let rr=Ge;pt=ve.method,Tt=Br(ve,rr);let ur=ve.numberOfParams;or=G0e.CancellationToken.is(rr[ur])?rr[ur]:void 0}let Zt=o++,Tr;or&&(Tr=or.onCancellationRequested(()=>{let rr=U.sender.sendCancellation(un,Zt);return rr===void 0?(i.log(`Received no promise from cancellation strategy when cancelling id ${Zt}`),Promise.resolve()):rr.catch(()=>{i.log(`Sending cancellation messages for id ${Zt} failed`)})}));let fr={jsonrpc:l,id:Zt,method:pt,params:Tt};return ye(fr),typeof U.sender.enableCancellation=="function"&&U.sender.enableCancellation(fr),new Promise(async(rr,ur)=>{let nr=s(sn=>{rr(sn),U.sender.cleanup(Zt),Tr?.dispose()},"resolveWithCleanup"),Mr=s(sn=>{ur(sn),U.sender.cleanup(Zt),Tr?.dispose()},"rejectWithCleanup"),Kr={method:pt,timerStart:Date.now(),resolve:nr,reject:Mr};try{await e.write(fr),y.set(Zt,Kr)}catch(sn){throw i.error("Sending request failed."),Kr.reject(new qn.ResponseError(qn.ErrorCodes.MessageWriteError,sn.message?sn.message:"Unknown reason")),sn}})},"sendRequest"),onRequest:s((ve,Ge)=>{je();let pt=null;return K0e.is(ve)?(pt=void 0,u=ve):za.string(ve)?(pt=null,Ge!==void 0&&(pt=ve,f.set(ve,{handler:Ge,type:void 0}))):Ge!==void 0&&(pt=ve.method,f.set(ve.method,{type:ve,handler:Ge})),{dispose:s(()=>{pt!==null&&(pt!==void 0?f.delete(pt):u=void 0)},"dispose")}},"onRequest"),hasPendingResponse:s(()=>y.size>0,"hasPendingResponse"),trace:s(async(ve,Ge,pt)=>{let Tt=!1,or=E0.Text;pt!==void 0&&(za.boolean(pt)?Tt=pt:(Tt=pt.sendNotification||!1,or=pt.traceFormat||E0.Text)),S=ve,R=or,S===Yo.Off?B=void 0:B=Ge,Tt&&!te()&&!re()&&await un.sendNotification(Y0e.type,{value:Yo.toString(ve)})},"trace"),onError:O.event,onClose:Y.event,onUnhandledNotification:V.event,onDispose:Q.event,end:s(()=>{e.end()},"end"),dispose:s(()=>{if(re())return;L=lA.Disposed,Q.fire(void 0);let ve=new qn.ResponseError(qn.ErrorCodes.PendingResponseRejected,"Pending response rejected since connection got disposed");for(let Ge of y.values())Ge.reject(ve);y=new Map,b=new Map,E=new Set,A=new OMe.LinkedMap,za.func(e.dispose)&&e.dispose(),za.func(t.dispose)&&t.dispose()},"dispose"),listen:s(()=>{je(),tt(),L=lA.Listening,t.listen(lt)},"listen"),inspect:s(()=>{(0,FMe.default)().console.log("inspect")},"inspect")};return un.onNotification(xG.type,ve=>{if(S===Yo.Off||!B)return;let Ge=S===Yo.Verbose||S===Yo.Compact;B.log(ve.message,Ge?ve.verbose:void 0)}),un.onNotification(l9.type,ve=>{let Ge=h.get(ve.token);Ge?Ge(ve.value):z.fire(ve)}),un}s(U5t,"createMessageConnection");mi.createMessageConnection=U5t});var SG=H(yt=>{"use strict";d();Object.defineProperty(yt,"__esModule",{value:!0});yt.ProgressType=yt.ProgressToken=yt.createMessageConnection=yt.NullLogger=yt.ConnectionOptions=yt.ConnectionStrategy=yt.AbstractMessageBuffer=yt.WriteableStreamMessageWriter=yt.AbstractMessageWriter=yt.MessageWriter=yt.ReadableStreamMessageReader=yt.AbstractMessageReader=yt.MessageReader=yt.SharedArrayReceiverStrategy=yt.SharedArraySenderStrategy=yt.CancellationToken=yt.CancellationTokenSource=yt.Emitter=yt.Event=yt.Disposable=yt.LRUCache=yt.Touch=yt.LinkedMap=yt.ParameterStructures=yt.NotificationType9=yt.NotificationType8=yt.NotificationType7=yt.NotificationType6=yt.NotificationType5=yt.NotificationType4=yt.NotificationType3=yt.NotificationType2=yt.NotificationType1=yt.NotificationType0=yt.NotificationType=yt.ErrorCodes=yt.ResponseError=yt.RequestType9=yt.RequestType8=yt.RequestType7=yt.RequestType6=yt.RequestType5=yt.RequestType4=yt.RequestType3=yt.RequestType2=yt.RequestType1=yt.RequestType0=yt.RequestType=yt.Message=yt.RAL=void 0;yt.MessageStrategy=yt.CancellationStrategy=yt.CancellationSenderStrategy=yt.CancellationReceiverStrategy=yt.ConnectionError=yt.ConnectionErrors=yt.LogTraceNotification=yt.SetTraceNotification=yt.TraceFormat=yt.TraceValues=yt.Trace=void 0;var Os=I0e();Object.defineProperty(yt,"Message",{enumerable:!0,get:s(function(){return Os.Message},"get")});Object.defineProperty(yt,"RequestType",{enumerable:!0,get:s(function(){return Os.RequestType},"get")});Object.defineProperty(yt,"RequestType0",{enumerable:!0,get:s(function(){return Os.RequestType0},"get")});Object.defineProperty(yt,"RequestType1",{enumerable:!0,get:s(function(){return Os.RequestType1},"get")});Object.defineProperty(yt,"RequestType2",{enumerable:!0,get:s(function(){return Os.RequestType2},"get")});Object.defineProperty(yt,"RequestType3",{enumerable:!0,get:s(function(){return Os.RequestType3},"get")});Object.defineProperty(yt,"RequestType4",{enumerable:!0,get:s(function(){return Os.RequestType4},"get")});Object.defineProperty(yt,"RequestType5",{enumerable:!0,get:s(function(){return Os.RequestType5},"get")});Object.defineProperty(yt,"RequestType6",{enumerable:!0,get:s(function(){return Os.RequestType6},"get")});Object.defineProperty(yt,"RequestType7",{enumerable:!0,get:s(function(){return Os.RequestType7},"get")});Object.defineProperty(yt,"RequestType8",{enumerable:!0,get:s(function(){return Os.RequestType8},"get")});Object.defineProperty(yt,"RequestType9",{enumerable:!0,get:s(function(){return Os.RequestType9},"get")});Object.defineProperty(yt,"ResponseError",{enumerable:!0,get:s(function(){return Os.ResponseError},"get")});Object.defineProperty(yt,"ErrorCodes",{enumerable:!0,get:s(function(){return Os.ErrorCodes},"get")});Object.defineProperty(yt,"NotificationType",{enumerable:!0,get:s(function(){return Os.NotificationType},"get")});Object.defineProperty(yt,"NotificationType0",{enumerable:!0,get:s(function(){return Os.NotificationType0},"get")});Object.defineProperty(yt,"NotificationType1",{enumerable:!0,get:s(function(){return Os.NotificationType1},"get")});Object.defineProperty(yt,"NotificationType2",{enumerable:!0,get:s(function(){return Os.NotificationType2},"get")});Object.defineProperty(yt,"NotificationType3",{enumerable:!0,get:s(function(){return Os.NotificationType3},"get")});Object.defineProperty(yt,"NotificationType4",{enumerable:!0,get:s(function(){return Os.NotificationType4},"get")});Object.defineProperty(yt,"NotificationType5",{enumerable:!0,get:s(function(){return Os.NotificationType5},"get")});Object.defineProperty(yt,"NotificationType6",{enumerable:!0,get:s(function(){return Os.NotificationType6},"get")});Object.defineProperty(yt,"NotificationType7",{enumerable:!0,get:s(function(){return Os.NotificationType7},"get")});Object.defineProperty(yt,"NotificationType8",{enumerable:!0,get:s(function(){return Os.NotificationType8},"get")});Object.defineProperty(yt,"NotificationType9",{enumerable:!0,get:s(function(){return Os.NotificationType9},"get")});Object.defineProperty(yt,"ParameterStructures",{enumerable:!0,get:s(function(){return Os.ParameterStructures},"get")});var Z0e=w0e();Object.defineProperty(yt,"LinkedMap",{enumerable:!0,get:s(function(){return Z0e.LinkedMap},"get")});Object.defineProperty(yt,"LRUCache",{enumerable:!0,get:s(function(){return Z0e.LRUCache},"get")});Object.defineProperty(yt,"Touch",{enumerable:!0,get:s(function(){return Z0e.Touch},"get")});var q5t=wMe();Object.defineProperty(yt,"Disposable",{enumerable:!0,get:s(function(){return q5t.Disposable},"get")});var HMe=pD();Object.defineProperty(yt,"Event",{enumerable:!0,get:s(function(){return HMe.Event},"get")});Object.defineProperty(yt,"Emitter",{enumerable:!0,get:s(function(){return HMe.Emitter},"get")});var $Me=gG();Object.defineProperty(yt,"CancellationTokenSource",{enumerable:!0,get:s(function(){return $Me.CancellationTokenSource},"get")});Object.defineProperty(yt,"CancellationToken",{enumerable:!0,get:s(function(){return $Me.CancellationToken},"get")});var WMe=_Me();Object.defineProperty(yt,"SharedArraySenderStrategy",{enumerable:!0,get:s(function(){return WMe.SharedArraySenderStrategy},"get")});Object.defineProperty(yt,"SharedArrayReceiverStrategy",{enumerable:!0,get:s(function(){return WMe.SharedArrayReceiverStrategy},"get")});var eme=kMe();Object.defineProperty(yt,"MessageReader",{enumerable:!0,get:s(function(){return eme.MessageReader},"get")});Object.defineProperty(yt,"AbstractMessageReader",{enumerable:!0,get:s(function(){return eme.AbstractMessageReader},"get")});Object.defineProperty(yt,"ReadableStreamMessageReader",{enumerable:!0,get:s(function(){return eme.ReadableStreamMessageReader},"get")});var tme=MMe();Object.defineProperty(yt,"MessageWriter",{enumerable:!0,get:s(function(){return tme.MessageWriter},"get")});Object.defineProperty(yt,"AbstractMessageWriter",{enumerable:!0,get:s(function(){return tme.AbstractMessageWriter},"get")});Object.defineProperty(yt,"WriteableStreamMessageWriter",{enumerable:!0,get:s(function(){return tme.WriteableStreamMessageWriter},"get")});var H5t=LMe();Object.defineProperty(yt,"AbstractMessageBuffer",{enumerable:!0,get:s(function(){return H5t.AbstractMessageBuffer},"get")});var $u=qMe();Object.defineProperty(yt,"ConnectionStrategy",{enumerable:!0,get:s(function(){return $u.ConnectionStrategy},"get")});Object.defineProperty(yt,"ConnectionOptions",{enumerable:!0,get:s(function(){return $u.ConnectionOptions},"get")});Object.defineProperty(yt,"NullLogger",{enumerable:!0,get:s(function(){return $u.NullLogger},"get")});Object.defineProperty(yt,"createMessageConnection",{enumerable:!0,get:s(function(){return $u.createMessageConnection},"get")});Object.defineProperty(yt,"ProgressToken",{enumerable:!0,get:s(function(){return $u.ProgressToken},"get")});Object.defineProperty(yt,"ProgressType",{enumerable:!0,get:s(function(){return $u.ProgressType},"get")});Object.defineProperty(yt,"Trace",{enumerable:!0,get:s(function(){return $u.Trace},"get")});Object.defineProperty(yt,"TraceValues",{enumerable:!0,get:s(function(){return $u.TraceValues},"get")});Object.defineProperty(yt,"TraceFormat",{enumerable:!0,get:s(function(){return $u.TraceFormat},"get")});Object.defineProperty(yt,"SetTraceNotification",{enumerable:!0,get:s(function(){return $u.SetTraceNotification},"get")});Object.defineProperty(yt,"LogTraceNotification",{enumerable:!0,get:s(function(){return $u.LogTraceNotification},"get")});Object.defineProperty(yt,"ConnectionErrors",{enumerable:!0,get:s(function(){return $u.ConnectionErrors},"get")});Object.defineProperty(yt,"ConnectionError",{enumerable:!0,get:s(function(){return $u.ConnectionError},"get")});Object.defineProperty(yt,"CancellationReceiverStrategy",{enumerable:!0,get:s(function(){return $u.CancellationReceiverStrategy},"get")});Object.defineProperty(yt,"CancellationSenderStrategy",{enumerable:!0,get:s(function(){return $u.CancellationSenderStrategy},"get")});Object.defineProperty(yt,"CancellationStrategy",{enumerable:!0,get:s(function(){return $u.CancellationStrategy},"get")});Object.defineProperty(yt,"MessageStrategy",{enumerable:!0,get:s(function(){return $u.MessageStrategy},"get")});var $5t=PI();yt.RAL=$5t.default});var VMe=H(ome=>{"use strict";d();Object.defineProperty(ome,"__esModule",{value:!0});var jMe=require("util"),Vv=SG(),_G=class t extends Vv.AbstractMessageBuffer{static{s(this,"MessageBuffer")}constructor(e="utf-8"){super(e)}emptyBuffer(){return t.emptyBuffer}fromString(e,r){return Buffer.from(e,r)}toString(e,r){return e instanceof Buffer?e.toString(r):new jMe.TextDecoder(r).decode(e)}asNative(e,r){return r===void 0?e instanceof Buffer?e:Buffer.from(e):e instanceof Buffer?e.slice(0,r):Buffer.from(e,0,r)}allocNative(e){return Buffer.allocUnsafe(e)}};_G.emptyBuffer=Buffer.allocUnsafe(0);var rme=class{static{s(this,"ReadableStreamWrapper")}constructor(e){this.stream=e}onClose(e){return this.stream.on("close",e),Vv.Disposable.create(()=>this.stream.off("close",e))}onError(e){return this.stream.on("error",e),Vv.Disposable.create(()=>this.stream.off("error",e))}onEnd(e){return this.stream.on("end",e),Vv.Disposable.create(()=>this.stream.off("end",e))}onData(e){return this.stream.on("data",e),Vv.Disposable.create(()=>this.stream.off("data",e))}},nme=class{static{s(this,"WritableStreamWrapper")}constructor(e){this.stream=e}onClose(e){return this.stream.on("close",e),Vv.Disposable.create(()=>this.stream.off("close",e))}onError(e){return this.stream.on("error",e),Vv.Disposable.create(()=>this.stream.off("error",e))}onEnd(e){return this.stream.on("end",e),Vv.Disposable.create(()=>this.stream.off("end",e))}write(e,r){return new Promise((n,i)=>{let o=s(a=>{a==null?n():i(a)},"callback");typeof e=="string"?this.stream.write(e,r,o):this.stream.write(e,o)})}end(){this.stream.end()}},GMe=Object.freeze({messageBuffer:Object.freeze({create:s(t=>new _G(t),"create")}),applicationJson:Object.freeze({encoder:Object.freeze({name:"application/json",encode:s((t,e)=>{try{return Promise.resolve(Buffer.from(JSON.stringify(t,void 0,0),e.charset))}catch(r){return Promise.reject(r)}},"encode")}),decoder:Object.freeze({name:"application/json",decode:s((t,e)=>{try{return t instanceof Buffer?Promise.resolve(JSON.parse(t.toString(e.charset))):Promise.resolve(JSON.parse(new jMe.TextDecoder(e.charset).decode(t)))}catch(r){return Promise.reject(r)}},"decode")})}),stream:Object.freeze({asReadableStream:s(t=>new rme(t),"asReadableStream"),asWritableStream:s(t=>new nme(t),"asWritableStream")}),console,timer:Object.freeze({setTimeout(t,e,...r){let n=setTimeout(t,e,...r);return{dispose:s(()=>clearTimeout(n),"dispose")}},setImmediate(t,...e){let r=setImmediate(t,...e);return{dispose:s(()=>clearImmediate(r),"dispose")}},setInterval(t,e,...r){let n=setInterval(t,e,...r);return{dispose:s(()=>clearInterval(n),"dispose")}}})});function ime(){return GMe}s(ime,"RIL");(function(t){function e(){Vv.RAL.install(GMe)}s(e,"install"),t.install=e})(ime||(ime={}));ome.default=ime});var i2=H(xo=>{"use strict";d();var W5t=xo&&xo.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:s(function(){return e[r]},"get")}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),j5t=xo&&xo.__exportStar||function(t,e){for(var r in t)r!=="default"&&!Object.prototype.hasOwnProperty.call(e,r)&&W5t(e,t,r)};Object.defineProperty(xo,"__esModule",{value:!0});xo.createMessageConnection=xo.createServerSocketTransport=xo.createClientSocketTransport=xo.createServerPipeTransport=xo.createClientPipeTransport=xo.generateRandomPipeName=xo.StreamMessageWriter=xo.StreamMessageReader=xo.SocketMessageWriter=xo.SocketMessageReader=xo.PortMessageWriter=xo.PortMessageReader=xo.IPCMessageWriter=xo.IPCMessageReader=void 0;var yD=VMe();yD.default.install();var zMe=require("path"),G5t=require("os"),V5t=require("crypto"),PG=require("net"),b0=SG();j5t(SG(),xo);var sme=class extends b0.AbstractMessageReader{static{s(this,"IPCMessageReader")}constructor(e){super(),this.process=e;let r=this.process;r.on("error",n=>this.fireError(n)),r.on("close",()=>this.fireClose())}listen(e){return this.process.on("message",e),b0.Disposable.create(()=>this.process.off("message",e))}};xo.IPCMessageReader=sme;var ame=class extends b0.AbstractMessageWriter{static{s(this,"IPCMessageWriter")}constructor(e){super(),this.process=e,this.errorCount=0;let r=this.process;r.on("error",n=>this.fireError(n)),r.on("close",()=>this.fireClose)}write(e){try{return typeof this.process.send=="function"&&this.process.send(e,void 0,void 0,r=>{r?(this.errorCount++,this.handleError(r,e)):this.errorCount=0}),Promise.resolve()}catch(r){return this.handleError(r,e),Promise.reject(r)}}handleError(e,r){this.errorCount++,this.fireError(e,r,this.errorCount)}end(){}};xo.IPCMessageWriter=ame;var cme=class extends b0.AbstractMessageReader{static{s(this,"PortMessageReader")}constructor(e){super(),this.onData=new b0.Emitter,e.on("close",()=>this.fireClose),e.on("error",r=>this.fireError(r)),e.on("message",r=>{this.onData.fire(r)})}listen(e){return this.onData.event(e)}};xo.PortMessageReader=cme;var lme=class extends b0.AbstractMessageWriter{static{s(this,"PortMessageWriter")}constructor(e){super(),this.port=e,this.errorCount=0,e.on("close",()=>this.fireClose()),e.on("error",r=>this.fireError(r))}write(e){try{return this.port.postMessage(e),Promise.resolve()}catch(r){return this.handleError(r,e),Promise.reject(r)}}handleError(e,r){this.errorCount++,this.fireError(e,r,this.errorCount)}end(){}};xo.PortMessageWriter=lme;var r2=class extends b0.ReadableStreamMessageReader{static{s(this,"SocketMessageReader")}constructor(e,r="utf-8"){super((0,yD.default)().stream.asReadableStream(e),r)}};xo.SocketMessageReader=r2;var n2=class extends b0.WriteableStreamMessageWriter{static{s(this,"SocketMessageWriter")}constructor(e,r){super((0,yD.default)().stream.asWritableStream(e),r),this.socket=e}dispose(){super.dispose(),this.socket.destroy()}};xo.SocketMessageWriter=n2;var RG=class extends b0.ReadableStreamMessageReader{static{s(this,"StreamMessageReader")}constructor(e,r){super((0,yD.default)().stream.asReadableStream(e),r)}};xo.StreamMessageReader=RG;var kG=class extends b0.WriteableStreamMessageWriter{static{s(this,"StreamMessageWriter")}constructor(e,r){super((0,yD.default)().stream.asWritableStream(e),r)}};xo.StreamMessageWriter=kG;var KMe=process.env.XDG_RUNTIME_DIR,z5t=new Map([["linux",107],["darwin",103]]);function K5t(){let t=(0,V5t.randomBytes)(21).toString("hex");if(process.platform==="win32")return`\\\\.\\pipe\\vscode-jsonrpc-${t}-sock`;let e;KMe?e=zMe.join(KMe,`vscode-ipc-${t}.sock`):e=zMe.join(G5t.tmpdir(),`vscode-${t}.sock`);let r=z5t.get(process.platform);return r!==void 0&&e.length>r&&(0,yD.default)().console.warn(`WARNING: IPC handle "${e}" is longer than ${r} characters.`),e}s(K5t,"generateRandomPipeName");xo.generateRandomPipeName=K5t;function Y5t(t,e="utf-8"){let r,n=new Promise((i,o)=>{r=i});return new Promise((i,o)=>{let a=(0,PG.createServer)(c=>{a.close(),r([new r2(c,e),new n2(c,e)])});a.on("error",o),a.listen(t,()=>{a.removeListener("error",o),i({onConnected:s(()=>n,"onConnected")})})})}s(Y5t,"createClientPipeTransport");xo.createClientPipeTransport=Y5t;function J5t(t,e="utf-8"){let r=(0,PG.createConnection)(t);return[new r2(r,e),new n2(r,e)]}s(J5t,"createServerPipeTransport");xo.createServerPipeTransport=J5t;function X5t(t,e="utf-8"){let r,n=new Promise((i,o)=>{r=i});return new Promise((i,o)=>{let a=(0,PG.createServer)(c=>{a.close(),r([new r2(c,e),new n2(c,e)])});a.on("error",o),a.listen(t,"127.0.0.1",()=>{a.removeListener("error",o),i({onConnected:s(()=>n,"onConnected")})})})}s(X5t,"createClientSocketTransport");xo.createClientSocketTransport=X5t;function Z5t(t,e="utf-8"){let r=(0,PG.createConnection)(t,"127.0.0.1");return[new r2(r,e),new n2(r,e)]}s(Z5t,"createServerSocketTransport");xo.createServerSocketTransport=Z5t;function e4t(t){let e=t;return e.read!==void 0&&e.addListener!==void 0}s(e4t,"isReadableStream");function t4t(t){let e=t;return e.write!==void 0&&e.addListener!==void 0}s(t4t,"isWritableStream");function r4t(t,e,r,n){r||(r=b0.NullLogger);let i=e4t(t)?new RG(t):t,o=t4t(e)?new kG(e):e;return b0.ConnectionStrategy.is(n)&&(n={connectionStrategy:n}),(0,b0.createMessageConnection)(i,o,r,n)}s(r4t,"createMessageConnection");xo.createMessageConnection=r4t});var ume=H((KGr,YMe)=>{"use strict";d();YMe.exports=i2()});var BG=H((JMe,DG)=>{d();(function(t){if(typeof DG=="object"&&typeof DG.exports=="object"){var e=t(require,JMe);e!==void 0&&(DG.exports=e)}else typeof define=="function"&&define.amd&&define(["require","exports"],t)})(function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.TextDocument=e.EOL=e.WorkspaceFolder=e.InlineCompletionContext=e.SelectedCompletionInfo=e.InlineCompletionTriggerKind=e.InlineCompletionList=e.InlineCompletionItem=e.StringValue=e.InlayHint=e.InlayHintLabelPart=e.InlayHintKind=e.InlineValueContext=e.InlineValueEvaluatableExpression=e.InlineValueVariableLookup=e.InlineValueText=e.SemanticTokens=e.SemanticTokenModifiers=e.SemanticTokenTypes=e.SelectionRange=e.DocumentLink=e.FormattingOptions=e.CodeLens=e.CodeAction=e.CodeActionContext=e.CodeActionTriggerKind=e.CodeActionKind=e.DocumentSymbol=e.WorkspaceSymbol=e.SymbolInformation=e.SymbolTag=e.SymbolKind=e.DocumentHighlight=e.DocumentHighlightKind=e.SignatureInformation=e.ParameterInformation=e.Hover=e.MarkedString=e.CompletionList=e.CompletionItem=e.CompletionItemLabelDetails=e.InsertTextMode=e.InsertReplaceEdit=e.CompletionItemTag=e.InsertTextFormat=e.CompletionItemKind=e.MarkupContent=e.MarkupKind=e.TextDocumentItem=e.OptionalVersionedTextDocumentIdentifier=e.VersionedTextDocumentIdentifier=e.TextDocumentIdentifier=e.WorkspaceChange=e.WorkspaceEdit=e.DeleteFile=e.RenameFile=e.CreateFile=e.TextDocumentEdit=e.AnnotatedTextEdit=e.ChangeAnnotationIdentifier=e.ChangeAnnotation=e.TextEdit=e.Command=e.Diagnostic=e.CodeDescription=e.DiagnosticTag=e.DiagnosticSeverity=e.DiagnosticRelatedInformation=e.FoldingRange=e.FoldingRangeKind=e.ColorPresentation=e.ColorInformation=e.Color=e.LocationLink=e.Location=e.Range=e.Position=e.uinteger=e.integer=e.URI=e.DocumentUri=void 0;var r;(function(K){function Ce(Ie){return typeof Ie=="string"}s(Ce,"is"),K.is=Ce})(r||(e.DocumentUri=r={}));var n;(function(K){function Ce(Ie){return typeof Ie=="string"}s(Ce,"is"),K.is=Ce})(n||(e.URI=n={}));var i;(function(K){K.MIN_VALUE=-2147483648,K.MAX_VALUE=2147483647;function Ce(Ie){return typeof Ie=="number"&&K.MIN_VALUE<=Ie&&Ie<=K.MAX_VALUE}s(Ce,"is"),K.is=Ce})(i||(e.integer=i={}));var o;(function(K){K.MIN_VALUE=0,K.MAX_VALUE=2147483647;function Ce(Ie){return typeof Ie=="number"&&K.MIN_VALUE<=Ie&&Ie<=K.MAX_VALUE}s(Ce,"is"),K.is=Ce})(o||(e.uinteger=o={}));var a;(function(K){function Ce(F,D){return F===Number.MAX_VALUE&&(F=o.MAX_VALUE),D===Number.MAX_VALUE&&(D=o.MAX_VALUE),{line:F,character:D}}s(Ce,"create"),K.create=Ce;function Ie(F){var D=F;return Pe.objectLiteral(D)&&Pe.uinteger(D.line)&&Pe.uinteger(D.character)}s(Ie,"is"),K.is=Ie})(a||(e.Position=a={}));var c;(function(K){function Ce(F,D,ee,ge){if(Pe.uinteger(F)&&Pe.uinteger(D)&&Pe.uinteger(ee)&&Pe.uinteger(ge))return{start:a.create(F,D),end:a.create(ee,ge)};if(a.is(F)&&a.is(D))return{start:F,end:D};throw new Error("Range#create called with invalid arguments[".concat(F,", ").concat(D,", ").concat(ee,", ").concat(ge,"]"))}s(Ce,"create"),K.create=Ce;function Ie(F){var D=F;return Pe.objectLiteral(D)&&a.is(D.start)&&a.is(D.end)}s(Ie,"is"),K.is=Ie})(c||(e.Range=c={}));var l;(function(K){function Ce(F,D){return{uri:F,range:D}}s(Ce,"create"),K.create=Ce;function Ie(F){var D=F;return Pe.objectLiteral(D)&&c.is(D.range)&&(Pe.string(D.uri)||Pe.undefined(D.uri))}s(Ie,"is"),K.is=Ie})(l||(e.Location=l={}));var u;(function(K){function Ce(F,D,ee,ge){return{targetUri:F,targetRange:D,targetSelectionRange:ee,originSelectionRange:ge}}s(Ce,"create"),K.create=Ce;function Ie(F){var D=F;return Pe.objectLiteral(D)&&c.is(D.targetRange)&&Pe.string(D.targetUri)&&c.is(D.targetSelectionRange)&&(c.is(D.originSelectionRange)||Pe.undefined(D.originSelectionRange))}s(Ie,"is"),K.is=Ie})(u||(e.LocationLink=u={}));var f;(function(K){function Ce(F,D,ee,ge){return{red:F,green:D,blue:ee,alpha:ge}}s(Ce,"create"),K.create=Ce;function Ie(F){var D=F;return Pe.objectLiteral(D)&&Pe.numberRange(D.red,0,1)&&Pe.numberRange(D.green,0,1)&&Pe.numberRange(D.blue,0,1)&&Pe.numberRange(D.alpha,0,1)}s(Ie,"is"),K.is=Ie})(f||(e.Color=f={}));var p;(function(K){function Ce(F,D){return{range:F,color:D}}s(Ce,"create"),K.create=Ce;function Ie(F){var D=F;return Pe.objectLiteral(D)&&c.is(D.range)&&f.is(D.color)}s(Ie,"is"),K.is=Ie})(p||(e.ColorInformation=p={}));var m;(function(K){function Ce(F,D,ee){return{label:F,textEdit:D,additionalTextEdits:ee}}s(Ce,"create"),K.create=Ce;function Ie(F){var D=F;return Pe.objectLiteral(D)&&Pe.string(D.label)&&(Pe.undefined(D.textEdit)||B.is(D))&&(Pe.undefined(D.additionalTextEdits)||Pe.typedArray(D.additionalTextEdits,B.is))}s(Ie,"is"),K.is=Ie})(m||(e.ColorPresentation=m={}));var h;(function(K){K.Comment="comment",K.Imports="imports",K.Region="region"})(h||(e.FoldingRangeKind=h={}));var g;(function(K){function Ce(F,D,ee,ge,_e,ut){var St={startLine:F,endLine:D};return Pe.defined(ee)&&(St.startCharacter=ee),Pe.defined(ge)&&(St.endCharacter=ge),Pe.defined(_e)&&(St.kind=_e),Pe.defined(ut)&&(St.collapsedText=ut),St}s(Ce,"create"),K.create=Ce;function Ie(F){var D=F;return Pe.objectLiteral(D)&&Pe.uinteger(D.startLine)&&Pe.uinteger(D.startLine)&&(Pe.undefined(D.startCharacter)||Pe.uinteger(D.startCharacter))&&(Pe.undefined(D.endCharacter)||Pe.uinteger(D.endCharacter))&&(Pe.undefined(D.kind)||Pe.string(D.kind))}s(Ie,"is"),K.is=Ie})(g||(e.FoldingRange=g={}));var A;(function(K){function Ce(F,D){return{location:F,message:D}}s(Ce,"create"),K.create=Ce;function Ie(F){var D=F;return Pe.defined(D)&&l.is(D.location)&&Pe.string(D.message)}s(Ie,"is"),K.is=Ie})(A||(e.DiagnosticRelatedInformation=A={}));var y;(function(K){K.Error=1,K.Warning=2,K.Information=3,K.Hint=4})(y||(e.DiagnosticSeverity=y={}));var E;(function(K){K.Unnecessary=1,K.Deprecated=2})(E||(e.DiagnosticTag=E={}));var b;(function(K){function Ce(Ie){var F=Ie;return Pe.objectLiteral(F)&&Pe.string(F.href)}s(Ce,"is"),K.is=Ce})(b||(e.CodeDescription=b={}));var S;(function(K){function Ce(F,D,ee,ge,_e,ut){var St={range:F,message:D};return Pe.defined(ee)&&(St.severity=ee),Pe.defined(ge)&&(St.code=ge),Pe.defined(_e)&&(St.source=_e),Pe.defined(ut)&&(St.relatedInformation=ut),St}s(Ce,"create"),K.create=Ce;function Ie(F){var D,ee=F;return Pe.defined(ee)&&c.is(ee.range)&&Pe.string(ee.message)&&(Pe.number(ee.severity)||Pe.undefined(ee.severity))&&(Pe.integer(ee.code)||Pe.string(ee.code)||Pe.undefined(ee.code))&&(Pe.undefined(ee.codeDescription)||Pe.string((D=ee.codeDescription)===null||D===void 0?void 0:D.href))&&(Pe.string(ee.source)||Pe.undefined(ee.source))&&(Pe.undefined(ee.relatedInformation)||Pe.typedArray(ee.relatedInformation,A.is))}s(Ie,"is"),K.is=Ie})(S||(e.Diagnostic=S={}));var R;(function(K){function Ce(F,D){for(var ee=[],ge=2;ge<arguments.length;ge++)ee[ge-2]=arguments[ge];var _e={title:F,command:D};return Pe.defined(ee)&&ee.length>0&&(_e.arguments=ee),_e}s(Ce,"create"),K.create=Ce;function Ie(F){var D=F;return Pe.defined(D)&&Pe.string(D.title)&&Pe.string(D.command)}s(Ie,"is"),K.is=Ie})(R||(e.Command=R={}));var B;(function(K){function Ce(ee,ge){return{range:ee,newText:ge}}s(Ce,"replace"),K.replace=Ce;function Ie(ee,ge){return{range:{start:ee,end:ee},newText:ge}}s(Ie,"insert"),K.insert=Ie;function F(ee){return{range:ee,newText:""}}s(F,"del"),K.del=F;function D(ee){var ge=ee;return Pe.objectLiteral(ge)&&Pe.string(ge.newText)&&c.is(ge.range)}s(D,"is"),K.is=D})(B||(e.TextEdit=B={}));var L;(function(K){function Ce(F,D,ee){var ge={label:F};return D!==void 0&&(ge.needsConfirmation=D),ee!==void 0&&(ge.description=ee),ge}s(Ce,"create"),K.create=Ce;function Ie(F){var D=F;return Pe.objectLiteral(D)&&Pe.string(D.label)&&(Pe.boolean(D.needsConfirmation)||D.needsConfirmation===void 0)&&(Pe.string(D.description)||D.description===void 0)}s(Ie,"is"),K.is=Ie})(L||(e.ChangeAnnotation=L={}));var O;(function(K){function Ce(Ie){var F=Ie;return Pe.string(F)}s(Ce,"is"),K.is=Ce})(O||(e.ChangeAnnotationIdentifier=O={}));var Y;(function(K){function Ce(ee,ge,_e){return{range:ee,newText:ge,annotationId:_e}}s(Ce,"replace"),K.replace=Ce;function Ie(ee,ge,_e){return{range:{start:ee,end:ee},newText:ge,annotationId:_e}}s(Ie,"insert"),K.insert=Ie;function F(ee,ge){return{range:ee,newText:"",annotationId:ge}}s(F,"del"),K.del=F;function D(ee){var ge=ee;return B.is(ge)&&(L.is(ge.annotationId)||O.is(ge.annotationId))}s(D,"is"),K.is=D})(Y||(e.AnnotatedTextEdit=Y={}));var V;(function(K){function Ce(F,D){return{textDocument:F,edits:D}}s(Ce,"create"),K.create=Ce;function Ie(F){var D=F;return Pe.defined(D)&&te.is(D.textDocument)&&Array.isArray(D.edits)}s(Ie,"is"),K.is=Ie})(V||(e.TextDocumentEdit=V={}));var z;(function(K){function Ce(F,D,ee){var ge={kind:"create",uri:F};return D!==void 0&&(D.overwrite!==void 0||D.ignoreIfExists!==void 0)&&(ge.options=D),ee!==void 0&&(ge.annotationId=ee),ge}s(Ce,"create"),K.create=Ce;function Ie(F){var D=F;return D&&D.kind==="create"&&Pe.string(D.uri)&&(D.options===void 0||(D.options.overwrite===void 0||Pe.boolean(D.options.overwrite))&&(D.options.ignoreIfExists===void 0||Pe.boolean(D.options.ignoreIfExists)))&&(D.annotationId===void 0||O.is(D.annotationId))}s(Ie,"is"),K.is=Ie})(z||(e.CreateFile=z={}));var Q;(function(K){function Ce(F,D,ee,ge){var _e={kind:"rename",oldUri:F,newUri:D};return ee!==void 0&&(ee.overwrite!==void 0||ee.ignoreIfExists!==void 0)&&(_e.options=ee),ge!==void 0&&(_e.annotationId=ge),_e}s(Ce,"create"),K.create=Ce;function Ie(F){var D=F;return D&&D.kind==="rename"&&Pe.string(D.oldUri)&&Pe.string(D.newUri)&&(D.options===void 0||(D.options.overwrite===void 0||Pe.boolean(D.options.overwrite))&&(D.options.ignoreIfExists===void 0||Pe.boolean(D.options.ignoreIfExists)))&&(D.annotationId===void 0||O.is(D.annotationId))}s(Ie,"is"),K.is=Ie})(Q||(e.RenameFile=Q={}));var U;(function(K){function Ce(F,D,ee){var ge={kind:"delete",uri:F};return D!==void 0&&(D.recursive!==void 0||D.ignoreIfNotExists!==void 0)&&(ge.options=D),ee!==void 0&&(ge.annotationId=ee),ge}s(Ce,"create"),K.create=Ce;function Ie(F){var D=F;return D&&D.kind==="delete"&&Pe.string(D.uri)&&(D.options===void 0||(D.options.recursive===void 0||Pe.boolean(D.options.recursive))&&(D.options.ignoreIfNotExists===void 0||Pe.boolean(D.options.ignoreIfNotExists)))&&(D.annotationId===void 0||O.is(D.annotationId))}s(Ie,"is"),K.is=Ie})(U||(e.DeleteFile=U={}));var Z;(function(K){function Ce(Ie){var F=Ie;return F&&(F.changes!==void 0||F.documentChanges!==void 0)&&(F.documentChanges===void 0||F.documentChanges.every(function(D){return Pe.string(D.kind)?z.is(D)||Q.is(D)||U.is(D):V.is(D)}))}s(Ce,"is"),K.is=Ce})(Z||(e.WorkspaceEdit=Z={}));var J=function(){function K(Ce,Ie){this.edits=Ce,this.changeAnnotations=Ie}return s(K,"TextEditChangeImpl"),K.prototype.insert=function(Ce,Ie,F){var D,ee;if(F===void 0?D=B.insert(Ce,Ie):O.is(F)?(ee=F,D=Y.insert(Ce,Ie,F)):(this.assertChangeAnnotations(this.changeAnnotations),ee=this.changeAnnotations.manage(F),D=Y.insert(Ce,Ie,ee)),this.edits.push(D),ee!==void 0)return ee},K.prototype.replace=function(Ce,Ie,F){var D,ee;if(F===void 0?D=B.replace(Ce,Ie):O.is(F)?(ee=F,D=Y.replace(Ce,Ie,F)):(this.assertChangeAnnotations(this.changeAnnotations),ee=this.changeAnnotations.manage(F),D=Y.replace(Ce,Ie,ee)),this.edits.push(D),ee!==void 0)return ee},K.prototype.delete=function(Ce,Ie){var F,D;if(Ie===void 0?F=B.del(Ce):O.is(Ie)?(D=Ie,F=Y.del(Ce,Ie)):(this.assertChangeAnnotations(this.changeAnnotations),D=this.changeAnnotations.manage(Ie),F=Y.del(Ce,D)),this.edits.push(F),D!==void 0)return D},K.prototype.add=function(Ce){this.edits.push(Ce)},K.prototype.all=function(){return this.edits},K.prototype.clear=function(){this.edits.splice(0,this.edits.length)},K.prototype.assertChangeAnnotations=function(Ce){if(Ce===void 0)throw new Error("Text edit change is not configured to manage change annotations.")},K}(),j=function(){function K(Ce){this._annotations=Ce===void 0?Object.create(null):Ce,this._counter=0,this._size=0}return s(K,"ChangeAnnotations"),K.prototype.all=function(){return this._annotations},Object.defineProperty(K.prototype,"size",{get:s(function(){return this._size},"get"),enumerable:!1,configurable:!0}),K.prototype.manage=function(Ce,Ie){var F;if(O.is(Ce)?F=Ce:(F=this.nextId(),Ie=Ce),this._annotations[F]!==void 0)throw new Error("Id ".concat(F," is already in use."));if(Ie===void 0)throw new Error("No annotation provided for id ".concat(F));return this._annotations[F]=Ie,this._size++,F},K.prototype.nextId=function(){return this._counter++,this._counter.toString()},K}(),W=function(){function K(Ce){var Ie=this;this._textEditChanges=Object.create(null),Ce!==void 0?(this._workspaceEdit=Ce,Ce.documentChanges?(this._changeAnnotations=new j(Ce.changeAnnotations),Ce.changeAnnotations=this._changeAnnotations.all(),Ce.documentChanges.forEach(function(F){if(V.is(F)){var D=new J(F.edits,Ie._changeAnnotations);Ie._textEditChanges[F.textDocument.uri]=D}})):Ce.changes&&Object.keys(Ce.changes).forEach(function(F){var D=new J(Ce.changes[F]);Ie._textEditChanges[F]=D})):this._workspaceEdit={}}return s(K,"WorkspaceChange"),Object.defineProperty(K.prototype,"edit",{get:s(function(){return this.initDocumentChanges(),this._changeAnnotations!==void 0&&(this._changeAnnotations.size===0?this._workspaceEdit.changeAnnotations=void 0:this._workspaceEdit.changeAnnotations=this._changeAnnotations.all()),this._workspaceEdit},"get"),enumerable:!1,configurable:!0}),K.prototype.getTextEditChange=function(Ce){if(te.is(Ce)){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");var Ie={uri:Ce.uri,version:Ce.version},F=this._textEditChanges[Ie.uri];if(!F){var D=[],ee={textDocument:Ie,edits:D};this._workspaceEdit.documentChanges.push(ee),F=new J(D,this._changeAnnotations),this._textEditChanges[Ie.uri]=F}return F}else{if(this.initChanges(),this._workspaceEdit.changes===void 0)throw new Error("Workspace edit is not configured for normal text edit changes.");var F=this._textEditChanges[Ce];if(!F){var D=[];this._workspaceEdit.changes[Ce]=D,F=new J(D),this._textEditChanges[Ce]=F}return F}},K.prototype.initDocumentChanges=function(){this._workspaceEdit.documentChanges===void 0&&this._workspaceEdit.changes===void 0&&(this._changeAnnotations=new j,this._workspaceEdit.documentChanges=[],this._workspaceEdit.changeAnnotations=this._changeAnnotations.all())},K.prototype.initChanges=function(){this._workspaceEdit.documentChanges===void 0&&this._workspaceEdit.changes===void 0&&(this._workspaceEdit.changes=Object.create(null))},K.prototype.createFile=function(Ce,Ie,F){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");var D;L.is(Ie)||O.is(Ie)?D=Ie:F=Ie;var ee,ge;if(D===void 0?ee=z.create(Ce,F):(ge=O.is(D)?D:this._changeAnnotations.manage(D),ee=z.create(Ce,F,ge)),this._workspaceEdit.documentChanges.push(ee),ge!==void 0)return ge},K.prototype.renameFile=function(Ce,Ie,F,D){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");var ee;L.is(F)||O.is(F)?ee=F:D=F;var ge,_e;if(ee===void 0?ge=Q.create(Ce,Ie,D):(_e=O.is(ee)?ee:this._changeAnnotations.manage(ee),ge=Q.create(Ce,Ie,D,_e)),this._workspaceEdit.documentChanges.push(ge),_e!==void 0)return _e},K.prototype.deleteFile=function(Ce,Ie,F){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");var D;L.is(Ie)||O.is(Ie)?D=Ie:F=Ie;var ee,ge;if(D===void 0?ee=U.create(Ce,F):(ge=O.is(D)?D:this._changeAnnotations.manage(D),ee=U.create(Ce,F,ge)),this._workspaceEdit.documentChanges.push(ee),ge!==void 0)return ge},K}();e.WorkspaceChange=W;var X;(function(K){function Ce(F){return{uri:F}}s(Ce,"create"),K.create=Ce;function Ie(F){var D=F;return Pe.defined(D)&&Pe.string(D.uri)}s(Ie,"is"),K.is=Ie})(X||(e.TextDocumentIdentifier=X={}));var oe;(function(K){function Ce(F,D){return{uri:F,version:D}}s(Ce,"create"),K.create=Ce;function Ie(F){var D=F;return Pe.defined(D)&&Pe.string(D.uri)&&Pe.integer(D.version)}s(Ie,"is"),K.is=Ie})(oe||(e.VersionedTextDocumentIdentifier=oe={}));var te;(function(K){function Ce(F,D){return{uri:F,version:D}}s(Ce,"create"),K.create=Ce;function Ie(F){var D=F;return Pe.defined(D)&&Pe.string(D.uri)&&(D.version===null||Pe.integer(D.version))}s(Ie,"is"),K.is=Ie})(te||(e.OptionalVersionedTextDocumentIdentifier=te={}));var re;(function(K){function Ce(F,D,ee,ge){return{uri:F,languageId:D,version:ee,text:ge}}s(Ce,"create"),K.create=Ce;function Ie(F){var D=F;return Pe.defined(D)&&Pe.string(D.uri)&&Pe.string(D.languageId)&&Pe.integer(D.version)&&Pe.string(D.text)}s(Ie,"is"),K.is=Ie})(re||(e.TextDocumentItem=re={}));var pe;(function(K){K.PlainText="plaintext",K.Markdown="markdown";function Ce(Ie){var F=Ie;return F===K.PlainText||F===K.Markdown}s(Ce,"is"),K.is=Ce})(pe||(e.MarkupKind=pe={}));var Ae;(function(K){function Ce(Ie){var F=Ie;return Pe.objectLiteral(Ie)&&pe.is(F.kind)&&Pe.string(F.value)}s(Ce,"is"),K.is=Ce})(Ae||(e.MarkupContent=Ae={}));var Oe;(function(K){K.Text=1,K.Method=2,K.Function=3,K.Constructor=4,K.Field=5,K.Variable=6,K.Class=7,K.Interface=8,K.Module=9,K.Property=10,K.Unit=11,K.Value=12,K.Enum=13,K.Keyword=14,K.Snippet=15,K.Color=16,K.File=17,K.Reference=18,K.Folder=19,K.EnumMember=20,K.Constant=21,K.Struct=22,K.Event=23,K.Operator=24,K.TypeParameter=25})(Oe||(e.CompletionItemKind=Oe={}));var Te;(function(K){K.PlainText=1,K.Snippet=2})(Te||(e.InsertTextFormat=Te={}));var Je;(function(K){K.Deprecated=1})(Je||(e.CompletionItemTag=Je={}));var Fe;(function(K){function Ce(F,D,ee){return{newText:F,insert:D,replace:ee}}s(Ce,"create"),K.create=Ce;function Ie(F){var D=F;return D&&Pe.string(D.newText)&&c.is(D.insert)&&c.is(D.replace)}s(Ie,"is"),K.is=Ie})(Fe||(e.InsertReplaceEdit=Fe={}));var lt;(function(K){K.asIs=1,K.adjustIndentation=2})(lt||(e.InsertTextMode=lt={}));var _t;(function(K){function Ce(Ie){var F=Ie;return F&&(Pe.string(F.detail)||F.detail===void 0)&&(Pe.string(F.description)||F.description===void 0)}s(Ce,"is"),K.is=Ce})(_t||(e.CompletionItemLabelDetails=_t={}));var xt;(function(K){function Ce(Ie){return{label:Ie}}s(Ce,"create"),K.create=Ce})(xt||(e.CompletionItem=xt={}));var gt;(function(K){function Ce(Ie,F){return{items:Ie||[],isIncomplete:!!F}}s(Ce,"create"),K.create=Ce})(gt||(e.CompletionList=gt={}));var ue;(function(K){function Ce(F){return F.replace(/[\\`*_{}[\]()#+\-.!]/g,"\\$&")}s(Ce,"fromPlainText"),K.fromPlainText=Ce;function Ie(F){var D=F;return Pe.string(D)||Pe.objectLiteral(D)&&Pe.string(D.language)&&Pe.string(D.value)}s(Ie,"is"),K.is=Ie})(ue||(e.MarkedString=ue={}));var Ue;(function(K){function Ce(Ie){var F=Ie;return!!F&&Pe.objectLiteral(F)&&(Ae.is(F.contents)||ue.is(F.contents)||Pe.typedArray(F.contents,ue.is))&&(Ie.range===void 0||c.is(Ie.range))}s(Ce,"is"),K.is=Ce})(Ue||(e.Hover=Ue={}));var ye;(function(K){function Ce(Ie,F){return F?{label:Ie,documentation:F}:{label:Ie}}s(Ce,"create"),K.create=Ce})(ye||(e.ParameterInformation=ye={}));var $e;(function(K){function Ce(Ie,F){for(var D=[],ee=2;ee<arguments.length;ee++)D[ee-2]=arguments[ee];var ge={label:Ie};return Pe.defined(F)&&(ge.documentation=F),Pe.defined(D)?ge.parameters=D:ge.parameters=[],ge}s(Ce,"create"),K.create=Ce})($e||(e.SignatureInformation=$e={}));var ae;(function(K){K.Text=1,K.Read=2,K.Write=3})(ae||(e.DocumentHighlightKind=ae={}));var le;(function(K){function Ce(Ie,F){var D={range:Ie};return Pe.number(F)&&(D.kind=F),D}s(Ce,"create"),K.create=Ce})(le||(e.DocumentHighlight=le={}));var qe;(function(K){K.File=1,K.Module=2,K.Namespace=3,K.Package=4,K.Class=5,K.Method=6,K.Property=7,K.Field=8,K.Constructor=9,K.Enum=10,K.Interface=11,K.Function=12,K.Variable=13,K.Constant=14,K.String=15,K.Number=16,K.Boolean=17,K.Array=18,K.Object=19,K.Key=20,K.Null=21,K.EnumMember=22,K.Struct=23,K.Event=24,K.Operator=25,K.TypeParameter=26})(qe||(e.SymbolKind=qe={}));var Ne;(function(K){K.Deprecated=1})(Ne||(e.SymbolTag=Ne={}));var Ee;(function(K){function Ce(Ie,F,D,ee,ge){var _e={name:Ie,kind:F,location:{uri:ee,range:D}};return ge&&(_e.containerName=ge),_e}s(Ce,"create"),K.create=Ce})(Ee||(e.SymbolInformation=Ee={}));var je;(function(K){function Ce(Ie,F,D,ee){return ee!==void 0?{name:Ie,kind:F,location:{uri:D,range:ee}}:{name:Ie,kind:F,location:{uri:D}}}s(Ce,"create"),K.create=Ce})(je||(e.WorkspaceSymbol=je={}));var tt;(function(K){function Ce(F,D,ee,ge,_e,ut){var St={name:F,detail:D,kind:ee,range:ge,selectionRange:_e};return ut!==void 0&&(St.children=ut),St}s(Ce,"create"),K.create=Ce;function Ie(F){var D=F;return D&&Pe.string(D.name)&&Pe.number(D.kind)&&c.is(D.range)&&c.is(D.selectionRange)&&(D.detail===void 0||Pe.string(D.detail))&&(D.deprecated===void 0||Pe.boolean(D.deprecated))&&(D.children===void 0||Array.isArray(D.children))&&(D.tags===void 0||Array.isArray(D.tags))}s(Ie,"is"),K.is=Ie})(tt||(e.DocumentSymbol=tt={}));var mt;(function(K){K.Empty="",K.QuickFix="quickfix",K.Refactor="refactor",K.RefactorExtract="refactor.extract",K.RefactorInline="refactor.inline",K.RefactorRewrite="refactor.rewrite",K.Source="source",K.SourceOrganizeImports="source.organizeImports",K.SourceFixAll="source.fixAll"})(mt||(e.CodeActionKind=mt={}));var Ft;(function(K){K.Invoked=1,K.Automatic=2})(Ft||(e.CodeActionTriggerKind=Ft={}));var Jt;(function(K){function Ce(F,D,ee){var ge={diagnostics:F};return D!=null&&(ge.only=D),ee!=null&&(ge.triggerKind=ee),ge}s(Ce,"create"),K.create=Ce;function Ie(F){var D=F;return Pe.defined(D)&&Pe.typedArray(D.diagnostics,S.is)&&(D.only===void 0||Pe.typedArray(D.only,Pe.string))&&(D.triggerKind===void 0||D.triggerKind===Ft.Invoked||D.triggerKind===Ft.Automatic)}s(Ie,"is"),K.is=Ie})(Jt||(e.CodeActionContext=Jt={}));var Qt;(function(K){function Ce(F,D,ee){var ge={title:F},_e=!0;return typeof D=="string"?(_e=!1,ge.kind=D):R.is(D)?ge.command=D:ge.edit=D,_e&&ee!==void 0&&(ge.kind=ee),ge}s(Ce,"create"),K.create=Ce;function Ie(F){var D=F;return D&&Pe.string(D.title)&&(D.diagnostics===void 0||Pe.typedArray(D.diagnostics,S.is))&&(D.kind===void 0||Pe.string(D.kind))&&(D.edit!==void 0||D.command!==void 0)&&(D.command===void 0||R.is(D.command))&&(D.isPreferred===void 0||Pe.boolean(D.isPreferred))&&(D.edit===void 0||Z.is(D.edit))}s(Ie,"is"),K.is=Ie})(Qt||(e.CodeAction=Qt={}));var zr;(function(K){function Ce(F,D){var ee={range:F};return Pe.defined(D)&&(ee.data=D),ee}s(Ce,"create"),K.create=Ce;function Ie(F){var D=F;return Pe.defined(D)&&c.is(D.range)&&(Pe.undefined(D.command)||R.is(D.command))}s(Ie,"is"),K.is=Ie})(zr||(e.CodeLens=zr={}));var Br;(function(K){function Ce(F,D){return{tabSize:F,insertSpaces:D}}s(Ce,"create"),K.create=Ce;function Ie(F){var D=F;return Pe.defined(D)&&Pe.uinteger(D.tabSize)&&Pe.boolean(D.insertSpaces)}s(Ie,"is"),K.is=Ie})(Br||(e.FormattingOptions=Br={}));var un;(function(K){function Ce(F,D,ee){return{range:F,target:D,data:ee}}s(Ce,"create"),K.create=Ce;function Ie(F){var D=F;return Pe.defined(D)&&c.is(D.range)&&(Pe.undefined(D.target)||Pe.string(D.target))}s(Ie,"is"),K.is=Ie})(un||(e.DocumentLink=un={}));var ve;(function(K){function Ce(F,D){return{range:F,parent:D}}s(Ce,"create"),K.create=Ce;function Ie(F){var D=F;return Pe.objectLiteral(D)&&c.is(D.range)&&(D.parent===void 0||K.is(D.parent))}s(Ie,"is"),K.is=Ie})(ve||(e.SelectionRange=ve={}));var Ge;(function(K){K.namespace="namespace",K.type="type",K.class="class",K.enum="enum",K.interface="interface",K.struct="struct",K.typeParameter="typeParameter",K.parameter="parameter",K.variable="variable",K.property="property",K.enumMember="enumMember",K.event="event",K.function="function",K.method="method",K.macro="macro",K.keyword="keyword",K.modifier="modifier",K.comment="comment",K.string="string",K.number="number",K.regexp="regexp",K.operator="operator",K.decorator="decorator"})(Ge||(e.SemanticTokenTypes=Ge={}));var pt;(function(K){K.declaration="declaration",K.definition="definition",K.readonly="readonly",K.static="static",K.deprecated="deprecated",K.abstract="abstract",K.async="async",K.modification="modification",K.documentation="documentation",K.defaultLibrary="defaultLibrary"})(pt||(e.SemanticTokenModifiers=pt={}));var Tt;(function(K){function Ce(Ie){var F=Ie;return Pe.objectLiteral(F)&&(F.resultId===void 0||typeof F.resultId=="string")&&Array.isArray(F.data)&&(F.data.length===0||typeof F.data[0]=="number")}s(Ce,"is"),K.is=Ce})(Tt||(e.SemanticTokens=Tt={}));var or;(function(K){function Ce(F,D){return{range:F,text:D}}s(Ce,"create"),K.create=Ce;function Ie(F){var D=F;return D!=null&&c.is(D.range)&&Pe.string(D.text)}s(Ie,"is"),K.is=Ie})(or||(e.InlineValueText=or={}));var Zt;(function(K){function Ce(F,D,ee){return{range:F,variableName:D,caseSensitiveLookup:ee}}s(Ce,"create"),K.create=Ce;function Ie(F){var D=F;return D!=null&&c.is(D.range)&&Pe.boolean(D.caseSensitiveLookup)&&(Pe.string(D.variableName)||D.variableName===void 0)}s(Ie,"is"),K.is=Ie})(Zt||(e.InlineValueVariableLookup=Zt={}));var Tr;(function(K){function Ce(F,D){return{range:F,expression:D}}s(Ce,"create"),K.create=Ce;function Ie(F){var D=F;return D!=null&&c.is(D.range)&&(Pe.string(D.expression)||D.expression===void 0)}s(Ie,"is"),K.is=Ie})(Tr||(e.InlineValueEvaluatableExpression=Tr={}));var fr;(function(K){function Ce(F,D){return{frameId:F,stoppedLocation:D}}s(Ce,"create"),K.create=Ce;function Ie(F){var D=F;return Pe.defined(D)&&c.is(F.stoppedLocation)}s(Ie,"is"),K.is=Ie})(fr||(e.InlineValueContext=fr={}));var rr;(function(K){K.Type=1,K.Parameter=2;function Ce(Ie){return Ie===1||Ie===2}s(Ce,"is"),K.is=Ce})(rr||(e.InlayHintKind=rr={}));var ur;(function(K){function Ce(F){return{value:F}}s(Ce,"create"),K.create=Ce;function Ie(F){var D=F;return Pe.objectLiteral(D)&&(D.tooltip===void 0||Pe.string(D.tooltip)||Ae.is(D.tooltip))&&(D.location===void 0||l.is(D.location))&&(D.command===void 0||R.is(D.command))}s(Ie,"is"),K.is=Ie})(ur||(e.InlayHintLabelPart=ur={}));var nr;(function(K){function Ce(F,D,ee){var ge={position:F,label:D};return ee!==void 0&&(ge.kind=ee),ge}s(Ce,"create"),K.create=Ce;function Ie(F){var D=F;return Pe.objectLiteral(D)&&a.is(D.position)&&(Pe.string(D.label)||Pe.typedArray(D.label,ur.is))&&(D.kind===void 0||rr.is(D.kind))&&D.textEdits===void 0||Pe.typedArray(D.textEdits,B.is)&&(D.tooltip===void 0||Pe.string(D.tooltip)||Ae.is(D.tooltip))&&(D.paddingLeft===void 0||Pe.boolean(D.paddingLeft))&&(D.paddingRight===void 0||Pe.boolean(D.paddingRight))}s(Ie,"is"),K.is=Ie})(nr||(e.InlayHint=nr={}));var Mr;(function(K){function Ce(Ie){return{kind:"snippet",value:Ie}}s(Ce,"createSnippet"),K.createSnippet=Ce})(Mr||(e.StringValue=Mr={}));var Kr;(function(K){function Ce(Ie,F,D,ee){return{insertText:Ie,filterText:F,range:D,command:ee}}s(Ce,"create"),K.create=Ce})(Kr||(e.InlineCompletionItem=Kr={}));var sn;(function(K){function Ce(Ie){return{items:Ie}}s(Ce,"create"),K.create=Ce})(sn||(e.InlineCompletionList=sn={}));var Cn;(function(K){K.Invoked=0,K.Automatic=1})(Cn||(e.InlineCompletionTriggerKind=Cn={}));var ii;(function(K){function Ce(Ie,F){return{range:Ie,text:F}}s(Ce,"create"),K.create=Ce})(ii||(e.SelectedCompletionInfo=ii={}));var Rn;(function(K){function Ce(Ie,F){return{triggerKind:Ie,selectedCompletionInfo:F}}s(Ce,"create"),K.create=Ce})(Rn||(e.InlineCompletionContext=Rn={}));var ti;(function(K){function Ce(Ie){var F=Ie;return Pe.objectLiteral(F)&&n.is(F.uri)&&Pe.string(F.name)}s(Ce,"is"),K.is=Ce})(ti||(e.WorkspaceFolder=ti={})),e.EOL=[`
`,`\r
`,"\r"];var an;(function(K){function Ce(ee,ge,_e,ut){return new Jn(ee,ge,_e,ut)}s(Ce,"create"),K.create=Ce;function Ie(ee){var ge=ee;return!!(Pe.defined(ge)&&Pe.string(ge.uri)&&(Pe.undefined(ge.languageId)||Pe.string(ge.languageId))&&Pe.uinteger(ge.lineCount)&&Pe.func(ge.getText)&&Pe.func(ge.positionAt)&&Pe.func(ge.offsetAt))}s(Ie,"is"),K.is=Ie;function F(ee,ge){for(var _e=ee.getText(),ut=D(ge,function(vr,di){var no=vr.range.start.line-di.range.start.line;return no===0?vr.range.start.character-di.range.start.character:no}),St=_e.length,Kt=ut.length-1;Kt>=0;Kt--){var er=ut[Kt],Yt=ee.offsetAt(er.range.start),bt=ee.offsetAt(er.range.end);if(bt<=St)_e=_e.substring(0,Yt)+er.newText+_e.substring(bt,_e.length);else throw new Error("Overlapping edit");St=Yt}return _e}s(F,"applyEdits"),K.applyEdits=F;function D(ee,ge){if(ee.length<=1)return ee;var _e=ee.length/2|0,ut=ee.slice(0,_e),St=ee.slice(_e);D(ut,ge),D(St,ge);for(var Kt=0,er=0,Yt=0;Kt<ut.length&&er<St.length;){var bt=ge(ut[Kt],St[er]);bt<=0?ee[Yt++]=ut[Kt++]:ee[Yt++]=St[er++]}for(;Kt<ut.length;)ee[Yt++]=ut[Kt++];for(;er<St.length;)ee[Yt++]=St[er++];return ee}s(D,"mergeSort")})(an||(e.TextDocument=an={}));var Jn=function(){function K(Ce,Ie,F,D){this._uri=Ce,this._languageId=Ie,this._version=F,this._content=D,this._lineOffsets=void 0}return s(K,"FullTextDocument"),Object.defineProperty(K.prototype,"uri",{get:s(function(){return this._uri},"get"),enumerable:!1,configurable:!0}),Object.defineProperty(K.prototype,"languageId",{get:s(function(){return this._languageId},"get"),enumerable:!1,configurable:!0}),Object.defineProperty(K.prototype,"version",{get:s(function(){return this._version},"get"),enumerable:!1,configurable:!0}),K.prototype.getText=function(Ce){if(Ce){var Ie=this.offsetAt(Ce.start),F=this.offsetAt(Ce.end);return this._content.substring(Ie,F)}return this._content},K.prototype.update=function(Ce,Ie){this._content=Ce.text,this._version=Ie,this._lineOffsets=void 0},K.prototype.getLineOffsets=function(){if(this._lineOffsets===void 0){for(var Ce=[],Ie=this._content,F=!0,D=0;D<Ie.length;D++){F&&(Ce.push(D),F=!1);var ee=Ie.charAt(D);F=ee==="\r"||ee===`
`,ee==="\r"&&D+1<Ie.length&&Ie.charAt(D+1)===`
`&&D++}F&&Ie.length>0&&Ce.push(Ie.length),this._lineOffsets=Ce}return this._lineOffsets},K.prototype.positionAt=function(Ce){Ce=Math.max(Math.min(Ce,this._content.length),0);var Ie=this.getLineOffsets(),F=0,D=Ie.length;if(D===0)return a.create(0,Ce);for(;F<D;){var ee=Math.floor((F+D)/2);Ie[ee]>Ce?D=ee:F=ee+1}var ge=F-1;return a.create(ge,Ce-Ie[ge])},K.prototype.offsetAt=function(Ce){var Ie=this.getLineOffsets();if(Ce.line>=Ie.length)return this._content.length;if(Ce.line<0)return 0;var F=Ie[Ce.line],D=Ce.line+1<Ie.length?Ie[Ce.line+1]:this._content.length;return Math.max(Math.min(F+Ce.character,D),F)},Object.defineProperty(K.prototype,"lineCount",{get:s(function(){return this.getLineOffsets().length},"get"),enumerable:!1,configurable:!0}),K}(),Pe;(function(K){var Ce=Object.prototype.toString;function Ie(bt){return typeof bt<"u"}s(Ie,"defined"),K.defined=Ie;function F(bt){return typeof bt>"u"}s(F,"undefined"),K.undefined=F;function D(bt){return bt===!0||bt===!1}s(D,"boolean"),K.boolean=D;function ee(bt){return Ce.call(bt)==="[object String]"}s(ee,"string"),K.string=ee;function ge(bt){return Ce.call(bt)==="[object Number]"}s(ge,"number"),K.number=ge;function _e(bt,vr,di){return Ce.call(bt)==="[object Number]"&&vr<=bt&&bt<=di}s(_e,"numberRange"),K.numberRange=_e;function ut(bt){return Ce.call(bt)==="[object Number]"&&-2147483648<=bt&&bt<=2147483647}s(ut,"integer"),K.integer=ut;function St(bt){return Ce.call(bt)==="[object Number]"&&0<=bt&&bt<=2147483647}s(St,"uinteger"),K.uinteger=St;function Kt(bt){return Ce.call(bt)==="[object Function]"}s(Kt,"func"),K.func=Kt;function er(bt){return bt!==null&&typeof bt=="object"}s(er,"objectLiteral"),K.objectLiteral=er;function Yt(bt,vr){return Array.isArray(bt)&&bt.every(vr)}s(Yt,"typedArray"),K.typedArray=Yt})(Pe||(Pe={}))})});var Da=H(lp=>{"use strict";d();Object.defineProperty(lp,"__esModule",{value:!0});lp.ProtocolNotificationType=lp.ProtocolNotificationType0=lp.ProtocolRequestType=lp.ProtocolRequestType0=lp.RegistrationType=lp.MessageDirection=void 0;var CD=i2(),XMe;(function(t){t.clientToServer="clientToServer",t.serverToClient="serverToClient",t.both="both"})(XMe||(lp.MessageDirection=XMe={}));var dme=class{static{s(this,"RegistrationType")}constructor(e){this.method=e}};lp.RegistrationType=dme;var fme=class extends CD.RequestType0{static{s(this,"ProtocolRequestType0")}constructor(e){super(e)}};lp.ProtocolRequestType0=fme;var pme=class extends CD.RequestType{static{s(this,"ProtocolRequestType")}constructor(e){super(e,CD.ParameterStructures.byName)}};lp.ProtocolRequestType=pme;var mme=class extends CD.NotificationType0{static{s(this,"ProtocolNotificationType0")}constructor(e){super(e)}};lp.ProtocolNotificationType0=mme;var hme=class extends CD.NotificationType{static{s(this,"ProtocolNotificationType")}constructor(e){super(e,CD.ParameterStructures.byName)}};lp.ProtocolNotificationType=hme});var NG=H(rl=>{"use strict";d();Object.defineProperty(rl,"__esModule",{value:!0});rl.objectLiteral=rl.typedArray=rl.stringArray=rl.array=rl.func=rl.error=rl.number=rl.string=rl.boolean=void 0;function n4t(t){return t===!0||t===!1}s(n4t,"boolean");rl.boolean=n4t;function ZMe(t){return typeof t=="string"||t instanceof String}s(ZMe,"string");rl.string=ZMe;function i4t(t){return typeof t=="number"||t instanceof Number}s(i4t,"number");rl.number=i4t;function o4t(t){return t instanceof Error}s(o4t,"error");rl.error=o4t;function s4t(t){return typeof t=="function"}s(s4t,"func");rl.func=s4t;function eLe(t){return Array.isArray(t)}s(eLe,"array");rl.array=eLe;function a4t(t){return eLe(t)&&t.every(e=>ZMe(e))}s(a4t,"stringArray");rl.stringArray=a4t;function c4t(t,e){return Array.isArray(t)&&t.every(e)}s(c4t,"typedArray");rl.typedArray=c4t;function l4t(t){return t!==null&&typeof t=="object"}s(l4t,"objectLiteral");rl.objectLiteral=l4t});var nLe=H(MG=>{"use strict";d();Object.defineProperty(MG,"__esModule",{value:!0});MG.ImplementationRequest=void 0;var tLe=Da(),rLe;(function(t){t.method="textDocument/implementation",t.messageDirection=tLe.MessageDirection.clientToServer,t.type=new tLe.ProtocolRequestType(t.method)})(rLe||(MG.ImplementationRequest=rLe={}))});var sLe=H(LG=>{"use strict";d();Object.defineProperty(LG,"__esModule",{value:!0});LG.TypeDefinitionRequest=void 0;var iLe=Da(),oLe;(function(t){t.method="textDocument/typeDefinition",t.messageDirection=iLe.MessageDirection.clientToServer,t.type=new iLe.ProtocolRequestType(t.method)})(oLe||(LG.TypeDefinitionRequest=oLe={}))});var lLe=H(vD=>{"use strict";d();Object.defineProperty(vD,"__esModule",{value:!0});vD.DidChangeWorkspaceFoldersNotification=vD.WorkspaceFoldersRequest=void 0;var FG=Da(),aLe;(function(t){t.method="workspace/workspaceFolders",t.messageDirection=FG.MessageDirection.serverToClient,t.type=new FG.ProtocolRequestType0(t.method)})(aLe||(vD.WorkspaceFoldersRequest=aLe={}));var cLe;(function(t){t.method="workspace/didChangeWorkspaceFolders",t.messageDirection=FG.MessageDirection.clientToServer,t.type=new FG.ProtocolNotificationType(t.method)})(cLe||(vD.DidChangeWorkspaceFoldersNotification=cLe={}))});var fLe=H(OG=>{"use strict";d();Object.defineProperty(OG,"__esModule",{value:!0});OG.ConfigurationRequest=void 0;var uLe=Da(),dLe;(function(t){t.method="workspace/configuration",t.messageDirection=uLe.MessageDirection.serverToClient,t.type=new uLe.ProtocolRequestType(t.method)})(dLe||(OG.ConfigurationRequest=dLe={}))});var hLe=H(xD=>{"use strict";d();Object.defineProperty(xD,"__esModule",{value:!0});xD.ColorPresentationRequest=xD.DocumentColorRequest=void 0;var QG=Da(),pLe;(function(t){t.method="textDocument/documentColor",t.messageDirection=QG.MessageDirection.clientToServer,t.type=new QG.ProtocolRequestType(t.method)})(pLe||(xD.DocumentColorRequest=pLe={}));var mLe;(function(t){t.method="textDocument/colorPresentation",t.messageDirection=QG.MessageDirection.clientToServer,t.type=new QG.ProtocolRequestType(t.method)})(mLe||(xD.ColorPresentationRequest=mLe={}))});var yLe=H(ED=>{"use strict";d();Object.defineProperty(ED,"__esModule",{value:!0});ED.FoldingRangeRefreshRequest=ED.FoldingRangeRequest=void 0;var UG=Da(),gLe;(function(t){t.method="textDocument/foldingRange",t.messageDirection=UG.MessageDirection.clientToServer,t.type=new UG.ProtocolRequestType(t.method)})(gLe||(ED.FoldingRangeRequest=gLe={}));var ALe;(function(t){t.method="workspace/foldingRange/refresh",t.messageDirection=UG.MessageDirection.serverToClient,t.type=new UG.ProtocolRequestType0(t.method)})(ALe||(ED.FoldingRangeRefreshRequest=ALe={}))});var xLe=H(qG=>{"use strict";d();Object.defineProperty(qG,"__esModule",{value:!0});qG.DeclarationRequest=void 0;var CLe=Da(),vLe;(function(t){t.method="textDocument/declaration",t.messageDirection=CLe.MessageDirection.clientToServer,t.type=new CLe.ProtocolRequestType(t.method)})(vLe||(qG.DeclarationRequest=vLe={}))});var ILe=H(HG=>{"use strict";d();Object.defineProperty(HG,"__esModule",{value:!0});HG.SelectionRangeRequest=void 0;var ELe=Da(),bLe;(function(t){t.method="textDocument/selectionRange",t.messageDirection=ELe.MessageDirection.clientToServer,t.type=new ELe.ProtocolRequestType(t.method)})(bLe||(HG.SelectionRangeRequest=bLe={}))});var _Le=H(NI=>{"use strict";d();Object.defineProperty(NI,"__esModule",{value:!0});NI.WorkDoneProgressCancelNotification=NI.WorkDoneProgressCreateRequest=NI.WorkDoneProgress=void 0;var u4t=i2(),$G=Da(),TLe;(function(t){t.type=new u4t.ProgressType;function e(r){return r===t.type}s(e,"is"),t.is=e})(TLe||(NI.WorkDoneProgress=TLe={}));var wLe;(function(t){t.method="window/workDoneProgress/create",t.messageDirection=$G.MessageDirection.serverToClient,t.type=new $G.ProtocolRequestType(t.method)})(wLe||(NI.WorkDoneProgressCreateRequest=wLe={}));var SLe;(function(t){t.method="window/workDoneProgress/cancel",t.messageDirection=$G.MessageDirection.clientToServer,t.type=new $G.ProtocolNotificationType(t.method)})(SLe||(NI.WorkDoneProgressCancelNotification=SLe={}))});var DLe=H(MI=>{"use strict";d();Object.defineProperty(MI,"__esModule",{value:!0});MI.CallHierarchyOutgoingCallsRequest=MI.CallHierarchyIncomingCallsRequest=MI.CallHierarchyPrepareRequest=void 0;var bD=Da(),RLe;(function(t){t.method="textDocument/prepareCallHierarchy",t.messageDirection=bD.MessageDirection.clientToServer,t.type=new bD.ProtocolRequestType(t.method)})(RLe||(MI.CallHierarchyPrepareRequest=RLe={}));var kLe;(function(t){t.method="callHierarchy/incomingCalls",t.messageDirection=bD.MessageDirection.clientToServer,t.type=new bD.ProtocolRequestType(t.method)})(kLe||(MI.CallHierarchyIncomingCallsRequest=kLe={}));var PLe;(function(t){t.method="callHierarchy/outgoingCalls",t.messageDirection=bD.MessageDirection.clientToServer,t.type=new bD.ProtocolRequestType(t.method)})(PLe||(MI.CallHierarchyOutgoingCallsRequest=PLe={}))});var OLe=H(up=>{"use strict";d();Object.defineProperty(up,"__esModule",{value:!0});up.SemanticTokensRefreshRequest=up.SemanticTokensRangeRequest=up.SemanticTokensDeltaRequest=up.SemanticTokensRequest=up.SemanticTokensRegistrationType=up.TokenFormat=void 0;var zv=Da(),BLe;(function(t){t.Relative="relative"})(BLe||(up.TokenFormat=BLe={}));var f9;(function(t){t.method="textDocument/semanticTokens",t.type=new zv.RegistrationType(t.method)})(f9||(up.SemanticTokensRegistrationType=f9={}));var NLe;(function(t){t.method="textDocument/semanticTokens/full",t.messageDirection=zv.MessageDirection.clientToServer,t.type=new zv.ProtocolRequestType(t.method),t.registrationMethod=f9.method})(NLe||(up.SemanticTokensRequest=NLe={}));var MLe;(function(t){t.method="textDocument/semanticTokens/full/delta",t.messageDirection=zv.MessageDirection.clientToServer,t.type=new zv.ProtocolRequestType(t.method),t.registrationMethod=f9.method})(MLe||(up.SemanticTokensDeltaRequest=MLe={}));var LLe;(function(t){t.method="textDocument/semanticTokens/range",t.messageDirection=zv.MessageDirection.clientToServer,t.type=new zv.ProtocolRequestType(t.method),t.registrationMethod=f9.method})(LLe||(up.SemanticTokensRangeRequest=LLe={}));var FLe;(function(t){t.method="workspace/semanticTokens/refresh",t.messageDirection=zv.MessageDirection.serverToClient,t.type=new zv.ProtocolRequestType0(t.method)})(FLe||(up.SemanticTokensRefreshRequest=FLe={}))});var qLe=H(WG=>{"use strict";d();Object.defineProperty(WG,"__esModule",{value:!0});WG.ShowDocumentRequest=void 0;var QLe=Da(),ULe;(function(t){t.method="window/showDocument",t.messageDirection=QLe.MessageDirection.serverToClient,t.type=new QLe.ProtocolRequestType(t.method)})(ULe||(WG.ShowDocumentRequest=ULe={}))});var WLe=H(jG=>{"use strict";d();Object.defineProperty(jG,"__esModule",{value:!0});jG.LinkedEditingRangeRequest=void 0;var HLe=Da(),$Le;(function(t){t.method="textDocument/linkedEditingRange",t.messageDirection=HLe.MessageDirection.clientToServer,t.type=new HLe.ProtocolRequestType(t.method)})($Le||(jG.LinkedEditingRangeRequest=$Le={}))});var XLe=H(Nd=>{"use strict";d();Object.defineProperty(Nd,"__esModule",{value:!0});Nd.WillDeleteFilesRequest=Nd.DidDeleteFilesNotification=Nd.DidRenameFilesNotification=Nd.WillRenameFilesRequest=Nd.DidCreateFilesNotification=Nd.WillCreateFilesRequest=Nd.FileOperationPatternKind=void 0;var Jm=Da(),jLe;(function(t){t.file="file",t.folder="folder"})(jLe||(Nd.FileOperationPatternKind=jLe={}));var GLe;(function(t){t.method="workspace/willCreateFiles",t.messageDirection=Jm.MessageDirection.clientToServer,t.type=new Jm.ProtocolRequestType(t.method)})(GLe||(Nd.WillCreateFilesRequest=GLe={}));var VLe;(function(t){t.method="workspace/didCreateFiles",t.messageDirection=Jm.MessageDirection.clientToServer,t.type=new Jm.ProtocolNotificationType(t.method)})(VLe||(Nd.DidCreateFilesNotification=VLe={}));var zLe;(function(t){t.method="workspace/willRenameFiles",t.messageDirection=Jm.MessageDirection.clientToServer,t.type=new Jm.ProtocolRequestType(t.method)})(zLe||(Nd.WillRenameFilesRequest=zLe={}));var KLe;(function(t){t.method="workspace/didRenameFiles",t.messageDirection=Jm.MessageDirection.clientToServer,t.type=new Jm.ProtocolNotificationType(t.method)})(KLe||(Nd.DidRenameFilesNotification=KLe={}));var YLe;(function(t){t.method="workspace/didDeleteFiles",t.messageDirection=Jm.MessageDirection.clientToServer,t.type=new Jm.ProtocolNotificationType(t.method)})(YLe||(Nd.DidDeleteFilesNotification=YLe={}));var JLe;(function(t){t.method="workspace/willDeleteFiles",t.messageDirection=Jm.MessageDirection.clientToServer,t.type=new Jm.ProtocolRequestType(t.method)})(JLe||(Nd.WillDeleteFilesRequest=JLe={}))});var nFe=H(LI=>{"use strict";d();Object.defineProperty(LI,"__esModule",{value:!0});LI.MonikerRequest=LI.MonikerKind=LI.UniquenessLevel=void 0;var ZLe=Da(),eFe;(function(t){t.document="document",t.project="project",t.group="group",t.scheme="scheme",t.global="global"})(eFe||(LI.UniquenessLevel=eFe={}));var tFe;(function(t){t.$import="import",t.$export="export",t.local="local"})(tFe||(LI.MonikerKind=tFe={}));var rFe;(function(t){t.method="textDocument/moniker",t.messageDirection=ZLe.MessageDirection.clientToServer,t.type=new ZLe.ProtocolRequestType(t.method)})(rFe||(LI.MonikerRequest=rFe={}))});var aFe=H(FI=>{"use strict";d();Object.defineProperty(FI,"__esModule",{value:!0});FI.TypeHierarchySubtypesRequest=FI.TypeHierarchySupertypesRequest=FI.TypeHierarchyPrepareRequest=void 0;var ID=Da(),iFe;(function(t){t.method="textDocument/prepareTypeHierarchy",t.messageDirection=ID.MessageDirection.clientToServer,t.type=new ID.ProtocolRequestType(t.method)})(iFe||(FI.TypeHierarchyPrepareRequest=iFe={}));var oFe;(function(t){t.method="typeHierarchy/supertypes",t.messageDirection=ID.MessageDirection.clientToServer,t.type=new ID.ProtocolRequestType(t.method)})(oFe||(FI.TypeHierarchySupertypesRequest=oFe={}));var sFe;(function(t){t.method="typeHierarchy/subtypes",t.messageDirection=ID.MessageDirection.clientToServer,t.type=new ID.ProtocolRequestType(t.method)})(sFe||(FI.TypeHierarchySubtypesRequest=sFe={}))});var uFe=H(TD=>{"use strict";d();Object.defineProperty(TD,"__esModule",{value:!0});TD.InlineValueRefreshRequest=TD.InlineValueRequest=void 0;var GG=Da(),cFe;(function(t){t.method="textDocument/inlineValue",t.messageDirection=GG.MessageDirection.clientToServer,t.type=new GG.ProtocolRequestType(t.method)})(cFe||(TD.InlineValueRequest=cFe={}));var lFe;(function(t){t.method="workspace/inlineValue/refresh",t.messageDirection=GG.MessageDirection.serverToClient,t.type=new GG.ProtocolRequestType0(t.method)})(lFe||(TD.InlineValueRefreshRequest=lFe={}))});var mFe=H(OI=>{"use strict";d();Object.defineProperty(OI,"__esModule",{value:!0});OI.InlayHintRefreshRequest=OI.InlayHintResolveRequest=OI.InlayHintRequest=void 0;var wD=Da(),dFe;(function(t){t.method="textDocument/inlayHint",t.messageDirection=wD.MessageDirection.clientToServer,t.type=new wD.ProtocolRequestType(t.method)})(dFe||(OI.InlayHintRequest=dFe={}));var fFe;(function(t){t.method="inlayHint/resolve",t.messageDirection=wD.MessageDirection.clientToServer,t.type=new wD.ProtocolRequestType(t.method)})(fFe||(OI.InlayHintResolveRequest=fFe={}));var pFe;(function(t){t.method="workspace/inlayHint/refresh",t.messageDirection=wD.MessageDirection.serverToClient,t.type=new wD.ProtocolRequestType0(t.method)})(pFe||(OI.InlayHintRefreshRequest=pFe={}))});var xFe=H(Xm=>{"use strict";d();Object.defineProperty(Xm,"__esModule",{value:!0});Xm.DiagnosticRefreshRequest=Xm.WorkspaceDiagnosticRequest=Xm.DocumentDiagnosticRequest=Xm.DocumentDiagnosticReportKind=Xm.DiagnosticServerCancellationData=void 0;var vFe=i2(),d4t=NG(),SD=Da(),hFe;(function(t){function e(r){let n=r;return n&&d4t.boolean(n.retriggerRequest)}s(e,"is"),t.is=e})(hFe||(Xm.DiagnosticServerCancellationData=hFe={}));var gFe;(function(t){t.Full="full",t.Unchanged="unchanged"})(gFe||(Xm.DocumentDiagnosticReportKind=gFe={}));var AFe;(function(t){t.method="textDocument/diagnostic",t.messageDirection=SD.MessageDirection.clientToServer,t.type=new SD.ProtocolRequestType(t.method),t.partialResult=new vFe.ProgressType})(AFe||(Xm.DocumentDiagnosticRequest=AFe={}));var yFe;(function(t){t.method="workspace/diagnostic",t.messageDirection=SD.MessageDirection.clientToServer,t.type=new SD.ProtocolRequestType(t.method),t.partialResult=new vFe.ProgressType})(yFe||(Xm.WorkspaceDiagnosticRequest=yFe={}));var CFe;(function(t){t.method="workspace/diagnostic/refresh",t.messageDirection=SD.MessageDirection.serverToClient,t.type=new SD.ProtocolRequestType0(t.method)})(CFe||(Xm.DiagnosticRefreshRequest=CFe={}))});var _Fe=H(cc=>{"use strict";d();Object.defineProperty(cc,"__esModule",{value:!0});cc.DidCloseNotebookDocumentNotification=cc.DidSaveNotebookDocumentNotification=cc.DidChangeNotebookDocumentNotification=cc.NotebookCellArrayChange=cc.DidOpenNotebookDocumentNotification=cc.NotebookDocumentSyncRegistrationType=cc.NotebookDocument=cc.NotebookCell=cc.ExecutionSummary=cc.NotebookCellKind=void 0;var p9=BG(),uA=NG(),pC=Da(),gme;(function(t){t.Markup=1,t.Code=2;function e(r){return r===1||r===2}s(e,"is"),t.is=e})(gme||(cc.NotebookCellKind=gme={}));var Ame;(function(t){function e(i,o){let a={executionOrder:i};return(o===!0||o===!1)&&(a.success=o),a}s(e,"create"),t.create=e;function r(i){let o=i;return uA.objectLiteral(o)&&p9.uinteger.is(o.executionOrder)&&(o.success===void 0||uA.boolean(o.success))}s(r,"is"),t.is=r;function n(i,o){return i===o?!0:i==null||o===null||o===void 0?!1:i.executionOrder===o.executionOrder&&i.success===o.success}s(n,"equals"),t.equals=n})(Ame||(cc.ExecutionSummary=Ame={}));var VG;(function(t){function e(o,a){return{kind:o,document:a}}s(e,"create"),t.create=e;function r(o){let a=o;return uA.objectLiteral(a)&&gme.is(a.kind)&&p9.DocumentUri.is(a.document)&&(a.metadata===void 0||uA.objectLiteral(a.metadata))}s(r,"is"),t.is=r;function n(o,a){let c=new Set;return o.document!==a.document&&c.add("document"),o.kind!==a.kind&&c.add("kind"),o.executionSummary!==a.executionSummary&&c.add("executionSummary"),(o.metadata!==void 0||a.metadata!==void 0)&&!i(o.metadata,a.metadata)&&c.add("metadata"),(o.executionSummary!==void 0||a.executionSummary!==void 0)&&!Ame.equals(o.executionSummary,a.executionSummary)&&c.add("executionSummary"),c}s(n,"diff"),t.diff=n;function i(o,a){if(o===a)return!0;if(o==null||a===null||a===void 0||typeof o!=typeof a||typeof o!="object")return!1;let c=Array.isArray(o),l=Array.isArray(a);if(c!==l)return!1;if(c&&l){if(o.length!==a.length)return!1;for(let u=0;u<o.length;u++)if(!i(o[u],a[u]))return!1}if(uA.objectLiteral(o)&&uA.objectLiteral(a)){let u=Object.keys(o),f=Object.keys(a);if(u.length!==f.length||(u.sort(),f.sort(),!i(u,f)))return!1;for(let p=0;p<u.length;p++){let m=u[p];if(!i(o[m],a[m]))return!1}}return!0}s(i,"equalsMetadata")})(VG||(cc.NotebookCell=VG={}));var EFe;(function(t){function e(n,i,o,a){return{uri:n,notebookType:i,version:o,cells:a}}s(e,"create"),t.create=e;function r(n){let i=n;return uA.objectLiteral(i)&&uA.string(i.uri)&&p9.integer.is(i.version)&&uA.typedArray(i.cells,VG.is)}s(r,"is"),t.is=r})(EFe||(cc.NotebookDocument=EFe={}));var _D;(function(t){t.method="notebookDocument/sync",t.messageDirection=pC.MessageDirection.clientToServer,t.type=new pC.RegistrationType(t.method)})(_D||(cc.NotebookDocumentSyncRegistrationType=_D={}));var bFe;(function(t){t.method="notebookDocument/didOpen",t.messageDirection=pC.MessageDirection.clientToServer,t.type=new pC.ProtocolNotificationType(t.method),t.registrationMethod=_D.method})(bFe||(cc.DidOpenNotebookDocumentNotification=bFe={}));var IFe;(function(t){function e(n){let i=n;return uA.objectLiteral(i)&&p9.uinteger.is(i.start)&&p9.uinteger.is(i.deleteCount)&&(i.cells===void 0||uA.typedArray(i.cells,VG.is))}s(e,"is"),t.is=e;function r(n,i,o){let a={start:n,deleteCount:i};return o!==void 0&&(a.cells=o),a}s(r,"create"),t.create=r})(IFe||(cc.NotebookCellArrayChange=IFe={}));var TFe;(function(t){t.method="notebookDocument/didChange",t.messageDirection=pC.MessageDirection.clientToServer,t.type=new pC.ProtocolNotificationType(t.method),t.registrationMethod=_D.method})(TFe||(cc.DidChangeNotebookDocumentNotification=TFe={}));var wFe;(function(t){t.method="notebookDocument/didSave",t.messageDirection=pC.MessageDirection.clientToServer,t.type=new pC.ProtocolNotificationType(t.method),t.registrationMethod=_D.method})(wFe||(cc.DidSaveNotebookDocumentNotification=wFe={}));var SFe;(function(t){t.method="notebookDocument/didClose",t.messageDirection=pC.MessageDirection.clientToServer,t.type=new pC.ProtocolNotificationType(t.method),t.registrationMethod=_D.method})(SFe||(cc.DidCloseNotebookDocumentNotification=SFe={}))});var PFe=H(zG=>{"use strict";d();Object.defineProperty(zG,"__esModule",{value:!0});zG.InlineCompletionRequest=void 0;var RFe=Da(),kFe;(function(t){t.method="textDocument/inlineCompletion",t.messageDirection=RFe.MessageDirection.clientToServer,t.type=new RFe.ProtocolRequestType(t.method)})(kFe||(zG.InlineCompletionRequest=kFe={}))});var W9e=H(be=>{"use strict";d();Object.defineProperty(be,"__esModule",{value:!0});be.WorkspaceSymbolRequest=be.CodeActionResolveRequest=be.CodeActionRequest=be.DocumentSymbolRequest=be.DocumentHighlightRequest=be.ReferencesRequest=be.DefinitionRequest=be.SignatureHelpRequest=be.SignatureHelpTriggerKind=be.HoverRequest=be.CompletionResolveRequest=be.CompletionRequest=be.CompletionTriggerKind=be.PublishDiagnosticsNotification=be.WatchKind=be.RelativePattern=be.FileChangeType=be.DidChangeWatchedFilesNotification=be.WillSaveTextDocumentWaitUntilRequest=be.WillSaveTextDocumentNotification=be.TextDocumentSaveReason=be.DidSaveTextDocumentNotification=be.DidCloseTextDocumentNotification=be.DidChangeTextDocumentNotification=be.TextDocumentContentChangeEvent=be.DidOpenTextDocumentNotification=be.TextDocumentSyncKind=be.TelemetryEventNotification=be.LogMessageNotification=be.ShowMessageRequest=be.ShowMessageNotification=be.MessageType=be.DidChangeConfigurationNotification=be.ExitNotification=be.ShutdownRequest=be.InitializedNotification=be.InitializeErrorCodes=be.InitializeRequest=be.WorkDoneProgressOptions=be.TextDocumentRegistrationOptions=be.StaticRegistrationOptions=be.PositionEncodingKind=be.FailureHandlingKind=be.ResourceOperationKind=be.UnregistrationRequest=be.RegistrationRequest=be.DocumentSelector=be.NotebookCellTextDocumentFilter=be.NotebookDocumentFilter=be.TextDocumentFilter=void 0;be.MonikerRequest=be.MonikerKind=be.UniquenessLevel=be.WillDeleteFilesRequest=be.DidDeleteFilesNotification=be.WillRenameFilesRequest=be.DidRenameFilesNotification=be.WillCreateFilesRequest=be.DidCreateFilesNotification=be.FileOperationPatternKind=be.LinkedEditingRangeRequest=be.ShowDocumentRequest=be.SemanticTokensRegistrationType=be.SemanticTokensRefreshRequest=be.SemanticTokensRangeRequest=be.SemanticTokensDeltaRequest=be.SemanticTokensRequest=be.TokenFormat=be.CallHierarchyPrepareRequest=be.CallHierarchyOutgoingCallsRequest=be.CallHierarchyIncomingCallsRequest=be.WorkDoneProgressCancelNotification=be.WorkDoneProgressCreateRequest=be.WorkDoneProgress=be.SelectionRangeRequest=be.DeclarationRequest=be.FoldingRangeRefreshRequest=be.FoldingRangeRequest=be.ColorPresentationRequest=be.DocumentColorRequest=be.ConfigurationRequest=be.DidChangeWorkspaceFoldersNotification=be.WorkspaceFoldersRequest=be.TypeDefinitionRequest=be.ImplementationRequest=be.ApplyWorkspaceEditRequest=be.ExecuteCommandRequest=be.PrepareRenameRequest=be.RenameRequest=be.PrepareSupportDefaultBehavior=be.DocumentOnTypeFormattingRequest=be.DocumentRangesFormattingRequest=be.DocumentRangeFormattingRequest=be.DocumentFormattingRequest=be.DocumentLinkResolveRequest=be.DocumentLinkRequest=be.CodeLensRefreshRequest=be.CodeLensResolveRequest=be.CodeLensRequest=be.WorkspaceSymbolResolveRequest=void 0;be.InlineCompletionRequest=be.DidCloseNotebookDocumentNotification=be.DidSaveNotebookDocumentNotification=be.DidChangeNotebookDocumentNotification=be.NotebookCellArrayChange=be.DidOpenNotebookDocumentNotification=be.NotebookDocumentSyncRegistrationType=be.NotebookDocument=be.NotebookCell=be.ExecutionSummary=be.NotebookCellKind=be.DiagnosticRefreshRequest=be.WorkspaceDiagnosticRequest=be.DocumentDiagnosticRequest=be.DocumentDiagnosticReportKind=be.DiagnosticServerCancellationData=be.InlayHintRefreshRequest=be.InlayHintResolveRequest=be.InlayHintRequest=be.InlineValueRefreshRequest=be.InlineValueRequest=be.TypeHierarchySupertypesRequest=be.TypeHierarchySubtypesRequest=be.TypeHierarchyPrepareRequest=void 0;var jt=Da(),DFe=BG(),ru=NG(),f4t=nLe();Object.defineProperty(be,"ImplementationRequest",{enumerable:!0,get:s(function(){return f4t.ImplementationRequest},"get")});var p4t=sLe();Object.defineProperty(be,"TypeDefinitionRequest",{enumerable:!0,get:s(function(){return p4t.TypeDefinitionRequest},"get")});var U9e=lLe();Object.defineProperty(be,"WorkspaceFoldersRequest",{enumerable:!0,get:s(function(){return U9e.WorkspaceFoldersRequest},"get")});Object.defineProperty(be,"DidChangeWorkspaceFoldersNotification",{enumerable:!0,get:s(function(){return U9e.DidChangeWorkspaceFoldersNotification},"get")});var m4t=fLe();Object.defineProperty(be,"ConfigurationRequest",{enumerable:!0,get:s(function(){return m4t.ConfigurationRequest},"get")});var q9e=hLe();Object.defineProperty(be,"DocumentColorRequest",{enumerable:!0,get:s(function(){return q9e.DocumentColorRequest},"get")});Object.defineProperty(be,"ColorPresentationRequest",{enumerable:!0,get:s(function(){return q9e.ColorPresentationRequest},"get")});var H9e=yLe();Object.defineProperty(be,"FoldingRangeRequest",{enumerable:!0,get:s(function(){return H9e.FoldingRangeRequest},"get")});Object.defineProperty(be,"FoldingRangeRefreshRequest",{enumerable:!0,get:s(function(){return H9e.FoldingRangeRefreshRequest},"get")});var h4t=xLe();Object.defineProperty(be,"DeclarationRequest",{enumerable:!0,get:s(function(){return h4t.DeclarationRequest},"get")});var g4t=ILe();Object.defineProperty(be,"SelectionRangeRequest",{enumerable:!0,get:s(function(){return g4t.SelectionRangeRequest},"get")});var Eme=_Le();Object.defineProperty(be,"WorkDoneProgress",{enumerable:!0,get:s(function(){return Eme.WorkDoneProgress},"get")});Object.defineProperty(be,"WorkDoneProgressCreateRequest",{enumerable:!0,get:s(function(){return Eme.WorkDoneProgressCreateRequest},"get")});Object.defineProperty(be,"WorkDoneProgressCancelNotification",{enumerable:!0,get:s(function(){return Eme.WorkDoneProgressCancelNotification},"get")});var bme=DLe();Object.defineProperty(be,"CallHierarchyIncomingCallsRequest",{enumerable:!0,get:s(function(){return bme.CallHierarchyIncomingCallsRequest},"get")});Object.defineProperty(be,"CallHierarchyOutgoingCallsRequest",{enumerable:!0,get:s(function(){return bme.CallHierarchyOutgoingCallsRequest},"get")});Object.defineProperty(be,"CallHierarchyPrepareRequest",{enumerable:!0,get:s(function(){return bme.CallHierarchyPrepareRequest},"get")});var RD=OLe();Object.defineProperty(be,"TokenFormat",{enumerable:!0,get:s(function(){return RD.TokenFormat},"get")});Object.defineProperty(be,"SemanticTokensRequest",{enumerable:!0,get:s(function(){return RD.SemanticTokensRequest},"get")});Object.defineProperty(be,"SemanticTokensDeltaRequest",{enumerable:!0,get:s(function(){return RD.SemanticTokensDeltaRequest},"get")});Object.defineProperty(be,"SemanticTokensRangeRequest",{enumerable:!0,get:s(function(){return RD.SemanticTokensRangeRequest},"get")});Object.defineProperty(be,"SemanticTokensRefreshRequest",{enumerable:!0,get:s(function(){return RD.SemanticTokensRefreshRequest},"get")});Object.defineProperty(be,"SemanticTokensRegistrationType",{enumerable:!0,get:s(function(){return RD.SemanticTokensRegistrationType},"get")});var A4t=qLe();Object.defineProperty(be,"ShowDocumentRequest",{enumerable:!0,get:s(function(){return A4t.ShowDocumentRequest},"get")});var y4t=WLe();Object.defineProperty(be,"LinkedEditingRangeRequest",{enumerable:!0,get:s(function(){return y4t.LinkedEditingRangeRequest},"get")});var o2=XLe();Object.defineProperty(be,"FileOperationPatternKind",{enumerable:!0,get:s(function(){return o2.FileOperationPatternKind},"get")});Object.defineProperty(be,"DidCreateFilesNotification",{enumerable:!0,get:s(function(){return o2.DidCreateFilesNotification},"get")});Object.defineProperty(be,"WillCreateFilesRequest",{enumerable:!0,get:s(function(){return o2.WillCreateFilesRequest},"get")});Object.defineProperty(be,"DidRenameFilesNotification",{enumerable:!0,get:s(function(){return o2.DidRenameFilesNotification},"get")});Object.defineProperty(be,"WillRenameFilesRequest",{enumerable:!0,get:s(function(){return o2.WillRenameFilesRequest},"get")});Object.defineProperty(be,"DidDeleteFilesNotification",{enumerable:!0,get:s(function(){return o2.DidDeleteFilesNotification},"get")});Object.defineProperty(be,"WillDeleteFilesRequest",{enumerable:!0,get:s(function(){return o2.WillDeleteFilesRequest},"get")});var Ime=nFe();Object.defineProperty(be,"UniquenessLevel",{enumerable:!0,get:s(function(){return Ime.UniquenessLevel},"get")});Object.defineProperty(be,"MonikerKind",{enumerable:!0,get:s(function(){return Ime.MonikerKind},"get")});Object.defineProperty(be,"MonikerRequest",{enumerable:!0,get:s(function(){return Ime.MonikerRequest},"get")});var Tme=aFe();Object.defineProperty(be,"TypeHierarchyPrepareRequest",{enumerable:!0,get:s(function(){return Tme.TypeHierarchyPrepareRequest},"get")});Object.defineProperty(be,"TypeHierarchySubtypesRequest",{enumerable:!0,get:s(function(){return Tme.TypeHierarchySubtypesRequest},"get")});Object.defineProperty(be,"TypeHierarchySupertypesRequest",{enumerable:!0,get:s(function(){return Tme.TypeHierarchySupertypesRequest},"get")});var $9e=uFe();Object.defineProperty(be,"InlineValueRequest",{enumerable:!0,get:s(function(){return $9e.InlineValueRequest},"get")});Object.defineProperty(be,"InlineValueRefreshRequest",{enumerable:!0,get:s(function(){return $9e.InlineValueRefreshRequest},"get")});var wme=mFe();Object.defineProperty(be,"InlayHintRequest",{enumerable:!0,get:s(function(){return wme.InlayHintRequest},"get")});Object.defineProperty(be,"InlayHintResolveRequest",{enumerable:!0,get:s(function(){return wme.InlayHintResolveRequest},"get")});Object.defineProperty(be,"InlayHintRefreshRequest",{enumerable:!0,get:s(function(){return wme.InlayHintRefreshRequest},"get")});var m9=xFe();Object.defineProperty(be,"DiagnosticServerCancellationData",{enumerable:!0,get:s(function(){return m9.DiagnosticServerCancellationData},"get")});Object.defineProperty(be,"DocumentDiagnosticReportKind",{enumerable:!0,get:s(function(){return m9.DocumentDiagnosticReportKind},"get")});Object.defineProperty(be,"DocumentDiagnosticRequest",{enumerable:!0,get:s(function(){return m9.DocumentDiagnosticRequest},"get")});Object.defineProperty(be,"WorkspaceDiagnosticRequest",{enumerable:!0,get:s(function(){return m9.WorkspaceDiagnosticRequest},"get")});Object.defineProperty(be,"DiagnosticRefreshRequest",{enumerable:!0,get:s(function(){return m9.DiagnosticRefreshRequest},"get")});var mC=_Fe();Object.defineProperty(be,"NotebookCellKind",{enumerable:!0,get:s(function(){return mC.NotebookCellKind},"get")});Object.defineProperty(be,"ExecutionSummary",{enumerable:!0,get:s(function(){return mC.ExecutionSummary},"get")});Object.defineProperty(be,"NotebookCell",{enumerable:!0,get:s(function(){return mC.NotebookCell},"get")});Object.defineProperty(be,"NotebookDocument",{enumerable:!0,get:s(function(){return mC.NotebookDocument},"get")});Object.defineProperty(be,"NotebookDocumentSyncRegistrationType",{enumerable:!0,get:s(function(){return mC.NotebookDocumentSyncRegistrationType},"get")});Object.defineProperty(be,"DidOpenNotebookDocumentNotification",{enumerable:!0,get:s(function(){return mC.DidOpenNotebookDocumentNotification},"get")});Object.defineProperty(be,"NotebookCellArrayChange",{enumerable:!0,get:s(function(){return mC.NotebookCellArrayChange},"get")});Object.defineProperty(be,"DidChangeNotebookDocumentNotification",{enumerable:!0,get:s(function(){return mC.DidChangeNotebookDocumentNotification},"get")});Object.defineProperty(be,"DidSaveNotebookDocumentNotification",{enumerable:!0,get:s(function(){return mC.DidSaveNotebookDocumentNotification},"get")});Object.defineProperty(be,"DidCloseNotebookDocumentNotification",{enumerable:!0,get:s(function(){return mC.DidCloseNotebookDocumentNotification},"get")});var C4t=PFe();Object.defineProperty(be,"InlineCompletionRequest",{enumerable:!0,get:s(function(){return C4t.InlineCompletionRequest},"get")});var yme;(function(t){function e(r){let n=r;return ru.string(n)||ru.string(n.language)||ru.string(n.scheme)||ru.string(n.pattern)}s(e,"is"),t.is=e})(yme||(be.TextDocumentFilter=yme={}));var Cme;(function(t){function e(r){let n=r;return ru.objectLiteral(n)&&(ru.string(n.notebookType)||ru.string(n.scheme)||ru.string(n.pattern))}s(e,"is"),t.is=e})(Cme||(be.NotebookDocumentFilter=Cme={}));var vme;(function(t){function e(r){let n=r;return ru.objectLiteral(n)&&(ru.string(n.notebook)||Cme.is(n.notebook))&&(n.language===void 0||ru.string(n.language))}s(e,"is"),t.is=e})(vme||(be.NotebookCellTextDocumentFilter=vme={}));var xme;(function(t){function e(r){if(!Array.isArray(r))return!1;for(let n of r)if(!ru.string(n)&&!yme.is(n)&&!vme.is(n))return!1;return!0}s(e,"is"),t.is=e})(xme||(be.DocumentSelector=xme={}));var BFe;(function(t){t.method="client/registerCapability",t.messageDirection=jt.MessageDirection.serverToClient,t.type=new jt.ProtocolRequestType(t.method)})(BFe||(be.RegistrationRequest=BFe={}));var NFe;(function(t){t.method="client/unregisterCapability",t.messageDirection=jt.MessageDirection.serverToClient,t.type=new jt.ProtocolRequestType(t.method)})(NFe||(be.UnregistrationRequest=NFe={}));var MFe;(function(t){t.Create="create",t.Rename="rename",t.Delete="delete"})(MFe||(be.ResourceOperationKind=MFe={}));var LFe;(function(t){t.Abort="abort",t.Transactional="transactional",t.TextOnlyTransactional="textOnlyTransactional",t.Undo="undo"})(LFe||(be.FailureHandlingKind=LFe={}));var FFe;(function(t){t.UTF8="utf-8",t.UTF16="utf-16",t.UTF32="utf-32"})(FFe||(be.PositionEncodingKind=FFe={}));var OFe;(function(t){function e(r){let n=r;return n&&ru.string(n.id)&&n.id.length>0}s(e,"hasId"),t.hasId=e})(OFe||(be.StaticRegistrationOptions=OFe={}));var QFe;(function(t){function e(r){let n=r;return n&&(n.documentSelector===null||xme.is(n.documentSelector))}s(e,"is"),t.is=e})(QFe||(be.TextDocumentRegistrationOptions=QFe={}));var UFe;(function(t){function e(n){let i=n;return ru.objectLiteral(i)&&(i.workDoneProgress===void 0||ru.boolean(i.workDoneProgress))}s(e,"is"),t.is=e;function r(n){let i=n;return i&&ru.boolean(i.workDoneProgress)}s(r,"hasWorkDoneProgress"),t.hasWorkDoneProgress=r})(UFe||(be.WorkDoneProgressOptions=UFe={}));var qFe;(function(t){t.method="initialize",t.messageDirection=jt.MessageDirection.clientToServer,t.type=new jt.ProtocolRequestType(t.method)})(qFe||(be.InitializeRequest=qFe={}));var HFe;(function(t){t.unknownProtocolVersion=1})(HFe||(be.InitializeErrorCodes=HFe={}));var $Fe;(function(t){t.method="initialized",t.messageDirection=jt.MessageDirection.clientToServer,t.type=new jt.ProtocolNotificationType(t.method)})($Fe||(be.InitializedNotification=$Fe={}));var WFe;(function(t){t.method="shutdown",t.messageDirection=jt.MessageDirection.clientToServer,t.type=new jt.ProtocolRequestType0(t.method)})(WFe||(be.ShutdownRequest=WFe={}));var jFe;(function(t){t.method="exit",t.messageDirection=jt.MessageDirection.clientToServer,t.type=new jt.ProtocolNotificationType0(t.method)})(jFe||(be.ExitNotification=jFe={}));var GFe;(function(t){t.method="workspace/didChangeConfiguration",t.messageDirection=jt.MessageDirection.clientToServer,t.type=new jt.ProtocolNotificationType(t.method)})(GFe||(be.DidChangeConfigurationNotification=GFe={}));var VFe;(function(t){t.Error=1,t.Warning=2,t.Info=3,t.Log=4,t.Debug=5})(VFe||(be.MessageType=VFe={}));var zFe;(function(t){t.method="window/showMessage",t.messageDirection=jt.MessageDirection.serverToClient,t.type=new jt.ProtocolNotificationType(t.method)})(zFe||(be.ShowMessageNotification=zFe={}));var KFe;(function(t){t.method="window/showMessageRequest",t.messageDirection=jt.MessageDirection.serverToClient,t.type=new jt.ProtocolRequestType(t.method)})(KFe||(be.ShowMessageRequest=KFe={}));var YFe;(function(t){t.method="window/logMessage",t.messageDirection=jt.MessageDirection.serverToClient,t.type=new jt.ProtocolNotificationType(t.method)})(YFe||(be.LogMessageNotification=YFe={}));var JFe;(function(t){t.method="telemetry/event",t.messageDirection=jt.MessageDirection.serverToClient,t.type=new jt.ProtocolNotificationType(t.method)})(JFe||(be.TelemetryEventNotification=JFe={}));var XFe;(function(t){t.None=0,t.Full=1,t.Incremental=2})(XFe||(be.TextDocumentSyncKind=XFe={}));var ZFe;(function(t){t.method="textDocument/didOpen",t.messageDirection=jt.MessageDirection.clientToServer,t.type=new jt.ProtocolNotificationType(t.method)})(ZFe||(be.DidOpenTextDocumentNotification=ZFe={}));var e9e;(function(t){function e(n){let i=n;return i!=null&&typeof i.text=="string"&&i.range!==void 0&&(i.rangeLength===void 0||typeof i.rangeLength=="number")}s(e,"isIncremental"),t.isIncremental=e;function r(n){let i=n;return i!=null&&typeof i.text=="string"&&i.range===void 0&&i.rangeLength===void 0}s(r,"isFull"),t.isFull=r})(e9e||(be.TextDocumentContentChangeEvent=e9e={}));var t9e;(function(t){t.method="textDocument/didChange",t.messageDirection=jt.MessageDirection.clientToServer,t.type=new jt.ProtocolNotificationType(t.method)})(t9e||(be.DidChangeTextDocumentNotification=t9e={}));var r9e;(function(t){t.method="textDocument/didClose",t.messageDirection=jt.MessageDirection.clientToServer,t.type=new jt.ProtocolNotificationType(t.method)})(r9e||(be.DidCloseTextDocumentNotification=r9e={}));var n9e;(function(t){t.method="textDocument/didSave",t.messageDirection=jt.MessageDirection.clientToServer,t.type=new jt.ProtocolNotificationType(t.method)})(n9e||(be.DidSaveTextDocumentNotification=n9e={}));var i9e;(function(t){t.Manual=1,t.AfterDelay=2,t.FocusOut=3})(i9e||(be.TextDocumentSaveReason=i9e={}));var o9e;(function(t){t.method="textDocument/willSave",t.messageDirection=jt.MessageDirection.clientToServer,t.type=new jt.ProtocolNotificationType(t.method)})(o9e||(be.WillSaveTextDocumentNotification=o9e={}));var s9e;(function(t){t.method="textDocument/willSaveWaitUntil",t.messageDirection=jt.MessageDirection.clientToServer,t.type=new jt.ProtocolRequestType(t.method)})(s9e||(be.WillSaveTextDocumentWaitUntilRequest=s9e={}));var a9e;(function(t){t.method="workspace/didChangeWatchedFiles",t.messageDirection=jt.MessageDirection.clientToServer,t.type=new jt.ProtocolNotificationType(t.method)})(a9e||(be.DidChangeWatchedFilesNotification=a9e={}));var c9e;(function(t){t.Created=1,t.Changed=2,t.Deleted=3})(c9e||(be.FileChangeType=c9e={}));var l9e;(function(t){function e(r){let n=r;return ru.objectLiteral(n)&&(DFe.URI.is(n.baseUri)||DFe.WorkspaceFolder.is(n.baseUri))&&ru.string(n.pattern)}s(e,"is"),t.is=e})(l9e||(be.RelativePattern=l9e={}));var u9e;(function(t){t.Create=1,t.Change=2,t.Delete=4})(u9e||(be.WatchKind=u9e={}));var d9e;(function(t){t.method="textDocument/publishDiagnostics",t.messageDirection=jt.MessageDirection.serverToClient,t.type=new jt.ProtocolNotificationType(t.method)})(d9e||(be.PublishDiagnosticsNotification=d9e={}));var f9e;(function(t){t.Invoked=1,t.TriggerCharacter=2,t.TriggerForIncompleteCompletions=3})(f9e||(be.CompletionTriggerKind=f9e={}));var p9e;(function(t){t.method="textDocument/completion",t.messageDirection=jt.MessageDirection.clientToServer,t.type=new jt.ProtocolRequestType(t.method)})(p9e||(be.CompletionRequest=p9e={}));var m9e;(function(t){t.method="completionItem/resolve",t.messageDirection=jt.MessageDirection.clientToServer,t.type=new jt.ProtocolRequestType(t.method)})(m9e||(be.CompletionResolveRequest=m9e={}));var h9e;(function(t){t.method="textDocument/hover",t.messageDirection=jt.MessageDirection.clientToServer,t.type=new jt.ProtocolRequestType(t.method)})(h9e||(be.HoverRequest=h9e={}));var g9e;(function(t){t.Invoked=1,t.TriggerCharacter=2,t.ContentChange=3})(g9e||(be.SignatureHelpTriggerKind=g9e={}));var A9e;(function(t){t.method="textDocument/signatureHelp",t.messageDirection=jt.MessageDirection.clientToServer,t.type=new jt.ProtocolRequestType(t.method)})(A9e||(be.SignatureHelpRequest=A9e={}));var y9e;(function(t){t.method="textDocument/definition",t.messageDirection=jt.MessageDirection.clientToServer,t.type=new jt.ProtocolRequestType(t.method)})(y9e||(be.DefinitionRequest=y9e={}));var C9e;(function(t){t.method="textDocument/references",t.messageDirection=jt.MessageDirection.clientToServer,t.type=new jt.ProtocolRequestType(t.method)})(C9e||(be.ReferencesRequest=C9e={}));var v9e;(function(t){t.method="textDocument/documentHighlight",t.messageDirection=jt.MessageDirection.clientToServer,t.type=new jt.ProtocolRequestType(t.method)})(v9e||(be.DocumentHighlightRequest=v9e={}));var x9e;(function(t){t.method="textDocument/documentSymbol",t.messageDirection=jt.MessageDirection.clientToServer,t.type=new jt.ProtocolRequestType(t.method)})(x9e||(be.DocumentSymbolRequest=x9e={}));var E9e;(function(t){t.method="textDocument/codeAction",t.messageDirection=jt.MessageDirection.clientToServer,t.type=new jt.ProtocolRequestType(t.method)})(E9e||(be.CodeActionRequest=E9e={}));var b9e;(function(t){t.method="codeAction/resolve",t.messageDirection=jt.MessageDirection.clientToServer,t.type=new jt.ProtocolRequestType(t.method)})(b9e||(be.CodeActionResolveRequest=b9e={}));var I9e;(function(t){t.method="workspace/symbol",t.messageDirection=jt.MessageDirection.clientToServer,t.type=new jt.ProtocolRequestType(t.method)})(I9e||(be.WorkspaceSymbolRequest=I9e={}));var T9e;(function(t){t.method="workspaceSymbol/resolve",t.messageDirection=jt.MessageDirection.clientToServer,t.type=new jt.ProtocolRequestType(t.method)})(T9e||(be.WorkspaceSymbolResolveRequest=T9e={}));var w9e;(function(t){t.method="textDocument/codeLens",t.messageDirection=jt.MessageDirection.clientToServer,t.type=new jt.ProtocolRequestType(t.method)})(w9e||(be.CodeLensRequest=w9e={}));var S9e;(function(t){t.method="codeLens/resolve",t.messageDirection=jt.MessageDirection.clientToServer,t.type=new jt.ProtocolRequestType(t.method)})(S9e||(be.CodeLensResolveRequest=S9e={}));var _9e;(function(t){t.method="workspace/codeLens/refresh",t.messageDirection=jt.MessageDirection.serverToClient,t.type=new jt.ProtocolRequestType0(t.method)})(_9e||(be.CodeLensRefreshRequest=_9e={}));var R9e;(function(t){t.method="textDocument/documentLink",t.messageDirection=jt.MessageDirection.clientToServer,t.type=new jt.ProtocolRequestType(t.method)})(R9e||(be.DocumentLinkRequest=R9e={}));var k9e;(function(t){t.method="documentLink/resolve",t.messageDirection=jt.MessageDirection.clientToServer,t.type=new jt.ProtocolRequestType(t.method)})(k9e||(be.DocumentLinkResolveRequest=k9e={}));var P9e;(function(t){t.method="textDocument/formatting",t.messageDirection=jt.MessageDirection.clientToServer,t.type=new jt.ProtocolRequestType(t.method)})(P9e||(be.DocumentFormattingRequest=P9e={}));var D9e;(function(t){t.method="textDocument/rangeFormatting",t.messageDirection=jt.MessageDirection.clientToServer,t.type=new jt.ProtocolRequestType(t.method)})(D9e||(be.DocumentRangeFormattingRequest=D9e={}));var B9e;(function(t){t.method="textDocument/rangesFormatting",t.messageDirection=jt.MessageDirection.clientToServer,t.type=new jt.ProtocolRequestType(t.method)})(B9e||(be.DocumentRangesFormattingRequest=B9e={}));var N9e;(function(t){t.method="textDocument/onTypeFormatting",t.messageDirection=jt.MessageDirection.clientToServer,t.type=new jt.ProtocolRequestType(t.method)})(N9e||(be.DocumentOnTypeFormattingRequest=N9e={}));var M9e;(function(t){t.Identifier=1})(M9e||(be.PrepareSupportDefaultBehavior=M9e={}));var L9e;(function(t){t.method="textDocument/rename",t.messageDirection=jt.MessageDirection.clientToServer,t.type=new jt.ProtocolRequestType(t.method)})(L9e||(be.RenameRequest=L9e={}));var F9e;(function(t){t.method="textDocument/prepareRename",t.messageDirection=jt.MessageDirection.clientToServer,t.type=new jt.ProtocolRequestType(t.method)})(F9e||(be.PrepareRenameRequest=F9e={}));var O9e;(function(t){t.method="workspace/executeCommand",t.messageDirection=jt.MessageDirection.clientToServer,t.type=new jt.ProtocolRequestType(t.method)})(O9e||(be.ExecuteCommandRequest=O9e={}));var Q9e;(function(t){t.method="workspace/applyEdit",t.messageDirection=jt.MessageDirection.serverToClient,t.type=new jt.ProtocolRequestType("workspace/applyEdit")})(Q9e||(be.ApplyWorkspaceEditRequest=Q9e={}))});var G9e=H(KG=>{"use strict";d();Object.defineProperty(KG,"__esModule",{value:!0});KG.createProtocolConnection=void 0;var j9e=i2();function v4t(t,e,r,n){return j9e.ConnectionStrategy.is(n)&&(n={connectionStrategy:n}),(0,j9e.createMessageConnection)(t,e,r,n)}s(v4t,"createProtocolConnection");KG.createProtocolConnection=v4t});var z9e=H(dp=>{"use strict";d();var x4t=dp&&dp.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:s(function(){return e[r]},"get")}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),YG=dp&&dp.__exportStar||function(t,e){for(var r in t)r!=="default"&&!Object.prototype.hasOwnProperty.call(e,r)&&x4t(e,t,r)};Object.defineProperty(dp,"__esModule",{value:!0});dp.LSPErrorCodes=dp.createProtocolConnection=void 0;YG(i2(),dp);YG(BG(),dp);YG(Da(),dp);YG(W9e(),dp);var E4t=G9e();Object.defineProperty(dp,"createProtocolConnection",{enumerable:!0,get:s(function(){return E4t.createProtocolConnection},"get")});var V9e;(function(t){t.lspReservedErrorRangeStart=-32899,t.RequestFailed=-32803,t.ServerCancelled=-32802,t.ContentModified=-32801,t.RequestCancelled=-32800,t.lspReservedErrorRangeEnd=-32800})(V9e||(dp.LSPErrorCodes=V9e={}))});var hi=H(hC=>{"use strict";d();var b4t=hC&&hC.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:s(function(){return e[r]},"get")}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),K9e=hC&&hC.__exportStar||function(t,e){for(var r in t)r!=="default"&&!Object.prototype.hasOwnProperty.call(e,r)&&b4t(e,t,r)};Object.defineProperty(hC,"__esModule",{value:!0});hC.createProtocolConnection=void 0;var I4t=ume();K9e(ume(),hC);K9e(z9e(),hC);function T4t(t,e,r,n){return(0,I4t.createMessageConnection)(t,e,r,n)}s(T4t,"createProtocolConnection");hC.createProtocolConnection=T4t});var s6e=H((tV,o6e)=>{d();(function(t,e){typeof tV=="object"&&typeof o6e<"u"?e(tV):typeof define=="function"&&define.amd?define(["exports"],e):(t=typeof globalThis<"u"?globalThis:t||self,e((t.Microsoft=t.Microsoft||{},t.Microsoft.ApplicationInsights=t.Microsoft.ApplicationInsights||{})))})(tV,function(t){"use strict";function e(w,P){return w||P}s(e,"_pureAssign");function r(w,P){return w[P]}s(r,"_pureRef");var n=void 0,i=null,o="",a="function",c="object",l="prototype",u="__proto__",f="undefined",p="constructor",m="Symbol",h="_polyfill",g="length",A="name",y="call",E="toString",b=e(Object),S=r(b,l),R=e(String),B=r(R,l),L=e(Math),O=e(Array),Y=r(O,l),V=r(Y,"slice");function z(w,P){try{return{v:w.apply(this,P)}}catch(N){return{e:N}}}s(z,"safe");function Q(w){return function(P){return typeof P===w}}s(Q,"_createIs");function U(w){var P="[object "+w+"]";return function(N){return!!(N&&Z(N)===P)}}s(U,"_createObjIs");function Z(w){return S[E].call(w)}s(Z,"objToString");function J(w){return typeof w===f||w===f}s(J,"isUndefined");function j(w){return!X(w)}s(j,"isStrictUndefined");function W(w){return w===i||J(w)}s(W,"isNullOrUndefined");function X(w){return!!w||w!==n}s(X,"isDefined");var oe=Q("string"),te=Q(a);function re(w){return!w&&W(w)?!1:!!w&&typeof w===c}s(re,"isObject");var pe=r(O,"isArray"),Ae=U("Error"),Oe=r(b,"getOwnPropertyDescriptor");function Te(w,P){return!!w&&S.hasOwnProperty[y](w,P)}s(Te,"objHasOwnProperty");var Je=e(r(b,"hasOwn"),Fe);function Fe(w,P){return Te(w,P)||!!Oe(w,P)}s(Fe,"polyObjHasOwn");function lt(w,P,N){if(w&&re(w)){for(var $ in w)if(Je(w,$)&&P[y](N||w,$,w[$])===-1)break}}s(lt,"objForEachKey");var _t={e:"enumerable",c:"configurable",v:"value",w:"writable",g:"get",s:"set"};function xt(w){var P={};if(P[_t.c]=!0,P[_t.e]=!0,w.l){P.get=function(){return w.l.v};var N=Oe(w.l,"v");N&&N.set&&(P.set=function($){w.l.v=$})}return lt(w,function($,de){P[_t[$]]=j(de)?P[_t[$]]:de}),P}s(xt,"_createProp");var gt=r(b,"defineProperty");function ue(w,P,N){return gt(w,P,xt(N))}s(ue,"objDefine");function Ue(w,P,N,$,de){var we={};return lt(w,function(ke,We){ye(we,ke,P?We:ke),ye(we,We,N?We:ke)}),$?$(we):we}s(Ue,"_createKeyValueMap");function ye(w,P,N,$){gt(w,P,{value:N,enumerable:!0,writable:!1})}s(ye,"_assignMapValue");var $e=e(R),ae="[object Error]";function le(w,P){var N=o,$=S[E][y](w);$===ae&&(w={stack:$e(w.stack),message:$e(w.message),name:$e(w.name)});try{N=JSON.stringify(w,i,P?typeof P=="number"?P:4:n),N=(N?N.replace(/"(\w+)"\s*:\s{0,1}/g,"$1: "):i)||$e(w)}catch(de){N=" - "+le(de,P)}return $+": "+N}s(le,"dumpObj");function qe(w){throw new Error(w)}s(qe,"throwError");function Ne(w){throw new TypeError(w)}s(Ne,"throwTypeError");var Ee=r(b,"freeze");function je(w){return w}s(je,"_doNothing");function tt(w){return w[u]||i}s(tt,"_getProto");var mt=r(b,"assign"),Ft=r(b,"keys"),Jt=e(Ee,je),Qt=e(r(b,"getPrototypeOf"),tt);function zr(w){return Ue(w,1,0,Jt)}s(zr,"createEnum");function Br(w){var P={};return lt(w,function(N,$){ye(P,N,$[1]),ye(P,$[0],$[1])}),Jt(P)}s(Br,"createSimpleMap");function un(w){return Br(w)}s(un,"createTypeMap");var ve="__tsUtils$gblCfg",Ge;function pt(){var w;return typeof globalThis!==f&&(w=globalThis),!w&&typeof self!==f&&(w=self),!w&&typeof window!==f&&(w=window),!w&&typeof global!==f&&(w=global),w}s(pt,"_getGlobalValue");function Tt(){if(!Ge){var w=z(pt).v||{};Ge=w[ve]=w[ve]||{}}return Ge}s(Tt,"_getGlobalConfig");var or=Zt;function Zt(w,P,N){var $=P?P[w]:i;return function(de){var we=(de?de[w]:i)||$;if(we||N){var ke=arguments;return(we||N).apply(de,we?V[y](ke,1):ke)}Ne('"'+$e(w)+'" not defined for '+le(de))}}s(Zt,"_unwrapFunctionWithPoly");var Tr=r(L,"min"),fr=r(L,"max"),rr=or("slice",B),ur=or("substring",B),nr=Zt("substr",B,Mr);function Mr(w,P,N){return W(w)&&Ne("Invalid "+le(w)),N<0?o:(P=P||0,P<0&&(P=fr(P+w[g],0)),J(N)?rr(w,P):rr(w,P,P+N))}s(Mr,"polyStrSubstr");function Kr(w,P){return ur(w,0,P)}s(Kr,"strLeft");var sn="_urid",Cn;function ii(){if(!Cn){var w=Tt();Cn=w.gblSym=w.gblSym||{k:{},s:{}}}return Cn}s(ii,"_globalSymbolRegistry");function Rn(w){var P={description:$e(w),toString:s(function(){return m+"("+w+")"},"toString")};return P[h]=!0,P}s(Rn,"polyNewSymbol");function ti(w){var P=ii();if(!Je(P.k,w)){var N=Rn(w),$=Ft(P.s).length;N[sn]=function(){return $+"_"+N[E]()},P.k[w]=N,P.s[N[sn]()]=$e(w)}return P.k[w]}s(ti,"polySymbolFor");var an;function Jn(){an=Tt()}s(Jn,"_initTestHooks");function Pe(w){return gt({toJSON:s(function(){return w},"toJSON")},"v",{value:w})}s(Pe,"createCachedValue");var K="window",Ce;function Ie(w,P){var N;return function(){return!an&&Jn(),(!N||an.lzy)&&(N=Pe(z(w,P).v)),N.v}}s(Ie,"_getGlobalInstFn");function F(w){return!an&&Jn(),(!Ce||w===!1||an.lzy)&&(Ce=Pe(z(pt).v||i)),Ce.v}s(F,"getGlobal");function D(w,P){var N;if(!Ce||P===!1?N=F(P):N=Ce.v,N&&N[w])return N[w];if(w===K)try{return window}catch{}return i}s(D,"getInst");var ee=Ie(D,["document"]);function ge(){return!!_e()}s(ge,"hasWindow");var _e=Ie(D,[K]);function ut(){return!!St()}s(ut,"hasNavigator");var St=Ie(D,["navigator"]),Kt,er;function Yt(){return Kt=Pe(z(D,[m]).v),Kt}s(Yt,"_initSymbol");function bt(w){var P=(an.lzy?0:Kt)||Yt();return P.v?P.v[w]:n}s(bt,"_getSymbolKey");function vr(w,P){!an&&Jn();var N=(an.lzy?0:Kt)||Yt();return N.v?N.v(w):P?i:Rn(w)}s(vr,"newSymbol");function di(w){return!an&&Jn(),er=(an.lzy?0:er)||Pe(z(bt,["for"]).v),(er.v||ti)(w)}s(di,"symbolFor");function no(w,P,N){return w.apply(P,N)}s(no,"fnApply");function Tn(w,P,N){if(w)for(var $=w[g]>>>0,de=0;de<$&&!(de in w&&P[y](N||w,w[de],de,w)===-1);de++);}s(Tn,"arrForEach");var yo=or("indexOf",Y),xi=or("map",Y),Zo=or("reduce",Y),va=e(r(b,"create"),Ic);function Ic(w){if(!w)return{};var P=typeof w;P!==c&&P!==a&&Ne("Prototype must be an Object or function: "+le(w));function N(){}return s(N,"tempFunc"),N[l]=w,new N}s(Ic,"polyObjCreate");var Mo;function Vs(w,P){var N=b.setPrototypeOf||function($,de){var we;!Mo&&(Mo=Pe((we={},we[u]=[],we instanceof Array))),Mo.v?$[u]=de:lt(de,function(ke,We){return $[ke]=We})};return N(w,P)}s(Vs,"objSetPrototypeOf");function gd(w,P,N){z(ue,[P,A,{v:w,c:!0,e:!1}]),P=Vs(P,N);function $(){this[p]=P,z(ue,[this,A,{v:w,c:!0,e:!1}])}return s($,"__"),P[l]=N===i?va(N):($[l]=N[l],new $),P}s(gd,"_createCustomError");function Tc(w,P){P&&(w[A]=P)}s(Tc,"_setName");function Tg(w,P,N){var $=N||Error,de=$[l][A],we=Error.captureStackTrace;return gd(w,function(){var ke=this,We=arguments;try{z(Tc,[$,w]);var it=no($,ke,V[y](We))||ke;if(it!==ke){var Et=Qt(ke);Et!==Qt(it)&&Vs(it,Et)}return we&&we(it,ke[p]),P&&P(it,We),it}finally{z(Tc,[$,de])}},$)}s(Tg,"createCustomError");function Tl(){return(Date.now||wg)()}s(Tl,"utcNow");function wg(){return new Date().getTime()}s(wg,"polyUtcNow");function Sg(w){return s(function(N){return W(N)&&Ne("strTrim called ["+le(N)+"]"),N&&N.replace&&(N=N.replace(w,o)),N},"_doTrim")}s(Sg,"_createTrimFn");var YE=Sg(/^\s+|(?=\s)\s+$/g),qa=Zt("trim",B,YE),ku=r(L,"floor"),Pu,Ad,_g;function jl(w){if(!w||typeof w!==c)return!1;_g||(_g=ge()?_e():!0);var P=!1;if(w!==_g){Ad||(Pu=Function[l][E],Ad=Pu[y](b));try{var N=Qt(w);P=!N,P||(Te(N,p)&&(N=N[p]),P=!!(N&&typeof N===a&&Pu[y](N)===Ad))}catch{}}return P}s(jl,"isPlainObject");var JE;function ov(){return!an&&Jn(),(!JE||an.lzy)&&(JE=Pe(z(D,["performance"]).v)),JE.v}s(ov,"getPerformance");var XE=r(L,"round"),jf=Zt("endsWith",B,Gf);function Gf(w,P,N){oe(w)||Ne("'"+le(w)+"' is not a string");var $=oe(P)?P:$e(P),de=!J(N)&&N<w[g]?N:w[g];return ur(w,de-$[g],de)===$}s(Gf,"polyStrEndsWith");var Yr=or("indexOf",B),wc="ref",Rg="unref",kg="hasRef",lL="enabled";function Gc(w,P,N){var $=!0,de=w?P(i):i,we;function ke(){return $=!1,de&&de[Rg]&&de[Rg](),we}s(ke,"_unref");function We(){de&&N(de),de=i}s(We,"_cancel");function it(){return de=P(de),$||ke(),we}s(it,"_refresh");function Et(yr){!yr&&de&&We(),yr&&!de&&it()}return s(Et,"_setEnabled"),we={cancel:We,refresh:it},we[kg]=function(){return de&&de[kg]?de[kg]():$},we[wc]=function(){return $=!0,de&&de[wc]&&de[wc](),we},we[Rg]=ke,we=gt(we,lL,{get:s(function(){return!!de},"get"),set:Et}),{h:we,dn:s(function(){de=i},"dn")}}s(Gc,"_createTimerHandler");function Sy(w,P,N){var $=pe(P),de=$?P.length:0,we=(de>0?P[0]:$?n:P)||setTimeout,ke=(de>1?P[1]:n)||clearTimeout,We=N[0];N[0]=function(){it.dn(),no(We,n,V[y](arguments))};var it=Gc(w,function(Et){if(Et){if(Et.refresh)return Et.refresh(),Et;no(ke,n,[Et])}return no(we,n,N)},function(Et){no(ke,n,[Et])});return it.h}s(Sy,"_createTimeoutWith");function sv(w,P){return Sy(!0,n,V[y](arguments))}s(sv,"scheduleTimeout");var Em=zr,_y=un,ZE="toLowerCase",Is="length",yd="warnToConsole",Ry="throwInternal",f5="watch",uL="apply",io="push",ky="splice",Pg="logger",p5="cancel",eb="name",Cd="unload",dL="version",fL="loggingLevelConsole",pL="messageId",av="message",mL="diagLog",e$="userAgent",hL="split",tb="replace",Py="type",t$="evtName",m5="traceFlags",gL="getAttribute",h5;function Vue(w,P){h5||(h5=Tg("AggregationError",function($,de){de[Is]>1&&($.errors=de[1])}));var N=w||"One or more errors occurred.";throw Tn(P,function($,de){N+=`
`.concat(de," > ").concat(le($))}),new h5(N,P||[])}s(Vue,"throwAggregationError");var zue="function",r$="object",Kue="undefined",Dg="prototype",g5=Object,AL=g5[Dg];(F()||{}).Symbol,(F()||{}).Reflect;var A5="hasOwnProperty",Yue=s(function(w){for(var P,N=1,$=arguments.length;N<$;N++){P=arguments[N];for(var de in P)AL[A5].call(P,de)&&(w[de]=P[de])}return w},"__objAssignFnImpl"),y5=mt||Yue,C5=s(function(w,P){return C5=g5.setPrototypeOf||{__proto__:[]}instanceof Array&&function(N,$){N.__proto__=$}||function(N,$){for(var de in $)$[A5](de)&&(N[de]=$[de])},C5(w,P)},"extendStaticsFn");function Dy(w,P){typeof P!==zue&&P!==null&&Ne("Class extends value "+String(P)+" is not a constructor or null"),C5(w,P);function N(){this.constructor=w}s(N,"__"),w[Dg]=P===null?va(P):(N[Dg]=P[Dg],new N)}s(Dy,"__extendsFn");var v5,cv="constructor",Vf="prototype",zf="function",lv="_dynInstFuncs",rb="_isDynProxy",By="_dynClass",nb="_dynCls$",yL="_dynInstChk",uv=yL,ib="_dfOpts",CL="_unknown_",x5="__proto__",ob="_dyn"+x5,WS="__dynProto$Gbl",E5="_dynInstProto",sb="useBaseInst",ab="setInstFuncs",jS=Object,dv=jS.getPrototypeOf,cb=jS.getOwnPropertyNames,vL=F(),b5=vL[WS]||(vL[WS]={o:(v5={},v5[ab]=!0,v5[sb]=!0,v5),n:1e3});function lb(w){return w&&(w===jS[Vf]||w===Array[Vf])}s(lb,"_isObjectOrArrayPrototype");function ub(w){return lb(w)||w===Function[Vf]}s(ub,"_isObjectArrayOrFunctionPrototype");function Bg(w){var P;if(w){if(dv)return dv(w);var N=w[x5]||w[Vf]||(w[cv]?w[cv][Vf]:null);P=w[ob]||N,Te(w,ob)||(delete w[E5],P=w[ob]=w[E5]||w[ob],w[E5]=N)}return P}s(Bg,"_getObjProto");function bm(w,P){var N=[];if(cb)N=cb(w);else for(var $ in w)typeof $=="string"&&Te(w,$)&&N.push($);if(N&&N.length>0)for(var de=0;de<N.length;de++)P(N[de])}s(bm,"_forEachProp");function db(w,P,N){return P!==cv&&typeof w[P]===zf&&(N||Te(w,P))&&P!==x5&&P!==Vf}s(db,"_isDynamicCandidate");function fb(w){Ne("DynamicProto: "+w)}s(fb,"_throwTypeError");function I5(w){var P=va(null);return bm(w,function(N){!P[N]&&db(w,N,!1)&&(P[N]=w[N])}),P}s(I5,"_getInstanceFuncs");function xL(w,P){for(var N=w.length-1;N>=0;N--)if(w[N]===P)return!0;return!1}s(xL,"_hasVisited");function EL(w,P,N,$){function de(it,Et,yr){var On=Et[yr];if(On[rb]&&$){var ri=it[lv]||{};ri[uv]!==!1&&(On=(ri[Et[By]]||{})[yr]||On)}return function(){return On.apply(it,arguments)}}s(de,"_instFuncProxy");var we=va(null);bm(N,function(it){we[it]=de(P,N,it)});for(var ke=Bg(w),We=[];ke&&!ub(ke)&&!xL(We,ke);)bm(ke,function(it){!we[it]&&db(ke,it,!dv)&&(we[it]=de(P,ke,it))}),We.push(ke),ke=Bg(ke);return we}s(EL,"_getBaseFuncs");function Jue(w,P,N,$){var de=null;if(w&&Te(N,By)){var we=w[lv]||va(null);if(de=(we[N[By]]||va(null))[P],de||fb("Missing ["+P+"] "+zf),!de[yL]&&we[uv]!==!1){for(var ke=!Te(w,P),We=Bg(w),it=[];ke&&We&&!ub(We)&&!xL(it,We);){var Et=We[P];if(Et){ke=Et===$;break}it.push(We),We=Bg(We)}try{ke&&(w[P]=de),de[yL]=1}catch{we[uv]=!1}}}return de}s(Jue,"_getInstFunc");function Xue(w,P,N){var $=P[w];return $===N&&($=Bg(P)[w]),typeof $!==zf&&fb("["+w+"] is not a "+zf),$}s(Xue,"_getProtoFunc");function Zue(w,P,N,$,de){function we(it,Et){var yr=s(function(){var On=Jue(this,Et,it,yr)||Xue(Et,it,yr);return On.apply(this,arguments)},"dynProtoProxy");return yr[rb]=1,yr}if(s(we,"_createDynamicPrototype"),!lb(w)){var ke=N[lv]=N[lv]||va(null);if(!lb(ke)){var We=ke[P]=ke[P]||va(null);ke[uv]!==!1&&(ke[uv]=!!de),lb(We)||bm(N,function(it){db(N,it,!1)&&N[it]!==$[it]&&(We[it]=N[it],delete N[it],(!Te(w,it)||w[it]&&!w[it][rb])&&(w[it]=we(w,it)))})}}}s(Zue,"_populatePrototype");function ede(w,P){if(dv){for(var N=[],$=Bg(P);$&&!ub($)&&!xL(N,$);){if($===w)return!0;N.push($),$=Bg($)}return!1}return!0}s(ede,"_checkPrototype");function bL(w,P){return Te(w,Vf)?w.name||P||CL:((w||{})[cv]||{}).name||P||CL}s(bL,"_getObjName");function GS(w,P,N,$){Te(w,Vf)||fb("theClass is an invalid class definition.");var de=w[Vf];ede(de,P)||fb("["+bL(w)+"] not in hierarchy of ["+bL(P)+"]");var we=null;Te(de,By)?we=de[By]:(we=nb+bL(w,"_")+"$"+b5.n,b5.n++,de[By]=we);var ke=GS[ib],We=!!ke[sb];We&&$&&$[sb]!==void 0&&(We=!!$[sb]);var it=I5(P),Et=EL(de,P,it,We);N(P,Et);var yr=!!dv&&!!ke[ab];yr&&$&&(yr=!!$[ab]),Zue(de,we,P,it,yr!==!1)}s(GS,"dynamicProto"),GS[ib]=b5.o;var Du=void 0,Ha="",n$="Not dynamic - ",i$=/-([a-z])/g,VS=/([^\w\d_$])/g,IL=/^(\d+[\w\d_$])/;function TL(w){return!W(w)}s(TL,"isNotNullOrUndefined");function T5(w){var P=w;return P&&oe(P)&&(P=P[tb](i$,function(N,$){return $.toUpperCase()}),P=P[tb](VS,"_"),P=P[tb](IL,function(N,$){return"_"+$})),P}s(T5,"normalizeJsName");function o$(w,P){return w&&P?Yr(w,P)!==-1:!1}s(o$,"strContains");function Ng(w){return w&&w.toISOString()||""}s(Ng,"toISOString");function Ny(w){return Ae(w)?w[eb]:Ha}s(Ny,"getExceptionName");function zS(w){return function(){function P(){var N=this;w&&lt(w,function($,de){N[$]=de})}return s(P,"class_1"),P}()}s(zS,"createClassFromInterface");var s$="console",w5="JSON",tde="crypto",My="msCrypto",pb="msie",fi="trident/",mb=null,fv=null,Mg=null;function S5(){return typeof console!==Kue?console:D(s$)}s(S5,"getConsole");function bo(){return!!(typeof JSON===r$&&JSON||D(w5)!==null)}s(bo,"hasJSON");function hb(){return bo()?JSON||D(w5):null}s(hb,"getJSON");function Sc(){return D(tde)}s(Sc,"getCrypto");function gb(){return D(My)}s(gb,"getMsCrypto");function KS(){var w=St();if(w&&(w[e$]!==fv||mb===null)){fv=w[e$];var P=(fv||Ha)[ZE]();mb=o$(P,pb)||o$(P,fi)}return mb}s(KS,"isIE");function Ly(w){return(Mg===null||w===!1)&&(Mg=ut()&&!!St().sendBeacon),Mg}s(Ly,"isBeaconsSupported");function YS(w,P){if(w)for(var N=0;N<w[Is];N++){var $=w[N];if($[eb]&&$[eb]===P)return $}return{}}s(YS,"_getNamedValue");function _5(w){var P=ee();return P&&w?YS(P.querySelectorAll("meta"),w).content:null}s(_5,"findMetaTag");function Im(w){var P,N=ov();if(N){var $=N.getEntriesByType("navigation")||[];P=YS(($[Is]>0?$[0]:{}).serverTiming,w).description}return P}s(Im,"findNamedServerTiming");var Ab=4294967296,o0=4294967295,yb=123456789,Fy=987654321,Gl=!1,Cb=yb,Tm=Fy;function a$(w){w<0&&(w>>>=0),Cb=yb+w&o0,Tm=Fy-w&o0,Gl=!0}s(a$,"_mwcSeed");function pv(){try{var w=Tl()&2147483647;a$((Math.random()*Ab^w)+w)}catch{}}s(pv,"_autoSeedMwc");function R5(w){return w>0?ku(vb()/o0*(w+1))>>>0:0}s(R5,"randomValue");function vb(w){var P=0,N=Sc()||gb();return N&&N.getRandomValues&&(P=N.getRandomValues(new Uint32Array(1))[0]&o0),P===0&&KS()&&(Gl||pv(),P=c$()&o0),P===0&&(P=ku(Ab*Math.random()|0)),w||(P>>>=0),P}s(vb,"random32");function c$(w){Tm=36969*(Tm&65535)+(Tm>>16)&o0,Cb=18e3*(Cb&65535)+(Cb>>16)&o0;var P=(Tm<<16)+(Cb&65535)>>>0&o0|0;return w||(P>>>=0),P}s(c$,"mwcRandom32");function mv(w){w===void 0&&(w=22);for(var P="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",N=vb()>>>0,$=0,de=Ha;de[Is]<w;)$++,de+=P.charAt(N&63),N>>>=6,$===5&&(N=(vb()<<2&4294967295|N&3)>>>0,$=0);return de}s(mv,"newId");var wm="3.3.6",k5="."+mv(6),hv=0;function Sm(w){return w.nodeType===1||w.nodeType===9||!+w.nodeType}s(Sm,"_canAcceptData");function P5(w,P){var N=P[w.id];if(!N){N={};try{Sm(P)&&ue(P,w.id,{e:!1,v:N})}catch{}}return N}s(P5,"_getCache");function Lg(w,P){return P===void 0&&(P=!1),T5(w+hv+++(P?"."+wm:Ha)+k5)}s(Lg,"createUniqueNamespace");function _m(w){var P={id:Lg("_aiData-"+(w||Ha)+"."+wm),accept:s(function(N){return Sm(N)},"accept"),get:s(function(N,$,de,we){var ke=N[P.id];return ke?ke[T5($)]:(we&&(ke=P5(P,N),ke[T5($)]=de),de)},"get"),kill:s(function(N,$){if(N&&N[$])try{delete N[$]}catch{}},"kill")};return P}s(_m,"createElmNodeData");function Oy(w){return w&&re(w)&&(w.isVal||w.fb||Je(w,"v")||Je(w,"mrg")||Je(w,"ref")||w.set)}s(Oy,"_isConfigDefaults");function D5(w,P,N){var $,de=N.dfVal||X;if(P&&N.fb){var we=N.fb;pe(we)||(we=[we]);for(var ke=0;ke<we[Is];ke++){var We=we[ke],it=P[We];if(de(it)?$=it:w&&(it=w.cfg[We],de(it)&&($=it),w.set(w.cfg,$e(We),it)),de($))break}}return!de($)&&de(N.v)&&($=N.v),$}s(D5,"_getDefault");function Qy(w,P,N){var $=N;if(N&&Oy(N)&&($=D5(w,P,N)),$){Oy($)&&($=Qy(w,P,$));var de;pe($)?(de=[],de[Is]=$[Is]):jl($)&&(de={}),de&&(lt($,function(we,ke){ke&&Oy(ke)&&(ke=Qy(w,P,ke)),de[we]=ke}),$=de)}return $}s(Qy,"_resolveDefaultValue");function Uy(w,P,N,$){var de,we,ke,We=$,it,Et,yr,On;Oy(We)?(de=We.isVal,we=We.set,yr=We.rdOnly,On=We.blkVal,it=We.mrg,Et=We.ref,!Et&&J(Et)&&(Et=!!it),ke=D5(w,P,We)):ke=$,On&&w.blkVal(P,N);var ri,Er=!0,Fr=P[N];(Fr||!W(Fr))&&(ri=Fr,Er=!1,de&&ri!==ke&&!de(ri)&&(ri=ke,Er=!0),we&&(ri=we(ri,ke,P),Er=ri===ke)),Er?ke?ri=Qy(w,P,ke):ri=ke:(jl(ri)||pe(ke))&&it&&ke&&(jl(ke)||pe(ke))&&lt(ke,function(Xn,Qn){Uy(w,ri,Xn,Qn)}),w.set(P,N,ri),Et&&w.ref(P,N),yr&&w.rdOnly(P,N)}s(Uy,"_applyDefaultValue");var Bu=di("[[ai_dynCfg_1]]"),wL=di("[[ai_blkDynCfg_1]]"),JS=di("[[ai_frcDynCfg_1]]");function SL(w){if(w){var P;if(pe(w)?(P=[],P[Is]=w[Is]):jl(w)&&(P={}),P)return lt(w,function(N,$){P[N]=SL($)}),P}return w}s(SL,"_cfgDeepCopy");function _L(w){if(w){var P=w[Bu]||w;if(P.cfg&&(P.cfg===w||P.cfg[Bu]===P))return P}return null}s(_L,"getDynamicConfigHandler");function xb(w){if(w&&(jl(w)||pe(w)))try{w[wL]=!0}catch{}return w}s(xb,"blockDynamicConversion");function qy(w,P,N){var $=!1;return N&&!w[P.blkVal]&&($=N[JS],!$&&!N[wL]&&($=jl(N)||pe(N))),$}s(qy,"_canMakeDynamic");function s0(w){Ne("InvalidAccess:"+w)}s(s0,"throwInvalidAccess");var l$=["push","pop","shift","unshift","splice"],Fg=s(function(w,P,N,$){w&&w[Ry](3,108,"".concat(N," [").concat(P,"] failed - ")+le($))},"_throwDynamicError");function RL(w,P,N){pe(P)&&Tn(l$,function($){var de=P[$];P[$]=function(){for(var we=[],ke=0;ke<arguments.length;ke++)we[ke]=arguments[ke];var We=de[uL](this,we);return gv(w,P,N,"Patching"),We}})}s(RL,"_patchArray");function Og(w,P){var N=Oe(w,P);return N&&N.get}s(Og,"_getOwnPropGetter");function u$(w,P,N,$){var de={n:N,h:[],trk:s(function(Et){Et&&Et.fn&&(yo(de.h,Et)===-1&&de.h[io](Et),w.trk(Et,de))},"trk"),clr:s(function(Et){var yr=yo(de.h,Et);yr!==-1&&de.h[ky](yr,1)},"clr")},we=!0,ke=!1;function We(){we&&(ke=ke||qy(We,w,$),$&&!$[Bu]&&ke&&($=gv(w,$,N,"Converting")),we=!1);var Et=w.act;return Et&&de.trk(Et),$}s(We,"_getProperty"),We[w.prop]={chng:s(function(){w.add(de)},"chng")};function it(Et){if($!==Et){We[w.ro]&&!w.upd&&s0("["+N+"] is read-only:"+le(P)),we&&(ke=ke||qy(We,w,$),we=!1);var yr=ke&&We[w.rf];if(ke)if(yr){lt($,function(ri){$[ri]=Et?Et[ri]:Du});try{lt(Et,function(ri,Er){Eb(w,$,ri,Er)}),Et=$}catch(ri){Fg((w.hdlr||{})[Pg],N,"Assigning",ri),ke=!1}}else $&&$[Bu]&&lt($,function(ri){var Er=Og($,ri);if(Er){var Fr=Er[w.prop];Fr&&Fr.chng()}});if(Et!==$){var On=Et&&qy(We,w,Et);!yr&&On&&(Et=gv(w,Et,N,"Converting")),$=Et,ke=On}w.add(de)}}s(it,"_setProperty"),ue(P,de.n,{g:We,s:it})}s(u$,"_createDynamicProperty");function Eb(w,P,N,$){if(P){var de=Og(P,N),we=de&&!!de[w.prop];we?P[N]=$:u$(w,P,N,$)}return P}s(Eb,"_setDynamicProperty");function kL(w,P,N,$){if(P){var de=Og(P,N),we=de&&!!de[w.prop],ke=$&&$[0],We=$&&$[1],it=$&&$[2];if(!we){if(it)try{xb(P)}catch(Et){Fg((w.hdlr||{})[Pg],N,"Blocking",Et)}try{Eb(w,P,N,P[N]),de=Og(P,N)}catch(Et){Fg((w.hdlr||{})[Pg],N,"State",Et)}}ke&&(de[w.rf]=ke),We&&(de[w.ro]=We),it&&(de[w.blkVal]=!0)}return P}s(kL,"_setDynamicPropertyState");function gv(w,P,N,$){try{lt(P,function(de,we){Eb(w,P,de,we)}),P[Bu]||(gt(P,Bu,{get:s(function(){return w.hdlr},"get")}),RL(w,P,N))}catch(de){Fg((w.hdlr||{})[Pg],N,$,de)}return P}s(gv,"_makeDynamicObject");var Av="[[ai_",Kf="]]";function d$(w){var P=vr(Av+"get"+w.uid+Kf),N=vr(Av+"ro"+w.uid+Kf),$=vr(Av+"rf"+w.uid+Kf),de=vr(Av+"blkVal"+w.uid+Kf),we=vr(Av+"dtl"+w.uid+Kf),ke=null,We=null,it;function Et(Er,Fr){var Xn=it.act;try{it.act=Er,Er&&Er[we]&&(Tn(Er[we],function(Ui){Ui.clr(Er)}),Er[we]=[]),Fr({cfg:w.cfg,set:w.set.bind(w),setDf:w.setDf.bind(w),ref:w.ref.bind(w),rdOnly:w.rdOnly.bind(w)})}catch(Ui){var Qn=w[Pg];throw Qn&&Qn[Ry](1,107,le(Ui)),Ui}finally{it.act=Xn||null}}s(Et,"_useHandler");function yr(){if(ke){var Er=ke;ke=null,We&&We[p5](),We=null;var Fr=[];if(Tn(Er,function(Xn){if(Xn&&(Xn[we]&&(Tn(Xn[we],function(Qn){Qn.clr(Xn)}),Xn[we]=null),Xn.fn))try{Et(Xn,Xn.fn)}catch(Qn){Fr[io](Qn)}}),ke)try{yr()}catch(Xn){Fr[io](Xn)}Fr[Is]>0&&Vue("Watcher error(s): ",Fr)}}s(yr,"_notifyWatchers");function On(Er){if(Er&&Er.h[Is]>0){ke||(ke=[]),We||(We=sv(function(){We=null,yr()},0));for(var Fr=0;Fr<Er.h[Is];Fr++){var Xn=Er.h[Fr];Xn&&yo(ke,Xn)===-1&&ke[io](Xn)}}}s(On,"_addWatcher");function ri(Er,Fr){if(Er){var Xn=Er[we]=Er[we]||[];yo(Xn,Fr)===-1&&Xn[io](Fr)}}return s(ri,"_trackHandler"),it={prop:P,ro:N,rf:$,blkVal:de,hdlr:w,add:On,notify:yr,use:Et,trk:ri},it}s(d$,"_createState");function rde(w,P){var N={fn:P,rm:s(function(){N.fn=null,w=null,P=null},"rm")};return ue(N,"toJSON",{v:s(function(){return"WatcherHandler"+(N.fn?"":"[X]")},"v")}),w.use(N,P),N}s(rde,"_createAndUseHandler");function f$(w,P,N){var $=_L(P);if($)return $;var de=Lg("dyncfg",!0),we=P&&N!==!1?P:SL(P),ke;function We(){ke.notify()}s(We,"_notifyWatchers");function it(Qn,Ui,Lo){try{Qn=Eb(ke,Qn,Ui,Lo)}catch(oo){Fg(w,Ui,"Setting value",oo)}return Qn[Ui]}s(it,"_setValue");function Et(Qn){return rde(ke,Qn)}s(Et,"_watch");function yr(Qn,Ui){ke.use(null,function(Lo){var oo=ke.upd;try{J(Ui)||(ke.upd=Ui),Qn(Lo)}finally{ke.upd=oo}})}s(yr,"_block");function On(Qn,Ui){var Lo;return kL(ke,Qn,Ui,(Lo={},Lo[0]=!0,Lo))[Ui]}s(On,"_ref");function ri(Qn,Ui){var Lo;return kL(ke,Qn,Ui,(Lo={},Lo[1]=!0,Lo))[Ui]}s(ri,"_rdOnly");function Er(Qn,Ui){var Lo;return kL(ke,Qn,Ui,(Lo={},Lo[2]=!0,Lo))[Ui]}s(Er,"_blkPropValue");function Fr(Qn,Ui){return Ui&&lt(Ui,function(Lo,oo){Uy(Xn,Qn,Lo,oo)}),Qn}s(Fr,"_applyDefaults");var Xn={uid:null,cfg:we,logger:w,notify:We,set:it,setDf:Fr,watch:Et,ref:On,rdOnly:ri,blkVal:Er,_block:yr};return ue(Xn,"uid",{c:!1,e:!1,w:!1,v:de}),ke=d$(Xn),gv(ke,we,"config","Creating"),Xn}s(f$,"_createDynamicHandler");function p$(w,P){w?(w[yd](P),w[Ry](2,108,P)):s0(P)}s(p$,"_logInvalidAccess");function XS(w,P,N,$){var de=f$(N,w||{},$);return P&&de.setDf(de.cfg,P),de}s(XS,"createDynamicConfig");function m$(w,P,N){var $=w[Bu]||w;return $.cfg&&($.cfg===w||$.cfg[Bu]===$)?$[f5](P):(p$(N,n$+le(w)),XS(w,null,N)[f5](P))}s(m$,"onConfigChange");var B5=null;function h$(){var w=D("Microsoft");return w&&(B5=w.ApplicationInsights),B5}s(h$,"_getExtensionNamespace");function nde(w){var P=B5;return!P&&w.disableDbgExt!==!0&&(P=B5||h$()),P?P.ChromeDbgExt:null}s(nde,"getDebugExt");var bb,N5="warnToConsole",g$="AI (Internal): ",A$="AI: ",ide="AITR_",ode={loggingLevelConsole:0,loggingLevelTelemetry:1,maxMessageLimit:25,enableDebug:!1},y$=(bb={},bb[0]=null,bb[1]="errorToConsole",bb[2]=N5,bb[3]="debugToConsole",bb);function C$(w){return w?'"'+w[tb](/\"/g,Ha)+'"':Ha}s(C$,"_sanitizeDiagnosticText");function M5(w,P){var N=S5();if(N){var $="log";N[w]&&($=w),te(N[$])&&N[$](P)}}s(M5,"_logToConsole");var L5=function(){function w(P,N,$,de){$===void 0&&($=!1);var we=this;we[pL]=P,we[av]=($?A$:g$)+P;var ke=Ha;bo()&&(ke=hb().stringify(de));var We=(N?" message:"+C$(N):Ha)+(de?" props:"+C$(ke):Ha);we[av]+=We}return s(w,"_InternalLogMessage"),w.dataType="MessageData",w}();function sde(w,P){return(w||{})[Pg]||new F5(P)}s(sde,"safeGetLogger");var F5=function(){function w(P){this.identifier="DiagnosticLogger",this.queue=[];var N=0,$={},de,we,ke,We,it;GS(w,this,function(Et){it=On(P||{}),Et.consoleLoggingLevel=function(){return de},Et[Ry]=function(Fr,Xn,Qn,Ui,Lo){Lo===void 0&&(Lo=!1);var oo=new L5(Xn,Qn,Lo,Ui);if(We)throw le(oo);var Vc=y$[Fr]||N5;if(J(oo[av]))Er("throw"+(Fr===1?"Critical":"Warning"),oo);else{if(Lo){var eI=+oo[pL];!$[eI]&&de>=Fr&&(Et[Vc](oo[av]),$[eI]=!0)}else de>=Fr&&Et[Vc](oo[av]);yr(Fr,oo)}},Et.debugToConsole=function(Fr){M5("debug",Fr),Er("warning",Fr)},Et[yd]=function(Fr){M5("warn",Fr),Er("warning",Fr)},Et.errorToConsole=function(Fr){M5("error",Fr),Er("error",Fr)},Et.resetInternalMessageCount=function(){N=0,$={}},Et.logInternalMessage=yr,Et[Cd]=function(Fr){it&&it.rm(),it=null};function yr(Fr,Xn){if(!ri()){var Qn=!0,Ui=ide+Xn[pL];if($[Ui]?Qn=!1:$[Ui]=!0,Qn&&(Fr<=we&&(Et.queue[io](Xn),N++,Er(Fr===1?"error":"warn",Xn)),N===ke)){var Lo="Internal events throttle limit per PageView reached for this app.",oo=new L5(23,Lo,!1);Et.queue[io](oo),Fr===1?Et.errorToConsole(Lo):Et[yd](Lo)}}}s(yr,"_logInternalMessage");function On(Fr){return m$(XS(Fr,ode,Et).cfg,function(Xn){var Qn=Xn.cfg;de=Qn[fL],we=Qn.loggingLevelTelemetry,ke=Qn.maxMessageLimit,We=Qn.enableDebug})}s(On,"_setDefaultsFromConfig");function ri(){return N>=ke}s(ri,"_areInternalMessagesThrottled");function Er(Fr,Xn){var Qn=nde(P||{});Qn&&Qn[mL]&&Qn[mL](Fr,Xn)}s(Er,"_debugExtMsg")})}return s(w,"DiagnosticLogger"),w.__ieDyn=1,w}();function O5(w){return w||new F5}s(O5,"_getLogger");function sf(w,P,N,$,de,we){we===void 0&&(we=!1),O5(w)[Ry](P,N,$,de,we)}s(sf,"_throwInternal");function Q5(){for(var w=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],P=Ha,N,$=0;$<4;$++)N=vb(),P+=w[N&15]+w[N>>4&15]+w[N>>8&15]+w[N>>12&15]+w[N>>16&15]+w[N>>20&15]+w[N>>24&15]+w[N>>28&15];var de=w[8+(vb()&3)|0];return nr(P,0,8)+nr(P,9,4)+"4"+nr(P,13,3)+de+nr(P,16,3)+nr(P,19,12)}s(Q5,"generateW3CId");var Ib=/^([\da-f]{2})-([\da-f]{32})-([\da-f]{16})-([\da-f]{2})(-[^\s]{1,64})?$/i,PL="00",Yf="ff",Qi="00000000000000000000000000000000",Qg="0000000000000000",_c=1;function a0(w,P,N){return w&&w[Is]===P&&w!==N?!!w.match(/^[\da-f]*$/i):!1}s(a0,"_isValid");function U5(w,P,N){return a0(w,P)?w:N}s(U5,"_formatValue");function yv(w){(isNaN(w)||w<0||w>255)&&(w=1);for(var P=w.toString(16);P[Is]<2;)P="0"+P;return P}s(yv,"_formatFlags");function Tb(w,P,N,$){return{version:a0($,2,Yf)?$:PL,traceId:wb(w)?w:Q5(),spanId:Sb(P)?P:Kr(Q5(),16),traceFlags:N>=0&&N<=255?N:1}}s(Tb,"createTraceParent");function Jf(w,P){if(!w||(pe(w)&&(w=w[0]||""),!w||!oe(w)||w[Is]>8192))return null;if(w.indexOf(",")!==-1){var N=w[hL](",");w=N[P>0&&N[Is]>P?P:0]}var $=Ib.exec(qa(w));return!$||$[1]===Yf||$[2]===Qi||$[3]===Qg?null:{version:($[1]||Ha)[ZE](),traceId:($[2]||Ha)[ZE](),spanId:($[3]||Ha)[ZE](),traceFlags:parseInt($[4],16)}}s(Jf,"parseTraceParent");function wb(w){return a0(w,32,Qi)}s(wb,"isValidTraceId");function Sb(w){return a0(w,16,Qg)}s(Sb,"isValidSpanId");function _b(w){return!(!w||!a0(w[dL],2,Yf)||!a0(w.traceId,32,Qi)||!a0(w.spanId,16,Qg)||!a0(yv(w[m5]),2))}s(_b,"isValidTraceParent");function q5(w){return _b(w)?(w[m5]&_c)===_c:!1}s(q5,"isSampledFlag");function Cv(w){if(w){var P=yv(w[m5]);a0(P,2)||(P="01");var N=w[dL]||PL;return N!=="00"&&N!=="ff"&&(N=PL),"".concat(N.toLowerCase(),"-").concat(U5(w.traceId,32,Qi).toLowerCase(),"-").concat(U5(w.spanId,16,Qg).toLowerCase(),"-").concat(P.toLowerCase())}return""}s(Cv,"formatTraceParent");function DL(w){var P="traceparent",N=Jf(_5(P),w);return N||(N=Jf(Im(P),w)),N}s(DL,"findW3cTraceParent");function BL(w){var P=w.getElementsByTagName("script"),N=[];return Tn(P,function($){var de=$[gL]("src");if(de){var we=$[gL]("crossorigin"),ke=$.hasAttribute("async")===!0,We=$.hasAttribute("defer")===!0,it=$[gL]("referrerpolicy"),Et={url:de};we&&(Et.crossOrigin=we),ke&&(Et.async=ke),We&&(Et.defer=We),it&&(Et.referrerPolicy=it),N[io](Et)}}),N}s(BL,"findAllScripts");var H5="on",ZS="attachEvent",$5="addEventListener",W5="detachEvent",v$="removeEventListener",NL="events";Lg("aiEvtPageHide"),Lg("aiEvtPageShow");var ade=/\.[\.]+/g,cde=/[\.]+$/,j5=1,Rb=_m("events"),Vl=/^([^.]*)(?:\.(.+)|)/;function e_(w){return w&&w[tb]?w[tb](/^[\s\.]+|(?=[\s\.])[\.\s]+$/g,Ha):w}s(e_,"_normalizeNamespace");function wl(w,P){if(P){var N=Ha;pe(P)?(N=Ha,Tn(P,function(de){de=e_(de),de&&(de[0]!=="."&&(de="."+de),N+=de)})):N=e_(P),N&&(N[0]!=="."&&(N="."+N),w=(w||Ha)+N)}var $=Vl.exec(w||Ha)||[];return{type:$[1],ns:($[2]||Ha).replace(ade,".").replace(cde,Ha)[hL](".").sort().join(".")}}s(wl,"_getEvtNamespace");function Hy(w,P,N){N===void 0&&(N=!0);var $=Rb.get(w,NL,{},N),de=$[P];return de||(de=$[P]=[]),de}s(Hy,"_getRegisteredEvents");function x$(w,P,N,$){w&&P&&P[Py]&&(w[v$]?w[v$](P[Py],N,$):w[W5]&&w[W5](H5+P[Py],N))}s(x$,"_doDetach");function lde(w,P,N,$){var de=!1;return w&&P&&P[Py]&&N&&(w[$5]?(w[$5](P[Py],N,$),de=!0):w[ZS]&&(w[ZS](H5+P[Py],N),de=!0)),de}s(lde,"_doAttach");function t_(w,P,N,$){for(var de=P[Is];de--;){var we=P[de];we&&(!N.ns||N.ns===we[t$].ns)&&(!$||$(we))&&(x$(w,we[t$],we.handler,we.capture),P[ky](de,1))}}s(t_,"_doUnregister");function ML(w,P,N){if(P[Py])t_(w,Hy(w,P[Py]),P,N);else{var $=Rb.get(w,NL,{});lt($,function(de,we){t_(w,we,P,N)}),Ft($)[Is]===0&&Rb.kill(w,NL)}}s(ML,"_unregisterEvents");function ude(w,P){var N;return P?(pe(P)?N=[w].concat(P):N=[w,P],N=wl("xx",N).ns[hL](".")):N=w,N}s(ude,"mergeEvtNamespace");function LL(w,P,N,$,de){de===void 0&&(de=!1);var we=!1;if(w)try{var ke=wl(P,$);if(we=lde(w,ke,N,de),we&&Rb.accept(w)){var We={guid:j5++,evtName:ke,handler:N,capture:de};Hy(w,ke.type)[io](We)}}catch{}return we}s(LL,"eventOn");function E$(w,P,N,$,de){if(de===void 0&&(de=!1),w)try{var we=wl(P,$),ke=!1;ML(w,we,function(We){return we.ns&&!N||We.handler===N?(ke=!0,!0):!1}),ke||x$(w,we,N,de)}catch{}}s(E$,"eventOff");var G5="Microsoft_ApplicationInsights_BypassAjaxInstrumentation",b$="sampleRate",V5="ProcessLegacy",I$="http.method",FL="https://dc.services.visualstudio.com",r_="/v2/track",Rm="not_specified",OL="iKey",T$=_y({requestContextHeader:[0,"Request-Context"],requestContextTargetKey:[1,"appId"],requestContextAppIdFormat:[2,"appId=cid-v1:"],requestIdHeader:[3,"Request-Id"],traceParentHeader:[4,"traceparent"],traceStateHeader:[5,"tracestate"],sdkContextHeader:[6,"Sdk-Context"],sdkContextHeaderAppIdRequest:[7,"appId"],requestContextHeaderLowerCase:[8,"request-context"]}),$y="split",Fn="length",kb="toLowerCase",vv="ingestionendpoint",xv="toString",QL="removeItem",n_="message",Pb="count",z5="preTriggerDate",UL="getUTCDate",K5="stringify",Db="pathname",Ev="match",qL="correlationHeaderExcludePatterns",Xf="name",Bb="extensionConfig",km="properties",vd="measurements",Nb="sizeInBytes",i_="typeName",Mb="exceptions",o_="severityLevel",Lb="problemGroup",af="parsedStack",Y5="hasFullStack",J5="assembly",c0="fileName",Fb="line",Wy="aiDataContract",s_="duration";function HL(w,P,N){var $=P[Fn],de=$L(w,P);if(de[Fn]!==$){for(var we=0,ke=de;N[ke]!==void 0;)we++,ke=ur(de,0,147)+w$(we);de=ke}return de}s(HL,"dataSanitizeKeyAndAddUniqueness");function $L(w,P){var N;return P&&(P=qa($e(P)),P[Fn]>150&&(N=ur(P,0,150),sf(w,2,57,"name is too long.  It has been truncated to 150 characters.",{name:P},!0))),N||P}s($L,"dataSanitizeKey");function Sl(w,P,N){N===void 0&&(N=1024);var $;return P&&(N=N||1024,P=qa($e(P)),P[Fn]>N&&($=ur(P,0,N),sf(w,2,61,"string value is too long. It has been truncated to "+N+" characters.",{value:P},!0))),$||P}s(Sl,"dataSanitizeString");function Pm(w,P){return jL(w,P,2048,66)}s(Pm,"dataSanitizeUrl");function X5(w,P){var N;return P&&P[Fn]>32768&&(N=ur(P,0,32768),sf(w,2,56,"message is too long, it has been truncated to 32768 characters.",{message:P},!0)),N||P}s(X5,"dataSanitizeMessage");function WL(w,P){var N;if(P){var $=""+P;$[Fn]>32768&&(N=ur($,0,32768),sf(w,2,52,"exception is too long, it has been truncated to 32768 characters.",{exception:P},!0))}return N||P}s(WL,"dataSanitizeException");function Ug(w,P){if(P){var N={};lt(P,function($,de){if(re(de)&&bo())try{de=hb()[K5](de)}catch(we){sf(w,2,49,"custom property is not valid",{exception:we},!0)}de=Sl(w,de,8192),$=HL(w,$,N),N[$]=de}),P=N}return P}s(Ug,"dataSanitizeProperties");function Zf(w,P){if(P){var N={};lt(P,function($,de){$=HL(w,$,N),N[$]=de}),P=N}return P}s(Zf,"dataSanitizeMeasurements");function Ob(w,P){return P&&jL(w,P,128,69)[xv]()}s(Ob,"dataSanitizeId");function jL(w,P,N,$){var de;return P&&(P=qa($e(P)),P[Fn]>N&&(de=ur(P,0,N),sf(w,2,$,"input is too long, it has been truncated to "+N+" characters.",{data:P},!0))),de||P}s(jL,"dataSanitizeInput");function w$(w){var P="00"+w;return nr(P,P[Fn]-3)}s(w$,"dsPadNumber");var GL=ee()||{},S$=0,dde=[null,null,null,null,null];function Qb(w){var P=S$,N=dde,$=N[P];return GL.createElement?N[P]||($=N[P]=GL.createElement("a")):$={host:R$(w,!0)},$.href=w,P++,P>=N[Fn]&&(P=0),S$=P,$}s(Qb,"urlParseUrl");function fde(w){var P,N=Qb(w);return N&&(P=N.href),P}s(fde,"urlGetAbsoluteUrl");function pde(w){var P,N=Qb(w);return N&&(P=N[Db]),P}s(pde,"urlGetPathName");function _$(w,P){return w?w.toUpperCase()+" "+P:P}s(_$,"urlGetCompleteUrl");function R$(w,P){var N=qg(w,P)||"";if(N){var $=N[Ev](/(www\d{0,5}\.)?([^\/:]{1,256})(:\d{1,20})?/i);if($!=null&&$[Fn]>3&&oe($[2])&&$[2][Fn]>0)return $[2]+($[3]||"")}return N}s(R$,"urlParseHost");function qg(w,P){var N=null;if(w){var $=w[Ev](/(\w{1,150}):\/\/([^\/:]{1,256})(:\d{1,20})?/i);if($!=null&&$[Fn]>2&&oe($[2])&&$[2][Fn]>0&&(N=$[2]||"",P&&$[Fn]>2)){var de=($[1]||"")[kb](),we=$[3]||"";(de==="http"&&we===":80"||de==="https"&&we===":443")&&(we=""),N+=we}}return N}s(qg,"urlParseFullHost");var k$=[FL+r_,"https://breeze.aimon.applicationinsights.io"+r_,"https://dc-int.services.visualstudio.com"+r_],Ub="cid-v1:";function P$(w){return yo(k$,w[kb]())!==-1}s(P$,"isInternalApplicationInsightsEndpoint");function VL(w){Ub=w}s(VL,"correlationIdSetPrefix");function zL(){return Ub}s(zL,"correlationIdGetPrefix");function jy(w,P,N){if(!P||w&&w.disableCorrelationHeaders)return!1;if(w&&w[qL]){for(var $=0;$<w.correlationHeaderExcludePatterns[Fn];$++)if(w[qL][$].test(P))return!1}var de=Qb(P).host[kb]();if(de&&(Yr(de,":443")!==-1||Yr(de,":80")!==-1)&&(de=(qg(P,!0)||"")[kb]()),(!w||!w.enableCorsCorrelation)&&de&&de!==N)return!1;var we=w&&w.correlationHeaderDomains;if(we){var ke;if(Tn(we,function(Et){var yr=new RegExp(Et.toLowerCase().replace(/\\/g,"\\\\").replace(/\./g,"\\.").replace(/\*/g,".*"));ke=ke||yr.test(de)}),!ke)return!1}var We=w&&w.correlationHeaderExcludedDomains;if(!We||We[Fn]===0)return!0;for(var $=0;$<We[Fn];$++){var it=new RegExp(We[$].toLowerCase().replace(/\\/g,"\\\\").replace(/\./g,"\\.").replace(/\*/g,".*"));if(it.test(de))return!1}return de&&de[Fn]>0}s(jy,"correlationIdCanIncludeCorrelationHeader");function D$(w){if(w){var P=B$(w,T$[1]);if(P&&P!==Ub)return P}}s(D$,"correlationIdGetCorrelationContext");function B$(w,P){if(w)for(var N=w[$y](","),$=0;$<N[Fn];++$){var de=N[$][$y]("=");if(de[Fn]===2&&de[0]===P)return de[1]}}s(B$,"correlationIdGetCorrelationContextValue");function N$(w,P,N,$){var de,we=$,ke=$;if(P&&P[Fn]>0){var We=Qb(P);if(de=We.host,!we)if(We[Db]!=null){var it=We.pathname[Fn]===0?"/":We[Db];it.charAt(0)!=="/"&&(it="/"+it),ke=We[Db],we=Sl(w,N?N+" "+it:it)}else we=Sl(w,P)}else de=$,we=$;return{target:de,name:we,data:ke}}s(N$,"AjaxHelperParseDependencyPath");function mde(){var w=ov();if(w&&w.now&&w.timing){var P=w.now()+w.timing.navigationStart;if(P>0)return P}return Tl()}s(mde,"dateTimeUtilsNow");function hde(w,P){var N=null;return w!==0&&P!==0&&!W(w)&&!W(P)&&(N=P-w),N}s(hde,"dateTimeUtilsDuration");function KL(w,P){var N=w||{};return{getName:s(function(){return N[Xf]},"getName"),setName:s(function($){P&&P.setName($),N[Xf]=$},"setName"),getTraceId:s(function(){return N.traceID},"getTraceId"),setTraceId:s(function($){P&&P.setTraceId($),wb($)&&(N.traceID=$)},"setTraceId"),getSpanId:s(function(){return N.parentID},"getSpanId"),setSpanId:s(function($){P&&P.setSpanId($),Sb($)&&(N.parentID=$)},"setSpanId"),getTraceFlags:s(function(){return N.traceFlags},"getTraceFlags"),setTraceFlags:s(function($){P&&P.setTraceFlags($),N.traceFlags=$},"setTraceFlags")}}s(KL,"createDistributedTraceContextFromTrace");var qb=Em({LocalStorage:0,SessionStorage:1}),gde=Em({AI:0,AI_AND_W3C:1,W3C:2}),a_=Em({Normal:1,Critical:2}),Gy=void 0,l0=void 0,M$="";function Hb(){return Z5()?$b(qb.LocalStorage):null}s(Hb,"_getLocalStorageObject");function $b(w){try{if(W(F()))return null;var P=new Date()[xv](),N=D(w===qb.LocalStorage?"localStorage":"sessionStorage"),$=M$+P;N.setItem($,P);var de=N.getItem($)!==P;if(N[QL]($),!de)return N}catch{}return null}s($b,"_getVerifiedStorageObject");function Wb(){return Hg()?$b(qb.SessionStorage):null}s(Wb,"_getSessionStorageObject");function c_(){Gy=!1,l0=!1}s(c_,"utlDisableStorage");function l_(w){M$=w||""}s(l_,"utlSetStoragePrefix");function Ade(){Gy=Z5(!0),l0=Hg(!0)}s(Ade,"utlEnableStorage");function Z5(w){return(w||Gy===void 0)&&(Gy=!!$b(qb.LocalStorage)),Gy}s(Z5,"utlCanUseLocalStorage");function L$(w,P){var N=Hb();if(N!==null)try{return N.getItem(P)}catch($){Gy=!1,sf(w,2,1,"Browser failed read of local storage. "+Ny($),{exception:le($)})}return null}s(L$,"utlGetLocalStorage");function F$(w,P,N){var $=Hb();if($!==null)try{return $.setItem(P,N),!0}catch(de){Gy=!1,sf(w,2,3,"Browser failed write to local storage. "+Ny(de),{exception:le(de)})}return!1}s(F$,"utlSetLocalStorage");function ep(w,P){var N=Hb();if(N!==null)try{return N[QL](P),!0}catch($){Gy=!1,sf(w,2,5,"Browser failed removal of local storage item. "+Ny($),{exception:le($)})}return!1}s(ep,"utlRemoveStorage");function Hg(w){return(w||l0===void 0)&&(l0=!!$b(qb.SessionStorage)),l0}s(Hg,"utlCanUseSessionStorage");function jb(){var w=[];return Hg()&&lt(D("sessionStorage"),function(P){w.push(P)}),w}s(jb,"utlGetSessionStorageKeys");function O$(w,P){var N=Wb();if(N!==null)try{return N.getItem(P)}catch($){l0=!1,sf(w,2,2,"Browser failed read of session storage. "+Ny($),{exception:le($)})}return null}s(O$,"utlGetSessionStorage");function yde(w,P,N){var $=Wb();if($!==null)try{return $.setItem(P,N),!0}catch(de){l0=!1,sf(w,2,4,"Browser failed write to session storage. "+Ny(de),{exception:le(de)})}return!1}s(yde,"utlSetSessionStorage");function Q$(w,P){var N=Wb();if(N!==null)try{return N[QL](P),!0}catch($){l0=!1,sf(w,2,6,"Browser failed removal of session storage item. "+Ny($),{exception:le($)})}return!1}s(Q$,"utlRemoveSessionStorage");var Cde="appInsightsThrottle",vde=function(){function w(P,N){var $=this,de,we,ke,We,it,Et,yr,On=!1,ri=!1;Fr(),$._getDbgPlgTargets=function(){return[yr]},$.getConfig=function(){return ke},$.canThrottle=function(Nt){var Jr=lF(Nt),vn=Xn(Nt);return Lo(vn,de,Jr)},$.isTriggered=function(Nt){return rW(Nt)},$.isReady=function(){return On},$.flush=function(Nt){try{var Jr=nW(Nt);if(Jr&&Jr[Fn]>0){var vn=Jr.slice(0);return yr[Nt]=[],Tn(vn,function(As){Er(As.msgID,As[n_],As.severity,!1)}),!0}}catch{}return!1},$.flushAll=function(){try{if(yr){var Nt=!0;return lt(yr,function(Jr){var vn=$.flush(parseInt(Jr));Nt=Nt&&vn}),Nt}}catch{}return!1},$.onReadyState=function(Nt,Jr){return Jr===void 0&&(Jr=!0),On=W(Nt)?!0:Nt,On&&Jr?$.flushAll():null},$.sendMessage=function(Nt,Jr,vn){return Er(Nt,Jr,vn,!0)};function Er(Nt,Jr,vn,As){if(On){var zc=Ode(Nt);if(!zc)return;var $a=Xn(Nt),Kc=lF(Nt),Iv=Lo($a,de,Kc),Jy=!1,tI=0,iW=rW(Nt);try{Iv&&!iW?(tI=Tr($a.limit.maxSendNumber,Kc[Pb]+1),Kc[Pb]=0,Jy=!0,it[Nt]=!0,Kc[z5]=new Date):(it[Nt]=Iv,Kc[Pb]+=1);var oW=oo(Nt);cF(we,oW,Kc);for(var p4=0;p4<tI;p4++)tW(Nt,we,Jr,vn)}catch{}return{isThrottled:Jy,throttleNum:tI}}else if(As){var Qde=nW(Nt);Qde.push({msgID:Nt,message:Jr,severity:vn})}return null}s(Er,"_flushMessage");function Fr(){we=sde(P),it={},We={},yr={},ke={},Qn(109),Et=TL(N)?N:"",P.addUnloadHook(m$(P.config,function(Nt){var Jr=Nt.cfg;de=Z5();var vn=Jr.throttleMgrCfg||{};lt(vn,function(As,zc){Qn(parseInt(As),zc)})}))}s(Fr,"_initConfig");function Xn(Nt){return ke[Nt]||ke[109]}s(Xn,"_getCfgByKey");function Qn(Nt,Jr){var vn,As;try{var zc=Jr||{},$a={};$a.disabled=!!zc.disabled;var Kc=zc.interval||{};ri=Kc?.daysOfMonth&&Kc?.daysOfMonth[Fn]>0,$a.interval=Ui(Kc);var Iv={samplingRate:((vn=zc.limit)===null||vn===void 0?void 0:vn.samplingRate)||100,maxSendNumber:((As=zc.limit)===null||As===void 0?void 0:As.maxSendNumber)||1};$a.limit=Iv,ke[Nt]=$a}catch{}}s(Qn,"_setCfgByKey");function Ui(Nt){Nt=Nt||{};var Jr=Nt?.monthInterval,vn=Nt?.dayInterval;return W(Jr)&&W(vn)&&(Nt.monthInterval=3,ri||(Nt.daysOfMonth=[28],ri=!0)),Nt={monthInterval:Nt?.monthInterval,dayInterval:Nt?.dayInterval,daysOfMonth:Nt?.daysOfMonth},Nt}s(Ui,"_getIntervalConfig");function Lo(Nt,Jr,vn){if(Nt&&!Nt.disabled&&Jr&&TL(vn)){var As=A_(),zc=vn.date,$a=Nt.interval,Kc=1;if($a?.monthInterval){var Iv=(As.getUTCFullYear()-zc.getUTCFullYear())*12+As.getUTCMonth()-zc.getUTCMonth();Kc=f4($a.monthInterval,0,Iv)}var Jy=1;if(ri)Jy=yo($a.daysOfMonth,As[UL]());else if($a?.dayInterval){var tI=ku((As.getTime()-zc.getTime())/864e5);Jy=f4($a.dayInterval,0,tI)}return Kc>=0&&Jy>=0}return!1}s(Lo,"_canThrottle");function oo(Nt,Jr){var vn=TL(Jr)?Jr:"";return Nt?Cde+vn+"-"+Nt:null}s(oo,"_getLocalStorageName");function Vc(Nt){try{if(Nt){var Jr=new Date;return Nt.getUTCFullYear()===Jr.getUTCFullYear()&&Nt.getUTCMonth()===Jr.getUTCMonth()&&Nt[UL]()===Jr[UL]()}}catch{}return!1}s(Vc,"_isTriggeredOnCurDate");function eI(Nt,Jr,vn){try{var As={date:A_(),count:0};if(Nt){var zc=JSON.parse(Nt),$a={date:A_(zc.date)||As.date,count:zc[Pb]||As[Pb],preTriggerDate:zc.preTriggerDate?A_(zc[z5]):void 0};return $a}else return cF(Jr,vn,As),As}catch{}return null}s(eI,"_getLocalStorageObj");function A_(Nt){try{if(Nt){var Jr=new Date(Nt);if(!isNaN(Jr.getDate()))return Jr}else return new Date}catch{}return null}s(A_,"_getThrottleDate");function cF(Nt,Jr,vn){try{return F$(Nt,Jr,qa(JSON[K5](vn)))}catch{}return!1}s(cF,"_resetLocalStorage");function f4(Nt,Jr,vn){return Nt<=0?1:vn>=Jr&&(vn-Jr)%Nt==0?ku((vn-Jr)/Nt)+1:-1}s(f4,"_checkInterval");function tW(Nt,Jr,vn,As){sf(Jr,As||1,Nt,vn)}s(tW,"_sendMessage");function Ode(Nt){try{var Jr=Xn(Nt);return R5(1e6)<=Jr.limit.samplingRate}catch{}return!1}s(Ode,"_canSampledIn");function lF(Nt){try{var Jr=We[Nt];if(!Jr){var vn=oo(Nt,Et);Jr=eI(L$(we,vn),we,vn),We[Nt]=Jr}return We[Nt]}catch{}return null}s(lF,"_getLocalStorageObjByKey");function rW(Nt){var Jr=it[Nt];if(W(Jr)){Jr=!1;var vn=lF(Nt);vn&&(Jr=Vc(vn[z5])),it[Nt]=Jr}return it[Nt]}s(rW,"_isTrigger");function nW(Nt){return yr=yr||{},W(yr[Nt])&&(yr[Nt]=[]),yr[Nt]}s(nW,"_getQueueByKey")}return s(w,"ThrottleMgr"),w}(),YL=";",Dm="=";function e4(w){if(!w)return{};var P=w[$y](YL),N=Zo(P,function(de,we){var ke=we[$y](Dm);if(ke[Fn]===2){var We=ke[0][kb](),it=ke[1];de[We]=it}return de},{});if(Ft(N)[Fn]>0){if(N.endpointsuffix){var $=N.location?N.location+".":"";N[vv]=N[vv]||"https://"+$+"dc."+N.endpointsuffix}N[vv]=N[vv]||FL,jf(N[vv],"/")&&(N[vv]=N[vv].slice(0,-1))}return N}s(e4,"parseConnectionString");var t4={parse:e4},r4=function(){function w(P,N,$){var de=this,we=this;we.ver=1,we.sampleRate=100,we.tags={},we[Xf]=Sl(P,$)||Rm,we.data=N,we.time=Ng(new Date),we[Wy]={time:1,iKey:1,name:1,sampleRate:s(function(){return de.sampleRate===100?4:1},"sampleRate"),tags:1,data:1}}return s(w,"Envelope"),w}(),xde=function(){function w(P,N,$,de){this.aiDataContract={ver:1,name:1,properties:0,measurements:0};var we=this;we.ver=2,we[Xf]=Sl(P,N)||Rm,we[km]=Ug(P,$),we[vd]=Zf(P,de)}return s(w,"Event"),w.envelopeType="Microsoft.ApplicationInsights.{0}.Event",w.dataType="EventData",w}(),Ede=58,U$=/^\s{0,50}(from\s|at\s|Line\s{1,5}\d{1,10}\s{1,5}of|\w{1,50}@\w{1,80}|[^\(\s\n]+:[0-9\?]+(?::[0-9\?]+)?)/,bde=/^(?:\s{0,50}at)?\s{0,50}([^\@\()\s]+)?\s{0,50}(?:\s|\@|\()\s{0,5}([^\(\s\n\]]+):([0-9\?]+):([0-9\?]+)\)?$/,Gb=/^(?:\s{0,50}at)?\s{0,50}([^\@\()\s]+)?\s{0,50}(?:\s|\@|\()\s{0,5}([^\(\s\n\]]+):([0-9\?]+)\)?$/,q$=/^(?:\s{0,50}at)?\s{0,50}([^\@\()\s]+)?\s{0,50}(?:\s|\@|\()\s{0,5}([^\(\s\n\)\]]+)\)?$/,Ide=/(?:^|\(|\s{0,10}[\w\)]+\@)?([^\(\n\s\]\)]+)(?:\:([0-9]+)(?:\:([0-9]+))?)?\)?(?:,|$)/,Tde=/([^\(\s\n]+):([0-9]+):([0-9]+)$/,wde=/([^\(\s\n]+):([0-9]+)$/,H$="<no_method>",Vb="error",cf="stack",u_="stackDetails",n4="errorSrc",d_="message",f_="description",JL=[{re:bde,len:5,m:1,fn:2,ln:3,col:4},{chk:i4,pre:Ur,re:Gb,len:4,m:1,fn:2,ln:3},{re:q$,len:3,m:1,fn:2,hdl:ZL},{re:Ide,len:2,fn:1,hdl:ZL}];function Ur(w){return w.replace(/(\(anonymous\))/,"<anonymous>")}s(Ur,"_scrubAnonymous");function i4(w){return Yr(w,"[native")<0}s(i4,"_ignoreNative");function p_(w,P){var N=w;return N&&!oe(N)&&(JSON&&JSON[K5]?(N=JSON[K5](w),P&&(!N||N==="{}")&&(te(w[xv])?N=w[xv]():N=""+w)):N=""+w+" - (Missing JSON.stringify)"),N||""}s(p_,"_stringify");function Vy(w,P){var N=w;return w&&(N&&!oe(N)&&(N=w[d_]||w[f_]||N),N&&!oe(N)&&(N=p_(N,!0)),w.filename&&(N=N+" @"+(w.filename||"")+":"+(w.lineno||"?")+":"+(w.colno||"?"))),P&&P!=="String"&&P!=="Object"&&P!=="Error"&&Yr(N||"",P)===-1&&(N=P+": "+N),N||""}s(Vy,"_formatMessage");function $$(w){try{if(re(w))return"hasFullStack"in w&&"typeName"in w}catch{}return!1}s($$,"_isExceptionDetailsInternal");function W$(w){try{if(re(w))return"ver"in w&&"exceptions"in w&&"properties"in w}catch{}return!1}s(W$,"_isExceptionInternal");function o4(w){return w&&w.src&&oe(w.src)&&w.obj&&pe(w.obj)}s(o4,"_isStackDetails");function $g(w){var P=w||"";oe(P)||(oe(P[cf])?P=P[cf]:P=""+P);var N=P[$y](`
`);return{src:P,obj:N}}s($g,"_convertStackObj");function j$(w){for(var P=[],N=w[$y](`
`),$=0;$<N[Fn];$++){var de=N[$];N[$+1]&&(de+="@"+N[$+1],$++),P.push(de)}return{src:w,obj:P}}s(j$,"_getOperaStack");function s4(w){var P=null;if(w)try{if(w[cf])P=$g(w[cf]);else if(w[Vb]&&w[Vb][cf])P=$g(w[Vb][cf]);else if(w.exception&&w.exception[cf])P=$g(w.exception[cf]);else if(o4(w))P=w;else if(o4(w[u_]))P=w[u_];else if(_e()&&_e().opera&&w[d_])P=j$(w[n_]);else if(w.reason&&w.reason[cf])P=$g(w.reason[cf]);else if(oe(w))P=$g(w);else{var N=w[d_]||w[f_]||"";oe(w[n4])&&(N&&(N+=`
`),N+=" from "+w[n4]),N&&(P=$g(N))}}catch($){P=$g($)}return P||{src:"",obj:null}}s(s4,"_getStackFromErrorObj");function G$(w){var P="";return w&&(w.obj?P=w.obj.join(`
`):P=w.src||""),P}s(G$,"_formatStackTrace");function a4(w){var P,N=w.obj;if(N&&N[Fn]>0){P=[];var $=0,de=!1,we=0;Tn(N,function(Xn){if(de||Sde(Xn)){var Qn=$e(Xn);de=!0;var Ui=_de(Qn,$);Ui&&(we+=Ui[Nb],P.push(Ui),$++)}});var ke=32*1024;if(we>ke)for(var We=0,it=P[Fn]-1,Et=0,yr=We,On=it;We<it;){var ri=P[We][Nb],Er=P[it][Nb];if(Et+=ri+Er,Et>ke){var Fr=On-yr+1;P.splice(yr,Fr);break}yr=We,On=it,We++,it--}}return P}s(a4,"_parseStack");function zb(w){var P="";if(w&&(P=w.typeName||w[Xf]||"",!P))try{var N=/function (.{1,200})\(/,$=N.exec(w.constructor[xv]());P=$&&$[Fn]>1?$[1]:""}catch{}return P}s(zb,"_getErrorType");function c4(w){if(w)try{if(!oe(w)){var P=zb(w),N=p_(w,!1);return(!N||N==="{}")&&(w[Vb]&&(w=w[Vb],P=zb(w)),N=p_(w,!0)),Yr(N,P)!==0&&P!=="String"?P+":"+N:N}}catch{}return""+(w||"")}s(c4,"_formatErrorCode");var Bm=function(){function w(P,N,$,de,we,ke){this.aiDataContract={ver:1,exceptions:1,severityLevel:0,properties:0,measurements:0};var We=this;We.ver=2,W$(N)?(We[Mb]=N[Mb]||[],We[km]=N[km],We[vd]=N[vd],N[o_]&&(We[o_]=N[o_]),N.id&&(We.id=N.id,N[km].id=N.id),N[Lb]&&(We[Lb]=N[Lb]),W(N.isManual)||(We.isManual=N.isManual)):($||($={}),ke&&($.id=ke),We[Mb]=[K$(P,N,$)],We[km]=Ug(P,$),We[vd]=Zf(P,de),we&&(We[o_]=we),ke&&(We.id=ke))}return s(w,"Exception"),w.CreateAutoException=function(P,N,$,de,we,ke,We,it){var Et=zb(we||ke||P);return{message:Vy(P,Et),url:N,lineNumber:$,columnNumber:de,error:c4(we||ke||P),evt:c4(ke||P),typeName:Et,stackDetails:s4(We||we||ke),errorSrc:it}},w.CreateFromInterface=function(P,N,$,de){var we=N[Mb]&&xi(N[Mb],function(We){return XL(P,We)}),ke=new w(P,y5(y5({},N),{exceptions:we}),$,de);return ke},w.prototype.toInterface=function(){var P=this,N=P.exceptions,$=P.properties,de=P.measurements,we=P.severityLevel,ke=P.problemGroup,We=P.id,it=P.isManual,Et=N instanceof Array&&xi(N,function(yr){return yr.toInterface()})||void 0;return{ver:"4.0",exceptions:Et,severityLevel:we,properties:$,measurements:de,problemGroup:ke,id:We,isManual:it}},w.CreateSimpleException=function(P,N,$,de,we,ke){var We;return{exceptions:[(We={},We[Y5]=!0,We.message=P,We.stack=we,We.typeName=N,We)]}},w.envelopeType="Microsoft.ApplicationInsights.{0}.Exception",w.dataType="ExceptionData",w.formatError=c4,w}(),V$=Jt({id:0,outerId:0,typeName:1,message:1,hasFullStack:0,stack:0,parsedStack:2});function z$(){var w=this,P=pe(w[af])&&xi(w[af],function($){return J$($)}),N={id:w.id,outerId:w.outerId,typeName:w[i_],message:w[n_],hasFullStack:w[Y5],stack:w[cf],parsedStack:P||void 0};return N}s(z$,"_toInterface");function K$(w,P,N){var $,de,we,ke,We,it,Et,yr;if($$(P))ke=P[i_],We=P[n_],Et=P[cf],yr=P[af]||[],it=P[Y5];else{var On=P,ri=On&&On.evt;Ae(On)||(On=On[Vb]||ri||On),ke=Sl(w,zb(On))||Rm,We=X5(w,Vy(P||On,ke))||Rm;var Er=P[u_]||s4(P);yr=a4(Er),pe(yr)&&xi(yr,function(Fr){Fr[J5]=Sl(w,Fr[J5]),Fr[c0]=Sl(w,Fr[c0])}),Et=WL(w,G$(Er)),it=pe(yr)&&yr[Fn]>0,N&&(N[i_]=N[i_]||ke)}return $={},$[Wy]=V$,$.id=de,$.outerId=we,$.typeName=ke,$.message=We,$[Y5]=it,$.stack=Et,$.parsedStack=yr,$.toInterface=z$,$}s(K$,"_createExceptionDetails");function XL(w,P){var N=pe(P[af])&&xi(P[af],function(de){return Y$(de)})||P[af],$=K$(w,y5(y5({},P),{parsedStack:N}));return $}s(XL,"_createExDetailsFromInterface");function m_(w,P){var N=P[Ev](Tde);if(N&&N[Fn]>=4)w[c0]=N[1],w[Fb]=parseInt(N[2]);else{var $=P[Ev](wde);$&&$[Fn]>=3?(w[c0]=$[1],w[Fb]=parseInt($[2])):w[c0]=P}}s(m_,"_parseFilename");function ZL(w,P,N){var $=w[c0];P.fn&&N&&N[Fn]>P.fn&&(P.ln&&N[Fn]>P.ln?($=qa(N[P.fn]||""),w[Fb]=parseInt(qa(N[P.ln]||""))||0):$=qa(N[P.fn]||"")),$&&m_(w,$)}s(ZL,"_handleFilename");function Sde(w){var P=!1;if(w&&oe(w)){var N=qa(w);N&&(P=U$.test(N))}return P}s(Sde,"_isStackFrame");var eF=Jt({level:1,method:1,assembly:0,fileName:0,line:0});function _de(w,P){var N,$;if(w&&oe(w)&&qa(w)){$=(N={},N[Wy]=eF,N.level=P,N.assembly=qa(w),N.method=H$,N.fileName="",N.line=0,N.sizeInBytes=0,N);for(var de=0;de<JL[Fn];){var we=JL[de];if(we.chk&&!we.chk(w))break;we.pre&&(w=we.pre(w));var ke=w[Ev](we.re);if(ke&&ke[Fn]>=we.len){we.m&&($.method=qa(ke[we.m]||H$)),we.hdl?we.hdl($,we,ke):we.fn&&(we.ln?($[c0]=qa(ke[we.fn]||""),$[Fb]=parseInt(qa(ke[we.ln]||""))||0):m_($,ke[we.fn]||""));break}de++}}return tF($)}s(_de,"_extractStackFrame");function Y$(w){var P,N=(P={},P[Wy]=eF,P.level=w.level,P.method=w.method,P.assembly=w[J5],P.fileName=w[c0],P.line=w[Fb],P.sizeInBytes=0,P);return tF(N)}s(Y$,"_stackFrameFromInterface");function tF(w){var P=Ede;return w&&(P+=w.method[Fn],P+=w.assembly[Fn],P+=w.fileName[Fn],P+=w.level.toString()[Fn],P+=w.line.toString()[Fn],w[Nb]=P),w}s(tF,"_populateFrameSizeInBytes");function J$(w){return{level:w.level,method:w.method,assembly:w[J5],fileName:w[c0],line:w[Fb]}}s(J$,"_parsedFrameToInterface");var X$=function(){function w(){this.aiDataContract={name:1,kind:0,value:1,count:0,min:0,max:0,stdDev:0},this.kind=0}return s(w,"DataPoint"),w}(),Rde=function(){function w(P,N,$,de,we,ke,We,it,Et){this.aiDataContract={ver:1,metrics:1,properties:0};var yr=this;yr.ver=2;var On=new X$;On[Pb]=de>0?de:void 0,On.max=isNaN(ke)||ke===null?void 0:ke,On.min=isNaN(we)||we===null?void 0:we,On[Xf]=Sl(P,N)||Rm,On.value=$,On.stdDev=isNaN(We)||We===null?void 0:We,yr.metrics=[On],yr[km]=Ug(P,it),yr[vd]=Zf(P,Et)}return s(w,"Metric"),w.envelopeType="Microsoft.ApplicationInsights.{0}.Metric",w.dataType="MetricData",w}(),Kb="";function kde(w,P){return P===void 0&&(P=!1),w==null?P:w.toString()[kb]()==="true"}s(kde,"stringToBoolOrDefault");function rF(w){(isNaN(w)||w<0)&&(w=0),w=XE(w);var P=Kb+w%1e3,N=Kb+ku(w/1e3)%60,$=Kb+ku(w/(1e3*60))%60,de=Kb+ku(w/(1e3*60*60))%24,we=ku(w/(1e3*60*60*24));return P=P[Fn]===1?"00"+P:P[Fn]===2?"0"+P:P,N=N[Fn]<2?"0"+N:N,$=$[Fn]<2?"0"+$:$,de=de[Fn]<2?"0"+de:de,(we>0?we+".":Kb)+de+":"+$+":"+N+"."+P}s(rF,"msToTimeSpan");function Pde(w,P){var N=null;return Tn(w,function($){if($.identifier===P)return N=$,-1}),N}s(Pde,"getExtensionByName");function zy(w,P,N,$,de){return!de&&oe(w)&&(w==="Script error."||w==="Script error")}s(zy,"isCrossOriginError");var Dde=function(){function w(P,N,$,de,we,ke,We){this.aiDataContract={ver:1,name:0,url:0,duration:0,properties:0,measurements:0,id:0};var it=this;it.ver=2,it.id=Ob(P,We),it.url=Pm(P,$),it[Xf]=Sl(P,N)||Rm,isNaN(de)||(it[s_]=rF(de)),it[km]=Ug(P,we),it[vd]=Zf(P,ke)}return s(w,"PageView"),w.envelopeType="Microsoft.ApplicationInsights.{0}.Pageview",w.dataType="PageviewData",w}(),Yb=function(){function w(P,N,$,de,we,ke,We,it,Et,yr,On,ri){Et===void 0&&(Et="Ajax"),this.aiDataContract={id:1,ver:1,name:0,resultCode:0,duration:0,success:0,data:0,target:0,type:0,properties:0,measurements:0,kind:0,value:0,count:0,min:0,max:0,stdDev:0,dependencyKind:0,dependencySource:0,commandName:0,dependencyTypeName:0};var Er=this;Er.ver=2,Er.id=N,Er[s_]=rF(we),Er.success=ke,Er.resultCode=We+"",Er.type=Sl(P,Et);var Fr=N$(P,$,it,de);Er.data=Pm(P,de)||Fr.data,Er.target=Sl(P,Fr.target),yr&&(Er.target="".concat(Er.target," | ").concat(yr)),Er[Xf]=Sl(P,Fr[Xf]),Er[km]=Ug(P,On),Er[vd]=Zf(P,ri)}return s(w,"RemoteDependencyData"),w.envelopeType="Microsoft.ApplicationInsights.{0}.RemoteDependency",w.dataType="RemoteDependencyData",w}(),nF=function(){function w(P,N,$,de,we){this.aiDataContract={ver:1,message:1,severityLevel:0,properties:0};var ke=this;ke.ver=2,N=N||Rm,ke[n_]=X5(P,N),ke[km]=Ug(P,de),ke[vd]=Zf(P,we),$&&(ke[o_]=$)}return s(w,"Trace"),w.envelopeType="Microsoft.ApplicationInsights.{0}.Message",w.dataType="MessageData",w}(),h_=function(){function w(P,N,$,de,we,ke,We){this.aiDataContract={ver:1,name:0,url:0,duration:0,perfTotal:0,networkConnect:0,sentRequest:0,receivedResponse:0,domProcessing:0,properties:0,measurements:0};var it=this;it.ver=2,it.url=Pm(P,$),it[Xf]=Sl(P,N)||Rm,it[km]=Ug(P,we),it[vd]=Zf(P,ke),We&&(it.domProcessing=We.domProcessing,it[s_]=We[s_],it.networkConnect=We.networkConnect,it.perfTotal=We.perfTotal,it.receivedResponse=We.receivedResponse,it.sentRequest=We.sentRequest)}return s(w,"PageViewPerformance"),w.envelopeType="Microsoft.ApplicationInsights.{0}.PageviewPerformance",w.dataType="PageviewPerformanceData",w}(),Bde=function(){function w(P,N){this.aiDataContract={baseType:1,baseData:1},this.baseType=P,this.baseData=N}return s(w,"Data"),w}(),l4=Em({Verbose:0,Information:1,Warning:2,Error:3,Critical:4}),Nde=function(){function w(){}return s(w,"ConfigurationManager"),w.getConfig=function(P,N,$,de){de===void 0&&(de=!1);var we;return $&&P[Bb]&&P[Bb][$]&&!W(P[Bb][$][N])?we=P[Bb][$][N]:we=P[N],W(we)?de:we},w}();function Nm(w){var P="ai."+w+".";return function(N){return P+N}}s(Nm,"_aiNameFunc");var Jb=Nm("application"),Rc=Nm("device"),u4=Nm("location"),Xb=Nm("operation"),d4=Nm("session"),Ky=Nm("user"),bv=Nm("cloud"),g_=Nm("internal"),Yy=function(w){Dy(P,w);function P(){return w.call(this)||this}return s(P,"ContextTagKeys"),P}(zS({applicationVersion:Jb("ver"),applicationBuild:Jb("build"),applicationTypeId:Jb("typeId"),applicationId:Jb("applicationId"),applicationLayer:Jb("layer"),deviceId:Rc("id"),deviceIp:Rc("ip"),deviceLanguage:Rc("language"),deviceLocale:Rc("locale"),deviceModel:Rc("model"),deviceFriendlyName:Rc("friendlyName"),deviceNetwork:Rc("network"),deviceNetworkName:Rc("networkName"),deviceOEMName:Rc("oemName"),deviceOS:Rc("os"),deviceOSVersion:Rc("osVersion"),deviceRoleInstance:Rc("roleInstance"),deviceRoleName:Rc("roleName"),deviceScreenResolution:Rc("screenResolution"),deviceType:Rc("type"),deviceMachineName:Rc("machineName"),deviceVMName:Rc("vmName"),deviceBrowser:Rc("browser"),deviceBrowserVersion:Rc("browserVersion"),locationIp:u4("ip"),locationCountry:u4("country"),locationProvince:u4("province"),locationCity:u4("city"),operationId:Xb("id"),operationName:Xb("name"),operationParentId:Xb("parentId"),operationRootId:Xb("rootId"),operationSyntheticSource:Xb("syntheticSource"),operationCorrelationVector:Xb("correlationVector"),sessionId:d4("id"),sessionIsFirst:d4("isFirst"),sessionIsNew:d4("isNew"),userAccountAcquisitionDate:Ky("accountAcquisitionDate"),userAccountId:Ky("accountId"),userAgent:Ky("userAgent"),userId:Ky("id"),userStoreRegion:Ky("storeRegion"),userAuthUserId:Ky("authUserId"),userAnonymousUserAcquisitionDate:Ky("anonUserAcquisitionDate"),userAuthenticatedUserAcquisitionDate:Ky("authUserAcquisitionDate"),cloudName:bv("name"),cloudRole:bv("role"),cloudRoleVer:bv("roleVer"),cloudRoleInstance:bv("roleInstance"),cloudEnvironment:bv("environment"),cloudLocation:bv("location"),cloudDeploymentUnit:bv("deploymentUnit"),internalNodeName:g_("nodeName"),internalSdkVersion:g_("sdkVersion"),internalAgentVersion:g_("agentVersion"),internalSnippet:g_("snippet"),internalSdkSrc:g_("sdkSrc")}));function iF(w,P,N,$,de,we){N=Sl($,N)||Rm,(W(w)||W(P)||W(N))&&qe("Input doesn't contain all required fields");var ke="";w[OL]&&(ke=w[OL],delete w[OL]);var We={name:N,time:Ng(new Date),iKey:ke,ext:we||{},tags:[],data:{},baseType:P,baseData:w};return W(de)||lt(de,function(it,Et){We.data[it]=Et}),We}s(iF,"createTelemetryItem");var oF=function(){function w(){}return s(w,"TelemetryItemCreator"),w.create=iF,w}(),Mde={UserExt:"user",DeviceExt:"device",TraceExt:"trace",WebExt:"web",AppExt:"app",OSExt:"os",SessionExt:"ses",SDKExt:"sdk"},Lde=new Yy;function Z$(w){var P=null;if(te(Event))P=new Event(w);else{var N=ee();N&&N.createEvent&&(P=N.createEvent("Event"),P.initEvent(w,!0,!0))}return P}s(Z$,"createDomEvent");function sF(w,P){E$(w,null,null,P)}s(sF,"_disableEvents");function eW(w){var P=ee(),N=St(),$=!1,de=[],we=1;N&&!W(N.onLine)&&!N.onLine&&(we=2);var ke=0,We=ri(),it=ude(Lg("OfflineListener"),w);try{if(yr(_e())&&($=!0),P){var Et=P.body||P;Et.ononline&&yr(Et)&&($=!0)}}catch{$=!1}function yr(oo){var Vc=!1;return oo&&(Vc=LL(oo,"online",Xn,it),Vc&&LL(oo,"offline",Qn,it)),Vc}s(yr,"_enableEvents");function On(){return We}s(On,"_isOnline");function ri(){return!(ke===2||we===2)}s(ri,"calCurrentState");function Er(){var oo=ri();We!==oo&&(We=oo,Tn(de,function(Vc){var eI={isOnline:We,rState:we,uState:ke};try{Vc(eI)}catch{}}))}s(Er,"listnerNoticeCheck");function Fr(oo){ke=oo,Er()}s(Fr,"setOnlineState");function Xn(){we=1,Er()}s(Xn,"_setOnline");function Qn(){we=2,Er()}s(Qn,"_setOffline");function Ui(){var oo=_e();if(oo&&$){if(sF(oo,it),P){var Vc=P.body||P;J(Vc.ononline)||sF(Vc,it)}$=!1}}s(Ui,"_unload");function Lo(oo){return de.push(oo),{rm:s(function(){var Vc=de.indexOf(oo);if(Vc>-1)return de.splice(Vc,1)},"rm")}}return s(Lo,"addListener"),{isOnline:On,isListening:s(function(){return $},"isListening"),unload:Ui,addListener:Lo,setOnlineState:Fr}}s(eW,"createOfflineListener");var Fde="AppInsightsPropertiesPlugin",aF="AppInsightsChannelPlugin",Zb="ApplicationInsightsAnalytics";t.AnalyticsPluginIdentifier=Zb,t.BreezeChannelIdentifier=aF,t.ConfigurationManager=Nde,t.ConnectionStringParser=t4,t.ContextTagKeys=Yy,t.CtxTagKeys=Lde,t.DEFAULT_BREEZE_ENDPOINT=FL,t.DEFAULT_BREEZE_PATH=r_,t.Data=Bde,t.DisabledPropertyName=G5,t.DistributedTracingModes=gde,t.Envelope=r4,t.Event=xde,t.EventPersistence=a_,t.Exception=Bm,t.Extensions=Mde,t.HttpMethod=I$,t.Metric=Rde,t.PageView=Dde,t.PageViewPerformance=h_,t.ProcessLegacy=V5,t.PropertiesPluginIdentifier=Fde,t.RemoteDependencyData=Yb,t.RequestHeaders=T$,t.SampleRate=b$,t.SeverityLevel=l4,t.TelemetryItemCreator=oF,t.ThrottleMgr=vde,t.Trace=nF,t.correlationIdCanIncludeCorrelationHeader=jy,t.correlationIdGetCorrelationContext=D$,t.correlationIdGetCorrelationContextValue=B$,t.correlationIdGetPrefix=zL,t.correlationIdSetPrefix=VL,t.createDistributedTraceContextFromTrace=KL,t.createDomEvent=Z$,t.createOfflineListener=eW,t.createTelemetryItem=iF,t.createTraceParent=Tb,t.dataSanitizeException=WL,t.dataSanitizeId=Ob,t.dataSanitizeInput=jL,t.dataSanitizeKey=$L,t.dataSanitizeKeyAndAddUniqueness=HL,t.dataSanitizeMeasurements=Zf,t.dataSanitizeMessage=X5,t.dataSanitizeProperties=Ug,t.dataSanitizeString=Sl,t.dataSanitizeUrl=Pm,t.dateTimeUtilsDuration=hde,t.dateTimeUtilsNow=mde,t.dsPadNumber=w$,t.findAllScripts=BL,t.findW3cTraceParent=DL,t.formatTraceParent=Cv,t.getExtensionByName=Pde,t.isBeaconApiSupported=Ly,t.isCrossOriginError=zy,t.isInternalApplicationInsightsEndpoint=P$,t.isSampledFlag=q5,t.isValidSpanId=Sb,t.isValidTraceId=wb,t.isValidTraceParent=_b,t.msToTimeSpan=rF,t.parseConnectionString=e4,t.parseTraceParent=Jf,t.strNotSpecified=Rm,t.stringToBoolOrDefault=kde,t.urlGetAbsoluteUrl=fde,t.urlGetCompleteUrl=_$,t.urlGetPathName=pde,t.urlParseFullHost=qg,t.urlParseHost=R$,t.urlParseUrl=Qb,t.utlCanUseLocalStorage=Z5,t.utlCanUseSessionStorage=Hg,t.utlDisableStorage=c_,t.utlEnableStorage=Ade,t.utlGetLocalStorage=L$,t.utlGetSessionStorage=O$,t.utlGetSessionStorageKeys=jb,t.utlRemoveSessionStorage=Q$,t.utlRemoveStorage=ep,t.utlSetLocalStorage=F$,t.utlSetSessionStorage=yde,t.utlSetStoragePrefix=l_})});var c6e=H((rV,a6e)=>{d();(function(t,e){typeof rV=="object"&&typeof a6e<"u"?e(rV):typeof define=="function"&&define.amd?define(["exports"],e):(t=typeof globalThis<"u"?globalThis:t||self,e((t.Microsoft=t.Microsoft||{},t.Microsoft.ApplicationInsights=t.Microsoft.ApplicationInsights||{})))})(rV,function(t){"use strict";function e(v,I){return v||I}s(e,"_pureAssign");function r(v,I){return v[I]}s(r,"_pureRef");var n=void 0,i=null,o="",a="function",c="object",l="prototype",u="__proto__",f="undefined",p="constructor",m="Symbol",h="_polyfill",g="length",A="name",y="call",E="toString",b=e(Object),S=r(b,l),R=e(String),B=r(R,l),L=e(Math),O=e(Array),Y=r(O,l),V=r(Y,"slice");function z(v,I){try{return{v:v.apply(this,I)}}catch(T){return{e:T}}}s(z,"safe");function Q(v,I){var T=z(v);return T.e?I:T.v}s(Q,"safeGet");var U;function Z(v){return function(I){return typeof I===v}}s(Z,"_createIs");function J(v){var I="[object "+v+"]";return function(T){return!!(T&&j(T)===I)}}s(J,"_createObjIs");function j(v){return S[E].call(v)}s(j,"objToString");function W(v){return typeof v===f||v===f}s(W,"isUndefined");function X(v){return!re(v)}s(X,"isStrictUndefined");function oe(v){return v===i||W(v)}s(oe,"isNullOrUndefined");function te(v){return v===i||!re(v)}s(te,"isStrictNullOrUndefined");function re(v){return!!v||v!==n}s(re,"isDefined");function pe(v){return!U&&(U=["string","number","boolean",f,"symbol","bigint"]),v!==c&&U.indexOf(v)!==-1}s(pe,"isPrimitiveType");var Ae=Z("string"),Oe=Z(a);function Te(v){return!v&&oe(v)?!1:!!v&&typeof v===c}s(Te,"isObject");var Je=r(O,"isArray"),Fe=J("Date"),lt=Z("number"),_t=Z("boolean"),xt=J("Error");function gt(v){return!!(v&&v.then&&Oe(v.then))}s(gt,"isPromiseLike");function ue(v){return!(!v||Q(function(){return!(v&&0+v)},!v))}s(ue,"isTruthy");var Ue=r(b,"getOwnPropertyDescriptor");function ye(v,I){return!!v&&S.hasOwnProperty[y](v,I)}s(ye,"objHasOwnProperty");var $e=e(r(b,"hasOwn"),ae);function ae(v,I){return ye(v,I)||!!Ue(v,I)}s(ae,"polyObjHasOwn");function le(v,I,T){if(v&&Te(v)){for(var k in v)if($e(v,k)&&I[y](T||v,k,v[k])===-1)break}}s(le,"objForEachKey");var qe={e:"enumerable",c:"configurable",v:"value",w:"writable",g:"get",s:"set"};function Ne(v){var I={};if(I[qe.c]=!0,I[qe.e]=!0,v.l){I.get=function(){return v.l.v};var T=Ue(v.l,"v");T&&T.set&&(I.set=function(k){v.l.v=k})}return le(v,function(k,M){I[qe[k]]=X(M)?I[qe[k]]:M}),I}s(Ne,"_createProp");var Ee=r(b,"defineProperty");function je(v,I,T){return Ee(v,I,Ne(T))}s(je,"objDefine");function tt(v,I,T,k,M){var q={};return le(v,function(G,ce){mt(q,G,I?ce:G),mt(q,ce,T?ce:G)}),k?k(q):q}s(tt,"_createKeyValueMap");function mt(v,I,T,k){Ee(v,I,{value:T,enumerable:!0,writable:!1})}s(mt,"_assignMapValue");var Ft=e(R),Jt="[object Error]";function Qt(v,I){var T=o,k=S[E][y](v);k===Jt&&(v={stack:Ft(v.stack),message:Ft(v.message),name:Ft(v.name)});try{T=JSON.stringify(v,i,I?typeof I=="number"?I:4:n),T=(T?T.replace(/"(\w+)"\s*:\s{0,1}/g,"$1: "):i)||Ft(v)}catch(M){T=" - "+Qt(M,I)}return k+": "+T}s(Qt,"dumpObj");function zr(v){throw new Error(v)}s(zr,"throwError");function Br(v){throw new TypeError(v)}s(Br,"throwTypeError");var un=r(b,"freeze");function ve(v){return v}s(ve,"_doNothing");function Ge(v){return v[u]||i}s(Ge,"_getProto");var pt=r(b,"assign"),Tt=r(b,"keys");function or(v){return un&&le(v,function(I,T){(Je(T)||Te(T))&&or(T)}),Zt(v)}s(or,"objDeepFreeze");var Zt=e(un,ve),Tr=e(r(b,"getPrototypeOf"),Ge);function fr(v){return tt(v,1,0,Zt)}s(fr,"createEnum");function rr(v){return tt(v,0,0,Zt)}s(rr,"createEnumKeyMap");function ur(v){var I={};return le(v,function(T,k){mt(I,T,k[1]),mt(I,k[0],k[1])}),Zt(I)}s(ur,"createSimpleMap");function nr(v){return ur(v)}s(nr,"createTypeMap");var Mr=rr({asyncIterator:0,hasInstance:1,isConcatSpreadable:2,iterator:3,match:4,matchAll:5,replace:6,search:7,species:8,split:9,toPrimitive:10,toStringTag:11,unscopables:12}),Kr="__tsUtils$gblCfg",sn;function Cn(){var v;return typeof globalThis!==f&&(v=globalThis),!v&&typeof self!==f&&(v=self),!v&&typeof window!==f&&(v=window),!v&&typeof global!==f&&(v=global),v}s(Cn,"_getGlobalValue");function ii(){if(!sn){var v=z(Cn).v||{};sn=v[Kr]=v[Kr]||{}}return sn}s(ii,"_getGlobalConfig");var Rn=ti;function ti(v,I,T){var k=I?I[v]:i;return function(M){var q=(M?M[v]:i)||k;if(q||T){var G=arguments;return(q||T).apply(M,q?V[y](G,1):G)}Br('"'+Ft(v)+'" not defined for '+Qt(M))}}s(ti,"_unwrapFunctionWithPoly");function an(v){return function(I){return I[v]}}s(an,"_unwrapProp");var Jn=r(L,"min"),Pe=r(L,"max"),K=Rn("slice",B),Ce=Rn("substring",B),Ie=ti("substr",B,F);function F(v,I,T){return oe(v)&&Br("Invalid "+Qt(v)),T<0?o:(I=I||0,I<0&&(I=Pe(I+v[g],0)),W(T)?K(v,I):K(v,I,I+T))}s(F,"polyStrSubstr");function D(v,I){return Ce(v,0,I)}s(D,"strLeft");var ee="_urid",ge;function _e(){if(!ge){var v=ii();ge=v.gblSym=v.gblSym||{k:{},s:{}}}return ge}s(_e,"_globalSymbolRegistry");var ut;function St(v){var I={description:Ft(v),toString:s(function(){return m+"("+v+")"},"toString")};return I[h]=!0,I}s(St,"polyNewSymbol");function Kt(v){var I=_e();if(!$e(I.k,v)){var T=St(v),k=Tt(I.s).length;T[ee]=function(){return k+"_"+T[E]()},I.k[v]=T,I.s[T[ee]()]=Ft(v)}return I.k[v]}s(Kt,"polySymbolFor");function er(v){!ut&&(ut={});var I,T=Mr[v];return T&&(I=ut[T]=ut[T]||St(m+"."+T)),I}s(er,"polyGetKnownSymbol");var Yt;function bt(){Yt=ii()}s(bt,"_initTestHooks");function vr(v){var I={};return!Yt&&bt(),I.b=Yt.lzy,Ee(I,"v",{configurable:!0,get:s(function(){var T=v();return Yt.lzy||Ee(I,"v",{value:T}),I.b=Yt.lzy,T},"get")}),I}s(vr,"getLazy");function di(v){return Ee({toJSON:s(function(){return v},"toJSON")},"v",{value:v})}s(di,"createCachedValue");var no="window",Tn;function yo(v,I){var T;return function(){return!Yt&&bt(),(!T||Yt.lzy)&&(T=di(z(v,I).v)),T.v}}s(yo,"_getGlobalInstFn");function xi(v){return!Yt&&bt(),(!Tn||v===!1||Yt.lzy)&&(Tn=di(z(Cn).v||i)),Tn.v}s(xi,"getGlobal");function Zo(v,I){var T;if(!Tn||I===!1?T=xi(I):T=Tn.v,T&&T[v])return T[v];if(v===no)try{return window}catch{}return i}s(Zo,"getInst");function va(){return!!Ic()}s(va,"hasDocument");var Ic=yo(Zo,["document"]);function Mo(){return!!Vs()}s(Mo,"hasWindow");var Vs=yo(Zo,[no]);function gd(){return!!Tc()}s(gd,"hasNavigator");var Tc=yo(Zo,["navigator"]),Tg=yo(function(){return!!z(function(){return process&&(process.versions||{}).node}).v}),Tl,wg;function Sg(){return Tl=di(z(Zo,[m]).v),Tl}s(Sg,"_initSymbol");function YE(v){var I=(Yt.lzy?0:Tl)||Sg();return I.v?I.v[v]:n}s(YE,"_getSymbolKey");function qa(){return!!ku()}s(qa,"hasSymbol");function ku(){return!Yt&&bt(),((Yt.lzy?0:Tl)||Sg()).v}s(ku,"getSymbol");function Pu(v,I){var T=Mr[v];!Yt&&bt();var k=(Yt.lzy?0:Tl)||Sg();return k.v?k.v[T||v]:I?n:er(v)}s(Pu,"getKnownSymbol");function Ad(v,I){!Yt&&bt();var T=(Yt.lzy?0:Tl)||Sg();return T.v?T.v(v):I?i:St(v)}s(Ad,"newSymbol");function _g(v){return!Yt&&bt(),wg=(Yt.lzy?0:wg)||di(z(YE,["for"]).v),(wg.v||Kt)(v)}s(_g,"symbolFor");function jl(v){return!!v&&Oe(v.next)}s(jl,"isIterator");function JE(v){return!te(v)&&Oe(v[Pu(3)])}s(JE,"isIterable");var ov;function XE(v,I,T){if(v&&(jl(v)||(!ov&&(ov=di(Pu(3))),v=v[ov.v]?v[ov.v]():i),jl(v))){var k=n,M=n;try{for(var q=0;!(M=v.next()).done&&I[y](T||v,M.value,q,v)!==-1;)q++}catch(G){k={e:G},v.throw&&(M=i,v.throw(k))}finally{try{M&&!M.done&&v.return&&v.return(M)}finally{if(k)throw k.e}}}}s(XE,"iterForOf");function jf(v,I,T){return v.apply(I,T)}s(jf,"fnApply");function Gf(v,I){return!W(I)&&v&&(Je(I)?jf(v.push,v,I):jl(I)||JE(I)?XE(I,function(T){v.push(T)}):v.push(I)),v}s(Gf,"arrAppend");function Yr(v,I,T){if(v)for(var k=v[g]>>>0,M=0;M<k&&!(M in v&&I[y](T||v,v[M],M,v)===-1);M++);}s(Yr,"arrForEach");var wc=Rn("indexOf",Y),Rg=Rn("map",Y);function kg(v,I,T){return((v?v.slice:i)||V).apply(v,V[y](arguments,1))}s(kg,"arrSlice");var lL=Rn("reduce",Y),Gc=e(r(b,"create"),Sy);function Sy(v){if(!v)return{};var I=typeof v;I!==c&&I!==a&&Br("Prototype must be an Object or function: "+Qt(v));function T(){}return s(T,"tempFunc"),T[l]=v,new T}s(Sy,"polyObjCreate");var sv;function Em(v,I){var T=b.setPrototypeOf||function(k,M){var q;!sv&&(sv=di((q={},q[u]=[],q instanceof Array))),sv.v?k[u]=M:le(M,function(G,ce){return k[G]=ce})};return T(v,I)}s(Em,"objSetPrototypeOf");function _y(v,I,T){z(je,[I,A,{v,c:!0,e:!1}]),I=Em(I,T);function k(){this[p]=I,z(je,[this,A,{v,c:!0,e:!1}])}return s(k,"__"),I[l]=T===i?Gc(T):(k[l]=T[l],new k),I}s(_y,"_createCustomError");function ZE(v,I){I&&(v[A]=I)}s(ZE,"_setName");function Is(v,I,T){var k=T||Error,M=k[l][A],q=Error.captureStackTrace;return _y(v,function(){var G=this,ce=arguments;try{z(ZE,[k,v]);var fe=jf(k,G,V[y](ce))||G;if(fe!==G){var xe=Tr(G);xe!==Tr(fe)&&Em(fe,xe)}return q&&q(fe,G[p]),I&&I(fe,ce),fe}finally{z(ZE,[k,M])}},k)}s(Is,"createCustomError");function yd(){return(Date.now||Ry)()}s(yd,"utcNow");function Ry(){return new Date().getTime()}s(Ry,"polyUtcNow");function f5(v){return s(function(T){return oe(T)&&Br("strTrim called ["+Qt(T)+"]"),T&&T.replace&&(T=T.replace(v,o)),T},"_doTrim")}s(f5,"_createTrimFn");var uL=f5(/^\s+|(?=\s)\s+$/g),io=ti("trim",B,uL),ky=r(L,"floor"),Pg,p5,eb;function Cd(v){if(!v||typeof v!==c)return!1;eb||(eb=Mo()?Vs():!0);var I=!1;if(v!==eb){p5||(Pg=Function[l][E],p5=Pg[y](b));try{var T=Tr(v);I=!T,I||(ye(T,p)&&(T=T[p]),I=!!(T&&typeof T===a&&Pg[y](T)===p5))}catch{}}return I}s(Cd,"isPlainObject");function dL(v){return v.value&&m5(v),!0}s(dL,"_defaultDeepCopyHandler");var fL=[tb,m5,t$,Py];function pL(v,I,T,k){var M;return Yr(v,function(q){if(q.k===I)return M=q,-1}),M||(M={k:I,v:I},v.push(M),k(M)),M.v}s(pL,"_getSetVisited");function av(v,I,T,k){var M=T.handler,q=T.path?k?T.path.concat(k):T.path:[],G={handler:T.handler,src:T.src,path:q},ce=typeof I,fe=!1,xe=I===i;xe||(I&&ce===c?fe=Cd(I):xe=pe(ce));var Re={type:ce,isPrim:xe,isPlain:fe,value:I,result:I,path:q,origin:T.src,copy:s(function(Qe,et){return av(v,Qe,et?G:T,et)},"copy"),copyTo:s(function(Qe,et){return mL(v,Qe,et,G)},"copyTo")};return Re.isPrim?M&&M[y](T,Re)?Re.result:I:pL(v,I,q,function(Qe){je(Re,"result",{g:s(function(){return Qe.v},"g"),s:s(function(Ke){Qe.v=Ke},"s")});for(var et=0,He=M;!(He||(et<fL.length?fL[et++]:dL))[y](T,Re);)He=i})}s(av,"_deepCopy");function mL(v,I,T,k){if(!oe(T))for(var M in T)I[M]=av(v,T[M],k,M);return I}s(mL,"_copyProps");function e$(v,I,T){var k={handler:T,src:I,path:[]};return mL([],v,I,k)}s(e$,"objCopyProps");function hL(v,I){var T={handler:I,src:v};return av([],v,T)}s(hL,"objDeepCopy");function tb(v){var I=v.value;if(Je(I)){var T=v.result=[];return T.length=I.length,v.copyTo(T,I),!0}return!1}s(tb,"arrayDeepCopyHandler");function Py(v){var I=v.value;return Fe(I)?(v.result=new Date(I.getTime()),!0):!1}s(Py,"dateDeepCopyHandler");function t$(v){return v.type===a}s(t$,"functionDeepCopyHandler");function m5(v){var I=v.value;if(I&&v.isPlain){var T=v.result={};return v.copyTo(T,I),!0}return!1}s(m5,"plainObjDeepCopyHandler");function gL(v,I){return Yr(I,function(T){e$(v,T)}),v}s(gL,"_doExtend");function h5(v,I,T,k,M,q,G){return gL(hL(v)||{},V[y](arguments))}s(h5,"deepExtend");var Vue=an(g),zue=r(L,"round"),r$=ti("endsWith",B,Kue);function Kue(v,I,T){Ae(v)||Br("'"+Qt(v)+"' is not a string");var k=Ae(I)?I:Ft(I),M=!W(T)&&T<v[g]?T:v[g];return Ce(v,M-k[g],M)===k}s(Kue,"polyStrEndsWith");var Dg=Rn("indexOf",B),g5="ref",AL="unref",A5="hasRef",Yue="enabled";function y5(v,I,T){var k=!0,M=v?I(i):i,q;function G(){return k=!1,M&&M[AL]&&M[AL](),q}s(G,"_unref");function ce(){M&&T(M),M=i}s(ce,"_cancel");function fe(){return M=I(M),k||G(),q}s(fe,"_refresh");function xe(Re){!Re&&M&&ce(),Re&&!M&&fe()}return s(xe,"_setEnabled"),q={cancel:ce,refresh:fe},q[A5]=function(){return M&&M[A5]?M[A5]():k},q[g5]=function(){return k=!0,M&&M[g5]&&M[g5](),q},q[AL]=G,q=Ee(q,Yue,{get:s(function(){return!!M},"get"),set:xe}),{h:q,dn:s(function(){M=i},"dn")}}s(y5,"_createTimerHandler");function C5(v,I,T){var k=Je(I),M=k?I.length:0,q=(M>0?I[0]:k?n:I)||setTimeout,G=(M>1?I[1]:n)||clearTimeout,ce=T[0];T[0]=function(){fe.dn(),jf(ce,n,V[y](arguments))};var fe=y5(v,function(xe){if(xe){if(xe.refresh)return xe.refresh(),xe;jf(G,n,[xe])}return jf(q,n,T)},function(xe){jf(G,n,[xe])});return fe.h}s(C5,"_createTimeoutWith");function Dy(v,I){return C5(!0,n,V[y](arguments))}s(Dy,"scheduleTimeout");function v5(v,I){return C5(!1,n,V[y](arguments))}s(v5,"createTimeout");var cv,Vf="constructor",zf="prototype",lv="function",rb="_dynInstFuncs",By="_isDynProxy",nb="_dynClass",yL="_dynCls$",uv="_dynInstChk",ib=uv,CL="_dfOpts",x5="_unknown_",ob="__proto__",WS="_dyn"+ob,E5="__dynProto$Gbl",sb="_dynInstProto",ab="useBaseInst",jS="setInstFuncs",dv=Object,cb=dv.getPrototypeOf,vL=dv.getOwnPropertyNames,b5=xi(),lb=b5[E5]||(b5[E5]={o:(cv={},cv[jS]=!0,cv[ab]=!0,cv),n:1e3});function ub(v){return v&&(v===dv[zf]||v===Array[zf])}s(ub,"_isObjectOrArrayPrototype");function Bg(v){return ub(v)||v===Function[zf]}s(Bg,"_isObjectArrayOrFunctionPrototype");function bm(v){var I;if(v){if(cb)return cb(v);var T=v[ob]||v[zf]||(v[Vf]?v[Vf][zf]:null);I=v[WS]||T,ye(v,WS)||(delete v[sb],I=v[WS]=v[sb]||v[WS],v[sb]=T)}return I}s(bm,"_getObjProto");function db(v,I){var T=[];if(vL)T=vL(v);else for(var k in v)typeof k=="string"&&ye(v,k)&&T.push(k);if(T&&T.length>0)for(var M=0;M<T.length;M++)I(T[M])}s(db,"_forEachProp");function fb(v,I,T){return I!==Vf&&typeof v[I]===lv&&(T||ye(v,I))&&I!==ob&&I!==zf}s(fb,"_isDynamicCandidate");function I5(v){Br("DynamicProto: "+v)}s(I5,"_throwTypeError");function xL(v){var I=Gc(null);return db(v,function(T){!I[T]&&fb(v,T,!1)&&(I[T]=v[T])}),I}s(xL,"_getInstanceFuncs");function EL(v,I){for(var T=v.length-1;T>=0;T--)if(v[T]===I)return!0;return!1}s(EL,"_hasVisited");function Jue(v,I,T,k){function M(fe,xe,Re){var Qe=xe[Re];if(Qe[By]&&k){var et=fe[rb]||{};et[ib]!==!1&&(Qe=(et[xe[nb]]||{})[Re]||Qe)}return function(){return Qe.apply(fe,arguments)}}s(M,"_instFuncProxy");var q=Gc(null);db(T,function(fe){q[fe]=M(I,T,fe)});for(var G=bm(v),ce=[];G&&!Bg(G)&&!EL(ce,G);)db(G,function(fe){!q[fe]&&fb(G,fe,!cb)&&(q[fe]=M(I,G,fe))}),ce.push(G),G=bm(G);return q}s(Jue,"_getBaseFuncs");function Xue(v,I,T,k){var M=null;if(v&&ye(T,nb)){var q=v[rb]||Gc(null);if(M=(q[T[nb]]||Gc(null))[I],M||I5("Missing ["+I+"] "+lv),!M[uv]&&q[ib]!==!1){for(var G=!ye(v,I),ce=bm(v),fe=[];G&&ce&&!Bg(ce)&&!EL(fe,ce);){var xe=ce[I];if(xe){G=xe===k;break}fe.push(ce),ce=bm(ce)}try{G&&(v[I]=M),M[uv]=1}catch{q[ib]=!1}}}return M}s(Xue,"_getInstFunc");function Zue(v,I,T){var k=I[v];return k===T&&(k=bm(I)[v]),typeof k!==lv&&I5("["+v+"] is not a "+lv),k}s(Zue,"_getProtoFunc");function ede(v,I,T,k,M){function q(fe,xe){var Re=s(function(){var Qe=Xue(this,xe,fe,Re)||Zue(xe,fe,Re);return Qe.apply(this,arguments)},"dynProtoProxy");return Re[By]=1,Re}if(s(q,"_createDynamicPrototype"),!ub(v)){var G=T[rb]=T[rb]||Gc(null);if(!ub(G)){var ce=G[I]=G[I]||Gc(null);G[ib]!==!1&&(G[ib]=!!M),ub(ce)||db(T,function(fe){fb(T,fe,!1)&&T[fe]!==k[fe]&&(ce[fe]=T[fe],delete T[fe],(!ye(v,fe)||v[fe]&&!v[fe][By])&&(v[fe]=q(v,fe)))})}}}s(ede,"_populatePrototype");function bL(v,I){if(cb){for(var T=[],k=bm(I);k&&!Bg(k)&&!EL(T,k);){if(k===v)return!0;T.push(k),k=bm(k)}return!1}return!0}s(bL,"_checkPrototype");function GS(v,I){return ye(v,zf)?v.name||I||x5:((v||{})[Vf]||{}).name||I||x5}s(GS,"_getObjName");function Du(v,I,T,k){ye(v,zf)||I5("theClass is an invalid class definition.");var M=v[zf];bL(M,I)||I5("["+GS(v)+"] not in hierarchy of ["+GS(I)+"]");var q=null;ye(M,nb)?q=M[nb]:(q=yL+GS(v,"_")+"$"+lb.n,lb.n++,M[nb]=q);var G=Du[CL],ce=!!G[ab];ce&&k&&k[ab]!==void 0&&(ce=!!k[ab]);var fe=xL(I),xe=Jue(M,I,fe,ce);T(I,xe);var Re=!!cb&&!!G[jS];Re&&k&&(Re=!!k[jS]),ede(M,q,I,fe,Re!==!1)}s(Du,"dynamicProto"),Du[CL]=lb.o;var Ha="function",n$="object",i$="undefined",VS="prototype",IL=Object,TL=IL[VS];(xi()||{}).Symbol,(xi()||{}).Reflect;var T5="hasOwnProperty",o$=s(function(v){for(var I,T=1,k=arguments.length;T<k;T++){I=arguments[T];for(var M in I)TL[T5].call(I,M)&&(v[M]=I[M])}return v},"__objAssignFnImpl"),Ng=pt||o$,Ny=s(function(v,I){return Ny=IL.setPrototypeOf||{__proto__:[]}instanceof Array&&function(T,k){T.__proto__=k}||function(T,k){for(var M in k)k[T5](M)&&(T[M]=k[M])},Ny(v,I)},"extendStaticsFn");function zS(v,I){typeof I!==Ha&&I!==null&&Br("Class extends value "+String(I)+" is not a constructor or null"),Ny(v,I);function T(){this.constructor=v}s(T,"__"),v[VS]=I===null?Gc(I):(T[VS]=I[VS],new T)}s(zS,"__extendsFn");function s$(v,I){for(var T=0,k=I.length,M=v.length;T<k;T++,M++)v[M]=I[T];return v}s(s$,"__spreadArrayFn");var w5=fr,tde=nr,My=w5({NONE:0,PENDING:3,INACTIVE:1,ACTIVE:2}),pb="toLowerCase",fi="length",mb="warnToConsole",fv="throwInternal",Mg="watch",S5="apply",bo="push",hb="splice",Sc="logger",gb="cancel",KS="initialize",Ly="identifier",YS="removeNotificationListener",_5="addNotificationListener",Im="isInitialized",Ab="value",o0="getNotifyMgr",yb="getPlugin",Fy="name",Gl="processNext",Cb="getProcessTelContext",Tm="enabled",a$="stopPollingInternalLogs",pv="unload",R5="onComplete",vb="version",c$="loggingLevelConsole",mv="createNew",wm="teardown",k5="messageId",hv="message",Sm="diagLog",P5="_doTeardown",Lg="update",_m="getNext",Oy="setNextPlugin",D5="userAgent",Qy="split",Uy="replace",Bu="type",wL="evtName",JS="status",SL="getAllResponseHeaders",_L="isChildEvt",xb="data",qy="getCtx",s0="setCtx",l$="itemsReceived",Fg="urlString",RL="headers",Og="timeout",u$="traceFlags",Eb;function kL(v,I){Eb||(Eb=Is("AggregationError",function(k,M){M[fi]>1&&(k.errors=M[1])}));var T=v||"One or more errors occurred.";throw Yr(I,function(k,M){T+=`
`.concat(M," > ").concat(Qt(k))}),new Eb(T,I||[])}s(kL,"throwAggregationError");var gv="Promise",Av="rejected";function Kf(v,I){return d$(v,function(T){return I?I({status:"fulfilled",rejected:!1,value:T}):T},function(T){return I?I({status:Av,rejected:!0,reason:T}):T})}s(Kf,"doAwaitResponse");function d$(v,I,T,k){var M=v;try{if(gt(v))(I||T)&&(M=v.then(I,T));else try{I&&(M=I(v))}catch(q){if(T)M=T(q);else throw q}}finally{k&&rde(M,k)}return M}s(d$,"doAwait");function rde(v,I){var T=v;return I&&(gt(v)?v.finally?T=v.finally(I):T=v.then(function(k){return I(),k},function(k){throw I(),k}):I()),T}s(rde,"doFinally");var f$=["pending","resolving","resolved",Av],p$="dispatchEvent",XS;function m$(v){var I;return v&&v.createEvent&&(I=v.createEvent("Event")),!!I&&I.initEvent}s(m$,"_hasInitEventFn");function B5(v,I,T,k){var M=Ic();!XS&&(XS=di(!!z(m$,[M]).v));var q=XS.v?M.createEvent("Event"):k?new Event(I):{};if(T&&T(q),XS.v&&q.initEvent(I,!1,!0),q&&v[p$])v[p$](q);else{var G=v["on"+I];if(G)G(q);else{var ce=Zo("console");ce&&(ce.error||ce.log)(I,Qt(q))}}}s(B5,"emitEvent");var h$="unhandledRejection",nde=h$.toLowerCase(),bb=10,N5;function g$(v){return Oe(v)?v.toString():Qt(v)}s(g$,"dumpFnObj");function A$(v,I,T){var k=kg(arguments,3),M=0,q=!1,G,ce=[],fe=!1,xe=null,Re;function Qe(sr,kr){try{fe=!0,xe&&xe.cancel(),xe=null;var oi=v(function(Wi,ji){ce.push(function(){try{var zo=M===2?sr:kr,wn=W(zo)?G:Oe(zo)?zo(G):zo;gt(wn)?wn.then(Wi,ji):zo?Wi(wn):M===3?ji(wn):Wi(wn)}catch(rn){ji(rn)}}),q&&At()},k);return oi}finally{}}s(Qe,"_then");function et(sr){return Qe(void 0,sr)}s(et,"_catch");function He(sr){var kr=sr,oi=sr;return Oe(sr)&&(kr=s(function(Wi){return sr&&sr(),Wi},"thenFinally"),oi=s(function(Wi){throw sr&&sr(),Wi},"catchFinally")),Qe(kr,oi)}s(He,"_finally");function Ke(){return f$[M]}s(Ke,"_strState");function At(){if(ce.length>0){var sr=ce.slice();ce=[],fe=!0,xe&&xe.cancel(),xe=null,I(sr)}}s(At,"_processQueue");function st(sr,kr){return function(oi){if(M===kr){if(sr===2&&gt(oi)){M=1,oi.then(st(2,1),st(3,1));return}M=sr,q=!0,G=oi,At(),!fe&&sr===3&&!xe&&(xe=Dy(wt,bb))}}}s(st,"_createSettleIfFn");function wt(){if(!fe)if(fe=!0,Tg())process.emit(h$,G,Re);else{var sr=Vs()||xi();!N5&&(N5=di(z(Zo,[gv+"RejectionEvent"]).v)),B5(sr,nde,function(kr){return je(kr,"promise",{g:s(function(){return Re},"g")}),kr.reason=G,kr},!!N5.v)}}s(wt,"_notifyUnhandledRejection"),Re={then:Qe,catch:et,finally:He},Ee(Re,"state",{get:Ke}),qa()&&(Re[Pu(11)]="IPromise");function $t(){return"IPromise "+Ke()+(q?" - "+g$(G):"")}return s($t,"_toString"),Re.toString=$t,s(function(){Oe(T)||Br(gv+": executor is not a function - "+g$(T));var kr=st(3,0);try{T.call(Re,st(2,0),kr)}catch(oi){kr(oi)}},"_initialize")(),Re}s(A$,"_createPromise");function ide(v){return function(I){var T=kg(arguments,1);return v(function(k,M){try{var q=[],G=1;XE(I,function(ce,fe){ce&&(G++,d$(ce,function(xe){q[fe]=xe,--G===0&&k(q)},M))}),G--,G===0&&k(q)}catch(ce){M(ce)}},T)}}s(ide,"_createAllPromise");function ode(v){return di(function(I){var T=kg(arguments,1);return v(function(k,M){var q=[],G=1;function ce(fe,xe){G++,Kf(fe,function(Re){Re.rejected?q[xe]={status:Av,reason:Re.reason}:q[xe]={status:"fulfilled",value:Re.value},--G===0&&k(q)})}s(ce,"processItem");try{Je(I)?Yr(I,ce):JE(I)?XE(I,ce):Br("Input is not an iterable"),G--,G===0&&k(q)}catch(fe){M(fe)}},T)})}s(ode,"_createAllSettledPromise");function y$(v){Yr(v,function(I){try{I()}catch{}})}s(y$,"syncItemProcessor");function C$(v){var I=lt(v)?v:0;return function(T){Dy(function(){y$(T)},I)}}s(C$,"timeoutItemProcessor");function M5(v,I){return A$(M5,C$(I),v,I)}s(M5,"createAsyncPromise");var L5;function sde(v,I){!L5&&(L5=di(z(Zo,[gv]).v||null));var T=L5.v;if(!T)return M5(v);Oe(v)||Br(gv+": executor is not a function - "+Qt(v));var k=0;function M(){return f$[k]}s(M,"_strState");var q=new T(function(G,ce){function fe(Re){k=2,G(Re)}s(fe,"_resolve");function xe(Re){k=3,ce(Re)}s(xe,"_reject"),v(fe,xe)});return Ee(q,"state",{get:M}),q}s(sde,"createNativePromise");var F5;function O5(v){return A$(O5,y$,v)}s(O5,"createSyncPromise");function sf(v,I){return!F5&&(F5=ode(O5)),F5.v(v,I)}s(sf,"createSyncAllSettledPromise");var Q5;function Ib(v,I){return!Q5&&(Q5=di(sde)),Q5.v.call(this,v,I)}s(Ib,"createPromise");var PL=ide(Ib),Yf=void 0,Qi="",Qg="channels",_c="core",a0="createPerfMgr",U5="disabled",yv="extensionConfig",Tb="extensions",Jf="processTelemetry",wb="priority",Sb="eventsSent",_b="eventsDiscarded",q5="eventsSendRequest",Cv="perfEvent",DL="offlineEventsStored",BL="offlineBatchSent",H5="offlineBatchDrop",ZS="getPerfMgr",$5="domain",W5="path",v$="Not dynamic - ",NL=/-([a-z])/g,ade=/([^\w\d_$])/g,cde=/^(\d+[\w\d_$])/;function j5(v){return!oe(v)}s(j5,"isNotNullOrUndefined");function Rb(v){var I=v;return I&&Ae(I)&&(I=I[Uy](NL,function(T,k){return k.toUpperCase()}),I=I[Uy](ade,"_"),I=I[Uy](cde,function(T,k){return"_"+k})),I}s(Rb,"normalizeJsName");function Vl(v,I){return v&&I?Dg(v,I)!==-1:!1}s(Vl,"strContains");function e_(v){return v&&v.toISOString()||""}s(e_,"toISOString");function wl(v){return xt(v)?v[Fy]:Qi}s(wl,"getExceptionName");function Hy(v,I,T,k,M){var q=T;return v&&(q=v[I],q!==T&&(!M||M(q))&&(!k||k(T))&&(q=T,v[I]=q)),q}s(Hy,"setValue");function x$(v,I,T){var k;return v?(k=v[I],!k&&oe(k)&&(k=W(T)?{}:T,v[I]=k)):k=W(T)?{}:T,k}s(x$,"getSetValue");function lde(v,I){var T=null,k=null;return Oe(v)?T=v:k=v,function(){var M=arguments;if(T&&(k=T()),k)return k[I][S5](k,M)}}s(lde,"_createProxyFunction");function t_(v,I,T,k,M){v&&I&&T&&(M!==!1||W(v[I]))&&(v[I]=lde(T,k))}s(t_,"proxyFunctionAs");function ML(v,I,T,k){return v&&I&&Te(v)&&Je(T)&&Yr(T,function(M){Ae(M)&&t_(v,M,I,M,k)}),v}s(ML,"proxyFunctions");function ude(v){return function(){function I(){var T=this;v&&le(v,function(k,M){T[k]=M})}return s(I,"class_1"),I}()}s(ude,"createClassFromInterface");function LL(v){return v&&pt&&(v=IL(pt({},v))),v}s(LL,"optimizeObject");function E$(v,I,T,k,M,q){var G=arguments,ce=G[0]||{},fe=G[fi],xe=!1,Re=1;for(fe>0&&_t(ce)&&(xe=ce,ce=G[Re]||{},Re++),Te(ce)||(ce={});Re<fe;Re++){var Qe=G[Re],et=Je(Qe),He=Te(Qe);for(var Ke in Qe){var At=et&&Ke in Qe||He&&$e(Qe,Ke);if(At){var st=Qe[Ke],wt=void 0;if(xe&&st&&((wt=Je(st))||Cd(st))){var $t=ce[Ke];wt?Je($t)||($t=[]):Cd($t)||($t={}),st=E$(xe,$t,st)}st!==void 0&&(ce[Ke]=st)}}}return ce}s(E$,"objExtend");function G5(v){try{return v.responseText}catch{}return null}s(G5,"getResponseText");function b$(v,I){return v?"XDomainRequest,Response:"+G5(v)||"":I}s(b$,"formatErrorMessageXdr");function V5(v,I){return v?"XMLHttpRequest,Status:"+v[JS]+",Response:"+G5(v)||v.response||"":I}s(V5,"formatErrorMessageXhr");function I$(v,I){return I&&(lt(I)?v=[I].concat(v):Je(I)&&(v=I.concat(v))),v}s(I$,"prependTransports");var FL="Microsoft_ApplicationInsights_BypassAjaxInstrumentation",r_="withCredentials",Rm="timeout";function OL(v,I,T,k,M,q){k===void 0&&(k=!1),M===void 0&&(M=!1);function G(fe,xe,Re){try{fe[xe]=Re}catch{}}s(G,"_wrapSetXhrProp");var ce=new XMLHttpRequest;return k&&G(ce,FL,k),T&&G(ce,r_,T),ce.open(v,I,!M),T&&G(ce,r_,T),!M&&q&&G(ce,Rm,q),ce}s(OL,"openXhr");function T$(v){var I={};if(Ae(v)){var T=io(v)[Qy](/[\r\n]+/);Yr(T,function(k){if(k){var M=k.indexOf(": ");if(M!==-1){var q=io(k.substring(0,M))[pb](),G=io(k.substring(M+1));I[q]=G}else I[io(k)]=1}})}return I}s(T$,"convertAllHeadersToMap");function $y(v,I,T){if(!v[T]&&I&&I.getResponseHeader){var k=I.getResponseHeader(T);k&&(v[T]=io(k))}return v}s($y,"_appendHeader");var Fn="kill-duration",kb="kill-duration-seconds",vv="time-delta-millis";function xv(v,I){var T={};return v[SL]?T=T$(v[SL]()):I&&(T=$y(T,v,vv),T=$y(T,v,Fn),T=$y(T,v,kb)),T}s(xv,"_getAllResponseHeaders");var QL="documentMode",n_="location",Pb="console",z5="JSON",UL="crypto",K5="msCrypto",Db="msie",Ev="trident/",qL="XMLHttpRequest",Xf=null,Bb=null,km=!1,vd=null,Nb=null;function i_(v,I){var T=!1;if(v){try{if(T=I in v,!T){var k=v[VS];k&&(T=I in k)}}catch{}if(!T)try{var M=new v;T=!W(M[I])}catch{}}return T}s(i_,"_hasProperty");function Mb(v){if(v&&km){var I=Zo("__mockLocation");if(I)return I}return typeof location===n$&&location?location:Zo(n_)}s(Mb,"getLocation");function o_(){return typeof console!==i$?console:Zo(Pb)}s(o_,"getConsole");function Lb(){return!!(typeof JSON===n$&&JSON||Zo(z5)!==null)}s(Lb,"hasJSON");function af(){return Lb()?JSON||Zo(z5):null}s(af,"getJSON");function Y5(){return Zo(UL)}s(Y5,"getCrypto");function J5(){return Zo(K5)}s(J5,"getMsCrypto");function c0(){var v=Tc();if(v&&(v[D5]!==Bb||Xf===null)){Bb=v[D5];var I=(Bb||Qi)[pb]();Xf=Vl(I,Db)||Vl(I,Ev)}return Xf}s(c0,"isIE");function Fb(v){if(v===void 0&&(v=null),!v){var I=Tc()||{};v=I?(I.userAgent||Qi)[pb]():Qi}var T=(v||Qi)[pb]();if(Vl(T,Db)){var k=Ic()||{};return Pe(parseInt(T[Qy](Db)[1]),k[QL]||0)}else if(Vl(T,Ev)){var M=parseInt(T[Qy](Ev)[1]);if(M)return M+4}return null}s(Fb,"getIEVersion");function Wy(v){return(Nb===null||v===!1)&&(Nb=gd()&&!!Tc().sendBeacon),Nb}s(Wy,"isBeaconsSupported");function s_(v){var I=!1;try{I=!!Zo("fetch");var T=Zo("Request");I&&v&&T&&(I=i_(T,"keepalive"))}catch{}return I}s(s_,"isFetchSupported");function HL(){return vd===null&&(vd=typeof XDomainRequest!==i$,vd&&$L()&&(vd=vd&&!i_(Zo(qL),"withCredentials"))),vd}s(HL,"useXDomainRequest");function $L(){var v=!1;try{var I=Zo(qL);v=!!I}catch{}return v}s($L,"isXhrSupported");var Sl=4294967296,Pm=4294967295,X5=123456789,WL=987654321,Ug=!1,Zf=X5,Ob=WL;function jL(v){v<0&&(v>>>=0),Zf=X5+v&Pm,Ob=WL-v&Pm,Ug=!0}s(jL,"_mwcSeed");function w$(){try{var v=yd()&2147483647;jL((Math.random()*Sl^v)+v)}catch{}}s(w$,"_autoSeedMwc");function GL(v){var I=0,T=Y5()||J5();return T&&T.getRandomValues&&(I=T.getRandomValues(new Uint32Array(1))[0]&Pm),I===0&&c0()&&(Ug||w$(),I=S$()&Pm),I===0&&(I=ky(Sl*Math.random()|0)),v||(I>>>=0),I}s(GL,"random32");function S$(v){Ob=36969*(Ob&65535)+(Ob>>16)&Pm,Zf=18e3*(Zf&65535)+(Zf>>16)&Pm;var I=(Ob<<16)+(Zf&65535)>>>0&Pm|0;return v||(I>>>=0),I}s(S$,"mwcRandom32");function dde(v){v===void 0&&(v=22);for(var I="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",T=GL()>>>0,k=0,M=Qi;M[fi]<v;)k++,M+=I.charAt(T&63),T>>>=6,k===5&&(T=(GL()<<2&4294967295|T&3)>>>0,k=0);return M}s(dde,"newId");var Qb="3.3.6",fde="."+dde(6),pde=0;function _$(v){return v.nodeType===1||v.nodeType===9||!+v.nodeType}s(_$,"_canAcceptData");function R$(v,I){var T=I[v.id];if(!T){T={};try{_$(I)&&je(I,v.id,{e:!1,v:T})}catch{}}return T}s(R$,"_getCache");function qg(v,I){return I===void 0&&(I=!1),Rb(v+pde+++(I?"."+Qb:Qi)+fde)}s(qg,"createUniqueNamespace");function k$(v){var I={id:qg("_aiData-"+(v||Qi)+"."+Qb),accept:s(function(T){return _$(T)},"accept"),get:s(function(T,k,M,q){var G=T[I.id];return G?G[Rb(k)]:(q&&(G=R$(I,T),G[Rb(k)]=M),M)},"get"),kill:s(function(T,k){if(T&&T[k])try{delete T[k]}catch{}},"kill")};return I}s(k$,"createElmNodeData");function Ub(v){return v&&Te(v)&&(v.isVal||v.fb||$e(v,"v")||$e(v,"mrg")||$e(v,"ref")||v.set)}s(Ub,"_isConfigDefaults");function P$(v,I,T){var k,M=T.dfVal||re;if(I&&T.fb){var q=T.fb;Je(q)||(q=[q]);for(var G=0;G<q[fi];G++){var ce=q[G],fe=I[ce];if(M(fe)?k=fe:v&&(fe=v.cfg[ce],M(fe)&&(k=fe),v.set(v.cfg,Ft(ce),fe)),M(k))break}}return!M(k)&&M(T.v)&&(k=T.v),k}s(P$,"_getDefault");function VL(v,I,T){var k=T;if(T&&Ub(T)&&(k=P$(v,I,T)),k){Ub(k)&&(k=VL(v,I,k));var M;Je(k)?(M=[],M[fi]=k[fi]):Cd(k)&&(M={}),M&&(le(k,function(q,G){G&&Ub(G)&&(G=VL(v,I,G)),M[q]=G}),k=M)}return k}s(VL,"_resolveDefaultValue");function zL(v,I,T,k){var M,q,G,ce=k,fe,xe,Re,Qe;Ub(ce)?(M=ce.isVal,q=ce.set,Re=ce.rdOnly,Qe=ce.blkVal,fe=ce.mrg,xe=ce.ref,!xe&&W(xe)&&(xe=!!fe),G=P$(v,I,ce)):G=k,Qe&&v.blkVal(I,T);var et,He=!0,Ke=I[T];(Ke||!oe(Ke))&&(et=Ke,He=!1,M&&et!==G&&!M(et)&&(et=G,He=!0),q&&(et=q(et,G,I),He=et===G)),He?G?et=VL(v,I,G):et=G:(Cd(et)||Je(G))&&fe&&G&&(Cd(G)||Je(G))&&le(G,function(At,st){zL(v,et,At,st)}),v.set(I,T,et),xe&&v.ref(I,T),Re&&v.rdOnly(I,T)}s(zL,"_applyDefaultValue");var jy=_g("[[ai_dynCfg_1]]"),D$=_g("[[ai_blkDynCfg_1]]"),B$=_g("[[ai_frcDynCfg_1]]");function N$(v){if(v){var I;if(Je(v)?(I=[],I[fi]=v[fi]):Cd(v)&&(I={}),I)return le(v,function(T,k){I[T]=N$(k)}),I}return v}s(N$,"_cfgDeepCopy");function mde(v){if(v){var I=v[jy]||v;if(I.cfg&&(I.cfg===v||I.cfg[jy]===I))return I}return null}s(mde,"getDynamicConfigHandler");function hde(v){if(v&&(Cd(v)||Je(v)))try{v[D$]=!0}catch{}return v}s(hde,"blockDynamicConversion");function KL(v,I,T){var k=!1;return T&&!v[I.blkVal]&&(k=T[B$],!k&&!T[D$]&&(k=Cd(T)||Je(T))),k}s(KL,"_canMakeDynamic");function qb(v){Br("InvalidAccess:"+v)}s(qb,"throwInvalidAccess");var gde=["push","pop","shift","unshift","splice"],a_=s(function(v,I,T,k){v&&v[fv](3,108,"".concat(T," [").concat(I,"] failed - ")+Qt(k))},"_throwDynamicError");function Gy(v,I,T){Je(I)&&Yr(gde,function(k){var M=I[k];I[k]=function(){for(var q=[],G=0;G<arguments.length;G++)q[G]=arguments[G];var ce=M[S5](this,q);return Wb(v,I,T,"Patching"),ce}})}s(Gy,"_patchArray");function l0(v,I){var T=Ue(v,I);return T&&T.get}s(l0,"_getOwnPropGetter");function M$(v,I,T,k){var M={n:T,h:[],trk:s(function(xe){xe&&xe.fn&&(wc(M.h,xe)===-1&&M.h[bo](xe),v.trk(xe,M))},"trk"),clr:s(function(xe){var Re=wc(M.h,xe);Re!==-1&&M.h[hb](Re,1)},"clr")},q=!0,G=!1;function ce(){q&&(G=G||KL(ce,v,k),k&&!k[jy]&&G&&(k=Wb(v,k,T,"Converting")),q=!1);var xe=v.act;return xe&&M.trk(xe),k}s(ce,"_getProperty"),ce[v.prop]={chng:s(function(){v.add(M)},"chng")};function fe(xe){if(k!==xe){ce[v.ro]&&!v.upd&&qb("["+T+"] is read-only:"+Qt(I)),q&&(G=G||KL(ce,v,k),q=!1);var Re=G&&ce[v.rf];if(G)if(Re){le(k,function(et){k[et]=xe?xe[et]:Yf});try{le(xe,function(et,He){Hb(v,k,et,He)}),xe=k}catch(et){a_((v.hdlr||{})[Sc],T,"Assigning",et),G=!1}}else k&&k[jy]&&le(k,function(et){var He=l0(k,et);if(He){var Ke=He[v.prop];Ke&&Ke.chng()}});if(xe!==k){var Qe=xe&&KL(ce,v,xe);!Re&&Qe&&(xe=Wb(v,xe,T,"Converting")),k=xe,G=Qe}v.add(M)}}s(fe,"_setProperty"),je(I,M.n,{g:ce,s:fe})}s(M$,"_createDynamicProperty");function Hb(v,I,T,k){if(I){var M=l0(I,T),q=M&&!!M[v.prop];q?I[T]=k:M$(v,I,T,k)}return I}s(Hb,"_setDynamicProperty");function $b(v,I,T,k){if(I){var M=l0(I,T),q=M&&!!M[v.prop],G=k&&k[0],ce=k&&k[1],fe=k&&k[2];if(!q){if(fe)try{hde(I)}catch(xe){a_((v.hdlr||{})[Sc],T,"Blocking",xe)}try{Hb(v,I,T,I[T]),M=l0(I,T)}catch(xe){a_((v.hdlr||{})[Sc],T,"State",xe)}}G&&(M[v.rf]=G),ce&&(M[v.ro]=ce),fe&&(M[v.blkVal]=!0)}return I}s($b,"_setDynamicPropertyState");function Wb(v,I,T,k){try{le(I,function(M,q){Hb(v,I,M,q)}),I[jy]||(Ee(I,jy,{get:s(function(){return v.hdlr},"get")}),Gy(v,I,T))}catch(M){a_((v.hdlr||{})[Sc],T,k,M)}return I}s(Wb,"_makeDynamicObject");var c_="[[ai_",l_="]]";function Ade(v){var I=Ad(c_+"get"+v.uid+l_),T=Ad(c_+"ro"+v.uid+l_),k=Ad(c_+"rf"+v.uid+l_),M=Ad(c_+"blkVal"+v.uid+l_),q=Ad(c_+"dtl"+v.uid+l_),G=null,ce=null,fe;function xe(He,Ke){var At=fe.act;try{fe.act=He,He&&He[q]&&(Yr(He[q],function(wt){wt.clr(He)}),He[q]=[]),Ke({cfg:v.cfg,set:v.set.bind(v),setDf:v.setDf.bind(v),ref:v.ref.bind(v),rdOnly:v.rdOnly.bind(v)})}catch(wt){var st=v[Sc];throw st&&st[fv](1,107,Qt(wt)),wt}finally{fe.act=At||null}}s(xe,"_useHandler");function Re(){if(G){var He=G;G=null,ce&&ce[gb](),ce=null;var Ke=[];if(Yr(He,function(At){if(At&&(At[q]&&(Yr(At[q],function(st){st.clr(At)}),At[q]=null),At.fn))try{xe(At,At.fn)}catch(st){Ke[bo](st)}}),G)try{Re()}catch(At){Ke[bo](At)}Ke[fi]>0&&kL("Watcher error(s): ",Ke)}}s(Re,"_notifyWatchers");function Qe(He){if(He&&He.h[fi]>0){G||(G=[]),ce||(ce=Dy(function(){ce=null,Re()},0));for(var Ke=0;Ke<He.h[fi];Ke++){var At=He.h[Ke];At&&wc(G,At)===-1&&G[bo](At)}}}s(Qe,"_addWatcher");function et(He,Ke){if(He){var At=He[q]=He[q]||[];wc(At,Ke)===-1&&At[bo](Ke)}}return s(et,"_trackHandler"),fe={prop:I,ro:T,rf:k,blkVal:M,hdlr:v,add:Qe,notify:Re,use:xe,trk:et},fe}s(Ade,"_createState");function Z5(v,I){var T={fn:I,rm:s(function(){T.fn=null,v=null,I=null},"rm")};return je(T,"toJSON",{v:s(function(){return"WatcherHandler"+(T.fn?"":"[X]")},"v")}),v.use(T,I),T}s(Z5,"_createAndUseHandler");function L$(v,I,T){var k=mde(I);if(k)return k;var M=qg("dyncfg",!0),q=I&&T!==!1?I:N$(I),G;function ce(){G.notify()}s(ce,"_notifyWatchers");function fe(st,wt,$t){try{st=Hb(G,st,wt,$t)}catch(sr){a_(v,wt,"Setting value",sr)}return st[wt]}s(fe,"_setValue");function xe(st){return Z5(G,st)}s(xe,"_watch");function Re(st,wt){G.use(null,function($t){var sr=G.upd;try{W(wt)||(G.upd=wt),st($t)}finally{G.upd=sr}})}s(Re,"_block");function Qe(st,wt){var $t;return $b(G,st,wt,($t={},$t[0]=!0,$t))[wt]}s(Qe,"_ref");function et(st,wt){var $t;return $b(G,st,wt,($t={},$t[1]=!0,$t))[wt]}s(et,"_rdOnly");function He(st,wt){var $t;return $b(G,st,wt,($t={},$t[2]=!0,$t))[wt]}s(He,"_blkPropValue");function Ke(st,wt){return wt&&le(wt,function($t,sr){zL(At,st,$t,sr)}),st}s(Ke,"_applyDefaults");var At={uid:null,cfg:q,logger:v,notify:ce,set:fe,setDf:Ke,watch:xe,ref:Qe,rdOnly:et,blkVal:He,_block:Re};return je(At,"uid",{c:!1,e:!1,w:!1,v:M}),G=Ade(At),Wb(G,q,"config","Creating"),At}s(L$,"_createDynamicHandler");function F$(v,I){v?(v[mb](I),v[fv](2,108,I)):qb(I)}s(F$,"_logInvalidAccess");function ep(v,I,T,k){var M=L$(T,v||{},k);return I&&M.setDf(M.cfg,I),M}s(ep,"createDynamicConfig");function Hg(v,I,T){var k=v[jy]||v;return k.cfg&&(k.cfg===v||k.cfg[jy]===k)?k[Mg](I):(F$(T,v$+Qt(v)),ep(v,null,T)[Mg](I))}s(Hg,"onConfigChange");function jb(v,I){if(v&&v[pv])return v[pv](I)}s(jb,"runTargetUnload");function O$(v,I,T){var k;return T||(k=Ib(function(M){T=M})),v&&Vue(v)>0?Kf(jb(v[0],I),function(){O$(kg(v,1),I,T)}):T(),k}s(O$,"doUnloadAll");var yde=500,Q$="Microsoft_ApplicationInsights_BypassAjaxInstrumentation";function Cde(v,I,T){return!v&&oe(v)?I:_t(v)?v:Ft(v)[pb]()==="true"}s(Cde,"_stringToBoolOrDefault");function vde(v){return{mrg:!0,v}}s(vde,"cfgDfMerge");function YL(v,I,T){return{fb:T,isVal:v,v:I}}s(YL,"cfgDfValidate");function Dm(v,I){return{fb:I,set:Cde,v:!!v}}s(Dm,"cfgDfBoolean");var e4=[Sb,_b,q5,Cv],t4=null,r4;function xde(v,I){return function(){var T=arguments,k=U$(I);if(k){var M=k.listener;M&&M[v]&&M[v][S5](M,T)}}}s(xde,"_listenerProxyFunc");function Ede(){var v=Zo("Microsoft");return v&&(t4=v.ApplicationInsights),t4}s(Ede,"_getExtensionNamespace");function U$(v){var I=t4;return!I&&v.disableDbgExt!==!0&&(I=t4||Ede()),I?I.ChromeDbgExt:null}s(U$,"getDebugExt");function bde(v){if(!r4){r4={};for(var I=0;I<e4[fi];I++)r4[e4[I]]=xde(e4[I],v)}return r4}s(bde,"getDebugListener");var Gb,q$="warnToConsole",Ide="AI (Internal): ",Tde="AI: ",wde="AITR_",H$={loggingLevelConsole:0,loggingLevelTelemetry:1,maxMessageLimit:25,enableDebug:!1},Vb=(Gb={},Gb[0]=null,Gb[1]="errorToConsole",Gb[2]=q$,Gb[3]="debugToConsole",Gb);function cf(v){return v?'"'+v[Uy](/\"/g,Qi)+'"':Qi}s(cf,"_sanitizeDiagnosticText");function u_(v,I){var T=o_();if(T){var k="log";T[v]&&(k=v),Oe(T[k])&&T[k](I)}}s(u_,"_logToConsole");var n4=function(){function v(I,T,k,M){k===void 0&&(k=!1);var q=this;q[k5]=I,q[hv]=(k?Tde:Ide)+I;var G=Qi;Lb()&&(G=af().stringify(M));var ce=(T?" message:"+cf(T):Qi)+(M?" props:"+cf(G):Qi);q[hv]+=ce}return s(v,"_InternalLogMessage"),v.dataType="MessageData",v}();function d_(v,I){return(v||{})[Sc]||new f_(I)}s(d_,"safeGetLogger");var f_=function(){function v(I){this.identifier="DiagnosticLogger",this.queue=[];var T=0,k={},M,q,G,ce,fe;Du(v,this,function(xe){fe=Qe(I||{}),xe.consoleLoggingLevel=function(){return M},xe[fv]=function(Ke,At,st,wt,$t){$t===void 0&&($t=!1);var sr=new n4(At,st,$t,wt);if(ce)throw Qt(sr);var kr=Vb[Ke]||q$;if(W(sr[hv]))He("throw"+(Ke===1?"Critical":"Warning"),sr);else{if($t){var oi=+sr[k5];!k[oi]&&M>=Ke&&(xe[kr](sr[hv]),k[oi]=!0)}else M>=Ke&&xe[kr](sr[hv]);Re(Ke,sr)}},xe.debugToConsole=function(Ke){u_("debug",Ke),He("warning",Ke)},xe[mb]=function(Ke){u_("warn",Ke),He("warning",Ke)},xe.errorToConsole=function(Ke){u_("error",Ke),He("error",Ke)},xe.resetInternalMessageCount=function(){T=0,k={}},xe.logInternalMessage=Re,xe[pv]=function(Ke){fe&&fe.rm(),fe=null};function Re(Ke,At){if(!et()){var st=!0,wt=wde+At[k5];if(k[wt]?st=!1:k[wt]=!0,st&&(Ke<=q&&(xe.queue[bo](At),T++,He(Ke===1?"error":"warn",At)),T===G)){var $t="Internal events throttle limit per PageView reached for this app.",sr=new n4(23,$t,!1);xe.queue[bo](sr),Ke===1?xe.errorToConsole($t):xe[mb]($t)}}}s(Re,"_logInternalMessage");function Qe(Ke){return Hg(ep(Ke,H$,xe).cfg,function(At){var st=At.cfg;M=st[c$],q=st.loggingLevelTelemetry,G=st.maxMessageLimit,ce=st.enableDebug})}s(Qe,"_setDefaultsFromConfig");function et(){return T>=G}s(et,"_areInternalMessagesThrottled");function He(Ke,At){var st=U$(I||{});st&&st[Sm]&&st[Sm](Ke,At)}s(He,"_debugExtMsg")})}return s(v,"DiagnosticLogger"),v.__ieDyn=1,v}();function JL(v){return v||new f_}s(JL,"_getLogger");function Ur(v,I,T,k,M,q){q===void 0&&(q=!1),JL(v)[fv](I,T,k,M,q)}s(Ur,"_throwInternal");function i4(v,I){JL(v)[mb](I)}s(i4,"_warnToConsole");var p_,Vy,$$="toGMTString",W$="toUTCString",o4="cookie",$g="expires",j$="isCookieUseDisabled",s4="disableCookiesUsage",G$="_ckMgr",a4=null,zb=null,c4=null,Bm,V$={},z$={},K$=(p_={cookieCfg:vde((Vy={},Vy[$5]={fb:"cookieDomain",dfVal:j5},Vy.path={fb:"cookiePath",dfVal:j5},Vy.enabled=Yf,Vy.ignoreCookies=Yf,Vy.blockedCookies=Yf,Vy)),cookieDomain:Yf,cookiePath:Yf},p_[s4]=Yf,p_);function XL(){!Bm&&(Bm=vr(function(){return Ic()}))}s(XL,"_getDoc");function m_(v){return v?v.isEnabled():!0}s(m_,"_isMgrEnabled");function ZL(v,I){return I&&v&&Je(v.ignoreCookies)?wc(v.ignoreCookies,I)!==-1:!1}s(ZL,"_isIgnoredCookie");function Sde(v,I){return I&&v&&Je(v.blockedCookies)&&wc(v.blockedCookies,I)!==-1?!0:ZL(v,I)}s(Sde,"_isBlockedCookie");function eF(v,I){var T=I[Tm];if(oe(T)){var k=void 0;W(v[j$])||(k=!v[j$]),W(v[s4])||(k=!v[s4]),T=k}return T}s(eF,"_isCfgEnabled");function _de(v,I){var T,k,M,q,G,ce,fe,xe;v=ep(v||z$,null,I).cfg,q=Hg(v,function(Qe){Qe.setDf(Qe.cfg,K$),T=Qe.ref(Qe.cfg,"cookieCfg"),k=T[W5]||"/",M=T[$5],G=eF(v,T)!==!1,ce=T.getCookie||Rde,fe=T.setCookie||Kb,xe=T.delCookie||Kb},I);var Re={isEnabled:s(function(){var Qe=eF(v,T)!==!1&&G&&Y$(I),et=z$[G$];return Qe&&et&&Re!==et&&(Qe=m_(et)),Qe},"isEnabled"),setEnabled:s(function(Qe){G=Qe!==!1,T[Tm]=Qe},"setEnabled"),set:s(function(Qe,et,He,Ke,At){var st=!1;if(m_(Re)&&!Sde(T,Qe)){var wt={},$t=io(et||Qi),sr=Dg($t,";");if(sr!==-1&&($t=io(D(et,sr)),wt=tF(Ce(et,sr+1))),Hy(wt,$5,Ke||M,ue,W),!oe(He)){var kr=c0();if(W(wt[$g])){var oi=yd(),Wi=oi+He*1e3;if(Wi>0){var ji=new Date;ji.setTime(Wi),Hy(wt,$g,J$(ji,kr?$$:W$)||J$(ji,kr?$$:W$)||Qi,ue)}}kr||Hy(wt,"max-age",Qi+He,null,W)}var zo=Mb();zo&&zo.protocol==="https:"&&(Hy(wt,"secure",null,null,W),zb===null&&(zb=!kde((Tc()||{})[D5])),zb&&Hy(wt,"SameSite","None",null,W)),Hy(wt,W5,At||k,null,W),fe(Qe,X$($t,wt)),st=!0}return st},"set"),get:s(function(Qe){var et=Qi;return m_(Re)&&!ZL(T,Qe)&&(et=ce(Qe)),et},"get"),del:s(function(Qe,et){var He=!1;return m_(Re)&&(He=Re.purge(Qe,et)),He},"del"),purge:s(function(Qe,et){var He,Ke=!1;if(Y$(I)){var At=(He={},He[W5]=et||"/",He[$g]="Thu, 01 Jan 1970 00:00:01 GMT",He);c0()||(At["max-age"]="0"),xe(Qe,X$(Qi,At)),Ke=!0}return Ke},"purge"),unload:s(function(Qe){q&&q.rm(),q=null},"unload")};return Re[G$]=Re,Re}s(_de,"createCookieMgr");function Y$(v){if(a4===null){a4=!1,!Bm&&XL();try{var I=Bm.v||{};a4=I[o4]!==void 0}catch(T){Ur(v,2,68,"Cannot access document.cookie - "+wl(T),{exception:Qt(T)})}}return a4}s(Y$,"areCookiesSupported");function tF(v){var I={};if(v&&v[fi]){var T=io(v)[Qy](";");Yr(T,function(k){if(k=io(k||Qi),k){var M=Dg(k,"=");M===-1?I[k]=null:I[io(D(k,M))]=io(Ce(k,M+1))}})}return I}s(tF,"_extractParts");function J$(v,I){return Oe(v[I])?v[I]():null}s(J$,"_formatDate");function X$(v,I){var T=v||Qi;return le(I,function(k,M){T+="; "+k+(oe(M)?Qi:"="+M)}),T}s(X$,"_formatCookieValue");function Rde(v){var I=Qi;if(!Bm&&XL(),Bm.v){var T=Bm.v[o4]||Qi;c4!==T&&(V$=tF(T),c4=T),I=io(V$[v]||Qi)}return I}s(Rde,"_getCookieValue");function Kb(v,I){!Bm&&XL(),Bm.v&&(Bm.v[o4]=v+"="+I)}s(Kb,"_setCookieValue");function kde(v){return Ae(v)?!!(Vl(v,"CPU iPhone OS 12")||Vl(v,"iPad; CPU OS 12")||Vl(v,"Macintosh; Intel Mac OS X 10_14")&&Vl(v,"Version/")&&Vl(v,"Safari")||Vl(v,"Macintosh; Intel Mac OS X 10_14")&&r$(v,"AppleWebKit/605.1.15 (KHTML, like Gecko)")||Vl(v,"Chrome/5")||Vl(v,"Chrome/6")||Vl(v,"UnrealEngine")&&!Vl(v,"Chrome")||Vl(v,"UCBrowser/12")||Vl(v,"UCBrowser/11")):!1}s(kde,"uaDisallowsSameSiteNone");var rF={perfEvtsSendAll:!1};function Pde(v){v.h=null;var I=v.cb;v.cb=[],Yr(I,function(T){z(T.fn,[T.arg])})}s(Pde,"_runScheduledListeners");function zy(v,I,T,k){Yr(v,function(M){M&&M[I]&&(T?(T.cb[bo]({fn:k,arg:M}),T.h=T.h||Dy(Pde,0,T)):z(k,[M]))})}s(zy,"_runListeners");var Dde=function(){function v(I){this.listeners=[];var T,k,M=[],q={h:null,cb:[]},G=ep(I,rF);k=G[Mg](function(ce){T=!!ce.cfg.perfEvtsSendAll}),Du(v,this,function(ce){je(ce,"listeners",{g:s(function(){return M},"g")}),ce[_5]=function(fe){M[bo](fe)},ce[YS]=function(fe){for(var xe=wc(M,fe);xe>-1;)M[hb](xe,1),xe=wc(M,fe)},ce[Sb]=function(fe){zy(M,Sb,q,function(xe){xe[Sb](fe)})},ce[_b]=function(fe,xe){zy(M,_b,q,function(Re){Re[_b](fe,xe)})},ce[q5]=function(fe,xe){zy(M,q5,xe?q:null,function(Re){Re[q5](fe,xe)})},ce[Cv]=function(fe){fe&&(T||!fe[_L]())&&zy(M,Cv,null,function(xe){fe.isAsync?Dy(function(){return xe[Cv](fe)},0):xe[Cv](fe)})},ce[DL]=function(fe){fe&&fe[fi]&&zy(M,DL,q,function(xe){xe[DL](fe)})},ce[BL]=function(fe){fe&&fe[xb]&&zy(M,BL,q,function(xe){xe[BL](fe)})},ce[H5]=function(fe,xe){if(fe>0){var Re=xe||0;zy(M,H5,q,function(Qe){Qe[H5](fe,Re)})}},ce[pv]=function(fe){var xe=s(function(){k&&k.rm(),k=null,M=[],q.h&&q.h[gb](),q.h=null,q.cb=[]},"_finishUnload"),Re;if(zy(M,"unload",null,function(Qe){var et=Qe[pv](fe);et&&(Re||(Re=[]),Re[bo](et))}),Re)return Ib(function(Qe){return Kf(PL(Re),function(){xe(),Qe()})});xe()}})}return s(v,"NotificationManager"),v.__ieDyn=1,v}(),Yb="ctx",nF="ParentContextKey",h_="ChildrenContextKey",Bde=null,l4=function(){function v(I,T,k){var M=this;if(M.start=yd(),M[Fy]=I,M.isAsync=k,M[_L]=function(){return!1},Oe(T)){var q;je(M,"payload",{g:s(function(){return!q&&Oe(T)&&(q=T(),T=null),q},"g")})}M[qy]=function(G){return G?G===v[nF]||G===v[h_]?M[G]:(M[Yb]||{})[G]:null},M[s0]=function(G,ce){if(G)if(G===v[nF])M[G]||(M[_L]=function(){return!0}),M[G]=ce;else if(G===v[h_])M[G]=ce;else{var fe=M[Yb]=M[Yb]||{};fe[G]=ce}},M.complete=function(){var G=0,ce=M[qy](v[h_]);if(Je(ce))for(var fe=0;fe<ce[fi];fe++){var xe=ce[fe];xe&&(G+=xe.time)}M.time=yd()-M.start,M.exTime=M.time-G,M.complete=function(){}}}return s(v,"PerfEvent"),v.ParentContextKey="parent",v.ChildrenContextKey="childEvts",v}(),Nde=function(){function v(I){this.ctx={},Du(v,this,function(T){T.create=function(k,M,q){return new l4(k,M,q)},T.fire=function(k){k&&(k.complete(),I&&Oe(I[Cv])&&I[Cv](k))},T[s0]=function(k,M){if(k){var q=T[Yb]=T[Yb]||{};q[k]=M}},T[qy]=function(k){return(T[Yb]||{})[k]}})}return s(v,"PerfManager"),v.__ieDyn=1,v}(),Nm="CoreUtils.doPerf";function Jb(v,I,T,k,M){if(v){var q=v;if(q[ZS]&&(q=q[ZS]()),q){var G=void 0,ce=q[qy](Nm);try{if(G=q.create(I(),k,M),G){if(ce&&G[s0]&&(G[s0](l4[nF],ce),ce[qy]&&ce[s0])){var fe=ce[qy](l4[h_]);fe||(fe=[],ce[s0](l4[h_],fe)),fe[bo](G)}return q[s0](Nm,G),T(G)}}catch(xe){G&&G[s0]&&G[s0]("exception",xe)}finally{G&&q.fire(G),q[s0](Nm,ce)}}}return T()}s(Jb,"doPerf");function Rc(){return Bde}s(Rc,"getGblPerfMgr");var u4="00000000000000000000000000000000",Xb="0000000000000000";function d4(v,I,T){return v&&v[fi]===I&&v!==T?!!v.match(/^[\da-f]*$/i):!1}s(d4,"_isValid");function Ky(v){return d4(v,32,u4)}s(Ky,"isValidTraceId");function bv(v){return d4(v,16,Xb)}s(bv,"isValidSpanId");var g_=k$("plugin");function Yy(v){return g_.get(v,"state",{},!0)}s(Yy,"_getPluginState");function iF(v,I){for(var T=[],k=null,M=v[_m](),q;M;){var G=M[yb]();if(G){k&&k[Oy]&&G[Jf]&&k[Oy](G),q=Yy(G);var ce=!!q[Im];G[Im]&&(ce=G[Im]()),ce||T[bo](G),k=G,M=M[_m]()}}Yr(T,function(fe){var xe=v[_c]();fe[KS](v.getCfg(),xe,I,v[_m]()),q=Yy(fe),!fe[_c]&&!q[_c]&&(q[_c]=xe),q[Im]=!0,delete q[wm]})}s(iF,"initializePlugins");function oF(v){return v.sort(function(I,T){var k=0;if(T){var M=T[Jf];I[Jf]?k=M?I[wb]-T[wb]:1:M&&(k=-1)}else k=I?1:-1;return k})}s(oF,"sortPlugins");function Mde(v){var I={};return{getName:s(function(){return I[Fy]},"getName"),setName:s(function(T){v&&v.setName(T),I[Fy]=T},"setName"),getTraceId:s(function(){return I.traceId},"getTraceId"),setTraceId:s(function(T){v&&v.setTraceId(T),Ky(T)&&(I.traceId=T)},"setTraceId"),getSpanId:s(function(){return I.spanId},"getSpanId"),setSpanId:s(function(T){v&&v.setSpanId(T),bv(T)&&(I.spanId=T)},"setSpanId"),getTraceFlags:s(function(){return I[u$]},"getTraceFlags"),setTraceFlags:s(function(T){v&&v.setTraceFlags(T),I[u$]=T},"setTraceFlags")}}s(Mde,"createDistributedTraceContext");var Lde="TelemetryPluginChain",Z$="_hasRun",sF="_getTelCtx",eW=0;function Fde(v,I,T){for(;v;){if(v[yb]()===T)return v;v=v[_m]()}return N([T],I.config||{},I)}s(Fde,"_getNextProxyStart");function aF(v,I,T,k){var M=null,q=[];I||(I=ep({},null,T[Sc])),k!==null&&(M=k?Fde(v,T,k):v);var G={_next:fe,ctx:{core:s(function(){return T},"core"),diagLog:s(function(){return d_(T,I.cfg)},"diagLog"),getCfg:s(function(){return I.cfg},"getCfg"),getExtCfg:Re,getConfig:Qe,hasNext:s(function(){return!!M},"hasNext"),getNext:s(function(){return M},"getNext"),setNext:s(function(He){M=He},"setNext"),iterate:et,onComplete:ce}};function ce(He,Ke){for(var At=[],st=2;st<arguments.length;st++)At[st-2]=arguments[st];He&&q[bo]({func:He,self:W(Ke)?G.ctx:Ke,args:At})}s(ce,"_addOnComplete");function fe(){var He=M;if(M=He?He[_m]():null,!He){var Ke=q;Ke&&Ke[fi]>0&&(Yr(Ke,function(At){try{At.func.call(At.self,At.args)}catch(st){Ur(T[Sc],2,73,"Unexpected Exception during onComplete - "+Qt(st))}}),q=[])}return He}s(fe,"_moveNext");function xe(He,Ke){var At=null,st=I.cfg;if(st&&He){var wt=st[yv];!wt&&Ke&&(wt={}),st[yv]=wt,wt=I.ref(st,yv),wt&&(At=wt[He],!At&&Ke&&(At={}),wt[He]=At,At=I.ref(wt,He))}return At}s(xe,"_getExtCfg");function Re(He,Ke){var At=xe(He,!0);return Ke&&le(Ke,function(st,wt){if(oe(At[st])){var $t=I.cfg[st];($t||!oe($t))&&(At[st]=$t)}zL(I,At,st,wt)}),I.setDf(At,Ke)}s(Re,"_resolveExtCfg");function Qe(He,Ke,At){At===void 0&&(At=!1);var st,wt=xe(He,!1),$t=I.cfg;return wt&&(wt[Ke]||!oe(wt[Ke]))?st=wt[Ke]:($t[Ke]||!oe($t[Ke]))&&(st=$t[Ke]),st||!oe(st)?st:At}s(Qe,"_getConfig");function et(He){for(var Ke;Ke=G._next();){var At=Ke[yb]();At&&He(At)}}return s(et,"_iterateChain"),G}s(aF,"_createInternalContext");function Zb(v,I,T,k){var M=ep(I),q=aF(v,M,T,k),G=q.ctx;function ce(xe){var Re=q._next();return Re&&Re[Jf](xe,G),!Re}s(ce,"_processNext");function fe(xe,Re){return xe===void 0&&(xe=null),Je(xe)&&(xe=N(xe,M.cfg,T,Re)),Zb(xe||G[_m](),M.cfg,T,Re)}return s(fe,"_createNew"),G[Gl]=ce,G[mv]=fe,G}s(Zb,"createProcessTelemetryContext");function w(v,I,T){var k=ep(I.config),M=aF(v,k,I,T),q=M.ctx;function G(fe){var xe=M._next();return xe&&xe[pv](q,fe),!xe}s(G,"_processNext");function ce(fe,xe){return fe===void 0&&(fe=null),Je(fe)&&(fe=N(fe,k.cfg,I,xe)),w(fe||q[_m](),I,xe)}return s(ce,"_createNew"),q[Gl]=G,q[mv]=ce,q}s(w,"createProcessTelemetryUnloadContext");function P(v,I,T){var k=ep(I.config),M=aF(v,k,I,T),q=M.ctx;function G(fe){return q.iterate(function(xe){Oe(xe[Lg])&&xe[Lg](q,fe)})}s(G,"_processNext");function ce(fe,xe){return fe===void 0&&(fe=null),Je(fe)&&(fe=N(fe,k.cfg,I,xe)),P(fe||q[_m](),I,xe)}return s(ce,"_createNew"),q[Gl]=G,q[mv]=ce,q}s(P,"createProcessTelemetryUpdateContext");function N(v,I,T,k){var M=null,q=!k;if(Je(v)&&v[fi]>0){var G=null;Yr(v,function(ce){if(!q&&k===ce&&(q=!0),q&&ce&&Oe(ce[Jf])){var fe=$(ce,I,T);M||(M=fe),G&&G._setNext(fe),G=fe}})}return k&&!M?N([k],I,T):M}s(N,"createTelemetryProxyChain");function $(v,I,T){var k=null,M=Oe(v[Jf]),q=Oe(v[Oy]),G;v?G=v[Ly]+"-"+v[wb]+"-"+eW++:G="Unknown-0-"+eW++;var ce={getPlugin:s(function(){return v},"getPlugin"),getNext:s(function(){return k},"getNext"),processTelemetry:Re,unload:Qe,update:et,_id:G,_setNext:s(function(He){k=He},"_setNext")};function fe(){var He;return v&&Oe(v[sF])&&(He=v[sF]()),He||(He=Zb(ce,I,T)),He}s(fe,"_getTelCtx");function xe(He,Ke,At,st,wt){var $t=!1,sr=v?v[Ly]:Lde,kr=He[Z$];return kr||(kr=He[Z$]={}),He.setNext(k),v&&Jb(He[_c](),function(){return sr+":"+At},function(){kr[G]=!0;try{var oi=k?k._id:Qi;oi&&(kr[oi]=!1),$t=Ke(He)}catch(ji){var Wi=k?kr[k._id]:!0;Wi&&($t=!0),(!k||!Wi)&&Ur(He[Sm](),1,73,"Plugin ["+sr+"] failed during "+At+" - "+Qt(ji)+", run flags: "+Qt(kr))}},st,wt),$t}s(xe,"_processChain");function Re(He,Ke){Ke=Ke||fe();function At(st){if(!v||!M)return!1;var wt=Yy(v);return wt[wm]||wt[U5]?!1:(q&&v[Oy](k),v[Jf](He,st),!0)}s(At,"_callProcessTelemetry"),xe(Ke,At,"processTelemetry",function(){return{item:He}},!He.sync)||Ke[Gl](He)}s(Re,"_processTelemetry");function Qe(He,Ke){function At(){var st=!1;if(v){var wt=Yy(v),$t=v[_c]||wt[_c];v&&(!$t||$t===He.core())&&!wt[wm]&&(wt[_c]=null,wt[wm]=!0,wt[Im]=!1,v[wm]&&v[wm](He,Ke)===!0&&(st=!0))}return st}s(At,"_callTeardown"),xe(He,At,"unload",function(){},Ke.isAsync)||He[Gl](Ke)}s(Qe,"_unloadPlugin");function et(He,Ke){function At(){var st=!1;if(v){var wt=Yy(v),$t=v[_c]||wt[_c];v&&(!$t||$t===He.core())&&!wt[wm]&&v[Lg]&&v[Lg](He,Ke)===!0&&(st=!0)}return st}s(At,"_callUpdate"),xe(He,At,"update",function(){},!1)||He[Gl](Ke)}return s(et,"_updatePlugin"),Zt(ce)}s($,"createTelemetryPluginProxy");function de(){var v=[];function I(k){k&&v[bo](k)}s(I,"_addHandler");function T(k,M){Yr(v,function(q){try{q(k,M)}catch(G){Ur(k[Sm](),2,73,"Unexpected error calling unload handler - "+Qt(G))}}),v=[]}return s(T,"_runHandlers"),{add:I,run:T}}s(de,"createUnloadHandlerContainer");function we(){var v=[];function I(k){var M=v;v=[],Yr(M,function(q){try{(q.rm||q.remove).call(q)}catch(G){Ur(k,2,73,"Unloading:"+Qt(G))}})}s(I,"_doUnload");function T(k){k&&Gf(v,k)}return s(T,"_addHook"),{run:I,add:T}}s(we,"createUnloadHookContainer");var ke,We="getPlugin",it=(ke={},ke[yv]={isVal:j5,v:{}},ke),Et=function(){function v(){var I=this,T,k,M,q,G;xe(),Du(v,I,function(Re){Re[KS]=function(Qe,et,He,Ke){fe(Qe,et,Ke),T=!0},Re[wm]=function(Qe,et){var He=Re[_c];if(!He||Qe&&He!==Qe[_c]())return;var Ke,At=!1,st=Qe||w(null,He,M&&M[We]?M[We]():M),wt=et||{reason:0,isAsync:!1};function $t(){At||(At=!0,q.run(st,et),G.run(st[Sm]()),Ke===!0&&st[Gl](wt),xe())}return s($t,"_unloadCallback"),!Re[P5]||Re[P5](st,wt,$t)!==!0?$t():Ke=!0,Ke},Re[Lg]=function(Qe,et){var He=Re[_c];if(!He||Qe&&He!==Qe[_c]())return;var Ke,At=!1,st=Qe||P(null,He,M&&M[We]?M[We]():M),wt=et||{reason:0};function $t(){At||(At=!0,fe(st.getCfg(),st.core(),st[_m]()))}return s($t,"_updateCallback"),!Re._doUpdate||Re._doUpdate(st,wt,$t)!==!0?$t():Ke=!0,Ke},t_(Re,"_addUnloadCb",function(){return q},"add"),t_(Re,"_addHook",function(){return G},"add"),je(Re,"_unloadHooks",{g:s(function(){return G},"g")})}),I[Sm]=function(Re){return ce(Re)[Sm]()},I[Im]=function(){return T},I.setInitialized=function(Re){T=Re},I[Oy]=function(Re){M=Re},I[Gl]=function(Re,Qe){Qe?Qe[Gl](Re):M&&Oe(M[Jf])&&M[Jf](Re,null)},I._getTelCtx=ce;function ce(Re){Re===void 0&&(Re=null);var Qe=Re;if(!Qe){var et=k||Zb(null,{},I[_c]);M&&M[We]?Qe=et[mv](null,M[We]):Qe=et[mv](null,M)}return Qe}s(ce,"_getTelCtx");function fe(Re,Qe,et){ep(Re,it,d_(Qe)),!et&&Qe&&(et=Qe[Cb]()[_m]());var He=M;M&&M[We]&&(He=M[We]()),I[_c]=Qe,k=Zb(et,Re,Qe,He)}s(fe,"_setDefaults");function xe(){T=!1,I[_c]=null,k=null,M=null,G=we(),q=de()}s(xe,"_initDefaults")}return s(v,"BaseTelemetryPlugin"),v.__ieDyn=1,v}();function yr(v,I,T){var k={id:I,fn:T};Gf(v,k);var M={remove:s(function(){Yr(v,function(q,G){if(q.id===k.id)return v[hb](G,1),-1})},"remove")};return M}s(yr,"_addInitializer");function On(v,I,T){for(var k=!1,M=v[fi],q=0;q<M;++q){var G=v[q];if(G)try{if(G.fn[S5](null,[I])===!1){k=!0;break}}catch(ce){Ur(T,2,64,"Telemetry initializer failed: "+wl(ce),{exception:Qt(ce)},!0)}}return!k}s(On,"_runInitializers");var ri=function(v){zS(I,v);function I(){var T=v.call(this)||this;T.identifier="TelemetryInitializerPlugin",T.priority=199;var k,M;q(),Du(I,T,function(G,ce){G.addTelemetryInitializer=function(fe){return yr(M,k++,fe)},G[Jf]=function(fe,xe){On(M,fe,xe?xe[Sm]():G[Sm]())&&G[Gl](fe,xe)},G[P5]=function(){q()}});function q(){k=0,M=[]}return s(q,"_initDefaults"),T}return s(I,"TelemetryInitializerPlugin"),I.__ieDyn=1,I}(Et),Er,Fr="Plugins must provide initialize method",Xn="_notificationManager",Qn="SDK is still unloading...",Ui="SDK is not initialized",Lo=100,oo=5e4,Vc=or((Er={cookieCfg:{}},Er[Tb]={rdOnly:!0,ref:!0,v:[]},Er[Qg]={rdOnly:!0,ref:!0,v:[]},Er[yv]={ref:!0,v:{}},Er[a0]=Yf,Er.loggingLevelConsole=0,Er.diagnosticLogInterval=Yf,Er));function eI(v,I){return new Nde(I)}s(eI,"_createPerfManager");function A_(v,I,T){var k=[],M=[],q={};return Yr(T,function(G){(oe(G)||oe(G[KS]))&&zr(Fr);var ce=G[wb],fe=G[Ly];G&&ce&&(oe(q[ce])?q[ce]=fe:i4(v,"Two extensions have same priority #"+ce+" - "+q[ce]+", "+fe)),!ce||ce<I?k[bo](G):M[bo](G)}),{core:k,channels:M}}s(A_,"_validateExtensions");function cF(v,I){var T=!1;return Yr(I,function(k){if(k===v)return T=!0,-1}),T}s(cF,"_isPluginPresent");function f4(v,I,T,k){T&&le(T,function(M,q){k&&Cd(q)&&Cd(I[M])&&f4(v,I[M],q,k),k&&Cd(q)&&Cd(I[M])?f4(v,I[M],q,k):v.set(I,M,q)})}s(f4,"_deepMergeConfig");function tW(v,I){var T=null,k=-1;return Yr(v,function(M,q){if(M.w===I)return T=M,k=q,-1}),{i:k,l:T}}s(tW,"_findWatcher");function Ode(v,I){var T=tW(v,I).l;return T||(T={w:I,rm:s(function(){var k=tW(v,I);k.i!==-1&&v[hb](k.i,1)},"rm")},v[bo](T)),T}s(Ode,"_addDelayedCfgListener");function lF(v,I,T){Yr(I,function(k){var M=Hg(v,k.w,T);delete k.w,k.rm=function(){M.rm()}})}s(lF,"_registerDelayedCfgListener");function rW(v,I,T,k){return I.add(v[Mg](function(M){var q=M.cfg.disableDbgExt;q===!0&&k&&(T[YS](k),k=null),T&&!k&&q!==!0&&(k=bde(M.cfg),T[_5](k))})),k}s(rW,"_initDebugListener");function nW(v){return je({rm:s(function(){v.rm()},"rm")},"toJSON",{v:s(function(){return"aicore::onCfgChange<"+JSON.stringify(v)+">"},"v")})}s(nW,"_createUnloadHook");var Nt=function(){function v(){var I,T,k,M,q,G,ce,fe,xe,Re,Qe,et,He,Ke,At,st,wt,$t,sr,kr,oi,Wi,ji,zo,wn,rn,Gi,Ea,Ts,Wt,nn,Fo;Du(v,this,function(Dt){ft(),Dt._getDbgPlgTargets=function(){return[ji,M]},Dt[Im]=function(){return T},Dt.activeStatus=function(){return rn},Dt._setPendingStatus=function(){rn=3},Dt[KS]=function(Ct,wr,jn,Xr){He&&zr(Qn),Dt[Im]()&&zr("Core cannot be initialized more than once"),I=ep(Ct,Vc,jn||Dt[Sc],!1),Ct=I.cfg,Mu(I[Mg](function(ss){var Ks=ss.cfg,bd=rn===3;if(!bd){Ea=Ks.initInMemoMaxSize||Lo;var tp=Ks.instrumentationKey,Gg=Ks.endpointUrl;if(oe(tp)){oi=null,rn=My.INACTIVE;var Vg="Please provide instrumentation key";T?(Ur(k,1,100,Vg),Wa()):zr(Vg);return}var T4=[];if(gt(tp)?(T4[bo](tp),oi=null):oi=tp,gt(Gg)?(T4[bo](Gg),Gi=null):Gi=Gg,T4[fi]){Ts=!1,rn=3;var RF=j5(Ks.initTimeOut)?Ks.initTimeOut:oo,gfe=sf(T4);Dy(function(){Ts||Un()},RF),Kf(gfe,function(dI){try{if(Ts)return;if(!dI.rejected){var fI=dI[Ab];if(fI&&fI[fi]){var SW=fI[0];if(oi=SW&&SW[Ab],fI[fi]>1){var _W=fI[1];Gi=_W&&_W[Ab]}}oi&&(Ct.instrumentationKey=oi,Ct.endpointUrl=Gi)}Un()}catch{Ts||Un()}})}else Un();var w4=ss.ref(ss.cfg,yv);le(w4,function(dI){ss.ref(w4,dI)})}})),q=Xr,sr=rW(I,$t,q&&Dt[o0](),sr),lI(),Dt[Sc]=jn;var Gn=Ct[Tb];if(Re=[],Re[bo].apply(Re,s$(s$([],wr,!1),Gn)),Qe=Ct[Qg],ja(null),(!et||et[fi]===0)&&zr("No "+Qg+" available"),Qe&&Qe[fi]>1){var es=Dt[yb]("TeeChannelController");(!es||!es.plugin)&&Ur(k,1,28,"TeeChannel required")}lF(Ct,Wi,k),Wi=null,T=!0,rn===My.ACTIVE&&Wa()},Dt.getChannels=function(){var Ct=[];return et&&Yr(et,function(wr){Ct[bo](wr)}),Zt(Ct)},Dt.track=function(Ct){Jb(Dt[ZS](),function(){return"AppInsightsCore:track"},function(){Ct===null&&(ba(Ct),zr("Invalid telemetry item")),!Ct[Fy]&&oe(Ct[Fy])&&(ba(Ct),zr("telemetry name required")),Ct.iKey=Ct.iKey||oi,Ct.time=Ct.time||e_(new Date),Ct.ver=Ct.ver||"4.0",!He&&Dt[Im]()&&rn===My.ACTIVE?Yc()[Gl](Ct):rn!==My.INACTIVE&&M[fi]<=Ea&&M[bo](Ct)},function(){return{item:Ct}},!Ct.sync)},Dt[Cb]=Yc,Dt[o0]=function(){return q||(q=new Dde(I.cfg),Dt[Xn]=q),q},Dt[_5]=function(Ct){Dt.getNotifyMgr()[_5](Ct)},Dt[YS]=function(Ct){q&&q[YS](Ct)},Dt.getCookieMgr=function(){return fe||(fe=_de(I.cfg,Dt[Sc])),fe},Dt.setCookieMgr=function(Ct){fe!==Ct&&(jb(fe,!1),fe=Ct)},Dt[ZS]=function(){return G||ce||Rc()},Dt.setPerfMgr=function(Ct){G=Ct},Dt.eventCnt=function(){return M[fi]},Dt.releaseQueue=function(){if(T&&M[fi]>0){var Ct=M;M=[],rn===2?Yr(Ct,function(wr){wr.iKey=wr.iKey||oi,Yc()[Gl](wr)}):Ur(k,2,20,"core init status is not active")}},Dt.pollInternalLogs=function(Ct){return At=Ct||null,Fo=!1,Wt&&Wt[gb](),Ko(!0)};function Un(){Ts=!0,oe(oi)?(rn=My.INACTIVE,Ur(k,1,112,"ikey can't be resolved from promises")):rn=My.ACTIVE,Wa()}s(Un,"_setStatus");function Wa(){T&&(Dt.releaseQueue(),Dt.pollInternalLogs())}s(Wa,"_releaseQueues");function Ko(Ct){if((!Wt||!Wt[Tm])&&!Fo){var wr=Ct||k&&k.queue[fi]>0;wr&&(nn||(nn=!0,Mu(I[Mg](function(jn){var Xr=jn.cfg.diagnosticLogInterval;(!Xr||!(Xr>0))&&(Xr=1e4);var Gn=!1;Wt&&(Gn=Wt[Tm],Wt[gb]()),Wt=v5(cI,Xr),Wt.unref(),Wt[Tm]=Gn}))),Wt[Tm]=!0)}return Wt}s(Ko,"_startLogPoller"),Dt[a$]=function(){Fo=!0,Wt&&Wt[gb](),cI()},ML(Dt,function(){return Ke},["addTelemetryInitializer"]),Dt[pv]=function(Ct,wr,jn){Ct===void 0&&(Ct=!0),T||zr(Ui),He&&zr(Qn);var Xr={reason:50,isAsync:Ct,flushComplete:!1},Gn;Ct&&!wr&&(Gn=Ib(function(Ks){wr=Ks}));var es=w(Lm(),Dt);es[R5](function(){$t.run(Dt[Sc]),O$([fe,q,k],Ct,function(){ft(),wr&&wr(Xr)})},Dt);function ss(Ks){Xr.flushComplete=Ks,He=!0,wt.run(es,Xr),Dt[a$](),es[Gl](Xr)}return s(ss,"_doUnload"),cI(),Wg(Ct,ss,6,jn),Gn},Dt[yb]=Jl,Dt.addPlugin=function(Ct,wr,jn,Xr){if(!Ct){Xr&&Xr(!1),uI(Fr);return}var Gn=Jl(Ct[Ly]);if(Gn&&!wr){Xr&&Xr(!1),uI("Plugin ["+Ct[Ly]+"] is already loaded!");return}var es={reason:16};function ss(tp){Re[bo](Ct),es.added=[Ct],ja(es),Xr&&Xr(!0)}if(s(ss,"_addPlugin"),Gn){var Ks=[Gn.plugin],bd={reason:2,isAsync:!!jn};lf(Ks,bd,function(tp){tp?(es.removed=Ks,es.reason|=32,ss()):Xr&&Xr(!1)})}else ss()},Dt.updateCfg=function(Ct,wr){wr===void 0&&(wr=!0);var jn;if(Dt[Im]()){jn={reason:1,cfg:I.cfg,oldCfg:h5({},I.cfg),newConfig:h5({},Ct),merge:wr},Ct=jn.newConfig;var Xr=I.cfg;Ct[Tb]=Xr[Tb],Ct[Qg]=Xr[Qg]}I._block(function(Gn){var es=Gn.cfg;f4(Gn,es,Ct,wr),wr||le(es,function(ss){$e(Ct,ss)||Gn.set(es,ss,Yf)}),Gn.setDf(es,Vc)},!0),I.notify(),jn&&jg(jn)},Dt.evtNamespace=function(){return st},Dt.flush=Wg,Dt.getTraceCtx=function(Ct){return kr||(kr=Mde()),kr},Dt.setTraceCtx=function(Ct){kr=Ct||null},Dt.addUnloadHook=Mu,t_(Dt,"addUnloadCb",function(){return wt},"add"),Dt.onCfgChange=function(Ct){var wr;return T?wr=Hg(I.cfg,Ct,Dt[Sc]):wr=Ode(Wi,Ct),nW(wr)},Dt.getWParam=function(){return va()||I.cfg.enableWParam?0:-1};function Yl(){var Ct={};zo=[];var wr=s(function(jn){jn&&Yr(jn,function(Xr){if(Xr[Ly]&&Xr[vb]&&!Ct[Xr.identifier]){var Gn=Xr[Ly]+"="+Xr[vb];zo[bo](Gn),Ct[Xr.identifier]=Xr}})},"_addPluginVersions");wr(et),Qe&&Yr(Qe,function(jn){wr(jn)}),wr(Re)}s(Yl,"_setPluginVersions");function ft(){T=!1,I=ep({},Vc,Dt[Sc]),I.cfg[c$]=1,je(Dt,"config",{g:s(function(){return I.cfg},"g"),s:s(function(wr){Dt.updateCfg(wr,!1)},"s")}),je(Dt,"pluginVersionStringArr",{g:s(function(){return zo||Yl(),zo},"g")}),je(Dt,"pluginVersionString",{g:s(function(){return wn||(zo||Yl(),wn=zo.join(";")),wn||Qi},"g")}),je(Dt,"logger",{g:s(function(){return k||(k=new f_(I.cfg),I[Sc]=k),k},"g"),s:s(function(wr){I[Sc]=wr,k!==wr&&(jb(k,!1),k=wr)},"s")}),Dt[Sc]=new f_(I.cfg),ji=[];var Ct=Dt.config[Tb]||[];Ct.splice(0,Ct[fi]),Gf(Ct,ji),Ke=new ri,M=[],jb(q,!1),q=null,G=null,ce=null,jb(fe,!1),fe=null,xe=null,Re=[],Qe=null,et=null,He=!1,At=null,st=qg("AIBaseCore",!0),wt=de(),kr=null,oi=null,$t=we(),Wi=[],wn=null,zo=null,Fo=!1,Wt=null,nn=!1,rn=0,Gi=null,Ea=null,Ts=!1}s(ft,"_initDefaults");function Yc(){var Ct=Zb(Lm(),I.cfg,Dt);return Ct[R5](Ko),Ct}s(Yc,"_createTelCtx");function ja(Ct){var wr=A_(Dt[Sc],yde,Re);xe=null,wn=null,zo=null,et=(Qe||[])[0]||[],et=oF(Gf(et,wr[Qg]));var jn=Gf(oF(wr[_c]),et);ji=Zt(jn);var Xr=Dt.config[Tb]||[];Xr.splice(0,Xr[fi]),Gf(Xr,ji);var Gn=Yc();et&&et[fi]>0&&iF(Gn[mv](et),jn),iF(Gn,jn),Ct&&jg(Ct)}s(ja,"_initPluginChain");function Jl(Ct){var wr=null,jn=null,Xr=[];return Yr(ji,function(Gn){if(Gn[Ly]===Ct&&Gn!==Ke)return jn=Gn,-1;Gn.getChannel&&Xr[bo](Gn)}),!jn&&Xr[fi]>0&&Yr(Xr,function(Gn){if(jn=Gn.getChannel(Ct),!jn)return-1}),jn&&(wr={plugin:jn,setEnabled:s(function(Gn){Yy(jn)[U5]=!Gn},"setEnabled"),isEnabled:s(function(){var Gn=Yy(jn);return!Gn[wm]&&!Gn[U5]},"isEnabled"),remove:s(function(Gn,es){Gn===void 0&&(Gn=!0);var ss=[jn],Ks={reason:1,isAsync:Gn};lf(ss,Ks,function(bd){bd&&ja({reason:32,removed:ss}),es&&es(bd)})},"remove")}),wr}s(Jl,"_getPlugin");function Lm(){if(!xe){var Ct=(ji||[]).slice();wc(Ct,Ke)===-1&&Ct[bo](Ke),xe=N(oF(Ct),I.cfg,Dt)}return xe}s(Lm,"_getPluginChain");function lf(Ct,wr,jn){if(Ct&&Ct[fi]>0){var Xr=N(Ct,I.cfg,Dt),Gn=w(Xr,Dt);Gn[R5](function(){var es=!1,ss=[];Yr(Re,function(bd,tp){cF(bd,Ct)?es=!0:ss[bo](bd)}),Re=ss,wn=null,zo=null;var Ks=[];Qe&&(Yr(Qe,function(bd,tp){var Gg=[];Yr(bd,function(Vg){cF(Vg,Ct)?es=!0:Gg[bo](Vg)}),Ks[bo](Gg)}),Qe=Ks),jn&&jn(es),Ko()}),Gn[Gl](wr)}else jn(!1)}s(lf,"_removePlugins");function cI(){if(k&&k.queue){var Ct=k.queue.slice(0);k.queue[fi]=0,Yr(Ct,function(wr){var jn={name:At||"InternalMessageId: "+wr[k5],iKey:oi,time:e_(new Date),baseType:n4.dataType,baseData:{message:wr[hv]}};Dt.track(jn)})}}s(cI,"_flushInternalLogs");function Wg(Ct,wr,jn,Xr){var Gn=1,es=!1,ss=null;Xr=Xr||5e3;function Ks(){Gn--,es&&Gn===0&&(ss&&ss[gb](),ss=null,wr&&wr(es),wr=null)}if(s(Ks,"doCallback"),et&&et[fi]>0){var bd=Yc()[mv](et);bd.iterate(function(tp){if(tp.flush){Gn++;var Gg=!1;tp.flush(Ct,function(){Gg=!0,Ks()},jn)||Gg||(Ct&&ss==null?ss=Dy(function(){ss=null,Ks()},Xr):Ks())}})}return es=!0,Ks(),!0}s(Wg,"_flushChannels");function lI(){var Ct;Mu(I[Mg](function(wr){var jn=wr.cfg.enablePerfMgr;if(jn){var Xr=wr.cfg[a0];(Ct!==Xr||!Ct)&&(Xr||(Xr=eI),x$(wr.cfg,a0,Xr),Ct=Xr,ce=null),!G&&!ce&&Oe(Xr)&&(ce=Xr(Dt,Dt[o0]()))}else ce=null,Ct=null}))}s(lI,"_initPerfManager");function jg(Ct){var wr=P(Lm(),Dt);wr[R5](Ko),(!Dt._updateHook||Dt._updateHook(wr,Ct)!==!0)&&wr[Gl](Ct)}s(jg,"_doUpdate");function uI(Ct){var wr=Dt[Sc];wr?(Ur(wr,2,73,Ct),Ko()):zr(Ct)}s(uI,"_logOrThrowError");function ba(Ct){var wr=Dt[o0]();wr&&wr[_b]([Ct],2)}s(ba,"_notifyInvalidEvent");function Mu(Ct){$t.add(Ct)}s(Mu,"_addUnloadHook")})}return s(v,"AppInsightsCore"),v.__ieDyn=1,v}();function Jr(v,I){try{if(v&&v!==""){var T=af().parse(v);if(T&&T[l$]&&T[l$]>=T.itemsAccepted&&T.itemsReceived-T.itemsAccepted===T.errors[fi])return T}}catch(k){Ur(I,1,43,"Cannot parse the response. "+(k[Fy]||Qt(k)),{response:v})}return null}s(Jr,"parseResponse");var vn="",As="NoResponseBody",zc="&"+As+"=true",$a="POST",Kc=function(){function v(){var I=0,T,k,M,q,G,ce,fe,xe,Re,Qe,et,He,Ke,At;Du(v,this,function(st,wt){var $t=!0;Ts(),st[KS]=function(Wt,nn){M=nn,k&&Ur(M,1,28,"Sender is already initialized"),st.SetConfig(Wt),k=!0},st._getDbgPlgTargets=function(){return[k,q,ce,T]},st.SetConfig=function(Wt){try{if(G=Wt.senderOnCompleteCallBack||{},ce=!!Wt.disableCredentials,fe=Wt.fetchCredentials,q=!!Wt.isOneDs,T=!!Wt.enableSendPromise,Re=!!Wt.disableXhr,Qe=!!Wt.disableBeacon,et=!!Wt.disableBeaconSync,At=Wt.timeWrapper,Ke=!!Wt.addNoResponse,He=!!Wt.disableFetchKeepAlive,xe={sendPOST:rn},q||($t=!1),ce){var nn=Mb();nn&&nn.protocol&&nn.protocol[pb]()==="file:"&&($t=!1)}return!0}catch{}return!1},st.getSyncFetchPayload=function(){return I},st.getSenderInst=function(Wt,nn){return Wt&&Wt[fi]?Wi(Wt,nn):null},st.getFallbackInst=function(){return xe},st[P5]=function(Wt,nn){Ts()};function sr(Wt,nn){ji(nn,200,{},Wt)}s(sr,"_onSuccess");function kr(Wt,nn){Ur(M,2,26,"Failed to send telemetry.",{message:Wt}),ji(nn,400,{})}s(kr,"_onError");function oi(Wt){kr("No endpoint url is provided for the batch",Wt)}s(oi,"_onNoPayloadUrl");function Wi(Wt,nn){for(var Fo=0,Dt=null,Un=0;Dt==null&&Un<Wt[fi];)Fo=Wt[Un],!Re&&Fo===1?HL()?Dt=Ea:$L()&&(Dt=rn):Fo===2&&s_(nn)&&(!nn||!He)?Dt=Gi:Fo===3&&Wy()&&(nn?!et:!Qe)&&(Dt=wn),Un++;return Dt?{_transport:Fo,_isSync:nn,sendPOST:Dt}:null}s(Wi,"_getSenderInterface");function ji(Wt,nn,Fo,Dt){try{Wt&&Wt(nn,Fo,Dt)}catch{}}s(ji,"_doOnComplete");function zo(Wt,nn){var Fo=Tc(),Dt=Wt[Fg];if(!Dt)return oi(nn),!0;Dt=Wt[Fg]+(Ke?zc:vn);var Un=Wt[xb],Wa=q?Un:new Blob([Un],{type:"text/plain;charset=UTF-8"}),Ko=Fo.sendBeacon(Dt,Wa);return Ko}s(zo,"_doBeaconSend");function wn(Wt,nn,Fo){var Dt=Wt[xb];try{if(Dt)if(zo(Wt,nn))sr(vn,nn);else{var Un=G&&G.beaconOnRetry;Un&&Oe(Un)?Un(Wt,nn,zo):(xe&&xe.sendPOST(Wt,nn,!0),Ur(M,2,40,". Failed to send telemetry with Beacon API, retried with normal sender."))}}catch(Wa){q&&i4(M,"Failed to send telemetry using sendBeacon API. Ex:"+Qt(Wa)),ji(nn,q?0:400,{},vn)}}s(wn,"_beaconSender");function rn(Wt,nn,Fo){var Dt,Un,Wa,Ko=Wt[RL]||{};!Fo&&T&&(Dt=Ib(function(ja,Jl){Un=ja,Wa=Jl})),q&&Fo&&Wt.disableXhrSync&&(Fo=!1);var Yl=Wt[Fg];if(!Yl){oi(nn),Un&&Un(!1);return}var ft=OL($a,Yl,$t,!0,Fo,Wt[Og]);q||ft.setRequestHeader("Content-type","application/json"),Yr(Tt(Ko),function(ja){ft.setRequestHeader(ja,Ko[ja])}),ft.onreadystatechange=function(){q||(Yc(ft),ft.readyState===4&&Un&&Un(!0))},ft.onload=function(){q&&Yc(ft)};function Yc(ja){var Jl=G&&G.xhrOnComplete,Lm=Jl&&Oe(Jl);if(Lm)Jl(ja,nn,Wt);else{var lf=G5(ja);ji(nn,ja[JS],xv(ja,q),lf)}}return s(Yc,"_doOnReadyFunc"),ft.onerror=function(ja){ji(nn,q?ft[JS]:400,xv(ft,q),q?vn:V5(ft)),Wa&&Wa(ja)},ft.ontimeout=function(){ji(nn,q?ft[JS]:500,xv(ft,q),q?vn:V5(ft)),Un&&Un(!1)},ft.send(Wt[xb]),Dt}s(rn,"_xhrSender");function Gi(Wt,nn,Fo){var Dt,Un=Wt[Fg],Wa=Wt[xb],Ko=q?Wa:new Blob([Wa],{type:"application/json"}),Yl,ft,Yc,ja=new Headers,Jl=Wa[fi],Lm=!1,lf=!1,cI=Wt[RL]||{},Wg=(Dt={method:$a,body:Ko},Dt[Q$]=!0,Dt);Wt.headers&&Tt(Wt.headers)[fi]>0&&(Yr(Tt(cI),function(ba){ja.append(ba,cI[ba])}),Wg[RL]=ja),fe?Wg.credentials=fe:$t&&q&&(Wg.credentials="include"),Fo&&(Wg.keepalive=!0,I+=Jl,q?Wt._sendReason===2&&(Lm=!0,Ke&&(Un+=zc)):Lm=!0);var lI=new Request(Un,Wg);try{lI[Q$]=!0}catch{}if(!Fo&&T&&(Yl=Ib(function(ba,Mu){ft=ba,Yc=Mu})),!Un){oi(nn),ft&&ft(!1);return}function jg(ba){ji(nn,q?0:400,{},q?vn:ba)}s(jg,"_handleError");function uI(ba,Mu,Ct){var wr=ba[JS],jn=G.fetchOnComplete;jn&&Oe(jn)?jn(ba,nn,Ct||vn,Mu):ji(nn,wr,{},Ct||vn)}s(uI,"_onFetchComplete");try{Kf(fetch(q?Un:lI,q?Wg:null),function(ba){if(Fo&&(I-=Jl,Jl=0),!lf)if(lf=!0,ba.rejected)jg(ba.reason&&ba.reason[hv]),Yc&&Yc(ba.reason);else{var Mu=ba[Ab];try{!q&&!Mu.ok?(jg(Mu.statusText),ft&&ft(!1)):q&&!Mu.body?(uI(Mu,null,vn),ft&&ft(!0)):Kf(Mu.text(),function(Ct){uI(Mu,Wt,Ct[Ab]),ft&&ft(!0)})}catch(Ct){jg(Qt(Ct)),Yc&&Yc(Ct)}}})}catch(ba){lf||(jg(Qt(ba)),Yc&&Yc(ba))}return Lm&&!lf&&(lf=!0,ji(nn,200,{}),ft&&ft(!0)),q&&!lf&&Wt[Og]>0&&At&&At.set(function(){lf||(lf=!0,ji(nn,500,{}),ft&&ft(!0))},Wt[Og]),Yl}s(Gi,"_doFetchSender");function Ea(Wt,nn,Fo){var Dt=Vs(),Un=new XDomainRequest,Wa=Wt[xb];Un.onload=function(){var ja=G5(Un),Jl=G&&G.xdrOnComplete;Jl&&Oe(Jl)?Jl(Un,nn,Wt):ji(nn,200,{},ja)},Un.onerror=function(){ji(nn,400,{},q?vn:b$(Un))},Un.ontimeout=function(){ji(nn,500,{})},Un.onprogress=function(){};var Ko=Dt&&Dt.location&&Dt.location.protocol||"",Yl=Wt[Fg];if(!Yl){oi(nn);return}if(!q&&Yl.lastIndexOf(Ko,0)!==0){var ft="Cannot send XDomain request. The endpoint URL protocol doesn't match the hosting page protocol.";Ur(M,2,40,". "+ft),kr(ft,nn);return}var Yc=q?Yl:Yl[Uy](/^(https?:)/,"");Un.open($a,Yc),Wt[Og]&&(Un[Og]=Wt[Og]),Un.send(Wa),q&&Fo?At&&At.set(function(){Un.send(Wa)},0):Un.send(Wa)}s(Ea,"_xdrSender");function Ts(){I=0,k=!1,T=!1,M=null,q=null,G=null,ce=null,fe=null,xe=null,Re=!1,Qe=!1,et=!1,He=!1,Ke=!1,At=null}s(Ts,"_initDefaults")})}return s(v,"SenderPostManager"),v.__ieDyn=1,v}(),Iv="on",Jy="attachEvent",tI="addEventListener",iW="detachEvent",oW="removeEventListener",p4="events";qg("aiEvtPageHide"),qg("aiEvtPageShow");var Qde=/\.[\.]+/g,Q4e=/[\.]+$/,eIt=1,sW=k$("events"),tIt=/^([^.]*)(?:\.(.+)|)/;function U4e(v){return v&&v[Uy]?v[Uy](/^[\s\.]+|(?=[\s\.])[\.\s]+$/g,Qi):v}s(U4e,"_normalizeNamespace");function Ude(v,I){if(I){var T=Qi;Je(I)?(T=Qi,Yr(I,function(M){M=U4e(M),M&&(M[0]!=="."&&(M="."+M),T+=M)})):T=U4e(I),T&&(T[0]!=="."&&(T="."+T),v=(v||Qi)+T)}var k=tIt.exec(v||Qi)||[];return{type:k[1],ns:(k[2]||Qi).replace(Qde,".").replace(Q4e,Qi)[Qy](".").sort().join(".")}}s(Ude,"_getEvtNamespace");function q4e(v,I,T){T===void 0&&(T=!0);var k=sW.get(v,p4,{},T),M=k[I];return M||(M=k[I]=[]),M}s(q4e,"_getRegisteredEvents");function H4e(v,I,T,k){v&&I&&I[Bu]&&(v[oW]?v[oW](I[Bu],T,k):v[iW]&&v[iW](Iv+I[Bu],T))}s(H4e,"_doDetach");function rIt(v,I,T,k){var M=!1;return v&&I&&I[Bu]&&T&&(v[tI]?(v[tI](I[Bu],T,k),M=!0):v[Jy]&&(v[Jy](Iv+I[Bu],T),M=!0)),M}s(rIt,"_doAttach");function $4e(v,I,T,k){for(var M=I[fi];M--;){var q=I[M];q&&(!T.ns||T.ns===q[wL].ns)&&(!k||k(q))&&(H4e(v,q[wL],q.handler,q.capture),I[hb](M,1))}}s($4e,"_doUnregister");function nIt(v,I,T){if(I[Bu])$4e(v,q4e(v,I[Bu]),I,T);else{var k=sW.get(v,p4,{});le(k,function(M,q){$4e(v,q,I,T)}),Tt(k)[fi]===0&&sW.kill(v,p4)}}s(nIt,"_unregisterEvents");function W4e(v,I){var T;return I?(Je(I)?T=[v].concat(I):T=[v,I],T=Ude("xx",T).ns[Qy](".")):T=v,T}s(W4e,"mergeEvtNamespace");function j4e(v,I,T,k,M){M===void 0&&(M=!1);var q=!1;if(v)try{var G=Ude(I,k);if(q=rIt(v,G,T,M),q&&sW.accept(v)){var ce={guid:eIt++,evtName:G,handler:T,capture:M};q4e(v,G.type)[bo](ce)}}catch{}return q}s(j4e,"eventOn");function iIt(v,I,T,k,M){if(M===void 0&&(M=!1),v)try{var q=Ude(I,k),G=!1;nIt(v,q,function(ce){return q.ns&&!T||ce.handler===T?(G=!0,!0):!1}),G||H4e(v,q,T,M)}catch{}}s(iIt,"eventOff");var G4e="sampleRate",qde="ProcessLegacy",V4e="http.method",Hde="https://dc.services.visualstudio.com",m4="/v2/track",rI="not_specified",z4e=tde({requestContextHeader:[0,"Request-Context"],requestContextTargetKey:[1,"appId"],requestContextAppIdFormat:[2,"appId=cid-v1:"],requestIdHeader:[3,"Request-Id"],traceParentHeader:[4,"traceparent"],traceStateHeader:[5,"tracestate"],sdkContextHeader:[6,"Sdk-Context"],sdkContextHeaderAppIdRequest:[7,"appId"],requestContextHeaderLowerCase:[8,"request-context"]}),aW="split",ki="length",$de="toLowerCase",y_="ingestionendpoint",uF="toString",K4e="removeItem",cW="message",oIt="count",Wde="stringify",jde="pathname",dF="match",nI="name",Xy="properties",Tv="measurements",lW="sizeInBytes",uW="typeName",fF="exceptions",pF="severityLevel",Gde="problemGroup",h4="parsedStack",dW="hasFullStack",fW="assembly",wv="fileName",g4="line",pW="aiDataContract",mW="duration";function Y4e(v,I,T){var k=I[ki],M=sIt(v,I);if(M[ki]!==k){for(var q=0,G=M;T[G]!==void 0;)q++,G=Ce(M,0,147)+lIt(q);M=G}return M}s(Y4e,"dataSanitizeKeyAndAddUniqueness");function sIt(v,I){var T;return I&&(I=io(Ft(I)),I[ki]>150&&(T=Ce(I,0,150),Ur(v,2,57,"name is too long.  It has been truncated to 150 characters.",{name:I},!0))),T||I}s(sIt,"dataSanitizeKey");function xd(v,I,T){T===void 0&&(T=1024);var k;return I&&(T=T||1024,I=io(Ft(I)),I[ki]>T&&(k=Ce(I,0,T),Ur(v,2,61,"string value is too long. It has been truncated to "+T+" characters.",{value:I},!0))),k||I}s(xd,"dataSanitizeString");function Vde(v,I){return X4e(v,I,2048,66)}s(Vde,"dataSanitizeUrl");function J4e(v,I){var T;return I&&I[ki]>32768&&(T=Ce(I,0,32768),Ur(v,2,56,"message is too long, it has been truncated to 32768 characters.",{message:I},!0)),T||I}s(J4e,"dataSanitizeMessage");function aIt(v,I){var T;if(I){var k=""+I;k[ki]>32768&&(T=Ce(k,0,32768),Ur(v,2,52,"exception is too long, it has been truncated to 32768 characters.",{exception:I},!0))}return T||I}s(aIt,"dataSanitizeException");function C_(v,I){if(I){var T={};le(I,function(k,M){if(Te(M)&&Lb())try{M=af()[Wde](M)}catch(q){Ur(v,2,49,"custom property is not valid",{exception:q},!0)}M=xd(v,M,8192),k=Y4e(v,k,T),T[k]=M}),I=T}return I}s(C_,"dataSanitizeProperties");function v_(v,I){if(I){var T={};le(I,function(k,M){k=Y4e(v,k,T),T[k]=M}),I=T}return I}s(v_,"dataSanitizeMeasurements");function cIt(v,I){return I&&X4e(v,I,128,69)[uF]()}s(cIt,"dataSanitizeId");function X4e(v,I,T,k){var M;return I&&(I=io(Ft(I)),I[ki]>T&&(M=Ce(I,0,T),Ur(v,2,k,"input is too long, it has been truncated to "+T+" characters.",{data:I},!0))),M||I}s(X4e,"dataSanitizeInput");function lIt(v){var I="00"+v;return Ie(I,I[ki]-3)}s(lIt,"dsPadNumber");var Z4e=Ic()||{},eDe=0,uIt=[null,null,null,null,null];function dIt(v){var I=eDe,T=uIt,k=T[I];return Z4e.createElement?T[I]||(k=T[I]=Z4e.createElement("a")):k={host:fIt(v,!0)},k.href=v,I++,I>=T[ki]&&(I=0),eDe=I,k}s(dIt,"urlParseUrl");function fIt(v,I){var T=pIt(v,I)||"";if(T){var k=T[dF](/(www\d{0,5}\.)?([^\/:]{1,256})(:\d{1,20})?/i);if(k!=null&&k[ki]>3&&Ae(k[2])&&k[2][ki]>0)return k[2]+(k[3]||"")}return T}s(fIt,"urlParseHost");function pIt(v,I){var T=null;if(v){var k=v[dF](/(\w{1,150}):\/\/([^\/:]{1,256})(:\d{1,20})?/i);if(k!=null&&k[ki]>2&&Ae(k[2])&&k[2][ki]>0&&(T=k[2]||"",I&&k[ki]>2)){var M=(k[1]||"")[$de](),q=k[3]||"";(M==="http"&&q===":80"||M==="https"&&q===":443")&&(q=""),T+=q}}return T}s(pIt,"urlParseFullHost");var mIt=[Hde+m4,"https://breeze.aimon.applicationinsights.io"+m4,"https://dc-int.services.visualstudio.com"+m4];function tDe(v){return wc(mIt,v[$de]())!==-1}s(tDe,"isInternalApplicationInsightsEndpoint");function hIt(v,I,T,k){var M,q=k,G=k;if(I&&I[ki]>0){var ce=dIt(I);if(M=ce.host,!q)if(ce[jde]!=null){var fe=ce.pathname[ki]===0?"/":ce[jde];fe.charAt(0)!=="/"&&(fe="/"+fe),G=ce[jde],q=xd(v,T?T+" "+fe:fe)}else q=xd(v,I)}else M=k,q=k;return{target:M,name:q,data:G}}s(hIt,"AjaxHelperParseDependencyPath");var zde=w5({LocalStorage:0,SessionStorage:1}),A4=void 0,rDe="";function nDe(v){try{if(oe(xi()))return null;var I=new Date()[uF](),T=Zo(v===zde.LocalStorage?"localStorage":"sessionStorage"),k=rDe+I;T.setItem(k,I);var M=T.getItem(k)!==I;if(T[K4e](k),!M)return T}catch{}return null}s(nDe,"_getVerifiedStorageObject");function Kde(){return iDe()?nDe(zde.SessionStorage):null}s(Kde,"_getSessionStorageObject");function gIt(v){rDe=v||""}s(gIt,"utlSetStoragePrefix");function iDe(v){return(v||A4===void 0)&&(A4=!!nDe(zde.SessionStorage)),A4}s(iDe,"utlCanUseSessionStorage");function AIt(v,I){var T=Kde();if(T!==null)try{return T.getItem(I)}catch(k){A4=!1,Ur(v,2,2,"Browser failed read of session storage. "+wl(k),{exception:Qt(k)})}return null}s(AIt,"utlGetSessionStorage");function yIt(v,I,T){var k=Kde();if(k!==null)try{return k.setItem(I,T),!0}catch(M){A4=!1,Ur(v,2,4,"Browser failed write to session storage. "+wl(M),{exception:Qt(M)})}return!1}s(yIt,"utlSetSessionStorage");function CIt(v,I){var T=Kde();if(T!==null)try{return T[K4e](I),!0}catch(k){A4=!1,Ur(v,2,6,"Browser failed removal of session storage item. "+wl(k),{exception:Qt(k)})}return!1}s(CIt,"utlRemoveSessionStorage");var vIt=";",xIt="=";function Yde(v){if(!v)return{};var I=v[aW](vIt),T=lL(I,function(M,q){var G=q[aW](xIt);if(G[ki]===2){var ce=G[0][$de](),fe=G[1];M[ce]=fe}return M},{});if(Tt(T)[ki]>0){if(T.endpointsuffix){var k=T.location?T.location+".":"";T[y_]=T[y_]||"https://"+k+"dc."+T.endpointsuffix}T[y_]=T[y_]||Hde,r$(T[y_],"/")&&(T[y_]=T[y_].slice(0,-1))}return T}s(Yde,"parseConnectionString");var EIt=function(){function v(I,T,k){var M=this,q=this;q.ver=1,q.sampleRate=100,q.tags={},q[nI]=xd(I,k)||rI,q.data=T,q.time=e_(new Date),q[pW]={time:1,iKey:1,name:1,sampleRate:s(function(){return M.sampleRate===100?4:1},"sampleRate"),tags:1,data:1}}return s(v,"Envelope"),v}(),y4=function(){function v(I,T,k,M){this.aiDataContract={ver:1,name:1,properties:0,measurements:0};var q=this;q.ver=2,q[nI]=xd(I,T)||rI,q[Xy]=C_(I,k),q[Tv]=v_(I,M)}return s(v,"Event"),v.envelopeType="Microsoft.ApplicationInsights.{0}.Event",v.dataType="EventData",v}(),bIt=58,IIt=/^\s{0,50}(from\s|at\s|Line\s{1,5}\d{1,10}\s{1,5}of|\w{1,50}@\w{1,80}|[^\(\s\n]+:[0-9\?]+(?::[0-9\?]+)?)/,TIt=/^(?:\s{0,50}at)?\s{0,50}([^\@\()\s]+)?\s{0,50}(?:\s|\@|\()\s{0,5}([^\(\s\n\]]+):([0-9\?]+):([0-9\?]+)\)?$/,wIt=/^(?:\s{0,50}at)?\s{0,50}([^\@\()\s]+)?\s{0,50}(?:\s|\@|\()\s{0,5}([^\(\s\n\]]+):([0-9\?]+)\)?$/,SIt=/^(?:\s{0,50}at)?\s{0,50}([^\@\()\s]+)?\s{0,50}(?:\s|\@|\()\s{0,5}([^\(\s\n\)\]]+)\)?$/,_It=/(?:^|\(|\s{0,10}[\w\)]+\@)?([^\(\n\s\]\)]+)(?:\:([0-9]+)(?:\:([0-9]+))?)?\)?(?:,|$)/,RIt=/([^\(\s\n]+):([0-9]+):([0-9]+)$/,kIt=/([^\(\s\n]+):([0-9]+)$/,oDe="<no_method>",C4="error",Mm="stack",Jde="stackDetails",sDe="errorSrc",Xde="message",aDe="description",cDe=[{re:TIt,len:5,m:1,fn:2,ln:3,col:4},{chk:DIt,pre:PIt,re:wIt,len:4,m:1,fn:2,ln:3},{re:SIt,len:3,m:1,fn:2,hdl:mDe},{re:_It,len:2,fn:1,hdl:mDe}];function PIt(v){return v.replace(/(\(anonymous\))/,"<anonymous>")}s(PIt,"_scrubAnonymous");function DIt(v){return Dg(v,"[native")<0}s(DIt,"_ignoreNative");function Zde(v,I){var T=v;return T&&!Ae(T)&&(JSON&&JSON[Wde]?(T=JSON[Wde](v),I&&(!T||T==="{}")&&(Oe(v[uF])?T=v[uF]():T=""+v)):T=""+v+" - (Missing JSON.stringify)"),T||""}s(Zde,"_stringify");function lDe(v,I){var T=v;return v&&(T&&!Ae(T)&&(T=v[Xde]||v[aDe]||T),T&&!Ae(T)&&(T=Zde(T,!0)),v.filename&&(T=T+" @"+(v.filename||"")+":"+(v.lineno||"?")+":"+(v.colno||"?"))),I&&I!=="String"&&I!=="Object"&&I!=="Error"&&Dg(T||"",I)===-1&&(T=I+": "+T),T||""}s(lDe,"_formatMessage");function BIt(v){try{if(Te(v))return"hasFullStack"in v&&"typeName"in v}catch{}return!1}s(BIt,"_isExceptionDetailsInternal");function NIt(v){try{if(Te(v))return"ver"in v&&"exceptions"in v&&"properties"in v}catch{}return!1}s(NIt,"_isExceptionInternal");function uDe(v){return v&&v.src&&Ae(v.src)&&v.obj&&Je(v.obj)}s(uDe,"_isStackDetails");function x_(v){var I=v||"";Ae(I)||(Ae(I[Mm])?I=I[Mm]:I=""+I);var T=I[aW](`
`);return{src:I,obj:T}}s(x_,"_convertStackObj");function MIt(v){for(var I=[],T=v[aW](`
`),k=0;k<T[ki];k++){var M=T[k];T[k+1]&&(M+="@"+T[k+1],k++),I.push(M)}return{src:v,obj:I}}s(MIt,"_getOperaStack");function dDe(v){var I=null;if(v)try{if(v[Mm])I=x_(v[Mm]);else if(v[C4]&&v[C4][Mm])I=x_(v[C4][Mm]);else if(v.exception&&v.exception[Mm])I=x_(v.exception[Mm]);else if(uDe(v))I=v;else if(uDe(v[Jde]))I=v[Jde];else if(Vs()&&Vs().opera&&v[Xde])I=MIt(v[cW]);else if(v.reason&&v.reason[Mm])I=x_(v.reason[Mm]);else if(Ae(v))I=x_(v);else{var T=v[Xde]||v[aDe]||"";Ae(v[sDe])&&(T&&(T+=`
`),T+=" from "+v[sDe]),T&&(I=x_(T))}}catch(k){I=x_(k)}return I||{src:"",obj:null}}s(dDe,"_getStackFromErrorObj");function LIt(v){var I="";return v&&(v.obj?I=v.obj.join(`
`):I=v.src||""),I}s(LIt,"_formatStackTrace");function FIt(v){var I,T=v.obj;if(T&&T[ki]>0){I=[];var k=0,M=!1,q=0;Yr(T,function(At){if(M||qIt(At)){var st=Ft(At);M=!0;var wt=HIt(st,k);wt&&(q+=wt[lW],I.push(wt),k++)}});var G=32*1024;if(q>G)for(var ce=0,fe=I[ki]-1,xe=0,Re=ce,Qe=fe;ce<fe;){var et=I[ce][lW],He=I[fe][lW];if(xe+=et+He,xe>G){var Ke=Qe-Re+1;I.splice(Re,Ke);break}Re=ce,Qe=fe,ce++,fe--}}return I}s(FIt,"_parseStack");function hW(v){var I="";if(v&&(I=v.typeName||v[nI]||"",!I))try{var T=/function (.{1,200})\(/,k=T.exec(v.constructor[uF]());I=k&&k[ki]>1?k[1]:""}catch{}return I}s(hW,"_getErrorType");function efe(v){if(v)try{if(!Ae(v)){var I=hW(v),T=Zde(v,!1);return(!T||T==="{}")&&(v[C4]&&(v=v[C4],I=hW(v)),T=Zde(v,!0)),Dg(T,I)!==0&&I!=="String"?I+":"+T:T}}catch{}return""+(v||"")}s(efe,"_formatErrorCode");var gW=function(){function v(I,T,k,M,q,G){this.aiDataContract={ver:1,exceptions:1,severityLevel:0,properties:0,measurements:0};var ce=this;ce.ver=2,NIt(T)?(ce[fF]=T[fF]||[],ce[Xy]=T[Xy],ce[Tv]=T[Tv],T[pF]&&(ce[pF]=T[pF]),T.id&&(ce.id=T.id,T[Xy].id=T.id),T[Gde]&&(ce[Gde]=T[Gde]),oe(T.isManual)||(ce.isManual=T.isManual)):(k||(k={}),G&&(k.id=G),ce[fF]=[fDe(I,T,k)],ce[Xy]=C_(I,k),ce[Tv]=v_(I,M),q&&(ce[pF]=q),G&&(ce.id=G))}return s(v,"Exception"),v.CreateAutoException=function(I,T,k,M,q,G,ce,fe){var xe=hW(q||G||I);return{message:lDe(I,xe),url:T,lineNumber:k,columnNumber:M,error:efe(q||G||I),evt:efe(G||I),typeName:xe,stackDetails:dDe(ce||q||G),errorSrc:fe}},v.CreateFromInterface=function(I,T,k,M){var q=T[fF]&&Rg(T[fF],function(ce){return UIt(I,ce)}),G=new v(I,Ng(Ng({},T),{exceptions:q}),k,M);return G},v.prototype.toInterface=function(){var I=this,T=I.exceptions,k=I.properties,M=I.measurements,q=I.severityLevel,G=I.problemGroup,ce=I.id,fe=I.isManual,xe=T instanceof Array&&Rg(T,function(Re){return Re.toInterface()})||void 0;return{ver:"4.0",exceptions:xe,severityLevel:q,properties:k,measurements:M,problemGroup:G,id:ce,isManual:fe}},v.CreateSimpleException=function(I,T,k,M,q,G){var ce;return{exceptions:[(ce={},ce[dW]=!0,ce.message=I,ce.stack=q,ce.typeName=T,ce)]}},v.envelopeType="Microsoft.ApplicationInsights.{0}.Exception",v.dataType="ExceptionData",v.formatError=efe,v}(),OIt=Zt({id:0,outerId:0,typeName:1,message:1,hasFullStack:0,stack:0,parsedStack:2});function QIt(){var v=this,I=Je(v[h4])&&Rg(v[h4],function(k){return WIt(k)}),T={id:v.id,outerId:v.outerId,typeName:v[uW],message:v[cW],hasFullStack:v[dW],stack:v[Mm],parsedStack:I||void 0};return T}s(QIt,"_toInterface");function fDe(v,I,T){var k,M,q,G,ce,fe,xe,Re;if(BIt(I))G=I[uW],ce=I[cW],xe=I[Mm],Re=I[h4]||[],fe=I[dW];else{var Qe=I,et=Qe&&Qe.evt;xt(Qe)||(Qe=Qe[C4]||et||Qe),G=xd(v,hW(Qe))||rI,ce=J4e(v,lDe(I||Qe,G))||rI;var He=I[Jde]||dDe(I);Re=FIt(He),Je(Re)&&Rg(Re,function(Ke){Ke[fW]=xd(v,Ke[fW]),Ke[wv]=xd(v,Ke[wv])}),xe=aIt(v,LIt(He)),fe=Je(Re)&&Re[ki]>0,T&&(T[uW]=T[uW]||G)}return k={},k[pW]=OIt,k.id=M,k.outerId=q,k.typeName=G,k.message=ce,k[dW]=fe,k.stack=xe,k.parsedStack=Re,k.toInterface=QIt,k}s(fDe,"_createExceptionDetails");function UIt(v,I){var T=Je(I[h4])&&Rg(I[h4],function(M){return $It(M)})||I[h4],k=fDe(v,Ng(Ng({},I),{parsedStack:T}));return k}s(UIt,"_createExDetailsFromInterface");function pDe(v,I){var T=I[dF](RIt);if(T&&T[ki]>=4)v[wv]=T[1],v[g4]=parseInt(T[2]);else{var k=I[dF](kIt);k&&k[ki]>=3?(v[wv]=k[1],v[g4]=parseInt(k[2])):v[wv]=I}}s(pDe,"_parseFilename");function mDe(v,I,T){var k=v[wv];I.fn&&T&&T[ki]>I.fn&&(I.ln&&T[ki]>I.ln?(k=io(T[I.fn]||""),v[g4]=parseInt(io(T[I.ln]||""))||0):k=io(T[I.fn]||"")),k&&pDe(v,k)}s(mDe,"_handleFilename");function qIt(v){var I=!1;if(v&&Ae(v)){var T=io(v);T&&(I=IIt.test(T))}return I}s(qIt,"_isStackFrame");var hDe=Zt({level:1,method:1,assembly:0,fileName:0,line:0});function HIt(v,I){var T,k;if(v&&Ae(v)&&io(v)){k=(T={},T[pW]=hDe,T.level=I,T.assembly=io(v),T.method=oDe,T.fileName="",T.line=0,T.sizeInBytes=0,T);for(var M=0;M<cDe[ki];){var q=cDe[M];if(q.chk&&!q.chk(v))break;q.pre&&(v=q.pre(v));var G=v[dF](q.re);if(G&&G[ki]>=q.len){q.m&&(k.method=io(G[q.m]||oDe)),q.hdl?q.hdl(k,q,G):q.fn&&(q.ln?(k[wv]=io(G[q.fn]||""),k[g4]=parseInt(io(G[q.ln]||""))||0):pDe(k,G[q.fn]||""));break}M++}}return gDe(k)}s(HIt,"_extractStackFrame");function $It(v){var I,T=(I={},I[pW]=hDe,I.level=v.level,I.method=v.method,I.assembly=v[fW],I.fileName=v[wv],I.line=v[g4],I.sizeInBytes=0,I);return gDe(T)}s($It,"_stackFrameFromInterface");function gDe(v){var I=bIt;return v&&(I+=v.method[ki],I+=v.assembly[ki],I+=v.fileName[ki],I+=v.level.toString()[ki],I+=v.line.toString()[ki],v[lW]=I),v}s(gDe,"_populateFrameSizeInBytes");function WIt(v){return{level:v.level,method:v.method,assembly:v[fW],fileName:v[wv],line:v[g4]}}s(WIt,"_parsedFrameToInterface");var jIt=function(){function v(){this.aiDataContract={name:1,kind:0,value:1,count:0,min:0,max:0,stdDev:0},this.kind=0}return s(v,"DataPoint"),v}(),mF=function(){function v(I,T,k,M,q,G,ce,fe,xe){this.aiDataContract={ver:1,metrics:1,properties:0};var Re=this;Re.ver=2;var Qe=new jIt;Qe[oIt]=M>0?M:void 0,Qe.max=isNaN(G)||G===null?void 0:G,Qe.min=isNaN(q)||q===null?void 0:q,Qe[nI]=xd(I,T)||rI,Qe.value=k,Qe.stdDev=isNaN(ce)||ce===null?void 0:ce,Re.metrics=[Qe],Re[Xy]=C_(I,fe),Re[Tv]=v_(I,xe)}return s(v,"Metric"),v.envelopeType="Microsoft.ApplicationInsights.{0}.Metric",v.dataType="MetricData",v}(),hF="";function ADe(v){(isNaN(v)||v<0)&&(v=0),v=zue(v);var I=hF+v%1e3,T=hF+ky(v/1e3)%60,k=hF+ky(v/(1e3*60))%60,M=hF+ky(v/(1e3*60*60))%24,q=ky(v/(1e3*60*60*24));return I=I[ki]===1?"00"+I:I[ki]===2?"0"+I:I,T=T[ki]<2?"0"+T:T,k=k[ki]<2?"0"+k:k,M=M[ki]<2?"0"+M:M,(q>0?q+".":hF)+M+":"+k+":"+T+"."+I}s(ADe,"msToTimeSpan");var AW=function(){function v(I,T,k,M,q,G,ce){this.aiDataContract={ver:1,name:0,url:0,duration:0,properties:0,measurements:0,id:0};var fe=this;fe.ver=2,fe.id=cIt(I,ce),fe.url=Vde(I,k),fe[nI]=xd(I,T)||rI,isNaN(M)||(fe[mW]=ADe(M)),fe[Xy]=C_(I,q),fe[Tv]=v_(I,G)}return s(v,"PageView"),v.envelopeType="Microsoft.ApplicationInsights.{0}.Pageview",v.dataType="PageviewData",v}(),yW=function(){function v(I,T,k,M,q,G,ce,fe,xe,Re,Qe,et){xe===void 0&&(xe="Ajax"),this.aiDataContract={id:1,ver:1,name:0,resultCode:0,duration:0,success:0,data:0,target:0,type:0,properties:0,measurements:0,kind:0,value:0,count:0,min:0,max:0,stdDev:0,dependencyKind:0,dependencySource:0,commandName:0,dependencyTypeName:0};var He=this;He.ver=2,He.id=T,He[mW]=ADe(q),He.success=G,He.resultCode=ce+"",He.type=xd(I,xe);var Ke=hIt(I,k,fe,M);He.data=Vde(I,M)||Ke.data,He.target=xd(I,Ke.target),Re&&(He.target="".concat(He.target," | ").concat(Re)),He[nI]=xd(I,Ke[nI]),He[Xy]=C_(I,Qe),He[Tv]=v_(I,et)}return s(v,"RemoteDependencyData"),v.envelopeType="Microsoft.ApplicationInsights.{0}.RemoteDependency",v.dataType="RemoteDependencyData",v}(),CW=function(){function v(I,T,k,M,q){this.aiDataContract={ver:1,message:1,severityLevel:0,properties:0};var G=this;G.ver=2,T=T||rI,G[cW]=J4e(I,T),G[Xy]=C_(I,M),G[Tv]=v_(I,q),k&&(G[pF]=k)}return s(v,"Trace"),v.envelopeType="Microsoft.ApplicationInsights.{0}.Message",v.dataType="MessageData",v}(),vW=function(){function v(I,T,k,M,q,G,ce){this.aiDataContract={ver:1,name:0,url:0,duration:0,perfTotal:0,networkConnect:0,sentRequest:0,receivedResponse:0,domProcessing:0,properties:0,measurements:0};var fe=this;fe.ver=2,fe.url=Vde(I,k),fe[nI]=xd(I,T)||rI,fe[Xy]=C_(I,q),fe[Tv]=v_(I,G),ce&&(fe.domProcessing=ce.domProcessing,fe[mW]=ce[mW],fe.networkConnect=ce.networkConnect,fe.perfTotal=ce.perfTotal,fe.receivedResponse=ce.receivedResponse,fe.sentRequest=ce.sentRequest)}return s(v,"PageViewPerformance"),v.envelopeType="Microsoft.ApplicationInsights.{0}.PageviewPerformance",v.dataType="PageviewPerformanceData",v}(),E_=function(){function v(I,T){this.aiDataContract={baseType:1,baseData:1},this.baseType=I,this.baseData=T}return s(v,"Data"),v}(),GIt=w5({Verbose:0,Information:1,Warning:2,Error:3,Critical:4});function iI(v){var I="ai."+v+".";return function(T){return I+T}}s(iI,"_aiNameFunc");var gF=iI("application"),_l=iI("device"),xW=iI("location"),v4=iI("operation"),tfe=iI("session"),oI=iI("user"),b_=iI("cloud"),AF=iI("internal"),yDe=function(v){zS(I,v);function I(){return v.call(this)||this}return s(I,"ContextTagKeys"),I}(ude({applicationVersion:gF("ver"),applicationBuild:gF("build"),applicationTypeId:gF("typeId"),applicationId:gF("applicationId"),applicationLayer:gF("layer"),deviceId:_l("id"),deviceIp:_l("ip"),deviceLanguage:_l("language"),deviceLocale:_l("locale"),deviceModel:_l("model"),deviceFriendlyName:_l("friendlyName"),deviceNetwork:_l("network"),deviceNetworkName:_l("networkName"),deviceOEMName:_l("oemName"),deviceOS:_l("os"),deviceOSVersion:_l("osVersion"),deviceRoleInstance:_l("roleInstance"),deviceRoleName:_l("roleName"),deviceScreenResolution:_l("screenResolution"),deviceType:_l("type"),deviceMachineName:_l("machineName"),deviceVMName:_l("vmName"),deviceBrowser:_l("browser"),deviceBrowserVersion:_l("browserVersion"),locationIp:xW("ip"),locationCountry:xW("country"),locationProvince:xW("province"),locationCity:xW("city"),operationId:v4("id"),operationName:v4("name"),operationParentId:v4("parentId"),operationRootId:v4("rootId"),operationSyntheticSource:v4("syntheticSource"),operationCorrelationVector:v4("correlationVector"),sessionId:tfe("id"),sessionIsFirst:tfe("isFirst"),sessionIsNew:tfe("isNew"),userAccountAcquisitionDate:oI("accountAcquisitionDate"),userAccountId:oI("accountId"),userAgent:oI("userAgent"),userId:oI("id"),userStoreRegion:oI("storeRegion"),userAuthUserId:oI("authUserId"),userAnonymousUserAcquisitionDate:oI("anonUserAcquisitionDate"),userAuthenticatedUserAcquisitionDate:oI("authUserAcquisitionDate"),cloudName:b_("name"),cloudRole:b_("role"),cloudRoleVer:b_("roleVer"),cloudRoleInstance:b_("roleInstance"),cloudEnvironment:b_("environment"),cloudLocation:b_("location"),cloudDeploymentUnit:b_("deploymentUnit"),internalNodeName:AF("nodeName"),internalSdkVersion:AF("sdkVersion"),internalAgentVersion:AF("agentVersion"),internalSnippet:AF("snippet"),internalSdkSrc:AF("sdkSrc")})),zl=new yDe;function CDe(v,I){iIt(v,null,null,I)}s(CDe,"_disableEvents");function VIt(v){var I=Ic(),T=Tc(),k=!1,M=[],q=1;T&&!oe(T.onLine)&&!T.onLine&&(q=2);var G=0,ce=et(),fe=W4e(qg("OfflineListener"),v);try{if(Re(Vs())&&(k=!0),I){var xe=I.body||I;xe.ononline&&Re(xe)&&(k=!0)}}catch{k=!1}function Re(sr){var kr=!1;return sr&&(kr=j4e(sr,"online",At,fe),kr&&j4e(sr,"offline",st,fe)),kr}s(Re,"_enableEvents");function Qe(){return ce}s(Qe,"_isOnline");function et(){return!(G===2||q===2)}s(et,"calCurrentState");function He(){var sr=et();ce!==sr&&(ce=sr,Yr(M,function(kr){var oi={isOnline:ce,rState:q,uState:G};try{kr(oi)}catch{}}))}s(He,"listnerNoticeCheck");function Ke(sr){G=sr,He()}s(Ke,"setOnlineState");function At(){q=1,He()}s(At,"_setOnline");function st(){q=2,He()}s(st,"_setOffline");function wt(){var sr=Vs();if(sr&&k){if(CDe(sr,fe),I){var kr=I.body||I;W(kr.ononline)||CDe(kr,fe)}k=!1}}s(wt,"_unload");function $t(sr){return M.push(sr),{rm:s(function(){var kr=M.indexOf(sr);if(kr>-1)return M.splice(kr,1)},"rm")}}return s($t,"addListener"),{isOnline:Qe,isListening:s(function(){return k},"isListening"),unload:wt,addListener:$t,setOnlineState:Ke}}s(VIt,"createOfflineListener");var zIt="AppInsightsChannelPlugin",I_="duration",Nu="tags",rfe="deviceType",u0="data",Sv="name",yF="traceID",qi="length",CF="stringify",T_="measurements",Zy="dataType",w_="envelopeType",S_="toString",__="enqueue",R_="count",_v="push",nfe="emitLineDelimitedJson",x4="clear",EW="markAsSent",vF="clearSent",ife="bufferOverride",xF="BUFFER_KEY",sI="SENT_BUFFER_KEY",E4="concat",EF="MAX_BUFFER_SIZE",bF="triggerSend",Ed="diagLog",ofe="initialize",IF="_sender",TF="endpointUrl",wF="instrumentationKey",sfe="customHeaders",vDe="maxBatchSizeInBytes",afe="onunloadDisableBeacon",cfe="isBeaconApiDisabled",xDe="alwaysUseXhrOverride",EDe="enableSessionStorageBuffer",eC="_buffer",bDe="onunloadDisableFetch",IDe="disableSendBeaconSplit",bW="getSenderInst",k_="_onError",lfe="_onPartialSuccess",IW="_onSuccess",ufe="itemsReceived",dfe="itemsAccepted",ffe="baseType",TW="sampleRate",KIt="getHashCodeScore",pfe="baseType",xa="baseData",Kl="properties",TDe="true";function kc(v,I,T){return Hy(v,I,T,ue)}s(kc,"_setValueIf");function YIt(v,I,T){var k=T[Nu]=T[Nu]||{},M=I.ext=I.ext||{},q=I[Nu]=I[Nu]||[],G=M.user;G&&(kc(k,zl.userAuthUserId,G.authId),kc(k,zl.userId,G.id||G.localId));var ce=M.app;ce&&kc(k,zl.sessionId,ce.sesId);var fe=M.device;fe&&(kc(k,zl.deviceId,fe.id||fe.localId),kc(k,zl[rfe],fe.deviceClass),kc(k,zl.deviceIp,fe.ip),kc(k,zl.deviceModel,fe.model),kc(k,zl[rfe],fe[rfe]));var xe=I.ext.web;if(xe){kc(k,zl.deviceLanguage,xe.browserLang),kc(k,zl.deviceBrowserVersion,xe.browserVer),kc(k,zl.deviceBrowser,xe.browser);var Re=T[u0]=T[u0]||{},Qe=Re[xa]=Re[xa]||{},et=Qe[Kl]=Qe[Kl]||{};kc(et,"domain",xe.domain),kc(et,"isManual",xe.isManual?TDe:null),kc(et,"screenRes",xe.screenRes),kc(et,"userConsent",xe.userConsent?TDe:null)}var He=M.os;He&&(kc(k,zl.deviceOS,He[Sv]),kc(k,zl.deviceOSVersion,He.osVer));var Ke=M.trace;Ke&&(kc(k,zl.operationParentId,Ke.parentID),kc(k,zl.operationName,xd(v,Ke[Sv])),kc(k,zl.operationId,Ke[yF]));for(var At={},st=q[qi]-1;st>=0;st--){var wt=q[st];le(wt,function(sr,kr){At[sr]=kr}),q.splice(st,1)}le(q,function(sr,kr){At[sr]=kr});var $t=Ng(Ng({},k),At);$t[zl.internalSdkVersion]||($t[zl.internalSdkVersion]=xd(v,"javascript:".concat(JIt.Version),64)),T[Nu]=LL($t)}s(YIt,"_extractPartAExtensions");function aI(v,I,T){oe(v)||le(v,function(k,M){lt(M)?T[k]=M:Ae(M)?I[k]=M:Lb()&&(I[k]=af()[CF](M))})}s(aI,"_extractPropsAndMeasurements");function P_(v,I){oe(v)||le(v,function(T,k){v[T]=k||I})}s(P_,"_convertPropsUndefinedToCustomDefinedValue");function D_(v,I,T,k){var M=new EIt(v,k,I);kc(M,"sampleRate",T[G4e]),(T[xa]||{}).startTime&&(M.time=e_(T[xa].startTime)),M.iKey=T.iKey;var q=T.iKey.replace(/-/g,"");return M[Sv]=M[Sv].replace("{0}",q),YIt(v,T,M),T[Nu]=T[Nu]||[],LL(M)}s(D_,"_createEnvelope");function B_(v,I){oe(I[xa])&&Ur(v,1,46,"telemetryItem.baseData cannot be null.")}s(B_,"EnvelopeCreatorInit");var JIt={Version:"3.3.6"};function XIt(v,I,T){B_(v,I);var k=I[xa][T_]||{},M=I[xa][Kl]||{};aI(I[u0],M,k),oe(T)||P_(M,T);var q=I[xa];if(oe(q))return i4(v,"Invalid input for dependency data"),null;var G=q[Kl]&&q[Kl][V4e]?q[Kl][V4e]:"GET",ce=new yW(v,q.id,q.target,q[Sv],q[I_],q.success,q.responseCode,G,q.type,q.correlationContext,M,k),fe=new E_(yW[Zy],ce);return D_(v,yW[w_],I,fe)}s(XIt,"DependencyEnvelopeCreator");function wDe(v,I,T){B_(v,I);var k={},M={};I[pfe]!==y4[Zy]&&(k.baseTypeSource=I[pfe]),I[pfe]===y4[Zy]?(k=I[xa][Kl]||{},M=I[xa][T_]||{}):I[xa]&&aI(I[xa],k,M),aI(I[u0],k,M),oe(T)||P_(k,T);var q=I[xa][Sv],G=new y4(v,q,k,M),ce=new E_(y4[Zy],G);return D_(v,y4[w_],I,ce)}s(wDe,"EventEnvelopeCreator");function ZIt(v,I,T){B_(v,I);var k=I[xa][T_]||{},M=I[xa][Kl]||{};aI(I[u0],M,k),oe(T)||P_(M,T);var q=I[xa],G=gW.CreateFromInterface(v,q,M,k),ce=new E_(gW[Zy],G);return D_(v,gW[w_],I,ce)}s(ZIt,"ExceptionEnvelopeCreator");function eTt(v,I,T){B_(v,I);var k=I[xa],M=k[Kl]||{},q=k[T_]||{};aI(I[u0],M,q),oe(T)||P_(M,T);var G=new mF(v,k[Sv],k.average,k.sampleCount,k.min,k.max,k.stdDev,M,q),ce=new E_(mF[Zy],G);return D_(v,mF[w_],I,ce)}s(eTt,"MetricEnvelopeCreator");function tTt(v,I,T){B_(v,I);var k,M=I[xa];!oe(M)&&!oe(M[Kl])&&!oe(M[Kl][I_])?(k=M[Kl][I_],delete M[Kl][I_]):!oe(I[u0])&&!oe(I[u0][I_])&&(k=I[u0][I_],delete I[u0][I_]);var q=I[xa],G;((I.ext||{}).trace||{})[yF]&&(G=I.ext.trace[yF]);var ce=q.id||G,fe=q[Sv],xe=q.uri,Re=q[Kl]||{},Qe=q[T_]||{};if(oe(q.refUri)||(Re.refUri=q.refUri),oe(q.pageType)||(Re.pageType=q.pageType),oe(q.isLoggedIn)||(Re.isLoggedIn=q.isLoggedIn[S_]()),!oe(q[Kl])){var et=q[Kl];le(et,function(At,st){Re[At]=st})}aI(I[u0],Re,Qe),oe(T)||P_(Re,T);var He=new AW(v,fe,xe,k,Re,Qe,ce),Ke=new E_(AW[Zy],He);return D_(v,AW[w_],I,Ke)}s(tTt,"PageViewEnvelopeCreator");function rTt(v,I,T){B_(v,I);var k=I[xa],M=k[Sv],q=k.uri||k.url,G=k[Kl]||{},ce=k[T_]||{};aI(I[u0],G,ce),oe(T)||P_(G,T);var fe=new vW(v,M,q,void 0,G,ce,k),xe=new E_(vW[Zy],fe);return D_(v,vW[w_],I,xe)}s(rTt,"PageViewPerformanceEnvelopeCreator");function nTt(v,I,T){B_(v,I);var k=I[xa].message,M=I[xa].severityLevel,q=I[xa][Kl]||{},G=I[xa][T_]||{};aI(I[u0],q,G),oe(T)||P_(q,T);var ce=new CW(v,k,M,q,G),fe=new E_(CW[Zy],ce);return D_(v,CW[w_],I,fe)}s(nTt,"TraceEnvelopeCreator");var SDe=function(){function v(I,T){var k=[],M=!1,q=T.maxRetryCnt;this._get=function(){return k},this._set=function(G){return k=G,k},Du(v,this,function(G){G[__]=function(ce){if(G[R_]()>=T.eventsLimitInMem){M||(Ur(I,2,105,"Maximum in-memory buffer size reached: "+G[R_](),!0),M=!0);return}ce.cnt=ce.cnt||0,!(!oe(q)&&ce.cnt>q)&&k[_v](ce)},G[R_]=function(){return k[qi]},G.size=function(){for(var ce=k[qi],fe=0;fe<k[qi];fe++)ce+=k[fe].item[qi];return T[nfe]||(ce+=2),ce},G[x4]=function(){k=[],M=!1},G.getItems=function(){return k.slice(0)},G.batchPayloads=function(ce){if(ce&&ce[qi]>0){var fe=[];Yr(ce,function(Re){fe[_v](Re.item)});var xe=T[nfe]?fe.join(`
`):"["+fe.join(",")+"]";return xe}return null},G.createNew=function(ce,fe,xe){var Re=k.slice(0);ce=ce||I,fe=fe||{};var Qe=xe?new _De(ce,fe):new mfe(ce,fe);return Yr(Re,function(et){Qe[__](et)}),Qe}})}return s(v,"BaseSendBuffer"),v.__ieDyn=1,v}(),mfe=function(v){zS(I,v);function I(T,k){var M=v.call(this,T,k)||this;return Du(I,M,function(q,G){q[EW]=function(ce){G[x4]()},q[vF]=function(ce){}}),M}return s(I,"ArraySendBuffer"),I.__ieDyn=1,I}(SDe),iTt=["AI_buffer","AI_sentBuffer"],_De=function(v){zS(I,v);function I(k,M){var q=v.call(this,k,M)||this,G=!1,ce=M?.namePrefix,fe=M[ife]||{getItem:AIt,setItem:yIt},xe=fe.getItem,Re=fe.setItem,Qe=M.maxRetryCnt;return Du(I,q,function(et,He){var Ke=kr(I[xF]),At=kr(I[sI]),st=ji(),wt=At[E4](st),$t=et._set(Ke[E4](wt));$t[qi]>I[EF]&&($t[qi]=I[EF]),Wi(I[sI],[]),Wi(I[xF],$t),et[__]=function(wn){if(et[R_]()>=I[EF]){G||(Ur(k,2,67,"Maximum buffer size reached: "+et[R_](),!0),G=!0);return}wn.cnt=wn.cnt||0,!(!oe(Qe)&&wn.cnt>Qe)&&(He[__](wn),Wi(I[xF],et._get()))},et[x4]=function(){He[x4](),Wi(I[xF],et._get()),Wi(I[sI],[]),G=!1},et[EW]=function(wn){Wi(I[xF],et._set(sr(wn,et._get())));var rn=kr(I[sI]);rn instanceof Array&&wn instanceof Array&&(rn=rn[E4](wn),rn[qi]>I[EF]&&(Ur(k,1,67,"Sent buffer reached its maximum size: "+rn[qi],!0),rn[qi]=I[EF]),Wi(I[sI],rn))},et[vF]=function(wn){var rn=kr(I[sI]);rn=sr(wn,rn),Wi(I[sI],rn)},et.createNew=function(wn,rn,Gi){Gi=!!Gi;var Ea=et._get().slice(0),Ts=kr(I[sI]).slice(0);wn=wn||k,rn=rn||{},et[x4]();var Wt=Gi?new I(wn,rn):new mfe(wn,rn);return Yr(Ea,function(nn){Wt[__](nn)}),Gi&&Wt[EW](Ts),Wt};function sr(wn,rn){var Gi=[],Ea=[];return Yr(wn,function(Ts){Ea[_v](Ts.item)}),Yr(rn,function(Ts){!Oe(Ts)&&wc(Ea,Ts.item)===-1&&Gi[_v](Ts)}),Gi}s(sr,"_removePayloadsFromBuffer");function kr(wn){var rn=wn;return rn=ce?ce+"_"+rn:rn,oi(rn)}s(kr,"_getBuffer");function oi(wn){try{var rn=xe(k,wn);if(rn){var Gi=af().parse(rn);if(Ae(Gi)&&(Gi=af().parse(Gi)),Gi&&Je(Gi))return Gi}}catch(Ea){Ur(k,1,42," storage key: "+wn+", "+wl(Ea),{exception:Qt(Ea)})}return[]}s(oi,"_getBufferBase");function Wi(wn,rn){var Gi=wn;try{Gi=ce?ce+"_"+Gi:Gi;var Ea=JSON[CF](rn);Re(k,Gi,Ea)}catch(Ts){Re(k,Gi,JSON[CF]([])),Ur(k,2,41," storage key: "+Gi+", "+wl(Ts)+". Buffer cleared",{exception:Qt(Ts)})}}s(Wi,"_setBuffer");function ji(){var wn=[];try{return Yr(iTt,function(rn){var Gi=zo(rn);if(wn=wn[E4](Gi),ce){var Ea=ce+"_"+rn,Ts=zo(Ea);wn=wn[E4](Ts)}}),wn}catch(rn){Ur(k,2,41,"Transfer events from previous buffers: "+wl(rn)+". previous Buffer items can not be removed",{exception:Qt(rn)})}return[]}s(ji,"_getPreviousEvents");function zo(wn){try{var rn=oi(wn),Gi=[];return Yr(rn,function(Ea){var Ts={item:Ea,cnt:0};Gi[_v](Ts)}),CIt(k,wn),Gi}catch{}return[]}s(zo,"_getItemsFromPreviousKey")}),q}s(I,"SessionStorageSendBuffer");var T;return T=I,I.VERSION="_1",I.BUFFER_KEY="AI_buffer"+T.VERSION,I.SENT_BUFFER_KEY="AI_sentBuffer"+T.VERSION,I.MAX_BUFFER_SIZE=2e3,I}(SDe),oTt=function(){function v(I){Du(v,this,function(T){T.serialize=function(G){var ce=k(G,"root");try{return af()[CF](ce)}catch(fe){Ur(I,1,48,fe&&Oe(fe[S_])?fe[S_]():"Error serializing object",null,!0)}};function k(G,ce){var fe="__aiCircularRefCheck",xe={};if(!G)return Ur(I,1,48,"cannot serialize object because it is null or undefined",{name:ce},!0),xe;if(G[fe])return Ur(I,2,50,"Circular reference detected while serializing object",{name:ce},!0),xe;if(!G.aiDataContract){if(ce==="measurements")xe=q(G,"number",ce);else if(ce==="properties")xe=q(G,"string",ce);else if(ce==="tags")xe=q(G,"string",ce);else if(Je(G))xe=M(G,ce);else{Ur(I,2,49,"Attempting to serialize an object which does not implement ISerializable",{name:ce},!0);try{af()[CF](G),xe=G}catch(Re){Ur(I,1,48,Re&&Oe(Re[S_])?Re[S_]():"Error serializing object",null,!0)}}return xe}return G[fe]=!0,le(G.aiDataContract,function(Re,Qe){var et=Oe(Qe)?Qe()&1:Qe&1,He=Oe(Qe)?Qe()&4:Qe&4,Ke=Qe&2,At=G[Re]!==void 0,st=Te(G[Re])&&G[Re]!==null;if(et&&!At&&!Ke)Ur(I,1,24,"Missing required field specification. The field is required but not present on source",{field:Re,name:ce});else if(!He){var wt=void 0;st?Ke?wt=M(G[Re],Re):wt=k(G[Re],Re):wt=G[Re],wt!==void 0&&(xe[Re]=wt)}}),delete G[fe],xe}s(k,"_serializeObject");function M(G,ce){var fe;if(G)if(!Je(G))Ur(I,1,54,`This field was specified as an array in the contract but the item is not an array.\r
`,{name:ce},!0);else{fe=[];for(var xe=0;xe<G[qi];xe++){var Re=G[xe],Qe=k(Re,ce+"["+xe+"]");fe[_v](Qe)}}return fe}s(M,"_serializeArray");function q(G,ce,fe){var xe;return G&&(xe={},le(G,function(Re,Qe){if(ce==="string")Qe===void 0?xe[Re]="undefined":Qe===null?xe[Re]="null":Qe[S_]?xe[Re]=Qe[S_]():xe[Re]="invalid field: toString() is not defined.";else if(ce==="number")if(Qe===void 0)xe[Re]="undefined";else if(Qe===null)xe[Re]="null";else{var et=parseFloat(Qe);xe[Re]=et}else xe[Re]="invalid field: "+fe+" is of unknown type.",Ur(I,1,xe[Re],null,!0)})),xe}s(q,"_serializeStringMap")})}return s(v,"Serializer"),v.__ieDyn=1,v}(),sTt=8,aTt=function(){function v(){}return s(v,"HashCodeScoreGenerator"),v.prototype.getHashCodeScore=function(I){var T=this.getHashCode(I)/v.INT_MAX_VALUE;return T*100},v.prototype.getHashCode=function(I){if(I==="")return 0;for(;I[qi]<sTt;)I=I[E4](I);for(var T=5381,k=0;k<I[qi];++k)T=(T<<5)+T+I.charCodeAt(k),T=T&T;return Math.abs(T)},v.INT_MAX_VALUE=2147483647,v}(),cTt=function(){function v(){var I=this,T=new aTt,k=new yDe;I.getSamplingScore=function(M){var q=0;return M[Nu]&&M[Nu][k.userId]?q=T.getHashCodeScore(M[Nu][k.userId]):M.ext&&M.ext.user&&M.ext.user.id?q=T[KIt](M.ext.user.id):M[Nu]&&M[Nu][k.operationId]?q=T.getHashCodeScore(M[Nu][k.operationId]):M.ext&&M.ext.telemetryTrace&&M.ext.telemetryTrace[yF]?q=T.getHashCodeScore(M.ext.telemetryTrace[yF]):q=Math.random()*100,q}}return s(v,"SamplingScoreGenerator"),v}(),lTt=function(){function v(I,T){this.INT_MAX_VALUE=2147483647;var k=T||d_(null);(I>100||I<0)&&(k.throwInternal(2,58,"Sampling rate is out of range (0..100). Sampling will be disabled, you may be sending too much data which may affect your AI service level.",{samplingRate:I},!0),I=100),this[TW]=I,this.samplingScoreGenerator=new cTt}return s(v,"Sample"),v.prototype.isSampledIn=function(I){var T=this[TW],k=!1;return T==null||T>=100||I.baseType===mF[Zy]?!0:(k=this.samplingScoreGenerator.getSamplingScore(I)<T,k)},v}(),zs,Rv,tC=void 0,RDe="",uTt=65e3;function kDe(v){try{return v.responseText}catch{}return null}s(kDe,"_getResponseText");function dTt(v){return v&&v.sendPOST}s(dTt,"isOverrideFn");var PDe=or((zs={endpointUrl:YL(ue,Hde+m4)},zs[nfe]=Dm(),zs.maxBatchInterval=15e3,zs[vDe]=102400,zs.disableTelemetry=Dm(),zs[EDe]=Dm(!0),zs.isRetryDisabled=Dm(),zs[cfe]=Dm(!0),zs[IDe]=Dm(!0),zs.disableXhr=Dm(),zs[bDe]=Dm(),zs[afe]=Dm(),zs[wF]=tC,zs.namePrefix=tC,zs.samplingPercentage=YL(fTt,100),zs[sfe]=tC,zs.convertUndefined=tC,zs.eventsLimitInMem=1e4,zs[ife]=!1,zs.httpXHROverride={isVal:dTt,v:tC},zs[xDe]=Dm(),zs.transports=tC,zs.retryCodes=tC,zs.maxRetryCnt={isVal:lt,v:10},zs));function fTt(v){return!isNaN(v)&&v>0&&v<=100}s(fTt,"_chkSampling");var pTt=(Rv={},Rv[y4.dataType]=wDe,Rv[CW.dataType]=nTt,Rv[AW.dataType]=tTt,Rv[vW.dataType]=rTt,Rv[gW.dataType]=ZIt,Rv[mF.dataType]=eTt,Rv[yW.dataType]=XIt,Rv),DDe=function(v){zS(I,v);function I(){var T=v.call(this)||this;T.priority=1001,T.identifier=zIt;var k,M,q,G,ce,fe,xe,Re=0,Qe,et,He,Ke,At,st,wt,$t,sr,kr,oi,Wi,ji,zo,wn,rn,Gi,Ea,Ts,Wt,nn,Fo,Dt,Un,Wa,Ko,Yl;return Du(I,T,function(ft,Yc){NDe(),ft.pause=function(){dI(),q=!0},ft.resume=function(){q&&(q=!1,M=null,ss(),w4())},ft.flush=function(Ve,It,pr){if(Ve===void 0&&(Ve=!0),!q){dI();try{return ft[bF](Ve,null,pr||1)}catch(Gr){Ur(ft[Ed](),1,22,"flush failed, telemetry will not be collected: "+wl(Gr),{exception:Qt(Gr)})}}},ft.onunloadFlush=function(){if(!q)if(wt||Wt)try{return ft[bF](!0,tp,2)}catch(Ve){Ur(ft[Ed](),1,20,"failed to flush with beacon sender on page unload, telemetry will not be collected: "+wl(Ve),{exception:Qt(Ve)})}else ft.flush(!1)},ft.addHeader=function(Ve,It){xe[Ve]=It},ft[ofe]=function(Ve,It,pr,Gr){ft.isInitialized()&&Ur(ft[Ed](),1,28,"Sender is already initialized"),Yc[ofe](Ve,It,pr,Gr);var Vn=ft.identifier;ce=new oTt(It.logger),k=0,M=null,ft[IF]=null,fe=0;var kn=ft[Ed]();He=W4e(qg("Sender"),It.evtNamespace&&It.evtNamespace()),et=VIt(He),ft._addHook(Hg(Ve,function(Io){var Pc=Io.cfg;Pc.storagePrefix&&gIt(Pc.storagePrefix);var d0=Zb(null,Pc,It),Si=d0.getExtCfg(Vn,PDe),MDe=Si[TF];if(Ke&&MDe===Ke){var Afe=Pc[TF];Afe&&Afe!==MDe&&(Si[TF]=Afe)}gt(Si[wF])&&(Si[wF]=Pc[wF]),je(ft,"_senderConfig",{g:s(function(){return Si},"g")}),At!==Si[TF]&&(Ke=At=Si[TF]),It.activeStatus()===My.PENDING?ft.pause():It.activeStatus()===My.ACTIVE&&ft.resume(),kr&&kr!==Si[sfe]&&Yr(kr,function(Lu){delete xe[Lu.header]}),st=Si[vDe],wt=(Si[afe]===!1||Si[cfe]===!1)&&Wy(),$t=Si[afe]===!1&&Wy(),sr=Si[cfe]===!1&&Wy(),Wt=Si[xDe],nn=!!Si.disableXhr,Yl=Si.retryCodes;var yfe=Si[ife],S4=!!Si[EDe]&&(!!yfe||iDe()),LDe=Si.namePrefix,ATt=S4!==rn||S4&&Ea!==LDe||S4&&Gi!==yfe;if(ft[eC]){if(ATt)try{ft[eC]=ft[eC].createNew(kn,Si,S4)}catch(Lu){Ur(ft[Ed](),1,12,"failed to transfer telemetry to different buffer storage, telemetry will be lost: "+wl(Lu),{exception:Qt(Lu)})}ss()}else ft[eC]=S4?new _De(kn,Si):new mfe(kn,Si);Ea=LDe,rn=S4,Gi=yfe,Fo=!Si[bDe]&&s_(!0),Wa=!!Si[IDe],ft._sample=new lTt(Si.samplingPercentage,kn),Wi=Si[wF],!gt(Wi)&&!BDe(Wi,Pc)&&Ur(kn,1,100,"Invalid Instrumentation key "+Wi),kr=Si[sfe],Ae(Ke)&&!tDe(Ke)&&kr&&kr[qi]>0?Yr(kr,function(Lu){T.addHeader(Lu.header,Lu.value)}):kr=null,Ts=Si.enableSendPromise;var FDe=Jl();Ko?Ko.SetConfig(FDe):(Ko=new Kc,Ko[ofe](FDe,kn));var RW=Si.httpXHROverride,kW=null,kF=null,yTt=I$([3,1,2],Si.transports);kW=Ko&&Ko[bW](yTt,!1);var Cfe=Ko&&Ko.getFallbackInst();Dt=s(function(Lu,N_){return Xr(Cfe,Lu,N_)},"_xhrSend"),Un=s(function(Lu,N_){return Xr(Cfe,Lu,N_,!1)},"_fallbackSend"),kW=Wt?RW:kW||RW||Cfe,ft[IF]=function(Lu,N_){return Xr(kW,Lu,N_)},Fo&&(Qe=T4);var vfe=I$([3,1],Si.unloadTransports);Fo||(vfe=vfe.filter(function(Lu){return Lu!==2})),kF=Ko&&Ko[bW](vfe,!0),kF=Wt?RW:kF||RW,(Wt||Si.unloadTransports||!Qe)&&kF&&(Qe=s(function(Lu,N_){return Xr(kF,Lu,N_)},"_syncUnloadSender")),Qe||(Qe=Dt),oi=Si.disableTelemetry,ji=Si.convertUndefined||tC,zo=Si.isRetryDisabled,wn=Si.maxBatchInterval}))},ft.processTelemetry=function(Ve,It){It=ft._getTelCtx(It);var pr=It[Ed]();try{var Gr=jg(Ve,pr);if(!Gr)return;var Vn=uI(Ve,pr);if(!Vn)return;var kn=ce.serialize(Vn),Io=ft[eC];ss(kn);var Pc={item:kn,cnt:0};Io[__](Pc),w4()}catch(d0){Ur(pr,2,12,"Failed adding telemetry to the sender's buffer, some telemetry will be lost: "+wl(d0),{exception:Qt(d0)})}ft.processNext(Ve,It)},ft.isCompletelyIdle=function(){return!q&&Re===0&&ft._buffer[R_]()===0},ft.getOfflineListener=function(){return et},ft._xhrReadyStateChange=function(Ve,It,pr){if(!Vg(It))return Lm(Ve,It,pr)},ft[bF]=function(Ve,It,pr){Ve===void 0&&(Ve=!0);var Gr;if(!q)try{var Vn=ft[eC];if(oi)Vn[x4]();else if(Vn[R_]()>0){var kn=Vn.getItems();_W(pr||0,Ve),It?Gr=It.call(ft,kn,Ve):Gr=ft[IF](kn,Ve)}dI()}catch(Pc){var Io=Fb();(!Io||Io>9)&&Ur(ft[Ed](),1,40,"Telemetry transmission failed, some telemetry will be lost: "+wl(Pc),{exception:Qt(Pc)})}return Gr},ft.getOfflineSupport=function(){return{getUrl:s(function(){return Ke},"getUrl"),createPayload:Ct,serialize:ba,batch:Mu,shouldProcess:s(function(Ve){return!!jg(Ve)},"shouldProcess")}},ft._doTeardown=function(Ve,It){ft.onunloadFlush(),jb(et,!1),NDe()},ft[k_]=function(Ve,It,pr){if(!Vg(Ve))return lf(Ve,It)},ft[lfe]=function(Ve,It){if(!Vg(Ve))return cI(Ve,It)},ft[IW]=function(Ve,It){if(!Vg(Ve))return Wg(Ve)},ft._xdrOnLoad=function(Ve,It){if(!Vg(It))return ja(Ve,It)};function ja(Ve,It){var pr=kDe(Ve);if(Ve&&(pr+""=="200"||pr===""))k=0,ft[IW](It,0);else{var Gr=Jr(pr);Gr&&Gr[ufe]&&Gr[ufe]>Gr[dfe]&&!zo?ft[lfe](It,Gr):ft[k_](It,b$(Ve))}}s(ja,"_xdrOnLoad");function Jl(){try{var Ve={xdrOnComplete:s(function(pr,Gr,Vn){var kn=lI(Vn);if(kn)return ja(pr,kn)},"xdrOnComplete"),fetchOnComplete:s(function(pr,Gr,Vn,kn){var Io=lI(kn);if(Io)return Ks(pr.status,Io,pr.url,Io[qi],pr.statusText,Vn||"")},"fetchOnComplete"),xhrOnComplete:s(function(pr,Gr,Vn){var kn=lI(Vn);if(kn)return Lm(pr,kn,kn[qi])},"xhrOnComplete"),beaconOnRetry:s(function(pr,Gr,Vn){return Gg(pr,Gr,Vn)},"beaconOnRetry")},It={enableSendPromise:Ts,isOneDs:!1,disableCredentials:!1,disableXhr:nn,disableBeacon:!sr,disableBeaconSync:!$t,senderOnCompleteCallBack:Ve};return It}catch{}return null}s(Jl,"_getSendPostMgrConfig");function Lm(Ve,It,pr){Ve.readyState===4&&Ks(Ve.status,It,Ve.responseURL,pr,V5(Ve),kDe(Ve)||Ve.response)}s(Lm,"_xhrReadyStateChange");function lf(Ve,It,pr){Ur(ft[Ed](),2,26,"Failed to send telemetry.",{message:It}),ft._buffer&&ft._buffer[vF](Ve)}s(lf,"_onError");function cI(Ve,It){for(var pr=[],Gr=[],Vn=It.errors.reverse(),kn=0,Io=Vn;kn<Io.length;kn++){var Pc=Io[kn],d0=Ve.splice(Pc.index,1)[0];fI(Pc.statusCode)?Gr[_v](d0):pr[_v](d0)}Ve[qi]>0&&ft[IW](Ve,It[dfe]),pr[qi]>0&&ft[k_](pr,V5(null,["partial success",It[dfe],"of",It.itemsReceived].join(" "))),Gr[qi]>0&&(RF(Gr),Ur(ft[Ed](),2,40,"Partial success. Delivered: "+Ve[qi]+", Failed: "+pr[qi]+". Will retry to send "+Gr[qi]+" our of "+It[ufe]+" items"))}s(cI,"_onPartialSuccess");function Wg(Ve,It){ft._buffer&&ft._buffer[vF](Ve)}s(Wg,"_onSuccess");function lI(Ve){try{if(Ve){var It=Ve,pr=It.oriPayload;return pr&&pr[qi]?pr:null}}catch{}return null}s(lI,"_getPayloadArr");function jg(Ve,It){if(oi)return!1;if(!Ve)return It&&Ur(It,1,7,"Cannot send empty telemetry"),!1;if(Ve.baseData&&!Ve[ffe])return It&&Ur(It,1,70,"Cannot send telemetry without baseData and baseType"),!1;if(Ve[ffe]||(Ve[ffe]="EventData"),!ft[IF])return It&&Ur(It,1,28,"Sender was not initialized"),!1;if(wr(Ve))Ve[G4e]=ft._sample[TW];else return It&&Ur(It,2,33,"Telemetry item was sampled out and not sent",{SampleRate:ft._sample[TW]}),!1;return!0}s(jg,"_validate");function uI(Ve,It){var pr=Ve.iKey||Wi,Gr=I.constructEnvelope(Ve,pr,It,ji);if(!Gr){Ur(It,1,47,"Unable to create an AppInsights envelope");return}var Vn=!1;if(Ve[Nu]&&Ve[Nu][qde]&&(Yr(Ve[Nu][qde],function(kn){try{kn&&kn(Gr)===!1&&(Vn=!0,i4(It,"Telemetry processor check returns false"))}catch(Io){Ur(It,1,64,"One of telemetry initializers failed, telemetry item will not be sent: "+wl(Io),{exception:Qt(Io)},!0)}}),delete Ve[Nu][qde]),!Vn)return Gr}s(uI,"_getEnvelope");function ba(Ve){var It=RDe,pr=ft[Ed]();try{var Gr=jg(Ve,pr),Vn=null;Gr&&(Vn=uI(Ve,pr)),Vn&&(It=ce.serialize(Vn))}catch{}return It}s(ba,"_serialize");function Mu(Ve){var It=RDe;return Ve&&Ve[qi]&&(It="["+Ve.join(",")+"]"),It}s(Mu,"_batch");function Ct(Ve){var It=es();return{urlString:Ke,data:Ve,headers:It}}s(Ct,"_createPayload");function wr(Ve){return ft._sample.isSampledIn(Ve)}s(wr,"_isSampledIn");function jn(Ve,It,pr,Gr){It===200&&Ve?ft._onSuccess(Ve,Ve[qi]):Gr&&ft[k_](Ve,Gr)}s(jn,"_getOnComplete");function Xr(Ve,It,pr,Gr){Gr===void 0&&(Gr=!0);var Vn=s(function(Pc,d0,Si){return jn(It,Pc,d0,Si)},"onComplete"),kn=Gn(It),Io=Ve&&Ve.sendPOST;return Io&&kn?(Gr&&ft._buffer[EW](It),Io(kn,Vn,!pr)):null}s(Xr,"_doSend");function Gn(Ve){if(Je(Ve)&&Ve[qi]>0){var It=ft[eC].batchPayloads(Ve),pr=es(),Gr={data:It,urlString:Ke,headers:pr,disableXhrSync:nn,disableFetchKeepAlive:!Fo,oriPayload:Ve};return Gr}return null}s(Gn,"_getPayload");function es(){try{var Ve=xe||{};return tDe(Ke)&&(Ve[z4e[6]]=z4e[7]),Ve}catch{}return null}s(es,"_getHeaders");function ss(Ve){var It=Ve?Ve[qi]:0;return ft[eC].size()+It>st?((!et||et.isOnline())&&ft[bF](!0,null,10),!0):!1}s(ss,"_checkMaxSize");function Ks(Ve,It,pr,Gr,Vn,kn){var Io=null;if(ft._appId||(Io=Jr(kn),Io&&Io.appId&&(ft._appId=Io.appId)),(Ve<200||Ve>=300)&&Ve!==0){if((Ve===301||Ve===307||Ve===308)&&!bd(pr)){ft[k_](It,Vn);return}if(et&&!et.isOnline()){if(!zo){var Pc=10;RF(It,Pc),Ur(ft[Ed](),2,40,". Offline - Response Code: ".concat(Ve,". Offline status: ").concat(!et.isOnline(),". Will retry to send ").concat(It.length," items."))}return}!zo&&fI(Ve)?(RF(It),Ur(ft[Ed](),2,40,". Response code "+Ve+". Will retry to send "+It[qi]+" items.")):ft[k_](It,Vn)}else bd(pr),Ve===206?(Io||(Io=Jr(kn)),Io&&!zo?ft[lfe](It,Io):ft[k_](It,Vn)):(k=0,ft[IW](It,Gr))}s(Ks,"_checkResponsStatus");function bd(Ve){return fe>=10?!1:!oe(Ve)&&Ve!==""&&Ve!==Ke?(Ke=Ve,++fe,!0):!1}s(bd,"_checkAndUpdateEndPointUrl");function tp(Ve,It){if(Qe)Qe(Ve,!1);else{var pr=Ko&&Ko[bW]([3],!0);return Xr(pr,Ve,It)}}s(tp,"_doUnloadSend");function Gg(Ve,It,pr){var Gr=Ve,Vn=Gr&&Gr.oriPayload;if(Wa)Un&&Un(Vn,!0),Ur(ft[Ed](),2,40,". Failed to send telemetry with Beacon API, retried with normal sender.");else{for(var kn=[],Io=0;Io<Vn[qi];Io++){var Pc=Vn[Io],d0=[Pc],Si=Gn(d0);pr(Si,It)?ft._onSuccess(d0,d0[qi]):kn[_v](Pc)}kn[qi]>0&&(Un&&Un(kn,!0),Ur(ft[Ed](),2,40,". Failed to send telemetry with Beacon API, retried with normal sender."))}}s(Gg,"_onBeaconRetry");function Vg(Ve){try{if(Ve&&Ve[qi])return Ae(Ve[0])}catch{}return null}s(Vg,"_isStringArr");function T4(Ve,It){var pr=null;if(Je(Ve)){for(var Gr=Ve[qi],Vn=0;Vn<Ve[qi];Vn++)Gr+=Ve[Vn].item[qi];var kn=Ko.getSyncFetchPayload();kn+Gr<=uTt?pr=2:Wy()?pr=3:(pr=1,Ur(ft[Ed](),2,40,". Failed to send telemetry with Beacon API, retried with xhrSender."));var Io=Ko&&Ko[bW]([pr],!0);return Xr(Io,Ve,It)}return null}s(T4,"_fetchKeepAliveSender");function RF(Ve,It){if(It===void 0&&(It=1),!(!Ve||Ve[qi]===0)){var pr=ft[eC];pr[vF](Ve),k++;for(var Gr=0,Vn=Ve;Gr<Vn.length;Gr++){var kn=Vn[Gr];kn.cnt=kn.cnt||0,kn.cnt++,pr[__](kn)}gfe(It),w4()}}s(RF,"_resendPayload");function gfe(Ve){var It=10,pr;if(k<=1)pr=It;else{var Gr=(Math.pow(2,k)-1)/2,Vn=ky(Math.random()*Gr*It)+1;Vn=Ve*Vn,pr=Pe(Jn(Vn,3600),It)}var kn=yd()+pr*1e3;M=kn}s(gfe,"_setRetryTime");function w4(){if(!G&&!q){var Ve=M?Pe(0,M-yd()):0,It=Pe(wn,Ve);G=Dy(function(){G=null,ft[bF](!0,null,1)},It)}}s(w4,"_setupTimer");function dI(){G&&G.cancel(),G=null,M=null}s(dI,"_clearScheduledTimer");function fI(Ve){return oe(Yl)?Ve===401||Ve===408||Ve===429||Ve===500||Ve===502||Ve===503||Ve===504:Yl[qi]&&Yl.indexOf(Ve)>-1}s(fI,"_isRetriable");function SW(){var Ve="getNotifyMgr";return ft.core[Ve]?ft.core[Ve]():ft.core._notificationManager}s(SW,"_getNotifyMgr");function _W(Ve,It){var pr=SW();if(pr&&pr.eventsSendRequest)try{pr.eventsSendRequest(Ve,It)}catch(Gr){Ur(ft[Ed](),1,74,"send request notification failed: "+wl(Gr),{exception:Qt(Gr)})}}s(_W,"_notifySendRequest");function BDe(Ve,It){var pr=It.disableInstrumentationKeyValidation,Gr=oe(pr)?!1:pr;if(Gr)return!0;var Vn="^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$",kn=new RegExp(Vn);return kn.test(Ve)}s(BDe,"_validateInstrumentationKey");function NDe(){ft[IF]=null,ft[eC]=null,ft._appId=null,ft._sample=null,xe={},et=null,k=0,M=null,q=!1,G=null,ce=null,fe=0,Re=0,Qe=null,He=null,Ke=null,At=null,st=0,wt=!1,kr=null,oi=!1,Wi=null,ji=tC,zo=!1,rn=null,Ea=tC,nn=!1,Fo=!1,Wa=!1,Dt=null,Un=null,Ko=null,je(ft,"_senderConfig",{g:s(function(){return E$({},PDe)},"g")})}s(NDe,"_initDefaults")}),T}return s(I,"Sender"),I.constructEnvelope=function(T,k,M,q){var G;k!==T.iKey&&!oe(k)?G=Ng(Ng({},T),{iKey:k}):G=T;var ce=pTt[G.baseType]||wDe;return ce(M,G,q)},I}(Et),b4="instrumentationKey",wW="connectionString",SF="endpointUrl",_F="userOverrideEndpointUrl",I4,hfe=void 0,mTt=(I4={diagnosticLogInterval:YL(hTt,1e4)},I4[wW]=hfe,I4.endpointUrl=hfe,I4[b4]=hfe,I4.extensionConfig={},I4);function hTt(v){return v&&v>0}s(hTt,"_chkDiagLevel");var gTt=function(){function v(I){var T=new Nt,k;(oe(I)||oe(I[b4])&&oe(I[wW]))&&zr("Invalid input configuration"),Du(v,this,function(q){je(q,"config",{g:s(function(){return k},"g")}),G(),q.initialize=G,q.track=M,ML(q,T,["flush","pollInternalLogs","stopPollingInternalLogs","unload","getPlugin","addPlugin","evtNamespace","addUnloadCb","onCfgChange","getTraceCtx","updateCfg","addTelemetryInitializer"]);function G(){var ce=ep(I||{},mTt);k=ce.cfg,T.addUnloadHook(Hg(ce,function(){var fe=k[wW];if(gt(fe)){var xe=O5(function(He,Ke){Kf(fe,function(At){var st=At.value,wt=k[b4];if(!At.rejected&&st){k[wW]=st;var $t=Yde(st);wt=$t.instrumentationkey||wt}He(wt)})}),Re=O5(function(He,Ke){Kf(fe,function(At){var st=At.value,wt=k[SF];if(!At.rejected&&st){var $t=Yde(st),sr=$t.ingestionendpoint;wt=sr?sr+m4:wt}He(wt)})});k[b4]=xe,k[SF]=k[_F]||Re}if(Ae(fe)){var Qe=Yde(fe),et=Qe.ingestionendpoint;k[SF]=k[_F]?k[_F]:et+m4,k[b4]=Qe.instrumentationkey||k[b4]}k[SF]=k[_F]?k[_F]:k[SF]})),T.initialize(k,[new DDe])}s(G,"_initialize")});function M(q){q&&(q.baseData=q.baseData||{},q.baseType=q.baseType||"EventData"),T.track(q)}s(M,"_track")}return s(v,"ApplicationInsights"),v.__ieDyn=1,v}();t.AppInsightsCore=Nt,t.ApplicationInsights=gTt,t.Sender=DDe,t.SeverityLevel=GIt,t.arrForEach=Yr,t.isNullOrUndefined=oe,t.proxyFunctions=ML,t.throwError=zr})});var G6e=H(CV=>{"use strict";d();Object.defineProperty(CV,"__esModule",{value:!0});CV.state=void 0;CV.state={instrumenterImplementation:void 0}});var eB=H((gge,FOe)=>{d();var fz=require("buffer"),wC=fz.Buffer;function LOe(t,e){for(var r in t)e[r]=t[r]}s(LOe,"copyProps");wC.from&&wC.alloc&&wC.allocUnsafe&&wC.allocUnsafeSlow?FOe.exports=fz:(LOe(fz,gge),gge.Buffer=Y2);function Y2(t,e,r){return wC(t,e,r)}s(Y2,"SafeBuffer");Y2.prototype=Object.create(wC.prototype);LOe(wC,Y2);Y2.from=function(t,e,r){if(typeof t=="number")throw new TypeError("Argument must not be a number");return wC(t,e,r)};Y2.alloc=function(t,e,r){if(typeof t!="number")throw new TypeError("Argument must be a number");var n=wC(t);return e!==void 0?typeof r=="string"?n.fill(e,r):n.fill(e):n.fill(0),n};Y2.allocUnsafe=function(t){if(typeof t!="number")throw new TypeError("Argument must be a number");return wC(t)};Y2.allocUnsafeSlow=function(t){if(typeof t!="number")throw new TypeError("Argument must be a number");return fz.SlowBuffer(t)}});var Age=H((uan,OOe)=>{d();var pz=eB().Buffer,CBt=require("stream"),vBt=require("util");function mz(t){if(this.buffer=null,this.writable=!0,this.readable=!0,!t)return this.buffer=pz.alloc(0),this;if(typeof t.pipe=="function")return this.buffer=pz.alloc(0),t.pipe(this),this;if(t.length||typeof t=="object")return this.buffer=t,this.writable=!1,process.nextTick(function(){this.emit("end",t),this.readable=!1,this.emit("close")}.bind(this)),this;throw new TypeError("Unexpected data type ("+typeof t+")")}s(mz,"DataStream");vBt.inherits(mz,CBt);mz.prototype.write=s(function(e){this.buffer=pz.concat([this.buffer,pz.from(e)]),this.emit("data",e)},"write");mz.prototype.end=s(function(e){e&&this.write(e),this.emit("end",e),this.emit("close"),this.writable=!1,this.readable=!1},"end");OOe.exports=mz});var UOe=H((pan,QOe)=>{"use strict";d();function yge(t){var e=(t/8|0)+(t%8===0?0:1);return e}s(yge,"getParamSize");var xBt={ES256:yge(256),ES384:yge(384),ES512:yge(521)};function EBt(t){var e=xBt[t];if(e)return e;throw new Error('Unknown algorithm "'+t+'"')}s(EBt,"getParamBytesForAlg");QOe.exports=EBt});var VOe=H((gan,GOe)=>{"use strict";d();var hz=eB().Buffer,HOe=UOe(),gz=128,$Oe=0,bBt=32,IBt=16,TBt=2,WOe=IBt|bBt|$Oe<<6,Az=TBt|$Oe<<6;function wBt(t){return t.replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}s(wBt,"base64Url");function jOe(t){if(hz.isBuffer(t))return t;if(typeof t=="string")return hz.from(t,"base64");throw new TypeError("ECDSA signature must be a Base64 string or a Buffer")}s(jOe,"signatureAsBuffer");function SBt(t,e){t=jOe(t);var r=HOe(e),n=r+1,i=t.length,o=0;if(t[o++]!==WOe)throw new Error('Could not find expected "seq"');var a=t[o++];if(a===(gz|1)&&(a=t[o++]),i-o<a)throw new Error('"seq" specified length of "'+a+'", only "'+(i-o)+'" remaining');if(t[o++]!==Az)throw new Error('Could not find expected "int" for "r"');var c=t[o++];if(i-o-2<c)throw new Error('"r" specified length of "'+c+'", only "'+(i-o-2)+'" available');if(n<c)throw new Error('"r" specified length of "'+c+'", max of "'+n+'" is acceptable');var l=o;if(o+=c,t[o++]!==Az)throw new Error('Could not find expected "int" for "s"');var u=t[o++];if(i-o!==u)throw new Error('"s" specified length of "'+u+'", expected "'+(i-o)+'"');if(n<u)throw new Error('"s" specified length of "'+u+'", max of "'+n+'" is acceptable');var f=o;if(o+=u,o!==i)throw new Error('Expected to consume entire buffer, but "'+(i-o)+'" bytes remain');var p=r-c,m=r-u,h=hz.allocUnsafe(p+c+m+u);for(o=0;o<p;++o)h[o]=0;t.copy(h,o,l+Math.max(-p,0),l+c),o=r;for(var g=o;o<g+m;++o)h[o]=0;return t.copy(h,o,f+Math.max(-m,0),f+u),h=h.toString("base64"),h=wBt(h),h}s(SBt,"derToJose");function qOe(t,e,r){for(var n=0;e+n<r&&t[e+n]===0;)++n;var i=t[e+n]>=gz;return i&&--n,n}s(qOe,"countPadding");function _Bt(t,e){t=jOe(t);var r=HOe(e),n=t.length;if(n!==r*2)throw new TypeError('"'+e+'" signatures must be "'+r*2+'" bytes, saw "'+n+'"');var i=qOe(t,0,r),o=qOe(t,r,t.length),a=r-i,c=r-o,l=2+a+1+1+c,u=l<gz,f=hz.allocUnsafe((u?2:3)+l),p=0;return f[p++]=WOe,u?f[p++]=l:(f[p++]=gz|1,f[p++]=l&255),f[p++]=Az,f[p++]=a,i<0?(f[p++]=0,p+=t.copy(f,p,0,r)):p+=t.copy(f,p,i,r),f[p++]=Az,f[p++]=c,o<0?(f[p++]=0,t.copy(f,p,r)):t.copy(f,p,r+o),f}s(_Bt,"joseToDer");GOe.exports={derToJose:SBt,joseToDer:_Bt}});var KOe=H((Can,zOe)=>{"use strict";d();var _6=require("buffer").Buffer,Cge=require("buffer").SlowBuffer;zOe.exports=yz;function yz(t,e){if(!_6.isBuffer(t)||!_6.isBuffer(e)||t.length!==e.length)return!1;for(var r=0,n=0;n<t.length;n++)r|=t[n]^e[n];return r===0}s(yz,"bufferEq");yz.install=function(){_6.prototype.equal=Cge.prototype.equal=s(function(e){return yz(this,e)},"equal")};var RBt=_6.prototype.equal,kBt=Cge.prototype.equal;yz.restore=function(){_6.prototype.equal=RBt,Cge.prototype.equal=kBt}});var bge=H((Ean,i7e)=>{d();var rB=eB().Buffer,rh=require("crypto"),JOe=VOe(),YOe=require("util"),PBt=`"%s" is not a valid algorithm.
  Supported algorithms are:
  "HS256", "HS384", "HS512", "RS256", "RS384", "RS512", "PS256", "PS384", "PS512", "ES256", "ES384", "ES512" and "none".`,R6="secret must be a string or buffer",tB="key must be a string or a buffer",DBt="key must be a string, a buffer or an object",xge=typeof rh.createPublicKey=="function";xge&&(tB+=" or a KeyObject",R6+="or a KeyObject");function XOe(t){if(!rB.isBuffer(t)&&typeof t!="string"&&(!xge||typeof t!="object"||typeof t.type!="string"||typeof t.asymmetricKeyType!="string"||typeof t.export!="function"))throw gA(tB)}s(XOe,"checkIsPublicKey");function ZOe(t){if(!rB.isBuffer(t)&&typeof t!="string"&&typeof t!="object")throw gA(DBt)}s(ZOe,"checkIsPrivateKey");function BBt(t){if(!rB.isBuffer(t)){if(typeof t=="string")return t;if(!xge||typeof t!="object"||t.type!=="secret"||typeof t.export!="function")throw gA(R6)}}s(BBt,"checkIsSecretKey");function Ege(t){return t.replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}s(Ege,"fromBase64");function e7e(t){t=t.toString();var e=4-t.length%4;if(e!==4)for(var r=0;r<e;++r)t+="=";return t.replace(/\-/g,"+").replace(/_/g,"/")}s(e7e,"toBase64");function gA(t){var e=[].slice.call(arguments,1),r=YOe.format.bind(YOe,t).apply(null,e);return new TypeError(r)}s(gA,"typeError");function NBt(t){return rB.isBuffer(t)||typeof t=="string"}s(NBt,"bufferOrString");function k6(t){return NBt(t)||(t=JSON.stringify(t)),t}s(k6,"normalizeInput");function t7e(t){return s(function(r,n){BBt(n),r=k6(r);var i=rh.createHmac("sha"+t,n),o=(i.update(r),i.digest("base64"));return Ege(o)},"sign")}s(t7e,"createHmacSigner");var vge,MBt="timingSafeEqual"in rh?s(function(e,r){return e.byteLength!==r.byteLength?!1:rh.timingSafeEqual(e,r)},"timingSafeEqual"):s(function(e,r){return vge||(vge=KOe()),vge(e,r)},"timingSafeEqual");function LBt(t){return s(function(r,n,i){var o=t7e(t)(r,i);return MBt(rB.from(n),rB.from(o))},"verify")}s(LBt,"createHmacVerifier");function r7e(t){return s(function(r,n){ZOe(n),r=k6(r);var i=rh.createSign("RSA-SHA"+t),o=(i.update(r),i.sign(n,"base64"));return Ege(o)},"sign")}s(r7e,"createKeySigner");function n7e(t){return s(function(r,n,i){XOe(i),r=k6(r),n=e7e(n);var o=rh.createVerify("RSA-SHA"+t);return o.update(r),o.verify(i,n,"base64")},"verify")}s(n7e,"createKeyVerifier");function FBt(t){return s(function(r,n){ZOe(n),r=k6(r);var i=rh.createSign("RSA-SHA"+t),o=(i.update(r),i.sign({key:n,padding:rh.constants.RSA_PKCS1_PSS_PADDING,saltLength:rh.constants.RSA_PSS_SALTLEN_DIGEST},"base64"));return Ege(o)},"sign")}s(FBt,"createPSSKeySigner");function OBt(t){return s(function(r,n,i){XOe(i),r=k6(r),n=e7e(n);var o=rh.createVerify("RSA-SHA"+t);return o.update(r),o.verify({key:i,padding:rh.constants.RSA_PKCS1_PSS_PADDING,saltLength:rh.constants.RSA_PSS_SALTLEN_DIGEST},n,"base64")},"verify")}s(OBt,"createPSSKeyVerifier");function QBt(t){var e=r7e(t);return s(function(){var n=e.apply(null,arguments);return n=JOe.derToJose(n,"ES"+t),n},"sign")}s(QBt,"createECDSASigner");function UBt(t){var e=n7e(t);return s(function(n,i,o){i=JOe.joseToDer(i,"ES"+t).toString("base64");var a=e(n,i,o);return a},"verify")}s(UBt,"createECDSAVerifer");function qBt(){return s(function(){return""},"sign")}s(qBt,"createNoneSigner");function HBt(){return s(function(e,r){return r===""},"verify")}s(HBt,"createNoneVerifier");i7e.exports=s(function(e){var r={hs:t7e,rs:r7e,ps:FBt,es:QBt,none:qBt},n={hs:LBt,rs:n7e,ps:OBt,es:UBt,none:HBt},i=e.match(/^(RS|PS|ES|HS)(256|384|512)$|^(none)$/i);if(!i)throw gA(PBt,e);var o=(i[1]||i[3]).toLowerCase(),a=i[2];return{sign:r[o](a),verify:n[o](a)}},"jwa")});var Ige=H((Tan,o7e)=>{d();var $Bt=require("buffer").Buffer;o7e.exports=s(function(e){return typeof e=="string"?e:typeof e=="number"||$Bt.isBuffer(e)?e.toString():JSON.stringify(e)},"toString")});var d7e=H((_an,u7e)=>{d();var WBt=eB().Buffer,s7e=Age(),jBt=bge(),GBt=require("stream"),a7e=Ige(),Tge=require("util");function c7e(t,e){return WBt.from(t,e).toString("base64").replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}s(c7e,"base64url");function VBt(t,e,r){r=r||"utf8";var n=c7e(a7e(t),"binary"),i=c7e(a7e(e),r);return Tge.format("%s.%s",n,i)}s(VBt,"jwsSecuredInput");function l7e(t){var e=t.header,r=t.payload,n=t.secret||t.privateKey,i=t.encoding,o=jBt(e.alg),a=VBt(e,r,i),c=o.sign(a,n);return Tge.format("%s.%s",a,c)}s(l7e,"jwsSign");function Cz(t){var e=t.secret||t.privateKey||t.key,r=new s7e(e);this.readable=!0,this.header=t.header,this.encoding=t.encoding,this.secret=this.privateKey=this.key=r,this.payload=new s7e(t.payload),this.secret.once("close",function(){!this.payload.writable&&this.readable&&this.sign()}.bind(this)),this.payload.once("close",function(){!this.secret.writable&&this.readable&&this.sign()}.bind(this))}s(Cz,"SignStream");Tge.inherits(Cz,GBt);Cz.prototype.sign=s(function(){try{var e=l7e({header:this.header,payload:this.payload.buffer,secret:this.secret.buffer,encoding:this.encoding});return this.emit("done",e),this.emit("data",e),this.emit("end"),this.readable=!1,e}catch(r){this.readable=!1,this.emit("error",r),this.emit("close")}},"sign");Cz.sign=l7e;u7e.exports=Cz});var x7e=H((Pan,v7e)=>{d();var p7e=eB().Buffer,f7e=Age(),zBt=bge(),KBt=require("stream"),m7e=Ige(),YBt=require("util"),JBt=/^[a-zA-Z0-9\-_]+?\.[a-zA-Z0-9\-_]+?\.([a-zA-Z0-9\-_]+)?$/;function XBt(t){return Object.prototype.toString.call(t)==="[object Object]"}s(XBt,"isObject");function ZBt(t){if(XBt(t))return t;try{return JSON.parse(t)}catch{return}}s(ZBt,"safeJsonParse");function h7e(t){var e=t.split(".",1)[0];return ZBt(p7e.from(e,"base64").toString("binary"))}s(h7e,"headerFromJWS");function e3t(t){return t.split(".",2).join(".")}s(e3t,"securedInputFromJWS");function g7e(t){return t.split(".")[2]}s(g7e,"signatureFromJWS");function t3t(t,e){e=e||"utf8";var r=t.split(".")[1];return p7e.from(r,"base64").toString(e)}s(t3t,"payloadFromJWS");function A7e(t){return JBt.test(t)&&!!h7e(t)}s(A7e,"isValidJws");function y7e(t,e,r){if(!e){var n=new Error("Missing algorithm parameter for jws.verify");throw n.code="MISSING_ALGORITHM",n}t=m7e(t);var i=g7e(t),o=e3t(t),a=zBt(e);return a.verify(o,i,r)}s(y7e,"jwsVerify");function C7e(t,e){if(e=e||{},t=m7e(t),!A7e(t))return null;var r=h7e(t);if(!r)return null;var n=t3t(t);return(r.typ==="JWT"||e.json)&&(n=JSON.parse(n,e.encoding)),{header:r,payload:n,signature:g7e(t)}}s(C7e,"jwsDecode");function nB(t){t=t||{};var e=t.secret||t.publicKey||t.key,r=new f7e(e);this.readable=!0,this.algorithm=t.algorithm,this.encoding=t.encoding,this.secret=this.publicKey=this.key=r,this.signature=new f7e(t.signature),this.secret.once("close",function(){!this.signature.writable&&this.readable&&this.verify()}.bind(this)),this.signature.once("close",function(){!this.secret.writable&&this.readable&&this.verify()}.bind(this))}s(nB,"VerifyStream");YBt.inherits(nB,KBt);nB.prototype.verify=s(function(){try{var e=y7e(this.signature.buffer,this.algorithm,this.key.buffer),r=C7e(this.signature.buffer,this.encoding);return this.emit("done",e,r),this.emit("data",e),this.emit("end"),this.readable=!1,e}catch(n){this.readable=!1,this.emit("error",n),this.emit("close")}},"verify");nB.decode=C7e;nB.isValid=A7e;nB.verify=y7e;v7e.exports=nB});var xz=H(oT=>{d();var E7e=d7e(),vz=x7e(),r3t=["HS256","HS384","HS512","RS256","RS384","RS512","PS256","PS384","PS512","ES256","ES384","ES512"];oT.ALGORITHMS=r3t;oT.sign=E7e.sign;oT.verify=vz.verify;oT.decode=vz.decode;oT.isValid=vz.isValid;oT.createSign=s(function(e){return new E7e(e)},"createSign");oT.createVerify=s(function(e){return new vz(e)},"createVerify")});var wge=H((Fan,b7e)=>{d();var n3t=xz();b7e.exports=function(t,e){e=e||{};var r=n3t.decode(t,e);if(!r)return null;var n=r.payload;if(typeof n=="string")try{var i=JSON.parse(n);i!==null&&typeof i=="object"&&(n=i)}catch{}return e.complete===!0?{header:r.header,payload:n,signature:r.signature}:n}});var P6=H((Qan,I7e)=>{d();var Ez=s(function(t,e){Error.call(this,t),Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor),this.name="JsonWebTokenError",this.message=t,e&&(this.inner=e)},"JsonWebTokenError");Ez.prototype=Object.create(Error.prototype);Ez.prototype.constructor=Ez;I7e.exports=Ez});var Sge=H((Han,w7e)=>{d();var T7e=P6(),bz=s(function(t,e){T7e.call(this,t),this.name="NotBeforeError",this.date=e},"NotBeforeError");bz.prototype=Object.create(T7e.prototype);bz.prototype.constructor=bz;w7e.exports=bz});var _ge=H((jan,_7e)=>{d();var S7e=P6(),Iz=s(function(t,e){S7e.call(this,t),this.name="TokenExpiredError",this.expiredAt=e},"TokenExpiredError");Iz.prototype=Object.create(S7e.prototype);Iz.prototype.constructor=Iz;_7e.exports=Iz});var Rge=H((zan,R7e)=>{d();var iB=1e3,oB=iB*60,sB=oB*60,J2=sB*24,i3t=J2*7,o3t=J2*365.25;R7e.exports=function(t,e){e=e||{};var r=typeof t;if(r==="string"&&t.length>0)return s3t(t);if(r==="number"&&isFinite(t))return e.long?c3t(t):a3t(t);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(t))};function s3t(t){if(t=String(t),!(t.length>100)){var e=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(t);if(e){var r=parseFloat(e[1]),n=(e[2]||"ms").toLowerCase();switch(n){case"years":case"year":case"yrs":case"yr":case"y":return r*o3t;case"weeks":case"week":case"w":return r*i3t;case"days":case"day":case"d":return r*J2;case"hours":case"hour":case"hrs":case"hr":case"h":return r*sB;case"minutes":case"minute":case"mins":case"min":case"m":return r*oB;case"seconds":case"second":case"secs":case"sec":case"s":return r*iB;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return r;default:return}}}}s(s3t,"parse");function a3t(t){var e=Math.abs(t);return e>=J2?Math.round(t/J2)+"d":e>=sB?Math.round(t/sB)+"h":e>=oB?Math.round(t/oB)+"m":e>=iB?Math.round(t/iB)+"s":t+"ms"}s(a3t,"fmtShort");function c3t(t){var e=Math.abs(t);return e>=J2?Tz(t,e,J2,"day"):e>=sB?Tz(t,e,sB,"hour"):e>=oB?Tz(t,e,oB,"minute"):e>=iB?Tz(t,e,iB,"second"):t+" ms"}s(c3t,"fmtLong");function Tz(t,e,r,n){var i=e>=r*1.5;return Math.round(t/r)+" "+n+(i?"s":"")}s(Tz,"plural")});var kge=H((Jan,k7e)=>{d();var l3t=Rge();k7e.exports=function(t,e){var r=e||Math.floor(Date.now()/1e3);if(typeof t=="string"){var n=l3t(t);return typeof n>"u"?void 0:Math.floor(r+n/1e3)}else return typeof t=="number"?r+t:void 0}});var D6=H((Zan,P7e)=>{"use strict";d();var u3t="2.0.0",d3t=Number.MAX_SAFE_INTEGER||9007199254740991,f3t=16,p3t=250,m3t=["major","premajor","minor","preminor","patch","prepatch","prerelease"];P7e.exports={MAX_LENGTH:256,MAX_SAFE_COMPONENT_LENGTH:f3t,MAX_SAFE_BUILD_LENGTH:p3t,MAX_SAFE_INTEGER:d3t,RELEASE_TYPES:m3t,SEMVER_SPEC_VERSION:u3t,FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2}});var B6=H((tcn,D7e)=>{"use strict";d();var h3t=typeof process=="object"&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?(...t)=>console.error("SEMVER",...t):()=>{};D7e.exports=h3t});var aB=H((SC,B7e)=>{"use strict";d();var{MAX_SAFE_COMPONENT_LENGTH:Pge,MAX_SAFE_BUILD_LENGTH:g3t,MAX_LENGTH:A3t}=D6(),y3t=B6();SC=B7e.exports={};var C3t=SC.re=[],v3t=SC.safeRe=[],Pr=SC.src=[],x3t=SC.safeSrc=[],Dr=SC.t={},E3t=0,Dge="[a-zA-Z0-9-]",b3t=[["\\s",1],["\\d",A3t],[Dge,g3t]],I3t=s(t=>{for(let[e,r]of b3t)t=t.split(`${e}*`).join(`${e}{0,${r}}`).split(`${e}+`).join(`${e}{1,${r}}`);return t},"makeSafeRegex"),gi=s((t,e,r)=>{let n=I3t(e),i=E3t++;y3t(t,i,e),Dr[t]=i,Pr[i]=e,x3t[i]=n,C3t[i]=new RegExp(e,r?"g":void 0),v3t[i]=new RegExp(n,r?"g":void 0)},"createToken");gi("NUMERICIDENTIFIER","0|[1-9]\\d*");gi("NUMERICIDENTIFIERLOOSE","\\d+");gi("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${Dge}*`);gi("MAINVERSION",`(${Pr[Dr.NUMERICIDENTIFIER]})\\.(${Pr[Dr.NUMERICIDENTIFIER]})\\.(${Pr[Dr.NUMERICIDENTIFIER]})`);gi("MAINVERSIONLOOSE",`(${Pr[Dr.NUMERICIDENTIFIERLOOSE]})\\.(${Pr[Dr.NUMERICIDENTIFIERLOOSE]})\\.(${Pr[Dr.NUMERICIDENTIFIERLOOSE]})`);gi("PRERELEASEIDENTIFIER",`(?:${Pr[Dr.NONNUMERICIDENTIFIER]}|${Pr[Dr.NUMERICIDENTIFIER]})`);gi("PRERELEASEIDENTIFIERLOOSE",`(?:${Pr[Dr.NONNUMERICIDENTIFIER]}|${Pr[Dr.NUMERICIDENTIFIERLOOSE]})`);gi("PRERELEASE",`(?:-(${Pr[Dr.PRERELEASEIDENTIFIER]}(?:\\.${Pr[Dr.PRERELEASEIDENTIFIER]})*))`);gi("PRERELEASELOOSE",`(?:-?(${Pr[Dr.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${Pr[Dr.PRERELEASEIDENTIFIERLOOSE]})*))`);gi("BUILDIDENTIFIER",`${Dge}+`);gi("BUILD",`(?:\\+(${Pr[Dr.BUILDIDENTIFIER]}(?:\\.${Pr[Dr.BUILDIDENTIFIER]})*))`);gi("FULLPLAIN",`v?${Pr[Dr.MAINVERSION]}${Pr[Dr.PRERELEASE]}?${Pr[Dr.BUILD]}?`);gi("FULL",`^${Pr[Dr.FULLPLAIN]}$`);gi("LOOSEPLAIN",`[v=\\s]*${Pr[Dr.MAINVERSIONLOOSE]}${Pr[Dr.PRERELEASELOOSE]}?${Pr[Dr.BUILD]}?`);gi("LOOSE",`^${Pr[Dr.LOOSEPLAIN]}$`);gi("GTLT","((?:<|>)?=?)");gi("XRANGEIDENTIFIERLOOSE",`${Pr[Dr.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`);gi("XRANGEIDENTIFIER",`${Pr[Dr.NUMERICIDENTIFIER]}|x|X|\\*`);gi("XRANGEPLAIN",`[v=\\s]*(${Pr[Dr.XRANGEIDENTIFIER]})(?:\\.(${Pr[Dr.XRANGEIDENTIFIER]})(?:\\.(${Pr[Dr.XRANGEIDENTIFIER]})(?:${Pr[Dr.PRERELEASE]})?${Pr[Dr.BUILD]}?)?)?`);gi("XRANGEPLAINLOOSE",`[v=\\s]*(${Pr[Dr.XRANGEIDENTIFIERLOOSE]})(?:\\.(${Pr[Dr.XRANGEIDENTIFIERLOOSE]})(?:\\.(${Pr[Dr.XRANGEIDENTIFIERLOOSE]})(?:${Pr[Dr.PRERELEASELOOSE]})?${Pr[Dr.BUILD]}?)?)?`);gi("XRANGE",`^${Pr[Dr.GTLT]}\\s*${Pr[Dr.XRANGEPLAIN]}$`);gi("XRANGELOOSE",`^${Pr[Dr.GTLT]}\\s*${Pr[Dr.XRANGEPLAINLOOSE]}$`);gi("COERCEPLAIN",`(^|[^\\d])(\\d{1,${Pge}})(?:\\.(\\d{1,${Pge}}))?(?:\\.(\\d{1,${Pge}}))?`);gi("COERCE",`${Pr[Dr.COERCEPLAIN]}(?:$|[^\\d])`);gi("COERCEFULL",Pr[Dr.COERCEPLAIN]+`(?:${Pr[Dr.PRERELEASE]})?(?:${Pr[Dr.BUILD]})?(?:$|[^\\d])`);gi("COERCERTL",Pr[Dr.COERCE],!0);gi("COERCERTLFULL",Pr[Dr.COERCEFULL],!0);gi("LONETILDE","(?:~>?)");gi("TILDETRIM",`(\\s*)${Pr[Dr.LONETILDE]}\\s+`,!0);SC.tildeTrimReplace="$1~";gi("TILDE",`^${Pr[Dr.LONETILDE]}${Pr[Dr.XRANGEPLAIN]}$`);gi("TILDELOOSE",`^${Pr[Dr.LONETILDE]}${Pr[Dr.XRANGEPLAINLOOSE]}$`);gi("LONECARET","(?:\\^)");gi("CARETTRIM",`(\\s*)${Pr[Dr.LONECARET]}\\s+`,!0);SC.caretTrimReplace="$1^";gi("CARET",`^${Pr[Dr.LONECARET]}${Pr[Dr.XRANGEPLAIN]}$`);gi("CARETLOOSE",`^${Pr[Dr.LONECARET]}${Pr[Dr.XRANGEPLAINLOOSE]}$`);gi("COMPARATORLOOSE",`^${Pr[Dr.GTLT]}\\s*(${Pr[Dr.LOOSEPLAIN]})$|^$`);gi("COMPARATOR",`^${Pr[Dr.GTLT]}\\s*(${Pr[Dr.FULLPLAIN]})$|^$`);gi("COMPARATORTRIM",`(\\s*)${Pr[Dr.GTLT]}\\s*(${Pr[Dr.LOOSEPLAIN]}|${Pr[Dr.XRANGEPLAIN]})`,!0);SC.comparatorTrimReplace="$1$2$3";gi("HYPHENRANGE",`^\\s*(${Pr[Dr.XRANGEPLAIN]})\\s+-\\s+(${Pr[Dr.XRANGEPLAIN]})\\s*$`);gi("HYPHENRANGELOOSE",`^\\s*(${Pr[Dr.XRANGEPLAINLOOSE]})\\s+-\\s+(${Pr[Dr.XRANGEPLAINLOOSE]})\\s*$`);gi("STAR","(<|>)?=?\\s*\\*");gi("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$");gi("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")});var wz=H((ocn,N7e)=>{"use strict";d();var T3t=Object.freeze({loose:!0}),w3t=Object.freeze({}),S3t=s(t=>t?typeof t!="object"?T3t:t:w3t,"parseOptions");N7e.exports=S3t});var Bge=H((ccn,F7e)=>{"use strict";d();var M7e=/^[0-9]+$/,L7e=s((t,e)=>{let r=M7e.test(t),n=M7e.test(e);return r&&n&&(t=+t,e=+e),t===e?0:r&&!n?-1:n&&!r?1:t<e?-1:1},"compareIdentifiers"),_3t=s((t,e)=>L7e(e,t),"rcompareIdentifiers");F7e.exports={compareIdentifiers:L7e,rcompareIdentifiers:_3t}});var Fd=H((dcn,Q7e)=>{"use strict";d();var Sz=B6(),{MAX_LENGTH:O7e,MAX_SAFE_INTEGER:_z}=D6(),{safeRe:Rz,t:kz}=aB(),R3t=wz(),{compareIdentifiers:cB}=Bge(),Nge=class t{static{s(this,"SemVer")}constructor(e,r){if(r=R3t(r),e instanceof t){if(e.loose===!!r.loose&&e.includePrerelease===!!r.includePrerelease)return e;e=e.version}else if(typeof e!="string")throw new TypeError(`Invalid version. Must be a string. Got type "${typeof e}".`);if(e.length>O7e)throw new TypeError(`version is longer than ${O7e} characters`);Sz("SemVer",e,r),this.options=r,this.loose=!!r.loose,this.includePrerelease=!!r.includePrerelease;let n=e.trim().match(r.loose?Rz[kz.LOOSE]:Rz[kz.FULL]);if(!n)throw new TypeError(`Invalid Version: ${e}`);if(this.raw=e,this.major=+n[1],this.minor=+n[2],this.patch=+n[3],this.major>_z||this.major<0)throw new TypeError("Invalid major version");if(this.minor>_z||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>_z||this.patch<0)throw new TypeError("Invalid patch version");n[4]?this.prerelease=n[4].split(".").map(i=>{if(/^[0-9]+$/.test(i)){let o=+i;if(o>=0&&o<_z)return o}return i}):this.prerelease=[],this.build=n[5]?n[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(e){if(Sz("SemVer.compare",this.version,this.options,e),!(e instanceof t)){if(typeof e=="string"&&e===this.version)return 0;e=new t(e,this.options)}return e.version===this.version?0:this.compareMain(e)||this.comparePre(e)}compareMain(e){return e instanceof t||(e=new t(e,this.options)),cB(this.major,e.major)||cB(this.minor,e.minor)||cB(this.patch,e.patch)}comparePre(e){if(e instanceof t||(e=new t(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;let r=0;do{let n=this.prerelease[r],i=e.prerelease[r];if(Sz("prerelease compare",r,n,i),n===void 0&&i===void 0)return 0;if(i===void 0)return 1;if(n===void 0)return-1;if(n===i)continue;return cB(n,i)}while(++r)}compareBuild(e){e instanceof t||(e=new t(e,this.options));let r=0;do{let n=this.build[r],i=e.build[r];if(Sz("build compare",r,n,i),n===void 0&&i===void 0)return 0;if(i===void 0)return 1;if(n===void 0)return-1;if(n===i)continue;return cB(n,i)}while(++r)}inc(e,r,n){if(e.startsWith("pre")){if(!r&&n===!1)throw new Error("invalid increment argument: identifier is empty");if(r){let i=`-${r}`.match(this.options.loose?Rz[kz.PRERELEASELOOSE]:Rz[kz.PRERELEASE]);if(!i||i[1]!==r)throw new Error(`invalid identifier: ${r}`)}}switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",r,n);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",r,n);break;case"prepatch":this.prerelease.length=0,this.inc("patch",r,n),this.inc("pre",r,n);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",r,n),this.inc("pre",r,n);break;case"release":if(this.prerelease.length===0)throw new Error(`version ${this.raw} is not a prerelease`);this.prerelease.length=0;break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":{let i=Number(n)?1:0;if(this.prerelease.length===0)this.prerelease=[i];else{let o=this.prerelease.length;for(;--o>=0;)typeof this.prerelease[o]=="number"&&(this.prerelease[o]++,o=-2);if(o===-1){if(r===this.prerelease.join(".")&&n===!1)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(i)}}if(r){let o=[r,i];n===!1&&(o=[r]),cB(this.prerelease[0],r)===0?isNaN(this.prerelease[1])&&(this.prerelease=o):this.prerelease=o}break}default:throw new Error(`invalid increment argument: ${e}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}};Q7e.exports=Nge});var X2=H((mcn,q7e)=>{"use strict";d();var U7e=Fd(),k3t=s((t,e,r=!1)=>{if(t instanceof U7e)return t;try{return new U7e(t,e)}catch(n){if(!r)return null;throw n}},"parse");q7e.exports=k3t});var $7e=H((Acn,H7e)=>{"use strict";d();var P3t=X2(),D3t=s((t,e)=>{let r=P3t(t,e);return r?r.version:null},"valid");H7e.exports=D3t});var j7e=H((vcn,W7e)=>{"use strict";d();var B3t=X2(),N3t=s((t,e)=>{let r=B3t(t.trim().replace(/^[=v]+/,""),e);return r?r.version:null},"clean");W7e.exports=N3t});var z7e=H((bcn,V7e)=>{"use strict";d();var G7e=Fd(),M3t=s((t,e,r,n,i)=>{typeof r=="string"&&(i=n,n=r,r=void 0);try{return new G7e(t instanceof G7e?t.version:t,r).inc(e,n,i).version}catch{return null}},"inc");V7e.exports=M3t});var J7e=H((wcn,Y7e)=>{"use strict";d();var K7e=X2(),L3t=s((t,e)=>{let r=K7e(t,null,!0),n=K7e(e,null,!0),i=r.compare(n);if(i===0)return null;let o=i>0,a=o?r:n,c=o?n:r,l=!!a.prerelease.length;if(!!c.prerelease.length&&!l){if(!c.patch&&!c.minor)return"major";if(c.compareMain(a)===0)return c.minor&&!c.patch?"minor":"patch"}let f=l?"pre":"";return r.major!==n.major?f+"major":r.minor!==n.minor?f+"minor":r.patch!==n.patch?f+"patch":"prerelease"},"diff");Y7e.exports=L3t});var Z7e=H((Rcn,X7e)=>{"use strict";d();var F3t=Fd(),O3t=s((t,e)=>new F3t(t,e).major,"major");X7e.exports=O3t});var tQe=H((Dcn,eQe)=>{"use strict";d();var Q3t=Fd(),U3t=s((t,e)=>new Q3t(t,e).minor,"minor");eQe.exports=U3t});var nQe=H((Mcn,rQe)=>{"use strict";d();var q3t=Fd(),H3t=s((t,e)=>new q3t(t,e).patch,"patch");rQe.exports=H3t});var oQe=H((Ocn,iQe)=>{"use strict";d();var $3t=X2(),W3t=s((t,e)=>{let r=$3t(t,e);return r&&r.prerelease.length?r.prerelease:null},"prerelease");iQe.exports=W3t});var nh=H((qcn,aQe)=>{"use strict";d();var sQe=Fd(),j3t=s((t,e,r)=>new sQe(t,r).compare(new sQe(e,r)),"compare");aQe.exports=j3t});var lQe=H((Wcn,cQe)=>{"use strict";d();var G3t=nh(),V3t=s((t,e,r)=>G3t(e,t,r),"rcompare");cQe.exports=V3t});var dQe=H((Vcn,uQe)=>{"use strict";d();var z3t=nh(),K3t=s((t,e)=>z3t(t,e,!0),"compareLoose");uQe.exports=K3t});var Pz=H((Ycn,pQe)=>{"use strict";d();var fQe=Fd(),Y3t=s((t,e,r)=>{let n=new fQe(t,r),i=new fQe(e,r);return n.compare(i)||n.compareBuild(i)},"compareBuild");pQe.exports=Y3t});var hQe=H((Zcn,mQe)=>{"use strict";d();var J3t=Pz(),X3t=s((t,e)=>t.sort((r,n)=>J3t(r,n,e)),"sort");mQe.exports=X3t});var AQe=H((rln,gQe)=>{"use strict";d();var Z3t=Pz(),eNt=s((t,e)=>t.sort((r,n)=>Z3t(n,r,e)),"rsort");gQe.exports=eNt});var N6=H((oln,yQe)=>{"use strict";d();var tNt=nh(),rNt=s((t,e,r)=>tNt(t,e,r)>0,"gt");yQe.exports=rNt});var Dz=H((cln,CQe)=>{"use strict";d();var nNt=nh(),iNt=s((t,e,r)=>nNt(t,e,r)<0,"lt");CQe.exports=iNt});var Mge=H((dln,vQe)=>{"use strict";d();var oNt=nh(),sNt=s((t,e,r)=>oNt(t,e,r)===0,"eq");vQe.exports=sNt});var Lge=H((mln,xQe)=>{"use strict";d();var aNt=nh(),cNt=s((t,e,r)=>aNt(t,e,r)!==0,"neq");xQe.exports=cNt});var Bz=H((Aln,EQe)=>{"use strict";d();var lNt=nh(),uNt=s((t,e,r)=>lNt(t,e,r)>=0,"gte");EQe.exports=uNt});var Nz=H((vln,bQe)=>{"use strict";d();var dNt=nh(),fNt=s((t,e,r)=>dNt(t,e,r)<=0,"lte");bQe.exports=fNt});var Fge=H((bln,IQe)=>{"use strict";d();var pNt=Mge(),mNt=Lge(),hNt=N6(),gNt=Bz(),ANt=Dz(),yNt=Nz(),CNt=s((t,e,r,n)=>{switch(e){case"===":return typeof t=="object"&&(t=t.version),typeof r=="object"&&(r=r.version),t===r;case"!==":return typeof t=="object"&&(t=t.version),typeof r=="object"&&(r=r.version),t!==r;case"":case"=":case"==":return pNt(t,r,n);case"!=":return mNt(t,r,n);case">":return hNt(t,r,n);case">=":return gNt(t,r,n);case"<":return ANt(t,r,n);case"<=":return yNt(t,r,n);default:throw new TypeError(`Invalid operator: ${e}`)}},"cmp");IQe.exports=CNt});var wQe=H((wln,TQe)=>{"use strict";d();var vNt=Fd(),xNt=X2(),{safeRe:Mz,t:Lz}=aB(),ENt=s((t,e)=>{if(t instanceof vNt)return t;if(typeof t=="number"&&(t=String(t)),typeof t!="string")return null;e=e||{};let r=null;if(!e.rtl)r=t.match(e.includePrerelease?Mz[Lz.COERCEFULL]:Mz[Lz.COERCE]);else{let l=e.includePrerelease?Mz[Lz.COERCERTLFULL]:Mz[Lz.COERCERTL],u;for(;(u=l.exec(t))&&(!r||r.index+r[0].length!==t.length);)(!r||u.index+u[0].length!==r.index+r[0].length)&&(r=u),l.lastIndex=u.index+u[1].length+u[2].length;l.lastIndex=-1}if(r===null)return null;let n=r[2],i=r[3]||"0",o=r[4]||"0",a=e.includePrerelease&&r[5]?`-${r[5]}`:"",c=e.includePrerelease&&r[6]?`+${r[6]}`:"";return xNt(`${n}.${i}.${o}${a}${c}`,e)},"coerce");TQe.exports=ENt});var _Qe=H((Rln,SQe)=>{"use strict";d();var Oge=class{static{s(this,"LRUCache")}constructor(){this.max=1e3,this.map=new Map}get(e){let r=this.map.get(e);if(r!==void 0)return this.map.delete(e),this.map.set(e,r),r}delete(e){return this.map.delete(e)}set(e,r){if(!this.delete(e)&&r!==void 0){if(this.map.size>=this.max){let i=this.map.keys().next().value;this.delete(i)}this.map.set(e,r)}return this}};SQe.exports=Oge});var ih=H((Dln,DQe)=>{"use strict";d();var bNt=/\s+/g,Qge=class t{static{s(this,"Range")}constructor(e,r){if(r=TNt(r),e instanceof t)return e.loose===!!r.loose&&e.includePrerelease===!!r.includePrerelease?e:new t(e.raw,r);if(e instanceof Uge)return this.raw=e.value,this.set=[[e]],this.formatted=void 0,this;if(this.options=r,this.loose=!!r.loose,this.includePrerelease=!!r.includePrerelease,this.raw=e.trim().replace(bNt," "),this.set=this.raw.split("||").map(n=>this.parseRange(n.trim())).filter(n=>n.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${this.raw}`);if(this.set.length>1){let n=this.set[0];if(this.set=this.set.filter(i=>!kQe(i[0])),this.set.length===0)this.set=[n];else if(this.set.length>1){for(let i of this.set)if(i.length===1&&DNt(i[0])){this.set=[i];break}}}this.formatted=void 0}get range(){if(this.formatted===void 0){this.formatted="";for(let e=0;e<this.set.length;e++){e>0&&(this.formatted+="||");let r=this.set[e];for(let n=0;n<r.length;n++)n>0&&(this.formatted+=" "),this.formatted+=r[n].toString().trim()}}return this.formatted}format(){return this.range}toString(){return this.range}parseRange(e){let n=((this.options.includePrerelease&&kNt)|(this.options.loose&&PNt))+":"+e,i=RQe.get(n);if(i)return i;let o=this.options.loose,a=o?yp[vf.HYPHENRANGELOOSE]:yp[vf.HYPHENRANGE];e=e.replace(a,HNt(this.options.includePrerelease)),oa("hyphen replace",e),e=e.replace(yp[vf.COMPARATORTRIM],SNt),oa("comparator trim",e),e=e.replace(yp[vf.TILDETRIM],_Nt),oa("tilde trim",e),e=e.replace(yp[vf.CARETTRIM],RNt),oa("caret trim",e);let c=e.split(" ").map(p=>BNt(p,this.options)).join(" ").split(/\s+/).map(p=>qNt(p,this.options));o&&(c=c.filter(p=>(oa("loose invalid filter",p,this.options),!!p.match(yp[vf.COMPARATORLOOSE])))),oa("range list",c);let l=new Map,u=c.map(p=>new Uge(p,this.options));for(let p of u){if(kQe(p))return[p];l.set(p.value,p)}l.size>1&&l.has("")&&l.delete("");let f=[...l.values()];return RQe.set(n,f),f}intersects(e,r){if(!(e instanceof t))throw new TypeError("a Range is required");return this.set.some(n=>PQe(n,r)&&e.set.some(i=>PQe(i,r)&&n.every(o=>i.every(a=>o.intersects(a,r)))))}test(e){if(!e)return!1;if(typeof e=="string")try{e=new wNt(e,this.options)}catch{return!1}for(let r=0;r<this.set.length;r++)if($Nt(this.set[r],e,this.options))return!0;return!1}};DQe.exports=Qge;var INt=_Qe(),RQe=new INt,TNt=wz(),Uge=M6(),oa=B6(),wNt=Fd(),{safeRe:yp,t:vf,comparatorTrimReplace:SNt,tildeTrimReplace:_Nt,caretTrimReplace:RNt}=aB(),{FLAG_INCLUDE_PRERELEASE:kNt,FLAG_LOOSE:PNt}=D6(),kQe=s(t=>t.value==="<0.0.0-0","isNullSet"),DNt=s(t=>t.value==="","isAny"),PQe=s((t,e)=>{let r=!0,n=t.slice(),i=n.pop();for(;r&&n.length;)r=n.every(o=>i.intersects(o,e)),i=n.pop();return r},"isSatisfiable"),BNt=s((t,e)=>(oa("comp",t,e),t=LNt(t,e),oa("caret",t),t=NNt(t,e),oa("tildes",t),t=ONt(t,e),oa("xrange",t),t=UNt(t,e),oa("stars",t),t),"parseComparator"),xf=s(t=>!t||t.toLowerCase()==="x"||t==="*","isX"),NNt=s((t,e)=>t.trim().split(/\s+/).map(r=>MNt(r,e)).join(" "),"replaceTildes"),MNt=s((t,e)=>{let r=e.loose?yp[vf.TILDELOOSE]:yp[vf.TILDE];return t.replace(r,(n,i,o,a,c)=>{oa("tilde",t,n,i,o,a,c);let l;return xf(i)?l="":xf(o)?l=`>=${i}.0.0 <${+i+1}.0.0-0`:xf(a)?l=`>=${i}.${o}.0 <${i}.${+o+1}.0-0`:c?(oa("replaceTilde pr",c),l=`>=${i}.${o}.${a}-${c} <${i}.${+o+1}.0-0`):l=`>=${i}.${o}.${a} <${i}.${+o+1}.0-0`,oa("tilde return",l),l})},"replaceTilde"),LNt=s((t,e)=>t.trim().split(/\s+/).map(r=>FNt(r,e)).join(" "),"replaceCarets"),FNt=s((t,e)=>{oa("caret",t,e);let r=e.loose?yp[vf.CARETLOOSE]:yp[vf.CARET],n=e.includePrerelease?"-0":"";return t.replace(r,(i,o,a,c,l)=>{oa("caret",t,i,o,a,c,l);let u;return xf(o)?u="":xf(a)?u=`>=${o}.0.0${n} <${+o+1}.0.0-0`:xf(c)?o==="0"?u=`>=${o}.${a}.0${n} <${o}.${+a+1}.0-0`:u=`>=${o}.${a}.0${n} <${+o+1}.0.0-0`:l?(oa("replaceCaret pr",l),o==="0"?a==="0"?u=`>=${o}.${a}.${c}-${l} <${o}.${a}.${+c+1}-0`:u=`>=${o}.${a}.${c}-${l} <${o}.${+a+1}.0-0`:u=`>=${o}.${a}.${c}-${l} <${+o+1}.0.0-0`):(oa("no pr"),o==="0"?a==="0"?u=`>=${o}.${a}.${c}${n} <${o}.${a}.${+c+1}-0`:u=`>=${o}.${a}.${c}${n} <${o}.${+a+1}.0-0`:u=`>=${o}.${a}.${c} <${+o+1}.0.0-0`),oa("caret return",u),u})},"replaceCaret"),ONt=s((t,e)=>(oa("replaceXRanges",t,e),t.split(/\s+/).map(r=>QNt(r,e)).join(" ")),"replaceXRanges"),QNt=s((t,e)=>{t=t.trim();let r=e.loose?yp[vf.XRANGELOOSE]:yp[vf.XRANGE];return t.replace(r,(n,i,o,a,c,l)=>{oa("xRange",t,n,i,o,a,c,l);let u=xf(o),f=u||xf(a),p=f||xf(c),m=p;return i==="="&&m&&(i=""),l=e.includePrerelease?"-0":"",u?i===">"||i==="<"?n="<0.0.0-0":n="*":i&&m?(f&&(a=0),c=0,i===">"?(i=">=",f?(o=+o+1,a=0,c=0):(a=+a+1,c=0)):i==="<="&&(i="<",f?o=+o+1:a=+a+1),i==="<"&&(l="-0"),n=`${i+o}.${a}.${c}${l}`):f?n=`>=${o}.0.0${l} <${+o+1}.0.0-0`:p&&(n=`>=${o}.${a}.0${l} <${o}.${+a+1}.0-0`),oa("xRange return",n),n})},"replaceXRange"),UNt=s((t,e)=>(oa("replaceStars",t,e),t.trim().replace(yp[vf.STAR],"")),"replaceStars"),qNt=s((t,e)=>(oa("replaceGTE0",t,e),t.trim().replace(yp[e.includePrerelease?vf.GTE0PRE:vf.GTE0],"")),"replaceGTE0"),HNt=s(t=>(e,r,n,i,o,a,c,l,u,f,p,m)=>(xf(n)?r="":xf(i)?r=`>=${n}.0.0${t?"-0":""}`:xf(o)?r=`>=${n}.${i}.0${t?"-0":""}`:a?r=`>=${r}`:r=`>=${r}${t?"-0":""}`,xf(u)?l="":xf(f)?l=`<${+u+1}.0.0-0`:xf(p)?l=`<${u}.${+f+1}.0-0`:m?l=`<=${u}.${f}.${p}-${m}`:t?l=`<${u}.${f}.${+p+1}-0`:l=`<=${l}`,`${r} ${l}`.trim()),"hyphenReplace"),$Nt=s((t,e,r)=>{for(let n=0;n<t.length;n++)if(!t[n].test(e))return!1;if(e.prerelease.length&&!r.includePrerelease){for(let n=0;n<t.length;n++)if(oa(t[n].semver),t[n].semver!==Uge.ANY&&t[n].semver.prerelease.length>0){let i=t[n].semver;if(i.major===e.major&&i.minor===e.minor&&i.patch===e.patch)return!0}return!1}return!0},"testSet")});var M6=H((Mln,OQe)=>{"use strict";d();var L6=Symbol("SemVer ANY"),$ge=class t{static{s(this,"Comparator")}static get ANY(){return L6}constructor(e,r){if(r=BQe(r),e instanceof t){if(e.loose===!!r.loose)return e;e=e.value}e=e.trim().split(/\s+/).join(" "),Hge("comparator",e,r),this.options=r,this.loose=!!r.loose,this.parse(e),this.semver===L6?this.value="":this.value=this.operator+this.semver.version,Hge("comp",this)}parse(e){let r=this.options.loose?NQe[MQe.COMPARATORLOOSE]:NQe[MQe.COMPARATOR],n=e.match(r);if(!n)throw new TypeError(`Invalid comparator: ${e}`);this.operator=n[1]!==void 0?n[1]:"",this.operator==="="&&(this.operator=""),n[2]?this.semver=new LQe(n[2],this.options.loose):this.semver=L6}toString(){return this.value}test(e){if(Hge("Comparator.test",e,this.options.loose),this.semver===L6||e===L6)return!0;if(typeof e=="string")try{e=new LQe(e,this.options)}catch{return!1}return qge(e,this.operator,this.semver,this.options)}intersects(e,r){if(!(e instanceof t))throw new TypeError("a Comparator is required");return this.operator===""?this.value===""?!0:new FQe(e.value,r).test(this.value):e.operator===""?e.value===""?!0:new FQe(this.value,r).test(e.semver):(r=BQe(r),r.includePrerelease&&(this.value==="<0.0.0-0"||e.value==="<0.0.0-0")||!r.includePrerelease&&(this.value.startsWith("<0.0.0")||e.value.startsWith("<0.0.0"))?!1:!!(this.operator.startsWith(">")&&e.operator.startsWith(">")||this.operator.startsWith("<")&&e.operator.startsWith("<")||this.semver.version===e.semver.version&&this.operator.includes("=")&&e.operator.includes("=")||qge(this.semver,"<",e.semver,r)&&this.operator.startsWith(">")&&e.operator.startsWith("<")||qge(this.semver,">",e.semver,r)&&this.operator.startsWith("<")&&e.operator.startsWith(">")))}};OQe.exports=$ge;var BQe=wz(),{safeRe:NQe,t:MQe}=aB(),qge=Fge(),Hge=B6(),LQe=Fd(),FQe=ih()});var F6=H((Oln,QQe)=>{"use strict";d();var WNt=ih(),jNt=s((t,e,r)=>{try{e=new WNt(e,r)}catch{return!1}return e.test(t)},"satisfies");QQe.exports=jNt});var qQe=H((qln,UQe)=>{"use strict";d();var GNt=ih(),VNt=s((t,e)=>new GNt(t,e).set.map(r=>r.map(n=>n.value).join(" ").trim().split(" ")),"toComparators");UQe.exports=VNt});var $Qe=H((Wln,HQe)=>{"use strict";d();var zNt=Fd(),KNt=ih(),YNt=s((t,e,r)=>{let n=null,i=null,o=null;try{o=new KNt(e,r)}catch{return null}return t.forEach(a=>{o.test(a)&&(!n||i.compare(a)===-1)&&(n=a,i=new zNt(n,r))}),n},"maxSatisfying");HQe.exports=YNt});var jQe=H((Vln,WQe)=>{"use strict";d();var JNt=Fd(),XNt=ih(),ZNt=s((t,e,r)=>{let n=null,i=null,o=null;try{o=new XNt(e,r)}catch{return null}return t.forEach(a=>{o.test(a)&&(!n||i.compare(a)===1)&&(n=a,i=new JNt(n,r))}),n},"minSatisfying");WQe.exports=ZNt});var zQe=H((Yln,VQe)=>{"use strict";d();var Wge=Fd(),e8t=ih(),GQe=N6(),t8t=s((t,e)=>{t=new e8t(t,e);let r=new Wge("0.0.0");if(t.test(r)||(r=new Wge("0.0.0-0"),t.test(r)))return r;r=null;for(let n=0;n<t.set.length;++n){let i=t.set[n],o=null;i.forEach(a=>{let c=new Wge(a.semver.version);switch(a.operator){case">":c.prerelease.length===0?c.patch++:c.prerelease.push(0),c.raw=c.format();case"":case">=":(!o||GQe(c,o))&&(o=c);break;case"<":case"<=":break;default:throw new Error(`Unexpected operation: ${a.operator}`)}}),o&&(!r||GQe(r,o))&&(r=o)}return r&&t.test(r)?r:null},"minVersion");VQe.exports=t8t});var YQe=H((Zln,KQe)=>{"use strict";d();var r8t=ih(),n8t=s((t,e)=>{try{return new r8t(t,e).range||"*"}catch{return null}},"validRange");KQe.exports=n8t});var Fz=H((nun,eUe)=>{"use strict";d();var i8t=Fd(),ZQe=M6(),{ANY:o8t}=ZQe,s8t=ih(),a8t=F6(),JQe=N6(),XQe=Dz(),c8t=Nz(),l8t=Bz(),u8t=s((t,e,r,n)=>{t=new i8t(t,n),e=new s8t(e,n);let i,o,a,c,l;switch(r){case">":i=JQe,o=c8t,a=XQe,c=">",l=">=";break;case"<":i=XQe,o=l8t,a=JQe,c="<",l="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(a8t(t,e,n))return!1;for(let u=0;u<e.set.length;++u){let f=e.set[u],p=null,m=null;if(f.forEach(h=>{h.semver===o8t&&(h=new ZQe(">=0.0.0")),p=p||h,m=m||h,i(h.semver,p.semver,n)?p=h:a(h.semver,m.semver,n)&&(m=h)}),p.operator===c||p.operator===l||(!m.operator||m.operator===c)&&o(t,m.semver))return!1;if(m.operator===l&&a(t,m.semver))return!1}return!0},"outside");eUe.exports=u8t});var rUe=H((sun,tUe)=>{"use strict";d();var d8t=Fz(),f8t=s((t,e,r)=>d8t(t,e,">",r),"gtr");tUe.exports=f8t});var iUe=H((lun,nUe)=>{"use strict";d();var p8t=Fz(),m8t=s((t,e,r)=>p8t(t,e,"<",r),"ltr");nUe.exports=m8t});var aUe=H((fun,sUe)=>{"use strict";d();var oUe=ih(),h8t=s((t,e,r)=>(t=new oUe(t,r),e=new oUe(e,r),t.intersects(e,r)),"intersects");sUe.exports=h8t});var lUe=H((hun,cUe)=>{"use strict";d();var g8t=F6(),A8t=nh();cUe.exports=(t,e,r)=>{let n=[],i=null,o=null,a=t.sort((f,p)=>A8t(f,p,r));for(let f of a)g8t(f,e,r)?(o=f,i||(i=f)):(o&&n.push([i,o]),o=null,i=null);i&&n.push([i,null]);let c=[];for(let[f,p]of n)f===p?c.push(f):!p&&f===a[0]?c.push("*"):p?f===a[0]?c.push(`<=${p}`):c.push(`${f} - ${p}`):c.push(`>=${f}`);let l=c.join(" || "),u=typeof e.raw=="string"?e.raw:String(e);return l.length<u.length?l:e}});var hUe=H((Aun,mUe)=>{"use strict";d();var uUe=ih(),Gge=M6(),{ANY:jge}=Gge,O6=F6(),Vge=nh(),y8t=s((t,e,r={})=>{if(t===e)return!0;t=new uUe(t,r),e=new uUe(e,r);let n=!1;e:for(let i of t.set){for(let o of e.set){let a=v8t(i,o,r);if(n=n||a!==null,a)continue e}if(n)return!1}return!0},"subset"),C8t=[new Gge(">=0.0.0-0")],dUe=[new Gge(">=0.0.0")],v8t=s((t,e,r)=>{if(t===e)return!0;if(t.length===1&&t[0].semver===jge){if(e.length===1&&e[0].semver===jge)return!0;r.includePrerelease?t=C8t:t=dUe}if(e.length===1&&e[0].semver===jge){if(r.includePrerelease)return!0;e=dUe}let n=new Set,i,o;for(let h of t)h.operator===">"||h.operator===">="?i=fUe(i,h,r):h.operator==="<"||h.operator==="<="?o=pUe(o,h,r):n.add(h.semver);if(n.size>1)return null;let a;if(i&&o){if(a=Vge(i.semver,o.semver,r),a>0)return null;if(a===0&&(i.operator!==">="||o.operator!=="<="))return null}for(let h of n){if(i&&!O6(h,String(i),r)||o&&!O6(h,String(o),r))return null;for(let g of e)if(!O6(h,String(g),r))return!1;return!0}let c,l,u,f,p=o&&!r.includePrerelease&&o.semver.prerelease.length?o.semver:!1,m=i&&!r.includePrerelease&&i.semver.prerelease.length?i.semver:!1;p&&p.prerelease.length===1&&o.operator==="<"&&p.prerelease[0]===0&&(p=!1);for(let h of e){if(f=f||h.operator===">"||h.operator===">=",u=u||h.operator==="<"||h.operator==="<=",i){if(m&&h.semver.prerelease&&h.semver.prerelease.length&&h.semver.major===m.major&&h.semver.minor===m.minor&&h.semver.patch===m.patch&&(m=!1),h.operator===">"||h.operator===">="){if(c=fUe(i,h,r),c===h&&c!==i)return!1}else if(i.operator===">="&&!O6(i.semver,String(h),r))return!1}if(o){if(p&&h.semver.prerelease&&h.semver.prerelease.length&&h.semver.major===p.major&&h.semver.minor===p.minor&&h.semver.patch===p.patch&&(p=!1),h.operator==="<"||h.operator==="<="){if(l=pUe(o,h,r),l===h&&l!==o)return!1}else if(o.operator==="<="&&!O6(o.semver,String(h),r))return!1}if(!h.operator&&(o||i)&&a!==0)return!1}return!(i&&u&&!o&&a!==0||o&&f&&!i&&a!==0||m||p)},"simpleSubset"),fUe=s((t,e,r)=>{if(!t)return e;let n=Vge(t.semver,e.semver,r);return n>0?t:n<0||e.operator===">"&&t.operator===">="?e:t},"higherGT"),pUe=s((t,e,r)=>{if(!t)return e;let n=Vge(t.semver,e.semver,r);return n<0?t:n>0||e.operator==="<"&&t.operator==="<="?e:t},"lowerLT");mUe.exports=y8t});var lB=H((vun,yUe)=>{"use strict";d();var zge=aB(),gUe=D6(),x8t=Fd(),AUe=Bge(),E8t=X2(),b8t=$7e(),I8t=j7e(),T8t=z7e(),w8t=J7e(),S8t=Z7e(),_8t=tQe(),R8t=nQe(),k8t=oQe(),P8t=nh(),D8t=lQe(),B8t=dQe(),N8t=Pz(),M8t=hQe(),L8t=AQe(),F8t=N6(),O8t=Dz(),Q8t=Mge(),U8t=Lge(),q8t=Bz(),H8t=Nz(),$8t=Fge(),W8t=wQe(),j8t=M6(),G8t=ih(),V8t=F6(),z8t=qQe(),K8t=$Qe(),Y8t=jQe(),J8t=zQe(),X8t=YQe(),Z8t=Fz(),eMt=rUe(),tMt=iUe(),rMt=aUe(),nMt=lUe(),iMt=hUe();yUe.exports={parse:E8t,valid:b8t,clean:I8t,inc:T8t,diff:w8t,major:S8t,minor:_8t,patch:R8t,prerelease:k8t,compare:P8t,rcompare:D8t,compareLoose:B8t,compareBuild:N8t,sort:M8t,rsort:L8t,gt:F8t,lt:O8t,eq:Q8t,neq:U8t,gte:q8t,lte:H8t,cmp:$8t,coerce:W8t,Comparator:j8t,Range:G8t,satisfies:V8t,toComparators:z8t,maxSatisfying:K8t,minSatisfying:Y8t,minVersion:J8t,validRange:X8t,outside:Z8t,gtr:eMt,ltr:tMt,intersects:rMt,simplifyRange:nMt,subset:iMt,SemVer:x8t,re:zge.re,src:zge.src,tokens:zge.t,SEMVER_SPEC_VERSION:gUe.SEMVER_SPEC_VERSION,RELEASE_TYPES:gUe.RELEASE_TYPES,compareIdentifiers:AUe.compareIdentifiers,rcompareIdentifiers:AUe.rcompareIdentifiers}});var vUe=H((Eun,CUe)=>{d();var oMt=lB();CUe.exports=oMt.satisfies(process.version,">=15.7.0")});var EUe=H((Iun,xUe)=>{d();var sMt=lB();xUe.exports=sMt.satisfies(process.version,">=16.9.0")});var Kge=H((wun,bUe)=>{d();var aMt=vUe(),cMt=EUe(),lMt={ec:["ES256","ES384","ES512"],rsa:["RS256","PS256","RS384","PS384","RS512","PS512"],"rsa-pss":["PS256","PS384","PS512"]},uMt={ES256:"prime256v1",ES384:"secp384r1",ES512:"secp521r1"};bUe.exports=function(t,e){if(!t||!e)return;let r=e.asymmetricKeyType;if(!r)return;let n=lMt[r];if(!n)throw new Error(`Unknown key type "${r}".`);if(!n.includes(t))throw new Error(`"alg" parameter for "${r}" key type must be one of: ${n.join(", ")}.`);if(aMt)switch(r){case"ec":let i=e.asymmetricKeyDetails.namedCurve,o=uMt[t];if(i!==o)throw new Error(`"alg" parameter "${t}" requires curve "${o}".`);break;case"rsa-pss":if(cMt){let a=parseInt(t.slice(-3),10),{hashAlgorithm:c,mgf1HashAlgorithm:l,saltLength:u}=e.asymmetricKeyDetails;if(c!==`sha${a}`||l!==c)throw new Error(`Invalid key for this operation, its RSA-PSS parameters do not meet the requirements of "alg" ${t}.`);if(u!==void 0&&u>a>>3)throw new Error(`Invalid key for this operation, its RSA-PSS parameter saltLength does not meet the requirements of "alg" ${t}.`)}break}}});var Yge=H((_un,IUe)=>{d();var dMt=lB();IUe.exports=dMt.satisfies(process.version,"^6.12.0 || >=8.0.0")});var SUe=H((kun,wUe)=>{d();var Us=P6(),fMt=Sge(),TUe=_ge(),pMt=wge(),mMt=kge(),hMt=Kge(),gMt=Yge(),AMt=xz(),{KeyObject:yMt,createSecretKey:CMt,createPublicKey:vMt}=require("crypto"),Jge=["RS256","RS384","RS512"],xMt=["ES256","ES384","ES512"],Xge=["RS256","RS384","RS512"],EMt=["HS256","HS384","HS512"];gMt&&(Jge.splice(Jge.length,0,"PS256","PS384","PS512"),Xge.splice(Xge.length,0,"PS256","PS384","PS512"));wUe.exports=function(t,e,r,n){typeof r=="function"&&!n&&(n=r,r={}),r||(r={}),r=Object.assign({},r);let i;if(n?i=n:i=s(function(f,p){if(f)throw f;return p},"done"),r.clockTimestamp&&typeof r.clockTimestamp!="number")return i(new Us("clockTimestamp must be a number"));if(r.nonce!==void 0&&(typeof r.nonce!="string"||r.nonce.trim()===""))return i(new Us("nonce must be a non-empty string"));if(r.allowInvalidAsymmetricKeyTypes!==void 0&&typeof r.allowInvalidAsymmetricKeyTypes!="boolean")return i(new Us("allowInvalidAsymmetricKeyTypes must be a boolean"));let o=r.clockTimestamp||Math.floor(Date.now()/1e3);if(!t)return i(new Us("jwt must be provided"));if(typeof t!="string")return i(new Us("jwt must be a string"));let a=t.split(".");if(a.length!==3)return i(new Us("jwt malformed"));let c;try{c=pMt(t,{complete:!0})}catch(f){return i(f)}if(!c)return i(new Us("invalid token"));let l=c.header,u;if(typeof e=="function"){if(!n)return i(new Us("verify must be called asynchronous if secret or public key is provided as a callback"));u=e}else u=s(function(f,p){return p(null,e)},"getSecret");return u(l,function(f,p){if(f)return i(new Us("error in secret or public key callback: "+f.message));let m=a[2].trim()!=="";if(!m&&p)return i(new Us("jwt signature is required"));if(m&&!p)return i(new Us("secret or public key must be provided"));if(!m&&!r.algorithms)return i(new Us('please specify "none" in "algorithms" to verify unsigned tokens'));if(p!=null&&!(p instanceof yMt))try{p=vMt(p)}catch{try{p=CMt(typeof p=="string"?Buffer.from(p):p)}catch{return i(new Us("secretOrPublicKey is not valid key material"))}}if(r.algorithms||(p.type==="secret"?r.algorithms=EMt:["rsa","rsa-pss"].includes(p.asymmetricKeyType)?r.algorithms=Xge:p.asymmetricKeyType==="ec"?r.algorithms=xMt:r.algorithms=Jge),r.algorithms.indexOf(c.header.alg)===-1)return i(new Us("invalid algorithm"));if(l.alg.startsWith("HS")&&p.type!=="secret")return i(new Us(`secretOrPublicKey must be a symmetric key when using ${l.alg}`));if(/^(?:RS|PS|ES)/.test(l.alg)&&p.type!=="public")return i(new Us(`secretOrPublicKey must be an asymmetric key when using ${l.alg}`));if(!r.allowInvalidAsymmetricKeyTypes)try{hMt(l.alg,p)}catch(A){return i(A)}let h;try{h=AMt.verify(t,c.header.alg,p)}catch(A){return i(A)}if(!h)return i(new Us("invalid signature"));let g=c.payload;if(typeof g.nbf<"u"&&!r.ignoreNotBefore){if(typeof g.nbf!="number")return i(new Us("invalid nbf value"));if(g.nbf>o+(r.clockTolerance||0))return i(new fMt("jwt not active",new Date(g.nbf*1e3)))}if(typeof g.exp<"u"&&!r.ignoreExpiration){if(typeof g.exp!="number")return i(new Us("invalid exp value"));if(o>=g.exp+(r.clockTolerance||0))return i(new TUe("jwt expired",new Date(g.exp*1e3)))}if(r.audience){let A=Array.isArray(r.audience)?r.audience:[r.audience];if(!(Array.isArray(g.aud)?g.aud:[g.aud]).some(function(b){return A.some(function(S){return S instanceof RegExp?S.test(b):S===b})}))return i(new Us("jwt audience invalid. expected: "+A.join(" or ")))}if(r.issuer&&(typeof r.issuer=="string"&&g.iss!==r.issuer||Array.isArray(r.issuer)&&r.issuer.indexOf(g.iss)===-1))return i(new Us("jwt issuer invalid. expected: "+r.issuer));if(r.subject&&g.sub!==r.subject)return i(new Us("jwt subject invalid. expected: "+r.subject));if(r.jwtid&&g.jti!==r.jwtid)return i(new Us("jwt jwtid invalid. expected: "+r.jwtid));if(r.nonce&&g.nonce!==r.nonce)return i(new Us("jwt nonce invalid. expected: "+r.nonce));if(r.maxAge){if(typeof g.iat!="number")return i(new Us("iat required when maxAge is specified"));let A=mMt(r.maxAge,g.iat);if(typeof A>"u")return i(new Us('"maxAge" should be a number of seconds or string representing a timespan eg: "1d", "20h", 60'));if(o>=A+(r.clockTolerance||0))return i(new TUe("maxAge exceeded",new Date(A*1e3)))}if(r.complete===!0){let A=c.signature;return i(null,{header:l,payload:g,signature:A})}return i(null,g)})}});var BUe=H((Nun,DUe)=>{d();var _Ue=1/0,kUe=9007199254740991,bMt=17976931348623157e292,RUe=NaN,IMt="[object Arguments]",TMt="[object Function]",wMt="[object GeneratorFunction]",SMt="[object String]",_Mt="[object Symbol]",RMt=/^\s+|\s+$/g,kMt=/^[-+]0x[0-9a-f]+$/i,PMt=/^0b[01]+$/i,DMt=/^0o[0-7]+$/i,BMt=/^(?:0|[1-9]\d*)$/,NMt=parseInt;function MMt(t,e){for(var r=-1,n=t?t.length:0,i=Array(n);++r<n;)i[r]=e(t[r],r,t);return i}s(MMt,"arrayMap");function LMt(t,e,r,n){for(var i=t.length,o=r+(n?1:-1);n?o--:++o<i;)if(e(t[o],o,t))return o;return-1}s(LMt,"baseFindIndex");function FMt(t,e,r){if(e!==e)return LMt(t,OMt,r);for(var n=r-1,i=t.length;++n<i;)if(t[n]===e)return n;return-1}s(FMt,"baseIndexOf");function OMt(t){return t!==t}s(OMt,"baseIsNaN");function QMt(t,e){for(var r=-1,n=Array(t);++r<t;)n[r]=e(r);return n}s(QMt,"baseTimes");function UMt(t,e){return MMt(e,function(r){return t[r]})}s(UMt,"baseValues");function qMt(t,e){return function(r){return t(e(r))}}s(qMt,"overArg");var Oz=Object.prototype,eAe=Oz.hasOwnProperty,Qz=Oz.toString,HMt=Oz.propertyIsEnumerable,$Mt=qMt(Object.keys,Object),WMt=Math.max;function jMt(t,e){var r=PUe(t)||YMt(t)?QMt(t.length,String):[],n=r.length,i=!!n;for(var o in t)(e||eAe.call(t,o))&&!(i&&(o=="length"||VMt(o,n)))&&r.push(o);return r}s(jMt,"arrayLikeKeys");function GMt(t){if(!zMt(t))return $Mt(t);var e=[];for(var r in Object(t))eAe.call(t,r)&&r!="constructor"&&e.push(r);return e}s(GMt,"baseKeys");function VMt(t,e){return e=e??kUe,!!e&&(typeof t=="number"||BMt.test(t))&&t>-1&&t%1==0&&t<e}s(VMt,"isIndex");function zMt(t){var e=t&&t.constructor,r=typeof e=="function"&&e.prototype||Oz;return t===r}s(zMt,"isPrototype");function KMt(t,e,r,n){t=tAe(t)?t:sLt(t),r=r&&!n?nLt(r):0;var i=t.length;return r<0&&(r=WMt(i+r,0)),eLt(t)?r<=i&&t.indexOf(e,r)>-1:!!i&&FMt(t,e,r)>-1}s(KMt,"includes");function YMt(t){return JMt(t)&&eAe.call(t,"callee")&&(!HMt.call(t,"callee")||Qz.call(t)==IMt)}s(YMt,"isArguments");var PUe=Array.isArray;function tAe(t){return t!=null&&ZMt(t.length)&&!XMt(t)}s(tAe,"isArrayLike");function JMt(t){return rAe(t)&&tAe(t)}s(JMt,"isArrayLikeObject");function XMt(t){var e=Zge(t)?Qz.call(t):"";return e==TMt||e==wMt}s(XMt,"isFunction");function ZMt(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=kUe}s(ZMt,"isLength");function Zge(t){var e=typeof t;return!!t&&(e=="object"||e=="function")}s(Zge,"isObject");function rAe(t){return!!t&&typeof t=="object"}s(rAe,"isObjectLike");function eLt(t){return typeof t=="string"||!PUe(t)&&rAe(t)&&Qz.call(t)==SMt}s(eLt,"isString");function tLt(t){return typeof t=="symbol"||rAe(t)&&Qz.call(t)==_Mt}s(tLt,"isSymbol");function rLt(t){if(!t)return t===0?t:0;if(t=iLt(t),t===_Ue||t===-_Ue){var e=t<0?-1:1;return e*bMt}return t===t?t:0}s(rLt,"toFinite");function nLt(t){var e=rLt(t),r=e%1;return e===e?r?e-r:e:0}s(nLt,"toInteger");function iLt(t){if(typeof t=="number")return t;if(tLt(t))return RUe;if(Zge(t)){var e=typeof t.valueOf=="function"?t.valueOf():t;t=Zge(e)?e+"":e}if(typeof t!="string")return t===0?t:+t;t=t.replace(RMt,"");var r=PMt.test(t);return r||DMt.test(t)?NMt(t.slice(2),r?2:8):kMt.test(t)?RUe:+t}s(iLt,"toNumber");function oLt(t){return tAe(t)?jMt(t):GMt(t)}s(oLt,"keys");function sLt(t){return t?UMt(t,oLt(t)):[]}s(sLt,"values");DUe.exports=KMt});var MUe=H((Fun,NUe)=>{d();var aLt="[object Boolean]",cLt=Object.prototype,lLt=cLt.toString;function uLt(t){return t===!0||t===!1||dLt(t)&&lLt.call(t)==aLt}s(uLt,"isBoolean");function dLt(t){return!!t&&typeof t=="object"}s(dLt,"isObjectLike");NUe.exports=uLt});var UUe=H((Uun,QUe)=>{d();var LUe=1/0,fLt=17976931348623157e292,FUe=NaN,pLt="[object Symbol]",mLt=/^\s+|\s+$/g,hLt=/^[-+]0x[0-9a-f]+$/i,gLt=/^0b[01]+$/i,ALt=/^0o[0-7]+$/i,yLt=parseInt,CLt=Object.prototype,vLt=CLt.toString;function xLt(t){return typeof t=="number"&&t==TLt(t)}s(xLt,"isInteger");function OUe(t){var e=typeof t;return!!t&&(e=="object"||e=="function")}s(OUe,"isObject");function ELt(t){return!!t&&typeof t=="object"}s(ELt,"isObjectLike");function bLt(t){return typeof t=="symbol"||ELt(t)&&vLt.call(t)==pLt}s(bLt,"isSymbol");function ILt(t){if(!t)return t===0?t:0;if(t=wLt(t),t===LUe||t===-LUe){var e=t<0?-1:1;return e*fLt}return t===t?t:0}s(ILt,"toFinite");function TLt(t){var e=ILt(t),r=e%1;return e===e?r?e-r:e:0}s(TLt,"toInteger");function wLt(t){if(typeof t=="number")return t;if(bLt(t))return FUe;if(OUe(t)){var e=typeof t.valueOf=="function"?t.valueOf():t;t=OUe(e)?e+"":e}if(typeof t!="string")return t===0?t:+t;t=t.replace(mLt,"");var r=gLt.test(t);return r||ALt.test(t)?yLt(t.slice(2),r?2:8):hLt.test(t)?FUe:+t}s(wLt,"toNumber");QUe.exports=xLt});var HUe=H(($un,qUe)=>{d();var SLt="[object Number]",_Lt=Object.prototype,RLt=_Lt.toString;function kLt(t){return!!t&&typeof t=="object"}s(kLt,"isObjectLike");function PLt(t){return typeof t=="number"||kLt(t)&&RLt.call(t)==SLt}s(PLt,"isNumber");qUe.exports=PLt});var GUe=H((Gun,jUe)=>{d();var DLt="[object Object]";function BLt(t){var e=!1;if(t!=null&&typeof t.toString!="function")try{e=!!(t+"")}catch{}return e}s(BLt,"isHostObject");function NLt(t,e){return function(r){return t(e(r))}}s(NLt,"overArg");var MLt=Function.prototype,$Ue=Object.prototype,WUe=MLt.toString,LLt=$Ue.hasOwnProperty,FLt=WUe.call(Object),OLt=$Ue.toString,QLt=NLt(Object.getPrototypeOf,Object);function ULt(t){return!!t&&typeof t=="object"}s(ULt,"isObjectLike");function qLt(t){if(!ULt(t)||OLt.call(t)!=DLt||BLt(t))return!1;var e=QLt(t);if(e===null)return!0;var r=LLt.call(e,"constructor")&&e.constructor;return typeof r=="function"&&r instanceof r&&WUe.call(r)==FLt}s(qLt,"isPlainObject");jUe.exports=qLt});var zUe=H((Kun,VUe)=>{d();var HLt="[object String]",$Lt=Object.prototype,WLt=$Lt.toString,jLt=Array.isArray;function GLt(t){return!!t&&typeof t=="object"}s(GLt,"isObjectLike");function VLt(t){return typeof t=="string"||!jLt(t)&&GLt(t)&&WLt.call(t)==HLt}s(VLt,"isString");VUe.exports=VLt});var ZUe=H((Xun,XUe)=>{d();var zLt="Expected a function",KUe=1/0,KLt=17976931348623157e292,YUe=NaN,YLt="[object Symbol]",JLt=/^\s+|\s+$/g,XLt=/^[-+]0x[0-9a-f]+$/i,ZLt=/^0b[01]+$/i,eFt=/^0o[0-7]+$/i,tFt=parseInt,rFt=Object.prototype,nFt=rFt.toString;function iFt(t,e){var r;if(typeof e!="function")throw new TypeError(zLt);return t=lFt(t),function(){return--t>0&&(r=e.apply(this,arguments)),t<=1&&(e=void 0),r}}s(iFt,"before");function oFt(t){return iFt(2,t)}s(oFt,"once");function JUe(t){var e=typeof t;return!!t&&(e=="object"||e=="function")}s(JUe,"isObject");function sFt(t){return!!t&&typeof t=="object"}s(sFt,"isObjectLike");function aFt(t){return typeof t=="symbol"||sFt(t)&&nFt.call(t)==YLt}s(aFt,"isSymbol");function cFt(t){if(!t)return t===0?t:0;if(t=uFt(t),t===KUe||t===-KUe){var e=t<0?-1:1;return e*KLt}return t===t?t:0}s(cFt,"toFinite");function lFt(t){var e=cFt(t),r=e%1;return e===e?r?e-r:e:0}s(lFt,"toInteger");function uFt(t){if(typeof t=="number")return t;if(aFt(t))return YUe;if(JUe(t)){var e=typeof t.valueOf=="function"?t.valueOf():t;t=JUe(e)?e+"":e}if(typeof t!="string")return t===0?t:+t;t=t.replace(JLt,"");var r=ZLt.test(t);return r||eFt.test(t)?tFt(t.slice(2),r?2:8):XLt.test(t)?YUe:+t}s(uFt,"toNumber");XUe.exports=oFt});var cqe=H((tdn,aqe)=>{d();var eqe=kge(),dFt=Yge(),fFt=Kge(),tqe=xz(),pFt=BUe(),Uz=MUe(),rqe=UUe(),nAe=HUe(),iqe=GUe(),sT=zUe(),mFt=ZUe(),{KeyObject:hFt,createSecretKey:gFt,createPrivateKey:AFt}=require("crypto"),oqe=["RS256","RS384","RS512","ES256","ES384","ES512","HS256","HS384","HS512","none"];dFt&&oqe.splice(3,0,"PS256","PS384","PS512");var yFt={expiresIn:{isValid:s(function(t){return rqe(t)||sT(t)&&t},"isValid"),message:'"expiresIn" should be a number of seconds or string representing a timespan'},notBefore:{isValid:s(function(t){return rqe(t)||sT(t)&&t},"isValid"),message:'"notBefore" should be a number of seconds or string representing a timespan'},audience:{isValid:s(function(t){return sT(t)||Array.isArray(t)},"isValid"),message:'"audience" must be a string or array'},algorithm:{isValid:pFt.bind(null,oqe),message:'"algorithm" must be a valid string enum value'},header:{isValid:iqe,message:'"header" must be an object'},encoding:{isValid:sT,message:'"encoding" must be a string'},issuer:{isValid:sT,message:'"issuer" must be a string'},subject:{isValid:sT,message:'"subject" must be a string'},jwtid:{isValid:sT,message:'"jwtid" must be a string'},noTimestamp:{isValid:Uz,message:'"noTimestamp" must be a boolean'},keyid:{isValid:sT,message:'"keyid" must be a string'},mutatePayload:{isValid:Uz,message:'"mutatePayload" must be a boolean'},allowInsecureKeySizes:{isValid:Uz,message:'"allowInsecureKeySizes" must be a boolean'},allowInvalidAsymmetricKeyTypes:{isValid:Uz,message:'"allowInvalidAsymmetricKeyTypes" must be a boolean'}},CFt={iat:{isValid:nAe,message:'"iat" should be a number of seconds'},exp:{isValid:nAe,message:'"exp" should be a number of seconds'},nbf:{isValid:nAe,message:'"nbf" should be a number of seconds'}};function sqe(t,e,r,n){if(!iqe(r))throw new Error('Expected "'+n+'" to be a plain object.');Object.keys(r).forEach(function(i){let o=t[i];if(!o){if(!e)throw new Error('"'+i+'" is not allowed in "'+n+'"');return}if(!o.isValid(r[i]))throw new Error(o.message)})}s(sqe,"validate");function vFt(t){return sqe(yFt,!1,t,"options")}s(vFt,"validateOptions");function xFt(t){return sqe(CFt,!0,t,"payload")}s(xFt,"validatePayload");var nqe={audience:"aud",issuer:"iss",subject:"sub",jwtid:"jti"},EFt=["expiresIn","notBefore","noTimestamp","audience","issuer","subject","jwtid"];aqe.exports=function(t,e,r,n){typeof r=="function"?(n=r,r={}):r=r||{};let i=typeof t=="object"&&!Buffer.isBuffer(t),o=Object.assign({alg:r.algorithm||"HS256",typ:i?"JWT":void 0,kid:r.keyid},r.header);function a(u){if(n)return n(u);throw u}if(s(a,"failure"),!e&&r.algorithm!=="none")return a(new Error("secretOrPrivateKey must have a value"));if(e!=null&&!(e instanceof hFt))try{e=AFt(e)}catch{try{e=gFt(typeof e=="string"?Buffer.from(e):e)}catch{return a(new Error("secretOrPrivateKey is not valid key material"))}}if(o.alg.startsWith("HS")&&e.type!=="secret")return a(new Error(`secretOrPrivateKey must be a symmetric key when using ${o.alg}`));if(/^(?:RS|PS|ES)/.test(o.alg)){if(e.type!=="private")return a(new Error(`secretOrPrivateKey must be an asymmetric key when using ${o.alg}`));if(!r.allowInsecureKeySizes&&!o.alg.startsWith("ES")&&e.asymmetricKeyDetails!==void 0&&e.asymmetricKeyDetails.modulusLength<2048)return a(new Error(`secretOrPrivateKey has a minimum key size of 2048 bits for ${o.alg}`))}if(typeof t>"u")return a(new Error("payload is required"));if(i){try{xFt(t)}catch(u){return a(u)}r.mutatePayload||(t=Object.assign({},t))}else{let u=EFt.filter(function(f){return typeof r[f]<"u"});if(u.length>0)return a(new Error("invalid "+u.join(",")+" option for "+typeof t+" payload"))}if(typeof t.exp<"u"&&typeof r.expiresIn<"u")return a(new Error('Bad "options.expiresIn" option the payload already has an "exp" property.'));if(typeof t.nbf<"u"&&typeof r.notBefore<"u")return a(new Error('Bad "options.notBefore" option the payload already has an "nbf" property.'));try{vFt(r)}catch(u){return a(u)}if(!r.allowInvalidAsymmetricKeyTypes)try{fFt(o.alg,e)}catch(u){return a(u)}let c=t.iat||Math.floor(Date.now()/1e3);if(r.noTimestamp?delete t.iat:i&&(t.iat=c),typeof r.notBefore<"u"){try{t.nbf=eqe(r.notBefore,c)}catch(u){return a(u)}if(typeof t.nbf>"u")return a(new Error('"notBefore" should be a number of seconds or string representing a timespan eg: "1d", "20h", 60'))}if(typeof r.expiresIn<"u"&&typeof t=="object"){try{t.exp=eqe(r.expiresIn,c)}catch(u){return a(u)}if(typeof t.exp>"u")return a(new Error('"expiresIn" should be a number of seconds or string representing a timespan eg: "1d", "20h", 60'))}Object.keys(nqe).forEach(function(u){let f=nqe[u];if(typeof r[u]<"u"){if(typeof t[f]<"u")return a(new Error('Bad "options.'+u+'" option. The payload already has an "'+f+'" property.'));t[f]=r[u]}});let l=r.encoding||"utf8";if(typeof n=="function")n=n&&mFt(n),tqe.createSign({header:o,privateKey:e,payload:t,encoding:l}).once("error",n).once("done",function(u){if(!r.allowInsecureKeySizes&&/^(?:RS|PS)/.test(o.alg)&&u.length<256)return n(new Error(`secretOrPrivateKey has a minimum key size of 2048 bits for ${o.alg}`));n(null,u)});else{let u=tqe.sign({header:o,payload:t,secret:e,encoding:l});if(!r.allowInsecureKeySizes&&/^(?:RS|PS)/.test(o.alg)&&u.length<256)throw new Error(`secretOrPrivateKey has a minimum key size of 2048 bits for ${o.alg}`);return u}}});var uqe=H((idn,lqe)=>{d();lqe.exports={decode:wge(),verify:SUe(),sign:cqe(),JsonWebTokenError:P6(),NotBeforeError:Sge(),TokenExpiredError:_ge()}});var BAe=H((OAn,iHe)=>{d();function E9t(t){r.debug=r,r.default=r,r.coerce=l,r.disable=o,r.enable=i,r.enabled=a,r.humanize=Rge(),r.destroy=u,Object.keys(t).forEach(f=>{r[f]=t[f]}),r.names=[],r.skips=[],r.formatters={};function e(f){let p=0;for(let m=0;m<f.length;m++)p=(p<<5)-p+f.charCodeAt(m),p|=0;return r.colors[Math.abs(p)%r.colors.length]}s(e,"selectColor"),r.selectColor=e;function r(f){let p,m=null,h,g;function A(...y){if(!A.enabled)return;let E=A,b=Number(new Date),S=b-(p||b);E.diff=S,E.prev=p,E.curr=b,p=b,y[0]=r.coerce(y[0]),typeof y[0]!="string"&&y.unshift("%O");let R=0;y[0]=y[0].replace(/%([a-zA-Z%])/g,(L,O)=>{if(L==="%%")return"%";R++;let Y=r.formatters[O];if(typeof Y=="function"){let V=y[R];L=Y.call(E,V),y.splice(R,1),R--}return L}),r.formatArgs.call(E,y),(E.log||r.log).apply(E,y)}return s(A,"debug"),A.namespace=f,A.useColors=r.useColors(),A.color=r.selectColor(f),A.extend=n,A.destroy=r.destroy,Object.defineProperty(A,"enabled",{enumerable:!0,configurable:!1,get:s(()=>m!==null?m:(h!==r.namespaces&&(h=r.namespaces,g=r.enabled(f)),g),"get"),set:s(y=>{m=y},"set")}),typeof r.init=="function"&&r.init(A),A}s(r,"createDebug");function n(f,p){let m=r(this.namespace+(typeof p>"u"?":":p)+f);return m.log=this.log,m}s(n,"extend");function i(f){r.save(f),r.namespaces=f,r.names=[],r.skips=[];let p,m=(typeof f=="string"?f:"").split(/[\s,]+/),h=m.length;for(p=0;p<h;p++)m[p]&&(f=m[p].replace(/\*/g,".*?"),f[0]==="-"?r.skips.push(new RegExp("^"+f.slice(1)+"$")):r.names.push(new RegExp("^"+f+"$")))}s(i,"enable");function o(){let f=[...r.names.map(c),...r.skips.map(c).map(p=>"-"+p)].join(",");return r.enable(""),f}s(o,"disable");function a(f){if(f[f.length-1]==="*")return!0;let p,m;for(p=0,m=r.skips.length;p<m;p++)if(r.skips[p].test(f))return!1;for(p=0,m=r.names.length;p<m;p++)if(r.names[p].test(f))return!0;return!1}s(a,"enabled");function c(f){return f.toString().substring(2,f.toString().length-2).replace(/\.\*\?$/,"*")}s(c,"toNamespace");function l(f){return f instanceof Error?f.stack||f.message:f}s(l,"coerce");function u(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return s(u,"destroy"),r.enable(r.load()),r}s(E9t,"setup");iHe.exports=E9t});var oHe=H((L0,hK)=>{d();L0.formatArgs=I9t;L0.save=T9t;L0.load=w9t;L0.useColors=b9t;L0.storage=S9t();L0.destroy=(()=>{let t=!1;return()=>{t||(t=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})();L0.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function b9t(){return typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}s(b9t,"useColors");function I9t(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+hK.exports.humanize(this.diff),!this.useColors)return;let e="color: "+this.color;t.splice(1,0,e,"color: inherit");let r=0,n=0;t[0].replace(/%[a-zA-Z%]/g,i=>{i!=="%%"&&(r++,i==="%c"&&(n=r))}),t.splice(n,0,e)}s(I9t,"formatArgs");L0.log=console.debug||console.log||(()=>{});function T9t(t){try{t?L0.storage.setItem("debug",t):L0.storage.removeItem("debug")}catch{}}s(T9t,"save");function w9t(){let t;try{t=L0.storage.getItem("debug")}catch{}return!t&&typeof process<"u"&&"env"in process&&(t=process.env.DEBUG),t}s(w9t,"load");function S9t(){try{return localStorage}catch{}}s(S9t,"localstorage");hK.exports=BAe()(L0);var{formatters:_9t}=hK.exports;_9t.j=function(t){try{return JSON.stringify(t)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}});var aHe=H(($An,sHe)=>{"use strict";d();sHe.exports=(t,e=process.argv)=>{let r=t.startsWith("-")?"":t.length===1?"-":"--",n=e.indexOf(r+t),i=e.indexOf("--");return n!==-1&&(i===-1||n<i)}});var uHe=H((jAn,lHe)=>{"use strict";d();var R9t=require("os"),cHe=require("tty"),sh=aHe(),{env:su}=process,dT;sh("no-color")||sh("no-colors")||sh("color=false")||sh("color=never")?dT=0:(sh("color")||sh("colors")||sh("color=true")||sh("color=always"))&&(dT=1);"FORCE_COLOR"in su&&(su.FORCE_COLOR==="true"?dT=1:su.FORCE_COLOR==="false"?dT=0:dT=su.FORCE_COLOR.length===0?1:Math.min(parseInt(su.FORCE_COLOR,10),3));function NAe(t){return t===0?!1:{level:t,hasBasic:!0,has256:t>=2,has16m:t>=3}}s(NAe,"translateLevel");function MAe(t,e){if(dT===0)return 0;if(sh("color=16m")||sh("color=full")||sh("color=truecolor"))return 3;if(sh("color=256"))return 2;if(t&&!e&&dT===void 0)return 0;let r=dT||0;if(su.TERM==="dumb")return r;if(process.platform==="win32"){let n=R9t.release().split(".");return Number(n[0])>=10&&Number(n[2])>=10586?Number(n[2])>=14931?3:2:1}if("CI"in su)return["TRAVIS","CIRCLECI","APPVEYOR","GITLAB_CI","GITHUB_ACTIONS","BUILDKITE"].some(n=>n in su)||su.CI_NAME==="codeship"?1:r;if("TEAMCITY_VERSION"in su)return/^(9\.(0*[1-9]\d*)\.|\d{2,}\.)/.test(su.TEAMCITY_VERSION)?1:0;if(su.COLORTERM==="truecolor")return 3;if("TERM_PROGRAM"in su){let n=parseInt((su.TERM_PROGRAM_VERSION||"").split(".")[0],10);switch(su.TERM_PROGRAM){case"iTerm.app":return n>=3?3:2;case"Apple_Terminal":return 2}}return/-256(color)?$/i.test(su.TERM)?2:/^screen|^xterm|^vt100|^vt220|^rxvt|color|ansi|cygwin|linux/i.test(su.TERM)||"COLORTERM"in su?1:r}s(MAe,"supportsColor");function k9t(t){let e=MAe(t,t&&t.isTTY);return NAe(e)}s(k9t,"getSupportLevel");lHe.exports={supportsColor:k9t,stdout:NAe(MAe(!0,cHe.isatty(1))),stderr:NAe(MAe(!0,cHe.isatty(2)))}});var fHe=H((Xu,AK)=>{d();var P9t=require("tty"),gK=require("util");Xu.init=O9t;Xu.log=M9t;Xu.formatArgs=B9t;Xu.save=L9t;Xu.load=F9t;Xu.useColors=D9t;Xu.destroy=gK.deprecate(()=>{},"Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.");Xu.colors=[6,2,3,4,5,1];try{let t=uHe();t&&(t.stderr||t).level>=2&&(Xu.colors=[20,21,26,27,32,33,38,39,40,41,42,43,44,45,56,57,62,63,68,69,74,75,76,77,78,79,80,81,92,93,98,99,112,113,128,129,134,135,148,149,160,161,162,163,164,165,166,167,168,169,170,171,172,173,178,179,184,185,196,197,198,199,200,201,202,203,204,205,206,207,208,209,214,215,220,221])}catch{}Xu.inspectOpts=Object.keys(process.env).filter(t=>/^debug_/i.test(t)).reduce((t,e)=>{let r=e.substring(6).toLowerCase().replace(/_([a-z])/g,(i,o)=>o.toUpperCase()),n=process.env[e];return/^(yes|on|true|enabled)$/i.test(n)?n=!0:/^(no|off|false|disabled)$/i.test(n)?n=!1:n==="null"?n=null:n=Number(n),t[r]=n,t},{});function D9t(){return"colors"in Xu.inspectOpts?!!Xu.inspectOpts.colors:P9t.isatty(process.stderr.fd)}s(D9t,"useColors");function B9t(t){let{namespace:e,useColors:r}=this;if(r){let n=this.color,i="\x1B[3"+(n<8?n:"8;5;"+n),o=`  ${i};1m${e} \x1B[0m`;t[0]=o+t[0].split(`
`).join(`
`+o),t.push(i+"m+"+AK.exports.humanize(this.diff)+"\x1B[0m")}else t[0]=N9t()+e+" "+t[0]}s(B9t,"formatArgs");function N9t(){return Xu.inspectOpts.hideDate?"":new Date().toISOString()+" "}s(N9t,"getDate");function M9t(...t){return process.stderr.write(gK.format(...t)+`
`)}s(M9t,"log");function L9t(t){t?process.env.DEBUG=t:delete process.env.DEBUG}s(L9t,"save");function F9t(){return process.env.DEBUG}s(F9t,"load");function O9t(t){t.inspectOpts={};let e=Object.keys(Xu.inspectOpts);for(let r=0;r<e.length;r++)t.inspectOpts[e[r]]=Xu.inspectOpts[e[r]]}s(O9t,"init");AK.exports=BAe()(Xu);var{formatters:dHe}=AK.exports;dHe.o=function(t){return this.inspectOpts.colors=this.useColors,gK.inspect(t,this.inspectOpts).split(`
`).map(e=>e.trim()).join(" ")};dHe.O=function(t){return this.inspectOpts.colors=this.useColors,gK.inspect(t,this.inspectOpts)}});var kC=H((YAn,LAe)=>{d();typeof process>"u"||process.type==="renderer"||process.browser===!0||process.__nwjs?LAe.exports=oHe():LAe.exports=fHe()});var hHe=H(xp=>{"use strict";d();var Q9t=xp&&xp.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:s(function(){return e[r]},"get")}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),U9t=xp&&xp.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),pHe=xp&&xp.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&Q9t(e,t,r);return U9t(e,t),e};Object.defineProperty(xp,"__esModule",{value:!0});xp.req=xp.json=xp.toBuffer=void 0;var q9t=pHe(require("http")),H9t=pHe(require("https"));async function mHe(t){let e=0,r=[];for await(let n of t)e+=n.length,r.push(n);return Buffer.concat(r,e)}s(mHe,"toBuffer");xp.toBuffer=mHe;async function $9t(t){let r=(await mHe(t)).toString("utf8");try{return JSON.parse(r)}catch(n){let i=n;throw i.message+=` (input: ${r})`,i}}s($9t,"json");xp.json=$9t;function W9t(t,e={}){let n=((typeof t=="string"?t:t.href).startsWith("https:")?H9t:q9t).request(t,e),i=new Promise((o,a)=>{n.once("response",o).once("error",a).end()});return n.then=i.then.bind(i),n}s(W9t,"req");xp.req=W9t});var OAe=H(F0=>{"use strict";d();var AHe=F0&&F0.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:s(function(){return e[r]},"get")}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),j9t=F0&&F0.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),yHe=F0&&F0.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&AHe(e,t,r);return j9t(e,t),e},G9t=F0&&F0.__exportStar||function(t,e){for(var r in t)r!=="default"&&!Object.prototype.hasOwnProperty.call(e,r)&&AHe(e,t,r)};Object.defineProperty(F0,"__esModule",{value:!0});F0.Agent=void 0;var V9t=yHe(require("net")),gHe=yHe(require("http")),z9t=require("https");G9t(hHe(),F0);var PC=Symbol("AgentBaseInternalState"),FAe=class extends gHe.Agent{static{s(this,"Agent")}constructor(e){super(e),this[PC]={}}isSecureEndpoint(e){if(e){if(typeof e.secureEndpoint=="boolean")return e.secureEndpoint;if(typeof e.protocol=="string")return e.protocol==="https:"}let{stack:r}=new Error;return typeof r!="string"?!1:r.split(`
`).some(n=>n.indexOf("(https.js:")!==-1||n.indexOf("node:https:")!==-1)}incrementSockets(e){if(this.maxSockets===1/0&&this.maxTotalSockets===1/0)return null;this.sockets[e]||(this.sockets[e]=[]);let r=new V9t.Socket({writable:!1});return this.sockets[e].push(r),this.totalSocketCount++,r}decrementSockets(e,r){if(!this.sockets[e]||r===null)return;let n=this.sockets[e],i=n.indexOf(r);i!==-1&&(n.splice(i,1),this.totalSocketCount--,n.length===0&&delete this.sockets[e])}getName(e){return(typeof e.secureEndpoint=="boolean"?e.secureEndpoint:this.isSecureEndpoint(e))?z9t.Agent.prototype.getName.call(this,e):super.getName(e)}createSocket(e,r,n){let i={...r,secureEndpoint:this.isSecureEndpoint(r)},o=this.getName(i),a=this.incrementSockets(o);Promise.resolve().then(()=>this.connect(e,i)).then(c=>{if(this.decrementSockets(o,a),c instanceof gHe.Agent)return c.addRequest(e,i);this[PC].currentSocket=c,super.createSocket(e,r,n)},c=>{this.decrementSockets(o,a),n(c)})}createConnection(){let e=this[PC].currentSocket;if(this[PC].currentSocket=void 0,!e)throw new Error("No socket was returned in the `connect()` function");return e}get defaultPort(){return this[PC].defaultPort??(this.protocol==="https:"?443:80)}set defaultPort(e){this[PC]&&(this[PC].defaultPort=e)}get protocol(){return this[PC].protocol??(this.isSecureEndpoint()?"https:":"http:")}set protocol(e){this[PC]&&(this[PC].protocol=e)}};F0.Agent=FAe});var CHe=H(bB=>{"use strict";d();var K9t=bB&&bB.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(bB,"__esModule",{value:!0});bB.parseProxyResponse=void 0;var Y9t=K9t(kC()),yK=(0,Y9t.default)("https-proxy-agent:parse-proxy-response");function J9t(t){return new Promise((e,r)=>{let n=0,i=[];function o(){let f=t.read();f?u(f):t.once("readable",o)}s(o,"read");function a(){t.removeListener("end",c),t.removeListener("error",l),t.removeListener("readable",o)}s(a,"cleanup");function c(){a(),yK("onend"),r(new Error("Proxy connection ended before receiving CONNECT response"))}s(c,"onend");function l(f){a(),yK("onerror %o",f),r(f)}s(l,"onerror");function u(f){i.push(f),n+=f.length;let p=Buffer.concat(i,n),m=p.indexOf(`\r
\r
`);if(m===-1){yK("have not received end of HTTP headers yet..."),o();return}let h=p.slice(0,m).toString("ascii").split(`\r
`),g=h.shift();if(!g)return t.destroy(),r(new Error("No header received from proxy CONNECT response"));let A=g.split(" "),y=+A[1],E=A.slice(2).join(" "),b={};for(let S of h){if(!S)continue;let R=S.indexOf(":");if(R===-1)return t.destroy(),r(new Error(`Invalid header from proxy CONNECT response: "${S}"`));let B=S.slice(0,R).toLowerCase(),L=S.slice(R+1).trimStart(),O=b[B];typeof O=="string"?b[B]=[O,L]:Array.isArray(O)?O.push(L):b[B]=L}yK("got proxy server response: %o %o",g,b),a(),e({connect:{statusCode:y,statusText:E,headers:b},buffered:p})}s(u,"ondata"),t.on("error",l),t.on("end",c),o()})}s(J9t,"parseProxyResponse");bB.parseProxyResponse=J9t});var IHe=H(ah=>{"use strict";d();var X9t=ah&&ah.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:s(function(){return e[r]},"get")}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),Z9t=ah&&ah.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),EHe=ah&&ah.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&X9t(e,t,r);return Z9t(e,t),e},bHe=ah&&ah.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(ah,"__esModule",{value:!0});ah.HttpsProxyAgent=void 0;var QAe=EHe(require("net")),vHe=EHe(require("tls")),e6t=bHe(require("assert")),t6t=bHe(kC()),r6t=OAe(),n6t=require("url"),i6t=CHe(),J6=(0,t6t.default)("https-proxy-agent"),CK=class extends r6t.Agent{static{s(this,"HttpsProxyAgent")}constructor(e,r){super(r),this.options={path:void 0},this.proxy=typeof e=="string"?new n6t.URL(e):e,this.proxyHeaders=r?.headers??{},J6("Creating new HttpsProxyAgent instance: %o",this.proxy.href);let n=(this.proxy.hostname||this.proxy.host).replace(/^\[|\]$/g,""),i=this.proxy.port?parseInt(this.proxy.port,10):this.proxy.protocol==="https:"?443:80;this.connectOpts={ALPNProtocols:["http/1.1"],...r?xHe(r,"headers"):null,host:n,port:i}}async connect(e,r){let{proxy:n}=this;if(!r.host)throw new TypeError('No "host" provided');let i;if(n.protocol==="https:"){J6("Creating `tls.Socket`: %o",this.connectOpts);let m=this.connectOpts.servername||this.connectOpts.host;i=vHe.connect({...this.connectOpts,servername:m})}else J6("Creating `net.Socket`: %o",this.connectOpts),i=QAe.connect(this.connectOpts);let o=typeof this.proxyHeaders=="function"?this.proxyHeaders():{...this.proxyHeaders},a=QAe.isIPv6(r.host)?`[${r.host}]`:r.host,c=`CONNECT ${a}:${r.port} HTTP/1.1\r
`;if(n.username||n.password){let m=`${decodeURIComponent(n.username)}:${decodeURIComponent(n.password)}`;o["Proxy-Authorization"]=`Basic ${Buffer.from(m).toString("base64")}`}o.Host=`${a}:${r.port}`,o["Proxy-Connection"]||(o["Proxy-Connection"]=this.keepAlive?"Keep-Alive":"close");for(let m of Object.keys(o))c+=`${m}: ${o[m]}\r
`;let l=(0,i6t.parseProxyResponse)(i);i.write(`${c}\r
`);let{connect:u,buffered:f}=await l;if(e.emit("proxyConnect",u),this.emit("proxyConnect",u,e),u.statusCode===200){if(e.once("socket",o6t),r.secureEndpoint){J6("Upgrading socket connection to TLS");let m=r.servername||r.host;return vHe.connect({...xHe(r,"host","path","port"),socket:i,servername:m})}return i}i.destroy();let p=new QAe.Socket({writable:!1});return p.readable=!0,e.once("socket",m=>{J6("Replaying proxy buffer for failed request"),(0,e6t.default)(m.listenerCount("data")>0),m.push(f),m.push(null)}),p}};CK.protocols=["http","https"];ah.HttpsProxyAgent=CK;function o6t(t){t.resume()}s(o6t,"resume");function xHe(t,...e){let r={},n;for(n in t)e.includes(n)||(r[n]=t[n]);return r}s(xHe,"omit")});var SHe=H(ch=>{"use strict";d();var s6t=ch&&ch.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:s(function(){return e[r]},"get")}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),a6t=ch&&ch.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),wHe=ch&&ch.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&s6t(e,t,r);return a6t(e,t),e},c6t=ch&&ch.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(ch,"__esModule",{value:!0});ch.HttpProxyAgent=void 0;var l6t=wHe(require("net")),u6t=wHe(require("tls")),d6t=c6t(kC()),f6t=require("events"),p6t=OAe(),THe=require("url"),IB=(0,d6t.default)("http-proxy-agent"),vK=class extends p6t.Agent{static{s(this,"HttpProxyAgent")}constructor(e,r){super(r),this.proxy=typeof e=="string"?new THe.URL(e):e,this.proxyHeaders=r?.headers??{},IB("Creating new HttpProxyAgent instance: %o",this.proxy.href);let n=(this.proxy.hostname||this.proxy.host).replace(/^\[|\]$/g,""),i=this.proxy.port?parseInt(this.proxy.port,10):this.proxy.protocol==="https:"?443:80;this.connectOpts={...r?m6t(r,"headers"):null,host:n,port:i}}addRequest(e,r){e._header=null,this.setRequestProps(e,r),super.addRequest(e,r)}setRequestProps(e,r){let{proxy:n}=this,i=r.secureEndpoint?"https:":"http:",o=e.getHeader("host")||"localhost",a=`${i}//${o}`,c=new THe.URL(e.path,a);r.port!==80&&(c.port=String(r.port)),e.path=String(c);let l=typeof this.proxyHeaders=="function"?this.proxyHeaders():{...this.proxyHeaders};if(n.username||n.password){let u=`${decodeURIComponent(n.username)}:${decodeURIComponent(n.password)}`;l["Proxy-Authorization"]=`Basic ${Buffer.from(u).toString("base64")}`}l["Proxy-Connection"]||(l["Proxy-Connection"]=this.keepAlive?"Keep-Alive":"close");for(let u of Object.keys(l)){let f=l[u];f&&e.setHeader(u,f)}}async connect(e,r){e._header=null,e.path.includes("://")||this.setRequestProps(e,r);let n,i;IB("Regenerating stored HTTP header string for request"),e._implicitHeader(),e.outputData&&e.outputData.length>0&&(IB("Patching connection write() output buffer with updated header"),n=e.outputData[0].data,i=n.indexOf(`\r
\r
`)+4,e.outputData[0].data=e._header+n.substring(i),IB("Output buffer: %o",e.outputData[0].data));let o;return this.proxy.protocol==="https:"?(IB("Creating `tls.Socket`: %o",this.connectOpts),o=u6t.connect(this.connectOpts)):(IB("Creating `net.Socket`: %o",this.connectOpts),o=l6t.connect(this.connectOpts)),await(0,f6t.once)(o,"connect"),o}};vK.protocols=["http","https"];ch.HttpProxyAgent=vK;function m6t(t,...e){let r={},n;for(n in t)e.includes(n)||(r[n]=t[n]);return r}s(m6t,"omit")});var ZHe=H(LK=>{"use strict";d();Object.defineProperty(LK,"__esModule",{value:!0});LK.state=void 0;LK.state={operationRequestMap:new WeakMap}});function IOt(){try{return gye.default.statSync("/.dockerenv"),!0}catch{return!1}}function TOt(){try{return gye.default.readFileSync("/proc/self/cgroup","utf8").includes("docker")}catch{return!1}}function Aye(){return hye===void 0&&(hye=IOt()||TOt()),hye}var gye,hye,m$e=Fm(()=>{d();gye=Be(require("node:fs"),1);s(IOt,"hasDockerEnv");s(TOt,"hasDockerCGroup");s(Aye,"isDocker")});function _B(){return yye===void 0&&(yye=wOt()||Aye()),yye}var h$e,yye,wOt,Cye=Fm(()=>{d();h$e=Be(require("node:fs"),1);m$e();wOt=s(()=>{try{return h$e.default.statSync("/run/.containerenv"),!0}catch{return!1}},"hasContainerEnv");s(_B,"isInsideContainer")});var vye,A$e,y$e,g$e,hT,xye=Fm(()=>{d();vye=Be(require("node:process"),1),A$e=Be(require("node:os"),1),y$e=Be(require("node:fs"),1);Cye();g$e=s(()=>{if(vye.default.platform!=="linux")return!1;if(A$e.default.release().toLowerCase().includes("microsoft"))return!_B();try{return y$e.default.readFileSync("/proc/version","utf8").toLowerCase().includes("microsoft")?!_B():!1}catch{return!1}},"isWsl"),hT=vye.default.env.__IS_WSL_TEST__?g$e:g$e()});var Eye,nO,SOt,_Ot,bye,C$e=Fm(()=>{d();Eye=Be(require("node:process"),1),nO=Be(require("node:fs/promises"),1);xye();xye();SOt=(()=>{let t="/mnt/",e;return async function(){if(e)return e;let r="/etc/wsl.conf",n=!1;try{await nO.default.access(r,nO.constants.F_OK),n=!0}catch{}if(!n)return t;let i=await nO.default.readFile(r,{encoding:"utf8"}),o=/(?<!#.*)root\s*=\s*(?<mountPoint>.*)/g.exec(i);return o?(e=o.groups.mountPoint.trim(),e=e.endsWith("/")?e:`${e}/`,e):t}})(),_Ot=s(async()=>`${await SOt()}c/Windows/System32/WindowsPowerShell/v1.0/powershell.exe`,"powerShellPathFromWsl"),bye=s(async()=>hT?_Ot():`${Eye.default.env.SYSTEMROOT||Eye.default.env.windir||String.raw`C:\Windows`}\\System32\\WindowsPowerShell\\v1.0\\powershell.exe`,"powerShellPath")});function gT(t,e,r){let n=s(i=>Object.defineProperty(t,e,{value:i,enumerable:!0,writable:!0}),"define");return Object.defineProperty(t,e,{configurable:!0,enumerable:!0,get(){let i=r();return n(i),i},set(i){n(i)}}),t}var v$e=Fm(()=>{d();s(gT,"defineLazyProperty")});async function Iye(){if(E$e.default.platform!=="darwin")throw new Error("macOS only");let{stdout:t}=await ROt("defaults",["read","com.apple.LaunchServices/com.apple.launchservices.secure","LSHandlers"]);return/LSHandlerRoleAll = "(?!-)(?<id>[^"]+?)";\s+?LSHandlerURLScheme = (?:http|https);/.exec(t)?.groups.id??"com.apple.Safari"}var x$e,E$e,b$e,ROt,I$e=Fm(()=>{d();x$e=require("node:util"),E$e=Be(require("node:process"),1),b$e=require("node:child_process"),ROt=(0,x$e.promisify)(b$e.execFile);s(Iye,"defaultBrowserId")});async function S$e(t,{humanReadableOutput:e=!0}={}){if(T$e.default.platform!=="darwin")throw new Error("macOS only");let r=e?[]:["-ss"],{stdout:n}=await kOt("osascript",["-e",t,r]);return n.trim()}var T$e,w$e,Tye,kOt,_$e=Fm(()=>{d();T$e=Be(require("node:process"),1),w$e=require("node:util"),Tye=require("node:child_process"),kOt=(0,w$e.promisify)(Tye.execFile);s(S$e,"runAppleScript")});async function wye(t){return S$e(`tell application "Finder" to set app_path to application file id "${t}" as string
tell application "System Events" to get value of property list item "CFBundleName" of property list file (app_path & ":Contents:Info.plist")`)}var R$e=Fm(()=>{d();_$e();s(wye,"bundleName")});async function Sye(t=POt){let{stdout:e}=await t("reg",["QUERY"," HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\Shell\\Associations\\UrlAssociations\\http\\UserChoice","/v","ProgId"]),r=/ProgId\s*REG_SZ\s*(?<id>\S+)/.exec(e);if(!r)throw new OK(`Cannot find Windows browser in stdout: ${JSON.stringify(e)}`);let{id:n}=r.groups,i=DOt[n];if(!i)throw new OK(`Unknown browser ID: ${n}`);return i}var k$e,P$e,POt,DOt,OK,D$e=Fm(()=>{d();k$e=require("node:util"),P$e=require("node:child_process"),POt=(0,k$e.promisify)(P$e.execFile),DOt={AppXq0fevzme2pys62n3e0fbqa7peapykr8v:{name:"Edge",id:"com.microsoft.edge.old"},MSEdgeDHTML:{name:"Edge",id:"com.microsoft.edge"},MSEdgeHTM:{name:"Edge",id:"com.microsoft.edge"},"IE.HTTP":{name:"Internet Explorer",id:"com.microsoft.ie"},FirefoxURL:{name:"Firefox",id:"org.mozilla.firefox"},ChromeHTML:{name:"Chrome",id:"com.google.chrome"},BraveHTML:{name:"Brave",id:"com.brave.Browser"},BraveBHTML:{name:"Brave Beta",id:"com.brave.Browser.beta"},BraveSSHTM:{name:"Brave Nightly",id:"com.brave.Browser.nightly"}},OK=class extends Error{static{s(this,"UnknownBrowserError")}};s(Sye,"defaultBrowser")});async function _ye(){if(QK.default.platform==="darwin"){let t=await Iye();return{name:await wye(t),id:t}}if(QK.default.platform==="linux"){let{stdout:t}=await BOt("xdg-mime",["query","default","x-scheme-handler/http"]),e=t.trim();return{name:NOt(e.replace(/.desktop$/,"").replace("-"," ")),id:e}}if(QK.default.platform==="win32")return Sye();throw new Error("Only macOS, Linux, and Windows are supported")}var B$e,QK,N$e,BOt,NOt,M$e=Fm(()=>{d();B$e=require("node:util"),QK=Be(require("node:process"),1),N$e=require("node:child_process");I$e();R$e();D$e();BOt=(0,B$e.promisify)(N$e.execFile),NOt=s(t=>t.toLowerCase().replaceAll(/(?:^|\s|-)\S/g,e=>e.toUpperCase()),"titleize");s(_ye,"defaultBrowser")});var H$e={};Ia(H$e,{apps:()=>AT,default:()=>oO,openApp:()=>OOt});async function LOt(){let t=await bye(),e=String.raw`(Get-ItemProperty -Path "HKCU:\Software\Microsoft\Windows\Shell\Associations\UrlAssociations\http\UserChoice").ProgId`,r=Pye.Buffer.from(e,"utf16le").toString("base64"),{stdout:n}=await MOt(t,["-NoProfile","-NonInteractive","-ExecutionPolicy","Bypass","-EncodedCommand",r],{encoding:"utf8"}),i=n.trim(),o={ChromeHTML:"com.google.chrome",BraveHTML:"com.brave.Browser",MSEdgeHTM:"com.microsoft.edge",FirefoxURL:"org.mozilla.firefox"};return o[i]?{id:o[i]}:{}}function Q$e(t){if(typeof t=="string"||Array.isArray(t))return t;let{[F$e]:e}=t;if(!e)throw new Error(`${F$e} is not supported`);return e}function qK({[RB]:t},{wsl:e}){if(e&&hT)return Q$e(e);if(!t)throw new Error(`${RB} is not supported`);return Q$e(t)}var kye,Pye,Dye,U$e,q$e,Bye,UK,MOt,Rye,L$e,RB,F$e,O$e,iO,FOt,OOt,AT,oO,HK=Fm(()=>{d();kye=Be(require("node:process"),1),Pye=require("node:buffer"),Dye=Be(require("node:path"),1),U$e=require("node:url"),q$e=require("node:util"),Bye=Be(require("node:child_process"),1),UK=Be(require("node:fs/promises"),1);C$e();v$e();M$e();Cye();MOt=(0,q$e.promisify)(Bye.default.execFile),Rye=Dye.default.dirname((0,U$e.fileURLToPath)(importMetaUrlShim)),L$e=Dye.default.join(Rye,"xdg-open"),{platform:RB,arch:F$e}=kye.default;s(LOt,"getWindowsDefaultBrowserFromWsl");O$e=s(async(t,e)=>{let r;for(let n of t)try{return await e(n)}catch(i){r=i}throw r},"pTryEach"),iO=s(async t=>{if(t={wait:!1,background:!1,newInstance:!1,allowNonzeroExitCode:!1,...t},Array.isArray(t.app))return O$e(t.app,c=>iO({...t,app:c}));let{name:e,arguments:r=[]}=t.app??{};if(r=[...r],Array.isArray(e))return O$e(e,c=>iO({...t,app:{name:c,arguments:r}}));if(e==="browser"||e==="browserPrivate"){let c={"com.google.chrome":"chrome","google-chrome.desktop":"chrome","com.brave.Browser":"brave","org.mozilla.firefox":"firefox","firefox.desktop":"firefox","com.microsoft.msedge":"edge","com.microsoft.edge":"edge","com.microsoft.edgemac":"edge","microsoft-edge.desktop":"edge"},l={chrome:"--incognito",brave:"--incognito",firefox:"--private-window",edge:"--inPrivate"},u=hT?await LOt():await _ye();if(u.id in c){let f=c[u.id];return e==="browserPrivate"&&r.push(l[f]),iO({...t,app:{name:AT[f],arguments:r}})}throw new Error(`${u.name} is not supported as a default browser`)}let n,i=[],o={};if(RB==="darwin")n="open",t.wait&&i.push("--wait-apps"),t.background&&i.push("--background"),t.newInstance&&i.push("--new"),e&&i.push("-a",e);else if(RB==="win32"||hT&&!_B()&&!e){n=await bye(),i.push("-NoProfile","-NonInteractive","-ExecutionPolicy","Bypass","-EncodedCommand"),hT||(o.windowsVerbatimArguments=!0);let c=["Start"];t.wait&&c.push("-Wait"),e?(c.push(`"\`"${e}\`""`),t.target&&r.push(t.target)):t.target&&c.push(`"${t.target}"`),r.length>0&&(r=r.map(l=>`"\`"${l}\`""`),c.push("-ArgumentList",r.join(","))),t.target=Pye.Buffer.from(c.join(" "),"utf16le").toString("base64")}else{if(e)n=e;else{let c=!Rye||Rye==="/",l=!1;try{await UK.default.access(L$e,UK.constants.X_OK),l=!0}catch{}n=kye.default.versions.electron??(RB==="android"||c||!l)?"xdg-open":L$e}r.length>0&&i.push(...r),t.wait||(o.stdio="ignore",o.detached=!0)}RB==="darwin"&&r.length>0&&i.push("--args",...r),t.target&&i.push(t.target);let a=Bye.default.spawn(n,i,o);return t.wait?new Promise((c,l)=>{a.once("error",l),a.once("close",u=>{if(!t.allowNonzeroExitCode&&u>0){l(new Error(`Exited with code ${u}`));return}c(a)})}):(a.unref(),a)},"baseOpen"),FOt=s((t,e)=>{if(typeof t!="string")throw new TypeError("Expected a `target`");return iO({...e,target:t})},"open"),OOt=s((t,e)=>{if(typeof t!="string"&&!Array.isArray(t))throw new TypeError("Expected a valid `name`");let{arguments:r=[]}=e??{};if(r!=null&&!Array.isArray(r))throw new TypeError("Expected `appArguments` as Array type");return iO({...e,app:{name:t,arguments:r}})},"openApp");s(Q$e,"detectArchBinary");s(qK,"detectPlatformBinary");AT={};gT(AT,"chrome",()=>qK({darwin:"google chrome",win32:"chrome",linux:["google-chrome","google-chrome-stable","chromium"]},{wsl:{ia32:"/mnt/c/Program Files (x86)/Google/Chrome/Application/chrome.exe",x64:["/mnt/c/Program Files/Google/Chrome/Application/chrome.exe","/mnt/c/Program Files (x86)/Google/Chrome/Application/chrome.exe"]}}));gT(AT,"brave",()=>qK({darwin:"brave browser",win32:"brave",linux:["brave-browser","brave"]},{wsl:{ia32:"/mnt/c/Program Files (x86)/BraveSoftware/Brave-Browser/Application/brave.exe",x64:["/mnt/c/Program Files/BraveSoftware/Brave-Browser/Application/brave.exe","/mnt/c/Program Files (x86)/BraveSoftware/Brave-Browser/Application/brave.exe"]}}));gT(AT,"firefox",()=>qK({darwin:"firefox",win32:String.raw`C:\Program Files\Mozilla Firefox\firefox.exe`,linux:"firefox"},{wsl:"/mnt/c/Program Files/Mozilla Firefox/firefox.exe"}));gT(AT,"edge",()=>qK({darwin:"microsoft edge",win32:"msedge",linux:["microsoft-edge","microsoft-edge-dev"]},{wsl:"/mnt/c/Program Files (x86)/Microsoft/Edge/Application/msedge.exe"}));gT(AT,"browser",()=>"browser");gT(AT,"browserPrivate",()=>"browserPrivate");oO=FOt});var AWe=H(LC=>{"use strict";d();Object.defineProperty(LC,"__esModule",{value:!0});LC.bytePairEncode=LC.BinaryMap=LC.binaryMapKey=void 0;var d7t=s((t,e,r)=>{let n=r-e,i=16777215>>>Math.max(0,(3-n)*8),o=(t[e+0]|t[e+1]<<8|t[e+2]<<16)&i,a=16777215>>>Math.min(31,Math.max(0,(6-n)*8)),c=(t[e+3]|t[e+4]<<8|t[e+5]<<16)&a;return o+16777216*c},"binaryMapKey");LC.binaryMapKey=d7t;var Jye=class t{static{s(this,"BinaryMap")}constructor(){this.nested=new Map,this.final=new Map}get(e,r=0,n=e.length){let i=n<6+r,o=(0,LC.binaryMapKey)(e,r,n);return i?this.final.get(o):this.nested.get(o)?.get(e,6+r,n)}set(e,r){let n=(0,LC.binaryMapKey)(e,0,e.length);if(e.length<6){this.final.set(n,r);return}let o=this.nested.get(n);if(o instanceof t)o.set(e.subarray(6),r);else{let a=new t;a.set(e.subarray(6),r),this.nested.set(n,a)}}};LC.BinaryMap=Jye;var MC=new Int32Array(128),Tf=new Int32Array(128);function f7t(t,e,r){if(r===1)return[e.get(t)];let n=2147483647,i=-1;for(;MC.length<r*2;)Tf=new Int32Array(Tf.length*2),MC=new Int32Array(MC.length*2);for(let l=0;l<r-1;l++){let u=e.get(t,l,l+2)??2147483647;u<n&&(n=u,i=l),Tf[l]=l,MC[l]=u}Tf[r-1]=r-1,MC[r-1]=2147483647,Tf[r]=r,MC[r]=2147483647;let o=r+1;function a(l,u=0){if(l+u+2<o){let f=e.get(t,Tf[l],Tf[l+u+2]);if(f!==void 0)return f}return 2147483647}for(s(a,"getRank");n!==2147483647;){MC[Tf[i]]=a(i,1),i>0&&(MC[Tf[i-1]]=a(i-1,1));for(let l=i+1;l<o-1;l++)Tf[l]=Tf[l+1];o--,i=-1,n=2147483647;for(let l=0;l<o-1;l++){let u=MC[Tf[l]];MC[Tf[l]]<n&&(n=u,i=l)}}let c=[];for(let l=0;l<o-1;l++)c.push(e.get(t,Tf[l],Tf[l+1]));return c}s(f7t,"bytePairEncode");LC.bytePairEncode=f7t});var yWe=H(ZK=>{"use strict";d();Object.defineProperty(ZK,"__esModule",{value:!0});ZK.makeTextEncoder=void 0;var Xye=class{static{s(this,"UniversalTextEncoder")}constructor(){this.length=0,this.encoder=new TextEncoder}encode(e){let r=this.encoder.encode(e);return this.length=r.length,r}},Zye=class{static{s(this,"NodeTextEncoder")}constructor(){this.buffer=Buffer.alloc(256),this.length=0}encode(e){for(;;){if(this.length=this.buffer.write(e,"utf8"),this.length<this.buffer.length-4)return this.buffer;this.buffer=Buffer.alloc(this.length*2),this.length=this.buffer.write(e)}}},p7t=s(()=>typeof Buffer<"u"?new Zye:new Xye,"makeTextEncoder");ZK.makeTextEncoder=p7t});var CWe=H(eY=>{"use strict";d();Object.defineProperty(eY,"__esModule",{value:!0});eY.LRUCache=void 0;var eCe=class{static{s(this,"LRUCache")}constructor(e){this.size=e,this.nodes=new Map}get(e){let r=this.nodes.get(e);if(r)return this.moveToHead(r),r.value}set(e,r){let n=this.nodes.get(e);if(n)n.value=r,this.moveToHead(n);else{let i=new tCe(e,r);this.nodes.set(e,i),this.addNode(i),this.nodes.size>this.size&&(this.nodes.delete(this.tail.key),this.removeNode(this.tail))}}moveToHead(e){this.removeNode(e),e.next=void 0,e.prev=void 0,this.addNode(e)}addNode(e){this.head&&(this.head.prev=e,e.next=this.head),this.tail||(this.tail=e),this.head=e}removeNode(e){e.prev?e.prev.next=e.next:this.head=e.next,e.next?e.next.prev=e.prev:this.tail=e.prev}};eY.LRUCache=eCe;var tCe=class{static{s(this,"Node")}constructor(e,r){this.key=e,this.value=r}}});var nCe=H(rY=>{"use strict";d();Object.defineProperty(rY,"__esModule",{value:!0});rY.TikTokenizer=void 0;var tY=AWe(),m7t=yWe(),h7t=CWe();function g7t(t){let e=new Map;try{let i=require("fs").readFileSync(t,"utf-8");return r(i),e}catch(n){throw new Error(`Failed to load from BPE encoder file stream: ${n}`)}function r(n){for(let i of n.split(/[\r\n]+/)){if(i.trim()==="")continue;let o=i.split(" ");if(o.length!==2)throw new Error("Invalid format in the BPE encoder file stream");let a=new Uint8Array(Buffer.from(o[0],"base64")),c=parseInt(o[1]);if(!isNaN(c))e.set(a,c);else throw new Error(`Can't parse ${o[1]} to integer`)}}s(r,"processBpeRanks")}s(g7t,"loadTikTokenBpe");function A7t(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}s(A7t,"escapeRegExp");var rCe=class{static{s(this,"TikTokenizer")}constructor(e,r,n,i=8192){this.textEncoder=(0,m7t.makeTextEncoder)(),this.textDecoder=new TextDecoder("utf-8"),this.cache=new h7t.LRUCache(i);let o=typeof e=="string"?g7t(e):e;this.init(o,r,n)}init(e,r,n){this.encoder=new tY.BinaryMap;for(let[i,o]of e)this.encoder.set(i,o);this.regex=new RegExp(n,"gu"),this.specialTokensRegex=new RegExp(Array.from(r.keys()).map(i=>A7t(i)).join("|")),this.specialTokensEncoder=r,this.decoder=new Map;for(let[i,o]of e)this.decoder.set(o,i);if(e.size!==this.decoder.size)throw new Error("Encoder and decoder sizes do not match");this.specialTokensDecoder=new Map;for(let[i,o]of r)this.specialTokensDecoder.set(o,i)}findNextSpecialToken(e,r,n){let i=r,o=null;if(n&&this.specialTokensRegex)for(;o=e.slice(i).match(this.specialTokensRegex),!(!o||n&&n.includes(o[0]));)i+=o.index+1;let a=o?i+o.index:e.length;return[o,a]}encode(e,r){let n=[],i=0;for(;;){let o,a;if([o,a]=this.findNextSpecialToken(e,i,r),a>i&&this.encodeByIndex(e,n,i,a),o){if(i=i+this.encodeSpecialToken(n,o),i>=e.length)break}else break}return n}encodeSpecialToken(e,r){let n=this.specialTokensEncoder?.get(r[0]);return e.push(n),r.index+r[0].length}encodeByIndex(e,r,n,i){let o,a=e.substring(n,i);for(this.regex.lastIndex=0;o=this.regex.exec(a);){let c=this.cache.get(o[0]);if(c)for(let l of c)r.push(l);else{let l=this.textEncoder.encode(o[0]),u=this.encoder.get(l,0,this.textEncoder.length);if(u!==void 0)r.push(u),this.cache.set(o[0],[u]);else{let f=(0,tY.bytePairEncode)(l,this.encoder,this.textEncoder.length);for(let p of f)r.push(p);this.cache.set(o[0],f)}}}}encodeTrimSuffixByIndex(e,r,n,i,o,a,c){let l,u=e.substring(n,i);for(this.regex.lastIndex=0;l=this.regex.exec(u);){let f=l[0],p=this.cache.get(f);if(p)if(a+p.length<=o)a+=p.length,c+=f.length,r.push(...p);else{let m=o-a;a+=m,c+=f.length,r.push(...p.slice(0,m));break}else{let m=this.textEncoder.encode(f),h=this.encoder.get(m,0,m.length);if(h!==void 0)if(this.cache.set(f,[h]),a+1<=o)a++,c+=f.length,r.push(h);else break;else{let g=(0,tY.bytePairEncode)(m,this.encoder,this.textEncoder.length);if(this.cache.set(f,g),a+g.length<=o){a+=g.length,c+=f.length;for(let A of g)r.push(A)}else{let A=o-a;a+=A,c+=f.length;for(let y=0;y<A;y++)r.push(g[y]);break}}}if(a>=o)break}return{tokenCount:a,encodeLength:c}}encodeTrimSuffix(e,r,n){let i=[],o=0,a=0,c=0;for(;;){let u,f;if([u,f]=this.findNextSpecialToken(e,o,n),f>o){let{tokenCount:p,encodeLength:m}=this.encodeTrimSuffixByIndex(e,i,o,f,r,a,c);if(a=p,c=m,a>=r)break}if(u!==null){if(a++,a<=r&&(o=o+this.encodeSpecialToken(i,u),c+=u[0].length,o>=e.length)||a>=r)break}else break}let l=c===e.length?e:e.slice(0,c);return{tokenIds:i,text:l}}encodeTrimPrefix(e,r,n){let i=[],o=0,a=0,c=0,l=new Map;for(l.set(a,c);;){let m,h;if([m,h]=this.findNextSpecialToken(e,o,n),h>o){let g,A=e.substring(o,h);for(this.regex.lastIndex=0;g=this.regex.exec(A);){let y=g[0],E=this.cache.get(y);if(E)a+=E.length,c+=y.length,i.push(...E),l.set(a,c);else{let b=this.textEncoder.encode(y),S=this.encoder.get(b);if(S!==void 0)this.cache.set(y,[S]),a++,c+=y.length,i.push(S),l.set(a,c);else{let R=(0,tY.bytePairEncode)(b,this.encoder,this.textEncoder.length);this.cache.set(y,R),a+=R.length,c+=y.length;for(let B of R)i.push(B);l.set(a,c)}}}}if(m!==null){if(o=o+this.encodeSpecialToken(i,m),a++,c+=m[0].length,l.set(a,c),o>=e.length)break}else break}if(a<=r)return{tokenIds:i,text:e};let u=a-r,f=0,p=0;for(let[m,h]of l)if(m>=u){f=m,p=h;break}if(f>r){let m=this.encode(e,n),h=m.slice(m.length-r);return{tokenIds:h,text:this.decode(h)}}return{tokenIds:i.slice(f),text:e.slice(p)}}decode(e){let r=[];for(let n of e){let i=[],o=this.decoder?.get(n);if(o!==void 0)i=Array.from(o);else{let a=this.specialTokensDecoder?.get(n);if(a!==void 0){let c=this.textEncoder.encode(a);i=Array.from(c.subarray(0,this.textEncoder.length))}}r.push(...i)}return this.textDecoder.decode(new Uint8Array(r))}};rY.TikTokenizer=rCe});var RWe=H(ol=>{"use strict";d();Object.defineProperty(ol,"__esModule",{value:!0});ol.createTokenizer=ol.createByEncoderName=ol.createByModelName=ol.getRegexByModel=ol.getRegexByEncoder=ol.getSpecialTokensByModel=ol.getSpecialTokensByEncoder=ol.MODEL_TO_ENCODING=void 0;var y7t=nCe(),C7t=new Map([["gpt-4o-","o200k_base"],["gpt-4-","cl100k_base"],["gpt-3.5-turbo-","cl100k_base"],["gpt-35-turbo-","cl100k_base"]]);ol.MODEL_TO_ENCODING=new Map([["gpt-4o","o200k_base"],["gpt-4","cl100k_base"],["gpt-3.5-turbo","cl100k_base"],["text-davinci-003","p50k_base"],["text-davinci-002","p50k_base"],["text-davinci-001","r50k_base"],["text-curie-001","r50k_base"],["text-babbage-001","r50k_base"],["text-ada-001","r50k_base"],["davinci","r50k_base"],["curie","r50k_base"],["babbage","r50k_base"],["ada","r50k_base"],["code-davinci-002","p50k_base"],["code-davinci-001","p50k_base"],["code-cushman-002","p50k_base"],["code-cushman-001","p50k_base"],["davinci-codex","p50k_base"],["cushman-codex","p50k_base"],["text-davinci-edit-001","p50k_edit"],["code-davinci-edit-001","p50k_edit"],["text-embedding-ada-002","cl100k_base"],["text-similarity-davinci-001","r50k_base"],["text-similarity-curie-001","r50k_base"],["text-similarity-babbage-001","r50k_base"],["text-similarity-ada-001","r50k_base"],["text-search-davinci-doc-001","r50k_base"],["text-search-curie-doc-001","r50k_base"],["text-search-babbage-doc-001","r50k_base"],["text-search-ada-doc-001","r50k_base"],["code-search-babbage-code-001","r50k_base"],["code-search-ada-code-001","r50k_base"],["gpt2","gpt2"]]);var nY="<|endoftext|>",vWe="<|fim_prefix|>",xWe="<|fim_middle|>",EWe="<|fim_suffix|>",bWe="<|endofprompt|>",CO="'s|'t|'re|'ve|'m|'ll|'d| ?\\p{L}+| ?\\p{N}+| ?[^\\s\\p{L}\\p{N}]+|\\s+(?!\\S)|\\s+",IWe="(?:'s|'S|'t|'T|'re|'RE|'Re|'eR|'ve|'VE|'vE|'Ve|'m|'M|'ll|'lL|'Ll|'LL|'d|'D)|[^\\r\\n\\p{L}\\p{N}]?\\p{L}+|\\p{N}{1,3}| ?[^\\s\\p{L}\\p{N}]+[\\r\\n]*|\\s*[\\r\\n]+|\\s+(?!\\S)|\\s+",v7t=[`[^\r
\\p{L}\\p{N}]?[\\p{Lu}\\p{Lt}\\p{Lm}\\p{Lo}\\p{M}]*[\\p{Ll}\\p{Lm}\\p{Lo}\\p{M}]+(?:'s|'S|'t|'T|'re|'RE|'Re|'eR|'ve|'VE|'vE|'Ve|'m|'M|'ll|'lL|'Ll|'LL|'d|'D)?`,`[^\r
\\p{L}\\p{N}]?[\\p{Lu}\\p{Lt}\\p{Lm}\\p{Lo}\\p{M}]+[\\p{Ll}\\p{Lm}\\p{Lo}\\p{M}]*(?:'s|'S|'t|'T|'re|'RE|'Re|'eR|'ve|'VE|'vE|'Ve|'m|'M|'ll|'lL|'Ll|'LL|'d|'D)?`,"\\p{N}{1,3}"," ?[^\\s\\p{L}\\p{N}]+[\\r\\n/]*","\\s*[\\r\\n]+","\\s+(?!\\S)","\\s+"],TWe=v7t.join("|");function iCe(t){let e="";if(ol.MODEL_TO_ENCODING.has(t))e=ol.MODEL_TO_ENCODING.get(t);else for(let[r,n]of C7t)if(t.startsWith(r)){e=n;break}return e}s(iCe,"getEncoderFromModelName");async function x7t(t,e){let r=require("fs"),n=await fetch(t);if(!n.ok)throw new Error(`Failed to fetch file from ${t}. Status code: ${n.status}`);let i=await n.text();r.writeFileSync(e,i)}s(x7t,"fetchAndSaveFile");function oCe(t){let e=new Map([[nY,50256]]);switch(t){case"o200k_base":e=new Map([[nY,199999],[bWe,200018]]);break;case"cl100k_base":e=new Map([[nY,100257],[vWe,100258],[xWe,100259],[EWe,100260],[bWe,100276]]);break;case"p50k_edit":e=new Map([[nY,50256],[vWe,50281],[xWe,50282],[EWe,50283]]);break;default:break}return e}s(oCe,"getSpecialTokensByEncoder");ol.getSpecialTokensByEncoder=oCe;function E7t(t){let e=iCe(t);return oCe(e)}s(E7t,"getSpecialTokensByModel");ol.getSpecialTokensByModel=E7t;function wWe(t){switch(t){case"o200k_base":return TWe;case"cl100k_base":return IWe;default:break}return CO}s(wWe,"getRegexByEncoder");ol.getRegexByEncoder=wWe;function b7t(t){let e=iCe(t);return wWe(e)}s(b7t,"getRegexByModel");ol.getRegexByModel=b7t;async function I7t(t,e=null){return SWe(iCe(t),e)}s(I7t,"createByModelName");ol.createByModelName=I7t;async function SWe(t,e=null){let r,n,i=oCe(t);switch(t){case"o200k_base":r=TWe,n="https://openaipublic.blob.core.windows.net/encodings/o200k_base.tiktoken";break;case"cl100k_base":r=IWe,n="https://openaipublic.blob.core.windows.net/encodings/cl100k_base.tiktoken";break;case"p50k_base":r=CO,n="https://openaipublic.blob.core.windows.net/encodings/p50k_base.tiktoken";break;case"p50k_edit":r=CO,n="https://openaipublic.blob.core.windows.net/encodings/p50k_base.tiktoken";break;case"r50k_base":r=CO,n="https://openaipublic.blob.core.windows.net/encodings/r50k_base.tiktoken";break;case"gpt2":r=CO,n="https://raw.githubusercontent.com/microsoft/Tokenizer/main/model/gpt2.tiktoken";break;default:throw new Error(`Doesn't support this encoder [${t}]`)}e!==null&&(i=new Map([...i,...e]));let o=require("fs"),a=require("path"),c=a.basename(n),l=a.resolve(__dirname,"..","model");o.existsSync(l)||o.mkdirSync(l,{recursive:!0});let u=a.resolve(l,c);return o.existsSync(u)||(console.log(`Downloading file from ${n}`),await x7t(n,u),console.log(`Saved file to ${u}`)),_We(u,i,r)}s(SWe,"createByEncoderName");ol.createByEncoderName=SWe;function _We(t,e,r,n=8192){return new y7t.TikTokenizer(t,e,r,n)}s(_We,"createTokenizer");ol.createTokenizer=_We});var kWe=H(sl=>{"use strict";d();Object.defineProperty(sl,"__esModule",{value:!0});sl.createTokenizer=sl.createByEncoderName=sl.createByModelName=sl.getSpecialTokensByModel=sl.getSpecialTokensByEncoder=sl.getRegexByModel=sl.getRegexByEncoder=sl.MODEL_TO_ENCODING=sl.TikTokenizer=void 0;var T7t=nCe();Object.defineProperty(sl,"TikTokenizer",{enumerable:!0,get:s(function(){return T7t.TikTokenizer},"get")});var CT=RWe();Object.defineProperty(sl,"MODEL_TO_ENCODING",{enumerable:!0,get:s(function(){return CT.MODEL_TO_ENCODING},"get")});Object.defineProperty(sl,"getRegexByEncoder",{enumerable:!0,get:s(function(){return CT.getRegexByEncoder},"get")});Object.defineProperty(sl,"getRegexByModel",{enumerable:!0,get:s(function(){return CT.getRegexByModel},"get")});Object.defineProperty(sl,"getSpecialTokensByEncoder",{enumerable:!0,get:s(function(){return CT.getSpecialTokensByEncoder},"get")});Object.defineProperty(sl,"getSpecialTokensByModel",{enumerable:!0,get:s(function(){return CT.getSpecialTokensByModel},"get")});Object.defineProperty(sl,"createByModelName",{enumerable:!0,get:s(function(){return CT.createByModelName},"get")});Object.defineProperty(sl,"createByEncoderName",{enumerable:!0,get:s(function(){return CT.createByEncoderName},"get")});Object.defineProperty(sl,"createTokenizer",{enumerable:!0,get:s(function(){return CT.createTokenizer},"get")})});var mCe=H((bBn,ZWe)=>{"use strict";d();ZWe.exports=s(function(e,r){r===!0&&(r=0);var n="";if(typeof e=="string")try{n=new URL(e).protocol}catch{}else e&&e.constructor===URL&&(n=e.protocol);var i=n.split(/\:|\+/).filter(Boolean);return typeof r=="number"?i[r]:i},"protocols")});var tje=H((wBn,eje)=>{"use strict";d();var nqt=mCe();function iqt(t){var e={protocols:[],protocol:null,port:null,resource:"",host:"",user:"",password:"",pathname:"",hash:"",search:"",href:t,query:{},parse_failed:!1};try{var r=new URL(t);e.protocols=nqt(r),e.protocol=e.protocols[0],e.port=r.port,e.resource=r.hostname,e.host=r.host,e.user=r.username||"",e.password=r.password||"",e.pathname=r.pathname,e.hash=r.hash.slice(1),e.search=r.search.slice(1),e.href=r.href,e.query=Object.fromEntries(r.searchParams)}catch{e.protocols=["file"],e.protocol=e.protocols[0],e.port="",e.resource="",e.user="",e.pathname="",e.hash="",e.search="",e.href=t,e.query={},e.parse_failed=!0}return e}s(iqt,"parsePath");eje.exports=iqt});var aje=H((RBn,sje)=>{"use strict";d();var oqt=tje();function sqt(t){return t&&typeof t=="object"&&"default"in t?t:{default:t}}s(sqt,"_interopDefaultLegacy");var aqt=sqt(oqt);function cqt(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var r=s(function n(){if(this instanceof n){var i=[null];i.push.apply(i,arguments);var o=Function.bind.apply(e,i);return new o}return e.apply(this,arguments)},"a");r.prototype=e.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(t).forEach(function(n){var i=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(r,n,i.get?i:{enumerable:!0,get:s(function(){return t[n]},"get")})}),r}s(cqt,"getAugmentedNamespace");var nje={},lqt="text/plain",uqt="us-ascii",rje=s((t,e)=>e.some(r=>r instanceof RegExp?r.test(t):r===t),"testParameter"),dqt=s((t,{stripHash:e})=>{let r=/^data:(?<type>[^,]*?),(?<data>[^#]*?)(?:#(?<hash>.*))?$/.exec(t);if(!r)throw new Error(`Invalid URL: ${t}`);let{type:n,data:i,hash:o}=r.groups,a=n.split(";");o=e?"":o;let c=!1;a[a.length-1]==="base64"&&(a.pop(),c=!0);let l=(a.shift()||"").toLowerCase(),f=[...a.map(p=>{let[m,h=""]=p.split("=").map(g=>g.trim());return m==="charset"&&(h=h.toLowerCase(),h===uqt)?"":`${m}${h?`=${h}`:""}`}).filter(Boolean)];return c&&f.push("base64"),(f.length>0||l&&l!==lqt)&&f.unshift(l),`data:${f.join(";")},${c?i.trim():i}${o?`#${o}`:""}`},"normalizeDataURL");function fqt(t,e){if(e={defaultProtocol:"http:",normalizeProtocol:!0,forceHttp:!1,forceHttps:!1,stripAuthentication:!0,stripHash:!1,stripTextFragment:!0,stripWWW:!0,removeQueryParameters:[/^utm_\w+/i],removeTrailingSlash:!0,removeSingleSlash:!0,removeDirectoryIndex:!1,sortQueryParameters:!0,...e},t=t.trim(),/^data:/i.test(t))return dqt(t,e);if(/^view-source:/i.test(t))throw new Error("`view-source:` is not supported as it is a non-standard protocol");let r=t.startsWith("//");!r&&/^\.*\//.test(t)||(t=t.replace(/^(?!(?:\w+:)?\/\/)|^\/\//,e.defaultProtocol));let i=new URL(t);if(e.forceHttp&&e.forceHttps)throw new Error("The `forceHttp` and `forceHttps` options cannot be used together");if(e.forceHttp&&i.protocol==="https:"&&(i.protocol="http:"),e.forceHttps&&i.protocol==="http:"&&(i.protocol="https:"),e.stripAuthentication&&(i.username="",i.password=""),e.stripHash?i.hash="":e.stripTextFragment&&(i.hash=i.hash.replace(/#?:~:text.*?$/i,"")),i.pathname){let a=/\b[a-z][a-z\d+\-.]{1,50}:\/\//g,c=0,l="";for(;;){let f=a.exec(i.pathname);if(!f)break;let p=f[0],m=f.index,h=i.pathname.slice(c,m);l+=h.replace(/\/{2,}/g,"/"),l+=p,c=m+p.length}let u=i.pathname.slice(c,i.pathname.length);l+=u.replace(/\/{2,}/g,"/"),i.pathname=l}if(i.pathname)try{i.pathname=decodeURI(i.pathname)}catch{}if(e.removeDirectoryIndex===!0&&(e.removeDirectoryIndex=[/^index\.[a-z]+$/]),Array.isArray(e.removeDirectoryIndex)&&e.removeDirectoryIndex.length>0){let a=i.pathname.split("/"),c=a[a.length-1];rje(c,e.removeDirectoryIndex)&&(a=a.slice(0,-1),i.pathname=a.slice(1).join("/")+"/")}if(i.hostname&&(i.hostname=i.hostname.replace(/\.$/,""),e.stripWWW&&/^www\.(?!www\.)[a-z\-\d]{1,63}\.[a-z.\-\d]{2,63}$/.test(i.hostname)&&(i.hostname=i.hostname.replace(/^www\./,""))),Array.isArray(e.removeQueryParameters))for(let a of[...i.searchParams.keys()])rje(a,e.removeQueryParameters)&&i.searchParams.delete(a);if(e.removeQueryParameters===!0&&(i.search=""),e.sortQueryParameters){i.searchParams.sort();try{i.search=decodeURIComponent(i.search)}catch{}}e.removeTrailingSlash&&(i.pathname=i.pathname.replace(/\/$/,""));let o=t;return t=i.toString(),!e.removeSingleSlash&&i.pathname==="/"&&!o.endsWith("/")&&i.hash===""&&(t=t.replace(/\/$/,"")),(e.removeTrailingSlash||i.pathname==="/")&&i.hash===""&&e.removeSingleSlash&&(t=t.replace(/\/$/,"")),r&&!e.normalizeProtocol&&(t=t.replace(/^http:\/\//,"//")),e.stripProtocol&&(t=t.replace(/^(?:https?:)?\/\//,"")),t}s(fqt,"normalizeUrl");var pqt=Object.freeze({__proto__:null,default:fqt}),mqt=cqt(pqt);Object.defineProperty(nje,"__esModule",{value:!0});var hqt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gqt=mqt,Aqt=ije(gqt),yqt=aqt.default,Cqt=ije(yqt);function ije(t){return t&&t.__esModule?t:{default:t}}s(ije,"_interopRequireDefault");var oje=s(function t(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,n=/^(?:([a-zA-Z_][a-zA-Z0-9_-]{0,31})@|https?:\/\/)([\w\.\-@]+)[\/:](([\~,\.\w,\-,\_,\/,\s]|%[0-9A-Fa-f]{2})+?(?:\.git|\/)?)$/,i=s(function(l){var u=new Error(l);throw u.subject_url=e,u},"throwErr");(typeof e!="string"||!e.trim())&&i("Invalid url."),e.length>t.MAX_INPUT_LENGTH&&i("Input exceeds maximum length. If needed, change the value of parseUrl.MAX_INPUT_LENGTH."),r&&((typeof r>"u"?"undefined":hqt(r))!=="object"&&(r={stripHash:!1}),e=(0,Aqt.default)(e,r));var o=(0,Cqt.default)(e);if(o.parse_failed){var a=o.href.match(n);a?(o.protocols=["ssh"],o.protocol="ssh",o.resource=a[2],o.host=a[2],o.user=a[1],o.pathname="/"+a[3],o.parse_failed=!1):i("URL parsing failed.")}return o},"parseUrl");oje.MAX_INPUT_LENGTH=2048;var vqt=nje.default=oje;sje.exports=vqt});var uje=H((DBn,lje)=>{"use strict";d();var xqt=mCe();function cje(t){if(Array.isArray(t))return t.indexOf("ssh")!==-1||t.indexOf("rsync")!==-1;if(typeof t!="string")return!1;var e=xqt(t);if(t=t.substring(t.indexOf("://")+3),cje(e))return!0;var r=new RegExp(".([a-zA-Z\\d]+):(\\d+)/");return!t.match(r)&&t.indexOf("@")<t.indexOf(":")}s(cje,"isSsh");lje.exports=cje});var pje=H((MBn,fje)=>{"use strict";d();var Eqt=aje(),dje=uje();function bqt(t){let e=Eqt(t);return e.token="",e.password==="x-oauth-basic"?e.token=e.user:e.user==="x-token-auth"&&(e.token=e.password),dje(e.protocols)||e.protocols.length===0&&dje(t)?e.protocol="ssh":e.protocols.length?e.protocol=e.protocols[0]:(e.protocol="file",e.protocols=["file"]),e.href=e.href.replace(/\/$/,""),e}s(bqt,"gitUp");fje.exports=bqt});var hje=H((OBn,mje)=>{"use strict";d();var Iqt=pje();function hCe(t,e){if(e=e||[],typeof t!="string")throw new Error("The url must be a string.");if(!e.every(function(b){return typeof b=="string"}))throw new Error("The refs should contain only strings");var r=/^([a-z\d-]{1,39})\/([-\.\w]{1,100})$/i;r.test(t)&&(t="https://github.com/"+t);var n=Iqt(t),i=n.resource.split("."),o=null;switch(n.toString=function(b){return hCe.stringify(this,b)},n.source=i.length>2?i.slice(1-i.length).join("."):n.source=n.resource,n.git_suffix=/\.git$/.test(n.pathname),n.name=decodeURIComponent((n.pathname||n.href).replace(/(^\/)|(\/$)/g,"").replace(/\.git$/,"")),n.owner=decodeURIComponent(n.user),n.source){case"git.cloudforge.com":n.owner=n.user,n.organization=i[0],n.source="cloudforge.com";break;case"visualstudio.com":if(n.resource==="vs-ssh.visualstudio.com"){o=n.name.split("/"),o.length===4&&(n.organization=o[1],n.owner=o[2],n.name=o[3],n.full_name=o[2]+"/"+o[3]);break}else{o=n.name.split("/"),o.length===2?(n.owner=o[1],n.name=o[1],n.full_name="_git/"+n.name):o.length===3?(n.name=o[2],o[0]==="DefaultCollection"?(n.owner=o[2],n.organization=o[0],n.full_name=n.organization+"/_git/"+n.name):(n.owner=o[0],n.full_name=n.owner+"/_git/"+n.name)):o.length===4&&(n.organization=o[0],n.owner=o[1],n.name=o[3],n.full_name=n.organization+"/"+n.owner+"/_git/"+n.name);break}case"dev.azure.com":case"azure.com":if(n.resource==="ssh.dev.azure.com"){o=n.name.split("/"),o.length===4&&(n.organization=o[1],n.owner=o[2],n.name=o[3]);break}else{o=n.name.split("/"),o.length===5?(n.organization=o[0],n.owner=o[1],n.name=o[4],n.full_name="_git/"+n.name):o.length===3?(n.name=o[2],o[0]==="DefaultCollection"?(n.owner=o[2],n.organization=o[0],n.full_name=n.organization+"/_git/"+n.name):(n.owner=o[0],n.full_name=n.owner+"/_git/"+n.name)):o.length===4&&(n.organization=o[0],n.owner=o[1],n.name=o[3],n.full_name=n.organization+"/"+n.owner+"/_git/"+n.name),n.query&&n.query.path&&(n.filepath=n.query.path.replace(/^\/+/g,"")),n.query&&n.query.version&&(n.ref=n.query.version.replace(/^GB/,""));break}default:o=n.name.split("/");var a=o.length-1;if(o.length>=2){var c=o.indexOf("-",2),l=o.indexOf("blob",2),u=o.indexOf("tree",2),f=o.indexOf("commit",2),p=o.indexOf("issues",2),m=o.indexOf("src",2),h=o.indexOf("raw",2),g=o.indexOf("edit",2);a=c>0?c-1:l>0&&u>0?Math.min(l-1,u-1):l>0?l-1:p>0?p-1:u>0?u-1:f>0?f-1:m>0?m-1:h>0?h-1:g>0?g-1:a,n.owner=o.slice(0,a).join("/"),n.name=o[a],f&&p<0&&(n.commit=o[a+2])}n.ref="",n.filepathtype="",n.filepath="";var A=o.length>a&&o[a+1]==="-"?a+1:a;o.length>A+2&&["raw","src","blob","tree","edit"].indexOf(o[A+1])>=0&&(n.filepathtype=o[A+1],n.ref=o[A+2],o.length>A+3&&(n.filepath=o.slice(A+3).join("/"))),n.organization=n.owner;break}n.full_name||(n.full_name=n.owner,n.name&&(n.full_name&&(n.full_name+="/"),n.full_name+=n.name)),n.owner.startsWith("scm/")&&(n.source="bitbucket-server",n.owner=n.owner.replace("scm/",""),n.organization=n.owner,n.full_name=n.owner+"/"+n.name);var y=/(projects|users)\/(.*?)\/repos\/(.*?)((\/.*$)|$)/,E=y.exec(n.pathname);return E!=null&&(n.source="bitbucket-server",E[1]==="users"?n.owner="~"+E[2]:n.owner=E[2],n.organization=n.owner,n.name=E[3],o=E[4].split("/"),o.length>1&&(["raw","browse"].indexOf(o[1])>=0?(n.filepathtype=o[1],o.length>2&&(n.filepath=o.slice(2).join("/"))):o[1]==="commits"&&o.length>2&&(n.commit=o[2])),n.full_name=n.owner+"/"+n.name,n.query.at?n.ref=n.query.at:n.ref=""),e.length!==0&&n.ref&&(n.ref=Sqt(n.href,e)||n.ref,n.filepath=n.href.split(n.ref+"/")[1]),n}s(hCe,"gitUrlParse");hCe.stringify=function(t,e){e=e||(t.protocols&&t.protocols.length?t.protocols.join("+"):t.protocol);var r=t.port?":"+t.port:"",n=t.user||"git",i=t.git_suffix?".git":"";switch(e){case"ssh":return r?"ssh://"+n+"@"+t.resource+r+"/"+t.full_name+i:n+"@"+t.resource+":"+t.full_name+i;case"git+ssh":case"ssh+git":case"ftp":case"ftps":return e+"://"+n+"@"+t.resource+r+"/"+t.full_name+i;case"http":case"https":var o=t.token?Tqt(t):t.user&&(t.protocols.includes("http")||t.protocols.includes("https"))?t.user+"@":"";return e+"://"+o+t.resource+r+"/"+wqt(t)+i;default:return t.href}};function Tqt(t){switch(t.source){case"bitbucket.org":return"x-token-auth:"+t.token+"@";default:return t.token+"@"}}s(Tqt,"buildToken");function wqt(t){switch(t.source){case"bitbucket-server":return"scm/"+t.full_name;default:var e=t.full_name.split("/").map(function(r){return encodeURIComponent(r)}).join("/");return e}}s(wqt,"buildPath");function Sqt(t,e){var r="";return e.forEach(function(n){t.includes(n)&&n.length>r.length&&(r=n)}),r}s(Sqt,"findLongestMatchingSubstring");mje.exports=hCe});var Eje=H((exports,module)=>{d();var Module=Module!==void 0?Module:{},TreeSitter=function(){var initPromise,document=typeof window=="object"?{currentScript:window.document.currentScript}:null;class Parser{static{s(this,"Parser")}constructor(){this.initialize()}initialize(){throw new Error("cannot construct a Parser before calling `init()`")}static init(moduleOptions){return initPromise||(Module=Object.assign({},Module,moduleOptions),initPromise=new Promise(resolveInitPromise=>{var moduleOverrides=Object.assign({},Module),arguments_=[],thisProgram="./this.program",quit_=s((t,e)=>{throw e},"quit_"),ENVIRONMENT_IS_WEB=typeof window=="object",ENVIRONMENT_IS_WORKER=typeof importScripts=="function",ENVIRONMENT_IS_NODE=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string",scriptDirectory="",read_,readAsync,readBinary,setWindowTitle;function locateFile(t){return Module.locateFile?Module.locateFile(t,scriptDirectory):scriptDirectory+t}s(locateFile,"locateFile");function logExceptionOnExit(t){t instanceof ExitStatus||err("exiting due to exception: "+t)}if(s(logExceptionOnExit,"logExceptionOnExit"),ENVIRONMENT_IS_NODE){var fs=require("fs"),nodePath=require("path");scriptDirectory=ENVIRONMENT_IS_WORKER?nodePath.dirname(scriptDirectory)+"/":__dirname+"/",read_=s((t,e)=>(t=isFileURI(t)?new URL(t):nodePath.normalize(t),fs.readFileSync(t,e?void 0:"utf8")),"read_"),readBinary=s(t=>{var e=read_(t,!0);return e.buffer||(e=new Uint8Array(e)),e},"readBinary"),readAsync=s((t,e,r)=>{t=isFileURI(t)?new URL(t):nodePath.normalize(t),fs.readFile(t,function(n,i){n?r(n):e(i.buffer)})},"readAsync"),process.argv.length>1&&(thisProgram=process.argv[1].replace(/\\/g,"/")),arguments_=process.argv.slice(2),typeof module<"u"&&(module.exports=Module),quit_=s((t,e)=>{if(keepRuntimeAlive())throw process.exitCode=t,e;logExceptionOnExit(e),process.exit(t)},"quit_"),Module.inspect=function(){return"[Emscripten Module object]"}}else(ENVIRONMENT_IS_WEB||ENVIRONMENT_IS_WORKER)&&(ENVIRONMENT_IS_WORKER?scriptDirectory=self.location.href:document!==void 0&&document.currentScript&&(scriptDirectory=document.currentScript.src),scriptDirectory=scriptDirectory.indexOf("blob:")!==0?scriptDirectory.substr(0,scriptDirectory.replace(/[?#].*/,"").lastIndexOf("/")+1):"",read_=s(t=>{var e=new XMLHttpRequest;return e.open("GET",t,!1),e.send(null),e.responseText},"read_"),ENVIRONMENT_IS_WORKER&&(readBinary=s(t=>{var e=new XMLHttpRequest;return e.open("GET",t,!1),e.responseType="arraybuffer",e.send(null),new Uint8Array(e.response)},"readBinary")),readAsync=s((t,e,r)=>{var n=new XMLHttpRequest;n.open("GET",t,!0),n.responseType="arraybuffer",n.onload=()=>{n.status==200||n.status==0&&n.response?e(n.response):r()},n.onerror=r,n.send(null)},"readAsync"),setWindowTitle=s(t=>document.title=t,"setWindowTitle"));var out=Module.print||console.log.bind(console),err=Module.printErr||console.warn.bind(console);Object.assign(Module,moduleOverrides),moduleOverrides=null,Module.arguments&&(arguments_=Module.arguments),Module.thisProgram&&(thisProgram=Module.thisProgram),Module.quit&&(quit_=Module.quit);var STACK_ALIGN=16,dynamicLibraries=Module.dynamicLibraries||[],wasmBinary;Module.wasmBinary&&(wasmBinary=Module.wasmBinary);var noExitRuntime=Module.noExitRuntime||!0,wasmMemory;typeof WebAssembly!="object"&&abort("no native wasm support detected");var ABORT=!1,EXITSTATUS,UTF8Decoder=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0,buffer,HEAP8,HEAPU8,HEAP16,HEAPU16,HEAP32,HEAPU32,HEAPF32,HEAPF64;function UTF8ArrayToString(t,e,r){for(var n=e+r,i=e;t[i]&&!(i>=n);)++i;if(i-e>16&&t.buffer&&UTF8Decoder)return UTF8Decoder.decode(t.subarray(e,i));for(var o="";e<i;){var a=t[e++];if(128&a){var c=63&t[e++];if((224&a)!=192){var l=63&t[e++];if((a=(240&a)==224?(15&a)<<12|c<<6|l:(7&a)<<18|c<<12|l<<6|63&t[e++])<65536)o+=String.fromCharCode(a);else{var u=a-65536;o+=String.fromCharCode(55296|u>>10,56320|1023&u)}}else o+=String.fromCharCode((31&a)<<6|c)}else o+=String.fromCharCode(a)}return o}s(UTF8ArrayToString,"UTF8ArrayToString");function UTF8ToString(t,e){return t?UTF8ArrayToString(HEAPU8,t,e):""}s(UTF8ToString,"UTF8ToString");function stringToUTF8Array(t,e,r,n){if(!(n>0))return 0;for(var i=r,o=r+n-1,a=0;a<t.length;++a){var c=t.charCodeAt(a);if(c>=55296&&c<=57343&&(c=65536+((1023&c)<<10)|1023&t.charCodeAt(++a)),c<=127){if(r>=o)break;e[r++]=c}else if(c<=2047){if(r+1>=o)break;e[r++]=192|c>>6,e[r++]=128|63&c}else if(c<=65535){if(r+2>=o)break;e[r++]=224|c>>12,e[r++]=128|c>>6&63,e[r++]=128|63&c}else{if(r+3>=o)break;e[r++]=240|c>>18,e[r++]=128|c>>12&63,e[r++]=128|c>>6&63,e[r++]=128|63&c}}return e[r]=0,r-i}s(stringToUTF8Array,"stringToUTF8Array");function stringToUTF8(t,e,r){return stringToUTF8Array(t,HEAPU8,e,r)}s(stringToUTF8,"stringToUTF8");function lengthBytesUTF8(t){for(var e=0,r=0;r<t.length;++r){var n=t.charCodeAt(r);n<=127?e++:n<=2047?e+=2:n>=55296&&n<=57343?(e+=4,++r):e+=3}return e}s(lengthBytesUTF8,"lengthBytesUTF8");function updateGlobalBufferAndViews(t){buffer=t,Module.HEAP8=HEAP8=new Int8Array(t),Module.HEAP16=HEAP16=new Int16Array(t),Module.HEAP32=HEAP32=new Int32Array(t),Module.HEAPU8=HEAPU8=new Uint8Array(t),Module.HEAPU16=HEAPU16=new Uint16Array(t),Module.HEAPU32=HEAPU32=new Uint32Array(t),Module.HEAPF32=HEAPF32=new Float32Array(t),Module.HEAPF64=HEAPF64=new Float64Array(t)}s(updateGlobalBufferAndViews,"updateGlobalBufferAndViews");var INITIAL_MEMORY=Module.INITIAL_MEMORY||33554432;wasmMemory=Module.wasmMemory?Module.wasmMemory:new WebAssembly.Memory({initial:INITIAL_MEMORY/65536,maximum:32768}),wasmMemory&&(buffer=wasmMemory.buffer),INITIAL_MEMORY=buffer.byteLength,updateGlobalBufferAndViews(buffer);var wasmTable=new WebAssembly.Table({initial:20,element:"anyfunc"}),__ATPRERUN__=[],__ATINIT__=[],__ATMAIN__=[],__ATPOSTRUN__=[],__RELOC_FUNCS__=[],runtimeInitialized=!1;function keepRuntimeAlive(){return noExitRuntime}s(keepRuntimeAlive,"keepRuntimeAlive");function preRun(){if(Module.preRun)for(typeof Module.preRun=="function"&&(Module.preRun=[Module.preRun]);Module.preRun.length;)addOnPreRun(Module.preRun.shift());callRuntimeCallbacks(__ATPRERUN__)}s(preRun,"preRun");function initRuntime(){runtimeInitialized=!0,callRuntimeCallbacks(__RELOC_FUNCS__),callRuntimeCallbacks(__ATINIT__)}s(initRuntime,"initRuntime");function preMain(){callRuntimeCallbacks(__ATMAIN__)}s(preMain,"preMain");function postRun(){if(Module.postRun)for(typeof Module.postRun=="function"&&(Module.postRun=[Module.postRun]);Module.postRun.length;)addOnPostRun(Module.postRun.shift());callRuntimeCallbacks(__ATPOSTRUN__)}s(postRun,"postRun");function addOnPreRun(t){__ATPRERUN__.unshift(t)}s(addOnPreRun,"addOnPreRun");function addOnInit(t){__ATINIT__.unshift(t)}s(addOnInit,"addOnInit");function addOnPostRun(t){__ATPOSTRUN__.unshift(t)}s(addOnPostRun,"addOnPostRun");var runDependencies=0,runDependencyWatcher=null,dependenciesFulfilled=null;function addRunDependency(t){runDependencies++,Module.monitorRunDependencies&&Module.monitorRunDependencies(runDependencies)}s(addRunDependency,"addRunDependency");function removeRunDependency(t){if(runDependencies--,Module.monitorRunDependencies&&Module.monitorRunDependencies(runDependencies),runDependencies==0&&(runDependencyWatcher!==null&&(clearInterval(runDependencyWatcher),runDependencyWatcher=null),dependenciesFulfilled)){var e=dependenciesFulfilled;dependenciesFulfilled=null,e()}}s(removeRunDependency,"removeRunDependency");function abort(t){throw Module.onAbort&&Module.onAbort(t),err(t="Aborted("+t+")"),ABORT=!0,EXITSTATUS=1,t+=". Build with -sASSERTIONS for more info.",new WebAssembly.RuntimeError(t)}s(abort,"abort");var dataURIPrefix="data:application/octet-stream;base64,",wasmBinaryFile,tempDouble,tempI64;function isDataURI(t){return t.startsWith(dataURIPrefix)}s(isDataURI,"isDataURI");function isFileURI(t){return t.startsWith("file://")}s(isFileURI,"isFileURI");function getBinary(t){try{if(t==wasmBinaryFile&&wasmBinary)return new Uint8Array(wasmBinary);if(readBinary)return readBinary(t);throw"both async and sync fetching of the wasm failed"}catch(e){abort(e)}}s(getBinary,"getBinary");function getBinaryPromise(){if(!wasmBinary&&(ENVIRONMENT_IS_WEB||ENVIRONMENT_IS_WORKER)){if(typeof fetch=="function"&&!isFileURI(wasmBinaryFile))return fetch(wasmBinaryFile,{credentials:"same-origin"}).then(function(t){if(!t.ok)throw"failed to load wasm binary file at '"+wasmBinaryFile+"'";return t.arrayBuffer()}).catch(function(){return getBinary(wasmBinaryFile)});if(readAsync)return new Promise(function(t,e){readAsync(wasmBinaryFile,function(r){t(new Uint8Array(r))},e)})}return Promise.resolve().then(function(){return getBinary(wasmBinaryFile)})}s(getBinaryPromise,"getBinaryPromise");function createWasm(){var t={env:asmLibraryArg,wasi_snapshot_preview1:asmLibraryArg,"GOT.mem":new Proxy(asmLibraryArg,GOTHandler),"GOT.func":new Proxy(asmLibraryArg,GOTHandler)};function e(i,o){var a=i.exports;a=relocateExports(a,1024);var c=getDylinkMetadata(o);c.neededDynlibs&&(dynamicLibraries=c.neededDynlibs.concat(dynamicLibraries)),mergeLibSymbols(a,"main"),Module.asm=a,addOnInit(Module.asm.__wasm_call_ctors),__RELOC_FUNCS__.push(Module.asm.__wasm_apply_data_relocs),removeRunDependency("wasm-instantiate")}s(e,"t");function r(i){e(i.instance,i.module)}s(r,"r");function n(i){return getBinaryPromise().then(function(o){return WebAssembly.instantiate(o,t)}).then(function(o){return o}).then(i,function(o){err("failed to asynchronously prepare wasm: "+o),abort(o)})}if(s(n,"_"),addRunDependency("wasm-instantiate"),Module.instantiateWasm)try{return Module.instantiateWasm(t,e)}catch(i){return err("Module.instantiateWasm callback failed with error: "+i),!1}return wasmBinary||typeof WebAssembly.instantiateStreaming!="function"||isDataURI(wasmBinaryFile)||isFileURI(wasmBinaryFile)||ENVIRONMENT_IS_NODE||typeof fetch!="function"?n(r):fetch(wasmBinaryFile,{credentials:"same-origin"}).then(function(i){return WebAssembly.instantiateStreaming(i,t).then(r,function(o){return err("wasm streaming compile failed: "+o),err("falling back to ArrayBuffer instantiation"),n(r)})}),{}}s(createWasm,"createWasm"),wasmBinaryFile="tree-sitter.wasm",isDataURI(wasmBinaryFile)||(wasmBinaryFile=locateFile(wasmBinaryFile));var ASM_CONSTS={};function ExitStatus(t){this.name="ExitStatus",this.message="Program terminated with exit("+t+")",this.status=t}s(ExitStatus,"ExitStatus");var GOT={},CurrentModuleWeakSymbols=new Set([]),GOTHandler={get:s(function(t,e){var r=GOT[e];return r||(r=GOT[e]=new WebAssembly.Global({value:"i32",mutable:!0})),CurrentModuleWeakSymbols.has(e)||(r.required=!0),r},"get")};function callRuntimeCallbacks(t){for(;t.length>0;)t.shift()(Module)}s(callRuntimeCallbacks,"callRuntimeCallbacks");function getDylinkMetadata(t){var e=0,r=0;function n(){for(var E=0,b=1;;){var S=t[e++];if(E+=(127&S)*b,b*=128,!(128&S))break}return E}s(n,"_");function i(){var E=n();return UTF8ArrayToString(t,(e+=E)-E,E)}s(i,"n");function o(E,b){if(E)throw new Error(b)}s(o,"s");var a="dylink.0";if(t instanceof WebAssembly.Module){var c=WebAssembly.Module.customSections(t,a);c.length===0&&(a="dylink",c=WebAssembly.Module.customSections(t,a)),o(c.length===0,"need dylink section"),r=(t=new Uint8Array(c[0])).length}else{o(new Uint32Array(new Uint8Array(t.subarray(0,24)).buffer)[0]!=1836278016,"need to see wasm magic number"),o(t[8]!==0,"need the dylink section to be first"),e=9;var l=n();r=e+l,a=i()}var u={neededDynlibs:[],tlsExports:new Set,weakImports:new Set};if(a=="dylink"){u.memorySize=n(),u.memoryAlign=n(),u.tableSize=n(),u.tableAlign=n();for(var f=n(),p=0;p<f;++p){var m=i();u.neededDynlibs.push(m)}}else for(o(a!=="dylink.0");e<r;){var h=t[e++],g=n();if(h===1)u.memorySize=n(),u.memoryAlign=n(),u.tableSize=n(),u.tableAlign=n();else if(h===2)for(f=n(),p=0;p<f;++p)m=i(),u.neededDynlibs.push(m);else if(h===3)for(var A=n();A--;){var y=i();256&n()&&u.tlsExports.add(y)}else if(h===4)for(A=n();A--;)i(),y=i(),(3&n())==1&&u.weakImports.add(y);else e+=g}return u}s(getDylinkMetadata,"getDylinkMetadata");function getValue(t,e="i8"){switch(e.endsWith("*")&&(e="*"),e){case"i1":case"i8":return HEAP8[t>>0];case"i16":return HEAP16[t>>1];case"i32":case"i64":return HEAP32[t>>2];case"float":return HEAPF32[t>>2];case"double":return HEAPF64[t>>3];case"*":return HEAPU32[t>>2];default:abort("invalid type for getValue: "+e)}return null}s(getValue,"getValue");function asmjsMangle(t){return t.indexOf("dynCall_")==0||["stackAlloc","stackSave","stackRestore","getTempRet0","setTempRet0"].includes(t)?t:"_"+t}s(asmjsMangle,"asmjsMangle");function mergeLibSymbols(t,e){for(var r in t)if(t.hasOwnProperty(r)){asmLibraryArg.hasOwnProperty(r)||(asmLibraryArg[r]=t[r]);var n=asmjsMangle(r);Module.hasOwnProperty(n)||(Module[n]=t[r]),r=="__main_argc_argv"&&(Module._main=t[r])}}s(mergeLibSymbols,"mergeLibSymbols");var LDSO={loadedLibsByName:{},loadedLibsByHandle:{}};function dynCallLegacy(t,e,r){var n=Module["dynCall_"+t];return r&&r.length?n.apply(null,[e].concat(r)):n.call(null,e)}s(dynCallLegacy,"dynCallLegacy");var wasmTableMirror=[];function getWasmTableEntry(t){var e=wasmTableMirror[t];return e||(t>=wasmTableMirror.length&&(wasmTableMirror.length=t+1),wasmTableMirror[t]=e=wasmTable.get(t)),e}s(getWasmTableEntry,"getWasmTableEntry");function dynCall(t,e,r){return t.includes("j")?dynCallLegacy(t,e,r):getWasmTableEntry(e).apply(null,r)}s(dynCall,"dynCall");function createInvokeFunction(t){return function(){var e=stackSave();try{return dynCall(t,arguments[0],Array.prototype.slice.call(arguments,1))}catch(r){if(stackRestore(e),r!==r+0)throw r;_setThrew(1,0)}}}s(createInvokeFunction,"createInvokeFunction");var ___heap_base=78144;function zeroMemory(t,e){return HEAPU8.fill(0,t,t+e),t}s(zeroMemory,"zeroMemory");function getMemory(t){if(runtimeInitialized)return zeroMemory(_malloc(t),t);var e=___heap_base,r=e+t+15&-16;return ___heap_base=r,GOT.__heap_base.value=r,e}s(getMemory,"getMemory");function isInternalSym(t){return["__cpp_exception","__c_longjmp","__wasm_apply_data_relocs","__dso_handle","__tls_size","__tls_align","__set_stack_limits","_emscripten_tls_init","__wasm_init_tls","__wasm_call_ctors","__start_em_asm","__stop_em_asm"].includes(t)}s(isInternalSym,"isInternalSym");function uleb128Encode(t,e){t<128?e.push(t):e.push(t%128|128,t>>7)}s(uleb128Encode,"uleb128Encode");function sigToWasmTypes(t){for(var e={i:"i32",j:"i32",f:"f32",d:"f64",p:"i32"},r={parameters:[],results:t[0]=="v"?[]:[e[t[0]]]},n=1;n<t.length;++n)r.parameters.push(e[t[n]]),t[n]==="j"&&r.parameters.push("i32");return r}s(sigToWasmTypes,"sigToWasmTypes");function generateFuncType(t,e){var r=t.slice(0,1),n=t.slice(1),i={i:127,p:127,j:126,f:125,d:124};e.push(96),uleb128Encode(n.length,e);for(var o=0;o<n.length;++o)e.push(i[n[o]]);r=="v"?e.push(0):e.push(1,i[r])}s(generateFuncType,"generateFuncType");function convertJsFunctionToWasm(t,e){if(typeof WebAssembly.Function=="function")return new WebAssembly.Function(sigToWasmTypes(e),t);var r=[1];generateFuncType(e,r);var n=[0,97,115,109,1,0,0,0,1];uleb128Encode(r.length,n),n.push.apply(n,r),n.push(2,7,1,1,101,1,102,0,0,7,5,1,1,102,0,0);var i=new WebAssembly.Module(new Uint8Array(n));return new WebAssembly.Instance(i,{e:{f:t}}).exports.f}s(convertJsFunctionToWasm,"convertJsFunctionToWasm");function updateTableMap(t,e){if(functionsInTableMap)for(var r=t;r<t+e;r++){var n=getWasmTableEntry(r);n&&functionsInTableMap.set(n,r)}}s(updateTableMap,"updateTableMap");var functionsInTableMap=void 0,freeTableIndexes=[];function getEmptyTableSlot(){if(freeTableIndexes.length)return freeTableIndexes.pop();try{wasmTable.grow(1)}catch(t){throw t instanceof RangeError?"Unable to grow wasm table. Set ALLOW_TABLE_GROWTH.":t}return wasmTable.length-1}s(getEmptyTableSlot,"getEmptyTableSlot");function setWasmTableEntry(t,e){wasmTable.set(t,e),wasmTableMirror[t]=wasmTable.get(t)}s(setWasmTableEntry,"setWasmTableEntry");function addFunction(t,e){if(functionsInTableMap||(functionsInTableMap=new WeakMap,updateTableMap(0,wasmTable.length)),functionsInTableMap.has(t))return functionsInTableMap.get(t);var r=getEmptyTableSlot();try{setWasmTableEntry(r,t)}catch(n){if(!(n instanceof TypeError))throw n;setWasmTableEntry(r,convertJsFunctionToWasm(t,e))}return functionsInTableMap.set(t,r),r}s(addFunction,"addFunction");function updateGOT(t,e){for(var r in t)if(!isInternalSym(r)){var n=t[r];r.startsWith("orig$")&&(r=r.split("$")[1],e=!0),GOT[r]||(GOT[r]=new WebAssembly.Global({value:"i32",mutable:!0})),(e||GOT[r].value==0)&&(typeof n=="function"?GOT[r].value=addFunction(n):typeof n=="number"?GOT[r].value=n:err("unhandled export type for `"+r+"`: "+typeof n))}}s(updateGOT,"updateGOT");function relocateExports(t,e,r){var n={};for(var i in t){var o=t[i];typeof o=="object"&&(o=o.value),typeof o=="number"&&(o+=e),n[i]=o}return updateGOT(n,r),n}s(relocateExports,"relocateExports");function resolveGlobalSymbol(t,e){var r;return e&&(r=asmLibraryArg["orig$"+t]),r||(r=asmLibraryArg[t])&&r.stub&&(r=void 0),r||(r=Module[asmjsMangle(t)]),!r&&t.startsWith("invoke_")&&(r=createInvokeFunction(t.split("_")[1])),r}s(resolveGlobalSymbol,"resolveGlobalSymbol");function alignMemory(t,e){return Math.ceil(t/e)*e}s(alignMemory,"alignMemory");function loadWebAssemblyModule(binary,flags,handle){var metadata=getDylinkMetadata(binary);function loadModule(){var firstLoad=!handle||!HEAP8[handle+12>>0];if(firstLoad){var memAlign=Math.pow(2,metadata.memoryAlign);memAlign=Math.max(memAlign,STACK_ALIGN);var memoryBase=metadata.memorySize?alignMemory(getMemory(metadata.memorySize+memAlign),memAlign):0,tableBase=metadata.tableSize?wasmTable.length:0;handle&&(HEAP8[handle+12>>0]=1,HEAPU32[handle+16>>2]=memoryBase,HEAP32[handle+20>>2]=metadata.memorySize,HEAPU32[handle+24>>2]=tableBase,HEAP32[handle+28>>2]=metadata.tableSize)}else memoryBase=HEAPU32[handle+16>>2],tableBase=HEAPU32[handle+24>>2];var tableGrowthNeeded=tableBase+metadata.tableSize-wasmTable.length,moduleExports;function resolveSymbol(t){var e=resolveGlobalSymbol(t,!1);return e||(e=moduleExports[t]),e}s(resolveSymbol,"resolveSymbol"),tableGrowthNeeded>0&&wasmTable.grow(tableGrowthNeeded);var proxyHandler={get:s(function(t,e){switch(e){case"__memory_base":return memoryBase;case"__table_base":return tableBase}if(e in asmLibraryArg)return asmLibraryArg[e];var r;return e in t||(t[e]=function(){return r||(r=resolveSymbol(e)),r.apply(null,arguments)}),t[e]},"get")},proxy=new Proxy({},proxyHandler),info={"GOT.mem":new Proxy({},GOTHandler),"GOT.func":new Proxy({},GOTHandler),env:proxy,wasi_snapshot_preview1:proxy};function postInstantiation(instance){function addEmAsm(addr,body){for(var args=[],arity=0;arity<16&&body.indexOf("$"+arity)!=-1;arity++)args.push("$"+arity);args=args.join(",");var func="("+args+" ) => { "+body+"};";ASM_CONSTS[start]=eval(func)}if(s(addEmAsm,"addEmAsm"),updateTableMap(tableBase,metadata.tableSize),moduleExports=relocateExports(instance.exports,memoryBase),flags.allowUndefined||reportUndefinedSymbols(),"__start_em_asm"in moduleExports)for(var start=moduleExports.__start_em_asm,stop=moduleExports.__stop_em_asm;start<stop;){var jsString=UTF8ToString(start);addEmAsm(start,jsString),start=HEAPU8.indexOf(0,start)+1}var applyRelocs=moduleExports.__wasm_apply_data_relocs;applyRelocs&&(runtimeInitialized?applyRelocs():__RELOC_FUNCS__.push(applyRelocs));var init=moduleExports.__wasm_call_ctors;return init&&(runtimeInitialized?init():__ATINIT__.push(init)),moduleExports}if(s(postInstantiation,"postInstantiation"),flags.loadAsync){if(binary instanceof WebAssembly.Module){var instance=new WebAssembly.Instance(binary,info);return Promise.resolve(postInstantiation(instance))}return WebAssembly.instantiate(binary,info).then(function(t){return postInstantiation(t.instance)})}var module=binary instanceof WebAssembly.Module?binary:new WebAssembly.Module(binary),instance=new WebAssembly.Instance(module,info);return postInstantiation(instance)}return s(loadModule,"loadModule"),CurrentModuleWeakSymbols=metadata.weakImports,flags.loadAsync?metadata.neededDynlibs.reduce(function(t,e){return t.then(function(){return loadDynamicLibrary(e,flags)})},Promise.resolve()).then(function(){return loadModule()}):(metadata.neededDynlibs.forEach(function(t){loadDynamicLibrary(t,flags)}),loadModule())}s(loadWebAssemblyModule,"loadWebAssemblyModule");function loadDynamicLibrary(t,e,r){e=e||{global:!0,nodelete:!0};var n=LDSO.loadedLibsByName[t];if(n)return e.global&&!n.global&&(n.global=!0,n.module!=="loading"&&mergeLibSymbols(n.module,t)),e.nodelete&&n.refcount!==1/0&&(n.refcount=1/0),n.refcount++,r&&(LDSO.loadedLibsByHandle[r]=n),!e.loadAsync||Promise.resolve(!0);function i(c){if(e.fs&&e.fs.findObject(c)){var l=e.fs.readFile(c,{encoding:"binary"});return l instanceof Uint8Array||(l=new Uint8Array(l)),e.loadAsync?Promise.resolve(l):l}if(c=locateFile(c),e.loadAsync)return new Promise(function(u,f){readAsync(c,p=>u(new Uint8Array(p)),f)});if(!readBinary)throw new Error(c+": file not found, and synchronous loading of external files is not available");return readBinary(c)}s(i,"n");function o(){if(typeof preloadedWasm<"u"&&preloadedWasm[t]){var c=preloadedWasm[t];return e.loadAsync?Promise.resolve(c):c}return e.loadAsync?i(t).then(function(l){return loadWebAssemblyModule(l,e,r)}):loadWebAssemblyModule(i(t),e,r)}s(o,"s");function a(c){n.global&&mergeLibSymbols(c,t),n.module=c}return s(a,"a"),n={refcount:e.nodelete?1/0:1,name:t,module:"loading",global:e.global},LDSO.loadedLibsByName[t]=n,r&&(LDSO.loadedLibsByHandle[r]=n),e.loadAsync?o().then(function(c){return a(c),!0}):(a(o()),!0)}s(loadDynamicLibrary,"loadDynamicLibrary");function reportUndefinedSymbols(){for(var t in GOT)if(GOT[t].value==0){var e=resolveGlobalSymbol(t,!0);if(!e&&!GOT[t].required)continue;if(typeof e=="function")GOT[t].value=addFunction(e,e.sig);else{if(typeof e!="number")throw new Error("bad export type for `"+t+"`: "+typeof e);GOT[t].value=e}}}s(reportUndefinedSymbols,"reportUndefinedSymbols");function preloadDylibs(){dynamicLibraries.length?(addRunDependency("preloadDylibs"),dynamicLibraries.reduce(function(t,e){return t.then(function(){return loadDynamicLibrary(e,{loadAsync:!0,global:!0,nodelete:!0,allowUndefined:!0})})},Promise.resolve()).then(function(){reportUndefinedSymbols(),removeRunDependency("preloadDylibs")})):reportUndefinedSymbols()}s(preloadDylibs,"preloadDylibs");function setValue(t,e,r="i8"){switch(r.endsWith("*")&&(r="*"),r){case"i1":case"i8":HEAP8[t>>0]=e;break;case"i16":HEAP16[t>>1]=e;break;case"i32":HEAP32[t>>2]=e;break;case"i64":tempI64=[e>>>0,(tempDouble=e,+Math.abs(tempDouble)>=1?tempDouble>0?(0|Math.min(+Math.floor(tempDouble/4294967296),4294967295))>>>0:~~+Math.ceil((tempDouble-+(~~tempDouble>>>0))/4294967296)>>>0:0)],HEAP32[t>>2]=tempI64[0],HEAP32[t+4>>2]=tempI64[1];break;case"float":HEAPF32[t>>2]=e;break;case"double":HEAPF64[t>>3]=e;break;case"*":HEAPU32[t>>2]=e;break;default:abort("invalid type for setValue: "+r)}}s(setValue,"setValue");var ___memory_base=new WebAssembly.Global({value:"i32",mutable:!1},1024),___stack_pointer=new WebAssembly.Global({value:"i32",mutable:!0},78144),___table_base=new WebAssembly.Global({value:"i32",mutable:!1},1),nowIsMonotonic=!0,_emscripten_get_now;function __emscripten_get_now_is_monotonic(){return nowIsMonotonic}s(__emscripten_get_now_is_monotonic,"__emscripten_get_now_is_monotonic");function _abort(){abort("")}s(_abort,"_abort");function _emscripten_date_now(){return Date.now()}s(_emscripten_date_now,"_emscripten_date_now");function _emscripten_memcpy_big(t,e,r){HEAPU8.copyWithin(t,e,e+r)}s(_emscripten_memcpy_big,"_emscripten_memcpy_big");function getHeapMax(){return 2147483648}s(getHeapMax,"getHeapMax");function emscripten_realloc_buffer(t){try{return wasmMemory.grow(t-buffer.byteLength+65535>>>16),updateGlobalBufferAndViews(wasmMemory.buffer),1}catch{}}s(emscripten_realloc_buffer,"emscripten_realloc_buffer");function _emscripten_resize_heap(t){var e=HEAPU8.length;t>>>=0;var r=getHeapMax();if(t>r)return!1;for(var n=1;n<=4;n*=2){var i=e*(1+.2/n);if(i=Math.min(i,t+100663296),emscripten_realloc_buffer(Math.min(r,(o=Math.max(t,i))+((a=65536)-o%a)%a)))return!0}var o,a;return!1}s(_emscripten_resize_heap,"_emscripten_resize_heap"),__emscripten_get_now_is_monotonic.sig="i",Module._abort=_abort,_abort.sig="v",_emscripten_date_now.sig="d",_emscripten_get_now=ENVIRONMENT_IS_NODE?()=>{var t=process.hrtime();return 1e3*t[0]+t[1]/1e6}:()=>performance.now(),_emscripten_get_now.sig="d",_emscripten_memcpy_big.sig="vppp",_emscripten_resize_heap.sig="ip";var SYSCALLS={DEFAULT_POLLMASK:5,calculateAt:s(function(t,e,r){if(PATH.isAbs(e))return e;var n;if(t===-100?n=FS.cwd():n=SYSCALLS.getStreamFromFD(t).path,e.length==0){if(!r)throw new FS.ErrnoError(44);return n}return PATH.join2(n,e)},"calculateAt"),doStat:s(function(t,e,r){try{var n=t(e)}catch(c){if(c&&c.node&&PATH.normalize(e)!==PATH.normalize(FS.getPath(c.node)))return-54;throw c}HEAP32[r>>2]=n.dev,HEAP32[r+8>>2]=n.ino,HEAP32[r+12>>2]=n.mode,HEAPU32[r+16>>2]=n.nlink,HEAP32[r+20>>2]=n.uid,HEAP32[r+24>>2]=n.gid,HEAP32[r+28>>2]=n.rdev,tempI64=[n.size>>>0,(tempDouble=n.size,+Math.abs(tempDouble)>=1?tempDouble>0?(0|Math.min(+Math.floor(tempDouble/4294967296),4294967295))>>>0:~~+Math.ceil((tempDouble-+(~~tempDouble>>>0))/4294967296)>>>0:0)],HEAP32[r+40>>2]=tempI64[0],HEAP32[r+44>>2]=tempI64[1],HEAP32[r+48>>2]=4096,HEAP32[r+52>>2]=n.blocks;var i=n.atime.getTime(),o=n.mtime.getTime(),a=n.ctime.getTime();return tempI64=[Math.floor(i/1e3)>>>0,(tempDouble=Math.floor(i/1e3),+Math.abs(tempDouble)>=1?tempDouble>0?(0|Math.min(+Math.floor(tempDouble/4294967296),4294967295))>>>0:~~+Math.ceil((tempDouble-+(~~tempDouble>>>0))/4294967296)>>>0:0)],HEAP32[r+56>>2]=tempI64[0],HEAP32[r+60>>2]=tempI64[1],HEAPU32[r+64>>2]=i%1e3*1e3,tempI64=[Math.floor(o/1e3)>>>0,(tempDouble=Math.floor(o/1e3),+Math.abs(tempDouble)>=1?tempDouble>0?(0|Math.min(+Math.floor(tempDouble/4294967296),4294967295))>>>0:~~+Math.ceil((tempDouble-+(~~tempDouble>>>0))/4294967296)>>>0:0)],HEAP32[r+72>>2]=tempI64[0],HEAP32[r+76>>2]=tempI64[1],HEAPU32[r+80>>2]=o%1e3*1e3,tempI64=[Math.floor(a/1e3)>>>0,(tempDouble=Math.floor(a/1e3),+Math.abs(tempDouble)>=1?tempDouble>0?(0|Math.min(+Math.floor(tempDouble/4294967296),4294967295))>>>0:~~+Math.ceil((tempDouble-+(~~tempDouble>>>0))/4294967296)>>>0:0)],HEAP32[r+88>>2]=tempI64[0],HEAP32[r+92>>2]=tempI64[1],HEAPU32[r+96>>2]=a%1e3*1e3,tempI64=[n.ino>>>0,(tempDouble=n.ino,+Math.abs(tempDouble)>=1?tempDouble>0?(0|Math.min(+Math.floor(tempDouble/4294967296),4294967295))>>>0:~~+Math.ceil((tempDouble-+(~~tempDouble>>>0))/4294967296)>>>0:0)],HEAP32[r+104>>2]=tempI64[0],HEAP32[r+108>>2]=tempI64[1],0},"doStat"),doMsync:s(function(t,e,r,n,i){if(!FS.isFile(e.node.mode))throw new FS.ErrnoError(43);if(2&n)return 0;var o=HEAPU8.slice(t,t+r);FS.msync(e,o,i,r,n)},"doMsync"),varargs:void 0,get:s(function(){return SYSCALLS.varargs+=4,HEAP32[SYSCALLS.varargs-4>>2]},"get"),getStr:s(function(t){return UTF8ToString(t)},"getStr"),getStreamFromFD:s(function(t){var e=FS.getStream(t);if(!e)throw new FS.ErrnoError(8);return e},"getStreamFromFD")};function _proc_exit(t){EXITSTATUS=t,keepRuntimeAlive()||(Module.onExit&&Module.onExit(t),ABORT=!0),quit_(t,new ExitStatus(t))}s(_proc_exit,"_proc_exit");function exitJS(t,e){EXITSTATUS=t,_proc_exit(t)}s(exitJS,"exitJS"),_proc_exit.sig="vi";var _exit=exitJS;function _fd_close(t){try{var e=SYSCALLS.getStreamFromFD(t);return FS.close(e),0}catch(r){if(typeof FS>"u"||!(r instanceof FS.ErrnoError))throw r;return r.errno}}s(_fd_close,"_fd_close");function convertI32PairToI53Checked(t,e){return e+2097152>>>0<4194305-!!t?(t>>>0)+4294967296*e:NaN}s(convertI32PairToI53Checked,"convertI32PairToI53Checked");function _fd_seek(t,e,r,n,i){try{var o=convertI32PairToI53Checked(e,r);if(isNaN(o))return 61;var a=SYSCALLS.getStreamFromFD(t);return FS.llseek(a,o,n),tempI64=[a.position>>>0,(tempDouble=a.position,+Math.abs(tempDouble)>=1?tempDouble>0?(0|Math.min(+Math.floor(tempDouble/4294967296),4294967295))>>>0:~~+Math.ceil((tempDouble-+(~~tempDouble>>>0))/4294967296)>>>0:0)],HEAP32[i>>2]=tempI64[0],HEAP32[i+4>>2]=tempI64[1],a.getdents&&o===0&&n===0&&(a.getdents=null),0}catch(c){if(typeof FS>"u"||!(c instanceof FS.ErrnoError))throw c;return c.errno}}s(_fd_seek,"_fd_seek");function doWritev(t,e,r,n){for(var i=0,o=0;o<r;o++){var a=HEAPU32[e>>2],c=HEAPU32[e+4>>2];e+=8;var l=FS.write(t,HEAP8,a,c,n);if(l<0)return-1;i+=l,n!==void 0&&(n+=l)}return i}s(doWritev,"doWritev");function _fd_write(t,e,r,n){try{var i=doWritev(SYSCALLS.getStreamFromFD(t),e,r);return HEAPU32[n>>2]=i,0}catch(o){if(typeof FS>"u"||!(o instanceof FS.ErrnoError))throw o;return o.errno}}s(_fd_write,"_fd_write");function _tree_sitter_log_callback(t,e){if(currentLogCallback){let r=UTF8ToString(e);currentLogCallback(r,t!==0)}}s(_tree_sitter_log_callback,"_tree_sitter_log_callback");function _tree_sitter_parse_callback(t,e,r,n,i){var o=currentParseCallback(e,{row:r,column:n});typeof o=="string"?(setValue(i,o.length,"i32"),stringToUTF16(o,t,10240)):setValue(i,0,"i32")}s(_tree_sitter_parse_callback,"_tree_sitter_parse_callback");function handleException(t){if(t instanceof ExitStatus||t=="unwind")return EXITSTATUS;quit_(1,t)}s(handleException,"handleException");function allocateUTF8OnStack(t){var e=lengthBytesUTF8(t)+1,r=stackAlloc(e);return stringToUTF8Array(t,HEAP8,r,e),r}s(allocateUTF8OnStack,"allocateUTF8OnStack");function stringToUTF16(t,e,r){if(r===void 0&&(r=2147483647),r<2)return 0;for(var n=e,i=(r-=2)<2*t.length?r/2:t.length,o=0;o<i;++o){var a=t.charCodeAt(o);HEAP16[e>>1]=a,e+=2}return HEAP16[e>>1]=0,e-n}s(stringToUTF16,"stringToUTF16");function AsciiToString(t){for(var e="";;){var r=HEAPU8[t++>>0];if(!r)return e;e+=String.fromCharCode(r)}}s(AsciiToString,"AsciiToString"),_exit.sig="vi",_fd_close.sig="ii",_fd_seek.sig="iijip",_fd_write.sig="iippp";var asmLibraryArg={__heap_base:___heap_base,__indirect_function_table:wasmTable,__memory_base:___memory_base,__stack_pointer:___stack_pointer,__table_base:___table_base,_emscripten_get_now_is_monotonic:__emscripten_get_now_is_monotonic,abort:_abort,emscripten_get_now:_emscripten_get_now,emscripten_memcpy_big:_emscripten_memcpy_big,emscripten_resize_heap:_emscripten_resize_heap,exit:_exit,fd_close:_fd_close,fd_seek:_fd_seek,fd_write:_fd_write,memory:wasmMemory,tree_sitter_log_callback:_tree_sitter_log_callback,tree_sitter_parse_callback:_tree_sitter_parse_callback},asm=createWasm(),___wasm_call_ctors=Module.___wasm_call_ctors=function(){return(___wasm_call_ctors=Module.___wasm_call_ctors=Module.asm.__wasm_call_ctors).apply(null,arguments)},___wasm_apply_data_relocs=Module.___wasm_apply_data_relocs=function(){return(___wasm_apply_data_relocs=Module.___wasm_apply_data_relocs=Module.asm.__wasm_apply_data_relocs).apply(null,arguments)},_malloc=Module._malloc=function(){return(_malloc=Module._malloc=Module.asm.malloc).apply(null,arguments)},_calloc=Module._calloc=function(){return(_calloc=Module._calloc=Module.asm.calloc).apply(null,arguments)},_realloc=Module._realloc=function(){return(_realloc=Module._realloc=Module.asm.realloc).apply(null,arguments)},_free=Module._free=function(){return(_free=Module._free=Module.asm.free).apply(null,arguments)},_ts_language_symbol_count=Module._ts_language_symbol_count=function(){return(_ts_language_symbol_count=Module._ts_language_symbol_count=Module.asm.ts_language_symbol_count).apply(null,arguments)},_ts_language_version=Module._ts_language_version=function(){return(_ts_language_version=Module._ts_language_version=Module.asm.ts_language_version).apply(null,arguments)},_ts_language_field_count=Module._ts_language_field_count=function(){return(_ts_language_field_count=Module._ts_language_field_count=Module.asm.ts_language_field_count).apply(null,arguments)},_ts_language_symbol_name=Module._ts_language_symbol_name=function(){return(_ts_language_symbol_name=Module._ts_language_symbol_name=Module.asm.ts_language_symbol_name).apply(null,arguments)},_ts_language_symbol_for_name=Module._ts_language_symbol_for_name=function(){return(_ts_language_symbol_for_name=Module._ts_language_symbol_for_name=Module.asm.ts_language_symbol_for_name).apply(null,arguments)},_ts_language_symbol_type=Module._ts_language_symbol_type=function(){return(_ts_language_symbol_type=Module._ts_language_symbol_type=Module.asm.ts_language_symbol_type).apply(null,arguments)},_ts_language_field_name_for_id=Module._ts_language_field_name_for_id=function(){return(_ts_language_field_name_for_id=Module._ts_language_field_name_for_id=Module.asm.ts_language_field_name_for_id).apply(null,arguments)},_memset=Module._memset=function(){return(_memset=Module._memset=Module.asm.memset).apply(null,arguments)},_memcpy=Module._memcpy=function(){return(_memcpy=Module._memcpy=Module.asm.memcpy).apply(null,arguments)},_ts_parser_delete=Module._ts_parser_delete=function(){return(_ts_parser_delete=Module._ts_parser_delete=Module.asm.ts_parser_delete).apply(null,arguments)},_ts_parser_reset=Module._ts_parser_reset=function(){return(_ts_parser_reset=Module._ts_parser_reset=Module.asm.ts_parser_reset).apply(null,arguments)},_ts_parser_set_language=Module._ts_parser_set_language=function(){return(_ts_parser_set_language=Module._ts_parser_set_language=Module.asm.ts_parser_set_language).apply(null,arguments)},_ts_parser_timeout_micros=Module._ts_parser_timeout_micros=function(){return(_ts_parser_timeout_micros=Module._ts_parser_timeout_micros=Module.asm.ts_parser_timeout_micros).apply(null,arguments)},_ts_parser_set_timeout_micros=Module._ts_parser_set_timeout_micros=function(){return(_ts_parser_set_timeout_micros=Module._ts_parser_set_timeout_micros=Module.asm.ts_parser_set_timeout_micros).apply(null,arguments)},_memmove=Module._memmove=function(){return(_memmove=Module._memmove=Module.asm.memmove).apply(null,arguments)},_memcmp=Module._memcmp=function(){return(_memcmp=Module._memcmp=Module.asm.memcmp).apply(null,arguments)},_ts_query_new=Module._ts_query_new=function(){return(_ts_query_new=Module._ts_query_new=Module.asm.ts_query_new).apply(null,arguments)},_ts_query_delete=Module._ts_query_delete=function(){return(_ts_query_delete=Module._ts_query_delete=Module.asm.ts_query_delete).apply(null,arguments)},_iswspace=Module._iswspace=function(){return(_iswspace=Module._iswspace=Module.asm.iswspace).apply(null,arguments)},_iswalnum=Module._iswalnum=function(){return(_iswalnum=Module._iswalnum=Module.asm.iswalnum).apply(null,arguments)},_ts_query_pattern_count=Module._ts_query_pattern_count=function(){return(_ts_query_pattern_count=Module._ts_query_pattern_count=Module.asm.ts_query_pattern_count).apply(null,arguments)},_ts_query_capture_count=Module._ts_query_capture_count=function(){return(_ts_query_capture_count=Module._ts_query_capture_count=Module.asm.ts_query_capture_count).apply(null,arguments)},_ts_query_string_count=Module._ts_query_string_count=function(){return(_ts_query_string_count=Module._ts_query_string_count=Module.asm.ts_query_string_count).apply(null,arguments)},_ts_query_capture_name_for_id=Module._ts_query_capture_name_for_id=function(){return(_ts_query_capture_name_for_id=Module._ts_query_capture_name_for_id=Module.asm.ts_query_capture_name_for_id).apply(null,arguments)},_ts_query_string_value_for_id=Module._ts_query_string_value_for_id=function(){return(_ts_query_string_value_for_id=Module._ts_query_string_value_for_id=Module.asm.ts_query_string_value_for_id).apply(null,arguments)},_ts_query_predicates_for_pattern=Module._ts_query_predicates_for_pattern=function(){return(_ts_query_predicates_for_pattern=Module._ts_query_predicates_for_pattern=Module.asm.ts_query_predicates_for_pattern).apply(null,arguments)},_ts_tree_copy=Module._ts_tree_copy=function(){return(_ts_tree_copy=Module._ts_tree_copy=Module.asm.ts_tree_copy).apply(null,arguments)},_ts_tree_delete=Module._ts_tree_delete=function(){return(_ts_tree_delete=Module._ts_tree_delete=Module.asm.ts_tree_delete).apply(null,arguments)},_ts_init=Module._ts_init=function(){return(_ts_init=Module._ts_init=Module.asm.ts_init).apply(null,arguments)},_ts_parser_new_wasm=Module._ts_parser_new_wasm=function(){return(_ts_parser_new_wasm=Module._ts_parser_new_wasm=Module.asm.ts_parser_new_wasm).apply(null,arguments)},_ts_parser_enable_logger_wasm=Module._ts_parser_enable_logger_wasm=function(){return(_ts_parser_enable_logger_wasm=Module._ts_parser_enable_logger_wasm=Module.asm.ts_parser_enable_logger_wasm).apply(null,arguments)},_ts_parser_parse_wasm=Module._ts_parser_parse_wasm=function(){return(_ts_parser_parse_wasm=Module._ts_parser_parse_wasm=Module.asm.ts_parser_parse_wasm).apply(null,arguments)},_ts_language_type_is_named_wasm=Module._ts_language_type_is_named_wasm=function(){return(_ts_language_type_is_named_wasm=Module._ts_language_type_is_named_wasm=Module.asm.ts_language_type_is_named_wasm).apply(null,arguments)},_ts_language_type_is_visible_wasm=Module._ts_language_type_is_visible_wasm=function(){return(_ts_language_type_is_visible_wasm=Module._ts_language_type_is_visible_wasm=Module.asm.ts_language_type_is_visible_wasm).apply(null,arguments)},_ts_tree_root_node_wasm=Module._ts_tree_root_node_wasm=function(){return(_ts_tree_root_node_wasm=Module._ts_tree_root_node_wasm=Module.asm.ts_tree_root_node_wasm).apply(null,arguments)},_ts_tree_edit_wasm=Module._ts_tree_edit_wasm=function(){return(_ts_tree_edit_wasm=Module._ts_tree_edit_wasm=Module.asm.ts_tree_edit_wasm).apply(null,arguments)},_ts_tree_get_changed_ranges_wasm=Module._ts_tree_get_changed_ranges_wasm=function(){return(_ts_tree_get_changed_ranges_wasm=Module._ts_tree_get_changed_ranges_wasm=Module.asm.ts_tree_get_changed_ranges_wasm).apply(null,arguments)},_ts_tree_cursor_new_wasm=Module._ts_tree_cursor_new_wasm=function(){return(_ts_tree_cursor_new_wasm=Module._ts_tree_cursor_new_wasm=Module.asm.ts_tree_cursor_new_wasm).apply(null,arguments)},_ts_tree_cursor_delete_wasm=Module._ts_tree_cursor_delete_wasm=function(){return(_ts_tree_cursor_delete_wasm=Module._ts_tree_cursor_delete_wasm=Module.asm.ts_tree_cursor_delete_wasm).apply(null,arguments)},_ts_tree_cursor_reset_wasm=Module._ts_tree_cursor_reset_wasm=function(){return(_ts_tree_cursor_reset_wasm=Module._ts_tree_cursor_reset_wasm=Module.asm.ts_tree_cursor_reset_wasm).apply(null,arguments)},_ts_tree_cursor_goto_first_child_wasm=Module._ts_tree_cursor_goto_first_child_wasm=function(){return(_ts_tree_cursor_goto_first_child_wasm=Module._ts_tree_cursor_goto_first_child_wasm=Module.asm.ts_tree_cursor_goto_first_child_wasm).apply(null,arguments)},_ts_tree_cursor_goto_next_sibling_wasm=Module._ts_tree_cursor_goto_next_sibling_wasm=function(){return(_ts_tree_cursor_goto_next_sibling_wasm=Module._ts_tree_cursor_goto_next_sibling_wasm=Module.asm.ts_tree_cursor_goto_next_sibling_wasm).apply(null,arguments)},_ts_tree_cursor_goto_parent_wasm=Module._ts_tree_cursor_goto_parent_wasm=function(){return(_ts_tree_cursor_goto_parent_wasm=Module._ts_tree_cursor_goto_parent_wasm=Module.asm.ts_tree_cursor_goto_parent_wasm).apply(null,arguments)},_ts_tree_cursor_current_node_type_id_wasm=Module._ts_tree_cursor_current_node_type_id_wasm=function(){return(_ts_tree_cursor_current_node_type_id_wasm=Module._ts_tree_cursor_current_node_type_id_wasm=Module.asm.ts_tree_cursor_current_node_type_id_wasm).apply(null,arguments)},_ts_tree_cursor_current_node_is_named_wasm=Module._ts_tree_cursor_current_node_is_named_wasm=function(){return(_ts_tree_cursor_current_node_is_named_wasm=Module._ts_tree_cursor_current_node_is_named_wasm=Module.asm.ts_tree_cursor_current_node_is_named_wasm).apply(null,arguments)},_ts_tree_cursor_current_node_is_missing_wasm=Module._ts_tree_cursor_current_node_is_missing_wasm=function(){return(_ts_tree_cursor_current_node_is_missing_wasm=Module._ts_tree_cursor_current_node_is_missing_wasm=Module.asm.ts_tree_cursor_current_node_is_missing_wasm).apply(null,arguments)},_ts_tree_cursor_current_node_id_wasm=Module._ts_tree_cursor_current_node_id_wasm=function(){return(_ts_tree_cursor_current_node_id_wasm=Module._ts_tree_cursor_current_node_id_wasm=Module.asm.ts_tree_cursor_current_node_id_wasm).apply(null,arguments)},_ts_tree_cursor_start_position_wasm=Module._ts_tree_cursor_start_position_wasm=function(){return(_ts_tree_cursor_start_position_wasm=Module._ts_tree_cursor_start_position_wasm=Module.asm.ts_tree_cursor_start_position_wasm).apply(null,arguments)},_ts_tree_cursor_end_position_wasm=Module._ts_tree_cursor_end_position_wasm=function(){return(_ts_tree_cursor_end_position_wasm=Module._ts_tree_cursor_end_position_wasm=Module.asm.ts_tree_cursor_end_position_wasm).apply(null,arguments)},_ts_tree_cursor_start_index_wasm=Module._ts_tree_cursor_start_index_wasm=function(){return(_ts_tree_cursor_start_index_wasm=Module._ts_tree_cursor_start_index_wasm=Module.asm.ts_tree_cursor_start_index_wasm).apply(null,arguments)},_ts_tree_cursor_end_index_wasm=Module._ts_tree_cursor_end_index_wasm=function(){return(_ts_tree_cursor_end_index_wasm=Module._ts_tree_cursor_end_index_wasm=Module.asm.ts_tree_cursor_end_index_wasm).apply(null,arguments)},_ts_tree_cursor_current_field_id_wasm=Module._ts_tree_cursor_current_field_id_wasm=function(){return(_ts_tree_cursor_current_field_id_wasm=Module._ts_tree_cursor_current_field_id_wasm=Module.asm.ts_tree_cursor_current_field_id_wasm).apply(null,arguments)},_ts_tree_cursor_current_node_wasm=Module._ts_tree_cursor_current_node_wasm=function(){return(_ts_tree_cursor_current_node_wasm=Module._ts_tree_cursor_current_node_wasm=Module.asm.ts_tree_cursor_current_node_wasm).apply(null,arguments)},_ts_node_symbol_wasm=Module._ts_node_symbol_wasm=function(){return(_ts_node_symbol_wasm=Module._ts_node_symbol_wasm=Module.asm.ts_node_symbol_wasm).apply(null,arguments)},_ts_node_child_count_wasm=Module._ts_node_child_count_wasm=function(){return(_ts_node_child_count_wasm=Module._ts_node_child_count_wasm=Module.asm.ts_node_child_count_wasm).apply(null,arguments)},_ts_node_named_child_count_wasm=Module._ts_node_named_child_count_wasm=function(){return(_ts_node_named_child_count_wasm=Module._ts_node_named_child_count_wasm=Module.asm.ts_node_named_child_count_wasm).apply(null,arguments)},_ts_node_child_wasm=Module._ts_node_child_wasm=function(){return(_ts_node_child_wasm=Module._ts_node_child_wasm=Module.asm.ts_node_child_wasm).apply(null,arguments)},_ts_node_named_child_wasm=Module._ts_node_named_child_wasm=function(){return(_ts_node_named_child_wasm=Module._ts_node_named_child_wasm=Module.asm.ts_node_named_child_wasm).apply(null,arguments)},_ts_node_child_by_field_id_wasm=Module._ts_node_child_by_field_id_wasm=function(){return(_ts_node_child_by_field_id_wasm=Module._ts_node_child_by_field_id_wasm=Module.asm.ts_node_child_by_field_id_wasm).apply(null,arguments)},_ts_node_next_sibling_wasm=Module._ts_node_next_sibling_wasm=function(){return(_ts_node_next_sibling_wasm=Module._ts_node_next_sibling_wasm=Module.asm.ts_node_next_sibling_wasm).apply(null,arguments)},_ts_node_prev_sibling_wasm=Module._ts_node_prev_sibling_wasm=function(){return(_ts_node_prev_sibling_wasm=Module._ts_node_prev_sibling_wasm=Module.asm.ts_node_prev_sibling_wasm).apply(null,arguments)},_ts_node_next_named_sibling_wasm=Module._ts_node_next_named_sibling_wasm=function(){return(_ts_node_next_named_sibling_wasm=Module._ts_node_next_named_sibling_wasm=Module.asm.ts_node_next_named_sibling_wasm).apply(null,arguments)},_ts_node_prev_named_sibling_wasm=Module._ts_node_prev_named_sibling_wasm=function(){return(_ts_node_prev_named_sibling_wasm=Module._ts_node_prev_named_sibling_wasm=Module.asm.ts_node_prev_named_sibling_wasm).apply(null,arguments)},_ts_node_parent_wasm=Module._ts_node_parent_wasm=function(){return(_ts_node_parent_wasm=Module._ts_node_parent_wasm=Module.asm.ts_node_parent_wasm).apply(null,arguments)},_ts_node_descendant_for_index_wasm=Module._ts_node_descendant_for_index_wasm=function(){return(_ts_node_descendant_for_index_wasm=Module._ts_node_descendant_for_index_wasm=Module.asm.ts_node_descendant_for_index_wasm).apply(null,arguments)},_ts_node_named_descendant_for_index_wasm=Module._ts_node_named_descendant_for_index_wasm=function(){return(_ts_node_named_descendant_for_index_wasm=Module._ts_node_named_descendant_for_index_wasm=Module.asm.ts_node_named_descendant_for_index_wasm).apply(null,arguments)},_ts_node_descendant_for_position_wasm=Module._ts_node_descendant_for_position_wasm=function(){return(_ts_node_descendant_for_position_wasm=Module._ts_node_descendant_for_position_wasm=Module.asm.ts_node_descendant_for_position_wasm).apply(null,arguments)},_ts_node_named_descendant_for_position_wasm=Module._ts_node_named_descendant_for_position_wasm=function(){return(_ts_node_named_descendant_for_position_wasm=Module._ts_node_named_descendant_for_position_wasm=Module.asm.ts_node_named_descendant_for_position_wasm).apply(null,arguments)},_ts_node_start_point_wasm=Module._ts_node_start_point_wasm=function(){return(_ts_node_start_point_wasm=Module._ts_node_start_point_wasm=Module.asm.ts_node_start_point_wasm).apply(null,arguments)},_ts_node_end_point_wasm=Module._ts_node_end_point_wasm=function(){return(_ts_node_end_point_wasm=Module._ts_node_end_point_wasm=Module.asm.ts_node_end_point_wasm).apply(null,arguments)},_ts_node_start_index_wasm=Module._ts_node_start_index_wasm=function(){return(_ts_node_start_index_wasm=Module._ts_node_start_index_wasm=Module.asm.ts_node_start_index_wasm).apply(null,arguments)},_ts_node_end_index_wasm=Module._ts_node_end_index_wasm=function(){return(_ts_node_end_index_wasm=Module._ts_node_end_index_wasm=Module.asm.ts_node_end_index_wasm).apply(null,arguments)},_ts_node_to_string_wasm=Module._ts_node_to_string_wasm=function(){return(_ts_node_to_string_wasm=Module._ts_node_to_string_wasm=Module.asm.ts_node_to_string_wasm).apply(null,arguments)},_ts_node_children_wasm=Module._ts_node_children_wasm=function(){return(_ts_node_children_wasm=Module._ts_node_children_wasm=Module.asm.ts_node_children_wasm).apply(null,arguments)},_ts_node_named_children_wasm=Module._ts_node_named_children_wasm=function(){return(_ts_node_named_children_wasm=Module._ts_node_named_children_wasm=Module.asm.ts_node_named_children_wasm).apply(null,arguments)},_ts_node_descendants_of_type_wasm=Module._ts_node_descendants_of_type_wasm=function(){return(_ts_node_descendants_of_type_wasm=Module._ts_node_descendants_of_type_wasm=Module.asm.ts_node_descendants_of_type_wasm).apply(null,arguments)},_ts_node_is_named_wasm=Module._ts_node_is_named_wasm=function(){return(_ts_node_is_named_wasm=Module._ts_node_is_named_wasm=Module.asm.ts_node_is_named_wasm).apply(null,arguments)},_ts_node_has_changes_wasm=Module._ts_node_has_changes_wasm=function(){return(_ts_node_has_changes_wasm=Module._ts_node_has_changes_wasm=Module.asm.ts_node_has_changes_wasm).apply(null,arguments)},_ts_node_has_error_wasm=Module._ts_node_has_error_wasm=function(){return(_ts_node_has_error_wasm=Module._ts_node_has_error_wasm=Module.asm.ts_node_has_error_wasm).apply(null,arguments)},_ts_node_is_missing_wasm=Module._ts_node_is_missing_wasm=function(){return(_ts_node_is_missing_wasm=Module._ts_node_is_missing_wasm=Module.asm.ts_node_is_missing_wasm).apply(null,arguments)},_ts_query_matches_wasm=Module._ts_query_matches_wasm=function(){return(_ts_query_matches_wasm=Module._ts_query_matches_wasm=Module.asm.ts_query_matches_wasm).apply(null,arguments)},_ts_query_captures_wasm=Module._ts_query_captures_wasm=function(){return(_ts_query_captures_wasm=Module._ts_query_captures_wasm=Module.asm.ts_query_captures_wasm).apply(null,arguments)},___cxa_atexit=Module.___cxa_atexit=function(){return(___cxa_atexit=Module.___cxa_atexit=Module.asm.__cxa_atexit).apply(null,arguments)},_iswdigit=Module._iswdigit=function(){return(_iswdigit=Module._iswdigit=Module.asm.iswdigit).apply(null,arguments)},_iswalpha=Module._iswalpha=function(){return(_iswalpha=Module._iswalpha=Module.asm.iswalpha).apply(null,arguments)},_iswlower=Module._iswlower=function(){return(_iswlower=Module._iswlower=Module.asm.iswlower).apply(null,arguments)},_memchr=Module._memchr=function(){return(_memchr=Module._memchr=Module.asm.memchr).apply(null,arguments)},_strlen=Module._strlen=function(){return(_strlen=Module._strlen=Module.asm.strlen).apply(null,arguments)},_towupper=Module._towupper=function(){return(_towupper=Module._towupper=Module.asm.towupper).apply(null,arguments)},_setThrew=Module._setThrew=function(){return(_setThrew=Module._setThrew=Module.asm.setThrew).apply(null,arguments)},stackSave=Module.stackSave=function(){return(stackSave=Module.stackSave=Module.asm.stackSave).apply(null,arguments)},stackRestore=Module.stackRestore=function(){return(stackRestore=Module.stackRestore=Module.asm.stackRestore).apply(null,arguments)},stackAlloc=Module.stackAlloc=function(){return(stackAlloc=Module.stackAlloc=Module.asm.stackAlloc).apply(null,arguments)},__Znwm=Module.__Znwm=function(){return(__Znwm=Module.__Znwm=Module.asm._Znwm).apply(null,arguments)},__ZdlPv=Module.__ZdlPv=function(){return(__ZdlPv=Module.__ZdlPv=Module.asm._ZdlPv).apply(null,arguments)},__ZNSt3__212basic_stringIcNS_11char_traitsIcEENS_9allocatorIcEEED2Ev=Module.__ZNSt3__212basic_stringIcNS_11char_traitsIcEENS_9allocatorIcEEED2Ev=function(){return(__ZNSt3__212basic_stringIcNS_11char_traitsIcEENS_9allocatorIcEEED2Ev=Module.__ZNSt3__212basic_stringIcNS_11char_traitsIcEENS_9allocatorIcEEED2Ev=Module.asm._ZNSt3__212basic_stringIcNS_11char_traitsIcEENS_9allocatorIcEEED2Ev).apply(null,arguments)},__ZNSt3__212basic_stringIcNS_11char_traitsIcEENS_9allocatorIcEEE9__grow_byEmmmmmm=Module.__ZNSt3__212basic_stringIcNS_11char_traitsIcEENS_9allocatorIcEEE9__grow_byEmmmmmm=function(){return(__ZNSt3__212basic_stringIcNS_11char_traitsIcEENS_9allocatorIcEEE9__grow_byEmmmmmm=Module.__ZNSt3__212basic_stringIcNS_11char_traitsIcEENS_9allocatorIcEEE9__grow_byEmmmmmm=Module.asm._ZNSt3__212basic_stringIcNS_11char_traitsIcEENS_9allocatorIcEEE9__grow_byEmmmmmm).apply(null,arguments)},__ZNSt3__212basic_stringIcNS_11char_traitsIcEENS_9allocatorIcEEE6__initEPKcm=Module.__ZNSt3__212basic_stringIcNS_11char_traitsIcEENS_9allocatorIcEEE6__initEPKcm=function(){return(__ZNSt3__212basic_stringIcNS_11char_traitsIcEENS_9allocatorIcEEE6__initEPKcm=Module.__ZNSt3__212basic_stringIcNS_11char_traitsIcEENS_9allocatorIcEEE6__initEPKcm=Module.asm._ZNSt3__212basic_stringIcNS_11char_traitsIcEENS_9allocatorIcEEE6__initEPKcm).apply(null,arguments)},__ZNSt3__212basic_stringIcNS_11char_traitsIcEENS_9allocatorIcEEE7reserveEm=Module.__ZNSt3__212basic_stringIcNS_11char_traitsIcEENS_9allocatorIcEEE7reserveEm=function(){return(__ZNSt3__212basic_stringIcNS_11char_traitsIcEENS_9allocatorIcEEE7reserveEm=Module.__ZNSt3__212basic_stringIcNS_11char_traitsIcEENS_9allocatorIcEEE7reserveEm=Module.asm._ZNSt3__212basic_stringIcNS_11char_traitsIcEENS_9allocatorIcEEE7reserveEm).apply(null,arguments)},__ZNKSt3__212basic_stringIcNS_11char_traitsIcEENS_9allocatorIcEEE4copyEPcmm=Module.__ZNKSt3__212basic_stringIcNS_11char_traitsIcEENS_9allocatorIcEEE4copyEPcmm=function(){return(__ZNKSt3__212basic_stringIcNS_11char_traitsIcEENS_9allocatorIcEEE4copyEPcmm=Module.__ZNKSt3__212basic_stringIcNS_11char_traitsIcEENS_9allocatorIcEEE4copyEPcmm=Module.asm._ZNKSt3__212basic_stringIcNS_11char_traitsIcEENS_9allocatorIcEEE4copyEPcmm).apply(null,arguments)},__ZNSt3__212basic_stringIcNS_11char_traitsIcEENS_9allocatorIcEEE9push_backEc=Module.__ZNSt3__212basic_stringIcNS_11char_traitsIcEENS_9allocatorIcEEE9push_backEc=function(){return(__ZNSt3__212basic_stringIcNS_11char_traitsIcEENS_9allocatorIcEEE9push_backEc=Module.__ZNSt3__212basic_stringIcNS_11char_traitsIcEENS_9allocatorIcEEE9push_backEc=Module.asm._ZNSt3__212basic_stringIcNS_11char_traitsIcEENS_9allocatorIcEEE9push_backEc).apply(null,arguments)},__ZNSt3__212basic_stringIwNS_11char_traitsIwEENS_9allocatorIwEEED2Ev=Module.__ZNSt3__212basic_stringIwNS_11char_traitsIwEENS_9allocatorIwEEED2Ev=function(){return(__ZNSt3__212basic_stringIwNS_11char_traitsIwEENS_9allocatorIwEEED2Ev=Module.__ZNSt3__212basic_stringIwNS_11char_traitsIwEENS_9allocatorIwEEED2Ev=Module.asm._ZNSt3__212basic_stringIwNS_11char_traitsIwEENS_9allocatorIwEEED2Ev).apply(null,arguments)},__ZNSt3__212basic_stringIwNS_11char_traitsIwEENS_9allocatorIwEEE9push_backEw=Module.__ZNSt3__212basic_stringIwNS_11char_traitsIwEENS_9allocatorIwEEE9push_backEw=function(){return(__ZNSt3__212basic_stringIwNS_11char_traitsIwEENS_9allocatorIwEEE9push_backEw=Module.__ZNSt3__212basic_stringIwNS_11char_traitsIwEENS_9allocatorIwEEE9push_backEw=Module.asm._ZNSt3__212basic_stringIwNS_11char_traitsIwEENS_9allocatorIwEEE9push_backEw).apply(null,arguments)},__ZNSt3__212basic_stringIwNS_11char_traitsIwEENS_9allocatorIwEEE6resizeEmw=Module.__ZNSt3__212basic_stringIwNS_11char_traitsIwEENS_9allocatorIwEEE6resizeEmw=function(){return(__ZNSt3__212basic_stringIwNS_11char_traitsIwEENS_9allocatorIwEEE6resizeEmw=Module.__ZNSt3__212basic_stringIwNS_11char_traitsIwEENS_9allocatorIwEEE6resizeEmw=Module.asm._ZNSt3__212basic_stringIwNS_11char_traitsIwEENS_9allocatorIwEEE6resizeEmw).apply(null,arguments)},dynCall_jiji=Module.dynCall_jiji=function(){return(dynCall_jiji=Module.dynCall_jiji=Module.asm.dynCall_jiji).apply(null,arguments)},_orig$ts_parser_timeout_micros=Module._orig$ts_parser_timeout_micros=function(){return(_orig$ts_parser_timeout_micros=Module._orig$ts_parser_timeout_micros=Module.asm.orig$ts_parser_timeout_micros).apply(null,arguments)},_orig$ts_parser_set_timeout_micros=Module._orig$ts_parser_set_timeout_micros=function(){return(_orig$ts_parser_set_timeout_micros=Module._orig$ts_parser_set_timeout_micros=Module.asm.orig$ts_parser_set_timeout_micros).apply(null,arguments)},calledRun;function callMain(t){var e=Module._main;if(e){(t=t||[]).unshift(thisProgram);var r=t.length,n=stackAlloc(4*(r+1)),i=n>>2;t.forEach(a=>{HEAP32[i++]=allocateUTF8OnStack(a)}),HEAP32[i]=0;try{var o=e(r,n);return exitJS(o,!0),o}catch(a){return handleException(a)}}}s(callMain,"callMain"),Module.AsciiToString=AsciiToString,Module.stringToUTF16=stringToUTF16,dependenciesFulfilled=s(function t(){calledRun||run(),calledRun||(dependenciesFulfilled=t)},"e");var dylibsLoaded=!1;function run(t){function e(){calledRun||(calledRun=!0,Module.calledRun=!0,ABORT||(initRuntime(),preMain(),Module.onRuntimeInitialized&&Module.onRuntimeInitialized(),shouldRunNow&&callMain(t),postRun()))}s(e,"t"),t=t||arguments_,runDependencies>0||!dylibsLoaded&&(preloadDylibs(),dylibsLoaded=!0,runDependencies>0)||(preRun(),runDependencies>0||(Module.setStatus?(Module.setStatus("Running..."),setTimeout(function(){setTimeout(function(){Module.setStatus("")},1),e()},1)):e()))}if(s(run,"run"),Module.preInit)for(typeof Module.preInit=="function"&&(Module.preInit=[Module.preInit]);Module.preInit.length>0;)Module.preInit.pop()();var shouldRunNow=!0;Module.noInitialRun&&(shouldRunNow=!1),run();let C=Module,INTERNAL={},SIZE_OF_INT=4,SIZE_OF_NODE=5*SIZE_OF_INT,SIZE_OF_POINT=2*SIZE_OF_INT,SIZE_OF_RANGE=2*SIZE_OF_INT+2*SIZE_OF_POINT,ZERO_POINT={row:0,column:0},QUERY_WORD_REGEX=/[\w-.]*/g,PREDICATE_STEP_TYPE_CAPTURE=1,PREDICATE_STEP_TYPE_STRING=2,LANGUAGE_FUNCTION_REGEX=/^_?tree_sitter_\w+/;var VERSION,MIN_COMPATIBLE_VERSION,TRANSFER_BUFFER,currentParseCallback,currentLogCallback;class ParserImpl{static{s(this,"ParserImpl")}static init(){TRANSFER_BUFFER=C._ts_init(),VERSION=getValue(TRANSFER_BUFFER,"i32"),MIN_COMPATIBLE_VERSION=getValue(TRANSFER_BUFFER+SIZE_OF_INT,"i32")}initialize(){C._ts_parser_new_wasm(),this[0]=getValue(TRANSFER_BUFFER,"i32"),this[1]=getValue(TRANSFER_BUFFER+SIZE_OF_INT,"i32")}delete(){C._ts_parser_delete(this[0]),C._free(this[1]),this[0]=0,this[1]=0}setLanguage(e){let r;if(e){if(e.constructor!==Language)throw new Error("Argument must be a Language");{r=e[0];let n=C._ts_language_version(r);if(n<MIN_COMPATIBLE_VERSION||VERSION<n)throw new Error(`Incompatible language version ${n}. Compatibility range ${MIN_COMPATIBLE_VERSION} through ${VERSION}.`)}}else r=0,e=null;return this.language=e,C._ts_parser_set_language(this[0],r),this}getLanguage(){return this.language}parse(e,r,n){if(typeof e=="string")currentParseCallback=s((l,u,f)=>e.slice(l,f),"currentParseCallback");else{if(typeof e!="function")throw new Error("Argument must be a string or a function");currentParseCallback=e}this.logCallback?(currentLogCallback=this.logCallback,C._ts_parser_enable_logger_wasm(this[0],1)):(currentLogCallback=null,C._ts_parser_enable_logger_wasm(this[0],0));let i=0,o=0;if(n&&n.includedRanges){i=n.includedRanges.length,o=C._calloc(i,SIZE_OF_RANGE);let l=o;for(let u=0;u<i;u++)marshalRange(l,n.includedRanges[u]),l+=SIZE_OF_RANGE}let a=C._ts_parser_parse_wasm(this[0],this[1],r?r[0]:0,o,i);if(!a)throw currentParseCallback=null,currentLogCallback=null,new Error("Parsing failed");let c=new Tree(INTERNAL,a,this.language,currentParseCallback);return currentParseCallback=null,currentLogCallback=null,c}reset(){C._ts_parser_reset(this[0])}setTimeoutMicros(e){C._ts_parser_set_timeout_micros(this[0],e)}getTimeoutMicros(){return C._ts_parser_timeout_micros(this[0])}setLogger(e){if(e){if(typeof e!="function")throw new Error("Logger callback must be a function")}else e=null;return this.logCallback=e,this}getLogger(){return this.logCallback}}class Tree{static{s(this,"Tree")}constructor(e,r,n,i){assertInternal(e),this[0]=r,this.language=n,this.textCallback=i}copy(){let e=C._ts_tree_copy(this[0]);return new Tree(INTERNAL,e,this.language,this.textCallback)}delete(){C._ts_tree_delete(this[0]),this[0]=0}edit(e){marshalEdit(e),C._ts_tree_edit_wasm(this[0])}get rootNode(){return C._ts_tree_root_node_wasm(this[0]),unmarshalNode(this)}getLanguage(){return this.language}walk(){return this.rootNode.walk()}getChangedRanges(e){if(e.constructor!==Tree)throw new TypeError("Argument must be a Tree");C._ts_tree_get_changed_ranges_wasm(this[0],e[0]);let r=getValue(TRANSFER_BUFFER,"i32"),n=getValue(TRANSFER_BUFFER+SIZE_OF_INT,"i32"),i=new Array(r);if(r>0){let o=n;for(let a=0;a<r;a++)i[a]=unmarshalRange(o),o+=SIZE_OF_RANGE;C._free(n)}return i}}class Node{static{s(this,"Node")}constructor(e,r){assertInternal(e),this.tree=r}get typeId(){return marshalNode(this),C._ts_node_symbol_wasm(this.tree[0])}get type(){return this.tree.language.types[this.typeId]||"ERROR"}get endPosition(){return marshalNode(this),C._ts_node_end_point_wasm(this.tree[0]),unmarshalPoint(TRANSFER_BUFFER)}get endIndex(){return marshalNode(this),C._ts_node_end_index_wasm(this.tree[0])}get text(){return getText(this.tree,this.startIndex,this.endIndex)}isNamed(){return marshalNode(this),C._ts_node_is_named_wasm(this.tree[0])===1}hasError(){return marshalNode(this),C._ts_node_has_error_wasm(this.tree[0])===1}hasChanges(){return marshalNode(this),C._ts_node_has_changes_wasm(this.tree[0])===1}isMissing(){return marshalNode(this),C._ts_node_is_missing_wasm(this.tree[0])===1}equals(e){return this.id===e.id}child(e){return marshalNode(this),C._ts_node_child_wasm(this.tree[0],e),unmarshalNode(this.tree)}namedChild(e){return marshalNode(this),C._ts_node_named_child_wasm(this.tree[0],e),unmarshalNode(this.tree)}childForFieldId(e){return marshalNode(this),C._ts_node_child_by_field_id_wasm(this.tree[0],e),unmarshalNode(this.tree)}childForFieldName(e){let r=this.tree.language.fields.indexOf(e);if(r!==-1)return this.childForFieldId(r)}get childCount(){return marshalNode(this),C._ts_node_child_count_wasm(this.tree[0])}get namedChildCount(){return marshalNode(this),C._ts_node_named_child_count_wasm(this.tree[0])}get firstChild(){return this.child(0)}get firstNamedChild(){return this.namedChild(0)}get lastChild(){return this.child(this.childCount-1)}get lastNamedChild(){return this.namedChild(this.namedChildCount-1)}get children(){if(!this._children){marshalNode(this),C._ts_node_children_wasm(this.tree[0]);let e=getValue(TRANSFER_BUFFER,"i32"),r=getValue(TRANSFER_BUFFER+SIZE_OF_INT,"i32");if(this._children=new Array(e),e>0){let n=r;for(let i=0;i<e;i++)this._children[i]=unmarshalNode(this.tree,n),n+=SIZE_OF_NODE;C._free(r)}}return this._children}get namedChildren(){if(!this._namedChildren){marshalNode(this),C._ts_node_named_children_wasm(this.tree[0]);let e=getValue(TRANSFER_BUFFER,"i32"),r=getValue(TRANSFER_BUFFER+SIZE_OF_INT,"i32");if(this._namedChildren=new Array(e),e>0){let n=r;for(let i=0;i<e;i++)this._namedChildren[i]=unmarshalNode(this.tree,n),n+=SIZE_OF_NODE;C._free(r)}}return this._namedChildren}descendantsOfType(e,r,n){Array.isArray(e)||(e=[e]),r||(r=ZERO_POINT),n||(n=ZERO_POINT);let i=[],o=this.tree.language.types;for(let f=0,p=o.length;f<p;f++)e.includes(o[f])&&i.push(f);let a=C._malloc(SIZE_OF_INT*i.length);for(let f=0,p=i.length;f<p;f++)setValue(a+f*SIZE_OF_INT,i[f],"i32");marshalNode(this),C._ts_node_descendants_of_type_wasm(this.tree[0],a,i.length,r.row,r.column,n.row,n.column);let c=getValue(TRANSFER_BUFFER,"i32"),l=getValue(TRANSFER_BUFFER+SIZE_OF_INT,"i32"),u=new Array(c);if(c>0){let f=l;for(let p=0;p<c;p++)u[p]=unmarshalNode(this.tree,f),f+=SIZE_OF_NODE}return C._free(l),C._free(a),u}get nextSibling(){return marshalNode(this),C._ts_node_next_sibling_wasm(this.tree[0]),unmarshalNode(this.tree)}get previousSibling(){return marshalNode(this),C._ts_node_prev_sibling_wasm(this.tree[0]),unmarshalNode(this.tree)}get nextNamedSibling(){return marshalNode(this),C._ts_node_next_named_sibling_wasm(this.tree[0]),unmarshalNode(this.tree)}get previousNamedSibling(){return marshalNode(this),C._ts_node_prev_named_sibling_wasm(this.tree[0]),unmarshalNode(this.tree)}get parent(){return marshalNode(this),C._ts_node_parent_wasm(this.tree[0]),unmarshalNode(this.tree)}descendantForIndex(e,r=e){if(typeof e!="number"||typeof r!="number")throw new Error("Arguments must be numbers");marshalNode(this);let n=TRANSFER_BUFFER+SIZE_OF_NODE;return setValue(n,e,"i32"),setValue(n+SIZE_OF_INT,r,"i32"),C._ts_node_descendant_for_index_wasm(this.tree[0]),unmarshalNode(this.tree)}namedDescendantForIndex(e,r=e){if(typeof e!="number"||typeof r!="number")throw new Error("Arguments must be numbers");marshalNode(this);let n=TRANSFER_BUFFER+SIZE_OF_NODE;return setValue(n,e,"i32"),setValue(n+SIZE_OF_INT,r,"i32"),C._ts_node_named_descendant_for_index_wasm(this.tree[0]),unmarshalNode(this.tree)}descendantForPosition(e,r=e){if(!isPoint(e)||!isPoint(r))throw new Error("Arguments must be {row, column} objects");marshalNode(this);let n=TRANSFER_BUFFER+SIZE_OF_NODE;return marshalPoint(n,e),marshalPoint(n+SIZE_OF_POINT,r),C._ts_node_descendant_for_position_wasm(this.tree[0]),unmarshalNode(this.tree)}namedDescendantForPosition(e,r=e){if(!isPoint(e)||!isPoint(r))throw new Error("Arguments must be {row, column} objects");marshalNode(this);let n=TRANSFER_BUFFER+SIZE_OF_NODE;return marshalPoint(n,e),marshalPoint(n+SIZE_OF_POINT,r),C._ts_node_named_descendant_for_position_wasm(this.tree[0]),unmarshalNode(this.tree)}walk(){return marshalNode(this),C._ts_tree_cursor_new_wasm(this.tree[0]),new TreeCursor(INTERNAL,this.tree)}toString(){marshalNode(this);let e=C._ts_node_to_string_wasm(this.tree[0]),r=AsciiToString(e);return C._free(e),r}}class TreeCursor{static{s(this,"TreeCursor")}constructor(e,r){assertInternal(e),this.tree=r,unmarshalTreeCursor(this)}delete(){marshalTreeCursor(this),C._ts_tree_cursor_delete_wasm(this.tree[0]),this[0]=this[1]=this[2]=0}reset(e){marshalNode(e),marshalTreeCursor(this,TRANSFER_BUFFER+SIZE_OF_NODE),C._ts_tree_cursor_reset_wasm(this.tree[0]),unmarshalTreeCursor(this)}get nodeType(){return this.tree.language.types[this.nodeTypeId]||"ERROR"}get nodeTypeId(){return marshalTreeCursor(this),C._ts_tree_cursor_current_node_type_id_wasm(this.tree[0])}get nodeId(){return marshalTreeCursor(this),C._ts_tree_cursor_current_node_id_wasm(this.tree[0])}get nodeIsNamed(){return marshalTreeCursor(this),C._ts_tree_cursor_current_node_is_named_wasm(this.tree[0])===1}get nodeIsMissing(){return marshalTreeCursor(this),C._ts_tree_cursor_current_node_is_missing_wasm(this.tree[0])===1}get nodeText(){marshalTreeCursor(this);let e=C._ts_tree_cursor_start_index_wasm(this.tree[0]),r=C._ts_tree_cursor_end_index_wasm(this.tree[0]);return getText(this.tree,e,r)}get startPosition(){return marshalTreeCursor(this),C._ts_tree_cursor_start_position_wasm(this.tree[0]),unmarshalPoint(TRANSFER_BUFFER)}get endPosition(){return marshalTreeCursor(this),C._ts_tree_cursor_end_position_wasm(this.tree[0]),unmarshalPoint(TRANSFER_BUFFER)}get startIndex(){return marshalTreeCursor(this),C._ts_tree_cursor_start_index_wasm(this.tree[0])}get endIndex(){return marshalTreeCursor(this),C._ts_tree_cursor_end_index_wasm(this.tree[0])}currentNode(){return marshalTreeCursor(this),C._ts_tree_cursor_current_node_wasm(this.tree[0]),unmarshalNode(this.tree)}currentFieldId(){return marshalTreeCursor(this),C._ts_tree_cursor_current_field_id_wasm(this.tree[0])}currentFieldName(){return this.tree.language.fields[this.currentFieldId()]}gotoFirstChild(){marshalTreeCursor(this);let e=C._ts_tree_cursor_goto_first_child_wasm(this.tree[0]);return unmarshalTreeCursor(this),e===1}gotoNextSibling(){marshalTreeCursor(this);let e=C._ts_tree_cursor_goto_next_sibling_wasm(this.tree[0]);return unmarshalTreeCursor(this),e===1}gotoParent(){marshalTreeCursor(this);let e=C._ts_tree_cursor_goto_parent_wasm(this.tree[0]);return unmarshalTreeCursor(this),e===1}}class Language{static{s(this,"Language")}constructor(e,r){assertInternal(e),this[0]=r,this.types=new Array(C._ts_language_symbol_count(this[0]));for(let n=0,i=this.types.length;n<i;n++)C._ts_language_symbol_type(this[0],n)<2&&(this.types[n]=UTF8ToString(C._ts_language_symbol_name(this[0],n)));this.fields=new Array(C._ts_language_field_count(this[0])+1);for(let n=0,i=this.fields.length;n<i;n++){let o=C._ts_language_field_name_for_id(this[0],n);this.fields[n]=o!==0?UTF8ToString(o):null}}get version(){return C._ts_language_version(this[0])}get fieldCount(){return this.fields.length-1}fieldIdForName(e){let r=this.fields.indexOf(e);return r!==-1?r:null}fieldNameForId(e){return this.fields[e]||null}idForNodeType(e,r){let n=lengthBytesUTF8(e),i=C._malloc(n+1);stringToUTF8(e,i,n+1);let o=C._ts_language_symbol_for_name(this[0],i,n,r);return C._free(i),o||null}get nodeTypeCount(){return C._ts_language_symbol_count(this[0])}nodeTypeForId(e){let r=C._ts_language_symbol_name(this[0],e);return r?UTF8ToString(r):null}nodeTypeIsNamed(e){return!!C._ts_language_type_is_named_wasm(this[0],e)}nodeTypeIsVisible(e){return!!C._ts_language_type_is_visible_wasm(this[0],e)}query(e){let r=lengthBytesUTF8(e),n=C._malloc(r+1);stringToUTF8(e,n,r+1);let i=C._ts_query_new(this[0],n,r,TRANSFER_BUFFER,TRANSFER_BUFFER+SIZE_OF_INT);if(!i){let A=getValue(TRANSFER_BUFFER+SIZE_OF_INT,"i32"),y=UTF8ToString(n,getValue(TRANSFER_BUFFER,"i32")).length,E=e.substr(y,100).split(`
`)[0],b,S=E.match(QUERY_WORD_REGEX)[0];switch(A){case 2:b=new RangeError(`Bad node name '${S}'`);break;case 3:b=new RangeError(`Bad field name '${S}'`);break;case 4:b=new RangeError(`Bad capture name @${S}`);break;case 5:b=new TypeError(`Bad pattern structure at offset ${y}: '${E}'...`),S="";break;default:b=new SyntaxError(`Bad syntax at offset ${y}: '${E}'...`),S=""}throw b.index=y,b.length=S.length,C._free(n),b}let o=C._ts_query_string_count(i),a=C._ts_query_capture_count(i),c=C._ts_query_pattern_count(i),l=new Array(a),u=new Array(o);for(let A=0;A<a;A++){let y=C._ts_query_capture_name_for_id(i,A,TRANSFER_BUFFER),E=getValue(TRANSFER_BUFFER,"i32");l[A]=UTF8ToString(y,E)}for(let A=0;A<o;A++){let y=C._ts_query_string_value_for_id(i,A,TRANSFER_BUFFER),E=getValue(TRANSFER_BUFFER,"i32");u[A]=UTF8ToString(y,E)}let f=new Array(c),p=new Array(c),m=new Array(c),h=new Array(c),g=new Array(c);for(let A=0;A<c;A++){let y=C._ts_query_predicates_for_pattern(i,A,TRANSFER_BUFFER),E=getValue(TRANSFER_BUFFER,"i32");h[A]=[],g[A]=[];let b=[],S=y;for(let R=0;R<E;R++){let B=getValue(S,"i32");S+=SIZE_OF_INT;let L=getValue(S,"i32");if(S+=SIZE_OF_INT,B===PREDICATE_STEP_TYPE_CAPTURE)b.push({type:"capture",name:l[L]});else if(B===PREDICATE_STEP_TYPE_STRING)b.push({type:"string",value:u[L]});else if(b.length>0){if(b[0].type!=="string")throw new Error("Predicates must begin with a literal value");let O=b[0].value,Y=!0;switch(O){case"not-eq?":Y=!1;case"eq?":if(b.length!==3)throw new Error("Wrong number of arguments to `#eq?` predicate. Expected 2, got "+(b.length-1));if(b[1].type!=="capture")throw new Error(`First argument of \`#eq?\` predicate must be a capture. Got "${b[1].value}"`);if(b[2].type==="capture"){let U=b[1].name,Z=b[2].name;g[A].push(function(J){let j,W;for(let X of J)X.name===U&&(j=X.node),X.name===Z&&(W=X.node);return j===void 0||W===void 0||j.text===W.text===Y})}else{let U=b[1].name,Z=b[2].value;g[A].push(function(J){for(let j of J)if(j.name===U)return j.node.text===Z===Y;return!0})}break;case"not-match?":Y=!1;case"match?":if(b.length!==3)throw new Error(`Wrong number of arguments to \`#match?\` predicate. Expected 2, got ${b.length-1}.`);if(b[1].type!=="capture")throw new Error(`First argument of \`#match?\` predicate must be a capture. Got "${b[1].value}".`);if(b[2].type!=="string")throw new Error(`Second argument of \`#match?\` predicate must be a string. Got @${b[2].value}.`);let V=b[1].name,z=new RegExp(b[2].value);g[A].push(function(U){for(let Z of U)if(Z.name===V)return z.test(Z.node.text)===Y;return!0});break;case"set!":if(b.length<2||b.length>3)throw new Error(`Wrong number of arguments to \`#set!\` predicate. Expected 1 or 2. Got ${b.length-1}.`);if(b.some(U=>U.type!=="string"))throw new Error('Arguments to `#set!` predicate must be a strings.".');f[A]||(f[A]={}),f[A][b[1].value]=b[2]?b[2].value:null;break;case"is?":case"is-not?":if(b.length<2||b.length>3)throw new Error(`Wrong number of arguments to \`#${O}\` predicate. Expected 1 or 2. Got ${b.length-1}.`);if(b.some(U=>U.type!=="string"))throw new Error(`Arguments to \`#${O}\` predicate must be a strings.".`);let Q=O==="is?"?p:m;Q[A]||(Q[A]={}),Q[A][b[1].value]=b[2]?b[2].value:null;break;default:h[A].push({operator:O,operands:b.slice(1)})}b.length=0}}Object.freeze(f[A]),Object.freeze(p[A]),Object.freeze(m[A])}return C._free(n),new Query(INTERNAL,i,l,g,h,Object.freeze(f),Object.freeze(p),Object.freeze(m))}static load(e){let r;if(e instanceof Uint8Array)r=Promise.resolve(e);else{let i=e;if(typeof process<"u"&&process.versions&&process.versions.node){let o=require("fs");r=Promise.resolve(o.readFileSync(i))}else r=fetch(i).then(o=>o.arrayBuffer().then(a=>{if(o.ok)return new Uint8Array(a);{let c=new TextDecoder("utf-8").decode(a);throw new Error(`Language.load failed with status ${o.status}.

${c}`)}}))}let n=typeof loadSideModule=="function"?loadSideModule:loadWebAssemblyModule;return r.then(i=>n(i,{loadAsync:!0})).then(i=>{let o=Object.keys(i),a=o.find(l=>LANGUAGE_FUNCTION_REGEX.test(l)&&!l.includes("external_scanner_"));a||console.log(`Couldn't find language function in WASM file. Symbols:
${JSON.stringify(o,null,2)}`);let c=i[a]();return new Language(INTERNAL,c)})}}class Query{static{s(this,"Query")}constructor(e,r,n,i,o,a,c,l){assertInternal(e),this[0]=r,this.captureNames=n,this.textPredicates=i,this.predicates=o,this.setProperties=a,this.assertedProperties=c,this.refutedProperties=l,this.exceededMatchLimit=!1}delete(){C._ts_query_delete(this[0]),this[0]=0}matches(e,r,n,i){r||(r=ZERO_POINT),n||(n=ZERO_POINT),i||(i={});let o=i.matchLimit;if(o===void 0)o=0;else if(typeof o!="number")throw new Error("Arguments must be numbers");marshalNode(e),C._ts_query_matches_wasm(this[0],e.tree[0],r.row,r.column,n.row,n.column,o);let a=getValue(TRANSFER_BUFFER,"i32"),c=getValue(TRANSFER_BUFFER+SIZE_OF_INT,"i32"),l=getValue(TRANSFER_BUFFER+2*SIZE_OF_INT,"i32"),u=new Array(a);this.exceededMatchLimit=!!l;let f=0,p=c;for(let m=0;m<a;m++){let h=getValue(p,"i32");p+=SIZE_OF_INT;let g=getValue(p,"i32");p+=SIZE_OF_INT;let A=new Array(g);if(p=unmarshalCaptures(this,e.tree,p,A),this.textPredicates[h].every(y=>y(A))){u[f++]={pattern:h,captures:A};let y=this.setProperties[h];y&&(u[m].setProperties=y);let E=this.assertedProperties[h];E&&(u[m].assertedProperties=E);let b=this.refutedProperties[h];b&&(u[m].refutedProperties=b)}}return u.length=f,C._free(c),u}captures(e,r,n,i){r||(r=ZERO_POINT),n||(n=ZERO_POINT),i||(i={});let o=i.matchLimit;if(o===void 0)o=0;else if(typeof o!="number")throw new Error("Arguments must be numbers");marshalNode(e),C._ts_query_captures_wasm(this[0],e.tree[0],r.row,r.column,n.row,n.column,o);let a=getValue(TRANSFER_BUFFER,"i32"),c=getValue(TRANSFER_BUFFER+SIZE_OF_INT,"i32"),l=getValue(TRANSFER_BUFFER+2*SIZE_OF_INT,"i32"),u=[];this.exceededMatchLimit=!!l;let f=[],p=c;for(let m=0;m<a;m++){let h=getValue(p,"i32");p+=SIZE_OF_INT;let g=getValue(p,"i32");p+=SIZE_OF_INT;let A=getValue(p,"i32");if(p+=SIZE_OF_INT,f.length=g,p=unmarshalCaptures(this,e.tree,p,f),this.textPredicates[h].every(y=>y(f))){let y=f[A],E=this.setProperties[h];E&&(y.setProperties=E);let b=this.assertedProperties[h];b&&(y.assertedProperties=b);let S=this.refutedProperties[h];S&&(y.refutedProperties=S),u.push(y)}}return C._free(c),u}predicatesForPattern(e){return this.predicates[e]}didExceedMatchLimit(){return this.exceededMatchLimit}}function getText(t,e,r){let n=r-e,i=t.textCallback(e,null,r);for(e+=i.length;e<r;){let o=t.textCallback(e,null,r);if(!(o&&o.length>0))break;e+=o.length,i+=o}return e>r&&(i=i.slice(0,n)),i}s(getText,"getText");function unmarshalCaptures(t,e,r,n){for(let i=0,o=n.length;i<o;i++){let a=getValue(r,"i32"),c=unmarshalNode(e,r+=SIZE_OF_INT);r+=SIZE_OF_NODE,n[i]={name:t.captureNames[a],node:c}}return r}s(unmarshalCaptures,"unmarshalCaptures");function assertInternal(t){if(t!==INTERNAL)throw new Error("Illegal constructor")}s(assertInternal,"assertInternal");function isPoint(t){return t&&typeof t.row=="number"&&typeof t.column=="number"}s(isPoint,"isPoint");function marshalNode(t){let e=TRANSFER_BUFFER;setValue(e,t.id,"i32"),e+=SIZE_OF_INT,setValue(e,t.startIndex,"i32"),e+=SIZE_OF_INT,setValue(e,t.startPosition.row,"i32"),e+=SIZE_OF_INT,setValue(e,t.startPosition.column,"i32"),e+=SIZE_OF_INT,setValue(e,t[0],"i32")}s(marshalNode,"marshalNode");function unmarshalNode(t,e=TRANSFER_BUFFER){let r=getValue(e,"i32");if(r===0)return null;let n=getValue(e+=SIZE_OF_INT,"i32"),i=getValue(e+=SIZE_OF_INT,"i32"),o=getValue(e+=SIZE_OF_INT,"i32"),a=getValue(e+=SIZE_OF_INT,"i32"),c=new Node(INTERNAL,t);return c.id=r,c.startIndex=n,c.startPosition={row:i,column:o},c[0]=a,c}s(unmarshalNode,"unmarshalNode");function marshalTreeCursor(t,e=TRANSFER_BUFFER){setValue(e+0*SIZE_OF_INT,t[0],"i32"),setValue(e+1*SIZE_OF_INT,t[1],"i32"),setValue(e+2*SIZE_OF_INT,t[2],"i32")}s(marshalTreeCursor,"marshalTreeCursor");function unmarshalTreeCursor(t){t[0]=getValue(TRANSFER_BUFFER+0*SIZE_OF_INT,"i32"),t[1]=getValue(TRANSFER_BUFFER+1*SIZE_OF_INT,"i32"),t[2]=getValue(TRANSFER_BUFFER+2*SIZE_OF_INT,"i32")}s(unmarshalTreeCursor,"unmarshalTreeCursor");function marshalPoint(t,e){setValue(t,e.row,"i32"),setValue(t+SIZE_OF_INT,e.column,"i32")}s(marshalPoint,"marshalPoint");function unmarshalPoint(t){return{row:getValue(t,"i32"),column:getValue(t+SIZE_OF_INT,"i32")}}s(unmarshalPoint,"unmarshalPoint");function marshalRange(t,e){marshalPoint(t,e.startPosition),marshalPoint(t+=SIZE_OF_POINT,e.endPosition),setValue(t+=SIZE_OF_POINT,e.startIndex,"i32"),setValue(t+=SIZE_OF_INT,e.endIndex,"i32"),t+=SIZE_OF_INT}s(marshalRange,"marshalRange");function unmarshalRange(t){let e={};return e.startPosition=unmarshalPoint(t),t+=SIZE_OF_POINT,e.endPosition=unmarshalPoint(t),t+=SIZE_OF_POINT,e.startIndex=getValue(t,"i32"),t+=SIZE_OF_INT,e.endIndex=getValue(t,"i32"),e}s(unmarshalRange,"unmarshalRange");function marshalEdit(t){let e=TRANSFER_BUFFER;marshalPoint(e,t.startPosition),e+=SIZE_OF_POINT,marshalPoint(e,t.oldEndPosition),e+=SIZE_OF_POINT,marshalPoint(e,t.newEndPosition),e+=SIZE_OF_POINT,setValue(e,t.startIndex,"i32"),e+=SIZE_OF_INT,setValue(e,t.oldEndIndex,"i32"),e+=SIZE_OF_INT,setValue(e,t.newEndIndex,"i32"),e+=SIZE_OF_INT}s(marshalEdit,"marshalEdit");for(let t of Object.getOwnPropertyNames(ParserImpl.prototype))Object.defineProperty(Parser.prototype,t,{value:ParserImpl.prototype[t],enumerable:!1,writable:!1});Parser.Language=Language,Module.onRuntimeInitialized=()=>{ParserImpl.init(),resolveInitPromise()}}))}}return Parser}();typeof exports=="object"&&(module.exports=TreeSitter)});var t1e=H((HLn,rGe)=>{d();var e1e=require("fs"),YY=require("path"),$O=YY.join,l$t=YY.dirname,eGe=e1e.accessSync&&function(t){try{e1e.accessSync(t)}catch{return!1}return!0}||e1e.existsSync||YY.existsSync,tGe={arrow:process.env.NODE_BINDINGS_ARROW||" \u2192 ",compiled:process.env.NODE_BINDINGS_COMPILED_DIR||"compiled",platform:process.platform,arch:process.arch,nodePreGyp:"node-v"+process.versions.modules+"-"+process.platform+"-"+process.arch,version:process.versions.node,bindings:"bindings.node",try:[["module_root","build","bindings"],["module_root","build","Debug","bindings"],["module_root","build","Release","bindings"],["module_root","out","Debug","bindings"],["module_root","Debug","bindings"],["module_root","out","Release","bindings"],["module_root","Release","bindings"],["module_root","build","default","bindings"],["module_root","compiled","version","platform","arch","bindings"],["module_root","compiled","platform","arch","bindings"]]};function u$t(t){typeof t=="string"?t={bindings:t}:t||(t={}),Object.keys(tGe).map(function(l){l in t||(t[l]=tGe[l])}),t.module_root||(t.module_root=d$t(__filename)),YY.extname(t.bindings)!=".node"&&(t.bindings+=".node");for(var e=typeof __webpack_require__=="function"?__non_webpack_require__:require,r=[],n=0,i=t.try.length,o,a,c;n<i;n++){o=$O.apply(null,t.try[n].map(function(l){return t[l]||l})),r.push(o);try{return a=t.path?e.resolve(o):e(o),t.path||(a.path=o),a}catch(l){if(l.code!=="MODULE_NOT_FOUND"&&l.code!=="QUALIFIED_PATH_RESOLUTION_FAILED"&&!/not find/i.test(l.message))throw l}}throw c=new Error(`Could not locate the bindings file. Tried:
`+r.map(function(l){return t.arrow+l}).join(`
`)),c.tries=r,c}s(u$t,"bindings");rGe.exports=u$t;function d$t(t){for(var e=l$t(t),r;;){if(e==="."&&(e=process.cwd()),eGe($O(e,"dist")))return $O(e,"dist");if(eGe($O(e,"compiled")))return e;if(r===e)throw new Error('Could not find module root given file: "'+t+'". Do you have a `dist` or `compiled` directory? ');r=e,e=$O(e,"..")}}s(d$t,"getRoot")});var iGe=H((jLn,nGe)=>{d();nGe.exports=t1e()("node_sqlite3.node")});var aGe=H(sGe=>{d();var f$t=require("util");function p$t(t,e,r){let n=t[e];t[e]=function(){let i=new Error,o=t.constructor.name+"#"+e+"("+Array.prototype.slice.call(arguments).map(function(c){return f$t.inspect(c,!1,0)}).join(", ")+")";typeof r>"u"&&(r=-1),r<0&&(r+=arguments.length);let a=arguments[r];return typeof arguments[r]=="function"&&(arguments[r]=s(function(){let l=arguments[0];return l&&l.stack&&!l.__augmented&&(l.stack=oGe(l).join(`
`),l.stack+=`
--> in `+o,l.stack+=`
`+oGe(i).slice(1).join(`
`),l.__augmented=!0),a.apply(this,arguments)},"replacement")),n.apply(this,arguments)}}s(p$t,"extendTrace");sGe.extendTrace=p$t;function oGe(t){return t.stack.split(`
`).filter(function(e){return e.indexOf(__filename)<0})}s(oGe,"filter")});var dGe=H((lGe,uGe)=>{d();var m$t=require("path"),gh=iGe(),VB=require("events").EventEmitter;uGe.exports=lGe=gh;function zB(t){return function(e){let r,n=Array.prototype.slice.call(arguments,1);if(typeof n[n.length-1]=="function"){let o=n[n.length-1];r=s(function(a){a&&o(a)},"errBack")}let i=new JY(this,e,r);return t.call(this,i,n)}}s(zB,"normalizeMethod");function n1e(t,e){for(let r in e.prototype)t.prototype[r]=e.prototype[r]}s(n1e,"inherits");gh.cached={Database:s(function(t,e,r){if(t===""||t===":memory:")return new Sf(t,e,r);let n;if(t=m$t.resolve(t),!gh.cached.objects[t])n=gh.cached.objects[t]=new Sf(t,e,r);else{n=gh.cached.objects[t];let o=typeof e=="number"?r:e;if(typeof o=="function"){let a=function(){o.call(n,null)};var i=a;s(a,"cb"),n.open?process.nextTick(a):n.once("open",a)}}return n},"Database"),objects:{}};var Sf=gh.Database,JY=gh.Statement,r1e=gh.Backup;n1e(Sf,VB);n1e(JY,VB);n1e(r1e,VB);Sf.prototype.prepare=zB(function(t,e){return e.length?t.bind.apply(t,e):t});Sf.prototype.run=zB(function(t,e){return t.run.apply(t,e).finalize(),this});Sf.prototype.get=zB(function(t,e){return t.get.apply(t,e).finalize(),this});Sf.prototype.all=zB(function(t,e){return t.all.apply(t,e).finalize(),this});Sf.prototype.each=zB(function(t,e){return t.each.apply(t,e).finalize(),this});Sf.prototype.map=zB(function(t,e){return t.map.apply(t,e).finalize(),this});Sf.prototype.backup=function(){let t;return arguments.length<=2?t=new r1e(this,arguments[0],"main","main",!0,arguments[1]):t=new r1e(this,arguments[0],arguments[1],arguments[2],arguments[3],arguments[4]),t.retryErrors=[gh.BUSY,gh.LOCKED],t};JY.prototype.map=function(){let t=Array.prototype.slice.call(arguments),e=t.pop();return t.push(function(r,n){if(r)return e(r);let i={};if(n.length){let o=Object.keys(n[0]),a=o[0];if(o.length>2)for(let c=0;c<n.length;c++)i[n[c][a]]=n[c];else{let c=o[1];for(let l=0;l<n.length;l++)i[n[l][a]]=n[l][c]}}e(r,i)}),this.all.apply(this,t)};var cGe=!1,i1e=["trace","profile","change"];Sf.prototype.addListener=Sf.prototype.on=function(t){let e=VB.prototype.addListener.apply(this,arguments);return i1e.indexOf(t)>=0&&this.configure(t,!0),e};Sf.prototype.removeListener=function(t){let e=VB.prototype.removeListener.apply(this,arguments);return i1e.indexOf(t)>=0&&!this._events[t]&&this.configure(t,!1),e};Sf.prototype.removeAllListeners=function(t){let e=VB.prototype.removeAllListeners.apply(this,arguments);return i1e.indexOf(t)>=0&&this.configure(t,!1),e};gh.verbose=function(){if(!cGe){let t=aGe();["prepare","get","run","all","each","map","close","exec"].forEach(function(e){t.extendTrace(Sf.prototype,e)}),["bind","get","run","all","each","map","reset","finalize"].forEach(function(e){t.extendTrace(JY.prototype,e)}),cGe=!0}return gh}});var uJ=H(ll=>{"use strict";d();Object.defineProperty(ll,"__esModule",{value:!0});ll.thenable=ll.typedArray=ll.stringArray=ll.array=ll.func=ll.error=ll.number=ll.string=ll.boolean=void 0;function g$t(t){return t===!0||t===!1}s(g$t,"boolean");ll.boolean=g$t;function gGe(t){return typeof t=="string"||t instanceof String}s(gGe,"string");ll.string=gGe;function A$t(t){return typeof t=="number"||t instanceof Number}s(A$t,"number");ll.number=A$t;function y$t(t){return t instanceof Error}s(y$t,"error");ll.error=y$t;function AGe(t){return typeof t=="function"}s(AGe,"func");ll.func=AGe;function yGe(t){return Array.isArray(t)}s(yGe,"array");ll.array=yGe;function C$t(t){return yGe(t)&&t.every(e=>gGe(e))}s(C$t,"stringArray");ll.stringArray=C$t;function v$t(t,e){return Array.isArray(t)&&t.every(e)}s(v$t,"typedArray");ll.typedArray=v$t;function x$t(t){return t&&AGe(t.then)}s(x$t,"thenable");ll.thenable=x$t});var a1e=H(Ah=>{"use strict";d();Object.defineProperty(Ah,"__esModule",{value:!0});Ah.generateUuid=Ah.parse=Ah.isUUID=Ah.v4=Ah.empty=void 0;var GO=class{static{s(this,"ValueUUID")}constructor(e){this._value=e}asHex(){return this._value}equals(e){return this.asHex()===e.asHex()}},VO=class t extends GO{static{s(this,"V4UUID")}static _oneOf(e){return e[Math.floor(e.length*Math.random())]}static _randomHex(){return t._oneOf(t._chars)}constructor(){super([t._randomHex(),t._randomHex(),t._randomHex(),t._randomHex(),t._randomHex(),t._randomHex(),t._randomHex(),t._randomHex(),"-",t._randomHex(),t._randomHex(),t._randomHex(),t._randomHex(),"-","4",t._randomHex(),t._randomHex(),t._randomHex(),"-",t._oneOf(t._timeHighBits),t._randomHex(),t._randomHex(),t._randomHex(),"-",t._randomHex(),t._randomHex(),t._randomHex(),t._randomHex(),t._randomHex(),t._randomHex(),t._randomHex(),t._randomHex(),t._randomHex(),t._randomHex(),t._randomHex(),t._randomHex()].join(""))}};VO._chars=["0","1","2","3","4","5","6","6","7","8","9","a","b","c","d","e","f"];VO._timeHighBits=["8","9","a","b"];Ah.empty=new GO("00000000-0000-0000-0000-000000000000");function CGe(){return new VO}s(CGe,"v4");Ah.v4=CGe;var E$t=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i;function vGe(t){return E$t.test(t)}s(vGe,"isUUID");Ah.isUUID=vGe;function b$t(t){if(!vGe(t))throw new Error("invalid uuid");return new GO(t)}s(b$t,"parse");Ah.parse=b$t;function I$t(){return CGe().asHex()}s(I$t,"generateUuid");Ah.generateUuid=I$t});var xGe=H(kT=>{"use strict";d();Object.defineProperty(kT,"__esModule",{value:!0});kT.attachPartialResult=kT.ProgressFeature=kT.attachWorkDone=void 0;var RT=hi(),T$t=a1e(),CR=class t{static{s(this,"WorkDoneProgressReporterImpl")}constructor(e,r){this._connection=e,this._token=r,t.Instances.set(this._token,this)}begin(e,r,n,i){let o={kind:"begin",title:e,percentage:r,message:n,cancellable:i};this._connection.sendProgress(RT.WorkDoneProgress.type,this._token,o)}report(e,r){let n={kind:"report"};typeof e=="number"?(n.percentage=e,r!==void 0&&(n.message=r)):n.message=e,this._connection.sendProgress(RT.WorkDoneProgress.type,this._token,n)}done(){t.Instances.delete(this._token),this._connection.sendProgress(RT.WorkDoneProgress.type,this._token,{kind:"end"})}};CR.Instances=new Map;var dJ=class extends CR{static{s(this,"WorkDoneProgressServerReporterImpl")}constructor(e,r){super(e,r),this._source=new RT.CancellationTokenSource}get token(){return this._source.token}done(){this._source.dispose(),super.done()}cancel(){this._source.cancel()}},zO=class{static{s(this,"NullProgressReporter")}constructor(){}begin(){}report(){}done(){}},fJ=class extends zO{static{s(this,"NullProgressServerReporter")}constructor(){super(),this._source=new RT.CancellationTokenSource}get token(){return this._source.token}done(){this._source.dispose()}cancel(){this._source.cancel()}};function w$t(t,e){if(e===void 0||e.workDoneToken===void 0)return new zO;let r=e.workDoneToken;return delete e.workDoneToken,new CR(t,r)}s(w$t,"attachWorkDone");kT.attachWorkDone=w$t;var S$t=s(t=>class extends t{constructor(){super(),this._progressSupported=!1}initialize(e){super.initialize(e),e?.window?.workDoneProgress===!0&&(this._progressSupported=!0,this.connection.onNotification(RT.WorkDoneProgressCancelNotification.type,r=>{let n=CR.Instances.get(r.token);(n instanceof dJ||n instanceof fJ)&&n.cancel()}))}attachWorkDoneProgress(e){return e===void 0?new zO:new CR(this.connection,e)}createWorkDoneProgress(){if(this._progressSupported){let e=(0,T$t.generateUuid)();return this.connection.sendRequest(RT.WorkDoneProgressCreateRequest.type,{token:e}).then(()=>new dJ(this.connection,e))}else return Promise.resolve(new fJ)}},"ProgressFeature");kT.ProgressFeature=S$t;var c1e;(function(t){t.type=new RT.ProgressType})(c1e||(c1e={}));var l1e=class{static{s(this,"ResultProgressReporterImpl")}constructor(e,r){this._connection=e,this._token=r}report(e){this._connection.sendProgress(c1e.type,this._token,e)}};function _$t(t,e){if(e===void 0||e.partialResultToken===void 0)return;let r=e.partialResultToken;return delete e.partialResultToken,new l1e(t,r)}s(_$t,"attachPartialResult");kT.attachPartialResult=_$t});var EGe=H(pJ=>{"use strict";d();Object.defineProperty(pJ,"__esModule",{value:!0});pJ.ConfigurationFeature=void 0;var R$t=hi(),k$t=uJ(),P$t=s(t=>class extends t{getConfiguration(e){return e?k$t.string(e)?this._getConfiguration({section:e}):this._getConfiguration(e):this._getConfiguration({})}_getConfiguration(e){let r={items:Array.isArray(e)?e:[e]};return this.connection.sendRequest(R$t.ConfigurationRequest.type,r).then(n=>Array.isArray(n)?Array.isArray(e)?n:n[0]:Array.isArray(e)?[]:null)}},"ConfigurationFeature");pJ.ConfigurationFeature=P$t});var bGe=H(hJ=>{"use strict";d();Object.defineProperty(hJ,"__esModule",{value:!0});hJ.WorkspaceFoldersFeature=void 0;var mJ=hi(),D$t=s(t=>class extends t{constructor(){super(),this._notificationIsAutoRegistered=!1}initialize(e){super.initialize(e);let r=e.workspace;r&&r.workspaceFolders&&(this._onDidChangeWorkspaceFolders=new mJ.Emitter,this.connection.onNotification(mJ.DidChangeWorkspaceFoldersNotification.type,n=>{this._onDidChangeWorkspaceFolders.fire(n.event)}))}fillServerCapabilities(e){super.fillServerCapabilities(e);let r=e.workspace?.workspaceFolders?.changeNotifications;this._notificationIsAutoRegistered=r===!0||typeof r=="string"}getWorkspaceFolders(){return this.connection.sendRequest(mJ.WorkspaceFoldersRequest.type)}get onDidChangeWorkspaceFolders(){if(!this._onDidChangeWorkspaceFolders)throw new Error("Client doesn't support sending workspace folder change events.");return!this._notificationIsAutoRegistered&&!this._unregistration&&(this._unregistration=this.connection.client.register(mJ.DidChangeWorkspaceFoldersNotification.type)),this._onDidChangeWorkspaceFolders.event}},"WorkspaceFoldersFeature");hJ.WorkspaceFoldersFeature=D$t});var IGe=H(gJ=>{"use strict";d();Object.defineProperty(gJ,"__esModule",{value:!0});gJ.CallHierarchyFeature=void 0;var u1e=hi(),B$t=s(t=>class extends t{get callHierarchy(){return{onPrepare:s(e=>this.connection.onRequest(u1e.CallHierarchyPrepareRequest.type,(r,n)=>e(r,n,this.attachWorkDoneProgress(r),void 0)),"onPrepare"),onIncomingCalls:s(e=>{let r=u1e.CallHierarchyIncomingCallsRequest.type;return this.connection.onRequest(r,(n,i)=>e(n,i,this.attachWorkDoneProgress(n),this.attachPartialResultProgress(r,n)))},"onIncomingCalls"),onOutgoingCalls:s(e=>{let r=u1e.CallHierarchyOutgoingCallsRequest.type;return this.connection.onRequest(r,(n,i)=>e(n,i,this.attachWorkDoneProgress(n),this.attachPartialResultProgress(r,n)))},"onOutgoingCalls")}}},"CallHierarchyFeature");gJ.CallHierarchyFeature=B$t});var f1e=H(PT=>{"use strict";d();Object.defineProperty(PT,"__esModule",{value:!0});PT.SemanticTokensBuilder=PT.SemanticTokensDiff=PT.SemanticTokensFeature=void 0;var AJ=hi(),N$t=s(t=>class extends t{get semanticTokens(){return{refresh:s(()=>this.connection.sendRequest(AJ.SemanticTokensRefreshRequest.type),"refresh"),on:s(e=>{let r=AJ.SemanticTokensRequest.type;return this.connection.onRequest(r,(n,i)=>e(n,i,this.attachWorkDoneProgress(n),this.attachPartialResultProgress(r,n)))},"on"),onDelta:s(e=>{let r=AJ.SemanticTokensDeltaRequest.type;return this.connection.onRequest(r,(n,i)=>e(n,i,this.attachWorkDoneProgress(n),this.attachPartialResultProgress(r,n)))},"onDelta"),onRange:s(e=>{let r=AJ.SemanticTokensRangeRequest.type;return this.connection.onRequest(r,(n,i)=>e(n,i,this.attachWorkDoneProgress(n),this.attachPartialResultProgress(r,n)))},"onRange")}}},"SemanticTokensFeature");PT.SemanticTokensFeature=N$t;var yJ=class{static{s(this,"SemanticTokensDiff")}constructor(e,r){this.originalSequence=e,this.modifiedSequence=r}computeDiff(){let e=this.originalSequence.length,r=this.modifiedSequence.length,n=0;for(;n<r&&n<e&&this.originalSequence[n]===this.modifiedSequence[n];)n++;if(n<r&&n<e){let i=e-1,o=r-1;for(;i>=n&&o>=n&&this.originalSequence[i]===this.modifiedSequence[o];)i--,o--;(i<n||o<n)&&(i++,o++);let a=i-n+1,c=this.modifiedSequence.slice(n,o+1);return c.length===1&&c[0]===this.originalSequence[i]?[{start:n,deleteCount:a-1}]:[{start:n,deleteCount:a,data:c}]}else return n<r?[{start:n,deleteCount:0,data:this.modifiedSequence.slice(n)}]:n<e?[{start:n,deleteCount:e-n}]:[]}};PT.SemanticTokensDiff=yJ;var d1e=class{static{s(this,"SemanticTokensBuilder")}constructor(){this._prevData=void 0,this.initialize()}initialize(){this._id=Date.now(),this._prevLine=0,this._prevChar=0,this._data=[],this._dataLen=0}push(e,r,n,i,o){let a=e,c=r;this._dataLen>0&&(a-=this._prevLine,a===0&&(c-=this._prevChar)),this._data[this._dataLen++]=a,this._data[this._dataLen++]=c,this._data[this._dataLen++]=n,this._data[this._dataLen++]=i,this._data[this._dataLen++]=o,this._prevLine=e,this._prevChar=r}get id(){return this._id.toString()}previousResult(e){this.id===e&&(this._prevData=this._data),this.initialize()}build(){return this._prevData=void 0,{resultId:this.id,data:this._data}}canBuildEdits(){return this._prevData!==void 0}buildEdits(){return this._prevData!==void 0?{resultId:this.id,edits:new yJ(this._prevData,this._data).computeDiff()}:this.build()}};PT.SemanticTokensBuilder=d1e});var TGe=H(CJ=>{"use strict";d();Object.defineProperty(CJ,"__esModule",{value:!0});CJ.ShowDocumentFeature=void 0;var M$t=hi(),L$t=s(t=>class extends t{showDocument(e){return this.connection.sendRequest(M$t.ShowDocumentRequest.type,e)}},"ShowDocumentFeature");CJ.ShowDocumentFeature=L$t});var wGe=H(vJ=>{"use strict";d();Object.defineProperty(vJ,"__esModule",{value:!0});vJ.FileOperationsFeature=void 0;var YB=hi(),F$t=s(t=>class extends t{onDidCreateFiles(e){return this.connection.onNotification(YB.DidCreateFilesNotification.type,r=>{e(r)})}onDidRenameFiles(e){return this.connection.onNotification(YB.DidRenameFilesNotification.type,r=>{e(r)})}onDidDeleteFiles(e){return this.connection.onNotification(YB.DidDeleteFilesNotification.type,r=>{e(r)})}onWillCreateFiles(e){return this.connection.onRequest(YB.WillCreateFilesRequest.type,(r,n)=>e(r,n))}onWillRenameFiles(e){return this.connection.onRequest(YB.WillRenameFilesRequest.type,(r,n)=>e(r,n))}onWillDeleteFiles(e){return this.connection.onRequest(YB.WillDeleteFilesRequest.type,(r,n)=>e(r,n))}},"FileOperationsFeature");vJ.FileOperationsFeature=F$t});var SGe=H(xJ=>{"use strict";d();Object.defineProperty(xJ,"__esModule",{value:!0});xJ.LinkedEditingRangeFeature=void 0;var O$t=hi(),Q$t=s(t=>class extends t{onLinkedEditingRange(e){return this.connection.onRequest(O$t.LinkedEditingRangeRequest.type,(r,n)=>e(r,n,this.attachWorkDoneProgress(r),void 0))}},"LinkedEditingRangeFeature");xJ.LinkedEditingRangeFeature=Q$t});var _Ge=H(EJ=>{"use strict";d();Object.defineProperty(EJ,"__esModule",{value:!0});EJ.TypeHierarchyFeature=void 0;var p1e=hi(),U$t=s(t=>class extends t{get typeHierarchy(){return{onPrepare:s(e=>this.connection.onRequest(p1e.TypeHierarchyPrepareRequest.type,(r,n)=>e(r,n,this.attachWorkDoneProgress(r),void 0)),"onPrepare"),onSupertypes:s(e=>{let r=p1e.TypeHierarchySupertypesRequest.type;return this.connection.onRequest(r,(n,i)=>e(n,i,this.attachWorkDoneProgress(n),this.attachPartialResultProgress(r,n)))},"onSupertypes"),onSubtypes:s(e=>{let r=p1e.TypeHierarchySubtypesRequest.type;return this.connection.onRequest(r,(n,i)=>e(n,i,this.attachWorkDoneProgress(n),this.attachPartialResultProgress(r,n)))},"onSubtypes")}}},"TypeHierarchyFeature");EJ.TypeHierarchyFeature=U$t});var kGe=H(bJ=>{"use strict";d();Object.defineProperty(bJ,"__esModule",{value:!0});bJ.InlineValueFeature=void 0;var RGe=hi(),q$t=s(t=>class extends t{get inlineValue(){return{refresh:s(()=>this.connection.sendRequest(RGe.InlineValueRefreshRequest.type),"refresh"),on:s(e=>this.connection.onRequest(RGe.InlineValueRequest.type,(r,n)=>e(r,n,this.attachWorkDoneProgress(r))),"on")}}},"InlineValueFeature");bJ.InlineValueFeature=q$t});var DGe=H(IJ=>{"use strict";d();Object.defineProperty(IJ,"__esModule",{value:!0});IJ.FoldingRangeFeature=void 0;var PGe=hi(),H$t=s(t=>class extends t{get foldingRange(){return{refresh:s(()=>this.connection.sendRequest(PGe.FoldingRangeRefreshRequest.type),"refresh"),on:s(e=>{let r=PGe.FoldingRangeRequest.type;return this.connection.onRequest(r,(n,i)=>e(n,i,this.attachWorkDoneProgress(n),this.attachPartialResultProgress(r,n)))},"on")}}},"FoldingRangeFeature");IJ.FoldingRangeFeature=H$t});var BGe=H(TJ=>{"use strict";d();Object.defineProperty(TJ,"__esModule",{value:!0});TJ.InlayHintFeature=void 0;var m1e=hi(),$$t=s(t=>class extends t{get inlayHint(){return{refresh:s(()=>this.connection.sendRequest(m1e.InlayHintRefreshRequest.type),"refresh"),on:s(e=>this.connection.onRequest(m1e.InlayHintRequest.type,(r,n)=>e(r,n,this.attachWorkDoneProgress(r))),"on"),resolve:s(e=>this.connection.onRequest(m1e.InlayHintResolveRequest.type,(r,n)=>e(r,n)),"resolve")}}},"InlayHintFeature");TJ.InlayHintFeature=$$t});var NGe=H(wJ=>{"use strict";d();Object.defineProperty(wJ,"__esModule",{value:!0});wJ.DiagnosticFeature=void 0;var KO=hi(),W$t=s(t=>class extends t{get diagnostics(){return{refresh:s(()=>this.connection.sendRequest(KO.DiagnosticRefreshRequest.type),"refresh"),on:s(e=>this.connection.onRequest(KO.DocumentDiagnosticRequest.type,(r,n)=>e(r,n,this.attachWorkDoneProgress(r),this.attachPartialResultProgress(KO.DocumentDiagnosticRequest.partialResult,r))),"on"),onWorkspace:s(e=>this.connection.onRequest(KO.WorkspaceDiagnosticRequest.type,(r,n)=>e(r,n,this.attachWorkDoneProgress(r),this.attachPartialResultProgress(KO.WorkspaceDiagnosticRequest.partialResult,r))),"onWorkspace")}}},"DiagnosticFeature");wJ.DiagnosticFeature=W$t});var g1e=H(SJ=>{"use strict";d();Object.defineProperty(SJ,"__esModule",{value:!0});SJ.TextDocuments=void 0;var vR=hi(),h1e=class{static{s(this,"TextDocuments")}constructor(e){this._configuration=e,this._syncedDocuments=new Map,this._onDidChangeContent=new vR.Emitter,this._onDidOpen=new vR.Emitter,this._onDidClose=new vR.Emitter,this._onDidSave=new vR.Emitter,this._onWillSave=new vR.Emitter}get onDidOpen(){return this._onDidOpen.event}get onDidChangeContent(){return this._onDidChangeContent.event}get onWillSave(){return this._onWillSave.event}onWillSaveWaitUntil(e){this._willSaveWaitUntil=e}get onDidSave(){return this._onDidSave.event}get onDidClose(){return this._onDidClose.event}get(e){return this._syncedDocuments.get(e)}all(){return Array.from(this._syncedDocuments.values())}keys(){return Array.from(this._syncedDocuments.keys())}listen(e){e.__textDocumentSync=vR.TextDocumentSyncKind.Incremental;let r=[];return r.push(e.onDidOpenTextDocument(n=>{let i=n.textDocument,o=this._configuration.create(i.uri,i.languageId,i.version,i.text);this._syncedDocuments.set(i.uri,o);let a=Object.freeze({document:o});this._onDidOpen.fire(a),this._onDidChangeContent.fire(a)})),r.push(e.onDidChangeTextDocument(n=>{let i=n.textDocument,o=n.contentChanges;if(o.length===0)return;let{version:a}=i;if(a==null)throw new Error(`Received document change event for ${i.uri} without valid version identifier`);let c=this._syncedDocuments.get(i.uri);c!==void 0&&(c=this._configuration.update(c,o,a),this._syncedDocuments.set(i.uri,c),this._onDidChangeContent.fire(Object.freeze({document:c})))})),r.push(e.onDidCloseTextDocument(n=>{let i=this._syncedDocuments.get(n.textDocument.uri);i!==void 0&&(this._syncedDocuments.delete(n.textDocument.uri),this._onDidClose.fire(Object.freeze({document:i})))})),r.push(e.onWillSaveTextDocument(n=>{let i=this._syncedDocuments.get(n.textDocument.uri);i!==void 0&&this._onWillSave.fire(Object.freeze({document:i,reason:n.reason}))})),r.push(e.onWillSaveTextDocumentWaitUntil((n,i)=>{let o=this._syncedDocuments.get(n.textDocument.uri);return o!==void 0&&this._willSaveWaitUntil?this._willSaveWaitUntil(Object.freeze({document:o,reason:n.reason}),i):[]})),r.push(e.onDidSaveTextDocument(n=>{let i=this._syncedDocuments.get(n.textDocument.uri);i!==void 0&&this._onDidSave.fire(Object.freeze({document:i}))})),vR.Disposable.create(()=>{r.forEach(n=>n.dispose())})}};SJ.TextDocuments=h1e});var y1e=H(JB=>{"use strict";d();Object.defineProperty(JB,"__esModule",{value:!0});JB.NotebookDocuments=JB.NotebookSyncFeature=void 0;var yh=hi(),MGe=g1e(),j$t=s(t=>class extends t{get synchronization(){return{onDidOpenNotebookDocument:s(e=>this.connection.onNotification(yh.DidOpenNotebookDocumentNotification.type,r=>{e(r)}),"onDidOpenNotebookDocument"),onDidChangeNotebookDocument:s(e=>this.connection.onNotification(yh.DidChangeNotebookDocumentNotification.type,r=>{e(r)}),"onDidChangeNotebookDocument"),onDidSaveNotebookDocument:s(e=>this.connection.onNotification(yh.DidSaveNotebookDocumentNotification.type,r=>{e(r)}),"onDidSaveNotebookDocument"),onDidCloseNotebookDocument:s(e=>this.connection.onNotification(yh.DidCloseNotebookDocumentNotification.type,r=>{e(r)}),"onDidCloseNotebookDocument")}}},"NotebookSyncFeature");JB.NotebookSyncFeature=j$t;var _J=class t{static{s(this,"CellTextDocumentConnection")}onDidOpenTextDocument(e){return this.openHandler=e,yh.Disposable.create(()=>{this.openHandler=void 0})}openTextDocument(e){this.openHandler&&this.openHandler(e)}onDidChangeTextDocument(e){return this.changeHandler=e,yh.Disposable.create(()=>{this.changeHandler=e})}changeTextDocument(e){this.changeHandler&&this.changeHandler(e)}onDidCloseTextDocument(e){return this.closeHandler=e,yh.Disposable.create(()=>{this.closeHandler=void 0})}closeTextDocument(e){this.closeHandler&&this.closeHandler(e)}onWillSaveTextDocument(){return t.NULL_DISPOSE}onWillSaveTextDocumentWaitUntil(){return t.NULL_DISPOSE}onDidSaveTextDocument(){return t.NULL_DISPOSE}};_J.NULL_DISPOSE=Object.freeze({dispose:s(()=>{},"dispose")});var A1e=class{static{s(this,"NotebookDocuments")}constructor(e){e instanceof MGe.TextDocuments?this._cellTextDocuments=e:this._cellTextDocuments=new MGe.TextDocuments(e),this.notebookDocuments=new Map,this.notebookCellMap=new Map,this._onDidOpen=new yh.Emitter,this._onDidChange=new yh.Emitter,this._onDidSave=new yh.Emitter,this._onDidClose=new yh.Emitter}get cellTextDocuments(){return this._cellTextDocuments}getCellTextDocument(e){return this._cellTextDocuments.get(e.document)}getNotebookDocument(e){return this.notebookDocuments.get(e)}getNotebookCell(e){let r=this.notebookCellMap.get(e);return r&&r[0]}findNotebookDocumentForCell(e){let r=typeof e=="string"?e:e.document,n=this.notebookCellMap.get(r);return n&&n[1]}get onDidOpen(){return this._onDidOpen.event}get onDidSave(){return this._onDidSave.event}get onDidChange(){return this._onDidChange.event}get onDidClose(){return this._onDidClose.event}listen(e){let r=new _J,n=[];return n.push(this.cellTextDocuments.listen(r)),n.push(e.notebooks.synchronization.onDidOpenNotebookDocument(i=>{this.notebookDocuments.set(i.notebookDocument.uri,i.notebookDocument);for(let o of i.cellTextDocuments)r.openTextDocument({textDocument:o});this.updateCellMap(i.notebookDocument),this._onDidOpen.fire(i.notebookDocument)})),n.push(e.notebooks.synchronization.onDidChangeNotebookDocument(i=>{let o=this.notebookDocuments.get(i.notebookDocument.uri);if(o===void 0)return;o.version=i.notebookDocument.version;let a=o.metadata,c=!1,l=i.change;l.metadata!==void 0&&(c=!0,o.metadata=l.metadata);let u=[],f=[],p=[],m=[];if(l.cells!==void 0){let E=l.cells;if(E.structure!==void 0){let b=E.structure.array;if(o.cells.splice(b.start,b.deleteCount,...b.cells!==void 0?b.cells:[]),E.structure.didOpen!==void 0)for(let S of E.structure.didOpen)r.openTextDocument({textDocument:S}),u.push(S.uri);if(E.structure.didClose)for(let S of E.structure.didClose)r.closeTextDocument({textDocument:S}),f.push(S.uri)}if(E.data!==void 0){let b=new Map(E.data.map(S=>[S.document,S]));for(let S=0;S<=o.cells.length;S++){let R=b.get(o.cells[S].document);if(R!==void 0){let B=o.cells.splice(S,1,R);if(p.push({old:B[0],new:R}),b.delete(R.document),b.size===0)break}}}if(E.textContent!==void 0)for(let b of E.textContent)r.changeTextDocument({textDocument:b.document,contentChanges:b.changes}),m.push(b.document.uri)}this.updateCellMap(o);let h={notebookDocument:o};c&&(h.metadata={old:a,new:o.metadata});let g=[];for(let E of u)g.push(this.getNotebookCell(E));let A=[];for(let E of f)A.push(this.getNotebookCell(E));let y=[];for(let E of m)y.push(this.getNotebookCell(E));(g.length>0||A.length>0||p.length>0||y.length>0)&&(h.cells={added:g,removed:A,changed:{data:p,textContent:y}}),(h.metadata!==void 0||h.cells!==void 0)&&this._onDidChange.fire(h)})),n.push(e.notebooks.synchronization.onDidSaveNotebookDocument(i=>{let o=this.notebookDocuments.get(i.notebookDocument.uri);o!==void 0&&this._onDidSave.fire(o)})),n.push(e.notebooks.synchronization.onDidCloseNotebookDocument(i=>{let o=this.notebookDocuments.get(i.notebookDocument.uri);if(o!==void 0){this._onDidClose.fire(o);for(let a of i.cellTextDocuments)r.closeTextDocument({textDocument:a});this.notebookDocuments.delete(i.notebookDocument.uri);for(let a of o.cells)this.notebookCellMap.delete(a.document)}})),yh.Disposable.create(()=>{n.forEach(i=>i.dispose())})}updateCellMap(e){for(let r of e.cells)this.notebookCellMap.set(r.document,[r,e])}};JB.NotebookDocuments=A1e});var LGe=H(RJ=>{"use strict";d();Object.defineProperty(RJ,"__esModule",{value:!0});RJ.MonikerFeature=void 0;var G$t=hi(),V$t=s(t=>class extends t{get moniker(){return{on:s(e=>{let r=G$t.MonikerRequest.type;return this.connection.onRequest(r,(n,i)=>e(n,i,this.attachWorkDoneProgress(n),this.attachPartialResultProgress(r,n)))},"on")}}},"MonikerFeature");RJ.MonikerFeature=V$t});var I1e=H(jo=>{"use strict";d();Object.defineProperty(jo,"__esModule",{value:!0});jo.createConnection=jo.combineFeatures=jo.combineNotebooksFeatures=jo.combineLanguagesFeatures=jo.combineWorkspaceFeatures=jo.combineWindowFeatures=jo.combineClientFeatures=jo.combineTracerFeatures=jo.combineTelemetryFeatures=jo.combineConsoleFeatures=jo._NotebooksImpl=jo._LanguagesImpl=jo.BulkUnregistration=jo.BulkRegistration=jo.ErrorMessageTracker=void 0;var cr=hi(),Ch=uJ(),v1e=a1e(),pi=xGe(),z$t=EGe(),K$t=bGe(),Y$t=IGe(),J$t=f1e(),X$t=TGe(),Z$t=wGe(),eWt=SGe(),tWt=_Ge(),rWt=kGe(),nWt=DGe(),iWt=BGe(),oWt=NGe(),sWt=y1e(),aWt=LGe();function C1e(t){if(t!==null)return t}s(C1e,"null2Undefined");var x1e=class{static{s(this,"ErrorMessageTracker")}constructor(){this._messages=Object.create(null)}add(e){let r=this._messages[e];r||(r=0),r++,this._messages[e]=r}sendErrors(e){Object.keys(this._messages).forEach(r=>{e.window.showErrorMessage(r)})}};jo.ErrorMessageTracker=x1e;var kJ=class{static{s(this,"RemoteConsoleImpl")}constructor(){}rawAttach(e){this._rawConnection=e}attach(e){this._connection=e}get connection(){if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}fillServerCapabilities(e){}initialize(e){}error(e){this.send(cr.MessageType.Error,e)}warn(e){this.send(cr.MessageType.Warning,e)}info(e){this.send(cr.MessageType.Info,e)}log(e){this.send(cr.MessageType.Log,e)}debug(e){this.send(cr.MessageType.Debug,e)}send(e,r){this._rawConnection&&this._rawConnection.sendNotification(cr.LogMessageNotification.type,{type:e,message:r}).catch(()=>{(0,cr.RAL)().console.error("Sending log message failed")})}},E1e=class{static{s(this,"_RemoteWindowImpl")}constructor(){}attach(e){this._connection=e}get connection(){if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}initialize(e){}fillServerCapabilities(e){}showErrorMessage(e,...r){let n={type:cr.MessageType.Error,message:e,actions:r};return this.connection.sendRequest(cr.ShowMessageRequest.type,n).then(C1e)}showWarningMessage(e,...r){let n={type:cr.MessageType.Warning,message:e,actions:r};return this.connection.sendRequest(cr.ShowMessageRequest.type,n).then(C1e)}showInformationMessage(e,...r){let n={type:cr.MessageType.Info,message:e,actions:r};return this.connection.sendRequest(cr.ShowMessageRequest.type,n).then(C1e)}},FGe=(0,X$t.ShowDocumentFeature)((0,pi.ProgressFeature)(E1e)),OGe;(function(t){function e(){return new PJ}s(e,"create"),t.create=e})(OGe||(jo.BulkRegistration=OGe={}));var PJ=class{static{s(this,"BulkRegistrationImpl")}constructor(){this._registrations=[],this._registered=new Set}add(e,r){let n=Ch.string(e)?e:e.method;if(this._registered.has(n))throw new Error(`${n} is already added to this registration`);let i=v1e.generateUuid();this._registrations.push({id:i,method:n,registerOptions:r||{}}),this._registered.add(n)}asRegistrationParams(){return{registrations:this._registrations}}},QGe;(function(t){function e(){return new YO(void 0,[])}s(e,"create"),t.create=e})(QGe||(jo.BulkUnregistration=QGe={}));var YO=class{static{s(this,"BulkUnregistrationImpl")}constructor(e,r){this._connection=e,this._unregistrations=new Map,r.forEach(n=>{this._unregistrations.set(n.method,n)})}get isAttached(){return!!this._connection}attach(e){this._connection=e}add(e){this._unregistrations.set(e.method,e)}dispose(){let e=[];for(let n of this._unregistrations.values())e.push(n);let r={unregisterations:e};this._connection.sendRequest(cr.UnregistrationRequest.type,r).catch(()=>{this._connection.console.info("Bulk unregistration failed.")})}disposeSingle(e){let r=Ch.string(e)?e:e.method,n=this._unregistrations.get(r);if(!n)return!1;let i={unregisterations:[n]};return this._connection.sendRequest(cr.UnregistrationRequest.type,i).then(()=>{this._unregistrations.delete(r)},o=>{this._connection.console.info(`Un-registering request handler for ${n.id} failed.`)}),!0}},DJ=class{static{s(this,"RemoteClientImpl")}attach(e){this._connection=e}get connection(){if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}initialize(e){}fillServerCapabilities(e){}register(e,r,n){return e instanceof PJ?this.registerMany(e):e instanceof YO?this.registerSingle1(e,r,n):this.registerSingle2(e,r)}registerSingle1(e,r,n){let i=Ch.string(r)?r:r.method,o=v1e.generateUuid(),a={registrations:[{id:o,method:i,registerOptions:n||{}}]};return e.isAttached||e.attach(this.connection),this.connection.sendRequest(cr.RegistrationRequest.type,a).then(c=>(e.add({id:o,method:i}),e),c=>(this.connection.console.info(`Registering request handler for ${i} failed.`),Promise.reject(c)))}registerSingle2(e,r){let n=Ch.string(e)?e:e.method,i=v1e.generateUuid(),o={registrations:[{id:i,method:n,registerOptions:r||{}}]};return this.connection.sendRequest(cr.RegistrationRequest.type,o).then(a=>cr.Disposable.create(()=>{this.unregisterSingle(i,n).catch(()=>{this.connection.console.info(`Un-registering capability with id ${i} failed.`)})}),a=>(this.connection.console.info(`Registering request handler for ${n} failed.`),Promise.reject(a)))}unregisterSingle(e,r){let n={unregisterations:[{id:e,method:r}]};return this.connection.sendRequest(cr.UnregistrationRequest.type,n).catch(()=>{this.connection.console.info(`Un-registering request handler for ${e} failed.`)})}registerMany(e){let r=e.asRegistrationParams();return this.connection.sendRequest(cr.RegistrationRequest.type,r).then(()=>new YO(this._connection,r.registrations.map(n=>({id:n.id,method:n.method}))),n=>(this.connection.console.info("Bulk registration failed."),Promise.reject(n)))}},b1e=class{static{s(this,"_RemoteWorkspaceImpl")}constructor(){}attach(e){this._connection=e}get connection(){if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}initialize(e){}fillServerCapabilities(e){}applyEdit(e){function r(i){return i&&!!i.edit}s(r,"isApplyWorkspaceEditParams");let n=r(e)?e:{edit:e};return this.connection.sendRequest(cr.ApplyWorkspaceEditRequest.type,n)}},UGe=(0,Z$t.FileOperationsFeature)((0,K$t.WorkspaceFoldersFeature)((0,z$t.ConfigurationFeature)(b1e))),BJ=class{static{s(this,"TracerImpl")}constructor(){this._trace=cr.Trace.Off}attach(e){this._connection=e}get connection(){if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}initialize(e){}fillServerCapabilities(e){}set trace(e){this._trace=e}log(e,r){this._trace!==cr.Trace.Off&&this.connection.sendNotification(cr.LogTraceNotification.type,{message:e,verbose:this._trace===cr.Trace.Verbose?r:void 0}).catch(()=>{})}},NJ=class{static{s(this,"TelemetryImpl")}constructor(){}attach(e){this._connection=e}get connection(){if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}initialize(e){}fillServerCapabilities(e){}logEvent(e){this.connection.sendNotification(cr.TelemetryEventNotification.type,e).catch(()=>{this.connection.console.log("Sending TelemetryEventNotification failed")})}},MJ=class{static{s(this,"_LanguagesImpl")}constructor(){}attach(e){this._connection=e}get connection(){if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}initialize(e){}fillServerCapabilities(e){}attachWorkDoneProgress(e){return(0,pi.attachWorkDone)(this.connection,e)}attachPartialResultProgress(e,r){return(0,pi.attachPartialResult)(this.connection,r)}};jo._LanguagesImpl=MJ;var qGe=(0,nWt.FoldingRangeFeature)((0,aWt.MonikerFeature)((0,oWt.DiagnosticFeature)((0,iWt.InlayHintFeature)((0,rWt.InlineValueFeature)((0,tWt.TypeHierarchyFeature)((0,eWt.LinkedEditingRangeFeature)((0,J$t.SemanticTokensFeature)((0,Y$t.CallHierarchyFeature)(MJ))))))))),LJ=class{static{s(this,"_NotebooksImpl")}constructor(){}attach(e){this._connection=e}get connection(){if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}initialize(e){}fillServerCapabilities(e){}attachWorkDoneProgress(e){return(0,pi.attachWorkDone)(this.connection,e)}attachPartialResultProgress(e,r){return(0,pi.attachPartialResult)(this.connection,r)}};jo._NotebooksImpl=LJ;var HGe=(0,sWt.NotebookSyncFeature)(LJ);function $Ge(t,e){return function(r){return e(t(r))}}s($Ge,"combineConsoleFeatures");jo.combineConsoleFeatures=$Ge;function WGe(t,e){return function(r){return e(t(r))}}s(WGe,"combineTelemetryFeatures");jo.combineTelemetryFeatures=WGe;function jGe(t,e){return function(r){return e(t(r))}}s(jGe,"combineTracerFeatures");jo.combineTracerFeatures=jGe;function GGe(t,e){return function(r){return e(t(r))}}s(GGe,"combineClientFeatures");jo.combineClientFeatures=GGe;function VGe(t,e){return function(r){return e(t(r))}}s(VGe,"combineWindowFeatures");jo.combineWindowFeatures=VGe;function zGe(t,e){return function(r){return e(t(r))}}s(zGe,"combineWorkspaceFeatures");jo.combineWorkspaceFeatures=zGe;function KGe(t,e){return function(r){return e(t(r))}}s(KGe,"combineLanguagesFeatures");jo.combineLanguagesFeatures=KGe;function YGe(t,e){return function(r){return e(t(r))}}s(YGe,"combineNotebooksFeatures");jo.combineNotebooksFeatures=YGe;function cWt(t,e){function r(i,o,a){return i&&o?a(i,o):i||o}return s(r,"combine"),{__brand:"features",console:r(t.console,e.console,$Ge),tracer:r(t.tracer,e.tracer,jGe),telemetry:r(t.telemetry,e.telemetry,WGe),client:r(t.client,e.client,GGe),window:r(t.window,e.window,VGe),workspace:r(t.workspace,e.workspace,zGe),languages:r(t.languages,e.languages,KGe),notebooks:r(t.notebooks,e.notebooks,YGe)}}s(cWt,"combineFeatures");jo.combineFeatures=cWt;function lWt(t,e,r){let n=r&&r.console?new(r.console(kJ)):new kJ,i=t(n);n.rawAttach(i);let o=r&&r.tracer?new(r.tracer(BJ)):new BJ,a=r&&r.telemetry?new(r.telemetry(NJ)):new NJ,c=r&&r.client?new(r.client(DJ)):new DJ,l=r&&r.window?new(r.window(FGe)):new FGe,u=r&&r.workspace?new(r.workspace(UGe)):new UGe,f=r&&r.languages?new(r.languages(qGe)):new qGe,p=r&&r.notebooks?new(r.notebooks(HGe)):new HGe,m=[n,o,a,c,l,u,f,p];function h(b){return b instanceof Promise?b:Ch.thenable(b)?new Promise((S,R)=>{b.then(B=>S(B),B=>R(B))}):Promise.resolve(b)}s(h,"asPromise");let g,A,y,E={listen:s(()=>i.listen(),"listen"),sendRequest:s((b,...S)=>i.sendRequest(Ch.string(b)?b:b.method,...S),"sendRequest"),onRequest:s((b,S)=>i.onRequest(b,S),"onRequest"),sendNotification:s((b,S)=>{let R=Ch.string(b)?b:b.method;return i.sendNotification(R,S)},"sendNotification"),onNotification:s((b,S)=>i.onNotification(b,S),"onNotification"),onProgress:i.onProgress,sendProgress:i.sendProgress,onInitialize:s(b=>(A=b,{dispose:s(()=>{A=void 0},"dispose")}),"onInitialize"),onInitialized:s(b=>i.onNotification(cr.InitializedNotification.type,b),"onInitialized"),onShutdown:s(b=>(g=b,{dispose:s(()=>{g=void 0},"dispose")}),"onShutdown"),onExit:s(b=>(y=b,{dispose:s(()=>{y=void 0},"dispose")}),"onExit"),get console(){return n},get telemetry(){return a},get tracer(){return o},get client(){return c},get window(){return l},get workspace(){return u},get languages(){return f},get notebooks(){return p},onDidChangeConfiguration:s(b=>i.onNotification(cr.DidChangeConfigurationNotification.type,b),"onDidChangeConfiguration"),onDidChangeWatchedFiles:s(b=>i.onNotification(cr.DidChangeWatchedFilesNotification.type,b),"onDidChangeWatchedFiles"),__textDocumentSync:void 0,onDidOpenTextDocument:s(b=>i.onNotification(cr.DidOpenTextDocumentNotification.type,b),"onDidOpenTextDocument"),onDidChangeTextDocument:s(b=>i.onNotification(cr.DidChangeTextDocumentNotification.type,b),"onDidChangeTextDocument"),onDidCloseTextDocument:s(b=>i.onNotification(cr.DidCloseTextDocumentNotification.type,b),"onDidCloseTextDocument"),onWillSaveTextDocument:s(b=>i.onNotification(cr.WillSaveTextDocumentNotification.type,b),"onWillSaveTextDocument"),onWillSaveTextDocumentWaitUntil:s(b=>i.onRequest(cr.WillSaveTextDocumentWaitUntilRequest.type,b),"onWillSaveTextDocumentWaitUntil"),onDidSaveTextDocument:s(b=>i.onNotification(cr.DidSaveTextDocumentNotification.type,b),"onDidSaveTextDocument"),sendDiagnostics:s(b=>i.sendNotification(cr.PublishDiagnosticsNotification.type,b),"sendDiagnostics"),onHover:s(b=>i.onRequest(cr.HoverRequest.type,(S,R)=>b(S,R,(0,pi.attachWorkDone)(i,S),void 0)),"onHover"),onCompletion:s(b=>i.onRequest(cr.CompletionRequest.type,(S,R)=>b(S,R,(0,pi.attachWorkDone)(i,S),(0,pi.attachPartialResult)(i,S))),"onCompletion"),onCompletionResolve:s(b=>i.onRequest(cr.CompletionResolveRequest.type,b),"onCompletionResolve"),onSignatureHelp:s(b=>i.onRequest(cr.SignatureHelpRequest.type,(S,R)=>b(S,R,(0,pi.attachWorkDone)(i,S),void 0)),"onSignatureHelp"),onDeclaration:s(b=>i.onRequest(cr.DeclarationRequest.type,(S,R)=>b(S,R,(0,pi.attachWorkDone)(i,S),(0,pi.attachPartialResult)(i,S))),"onDeclaration"),onDefinition:s(b=>i.onRequest(cr.DefinitionRequest.type,(S,R)=>b(S,R,(0,pi.attachWorkDone)(i,S),(0,pi.attachPartialResult)(i,S))),"onDefinition"),onTypeDefinition:s(b=>i.onRequest(cr.TypeDefinitionRequest.type,(S,R)=>b(S,R,(0,pi.attachWorkDone)(i,S),(0,pi.attachPartialResult)(i,S))),"onTypeDefinition"),onImplementation:s(b=>i.onRequest(cr.ImplementationRequest.type,(S,R)=>b(S,R,(0,pi.attachWorkDone)(i,S),(0,pi.attachPartialResult)(i,S))),"onImplementation"),onReferences:s(b=>i.onRequest(cr.ReferencesRequest.type,(S,R)=>b(S,R,(0,pi.attachWorkDone)(i,S),(0,pi.attachPartialResult)(i,S))),"onReferences"),onDocumentHighlight:s(b=>i.onRequest(cr.DocumentHighlightRequest.type,(S,R)=>b(S,R,(0,pi.attachWorkDone)(i,S),(0,pi.attachPartialResult)(i,S))),"onDocumentHighlight"),onDocumentSymbol:s(b=>i.onRequest(cr.DocumentSymbolRequest.type,(S,R)=>b(S,R,(0,pi.attachWorkDone)(i,S),(0,pi.attachPartialResult)(i,S))),"onDocumentSymbol"),onWorkspaceSymbol:s(b=>i.onRequest(cr.WorkspaceSymbolRequest.type,(S,R)=>b(S,R,(0,pi.attachWorkDone)(i,S),(0,pi.attachPartialResult)(i,S))),"onWorkspaceSymbol"),onWorkspaceSymbolResolve:s(b=>i.onRequest(cr.WorkspaceSymbolResolveRequest.type,b),"onWorkspaceSymbolResolve"),onCodeAction:s(b=>i.onRequest(cr.CodeActionRequest.type,(S,R)=>b(S,R,(0,pi.attachWorkDone)(i,S),(0,pi.attachPartialResult)(i,S))),"onCodeAction"),onCodeActionResolve:s(b=>i.onRequest(cr.CodeActionResolveRequest.type,(S,R)=>b(S,R)),"onCodeActionResolve"),onCodeLens:s(b=>i.onRequest(cr.CodeLensRequest.type,(S,R)=>b(S,R,(0,pi.attachWorkDone)(i,S),(0,pi.attachPartialResult)(i,S))),"onCodeLens"),onCodeLensResolve:s(b=>i.onRequest(cr.CodeLensResolveRequest.type,(S,R)=>b(S,R)),"onCodeLensResolve"),onDocumentFormatting:s(b=>i.onRequest(cr.DocumentFormattingRequest.type,(S,R)=>b(S,R,(0,pi.attachWorkDone)(i,S),void 0)),"onDocumentFormatting"),onDocumentRangeFormatting:s(b=>i.onRequest(cr.DocumentRangeFormattingRequest.type,(S,R)=>b(S,R,(0,pi.attachWorkDone)(i,S),void 0)),"onDocumentRangeFormatting"),onDocumentOnTypeFormatting:s(b=>i.onRequest(cr.DocumentOnTypeFormattingRequest.type,(S,R)=>b(S,R)),"onDocumentOnTypeFormatting"),onRenameRequest:s(b=>i.onRequest(cr.RenameRequest.type,(S,R)=>b(S,R,(0,pi.attachWorkDone)(i,S),void 0)),"onRenameRequest"),onPrepareRename:s(b=>i.onRequest(cr.PrepareRenameRequest.type,(S,R)=>b(S,R)),"onPrepareRename"),onDocumentLinks:s(b=>i.onRequest(cr.DocumentLinkRequest.type,(S,R)=>b(S,R,(0,pi.attachWorkDone)(i,S),(0,pi.attachPartialResult)(i,S))),"onDocumentLinks"),onDocumentLinkResolve:s(b=>i.onRequest(cr.DocumentLinkResolveRequest.type,(S,R)=>b(S,R)),"onDocumentLinkResolve"),onDocumentColor:s(b=>i.onRequest(cr.DocumentColorRequest.type,(S,R)=>b(S,R,(0,pi.attachWorkDone)(i,S),(0,pi.attachPartialResult)(i,S))),"onDocumentColor"),onColorPresentation:s(b=>i.onRequest(cr.ColorPresentationRequest.type,(S,R)=>b(S,R,(0,pi.attachWorkDone)(i,S),(0,pi.attachPartialResult)(i,S))),"onColorPresentation"),onFoldingRanges:s(b=>i.onRequest(cr.FoldingRangeRequest.type,(S,R)=>b(S,R,(0,pi.attachWorkDone)(i,S),(0,pi.attachPartialResult)(i,S))),"onFoldingRanges"),onSelectionRanges:s(b=>i.onRequest(cr.SelectionRangeRequest.type,(S,R)=>b(S,R,(0,pi.attachWorkDone)(i,S),(0,pi.attachPartialResult)(i,S))),"onSelectionRanges"),onExecuteCommand:s(b=>i.onRequest(cr.ExecuteCommandRequest.type,(S,R)=>b(S,R,(0,pi.attachWorkDone)(i,S),void 0)),"onExecuteCommand"),dispose:s(()=>i.dispose(),"dispose")};for(let b of m)b.attach(E);return i.onRequest(cr.InitializeRequest.type,b=>{e.initialize(b),Ch.string(b.trace)&&(o.trace=cr.Trace.fromString(b.trace));for(let S of m)S.initialize(b.capabilities);if(A){let S=A(b,new cr.CancellationTokenSource().token,(0,pi.attachWorkDone)(i,b),void 0);return h(S).then(R=>{if(R instanceof cr.ResponseError)return R;let B=R;B||(B={capabilities:{}});let L=B.capabilities;L||(L={},B.capabilities=L),L.textDocumentSync===void 0||L.textDocumentSync===null?L.textDocumentSync=Ch.number(E.__textDocumentSync)?E.__textDocumentSync:cr.TextDocumentSyncKind.None:!Ch.number(L.textDocumentSync)&&!Ch.number(L.textDocumentSync.change)&&(L.textDocumentSync.change=Ch.number(E.__textDocumentSync)?E.__textDocumentSync:cr.TextDocumentSyncKind.None);for(let O of m)O.fillServerCapabilities(L);return B})}else{let S={capabilities:{textDocumentSync:cr.TextDocumentSyncKind.None}};for(let R of m)R.fillServerCapabilities(S.capabilities);return S}}),i.onRequest(cr.ShutdownRequest.type,()=>{if(e.shutdownReceived=!0,g)return g(new cr.CancellationTokenSource().token)}),i.onNotification(cr.ExitNotification.type,()=>{try{y&&y()}finally{e.shutdownReceived?e.exit(0):e.exit(1)}}),i.onNotification(cr.SetTraceNotification.type,b=>{o.trace=cr.Trace.fromString(b.value)}),E}s(lWt,"createConnection");jo.createConnection=lWt});var JGe=H(wp=>{"use strict";d();Object.defineProperty(wp,"__esModule",{value:!0});wp.resolveModulePath=wp.FileSystem=wp.resolveGlobalYarnPath=wp.resolveGlobalNodePath=wp.resolve=wp.uriToFilePath=void 0;var uWt=require("url"),TA=require("path"),T1e=require("fs"),R1e=require("child_process");function dWt(t){let e=uWt.parse(t);if(e.protocol!=="file:"||!e.path)return;let r=e.path.split("/");for(var n=0,i=r.length;n<i;n++)r[n]=decodeURIComponent(r[n]);if(process.platform==="win32"&&r.length>1){let o=r[0],a=r[1];o.length===0&&a.length>1&&a[1]===":"&&r.shift()}return TA.normalize(r.join("/"))}s(dWt,"uriToFilePath");wp.uriToFilePath=dWt;function w1e(){return process.platform==="win32"}s(w1e,"isWindows");function FJ(t,e,r,n){let i="NODE_PATH",o=["var p = process;","p.on('message',function(m){","if(m.c==='e'){","p.exit(0);","}","else if(m.c==='rs'){","try{","var r=require.resolve(m.a);","p.send({c:'r',s:true,r:r});","}","catch(err){","p.send({c:'r',s:false});","}","}","});"].join("");return new Promise((a,c)=>{let l=process.env,u=Object.create(null);Object.keys(l).forEach(f=>u[f]=l[f]),e&&T1e.existsSync(e)&&(u[i]?u[i]=e+TA.delimiter+u[i]:u[i]=e,n&&n(`NODE_PATH value is: ${u[i]}`)),u.ELECTRON_RUN_AS_NODE="1";try{let f=(0,R1e.fork)("",[],{cwd:r,env:u,execArgv:["-e",o]});if(f.pid===void 0){c(new Error(`Starting process to resolve node module  ${t} failed`));return}f.on("error",m=>{c(m)}),f.on("message",m=>{m.c==="r"&&(f.send({c:"e"}),m.s?a(m.r):c(new Error(`Failed to resolve module: ${t}`)))});let p={c:"rs",a:t};f.send(p)}catch(f){c(f)}})}s(FJ,"resolve");wp.resolve=FJ;function S1e(t){let e="npm",r=Object.create(null);Object.keys(process.env).forEach(o=>r[o]=process.env[o]),r.NO_UPDATE_NOTIFIER="true";let n={encoding:"utf8",env:r};w1e()&&(e="npm.cmd",n.shell=!0);let i=s(()=>{},"handler");try{process.on("SIGPIPE",i);let o=(0,R1e.spawnSync)(e,["config","get","prefix"],n).stdout;if(!o){t&&t("'npm config get prefix' didn't return a value.");return}let a=o.trim();return t&&t(`'npm config get prefix' value is: ${a}`),a.length>0?w1e()?TA.join(a,"node_modules"):TA.join(a,"lib","node_modules"):void 0}catch{return}finally{process.removeListener("SIGPIPE",i)}}s(S1e,"resolveGlobalNodePath");wp.resolveGlobalNodePath=S1e;function fWt(t){let e="yarn",r={encoding:"utf8"};w1e()&&(e="yarn.cmd",r.shell=!0);let n=s(()=>{},"handler");try{process.on("SIGPIPE",n);let i=(0,R1e.spawnSync)(e,["global","dir","--json"],r),o=i.stdout;if(!o){t&&(t("'yarn global dir' didn't return a value."),i.stderr&&t(i.stderr));return}let a=o.trim().split(/\r?\n/);for(let c of a)try{let l=JSON.parse(c);if(l.type==="log")return TA.join(l.data,"node_modules")}catch{}return}catch{return}finally{process.removeListener("SIGPIPE",n)}}s(fWt,"resolveGlobalYarnPath");wp.resolveGlobalYarnPath=fWt;var _1e;(function(t){let e;function r(){return e!==void 0||(process.platform==="win32"?e=!1:e=!T1e.existsSync(__filename.toUpperCase())||!T1e.existsSync(__filename.toLowerCase())),e}s(r,"isCaseSensitive"),t.isCaseSensitive=r;function n(i,o){return r()?TA.normalize(o).indexOf(TA.normalize(i))===0:TA.normalize(o).toLowerCase().indexOf(TA.normalize(i).toLowerCase())===0}s(n,"isParent"),t.isParent=n})(_1e||(wp.FileSystem=_1e={}));function pWt(t,e,r,n){return r?(TA.isAbsolute(r)||(r=TA.join(t,r)),FJ(e,r,r,n).then(i=>_1e.isParent(r,i)?i:Promise.reject(new Error(`Failed to load ${e} from node path location.`))).then(void 0,i=>FJ(e,S1e(n),t,n))):FJ(e,S1e(n),t,n)}s(pWt,"resolveModulePath");wp.resolveModulePath=pWt});var k1e=H((a6n,XGe)=>{"use strict";d();XGe.exports=hi()});var ZGe=H(OJ=>{"use strict";d();Object.defineProperty(OJ,"__esModule",{value:!0});OJ.InlineCompletionFeature=void 0;var mWt=hi(),hWt=s(t=>class extends t{get inlineCompletion(){return{on:s(e=>this.connection.onRequest(mWt.InlineCompletionRequest.type,(r,n)=>e(r,n,this.attachWorkDoneProgress(r))),"on")}}},"InlineCompletionFeature");OJ.InlineCompletionFeature=hWt});var rVe=H(qd=>{"use strict";d();var gWt=qd&&qd.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:s(function(){return e[r]},"get")}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),tVe=qd&&qd.__exportStar||function(t,e){for(var r in t)r!=="default"&&!Object.prototype.hasOwnProperty.call(e,r)&&gWt(e,t,r)};Object.defineProperty(qd,"__esModule",{value:!0});qd.ProposedFeatures=qd.NotebookDocuments=qd.TextDocuments=qd.SemanticTokensBuilder=void 0;var AWt=f1e();Object.defineProperty(qd,"SemanticTokensBuilder",{enumerable:!0,get:s(function(){return AWt.SemanticTokensBuilder},"get")});var yWt=ZGe();tVe(hi(),qd);var CWt=g1e();Object.defineProperty(qd,"TextDocuments",{enumerable:!0,get:s(function(){return CWt.TextDocuments},"get")});var vWt=y1e();Object.defineProperty(qd,"NotebookDocuments",{enumerable:!0,get:s(function(){return vWt.NotebookDocuments},"get")});tVe(I1e(),qd);var eVe;(function(t){t.all={__brand:"features",languages:yWt.InlineCompletionFeature}})(eVe||(qd.ProposedFeatures=eVe={}))});var ul=H(vh=>{"use strict";d();var xWt=vh&&vh.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:s(function(){return e[r]},"get")}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),sVe=vh&&vh.__exportStar||function(t,e){for(var r in t)r!=="default"&&!Object.prototype.hasOwnProperty.call(e,r)&&xWt(e,t,r)};Object.defineProperty(vh,"__esModule",{value:!0});vh.createConnection=vh.Files=void 0;var nVe=require("node:util"),P1e=uJ(),EWt=I1e(),JO=JGe(),xR=k1e();sVe(k1e(),vh);sVe(rVe(),vh);var iVe;(function(t){t.uriToFilePath=JO.uriToFilePath,t.resolveGlobalNodePath=JO.resolveGlobalNodePath,t.resolveGlobalYarnPath=JO.resolveGlobalYarnPath,t.resolve=JO.resolve,t.resolveModulePath=JO.resolveModulePath})(iVe||(vh.Files=iVe={}));var oVe;function QJ(){if(oVe!==void 0)try{oVe.end()}catch{}}s(QJ,"endProtocolConnection");var XB=!1,aVe;function bWt(){let t="--clientProcessId";function e(r){try{let n=parseInt(r);isNaN(n)||(aVe=setInterval(()=>{try{process.kill(n,0)}catch{QJ(),process.exit(XB?0:1)}},3e3))}catch{}}s(e,"runTimer");for(let r=2;r<process.argv.length;r++){let n=process.argv[r];if(n===t&&r+1<process.argv.length){e(process.argv[r+1]);return}else{let i=n.split("=");i[0]===t&&e(i[1])}}}s(bWt,"setupExitTimer");bWt();var IWt={initialize:s(t=>{let e=t.processId;P1e.number(e)&&aVe===void 0&&setInterval(()=>{try{process.kill(e,0)}catch{process.exit(XB?0:1)}},3e3)},"initialize"),get shutdownReceived(){return XB},set shutdownReceived(t){XB=t},exit:s(t=>{QJ(),process.exit(t)},"exit")};function TWt(t,e,r,n){let i,o,a,c;return t!==void 0&&t.__brand==="features"&&(i=t,t=e,e=r,r=n),xR.ConnectionStrategy.is(t)||xR.ConnectionOptions.is(t)?c=t:(o=t,a=e,c=r),wWt(o,a,c,i)}s(TWt,"createConnection");vh.createConnection=TWt;function wWt(t,e,r,n){let i=!1;if(!t&&!e&&process.argv.length>2){let l,u,f=process.argv.slice(2);for(let p=0;p<f.length;p++){let m=f[p];if(m==="--node-ipc"){t=new xR.IPCMessageReader(process),e=new xR.IPCMessageWriter(process);break}else if(m==="--stdio"){i=!0,t=process.stdin,e=process.stdout;break}else if(m==="--socket"){l=parseInt(f[p+1]);break}else if(m==="--pipe"){u=f[p+1];break}else{var o=m.split("=");if(o[0]==="--socket"){l=parseInt(o[1]);break}else if(o[0]==="--pipe"){u=o[1];break}}}if(l){let p=(0,xR.createServerSocketTransport)(l);t=p[0],e=p[1]}else if(u){let p=(0,xR.createServerPipeTransport)(u);t=p[0],e=p[1]}}var a="Use arguments of createConnection or set command line parameters: '--node-ipc', '--stdio' or '--socket={number}'";if(!t)throw new Error("Connection input stream is not set. "+a);if(!e)throw new Error("Connection output stream is not set. "+a);if(P1e.func(t.read)&&P1e.func(t.on)){let l=t;l.on("end",()=>{QJ(),process.exit(XB?0:1)}),l.on("close",()=>{QJ(),process.exit(XB?0:1)})}let c=s(l=>{let u=(0,xR.createProtocolConnection)(t,e,l,r);return i&&SWt(l),u},"connectionFactory");return(0,EWt.createConnection)(c,IWt,n)}s(wWt,"_createConnection");function SWt(t){function e(n){return n.map(i=>typeof i=="string"?i:(0,nVe.inspect)(i)).join(" ")}s(e,"serialize");let r=new Map;console.assert=s(function(i,...o){if(!i)if(o.length===0)t.error("Assertion failed");else{let[a,...c]=o;t.error(`Assertion failed: ${a} ${e(c)}`)}},"assert"),console.count=s(function(i="default"){let o=String(i),a=r.get(o)??0;a+=1,r.set(o,a),t.log(`${o}: ${o}`)},"count"),console.countReset=s(function(i){i===void 0?r.clear():r.delete(String(i))},"countReset"),console.debug=s(function(...i){t.log(e(i))},"debug"),console.dir=s(function(i,o){t.log((0,nVe.inspect)(i,o))},"dir"),console.log=s(function(...i){t.log(e(i))},"log"),console.error=s(function(...i){t.error(e(i))},"error"),console.trace=s(function(...i){let o=new Error().stack.replace(/(.+\n){2}/,""),a="Trace";i.length!==0&&(a+=`: ${e(i)}`),t.log(`${a}
${o}`)},"trace"),console.warn=s(function(...i){t.warn(e(i))},"warn")}s(SWt,"patchConsole")});var wA=H((C6n,cVe)=>{"use strict";d();cVe.exports=ul()});var pYe=H((FHn,fYe)=>{"use strict";d();fYe.exports=uYe;function uYe(t,e,r){t instanceof RegExp&&(t=lYe(t,r)),e instanceof RegExp&&(e=lYe(e,r));var n=dYe(t,e,r);return n&&{start:n[0],end:n[1],pre:r.slice(0,n[0]),body:r.slice(n[0]+t.length,n[1]),post:r.slice(n[1]+e.length)}}s(uYe,"balanced");function lYe(t,e){var r=e.match(t);return r?r[0]:null}s(lYe,"maybeMatch");uYe.range=dYe;function dYe(t,e,r){var n,i,o,a,c,l=r.indexOf(t),u=r.indexOf(e,l+1),f=l;if(l>=0&&u>0){if(t===e)return[l,u];for(n=[],o=r.length;f>=0&&!c;)f==l?(n.push(f),l=r.indexOf(t,f+1)):n.length==1?c=[n.pop(),u]:(i=n.pop(),i<o&&(o=i,a=u),u=r.indexOf(e,f+1)),f=l<u&&l>=0?l:u;n.length&&(c=[o,a])}return c}s(dYe,"range")});var xYe=H((UHn,vYe)=>{d();var mYe=pYe();vYe.exports=bjt;var hYe="\0SLASH"+Math.random()+"\0",gYe="\0OPEN"+Math.random()+"\0",Wve="\0CLOSE"+Math.random()+"\0",AYe="\0COMMA"+Math.random()+"\0",yYe="\0PERIOD"+Math.random()+"\0";function $ve(t){return parseInt(t,10)==t?parseInt(t,10):t.charCodeAt(0)}s($ve,"numeric");function xjt(t){return t.split("\\\\").join(hYe).split("\\{").join(gYe).split("\\}").join(Wve).split("\\,").join(AYe).split("\\.").join(yYe)}s(xjt,"escapeBraces");function Ejt(t){return t.split(hYe).join("\\").split(gYe).join("{").split(Wve).join("}").split(AYe).join(",").split(yYe).join(".")}s(Ejt,"unescapeBraces");function CYe(t){if(!t)return[""];var e=[],r=mYe("{","}",t);if(!r)return t.split(",");var n=r.pre,i=r.body,o=r.post,a=n.split(",");a[a.length-1]+="{"+i+"}";var c=CYe(o);return o.length&&(a[a.length-1]+=c.shift(),a.push.apply(a,c)),e.push.apply(e,a),e}s(CYe,"parseCommaParts");function bjt(t){return t?(t.substr(0,2)==="{}"&&(t="\\{\\}"+t.substr(2)),u7(xjt(t),!0).map(Ejt)):[]}s(bjt,"expandTop");function Ijt(t){return"{"+t+"}"}s(Ijt,"embrace");function Tjt(t){return/^-?0\d/.test(t)}s(Tjt,"isPadded");function wjt(t,e){return t<=e}s(wjt,"lte");function Sjt(t,e){return t>=e}s(Sjt,"gte");function u7(t,e){var r=[],n=mYe("{","}",t);if(!n)return[t];var i=n.pre,o=n.post.length?u7(n.post,!1):[""];if(/\$$/.test(n.pre))for(var a=0;a<o.length;a++){var c=i+"{"+n.body+"}"+o[a];r.push(c)}else{var l=/^-?\d+\.\.-?\d+(?:\.\.-?\d+)?$/.test(n.body),u=/^[a-zA-Z]\.\.[a-zA-Z](?:\.\.-?\d+)?$/.test(n.body),f=l||u,p=n.body.indexOf(",")>=0;if(!f&&!p)return n.post.match(/,(?!,).*\}/)?(t=n.pre+"{"+n.body+Wve+n.post,u7(t)):[t];var m;if(f)m=n.body.split(/\.\./);else if(m=CYe(n.body),m.length===1&&(m=u7(m[0],!1).map(Ijt),m.length===1))return o.map(function(z){return n.pre+m[0]+z});var h;if(f){var g=$ve(m[0]),A=$ve(m[1]),y=Math.max(m[0].length,m[1].length),E=m.length==3?Math.abs($ve(m[2])):1,b=wjt,S=A<g;S&&(E*=-1,b=Sjt);var R=m.some(Tjt);h=[];for(var B=g;b(B,A);B+=E){var L;if(u)L=String.fromCharCode(B),L==="\\"&&(L="");else if(L=String(B),R){var O=y-L.length;if(O>0){var Y=new Array(O+1).join("0");B<0?L="-"+Y+L.slice(1):L=Y+L}}h.push(L)}}else{h=[];for(var V=0;V<m.length;V++)h.push.apply(h,u7(m[V],!1))}for(var V=0;V<h.length;V++)for(var a=0;a<o.length;a++){var c=i+h[V]+o[a];(!e||f||c)&&r.push(c)}}return r}s(u7,"expand")});var La=H((ffi,LZe)=>{d();LZe.exports={kClose:Symbol("close"),kDestroy:Symbol("destroy"),kDispatch:Symbol("dispatch"),kUrl:Symbol("url"),kWriting:Symbol("writing"),kResuming:Symbol("resuming"),kQueue:Symbol("queue"),kConnect:Symbol("connect"),kConnecting:Symbol("connecting"),kKeepAliveDefaultTimeout:Symbol("default keep alive timeout"),kKeepAliveMaxTimeout:Symbol("max keep alive timeout"),kKeepAliveTimeoutThreshold:Symbol("keep alive timeout threshold"),kKeepAliveTimeoutValue:Symbol("keep alive timeout"),kKeepAlive:Symbol("keep alive"),kHeadersTimeout:Symbol("headers timeout"),kBodyTimeout:Symbol("body timeout"),kServerName:Symbol("server name"),kLocalAddress:Symbol("local address"),kHost:Symbol("host"),kNoRef:Symbol("no ref"),kBodyUsed:Symbol("used"),kBody:Symbol("abstracted request body"),kRunning:Symbol("running"),kBlocking:Symbol("blocking"),kPending:Symbol("pending"),kSize:Symbol("size"),kBusy:Symbol("busy"),kQueued:Symbol("queued"),kFree:Symbol("free"),kConnected:Symbol("connected"),kClosed:Symbol("closed"),kNeedDrain:Symbol("need drain"),kReset:Symbol("reset"),kDestroyed:Symbol.for("nodejs.stream.destroyed"),kResume:Symbol("resume"),kOnError:Symbol("on error"),kMaxHeadersSize:Symbol("max headers size"),kRunningIdx:Symbol("running index"),kPendingIdx:Symbol("pending index"),kError:Symbol("error"),kClients:Symbol("clients"),kClient:Symbol("client"),kParser:Symbol("parser"),kOnDestroyed:Symbol("destroy callbacks"),kPipelining:Symbol("pipelining"),kSocket:Symbol("socket"),kHostHeader:Symbol("host header"),kConnector:Symbol("connector"),kStrictContentLength:Symbol("strict content length"),kMaxRedirections:Symbol("maxRedirections"),kMaxRequests:Symbol("maxRequestsPerClient"),kProxy:Symbol("proxy agent options"),kCounter:Symbol("socket request counter"),kInterceptors:Symbol("dispatch interceptors"),kMaxResponseSize:Symbol("max response size"),kHTTP2Session:Symbol("http2Session"),kHTTP2SessionState:Symbol("http2Session state"),kRetryHandlerDefaultRetry:Symbol("retry agent default retry"),kConstruct:Symbol("constructable"),kListeners:Symbol("listeners"),kHTTPContext:Symbol("http context"),kMaxConcurrentStreams:Symbol("max concurrent streams"),kNoProxyAgent:Symbol("no proxy agent"),kHttpProxyAgent:Symbol("http proxy agent"),kHttpsProxyAgent:Symbol("https proxy agent")}});var Jo=H((mfi,FZe)=>{"use strict";d();var tc=class extends Error{static{s(this,"UndiciError")}constructor(e){super(e),this.name="UndiciError",this.code="UND_ERR"}},xEe=class extends tc{static{s(this,"ConnectTimeoutError")}constructor(e){super(e),this.name="ConnectTimeoutError",this.message=e||"Connect Timeout Error",this.code="UND_ERR_CONNECT_TIMEOUT"}},EEe=class extends tc{static{s(this,"HeadersTimeoutError")}constructor(e){super(e),this.name="HeadersTimeoutError",this.message=e||"Headers Timeout Error",this.code="UND_ERR_HEADERS_TIMEOUT"}},bEe=class extends tc{static{s(this,"HeadersOverflowError")}constructor(e){super(e),this.name="HeadersOverflowError",this.message=e||"Headers Overflow Error",this.code="UND_ERR_HEADERS_OVERFLOW"}},IEe=class extends tc{static{s(this,"BodyTimeoutError")}constructor(e){super(e),this.name="BodyTimeoutError",this.message=e||"Body Timeout Error",this.code="UND_ERR_BODY_TIMEOUT"}},TEe=class extends tc{static{s(this,"ResponseStatusCodeError")}constructor(e,r,n,i){super(e),this.name="ResponseStatusCodeError",this.message=e||"Response Status Code Error",this.code="UND_ERR_RESPONSE_STATUS_CODE",this.body=i,this.status=r,this.statusCode=r,this.headers=n}},wEe=class extends tc{static{s(this,"InvalidArgumentError")}constructor(e){super(e),this.name="InvalidArgumentError",this.message=e||"Invalid Argument Error",this.code="UND_ERR_INVALID_ARG"}},SEe=class extends tc{static{s(this,"InvalidReturnValueError")}constructor(e){super(e),this.name="InvalidReturnValueError",this.message=e||"Invalid Return Value Error",this.code="UND_ERR_INVALID_RETURN_VALUE"}},Ree=class extends tc{static{s(this,"AbortError")}constructor(e){super(e),this.name="AbortError",this.message=e||"The operation was aborted"}},_Ee=class extends Ree{static{s(this,"RequestAbortedError")}constructor(e){super(e),this.name="AbortError",this.message=e||"Request aborted",this.code="UND_ERR_ABORTED"}},REe=class extends tc{static{s(this,"InformationalError")}constructor(e){super(e),this.name="InformationalError",this.message=e||"Request information",this.code="UND_ERR_INFO"}},kEe=class extends tc{static{s(this,"RequestContentLengthMismatchError")}constructor(e){super(e),this.name="RequestContentLengthMismatchError",this.message=e||"Request body length does not match content-length header",this.code="UND_ERR_REQ_CONTENT_LENGTH_MISMATCH"}},PEe=class extends tc{static{s(this,"ResponseContentLengthMismatchError")}constructor(e){super(e),this.name="ResponseContentLengthMismatchError",this.message=e||"Response body length does not match content-length header",this.code="UND_ERR_RES_CONTENT_LENGTH_MISMATCH"}},DEe=class extends tc{static{s(this,"ClientDestroyedError")}constructor(e){super(e),this.name="ClientDestroyedError",this.message=e||"The client is destroyed",this.code="UND_ERR_DESTROYED"}},BEe=class extends tc{static{s(this,"ClientClosedError")}constructor(e){super(e),this.name="ClientClosedError",this.message=e||"The client is closed",this.code="UND_ERR_CLOSED"}},NEe=class extends tc{static{s(this,"SocketError")}constructor(e,r){super(e),this.name="SocketError",this.message=e||"Socket error",this.code="UND_ERR_SOCKET",this.socket=r}},MEe=class extends tc{static{s(this,"NotSupportedError")}constructor(e){super(e),this.name="NotSupportedError",this.message=e||"Not supported error",this.code="UND_ERR_NOT_SUPPORTED"}},LEe=class extends tc{static{s(this,"BalancedPoolMissingUpstreamError")}constructor(e){super(e),this.name="MissingUpstreamError",this.message=e||"No upstream has been added to the BalancedPool",this.code="UND_ERR_BPL_MISSING_UPSTREAM"}},FEe=class extends Error{static{s(this,"HTTPParserError")}constructor(e,r,n){super(e),this.name="HTTPParserError",this.code=r?`HPE_${r}`:void 0,this.data=n?n.toString():void 0}},OEe=class extends tc{static{s(this,"ResponseExceededMaxSizeError")}constructor(e){super(e),this.name="ResponseExceededMaxSizeError",this.message=e||"Response content exceeded max size",this.code="UND_ERR_RES_EXCEEDED_MAX_SIZE"}},QEe=class extends tc{static{s(this,"RequestRetryError")}constructor(e,r,{headers:n,data:i}){super(e),this.name="RequestRetryError",this.message=e||"Request retry error",this.code="UND_ERR_REQ_RETRY",this.statusCode=r,this.data=i,this.headers=n}},UEe=class extends tc{static{s(this,"ResponseError")}constructor(e,r,{headers:n,data:i}){super(e),this.name="ResponseError",this.message=e||"Response error",this.code="UND_ERR_RESPONSE",this.statusCode=r,this.data=i,this.headers=n}},qEe=class extends tc{static{s(this,"SecureProxyConnectionError")}constructor(e,r,n){super(r,{cause:e,...n??{}}),this.name="SecureProxyConnectionError",this.message=r||"Secure Proxy Connection failed",this.code="UND_ERR_PRX_TLS",this.cause=e}};FZe.exports={AbortError:Ree,HTTPParserError:FEe,UndiciError:tc,HeadersTimeoutError:EEe,HeadersOverflowError:bEe,BodyTimeoutError:IEe,RequestContentLengthMismatchError:kEe,ConnectTimeoutError:xEe,ResponseStatusCodeError:TEe,InvalidArgumentError:wEe,InvalidReturnValueError:SEe,RequestAbortedError:_Ee,ClientDestroyedError:DEe,ClientClosedError:BEe,InformationalError:REe,SocketError:NEe,NotSupportedError:MEe,ResponseContentLengthMismatchError:PEe,BalancedPoolMissingUpstreamError:LEe,ResponseExceededMaxSizeError:OEe,RequestRetryError:QEe,ResponseError:UEe,SecureProxyConnectionError:qEe}});var Pee=H((Afi,OZe)=>{"use strict";d();var kee={},HEe=["Accept","Accept-Encoding","Accept-Language","Accept-Ranges","Access-Control-Allow-Credentials","Access-Control-Allow-Headers","Access-Control-Allow-Methods","Access-Control-Allow-Origin","Access-Control-Expose-Headers","Access-Control-Max-Age","Access-Control-Request-Headers","Access-Control-Request-Method","Age","Allow","Alt-Svc","Alt-Used","Authorization","Cache-Control","Clear-Site-Data","Connection","Content-Disposition","Content-Encoding","Content-Language","Content-Length","Content-Location","Content-Range","Content-Security-Policy","Content-Security-Policy-Report-Only","Content-Type","Cookie","Cross-Origin-Embedder-Policy","Cross-Origin-Opener-Policy","Cross-Origin-Resource-Policy","Date","Device-Memory","Downlink","ECT","ETag","Expect","Expect-CT","Expires","Forwarded","From","Host","If-Match","If-Modified-Since","If-None-Match","If-Range","If-Unmodified-Since","Keep-Alive","Last-Modified","Link","Location","Max-Forwards","Origin","Permissions-Policy","Pragma","Proxy-Authenticate","Proxy-Authorization","RTT","Range","Referer","Referrer-Policy","Refresh","Retry-After","Sec-WebSocket-Accept","Sec-WebSocket-Extensions","Sec-WebSocket-Key","Sec-WebSocket-Protocol","Sec-WebSocket-Version","Server","Server-Timing","Service-Worker-Allowed","Service-Worker-Navigation-Preload","Set-Cookie","SourceMap","Strict-Transport-Security","Supports-Loading-Mode","TE","Timing-Allow-Origin","Trailer","Transfer-Encoding","Upgrade","Upgrade-Insecure-Requests","User-Agent","Vary","Via","WWW-Authenticate","X-Content-Type-Options","X-DNS-Prefetch-Control","X-Frame-Options","X-Permitted-Cross-Domain-Policies","X-Powered-By","X-Requested-With","X-XSS-Protection"];for(let t=0;t<HEe.length;++t){let e=HEe[t],r=e.toLowerCase();kee[e]=kee[r]=r}Object.setPrototypeOf(kee,null);OZe.exports={wellknownHeaderNames:HEe,headerNameLowerCasedRecord:kee}});var HZe=H((Cfi,qZe)=>{"use strict";d();var{wellknownHeaderNames:QZe,headerNameLowerCasedRecord:LKt}=Pee(),$Ee=class t{static{s(this,"TstNode")}value=null;left=null;middle=null;right=null;code;constructor(e,r,n){if(n===void 0||n>=e.length)throw new TypeError("Unreachable");if((this.code=e.charCodeAt(n))>127)throw new TypeError("key must be ascii string");e.length!==++n?this.middle=new t(e,r,n):this.value=r}add(e,r){let n=e.length;if(n===0)throw new TypeError("Unreachable");let i=0,o=this;for(;;){let a=e.charCodeAt(i);if(a>127)throw new TypeError("key must be ascii string");if(o.code===a)if(n===++i){o.value=r;break}else if(o.middle!==null)o=o.middle;else{o.middle=new t(e,r,i);break}else if(o.code<a)if(o.left!==null)o=o.left;else{o.left=new t(e,r,i);break}else if(o.right!==null)o=o.right;else{o.right=new t(e,r,i);break}}}search(e){let r=e.length,n=0,i=this;for(;i!==null&&n<r;){let o=e[n];for(o<=90&&o>=65&&(o|=32);i!==null;){if(o===i.code){if(r===++n)return i;i=i.middle;break}i=i.code<o?i.left:i.right}}return null}},Dee=class{static{s(this,"TernarySearchTree")}node=null;insert(e,r){this.node===null?this.node=new $Ee(e,r,0):this.node.add(e,r)}lookup(e){return this.node?.search(e)?.value??null}},UZe=new Dee;for(let t=0;t<QZe.length;++t){let e=LKt[QZe[t]];UZe.insert(e,e)}qZe.exports={TernarySearchTree:Dee,tree:UZe}});var $i=H((Efi,iet)=>{"use strict";d();var q7=require("node:assert"),{kDestroyed:WZe,kBodyUsed:z3,kListeners:WEe,kBody:$Ze}=La(),{IncomingMessage:FKt}=require("node:http"),Mee=require("node:stream"),OKt=require("node:net"),{Blob:QKt}=require("node:buffer"),UKt=require("node:util"),{stringify:qKt}=require("node:querystring"),{EventEmitter:HKt}=require("node:events"),{InvalidArgumentError:hu}=Jo(),{headerNameLowerCasedRecord:$Kt}=Pee(),{tree:jZe}=HZe(),[WKt,jKt]=process.versions.node.split(".").map(t=>Number(t)),Nee=class{static{s(this,"BodyAsyncIterable")}constructor(e){this[$Ze]=e,this[z3]=!1}async*[Symbol.asyncIterator](){q7(!this[z3],"disturbed"),this[z3]=!0,yield*this[$Ze]}};function GKt(t){return Lee(t)?(YZe(t)===0&&t.on("data",function(){q7(!1)}),typeof t.readableDidRead!="boolean"&&(t[z3]=!1,HKt.prototype.on.call(t,"data",function(){this[z3]=!0})),t):t&&typeof t.pipeTo=="function"?new Nee(t):t&&typeof t!="string"&&!ArrayBuffer.isView(t)&&KZe(t)?new Nee(t):t}s(GKt,"wrapRequestBody");function VKt(){}s(VKt,"nop");function Lee(t){return t&&typeof t=="object"&&typeof t.pipe=="function"&&typeof t.on=="function"}s(Lee,"isStream");function GZe(t){if(t===null)return!1;if(t instanceof QKt)return!0;if(typeof t!="object")return!1;{let e=t[Symbol.toStringTag];return(e==="Blob"||e==="File")&&("stream"in t&&typeof t.stream=="function"||"arrayBuffer"in t&&typeof t.arrayBuffer=="function")}}s(GZe,"isBlobLike");function zKt(t,e){if(t.includes("?")||t.includes("#"))throw new Error('Query params cannot be passed when url already contains "?" or "#".');let r=qKt(e);return r&&(t+="?"+r),t}s(zKt,"buildURL");function VZe(t){let e=parseInt(t,10);return e===Number(t)&&e>=0&&e<=65535}s(VZe,"isValidPort");function Bee(t){return t!=null&&t[0]==="h"&&t[1]==="t"&&t[2]==="t"&&t[3]==="p"&&(t[4]===":"||t[4]==="s"&&t[5]===":")}s(Bee,"isHttpOrHttpsPrefixed");function zZe(t){if(typeof t=="string"){if(t=new URL(t),!Bee(t.origin||t.protocol))throw new hu("Invalid URL protocol: the URL must start with `http:` or `https:`.");return t}if(!t||typeof t!="object")throw new hu("Invalid URL: The URL argument must be a non-null object.");if(!(t instanceof URL)){if(t.port!=null&&t.port!==""&&VZe(t.port)===!1)throw new hu("Invalid URL: port must be a valid integer or a string representation of an integer.");if(t.path!=null&&typeof t.path!="string")throw new hu("Invalid URL path: the path must be a string or null/undefined.");if(t.pathname!=null&&typeof t.pathname!="string")throw new hu("Invalid URL pathname: the pathname must be a string or null/undefined.");if(t.hostname!=null&&typeof t.hostname!="string")throw new hu("Invalid URL hostname: the hostname must be a string or null/undefined.");if(t.origin!=null&&typeof t.origin!="string")throw new hu("Invalid URL origin: the origin must be a string or null/undefined.");if(!Bee(t.origin||t.protocol))throw new hu("Invalid URL protocol: the URL must start with `http:` or `https:`.");let e=t.port!=null?t.port:t.protocol==="https:"?443:80,r=t.origin!=null?t.origin:`${t.protocol||""}//${t.hostname||""}:${e}`,n=t.path!=null?t.path:`${t.pathname||""}${t.search||""}`;return r[r.length-1]==="/"&&(r=r.slice(0,r.length-1)),n&&n[0]!=="/"&&(n=`/${n}`),new URL(`${r}${n}`)}if(!Bee(t.origin||t.protocol))throw new hu("Invalid URL protocol: the URL must start with `http:` or `https:`.");return t}s(zZe,"parseURL");function KKt(t){if(t=zZe(t),t.pathname!=="/"||t.search||t.hash)throw new hu("invalid url");return t}s(KKt,"parseOrigin");function YKt(t){if(t[0]==="["){let r=t.indexOf("]");return q7(r!==-1),t.substring(1,r)}let e=t.indexOf(":");return e===-1?t:t.substring(0,e)}s(YKt,"getHostname");function JKt(t){if(!t)return null;q7(typeof t=="string");let e=YKt(t);return OKt.isIP(e)?"":e}s(JKt,"getServerName");function XKt(t){return JSON.parse(JSON.stringify(t))}s(XKt,"deepClone");function ZKt(t){return t!=null&&typeof t[Symbol.asyncIterator]=="function"}s(ZKt,"isAsyncIterable");function KZe(t){return t!=null&&(typeof t[Symbol.iterator]=="function"||typeof t[Symbol.asyncIterator]=="function")}s(KZe,"isIterable");function YZe(t){if(t==null)return 0;if(Lee(t)){let e=t._readableState;return e&&e.objectMode===!1&&e.ended===!0&&Number.isFinite(e.length)?e.length:null}else{if(GZe(t))return t.size!=null?t.size:null;if(ZZe(t))return t.byteLength}return null}s(YZe,"bodyLength");function JZe(t){return t&&!!(t.destroyed||t[WZe]||Mee.isDestroyed?.(t))}s(JZe,"isDestroyed");function eYt(t,e){t==null||!Lee(t)||JZe(t)||(typeof t.destroy=="function"?(Object.getPrototypeOf(t).constructor===FKt&&(t.socket=null),t.destroy(e)):e&&queueMicrotask(()=>{t.emit("error",e)}),t.destroyed!==!0&&(t[WZe]=!0))}s(eYt,"destroy");var tYt=/timeout=(\d+)/;function rYt(t){let e=t.toString().match(tYt);return e?parseInt(e[1],10)*1e3:null}s(rYt,"parseKeepAliveTimeout");function XZe(t){return typeof t=="string"?$Kt[t]??t.toLowerCase():jZe.lookup(t)??t.toString("latin1").toLowerCase()}s(XZe,"headerNameToString");function nYt(t){return jZe.lookup(t)??t.toString("latin1").toLowerCase()}s(nYt,"bufferToLowerCasedHeaderName");function iYt(t,e){e===void 0&&(e={});for(let r=0;r<t.length;r+=2){let n=XZe(t[r]),i=e[n];if(i)typeof i=="string"&&(i=[i],e[n]=i),i.push(t[r+1].toString("utf8"));else{let o=t[r+1];typeof o=="string"?e[n]=o:e[n]=Array.isArray(o)?o.map(a=>a.toString("utf8")):o.toString("utf8")}}return"content-length"in e&&"content-disposition"in e&&(e["content-disposition"]=Buffer.from(e["content-disposition"]).toString("latin1")),e}s(iYt,"parseHeaders");function oYt(t){let e=t.length,r=new Array(e),n=!1,i=-1,o,a,c=0;for(let l=0;l<t.length;l+=2)o=t[l],a=t[l+1],typeof o!="string"&&(o=o.toString()),typeof a!="string"&&(a=a.toString("utf8")),c=o.length,c===14&&o[7]==="-"&&(o==="content-length"||o.toLowerCase()==="content-length")?n=!0:c===19&&o[7]==="-"&&(o==="content-disposition"||o.toLowerCase()==="content-disposition")&&(i=l+1),r[l]=o,r[l+1]=a;return n&&i!==-1&&(r[i]=Buffer.from(r[i]).toString("latin1")),r}s(oYt,"parseRawHeaders");function ZZe(t){return t instanceof Uint8Array||Buffer.isBuffer(t)}s(ZZe,"isBuffer");function sYt(t,e,r){if(!t||typeof t!="object")throw new hu("handler must be an object");if(typeof t.onConnect!="function")throw new hu("invalid onConnect method");if(typeof t.onError!="function")throw new hu("invalid onError method");if(typeof t.onBodySent!="function"&&t.onBodySent!==void 0)throw new hu("invalid onBodySent method");if(r||e==="CONNECT"){if(typeof t.onUpgrade!="function")throw new hu("invalid onUpgrade method")}else{if(typeof t.onHeaders!="function")throw new hu("invalid onHeaders method");if(typeof t.onData!="function")throw new hu("invalid onData method");if(typeof t.onComplete!="function")throw new hu("invalid onComplete method")}}s(sYt,"validateHandler");function aYt(t){return!!(t&&(Mee.isDisturbed(t)||t[z3]))}s(aYt,"isDisturbed");function cYt(t){return!!(t&&Mee.isErrored(t))}s(cYt,"isErrored");function lYt(t){return!!(t&&Mee.isReadable(t))}s(lYt,"isReadable");function uYt(t){return{localAddress:t.localAddress,localPort:t.localPort,remoteAddress:t.remoteAddress,remotePort:t.remotePort,remoteFamily:t.remoteFamily,timeout:t.timeout,bytesWritten:t.bytesWritten,bytesRead:t.bytesRead}}s(uYt,"getSocketInfo");function dYt(t){let e;return new ReadableStream({async start(){e=t[Symbol.asyncIterator]()},async pull(r){let{done:n,value:i}=await e.next();if(n)queueMicrotask(()=>{r.close(),r.byobRequest?.respond(0)});else{let o=Buffer.isBuffer(i)?i:Buffer.from(i);o.byteLength&&r.enqueue(new Uint8Array(o))}return r.desiredSize>0},async cancel(r){await e.return()},type:"bytes"})}s(dYt,"ReadableStreamFrom");function fYt(t){return t&&typeof t=="object"&&typeof t.append=="function"&&typeof t.delete=="function"&&typeof t.get=="function"&&typeof t.getAll=="function"&&typeof t.has=="function"&&typeof t.set=="function"&&t[Symbol.toStringTag]==="FormData"}s(fYt,"isFormDataLike");function pYt(t,e){return"addEventListener"in t?(t.addEventListener("abort",e,{once:!0}),()=>t.removeEventListener("abort",e)):(t.addListener("abort",e),()=>t.removeListener("abort",e))}s(pYt,"addAbortListener");var mYt=typeof String.prototype.toWellFormed=="function",hYt=typeof String.prototype.isWellFormed=="function";function eet(t){return mYt?`${t}`.toWellFormed():UKt.toUSVString(t)}s(eet,"toUSVString");function gYt(t){return hYt?`${t}`.isWellFormed():eet(t)===`${t}`}s(gYt,"isUSVString");function tet(t){switch(t){case 34:case 40:case 41:case 44:case 47:case 58:case 59:case 60:case 61:case 62:case 63:case 64:case 91:case 92:case 93:case 123:case 125:return!1;default:return t>=33&&t<=126}}s(tet,"isTokenCharCode");function AYt(t){if(t.length===0)return!1;for(let e=0;e<t.length;++e)if(!tet(t.charCodeAt(e)))return!1;return!0}s(AYt,"isValidHTTPToken");var yYt=/[^\t\x20-\x7e\x80-\xff]/;function CYt(t){return!yYt.test(t)}s(CYt,"isValidHeaderValue");function vYt(t){if(t==null||t==="")return{start:0,end:null,size:null};let e=t?t.match(/^bytes (\d+)-(\d+)\/(\d+)?$/):null;return e?{start:parseInt(e[1]),end:e[2]?parseInt(e[2]):null,size:e[3]?parseInt(e[3]):null}:null}s(vYt,"parseRangeHeader");function xYt(t,e,r){return(t[WEe]??=[]).push([e,r]),t.on(e,r),t}s(xYt,"addListener");function EYt(t){for(let[e,r]of t[WEe]??[])t.removeListener(e,r);t[WEe]=null}s(EYt,"removeAllListeners");function bYt(t,e,r){try{e.onError(r),q7(e.aborted)}catch(n){t.emit("error",n)}}s(bYt,"errorRequest");var ret=Object.create(null);ret.enumerable=!0;var jEe={delete:"DELETE",DELETE:"DELETE",get:"GET",GET:"GET",head:"HEAD",HEAD:"HEAD",options:"OPTIONS",OPTIONS:"OPTIONS",post:"POST",POST:"POST",put:"PUT",PUT:"PUT"},net={...jEe,patch:"patch",PATCH:"PATCH"};Object.setPrototypeOf(jEe,null);Object.setPrototypeOf(net,null);iet.exports={kEnumerableProperty:ret,nop:VKt,isDisturbed:aYt,isErrored:cYt,isReadable:lYt,toUSVString:eet,isUSVString:gYt,isBlobLike:GZe,parseOrigin:KKt,parseURL:zZe,getServerName:JKt,isStream:Lee,isIterable:KZe,isAsyncIterable:ZKt,isDestroyed:JZe,headerNameToString:XZe,bufferToLowerCasedHeaderName:nYt,addListener:xYt,removeAllListeners:EYt,errorRequest:bYt,parseRawHeaders:oYt,parseHeaders:iYt,parseKeepAliveTimeout:rYt,destroy:eYt,bodyLength:YZe,deepClone:XKt,ReadableStreamFrom:dYt,isBuffer:ZZe,validateHandler:sYt,getSocketInfo:uYt,isFormDataLike:fYt,buildURL:zKt,addAbortListener:pYt,isValidHTTPToken:AYt,isValidHeaderValue:CYt,isTokenCharCode:tet,parseRangeHeader:vYt,normalizedMethodRecordsBase:jEe,normalizedMethodRecords:net,isValidPort:VZe,isHttpOrHttpsPrefixed:Bee,nodeMajor:WKt,nodeMinor:jKt,safeHTTPMethods:["GET","HEAD","OPTIONS","TRACE"],wrapRequestBody:GKt}});var K3=H((Tfi,set)=>{"use strict";d();var ns=require("node:diagnostics_channel"),VEe=require("node:util"),Fee=VEe.debuglog("undici"),GEe=VEe.debuglog("fetch"),tk=VEe.debuglog("websocket"),oet=!1,IYt={beforeConnect:ns.channel("undici:client:beforeConnect"),connected:ns.channel("undici:client:connected"),connectError:ns.channel("undici:client:connectError"),sendHeaders:ns.channel("undici:client:sendHeaders"),create:ns.channel("undici:request:create"),bodySent:ns.channel("undici:request:bodySent"),headers:ns.channel("undici:request:headers"),trailers:ns.channel("undici:request:trailers"),error:ns.channel("undici:request:error"),open:ns.channel("undici:websocket:open"),close:ns.channel("undici:websocket:close"),socketError:ns.channel("undici:websocket:socket_error"),ping:ns.channel("undici:websocket:ping"),pong:ns.channel("undici:websocket:pong")};if(Fee.enabled||GEe.enabled){let t=GEe.enabled?GEe:Fee;ns.channel("undici:client:beforeConnect").subscribe(e=>{let{connectParams:{version:r,protocol:n,port:i,host:o}}=e;t("connecting to %s using %s%s",`${o}${i?`:${i}`:""}`,n,r)}),ns.channel("undici:client:connected").subscribe(e=>{let{connectParams:{version:r,protocol:n,port:i,host:o}}=e;t("connected to %s using %s%s",`${o}${i?`:${i}`:""}`,n,r)}),ns.channel("undici:client:connectError").subscribe(e=>{let{connectParams:{version:r,protocol:n,port:i,host:o},error:a}=e;t("connection to %s using %s%s errored - %s",`${o}${i?`:${i}`:""}`,n,r,a.message)}),ns.channel("undici:client:sendHeaders").subscribe(e=>{let{request:{method:r,path:n,origin:i}}=e;t("sending request to %s %s/%s",r,i,n)}),ns.channel("undici:request:headers").subscribe(e=>{let{request:{method:r,path:n,origin:i},response:{statusCode:o}}=e;t("received response to %s %s/%s - HTTP %d",r,i,n,o)}),ns.channel("undici:request:trailers").subscribe(e=>{let{request:{method:r,path:n,origin:i}}=e;t("trailers received from %s %s/%s",r,i,n)}),ns.channel("undici:request:error").subscribe(e=>{let{request:{method:r,path:n,origin:i},error:o}=e;t("request to %s %s/%s errored - %s",r,i,n,o.message)}),oet=!0}if(tk.enabled){if(!oet){let t=Fee.enabled?Fee:tk;ns.channel("undici:client:beforeConnect").subscribe(e=>{let{connectParams:{version:r,protocol:n,port:i,host:o}}=e;t("connecting to %s%s using %s%s",o,i?`:${i}`:"",n,r)}),ns.channel("undici:client:connected").subscribe(e=>{let{connectParams:{version:r,protocol:n,port:i,host:o}}=e;t("connected to %s%s using %s%s",o,i?`:${i}`:"",n,r)}),ns.channel("undici:client:connectError").subscribe(e=>{let{connectParams:{version:r,protocol:n,port:i,host:o},error:a}=e;t("connection to %s%s using %s%s errored - %s",o,i?`:${i}`:"",n,r,a.message)}),ns.channel("undici:client:sendHeaders").subscribe(e=>{let{request:{method:r,path:n,origin:i}}=e;t("sending request to %s %s/%s",r,i,n)})}ns.channel("undici:websocket:open").subscribe(t=>{let{address:{address:e,port:r}}=t;tk("connection opened %s%s",e,r?`:${r}`:"")}),ns.channel("undici:websocket:close").subscribe(t=>{let{websocket:e,code:r,reason:n}=t;tk("closed connection to %s - %s %s",e.url,r,n)}),ns.channel("undici:websocket:socket_error").subscribe(t=>{tk("connection errored - %s",t.message)}),ns.channel("undici:websocket:ping").subscribe(t=>{tk("ping received")}),ns.channel("undici:websocket:pong").subscribe(t=>{tk("pong received")})}set.exports={channels:IYt}});var fet=H((Sfi,det)=>{"use strict";d();var{InvalidArgumentError:rc,NotSupportedError:TYt}=Jo(),Qx=require("node:assert"),{isValidHTTPToken:uet,isValidHeaderValue:aet,isStream:wYt,destroy:SYt,isBuffer:_Yt,isFormDataLike:RYt,isIterable:kYt,isBlobLike:PYt,buildURL:DYt,validateHandler:BYt,getServerName:NYt,normalizedMethodRecords:MYt}=$i(),{channels:XC}=K3(),{headerNameLowerCasedRecord:cet}=Pee(),LYt=/[^\u0021-\u00ff]/,Oh=Symbol("handler"),zEe=class{static{s(this,"Request")}constructor(e,{path:r,method:n,body:i,headers:o,query:a,idempotent:c,blocking:l,upgrade:u,headersTimeout:f,bodyTimeout:p,reset:m,throwOnError:h,expectContinue:g,servername:A},y){if(typeof r!="string")throw new rc("path must be a string");if(r[0]!=="/"&&!(r.startsWith("http://")||r.startsWith("https://"))&&n!=="CONNECT")throw new rc("path must be an absolute URL or start with a slash");if(LYt.test(r))throw new rc("invalid request path");if(typeof n!="string")throw new rc("method must be a string");if(MYt[n]===void 0&&!uet(n))throw new rc("invalid request method");if(u&&typeof u!="string")throw new rc("upgrade must be a string");if(f!=null&&(!Number.isFinite(f)||f<0))throw new rc("invalid headersTimeout");if(p!=null&&(!Number.isFinite(p)||p<0))throw new rc("invalid bodyTimeout");if(m!=null&&typeof m!="boolean")throw new rc("invalid reset");if(g!=null&&typeof g!="boolean")throw new rc("invalid expectContinue");if(this.headersTimeout=f,this.bodyTimeout=p,this.throwOnError=h===!0,this.method=n,this.abort=null,i==null)this.body=null;else if(wYt(i)){this.body=i;let E=this.body._readableState;(!E||!E.autoDestroy)&&(this.endHandler=s(function(){SYt(this)},"autoDestroy"),this.body.on("end",this.endHandler)),this.errorHandler=b=>{this.abort?this.abort(b):this.error=b},this.body.on("error",this.errorHandler)}else if(_Yt(i))this.body=i.byteLength?i:null;else if(ArrayBuffer.isView(i))this.body=i.buffer.byteLength?Buffer.from(i.buffer,i.byteOffset,i.byteLength):null;else if(i instanceof ArrayBuffer)this.body=i.byteLength?Buffer.from(i):null;else if(typeof i=="string")this.body=i.length?Buffer.from(i):null;else if(RYt(i)||kYt(i)||PYt(i))this.body=i;else throw new rc("body must be a string, a Buffer, a Readable stream, an iterable, or an async iterable");if(this.completed=!1,this.aborted=!1,this.upgrade=u||null,this.path=a?DYt(r,a):r,this.origin=e,this.idempotent=c??(n==="HEAD"||n==="GET"),this.blocking=l??!1,this.reset=m??null,this.host=null,this.contentLength=null,this.contentType=null,this.headers=[],this.expectContinue=g??!1,Array.isArray(o)){if(o.length%2!==0)throw new rc("headers array must be even");for(let E=0;E<o.length;E+=2)Oee(this,o[E],o[E+1])}else if(o&&typeof o=="object")if(o[Symbol.iterator])for(let E of o){if(!Array.isArray(E)||E.length!==2)throw new rc("headers must be in key-value pair format");Oee(this,E[0],E[1])}else{let E=Object.keys(o);for(let b=0;b<E.length;++b)Oee(this,E[b],o[E[b]])}else if(o!=null)throw new rc("headers must be an object or an array");BYt(y,n,u),this.servername=A||NYt(this.host),this[Oh]=y,XC.create.hasSubscribers&&XC.create.publish({request:this})}onBodySent(e){if(this[Oh].onBodySent)try{return this[Oh].onBodySent(e)}catch(r){this.abort(r)}}onRequestSent(){if(XC.bodySent.hasSubscribers&&XC.bodySent.publish({request:this}),this[Oh].onRequestSent)try{return this[Oh].onRequestSent()}catch(e){this.abort(e)}}onConnect(e){if(Qx(!this.aborted),Qx(!this.completed),this.error)e(this.error);else return this.abort=e,this[Oh].onConnect(e)}onResponseStarted(){return this[Oh].onResponseStarted?.()}onHeaders(e,r,n,i){Qx(!this.aborted),Qx(!this.completed),XC.headers.hasSubscribers&&XC.headers.publish({request:this,response:{statusCode:e,headers:r,statusText:i}});try{return this[Oh].onHeaders(e,r,n,i)}catch(o){this.abort(o)}}onData(e){Qx(!this.aborted),Qx(!this.completed);try{return this[Oh].onData(e)}catch(r){return this.abort(r),!1}}onUpgrade(e,r,n){return Qx(!this.aborted),Qx(!this.completed),this[Oh].onUpgrade(e,r,n)}onComplete(e){this.onFinally(),Qx(!this.aborted),this.completed=!0,XC.trailers.hasSubscribers&&XC.trailers.publish({request:this,trailers:e});try{return this[Oh].onComplete(e)}catch(r){this.onError(r)}}onError(e){if(this.onFinally(),XC.error.hasSubscribers&&XC.error.publish({request:this,error:e}),!this.aborted)return this.aborted=!0,this[Oh].onError(e)}onFinally(){this.errorHandler&&(this.body.off("error",this.errorHandler),this.errorHandler=null),this.endHandler&&(this.body.off("end",this.endHandler),this.endHandler=null)}addHeader(e,r){return Oee(this,e,r),this}};function Oee(t,e,r){if(r&&typeof r=="object"&&!Array.isArray(r))throw new rc(`invalid ${e} header`);if(r===void 0)return;let n=cet[e];if(n===void 0&&(n=e.toLowerCase(),cet[n]===void 0&&!uet(n)))throw new rc("invalid header key");if(Array.isArray(r)){let i=[];for(let o=0;o<r.length;o++)if(typeof r[o]=="string"){if(!aet(r[o]))throw new rc(`invalid ${e} header`);i.push(r[o])}else if(r[o]===null)i.push("");else{if(typeof r[o]=="object")throw new rc(`invalid ${e} header`);i.push(`${r[o]}`)}r=i}else if(typeof r=="string"){if(!aet(r))throw new rc(`invalid ${e} header`)}else r===null?r="":r=`${r}`;if(t.host===null&&n==="host"){if(typeof r!="string")throw new rc("invalid host header");t.host=r}else if(t.contentLength===null&&n==="content-length"){if(t.contentLength=parseInt(r,10),!Number.isFinite(t.contentLength))throw new rc("invalid content-length header")}else if(t.contentType===null&&n==="content-type")t.contentType=r,t.headers.push(e,r);else{if(n==="transfer-encoding"||n==="keep-alive"||n==="upgrade")throw new rc(`invalid ${n} header`);if(n==="connection"){let i=typeof r=="string"?r.toLowerCase():null;if(i!=="close"&&i!=="keep-alive")throw new rc("invalid connection header");i==="close"&&(t.reset=!0)}else{if(n==="expect")throw new TYt("expect header not supported");t.headers.push(e,r)}}}s(Oee,"processHeader");det.exports=zEe});var H7=H((kfi,pet)=>{"use strict";d();var FYt=require("node:events"),Qee=class extends FYt{static{s(this,"Dispatcher")}dispatch(){throw new Error("not implemented")}close(){throw new Error("not implemented")}destroy(){throw new Error("not implemented")}compose(...e){let r=Array.isArray(e[0])?e[0]:e,n=this.dispatch.bind(this);for(let i of r)if(i!=null){if(typeof i!="function")throw new TypeError(`invalid interceptor, expected function received ${typeof i}`);if(n=i(n),n==null||typeof n!="function"||n.length!==2)throw new TypeError("invalid interceptor")}return new KEe(this,n)}},KEe=class extends Qee{static{s(this,"ComposedDispatcher")}#e=null;#t=null;constructor(e,r){super(),this.#e=e,this.#t=r}dispatch(...e){this.#t(...e)}close(...e){return this.#e.close(...e)}destroy(...e){return this.#e.destroy(...e)}};pet.exports=Qee});var Z3=H((Bfi,met)=>{"use strict";d();var OYt=H7(),{ClientDestroyedError:YEe,ClientClosedError:QYt,InvalidArgumentError:Y3}=Jo(),{kDestroy:UYt,kClose:qYt,kClosed:$7,kDestroyed:J3,kDispatch:JEe,kInterceptors:rk}=La(),Ux=Symbol("onDestroyed"),X3=Symbol("onClosed"),Uee=Symbol("Intercepted Dispatch"),XEe=class extends OYt{static{s(this,"DispatcherBase")}constructor(){super(),this[J3]=!1,this[Ux]=null,this[$7]=!1,this[X3]=[]}get destroyed(){return this[J3]}get closed(){return this[$7]}get interceptors(){return this[rk]}set interceptors(e){if(e){for(let r=e.length-1;r>=0;r--)if(typeof this[rk][r]!="function")throw new Y3("interceptor must be an function")}this[rk]=e}close(e){if(e===void 0)return new Promise((n,i)=>{this.close((o,a)=>o?i(o):n(a))});if(typeof e!="function")throw new Y3("invalid callback");if(this[J3]){queueMicrotask(()=>e(new YEe,null));return}if(this[$7]){this[X3]?this[X3].push(e):queueMicrotask(()=>e(null,null));return}this[$7]=!0,this[X3].push(e);let r=s(()=>{let n=this[X3];this[X3]=null;for(let i=0;i<n.length;i++)n[i](null,null)},"onClosed");this[qYt]().then(()=>this.destroy()).then(()=>{queueMicrotask(r)})}destroy(e,r){if(typeof e=="function"&&(r=e,e=null),r===void 0)return new Promise((i,o)=>{this.destroy(e,(a,c)=>a?o(a):i(c))});if(typeof r!="function")throw new Y3("invalid callback");if(this[J3]){this[Ux]?this[Ux].push(r):queueMicrotask(()=>r(null,null));return}e||(e=new YEe),this[J3]=!0,this[Ux]=this[Ux]||[],this[Ux].push(r);let n=s(()=>{let i=this[Ux];this[Ux]=null;for(let o=0;o<i.length;o++)i[o](null,null)},"onDestroyed");this[UYt](e).then(()=>{queueMicrotask(n)})}[Uee](e,r){if(!this[rk]||this[rk].length===0)return this[Uee]=this[JEe],this[JEe](e,r);let n=this[JEe].bind(this);for(let i=this[rk].length-1;i>=0;i--)n=this[rk][i](n);return this[Uee]=n,n(e,r)}dispatch(e,r){if(!r||typeof r!="object")throw new Y3("handler must be an object");try{if(!e||typeof e!="object")throw new Y3("opts must be an object.");if(this[J3]||this[Ux])throw new YEe;if(this[$7])throw new QYt;return this[Uee](e,r)}catch(n){if(typeof r.onError!="function")throw new Y3("invalid onError method");return r.onError(n),!1}}};met.exports=XEe});var obe=H((Lfi,yet)=>{"use strict";d();var eN=0,ZEe=1e3,ebe=(ZEe>>1)-1,qx,tbe=Symbol("kFastTimer"),Hx=[],rbe=-2,nbe=-1,get=0,het=1;function ibe(){eN+=ebe;let t=0,e=Hx.length;for(;t<e;){let r=Hx[t];r._state===get?(r._idleStart=eN-ebe,r._state=het):r._state===het&&eN>=r._idleStart+r._idleTimeout&&(r._state=nbe,r._idleStart=-1,r._onTimeout(r._timerArg)),r._state===nbe?(r._state=rbe,--e!==0&&(Hx[t]=Hx[e])):++t}Hx.length=e,Hx.length!==0&&Aet()}s(ibe,"onTick");function Aet(){qx?qx.refresh():(clearTimeout(qx),qx=setTimeout(ibe,ebe),qx.unref&&qx.unref())}s(Aet,"refreshTimeout");var qee=class{static{s(this,"FastTimer")}[tbe]=!0;_state=rbe;_idleTimeout=-1;_idleStart=-1;_onTimeout;_timerArg;constructor(e,r,n){this._onTimeout=e,this._idleTimeout=r,this._timerArg=n,this.refresh()}refresh(){this._state===rbe&&Hx.push(this),(!qx||Hx.length===1)&&Aet(),this._state=get}clear(){this._state=nbe,this._idleStart=-1}};yet.exports={setTimeout(t,e,r){return e<=ZEe?setTimeout(t,e,r):new qee(t,e,r)},clearTimeout(t){t[tbe]?t.clear():clearTimeout(t)},setFastTimeout(t,e,r){return new qee(t,e,r)},clearFastTimeout(t){t.clear()},now(){return eN},tick(t=0){eN+=t-ZEe+1,ibe(),ibe()},reset(){eN=0,Hx.length=0,clearTimeout(qx),qx=null},kFastTimer:tbe}});var W7=H((qfi,bet)=>{"use strict";d();var HYt=require("node:net"),Cet=require("node:assert"),Eet=$i(),{InvalidArgumentError:$Yt,ConnectTimeoutError:WYt}=Jo(),Hee=obe();function vet(){}s(vet,"noop");var sbe,abe;global.FinalizationRegistry&&!(process.env.NODE_V8_COVERAGE||process.env.UNDICI_NO_FG)?abe=class{static{s(this,"WeakSessionCache")}constructor(e){this._maxCachedSessions=e,this._sessionCache=new Map,this._sessionRegistry=new global.FinalizationRegistry(r=>{if(this._sessionCache.size<this._maxCachedSessions)return;let n=this._sessionCache.get(r);n!==void 0&&n.deref()===void 0&&this._sessionCache.delete(r)})}get(e){let r=this._sessionCache.get(e);return r?r.deref():null}set(e,r){this._maxCachedSessions!==0&&(this._sessionCache.set(e,new WeakRef(r)),this._sessionRegistry.register(r,e))}}:abe=class{static{s(this,"SimpleSessionCache")}constructor(e){this._maxCachedSessions=e,this._sessionCache=new Map}get(e){return this._sessionCache.get(e)}set(e,r){if(this._maxCachedSessions!==0){if(this._sessionCache.size>=this._maxCachedSessions){let{value:n}=this._sessionCache.keys().next();this._sessionCache.delete(n)}this._sessionCache.set(e,r)}}};function jYt({allowH2:t,maxCachedSessions:e,socketPath:r,timeout:n,session:i,...o}){if(e!=null&&(!Number.isInteger(e)||e<0))throw new $Yt("maxCachedSessions must be a positive integer or zero");let a={path:r,...o},c=new abe(e??100);return n=n??1e4,t=t??!1,s(function({hostname:u,host:f,protocol:p,port:m,servername:h,localAddress:g,httpSocket:A},y){let E;if(p==="https:"){sbe||(sbe=require("node:tls")),h=h||a.servername||Eet.getServerName(f)||null;let S=h||u;Cet(S);let R=i||c.get(S)||null;m=m||443,E=sbe.connect({highWaterMark:16384,...a,servername:h,session:R,localAddress:g,ALPNProtocols:t?["http/1.1","h2"]:["http/1.1"],socket:A,port:m,host:u}),E.on("session",function(B){c.set(S,B)})}else Cet(!A,"httpSocket can only be sent on TLS update"),m=m||80,E=HYt.connect({highWaterMark:64*1024,...a,localAddress:g,port:m,host:u});if(a.keepAlive==null||a.keepAlive){let S=a.keepAliveInitialDelay===void 0?6e4:a.keepAliveInitialDelay;E.setKeepAlive(!0,S)}let b=GYt(new WeakRef(E),{timeout:n,hostname:u,port:m});return E.setNoDelay(!0).once(p==="https:"?"secureConnect":"connect",function(){if(queueMicrotask(b),y){let S=y;y=null,S(null,this)}}).on("error",function(S){if(queueMicrotask(b),y){let R=y;y=null,R(S)}}),E},"connect")}s(jYt,"buildConnector");var GYt=process.platform==="win32"?(t,e)=>{if(!e.timeout)return vet;let r=null,n=null,i=Hee.setFastTimeout(()=>{r=setImmediate(()=>{n=setImmediate(()=>xet(t.deref(),e))})},e.timeout);return()=>{Hee.clearFastTimeout(i),clearImmediate(r),clearImmediate(n)}}:(t,e)=>{if(!e.timeout)return vet;let r=null,n=Hee.setFastTimeout(()=>{r=setImmediate(()=>{xet(t.deref(),e)})},e.timeout);return()=>{Hee.clearFastTimeout(n),clearImmediate(r)}};function xet(t,e){if(t==null)return;let r="Connect Timeout Error";Array.isArray(t.autoSelectFamilyAttemptedAddresses)?r+=` (attempted addresses: ${t.autoSelectFamilyAttemptedAddresses.join(", ")},`:r+=` (attempted address: ${e.hostname}:${e.port},`,r+=` timeout: ${e.timeout}ms)`,Eet.destroy(t,new WYt(r))}s(xet,"onConnectTimeout");bet.exports=jYt});var Iet=H($ee=>{"use strict";d();Object.defineProperty($ee,"__esModule",{value:!0});$ee.enumToMap=void 0;function VYt(t){let e={};return Object.keys(t).forEach(r=>{let n=t[r];typeof n=="number"&&(e[r]=n)}),e}s(VYt,"enumToMap");$ee.enumToMap=VYt});var Tet=H(zt=>{"use strict";d();Object.defineProperty(zt,"__esModule",{value:!0});zt.SPECIAL_HEADERS=zt.HEADER_STATE=zt.MINOR=zt.MAJOR=zt.CONNECTION_TOKEN_CHARS=zt.HEADER_CHARS=zt.TOKEN=zt.STRICT_TOKEN=zt.HEX=zt.URL_CHAR=zt.STRICT_URL_CHAR=zt.USERINFO_CHARS=zt.MARK=zt.ALPHANUM=zt.NUM=zt.HEX_MAP=zt.NUM_MAP=zt.ALPHA=zt.FINISH=zt.H_METHOD_MAP=zt.METHOD_MAP=zt.METHODS_RTSP=zt.METHODS_ICE=zt.METHODS_HTTP=zt.METHODS=zt.LENIENT_FLAGS=zt.FLAGS=zt.TYPE=zt.ERROR=void 0;var zYt=Iet(),KYt;(function(t){t[t.OK=0]="OK",t[t.INTERNAL=1]="INTERNAL",t[t.STRICT=2]="STRICT",t[t.LF_EXPECTED=3]="LF_EXPECTED",t[t.UNEXPECTED_CONTENT_LENGTH=4]="UNEXPECTED_CONTENT_LENGTH",t[t.CLOSED_CONNECTION=5]="CLOSED_CONNECTION",t[t.INVALID_METHOD=6]="INVALID_METHOD",t[t.INVALID_URL=7]="INVALID_URL",t[t.INVALID_CONSTANT=8]="INVALID_CONSTANT",t[t.INVALID_VERSION=9]="INVALID_VERSION",t[t.INVALID_HEADER_TOKEN=10]="INVALID_HEADER_TOKEN",t[t.INVALID_CONTENT_LENGTH=11]="INVALID_CONTENT_LENGTH",t[t.INVALID_CHUNK_SIZE=12]="INVALID_CHUNK_SIZE",t[t.INVALID_STATUS=13]="INVALID_STATUS",t[t.INVALID_EOF_STATE=14]="INVALID_EOF_STATE",t[t.INVALID_TRANSFER_ENCODING=15]="INVALID_TRANSFER_ENCODING",t[t.CB_MESSAGE_BEGIN=16]="CB_MESSAGE_BEGIN",t[t.CB_HEADERS_COMPLETE=17]="CB_HEADERS_COMPLETE",t[t.CB_MESSAGE_COMPLETE=18]="CB_MESSAGE_COMPLETE",t[t.CB_CHUNK_HEADER=19]="CB_CHUNK_HEADER",t[t.CB_CHUNK_COMPLETE=20]="CB_CHUNK_COMPLETE",t[t.PAUSED=21]="PAUSED",t[t.PAUSED_UPGRADE=22]="PAUSED_UPGRADE",t[t.PAUSED_H2_UPGRADE=23]="PAUSED_H2_UPGRADE",t[t.USER=24]="USER"})(KYt=zt.ERROR||(zt.ERROR={}));var YYt;(function(t){t[t.BOTH=0]="BOTH",t[t.REQUEST=1]="REQUEST",t[t.RESPONSE=2]="RESPONSE"})(YYt=zt.TYPE||(zt.TYPE={}));var JYt;(function(t){t[t.CONNECTION_KEEP_ALIVE=1]="CONNECTION_KEEP_ALIVE",t[t.CONNECTION_CLOSE=2]="CONNECTION_CLOSE",t[t.CONNECTION_UPGRADE=4]="CONNECTION_UPGRADE",t[t.CHUNKED=8]="CHUNKED",t[t.UPGRADE=16]="UPGRADE",t[t.CONTENT_LENGTH=32]="CONTENT_LENGTH",t[t.SKIPBODY=64]="SKIPBODY",t[t.TRAILING=128]="TRAILING",t[t.TRANSFER_ENCODING=512]="TRANSFER_ENCODING"})(JYt=zt.FLAGS||(zt.FLAGS={}));var XYt;(function(t){t[t.HEADERS=1]="HEADERS",t[t.CHUNKED_LENGTH=2]="CHUNKED_LENGTH",t[t.KEEP_ALIVE=4]="KEEP_ALIVE"})(XYt=zt.LENIENT_FLAGS||(zt.LENIENT_FLAGS={}));var bn;(function(t){t[t.DELETE=0]="DELETE",t[t.GET=1]="GET",t[t.HEAD=2]="HEAD",t[t.POST=3]="POST",t[t.PUT=4]="PUT",t[t.CONNECT=5]="CONNECT",t[t.OPTIONS=6]="OPTIONS",t[t.TRACE=7]="TRACE",t[t.COPY=8]="COPY",t[t.LOCK=9]="LOCK",t[t.MKCOL=10]="MKCOL",t[t.MOVE=11]="MOVE",t[t.PROPFIND=12]="PROPFIND",t[t.PROPPATCH=13]="PROPPATCH",t[t.SEARCH=14]="SEARCH",t[t.UNLOCK=15]="UNLOCK",t[t.BIND=16]="BIND",t[t.REBIND=17]="REBIND",t[t.UNBIND=18]="UNBIND",t[t.ACL=19]="ACL",t[t.REPORT=20]="REPORT",t[t.MKACTIVITY=21]="MKACTIVITY",t[t.CHECKOUT=22]="CHECKOUT",t[t.MERGE=23]="MERGE",t[t["M-SEARCH"]=24]="M-SEARCH",t[t.NOTIFY=25]="NOTIFY",t[t.SUBSCRIBE=26]="SUBSCRIBE",t[t.UNSUBSCRIBE=27]="UNSUBSCRIBE",t[t.PATCH=28]="PATCH",t[t.PURGE=29]="PURGE",t[t.MKCALENDAR=30]="MKCALENDAR",t[t.LINK=31]="LINK",t[t.UNLINK=32]="UNLINK",t[t.SOURCE=33]="SOURCE",t[t.PRI=34]="PRI",t[t.DESCRIBE=35]="DESCRIBE",t[t.ANNOUNCE=36]="ANNOUNCE",t[t.SETUP=37]="SETUP",t[t.PLAY=38]="PLAY",t[t.PAUSE=39]="PAUSE",t[t.TEARDOWN=40]="TEARDOWN",t[t.GET_PARAMETER=41]="GET_PARAMETER",t[t.SET_PARAMETER=42]="SET_PARAMETER",t[t.REDIRECT=43]="REDIRECT",t[t.RECORD=44]="RECORD",t[t.FLUSH=45]="FLUSH"})(bn=zt.METHODS||(zt.METHODS={}));zt.METHODS_HTTP=[bn.DELETE,bn.GET,bn.HEAD,bn.POST,bn.PUT,bn.CONNECT,bn.OPTIONS,bn.TRACE,bn.COPY,bn.LOCK,bn.MKCOL,bn.MOVE,bn.PROPFIND,bn.PROPPATCH,bn.SEARCH,bn.UNLOCK,bn.BIND,bn.REBIND,bn.UNBIND,bn.ACL,bn.REPORT,bn.MKACTIVITY,bn.CHECKOUT,bn.MERGE,bn["M-SEARCH"],bn.NOTIFY,bn.SUBSCRIBE,bn.UNSUBSCRIBE,bn.PATCH,bn.PURGE,bn.MKCALENDAR,bn.LINK,bn.UNLINK,bn.PRI,bn.SOURCE];zt.METHODS_ICE=[bn.SOURCE];zt.METHODS_RTSP=[bn.OPTIONS,bn.DESCRIBE,bn.ANNOUNCE,bn.SETUP,bn.PLAY,bn.PAUSE,bn.TEARDOWN,bn.GET_PARAMETER,bn.SET_PARAMETER,bn.REDIRECT,bn.RECORD,bn.FLUSH,bn.GET,bn.POST];zt.METHOD_MAP=zYt.enumToMap(bn);zt.H_METHOD_MAP={};Object.keys(zt.METHOD_MAP).forEach(t=>{/^H/.test(t)&&(zt.H_METHOD_MAP[t]=zt.METHOD_MAP[t])});var ZYt;(function(t){t[t.SAFE=0]="SAFE",t[t.SAFE_WITH_CB=1]="SAFE_WITH_CB",t[t.UNSAFE=2]="UNSAFE"})(ZYt=zt.FINISH||(zt.FINISH={}));zt.ALPHA=[];for(let t=65;t<=90;t++)zt.ALPHA.push(String.fromCharCode(t)),zt.ALPHA.push(String.fromCharCode(t+32));zt.NUM_MAP={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9};zt.HEX_MAP={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15};zt.NUM=["0","1","2","3","4","5","6","7","8","9"];zt.ALPHANUM=zt.ALPHA.concat(zt.NUM);zt.MARK=["-","_",".","!","~","*","'","(",")"];zt.USERINFO_CHARS=zt.ALPHANUM.concat(zt.MARK).concat(["%",";",":","&","=","+","$",","]);zt.STRICT_URL_CHAR=["!",'"',"$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","@","[","\\","]","^","_","`","{","|","}","~"].concat(zt.ALPHANUM);zt.URL_CHAR=zt.STRICT_URL_CHAR.concat(["	","\f"]);for(let t=128;t<=255;t++)zt.URL_CHAR.push(t);zt.HEX=zt.NUM.concat(["a","b","c","d","e","f","A","B","C","D","E","F"]);zt.STRICT_TOKEN=["!","#","$","%","&","'","*","+","-",".","^","_","`","|","~"].concat(zt.ALPHANUM);zt.TOKEN=zt.STRICT_TOKEN.concat([" "]);zt.HEADER_CHARS=["	"];for(let t=32;t<=255;t++)t!==127&&zt.HEADER_CHARS.push(t);zt.CONNECTION_TOKEN_CHARS=zt.HEADER_CHARS.filter(t=>t!==44);zt.MAJOR=zt.NUM_MAP;zt.MINOR=zt.MAJOR;var tN;(function(t){t[t.GENERAL=0]="GENERAL",t[t.CONNECTION=1]="CONNECTION",t[t.CONTENT_LENGTH=2]="CONTENT_LENGTH",t[t.TRANSFER_ENCODING=3]="TRANSFER_ENCODING",t[t.UPGRADE=4]="UPGRADE",t[t.CONNECTION_KEEP_ALIVE=5]="CONNECTION_KEEP_ALIVE",t[t.CONNECTION_CLOSE=6]="CONNECTION_CLOSE",t[t.CONNECTION_UPGRADE=7]="CONNECTION_UPGRADE",t[t.TRANSFER_ENCODING_CHUNKED=8]="TRANSFER_ENCODING_CHUNKED"})(tN=zt.HEADER_STATE||(zt.HEADER_STATE={}));zt.SPECIAL_HEADERS={connection:tN.CONNECTION,"content-length":tN.CONTENT_LENGTH,"proxy-connection":tN.CONNECTION,"transfer-encoding":tN.TRANSFER_ENCODING,upgrade:tN.UPGRADE}});var cbe=H((Kfi,wet)=>{"use strict";d();var{Buffer:eJt}=require("node:buffer");wet.exports=eJt.from("AGFzbQEAAAABJwdgAX8Bf2ADf39/AX9gAX8AYAJ/fwBgBH9/f38Bf2AAAGADf39/AALLAQgDZW52GHdhc21fb25faGVhZGVyc19jb21wbGV0ZQAEA2VudhV3YXNtX29uX21lc3NhZ2VfYmVnaW4AAANlbnYLd2FzbV9vbl91cmwAAQNlbnYOd2FzbV9vbl9zdGF0dXMAAQNlbnYUd2FzbV9vbl9oZWFkZXJfZmllbGQAAQNlbnYUd2FzbV9vbl9oZWFkZXJfdmFsdWUAAQNlbnYMd2FzbV9vbl9ib2R5AAEDZW52GHdhc21fb25fbWVzc2FnZV9jb21wbGV0ZQAAAy0sBQYAAAIAAAAAAAACAQIAAgICAAADAAAAAAMDAwMBAQEBAQEBAQEAAAIAAAAEBQFwARISBQMBAAIGCAF/AUGA1AQLB9EFIgZtZW1vcnkCAAtfaW5pdGlhbGl6ZQAIGV9faW5kaXJlY3RfZnVuY3Rpb25fdGFibGUBAAtsbGh0dHBfaW5pdAAJGGxsaHR0cF9zaG91bGRfa2VlcF9hbGl2ZQAvDGxsaHR0cF9hbGxvYwALBm1hbGxvYwAxC2xsaHR0cF9mcmVlAAwEZnJlZQAMD2xsaHR0cF9nZXRfdHlwZQANFWxsaHR0cF9nZXRfaHR0cF9tYWpvcgAOFWxsaHR0cF9nZXRfaHR0cF9taW5vcgAPEWxsaHR0cF9nZXRfbWV0aG9kABAWbGxodHRwX2dldF9zdGF0dXNfY29kZQAREmxsaHR0cF9nZXRfdXBncmFkZQASDGxsaHR0cF9yZXNldAATDmxsaHR0cF9leGVjdXRlABQUbGxodHRwX3NldHRpbmdzX2luaXQAFQ1sbGh0dHBfZmluaXNoABYMbGxodHRwX3BhdXNlABcNbGxodHRwX3Jlc3VtZQAYG2xsaHR0cF9yZXN1bWVfYWZ0ZXJfdXBncmFkZQAZEGxsaHR0cF9nZXRfZXJybm8AGhdsbGh0dHBfZ2V0X2Vycm9yX3JlYXNvbgAbF2xsaHR0cF9zZXRfZXJyb3JfcmVhc29uABwUbGxodHRwX2dldF9lcnJvcl9wb3MAHRFsbGh0dHBfZXJybm9fbmFtZQAeEmxsaHR0cF9tZXRob2RfbmFtZQAfEmxsaHR0cF9zdGF0dXNfbmFtZQAgGmxsaHR0cF9zZXRfbGVuaWVudF9oZWFkZXJzACEhbGxodHRwX3NldF9sZW5pZW50X2NodW5rZWRfbGVuZ3RoACIdbGxodHRwX3NldF9sZW5pZW50X2tlZXBfYWxpdmUAIyRsbGh0dHBfc2V0X2xlbmllbnRfdHJhbnNmZXJfZW5jb2RpbmcAJBhsbGh0dHBfbWVzc2FnZV9uZWVkc19lb2YALgkXAQBBAQsRAQIDBAUKBgcrLSwqKSglJyYK07MCLBYAQYjQACgCAARAAAtBiNAAQQE2AgALFAAgABAwIAAgAjYCOCAAIAE6ACgLFAAgACAALwEyIAAtAC4gABAvEAALHgEBf0HAABAyIgEQMCABQYAINgI4IAEgADoAKCABC48MAQd/AkAgAEUNACAAQQhrIgEgAEEEaygCACIAQXhxIgRqIQUCQCAAQQFxDQAgAEEDcUUNASABIAEoAgAiAGsiAUGc0AAoAgBJDQEgACAEaiEEAkACQEGg0AAoAgAgAUcEQCAAQf8BTQRAIABBA3YhAyABKAIIIgAgASgCDCICRgRAQYzQAEGM0AAoAgBBfiADd3E2AgAMBQsgAiAANgIIIAAgAjYCDAwECyABKAIYIQYgASABKAIMIgBHBEAgACABKAIIIgI2AgggAiAANgIMDAMLIAFBFGoiAygCACICRQRAIAEoAhAiAkUNAiABQRBqIQMLA0AgAyEHIAIiAEEUaiIDKAIAIgINACAAQRBqIQMgACgCECICDQALIAdBADYCAAwCCyAFKAIEIgBBA3FBA0cNAiAFIABBfnE2AgRBlNAAIAQ2AgAgBSAENgIAIAEgBEEBcjYCBAwDC0EAIQALIAZFDQACQCABKAIcIgJBAnRBvNIAaiIDKAIAIAFGBEAgAyAANgIAIAANAUGQ0ABBkNAAKAIAQX4gAndxNgIADAILIAZBEEEUIAYoAhAgAUYbaiAANgIAIABFDQELIAAgBjYCGCABKAIQIgIEQCAAIAI2AhAgAiAANgIYCyABQRRqKAIAIgJFDQAgAEEUaiACNgIAIAIgADYCGAsgASAFTw0AIAUoAgQiAEEBcUUNAAJAAkACQAJAIABBAnFFBEBBpNAAKAIAIAVGBEBBpNAAIAE2AgBBmNAAQZjQACgCACAEaiIANgIAIAEgAEEBcjYCBCABQaDQACgCAEcNBkGU0ABBADYCAEGg0ABBADYCAAwGC0Gg0AAoAgAgBUYEQEGg0AAgATYCAEGU0ABBlNAAKAIAIARqIgA2AgAgASAAQQFyNgIEIAAgAWogADYCAAwGCyAAQXhxIARqIQQgAEH/AU0EQCAAQQN2IQMgBSgCCCIAIAUoAgwiAkYEQEGM0ABBjNAAKAIAQX4gA3dxNgIADAULIAIgADYCCCAAIAI2AgwMBAsgBSgCGCEGIAUgBSgCDCIARwRAQZzQACgCABogACAFKAIIIgI2AgggAiAANgIMDAMLIAVBFGoiAygCACICRQRAIAUoAhAiAkUNAiAFQRBqIQMLA0AgAyEHIAIiAEEUaiIDKAIAIgINACAAQRBqIQMgACgCECICDQALIAdBADYCAAwCCyAFIABBfnE2AgQgASAEaiAENgIAIAEgBEEBcjYCBAwDC0EAIQALIAZFDQACQCAFKAIcIgJBAnRBvNIAaiIDKAIAIAVGBEAgAyAANgIAIAANAUGQ0ABBkNAAKAIAQX4gAndxNgIADAILIAZBEEEUIAYoAhAgBUYbaiAANgIAIABFDQELIAAgBjYCGCAFKAIQIgIEQCAAIAI2AhAgAiAANgIYCyAFQRRqKAIAIgJFDQAgAEEUaiACNgIAIAIgADYCGAsgASAEaiAENgIAIAEgBEEBcjYCBCABQaDQACgCAEcNAEGU0AAgBDYCAAwBCyAEQf8BTQRAIARBeHFBtNAAaiEAAn9BjNAAKAIAIgJBASAEQQN2dCIDcUUEQEGM0AAgAiADcjYCACAADAELIAAoAggLIgIgATYCDCAAIAE2AgggASAANgIMIAEgAjYCCAwBC0EfIQIgBEH///8HTQRAIARBJiAEQQh2ZyIAa3ZBAXEgAEEBdGtBPmohAgsgASACNgIcIAFCADcCECACQQJ0QbzSAGohAAJAQZDQACgCACIDQQEgAnQiB3FFBEAgACABNgIAQZDQACADIAdyNgIAIAEgADYCGCABIAE2AgggASABNgIMDAELIARBGSACQQF2a0EAIAJBH0cbdCECIAAoAgAhAAJAA0AgACIDKAIEQXhxIARGDQEgAkEddiEAIAJBAXQhAiADIABBBHFqQRBqIgcoAgAiAA0ACyAHIAE2AgAgASADNgIYIAEgATYCDCABIAE2AggMAQsgAygCCCIAIAE2AgwgAyABNgIIIAFBADYCGCABIAM2AgwgASAANgIIC0Gs0ABBrNAAKAIAQQFrIgBBfyAAGzYCAAsLBwAgAC0AKAsHACAALQAqCwcAIAAtACsLBwAgAC0AKQsHACAALwEyCwcAIAAtAC4LQAEEfyAAKAIYIQEgAC0ALSECIAAtACghAyAAKAI4IQQgABAwIAAgBDYCOCAAIAM6ACggACACOgAtIAAgATYCGAu74gECB38DfiABIAJqIQQCQCAAIgIoAgwiAA0AIAIoAgQEQCACIAE2AgQLIwBBEGsiCCQAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACfwJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAIAIoAhwiA0EBaw7dAdoBAdkBAgMEBQYHCAkKCwwNDtgBDxDXARES1gETFBUWFxgZGhvgAd8BHB0e1QEfICEiIyQl1AEmJygpKiss0wHSAS0u0QHQAS8wMTIzNDU2Nzg5Ojs8PT4/QEFCQ0RFRtsBR0hJSs8BzgFLzQFMzAFNTk9QUVJTVFVWV1hZWltcXV5fYGFiY2RlZmdoaWprbG1ub3BxcnN0dXZ3eHl6e3x9fn+AAYEBggGDAYQBhQGGAYcBiAGJAYoBiwGMAY0BjgGPAZABkQGSAZMBlAGVAZYBlwGYAZkBmgGbAZwBnQGeAZ8BoAGhAaIBowGkAaUBpgGnAagBqQGqAasBrAGtAa4BrwGwAbEBsgGzAbQBtQG2AbcBywHKAbgByQG5AcgBugG7AbwBvQG+Ab8BwAHBAcIBwwHEAcUBxgEA3AELQQAMxgELQQ4MxQELQQ0MxAELQQ8MwwELQRAMwgELQRMMwQELQRQMwAELQRUMvwELQRYMvgELQRgMvQELQRkMvAELQRoMuwELQRsMugELQRwMuQELQR0MuAELQQgMtwELQR4MtgELQSAMtQELQR8MtAELQQcMswELQSEMsgELQSIMsQELQSMMsAELQSQMrwELQRIMrgELQREMrQELQSUMrAELQSYMqwELQScMqgELQSgMqQELQcMBDKgBC0EqDKcBC0ErDKYBC0EsDKUBC0EtDKQBC0EuDKMBC0EvDKIBC0HEAQyhAQtBMAygAQtBNAyfAQtBDAyeAQtBMQydAQtBMgycAQtBMwybAQtBOQyaAQtBNQyZAQtBxQEMmAELQQsMlwELQToMlgELQTYMlQELQQoMlAELQTcMkwELQTgMkgELQTwMkQELQTsMkAELQT0MjwELQQkMjgELQSkMjQELQT4MjAELQT8MiwELQcAADIoBC0HBAAyJAQtBwgAMiAELQcMADIcBC0HEAAyGAQtBxQAMhQELQcYADIQBC0EXDIMBC0HHAAyCAQtByAAMgQELQckADIABC0HKAAx/C0HLAAx+C0HNAAx9C0HMAAx8C0HOAAx7C0HPAAx6C0HQAAx5C0HRAAx4C0HSAAx3C0HTAAx2C0HUAAx1C0HWAAx0C0HVAAxzC0EGDHILQdcADHELQQUMcAtB2AAMbwtBBAxuC0HZAAxtC0HaAAxsC0HbAAxrC0HcAAxqC0EDDGkLQd0ADGgLQd4ADGcLQd8ADGYLQeEADGULQeAADGQLQeIADGMLQeMADGILQQIMYQtB5AAMYAtB5QAMXwtB5gAMXgtB5wAMXQtB6AAMXAtB6QAMWwtB6gAMWgtB6wAMWQtB7AAMWAtB7QAMVwtB7gAMVgtB7wAMVQtB8AAMVAtB8QAMUwtB8gAMUgtB8wAMUQtB9AAMUAtB9QAMTwtB9gAMTgtB9wAMTQtB+AAMTAtB+QAMSwtB+gAMSgtB+wAMSQtB/AAMSAtB/QAMRwtB/gAMRgtB/wAMRQtBgAEMRAtBgQEMQwtBggEMQgtBgwEMQQtBhAEMQAtBhQEMPwtBhgEMPgtBhwEMPQtBiAEMPAtBiQEMOwtBigEMOgtBiwEMOQtBjAEMOAtBjQEMNwtBjgEMNgtBjwEMNQtBkAEMNAtBkQEMMwtBkgEMMgtBkwEMMQtBlAEMMAtBlQEMLwtBlgEMLgtBlwEMLQtBmAEMLAtBmQEMKwtBmgEMKgtBmwEMKQtBnAEMKAtBnQEMJwtBngEMJgtBnwEMJQtBoAEMJAtBoQEMIwtBogEMIgtBowEMIQtBpAEMIAtBpQEMHwtBpgEMHgtBpwEMHQtBqAEMHAtBqQEMGwtBqgEMGgtBqwEMGQtBrAEMGAtBrQEMFwtBrgEMFgtBAQwVC0GvAQwUC0GwAQwTC0GxAQwSC0GzAQwRC0GyAQwQC0G0AQwPC0G1AQwOC0G2AQwNC0G3AQwMC0G4AQwLC0G5AQwKC0G6AQwJC0G7AQwIC0HGAQwHC0G8AQwGC0G9AQwFC0G+AQwEC0G/AQwDC0HAAQwCC0HCAQwBC0HBAQshAwNAAkACQAJAAkACQAJAAkACQAJAIAICfwJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJ/AkACQAJAAkACQAJAAkACQAJAAkACQAJAAkAgAgJ/AkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACfwJAAkACfwJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACfwJAAkACQAJAAn8CQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQCADDsYBAAECAwQFBgcICQoLDA0ODxAREhMUFRYXGBkaGxwdHyAhIyUmKCorLC8wMTIzNDU2Nzk6Ozw9lANAQkRFRklLTk9QUVJTVFVWWFpbXF1eX2BhYmNkZWZnaGpsb3Bxc3V2eHl6e3x/gAGBAYIBgwGEAYUBhgGHAYgBiQGKAYsBjAGNAY4BjwGQAZEBkgGTAZQBlQGWAZcBmAGZAZoBmwGcAZ0BngGfAaABoQGiAaMBpAGlAaYBpwGoAakBqgGrAawBrQGuAa8BsAGxAbIBswG0AbUBtgG3AbgBuQG6AbsBvAG9Ab4BvwHAAcEBwgHDAcQBxQHGAccByAHJAcsBzAHNAc4BzwGKA4kDiAOHA4QDgwOAA/sC+gL5AvgC9wL0AvMC8gLLAsECsALZAQsgASAERw3wAkHdASEDDLMDCyABIARHDcgBQcMBIQMMsgMLIAEgBEcNe0H3ACEDDLEDCyABIARHDXBB7wAhAwywAwsgASAERw1pQeoAIQMMrwMLIAEgBEcNZUHoACEDDK4DCyABIARHDWJB5gAhAwytAwsgASAERw0aQRghAwysAwsgASAERw0VQRIhAwyrAwsgASAERw1CQcUAIQMMqgMLIAEgBEcNNEE/IQMMqQMLIAEgBEcNMkE8IQMMqAMLIAEgBEcNK0ExIQMMpwMLIAItAC5BAUYNnwMMwQILQQAhAAJAAkACQCACLQAqRQ0AIAItACtFDQAgAi8BMCIDQQJxRQ0BDAILIAIvATAiA0EBcUUNAQtBASEAIAItAChBAUYNACACLwEyIgVB5ABrQeQASQ0AIAVBzAFGDQAgBUGwAkYNACADQcAAcQ0AQQAhACADQYgEcUGABEYNACADQShxQQBHIQALIAJBADsBMCACQQA6AC8gAEUN3wIgAkIANwMgDOACC0EAIQACQCACKAI4IgNFDQAgAygCLCIDRQ0AIAIgAxEAACEACyAARQ3MASAAQRVHDd0CIAJBBDYCHCACIAE2AhQgAkGwGDYCECACQRU2AgxBACEDDKQDCyABIARGBEBBBiEDDKQDCyABQQFqIQFBACEAAkAgAigCOCIDRQ0AIAMoAlQiA0UNACACIAMRAAAhAAsgAA3ZAgwcCyACQgA3AyBBEiEDDIkDCyABIARHDRZBHSEDDKEDCyABIARHBEAgAUEBaiEBQRAhAwyIAwtBByEDDKADCyACIAIpAyAiCiAEIAFrrSILfSIMQgAgCiAMWhs3AyAgCiALWA3UAkEIIQMMnwMLIAEgBEcEQCACQQk2AgggAiABNgIEQRQhAwyGAwtBCSEDDJ4DCyACKQMgQgBSDccBIAIgAi8BMEGAAXI7ATAMQgsgASAERw0/QdAAIQMMnAMLIAEgBEYEQEELIQMMnAMLIAFBAWohAUEAIQACQCACKAI4IgNFDQAgAygCUCIDRQ0AIAIgAxEAACEACyAADc8CDMYBC0EAIQACQCACKAI4IgNFDQAgAygCSCIDRQ0AIAIgAxEAACEACyAARQ3GASAAQRVHDc0CIAJBCzYCHCACIAE2AhQgAkGCGTYCECACQRU2AgxBACEDDJoDC0EAIQACQCACKAI4IgNFDQAgAygCSCIDRQ0AIAIgAxEAACEACyAARQ0MIABBFUcNygIgAkEaNgIcIAIgATYCFCACQYIZNgIQIAJBFTYCDEEAIQMMmQMLQQAhAAJAIAIoAjgiA0UNACADKAJMIgNFDQAgAiADEQAAIQALIABFDcQBIABBFUcNxwIgAkELNgIcIAIgATYCFCACQZEXNgIQIAJBFTYCDEEAIQMMmAMLIAEgBEYEQEEPIQMMmAMLIAEtAAAiAEE7Rg0HIABBDUcNxAIgAUEBaiEBDMMBC0EAIQACQCACKAI4IgNFDQAgAygCTCIDRQ0AIAIgAxEAACEACyAARQ3DASAAQRVHDcICIAJBDzYCHCACIAE2AhQgAkGRFzYCECACQRU2AgxBACEDDJYDCwNAIAEtAABB8DVqLQAAIgBBAUcEQCAAQQJHDcECIAIoAgQhAEEAIQMgAkEANgIEIAIgACABQQFqIgEQLSIADcICDMUBCyAEIAFBAWoiAUcNAAtBEiEDDJUDC0EAIQACQCACKAI4IgNFDQAgAygCTCIDRQ0AIAIgAxEAACEACyAARQ3FASAAQRVHDb0CIAJBGzYCHCACIAE2AhQgAkGRFzYCECACQRU2AgxBACEDDJQDCyABIARGBEBBFiEDDJQDCyACQQo2AgggAiABNgIEQQAhAAJAIAIoAjgiA0UNACADKAJIIgNFDQAgAiADEQAAIQALIABFDcIBIABBFUcNuQIgAkEVNgIcIAIgATYCFCACQYIZNgIQIAJBFTYCDEEAIQMMkwMLIAEgBEcEQANAIAEtAABB8DdqLQAAIgBBAkcEQAJAIABBAWsOBMQCvQIAvgK9AgsgAUEBaiEBQQghAwz8AgsgBCABQQFqIgFHDQALQRUhAwyTAwtBFSEDDJIDCwNAIAEtAABB8DlqLQAAIgBBAkcEQCAAQQFrDgTFArcCwwK4ArcCCyAEIAFBAWoiAUcNAAtBGCEDDJEDCyABIARHBEAgAkELNgIIIAIgATYCBEEHIQMM+AILQRkhAwyQAwsgAUEBaiEBDAILIAEgBEYEQEEaIQMMjwMLAkAgAS0AAEENaw4UtQG/Ab8BvwG/Ab8BvwG/Ab8BvwG/Ab8BvwG/Ab8BvwG/Ab8BvwEAvwELQQAhAyACQQA2AhwgAkGvCzYCECACQQI2AgwgAiABQQFqNgIUDI4DCyABIARGBEBBGyEDDI4DCyABLQAAIgBBO0cEQCAAQQ1HDbECIAFBAWohAQy6AQsgAUEBaiEBC0EiIQMM8wILIAEgBEYEQEEcIQMMjAMLQgAhCgJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkAgAS0AAEEwaw43wQLAAgABAgMEBQYH0AHQAdAB0AHQAdAB0AEICQoLDA3QAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdABDg8QERIT0AELQgIhCgzAAgtCAyEKDL8CC0IEIQoMvgILQgUhCgy9AgtCBiEKDLwCC0IHIQoMuwILQgghCgy6AgtCCSEKDLkCC0IKIQoMuAILQgshCgy3AgtCDCEKDLYCC0INIQoMtQILQg4hCgy0AgtCDyEKDLMCC0IKIQoMsgILQgshCgyxAgtCDCEKDLACC0INIQoMrwILQg4hCgyuAgtCDyEKDK0CC0IAIQoCQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAIAEtAABBMGsON8ACvwIAAQIDBAUGB74CvgK+Ar4CvgK+Ar4CCAkKCwwNvgK+Ar4CvgK+Ar4CvgK+Ar4CvgK+Ar4CvgK+Ar4CvgK+Ar4CvgK+Ar4CvgK+Ar4CvgK+Ag4PEBESE74CC0ICIQoMvwILQgMhCgy+AgtCBCEKDL0CC0IFIQoMvAILQgYhCgy7AgtCByEKDLoCC0IIIQoMuQILQgkhCgy4AgtCCiEKDLcCC0ILIQoMtgILQgwhCgy1AgtCDSEKDLQCC0IOIQoMswILQg8hCgyyAgtCCiEKDLECC0ILIQoMsAILQgwhCgyvAgtCDSEKDK4CC0IOIQoMrQILQg8hCgysAgsgAiACKQMgIgogBCABa60iC30iDEIAIAogDFobNwMgIAogC1gNpwJBHyEDDIkDCyABIARHBEAgAkEJNgIIIAIgATYCBEElIQMM8AILQSAhAwyIAwtBASEFIAIvATAiA0EIcUUEQCACKQMgQgBSIQULAkAgAi0ALgRAQQEhACACLQApQQVGDQEgA0HAAHFFIAVxRQ0BC0EAIQAgA0HAAHENAEECIQAgA0EIcQ0AIANBgARxBEACQCACLQAoQQFHDQAgAi0ALUEKcQ0AQQUhAAwCC0EEIQAMAQsgA0EgcUUEQAJAIAItAChBAUYNACACLwEyIgBB5ABrQeQASQ0AIABBzAFGDQAgAEGwAkYNAEEEIQAgA0EocUUNAiADQYgEcUGABEYNAgtBACEADAELQQBBAyACKQMgUBshAAsgAEEBaw4FvgIAsAEBpAKhAgtBESEDDO0CCyACQQE6AC8MhAMLIAEgBEcNnQJBJCEDDIQDCyABIARHDRxBxgAhAwyDAwtBACEAAkAgAigCOCIDRQ0AIAMoAkQiA0UNACACIAMRAAAhAAsgAEUNJyAAQRVHDZgCIAJB0AA2AhwgAiABNgIUIAJBkRg2AhAgAkEVNgIMQQAhAwyCAwsgASAERgRAQSghAwyCAwtBACEDIAJBADYCBCACQQw2AgggAiABIAEQKiIARQ2UAiACQSc2AhwgAiABNgIUIAIgADYCDAyBAwsgASAERgRAQSkhAwyBAwsgAS0AACIAQSBGDRMgAEEJRw2VAiABQQFqIQEMFAsgASAERwRAIAFBAWohAQwWC0EqIQMM/wILIAEgBEYEQEErIQMM/wILIAEtAAAiAEEJRyAAQSBHcQ2QAiACLQAsQQhHDd0CIAJBADoALAzdAgsgASAERgRAQSwhAwz+AgsgAS0AAEEKRw2OAiABQQFqIQEMsAELIAEgBEcNigJBLyEDDPwCCwNAIAEtAAAiAEEgRwRAIABBCmsOBIQCiAKIAoQChgILIAQgAUEBaiIBRw0AC0ExIQMM+wILQTIhAyABIARGDfoCIAIoAgAiACAEIAFraiEHIAEgAGtBA2ohBgJAA0AgAEHwO2otAAAgAS0AACIFQSByIAUgBUHBAGtB/wFxQRpJG0H/AXFHDQEgAEEDRgRAQQYhAQziAgsgAEEBaiEAIAQgAUEBaiIBRw0ACyACIAc2AgAM+wILIAJBADYCAAyGAgtBMyEDIAQgASIARg35AiAEIAFrIAIoAgAiAWohByAAIAFrQQhqIQYCQANAIAFB9DtqLQAAIAAtAAAiBUEgciAFIAVBwQBrQf8BcUEaSRtB/wFxRw0BIAFBCEYEQEEFIQEM4QILIAFBAWohASAEIABBAWoiAEcNAAsgAiAHNgIADPoCCyACQQA2AgAgACEBDIUCC0E0IQMgBCABIgBGDfgCIAQgAWsgAigCACIBaiEHIAAgAWtBBWohBgJAA0AgAUHQwgBqLQAAIAAtAAAiBUEgciAFIAVBwQBrQf8BcUEaSRtB/wFxRw0BIAFBBUYEQEEHIQEM4AILIAFBAWohASAEIABBAWoiAEcNAAsgAiAHNgIADPkCCyACQQA2AgAgACEBDIQCCyABIARHBEADQCABLQAAQYA+ai0AACIAQQFHBEAgAEECRg0JDIECCyAEIAFBAWoiAUcNAAtBMCEDDPgCC0EwIQMM9wILIAEgBEcEQANAIAEtAAAiAEEgRwRAIABBCmsOBP8B/gH+Af8B/gELIAQgAUEBaiIBRw0AC0E4IQMM9wILQTghAwz2AgsDQCABLQAAIgBBIEcgAEEJR3EN9gEgBCABQQFqIgFHDQALQTwhAwz1AgsDQCABLQAAIgBBIEcEQAJAIABBCmsOBPkBBAT5AQALIABBLEYN9QEMAwsgBCABQQFqIgFHDQALQT8hAwz0AgtBwAAhAyABIARGDfMCIAIoAgAiACAEIAFraiEFIAEgAGtBBmohBgJAA0AgAEGAQGstAAAgAS0AAEEgckcNASAAQQZGDdsCIABBAWohACAEIAFBAWoiAUcNAAsgAiAFNgIADPQCCyACQQA2AgALQTYhAwzZAgsgASAERgRAQcEAIQMM8gILIAJBDDYCCCACIAE2AgQgAi0ALEEBaw4E+wHuAewB6wHUAgsgAUEBaiEBDPoBCyABIARHBEADQAJAIAEtAAAiAEEgciAAIABBwQBrQf8BcUEaSRtB/wFxIgBBCUYNACAAQSBGDQACQAJAAkACQCAAQeMAaw4TAAMDAwMDAwMBAwMDAwMDAwMDAgMLIAFBAWohAUExIQMM3AILIAFBAWohAUEyIQMM2wILIAFBAWohAUEzIQMM2gILDP4BCyAEIAFBAWoiAUcNAAtBNSEDDPACC0E1IQMM7wILIAEgBEcEQANAIAEtAABBgDxqLQAAQQFHDfcBIAQgAUEBaiIBRw0AC0E9IQMM7wILQT0hAwzuAgtBACEAAkAgAigCOCIDRQ0AIAMoAkAiA0UNACACIAMRAAAhAAsgAEUNASAAQRVHDeYBIAJBwgA2AhwgAiABNgIUIAJB4xg2AhAgAkEVNgIMQQAhAwztAgsgAUEBaiEBC0E8IQMM0gILIAEgBEYEQEHCACEDDOsCCwJAA0ACQCABLQAAQQlrDhgAAswCzALRAswCzALMAswCzALMAswCzALMAswCzALMAswCzALMAswCzALMAgDMAgsgBCABQQFqIgFHDQALQcIAIQMM6wILIAFBAWohASACLQAtQQFxRQ3+AQtBLCEDDNACCyABIARHDd4BQcQAIQMM6AILA0AgAS0AAEGQwABqLQAAQQFHDZwBIAQgAUEBaiIBRw0AC0HFACEDDOcCCyABLQAAIgBBIEYN/gEgAEE6Rw3AAiACKAIEIQBBACEDIAJBADYCBCACIAAgARApIgAN3gEM3QELQccAIQMgBCABIgBGDeUCIAQgAWsgAigCACIBaiEHIAAgAWtBBWohBgNAIAFBkMIAai0AACAALQAAIgVBIHIgBSAFQcEAa0H/AXFBGkkbQf8BcUcNvwIgAUEFRg3CAiABQQFqIQEgBCAAQQFqIgBHDQALIAIgBzYCAAzlAgtByAAhAyAEIAEiAEYN5AIgBCABayACKAIAIgFqIQcgACABa0EJaiEGA0AgAUGWwgBqLQAAIAAtAAAiBUEgciAFIAVBwQBrQf8BcUEaSRtB/wFxRw2+AkECIAFBCUYNwgIaIAFBAWohASAEIABBAWoiAEcNAAsgAiAHNgIADOQCCyABIARGBEBByQAhAwzkAgsCQAJAIAEtAAAiAEEgciAAIABBwQBrQf8BcUEaSRtB/wFxQe4Aaw4HAL8CvwK/Ar8CvwIBvwILIAFBAWohAUE+IQMMywILIAFBAWohAUE/IQMMygILQcoAIQMgBCABIgBGDeICIAQgAWsgAigCACIBaiEGIAAgAWtBAWohBwNAIAFBoMIAai0AACAALQAAIgVBIHIgBSAFQcEAa0H/AXFBGkkbQf8BcUcNvAIgAUEBRg2+AiABQQFqIQEgBCAAQQFqIgBHDQALIAIgBjYCAAziAgtBywAhAyAEIAEiAEYN4QIgBCABayACKAIAIgFqIQcgACABa0EOaiEGA0AgAUGiwgBqLQAAIAAtAAAiBUEgciAFIAVBwQBrQf8BcUEaSRtB/wFxRw27AiABQQ5GDb4CIAFBAWohASAEIABBAWoiAEcNAAsgAiAHNgIADOECC0HMACEDIAQgASIARg3gAiAEIAFrIAIoAgAiAWohByAAIAFrQQ9qIQYDQCABQcDCAGotAAAgAC0AACIFQSByIAUgBUHBAGtB/wFxQRpJG0H/AXFHDboCQQMgAUEPRg2+AhogAUEBaiEBIAQgAEEBaiIARw0ACyACIAc2AgAM4AILQc0AIQMgBCABIgBGDd8CIAQgAWsgAigCACIBaiEHIAAgAWtBBWohBgNAIAFB0MIAai0AACAALQAAIgVBIHIgBSAFQcEAa0H/AXFBGkkbQf8BcUcNuQJBBCABQQVGDb0CGiABQQFqIQEgBCAAQQFqIgBHDQALIAIgBzYCAAzfAgsgASAERgRAQc4AIQMM3wILAkACQAJAAkAgAS0AACIAQSByIAAgAEHBAGtB/wFxQRpJG0H/AXFB4wBrDhMAvAK8ArwCvAK8ArwCvAK8ArwCvAK8ArwCAbwCvAK8AgIDvAILIAFBAWohAUHBACEDDMgCCyABQQFqIQFBwgAhAwzHAgsgAUEBaiEBQcMAIQMMxgILIAFBAWohAUHEACEDDMUCCyABIARHBEAgAkENNgIIIAIgATYCBEHFACEDDMUCC0HPACEDDN0CCwJAAkAgAS0AAEEKaw4EAZABkAEAkAELIAFBAWohAQtBKCEDDMMCCyABIARGBEBB0QAhAwzcAgsgAS0AAEEgRw0AIAFBAWohASACLQAtQQFxRQ3QAQtBFyEDDMECCyABIARHDcsBQdIAIQMM2QILQdMAIQMgASAERg3YAiACKAIAIgAgBCABa2ohBiABIABrQQFqIQUDQCABLQAAIABB1sIAai0AAEcNxwEgAEEBRg3KASAAQQFqIQAgBCABQQFqIgFHDQALIAIgBjYCAAzYAgsgASAERgRAQdUAIQMM2AILIAEtAABBCkcNwgEgAUEBaiEBDMoBCyABIARGBEBB1gAhAwzXAgsCQAJAIAEtAABBCmsOBADDAcMBAcMBCyABQQFqIQEMygELIAFBAWohAUHKACEDDL0CC0EAIQACQCACKAI4IgNFDQAgAygCPCIDRQ0AIAIgAxEAACEACyAADb8BQc0AIQMMvAILIAItAClBIkYNzwIMiQELIAQgASIFRgRAQdsAIQMM1AILQQAhAEEBIQFBASEGQQAhAwJAAn8CQAJAAkACQAJAAkACQCAFLQAAQTBrDgrFAcQBAAECAwQFBgjDAQtBAgwGC0EDDAULQQQMBAtBBQwDC0EGDAILQQcMAQtBCAshA0EAIQFBACEGDL0BC0EJIQNBASEAQQAhAUEAIQYMvAELIAEgBEYEQEHdACEDDNMCCyABLQAAQS5HDbgBIAFBAWohAQyIAQsgASAERw22AUHfACEDDNECCyABIARHBEAgAkEONgIIIAIgATYCBEHQACEDDLgCC0HgACEDDNACC0HhACEDIAEgBEYNzwIgAigCACIAIAQgAWtqIQUgASAAa0EDaiEGA0AgAS0AACAAQeLCAGotAABHDbEBIABBA0YNswEgAEEBaiEAIAQgAUEBaiIBRw0ACyACIAU2AgAMzwILQeIAIQMgASAERg3OAiACKAIAIgAgBCABa2ohBSABIABrQQJqIQYDQCABLQAAIABB5sIAai0AAEcNsAEgAEECRg2vASAAQQFqIQAgBCABQQFqIgFHDQALIAIgBTYCAAzOAgtB4wAhAyABIARGDc0CIAIoAgAiACAEIAFraiEFIAEgAGtBA2ohBgNAIAEtAAAgAEHpwgBqLQAARw2vASAAQQNGDa0BIABBAWohACAEIAFBAWoiAUcNAAsgAiAFNgIADM0CCyABIARGBEBB5QAhAwzNAgsgAUEBaiEBQQAhAAJAIAIoAjgiA0UNACADKAIwIgNFDQAgAiADEQAAIQALIAANqgFB1gAhAwyzAgsgASAERwRAA0AgAS0AACIAQSBHBEACQAJAAkAgAEHIAGsOCwABswGzAbMBswGzAbMBswGzAQKzAQsgAUEBaiEBQdIAIQMMtwILIAFBAWohAUHTACEDDLYCCyABQQFqIQFB1AAhAwy1AgsgBCABQQFqIgFHDQALQeQAIQMMzAILQeQAIQMMywILA0AgAS0AAEHwwgBqLQAAIgBBAUcEQCAAQQJrDgOnAaYBpQGkAQsgBCABQQFqIgFHDQALQeYAIQMMygILIAFBAWogASAERw0CGkHnACEDDMkCCwNAIAEtAABB8MQAai0AACIAQQFHBEACQCAAQQJrDgSiAaEBoAEAnwELQdcAIQMMsQILIAQgAUEBaiIBRw0AC0HoACEDDMgCCyABIARGBEBB6QAhAwzIAgsCQCABLQAAIgBBCmsOGrcBmwGbAbQBmwGbAZsBmwGbAZsBmwGbAZsBmwGbAZsBmwGbAZsBmwGbAZsBpAGbAZsBAJkBCyABQQFqCyEBQQYhAwytAgsDQCABLQAAQfDGAGotAABBAUcNfSAEIAFBAWoiAUcNAAtB6gAhAwzFAgsgAUEBaiABIARHDQIaQesAIQMMxAILIAEgBEYEQEHsACEDDMQCCyABQQFqDAELIAEgBEYEQEHtACEDDMMCCyABQQFqCyEBQQQhAwyoAgsgASAERgRAQe4AIQMMwQILAkACQAJAIAEtAABB8MgAai0AAEEBaw4HkAGPAY4BAHwBAo0BCyABQQFqIQEMCwsgAUEBagyTAQtBACEDIAJBADYCHCACQZsSNgIQIAJBBzYCDCACIAFBAWo2AhQMwAILAkADQCABLQAAQfDIAGotAAAiAEEERwRAAkACQCAAQQFrDgeUAZMBkgGNAQAEAY0BC0HaACEDDKoCCyABQQFqIQFB3AAhAwypAgsgBCABQQFqIgFHDQALQe8AIQMMwAILIAFBAWoMkQELIAQgASIARgRAQfAAIQMMvwILIAAtAABBL0cNASAAQQFqIQEMBwsgBCABIgBGBEBB8QAhAwy+AgsgAC0AACIBQS9GBEAgAEEBaiEBQd0AIQMMpQILIAFBCmsiA0EWSw0AIAAhAUEBIAN0QYmAgAJxDfkBC0EAIQMgAkEANgIcIAIgADYCFCACQYwcNgIQIAJBBzYCDAy8AgsgASAERwRAIAFBAWohAUHeACEDDKMCC0HyACEDDLsCCyABIARGBEBB9AAhAwy7AgsCQCABLQAAQfDMAGotAABBAWsOA/cBcwCCAQtB4QAhAwyhAgsgASAERwRAA0AgAS0AAEHwygBqLQAAIgBBA0cEQAJAIABBAWsOAvkBAIUBC0HfACEDDKMCCyAEIAFBAWoiAUcNAAtB8wAhAwy6AgtB8wAhAwy5AgsgASAERwRAIAJBDzYCCCACIAE2AgRB4AAhAwygAgtB9QAhAwy4AgsgASAERgRAQfYAIQMMuAILIAJBDzYCCCACIAE2AgQLQQMhAwydAgsDQCABLQAAQSBHDY4CIAQgAUEBaiIBRw0AC0H3ACEDDLUCCyABIARGBEBB+AAhAwy1AgsgAS0AAEEgRw16IAFBAWohAQxbC0EAIQACQCACKAI4IgNFDQAgAygCOCIDRQ0AIAIgAxEAACEACyAADXgMgAILIAEgBEYEQEH6ACEDDLMCCyABLQAAQcwARw10IAFBAWohAUETDHYLQfsAIQMgASAERg2xAiACKAIAIgAgBCABa2ohBSABIABrQQVqIQYDQCABLQAAIABB8M4Aai0AAEcNcyAAQQVGDXUgAEEBaiEAIAQgAUEBaiIBRw0ACyACIAU2AgAMsQILIAEgBEYEQEH8ACEDDLECCwJAAkAgAS0AAEHDAGsODAB0dHR0dHR0dHR0AXQLIAFBAWohAUHmACEDDJgCCyABQQFqIQFB5wAhAwyXAgtB/QAhAyABIARGDa8CIAIoAgAiACAEIAFraiEFIAEgAGtBAmohBgJAA0AgAS0AACAAQe3PAGotAABHDXIgAEECRg0BIABBAWohACAEIAFBAWoiAUcNAAsgAiAFNgIADLACCyACQQA2AgAgBkEBaiEBQRAMcwtB/gAhAyABIARGDa4CIAIoAgAiACAEIAFraiEFIAEgAGtBBWohBgJAA0AgAS0AACAAQfbOAGotAABHDXEgAEEFRg0BIABBAWohACAEIAFBAWoiAUcNAAsgAiAFNgIADK8CCyACQQA2AgAgBkEBaiEBQRYMcgtB/wAhAyABIARGDa0CIAIoAgAiACAEIAFraiEFIAEgAGtBA2ohBgJAA0AgAS0AACAAQfzOAGotAABHDXAgAEEDRg0BIABBAWohACAEIAFBAWoiAUcNAAsgAiAFNgIADK4CCyACQQA2AgAgBkEBaiEBQQUMcQsgASAERgRAQYABIQMMrQILIAEtAABB2QBHDW4gAUEBaiEBQQgMcAsgASAERgRAQYEBIQMMrAILAkACQCABLQAAQc4Aaw4DAG8BbwsgAUEBaiEBQesAIQMMkwILIAFBAWohAUHsACEDDJICCyABIARGBEBBggEhAwyrAgsCQAJAIAEtAABByABrDggAbm5ubm5uAW4LIAFBAWohAUHqACEDDJICCyABQQFqIQFB7QAhAwyRAgtBgwEhAyABIARGDakCIAIoAgAiACAEIAFraiEFIAEgAGtBAmohBgJAA0AgAS0AACAAQYDPAGotAABHDWwgAEECRg0BIABBAWohACAEIAFBAWoiAUcNAAsgAiAFNgIADKoCCyACQQA2AgAgBkEBaiEBQQAMbQtBhAEhAyABIARGDagCIAIoAgAiACAEIAFraiEFIAEgAGtBBGohBgJAA0AgAS0AACAAQYPPAGotAABHDWsgAEEERg0BIABBAWohACAEIAFBAWoiAUcNAAsgAiAFNgIADKkCCyACQQA2AgAgBkEBaiEBQSMMbAsgASAERgRAQYUBIQMMqAILAkACQCABLQAAQcwAaw4IAGtra2trawFrCyABQQFqIQFB7wAhAwyPAgsgAUEBaiEBQfAAIQMMjgILIAEgBEYEQEGGASEDDKcCCyABLQAAQcUARw1oIAFBAWohAQxgC0GHASEDIAEgBEYNpQIgAigCACIAIAQgAWtqIQUgASAAa0EDaiEGAkADQCABLQAAIABBiM8Aai0AAEcNaCAAQQNGDQEgAEEBaiEAIAQgAUEBaiIBRw0ACyACIAU2AgAMpgILIAJBADYCACAGQQFqIQFBLQxpC0GIASEDIAEgBEYNpAIgAigCACIAIAQgAWtqIQUgASAAa0EIaiEGAkADQCABLQAAIABB0M8Aai0AAEcNZyAAQQhGDQEgAEEBaiEAIAQgAUEBaiIBRw0ACyACIAU2AgAMpQILIAJBADYCACAGQQFqIQFBKQxoCyABIARGBEBBiQEhAwykAgtBASABLQAAQd8ARw1nGiABQQFqIQEMXgtBigEhAyABIARGDaICIAIoAgAiACAEIAFraiEFIAEgAGtBAWohBgNAIAEtAAAgAEGMzwBqLQAARw1kIABBAUYN+gEgAEEBaiEAIAQgAUEBaiIBRw0ACyACIAU2AgAMogILQYsBIQMgASAERg2hAiACKAIAIgAgBCABa2ohBSABIABrQQJqIQYCQANAIAEtAAAgAEGOzwBqLQAARw1kIABBAkYNASAAQQFqIQAgBCABQQFqIgFHDQALIAIgBTYCAAyiAgsgAkEANgIAIAZBAWohAUECDGULQYwBIQMgASAERg2gAiACKAIAIgAgBCABa2ohBSABIABrQQFqIQYCQANAIAEtAAAgAEHwzwBqLQAARw1jIABBAUYNASAAQQFqIQAgBCABQQFqIgFHDQALIAIgBTYCAAyhAgsgAkEANgIAIAZBAWohAUEfDGQLQY0BIQMgASAERg2fAiACKAIAIgAgBCABa2ohBSABIABrQQFqIQYCQANAIAEtAAAgAEHyzwBqLQAARw1iIABBAUYNASAAQQFqIQAgBCABQQFqIgFHDQALIAIgBTYCAAygAgsgAkEANgIAIAZBAWohAUEJDGMLIAEgBEYEQEGOASEDDJ8CCwJAAkAgAS0AAEHJAGsOBwBiYmJiYgFiCyABQQFqIQFB+AAhAwyGAgsgAUEBaiEBQfkAIQMMhQILQY8BIQMgASAERg2dAiACKAIAIgAgBCABa2ohBSABIABrQQVqIQYCQANAIAEtAAAgAEGRzwBqLQAARw1gIABBBUYNASAAQQFqIQAgBCABQQFqIgFHDQALIAIgBTYCAAyeAgsgAkEANgIAIAZBAWohAUEYDGELQZABIQMgASAERg2cAiACKAIAIgAgBCABa2ohBSABIABrQQJqIQYCQANAIAEtAAAgAEGXzwBqLQAARw1fIABBAkYNASAAQQFqIQAgBCABQQFqIgFHDQALIAIgBTYCAAydAgsgAkEANgIAIAZBAWohAUEXDGALQZEBIQMgASAERg2bAiACKAIAIgAgBCABa2ohBSABIABrQQZqIQYCQANAIAEtAAAgAEGazwBqLQAARw1eIABBBkYNASAAQQFqIQAgBCABQQFqIgFHDQALIAIgBTYCAAycAgsgAkEANgIAIAZBAWohAUEVDF8LQZIBIQMgASAERg2aAiACKAIAIgAgBCABa2ohBSABIABrQQVqIQYCQANAIAEtAAAgAEGhzwBqLQAARw1dIABBBUYNASAAQQFqIQAgBCABQQFqIgFHDQALIAIgBTYCAAybAgsgAkEANgIAIAZBAWohAUEeDF4LIAEgBEYEQEGTASEDDJoCCyABLQAAQcwARw1bIAFBAWohAUEKDF0LIAEgBEYEQEGUASEDDJkCCwJAAkAgAS0AAEHBAGsODwBcXFxcXFxcXFxcXFxcAVwLIAFBAWohAUH+ACEDDIACCyABQQFqIQFB/wAhAwz/AQsgASAERgRAQZUBIQMMmAILAkACQCABLQAAQcEAaw4DAFsBWwsgAUEBaiEBQf0AIQMM/wELIAFBAWohAUGAASEDDP4BC0GWASEDIAEgBEYNlgIgAigCACIAIAQgAWtqIQUgASAAa0EBaiEGAkADQCABLQAAIABBp88Aai0AAEcNWSAAQQFGDQEgAEEBaiEAIAQgAUEBaiIBRw0ACyACIAU2AgAMlwILIAJBADYCACAGQQFqIQFBCwxaCyABIARGBEBBlwEhAwyWAgsCQAJAAkACQCABLQAAQS1rDiMAW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1sBW1tbW1sCW1tbA1sLIAFBAWohAUH7ACEDDP8BCyABQQFqIQFB/AAhAwz+AQsgAUEBaiEBQYEBIQMM/QELIAFBAWohAUGCASEDDPwBC0GYASEDIAEgBEYNlAIgAigCACIAIAQgAWtqIQUgASAAa0EEaiEGAkADQCABLQAAIABBqc8Aai0AAEcNVyAAQQRGDQEgAEEBaiEAIAQgAUEBaiIBRw0ACyACIAU2AgAMlQILIAJBADYCACAGQQFqIQFBGQxYC0GZASEDIAEgBEYNkwIgAigCACIAIAQgAWtqIQUgASAAa0EFaiEGAkADQCABLQAAIABBrs8Aai0AAEcNViAAQQVGDQEgAEEBaiEAIAQgAUEBaiIBRw0ACyACIAU2AgAMlAILIAJBADYCACAGQQFqIQFBBgxXC0GaASEDIAEgBEYNkgIgAigCACIAIAQgAWtqIQUgASAAa0EBaiEGAkADQCABLQAAIABBtM8Aai0AAEcNVSAAQQFGDQEgAEEBaiEAIAQgAUEBaiIBRw0ACyACIAU2AgAMkwILIAJBADYCACAGQQFqIQFBHAxWC0GbASEDIAEgBEYNkQIgAigCACIAIAQgAWtqIQUgASAAa0EBaiEGAkADQCABLQAAIABBts8Aai0AAEcNVCAAQQFGDQEgAEEBaiEAIAQgAUEBaiIBRw0ACyACIAU2AgAMkgILIAJBADYCACAGQQFqIQFBJwxVCyABIARGBEBBnAEhAwyRAgsCQAJAIAEtAABB1ABrDgIAAVQLIAFBAWohAUGGASEDDPgBCyABQQFqIQFBhwEhAwz3AQtBnQEhAyABIARGDY8CIAIoAgAiACAEIAFraiEFIAEgAGtBAWohBgJAA0AgAS0AACAAQbjPAGotAABHDVIgAEEBRg0BIABBAWohACAEIAFBAWoiAUcNAAsgAiAFNgIADJACCyACQQA2AgAgBkEBaiEBQSYMUwtBngEhAyABIARGDY4CIAIoAgAiACAEIAFraiEFIAEgAGtBAWohBgJAA0AgAS0AACAAQbrPAGotAABHDVEgAEEBRg0BIABBAWohACAEIAFBAWoiAUcNAAsgAiAFNgIADI8CCyACQQA2AgAgBkEBaiEBQQMMUgtBnwEhAyABIARGDY0CIAIoAgAiACAEIAFraiEFIAEgAGtBAmohBgJAA0AgAS0AACAAQe3PAGotAABHDVAgAEECRg0BIABBAWohACAEIAFBAWoiAUcNAAsgAiAFNgIADI4CCyACQQA2AgAgBkEBaiEBQQwMUQtBoAEhAyABIARGDYwCIAIoAgAiACAEIAFraiEFIAEgAGtBA2ohBgJAA0AgAS0AACAAQbzPAGotAABHDU8gAEEDRg0BIABBAWohACAEIAFBAWoiAUcNAAsgAiAFNgIADI0CCyACQQA2AgAgBkEBaiEBQQ0MUAsgASAERgRAQaEBIQMMjAILAkACQCABLQAAQcYAaw4LAE9PT09PT09PTwFPCyABQQFqIQFBiwEhAwzzAQsgAUEBaiEBQYwBIQMM8gELIAEgBEYEQEGiASEDDIsCCyABLQAAQdAARw1MIAFBAWohAQxGCyABIARGBEBBowEhAwyKAgsCQAJAIAEtAABByQBrDgcBTU1NTU0ATQsgAUEBaiEBQY4BIQMM8QELIAFBAWohAUEiDE0LQaQBIQMgASAERg2IAiACKAIAIgAgBCABa2ohBSABIABrQQFqIQYCQANAIAEtAAAgAEHAzwBqLQAARw1LIABBAUYNASAAQQFqIQAgBCABQQFqIgFHDQALIAIgBTYCAAyJAgsgAkEANgIAIAZBAWohAUEdDEwLIAEgBEYEQEGlASEDDIgCCwJAAkAgAS0AAEHSAGsOAwBLAUsLIAFBAWohAUGQASEDDO8BCyABQQFqIQFBBAxLCyABIARGBEBBpgEhAwyHAgsCQAJAAkACQAJAIAEtAABBwQBrDhUATU1NTU1NTU1NTQFNTQJNTQNNTQRNCyABQQFqIQFBiAEhAwzxAQsgAUEBaiEBQYkBIQMM8AELIAFBAWohAUGKASEDDO8BCyABQQFqIQFBjwEhAwzuAQsgAUEBaiEBQZEBIQMM7QELQacBIQMgASAERg2FAiACKAIAIgAgBCABa2ohBSABIABrQQJqIQYCQANAIAEtAAAgAEHtzwBqLQAARw1IIABBAkYNASAAQQFqIQAgBCABQQFqIgFHDQALIAIgBTYCAAyGAgsgAkEANgIAIAZBAWohAUERDEkLQagBIQMgASAERg2EAiACKAIAIgAgBCABa2ohBSABIABrQQJqIQYCQANAIAEtAAAgAEHCzwBqLQAARw1HIABBAkYNASAAQQFqIQAgBCABQQFqIgFHDQALIAIgBTYCAAyFAgsgAkEANgIAIAZBAWohAUEsDEgLQakBIQMgASAERg2DAiACKAIAIgAgBCABa2ohBSABIABrQQRqIQYCQANAIAEtAAAgAEHFzwBqLQAARw1GIABBBEYNASAAQQFqIQAgBCABQQFqIgFHDQALIAIgBTYCAAyEAgsgAkEANgIAIAZBAWohAUErDEcLQaoBIQMgASAERg2CAiACKAIAIgAgBCABa2ohBSABIABrQQJqIQYCQANAIAEtAAAgAEHKzwBqLQAARw1FIABBAkYNASAAQQFqIQAgBCABQQFqIgFHDQALIAIgBTYCAAyDAgsgAkEANgIAIAZBAWohAUEUDEYLIAEgBEYEQEGrASEDDIICCwJAAkACQAJAIAEtAABBwgBrDg8AAQJHR0dHR0dHR0dHRwNHCyABQQFqIQFBkwEhAwzrAQsgAUEBaiEBQZQBIQMM6gELIAFBAWohAUGVASEDDOkBCyABQQFqIQFBlgEhAwzoAQsgASAERgRAQawBIQMMgQILIAEtAABBxQBHDUIgAUEBaiEBDD0LQa0BIQMgASAERg3/ASACKAIAIgAgBCABa2ohBSABIABrQQJqIQYCQANAIAEtAAAgAEHNzwBqLQAARw1CIABBAkYNASAAQQFqIQAgBCABQQFqIgFHDQALIAIgBTYCAAyAAgsgAkEANgIAIAZBAWohAUEODEMLIAEgBEYEQEGuASEDDP8BCyABLQAAQdAARw1AIAFBAWohAUElDEILQa8BIQMgASAERg39ASACKAIAIgAgBCABa2ohBSABIABrQQhqIQYCQANAIAEtAAAgAEHQzwBqLQAARw1AIABBCEYNASAAQQFqIQAgBCABQQFqIgFHDQALIAIgBTYCAAz+AQsgAkEANgIAIAZBAWohAUEqDEELIAEgBEYEQEGwASEDDP0BCwJAAkAgAS0AAEHVAGsOCwBAQEBAQEBAQEABQAsgAUEBaiEBQZoBIQMM5AELIAFBAWohAUGbASEDDOMBCyABIARGBEBBsQEhAwz8AQsCQAJAIAEtAABBwQBrDhQAPz8/Pz8/Pz8/Pz8/Pz8/Pz8/AT8LIAFBAWohAUGZASEDDOMBCyABQQFqIQFBnAEhAwziAQtBsgEhAyABIARGDfoBIAIoAgAiACAEIAFraiEFIAEgAGtBA2ohBgJAA0AgAS0AACAAQdnPAGotAABHDT0gAEEDRg0BIABBAWohACAEIAFBAWoiAUcNAAsgAiAFNgIADPsBCyACQQA2AgAgBkEBaiEBQSEMPgtBswEhAyABIARGDfkBIAIoAgAiACAEIAFraiEFIAEgAGtBBmohBgJAA0AgAS0AACAAQd3PAGotAABHDTwgAEEGRg0BIABBAWohACAEIAFBAWoiAUcNAAsgAiAFNgIADPoBCyACQQA2AgAgBkEBaiEBQRoMPQsgASAERgRAQbQBIQMM+QELAkACQAJAIAEtAABBxQBrDhEAPT09PT09PT09AT09PT09Aj0LIAFBAWohAUGdASEDDOEBCyABQQFqIQFBngEhAwzgAQsgAUEBaiEBQZ8BIQMM3wELQbUBIQMgASAERg33ASACKAIAIgAgBCABa2ohBSABIABrQQVqIQYCQANAIAEtAAAgAEHkzwBqLQAARw06IABBBUYNASAAQQFqIQAgBCABQQFqIgFHDQALIAIgBTYCAAz4AQsgAkEANgIAIAZBAWohAUEoDDsLQbYBIQMgASAERg32ASACKAIAIgAgBCABa2ohBSABIABrQQJqIQYCQANAIAEtAAAgAEHqzwBqLQAARw05IABBAkYNASAAQQFqIQAgBCABQQFqIgFHDQALIAIgBTYCAAz3AQsgAkEANgIAIAZBAWohAUEHDDoLIAEgBEYEQEG3ASEDDPYBCwJAAkAgAS0AAEHFAGsODgA5OTk5OTk5OTk5OTkBOQsgAUEBaiEBQaEBIQMM3QELIAFBAWohAUGiASEDDNwBC0G4ASEDIAEgBEYN9AEgAigCACIAIAQgAWtqIQUgASAAa0ECaiEGAkADQCABLQAAIABB7c8Aai0AAEcNNyAAQQJGDQEgAEEBaiEAIAQgAUEBaiIBRw0ACyACIAU2AgAM9QELIAJBADYCACAGQQFqIQFBEgw4C0G5ASEDIAEgBEYN8wEgAigCACIAIAQgAWtqIQUgASAAa0EBaiEGAkADQCABLQAAIABB8M8Aai0AAEcNNiAAQQFGDQEgAEEBaiEAIAQgAUEBaiIBRw0ACyACIAU2AgAM9AELIAJBADYCACAGQQFqIQFBIAw3C0G6ASEDIAEgBEYN8gEgAigCACIAIAQgAWtqIQUgASAAa0EBaiEGAkADQCABLQAAIABB8s8Aai0AAEcNNSAAQQFGDQEgAEEBaiEAIAQgAUEBaiIBRw0ACyACIAU2AgAM8wELIAJBADYCACAGQQFqIQFBDww2CyABIARGBEBBuwEhAwzyAQsCQAJAIAEtAABByQBrDgcANTU1NTUBNQsgAUEBaiEBQaUBIQMM2QELIAFBAWohAUGmASEDDNgBC0G8ASEDIAEgBEYN8AEgAigCACIAIAQgAWtqIQUgASAAa0EHaiEGAkADQCABLQAAIABB9M8Aai0AAEcNMyAAQQdGDQEgAEEBaiEAIAQgAUEBaiIBRw0ACyACIAU2AgAM8QELIAJBADYCACAGQQFqIQFBGww0CyABIARGBEBBvQEhAwzwAQsCQAJAAkAgAS0AAEHCAGsOEgA0NDQ0NDQ0NDQBNDQ0NDQ0AjQLIAFBAWohAUGkASEDDNgBCyABQQFqIQFBpwEhAwzXAQsgAUEBaiEBQagBIQMM1gELIAEgBEYEQEG+ASEDDO8BCyABLQAAQc4ARw0wIAFBAWohAQwsCyABIARGBEBBvwEhAwzuAQsCQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQCABLQAAQcEAaw4VAAECAz8EBQY/Pz8HCAkKCz8MDQ4PPwsgAUEBaiEBQegAIQMM4wELIAFBAWohAUHpACEDDOIBCyABQQFqIQFB7gAhAwzhAQsgAUEBaiEBQfIAIQMM4AELIAFBAWohAUHzACEDDN8BCyABQQFqIQFB9gAhAwzeAQsgAUEBaiEBQfcAIQMM3QELIAFBAWohAUH6ACEDDNwBCyABQQFqIQFBgwEhAwzbAQsgAUEBaiEBQYQBIQMM2gELIAFBAWohAUGFASEDDNkBCyABQQFqIQFBkgEhAwzYAQsgAUEBaiEBQZgBIQMM1wELIAFBAWohAUGgASEDDNYBCyABQQFqIQFBowEhAwzVAQsgAUEBaiEBQaoBIQMM1AELIAEgBEcEQCACQRA2AgggAiABNgIEQasBIQMM1AELQcABIQMM7AELQQAhAAJAIAIoAjgiA0UNACADKAI0IgNFDQAgAiADEQAAIQALIABFDV4gAEEVRw0HIAJB0QA2AhwgAiABNgIUIAJBsBc2AhAgAkEVNgIMQQAhAwzrAQsgAUEBaiABIARHDQgaQcIBIQMM6gELA0ACQCABLQAAQQprDgQIAAALAAsgBCABQQFqIgFHDQALQcMBIQMM6QELIAEgBEcEQCACQRE2AgggAiABNgIEQQEhAwzQAQtBxAEhAwzoAQsgASAERgRAQcUBIQMM6AELAkACQCABLQAAQQprDgQBKCgAKAsgAUEBagwJCyABQQFqDAULIAEgBEYEQEHGASEDDOcBCwJAAkAgAS0AAEEKaw4XAQsLAQsLCwsLCwsLCwsLCwsLCwsLCwALCyABQQFqIQELQbABIQMMzQELIAEgBEYEQEHIASEDDOYBCyABLQAAQSBHDQkgAkEAOwEyIAFBAWohAUGzASEDDMwBCwNAIAEhAAJAIAEgBEcEQCABLQAAQTBrQf8BcSIDQQpJDQEMJwtBxwEhAwzmAQsCQCACLwEyIgFBmTNLDQAgAiABQQpsIgU7ATIgBUH+/wNxIANB//8Dc0sNACAAQQFqIQEgAiADIAVqIgM7ATIgA0H//wNxQegHSQ0BCwtBACEDIAJBADYCHCACQcEJNgIQIAJBDTYCDCACIABBAWo2AhQM5AELIAJBADYCHCACIAE2AhQgAkHwDDYCECACQRs2AgxBACEDDOMBCyACKAIEIQAgAkEANgIEIAIgACABECYiAA0BIAFBAWoLIQFBrQEhAwzIAQsgAkHBATYCHCACIAA2AgwgAiABQQFqNgIUQQAhAwzgAQsgAigCBCEAIAJBADYCBCACIAAgARAmIgANASABQQFqCyEBQa4BIQMMxQELIAJBwgE2AhwgAiAANgIMIAIgAUEBajYCFEEAIQMM3QELIAJBADYCHCACIAE2AhQgAkGXCzYCECACQQ02AgxBACEDDNwBCyACQQA2AhwgAiABNgIUIAJB4xA2AhAgAkEJNgIMQQAhAwzbAQsgAkECOgAoDKwBC0EAIQMgAkEANgIcIAJBrws2AhAgAkECNgIMIAIgAUEBajYCFAzZAQtBAiEDDL8BC0ENIQMMvgELQSYhAwy9AQtBFSEDDLwBC0EWIQMMuwELQRghAwy6AQtBHCEDDLkBC0EdIQMMuAELQSAhAwy3AQtBISEDDLYBC0EjIQMMtQELQcYAIQMMtAELQS4hAwyzAQtBPSEDDLIBC0HLACEDDLEBC0HOACEDDLABC0HYACEDDK8BC0HZACEDDK4BC0HbACEDDK0BC0HxACEDDKwBC0H0ACEDDKsBC0GNASEDDKoBC0GXASEDDKkBC0GpASEDDKgBC0GvASEDDKcBC0GxASEDDKYBCyACQQA2AgALQQAhAyACQQA2AhwgAiABNgIUIAJB8Rs2AhAgAkEGNgIMDL0BCyACQQA2AgAgBkEBaiEBQSQLOgApIAIoAgQhACACQQA2AgQgAiAAIAEQJyIARQRAQeUAIQMMowELIAJB+QA2AhwgAiABNgIUIAIgADYCDEEAIQMMuwELIABBFUcEQCACQQA2AhwgAiABNgIUIAJBzA42AhAgAkEgNgIMQQAhAwy7AQsgAkH4ADYCHCACIAE2AhQgAkHKGDYCECACQRU2AgxBACEDDLoBCyACQQA2AhwgAiABNgIUIAJBjhs2AhAgAkEGNgIMQQAhAwy5AQsgAkEANgIcIAIgATYCFCACQf4RNgIQIAJBBzYCDEEAIQMMuAELIAJBADYCHCACIAE2AhQgAkGMHDYCECACQQc2AgxBACEDDLcBCyACQQA2AhwgAiABNgIUIAJBww82AhAgAkEHNgIMQQAhAwy2AQsgAkEANgIcIAIgATYCFCACQcMPNgIQIAJBBzYCDEEAIQMMtQELIAIoAgQhACACQQA2AgQgAiAAIAEQJSIARQ0RIAJB5QA2AhwgAiABNgIUIAIgADYCDEEAIQMMtAELIAIoAgQhACACQQA2AgQgAiAAIAEQJSIARQ0gIAJB0wA2AhwgAiABNgIUIAIgADYCDEEAIQMMswELIAIoAgQhACACQQA2AgQgAiAAIAEQJSIARQ0iIAJB0gA2AhwgAiABNgIUIAIgADYCDEEAIQMMsgELIAIoAgQhACACQQA2AgQgAiAAIAEQJSIARQ0OIAJB5QA2AhwgAiABNgIUIAIgADYCDEEAIQMMsQELIAIoAgQhACACQQA2AgQgAiAAIAEQJSIARQ0dIAJB0wA2AhwgAiABNgIUIAIgADYCDEEAIQMMsAELIAIoAgQhACACQQA2AgQgAiAAIAEQJSIARQ0fIAJB0gA2AhwgAiABNgIUIAIgADYCDEEAIQMMrwELIABBP0cNASABQQFqCyEBQQUhAwyUAQtBACEDIAJBADYCHCACIAE2AhQgAkH9EjYCECACQQc2AgwMrAELIAJBADYCHCACIAE2AhQgAkHcCDYCECACQQc2AgxBACEDDKsBCyACKAIEIQAgAkEANgIEIAIgACABECUiAEUNByACQeUANgIcIAIgATYCFCACIAA2AgxBACEDDKoBCyACKAIEIQAgAkEANgIEIAIgACABECUiAEUNFiACQdMANgIcIAIgATYCFCACIAA2AgxBACEDDKkBCyACKAIEIQAgAkEANgIEIAIgACABECUiAEUNGCACQdIANgIcIAIgATYCFCACIAA2AgxBACEDDKgBCyACQQA2AhwgAiABNgIUIAJBxgo2AhAgAkEHNgIMQQAhAwynAQsgAigCBCEAIAJBADYCBCACIAAgARAlIgBFDQMgAkHlADYCHCACIAE2AhQgAiAANgIMQQAhAwymAQsgAigCBCEAIAJBADYCBCACIAAgARAlIgBFDRIgAkHTADYCHCACIAE2AhQgAiAANgIMQQAhAwylAQsgAigCBCEAIAJBADYCBCACIAAgARAlIgBFDRQgAkHSADYCHCACIAE2AhQgAiAANgIMQQAhAwykAQsgAigCBCEAIAJBADYCBCACIAAgARAlIgBFDQAgAkHlADYCHCACIAE2AhQgAiAANgIMQQAhAwyjAQtB1QAhAwyJAQsgAEEVRwRAIAJBADYCHCACIAE2AhQgAkG5DTYCECACQRo2AgxBACEDDKIBCyACQeQANgIcIAIgATYCFCACQeMXNgIQIAJBFTYCDEEAIQMMoQELIAJBADYCACAGQQFqIQEgAi0AKSIAQSNrQQtJDQQCQCAAQQZLDQBBASAAdEHKAHFFDQAMBQtBACEDIAJBADYCHCACIAE2AhQgAkH3CTYCECACQQg2AgwMoAELIAJBADYCACAGQQFqIQEgAi0AKUEhRg0DIAJBADYCHCACIAE2AhQgAkGbCjYCECACQQg2AgxBACEDDJ8BCyACQQA2AgALQQAhAyACQQA2AhwgAiABNgIUIAJBkDM2AhAgAkEINgIMDJ0BCyACQQA2AgAgBkEBaiEBIAItAClBI0kNACACQQA2AhwgAiABNgIUIAJB0wk2AhAgAkEINgIMQQAhAwycAQtB0QAhAwyCAQsgAS0AAEEwayIAQf8BcUEKSQRAIAIgADoAKiABQQFqIQFBzwAhAwyCAQsgAigCBCEAIAJBADYCBCACIAAgARAoIgBFDYYBIAJB3gA2AhwgAiABNgIUIAIgADYCDEEAIQMMmgELIAIoAgQhACACQQA2AgQgAiAAIAEQKCIARQ2GASACQdwANgIcIAIgATYCFCACIAA2AgxBACEDDJkBCyACKAIEIQAgAkEANgIEIAIgACAFECgiAEUEQCAFIQEMhwELIAJB2gA2AhwgAiAFNgIUIAIgADYCDAyYAQtBACEBQQEhAwsgAiADOgArIAVBAWohAwJAAkACQCACLQAtQRBxDQACQAJAAkAgAi0AKg4DAQACBAsgBkUNAwwCCyAADQEMAgsgAUUNAQsgAigCBCEAIAJBADYCBCACIAAgAxAoIgBFBEAgAyEBDAILIAJB2AA2AhwgAiADNgIUIAIgADYCDEEAIQMMmAELIAIoAgQhACACQQA2AgQgAiAAIAMQKCIARQRAIAMhAQyHAQsgAkHZADYCHCACIAM2AhQgAiAANgIMQQAhAwyXAQtBzAAhAwx9CyAAQRVHBEAgAkEANgIcIAIgATYCFCACQZQNNgIQIAJBITYCDEEAIQMMlgELIAJB1wA2AhwgAiABNgIUIAJByRc2AhAgAkEVNgIMQQAhAwyVAQtBACEDIAJBADYCHCACIAE2AhQgAkGAETYCECACQQk2AgwMlAELIAIoAgQhACACQQA2AgQgAiAAIAEQJSIARQ0AIAJB0wA2AhwgAiABNgIUIAIgADYCDEEAIQMMkwELQckAIQMMeQsgAkEANgIcIAIgATYCFCACQcEoNgIQIAJBBzYCDCACQQA2AgBBACEDDJEBCyACKAIEIQBBACEDIAJBADYCBCACIAAgARAlIgBFDQAgAkHSADYCHCACIAE2AhQgAiAANgIMDJABC0HIACEDDHYLIAJBADYCACAFIQELIAJBgBI7ASogAUEBaiEBQQAhAAJAIAIoAjgiA0UNACADKAIwIgNFDQAgAiADEQAAIQALIAANAQtBxwAhAwxzCyAAQRVGBEAgAkHRADYCHCACIAE2AhQgAkHjFzYCECACQRU2AgxBACEDDIwBC0EAIQMgAkEANgIcIAIgATYCFCACQbkNNgIQIAJBGjYCDAyLAQtBACEDIAJBADYCHCACIAE2AhQgAkGgGTYCECACQR42AgwMigELIAEtAABBOkYEQCACKAIEIQBBACEDIAJBADYCBCACIAAgARApIgBFDQEgAkHDADYCHCACIAA2AgwgAiABQQFqNgIUDIoBC0EAIQMgAkEANgIcIAIgATYCFCACQbERNgIQIAJBCjYCDAyJAQsgAUEBaiEBQTshAwxvCyACQcMANgIcIAIgADYCDCACIAFBAWo2AhQMhwELQQAhAyACQQA2AhwgAiABNgIUIAJB8A42AhAgAkEcNgIMDIYBCyACIAIvATBBEHI7ATAMZgsCQCACLwEwIgBBCHFFDQAgAi0AKEEBRw0AIAItAC1BCHFFDQMLIAIgAEH3+wNxQYAEcjsBMAwECyABIARHBEACQANAIAEtAABBMGsiAEH/AXFBCk8EQEE1IQMMbgsgAikDICIKQpmz5syZs+bMGVYNASACIApCCn4iCjcDICAKIACtQv8BgyILQn+FVg0BIAIgCiALfDcDICAEIAFBAWoiAUcNAAtBOSEDDIUBCyACKAIEIQBBACEDIAJBADYCBCACIAAgAUEBaiIBECoiAA0MDHcLQTkhAwyDAQsgAi0AMEEgcQ0GQcUBIQMMaQtBACEDIAJBADYCBCACIAEgARAqIgBFDQQgAkE6NgIcIAIgADYCDCACIAFBAWo2AhQMgQELIAItAChBAUcNACACLQAtQQhxRQ0BC0E3IQMMZgsgAigCBCEAQQAhAyACQQA2AgQgAiAAIAEQKiIABEAgAkE7NgIcIAIgADYCDCACIAFBAWo2AhQMfwsgAUEBaiEBDG4LIAJBCDoALAwECyABQQFqIQEMbQtBACEDIAJBADYCHCACIAE2AhQgAkHkEjYCECACQQQ2AgwMewsgAigCBCEAQQAhAyACQQA2AgQgAiAAIAEQKiIARQ1sIAJBNzYCHCACIAE2AhQgAiAANgIMDHoLIAIgAi8BMEEgcjsBMAtBMCEDDF8LIAJBNjYCHCACIAE2AhQgAiAANgIMDHcLIABBLEcNASABQQFqIQBBASEBAkACQAJAAkACQCACLQAsQQVrDgQDAQIEAAsgACEBDAQLQQIhAQwBC0EEIQELIAJBAToALCACIAIvATAgAXI7ATAgACEBDAELIAIgAi8BMEEIcjsBMCAAIQELQTkhAwxcCyACQQA6ACwLQTQhAwxaCyABIARGBEBBLSEDDHMLAkACQANAAkAgAS0AAEEKaw4EAgAAAwALIAQgAUEBaiIBRw0AC0EtIQMMdAsgAigCBCEAQQAhAyACQQA2AgQgAiAAIAEQKiIARQ0CIAJBLDYCHCACIAE2AhQgAiAANgIMDHMLIAIoAgQhAEEAIQMgAkEANgIEIAIgACABECoiAEUEQCABQQFqIQEMAgsgAkEsNgIcIAIgADYCDCACIAFBAWo2AhQMcgsgAS0AAEENRgRAIAIoAgQhAEEAIQMgAkEANgIEIAIgACABECoiAEUEQCABQQFqIQEMAgsgAkEsNgIcIAIgADYCDCACIAFBAWo2AhQMcgsgAi0ALUEBcQRAQcQBIQMMWQsgAigCBCEAQQAhAyACQQA2AgQgAiAAIAEQKiIADQEMZQtBLyEDDFcLIAJBLjYCHCACIAE2AhQgAiAANgIMDG8LQQAhAyACQQA2AhwgAiABNgIUIAJB8BQ2AhAgAkEDNgIMDG4LQQEhAwJAAkACQAJAIAItACxBBWsOBAMBAgAECyACIAIvATBBCHI7ATAMAwtBAiEDDAELQQQhAwsgAkEBOgAsIAIgAi8BMCADcjsBMAtBKiEDDFMLQQAhAyACQQA2AhwgAiABNgIUIAJB4Q82AhAgAkEKNgIMDGsLQQEhAwJAAkACQAJAAkACQCACLQAsQQJrDgcFBAQDAQIABAsgAiACLwEwQQhyOwEwDAMLQQIhAwwBC0EEIQMLIAJBAToALCACIAIvATAgA3I7ATALQSshAwxSC0EAIQMgAkEANgIcIAIgATYCFCACQasSNgIQIAJBCzYCDAxqC0EAIQMgAkEANgIcIAIgATYCFCACQf0NNgIQIAJBHTYCDAxpCyABIARHBEADQCABLQAAQSBHDUggBCABQQFqIgFHDQALQSUhAwxpC0ElIQMMaAsgAi0ALUEBcQRAQcMBIQMMTwsgAigCBCEAQQAhAyACQQA2AgQgAiAAIAEQKSIABEAgAkEmNgIcIAIgADYCDCACIAFBAWo2AhQMaAsgAUEBaiEBDFwLIAFBAWohASACLwEwIgBBgAFxBEBBACEAAkAgAigCOCIDRQ0AIAMoAlQiA0UNACACIAMRAAAhAAsgAEUNBiAAQRVHDR8gAkEFNgIcIAIgATYCFCACQfkXNgIQIAJBFTYCDEEAIQMMZwsCQCAAQaAEcUGgBEcNACACLQAtQQJxDQBBACEDIAJBADYCHCACIAE2AhQgAkGWEzYCECACQQQ2AgwMZwsgAgJ/IAIvATBBFHFBFEYEQEEBIAItAChBAUYNARogAi8BMkHlAEYMAQsgAi0AKUEFRgs6AC5BACEAAkAgAigCOCIDRQ0AIAMoAiQiA0UNACACIAMRAAAhAAsCQAJAAkACQAJAIAAOFgIBAAQEBAQEBAQEBAQEBAQEBAQEBAMECyACQQE6AC4LIAIgAi8BMEHAAHI7ATALQSchAwxPCyACQSM2AhwgAiABNgIUIAJBpRY2AhAgAkEVNgIMQQAhAwxnC0EAIQMgAkEANgIcIAIgATYCFCACQdULNgIQIAJBETYCDAxmC0EAIQACQCACKAI4IgNFDQAgAygCLCIDRQ0AIAIgAxEAACEACyAADQELQQ4hAwxLCyAAQRVGBEAgAkECNgIcIAIgATYCFCACQbAYNgIQIAJBFTYCDEEAIQMMZAtBACEDIAJBADYCHCACIAE2AhQgAkGnDjYCECACQRI2AgwMYwtBACEDIAJBADYCHCACIAE2AhQgAkGqHDYCECACQQ82AgwMYgsgAigCBCEAQQAhAyACQQA2AgQgAiAAIAEgCqdqIgEQKyIARQ0AIAJBBTYCHCACIAE2AhQgAiAANgIMDGELQQ8hAwxHC0EAIQMgAkEANgIcIAIgATYCFCACQc0TNgIQIAJBDDYCDAxfC0IBIQoLIAFBAWohAQJAIAIpAyAiC0L//////////w9YBEAgAiALQgSGIAqENwMgDAELQQAhAyACQQA2AhwgAiABNgIUIAJBrQk2AhAgAkEMNgIMDF4LQSQhAwxEC0EAIQMgAkEANgIcIAIgATYCFCACQc0TNgIQIAJBDDYCDAxcCyACKAIEIQBBACEDIAJBADYCBCACIAAgARAsIgBFBEAgAUEBaiEBDFILIAJBFzYCHCACIAA2AgwgAiABQQFqNgIUDFsLIAIoAgQhAEEAIQMgAkEANgIEAkAgAiAAIAEQLCIARQRAIAFBAWohAQwBCyACQRY2AhwgAiAANgIMIAIgAUEBajYCFAxbC0EfIQMMQQtBACEDIAJBADYCHCACIAE2AhQgAkGaDzYCECACQSI2AgwMWQsgAigCBCEAQQAhAyACQQA2AgQgAiAAIAEQLSIARQRAIAFBAWohAQxQCyACQRQ2AhwgAiAANgIMIAIgAUEBajYCFAxYCyACKAIEIQBBACEDIAJBADYCBAJAIAIgACABEC0iAEUEQCABQQFqIQEMAQsgAkETNgIcIAIgADYCDCACIAFBAWo2AhQMWAtBHiEDDD4LQQAhAyACQQA2AhwgAiABNgIUIAJBxgw2AhAgAkEjNgIMDFYLIAIoAgQhAEEAIQMgAkEANgIEIAIgACABEC0iAEUEQCABQQFqIQEMTgsgAkERNgIcIAIgADYCDCACIAFBAWo2AhQMVQsgAkEQNgIcIAIgATYCFCACIAA2AgwMVAtBACEDIAJBADYCHCACIAE2AhQgAkHGDDYCECACQSM2AgwMUwtBACEDIAJBADYCHCACIAE2AhQgAkHAFTYCECACQQI2AgwMUgsgAigCBCEAQQAhAyACQQA2AgQCQCACIAAgARAtIgBFBEAgAUEBaiEBDAELIAJBDjYCHCACIAA2AgwgAiABQQFqNgIUDFILQRshAww4C0EAIQMgAkEANgIcIAIgATYCFCACQcYMNgIQIAJBIzYCDAxQCyACKAIEIQBBACEDIAJBADYCBAJAIAIgACABECwiAEUEQCABQQFqIQEMAQsgAkENNgIcIAIgADYCDCACIAFBAWo2AhQMUAtBGiEDDDYLQQAhAyACQQA2AhwgAiABNgIUIAJBmg82AhAgAkEiNgIMDE4LIAIoAgQhAEEAIQMgAkEANgIEAkAgAiAAIAEQLCIARQRAIAFBAWohAQwBCyACQQw2AhwgAiAANgIMIAIgAUEBajYCFAxOC0EZIQMMNAtBACEDIAJBADYCHCACIAE2AhQgAkGaDzYCECACQSI2AgwMTAsgAEEVRwRAQQAhAyACQQA2AhwgAiABNgIUIAJBgww2AhAgAkETNgIMDEwLIAJBCjYCHCACIAE2AhQgAkHkFjYCECACQRU2AgxBACEDDEsLIAIoAgQhAEEAIQMgAkEANgIEIAIgACABIAqnaiIBECsiAARAIAJBBzYCHCACIAE2AhQgAiAANgIMDEsLQRMhAwwxCyAAQRVHBEBBACEDIAJBADYCHCACIAE2AhQgAkHaDTYCECACQRQ2AgwMSgsgAkEeNgIcIAIgATYCFCACQfkXNgIQIAJBFTYCDEEAIQMMSQtBACEAAkAgAigCOCIDRQ0AIAMoAiwiA0UNACACIAMRAAAhAAsgAEUNQSAAQRVGBEAgAkEDNgIcIAIgATYCFCACQbAYNgIQIAJBFTYCDEEAIQMMSQtBACEDIAJBADYCHCACIAE2AhQgAkGnDjYCECACQRI2AgwMSAtBACEDIAJBADYCHCACIAE2AhQgAkHaDTYCECACQRQ2AgwMRwtBACEDIAJBADYCHCACIAE2AhQgAkGnDjYCECACQRI2AgwMRgsgAkEAOgAvIAItAC1BBHFFDT8LIAJBADoALyACQQE6ADRBACEDDCsLQQAhAyACQQA2AhwgAkHkETYCECACQQc2AgwgAiABQQFqNgIUDEMLAkADQAJAIAEtAABBCmsOBAACAgACCyAEIAFBAWoiAUcNAAtB3QEhAwxDCwJAAkAgAi0ANEEBRw0AQQAhAAJAIAIoAjgiA0UNACADKAJYIgNFDQAgAiADEQAAIQALIABFDQAgAEEVRw0BIAJB3AE2AhwgAiABNgIUIAJB1RY2AhAgAkEVNgIMQQAhAwxEC0HBASEDDCoLIAJBADYCHCACIAE2AhQgAkHpCzYCECACQR82AgxBACEDDEILAkACQCACLQAoQQFrDgIEAQALQcABIQMMKQtBuQEhAwwoCyACQQI6AC9BACEAAkAgAigCOCIDRQ0AIAMoAgAiA0UNACACIAMRAAAhAAsgAEUEQEHCASEDDCgLIABBFUcEQCACQQA2AhwgAiABNgIUIAJBpAw2AhAgAkEQNgIMQQAhAwxBCyACQdsBNgIcIAIgATYCFCACQfoWNgIQIAJBFTYCDEEAIQMMQAsgASAERgRAQdoBIQMMQAsgAS0AAEHIAEYNASACQQE6ACgLQawBIQMMJQtBvwEhAwwkCyABIARHBEAgAkEQNgIIIAIgATYCBEG+ASEDDCQLQdkBIQMMPAsgASAERgRAQdgBIQMMPAsgAS0AAEHIAEcNBCABQQFqIQFBvQEhAwwiCyABIARGBEBB1wEhAww7CwJAAkAgAS0AAEHFAGsOEAAFBQUFBQUFBQUFBQUFBQEFCyABQQFqIQFBuwEhAwwiCyABQQFqIQFBvAEhAwwhC0HWASEDIAEgBEYNOSACKAIAIgAgBCABa2ohBSABIABrQQJqIQYCQANAIAEtAAAgAEGD0ABqLQAARw0DIABBAkYNASAAQQFqIQAgBCABQQFqIgFHDQALIAIgBTYCAAw6CyACKAIEIQAgAkIANwMAIAIgACAGQQFqIgEQJyIARQRAQcYBIQMMIQsgAkHVATYCHCACIAE2AhQgAiAANgIMQQAhAww5C0HUASEDIAEgBEYNOCACKAIAIgAgBCABa2ohBSABIABrQQFqIQYCQANAIAEtAAAgAEGB0ABqLQAARw0CIABBAUYNASAAQQFqIQAgBCABQQFqIgFHDQALIAIgBTYCAAw5CyACQYEEOwEoIAIoAgQhACACQgA3AwAgAiAAIAZBAWoiARAnIgANAwwCCyACQQA2AgALQQAhAyACQQA2AhwgAiABNgIUIAJB2Bs2AhAgAkEINgIMDDYLQboBIQMMHAsgAkHTATYCHCACIAE2AhQgAiAANgIMQQAhAww0C0EAIQACQCACKAI4IgNFDQAgAygCOCIDRQ0AIAIgAxEAACEACyAARQ0AIABBFUYNASACQQA2AhwgAiABNgIUIAJBzA42AhAgAkEgNgIMQQAhAwwzC0HkACEDDBkLIAJB+AA2AhwgAiABNgIUIAJByhg2AhAgAkEVNgIMQQAhAwwxC0HSASEDIAQgASIARg0wIAQgAWsgAigCACIBaiEFIAAgAWtBBGohBgJAA0AgAC0AACABQfzPAGotAABHDQEgAUEERg0DIAFBAWohASAEIABBAWoiAEcNAAsgAiAFNgIADDELIAJBADYCHCACIAA2AhQgAkGQMzYCECACQQg2AgwgAkEANgIAQQAhAwwwCyABIARHBEAgAkEONgIIIAIgATYCBEG3ASEDDBcLQdEBIQMMLwsgAkEANgIAIAZBAWohAQtBuAEhAwwUCyABIARGBEBB0AEhAwwtCyABLQAAQTBrIgBB/wFxQQpJBEAgAiAAOgAqIAFBAWohAUG2ASEDDBQLIAIoAgQhACACQQA2AgQgAiAAIAEQKCIARQ0UIAJBzwE2AhwgAiABNgIUIAIgADYCDEEAIQMMLAsgASAERgRAQc4BIQMMLAsCQCABLQAAQS5GBEAgAUEBaiEBDAELIAIoAgQhACACQQA2AgQgAiAAIAEQKCIARQ0VIAJBzQE2AhwgAiABNgIUIAIgADYCDEEAIQMMLAtBtQEhAwwSCyAEIAEiBUYEQEHMASEDDCsLQQAhAEEBIQFBASEGQQAhAwJAAkACQAJAAkACfwJAAkACQAJAAkACQAJAIAUtAABBMGsOCgoJAAECAwQFBggLC0ECDAYLQQMMBQtBBAwEC0EFDAMLQQYMAgtBBwwBC0EICyEDQQAhAUEAIQYMAgtBCSEDQQEhAEEAIQFBACEGDAELQQAhAUEBIQMLIAIgAzoAKyAFQQFqIQMCQAJAIAItAC1BEHENAAJAAkACQCACLQAqDgMBAAIECyAGRQ0DDAILIAANAQwCCyABRQ0BCyACKAIEIQAgAkEANgIEIAIgACADECgiAEUEQCADIQEMAwsgAkHJATYCHCACIAM2AhQgAiAANgIMQQAhAwwtCyACKAIEIQAgAkEANgIEIAIgACADECgiAEUEQCADIQEMGAsgAkHKATYCHCACIAM2AhQgAiAANgIMQQAhAwwsCyACKAIEIQAgAkEANgIEIAIgACAFECgiAEUEQCAFIQEMFgsgAkHLATYCHCACIAU2AhQgAiAANgIMDCsLQbQBIQMMEQtBACEAAkAgAigCOCIDRQ0AIAMoAjwiA0UNACACIAMRAAAhAAsCQCAABEAgAEEVRg0BIAJBADYCHCACIAE2AhQgAkGUDTYCECACQSE2AgxBACEDDCsLQbIBIQMMEQsgAkHIATYCHCACIAE2AhQgAkHJFzYCECACQRU2AgxBACEDDCkLIAJBADYCACAGQQFqIQFB9QAhAwwPCyACLQApQQVGBEBB4wAhAwwPC0HiACEDDA4LIAAhASACQQA2AgALIAJBADoALEEJIQMMDAsgAkEANgIAIAdBAWohAUHAACEDDAsLQQELOgAsIAJBADYCACAGQQFqIQELQSkhAwwIC0E4IQMMBwsCQCABIARHBEADQCABLQAAQYA+ai0AACIAQQFHBEAgAEECRw0DIAFBAWohAQwFCyAEIAFBAWoiAUcNAAtBPiEDDCELQT4hAwwgCwsgAkEAOgAsDAELQQshAwwEC0E6IQMMAwsgAUEBaiEBQS0hAwwCCyACIAE6ACwgAkEANgIAIAZBAWohAUEMIQMMAQsgAkEANgIAIAZBAWohAUEKIQMMAAsAC0EAIQMgAkEANgIcIAIgATYCFCACQc0QNgIQIAJBCTYCDAwXC0EAIQMgAkEANgIcIAIgATYCFCACQekKNgIQIAJBCTYCDAwWC0EAIQMgAkEANgIcIAIgATYCFCACQbcQNgIQIAJBCTYCDAwVC0EAIQMgAkEANgIcIAIgATYCFCACQZwRNgIQIAJBCTYCDAwUC0EAIQMgAkEANgIcIAIgATYCFCACQc0QNgIQIAJBCTYCDAwTC0EAIQMgAkEANgIcIAIgATYCFCACQekKNgIQIAJBCTYCDAwSC0EAIQMgAkEANgIcIAIgATYCFCACQbcQNgIQIAJBCTYCDAwRC0EAIQMgAkEANgIcIAIgATYCFCACQZwRNgIQIAJBCTYCDAwQC0EAIQMgAkEANgIcIAIgATYCFCACQZcVNgIQIAJBDzYCDAwPC0EAIQMgAkEANgIcIAIgATYCFCACQZcVNgIQIAJBDzYCDAwOC0EAIQMgAkEANgIcIAIgATYCFCACQcASNgIQIAJBCzYCDAwNC0EAIQMgAkEANgIcIAIgATYCFCACQZUJNgIQIAJBCzYCDAwMC0EAIQMgAkEANgIcIAIgATYCFCACQeEPNgIQIAJBCjYCDAwLC0EAIQMgAkEANgIcIAIgATYCFCACQfsPNgIQIAJBCjYCDAwKC0EAIQMgAkEANgIcIAIgATYCFCACQfEZNgIQIAJBAjYCDAwJC0EAIQMgAkEANgIcIAIgATYCFCACQcQUNgIQIAJBAjYCDAwIC0EAIQMgAkEANgIcIAIgATYCFCACQfIVNgIQIAJBAjYCDAwHCyACQQI2AhwgAiABNgIUIAJBnBo2AhAgAkEWNgIMQQAhAwwGC0EBIQMMBQtB1AAhAyABIARGDQQgCEEIaiEJIAIoAgAhBQJAAkAgASAERwRAIAVB2MIAaiEHIAQgBWogAWshACAFQX9zQQpqIgUgAWohBgNAIAEtAAAgBy0AAEcEQEECIQcMAwsgBUUEQEEAIQcgBiEBDAMLIAVBAWshBSAHQQFqIQcgBCABQQFqIgFHDQALIAAhBSAEIQELIAlBATYCACACIAU2AgAMAQsgAkEANgIAIAkgBzYCAAsgCSABNgIEIAgoAgwhACAIKAIIDgMBBAIACwALIAJBADYCHCACQbUaNgIQIAJBFzYCDCACIABBAWo2AhRBACEDDAILIAJBADYCHCACIAA2AhQgAkHKGjYCECACQQk2AgxBACEDDAELIAEgBEYEQEEiIQMMAQsgAkEJNgIIIAIgATYCBEEhIQMLIAhBEGokACADRQRAIAIoAgwhAAwBCyACIAM2AhxBACEAIAIoAgQiAUUNACACIAEgBCACKAIIEQEAIgFFDQAgAiAENgIUIAIgATYCDCABIQALIAALvgIBAn8gAEEAOgAAIABB3ABqIgFBAWtBADoAACAAQQA6AAIgAEEAOgABIAFBA2tBADoAACABQQJrQQA6AAAgAEEAOgADIAFBBGtBADoAAEEAIABrQQNxIgEgAGoiAEEANgIAQdwAIAFrQXxxIgIgAGoiAUEEa0EANgIAAkAgAkEJSQ0AIABBADYCCCAAQQA2AgQgAUEIa0EANgIAIAFBDGtBADYCACACQRlJDQAgAEEANgIYIABBADYCFCAAQQA2AhAgAEEANgIMIAFBEGtBADYCACABQRRrQQA2AgAgAUEYa0EANgIAIAFBHGtBADYCACACIABBBHFBGHIiAmsiAUEgSQ0AIAAgAmohAANAIABCADcDGCAAQgA3AxAgAEIANwMIIABCADcDACAAQSBqIQAgAUEgayIBQR9LDQALCwtWAQF/AkAgACgCDA0AAkACQAJAAkAgAC0ALw4DAQADAgsgACgCOCIBRQ0AIAEoAiwiAUUNACAAIAERAAAiAQ0DC0EADwsACyAAQcMWNgIQQQ4hAQsgAQsaACAAKAIMRQRAIABB0Rs2AhAgAEEVNgIMCwsUACAAKAIMQRVGBEAgAEEANgIMCwsUACAAKAIMQRZGBEAgAEEANgIMCwsHACAAKAIMCwcAIAAoAhALCQAgACABNgIQCwcAIAAoAhQLFwAgAEEkTwRAAAsgAEECdEGgM2ooAgALFwAgAEEuTwRAAAsgAEECdEGwNGooAgALvwkBAX9B6yghAQJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAIABB5ABrDvQDY2IAAWFhYWFhYQIDBAVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhBgcICQoLDA0OD2FhYWFhEGFhYWFhYWFhYWFhEWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYRITFBUWFxgZGhthYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhHB0eHyAhIiMkJSYnKCkqKywtLi8wMTIzNDU2YTc4OTphYWFhYWFhYTthYWE8YWFhYT0+P2FhYWFhYWFhQGFhQWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYUJDREVGR0hJSktMTU5PUFFSU2FhYWFhYWFhVFVWV1hZWlthXF1hYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFeYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhX2BhC0HhJw8LQaQhDwtByywPC0H+MQ8LQcAkDwtBqyQPC0GNKA8LQeImDwtBgDAPC0G5Lw8LQdckDwtB7x8PC0HhHw8LQfofDwtB8iAPC0GoLw8LQa4yDwtBiDAPC0HsJw8LQYIiDwtBjh0PC0HQLg8LQcojDwtBxTIPC0HfHA8LQdIcDwtBxCAPC0HXIA8LQaIfDwtB7S4PC0GrMA8LQdQlDwtBzC4PC0H6Lg8LQfwrDwtB0jAPC0HxHQ8LQbsgDwtB9ysPC0GQMQ8LQdcxDwtBoi0PC0HUJw8LQeArDwtBnywPC0HrMQ8LQdUfDwtByjEPC0HeJQ8LQdQeDwtB9BwPC0GnMg8LQbEdDwtBoB0PC0G5MQ8LQbwwDwtBkiEPC0GzJg8LQeksDwtBrB4PC0HUKw8LQfcmDwtBgCYPC0GwIQ8LQf4eDwtBjSMPC0GJLQ8LQfciDwtBoDEPC0GuHw8LQcYlDwtB6B4PC0GTIg8LQcIvDwtBwx0PC0GLLA8LQeEdDwtBjS8PC0HqIQ8LQbQtDwtB0i8PC0HfMg8LQdIyDwtB8DAPC0GpIg8LQfkjDwtBmR4PC0G1LA8LQZswDwtBkjIPC0G2Kw8LQcIiDwtB+DIPC0GeJQ8LQdAiDwtBuh4PC0GBHg8LAAtB1iEhAQsgAQsWACAAIAAtAC1B/gFxIAFBAEdyOgAtCxkAIAAgAC0ALUH9AXEgAUEAR0EBdHI6AC0LGQAgACAALQAtQfsBcSABQQBHQQJ0cjoALQsZACAAIAAtAC1B9wFxIAFBAEdBA3RyOgAtCz4BAn8CQCAAKAI4IgNFDQAgAygCBCIDRQ0AIAAgASACIAFrIAMRAQAiBEF/Rw0AIABBxhE2AhBBGCEECyAECz4BAn8CQCAAKAI4IgNFDQAgAygCCCIDRQ0AIAAgASACIAFrIAMRAQAiBEF/Rw0AIABB9go2AhBBGCEECyAECz4BAn8CQCAAKAI4IgNFDQAgAygCDCIDRQ0AIAAgASACIAFrIAMRAQAiBEF/Rw0AIABB7Ro2AhBBGCEECyAECz4BAn8CQCAAKAI4IgNFDQAgAygCECIDRQ0AIAAgASACIAFrIAMRAQAiBEF/Rw0AIABBlRA2AhBBGCEECyAECz4BAn8CQCAAKAI4IgNFDQAgAygCFCIDRQ0AIAAgASACIAFrIAMRAQAiBEF/Rw0AIABBqhs2AhBBGCEECyAECz4BAn8CQCAAKAI4IgNFDQAgAygCGCIDRQ0AIAAgASACIAFrIAMRAQAiBEF/Rw0AIABB7RM2AhBBGCEECyAECz4BAn8CQCAAKAI4IgNFDQAgAygCKCIDRQ0AIAAgASACIAFrIAMRAQAiBEF/Rw0AIABB9gg2AhBBGCEECyAECz4BAn8CQCAAKAI4IgNFDQAgAygCHCIDRQ0AIAAgASACIAFrIAMRAQAiBEF/Rw0AIABBwhk2AhBBGCEECyAECz4BAn8CQCAAKAI4IgNFDQAgAygCICIDRQ0AIAAgASACIAFrIAMRAQAiBEF/Rw0AIABBlBQ2AhBBGCEECyAEC1kBAn8CQCAALQAoQQFGDQAgAC8BMiIBQeQAa0HkAEkNACABQcwBRg0AIAFBsAJGDQAgAC8BMCIAQcAAcQ0AQQEhAiAAQYgEcUGABEYNACAAQShxRSECCyACC4wBAQJ/AkACQAJAIAAtACpFDQAgAC0AK0UNACAALwEwIgFBAnFFDQEMAgsgAC8BMCIBQQFxRQ0BC0EBIQIgAC0AKEEBRg0AIAAvATIiAEHkAGtB5ABJDQAgAEHMAUYNACAAQbACRg0AIAFBwABxDQBBACECIAFBiARxQYAERg0AIAFBKHFBAEchAgsgAgtXACAAQRhqQgA3AwAgAEIANwMAIABBOGpCADcDACAAQTBqQgA3AwAgAEEoakIANwMAIABBIGpCADcDACAAQRBqQgA3AwAgAEEIakIANwMAIABB3QE2AhwLBgAgABAyC5otAQt/IwBBEGsiCiQAQaTQACgCACIJRQRAQeTTACgCACIFRQRAQfDTAEJ/NwIAQejTAEKAgISAgIDAADcCAEHk0wAgCkEIakFwcUHYqtWqBXMiBTYCAEH40wBBADYCAEHI0wBBADYCAAtBzNMAQYDUBDYCAEGc0ABBgNQENgIAQbDQACAFNgIAQazQAEF/NgIAQdDTAEGArAM2AgADQCABQcjQAGogAUG80ABqIgI2AgAgAiABQbTQAGoiAzYCACABQcDQAGogAzYCACABQdDQAGogAUHE0ABqIgM2AgAgAyACNgIAIAFB2NAAaiABQczQAGoiAjYCACACIAM2AgAgAUHU0ABqIAI2AgAgAUEgaiIBQYACRw0AC0GM1ARBwasDNgIAQajQAEH00wAoAgA2AgBBmNAAQcCrAzYCAEGk0ABBiNQENgIAQcz/B0E4NgIAQYjUBCEJCwJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAIABB7AFNBEBBjNAAKAIAIgZBECAAQRNqQXBxIABBC0kbIgRBA3YiAHYiAUEDcQRAAkAgAUEBcSAAckEBcyICQQN0IgBBtNAAaiIBIABBvNAAaigCACIAKAIIIgNGBEBBjNAAIAZBfiACd3E2AgAMAQsgASADNgIIIAMgATYCDAsgAEEIaiEBIAAgAkEDdCICQQNyNgIEIAAgAmoiACAAKAIEQQFyNgIEDBELQZTQACgCACIIIARPDQEgAQRAAkBBAiAAdCICQQAgAmtyIAEgAHRxaCIAQQN0IgJBtNAAaiIBIAJBvNAAaigCACICKAIIIgNGBEBBjNAAIAZBfiAAd3EiBjYCAAwBCyABIAM2AgggAyABNgIMCyACIARBA3I2AgQgAEEDdCIAIARrIQUgACACaiAFNgIAIAIgBGoiBCAFQQFyNgIEIAgEQCAIQXhxQbTQAGohAEGg0AAoAgAhAwJ/QQEgCEEDdnQiASAGcUUEQEGM0AAgASAGcjYCACAADAELIAAoAggLIgEgAzYCDCAAIAM2AgggAyAANgIMIAMgATYCCAsgAkEIaiEBQaDQACAENgIAQZTQACAFNgIADBELQZDQACgCACILRQ0BIAtoQQJ0QbzSAGooAgAiACgCBEF4cSAEayEFIAAhAgNAAkAgAigCECIBRQRAIAJBFGooAgAiAUUNAQsgASgCBEF4cSAEayIDIAVJIQIgAyAFIAIbIQUgASAAIAIbIQAgASECDAELCyAAKAIYIQkgACgCDCIDIABHBEBBnNAAKAIAGiADIAAoAggiATYCCCABIAM2AgwMEAsgAEEUaiICKAIAIgFFBEAgACgCECIBRQ0DIABBEGohAgsDQCACIQcgASIDQRRqIgIoAgAiAQ0AIANBEGohAiADKAIQIgENAAsgB0EANgIADA8LQX8hBCAAQb9/Sw0AIABBE2oiAUFwcSEEQZDQACgCACIIRQ0AQQAgBGshBQJAAkACQAJ/QQAgBEGAAkkNABpBHyAEQf///wdLDQAaIARBJiABQQh2ZyIAa3ZBAXEgAEEBdGtBPmoLIgZBAnRBvNIAaigCACICRQRAQQAhAUEAIQMMAQtBACEBIARBGSAGQQF2a0EAIAZBH0cbdCEAQQAhAwNAAkAgAigCBEF4cSAEayIHIAVPDQAgAiEDIAciBQ0AQQAhBSACIQEMAwsgASACQRRqKAIAIgcgByACIABBHXZBBHFqQRBqKAIAIgJGGyABIAcbIQEgAEEBdCEAIAINAAsLIAEgA3JFBEBBACEDQQIgBnQiAEEAIABrciAIcSIARQ0DIABoQQJ0QbzSAGooAgAhAQsgAUUNAQsDQCABKAIEQXhxIARrIgIgBUkhACACIAUgABshBSABIAMgABshAyABKAIQIgAEfyAABSABQRRqKAIACyIBDQALCyADRQ0AIAVBlNAAKAIAIARrTw0AIAMoAhghByADIAMoAgwiAEcEQEGc0AAoAgAaIAAgAygCCCIBNgIIIAEgADYCDAwOCyADQRRqIgIoAgAiAUUEQCADKAIQIgFFDQMgA0EQaiECCwNAIAIhBiABIgBBFGoiAigCACIBDQAgAEEQaiECIAAoAhAiAQ0ACyAGQQA2AgAMDQtBlNAAKAIAIgMgBE8EQEGg0AAoAgAhAQJAIAMgBGsiAkEQTwRAIAEgBGoiACACQQFyNgIEIAEgA2ogAjYCACABIARBA3I2AgQMAQsgASADQQNyNgIEIAEgA2oiACAAKAIEQQFyNgIEQQAhAEEAIQILQZTQACACNgIAQaDQACAANgIAIAFBCGohAQwPC0GY0AAoAgAiAyAESwRAIAQgCWoiACADIARrIgFBAXI2AgRBpNAAIAA2AgBBmNAAIAE2AgAgCSAEQQNyNgIEIAlBCGohAQwPC0EAIQEgBAJ/QeTTACgCAARAQezTACgCAAwBC0Hw0wBCfzcCAEHo0wBCgICEgICAwAA3AgBB5NMAIApBDGpBcHFB2KrVqgVzNgIAQfjTAEEANgIAQcjTAEEANgIAQYCABAsiACAEQccAaiIFaiIGQQAgAGsiB3EiAk8EQEH80wBBMDYCAAwPCwJAQcTTACgCACIBRQ0AQbzTACgCACIIIAJqIQAgACABTSAAIAhLcQ0AQQAhAUH80wBBMDYCAAwPC0HI0wAtAABBBHENBAJAAkAgCQRAQczTACEBA0AgASgCACIAIAlNBEAgACABKAIEaiAJSw0DCyABKAIIIgENAAsLQQAQMyIAQX9GDQUgAiEGQejTACgCACIBQQFrIgMgAHEEQCACIABrIAAgA2pBACABa3FqIQYLIAQgBk8NBSAGQf7///8HSw0FQcTTACgCACIDBEBBvNMAKAIAIgcgBmohASABIAdNDQYgASADSw0GCyAGEDMiASAARw0BDAcLIAYgA2sgB3EiBkH+////B0sNBCAGEDMhACAAIAEoAgAgASgCBGpGDQMgACEBCwJAIAYgBEHIAGpPDQAgAUF/Rg0AQezTACgCACIAIAUgBmtqQQAgAGtxIgBB/v///wdLBEAgASEADAcLIAAQM0F/RwRAIAAgBmohBiABIQAMBwtBACAGaxAzGgwECyABIgBBf0cNBQwDC0EAIQMMDAtBACEADAoLIABBf0cNAgtByNMAQcjTACgCAEEEcjYCAAsgAkH+////B0sNASACEDMhAEEAEDMhASAAQX9GDQEgAUF/Rg0BIAAgAU8NASABIABrIgYgBEE4ak0NAQtBvNMAQbzTACgCACAGaiIBNgIAQcDTACgCACABSQRAQcDTACABNgIACwJAAkACQEGk0AAoAgAiAgRAQczTACEBA0AgACABKAIAIgMgASgCBCIFakYNAiABKAIIIgENAAsMAgtBnNAAKAIAIgFBAEcgACABT3FFBEBBnNAAIAA2AgALQQAhAUHQ0wAgBjYCAEHM0wAgADYCAEGs0ABBfzYCAEGw0ABB5NMAKAIANgIAQdjTAEEANgIAA0AgAUHI0ABqIAFBvNAAaiICNgIAIAIgAUG00ABqIgM2AgAgAUHA0ABqIAM2AgAgAUHQ0ABqIAFBxNAAaiIDNgIAIAMgAjYCACABQdjQAGogAUHM0ABqIgI2AgAgAiADNgIAIAFB1NAAaiACNgIAIAFBIGoiAUGAAkcNAAtBeCAAa0EPcSIBIABqIgIgBkE4ayIDIAFrIgFBAXI2AgRBqNAAQfTTACgCADYCAEGY0AAgATYCAEGk0AAgAjYCACAAIANqQTg2AgQMAgsgACACTQ0AIAIgA0kNACABKAIMQQhxDQBBeCACa0EPcSIAIAJqIgNBmNAAKAIAIAZqIgcgAGsiAEEBcjYCBCABIAUgBmo2AgRBqNAAQfTTACgCADYCAEGY0AAgADYCAEGk0AAgAzYCACACIAdqQTg2AgQMAQsgAEGc0AAoAgBJBEBBnNAAIAA2AgALIAAgBmohA0HM0wAhAQJAAkACQANAIAMgASgCAEcEQCABKAIIIgENAQwCCwsgAS0ADEEIcUUNAQtBzNMAIQEDQCABKAIAIgMgAk0EQCADIAEoAgRqIgUgAksNAwsgASgCCCEBDAALAAsgASAANgIAIAEgASgCBCAGajYCBCAAQXggAGtBD3FqIgkgBEEDcjYCBCADQXggA2tBD3FqIgYgBCAJaiIEayEBIAIgBkYEQEGk0AAgBDYCAEGY0ABBmNAAKAIAIAFqIgA2AgAgBCAAQQFyNgIEDAgLQaDQACgCACAGRgRAQaDQACAENgIAQZTQAEGU0AAoAgAgAWoiADYCACAEIABBAXI2AgQgACAEaiAANgIADAgLIAYoAgQiBUEDcUEBRw0GIAVBeHEhCCAFQf8BTQRAIAVBA3YhAyAGKAIIIgAgBigCDCICRgRAQYzQAEGM0AAoAgBBfiADd3E2AgAMBwsgAiAANgIIIAAgAjYCDAwGCyAGKAIYIQcgBiAGKAIMIgBHBEAgACAGKAIIIgI2AgggAiAANgIMDAULIAZBFGoiAigCACIFRQRAIAYoAhAiBUUNBCAGQRBqIQILA0AgAiEDIAUiAEEUaiICKAIAIgUNACAAQRBqIQIgACgCECIFDQALIANBADYCAAwEC0F4IABrQQ9xIgEgAGoiByAGQThrIgMgAWsiAUEBcjYCBCAAIANqQTg2AgQgAiAFQTcgBWtBD3FqQT9rIgMgAyACQRBqSRsiA0EjNgIEQajQAEH00wAoAgA2AgBBmNAAIAE2AgBBpNAAIAc2AgAgA0EQakHU0wApAgA3AgAgA0HM0wApAgA3AghB1NMAIANBCGo2AgBB0NMAIAY2AgBBzNMAIAA2AgBB2NMAQQA2AgAgA0EkaiEBA0AgAUEHNgIAIAUgAUEEaiIBSw0ACyACIANGDQAgAyADKAIEQX5xNgIEIAMgAyACayIFNgIAIAIgBUEBcjYCBCAFQf8BTQRAIAVBeHFBtNAAaiEAAn9BjNAAKAIAIgFBASAFQQN2dCIDcUUEQEGM0AAgASADcjYCACAADAELIAAoAggLIgEgAjYCDCAAIAI2AgggAiAANgIMIAIgATYCCAwBC0EfIQEgBUH///8HTQRAIAVBJiAFQQh2ZyIAa3ZBAXEgAEEBdGtBPmohAQsgAiABNgIcIAJCADcCECABQQJ0QbzSAGohAEGQ0AAoAgAiA0EBIAF0IgZxRQRAIAAgAjYCAEGQ0AAgAyAGcjYCACACIAA2AhggAiACNgIIIAIgAjYCDAwBCyAFQRkgAUEBdmtBACABQR9HG3QhASAAKAIAIQMCQANAIAMiACgCBEF4cSAFRg0BIAFBHXYhAyABQQF0IQEgACADQQRxakEQaiIGKAIAIgMNAAsgBiACNgIAIAIgADYCGCACIAI2AgwgAiACNgIIDAELIAAoAggiASACNgIMIAAgAjYCCCACQQA2AhggAiAANgIMIAIgATYCCAtBmNAAKAIAIgEgBE0NAEGk0AAoAgAiACAEaiICIAEgBGsiAUEBcjYCBEGY0AAgATYCAEGk0AAgAjYCACAAIARBA3I2AgQgAEEIaiEBDAgLQQAhAUH80wBBMDYCAAwHC0EAIQALIAdFDQACQCAGKAIcIgJBAnRBvNIAaiIDKAIAIAZGBEAgAyAANgIAIAANAUGQ0ABBkNAAKAIAQX4gAndxNgIADAILIAdBEEEUIAcoAhAgBkYbaiAANgIAIABFDQELIAAgBzYCGCAGKAIQIgIEQCAAIAI2AhAgAiAANgIYCyAGQRRqKAIAIgJFDQAgAEEUaiACNgIAIAIgADYCGAsgASAIaiEBIAYgCGoiBigCBCEFCyAGIAVBfnE2AgQgASAEaiABNgIAIAQgAUEBcjYCBCABQf8BTQRAIAFBeHFBtNAAaiEAAn9BjNAAKAIAIgJBASABQQN2dCIBcUUEQEGM0AAgASACcjYCACAADAELIAAoAggLIgEgBDYCDCAAIAQ2AgggBCAANgIMIAQgATYCCAwBC0EfIQUgAUH///8HTQRAIAFBJiABQQh2ZyIAa3ZBAXEgAEEBdGtBPmohBQsgBCAFNgIcIARCADcCECAFQQJ0QbzSAGohAEGQ0AAoAgAiAkEBIAV0IgNxRQRAIAAgBDYCAEGQ0AAgAiADcjYCACAEIAA2AhggBCAENgIIIAQgBDYCDAwBCyABQRkgBUEBdmtBACAFQR9HG3QhBSAAKAIAIQACQANAIAAiAigCBEF4cSABRg0BIAVBHXYhACAFQQF0IQUgAiAAQQRxakEQaiIDKAIAIgANAAsgAyAENgIAIAQgAjYCGCAEIAQ2AgwgBCAENgIIDAELIAIoAggiACAENgIMIAIgBDYCCCAEQQA2AhggBCACNgIMIAQgADYCCAsgCUEIaiEBDAILAkAgB0UNAAJAIAMoAhwiAUECdEG80gBqIgIoAgAgA0YEQCACIAA2AgAgAA0BQZDQACAIQX4gAXdxIgg2AgAMAgsgB0EQQRQgBygCECADRhtqIAA2AgAgAEUNAQsgACAHNgIYIAMoAhAiAQRAIAAgATYCECABIAA2AhgLIANBFGooAgAiAUUNACAAQRRqIAE2AgAgASAANgIYCwJAIAVBD00EQCADIAQgBWoiAEEDcjYCBCAAIANqIgAgACgCBEEBcjYCBAwBCyADIARqIgIgBUEBcjYCBCADIARBA3I2AgQgAiAFaiAFNgIAIAVB/wFNBEAgBUF4cUG00ABqIQACf0GM0AAoAgAiAUEBIAVBA3Z0IgVxRQRAQYzQACABIAVyNgIAIAAMAQsgACgCCAsiASACNgIMIAAgAjYCCCACIAA2AgwgAiABNgIIDAELQR8hASAFQf///wdNBEAgBUEmIAVBCHZnIgBrdkEBcSAAQQF0a0E+aiEBCyACIAE2AhwgAkIANwIQIAFBAnRBvNIAaiEAQQEgAXQiBCAIcUUEQCAAIAI2AgBBkNAAIAQgCHI2AgAgAiAANgIYIAIgAjYCCCACIAI2AgwMAQsgBUEZIAFBAXZrQQAgAUEfRxt0IQEgACgCACEEAkADQCAEIgAoAgRBeHEgBUYNASABQR12IQQgAUEBdCEBIAAgBEEEcWpBEGoiBigCACIEDQALIAYgAjYCACACIAA2AhggAiACNgIMIAIgAjYCCAwBCyAAKAIIIgEgAjYCDCAAIAI2AgggAkEANgIYIAIgADYCDCACIAE2AggLIANBCGohAQwBCwJAIAlFDQACQCAAKAIcIgFBAnRBvNIAaiICKAIAIABGBEAgAiADNgIAIAMNAUGQ0AAgC0F+IAF3cTYCAAwCCyAJQRBBFCAJKAIQIABGG2ogAzYCACADRQ0BCyADIAk2AhggACgCECIBBEAgAyABNgIQIAEgAzYCGAsgAEEUaigCACIBRQ0AIANBFGogATYCACABIAM2AhgLAkAgBUEPTQRAIAAgBCAFaiIBQQNyNgIEIAAgAWoiASABKAIEQQFyNgIEDAELIAAgBGoiByAFQQFyNgIEIAAgBEEDcjYCBCAFIAdqIAU2AgAgCARAIAhBeHFBtNAAaiEBQaDQACgCACEDAn9BASAIQQN2dCICIAZxRQRAQYzQACACIAZyNgIAIAEMAQsgASgCCAsiAiADNgIMIAEgAzYCCCADIAE2AgwgAyACNgIIC0Gg0AAgBzYCAEGU0AAgBTYCAAsgAEEIaiEBCyAKQRBqJAAgAQtDACAARQRAPwBBEHQPCwJAIABB//8DcQ0AIABBAEgNACAAQRB2QAAiAEF/RgRAQfzTAEEwNgIAQX8PCyAAQRB0DwsACwvcPyIAQYAICwkBAAAAAgAAAAMAQZQICwUEAAAABQBBpAgLCQYAAAAHAAAACABB3AgLii1JbnZhbGlkIGNoYXIgaW4gdXJsIHF1ZXJ5AFNwYW4gY2FsbGJhY2sgZXJyb3IgaW4gb25fYm9keQBDb250ZW50LUxlbmd0aCBvdmVyZmxvdwBDaHVuayBzaXplIG92ZXJmbG93AFJlc3BvbnNlIG92ZXJmbG93AEludmFsaWQgbWV0aG9kIGZvciBIVFRQL3gueCByZXF1ZXN0AEludmFsaWQgbWV0aG9kIGZvciBSVFNQL3gueCByZXF1ZXN0AEV4cGVjdGVkIFNPVVJDRSBtZXRob2QgZm9yIElDRS94LnggcmVxdWVzdABJbnZhbGlkIGNoYXIgaW4gdXJsIGZyYWdtZW50IHN0YXJ0AEV4cGVjdGVkIGRvdABTcGFuIGNhbGxiYWNrIGVycm9yIGluIG9uX3N0YXR1cwBJbnZhbGlkIHJlc3BvbnNlIHN0YXR1cwBJbnZhbGlkIGNoYXJhY3RlciBpbiBjaHVuayBleHRlbnNpb25zAFVzZXIgY2FsbGJhY2sgZXJyb3IAYG9uX3Jlc2V0YCBjYWxsYmFjayBlcnJvcgBgb25fY2h1bmtfaGVhZGVyYCBjYWxsYmFjayBlcnJvcgBgb25fbWVzc2FnZV9iZWdpbmAgY2FsbGJhY2sgZXJyb3IAYG9uX2NodW5rX2V4dGVuc2lvbl92YWx1ZWAgY2FsbGJhY2sgZXJyb3IAYG9uX3N0YXR1c19jb21wbGV0ZWAgY2FsbGJhY2sgZXJyb3IAYG9uX3ZlcnNpb25fY29tcGxldGVgIGNhbGxiYWNrIGVycm9yAGBvbl91cmxfY29tcGxldGVgIGNhbGxiYWNrIGVycm9yAGBvbl9jaHVua19jb21wbGV0ZWAgY2FsbGJhY2sgZXJyb3IAYG9uX2hlYWRlcl92YWx1ZV9jb21wbGV0ZWAgY2FsbGJhY2sgZXJyb3IAYG9uX21lc3NhZ2VfY29tcGxldGVgIGNhbGxiYWNrIGVycm9yAGBvbl9tZXRob2RfY29tcGxldGVgIGNhbGxiYWNrIGVycm9yAGBvbl9oZWFkZXJfZmllbGRfY29tcGxldGVgIGNhbGxiYWNrIGVycm9yAGBvbl9jaHVua19leHRlbnNpb25fbmFtZWAgY2FsbGJhY2sgZXJyb3IAVW5leHBlY3RlZCBjaGFyIGluIHVybCBzZXJ2ZXIASW52YWxpZCBoZWFkZXIgdmFsdWUgY2hhcgBJbnZhbGlkIGhlYWRlciBmaWVsZCBjaGFyAFNwYW4gY2FsbGJhY2sgZXJyb3IgaW4gb25fdmVyc2lvbgBJbnZhbGlkIG1pbm9yIHZlcnNpb24ASW52YWxpZCBtYWpvciB2ZXJzaW9uAEV4cGVjdGVkIHNwYWNlIGFmdGVyIHZlcnNpb24ARXhwZWN0ZWQgQ1JMRiBhZnRlciB2ZXJzaW9uAEludmFsaWQgSFRUUCB2ZXJzaW9uAEludmFsaWQgaGVhZGVyIHRva2VuAFNwYW4gY2FsbGJhY2sgZXJyb3IgaW4gb25fdXJsAEludmFsaWQgY2hhcmFjdGVycyBpbiB1cmwAVW5leHBlY3RlZCBzdGFydCBjaGFyIGluIHVybABEb3VibGUgQCBpbiB1cmwARW1wdHkgQ29udGVudC1MZW5ndGgASW52YWxpZCBjaGFyYWN0ZXIgaW4gQ29udGVudC1MZW5ndGgARHVwbGljYXRlIENvbnRlbnQtTGVuZ3RoAEludmFsaWQgY2hhciBpbiB1cmwgcGF0aABDb250ZW50LUxlbmd0aCBjYW4ndCBiZSBwcmVzZW50IHdpdGggVHJhbnNmZXItRW5jb2RpbmcASW52YWxpZCBjaGFyYWN0ZXIgaW4gY2h1bmsgc2l6ZQBTcGFuIGNhbGxiYWNrIGVycm9yIGluIG9uX2hlYWRlcl92YWx1ZQBTcGFuIGNhbGxiYWNrIGVycm9yIGluIG9uX2NodW5rX2V4dGVuc2lvbl92YWx1ZQBJbnZhbGlkIGNoYXJhY3RlciBpbiBjaHVuayBleHRlbnNpb25zIHZhbHVlAE1pc3NpbmcgZXhwZWN0ZWQgTEYgYWZ0ZXIgaGVhZGVyIHZhbHVlAEludmFsaWQgYFRyYW5zZmVyLUVuY29kaW5nYCBoZWFkZXIgdmFsdWUASW52YWxpZCBjaGFyYWN0ZXIgaW4gY2h1bmsgZXh0ZW5zaW9ucyBxdW90ZSB2YWx1ZQBJbnZhbGlkIGNoYXJhY3RlciBpbiBjaHVuayBleHRlbnNpb25zIHF1b3RlZCB2YWx1ZQBQYXVzZWQgYnkgb25faGVhZGVyc19jb21wbGV0ZQBJbnZhbGlkIEVPRiBzdGF0ZQBvbl9yZXNldCBwYXVzZQBvbl9jaHVua19oZWFkZXIgcGF1c2UAb25fbWVzc2FnZV9iZWdpbiBwYXVzZQBvbl9jaHVua19leHRlbnNpb25fdmFsdWUgcGF1c2UAb25fc3RhdHVzX2NvbXBsZXRlIHBhdXNlAG9uX3ZlcnNpb25fY29tcGxldGUgcGF1c2UAb25fdXJsX2NvbXBsZXRlIHBhdXNlAG9uX2NodW5rX2NvbXBsZXRlIHBhdXNlAG9uX2hlYWRlcl92YWx1ZV9jb21wbGV0ZSBwYXVzZQBvbl9tZXNzYWdlX2NvbXBsZXRlIHBhdXNlAG9uX21ldGhvZF9jb21wbGV0ZSBwYXVzZQBvbl9oZWFkZXJfZmllbGRfY29tcGxldGUgcGF1c2UAb25fY2h1bmtfZXh0ZW5zaW9uX25hbWUgcGF1c2UAVW5leHBlY3RlZCBzcGFjZSBhZnRlciBzdGFydCBsaW5lAFNwYW4gY2FsbGJhY2sgZXJyb3IgaW4gb25fY2h1bmtfZXh0ZW5zaW9uX25hbWUASW52YWxpZCBjaGFyYWN0ZXIgaW4gY2h1bmsgZXh0ZW5zaW9ucyBuYW1lAFBhdXNlIG9uIENPTk5FQ1QvVXBncmFkZQBQYXVzZSBvbiBQUkkvVXBncmFkZQBFeHBlY3RlZCBIVFRQLzIgQ29ubmVjdGlvbiBQcmVmYWNlAFNwYW4gY2FsbGJhY2sgZXJyb3IgaW4gb25fbWV0aG9kAEV4cGVjdGVkIHNwYWNlIGFmdGVyIG1ldGhvZABTcGFuIGNhbGxiYWNrIGVycm9yIGluIG9uX2hlYWRlcl9maWVsZABQYXVzZWQASW52YWxpZCB3b3JkIGVuY291bnRlcmVkAEludmFsaWQgbWV0aG9kIGVuY291bnRlcmVkAFVuZXhwZWN0ZWQgY2hhciBpbiB1cmwgc2NoZW1hAFJlcXVlc3QgaGFzIGludmFsaWQgYFRyYW5zZmVyLUVuY29kaW5nYABTV0lUQ0hfUFJPWFkAVVNFX1BST1hZAE1LQUNUSVZJVFkAVU5QUk9DRVNTQUJMRV9FTlRJVFkAQ09QWQBNT1ZFRF9QRVJNQU5FTlRMWQBUT09fRUFSTFkATk9USUZZAEZBSUxFRF9ERVBFTkRFTkNZAEJBRF9HQVRFV0FZAFBMQVkAUFVUAENIRUNLT1VUAEdBVEVXQVlfVElNRU9VVABSRVFVRVNUX1RJTUVPVVQATkVUV09SS19DT05ORUNUX1RJTUVPVVQAQ09OTkVDVElPTl9USU1FT1VUAExPR0lOX1RJTUVPVVQATkVUV09SS19SRUFEX1RJTUVPVVQAUE9TVABNSVNESVJFQ1RFRF9SRVFVRVNUAENMSUVOVF9DTE9TRURfUkVRVUVTVABDTElFTlRfQ0xPU0VEX0xPQURfQkFMQU5DRURfUkVRVUVTVABCQURfUkVRVUVTVABIVFRQX1JFUVVFU1RfU0VOVF9UT19IVFRQU19QT1JUAFJFUE9SVABJTV9BX1RFQVBPVABSRVNFVF9DT05URU5UAE5PX0NPTlRFTlQAUEFSVElBTF9DT05URU5UAEhQRV9JTlZBTElEX0NPTlNUQU5UAEhQRV9DQl9SRVNFVABHRVQASFBFX1NUUklDVABDT05GTElDVABURU1QT1JBUllfUkVESVJFQ1QAUEVSTUFORU5UX1JFRElSRUNUAENPTk5FQ1QATVVMVElfU1RBVFVTAEhQRV9JTlZBTElEX1NUQVRVUwBUT09fTUFOWV9SRVFVRVNUUwBFQVJMWV9ISU5UUwBVTkFWQUlMQUJMRV9GT1JfTEVHQUxfUkVBU09OUwBPUFRJT05TAFNXSVRDSElOR19QUk9UT0NPTFMAVkFSSUFOVF9BTFNPX05FR09USUFURVMATVVMVElQTEVfQ0hPSUNFUwBJTlRFUk5BTF9TRVJWRVJfRVJST1IAV0VCX1NFUlZFUl9VTktOT1dOX0VSUk9SAFJBSUxHVU5fRVJST1IASURFTlRJVFlfUFJPVklERVJfQVVUSEVOVElDQVRJT05fRVJST1IAU1NMX0NFUlRJRklDQVRFX0VSUk9SAElOVkFMSURfWF9GT1JXQVJERURfRk9SAFNFVF9QQVJBTUVURVIAR0VUX1BBUkFNRVRFUgBIUEVfVVNFUgBTRUVfT1RIRVIASFBFX0NCX0NIVU5LX0hFQURFUgBNS0NBTEVOREFSAFNFVFVQAFdFQl9TRVJWRVJfSVNfRE9XTgBURUFSRE9XTgBIUEVfQ0xPU0VEX0NPTk5FQ1RJT04ASEVVUklTVElDX0VYUElSQVRJT04ARElTQ09OTkVDVEVEX09QRVJBVElPTgBOT05fQVVUSE9SSVRBVElWRV9JTkZPUk1BVElPTgBIUEVfSU5WQUxJRF9WRVJTSU9OAEhQRV9DQl9NRVNTQUdFX0JFR0lOAFNJVEVfSVNfRlJPWkVOAEhQRV9JTlZBTElEX0hFQURFUl9UT0tFTgBJTlZBTElEX1RPS0VOAEZPUkJJRERFTgBFTkhBTkNFX1lPVVJfQ0FMTQBIUEVfSU5WQUxJRF9VUkwAQkxPQ0tFRF9CWV9QQVJFTlRBTF9DT05UUk9MAE1LQ09MAEFDTABIUEVfSU5URVJOQUwAUkVRVUVTVF9IRUFERVJfRklFTERTX1RPT19MQVJHRV9VTk9GRklDSUFMAEhQRV9PSwBVTkxJTksAVU5MT0NLAFBSSQBSRVRSWV9XSVRIAEhQRV9JTlZBTElEX0NPTlRFTlRfTEVOR1RIAEhQRV9VTkVYUEVDVEVEX0NPTlRFTlRfTEVOR1RIAEZMVVNIAFBST1BQQVRDSABNLVNFQVJDSABVUklfVE9PX0xPTkcAUFJPQ0VTU0lORwBNSVNDRUxMQU5FT1VTX1BFUlNJU1RFTlRfV0FSTklORwBNSVNDRUxMQU5FT1VTX1dBUk5JTkcASFBFX0lOVkFMSURfVFJBTlNGRVJfRU5DT0RJTkcARXhwZWN0ZWQgQ1JMRgBIUEVfSU5WQUxJRF9DSFVOS19TSVpFAE1PVkUAQ09OVElOVUUASFBFX0NCX1NUQVRVU19DT01QTEVURQBIUEVfQ0JfSEVBREVSU19DT01QTEVURQBIUEVfQ0JfVkVSU0lPTl9DT01QTEVURQBIUEVfQ0JfVVJMX0NPTVBMRVRFAEhQRV9DQl9DSFVOS19DT01QTEVURQBIUEVfQ0JfSEVBREVSX1ZBTFVFX0NPTVBMRVRFAEhQRV9DQl9DSFVOS19FWFRFTlNJT05fVkFMVUVfQ09NUExFVEUASFBFX0NCX0NIVU5LX0VYVEVOU0lPTl9OQU1FX0NPTVBMRVRFAEhQRV9DQl9NRVNTQUdFX0NPTVBMRVRFAEhQRV9DQl9NRVRIT0RfQ09NUExFVEUASFBFX0NCX0hFQURFUl9GSUVMRF9DT01QTEVURQBERUxFVEUASFBFX0lOVkFMSURfRU9GX1NUQVRFAElOVkFMSURfU1NMX0NFUlRJRklDQVRFAFBBVVNFAE5PX1JFU1BPTlNFAFVOU1VQUE9SVEVEX01FRElBX1RZUEUAR09ORQBOT1RfQUNDRVBUQUJMRQBTRVJWSUNFX1VOQVZBSUxBQkxFAFJBTkdFX05PVF9TQVRJU0ZJQUJMRQBPUklHSU5fSVNfVU5SRUFDSEFCTEUAUkVTUE9OU0VfSVNfU1RBTEUAUFVSR0UATUVSR0UAUkVRVUVTVF9IRUFERVJfRklFTERTX1RPT19MQVJHRQBSRVFVRVNUX0hFQURFUl9UT09fTEFSR0UAUEFZTE9BRF9UT09fTEFSR0UASU5TVUZGSUNJRU5UX1NUT1JBR0UASFBFX1BBVVNFRF9VUEdSQURFAEhQRV9QQVVTRURfSDJfVVBHUkFERQBTT1VSQ0UAQU5OT1VOQ0UAVFJBQ0UASFBFX1VORVhQRUNURURfU1BBQ0UAREVTQ1JJQkUAVU5TVUJTQ1JJQkUAUkVDT1JEAEhQRV9JTlZBTElEX01FVEhPRABOT1RfRk9VTkQAUFJPUEZJTkQAVU5CSU5EAFJFQklORABVTkFVVEhPUklaRUQATUVUSE9EX05PVF9BTExPV0VEAEhUVFBfVkVSU0lPTl9OT1RfU1VQUE9SVEVEAEFMUkVBRFlfUkVQT1JURUQAQUNDRVBURUQATk9UX0lNUExFTUVOVEVEAExPT1BfREVURUNURUQASFBFX0NSX0VYUEVDVEVEAEhQRV9MRl9FWFBFQ1RFRABDUkVBVEVEAElNX1VTRUQASFBFX1BBVVNFRABUSU1FT1VUX09DQ1VSRUQAUEFZTUVOVF9SRVFVSVJFRABQUkVDT05ESVRJT05fUkVRVUlSRUQAUFJPWFlfQVVUSEVOVElDQVRJT05fUkVRVUlSRUQATkVUV09SS19BVVRIRU5USUNBVElPTl9SRVFVSVJFRABMRU5HVEhfUkVRVUlSRUQAU1NMX0NFUlRJRklDQVRFX1JFUVVJUkVEAFVQR1JBREVfUkVRVUlSRUQAUEFHRV9FWFBJUkVEAFBSRUNPTkRJVElPTl9GQUlMRUQARVhQRUNUQVRJT05fRkFJTEVEAFJFVkFMSURBVElPTl9GQUlMRUQAU1NMX0hBTkRTSEFLRV9GQUlMRUQATE9DS0VEAFRSQU5TRk9STUFUSU9OX0FQUExJRUQATk9UX01PRElGSUVEAE5PVF9FWFRFTkRFRABCQU5EV0lEVEhfTElNSVRfRVhDRUVERUQAU0lURV9JU19PVkVSTE9BREVEAEhFQUQARXhwZWN0ZWQgSFRUUC8AAF4TAAAmEwAAMBAAAPAXAACdEwAAFRIAADkXAADwEgAAChAAAHUSAACtEgAAghMAAE8UAAB/EAAAoBUAACMUAACJEgAAixQAAE0VAADUEQAAzxQAABAYAADJFgAA3BYAAMERAADgFwAAuxQAAHQUAAB8FQAA5RQAAAgXAAAfEAAAZRUAAKMUAAAoFQAAAhUAAJkVAAAsEAAAixkAAE8PAADUDgAAahAAAM4QAAACFwAAiQ4AAG4TAAAcEwAAZhQAAFYXAADBEwAAzRMAAGwTAABoFwAAZhcAAF8XAAAiEwAAzg8AAGkOAADYDgAAYxYAAMsTAACqDgAAKBcAACYXAADFEwAAXRYAAOgRAABnEwAAZRMAAPIWAABzEwAAHRcAAPkWAADzEQAAzw4AAM4VAAAMEgAAsxEAAKURAABhEAAAMhcAALsTAEH5NQsBAQBBkDYL4AEBAQIBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEAAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQBB/TcLAQEAQZE4C14CAwICAgICAAACAgACAgACAgICAgICAgICAAQAAAAAAAICAgICAgICAgICAgICAgICAgICAgICAgICAAAAAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAAgACAEH9OQsBAQBBkToLXgIAAgICAgIAAAICAAICAAICAgICAgICAgIAAwAEAAAAAgICAgICAgICAgICAgICAgICAgICAgICAgIAAAACAgICAgICAgICAgICAgICAgICAgICAgICAgICAgACAAIAQfA7Cw1sb3NlZWVwLWFsaXZlAEGJPAsBAQBBoDwL4AEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQABAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQBBiT4LAQEAQaA+C+cBAQEBAQEBAQEBAQEBAgEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEAAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQFjaHVua2VkAEGwwAALXwEBAAEBAQEBAAABAQABAQABAQEBAQEBAQEBAAAAAAAAAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAAAAAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEAAQABAEGQwgALIWVjdGlvbmVudC1sZW5ndGhvbnJveHktY29ubmVjdGlvbgBBwMIACy1yYW5zZmVyLWVuY29kaW5ncGdyYWRlDQoNCg0KU00NCg0KVFRQL0NFL1RTUC8AQfnCAAsFAQIAAQMAQZDDAAvgAQQBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAEH5xAALBQECAAEDAEGQxQAL4AEEAQEFAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQABAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQBB+cYACwQBAAABAEGRxwAL3wEBAQABAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEAAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAEH6yAALBAEAAAIAQZDJAAtfAwQAAAQEBAQEBAQEBAQEBQQEBAQEBAQEBAQEBAAEAAYHBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEAAQABAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAAAAAQAQfrKAAsEAQAAAQBBkMsACwEBAEGqywALQQIAAAAAAAADAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwAAAAAAAAMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAEH6zAALBAEAAAEAQZDNAAsBAQBBms0ACwYCAAAAAAIAQbHNAAs6AwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMAAAAAAAADAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwBB8M4AC5YBTk9VTkNFRUNLT1VUTkVDVEVURUNSSUJFTFVTSEVURUFEU0VBUkNIUkdFQ1RJVklUWUxFTkRBUlZFT1RJRllQVElPTlNDSFNFQVlTVEFUQ0hHRU9SRElSRUNUT1JUUkNIUEFSQU1FVEVSVVJDRUJTQ1JJQkVBUkRPV05BQ0VJTkROS0NLVUJTQ1JJQkVIVFRQL0FEVFAv","base64")});var Ret=H((Jfi,_et)=>{"use strict";d();var{Buffer:tJt}=require("node:buffer");_et.exports=tJt.from("AGFzbQEAAAABJwdgAX8Bf2ADf39/AX9gAX8AYAJ/fwBgBH9/f38Bf2AAAGADf39/AALLAQgDZW52GHdhc21fb25faGVhZGVyc19jb21wbGV0ZQAEA2VudhV3YXNtX29uX21lc3NhZ2VfYmVnaW4AAANlbnYLd2FzbV9vbl91cmwAAQNlbnYOd2FzbV9vbl9zdGF0dXMAAQNlbnYUd2FzbV9vbl9oZWFkZXJfZmllbGQAAQNlbnYUd2FzbV9vbl9oZWFkZXJfdmFsdWUAAQNlbnYMd2FzbV9vbl9ib2R5AAEDZW52GHdhc21fb25fbWVzc2FnZV9jb21wbGV0ZQAAAy0sBQYAAAIAAAAAAAACAQIAAgICAAADAAAAAAMDAwMBAQEBAQEBAQEAAAIAAAAEBQFwARISBQMBAAIGCAF/AUGA1AQLB9EFIgZtZW1vcnkCAAtfaW5pdGlhbGl6ZQAIGV9faW5kaXJlY3RfZnVuY3Rpb25fdGFibGUBAAtsbGh0dHBfaW5pdAAJGGxsaHR0cF9zaG91bGRfa2VlcF9hbGl2ZQAvDGxsaHR0cF9hbGxvYwALBm1hbGxvYwAxC2xsaHR0cF9mcmVlAAwEZnJlZQAMD2xsaHR0cF9nZXRfdHlwZQANFWxsaHR0cF9nZXRfaHR0cF9tYWpvcgAOFWxsaHR0cF9nZXRfaHR0cF9taW5vcgAPEWxsaHR0cF9nZXRfbWV0aG9kABAWbGxodHRwX2dldF9zdGF0dXNfY29kZQAREmxsaHR0cF9nZXRfdXBncmFkZQASDGxsaHR0cF9yZXNldAATDmxsaHR0cF9leGVjdXRlABQUbGxodHRwX3NldHRpbmdzX2luaXQAFQ1sbGh0dHBfZmluaXNoABYMbGxodHRwX3BhdXNlABcNbGxodHRwX3Jlc3VtZQAYG2xsaHR0cF9yZXN1bWVfYWZ0ZXJfdXBncmFkZQAZEGxsaHR0cF9nZXRfZXJybm8AGhdsbGh0dHBfZ2V0X2Vycm9yX3JlYXNvbgAbF2xsaHR0cF9zZXRfZXJyb3JfcmVhc29uABwUbGxodHRwX2dldF9lcnJvcl9wb3MAHRFsbGh0dHBfZXJybm9fbmFtZQAeEmxsaHR0cF9tZXRob2RfbmFtZQAfEmxsaHR0cF9zdGF0dXNfbmFtZQAgGmxsaHR0cF9zZXRfbGVuaWVudF9oZWFkZXJzACEhbGxodHRwX3NldF9sZW5pZW50X2NodW5rZWRfbGVuZ3RoACIdbGxodHRwX3NldF9sZW5pZW50X2tlZXBfYWxpdmUAIyRsbGh0dHBfc2V0X2xlbmllbnRfdHJhbnNmZXJfZW5jb2RpbmcAJBhsbGh0dHBfbWVzc2FnZV9uZWVkc19lb2YALgkXAQBBAQsRAQIDBAUKBgcrLSwqKSglJyYK77MCLBYAQYjQACgCAARAAAtBiNAAQQE2AgALFAAgABAwIAAgAjYCOCAAIAE6ACgLFAAgACAALwEyIAAtAC4gABAvEAALHgEBf0HAABAyIgEQMCABQYAINgI4IAEgADoAKCABC48MAQd/AkAgAEUNACAAQQhrIgEgAEEEaygCACIAQXhxIgRqIQUCQCAAQQFxDQAgAEEDcUUNASABIAEoAgAiAGsiAUGc0AAoAgBJDQEgACAEaiEEAkACQEGg0AAoAgAgAUcEQCAAQf8BTQRAIABBA3YhAyABKAIIIgAgASgCDCICRgRAQYzQAEGM0AAoAgBBfiADd3E2AgAMBQsgAiAANgIIIAAgAjYCDAwECyABKAIYIQYgASABKAIMIgBHBEAgACABKAIIIgI2AgggAiAANgIMDAMLIAFBFGoiAygCACICRQRAIAEoAhAiAkUNAiABQRBqIQMLA0AgAyEHIAIiAEEUaiIDKAIAIgINACAAQRBqIQMgACgCECICDQALIAdBADYCAAwCCyAFKAIEIgBBA3FBA0cNAiAFIABBfnE2AgRBlNAAIAQ2AgAgBSAENgIAIAEgBEEBcjYCBAwDC0EAIQALIAZFDQACQCABKAIcIgJBAnRBvNIAaiIDKAIAIAFGBEAgAyAANgIAIAANAUGQ0ABBkNAAKAIAQX4gAndxNgIADAILIAZBEEEUIAYoAhAgAUYbaiAANgIAIABFDQELIAAgBjYCGCABKAIQIgIEQCAAIAI2AhAgAiAANgIYCyABQRRqKAIAIgJFDQAgAEEUaiACNgIAIAIgADYCGAsgASAFTw0AIAUoAgQiAEEBcUUNAAJAAkACQAJAIABBAnFFBEBBpNAAKAIAIAVGBEBBpNAAIAE2AgBBmNAAQZjQACgCACAEaiIANgIAIAEgAEEBcjYCBCABQaDQACgCAEcNBkGU0ABBADYCAEGg0ABBADYCAAwGC0Gg0AAoAgAgBUYEQEGg0AAgATYCAEGU0ABBlNAAKAIAIARqIgA2AgAgASAAQQFyNgIEIAAgAWogADYCAAwGCyAAQXhxIARqIQQgAEH/AU0EQCAAQQN2IQMgBSgCCCIAIAUoAgwiAkYEQEGM0ABBjNAAKAIAQX4gA3dxNgIADAULIAIgADYCCCAAIAI2AgwMBAsgBSgCGCEGIAUgBSgCDCIARwRAQZzQACgCABogACAFKAIIIgI2AgggAiAANgIMDAMLIAVBFGoiAygCACICRQRAIAUoAhAiAkUNAiAFQRBqIQMLA0AgAyEHIAIiAEEUaiIDKAIAIgINACAAQRBqIQMgACgCECICDQALIAdBADYCAAwCCyAFIABBfnE2AgQgASAEaiAENgIAIAEgBEEBcjYCBAwDC0EAIQALIAZFDQACQCAFKAIcIgJBAnRBvNIAaiIDKAIAIAVGBEAgAyAANgIAIAANAUGQ0ABBkNAAKAIAQX4gAndxNgIADAILIAZBEEEUIAYoAhAgBUYbaiAANgIAIABFDQELIAAgBjYCGCAFKAIQIgIEQCAAIAI2AhAgAiAANgIYCyAFQRRqKAIAIgJFDQAgAEEUaiACNgIAIAIgADYCGAsgASAEaiAENgIAIAEgBEEBcjYCBCABQaDQACgCAEcNAEGU0AAgBDYCAAwBCyAEQf8BTQRAIARBeHFBtNAAaiEAAn9BjNAAKAIAIgJBASAEQQN2dCIDcUUEQEGM0AAgAiADcjYCACAADAELIAAoAggLIgIgATYCDCAAIAE2AgggASAANgIMIAEgAjYCCAwBC0EfIQIgBEH///8HTQRAIARBJiAEQQh2ZyIAa3ZBAXEgAEEBdGtBPmohAgsgASACNgIcIAFCADcCECACQQJ0QbzSAGohAAJAQZDQACgCACIDQQEgAnQiB3FFBEAgACABNgIAQZDQACADIAdyNgIAIAEgADYCGCABIAE2AgggASABNgIMDAELIARBGSACQQF2a0EAIAJBH0cbdCECIAAoAgAhAAJAA0AgACIDKAIEQXhxIARGDQEgAkEddiEAIAJBAXQhAiADIABBBHFqQRBqIgcoAgAiAA0ACyAHIAE2AgAgASADNgIYIAEgATYCDCABIAE2AggMAQsgAygCCCIAIAE2AgwgAyABNgIIIAFBADYCGCABIAM2AgwgASAANgIIC0Gs0ABBrNAAKAIAQQFrIgBBfyAAGzYCAAsLBwAgAC0AKAsHACAALQAqCwcAIAAtACsLBwAgAC0AKQsHACAALwEyCwcAIAAtAC4LQAEEfyAAKAIYIQEgAC0ALSECIAAtACghAyAAKAI4IQQgABAwIAAgBDYCOCAAIAM6ACggACACOgAtIAAgATYCGAu74gECB38DfiABIAJqIQQCQCAAIgIoAgwiAA0AIAIoAgQEQCACIAE2AgQLIwBBEGsiCCQAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACfwJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAIAIoAhwiA0EBaw7dAdoBAdkBAgMEBQYHCAkKCwwNDtgBDxDXARES1gETFBUWFxgZGhvgAd8BHB0e1QEfICEiIyQl1AEmJygpKiss0wHSAS0u0QHQAS8wMTIzNDU2Nzg5Ojs8PT4/QEFCQ0RFRtsBR0hJSs8BzgFLzQFMzAFNTk9QUVJTVFVWV1hZWltcXV5fYGFiY2RlZmdoaWprbG1ub3BxcnN0dXZ3eHl6e3x9fn+AAYEBggGDAYQBhQGGAYcBiAGJAYoBiwGMAY0BjgGPAZABkQGSAZMBlAGVAZYBlwGYAZkBmgGbAZwBnQGeAZ8BoAGhAaIBowGkAaUBpgGnAagBqQGqAasBrAGtAa4BrwGwAbEBsgGzAbQBtQG2AbcBywHKAbgByQG5AcgBugG7AbwBvQG+Ab8BwAHBAcIBwwHEAcUBxgEA3AELQQAMxgELQQ4MxQELQQ0MxAELQQ8MwwELQRAMwgELQRMMwQELQRQMwAELQRUMvwELQRYMvgELQRgMvQELQRkMvAELQRoMuwELQRsMugELQRwMuQELQR0MuAELQQgMtwELQR4MtgELQSAMtQELQR8MtAELQQcMswELQSEMsgELQSIMsQELQSMMsAELQSQMrwELQRIMrgELQREMrQELQSUMrAELQSYMqwELQScMqgELQSgMqQELQcMBDKgBC0EqDKcBC0ErDKYBC0EsDKUBC0EtDKQBC0EuDKMBC0EvDKIBC0HEAQyhAQtBMAygAQtBNAyfAQtBDAyeAQtBMQydAQtBMgycAQtBMwybAQtBOQyaAQtBNQyZAQtBxQEMmAELQQsMlwELQToMlgELQTYMlQELQQoMlAELQTcMkwELQTgMkgELQTwMkQELQTsMkAELQT0MjwELQQkMjgELQSkMjQELQT4MjAELQT8MiwELQcAADIoBC0HBAAyJAQtBwgAMiAELQcMADIcBC0HEAAyGAQtBxQAMhQELQcYADIQBC0EXDIMBC0HHAAyCAQtByAAMgQELQckADIABC0HKAAx/C0HLAAx+C0HNAAx9C0HMAAx8C0HOAAx7C0HPAAx6C0HQAAx5C0HRAAx4C0HSAAx3C0HTAAx2C0HUAAx1C0HWAAx0C0HVAAxzC0EGDHILQdcADHELQQUMcAtB2AAMbwtBBAxuC0HZAAxtC0HaAAxsC0HbAAxrC0HcAAxqC0EDDGkLQd0ADGgLQd4ADGcLQd8ADGYLQeEADGULQeAADGQLQeIADGMLQeMADGILQQIMYQtB5AAMYAtB5QAMXwtB5gAMXgtB5wAMXQtB6AAMXAtB6QAMWwtB6gAMWgtB6wAMWQtB7AAMWAtB7QAMVwtB7gAMVgtB7wAMVQtB8AAMVAtB8QAMUwtB8gAMUgtB8wAMUQtB9AAMUAtB9QAMTwtB9gAMTgtB9wAMTQtB+AAMTAtB+QAMSwtB+gAMSgtB+wAMSQtB/AAMSAtB/QAMRwtB/gAMRgtB/wAMRQtBgAEMRAtBgQEMQwtBggEMQgtBgwEMQQtBhAEMQAtBhQEMPwtBhgEMPgtBhwEMPQtBiAEMPAtBiQEMOwtBigEMOgtBiwEMOQtBjAEMOAtBjQEMNwtBjgEMNgtBjwEMNQtBkAEMNAtBkQEMMwtBkgEMMgtBkwEMMQtBlAEMMAtBlQEMLwtBlgEMLgtBlwEMLQtBmAEMLAtBmQEMKwtBmgEMKgtBmwEMKQtBnAEMKAtBnQEMJwtBngEMJgtBnwEMJQtBoAEMJAtBoQEMIwtBogEMIgtBowEMIQtBpAEMIAtBpQEMHwtBpgEMHgtBpwEMHQtBqAEMHAtBqQEMGwtBqgEMGgtBqwEMGQtBrAEMGAtBrQEMFwtBrgEMFgtBAQwVC0GvAQwUC0GwAQwTC0GxAQwSC0GzAQwRC0GyAQwQC0G0AQwPC0G1AQwOC0G2AQwNC0G3AQwMC0G4AQwLC0G5AQwKC0G6AQwJC0G7AQwIC0HGAQwHC0G8AQwGC0G9AQwFC0G+AQwEC0G/AQwDC0HAAQwCC0HCAQwBC0HBAQshAwNAAkACQAJAAkACQAJAAkACQAJAIAICfwJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJ/AkACQAJAAkACQAJAAkACQAJAAkACQAJAAkAgAgJ/AkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACfwJAAkACfwJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACfwJAAkACQAJAAn8CQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQCADDsYBAAECAwQFBgcICQoLDA0ODxAREhMUFRYXGBkaGxwdHyAhIyUmKCorLC8wMTIzNDU2Nzk6Ozw9lANAQkRFRklLTk9QUVJTVFVWWFpbXF1eX2BhYmNkZWZnaGpsb3Bxc3V2eHl6e3x/gAGBAYIBgwGEAYUBhgGHAYgBiQGKAYsBjAGNAY4BjwGQAZEBkgGTAZQBlQGWAZcBmAGZAZoBmwGcAZ0BngGfAaABoQGiAaMBpAGlAaYBpwGoAakBqgGrAawBrQGuAa8BsAGxAbIBswG0AbUBtgG3AbgBuQG6AbsBvAG9Ab4BvwHAAcEBwgHDAcQBxQHGAccByAHJAcsBzAHNAc4BzwGKA4kDiAOHA4QDgwOAA/sC+gL5AvgC9wL0AvMC8gLLAsECsALZAQsgASAERw3wAkHdASEDDLMDCyABIARHDcgBQcMBIQMMsgMLIAEgBEcNe0H3ACEDDLEDCyABIARHDXBB7wAhAwywAwsgASAERw1pQeoAIQMMrwMLIAEgBEcNZUHoACEDDK4DCyABIARHDWJB5gAhAwytAwsgASAERw0aQRghAwysAwsgASAERw0VQRIhAwyrAwsgASAERw1CQcUAIQMMqgMLIAEgBEcNNEE/IQMMqQMLIAEgBEcNMkE8IQMMqAMLIAEgBEcNK0ExIQMMpwMLIAItAC5BAUYNnwMMwQILQQAhAAJAAkACQCACLQAqRQ0AIAItACtFDQAgAi8BMCIDQQJxRQ0BDAILIAIvATAiA0EBcUUNAQtBASEAIAItAChBAUYNACACLwEyIgVB5ABrQeQASQ0AIAVBzAFGDQAgBUGwAkYNACADQcAAcQ0AQQAhACADQYgEcUGABEYNACADQShxQQBHIQALIAJBADsBMCACQQA6AC8gAEUN3wIgAkIANwMgDOACC0EAIQACQCACKAI4IgNFDQAgAygCLCIDRQ0AIAIgAxEAACEACyAARQ3MASAAQRVHDd0CIAJBBDYCHCACIAE2AhQgAkGwGDYCECACQRU2AgxBACEDDKQDCyABIARGBEBBBiEDDKQDCyABQQFqIQFBACEAAkAgAigCOCIDRQ0AIAMoAlQiA0UNACACIAMRAAAhAAsgAA3ZAgwcCyACQgA3AyBBEiEDDIkDCyABIARHDRZBHSEDDKEDCyABIARHBEAgAUEBaiEBQRAhAwyIAwtBByEDDKADCyACIAIpAyAiCiAEIAFrrSILfSIMQgAgCiAMWhs3AyAgCiALWA3UAkEIIQMMnwMLIAEgBEcEQCACQQk2AgggAiABNgIEQRQhAwyGAwtBCSEDDJ4DCyACKQMgQgBSDccBIAIgAi8BMEGAAXI7ATAMQgsgASAERw0/QdAAIQMMnAMLIAEgBEYEQEELIQMMnAMLIAFBAWohAUEAIQACQCACKAI4IgNFDQAgAygCUCIDRQ0AIAIgAxEAACEACyAADc8CDMYBC0EAIQACQCACKAI4IgNFDQAgAygCSCIDRQ0AIAIgAxEAACEACyAARQ3GASAAQRVHDc0CIAJBCzYCHCACIAE2AhQgAkGCGTYCECACQRU2AgxBACEDDJoDC0EAIQACQCACKAI4IgNFDQAgAygCSCIDRQ0AIAIgAxEAACEACyAARQ0MIABBFUcNygIgAkEaNgIcIAIgATYCFCACQYIZNgIQIAJBFTYCDEEAIQMMmQMLQQAhAAJAIAIoAjgiA0UNACADKAJMIgNFDQAgAiADEQAAIQALIABFDcQBIABBFUcNxwIgAkELNgIcIAIgATYCFCACQZEXNgIQIAJBFTYCDEEAIQMMmAMLIAEgBEYEQEEPIQMMmAMLIAEtAAAiAEE7Rg0HIABBDUcNxAIgAUEBaiEBDMMBC0EAIQACQCACKAI4IgNFDQAgAygCTCIDRQ0AIAIgAxEAACEACyAARQ3DASAAQRVHDcICIAJBDzYCHCACIAE2AhQgAkGRFzYCECACQRU2AgxBACEDDJYDCwNAIAEtAABB8DVqLQAAIgBBAUcEQCAAQQJHDcECIAIoAgQhAEEAIQMgAkEANgIEIAIgACABQQFqIgEQLSIADcICDMUBCyAEIAFBAWoiAUcNAAtBEiEDDJUDC0EAIQACQCACKAI4IgNFDQAgAygCTCIDRQ0AIAIgAxEAACEACyAARQ3FASAAQRVHDb0CIAJBGzYCHCACIAE2AhQgAkGRFzYCECACQRU2AgxBACEDDJQDCyABIARGBEBBFiEDDJQDCyACQQo2AgggAiABNgIEQQAhAAJAIAIoAjgiA0UNACADKAJIIgNFDQAgAiADEQAAIQALIABFDcIBIABBFUcNuQIgAkEVNgIcIAIgATYCFCACQYIZNgIQIAJBFTYCDEEAIQMMkwMLIAEgBEcEQANAIAEtAABB8DdqLQAAIgBBAkcEQAJAIABBAWsOBMQCvQIAvgK9AgsgAUEBaiEBQQghAwz8AgsgBCABQQFqIgFHDQALQRUhAwyTAwtBFSEDDJIDCwNAIAEtAABB8DlqLQAAIgBBAkcEQCAAQQFrDgTFArcCwwK4ArcCCyAEIAFBAWoiAUcNAAtBGCEDDJEDCyABIARHBEAgAkELNgIIIAIgATYCBEEHIQMM+AILQRkhAwyQAwsgAUEBaiEBDAILIAEgBEYEQEEaIQMMjwMLAkAgAS0AAEENaw4UtQG/Ab8BvwG/Ab8BvwG/Ab8BvwG/Ab8BvwG/Ab8BvwG/Ab8BvwEAvwELQQAhAyACQQA2AhwgAkGvCzYCECACQQI2AgwgAiABQQFqNgIUDI4DCyABIARGBEBBGyEDDI4DCyABLQAAIgBBO0cEQCAAQQ1HDbECIAFBAWohAQy6AQsgAUEBaiEBC0EiIQMM8wILIAEgBEYEQEEcIQMMjAMLQgAhCgJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkAgAS0AAEEwaw43wQLAAgABAgMEBQYH0AHQAdAB0AHQAdAB0AEICQoLDA3QAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdABDg8QERIT0AELQgIhCgzAAgtCAyEKDL8CC0IEIQoMvgILQgUhCgy9AgtCBiEKDLwCC0IHIQoMuwILQgghCgy6AgtCCSEKDLkCC0IKIQoMuAILQgshCgy3AgtCDCEKDLYCC0INIQoMtQILQg4hCgy0AgtCDyEKDLMCC0IKIQoMsgILQgshCgyxAgtCDCEKDLACC0INIQoMrwILQg4hCgyuAgtCDyEKDK0CC0IAIQoCQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAIAEtAABBMGsON8ACvwIAAQIDBAUGB74CvgK+Ar4CvgK+Ar4CCAkKCwwNvgK+Ar4CvgK+Ar4CvgK+Ar4CvgK+Ar4CvgK+Ar4CvgK+Ar4CvgK+Ar4CvgK+Ar4CvgK+Ag4PEBESE74CC0ICIQoMvwILQgMhCgy+AgtCBCEKDL0CC0IFIQoMvAILQgYhCgy7AgtCByEKDLoCC0IIIQoMuQILQgkhCgy4AgtCCiEKDLcCC0ILIQoMtgILQgwhCgy1AgtCDSEKDLQCC0IOIQoMswILQg8hCgyyAgtCCiEKDLECC0ILIQoMsAILQgwhCgyvAgtCDSEKDK4CC0IOIQoMrQILQg8hCgysAgsgAiACKQMgIgogBCABa60iC30iDEIAIAogDFobNwMgIAogC1gNpwJBHyEDDIkDCyABIARHBEAgAkEJNgIIIAIgATYCBEElIQMM8AILQSAhAwyIAwtBASEFIAIvATAiA0EIcUUEQCACKQMgQgBSIQULAkAgAi0ALgRAQQEhACACLQApQQVGDQEgA0HAAHFFIAVxRQ0BC0EAIQAgA0HAAHENAEECIQAgA0EIcQ0AIANBgARxBEACQCACLQAoQQFHDQAgAi0ALUEKcQ0AQQUhAAwCC0EEIQAMAQsgA0EgcUUEQAJAIAItAChBAUYNACACLwEyIgBB5ABrQeQASQ0AIABBzAFGDQAgAEGwAkYNAEEEIQAgA0EocUUNAiADQYgEcUGABEYNAgtBACEADAELQQBBAyACKQMgUBshAAsgAEEBaw4FvgIAsAEBpAKhAgtBESEDDO0CCyACQQE6AC8MhAMLIAEgBEcNnQJBJCEDDIQDCyABIARHDRxBxgAhAwyDAwtBACEAAkAgAigCOCIDRQ0AIAMoAkQiA0UNACACIAMRAAAhAAsgAEUNJyAAQRVHDZgCIAJB0AA2AhwgAiABNgIUIAJBkRg2AhAgAkEVNgIMQQAhAwyCAwsgASAERgRAQSghAwyCAwtBACEDIAJBADYCBCACQQw2AgggAiABIAEQKiIARQ2UAiACQSc2AhwgAiABNgIUIAIgADYCDAyBAwsgASAERgRAQSkhAwyBAwsgAS0AACIAQSBGDRMgAEEJRw2VAiABQQFqIQEMFAsgASAERwRAIAFBAWohAQwWC0EqIQMM/wILIAEgBEYEQEErIQMM/wILIAEtAAAiAEEJRyAAQSBHcQ2QAiACLQAsQQhHDd0CIAJBADoALAzdAgsgASAERgRAQSwhAwz+AgsgAS0AAEEKRw2OAiABQQFqIQEMsAELIAEgBEcNigJBLyEDDPwCCwNAIAEtAAAiAEEgRwRAIABBCmsOBIQCiAKIAoQChgILIAQgAUEBaiIBRw0AC0ExIQMM+wILQTIhAyABIARGDfoCIAIoAgAiACAEIAFraiEHIAEgAGtBA2ohBgJAA0AgAEHwO2otAAAgAS0AACIFQSByIAUgBUHBAGtB/wFxQRpJG0H/AXFHDQEgAEEDRgRAQQYhAQziAgsgAEEBaiEAIAQgAUEBaiIBRw0ACyACIAc2AgAM+wILIAJBADYCAAyGAgtBMyEDIAQgASIARg35AiAEIAFrIAIoAgAiAWohByAAIAFrQQhqIQYCQANAIAFB9DtqLQAAIAAtAAAiBUEgciAFIAVBwQBrQf8BcUEaSRtB/wFxRw0BIAFBCEYEQEEFIQEM4QILIAFBAWohASAEIABBAWoiAEcNAAsgAiAHNgIADPoCCyACQQA2AgAgACEBDIUCC0E0IQMgBCABIgBGDfgCIAQgAWsgAigCACIBaiEHIAAgAWtBBWohBgJAA0AgAUHQwgBqLQAAIAAtAAAiBUEgciAFIAVBwQBrQf8BcUEaSRtB/wFxRw0BIAFBBUYEQEEHIQEM4AILIAFBAWohASAEIABBAWoiAEcNAAsgAiAHNgIADPkCCyACQQA2AgAgACEBDIQCCyABIARHBEADQCABLQAAQYA+ai0AACIAQQFHBEAgAEECRg0JDIECCyAEIAFBAWoiAUcNAAtBMCEDDPgCC0EwIQMM9wILIAEgBEcEQANAIAEtAAAiAEEgRwRAIABBCmsOBP8B/gH+Af8B/gELIAQgAUEBaiIBRw0AC0E4IQMM9wILQTghAwz2AgsDQCABLQAAIgBBIEcgAEEJR3EN9gEgBCABQQFqIgFHDQALQTwhAwz1AgsDQCABLQAAIgBBIEcEQAJAIABBCmsOBPkBBAT5AQALIABBLEYN9QEMAwsgBCABQQFqIgFHDQALQT8hAwz0AgtBwAAhAyABIARGDfMCIAIoAgAiACAEIAFraiEFIAEgAGtBBmohBgJAA0AgAEGAQGstAAAgAS0AAEEgckcNASAAQQZGDdsCIABBAWohACAEIAFBAWoiAUcNAAsgAiAFNgIADPQCCyACQQA2AgALQTYhAwzZAgsgASAERgRAQcEAIQMM8gILIAJBDDYCCCACIAE2AgQgAi0ALEEBaw4E+wHuAewB6wHUAgsgAUEBaiEBDPoBCyABIARHBEADQAJAIAEtAAAiAEEgciAAIABBwQBrQf8BcUEaSRtB/wFxIgBBCUYNACAAQSBGDQACQAJAAkACQCAAQeMAaw4TAAMDAwMDAwMBAwMDAwMDAwMDAgMLIAFBAWohAUExIQMM3AILIAFBAWohAUEyIQMM2wILIAFBAWohAUEzIQMM2gILDP4BCyAEIAFBAWoiAUcNAAtBNSEDDPACC0E1IQMM7wILIAEgBEcEQANAIAEtAABBgDxqLQAAQQFHDfcBIAQgAUEBaiIBRw0AC0E9IQMM7wILQT0hAwzuAgtBACEAAkAgAigCOCIDRQ0AIAMoAkAiA0UNACACIAMRAAAhAAsgAEUNASAAQRVHDeYBIAJBwgA2AhwgAiABNgIUIAJB4xg2AhAgAkEVNgIMQQAhAwztAgsgAUEBaiEBC0E8IQMM0gILIAEgBEYEQEHCACEDDOsCCwJAA0ACQCABLQAAQQlrDhgAAswCzALRAswCzALMAswCzALMAswCzALMAswCzALMAswCzALMAswCzALMAgDMAgsgBCABQQFqIgFHDQALQcIAIQMM6wILIAFBAWohASACLQAtQQFxRQ3+AQtBLCEDDNACCyABIARHDd4BQcQAIQMM6AILA0AgAS0AAEGQwABqLQAAQQFHDZwBIAQgAUEBaiIBRw0AC0HFACEDDOcCCyABLQAAIgBBIEYN/gEgAEE6Rw3AAiACKAIEIQBBACEDIAJBADYCBCACIAAgARApIgAN3gEM3QELQccAIQMgBCABIgBGDeUCIAQgAWsgAigCACIBaiEHIAAgAWtBBWohBgNAIAFBkMIAai0AACAALQAAIgVBIHIgBSAFQcEAa0H/AXFBGkkbQf8BcUcNvwIgAUEFRg3CAiABQQFqIQEgBCAAQQFqIgBHDQALIAIgBzYCAAzlAgtByAAhAyAEIAEiAEYN5AIgBCABayACKAIAIgFqIQcgACABa0EJaiEGA0AgAUGWwgBqLQAAIAAtAAAiBUEgciAFIAVBwQBrQf8BcUEaSRtB/wFxRw2+AkECIAFBCUYNwgIaIAFBAWohASAEIABBAWoiAEcNAAsgAiAHNgIADOQCCyABIARGBEBByQAhAwzkAgsCQAJAIAEtAAAiAEEgciAAIABBwQBrQf8BcUEaSRtB/wFxQe4Aaw4HAL8CvwK/Ar8CvwIBvwILIAFBAWohAUE+IQMMywILIAFBAWohAUE/IQMMygILQcoAIQMgBCABIgBGDeICIAQgAWsgAigCACIBaiEGIAAgAWtBAWohBwNAIAFBoMIAai0AACAALQAAIgVBIHIgBSAFQcEAa0H/AXFBGkkbQf8BcUcNvAIgAUEBRg2+AiABQQFqIQEgBCAAQQFqIgBHDQALIAIgBjYCAAziAgtBywAhAyAEIAEiAEYN4QIgBCABayACKAIAIgFqIQcgACABa0EOaiEGA0AgAUGiwgBqLQAAIAAtAAAiBUEgciAFIAVBwQBrQf8BcUEaSRtB/wFxRw27AiABQQ5GDb4CIAFBAWohASAEIABBAWoiAEcNAAsgAiAHNgIADOECC0HMACEDIAQgASIARg3gAiAEIAFrIAIoAgAiAWohByAAIAFrQQ9qIQYDQCABQcDCAGotAAAgAC0AACIFQSByIAUgBUHBAGtB/wFxQRpJG0H/AXFHDboCQQMgAUEPRg2+AhogAUEBaiEBIAQgAEEBaiIARw0ACyACIAc2AgAM4AILQc0AIQMgBCABIgBGDd8CIAQgAWsgAigCACIBaiEHIAAgAWtBBWohBgNAIAFB0MIAai0AACAALQAAIgVBIHIgBSAFQcEAa0H/AXFBGkkbQf8BcUcNuQJBBCABQQVGDb0CGiABQQFqIQEgBCAAQQFqIgBHDQALIAIgBzYCAAzfAgsgASAERgRAQc4AIQMM3wILAkACQAJAAkAgAS0AACIAQSByIAAgAEHBAGtB/wFxQRpJG0H/AXFB4wBrDhMAvAK8ArwCvAK8ArwCvAK8ArwCvAK8ArwCAbwCvAK8AgIDvAILIAFBAWohAUHBACEDDMgCCyABQQFqIQFBwgAhAwzHAgsgAUEBaiEBQcMAIQMMxgILIAFBAWohAUHEACEDDMUCCyABIARHBEAgAkENNgIIIAIgATYCBEHFACEDDMUCC0HPACEDDN0CCwJAAkAgAS0AAEEKaw4EAZABkAEAkAELIAFBAWohAQtBKCEDDMMCCyABIARGBEBB0QAhAwzcAgsgAS0AAEEgRw0AIAFBAWohASACLQAtQQFxRQ3QAQtBFyEDDMECCyABIARHDcsBQdIAIQMM2QILQdMAIQMgASAERg3YAiACKAIAIgAgBCABa2ohBiABIABrQQFqIQUDQCABLQAAIABB1sIAai0AAEcNxwEgAEEBRg3KASAAQQFqIQAgBCABQQFqIgFHDQALIAIgBjYCAAzYAgsgASAERgRAQdUAIQMM2AILIAEtAABBCkcNwgEgAUEBaiEBDMoBCyABIARGBEBB1gAhAwzXAgsCQAJAIAEtAABBCmsOBADDAcMBAcMBCyABQQFqIQEMygELIAFBAWohAUHKACEDDL0CC0EAIQACQCACKAI4IgNFDQAgAygCPCIDRQ0AIAIgAxEAACEACyAADb8BQc0AIQMMvAILIAItAClBIkYNzwIMiQELIAQgASIFRgRAQdsAIQMM1AILQQAhAEEBIQFBASEGQQAhAwJAAn8CQAJAAkACQAJAAkACQCAFLQAAQTBrDgrFAcQBAAECAwQFBgjDAQtBAgwGC0EDDAULQQQMBAtBBQwDC0EGDAILQQcMAQtBCAshA0EAIQFBACEGDL0BC0EJIQNBASEAQQAhAUEAIQYMvAELIAEgBEYEQEHdACEDDNMCCyABLQAAQS5HDbgBIAFBAWohAQyIAQsgASAERw22AUHfACEDDNECCyABIARHBEAgAkEONgIIIAIgATYCBEHQACEDDLgCC0HgACEDDNACC0HhACEDIAEgBEYNzwIgAigCACIAIAQgAWtqIQUgASAAa0EDaiEGA0AgAS0AACAAQeLCAGotAABHDbEBIABBA0YNswEgAEEBaiEAIAQgAUEBaiIBRw0ACyACIAU2AgAMzwILQeIAIQMgASAERg3OAiACKAIAIgAgBCABa2ohBSABIABrQQJqIQYDQCABLQAAIABB5sIAai0AAEcNsAEgAEECRg2vASAAQQFqIQAgBCABQQFqIgFHDQALIAIgBTYCAAzOAgtB4wAhAyABIARGDc0CIAIoAgAiACAEIAFraiEFIAEgAGtBA2ohBgNAIAEtAAAgAEHpwgBqLQAARw2vASAAQQNGDa0BIABBAWohACAEIAFBAWoiAUcNAAsgAiAFNgIADM0CCyABIARGBEBB5QAhAwzNAgsgAUEBaiEBQQAhAAJAIAIoAjgiA0UNACADKAIwIgNFDQAgAiADEQAAIQALIAANqgFB1gAhAwyzAgsgASAERwRAA0AgAS0AACIAQSBHBEACQAJAAkAgAEHIAGsOCwABswGzAbMBswGzAbMBswGzAQKzAQsgAUEBaiEBQdIAIQMMtwILIAFBAWohAUHTACEDDLYCCyABQQFqIQFB1AAhAwy1AgsgBCABQQFqIgFHDQALQeQAIQMMzAILQeQAIQMMywILA0AgAS0AAEHwwgBqLQAAIgBBAUcEQCAAQQJrDgOnAaYBpQGkAQsgBCABQQFqIgFHDQALQeYAIQMMygILIAFBAWogASAERw0CGkHnACEDDMkCCwNAIAEtAABB8MQAai0AACIAQQFHBEACQCAAQQJrDgSiAaEBoAEAnwELQdcAIQMMsQILIAQgAUEBaiIBRw0AC0HoACEDDMgCCyABIARGBEBB6QAhAwzIAgsCQCABLQAAIgBBCmsOGrcBmwGbAbQBmwGbAZsBmwGbAZsBmwGbAZsBmwGbAZsBmwGbAZsBmwGbAZsBpAGbAZsBAJkBCyABQQFqCyEBQQYhAwytAgsDQCABLQAAQfDGAGotAABBAUcNfSAEIAFBAWoiAUcNAAtB6gAhAwzFAgsgAUEBaiABIARHDQIaQesAIQMMxAILIAEgBEYEQEHsACEDDMQCCyABQQFqDAELIAEgBEYEQEHtACEDDMMCCyABQQFqCyEBQQQhAwyoAgsgASAERgRAQe4AIQMMwQILAkACQAJAIAEtAABB8MgAai0AAEEBaw4HkAGPAY4BAHwBAo0BCyABQQFqIQEMCwsgAUEBagyTAQtBACEDIAJBADYCHCACQZsSNgIQIAJBBzYCDCACIAFBAWo2AhQMwAILAkADQCABLQAAQfDIAGotAAAiAEEERwRAAkACQCAAQQFrDgeUAZMBkgGNAQAEAY0BC0HaACEDDKoCCyABQQFqIQFB3AAhAwypAgsgBCABQQFqIgFHDQALQe8AIQMMwAILIAFBAWoMkQELIAQgASIARgRAQfAAIQMMvwILIAAtAABBL0cNASAAQQFqIQEMBwsgBCABIgBGBEBB8QAhAwy+AgsgAC0AACIBQS9GBEAgAEEBaiEBQd0AIQMMpQILIAFBCmsiA0EWSw0AIAAhAUEBIAN0QYmAgAJxDfkBC0EAIQMgAkEANgIcIAIgADYCFCACQYwcNgIQIAJBBzYCDAy8AgsgASAERwRAIAFBAWohAUHeACEDDKMCC0HyACEDDLsCCyABIARGBEBB9AAhAwy7AgsCQCABLQAAQfDMAGotAABBAWsOA/cBcwCCAQtB4QAhAwyhAgsgASAERwRAA0AgAS0AAEHwygBqLQAAIgBBA0cEQAJAIABBAWsOAvkBAIUBC0HfACEDDKMCCyAEIAFBAWoiAUcNAAtB8wAhAwy6AgtB8wAhAwy5AgsgASAERwRAIAJBDzYCCCACIAE2AgRB4AAhAwygAgtB9QAhAwy4AgsgASAERgRAQfYAIQMMuAILIAJBDzYCCCACIAE2AgQLQQMhAwydAgsDQCABLQAAQSBHDY4CIAQgAUEBaiIBRw0AC0H3ACEDDLUCCyABIARGBEBB+AAhAwy1AgsgAS0AAEEgRw16IAFBAWohAQxbC0EAIQACQCACKAI4IgNFDQAgAygCOCIDRQ0AIAIgAxEAACEACyAADXgMgAILIAEgBEYEQEH6ACEDDLMCCyABLQAAQcwARw10IAFBAWohAUETDHYLQfsAIQMgASAERg2xAiACKAIAIgAgBCABa2ohBSABIABrQQVqIQYDQCABLQAAIABB8M4Aai0AAEcNcyAAQQVGDXUgAEEBaiEAIAQgAUEBaiIBRw0ACyACIAU2AgAMsQILIAEgBEYEQEH8ACEDDLECCwJAAkAgAS0AAEHDAGsODAB0dHR0dHR0dHR0AXQLIAFBAWohAUHmACEDDJgCCyABQQFqIQFB5wAhAwyXAgtB/QAhAyABIARGDa8CIAIoAgAiACAEIAFraiEFIAEgAGtBAmohBgJAA0AgAS0AACAAQe3PAGotAABHDXIgAEECRg0BIABBAWohACAEIAFBAWoiAUcNAAsgAiAFNgIADLACCyACQQA2AgAgBkEBaiEBQRAMcwtB/gAhAyABIARGDa4CIAIoAgAiACAEIAFraiEFIAEgAGtBBWohBgJAA0AgAS0AACAAQfbOAGotAABHDXEgAEEFRg0BIABBAWohACAEIAFBAWoiAUcNAAsgAiAFNgIADK8CCyACQQA2AgAgBkEBaiEBQRYMcgtB/wAhAyABIARGDa0CIAIoAgAiACAEIAFraiEFIAEgAGtBA2ohBgJAA0AgAS0AACAAQfzOAGotAABHDXAgAEEDRg0BIABBAWohACAEIAFBAWoiAUcNAAsgAiAFNgIADK4CCyACQQA2AgAgBkEBaiEBQQUMcQsgASAERgRAQYABIQMMrQILIAEtAABB2QBHDW4gAUEBaiEBQQgMcAsgASAERgRAQYEBIQMMrAILAkACQCABLQAAQc4Aaw4DAG8BbwsgAUEBaiEBQesAIQMMkwILIAFBAWohAUHsACEDDJICCyABIARGBEBBggEhAwyrAgsCQAJAIAEtAABByABrDggAbm5ubm5uAW4LIAFBAWohAUHqACEDDJICCyABQQFqIQFB7QAhAwyRAgtBgwEhAyABIARGDakCIAIoAgAiACAEIAFraiEFIAEgAGtBAmohBgJAA0AgAS0AACAAQYDPAGotAABHDWwgAEECRg0BIABBAWohACAEIAFBAWoiAUcNAAsgAiAFNgIADKoCCyACQQA2AgAgBkEBaiEBQQAMbQtBhAEhAyABIARGDagCIAIoAgAiACAEIAFraiEFIAEgAGtBBGohBgJAA0AgAS0AACAAQYPPAGotAABHDWsgAEEERg0BIABBAWohACAEIAFBAWoiAUcNAAsgAiAFNgIADKkCCyACQQA2AgAgBkEBaiEBQSMMbAsgASAERgRAQYUBIQMMqAILAkACQCABLQAAQcwAaw4IAGtra2trawFrCyABQQFqIQFB7wAhAwyPAgsgAUEBaiEBQfAAIQMMjgILIAEgBEYEQEGGASEDDKcCCyABLQAAQcUARw1oIAFBAWohAQxgC0GHASEDIAEgBEYNpQIgAigCACIAIAQgAWtqIQUgASAAa0EDaiEGAkADQCABLQAAIABBiM8Aai0AAEcNaCAAQQNGDQEgAEEBaiEAIAQgAUEBaiIBRw0ACyACIAU2AgAMpgILIAJBADYCACAGQQFqIQFBLQxpC0GIASEDIAEgBEYNpAIgAigCACIAIAQgAWtqIQUgASAAa0EIaiEGAkADQCABLQAAIABB0M8Aai0AAEcNZyAAQQhGDQEgAEEBaiEAIAQgAUEBaiIBRw0ACyACIAU2AgAMpQILIAJBADYCACAGQQFqIQFBKQxoCyABIARGBEBBiQEhAwykAgtBASABLQAAQd8ARw1nGiABQQFqIQEMXgtBigEhAyABIARGDaICIAIoAgAiACAEIAFraiEFIAEgAGtBAWohBgNAIAEtAAAgAEGMzwBqLQAARw1kIABBAUYN+gEgAEEBaiEAIAQgAUEBaiIBRw0ACyACIAU2AgAMogILQYsBIQMgASAERg2hAiACKAIAIgAgBCABa2ohBSABIABrQQJqIQYCQANAIAEtAAAgAEGOzwBqLQAARw1kIABBAkYNASAAQQFqIQAgBCABQQFqIgFHDQALIAIgBTYCAAyiAgsgAkEANgIAIAZBAWohAUECDGULQYwBIQMgASAERg2gAiACKAIAIgAgBCABa2ohBSABIABrQQFqIQYCQANAIAEtAAAgAEHwzwBqLQAARw1jIABBAUYNASAAQQFqIQAgBCABQQFqIgFHDQALIAIgBTYCAAyhAgsgAkEANgIAIAZBAWohAUEfDGQLQY0BIQMgASAERg2fAiACKAIAIgAgBCABa2ohBSABIABrQQFqIQYCQANAIAEtAAAgAEHyzwBqLQAARw1iIABBAUYNASAAQQFqIQAgBCABQQFqIgFHDQALIAIgBTYCAAygAgsgAkEANgIAIAZBAWohAUEJDGMLIAEgBEYEQEGOASEDDJ8CCwJAAkAgAS0AAEHJAGsOBwBiYmJiYgFiCyABQQFqIQFB+AAhAwyGAgsgAUEBaiEBQfkAIQMMhQILQY8BIQMgASAERg2dAiACKAIAIgAgBCABa2ohBSABIABrQQVqIQYCQANAIAEtAAAgAEGRzwBqLQAARw1gIABBBUYNASAAQQFqIQAgBCABQQFqIgFHDQALIAIgBTYCAAyeAgsgAkEANgIAIAZBAWohAUEYDGELQZABIQMgASAERg2cAiACKAIAIgAgBCABa2ohBSABIABrQQJqIQYCQANAIAEtAAAgAEGXzwBqLQAARw1fIABBAkYNASAAQQFqIQAgBCABQQFqIgFHDQALIAIgBTYCAAydAgsgAkEANgIAIAZBAWohAUEXDGALQZEBIQMgASAERg2bAiACKAIAIgAgBCABa2ohBSABIABrQQZqIQYCQANAIAEtAAAgAEGazwBqLQAARw1eIABBBkYNASAAQQFqIQAgBCABQQFqIgFHDQALIAIgBTYCAAycAgsgAkEANgIAIAZBAWohAUEVDF8LQZIBIQMgASAERg2aAiACKAIAIgAgBCABa2ohBSABIABrQQVqIQYCQANAIAEtAAAgAEGhzwBqLQAARw1dIABBBUYNASAAQQFqIQAgBCABQQFqIgFHDQALIAIgBTYCAAybAgsgAkEANgIAIAZBAWohAUEeDF4LIAEgBEYEQEGTASEDDJoCCyABLQAAQcwARw1bIAFBAWohAUEKDF0LIAEgBEYEQEGUASEDDJkCCwJAAkAgAS0AAEHBAGsODwBcXFxcXFxcXFxcXFxcAVwLIAFBAWohAUH+ACEDDIACCyABQQFqIQFB/wAhAwz/AQsgASAERgRAQZUBIQMMmAILAkACQCABLQAAQcEAaw4DAFsBWwsgAUEBaiEBQf0AIQMM/wELIAFBAWohAUGAASEDDP4BC0GWASEDIAEgBEYNlgIgAigCACIAIAQgAWtqIQUgASAAa0EBaiEGAkADQCABLQAAIABBp88Aai0AAEcNWSAAQQFGDQEgAEEBaiEAIAQgAUEBaiIBRw0ACyACIAU2AgAMlwILIAJBADYCACAGQQFqIQFBCwxaCyABIARGBEBBlwEhAwyWAgsCQAJAAkACQCABLQAAQS1rDiMAW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1sBW1tbW1sCW1tbA1sLIAFBAWohAUH7ACEDDP8BCyABQQFqIQFB/AAhAwz+AQsgAUEBaiEBQYEBIQMM/QELIAFBAWohAUGCASEDDPwBC0GYASEDIAEgBEYNlAIgAigCACIAIAQgAWtqIQUgASAAa0EEaiEGAkADQCABLQAAIABBqc8Aai0AAEcNVyAAQQRGDQEgAEEBaiEAIAQgAUEBaiIBRw0ACyACIAU2AgAMlQILIAJBADYCACAGQQFqIQFBGQxYC0GZASEDIAEgBEYNkwIgAigCACIAIAQgAWtqIQUgASAAa0EFaiEGAkADQCABLQAAIABBrs8Aai0AAEcNViAAQQVGDQEgAEEBaiEAIAQgAUEBaiIBRw0ACyACIAU2AgAMlAILIAJBADYCACAGQQFqIQFBBgxXC0GaASEDIAEgBEYNkgIgAigCACIAIAQgAWtqIQUgASAAa0EBaiEGAkADQCABLQAAIABBtM8Aai0AAEcNVSAAQQFGDQEgAEEBaiEAIAQgAUEBaiIBRw0ACyACIAU2AgAMkwILIAJBADYCACAGQQFqIQFBHAxWC0GbASEDIAEgBEYNkQIgAigCACIAIAQgAWtqIQUgASAAa0EBaiEGAkADQCABLQAAIABBts8Aai0AAEcNVCAAQQFGDQEgAEEBaiEAIAQgAUEBaiIBRw0ACyACIAU2AgAMkgILIAJBADYCACAGQQFqIQFBJwxVCyABIARGBEBBnAEhAwyRAgsCQAJAIAEtAABB1ABrDgIAAVQLIAFBAWohAUGGASEDDPgBCyABQQFqIQFBhwEhAwz3AQtBnQEhAyABIARGDY8CIAIoAgAiACAEIAFraiEFIAEgAGtBAWohBgJAA0AgAS0AACAAQbjPAGotAABHDVIgAEEBRg0BIABBAWohACAEIAFBAWoiAUcNAAsgAiAFNgIADJACCyACQQA2AgAgBkEBaiEBQSYMUwtBngEhAyABIARGDY4CIAIoAgAiACAEIAFraiEFIAEgAGtBAWohBgJAA0AgAS0AACAAQbrPAGotAABHDVEgAEEBRg0BIABBAWohACAEIAFBAWoiAUcNAAsgAiAFNgIADI8CCyACQQA2AgAgBkEBaiEBQQMMUgtBnwEhAyABIARGDY0CIAIoAgAiACAEIAFraiEFIAEgAGtBAmohBgJAA0AgAS0AACAAQe3PAGotAABHDVAgAEECRg0BIABBAWohACAEIAFBAWoiAUcNAAsgAiAFNgIADI4CCyACQQA2AgAgBkEBaiEBQQwMUQtBoAEhAyABIARGDYwCIAIoAgAiACAEIAFraiEFIAEgAGtBA2ohBgJAA0AgAS0AACAAQbzPAGotAABHDU8gAEEDRg0BIABBAWohACAEIAFBAWoiAUcNAAsgAiAFNgIADI0CCyACQQA2AgAgBkEBaiEBQQ0MUAsgASAERgRAQaEBIQMMjAILAkACQCABLQAAQcYAaw4LAE9PT09PT09PTwFPCyABQQFqIQFBiwEhAwzzAQsgAUEBaiEBQYwBIQMM8gELIAEgBEYEQEGiASEDDIsCCyABLQAAQdAARw1MIAFBAWohAQxGCyABIARGBEBBowEhAwyKAgsCQAJAIAEtAABByQBrDgcBTU1NTU0ATQsgAUEBaiEBQY4BIQMM8QELIAFBAWohAUEiDE0LQaQBIQMgASAERg2IAiACKAIAIgAgBCABa2ohBSABIABrQQFqIQYCQANAIAEtAAAgAEHAzwBqLQAARw1LIABBAUYNASAAQQFqIQAgBCABQQFqIgFHDQALIAIgBTYCAAyJAgsgAkEANgIAIAZBAWohAUEdDEwLIAEgBEYEQEGlASEDDIgCCwJAAkAgAS0AAEHSAGsOAwBLAUsLIAFBAWohAUGQASEDDO8BCyABQQFqIQFBBAxLCyABIARGBEBBpgEhAwyHAgsCQAJAAkACQAJAIAEtAABBwQBrDhUATU1NTU1NTU1NTQFNTQJNTQNNTQRNCyABQQFqIQFBiAEhAwzxAQsgAUEBaiEBQYkBIQMM8AELIAFBAWohAUGKASEDDO8BCyABQQFqIQFBjwEhAwzuAQsgAUEBaiEBQZEBIQMM7QELQacBIQMgASAERg2FAiACKAIAIgAgBCABa2ohBSABIABrQQJqIQYCQANAIAEtAAAgAEHtzwBqLQAARw1IIABBAkYNASAAQQFqIQAgBCABQQFqIgFHDQALIAIgBTYCAAyGAgsgAkEANgIAIAZBAWohAUERDEkLQagBIQMgASAERg2EAiACKAIAIgAgBCABa2ohBSABIABrQQJqIQYCQANAIAEtAAAgAEHCzwBqLQAARw1HIABBAkYNASAAQQFqIQAgBCABQQFqIgFHDQALIAIgBTYCAAyFAgsgAkEANgIAIAZBAWohAUEsDEgLQakBIQMgASAERg2DAiACKAIAIgAgBCABa2ohBSABIABrQQRqIQYCQANAIAEtAAAgAEHFzwBqLQAARw1GIABBBEYNASAAQQFqIQAgBCABQQFqIgFHDQALIAIgBTYCAAyEAgsgAkEANgIAIAZBAWohAUErDEcLQaoBIQMgASAERg2CAiACKAIAIgAgBCABa2ohBSABIABrQQJqIQYCQANAIAEtAAAgAEHKzwBqLQAARw1FIABBAkYNASAAQQFqIQAgBCABQQFqIgFHDQALIAIgBTYCAAyDAgsgAkEANgIAIAZBAWohAUEUDEYLIAEgBEYEQEGrASEDDIICCwJAAkACQAJAIAEtAABBwgBrDg8AAQJHR0dHR0dHR0dHRwNHCyABQQFqIQFBkwEhAwzrAQsgAUEBaiEBQZQBIQMM6gELIAFBAWohAUGVASEDDOkBCyABQQFqIQFBlgEhAwzoAQsgASAERgRAQawBIQMMgQILIAEtAABBxQBHDUIgAUEBaiEBDD0LQa0BIQMgASAERg3/ASACKAIAIgAgBCABa2ohBSABIABrQQJqIQYCQANAIAEtAAAgAEHNzwBqLQAARw1CIABBAkYNASAAQQFqIQAgBCABQQFqIgFHDQALIAIgBTYCAAyAAgsgAkEANgIAIAZBAWohAUEODEMLIAEgBEYEQEGuASEDDP8BCyABLQAAQdAARw1AIAFBAWohAUElDEILQa8BIQMgASAERg39ASACKAIAIgAgBCABa2ohBSABIABrQQhqIQYCQANAIAEtAAAgAEHQzwBqLQAARw1AIABBCEYNASAAQQFqIQAgBCABQQFqIgFHDQALIAIgBTYCAAz+AQsgAkEANgIAIAZBAWohAUEqDEELIAEgBEYEQEGwASEDDP0BCwJAAkAgAS0AAEHVAGsOCwBAQEBAQEBAQEABQAsgAUEBaiEBQZoBIQMM5AELIAFBAWohAUGbASEDDOMBCyABIARGBEBBsQEhAwz8AQsCQAJAIAEtAABBwQBrDhQAPz8/Pz8/Pz8/Pz8/Pz8/Pz8/AT8LIAFBAWohAUGZASEDDOMBCyABQQFqIQFBnAEhAwziAQtBsgEhAyABIARGDfoBIAIoAgAiACAEIAFraiEFIAEgAGtBA2ohBgJAA0AgAS0AACAAQdnPAGotAABHDT0gAEEDRg0BIABBAWohACAEIAFBAWoiAUcNAAsgAiAFNgIADPsBCyACQQA2AgAgBkEBaiEBQSEMPgtBswEhAyABIARGDfkBIAIoAgAiACAEIAFraiEFIAEgAGtBBmohBgJAA0AgAS0AACAAQd3PAGotAABHDTwgAEEGRg0BIABBAWohACAEIAFBAWoiAUcNAAsgAiAFNgIADPoBCyACQQA2AgAgBkEBaiEBQRoMPQsgASAERgRAQbQBIQMM+QELAkACQAJAIAEtAABBxQBrDhEAPT09PT09PT09AT09PT09Aj0LIAFBAWohAUGdASEDDOEBCyABQQFqIQFBngEhAwzgAQsgAUEBaiEBQZ8BIQMM3wELQbUBIQMgASAERg33ASACKAIAIgAgBCABa2ohBSABIABrQQVqIQYCQANAIAEtAAAgAEHkzwBqLQAARw06IABBBUYNASAAQQFqIQAgBCABQQFqIgFHDQALIAIgBTYCAAz4AQsgAkEANgIAIAZBAWohAUEoDDsLQbYBIQMgASAERg32ASACKAIAIgAgBCABa2ohBSABIABrQQJqIQYCQANAIAEtAAAgAEHqzwBqLQAARw05IABBAkYNASAAQQFqIQAgBCABQQFqIgFHDQALIAIgBTYCAAz3AQsgAkEANgIAIAZBAWohAUEHDDoLIAEgBEYEQEG3ASEDDPYBCwJAAkAgAS0AAEHFAGsODgA5OTk5OTk5OTk5OTkBOQsgAUEBaiEBQaEBIQMM3QELIAFBAWohAUGiASEDDNwBC0G4ASEDIAEgBEYN9AEgAigCACIAIAQgAWtqIQUgASAAa0ECaiEGAkADQCABLQAAIABB7c8Aai0AAEcNNyAAQQJGDQEgAEEBaiEAIAQgAUEBaiIBRw0ACyACIAU2AgAM9QELIAJBADYCACAGQQFqIQFBEgw4C0G5ASEDIAEgBEYN8wEgAigCACIAIAQgAWtqIQUgASAAa0EBaiEGAkADQCABLQAAIABB8M8Aai0AAEcNNiAAQQFGDQEgAEEBaiEAIAQgAUEBaiIBRw0ACyACIAU2AgAM9AELIAJBADYCACAGQQFqIQFBIAw3C0G6ASEDIAEgBEYN8gEgAigCACIAIAQgAWtqIQUgASAAa0EBaiEGAkADQCABLQAAIABB8s8Aai0AAEcNNSAAQQFGDQEgAEEBaiEAIAQgAUEBaiIBRw0ACyACIAU2AgAM8wELIAJBADYCACAGQQFqIQFBDww2CyABIARGBEBBuwEhAwzyAQsCQAJAIAEtAABByQBrDgcANTU1NTUBNQsgAUEBaiEBQaUBIQMM2QELIAFBAWohAUGmASEDDNgBC0G8ASEDIAEgBEYN8AEgAigCACIAIAQgAWtqIQUgASAAa0EHaiEGAkADQCABLQAAIABB9M8Aai0AAEcNMyAAQQdGDQEgAEEBaiEAIAQgAUEBaiIBRw0ACyACIAU2AgAM8QELIAJBADYCACAGQQFqIQFBGww0CyABIARGBEBBvQEhAwzwAQsCQAJAAkAgAS0AAEHCAGsOEgA0NDQ0NDQ0NDQBNDQ0NDQ0AjQLIAFBAWohAUGkASEDDNgBCyABQQFqIQFBpwEhAwzXAQsgAUEBaiEBQagBIQMM1gELIAEgBEYEQEG+ASEDDO8BCyABLQAAQc4ARw0wIAFBAWohAQwsCyABIARGBEBBvwEhAwzuAQsCQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQCABLQAAQcEAaw4VAAECAz8EBQY/Pz8HCAkKCz8MDQ4PPwsgAUEBaiEBQegAIQMM4wELIAFBAWohAUHpACEDDOIBCyABQQFqIQFB7gAhAwzhAQsgAUEBaiEBQfIAIQMM4AELIAFBAWohAUHzACEDDN8BCyABQQFqIQFB9gAhAwzeAQsgAUEBaiEBQfcAIQMM3QELIAFBAWohAUH6ACEDDNwBCyABQQFqIQFBgwEhAwzbAQsgAUEBaiEBQYQBIQMM2gELIAFBAWohAUGFASEDDNkBCyABQQFqIQFBkgEhAwzYAQsgAUEBaiEBQZgBIQMM1wELIAFBAWohAUGgASEDDNYBCyABQQFqIQFBowEhAwzVAQsgAUEBaiEBQaoBIQMM1AELIAEgBEcEQCACQRA2AgggAiABNgIEQasBIQMM1AELQcABIQMM7AELQQAhAAJAIAIoAjgiA0UNACADKAI0IgNFDQAgAiADEQAAIQALIABFDV4gAEEVRw0HIAJB0QA2AhwgAiABNgIUIAJBsBc2AhAgAkEVNgIMQQAhAwzrAQsgAUEBaiABIARHDQgaQcIBIQMM6gELA0ACQCABLQAAQQprDgQIAAALAAsgBCABQQFqIgFHDQALQcMBIQMM6QELIAEgBEcEQCACQRE2AgggAiABNgIEQQEhAwzQAQtBxAEhAwzoAQsgASAERgRAQcUBIQMM6AELAkACQCABLQAAQQprDgQBKCgAKAsgAUEBagwJCyABQQFqDAULIAEgBEYEQEHGASEDDOcBCwJAAkAgAS0AAEEKaw4XAQsLAQsLCwsLCwsLCwsLCwsLCwsLCwALCyABQQFqIQELQbABIQMMzQELIAEgBEYEQEHIASEDDOYBCyABLQAAQSBHDQkgAkEAOwEyIAFBAWohAUGzASEDDMwBCwNAIAEhAAJAIAEgBEcEQCABLQAAQTBrQf8BcSIDQQpJDQEMJwtBxwEhAwzmAQsCQCACLwEyIgFBmTNLDQAgAiABQQpsIgU7ATIgBUH+/wNxIANB//8Dc0sNACAAQQFqIQEgAiADIAVqIgM7ATIgA0H//wNxQegHSQ0BCwtBACEDIAJBADYCHCACQcEJNgIQIAJBDTYCDCACIABBAWo2AhQM5AELIAJBADYCHCACIAE2AhQgAkHwDDYCECACQRs2AgxBACEDDOMBCyACKAIEIQAgAkEANgIEIAIgACABECYiAA0BIAFBAWoLIQFBrQEhAwzIAQsgAkHBATYCHCACIAA2AgwgAiABQQFqNgIUQQAhAwzgAQsgAigCBCEAIAJBADYCBCACIAAgARAmIgANASABQQFqCyEBQa4BIQMMxQELIAJBwgE2AhwgAiAANgIMIAIgAUEBajYCFEEAIQMM3QELIAJBADYCHCACIAE2AhQgAkGXCzYCECACQQ02AgxBACEDDNwBCyACQQA2AhwgAiABNgIUIAJB4xA2AhAgAkEJNgIMQQAhAwzbAQsgAkECOgAoDKwBC0EAIQMgAkEANgIcIAJBrws2AhAgAkECNgIMIAIgAUEBajYCFAzZAQtBAiEDDL8BC0ENIQMMvgELQSYhAwy9AQtBFSEDDLwBC0EWIQMMuwELQRghAwy6AQtBHCEDDLkBC0EdIQMMuAELQSAhAwy3AQtBISEDDLYBC0EjIQMMtQELQcYAIQMMtAELQS4hAwyzAQtBPSEDDLIBC0HLACEDDLEBC0HOACEDDLABC0HYACEDDK8BC0HZACEDDK4BC0HbACEDDK0BC0HxACEDDKwBC0H0ACEDDKsBC0GNASEDDKoBC0GXASEDDKkBC0GpASEDDKgBC0GvASEDDKcBC0GxASEDDKYBCyACQQA2AgALQQAhAyACQQA2AhwgAiABNgIUIAJB8Rs2AhAgAkEGNgIMDL0BCyACQQA2AgAgBkEBaiEBQSQLOgApIAIoAgQhACACQQA2AgQgAiAAIAEQJyIARQRAQeUAIQMMowELIAJB+QA2AhwgAiABNgIUIAIgADYCDEEAIQMMuwELIABBFUcEQCACQQA2AhwgAiABNgIUIAJBzA42AhAgAkEgNgIMQQAhAwy7AQsgAkH4ADYCHCACIAE2AhQgAkHKGDYCECACQRU2AgxBACEDDLoBCyACQQA2AhwgAiABNgIUIAJBjhs2AhAgAkEGNgIMQQAhAwy5AQsgAkEANgIcIAIgATYCFCACQf4RNgIQIAJBBzYCDEEAIQMMuAELIAJBADYCHCACIAE2AhQgAkGMHDYCECACQQc2AgxBACEDDLcBCyACQQA2AhwgAiABNgIUIAJBww82AhAgAkEHNgIMQQAhAwy2AQsgAkEANgIcIAIgATYCFCACQcMPNgIQIAJBBzYCDEEAIQMMtQELIAIoAgQhACACQQA2AgQgAiAAIAEQJSIARQ0RIAJB5QA2AhwgAiABNgIUIAIgADYCDEEAIQMMtAELIAIoAgQhACACQQA2AgQgAiAAIAEQJSIARQ0gIAJB0wA2AhwgAiABNgIUIAIgADYCDEEAIQMMswELIAIoAgQhACACQQA2AgQgAiAAIAEQJSIARQ0iIAJB0gA2AhwgAiABNgIUIAIgADYCDEEAIQMMsgELIAIoAgQhACACQQA2AgQgAiAAIAEQJSIARQ0OIAJB5QA2AhwgAiABNgIUIAIgADYCDEEAIQMMsQELIAIoAgQhACACQQA2AgQgAiAAIAEQJSIARQ0dIAJB0wA2AhwgAiABNgIUIAIgADYCDEEAIQMMsAELIAIoAgQhACACQQA2AgQgAiAAIAEQJSIARQ0fIAJB0gA2AhwgAiABNgIUIAIgADYCDEEAIQMMrwELIABBP0cNASABQQFqCyEBQQUhAwyUAQtBACEDIAJBADYCHCACIAE2AhQgAkH9EjYCECACQQc2AgwMrAELIAJBADYCHCACIAE2AhQgAkHcCDYCECACQQc2AgxBACEDDKsBCyACKAIEIQAgAkEANgIEIAIgACABECUiAEUNByACQeUANgIcIAIgATYCFCACIAA2AgxBACEDDKoBCyACKAIEIQAgAkEANgIEIAIgACABECUiAEUNFiACQdMANgIcIAIgATYCFCACIAA2AgxBACEDDKkBCyACKAIEIQAgAkEANgIEIAIgACABECUiAEUNGCACQdIANgIcIAIgATYCFCACIAA2AgxBACEDDKgBCyACQQA2AhwgAiABNgIUIAJBxgo2AhAgAkEHNgIMQQAhAwynAQsgAigCBCEAIAJBADYCBCACIAAgARAlIgBFDQMgAkHlADYCHCACIAE2AhQgAiAANgIMQQAhAwymAQsgAigCBCEAIAJBADYCBCACIAAgARAlIgBFDRIgAkHTADYCHCACIAE2AhQgAiAANgIMQQAhAwylAQsgAigCBCEAIAJBADYCBCACIAAgARAlIgBFDRQgAkHSADYCHCACIAE2AhQgAiAANgIMQQAhAwykAQsgAigCBCEAIAJBADYCBCACIAAgARAlIgBFDQAgAkHlADYCHCACIAE2AhQgAiAANgIMQQAhAwyjAQtB1QAhAwyJAQsgAEEVRwRAIAJBADYCHCACIAE2AhQgAkG5DTYCECACQRo2AgxBACEDDKIBCyACQeQANgIcIAIgATYCFCACQeMXNgIQIAJBFTYCDEEAIQMMoQELIAJBADYCACAGQQFqIQEgAi0AKSIAQSNrQQtJDQQCQCAAQQZLDQBBASAAdEHKAHFFDQAMBQtBACEDIAJBADYCHCACIAE2AhQgAkH3CTYCECACQQg2AgwMoAELIAJBADYCACAGQQFqIQEgAi0AKUEhRg0DIAJBADYCHCACIAE2AhQgAkGbCjYCECACQQg2AgxBACEDDJ8BCyACQQA2AgALQQAhAyACQQA2AhwgAiABNgIUIAJBkDM2AhAgAkEINgIMDJ0BCyACQQA2AgAgBkEBaiEBIAItAClBI0kNACACQQA2AhwgAiABNgIUIAJB0wk2AhAgAkEINgIMQQAhAwycAQtB0QAhAwyCAQsgAS0AAEEwayIAQf8BcUEKSQRAIAIgADoAKiABQQFqIQFBzwAhAwyCAQsgAigCBCEAIAJBADYCBCACIAAgARAoIgBFDYYBIAJB3gA2AhwgAiABNgIUIAIgADYCDEEAIQMMmgELIAIoAgQhACACQQA2AgQgAiAAIAEQKCIARQ2GASACQdwANgIcIAIgATYCFCACIAA2AgxBACEDDJkBCyACKAIEIQAgAkEANgIEIAIgACAFECgiAEUEQCAFIQEMhwELIAJB2gA2AhwgAiAFNgIUIAIgADYCDAyYAQtBACEBQQEhAwsgAiADOgArIAVBAWohAwJAAkACQCACLQAtQRBxDQACQAJAAkAgAi0AKg4DAQACBAsgBkUNAwwCCyAADQEMAgsgAUUNAQsgAigCBCEAIAJBADYCBCACIAAgAxAoIgBFBEAgAyEBDAILIAJB2AA2AhwgAiADNgIUIAIgADYCDEEAIQMMmAELIAIoAgQhACACQQA2AgQgAiAAIAMQKCIARQRAIAMhAQyHAQsgAkHZADYCHCACIAM2AhQgAiAANgIMQQAhAwyXAQtBzAAhAwx9CyAAQRVHBEAgAkEANgIcIAIgATYCFCACQZQNNgIQIAJBITYCDEEAIQMMlgELIAJB1wA2AhwgAiABNgIUIAJByRc2AhAgAkEVNgIMQQAhAwyVAQtBACEDIAJBADYCHCACIAE2AhQgAkGAETYCECACQQk2AgwMlAELIAIoAgQhACACQQA2AgQgAiAAIAEQJSIARQ0AIAJB0wA2AhwgAiABNgIUIAIgADYCDEEAIQMMkwELQckAIQMMeQsgAkEANgIcIAIgATYCFCACQcEoNgIQIAJBBzYCDCACQQA2AgBBACEDDJEBCyACKAIEIQBBACEDIAJBADYCBCACIAAgARAlIgBFDQAgAkHSADYCHCACIAE2AhQgAiAANgIMDJABC0HIACEDDHYLIAJBADYCACAFIQELIAJBgBI7ASogAUEBaiEBQQAhAAJAIAIoAjgiA0UNACADKAIwIgNFDQAgAiADEQAAIQALIAANAQtBxwAhAwxzCyAAQRVGBEAgAkHRADYCHCACIAE2AhQgAkHjFzYCECACQRU2AgxBACEDDIwBC0EAIQMgAkEANgIcIAIgATYCFCACQbkNNgIQIAJBGjYCDAyLAQtBACEDIAJBADYCHCACIAE2AhQgAkGgGTYCECACQR42AgwMigELIAEtAABBOkYEQCACKAIEIQBBACEDIAJBADYCBCACIAAgARApIgBFDQEgAkHDADYCHCACIAA2AgwgAiABQQFqNgIUDIoBC0EAIQMgAkEANgIcIAIgATYCFCACQbERNgIQIAJBCjYCDAyJAQsgAUEBaiEBQTshAwxvCyACQcMANgIcIAIgADYCDCACIAFBAWo2AhQMhwELQQAhAyACQQA2AhwgAiABNgIUIAJB8A42AhAgAkEcNgIMDIYBCyACIAIvATBBEHI7ATAMZgsCQCACLwEwIgBBCHFFDQAgAi0AKEEBRw0AIAItAC1BCHFFDQMLIAIgAEH3+wNxQYAEcjsBMAwECyABIARHBEACQANAIAEtAABBMGsiAEH/AXFBCk8EQEE1IQMMbgsgAikDICIKQpmz5syZs+bMGVYNASACIApCCn4iCjcDICAKIACtQv8BgyILQn+FVg0BIAIgCiALfDcDICAEIAFBAWoiAUcNAAtBOSEDDIUBCyACKAIEIQBBACEDIAJBADYCBCACIAAgAUEBaiIBECoiAA0MDHcLQTkhAwyDAQsgAi0AMEEgcQ0GQcUBIQMMaQtBACEDIAJBADYCBCACIAEgARAqIgBFDQQgAkE6NgIcIAIgADYCDCACIAFBAWo2AhQMgQELIAItAChBAUcNACACLQAtQQhxRQ0BC0E3IQMMZgsgAigCBCEAQQAhAyACQQA2AgQgAiAAIAEQKiIABEAgAkE7NgIcIAIgADYCDCACIAFBAWo2AhQMfwsgAUEBaiEBDG4LIAJBCDoALAwECyABQQFqIQEMbQtBACEDIAJBADYCHCACIAE2AhQgAkHkEjYCECACQQQ2AgwMewsgAigCBCEAQQAhAyACQQA2AgQgAiAAIAEQKiIARQ1sIAJBNzYCHCACIAE2AhQgAiAANgIMDHoLIAIgAi8BMEEgcjsBMAtBMCEDDF8LIAJBNjYCHCACIAE2AhQgAiAANgIMDHcLIABBLEcNASABQQFqIQBBASEBAkACQAJAAkACQCACLQAsQQVrDgQDAQIEAAsgACEBDAQLQQIhAQwBC0EEIQELIAJBAToALCACIAIvATAgAXI7ATAgACEBDAELIAIgAi8BMEEIcjsBMCAAIQELQTkhAwxcCyACQQA6ACwLQTQhAwxaCyABIARGBEBBLSEDDHMLAkACQANAAkAgAS0AAEEKaw4EAgAAAwALIAQgAUEBaiIBRw0AC0EtIQMMdAsgAigCBCEAQQAhAyACQQA2AgQgAiAAIAEQKiIARQ0CIAJBLDYCHCACIAE2AhQgAiAANgIMDHMLIAIoAgQhAEEAIQMgAkEANgIEIAIgACABECoiAEUEQCABQQFqIQEMAgsgAkEsNgIcIAIgADYCDCACIAFBAWo2AhQMcgsgAS0AAEENRgRAIAIoAgQhAEEAIQMgAkEANgIEIAIgACABECoiAEUEQCABQQFqIQEMAgsgAkEsNgIcIAIgADYCDCACIAFBAWo2AhQMcgsgAi0ALUEBcQRAQcQBIQMMWQsgAigCBCEAQQAhAyACQQA2AgQgAiAAIAEQKiIADQEMZQtBLyEDDFcLIAJBLjYCHCACIAE2AhQgAiAANgIMDG8LQQAhAyACQQA2AhwgAiABNgIUIAJB8BQ2AhAgAkEDNgIMDG4LQQEhAwJAAkACQAJAIAItACxBBWsOBAMBAgAECyACIAIvATBBCHI7ATAMAwtBAiEDDAELQQQhAwsgAkEBOgAsIAIgAi8BMCADcjsBMAtBKiEDDFMLQQAhAyACQQA2AhwgAiABNgIUIAJB4Q82AhAgAkEKNgIMDGsLQQEhAwJAAkACQAJAAkACQCACLQAsQQJrDgcFBAQDAQIABAsgAiACLwEwQQhyOwEwDAMLQQIhAwwBC0EEIQMLIAJBAToALCACIAIvATAgA3I7ATALQSshAwxSC0EAIQMgAkEANgIcIAIgATYCFCACQasSNgIQIAJBCzYCDAxqC0EAIQMgAkEANgIcIAIgATYCFCACQf0NNgIQIAJBHTYCDAxpCyABIARHBEADQCABLQAAQSBHDUggBCABQQFqIgFHDQALQSUhAwxpC0ElIQMMaAsgAi0ALUEBcQRAQcMBIQMMTwsgAigCBCEAQQAhAyACQQA2AgQgAiAAIAEQKSIABEAgAkEmNgIcIAIgADYCDCACIAFBAWo2AhQMaAsgAUEBaiEBDFwLIAFBAWohASACLwEwIgBBgAFxBEBBACEAAkAgAigCOCIDRQ0AIAMoAlQiA0UNACACIAMRAAAhAAsgAEUNBiAAQRVHDR8gAkEFNgIcIAIgATYCFCACQfkXNgIQIAJBFTYCDEEAIQMMZwsCQCAAQaAEcUGgBEcNACACLQAtQQJxDQBBACEDIAJBADYCHCACIAE2AhQgAkGWEzYCECACQQQ2AgwMZwsgAgJ/IAIvATBBFHFBFEYEQEEBIAItAChBAUYNARogAi8BMkHlAEYMAQsgAi0AKUEFRgs6AC5BACEAAkAgAigCOCIDRQ0AIAMoAiQiA0UNACACIAMRAAAhAAsCQAJAAkACQAJAIAAOFgIBAAQEBAQEBAQEBAQEBAQEBAQEBAMECyACQQE6AC4LIAIgAi8BMEHAAHI7ATALQSchAwxPCyACQSM2AhwgAiABNgIUIAJBpRY2AhAgAkEVNgIMQQAhAwxnC0EAIQMgAkEANgIcIAIgATYCFCACQdULNgIQIAJBETYCDAxmC0EAIQACQCACKAI4IgNFDQAgAygCLCIDRQ0AIAIgAxEAACEACyAADQELQQ4hAwxLCyAAQRVGBEAgAkECNgIcIAIgATYCFCACQbAYNgIQIAJBFTYCDEEAIQMMZAtBACEDIAJBADYCHCACIAE2AhQgAkGnDjYCECACQRI2AgwMYwtBACEDIAJBADYCHCACIAE2AhQgAkGqHDYCECACQQ82AgwMYgsgAigCBCEAQQAhAyACQQA2AgQgAiAAIAEgCqdqIgEQKyIARQ0AIAJBBTYCHCACIAE2AhQgAiAANgIMDGELQQ8hAwxHC0EAIQMgAkEANgIcIAIgATYCFCACQc0TNgIQIAJBDDYCDAxfC0IBIQoLIAFBAWohAQJAIAIpAyAiC0L//////////w9YBEAgAiALQgSGIAqENwMgDAELQQAhAyACQQA2AhwgAiABNgIUIAJBrQk2AhAgAkEMNgIMDF4LQSQhAwxEC0EAIQMgAkEANgIcIAIgATYCFCACQc0TNgIQIAJBDDYCDAxcCyACKAIEIQBBACEDIAJBADYCBCACIAAgARAsIgBFBEAgAUEBaiEBDFILIAJBFzYCHCACIAA2AgwgAiABQQFqNgIUDFsLIAIoAgQhAEEAIQMgAkEANgIEAkAgAiAAIAEQLCIARQRAIAFBAWohAQwBCyACQRY2AhwgAiAANgIMIAIgAUEBajYCFAxbC0EfIQMMQQtBACEDIAJBADYCHCACIAE2AhQgAkGaDzYCECACQSI2AgwMWQsgAigCBCEAQQAhAyACQQA2AgQgAiAAIAEQLSIARQRAIAFBAWohAQxQCyACQRQ2AhwgAiAANgIMIAIgAUEBajYCFAxYCyACKAIEIQBBACEDIAJBADYCBAJAIAIgACABEC0iAEUEQCABQQFqIQEMAQsgAkETNgIcIAIgADYCDCACIAFBAWo2AhQMWAtBHiEDDD4LQQAhAyACQQA2AhwgAiABNgIUIAJBxgw2AhAgAkEjNgIMDFYLIAIoAgQhAEEAIQMgAkEANgIEIAIgACABEC0iAEUEQCABQQFqIQEMTgsgAkERNgIcIAIgADYCDCACIAFBAWo2AhQMVQsgAkEQNgIcIAIgATYCFCACIAA2AgwMVAtBACEDIAJBADYCHCACIAE2AhQgAkHGDDYCECACQSM2AgwMUwtBACEDIAJBADYCHCACIAE2AhQgAkHAFTYCECACQQI2AgwMUgsgAigCBCEAQQAhAyACQQA2AgQCQCACIAAgARAtIgBFBEAgAUEBaiEBDAELIAJBDjYCHCACIAA2AgwgAiABQQFqNgIUDFILQRshAww4C0EAIQMgAkEANgIcIAIgATYCFCACQcYMNgIQIAJBIzYCDAxQCyACKAIEIQBBACEDIAJBADYCBAJAIAIgACABECwiAEUEQCABQQFqIQEMAQsgAkENNgIcIAIgADYCDCACIAFBAWo2AhQMUAtBGiEDDDYLQQAhAyACQQA2AhwgAiABNgIUIAJBmg82AhAgAkEiNgIMDE4LIAIoAgQhAEEAIQMgAkEANgIEAkAgAiAAIAEQLCIARQRAIAFBAWohAQwBCyACQQw2AhwgAiAANgIMIAIgAUEBajYCFAxOC0EZIQMMNAtBACEDIAJBADYCHCACIAE2AhQgAkGaDzYCECACQSI2AgwMTAsgAEEVRwRAQQAhAyACQQA2AhwgAiABNgIUIAJBgww2AhAgAkETNgIMDEwLIAJBCjYCHCACIAE2AhQgAkHkFjYCECACQRU2AgxBACEDDEsLIAIoAgQhAEEAIQMgAkEANgIEIAIgACABIAqnaiIBECsiAARAIAJBBzYCHCACIAE2AhQgAiAANgIMDEsLQRMhAwwxCyAAQRVHBEBBACEDIAJBADYCHCACIAE2AhQgAkHaDTYCECACQRQ2AgwMSgsgAkEeNgIcIAIgATYCFCACQfkXNgIQIAJBFTYCDEEAIQMMSQtBACEAAkAgAigCOCIDRQ0AIAMoAiwiA0UNACACIAMRAAAhAAsgAEUNQSAAQRVGBEAgAkEDNgIcIAIgATYCFCACQbAYNgIQIAJBFTYCDEEAIQMMSQtBACEDIAJBADYCHCACIAE2AhQgAkGnDjYCECACQRI2AgwMSAtBACEDIAJBADYCHCACIAE2AhQgAkHaDTYCECACQRQ2AgwMRwtBACEDIAJBADYCHCACIAE2AhQgAkGnDjYCECACQRI2AgwMRgsgAkEAOgAvIAItAC1BBHFFDT8LIAJBADoALyACQQE6ADRBACEDDCsLQQAhAyACQQA2AhwgAkHkETYCECACQQc2AgwgAiABQQFqNgIUDEMLAkADQAJAIAEtAABBCmsOBAACAgACCyAEIAFBAWoiAUcNAAtB3QEhAwxDCwJAAkAgAi0ANEEBRw0AQQAhAAJAIAIoAjgiA0UNACADKAJYIgNFDQAgAiADEQAAIQALIABFDQAgAEEVRw0BIAJB3AE2AhwgAiABNgIUIAJB1RY2AhAgAkEVNgIMQQAhAwxEC0HBASEDDCoLIAJBADYCHCACIAE2AhQgAkHpCzYCECACQR82AgxBACEDDEILAkACQCACLQAoQQFrDgIEAQALQcABIQMMKQtBuQEhAwwoCyACQQI6AC9BACEAAkAgAigCOCIDRQ0AIAMoAgAiA0UNACACIAMRAAAhAAsgAEUEQEHCASEDDCgLIABBFUcEQCACQQA2AhwgAiABNgIUIAJBpAw2AhAgAkEQNgIMQQAhAwxBCyACQdsBNgIcIAIgATYCFCACQfoWNgIQIAJBFTYCDEEAIQMMQAsgASAERgRAQdoBIQMMQAsgAS0AAEHIAEYNASACQQE6ACgLQawBIQMMJQtBvwEhAwwkCyABIARHBEAgAkEQNgIIIAIgATYCBEG+ASEDDCQLQdkBIQMMPAsgASAERgRAQdgBIQMMPAsgAS0AAEHIAEcNBCABQQFqIQFBvQEhAwwiCyABIARGBEBB1wEhAww7CwJAAkAgAS0AAEHFAGsOEAAFBQUFBQUFBQUFBQUFBQEFCyABQQFqIQFBuwEhAwwiCyABQQFqIQFBvAEhAwwhC0HWASEDIAEgBEYNOSACKAIAIgAgBCABa2ohBSABIABrQQJqIQYCQANAIAEtAAAgAEGD0ABqLQAARw0DIABBAkYNASAAQQFqIQAgBCABQQFqIgFHDQALIAIgBTYCAAw6CyACKAIEIQAgAkIANwMAIAIgACAGQQFqIgEQJyIARQRAQcYBIQMMIQsgAkHVATYCHCACIAE2AhQgAiAANgIMQQAhAww5C0HUASEDIAEgBEYNOCACKAIAIgAgBCABa2ohBSABIABrQQFqIQYCQANAIAEtAAAgAEGB0ABqLQAARw0CIABBAUYNASAAQQFqIQAgBCABQQFqIgFHDQALIAIgBTYCAAw5CyACQYEEOwEoIAIoAgQhACACQgA3AwAgAiAAIAZBAWoiARAnIgANAwwCCyACQQA2AgALQQAhAyACQQA2AhwgAiABNgIUIAJB2Bs2AhAgAkEINgIMDDYLQboBIQMMHAsgAkHTATYCHCACIAE2AhQgAiAANgIMQQAhAww0C0EAIQACQCACKAI4IgNFDQAgAygCOCIDRQ0AIAIgAxEAACEACyAARQ0AIABBFUYNASACQQA2AhwgAiABNgIUIAJBzA42AhAgAkEgNgIMQQAhAwwzC0HkACEDDBkLIAJB+AA2AhwgAiABNgIUIAJByhg2AhAgAkEVNgIMQQAhAwwxC0HSASEDIAQgASIARg0wIAQgAWsgAigCACIBaiEFIAAgAWtBBGohBgJAA0AgAC0AACABQfzPAGotAABHDQEgAUEERg0DIAFBAWohASAEIABBAWoiAEcNAAsgAiAFNgIADDELIAJBADYCHCACIAA2AhQgAkGQMzYCECACQQg2AgwgAkEANgIAQQAhAwwwCyABIARHBEAgAkEONgIIIAIgATYCBEG3ASEDDBcLQdEBIQMMLwsgAkEANgIAIAZBAWohAQtBuAEhAwwUCyABIARGBEBB0AEhAwwtCyABLQAAQTBrIgBB/wFxQQpJBEAgAiAAOgAqIAFBAWohAUG2ASEDDBQLIAIoAgQhACACQQA2AgQgAiAAIAEQKCIARQ0UIAJBzwE2AhwgAiABNgIUIAIgADYCDEEAIQMMLAsgASAERgRAQc4BIQMMLAsCQCABLQAAQS5GBEAgAUEBaiEBDAELIAIoAgQhACACQQA2AgQgAiAAIAEQKCIARQ0VIAJBzQE2AhwgAiABNgIUIAIgADYCDEEAIQMMLAtBtQEhAwwSCyAEIAEiBUYEQEHMASEDDCsLQQAhAEEBIQFBASEGQQAhAwJAAkACQAJAAkACfwJAAkACQAJAAkACQAJAIAUtAABBMGsOCgoJAAECAwQFBggLC0ECDAYLQQMMBQtBBAwEC0EFDAMLQQYMAgtBBwwBC0EICyEDQQAhAUEAIQYMAgtBCSEDQQEhAEEAIQFBACEGDAELQQAhAUEBIQMLIAIgAzoAKyAFQQFqIQMCQAJAIAItAC1BEHENAAJAAkACQCACLQAqDgMBAAIECyAGRQ0DDAILIAANAQwCCyABRQ0BCyACKAIEIQAgAkEANgIEIAIgACADECgiAEUEQCADIQEMAwsgAkHJATYCHCACIAM2AhQgAiAANgIMQQAhAwwtCyACKAIEIQAgAkEANgIEIAIgACADECgiAEUEQCADIQEMGAsgAkHKATYCHCACIAM2AhQgAiAANgIMQQAhAwwsCyACKAIEIQAgAkEANgIEIAIgACAFECgiAEUEQCAFIQEMFgsgAkHLATYCHCACIAU2AhQgAiAANgIMDCsLQbQBIQMMEQtBACEAAkAgAigCOCIDRQ0AIAMoAjwiA0UNACACIAMRAAAhAAsCQCAABEAgAEEVRg0BIAJBADYCHCACIAE2AhQgAkGUDTYCECACQSE2AgxBACEDDCsLQbIBIQMMEQsgAkHIATYCHCACIAE2AhQgAkHJFzYCECACQRU2AgxBACEDDCkLIAJBADYCACAGQQFqIQFB9QAhAwwPCyACLQApQQVGBEBB4wAhAwwPC0HiACEDDA4LIAAhASACQQA2AgALIAJBADoALEEJIQMMDAsgAkEANgIAIAdBAWohAUHAACEDDAsLQQELOgAsIAJBADYCACAGQQFqIQELQSkhAwwIC0E4IQMMBwsCQCABIARHBEADQCABLQAAQYA+ai0AACIAQQFHBEAgAEECRw0DIAFBAWohAQwFCyAEIAFBAWoiAUcNAAtBPiEDDCELQT4hAwwgCwsgAkEAOgAsDAELQQshAwwEC0E6IQMMAwsgAUEBaiEBQS0hAwwCCyACIAE6ACwgAkEANgIAIAZBAWohAUEMIQMMAQsgAkEANgIAIAZBAWohAUEKIQMMAAsAC0EAIQMgAkEANgIcIAIgATYCFCACQc0QNgIQIAJBCTYCDAwXC0EAIQMgAkEANgIcIAIgATYCFCACQekKNgIQIAJBCTYCDAwWC0EAIQMgAkEANgIcIAIgATYCFCACQbcQNgIQIAJBCTYCDAwVC0EAIQMgAkEANgIcIAIgATYCFCACQZwRNgIQIAJBCTYCDAwUC0EAIQMgAkEANgIcIAIgATYCFCACQc0QNgIQIAJBCTYCDAwTC0EAIQMgAkEANgIcIAIgATYCFCACQekKNgIQIAJBCTYCDAwSC0EAIQMgAkEANgIcIAIgATYCFCACQbcQNgIQIAJBCTYCDAwRC0EAIQMgAkEANgIcIAIgATYCFCACQZwRNgIQIAJBCTYCDAwQC0EAIQMgAkEANgIcIAIgATYCFCACQZcVNgIQIAJBDzYCDAwPC0EAIQMgAkEANgIcIAIgATYCFCACQZcVNgIQIAJBDzYCDAwOC0EAIQMgAkEANgIcIAIgATYCFCACQcASNgIQIAJBCzYCDAwNC0EAIQMgAkEANgIcIAIgATYCFCACQZUJNgIQIAJBCzYCDAwMC0EAIQMgAkEANgIcIAIgATYCFCACQeEPNgIQIAJBCjYCDAwLC0EAIQMgAkEANgIcIAIgATYCFCACQfsPNgIQIAJBCjYCDAwKC0EAIQMgAkEANgIcIAIgATYCFCACQfEZNgIQIAJBAjYCDAwJC0EAIQMgAkEANgIcIAIgATYCFCACQcQUNgIQIAJBAjYCDAwIC0EAIQMgAkEANgIcIAIgATYCFCACQfIVNgIQIAJBAjYCDAwHCyACQQI2AhwgAiABNgIUIAJBnBo2AhAgAkEWNgIMQQAhAwwGC0EBIQMMBQtB1AAhAyABIARGDQQgCEEIaiEJIAIoAgAhBQJAAkAgASAERwRAIAVB2MIAaiEHIAQgBWogAWshACAFQX9zQQpqIgUgAWohBgNAIAEtAAAgBy0AAEcEQEECIQcMAwsgBUUEQEEAIQcgBiEBDAMLIAVBAWshBSAHQQFqIQcgBCABQQFqIgFHDQALIAAhBSAEIQELIAlBATYCACACIAU2AgAMAQsgAkEANgIAIAkgBzYCAAsgCSABNgIEIAgoAgwhACAIKAIIDgMBBAIACwALIAJBADYCHCACQbUaNgIQIAJBFzYCDCACIABBAWo2AhRBACEDDAILIAJBADYCHCACIAA2AhQgAkHKGjYCECACQQk2AgxBACEDDAELIAEgBEYEQEEiIQMMAQsgAkEJNgIIIAIgATYCBEEhIQMLIAhBEGokACADRQRAIAIoAgwhAAwBCyACIAM2AhxBACEAIAIoAgQiAUUNACACIAEgBCACKAIIEQEAIgFFDQAgAiAENgIUIAIgATYCDCABIQALIAALvgIBAn8gAEEAOgAAIABB3ABqIgFBAWtBADoAACAAQQA6AAIgAEEAOgABIAFBA2tBADoAACABQQJrQQA6AAAgAEEAOgADIAFBBGtBADoAAEEAIABrQQNxIgEgAGoiAEEANgIAQdwAIAFrQXxxIgIgAGoiAUEEa0EANgIAAkAgAkEJSQ0AIABBADYCCCAAQQA2AgQgAUEIa0EANgIAIAFBDGtBADYCACACQRlJDQAgAEEANgIYIABBADYCFCAAQQA2AhAgAEEANgIMIAFBEGtBADYCACABQRRrQQA2AgAgAUEYa0EANgIAIAFBHGtBADYCACACIABBBHFBGHIiAmsiAUEgSQ0AIAAgAmohAANAIABCADcDGCAAQgA3AxAgAEIANwMIIABCADcDACAAQSBqIQAgAUEgayIBQR9LDQALCwtWAQF/AkAgACgCDA0AAkACQAJAAkAgAC0ALw4DAQADAgsgACgCOCIBRQ0AIAEoAiwiAUUNACAAIAERAAAiAQ0DC0EADwsACyAAQcMWNgIQQQ4hAQsgAQsaACAAKAIMRQRAIABB0Rs2AhAgAEEVNgIMCwsUACAAKAIMQRVGBEAgAEEANgIMCwsUACAAKAIMQRZGBEAgAEEANgIMCwsHACAAKAIMCwcAIAAoAhALCQAgACABNgIQCwcAIAAoAhQLFwAgAEEkTwRAAAsgAEECdEGgM2ooAgALFwAgAEEuTwRAAAsgAEECdEGwNGooAgALvwkBAX9B6yghAQJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAIABB5ABrDvQDY2IAAWFhYWFhYQIDBAVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhBgcICQoLDA0OD2FhYWFhEGFhYWFhYWFhYWFhEWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYRITFBUWFxgZGhthYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhHB0eHyAhIiMkJSYnKCkqKywtLi8wMTIzNDU2YTc4OTphYWFhYWFhYTthYWE8YWFhYT0+P2FhYWFhYWFhQGFhQWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYUJDREVGR0hJSktMTU5PUFFSU2FhYWFhYWFhVFVWV1hZWlthXF1hYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFeYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhX2BhC0HhJw8LQaQhDwtByywPC0H+MQ8LQcAkDwtBqyQPC0GNKA8LQeImDwtBgDAPC0G5Lw8LQdckDwtB7x8PC0HhHw8LQfofDwtB8iAPC0GoLw8LQa4yDwtBiDAPC0HsJw8LQYIiDwtBjh0PC0HQLg8LQcojDwtBxTIPC0HfHA8LQdIcDwtBxCAPC0HXIA8LQaIfDwtB7S4PC0GrMA8LQdQlDwtBzC4PC0H6Lg8LQfwrDwtB0jAPC0HxHQ8LQbsgDwtB9ysPC0GQMQ8LQdcxDwtBoi0PC0HUJw8LQeArDwtBnywPC0HrMQ8LQdUfDwtByjEPC0HeJQ8LQdQeDwtB9BwPC0GnMg8LQbEdDwtBoB0PC0G5MQ8LQbwwDwtBkiEPC0GzJg8LQeksDwtBrB4PC0HUKw8LQfcmDwtBgCYPC0GwIQ8LQf4eDwtBjSMPC0GJLQ8LQfciDwtBoDEPC0GuHw8LQcYlDwtB6B4PC0GTIg8LQcIvDwtBwx0PC0GLLA8LQeEdDwtBjS8PC0HqIQ8LQbQtDwtB0i8PC0HfMg8LQdIyDwtB8DAPC0GpIg8LQfkjDwtBmR4PC0G1LA8LQZswDwtBkjIPC0G2Kw8LQcIiDwtB+DIPC0GeJQ8LQdAiDwtBuh4PC0GBHg8LAAtB1iEhAQsgAQsWACAAIAAtAC1B/gFxIAFBAEdyOgAtCxkAIAAgAC0ALUH9AXEgAUEAR0EBdHI6AC0LGQAgACAALQAtQfsBcSABQQBHQQJ0cjoALQsZACAAIAAtAC1B9wFxIAFBAEdBA3RyOgAtCz4BAn8CQCAAKAI4IgNFDQAgAygCBCIDRQ0AIAAgASACIAFrIAMRAQAiBEF/Rw0AIABBxhE2AhBBGCEECyAECz4BAn8CQCAAKAI4IgNFDQAgAygCCCIDRQ0AIAAgASACIAFrIAMRAQAiBEF/Rw0AIABB9go2AhBBGCEECyAECz4BAn8CQCAAKAI4IgNFDQAgAygCDCIDRQ0AIAAgASACIAFrIAMRAQAiBEF/Rw0AIABB7Ro2AhBBGCEECyAECz4BAn8CQCAAKAI4IgNFDQAgAygCECIDRQ0AIAAgASACIAFrIAMRAQAiBEF/Rw0AIABBlRA2AhBBGCEECyAECz4BAn8CQCAAKAI4IgNFDQAgAygCFCIDRQ0AIAAgASACIAFrIAMRAQAiBEF/Rw0AIABBqhs2AhBBGCEECyAECz4BAn8CQCAAKAI4IgNFDQAgAygCGCIDRQ0AIAAgASACIAFrIAMRAQAiBEF/Rw0AIABB7RM2AhBBGCEECyAECz4BAn8CQCAAKAI4IgNFDQAgAygCKCIDRQ0AIAAgASACIAFrIAMRAQAiBEF/Rw0AIABB9gg2AhBBGCEECyAECz4BAn8CQCAAKAI4IgNFDQAgAygCHCIDRQ0AIAAgASACIAFrIAMRAQAiBEF/Rw0AIABBwhk2AhBBGCEECyAECz4BAn8CQCAAKAI4IgNFDQAgAygCICIDRQ0AIAAgASACIAFrIAMRAQAiBEF/Rw0AIABBlBQ2AhBBGCEECyAEC1kBAn8CQCAALQAoQQFGDQAgAC8BMiIBQeQAa0HkAEkNACABQcwBRg0AIAFBsAJGDQAgAC8BMCIAQcAAcQ0AQQEhAiAAQYgEcUGABEYNACAAQShxRSECCyACC4wBAQJ/AkACQAJAIAAtACpFDQAgAC0AK0UNACAALwEwIgFBAnFFDQEMAgsgAC8BMCIBQQFxRQ0BC0EBIQIgAC0AKEEBRg0AIAAvATIiAEHkAGtB5ABJDQAgAEHMAUYNACAAQbACRg0AIAFBwABxDQBBACECIAFBiARxQYAERg0AIAFBKHFBAEchAgsgAgtzACAAQRBq/QwAAAAAAAAAAAAAAAAAAAAA/QsDACAA/QwAAAAAAAAAAAAAAAAAAAAA/QsDACAAQTBq/QwAAAAAAAAAAAAAAAAAAAAA/QsDACAAQSBq/QwAAAAAAAAAAAAAAAAAAAAA/QsDACAAQd0BNgIcCwYAIAAQMguaLQELfyMAQRBrIgokAEGk0AAoAgAiCUUEQEHk0wAoAgAiBUUEQEHw0wBCfzcCAEHo0wBCgICEgICAwAA3AgBB5NMAIApBCGpBcHFB2KrVqgVzIgU2AgBB+NMAQQA2AgBByNMAQQA2AgALQczTAEGA1AQ2AgBBnNAAQYDUBDYCAEGw0AAgBTYCAEGs0ABBfzYCAEHQ0wBBgKwDNgIAA0AgAUHI0ABqIAFBvNAAaiICNgIAIAIgAUG00ABqIgM2AgAgAUHA0ABqIAM2AgAgAUHQ0ABqIAFBxNAAaiIDNgIAIAMgAjYCACABQdjQAGogAUHM0ABqIgI2AgAgAiADNgIAIAFB1NAAaiACNgIAIAFBIGoiAUGAAkcNAAtBjNQEQcGrAzYCAEGo0ABB9NMAKAIANgIAQZjQAEHAqwM2AgBBpNAAQYjUBDYCAEHM/wdBODYCAEGI1AQhCQsCQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQCAAQewBTQRAQYzQACgCACIGQRAgAEETakFwcSAAQQtJGyIEQQN2IgB2IgFBA3EEQAJAIAFBAXEgAHJBAXMiAkEDdCIAQbTQAGoiASAAQbzQAGooAgAiACgCCCIDRgRAQYzQACAGQX4gAndxNgIADAELIAEgAzYCCCADIAE2AgwLIABBCGohASAAIAJBA3QiAkEDcjYCBCAAIAJqIgAgACgCBEEBcjYCBAwRC0GU0AAoAgAiCCAETw0BIAEEQAJAQQIgAHQiAkEAIAJrciABIAB0cWgiAEEDdCICQbTQAGoiASACQbzQAGooAgAiAigCCCIDRgRAQYzQACAGQX4gAHdxIgY2AgAMAQsgASADNgIIIAMgATYCDAsgAiAEQQNyNgIEIABBA3QiACAEayEFIAAgAmogBTYCACACIARqIgQgBUEBcjYCBCAIBEAgCEF4cUG00ABqIQBBoNAAKAIAIQMCf0EBIAhBA3Z0IgEgBnFFBEBBjNAAIAEgBnI2AgAgAAwBCyAAKAIICyIBIAM2AgwgACADNgIIIAMgADYCDCADIAE2AggLIAJBCGohAUGg0AAgBDYCAEGU0AAgBTYCAAwRC0GQ0AAoAgAiC0UNASALaEECdEG80gBqKAIAIgAoAgRBeHEgBGshBSAAIQIDQAJAIAIoAhAiAUUEQCACQRRqKAIAIgFFDQELIAEoAgRBeHEgBGsiAyAFSSECIAMgBSACGyEFIAEgACACGyEAIAEhAgwBCwsgACgCGCEJIAAoAgwiAyAARwRAQZzQACgCABogAyAAKAIIIgE2AgggASADNgIMDBALIABBFGoiAigCACIBRQRAIAAoAhAiAUUNAyAAQRBqIQILA0AgAiEHIAEiA0EUaiICKAIAIgENACADQRBqIQIgAygCECIBDQALIAdBADYCAAwPC0F/IQQgAEG/f0sNACAAQRNqIgFBcHEhBEGQ0AAoAgAiCEUNAEEAIARrIQUCQAJAAkACf0EAIARBgAJJDQAaQR8gBEH///8HSw0AGiAEQSYgAUEIdmciAGt2QQFxIABBAXRrQT5qCyIGQQJ0QbzSAGooAgAiAkUEQEEAIQFBACEDDAELQQAhASAEQRkgBkEBdmtBACAGQR9HG3QhAEEAIQMDQAJAIAIoAgRBeHEgBGsiByAFTw0AIAIhAyAHIgUNAEEAIQUgAiEBDAMLIAEgAkEUaigCACIHIAcgAiAAQR12QQRxakEQaigCACICRhsgASAHGyEBIABBAXQhACACDQALCyABIANyRQRAQQAhA0ECIAZ0IgBBACAAa3IgCHEiAEUNAyAAaEECdEG80gBqKAIAIQELIAFFDQELA0AgASgCBEF4cSAEayICIAVJIQAgAiAFIAAbIQUgASADIAAbIQMgASgCECIABH8gAAUgAUEUaigCAAsiAQ0ACwsgA0UNACAFQZTQACgCACAEa08NACADKAIYIQcgAyADKAIMIgBHBEBBnNAAKAIAGiAAIAMoAggiATYCCCABIAA2AgwMDgsgA0EUaiICKAIAIgFFBEAgAygCECIBRQ0DIANBEGohAgsDQCACIQYgASIAQRRqIgIoAgAiAQ0AIABBEGohAiAAKAIQIgENAAsgBkEANgIADA0LQZTQACgCACIDIARPBEBBoNAAKAIAIQECQCADIARrIgJBEE8EQCABIARqIgAgAkEBcjYCBCABIANqIAI2AgAgASAEQQNyNgIEDAELIAEgA0EDcjYCBCABIANqIgAgACgCBEEBcjYCBEEAIQBBACECC0GU0AAgAjYCAEGg0AAgADYCACABQQhqIQEMDwtBmNAAKAIAIgMgBEsEQCAEIAlqIgAgAyAEayIBQQFyNgIEQaTQACAANgIAQZjQACABNgIAIAkgBEEDcjYCBCAJQQhqIQEMDwtBACEBIAQCf0Hk0wAoAgAEQEHs0wAoAgAMAQtB8NMAQn83AgBB6NMAQoCAhICAgMAANwIAQeTTACAKQQxqQXBxQdiq1aoFczYCAEH40wBBADYCAEHI0wBBADYCAEGAgAQLIgAgBEHHAGoiBWoiBkEAIABrIgdxIgJPBEBB/NMAQTA2AgAMDwsCQEHE0wAoAgAiAUUNAEG80wAoAgAiCCACaiEAIAAgAU0gACAIS3ENAEEAIQFB/NMAQTA2AgAMDwtByNMALQAAQQRxDQQCQAJAIAkEQEHM0wAhAQNAIAEoAgAiACAJTQRAIAAgASgCBGogCUsNAwsgASgCCCIBDQALC0EAEDMiAEF/Rg0FIAIhBkHo0wAoAgAiAUEBayIDIABxBEAgAiAAayAAIANqQQAgAWtxaiEGCyAEIAZPDQUgBkH+////B0sNBUHE0wAoAgAiAwRAQbzTACgCACIHIAZqIQEgASAHTQ0GIAEgA0sNBgsgBhAzIgEgAEcNAQwHCyAGIANrIAdxIgZB/v///wdLDQQgBhAzIQAgACABKAIAIAEoAgRqRg0DIAAhAQsCQCAGIARByABqTw0AIAFBf0YNAEHs0wAoAgAiACAFIAZrakEAIABrcSIAQf7///8HSwRAIAEhAAwHCyAAEDNBf0cEQCAAIAZqIQYgASEADAcLQQAgBmsQMxoMBAsgASIAQX9HDQUMAwtBACEDDAwLQQAhAAwKCyAAQX9HDQILQcjTAEHI0wAoAgBBBHI2AgALIAJB/v///wdLDQEgAhAzIQBBABAzIQEgAEF/Rg0BIAFBf0YNASAAIAFPDQEgASAAayIGIARBOGpNDQELQbzTAEG80wAoAgAgBmoiATYCAEHA0wAoAgAgAUkEQEHA0wAgATYCAAsCQAJAAkBBpNAAKAIAIgIEQEHM0wAhAQNAIAAgASgCACIDIAEoAgQiBWpGDQIgASgCCCIBDQALDAILQZzQACgCACIBQQBHIAAgAU9xRQRAQZzQACAANgIAC0EAIQFB0NMAIAY2AgBBzNMAIAA2AgBBrNAAQX82AgBBsNAAQeTTACgCADYCAEHY0wBBADYCAANAIAFByNAAaiABQbzQAGoiAjYCACACIAFBtNAAaiIDNgIAIAFBwNAAaiADNgIAIAFB0NAAaiABQcTQAGoiAzYCACADIAI2AgAgAUHY0ABqIAFBzNAAaiICNgIAIAIgAzYCACABQdTQAGogAjYCACABQSBqIgFBgAJHDQALQXggAGtBD3EiASAAaiICIAZBOGsiAyABayIBQQFyNgIEQajQAEH00wAoAgA2AgBBmNAAIAE2AgBBpNAAIAI2AgAgACADakE4NgIEDAILIAAgAk0NACACIANJDQAgASgCDEEIcQ0AQXggAmtBD3EiACACaiIDQZjQACgCACAGaiIHIABrIgBBAXI2AgQgASAFIAZqNgIEQajQAEH00wAoAgA2AgBBmNAAIAA2AgBBpNAAIAM2AgAgAiAHakE4NgIEDAELIABBnNAAKAIASQRAQZzQACAANgIACyAAIAZqIQNBzNMAIQECQAJAAkADQCADIAEoAgBHBEAgASgCCCIBDQEMAgsLIAEtAAxBCHFFDQELQczTACEBA0AgASgCACIDIAJNBEAgAyABKAIEaiIFIAJLDQMLIAEoAgghAQwACwALIAEgADYCACABIAEoAgQgBmo2AgQgAEF4IABrQQ9xaiIJIARBA3I2AgQgA0F4IANrQQ9xaiIGIAQgCWoiBGshASACIAZGBEBBpNAAIAQ2AgBBmNAAQZjQACgCACABaiIANgIAIAQgAEEBcjYCBAwIC0Gg0AAoAgAgBkYEQEGg0AAgBDYCAEGU0ABBlNAAKAIAIAFqIgA2AgAgBCAAQQFyNgIEIAAgBGogADYCAAwICyAGKAIEIgVBA3FBAUcNBiAFQXhxIQggBUH/AU0EQCAFQQN2IQMgBigCCCIAIAYoAgwiAkYEQEGM0ABBjNAAKAIAQX4gA3dxNgIADAcLIAIgADYCCCAAIAI2AgwMBgsgBigCGCEHIAYgBigCDCIARwRAIAAgBigCCCICNgIIIAIgADYCDAwFCyAGQRRqIgIoAgAiBUUEQCAGKAIQIgVFDQQgBkEQaiECCwNAIAIhAyAFIgBBFGoiAigCACIFDQAgAEEQaiECIAAoAhAiBQ0ACyADQQA2AgAMBAtBeCAAa0EPcSIBIABqIgcgBkE4ayIDIAFrIgFBAXI2AgQgACADakE4NgIEIAIgBUE3IAVrQQ9xakE/ayIDIAMgAkEQakkbIgNBIzYCBEGo0ABB9NMAKAIANgIAQZjQACABNgIAQaTQACAHNgIAIANBEGpB1NMAKQIANwIAIANBzNMAKQIANwIIQdTTACADQQhqNgIAQdDTACAGNgIAQczTACAANgIAQdjTAEEANgIAIANBJGohAQNAIAFBBzYCACAFIAFBBGoiAUsNAAsgAiADRg0AIAMgAygCBEF+cTYCBCADIAMgAmsiBTYCACACIAVBAXI2AgQgBUH/AU0EQCAFQXhxQbTQAGohAAJ/QYzQACgCACIBQQEgBUEDdnQiA3FFBEBBjNAAIAEgA3I2AgAgAAwBCyAAKAIICyIBIAI2AgwgACACNgIIIAIgADYCDCACIAE2AggMAQtBHyEBIAVB////B00EQCAFQSYgBUEIdmciAGt2QQFxIABBAXRrQT5qIQELIAIgATYCHCACQgA3AhAgAUECdEG80gBqIQBBkNAAKAIAIgNBASABdCIGcUUEQCAAIAI2AgBBkNAAIAMgBnI2AgAgAiAANgIYIAIgAjYCCCACIAI2AgwMAQsgBUEZIAFBAXZrQQAgAUEfRxt0IQEgACgCACEDAkADQCADIgAoAgRBeHEgBUYNASABQR12IQMgAUEBdCEBIAAgA0EEcWpBEGoiBigCACIDDQALIAYgAjYCACACIAA2AhggAiACNgIMIAIgAjYCCAwBCyAAKAIIIgEgAjYCDCAAIAI2AgggAkEANgIYIAIgADYCDCACIAE2AggLQZjQACgCACIBIARNDQBBpNAAKAIAIgAgBGoiAiABIARrIgFBAXI2AgRBmNAAIAE2AgBBpNAAIAI2AgAgACAEQQNyNgIEIABBCGohAQwIC0EAIQFB/NMAQTA2AgAMBwtBACEACyAHRQ0AAkAgBigCHCICQQJ0QbzSAGoiAygCACAGRgRAIAMgADYCACAADQFBkNAAQZDQACgCAEF+IAJ3cTYCAAwCCyAHQRBBFCAHKAIQIAZGG2ogADYCACAARQ0BCyAAIAc2AhggBigCECICBEAgACACNgIQIAIgADYCGAsgBkEUaigCACICRQ0AIABBFGogAjYCACACIAA2AhgLIAEgCGohASAGIAhqIgYoAgQhBQsgBiAFQX5xNgIEIAEgBGogATYCACAEIAFBAXI2AgQgAUH/AU0EQCABQXhxQbTQAGohAAJ/QYzQACgCACICQQEgAUEDdnQiAXFFBEBBjNAAIAEgAnI2AgAgAAwBCyAAKAIICyIBIAQ2AgwgACAENgIIIAQgADYCDCAEIAE2AggMAQtBHyEFIAFB////B00EQCABQSYgAUEIdmciAGt2QQFxIABBAXRrQT5qIQULIAQgBTYCHCAEQgA3AhAgBUECdEG80gBqIQBBkNAAKAIAIgJBASAFdCIDcUUEQCAAIAQ2AgBBkNAAIAIgA3I2AgAgBCAANgIYIAQgBDYCCCAEIAQ2AgwMAQsgAUEZIAVBAXZrQQAgBUEfRxt0IQUgACgCACEAAkADQCAAIgIoAgRBeHEgAUYNASAFQR12IQAgBUEBdCEFIAIgAEEEcWpBEGoiAygCACIADQALIAMgBDYCACAEIAI2AhggBCAENgIMIAQgBDYCCAwBCyACKAIIIgAgBDYCDCACIAQ2AgggBEEANgIYIAQgAjYCDCAEIAA2AggLIAlBCGohAQwCCwJAIAdFDQACQCADKAIcIgFBAnRBvNIAaiICKAIAIANGBEAgAiAANgIAIAANAUGQ0AAgCEF+IAF3cSIINgIADAILIAdBEEEUIAcoAhAgA0YbaiAANgIAIABFDQELIAAgBzYCGCADKAIQIgEEQCAAIAE2AhAgASAANgIYCyADQRRqKAIAIgFFDQAgAEEUaiABNgIAIAEgADYCGAsCQCAFQQ9NBEAgAyAEIAVqIgBBA3I2AgQgACADaiIAIAAoAgRBAXI2AgQMAQsgAyAEaiICIAVBAXI2AgQgAyAEQQNyNgIEIAIgBWogBTYCACAFQf8BTQRAIAVBeHFBtNAAaiEAAn9BjNAAKAIAIgFBASAFQQN2dCIFcUUEQEGM0AAgASAFcjYCACAADAELIAAoAggLIgEgAjYCDCAAIAI2AgggAiAANgIMIAIgATYCCAwBC0EfIQEgBUH///8HTQRAIAVBJiAFQQh2ZyIAa3ZBAXEgAEEBdGtBPmohAQsgAiABNgIcIAJCADcCECABQQJ0QbzSAGohAEEBIAF0IgQgCHFFBEAgACACNgIAQZDQACAEIAhyNgIAIAIgADYCGCACIAI2AgggAiACNgIMDAELIAVBGSABQQF2a0EAIAFBH0cbdCEBIAAoAgAhBAJAA0AgBCIAKAIEQXhxIAVGDQEgAUEddiEEIAFBAXQhASAAIARBBHFqQRBqIgYoAgAiBA0ACyAGIAI2AgAgAiAANgIYIAIgAjYCDCACIAI2AggMAQsgACgCCCIBIAI2AgwgACACNgIIIAJBADYCGCACIAA2AgwgAiABNgIICyADQQhqIQEMAQsCQCAJRQ0AAkAgACgCHCIBQQJ0QbzSAGoiAigCACAARgRAIAIgAzYCACADDQFBkNAAIAtBfiABd3E2AgAMAgsgCUEQQRQgCSgCECAARhtqIAM2AgAgA0UNAQsgAyAJNgIYIAAoAhAiAQRAIAMgATYCECABIAM2AhgLIABBFGooAgAiAUUNACADQRRqIAE2AgAgASADNgIYCwJAIAVBD00EQCAAIAQgBWoiAUEDcjYCBCAAIAFqIgEgASgCBEEBcjYCBAwBCyAAIARqIgcgBUEBcjYCBCAAIARBA3I2AgQgBSAHaiAFNgIAIAgEQCAIQXhxQbTQAGohAUGg0AAoAgAhAwJ/QQEgCEEDdnQiAiAGcUUEQEGM0AAgAiAGcjYCACABDAELIAEoAggLIgIgAzYCDCABIAM2AgggAyABNgIMIAMgAjYCCAtBoNAAIAc2AgBBlNAAIAU2AgALIABBCGohAQsgCkEQaiQAIAELQwAgAEUEQD8AQRB0DwsCQCAAQf//A3ENACAAQQBIDQAgAEEQdkAAIgBBf0YEQEH80wBBMDYCAEF/DwsgAEEQdA8LAAsL3D8iAEGACAsJAQAAAAIAAAADAEGUCAsFBAAAAAUAQaQICwkGAAAABwAAAAgAQdwIC4otSW52YWxpZCBjaGFyIGluIHVybCBxdWVyeQBTcGFuIGNhbGxiYWNrIGVycm9yIGluIG9uX2JvZHkAQ29udGVudC1MZW5ndGggb3ZlcmZsb3cAQ2h1bmsgc2l6ZSBvdmVyZmxvdwBSZXNwb25zZSBvdmVyZmxvdwBJbnZhbGlkIG1ldGhvZCBmb3IgSFRUUC94LnggcmVxdWVzdABJbnZhbGlkIG1ldGhvZCBmb3IgUlRTUC94LnggcmVxdWVzdABFeHBlY3RlZCBTT1VSQ0UgbWV0aG9kIGZvciBJQ0UveC54IHJlcXVlc3QASW52YWxpZCBjaGFyIGluIHVybCBmcmFnbWVudCBzdGFydABFeHBlY3RlZCBkb3QAU3BhbiBjYWxsYmFjayBlcnJvciBpbiBvbl9zdGF0dXMASW52YWxpZCByZXNwb25zZSBzdGF0dXMASW52YWxpZCBjaGFyYWN0ZXIgaW4gY2h1bmsgZXh0ZW5zaW9ucwBVc2VyIGNhbGxiYWNrIGVycm9yAGBvbl9yZXNldGAgY2FsbGJhY2sgZXJyb3IAYG9uX2NodW5rX2hlYWRlcmAgY2FsbGJhY2sgZXJyb3IAYG9uX21lc3NhZ2VfYmVnaW5gIGNhbGxiYWNrIGVycm9yAGBvbl9jaHVua19leHRlbnNpb25fdmFsdWVgIGNhbGxiYWNrIGVycm9yAGBvbl9zdGF0dXNfY29tcGxldGVgIGNhbGxiYWNrIGVycm9yAGBvbl92ZXJzaW9uX2NvbXBsZXRlYCBjYWxsYmFjayBlcnJvcgBgb25fdXJsX2NvbXBsZXRlYCBjYWxsYmFjayBlcnJvcgBgb25fY2h1bmtfY29tcGxldGVgIGNhbGxiYWNrIGVycm9yAGBvbl9oZWFkZXJfdmFsdWVfY29tcGxldGVgIGNhbGxiYWNrIGVycm9yAGBvbl9tZXNzYWdlX2NvbXBsZXRlYCBjYWxsYmFjayBlcnJvcgBgb25fbWV0aG9kX2NvbXBsZXRlYCBjYWxsYmFjayBlcnJvcgBgb25faGVhZGVyX2ZpZWxkX2NvbXBsZXRlYCBjYWxsYmFjayBlcnJvcgBgb25fY2h1bmtfZXh0ZW5zaW9uX25hbWVgIGNhbGxiYWNrIGVycm9yAFVuZXhwZWN0ZWQgY2hhciBpbiB1cmwgc2VydmVyAEludmFsaWQgaGVhZGVyIHZhbHVlIGNoYXIASW52YWxpZCBoZWFkZXIgZmllbGQgY2hhcgBTcGFuIGNhbGxiYWNrIGVycm9yIGluIG9uX3ZlcnNpb24ASW52YWxpZCBtaW5vciB2ZXJzaW9uAEludmFsaWQgbWFqb3IgdmVyc2lvbgBFeHBlY3RlZCBzcGFjZSBhZnRlciB2ZXJzaW9uAEV4cGVjdGVkIENSTEYgYWZ0ZXIgdmVyc2lvbgBJbnZhbGlkIEhUVFAgdmVyc2lvbgBJbnZhbGlkIGhlYWRlciB0b2tlbgBTcGFuIGNhbGxiYWNrIGVycm9yIGluIG9uX3VybABJbnZhbGlkIGNoYXJhY3RlcnMgaW4gdXJsAFVuZXhwZWN0ZWQgc3RhcnQgY2hhciBpbiB1cmwARG91YmxlIEAgaW4gdXJsAEVtcHR5IENvbnRlbnQtTGVuZ3RoAEludmFsaWQgY2hhcmFjdGVyIGluIENvbnRlbnQtTGVuZ3RoAER1cGxpY2F0ZSBDb250ZW50LUxlbmd0aABJbnZhbGlkIGNoYXIgaW4gdXJsIHBhdGgAQ29udGVudC1MZW5ndGggY2FuJ3QgYmUgcHJlc2VudCB3aXRoIFRyYW5zZmVyLUVuY29kaW5nAEludmFsaWQgY2hhcmFjdGVyIGluIGNodW5rIHNpemUAU3BhbiBjYWxsYmFjayBlcnJvciBpbiBvbl9oZWFkZXJfdmFsdWUAU3BhbiBjYWxsYmFjayBlcnJvciBpbiBvbl9jaHVua19leHRlbnNpb25fdmFsdWUASW52YWxpZCBjaGFyYWN0ZXIgaW4gY2h1bmsgZXh0ZW5zaW9ucyB2YWx1ZQBNaXNzaW5nIGV4cGVjdGVkIExGIGFmdGVyIGhlYWRlciB2YWx1ZQBJbnZhbGlkIGBUcmFuc2Zlci1FbmNvZGluZ2AgaGVhZGVyIHZhbHVlAEludmFsaWQgY2hhcmFjdGVyIGluIGNodW5rIGV4dGVuc2lvbnMgcXVvdGUgdmFsdWUASW52YWxpZCBjaGFyYWN0ZXIgaW4gY2h1bmsgZXh0ZW5zaW9ucyBxdW90ZWQgdmFsdWUAUGF1c2VkIGJ5IG9uX2hlYWRlcnNfY29tcGxldGUASW52YWxpZCBFT0Ygc3RhdGUAb25fcmVzZXQgcGF1c2UAb25fY2h1bmtfaGVhZGVyIHBhdXNlAG9uX21lc3NhZ2VfYmVnaW4gcGF1c2UAb25fY2h1bmtfZXh0ZW5zaW9uX3ZhbHVlIHBhdXNlAG9uX3N0YXR1c19jb21wbGV0ZSBwYXVzZQBvbl92ZXJzaW9uX2NvbXBsZXRlIHBhdXNlAG9uX3VybF9jb21wbGV0ZSBwYXVzZQBvbl9jaHVua19jb21wbGV0ZSBwYXVzZQBvbl9oZWFkZXJfdmFsdWVfY29tcGxldGUgcGF1c2UAb25fbWVzc2FnZV9jb21wbGV0ZSBwYXVzZQBvbl9tZXRob2RfY29tcGxldGUgcGF1c2UAb25faGVhZGVyX2ZpZWxkX2NvbXBsZXRlIHBhdXNlAG9uX2NodW5rX2V4dGVuc2lvbl9uYW1lIHBhdXNlAFVuZXhwZWN0ZWQgc3BhY2UgYWZ0ZXIgc3RhcnQgbGluZQBTcGFuIGNhbGxiYWNrIGVycm9yIGluIG9uX2NodW5rX2V4dGVuc2lvbl9uYW1lAEludmFsaWQgY2hhcmFjdGVyIGluIGNodW5rIGV4dGVuc2lvbnMgbmFtZQBQYXVzZSBvbiBDT05ORUNUL1VwZ3JhZGUAUGF1c2Ugb24gUFJJL1VwZ3JhZGUARXhwZWN0ZWQgSFRUUC8yIENvbm5lY3Rpb24gUHJlZmFjZQBTcGFuIGNhbGxiYWNrIGVycm9yIGluIG9uX21ldGhvZABFeHBlY3RlZCBzcGFjZSBhZnRlciBtZXRob2QAU3BhbiBjYWxsYmFjayBlcnJvciBpbiBvbl9oZWFkZXJfZmllbGQAUGF1c2VkAEludmFsaWQgd29yZCBlbmNvdW50ZXJlZABJbnZhbGlkIG1ldGhvZCBlbmNvdW50ZXJlZABVbmV4cGVjdGVkIGNoYXIgaW4gdXJsIHNjaGVtYQBSZXF1ZXN0IGhhcyBpbnZhbGlkIGBUcmFuc2Zlci1FbmNvZGluZ2AAU1dJVENIX1BST1hZAFVTRV9QUk9YWQBNS0FDVElWSVRZAFVOUFJPQ0VTU0FCTEVfRU5USVRZAENPUFkATU9WRURfUEVSTUFORU5UTFkAVE9PX0VBUkxZAE5PVElGWQBGQUlMRURfREVQRU5ERU5DWQBCQURfR0FURVdBWQBQTEFZAFBVVABDSEVDS09VVABHQVRFV0FZX1RJTUVPVVQAUkVRVUVTVF9USU1FT1VUAE5FVFdPUktfQ09OTkVDVF9USU1FT1VUAENPTk5FQ1RJT05fVElNRU9VVABMT0dJTl9USU1FT1VUAE5FVFdPUktfUkVBRF9USU1FT1VUAFBPU1QATUlTRElSRUNURURfUkVRVUVTVABDTElFTlRfQ0xPU0VEX1JFUVVFU1QAQ0xJRU5UX0NMT1NFRF9MT0FEX0JBTEFOQ0VEX1JFUVVFU1QAQkFEX1JFUVVFU1QASFRUUF9SRVFVRVNUX1NFTlRfVE9fSFRUUFNfUE9SVABSRVBPUlQASU1fQV9URUFQT1QAUkVTRVRfQ09OVEVOVABOT19DT05URU5UAFBBUlRJQUxfQ09OVEVOVABIUEVfSU5WQUxJRF9DT05TVEFOVABIUEVfQ0JfUkVTRVQAR0VUAEhQRV9TVFJJQ1QAQ09ORkxJQ1QAVEVNUE9SQVJZX1JFRElSRUNUAFBFUk1BTkVOVF9SRURJUkVDVABDT05ORUNUAE1VTFRJX1NUQVRVUwBIUEVfSU5WQUxJRF9TVEFUVVMAVE9PX01BTllfUkVRVUVTVFMARUFSTFlfSElOVFMAVU5BVkFJTEFCTEVfRk9SX0xFR0FMX1JFQVNPTlMAT1BUSU9OUwBTV0lUQ0hJTkdfUFJPVE9DT0xTAFZBUklBTlRfQUxTT19ORUdPVElBVEVTAE1VTFRJUExFX0NIT0lDRVMASU5URVJOQUxfU0VSVkVSX0VSUk9SAFdFQl9TRVJWRVJfVU5LTk9XTl9FUlJPUgBSQUlMR1VOX0VSUk9SAElERU5USVRZX1BST1ZJREVSX0FVVEhFTlRJQ0FUSU9OX0VSUk9SAFNTTF9DRVJUSUZJQ0FURV9FUlJPUgBJTlZBTElEX1hfRk9SV0FSREVEX0ZPUgBTRVRfUEFSQU1FVEVSAEdFVF9QQVJBTUVURVIASFBFX1VTRVIAU0VFX09USEVSAEhQRV9DQl9DSFVOS19IRUFERVIATUtDQUxFTkRBUgBTRVRVUABXRUJfU0VSVkVSX0lTX0RPV04AVEVBUkRPV04ASFBFX0NMT1NFRF9DT05ORUNUSU9OAEhFVVJJU1RJQ19FWFBJUkFUSU9OAERJU0NPTk5FQ1RFRF9PUEVSQVRJT04ATk9OX0FVVEhPUklUQVRJVkVfSU5GT1JNQVRJT04ASFBFX0lOVkFMSURfVkVSU0lPTgBIUEVfQ0JfTUVTU0FHRV9CRUdJTgBTSVRFX0lTX0ZST1pFTgBIUEVfSU5WQUxJRF9IRUFERVJfVE9LRU4ASU5WQUxJRF9UT0tFTgBGT1JCSURERU4ARU5IQU5DRV9ZT1VSX0NBTE0ASFBFX0lOVkFMSURfVVJMAEJMT0NLRURfQllfUEFSRU5UQUxfQ09OVFJPTABNS0NPTABBQ0wASFBFX0lOVEVSTkFMAFJFUVVFU1RfSEVBREVSX0ZJRUxEU19UT09fTEFSR0VfVU5PRkZJQ0lBTABIUEVfT0sAVU5MSU5LAFVOTE9DSwBQUkkAUkVUUllfV0lUSABIUEVfSU5WQUxJRF9DT05URU5UX0xFTkdUSABIUEVfVU5FWFBFQ1RFRF9DT05URU5UX0xFTkdUSABGTFVTSABQUk9QUEFUQ0gATS1TRUFSQ0gAVVJJX1RPT19MT05HAFBST0NFU1NJTkcATUlTQ0VMTEFORU9VU19QRVJTSVNURU5UX1dBUk5JTkcATUlTQ0VMTEFORU9VU19XQVJOSU5HAEhQRV9JTlZBTElEX1RSQU5TRkVSX0VOQ09ESU5HAEV4cGVjdGVkIENSTEYASFBFX0lOVkFMSURfQ0hVTktfU0laRQBNT1ZFAENPTlRJTlVFAEhQRV9DQl9TVEFUVVNfQ09NUExFVEUASFBFX0NCX0hFQURFUlNfQ09NUExFVEUASFBFX0NCX1ZFUlNJT05fQ09NUExFVEUASFBFX0NCX1VSTF9DT01QTEVURQBIUEVfQ0JfQ0hVTktfQ09NUExFVEUASFBFX0NCX0hFQURFUl9WQUxVRV9DT01QTEVURQBIUEVfQ0JfQ0hVTktfRVhURU5TSU9OX1ZBTFVFX0NPTVBMRVRFAEhQRV9DQl9DSFVOS19FWFRFTlNJT05fTkFNRV9DT01QTEVURQBIUEVfQ0JfTUVTU0FHRV9DT01QTEVURQBIUEVfQ0JfTUVUSE9EX0NPTVBMRVRFAEhQRV9DQl9IRUFERVJfRklFTERfQ09NUExFVEUAREVMRVRFAEhQRV9JTlZBTElEX0VPRl9TVEFURQBJTlZBTElEX1NTTF9DRVJUSUZJQ0FURQBQQVVTRQBOT19SRVNQT05TRQBVTlNVUFBPUlRFRF9NRURJQV9UWVBFAEdPTkUATk9UX0FDQ0VQVEFCTEUAU0VSVklDRV9VTkFWQUlMQUJMRQBSQU5HRV9OT1RfU0FUSVNGSUFCTEUAT1JJR0lOX0lTX1VOUkVBQ0hBQkxFAFJFU1BPTlNFX0lTX1NUQUxFAFBVUkdFAE1FUkdFAFJFUVVFU1RfSEVBREVSX0ZJRUxEU19UT09fTEFSR0UAUkVRVUVTVF9IRUFERVJfVE9PX0xBUkdFAFBBWUxPQURfVE9PX0xBUkdFAElOU1VGRklDSUVOVF9TVE9SQUdFAEhQRV9QQVVTRURfVVBHUkFERQBIUEVfUEFVU0VEX0gyX1VQR1JBREUAU09VUkNFAEFOTk9VTkNFAFRSQUNFAEhQRV9VTkVYUEVDVEVEX1NQQUNFAERFU0NSSUJFAFVOU1VCU0NSSUJFAFJFQ09SRABIUEVfSU5WQUxJRF9NRVRIT0QATk9UX0ZPVU5EAFBST1BGSU5EAFVOQklORABSRUJJTkQAVU5BVVRIT1JJWkVEAE1FVEhPRF9OT1RfQUxMT1dFRABIVFRQX1ZFUlNJT05fTk9UX1NVUFBPUlRFRABBTFJFQURZX1JFUE9SVEVEAEFDQ0VQVEVEAE5PVF9JTVBMRU1FTlRFRABMT09QX0RFVEVDVEVEAEhQRV9DUl9FWFBFQ1RFRABIUEVfTEZfRVhQRUNURUQAQ1JFQVRFRABJTV9VU0VEAEhQRV9QQVVTRUQAVElNRU9VVF9PQ0NVUkVEAFBBWU1FTlRfUkVRVUlSRUQAUFJFQ09ORElUSU9OX1JFUVVJUkVEAFBST1hZX0FVVEhFTlRJQ0FUSU9OX1JFUVVJUkVEAE5FVFdPUktfQVVUSEVOVElDQVRJT05fUkVRVUlSRUQATEVOR1RIX1JFUVVJUkVEAFNTTF9DRVJUSUZJQ0FURV9SRVFVSVJFRABVUEdSQURFX1JFUVVJUkVEAFBBR0VfRVhQSVJFRABQUkVDT05ESVRJT05fRkFJTEVEAEVYUEVDVEFUSU9OX0ZBSUxFRABSRVZBTElEQVRJT05fRkFJTEVEAFNTTF9IQU5EU0hBS0VfRkFJTEVEAExPQ0tFRABUUkFOU0ZPUk1BVElPTl9BUFBMSUVEAE5PVF9NT0RJRklFRABOT1RfRVhURU5ERUQAQkFORFdJRFRIX0xJTUlUX0VYQ0VFREVEAFNJVEVfSVNfT1ZFUkxPQURFRABIRUFEAEV4cGVjdGVkIEhUVFAvAABeEwAAJhMAADAQAADwFwAAnRMAABUSAAA5FwAA8BIAAAoQAAB1EgAArRIAAIITAABPFAAAfxAAAKAVAAAjFAAAiRIAAIsUAABNFQAA1BEAAM8UAAAQGAAAyRYAANwWAADBEQAA4BcAALsUAAB0FAAAfBUAAOUUAAAIFwAAHxAAAGUVAACjFAAAKBUAAAIVAACZFQAALBAAAIsZAABPDwAA1A4AAGoQAADOEAAAAhcAAIkOAABuEwAAHBMAAGYUAABWFwAAwRMAAM0TAABsEwAAaBcAAGYXAABfFwAAIhMAAM4PAABpDgAA2A4AAGMWAADLEwAAqg4AACgXAAAmFwAAxRMAAF0WAADoEQAAZxMAAGUTAADyFgAAcxMAAB0XAAD5FgAA8xEAAM8OAADOFQAADBIAALMRAAClEQAAYRAAADIXAAC7EwBB+TULAQEAQZA2C+ABAQECAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEAQf03CwEBAEGROAteAgMCAgICAgAAAgIAAgIAAgICAgICAgICAgAEAAAAAAACAgICAgICAgICAgICAgICAgICAgICAgICAgAAAAICAgICAgICAgICAgICAgICAgICAgICAgICAgICAAIAAgBB/TkLAQEAQZE6C14CAAICAgICAAACAgACAgACAgICAgICAgICAAMABAAAAAICAgICAgICAgICAgICAgICAgICAgICAgICAAAAAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAAgACAEHwOwsNbG9zZWVlcC1hbGl2ZQBBiTwLAQEAQaA8C+ABAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEAAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEAQYk+CwEBAEGgPgvnAQEBAQEBAQEBAQEBAQIBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBY2h1bmtlZABBsMAAC18BAQABAQEBAQAAAQEAAQEAAQEBAQEBAQEBAQAAAAAAAAABAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQAAAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAAEAAQBBkMIACyFlY3Rpb25lbnQtbGVuZ3Rob25yb3h5LWNvbm5lY3Rpb24AQcDCAAstcmFuc2Zlci1lbmNvZGluZ3BncmFkZQ0KDQoNClNNDQoNClRUUC9DRS9UU1AvAEH5wgALBQECAAEDAEGQwwAL4AEEAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQABAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQBB+cQACwUBAgABAwBBkMUAC+ABBAEBBQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEAAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEAQfnGAAsEAQAAAQBBkccAC98BAQEAAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQABAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQBB+sgACwQBAAACAEGQyQALXwMEAAAEBAQEBAQEBAQEBAUEBAQEBAQEBAQEBAQABAAGBwQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAAEAAQABAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQAAAAEAEH6ygALBAEAAAEAQZDLAAsBAQBBqssAC0ECAAAAAAAAAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMAAAAAAAADAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwBB+swACwQBAAABAEGQzQALAQEAQZrNAAsGAgAAAAACAEGxzQALOgMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAAAAAAAAAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMAQfDOAAuWAU5PVU5DRUVDS09VVE5FQ1RFVEVDUklCRUxVU0hFVEVBRFNFQVJDSFJHRUNUSVZJVFlMRU5EQVJWRU9USUZZUFRJT05TQ0hTRUFZU1RBVENIR0VPUkRJUkVDVE9SVFJDSFBBUkFNRVRFUlVSQ0VCU0NSSUJFQVJET1dOQUNFSU5ETktDS1VCU0NSSUJFSFRUUC9BRFRQLw==","base64")});var j7=H((Zfi,Fet)=>{"use strict";d();var ket=["GET","HEAD","POST"],rJt=new Set(ket),nJt=[101,204,205,304],Pet=[301,302,303,307,308],iJt=new Set(Pet),Det=["1","7","9","11","13","15","17","19","20","21","22","23","25","37","42","43","53","69","77","79","87","95","101","102","103","104","109","110","111","113","115","117","119","123","135","137","139","143","161","179","389","427","465","512","513","514","515","526","530","531","532","540","548","554","556","563","587","601","636","989","990","993","995","1719","1720","1723","2049","3659","4045","4190","5060","5061","6000","6566","6665","6666","6667","6668","6669","6679","6697","10080"],oJt=new Set(Det),Bet=["","no-referrer","no-referrer-when-downgrade","same-origin","origin","strict-origin","origin-when-cross-origin","strict-origin-when-cross-origin","unsafe-url"],sJt=new Set(Bet),aJt=["follow","manual","error"],Net=["GET","HEAD","OPTIONS","TRACE"],cJt=new Set(Net),lJt=["navigate","same-origin","no-cors","cors"],uJt=["omit","same-origin","include"],dJt=["default","no-store","reload","no-cache","force-cache","only-if-cached"],fJt=["content-encoding","content-language","content-location","content-type","content-length"],pJt=["half"],Met=["CONNECT","TRACE","TRACK"],mJt=new Set(Met),Let=["audio","audioworklet","font","image","manifest","paintworklet","script","style","track","video","xslt",""],hJt=new Set(Let);Fet.exports={subresource:Let,forbiddenMethods:Met,requestBodyHeader:fJt,referrerPolicy:Bet,requestRedirect:aJt,requestMode:lJt,requestCredentials:uJt,requestCache:dJt,redirectStatus:Pet,corsSafeListedMethods:ket,nullBodyStatus:nJt,safeMethods:Net,badPorts:Det,requestDuplex:pJt,subresourceSet:hJt,badPortsSet:oJt,redirectStatusSet:iJt,corsSafeListedMethodsSet:rJt,safeMethodsSet:cJt,forbiddenMethodsSet:mJt,referrerPolicySet:sJt}});var ube=H((tpi,Oet)=>{"use strict";d();var lbe=Symbol.for("undici.globalOrigin.1");function gJt(){return globalThis[lbe]}s(gJt,"getGlobalOrigin");function AJt(t){if(t===void 0){Object.defineProperty(globalThis,lbe,{value:void 0,writable:!0,enumerable:!1,configurable:!1});return}let e=new URL(t);if(e.protocol!=="http:"&&e.protocol!=="https:")throw new TypeError(`Only http & https urls are allowed, received ${e.protocol}`);Object.defineProperty(globalThis,lbe,{value:e,writable:!0,enumerable:!1,configurable:!1})}s(AJt,"setGlobalOrigin");Oet.exports={getGlobalOrigin:gJt,setGlobalOrigin:AJt}});var Mp=H((ipi,jet)=>{"use strict";d();var jee=require("node:assert"),yJt=new TextEncoder,G7=/^[!#$%&'*+\-.^_|~A-Za-z0-9]+$/,CJt=/[\u000A\u000D\u0009\u0020]/,vJt=/[\u0009\u000A\u000C\u000D\u0020]/g,xJt=/^[\u0009\u0020-\u007E\u0080-\u00FF]+$/;function EJt(t){jee(t.protocol==="data:");let e=qet(t,!0);e=e.slice(5);let r={position:0},n=rN(",",e,r),i=n.length;if(n=_Jt(n,!0,!0),r.position>=e.length)return"failure";r.position++;let o=e.slice(i+1),a=Het(o);if(/;(\u0020){0,}base64$/i.test(n)){let l=Wet(a);if(a=IJt(l),a==="failure")return"failure";n=n.slice(0,-6),n=n.replace(/(\u0020)+$/,""),n=n.slice(0,-1)}n.startsWith(";")&&(n="text/plain"+n);let c=dbe(n);return c==="failure"&&(c=dbe("text/plain;charset=US-ASCII")),{mimeType:c,body:a}}s(EJt,"dataURLProcessor");function qet(t,e=!1){if(!e)return t.href;let r=t.href,n=t.hash.length,i=n===0?r:r.substring(0,r.length-n);return!n&&r.endsWith("#")?i.slice(0,-1):i}s(qet,"URLSerializer");function Gee(t,e,r){let n="";for(;r.position<e.length&&t(e[r.position]);)n+=e[r.position],r.position++;return n}s(Gee,"collectASequenceOfCodePoints");function rN(t,e,r){let n=e.indexOf(t,r.position),i=r.position;return n===-1?(r.position=e.length,e.slice(i)):(r.position=n,e.slice(i,r.position))}s(rN,"collectASequenceOfCodePointsFast");function Het(t){let e=yJt.encode(t);return bJt(e)}s(Het,"stringPercentDecode");function Qet(t){return t>=48&&t<=57||t>=65&&t<=70||t>=97&&t<=102}s(Qet,"isHexCharByte");function Uet(t){return t>=48&&t<=57?t-48:(t&223)-55}s(Uet,"hexByteToNumber");function bJt(t){let e=t.length,r=new Uint8Array(e),n=0;for(let i=0;i<e;++i){let o=t[i];o!==37?r[n++]=o:o===37&&!(Qet(t[i+1])&&Qet(t[i+2]))?r[n++]=37:(r[n++]=Uet(t[i+1])<<4|Uet(t[i+2]),i+=2)}return e===n?r:r.subarray(0,n)}s(bJt,"percentDecode");function dbe(t){t=Wee(t,!0,!0);let e={position:0},r=rN("/",t,e);if(r.length===0||!G7.test(r)||e.position>t.length)return"failure";e.position++;let n=rN(";",t,e);if(n=Wee(n,!1,!0),n.length===0||!G7.test(n))return"failure";let i=r.toLowerCase(),o=n.toLowerCase(),a={type:i,subtype:o,parameters:new Map,essence:`${i}/${o}`};for(;e.position<t.length;){e.position++,Gee(u=>CJt.test(u),t,e);let c=Gee(u=>u!==";"&&u!=="=",t,e);if(c=c.toLowerCase(),e.position<t.length){if(t[e.position]===";")continue;e.position++}if(e.position>t.length)break;let l=null;if(t[e.position]==='"')l=$et(t,e,!0),rN(";",t,e);else if(l=rN(";",t,e),l=Wee(l,!1,!0),l.length===0)continue;c.length!==0&&G7.test(c)&&(l.length===0||xJt.test(l))&&!a.parameters.has(c)&&a.parameters.set(c,l)}return a}s(dbe,"parseMIMEType");function IJt(t){t=t.replace(vJt,"");let e=t.length;if(e%4===0&&t.charCodeAt(e-1)===61&&(--e,t.charCodeAt(e-1)===61&&--e),e%4===1||/[^+/0-9A-Za-z]/.test(t.length===e?t:t.substring(0,e)))return"failure";let r=Buffer.from(t,"base64");return new Uint8Array(r.buffer,r.byteOffset,r.byteLength)}s(IJt,"forgivingBase64");function $et(t,e,r){let n=e.position,i="";for(jee(t[e.position]==='"'),e.position++;i+=Gee(a=>a!=='"'&&a!=="\\",t,e),!(e.position>=t.length);){let o=t[e.position];if(e.position++,o==="\\"){if(e.position>=t.length){i+="\\";break}i+=t[e.position],e.position++}else{jee(o==='"');break}}return r?i:t.slice(n,e.position)}s($et,"collectAnHTTPQuotedString");function TJt(t){jee(t!=="failure");let{parameters:e,essence:r}=t,n=r;for(let[i,o]of e.entries())n+=";",n+=i,n+="=",G7.test(o)||(o=o.replace(/(\\|")/g,"\\$1"),o='"'+o,o+='"'),n+=o;return n}s(TJt,"serializeAMimeType");function wJt(t){return t===13||t===10||t===9||t===32}s(wJt,"isHTTPWhiteSpace");function Wee(t,e=!0,r=!0){return fbe(t,e,r,wJt)}s(Wee,"removeHTTPWhitespace");function SJt(t){return t===13||t===10||t===9||t===12||t===32}s(SJt,"isASCIIWhitespace");function _Jt(t,e=!0,r=!0){return fbe(t,e,r,SJt)}s(_Jt,"removeASCIIWhitespace");function fbe(t,e,r,n){let i=0,o=t.length-1;if(e)for(;i<t.length&&n(t.charCodeAt(i));)i++;if(r)for(;o>0&&n(t.charCodeAt(o));)o--;return i===0&&o===t.length-1?t:t.slice(i,o+1)}s(fbe,"removeChars");function Wet(t){let e=t.length;if(65535>e)return String.fromCharCode.apply(null,t);let r="",n=0,i=65535;for(;n<e;)n+i>e&&(i=e-n),r+=String.fromCharCode.apply(null,t.subarray(n,n+=i));return r}s(Wet,"isomorphicDecode");function RJt(t){switch(t.essence){case"application/ecmascript":case"application/javascript":case"application/x-ecmascript":case"application/x-javascript":case"text/ecmascript":case"text/javascript":case"text/javascript1.0":case"text/javascript1.1":case"text/javascript1.2":case"text/javascript1.3":case"text/javascript1.4":case"text/javascript1.5":case"text/jscript":case"text/livescript":case"text/x-ecmascript":case"text/x-javascript":return"text/javascript";case"application/json":case"text/json":return"application/json";case"image/svg+xml":return"image/svg+xml";case"text/xml":case"application/xml":return"application/xml"}return t.subtype.endsWith("+json")?"application/json":t.subtype.endsWith("+xml")?"application/xml":""}s(RJt,"minimizeSupportedMimeType");jet.exports={dataURLProcessor:EJt,URLSerializer:qet,collectASequenceOfCodePoints:Gee,collectASequenceOfCodePointsFast:rN,stringPercentDecode:Het,parseMIMEType:dbe,collectAnHTTPQuotedString:$et,serializeAMimeType:TJt,removeChars:fbe,removeHTTPWhitespace:Wee,minimizeSupportedMimeType:RJt,HTTP_TOKEN_CODEPOINTS:G7,isomorphicDecode:Wet}});var nd=H((api,Get)=>{"use strict";d();var{types:ZC,inspect:kJt}=require("node:util"),{markAsUncloneable:PJt}=require("node:worker_threads"),{toUSVString:DJt}=$i(),qt={};qt.converters={};qt.util={};qt.errors={};qt.errors.exception=function(t){return new TypeError(`${t.header}: ${t.message}`)};qt.errors.conversionFailed=function(t){let e=t.types.length===1?"":" one of",r=`${t.argument} could not be converted to${e}: ${t.types.join(", ")}.`;return qt.errors.exception({header:t.prefix,message:r})};qt.errors.invalidArgument=function(t){return qt.errors.exception({header:t.prefix,message:`"${t.value}" is an invalid ${t.type}.`})};qt.brandCheck=function(t,e,r){if(r?.strict!==!1){if(!(t instanceof e)){let n=new TypeError("Illegal invocation");throw n.code="ERR_INVALID_THIS",n}}else if(t?.[Symbol.toStringTag]!==e.prototype[Symbol.toStringTag]){let n=new TypeError("Illegal invocation");throw n.code="ERR_INVALID_THIS",n}};qt.argumentLengthCheck=function({length:t},e,r){if(t<e)throw qt.errors.exception({message:`${e} argument${e!==1?"s":""} required, but${t?" only":""} ${t} found.`,header:r})};qt.illegalConstructor=function(){throw qt.errors.exception({header:"TypeError",message:"Illegal constructor"})};qt.util.Type=function(t){switch(typeof t){case"undefined":return"Undefined";case"boolean":return"Boolean";case"string":return"String";case"symbol":return"Symbol";case"number":return"Number";case"bigint":return"BigInt";case"function":case"object":return t===null?"Null":"Object"}};qt.util.markAsUncloneable=PJt||(()=>{});qt.util.ConvertToInt=function(t,e,r,n){let i,o;e===64?(i=Math.pow(2,53)-1,r==="unsigned"?o=0:o=Math.pow(-2,53)+1):r==="unsigned"?(o=0,i=Math.pow(2,e)-1):(o=Math.pow(-2,e)-1,i=Math.pow(2,e-1)-1);let a=Number(t);if(a===0&&(a=0),n?.enforceRange===!0){if(Number.isNaN(a)||a===Number.POSITIVE_INFINITY||a===Number.NEGATIVE_INFINITY)throw qt.errors.exception({header:"Integer conversion",message:`Could not convert ${qt.util.Stringify(t)} to an integer.`});if(a=qt.util.IntegerPart(a),a<o||a>i)throw qt.errors.exception({header:"Integer conversion",message:`Value must be between ${o}-${i}, got ${a}.`});return a}return!Number.isNaN(a)&&n?.clamp===!0?(a=Math.min(Math.max(a,o),i),Math.floor(a)%2===0?a=Math.floor(a):a=Math.ceil(a),a):Number.isNaN(a)||a===0&&Object.is(0,a)||a===Number.POSITIVE_INFINITY||a===Number.NEGATIVE_INFINITY?0:(a=qt.util.IntegerPart(a),a=a%Math.pow(2,e),r==="signed"&&a>=Math.pow(2,e)-1?a-Math.pow(2,e):a)};qt.util.IntegerPart=function(t){let e=Math.floor(Math.abs(t));return t<0?-1*e:e};qt.util.Stringify=function(t){switch(qt.util.Type(t)){case"Symbol":return`Symbol(${t.description})`;case"Object":return kJt(t);case"String":return`"${t}"`;default:return`${t}`}};qt.sequenceConverter=function(t){return(e,r,n,i)=>{if(qt.util.Type(e)!=="Object")throw qt.errors.exception({header:r,message:`${n} (${qt.util.Stringify(e)}) is not iterable.`});let o=typeof i=="function"?i():e?.[Symbol.iterator]?.(),a=[],c=0;if(o===void 0||typeof o.next!="function")throw qt.errors.exception({header:r,message:`${n} is not iterable.`});for(;;){let{done:l,value:u}=o.next();if(l)break;a.push(t(u,r,`${n}[${c++}]`))}return a}};qt.recordConverter=function(t,e){return(r,n,i)=>{if(qt.util.Type(r)!=="Object")throw qt.errors.exception({header:n,message:`${i} ("${qt.util.Type(r)}") is not an Object.`});let o={};if(!ZC.isProxy(r)){let c=[...Object.getOwnPropertyNames(r),...Object.getOwnPropertySymbols(r)];for(let l of c){let u=t(l,n,i),f=e(r[l],n,i);o[u]=f}return o}let a=Reflect.ownKeys(r);for(let c of a)if(Reflect.getOwnPropertyDescriptor(r,c)?.enumerable){let u=t(c,n,i),f=e(r[c],n,i);o[u]=f}return o}};qt.interfaceConverter=function(t){return(e,r,n,i)=>{if(i?.strict!==!1&&!(e instanceof t))throw qt.errors.exception({header:r,message:`Expected ${n} ("${qt.util.Stringify(e)}") to be an instance of ${t.name}.`});return e}};qt.dictionaryConverter=function(t){return(e,r,n)=>{let i=qt.util.Type(e),o={};if(i==="Null"||i==="Undefined")return o;if(i!=="Object")throw qt.errors.exception({header:r,message:`Expected ${e} to be one of: Null, Undefined, Object.`});for(let a of t){let{key:c,defaultValue:l,required:u,converter:f}=a;if(u===!0&&!Object.hasOwn(e,c))throw qt.errors.exception({header:r,message:`Missing required key "${c}".`});let p=e[c],m=Object.hasOwn(a,"defaultValue");if(m&&p!==null&&(p??=l()),u||m||p!==void 0){if(p=f(p,r,`${n}.${c}`),a.allowedValues&&!a.allowedValues.includes(p))throw qt.errors.exception({header:r,message:`${p} is not an accepted type. Expected one of ${a.allowedValues.join(", ")}.`});o[c]=p}}return o}};qt.nullableConverter=function(t){return(e,r,n)=>e===null?e:t(e,r,n)};qt.converters.DOMString=function(t,e,r,n){if(t===null&&n?.legacyNullToEmptyString)return"";if(typeof t=="symbol")throw qt.errors.exception({header:e,message:`${r} is a symbol, which cannot be converted to a DOMString.`});return String(t)};qt.converters.ByteString=function(t,e,r){let n=qt.converters.DOMString(t,e,r);for(let i=0;i<n.length;i++)if(n.charCodeAt(i)>255)throw new TypeError(`Cannot convert argument to a ByteString because the character at index ${i} has a value of ${n.charCodeAt(i)} which is greater than 255.`);return n};qt.converters.USVString=DJt;qt.converters.boolean=function(t){return!!t};qt.converters.any=function(t){return t};qt.converters["long long"]=function(t,e,r){return qt.util.ConvertToInt(t,64,"signed",void 0,e,r)};qt.converters["unsigned long long"]=function(t,e,r){return qt.util.ConvertToInt(t,64,"unsigned",void 0,e,r)};qt.converters["unsigned long"]=function(t,e,r){return qt.util.ConvertToInt(t,32,"unsigned",void 0,e,r)};qt.converters["unsigned short"]=function(t,e,r,n){return qt.util.ConvertToInt(t,16,"unsigned",n,e,r)};qt.converters.ArrayBuffer=function(t,e,r,n){if(qt.util.Type(t)!=="Object"||!ZC.isAnyArrayBuffer(t))throw qt.errors.conversionFailed({prefix:e,argument:`${r} ("${qt.util.Stringify(t)}")`,types:["ArrayBuffer"]});if(n?.allowShared===!1&&ZC.isSharedArrayBuffer(t))throw qt.errors.exception({header:"ArrayBuffer",message:"SharedArrayBuffer is not allowed."});if(t.resizable||t.growable)throw qt.errors.exception({header:"ArrayBuffer",message:"Received a resizable ArrayBuffer."});return t};qt.converters.TypedArray=function(t,e,r,n,i){if(qt.util.Type(t)!=="Object"||!ZC.isTypedArray(t)||t.constructor.name!==e.name)throw qt.errors.conversionFailed({prefix:r,argument:`${n} ("${qt.util.Stringify(t)}")`,types:[e.name]});if(i?.allowShared===!1&&ZC.isSharedArrayBuffer(t.buffer))throw qt.errors.exception({header:"ArrayBuffer",message:"SharedArrayBuffer is not allowed."});if(t.buffer.resizable||t.buffer.growable)throw qt.errors.exception({header:"ArrayBuffer",message:"Received a resizable ArrayBuffer."});return t};qt.converters.DataView=function(t,e,r,n){if(qt.util.Type(t)!=="Object"||!ZC.isDataView(t))throw qt.errors.exception({header:e,message:`${r} is not a DataView.`});if(n?.allowShared===!1&&ZC.isSharedArrayBuffer(t.buffer))throw qt.errors.exception({header:"ArrayBuffer",message:"SharedArrayBuffer is not allowed."});if(t.buffer.resizable||t.buffer.growable)throw qt.errors.exception({header:"ArrayBuffer",message:"Received a resizable ArrayBuffer."});return t};qt.converters.BufferSource=function(t,e,r,n){if(ZC.isAnyArrayBuffer(t))return qt.converters.ArrayBuffer(t,e,r,{...n,allowShared:!1});if(ZC.isTypedArray(t))return qt.converters.TypedArray(t,t.constructor,e,r,{...n,allowShared:!1});if(ZC.isDataView(t))return qt.converters.DataView(t,e,r,{...n,allowShared:!1});throw qt.errors.conversionFailed({prefix:e,argument:`${r} ("${qt.util.Stringify(t)}")`,types:["BufferSource"]})};qt.converters["sequence<ByteString>"]=qt.sequenceConverter(qt.converters.ByteString);qt.converters["sequence<sequence<ByteString>>"]=qt.sequenceConverter(qt.converters["sequence<ByteString>"]);qt.converters["record<ByteString, ByteString>"]=qt.recordConverter(qt.converters.ByteString,qt.converters.ByteString);Get.exports={webidl:qt}});var J0=H((lpi,stt)=>{"use strict";d();var{Transform:BJt}=require("node:stream"),Vet=require("node:zlib"),{redirectStatusSet:NJt,referrerPolicySet:MJt,badPortsSet:LJt}=j7(),{getGlobalOrigin:zet}=ube(),{collectASequenceOfCodePoints:nk,collectAnHTTPQuotedString:FJt,removeChars:OJt,parseMIMEType:QJt}=Mp(),{performance:UJt}=require("node:perf_hooks"),{isBlobLike:qJt,ReadableStreamFrom:HJt,isValidHTTPToken:Ket,normalizedMethodRecordsBase:$Jt}=$i(),ik=require("node:assert"),{isUint8Array:WJt}=require("node:util/types"),{webidl:V7}=nd(),Yet=[],zee;try{zee=require("node:crypto");let t=["sha256","sha384","sha512"];Yet=zee.getHashes().filter(e=>t.includes(e))}catch{}function Jet(t){let e=t.urlList,r=e.length;return r===0?null:e[r-1].toString()}s(Jet,"responseURL");function jJt(t,e){if(!NJt.has(t.status))return null;let r=t.headersList.get("location",!0);return r!==null&&Zet(r)&&(Xet(r)||(r=GJt(r)),r=new URL(r,Jet(t))),r&&!r.hash&&(r.hash=e),r}s(jJt,"responseLocationURL");function Xet(t){for(let e=0;e<t.length;++e){let r=t.charCodeAt(e);if(r>126||r<32)return!1}return!0}s(Xet,"isValidEncodedURL");function GJt(t){return Buffer.from(t,"binary").toString("utf8")}s(GJt,"normalizeBinaryStringToUtf8");function K7(t){return t.urlList[t.urlList.length-1]}s(K7,"requestCurrentURL");function VJt(t){let e=K7(t);return itt(e)&&LJt.has(e.port)?"blocked":"allowed"}s(VJt,"requestBadPort");function zJt(t){return t instanceof Error||t?.constructor?.name==="Error"||t?.constructor?.name==="DOMException"}s(zJt,"isErrorLike");function KJt(t){for(let e=0;e<t.length;++e){let r=t.charCodeAt(e);if(!(r===9||r>=32&&r<=126||r>=128&&r<=255))return!1}return!0}s(KJt,"isValidReasonPhrase");var YJt=Ket;function Zet(t){return(t[0]==="	"||t[0]===" "||t[t.length-1]==="	"||t[t.length-1]===" "||t.includes(`
`)||t.includes("\r")||t.includes("\0"))===!1}s(Zet,"isValidHeaderValue");function JJt(t,e){let{headersList:r}=e,n=(r.get("referrer-policy",!0)??"").split(","),i="";if(n.length>0)for(let o=n.length;o!==0;o--){let a=n[o-1].trim();if(MJt.has(a)){i=a;break}}i!==""&&(t.referrerPolicy=i)}s(JJt,"setRequestReferrerPolicyOnRedirect");function XJt(){return"allowed"}s(XJt,"crossOriginResourcePolicyCheck");function ZJt(){return"success"}s(ZJt,"corsCheck");function eXt(){return"success"}s(eXt,"TAOCheck");function tXt(t){let e=null;e=t.mode,t.headersList.set("sec-fetch-mode",e,!0)}s(tXt,"appendFetchMetadata");function rXt(t){let e=t.origin;if(!(e==="client"||e===void 0)){if(t.responseTainting==="cors"||t.mode==="websocket")t.headersList.append("origin",e,!0);else if(t.method!=="GET"&&t.method!=="HEAD"){switch(t.referrerPolicy){case"no-referrer":e=null;break;case"no-referrer-when-downgrade":case"strict-origin":case"strict-origin-when-cross-origin":t.origin&&mbe(t.origin)&&!mbe(K7(t))&&(e=null);break;case"same-origin":Kee(t,K7(t))||(e=null);break;default:}t.headersList.append("origin",e,!0)}}}s(rXt,"appendRequestOriginHeader");function nN(t,e){return t}s(nN,"coarsenTime");function nXt(t,e,r){return!t?.startTime||t.startTime<e?{domainLookupStartTime:e,domainLookupEndTime:e,connectionStartTime:e,connectionEndTime:e,secureConnectionStartTime:e,ALPNNegotiatedProtocol:t?.ALPNNegotiatedProtocol}:{domainLookupStartTime:nN(t.domainLookupStartTime,r),domainLookupEndTime:nN(t.domainLookupEndTime,r),connectionStartTime:nN(t.connectionStartTime,r),connectionEndTime:nN(t.connectionEndTime,r),secureConnectionStartTime:nN(t.secureConnectionStartTime,r),ALPNNegotiatedProtocol:t.ALPNNegotiatedProtocol}}s(nXt,"clampAndCoarsenConnectionTimingInfo");function iXt(t){return nN(UJt.now(),t)}s(iXt,"coarsenedSharedCurrentTime");function oXt(t){return{startTime:t.startTime??0,redirectStartTime:0,redirectEndTime:0,postRedirectStartTime:t.startTime??0,finalServiceWorkerStartTime:0,finalNetworkResponseStartTime:0,finalNetworkRequestStartTime:0,endTime:0,encodedBodySize:0,decodedBodySize:0,finalConnectionTimingInfo:null}}s(oXt,"createOpaqueTimingInfo");function ett(){return{referrerPolicy:"strict-origin-when-cross-origin"}}s(ett,"makePolicyContainer");function sXt(t){return{referrerPolicy:t.referrerPolicy}}s(sXt,"clonePolicyContainer");function aXt(t){let e=t.referrerPolicy;ik(e);let r=null;if(t.referrer==="client"){let c=zet();if(!c||c.origin==="null")return"no-referrer";r=new URL(c)}else t.referrer instanceof URL&&(r=t.referrer);let n=pbe(r),i=pbe(r,!0);n.toString().length>4096&&(n=i);let o=Kee(t,n),a=z7(n)&&!z7(t.url);switch(e){case"origin":return i??pbe(r,!0);case"unsafe-url":return n;case"same-origin":return o?i:"no-referrer";case"origin-when-cross-origin":return o?n:i;case"strict-origin-when-cross-origin":{let c=K7(t);return Kee(n,c)?n:z7(n)&&!z7(c)?"no-referrer":i}case"strict-origin":case"no-referrer-when-downgrade":default:return a?"no-referrer":i}}s(aXt,"determineRequestsReferrer");function pbe(t,e){return ik(t instanceof URL),t=new URL(t),t.protocol==="file:"||t.protocol==="about:"||t.protocol==="blank:"?"no-referrer":(t.username="",t.password="",t.hash="",e&&(t.pathname="",t.search=""),t)}s(pbe,"stripURLForReferrer");function z7(t){if(!(t instanceof URL))return!1;if(t.href==="about:blank"||t.href==="about:srcdoc"||t.protocol==="data:"||t.protocol==="file:")return!0;return e(t.origin);function e(r){if(r==null||r==="null")return!1;let n=new URL(r);return!!(n.protocol==="https:"||n.protocol==="wss:"||/^127(?:\.[0-9]+){0,2}\.[0-9]+$|^\[(?:0*:)*?:?0*1\]$/.test(n.hostname)||n.hostname==="localhost"||n.hostname.includes("localhost.")||n.hostname.endsWith(".localhost"))}}s(z7,"isURLPotentiallyTrustworthy");function cXt(t,e){if(zee===void 0)return!0;let r=ttt(e);if(r==="no metadata"||r.length===0)return!0;let n=uXt(r),i=dXt(r,n);for(let o of i){let a=o.algo,c=o.hash,l=zee.createHash(a).update(t).digest("base64");if(l[l.length-1]==="="&&(l[l.length-2]==="="?l=l.slice(0,-2):l=l.slice(0,-1)),fXt(l,c))return!0}return!1}s(cXt,"bytesMatch");var lXt=/(?<algo>sha256|sha384|sha512)-((?<hash>[A-Za-z0-9+/]+|[A-Za-z0-9_-]+)={0,2}(?:\s|$)( +[!-~]*)?)?/i;function ttt(t){let e=[],r=!0;for(let n of t.split(" ")){r=!1;let i=lXt.exec(n);if(i===null||i.groups===void 0||i.groups.algo===void 0)continue;let o=i.groups.algo.toLowerCase();Yet.includes(o)&&e.push(i.groups)}return r===!0?"no metadata":e}s(ttt,"parseMetadata");function uXt(t){let e=t[0].algo;if(e[3]==="5")return e;for(let r=1;r<t.length;++r){let n=t[r];if(n.algo[3]==="5"){e="sha512";break}else{if(e[3]==="3")continue;n.algo[3]==="3"&&(e="sha384")}}return e}s(uXt,"getStrongestMetadata");function dXt(t,e){if(t.length===1)return t;let r=0;for(let n=0;n<t.length;++n)t[n].algo===e&&(t[r++]=t[n]);return t.length=r,t}s(dXt,"filterMetadataListByAlgorithm");function fXt(t,e){if(t.length!==e.length)return!1;for(let r=0;r<t.length;++r)if(t[r]!==e[r]){if(t[r]==="+"&&e[r]==="-"||t[r]==="/"&&e[r]==="_")continue;return!1}return!0}s(fXt,"compareBase64Mixed");function pXt(t){}s(pXt,"tryUpgradeRequestToAPotentiallyTrustworthyURL");function Kee(t,e){return t.origin===e.origin&&t.origin==="null"||t.protocol===e.protocol&&t.hostname===e.hostname&&t.port===e.port}s(Kee,"sameOrigin");function mXt(){let t,e;return{promise:new Promise((n,i)=>{t=n,e=i}),resolve:t,reject:e}}s(mXt,"createDeferredPromise");function hXt(t){return t.controller.state==="aborted"}s(hXt,"isAborted");function gXt(t){return t.controller.state==="aborted"||t.controller.state==="terminated"}s(gXt,"isCancelled");function AXt(t){return $Jt[t.toLowerCase()]??t}s(AXt,"normalizeMethod");function yXt(t){let e=JSON.stringify(t);if(e===void 0)throw new TypeError("Value is not JSON serializable");return ik(typeof e=="string"),e}s(yXt,"serializeJavascriptValueToJSONString");var CXt=Object.getPrototypeOf(Object.getPrototypeOf([][Symbol.iterator]()));function rtt(t,e,r=0,n=1){class i{static{s(this,"FastIterableIterator")}#e;#t;#i;constructor(a,c){this.#e=a,this.#t=c,this.#i=0}next(){if(typeof this!="object"||this===null||!(#e in this))throw new TypeError(`'next' called on an object that does not implement interface ${t} Iterator.`);let a=this.#i,c=this.#e[e],l=c.length;if(a>=l)return{value:void 0,done:!0};let{[r]:u,[n]:f}=c[a];this.#i=a+1;let p;switch(this.#t){case"key":p=u;break;case"value":p=f;break;case"key+value":p=[u,f];break}return{value:p,done:!1}}}return delete i.prototype.constructor,Object.setPrototypeOf(i.prototype,CXt),Object.defineProperties(i.prototype,{[Symbol.toStringTag]:{writable:!1,enumerable:!1,configurable:!0,value:`${t} Iterator`},next:{writable:!0,enumerable:!0,configurable:!0}}),function(o,a){return new i(o,a)}}s(rtt,"createIterator");function vXt(t,e,r,n=0,i=1){let o=rtt(t,r,n,i),a={keys:{writable:!0,enumerable:!0,configurable:!0,value:s(function(){return V7.brandCheck(this,e),o(this,"key")},"keys")},values:{writable:!0,enumerable:!0,configurable:!0,value:s(function(){return V7.brandCheck(this,e),o(this,"value")},"values")},entries:{writable:!0,enumerable:!0,configurable:!0,value:s(function(){return V7.brandCheck(this,e),o(this,"key+value")},"entries")},forEach:{writable:!0,enumerable:!0,configurable:!0,value:s(function(l,u=globalThis){if(V7.brandCheck(this,e),V7.argumentLengthCheck(arguments,1,`${t}.forEach`),typeof l!="function")throw new TypeError(`Failed to execute 'forEach' on '${t}': parameter 1 is not of type 'Function'.`);for(let{0:f,1:p}of o(this,"key+value"))l.call(u,p,f,this)},"forEach")}};return Object.defineProperties(e.prototype,{...a,[Symbol.iterator]:{writable:!0,enumerable:!1,configurable:!0,value:a.entries.value}})}s(vXt,"iteratorMixin");async function xXt(t,e,r){let n=e,i=r,o;try{o=t.stream.getReader()}catch(a){i(a);return}try{n(await ntt(o))}catch(a){i(a)}}s(xXt,"fullyReadBody");function EXt(t){return t instanceof ReadableStream||t[Symbol.toStringTag]==="ReadableStream"&&typeof t.tee=="function"}s(EXt,"isReadableStreamLike");function bXt(t){try{t.close(),t.byobRequest?.respond(0)}catch(e){if(!e.message.includes("Controller is already closed")&&!e.message.includes("ReadableStream is already closed"))throw e}}s(bXt,"readableStreamClose");var IXt=/[^\x00-\xFF]/;function Vee(t){return ik(!IXt.test(t)),t}s(Vee,"isomorphicEncode");async function ntt(t){let e=[],r=0;for(;;){let{done:n,value:i}=await t.read();if(n)return Buffer.concat(e,r);if(!WJt(i))throw new TypeError("Received non-Uint8Array chunk");e.push(i),r+=i.length}}s(ntt,"readAllBytes");function TXt(t){ik("protocol"in t);let e=t.protocol;return e==="about:"||e==="blob:"||e==="data:"}s(TXt,"urlIsLocal");function mbe(t){return typeof t=="string"&&t[5]===":"&&t[0]==="h"&&t[1]==="t"&&t[2]==="t"&&t[3]==="p"&&t[4]==="s"||t.protocol==="https:"}s(mbe,"urlHasHttpsScheme");function itt(t){ik("protocol"in t);let e=t.protocol;return e==="http:"||e==="https:"}s(itt,"urlIsHttpHttpsScheme");function wXt(t,e){let r=t;if(!r.startsWith("bytes"))return"failure";let n={position:5};if(e&&nk(l=>l==="	"||l===" ",r,n),r.charCodeAt(n.position)!==61)return"failure";n.position++,e&&nk(l=>l==="	"||l===" ",r,n);let i=nk(l=>{let u=l.charCodeAt(0);return u>=48&&u<=57},r,n),o=i.length?Number(i):null;if(e&&nk(l=>l==="	"||l===" ",r,n),r.charCodeAt(n.position)!==45)return"failure";n.position++,e&&nk(l=>l==="	"||l===" ",r,n);let a=nk(l=>{let u=l.charCodeAt(0);return u>=48&&u<=57},r,n),c=a.length?Number(a):null;return n.position<r.length||c===null&&o===null||o>c?"failure":{rangeStartValue:o,rangeEndValue:c}}s(wXt,"simpleRangeHeaderValue");function SXt(t,e,r){let n="bytes ";return n+=Vee(`${t}`),n+="-",n+=Vee(`${e}`),n+="/",n+=Vee(`${r}`),n}s(SXt,"buildContentRange");var hbe=class extends BJt{static{s(this,"InflateStream")}#e;constructor(e){super(),this.#e=e}_transform(e,r,n){if(!this._inflateStream){if(e.length===0){n();return}this._inflateStream=(e[0]&15)===8?Vet.createInflate(this.#e):Vet.createInflateRaw(this.#e),this._inflateStream.on("data",this.push.bind(this)),this._inflateStream.on("end",()=>this.push(null)),this._inflateStream.on("error",i=>this.destroy(i))}this._inflateStream.write(e,r,n)}_final(e){this._inflateStream&&(this._inflateStream.end(),this._inflateStream=null),e()}};function _Xt(t){return new hbe(t)}s(_Xt,"createInflate");function RXt(t){let e=null,r=null,n=null,i=ott("content-type",t);if(i===null)return"failure";for(let o of i){let a=QJt(o);a==="failure"||a.essence==="*/*"||(n=a,n.essence!==r?(e=null,n.parameters.has("charset")&&(e=n.parameters.get("charset")),r=n.essence):!n.parameters.has("charset")&&e!==null&&n.parameters.set("charset",e))}return n??"failure"}s(RXt,"extractMimeType");function kXt(t){let e=t,r={position:0},n=[],i="";for(;r.position<e.length;){if(i+=nk(o=>o!=='"'&&o!==",",e,r),r.position<e.length)if(e.charCodeAt(r.position)===34){if(i+=FJt(e,r),r.position<e.length)continue}else ik(e.charCodeAt(r.position)===44),r.position++;i=OJt(i,!0,!0,o=>o===9||o===32),n.push(i),i=""}return n}s(kXt,"gettingDecodingSplitting");function ott(t,e){let r=e.get(t,!0);return r===null?null:kXt(r)}s(ott,"getDecodeSplit");var PXt=new TextDecoder;function DXt(t){return t.length===0?"":(t[0]===239&&t[1]===187&&t[2]===191&&(t=t.subarray(3)),PXt.decode(t))}s(DXt,"utf8DecodeBytes");var gbe=class{static{s(this,"EnvironmentSettingsObjectBase")}get baseUrl(){return zet()}get origin(){return this.baseUrl?.origin}policyContainer=ett()},Abe=class{static{s(this,"EnvironmentSettingsObject")}settingsObject=new gbe},BXt=new Abe;stt.exports={isAborted:hXt,isCancelled:gXt,isValidEncodedURL:Xet,createDeferredPromise:mXt,ReadableStreamFrom:HJt,tryUpgradeRequestToAPotentiallyTrustworthyURL:pXt,clampAndCoarsenConnectionTimingInfo:nXt,coarsenedSharedCurrentTime:iXt,determineRequestsReferrer:aXt,makePolicyContainer:ett,clonePolicyContainer:sXt,appendFetchMetadata:tXt,appendRequestOriginHeader:rXt,TAOCheck:eXt,corsCheck:ZJt,crossOriginResourcePolicyCheck:XJt,createOpaqueTimingInfo:oXt,setRequestReferrerPolicyOnRedirect:JJt,isValidHTTPToken:Ket,requestBadPort:VJt,requestCurrentURL:K7,responseURL:Jet,responseLocationURL:jJt,isBlobLike:qJt,isURLPotentiallyTrustworthy:z7,isValidReasonPhrase:KJt,sameOrigin:Kee,normalizeMethod:AXt,serializeJavascriptValueToJSONString:yXt,iteratorMixin:vXt,createIterator:rtt,isValidHeaderName:YJt,isValidHeaderValue:Zet,isErrorLike:zJt,fullyReadBody:xXt,bytesMatch:cXt,isReadableStreamLike:EXt,readableStreamClose:bXt,isomorphicEncode:Vee,urlIsLocal:TXt,urlHasHttpsScheme:mbe,urlIsHttpHttpsScheme:itt,readAllBytes:ntt,simpleRangeHeaderValue:wXt,buildContentRange:SXt,parseMetadata:ttt,createInflate:_Xt,extractMimeType:RXt,getDecodeSplit:ott,utf8DecodeBytes:DXt,environmentSettingsObject:BXt}});var ew=H((fpi,att)=>{"use strict";d();att.exports={kUrl:Symbol("url"),kHeaders:Symbol("headers"),kSignal:Symbol("signal"),kState:Symbol("state"),kDispatcher:Symbol("dispatcher")}});var Cbe=H((mpi,ctt)=>{"use strict";d();var{Blob:NXt,File:MXt}=require("node:buffer"),{kState:$x}=ew(),{webidl:e1}=nd(),ybe=class t{static{s(this,"FileLike")}constructor(e,r,n={}){let i=r,o=n.type,a=n.lastModified??Date.now();this[$x]={blobLike:e,name:i,type:o,lastModified:a}}stream(...e){return e1.brandCheck(this,t),this[$x].blobLike.stream(...e)}arrayBuffer(...e){return e1.brandCheck(this,t),this[$x].blobLike.arrayBuffer(...e)}slice(...e){return e1.brandCheck(this,t),this[$x].blobLike.slice(...e)}text(...e){return e1.brandCheck(this,t),this[$x].blobLike.text(...e)}get size(){return e1.brandCheck(this,t),this[$x].blobLike.size}get type(){return e1.brandCheck(this,t),this[$x].blobLike.type}get name(){return e1.brandCheck(this,t),this[$x].name}get lastModified(){return e1.brandCheck(this,t),this[$x].lastModified}get[Symbol.toStringTag](){return"File"}};e1.converters.Blob=e1.interfaceConverter(NXt);function LXt(t){return t instanceof MXt||t&&(typeof t.stream=="function"||typeof t.arrayBuffer=="function")&&t[Symbol.toStringTag]==="File"}s(LXt,"isFileLike");ctt.exports={FileLike:ybe,isFileLike:LXt}});var J7=H((Api,ptt)=>{"use strict";d();var{isBlobLike:Yee,iteratorMixin:FXt}=J0(),{kState:Nf}=ew(),{kEnumerableProperty:iN}=$i(),{FileLike:ltt,isFileLike:OXt}=Cbe(),{webidl:$s}=nd(),{File:ftt}=require("node:buffer"),utt=require("node:util"),dtt=globalThis.File??ftt,Y7=class t{static{s(this,"FormData")}constructor(e){if($s.util.markAsUncloneable(this),e!==void 0)throw $s.errors.conversionFailed({prefix:"FormData constructor",argument:"Argument 1",types:["undefined"]});this[Nf]=[]}append(e,r,n=void 0){$s.brandCheck(this,t);let i="FormData.append";if($s.argumentLengthCheck(arguments,2,i),arguments.length===3&&!Yee(r))throw new TypeError("Failed to execute 'append' on 'FormData': parameter 2 is not of type 'Blob'");e=$s.converters.USVString(e,i,"name"),r=Yee(r)?$s.converters.Blob(r,i,"value",{strict:!1}):$s.converters.USVString(r,i,"value"),n=arguments.length===3?$s.converters.USVString(n,i,"filename"):void 0;let o=vbe(e,r,n);this[Nf].push(o)}delete(e){$s.brandCheck(this,t);let r="FormData.delete";$s.argumentLengthCheck(arguments,1,r),e=$s.converters.USVString(e,r,"name"),this[Nf]=this[Nf].filter(n=>n.name!==e)}get(e){$s.brandCheck(this,t);let r="FormData.get";$s.argumentLengthCheck(arguments,1,r),e=$s.converters.USVString(e,r,"name");let n=this[Nf].findIndex(i=>i.name===e);return n===-1?null:this[Nf][n].value}getAll(e){$s.brandCheck(this,t);let r="FormData.getAll";return $s.argumentLengthCheck(arguments,1,r),e=$s.converters.USVString(e,r,"name"),this[Nf].filter(n=>n.name===e).map(n=>n.value)}has(e){$s.brandCheck(this,t);let r="FormData.has";return $s.argumentLengthCheck(arguments,1,r),e=$s.converters.USVString(e,r,"name"),this[Nf].findIndex(n=>n.name===e)!==-1}set(e,r,n=void 0){$s.brandCheck(this,t);let i="FormData.set";if($s.argumentLengthCheck(arguments,2,i),arguments.length===3&&!Yee(r))throw new TypeError("Failed to execute 'set' on 'FormData': parameter 2 is not of type 'Blob'");e=$s.converters.USVString(e,i,"name"),r=Yee(r)?$s.converters.Blob(r,i,"name",{strict:!1}):$s.converters.USVString(r,i,"name"),n=arguments.length===3?$s.converters.USVString(n,i,"name"):void 0;let o=vbe(e,r,n),a=this[Nf].findIndex(c=>c.name===e);a!==-1?this[Nf]=[...this[Nf].slice(0,a),o,...this[Nf].slice(a+1).filter(c=>c.name!==e)]:this[Nf].push(o)}[utt.inspect.custom](e,r){let n=this[Nf].reduce((o,a)=>(o[a.name]?Array.isArray(o[a.name])?o[a.name].push(a.value):o[a.name]=[o[a.name],a.value]:o[a.name]=a.value,o),{__proto__:null});r.depth??=e,r.colors??=!0;let i=utt.formatWithOptions(r,n);return`FormData ${i.slice(i.indexOf("]")+2)}`}};FXt("FormData",Y7,Nf,"name","value");Object.defineProperties(Y7.prototype,{append:iN,delete:iN,get:iN,getAll:iN,has:iN,set:iN,[Symbol.toStringTag]:{value:"FormData",configurable:!0}});function vbe(t,e,r){if(typeof e!="string"){if(OXt(e)||(e=e instanceof Blob?new dtt([e],"blob",{type:e.type}):new ltt(e,"blob",{type:e.type})),r!==void 0){let n={type:e.type,lastModified:e.lastModified};e=e instanceof ftt?new dtt([e],r,n):new ltt(e,r,n)}}return{name:t,value:e}}s(vbe,"makeEntry");ptt.exports={FormData:Y7,makeEntry:vbe}});var Ctt=H((vpi,ytt)=>{"use strict";d();var{isUSVString:mtt,bufferToLowerCasedHeaderName:QXt}=$i(),{utf8DecodeBytes:UXt}=J0(),{HTTP_TOKEN_CODEPOINTS:qXt,isomorphicDecode:htt}=Mp(),{isFileLike:HXt}=Cbe(),{makeEntry:$Xt}=J7(),Jee=require("node:assert"),{File:WXt}=require("node:buffer"),jXt=globalThis.File??WXt,GXt=Buffer.from('form-data; name="'),gtt=Buffer.from("; filename"),VXt=Buffer.from("--"),zXt=Buffer.from(`--\r
`);function KXt(t){for(let e=0;e<t.length;++e)if((t.charCodeAt(e)&-128)!==0)return!1;return!0}s(KXt,"isAsciiString");function YXt(t){let e=t.length;if(e<27||e>70)return!1;for(let r=0;r<e;++r){let n=t.charCodeAt(r);if(!(n>=48&&n<=57||n>=65&&n<=90||n>=97&&n<=122||n===39||n===45||n===95))return!1}return!0}s(YXt,"validateBoundary");function JXt(t,e){Jee(e!=="failure"&&e.essence==="multipart/form-data");let r=e.parameters.get("boundary");if(r===void 0)return"failure";let n=Buffer.from(`--${r}`,"utf8"),i=[],o={position:0};for(;t[o.position]===13&&t[o.position+1]===10;)o.position+=2;let a=t.length;for(;t[a-1]===10&&t[a-2]===13;)a-=2;for(a!==t.length&&(t=t.subarray(0,a));;){if(t.subarray(o.position,o.position+n.length).equals(n))o.position+=n.length;else return"failure";if(o.position===t.length-2&&Xee(t,VXt,o)||o.position===t.length-4&&Xee(t,zXt,o))return i;if(t[o.position]!==13||t[o.position+1]!==10)return"failure";o.position+=2;let c=XXt(t,o);if(c==="failure")return"failure";let{name:l,filename:u,contentType:f,encoding:p}=c;o.position+=2;let m;{let g=t.indexOf(n.subarray(2),o.position);if(g===-1)return"failure";m=t.subarray(o.position,g-4),o.position+=m.length,p==="base64"&&(m=Buffer.from(m.toString(),"base64"))}if(t[o.position]!==13||t[o.position+1]!==10)return"failure";o.position+=2;let h;u!==null?(f??="text/plain",KXt(f)||(f=""),h=new jXt([m],u,{type:f})):h=UXt(Buffer.from(m)),Jee(mtt(l)),Jee(typeof h=="string"&&mtt(h)||HXt(h)),i.push($Xt(l,h,u))}}s(JXt,"multipartFormDataParser");function XXt(t,e){let r=null,n=null,i=null,o=null;for(;;){if(t[e.position]===13&&t[e.position+1]===10)return r===null?"failure":{name:r,filename:n,contentType:i,encoding:o};let a=oN(c=>c!==10&&c!==13&&c!==58,t,e);if(a=xbe(a,!0,!0,c=>c===9||c===32),!qXt.test(a.toString())||t[e.position]!==58)return"failure";switch(e.position++,oN(c=>c===32||c===9,t,e),QXt(a)){case"content-disposition":{if(r=n=null,!Xee(t,GXt,e)||(e.position+=17,r=Att(t,e),r===null))return"failure";if(Xee(t,gtt,e)){let c=e.position+gtt.length;if(t[c]===42&&(e.position+=1,c+=1),t[c]!==61||t[c+1]!==34||(e.position+=12,n=Att(t,e),n===null))return"failure"}break}case"content-type":{let c=oN(l=>l!==10&&l!==13,t,e);c=xbe(c,!1,!0,l=>l===9||l===32),i=htt(c);break}case"content-transfer-encoding":{let c=oN(l=>l!==10&&l!==13,t,e);c=xbe(c,!1,!0,l=>l===9||l===32),o=htt(c);break}default:oN(c=>c!==10&&c!==13,t,e)}if(t[e.position]!==13&&t[e.position+1]!==10)return"failure";e.position+=2}}s(XXt,"parseMultipartFormDataHeaders");function Att(t,e){Jee(t[e.position-1]===34);let r=oN(n=>n!==10&&n!==13&&n!==34,t,e);return t[e.position]!==34?null:(e.position++,r=new TextDecoder().decode(r).replace(/%0A/ig,`
`).replace(/%0D/ig,"\r").replace(/%22/g,'"'),r)}s(Att,"parseMultipartFormDataName");function oN(t,e,r){let n=r.position;for(;n<e.length&&t(e[n]);)++n;return e.subarray(r.position,r.position=n)}s(oN,"collectASequenceOfBytes");function xbe(t,e,r,n){let i=0,o=t.length-1;if(e)for(;i<t.length&&n(t[i]);)i++;if(r)for(;o>0&&n(t[o]);)o--;return i===0&&o===t.length-1?t:t.subarray(i,o+1)}s(xbe,"removeChars");function Xee(t,e,r){if(t.length<e.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[r.position+n])return!1;return!0}s(Xee,"bufferStartsWith");ytt.exports={multipartFormDataParser:JXt,validateBoundary:YXt}});var cN=H((bpi,Stt)=>{"use strict";d();var X7=$i(),{ReadableStreamFrom:ZXt,isBlobLike:vtt,isReadableStreamLike:eZt,readableStreamClose:tZt,createDeferredPromise:rZt,fullyReadBody:nZt,extractMimeType:iZt,utf8DecodeBytes:btt}=J0(),{FormData:xtt}=J7(),{kState:aN}=ew(),{webidl:oZt}=nd(),{Blob:sZt}=require("node:buffer"),Ebe=require("node:assert"),{isErrored:Itt,isDisturbed:aZt}=require("node:stream"),{isArrayBuffer:cZt}=require("node:util/types"),{serializeAMimeType:lZt}=Mp(),{multipartFormDataParser:uZt}=Ctt(),bbe;try{let t=require("node:crypto");bbe=s(e=>t.randomInt(0,e),"random")}catch{bbe=s(t=>Math.floor(Math.random(t)),"random")}var Zee=new TextEncoder;function dZt(){}s(dZt,"noop");var Ibe=globalThis.FinalizationRegistry&&process.version.indexOf("v18")!==0,Tbe;Ibe&&(Tbe=new FinalizationRegistry(t=>{let e=t.deref();e&&!e.locked&&!aZt(e)&&!Itt(e)&&e.cancel("Response object has been garbage collected").catch(dZt)}));function Ttt(t,e=!1){let r=null;t instanceof ReadableStream?r=t:vtt(t)?r=t.stream():r=new ReadableStream({async pull(l){let u=typeof i=="string"?Zee.encode(i):i;u.byteLength&&l.enqueue(u),queueMicrotask(()=>tZt(l))},start(){},type:"bytes"}),Ebe(eZt(r));let n=null,i=null,o=null,a=null;if(typeof t=="string")i=t,a="text/plain;charset=UTF-8";else if(t instanceof URLSearchParams)i=t.toString(),a="application/x-www-form-urlencoded;charset=UTF-8";else if(cZt(t))i=new Uint8Array(t.slice());else if(ArrayBuffer.isView(t))i=new Uint8Array(t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength));else if(X7.isFormDataLike(t)){let l=`----formdata-undici-0${`${bbe(1e11)}`.padStart(11,"0")}`,u=`--${l}\r
Content-Disposition: form-data`;let f=s(y=>y.replace(/\n/g,"%0A").replace(/\r/g,"%0D").replace(/"/g,"%22"),"escape"),p=s(y=>y.replace(/\r?\n|\r/g,`\r
`),"normalizeLinefeeds"),m=[],h=new Uint8Array([13,10]);o=0;let g=!1;for(let[y,E]of t)if(typeof E=="string"){let b=Zee.encode(u+`; name="${f(p(y))}"\r
\r
${p(E)}\r
`);m.push(b),o+=b.byteLength}else{let b=Zee.encode(`${u}; name="${f(p(y))}"`+(E.name?`; filename="${f(E.name)}"`:"")+`\r
Content-Type: ${E.type||"application/octet-stream"}\r
\r
`);m.push(b,E,h),typeof E.size=="number"?o+=b.byteLength+E.size+h.byteLength:g=!0}let A=Zee.encode(`--${l}--\r
`);m.push(A),o+=A.byteLength,g&&(o=null),i=t,n=s(async function*(){for(let y of m)y.stream?yield*y.stream():yield y},"action"),a=`multipart/form-data; boundary=${l}`}else if(vtt(t))i=t,o=t.size,t.type&&(a=t.type);else if(typeof t[Symbol.asyncIterator]=="function"){if(e)throw new TypeError("keepalive");if(X7.isDisturbed(t)||t.locked)throw new TypeError("Response body object should not be disturbed or locked");r=t instanceof ReadableStream?t:ZXt(t)}if((typeof i=="string"||X7.isBuffer(i))&&(o=Buffer.byteLength(i)),n!=null){let l;r=new ReadableStream({async start(){l=n(t)[Symbol.asyncIterator]()},async pull(u){let{value:f,done:p}=await l.next();if(p)queueMicrotask(()=>{u.close(),u.byobRequest?.respond(0)});else if(!Itt(r)){let m=new Uint8Array(f);m.byteLength&&u.enqueue(m)}return u.desiredSize>0},async cancel(u){await l.return()},type:"bytes"})}return[{stream:r,source:i,length:o},a]}s(Ttt,"extractBody");function fZt(t,e=!1){return t instanceof ReadableStream&&(Ebe(!X7.isDisturbed(t),"The body has already been consumed."),Ebe(!t.locked,"The stream is locked.")),Ttt(t,e)}s(fZt,"safelyExtractBody");function pZt(t,e){let[r,n]=e.stream.tee();return Ibe&&Tbe.register(t,new WeakRef(r)),e.stream=r,{stream:n,length:e.length,source:e.source}}s(pZt,"cloneBody");function mZt(t){if(t.aborted)throw new DOMException("The operation was aborted.","AbortError")}s(mZt,"throwIfAborted");function hZt(t){return{blob(){return sN(this,r=>{let n=Ett(this);return n===null?n="":n&&(n=lZt(n)),new sZt([r],{type:n})},t)},arrayBuffer(){return sN(this,r=>new Uint8Array(r).buffer,t)},text(){return sN(this,btt,t)},json(){return sN(this,AZt,t)},formData(){return sN(this,r=>{let n=Ett(this);if(n!==null)switch(n.essence){case"multipart/form-data":{let i=uZt(r,n);if(i==="failure")throw new TypeError("Failed to parse body as FormData.");let o=new xtt;return o[aN]=i,o}case"application/x-www-form-urlencoded":{let i=new URLSearchParams(r.toString()),o=new xtt;for(let[a,c]of i)o.append(a,c);return o}}throw new TypeError('Content-Type was not one of "multipart/form-data" or "application/x-www-form-urlencoded".')},t)},bytes(){return sN(this,r=>new Uint8Array(r),t)}}}s(hZt,"bodyMixinMethods");function gZt(t){Object.assign(t.prototype,hZt(t))}s(gZt,"mixinBody");async function sN(t,e,r){if(oZt.brandCheck(t,r),wtt(t))throw new TypeError("Body is unusable: Body has already been read");mZt(t[aN]);let n=rZt(),i=s(a=>n.reject(a),"errorSteps"),o=s(a=>{try{n.resolve(e(a))}catch(c){i(c)}},"successSteps");return t[aN].body==null?(o(Buffer.allocUnsafe(0)),n.promise):(await nZt(t[aN].body,o,i),n.promise)}s(sN,"consumeBody");function wtt(t){let e=t[aN].body;return e!=null&&(e.stream.locked||X7.isDisturbed(e.stream))}s(wtt,"bodyUnusable");function AZt(t){return JSON.parse(btt(t))}s(AZt,"parseJSONFromBytes");function Ett(t){let e=t[aN].headersList,r=iZt(e);return r==="failure"?null:r}s(Ett,"bodyMimeType");Stt.exports={extractBody:Ttt,safelyExtractBody:fZt,cloneBody:pZt,mixinBody:gZt,streamRegistry:Tbe,hasFinalizationRegistry:Ibe,bodyUnusable:wtt}});var Ott=H((wpi,Ftt)=>{"use strict";d();var Nn=require("node:assert"),ui=$i(),{channels:_tt}=K3(),wbe=obe(),{RequestContentLengthMismatchError:ok,ResponseContentLengthMismatchError:yZt,RequestAbortedError:Ntt,HeadersTimeoutError:CZt,HeadersOverflowError:vZt,SocketError:ote,InformationalError:lN,BodyTimeoutError:xZt,HTTPParserError:EZt,ResponseExceededMaxSizeError:bZt}=Jo(),{kUrl:Mtt,kReset:Lp,kClient:kbe,kParser:gc,kBlocking:tQ,kRunning:$d,kPending:IZt,kSize:Rtt,kWriting:rw,kQueue:QA,kNoRef:Z7,kKeepAliveDefaultTimeout:TZt,kHostHeader:wZt,kPendingIdx:SZt,kRunningIdx:Qh,kError:Uh,kPipelining:nte,kSocket:uN,kKeepAliveTimeoutValue:ste,kMaxHeadersSize:Sbe,kKeepAliveMaxTimeout:_Zt,kKeepAliveTimeoutThreshold:RZt,kHeadersTimeout:kZt,kBodyTimeout:PZt,kStrictContentLength:Pbe,kMaxRequests:ktt,kCounter:DZt,kMaxResponseSize:BZt,kOnError:NZt,kResume:tw,kHTTPContext:Ltt}=La(),t1=Tet(),MZt=Buffer.alloc(0),ete=Buffer[Symbol.species],tte=ui.addListener,LZt=ui.removeAllListeners,_be;async function FZt(){let t=process.env.JEST_WORKER_ID?cbe():void 0,e;try{e=await WebAssembly.compile(Ret())}catch{e=await WebAssembly.compile(t||cbe())}return await WebAssembly.instantiate(e,{env:{wasm_on_url:s((r,n,i)=>0,"wasm_on_url"),wasm_on_status:s((r,n,i)=>{Nn(Ql.ptr===r);let o=n-n1+r1.byteOffset;return Ql.onStatus(new ete(r1.buffer,o,i))||0},"wasm_on_status"),wasm_on_message_begin:s(r=>(Nn(Ql.ptr===r),Ql.onMessageBegin()||0),"wasm_on_message_begin"),wasm_on_header_field:s((r,n,i)=>{Nn(Ql.ptr===r);let o=n-n1+r1.byteOffset;return Ql.onHeaderField(new ete(r1.buffer,o,i))||0},"wasm_on_header_field"),wasm_on_header_value:s((r,n,i)=>{Nn(Ql.ptr===r);let o=n-n1+r1.byteOffset;return Ql.onHeaderValue(new ete(r1.buffer,o,i))||0},"wasm_on_header_value"),wasm_on_headers_complete:s((r,n,i,o)=>(Nn(Ql.ptr===r),Ql.onHeadersComplete(n,!!i,!!o)||0),"wasm_on_headers_complete"),wasm_on_body:s((r,n,i)=>{Nn(Ql.ptr===r);let o=n-n1+r1.byteOffset;return Ql.onBody(new ete(r1.buffer,o,i))||0},"wasm_on_body"),wasm_on_message_complete:s(r=>(Nn(Ql.ptr===r),Ql.onMessageComplete()||0),"wasm_on_message_complete")}})}s(FZt,"lazyllhttp");var Rbe=null,Dbe=FZt();Dbe.catch();var Ql=null,r1=null,rte=0,n1=null,OZt=0,eQ=1,dN=2|eQ,ite=4|eQ,Bbe=8|OZt,Nbe=class{static{s(this,"Parser")}constructor(e,r,{exports:n}){Nn(Number.isFinite(e[Sbe])&&e[Sbe]>0),this.llhttp=n,this.ptr=this.llhttp.llhttp_alloc(t1.TYPE.RESPONSE),this.client=e,this.socket=r,this.timeout=null,this.timeoutValue=null,this.timeoutType=null,this.statusCode=null,this.statusText="",this.upgrade=!1,this.headers=[],this.headersSize=0,this.headersMaxSize=e[Sbe],this.shouldKeepAlive=!1,this.paused=!1,this.resume=this.resume.bind(this),this.bytesRead=0,this.keepAlive="",this.contentLength="",this.connection="",this.maxResponseSize=e[BZt]}setTimeout(e,r){e!==this.timeoutValue||r&eQ^this.timeoutType&eQ?(this.timeout&&(wbe.clearTimeout(this.timeout),this.timeout=null),e&&(r&eQ?this.timeout=wbe.setFastTimeout(Ptt,e,new WeakRef(this)):(this.timeout=setTimeout(Ptt,e,new WeakRef(this)),this.timeout.unref())),this.timeoutValue=e):this.timeout&&this.timeout.refresh&&this.timeout.refresh(),this.timeoutType=r}resume(){this.socket.destroyed||!this.paused||(Nn(this.ptr!=null),Nn(Ql==null),this.llhttp.llhttp_resume(this.ptr),Nn(this.timeoutType===ite),this.timeout&&this.timeout.refresh&&this.timeout.refresh(),this.paused=!1,this.execute(this.socket.read()||MZt),this.readMore())}readMore(){for(;!this.paused&&this.ptr;){let e=this.socket.read();if(e===null)break;this.execute(e)}}execute(e){Nn(this.ptr!=null),Nn(Ql==null),Nn(!this.paused);let{socket:r,llhttp:n}=this;e.length>rte&&(n1&&n.free(n1),rte=Math.ceil(e.length/4096)*4096,n1=n.malloc(rte)),new Uint8Array(n.memory.buffer,n1,rte).set(e);try{let i;try{r1=e,Ql=this,i=n.llhttp_execute(this.ptr,n1,e.length)}catch(a){throw a}finally{Ql=null,r1=null}let o=n.llhttp_get_error_pos(this.ptr)-n1;if(i===t1.ERROR.PAUSED_UPGRADE)this.onUpgrade(e.slice(o));else if(i===t1.ERROR.PAUSED)this.paused=!0,r.unshift(e.slice(o));else if(i!==t1.ERROR.OK){let a=n.llhttp_get_error_reason(this.ptr),c="";if(a){let l=new Uint8Array(n.memory.buffer,a).indexOf(0);c="Response does not match the HTTP/1.1 protocol ("+Buffer.from(n.memory.buffer,a,l).toString()+")"}throw new EZt(c,t1.ERROR[i],e.slice(o))}}catch(i){ui.destroy(r,i)}}destroy(){Nn(this.ptr!=null),Nn(Ql==null),this.llhttp.llhttp_free(this.ptr),this.ptr=null,this.timeout&&wbe.clearTimeout(this.timeout),this.timeout=null,this.timeoutValue=null,this.timeoutType=null,this.paused=!1}onStatus(e){this.statusText=e.toString()}onMessageBegin(){let{socket:e,client:r}=this;if(e.destroyed)return-1;let n=r[QA][r[Qh]];if(!n)return-1;n.onResponseStarted()}onHeaderField(e){let r=this.headers.length;(r&1)===0?this.headers.push(e):this.headers[r-1]=Buffer.concat([this.headers[r-1],e]),this.trackHeader(e.length)}onHeaderValue(e){let r=this.headers.length;(r&1)===1?(this.headers.push(e),r+=1):this.headers[r-1]=Buffer.concat([this.headers[r-1],e]);let n=this.headers[r-2];if(n.length===10){let i=ui.bufferToLowerCasedHeaderName(n);i==="keep-alive"?this.keepAlive+=e.toString():i==="connection"&&(this.connection+=e.toString())}else n.length===14&&ui.bufferToLowerCasedHeaderName(n)==="content-length"&&(this.contentLength+=e.toString());this.trackHeader(e.length)}trackHeader(e){this.headersSize+=e,this.headersSize>=this.headersMaxSize&&ui.destroy(this.socket,new vZt)}onUpgrade(e){let{upgrade:r,client:n,socket:i,headers:o,statusCode:a}=this;Nn(r),Nn(n[uN]===i),Nn(!i.destroyed),Nn(!this.paused),Nn((o.length&1)===0);let c=n[QA][n[Qh]];Nn(c),Nn(c.upgrade||c.method==="CONNECT"),this.statusCode=null,this.statusText="",this.shouldKeepAlive=null,this.headers=[],this.headersSize=0,i.unshift(e),i[gc].destroy(),i[gc]=null,i[kbe]=null,i[Uh]=null,LZt(i),n[uN]=null,n[Ltt]=null,n[QA][n[Qh]++]=null,n.emit("disconnect",n[Mtt],[n],new lN("upgrade"));try{c.onUpgrade(a,o,i)}catch(l){ui.destroy(i,l)}n[tw]()}onHeadersComplete(e,r,n){let{client:i,socket:o,headers:a,statusText:c}=this;if(o.destroyed)return-1;let l=i[QA][i[Qh]];if(!l)return-1;if(Nn(!this.upgrade),Nn(this.statusCode<200),e===100)return ui.destroy(o,new ote("bad response",ui.getSocketInfo(o))),-1;if(r&&!l.upgrade)return ui.destroy(o,new ote("bad upgrade",ui.getSocketInfo(o))),-1;if(Nn(this.timeoutType===dN),this.statusCode=e,this.shouldKeepAlive=n||l.method==="HEAD"&&!o[Lp]&&this.connection.toLowerCase()==="keep-alive",this.statusCode>=200){let f=l.bodyTimeout!=null?l.bodyTimeout:i[PZt];this.setTimeout(f,ite)}else this.timeout&&this.timeout.refresh&&this.timeout.refresh();if(l.method==="CONNECT")return Nn(i[$d]===1),this.upgrade=!0,2;if(r)return Nn(i[$d]===1),this.upgrade=!0,2;if(Nn((this.headers.length&1)===0),this.headers=[],this.headersSize=0,this.shouldKeepAlive&&i[nte]){let f=this.keepAlive?ui.parseKeepAliveTimeout(this.keepAlive):null;if(f!=null){let p=Math.min(f-i[RZt],i[_Zt]);p<=0?o[Lp]=!0:i[ste]=p}else i[ste]=i[TZt]}else o[Lp]=!0;let u=l.onHeaders(e,a,this.resume,c)===!1;return l.aborted?-1:l.method==="HEAD"||e<200?1:(o[tQ]&&(o[tQ]=!1,i[tw]()),u?t1.ERROR.PAUSED:0)}onBody(e){let{client:r,socket:n,statusCode:i,maxResponseSize:o}=this;if(n.destroyed)return-1;let a=r[QA][r[Qh]];if(Nn(a),Nn(this.timeoutType===ite),this.timeout&&this.timeout.refresh&&this.timeout.refresh(),Nn(i>=200),o>-1&&this.bytesRead+e.length>o)return ui.destroy(n,new bZt),-1;if(this.bytesRead+=e.length,a.onData(e)===!1)return t1.ERROR.PAUSED}onMessageComplete(){let{client:e,socket:r,statusCode:n,upgrade:i,headers:o,contentLength:a,bytesRead:c,shouldKeepAlive:l}=this;if(r.destroyed&&(!n||l))return-1;if(i)return;Nn(n>=100),Nn((this.headers.length&1)===0);let u=e[QA][e[Qh]];if(Nn(u),this.statusCode=null,this.statusText="",this.bytesRead=0,this.contentLength="",this.keepAlive="",this.connection="",this.headers=[],this.headersSize=0,!(n<200)){if(u.method!=="HEAD"&&a&&c!==parseInt(a,10))return ui.destroy(r,new yZt),-1;if(u.onComplete(o),e[QA][e[Qh]++]=null,r[rw])return Nn(e[$d]===0),ui.destroy(r,new lN("reset")),t1.ERROR.PAUSED;if(l){if(r[Lp]&&e[$d]===0)return ui.destroy(r,new lN("reset")),t1.ERROR.PAUSED;e[nte]==null||e[nte]===1?setImmediate(()=>e[tw]()):e[tw]()}else return ui.destroy(r,new lN("reset")),t1.ERROR.PAUSED}}};function Ptt(t){let{socket:e,timeoutType:r,client:n,paused:i}=t.deref();r===dN?(!e[rw]||e.writableNeedDrain||n[$d]>1)&&(Nn(!i,"cannot be paused while waiting for headers"),ui.destroy(e,new CZt)):r===ite?i||ui.destroy(e,new xZt):r===Bbe&&(Nn(n[$d]===0&&n[ste]),ui.destroy(e,new lN("socket idle timeout")))}s(Ptt,"onParserTimeout");async function QZt(t,e){t[uN]=e,Rbe||(Rbe=await Dbe,Dbe=null),e[Z7]=!1,e[rw]=!1,e[Lp]=!1,e[tQ]=!1,e[gc]=new Nbe(t,e,Rbe),tte(e,"error",function(n){Nn(n.code!=="ERR_TLS_CERT_ALTNAME_INVALID");let i=this[gc];if(n.code==="ECONNRESET"&&i.statusCode&&!i.shouldKeepAlive){i.onMessageComplete();return}this[Uh]=n,this[kbe][NZt](n)}),tte(e,"readable",function(){let n=this[gc];n&&n.readMore()}),tte(e,"end",function(){let n=this[gc];if(n.statusCode&&!n.shouldKeepAlive){n.onMessageComplete();return}ui.destroy(this,new ote("other side closed",ui.getSocketInfo(this)))}),tte(e,"close",function(){let n=this[kbe],i=this[gc];i&&(!this[Uh]&&i.statusCode&&!i.shouldKeepAlive&&i.onMessageComplete(),this[gc].destroy(),this[gc]=null);let o=this[Uh]||new ote("closed",ui.getSocketInfo(this));if(n[uN]=null,n[Ltt]=null,n.destroyed){Nn(n[IZt]===0);let a=n[QA].splice(n[Qh]);for(let c=0;c<a.length;c++){let l=a[c];ui.errorRequest(n,l,o)}}else if(n[$d]>0&&o.code!=="UND_ERR_INFO"){let a=n[QA][n[Qh]];n[QA][n[Qh]++]=null,ui.errorRequest(n,a,o)}n[SZt]=n[Qh],Nn(n[$d]===0),n.emit("disconnect",n[Mtt],[n],o),n[tw]()});let r=!1;return e.on("close",()=>{r=!0}),{version:"h1",defaultPipelining:1,write(...n){return HZt(t,...n)},resume(){UZt(t)},destroy(n,i){r?queueMicrotask(i):e.destroy(n).on("close",i)},get destroyed(){return e.destroyed},busy(n){return!!(e[rw]||e[Lp]||e[tQ]||n&&(t[$d]>0&&!n.idempotent||t[$d]>0&&(n.upgrade||n.method==="CONNECT")||t[$d]>0&&ui.bodyLength(n.body)!==0&&(ui.isStream(n.body)||ui.isAsyncIterable(n.body)||ui.isFormDataLike(n.body))))}}}s(QZt,"connectH1");function UZt(t){let e=t[uN];if(e&&!e.destroyed){if(t[Rtt]===0?!e[Z7]&&e.unref&&(e.unref(),e[Z7]=!0):e[Z7]&&e.ref&&(e.ref(),e[Z7]=!1),t[Rtt]===0)e[gc].timeoutType!==Bbe&&e[gc].setTimeout(t[ste],Bbe);else if(t[$d]>0&&e[gc].statusCode<200&&e[gc].timeoutType!==dN){let r=t[QA][t[Qh]],n=r.headersTimeout!=null?r.headersTimeout:t[kZt];e[gc].setTimeout(n,dN)}}}s(UZt,"resumeH1");function qZt(t){return t!=="GET"&&t!=="HEAD"&&t!=="OPTIONS"&&t!=="TRACE"&&t!=="CONNECT"}s(qZt,"shouldSendContentLength");function HZt(t,e){let{method:r,path:n,host:i,upgrade:o,blocking:a,reset:c}=e,{body:l,headers:u,contentLength:f}=e,p=r==="PUT"||r==="POST"||r==="PATCH"||r==="QUERY"||r==="PROPFIND"||r==="PROPPATCH";if(ui.isFormDataLike(l)){_be||(_be=cN().extractBody);let[y,E]=_be(l);e.contentType==null&&u.push("content-type",E),l=y.stream,f=y.length}else ui.isBlobLike(l)&&e.contentType==null&&l.type&&u.push("content-type",l.type);l&&typeof l.read=="function"&&l.read(0);let m=ui.bodyLength(l);if(f=m??f,f===null&&(f=e.contentLength),f===0&&!p&&(f=null),qZt(r)&&f>0&&e.contentLength!==null&&e.contentLength!==f){if(t[Pbe])return ui.errorRequest(t,e,new ok),!1;process.emitWarning(new ok)}let h=t[uN],g=s(y=>{e.aborted||e.completed||(ui.errorRequest(t,e,y||new Ntt),ui.destroy(l),ui.destroy(h,new lN("aborted")))},"abort");try{e.onConnect(g)}catch(y){ui.errorRequest(t,e,y)}if(e.aborted)return!1;r==="HEAD"&&(h[Lp]=!0),(o||r==="CONNECT")&&(h[Lp]=!0),c!=null&&(h[Lp]=c),t[ktt]&&h[DZt]++>=t[ktt]&&(h[Lp]=!0),a&&(h[tQ]=!0);let A=`${r} ${n} HTTP/1.1\r
`;if(typeof i=="string"?A+=`host: ${i}\r
`:A+=t[wZt],o?A+=`connection: upgrade\r
upgrade: ${o}\r
`:t[nte]&&!h[Lp]?A+=`connection: keep-alive\r
`:A+=`connection: close\r
`,Array.isArray(u))for(let y=0;y<u.length;y+=2){let E=u[y+0],b=u[y+1];if(Array.isArray(b))for(let S=0;S<b.length;S++)A+=`${E}: ${b[S]}\r
`;else A+=`${E}: ${b}\r
`}return _tt.sendHeaders.hasSubscribers&&_tt.sendHeaders.publish({request:e,headers:A,socket:h}),!l||m===0?Dtt(g,null,t,e,h,f,A,p):ui.isBuffer(l)?Dtt(g,l,t,e,h,f,A,p):ui.isBlobLike(l)?typeof l.stream=="function"?Btt(g,l.stream(),t,e,h,f,A,p):WZt(g,l,t,e,h,f,A,p):ui.isStream(l)?$Zt(g,l,t,e,h,f,A,p):ui.isIterable(l)?Btt(g,l,t,e,h,f,A,p):Nn(!1),!0}s(HZt,"writeH1");function $Zt(t,e,r,n,i,o,a,c){Nn(o!==0||r[$d]===0,"stream body cannot be pipelined");let l=!1,u=new ate({abort:t,socket:i,request:n,contentLength:o,client:r,expectsPayload:c,header:a}),f=s(function(g){if(!l)try{!u.write(g)&&this.pause&&this.pause()}catch(A){ui.destroy(this,A)}},"onData"),p=s(function(){l||e.resume&&e.resume()},"onDrain"),m=s(function(){if(queueMicrotask(()=>{e.removeListener("error",h)}),!l){let g=new Ntt;queueMicrotask(()=>h(g))}},"onClose"),h=s(function(g){if(!l){if(l=!0,Nn(i.destroyed||i[rw]&&r[$d]<=1),i.off("drain",p).off("error",h),e.removeListener("data",f).removeListener("end",h).removeListener("close",m),!g)try{u.end()}catch(A){g=A}u.destroy(g),g&&(g.code!=="UND_ERR_INFO"||g.message!=="reset")?ui.destroy(e,g):ui.destroy(e)}},"onFinished");e.on("data",f).on("end",h).on("error",h).on("close",m),e.resume&&e.resume(),i.on("drain",p).on("error",h),e.errorEmitted??e.errored?setImmediate(()=>h(e.errored)):(e.endEmitted??e.readableEnded)&&setImmediate(()=>h(null)),(e.closeEmitted??e.closed)&&setImmediate(m)}s($Zt,"writeStream");function Dtt(t,e,r,n,i,o,a,c){try{e?ui.isBuffer(e)&&(Nn(o===e.byteLength,"buffer body must have content length"),i.cork(),i.write(`${a}content-length: ${o}\r
\r
`,"latin1"),i.write(e),i.uncork(),n.onBodySent(e),!c&&n.reset!==!1&&(i[Lp]=!0)):o===0?i.write(`${a}content-length: 0\r
\r
`,"latin1"):(Nn(o===null,"no body must not have content length"),i.write(`${a}\r
`,"latin1")),n.onRequestSent(),r[tw]()}catch(l){t(l)}}s(Dtt,"writeBuffer");async function WZt(t,e,r,n,i,o,a,c){Nn(o===e.size,"blob body must have content length");try{if(o!=null&&o!==e.size)throw new ok;let l=Buffer.from(await e.arrayBuffer());i.cork(),i.write(`${a}content-length: ${o}\r
\r
`,"latin1"),i.write(l),i.uncork(),n.onBodySent(l),n.onRequestSent(),!c&&n.reset!==!1&&(i[Lp]=!0),r[tw]()}catch(l){t(l)}}s(WZt,"writeBlob");async function Btt(t,e,r,n,i,o,a,c){Nn(o!==0||r[$d]===0,"iterator body cannot be pipelined");let l=null;function u(){if(l){let m=l;l=null,m()}}s(u,"onDrain");let f=s(()=>new Promise((m,h)=>{Nn(l===null),i[Uh]?h(i[Uh]):l=m}),"waitForDrain");i.on("close",u).on("drain",u);let p=new ate({abort:t,socket:i,request:n,contentLength:o,client:r,expectsPayload:c,header:a});try{for await(let m of e){if(i[Uh])throw i[Uh];p.write(m)||await f()}p.end()}catch(m){p.destroy(m)}finally{i.off("close",u).off("drain",u)}}s(Btt,"writeIterable");var ate=class{static{s(this,"AsyncWriter")}constructor({abort:e,socket:r,request:n,contentLength:i,client:o,expectsPayload:a,header:c}){this.socket=r,this.request=n,this.contentLength=i,this.client=o,this.bytesWritten=0,this.expectsPayload=a,this.header=c,this.abort=e,r[rw]=!0}write(e){let{socket:r,request:n,contentLength:i,client:o,bytesWritten:a,expectsPayload:c,header:l}=this;if(r[Uh])throw r[Uh];if(r.destroyed)return!1;let u=Buffer.byteLength(e);if(!u)return!0;if(i!==null&&a+u>i){if(o[Pbe])throw new ok;process.emitWarning(new ok)}r.cork(),a===0&&(!c&&n.reset!==!1&&(r[Lp]=!0),i===null?r.write(`${l}transfer-encoding: chunked\r
`,"latin1"):r.write(`${l}content-length: ${i}\r
\r
`,"latin1")),i===null&&r.write(`\r
${u.toString(16)}\r
`,"latin1"),this.bytesWritten+=u;let f=r.write(e);return r.uncork(),n.onBodySent(e),f||r[gc].timeout&&r[gc].timeoutType===dN&&r[gc].timeout.refresh&&r[gc].timeout.refresh(),f}end(){let{socket:e,contentLength:r,client:n,bytesWritten:i,expectsPayload:o,header:a,request:c}=this;if(c.onRequestSent(),e[rw]=!1,e[Uh])throw e[Uh];if(!e.destroyed){if(i===0?o?e.write(`${a}content-length: 0\r
\r
`,"latin1"):e.write(`${a}\r
`,"latin1"):r===null&&e.write(`\r
0\r
\r
`,"latin1"),r!==null&&i!==r){if(n[Pbe])throw new ok;process.emitWarning(new ok)}e[gc].timeout&&e[gc].timeoutType===dN&&e[gc].timeout.refresh&&e[gc].timeout.refresh(),n[tw]()}}destroy(e){let{socket:r,client:n,abort:i}=this;r[rw]=!1,e&&(Nn(n[$d]<=1,"pipeline should only contain this request"),i(e))}};Ftt.exports=QZt});var Gtt=H((Rpi,jtt)=>{"use strict";d();var qh=require("node:assert"),{pipeline:jZt}=require("node:stream"),po=$i(),{RequestContentLengthMismatchError:Mbe,RequestAbortedError:Qtt,SocketError:rQ,InformationalError:Lbe}=Jo(),{kUrl:cte,kReset:ute,kClient:fN,kRunning:dte,kPending:GZt,kQueue:nw,kPendingIdx:Fbe,kRunningIdx:UA,kError:HA,kSocket:gu,kStrictContentLength:VZt,kOnError:Obe,kMaxConcurrentStreams:Wtt,kHTTP2Session:qA,kResume:iw,kSize:zZt,kHTTPContext:KZt}=La(),Wx=Symbol("open streams"),Utt,qtt=!1,lte;try{lte=require("node:http2")}catch{lte={constants:{}}}var{constants:{HTTP2_HEADER_AUTHORITY:YZt,HTTP2_HEADER_METHOD:JZt,HTTP2_HEADER_PATH:XZt,HTTP2_HEADER_SCHEME:ZZt,HTTP2_HEADER_CONTENT_LENGTH:eer,HTTP2_HEADER_EXPECT:ter,HTTP2_HEADER_STATUS:rer}}=lte;function ner(t){let e=[];for(let[r,n]of Object.entries(t))if(Array.isArray(n))for(let i of n)e.push(Buffer.from(r),Buffer.from(i));else e.push(Buffer.from(r),Buffer.from(n));return e}s(ner,"parseH2Headers");async function ier(t,e){t[gu]=e,qtt||(qtt=!0,process.emitWarning("H2 support is experimental, expect them to change at any time.",{code:"UNDICI-H2"}));let r=lte.connect(t[cte],{createConnection:s(()=>e,"createConnection"),peerMaxConcurrentStreams:t[Wtt]});r[Wx]=0,r[fN]=t,r[gu]=e,po.addListener(r,"error",ser),po.addListener(r,"frameError",aer),po.addListener(r,"end",cer),po.addListener(r,"goaway",ler),po.addListener(r,"close",function(){let{[fN]:i}=this,{[gu]:o}=i,a=this[gu][HA]||this[HA]||new rQ("closed",po.getSocketInfo(o));if(i[qA]=null,i.destroyed){qh(i[GZt]===0);let c=i[nw].splice(i[UA]);for(let l=0;l<c.length;l++){let u=c[l];po.errorRequest(i,u,a)}}}),r.unref(),t[qA]=r,e[qA]=r,po.addListener(e,"error",function(i){qh(i.code!=="ERR_TLS_CERT_ALTNAME_INVALID"),this[HA]=i,this[fN][Obe](i)}),po.addListener(e,"end",function(){po.destroy(this,new rQ("other side closed",po.getSocketInfo(this)))}),po.addListener(e,"close",function(){let i=this[HA]||new rQ("closed",po.getSocketInfo(this));t[gu]=null,this[qA]!=null&&this[qA].destroy(i),t[Fbe]=t[UA],qh(t[dte]===0),t.emit("disconnect",t[cte],[t],i),t[iw]()});let n=!1;return e.on("close",()=>{n=!0}),{version:"h2",defaultPipelining:1/0,write(...i){return der(t,...i)},resume(){oer(t)},destroy(i,o){n?queueMicrotask(o):e.destroy(i).on("close",o)},get destroyed(){return e.destroyed},busy(){return!1}}}s(ier,"connectH2");function oer(t){let e=t[gu];e?.destroyed===!1&&(t[zZt]===0&&t[Wtt]===0?(e.unref(),t[qA].unref()):(e.ref(),t[qA].ref()))}s(oer,"resumeH2");function ser(t){qh(t.code!=="ERR_TLS_CERT_ALTNAME_INVALID"),this[gu][HA]=t,this[fN][Obe](t)}s(ser,"onHttp2SessionError");function aer(t,e,r){if(r===0){let n=new Lbe(`HTTP/2: "frameError" received - type ${t}, code ${e}`);this[gu][HA]=n,this[fN][Obe](n)}}s(aer,"onHttp2FrameError");function cer(){let t=new rQ("other side closed",po.getSocketInfo(this[gu]));this.destroy(t),po.destroy(this[gu],t)}s(cer,"onHttp2SessionEnd");function ler(t){let e=this[HA]||new rQ(`HTTP/2: "GOAWAY" frame received with code ${t}`,po.getSocketInfo(this)),r=this[fN];if(r[gu]=null,r[KZt]=null,this[qA]!=null&&(this[qA].destroy(e),this[qA]=null),po.destroy(this[gu],e),r[UA]<r[nw].length){let n=r[nw][r[UA]];r[nw][r[UA]++]=null,po.errorRequest(r,n,e),r[Fbe]=r[UA]}qh(r[dte]===0),r.emit("disconnect",r[cte],[r],e),r[iw]()}s(ler,"onHTTP2GoAway");function uer(t){return t!=="GET"&&t!=="HEAD"&&t!=="OPTIONS"&&t!=="TRACE"&&t!=="CONNECT"}s(uer,"shouldSendContentLength");function der(t,e){let r=t[qA],{method:n,path:i,host:o,upgrade:a,expectContinue:c,signal:l,headers:u}=e,{body:f}=e;if(a)return po.errorRequest(t,e,new Error("Upgrade not supported for H2")),!1;let p={};for(let R=0;R<u.length;R+=2){let B=u[R+0],L=u[R+1];if(Array.isArray(L))for(let O=0;O<L.length;O++)p[B]?p[B]+=`,${L[O]}`:p[B]=L[O];else p[B]=L}let m,{hostname:h,port:g}=t[cte];p[YZt]=o||`${h}${g?`:${g}`:""}`,p[JZt]=n;let A=s(R=>{e.aborted||e.completed||(R=R||new Qtt,po.errorRequest(t,e,R),m!=null&&po.destroy(m,R),po.destroy(f,R),t[nw][t[UA]++]=null,t[iw]())},"abort");try{e.onConnect(A)}catch(R){po.errorRequest(t,e,R)}if(e.aborted)return!1;if(n==="CONNECT")return r.ref(),m=r.request(p,{endStream:!1,signal:l}),m.id&&!m.pending?(e.onUpgrade(null,null,m),++r[Wx],t[nw][t[UA]++]=null):m.once("ready",()=>{e.onUpgrade(null,null,m),++r[Wx],t[nw][t[UA]++]=null}),m.once("close",()=>{r[Wx]-=1,r[Wx]===0&&r.unref()}),!0;p[XZt]=i,p[ZZt]="https";let y=n==="PUT"||n==="POST"||n==="PATCH";f&&typeof f.read=="function"&&f.read(0);let E=po.bodyLength(f);if(po.isFormDataLike(f)){Utt??=cN().extractBody;let[R,B]=Utt(f);p["content-type"]=B,f=R.stream,E=R.length}if(E==null&&(E=e.contentLength),(E===0||!y)&&(E=null),uer(n)&&E>0&&e.contentLength!=null&&e.contentLength!==E){if(t[VZt])return po.errorRequest(t,e,new Mbe),!1;process.emitWarning(new Mbe)}E!=null&&(qh(f,"no body must not have content length"),p[eer]=`${E}`),r.ref();let b=n==="GET"||n==="HEAD"||f===null;return c?(p[ter]="100-continue",m=r.request(p,{endStream:b,signal:l}),m.once("continue",S)):(m=r.request(p,{endStream:b,signal:l}),S()),++r[Wx],m.once("response",R=>{let{[rer]:B,...L}=R;if(e.onResponseStarted(),e.aborted){let O=new Qtt;po.errorRequest(t,e,O),po.destroy(m,O);return}e.onHeaders(Number(B),ner(L),m.resume.bind(m),"")===!1&&m.pause(),m.on("data",O=>{e.onData(O)===!1&&m.pause()})}),m.once("end",()=>{(m.state?.state==null||m.state.state<6)&&e.onComplete([]),r[Wx]===0&&r.unref(),A(new Lbe("HTTP/2: stream half-closed (remote)")),t[nw][t[UA]++]=null,t[Fbe]=t[UA],t[iw]()}),m.once("close",()=>{r[Wx]-=1,r[Wx]===0&&r.unref()}),m.once("error",function(R){A(R)}),m.once("frameError",(R,B)=>{A(new Lbe(`HTTP/2: "frameError" received - type ${R}, code ${B}`))}),!0;function S(){!f||E===0?Htt(A,m,null,t,e,t[gu],E,y):po.isBuffer(f)?Htt(A,m,f,t,e,t[gu],E,y):po.isBlobLike(f)?typeof f.stream=="function"?$tt(A,m,f.stream(),t,e,t[gu],E,y):per(A,m,f,t,e,t[gu],E,y):po.isStream(f)?fer(A,t[gu],y,m,f,t,e,E):po.isIterable(f)?$tt(A,m,f,t,e,t[gu],E,y):qh(!1)}s(S,"writeBodyH2")}s(der,"writeH2");function Htt(t,e,r,n,i,o,a,c){try{r!=null&&po.isBuffer(r)&&(qh(a===r.byteLength,"buffer body must have content length"),e.cork(),e.write(r),e.uncork(),e.end(),i.onBodySent(r)),c||(o[ute]=!0),i.onRequestSent(),n[iw]()}catch(l){t(l)}}s(Htt,"writeBuffer");function fer(t,e,r,n,i,o,a,c){qh(c!==0||o[dte]===0,"stream body cannot be pipelined");let l=jZt(i,n,f=>{f?(po.destroy(l,f),t(f)):(po.removeAllListeners(l),a.onRequestSent(),r||(e[ute]=!0),o[iw]())});po.addListener(l,"data",u);function u(f){a.onBodySent(f)}s(u,"onPipeData")}s(fer,"writeStream");async function per(t,e,r,n,i,o,a,c){qh(a===r.size,"blob body must have content length");try{if(a!=null&&a!==r.size)throw new Mbe;let l=Buffer.from(await r.arrayBuffer());e.cork(),e.write(l),e.uncork(),e.end(),i.onBodySent(l),i.onRequestSent(),c||(o[ute]=!0),n[iw]()}catch(l){t(l)}}s(per,"writeBlob");async function $tt(t,e,r,n,i,o,a,c){qh(a!==0||n[dte]===0,"iterator body cannot be pipelined");let l=null;function u(){if(l){let p=l;l=null,p()}}s(u,"onDrain");let f=s(()=>new Promise((p,m)=>{qh(l===null),o[HA]?m(o[HA]):l=p}),"waitForDrain");e.on("close",u).on("drain",u);try{for await(let p of r){if(o[HA])throw o[HA];let m=e.write(p);i.onBodySent(p),m||await f()}e.end(),i.onRequestSent(),c||(o[ute]=!0),n[iw]()}catch(p){t(p)}finally{e.off("close",u).off("drain",u)}}s($tt,"writeIterable");jtt.exports=ier});var pte=H((Dpi,Ktt)=>{"use strict";d();var i1=$i(),{kBodyUsed:nQ}=La(),Ube=require("node:assert"),{InvalidArgumentError:mer}=Jo(),her=require("node:events"),ger=[300,301,302,303,307,308],Vtt=Symbol("body"),fte=class{static{s(this,"BodyAsyncIterable")}constructor(e){this[Vtt]=e,this[nQ]=!1}async*[Symbol.asyncIterator](){Ube(!this[nQ],"disturbed"),this[nQ]=!0,yield*this[Vtt]}},Qbe=class{static{s(this,"RedirectHandler")}constructor(e,r,n,i){if(r!=null&&(!Number.isInteger(r)||r<0))throw new mer("maxRedirections must be a positive number");i1.validateHandler(i,n.method,n.upgrade),this.dispatch=e,this.location=null,this.abort=null,this.opts={...n,maxRedirections:0},this.maxRedirections=r,this.handler=i,this.history=[],this.redirectionLimitReached=!1,i1.isStream(this.opts.body)?(i1.bodyLength(this.opts.body)===0&&this.opts.body.on("data",function(){Ube(!1)}),typeof this.opts.body.readableDidRead!="boolean"&&(this.opts.body[nQ]=!1,her.prototype.on.call(this.opts.body,"data",function(){this[nQ]=!0}))):this.opts.body&&typeof this.opts.body.pipeTo=="function"?this.opts.body=new fte(this.opts.body):this.opts.body&&typeof this.opts.body!="string"&&!ArrayBuffer.isView(this.opts.body)&&i1.isIterable(this.opts.body)&&(this.opts.body=new fte(this.opts.body))}onConnect(e){this.abort=e,this.handler.onConnect(e,{history:this.history})}onUpgrade(e,r,n){this.handler.onUpgrade(e,r,n)}onError(e){this.handler.onError(e)}onHeaders(e,r,n,i){if(this.location=this.history.length>=this.maxRedirections||i1.isDisturbed(this.opts.body)?null:Aer(e,r),this.opts.throwOnMaxRedirect&&this.history.length>=this.maxRedirections){this.request&&this.request.abort(new Error("max redirects")),this.redirectionLimitReached=!0,this.abort(new Error("max redirects"));return}if(this.opts.origin&&this.history.push(new URL(this.opts.path,this.opts.origin)),!this.location)return this.handler.onHeaders(e,r,n,i);let{origin:o,pathname:a,search:c}=i1.parseURL(new URL(this.location,this.opts.origin&&new URL(this.opts.path,this.opts.origin))),l=c?`${a}${c}`:a;this.opts.headers=yer(this.opts.headers,e===303,this.opts.origin!==o),this.opts.path=l,this.opts.origin=o,this.opts.maxRedirections=0,this.opts.query=null,e===303&&this.opts.method!=="HEAD"&&(this.opts.method="GET",this.opts.body=null)}onData(e){if(!this.location)return this.handler.onData(e)}onComplete(e){this.location?(this.location=null,this.abort=null,this.dispatch(this.opts,this)):this.handler.onComplete(e)}onBodySent(e){this.handler.onBodySent&&this.handler.onBodySent(e)}};function Aer(t,e){if(ger.indexOf(t)===-1)return null;for(let r=0;r<e.length;r+=2)if(e[r].length===8&&i1.headerNameToString(e[r])==="location")return e[r+1]}s(Aer,"parseLocation");function ztt(t,e,r){if(t.length===4)return i1.headerNameToString(t)==="host";if(e&&i1.headerNameToString(t).startsWith("content-"))return!0;if(r&&(t.length===13||t.length===6||t.length===19)){let n=i1.headerNameToString(t);return n==="authorization"||n==="cookie"||n==="proxy-authorization"}return!1}s(ztt,"shouldRemoveHeader");function yer(t,e,r){let n=[];if(Array.isArray(t))for(let i=0;i<t.length;i+=2)ztt(t[i],e,r)||n.push(t[i],t[i+1]);else if(t&&typeof t=="object")for(let i of Object.keys(t))ztt(i,e,r)||n.push(i,t[i]);else Ube(t==null,"headers must be an object or an array");return n}s(yer,"cleanRequestHeaders");Ktt.exports=Qbe});var mte=H((Mpi,Ytt)=>{"use strict";d();var Cer=pte();function ver({maxRedirections:t}){return e=>s(function(n,i){let{maxRedirections:o=t}=n;if(!o)return e(n,i);let a=new Cer(e,o,n,i);return n={...n,maxRedirections:0},e(n,a)},"Intercept")}s(ver,"createRedirectInterceptor");Ytt.exports=ver});var uQ=H((Opi,srt)=>{"use strict";d();var jx=require("node:assert"),rrt=require("node:net"),xer=require("node:http"),sk=$i(),{channels:pN}=K3(),Eer=fet(),ber=Z3(),{InvalidArgumentError:$c,InformationalError:Ier,ClientDestroyedError:Ter}=Jo(),wer=W7(),{kUrl:o1,kServerName:ow,kClient:Ser,kBusy:qbe,kConnect:_er,kResuming:ak,kRunning:cQ,kPending:lQ,kSize:aQ,kQueue:$A,kConnected:Rer,kConnecting:mN,kNeedDrain:aw,kKeepAliveDefaultTimeout:Jtt,kHostHeader:ker,kPendingIdx:WA,kRunningIdx:Gx,kError:Per,kPipelining:hte,kKeepAliveTimeoutValue:Der,kMaxHeadersSize:Ber,kKeepAliveMaxTimeout:Ner,kKeepAliveTimeoutThreshold:Mer,kHeadersTimeout:Ler,kBodyTimeout:Fer,kStrictContentLength:Oer,kConnector:iQ,kMaxRedirections:Qer,kMaxRequests:Hbe,kCounter:Uer,kClose:qer,kDestroy:Her,kDispatch:$er,kInterceptors:Xtt,kLocalAddress:oQ,kMaxResponseSize:Wer,kOnError:jer,kHTTPContext:Wc,kMaxConcurrentStreams:Ger,kResume:sQ}=La(),Ver=Ott(),zer=Gtt(),Ztt=!1,sw=Symbol("kClosedResolve"),ert=s(()=>{},"noop");function nrt(t){return t[hte]??t[Wc]?.defaultPipelining??1}s(nrt,"getPipelining");var $be=class extends ber{static{s(this,"Client")}constructor(e,{interceptors:r,maxHeaderSize:n,headersTimeout:i,socketTimeout:o,requestTimeout:a,connectTimeout:c,bodyTimeout:l,idleTimeout:u,keepAlive:f,keepAliveTimeout:p,maxKeepAliveTimeout:m,keepAliveMaxTimeout:h,keepAliveTimeoutThreshold:g,socketPath:A,pipelining:y,tls:E,strictContentLength:b,maxCachedSessions:S,maxRedirections:R,connect:B,maxRequestsPerClient:L,localAddress:O,maxResponseSize:Y,autoSelectFamily:V,autoSelectFamilyAttemptTimeout:z,maxConcurrentStreams:Q,allowH2:U}={}){if(super(),f!==void 0)throw new $c("unsupported keepAlive, use pipelining=0 instead");if(o!==void 0)throw new $c("unsupported socketTimeout, use headersTimeout & bodyTimeout instead");if(a!==void 0)throw new $c("unsupported requestTimeout, use headersTimeout & bodyTimeout instead");if(u!==void 0)throw new $c("unsupported idleTimeout, use keepAliveTimeout instead");if(m!==void 0)throw new $c("unsupported maxKeepAliveTimeout, use keepAliveMaxTimeout instead");if(n!=null&&!Number.isFinite(n))throw new $c("invalid maxHeaderSize");if(A!=null&&typeof A!="string")throw new $c("invalid socketPath");if(c!=null&&(!Number.isFinite(c)||c<0))throw new $c("invalid connectTimeout");if(p!=null&&(!Number.isFinite(p)||p<=0))throw new $c("invalid keepAliveTimeout");if(h!=null&&(!Number.isFinite(h)||h<=0))throw new $c("invalid keepAliveMaxTimeout");if(g!=null&&!Number.isFinite(g))throw new $c("invalid keepAliveTimeoutThreshold");if(i!=null&&(!Number.isInteger(i)||i<0))throw new $c("headersTimeout must be a positive integer or zero");if(l!=null&&(!Number.isInteger(l)||l<0))throw new $c("bodyTimeout must be a positive integer or zero");if(B!=null&&typeof B!="function"&&typeof B!="object")throw new $c("connect must be a function or an object");if(R!=null&&(!Number.isInteger(R)||R<0))throw new $c("maxRedirections must be a positive number");if(L!=null&&(!Number.isInteger(L)||L<0))throw new $c("maxRequestsPerClient must be a positive number");if(O!=null&&(typeof O!="string"||rrt.isIP(O)===0))throw new $c("localAddress must be valid string IP address");if(Y!=null&&(!Number.isInteger(Y)||Y<-1))throw new $c("maxResponseSize must be a positive number");if(z!=null&&(!Number.isInteger(z)||z<-1))throw new $c("autoSelectFamilyAttemptTimeout must be a positive number");if(U!=null&&typeof U!="boolean")throw new $c("allowH2 must be a valid boolean value");if(Q!=null&&(typeof Q!="number"||Q<1))throw new $c("maxConcurrentStreams must be a positive integer, greater than 0");typeof B!="function"&&(B=wer({...E,maxCachedSessions:S,allowH2:U,socketPath:A,timeout:c,...V?{autoSelectFamily:V,autoSelectFamilyAttemptTimeout:z}:void 0,...B})),r?.Client&&Array.isArray(r.Client)?(this[Xtt]=r.Client,Ztt||(Ztt=!0,process.emitWarning("Client.Options#interceptor is deprecated. Use Dispatcher#compose instead.",{code:"UNDICI-CLIENT-INTERCEPTOR-DEPRECATED"}))):this[Xtt]=[Ker({maxRedirections:R})],this[o1]=sk.parseOrigin(e),this[iQ]=B,this[hte]=y??1,this[Ber]=n||xer.maxHeaderSize,this[Jtt]=p??4e3,this[Ner]=h??6e5,this[Mer]=g??2e3,this[Der]=this[Jtt],this[ow]=null,this[oQ]=O??null,this[ak]=0,this[aw]=0,this[ker]=`host: ${this[o1].hostname}${this[o1].port?`:${this[o1].port}`:""}\r
`,this[Fer]=l??3e5,this[Ler]=i??3e5,this[Oer]=b??!0,this[Qer]=R,this[Hbe]=L,this[sw]=null,this[Wer]=Y>-1?Y:-1,this[Ger]=Q??100,this[Wc]=null,this[$A]=[],this[Gx]=0,this[WA]=0,this[sQ]=Z=>Wbe(this,Z),this[jer]=Z=>irt(this,Z)}get pipelining(){return this[hte]}set pipelining(e){this[hte]=e,this[sQ](!0)}get[lQ](){return this[$A].length-this[WA]}get[cQ](){return this[WA]-this[Gx]}get[aQ](){return this[$A].length-this[Gx]}get[Rer](){return!!this[Wc]&&!this[mN]&&!this[Wc].destroyed}get[qbe](){return!!(this[Wc]?.busy(null)||this[aQ]>=(nrt(this)||1)||this[lQ]>0)}[_er](e){ort(this),this.once("connect",e)}[$er](e,r){let n=e.origin||this[o1].origin,i=new Eer(n,e,r);return this[$A].push(i),this[ak]||(sk.bodyLength(i.body)==null&&sk.isIterable(i.body)?(this[ak]=1,queueMicrotask(()=>Wbe(this))):this[sQ](!0)),this[ak]&&this[aw]!==2&&this[qbe]&&(this[aw]=2),this[aw]<2}async[qer](){return new Promise(e=>{this[aQ]?this[sw]=e:e(null)})}async[Her](e){return new Promise(r=>{let n=this[$A].splice(this[WA]);for(let o=0;o<n.length;o++){let a=n[o];sk.errorRequest(this,a,e)}let i=s(()=>{this[sw]&&(this[sw](),this[sw]=null),r(null)},"callback");this[Wc]?(this[Wc].destroy(e,i),this[Wc]=null):queueMicrotask(i),this[sQ]()})}},Ker=mte();function irt(t,e){if(t[cQ]===0&&e.code!=="UND_ERR_INFO"&&e.code!=="UND_ERR_SOCKET"){jx(t[WA]===t[Gx]);let r=t[$A].splice(t[Gx]);for(let n=0;n<r.length;n++){let i=r[n];sk.errorRequest(t,i,e)}jx(t[aQ]===0)}}s(irt,"onError");async function ort(t){jx(!t[mN]),jx(!t[Wc]);let{host:e,hostname:r,protocol:n,port:i}=t[o1];if(r[0]==="["){let o=r.indexOf("]");jx(o!==-1);let a=r.substring(1,o);jx(rrt.isIP(a)),r=a}t[mN]=!0,pN.beforeConnect.hasSubscribers&&pN.beforeConnect.publish({connectParams:{host:e,hostname:r,protocol:n,port:i,version:t[Wc]?.version,servername:t[ow],localAddress:t[oQ]},connector:t[iQ]});try{let o=await new Promise((a,c)=>{t[iQ]({host:e,hostname:r,protocol:n,port:i,servername:t[ow],localAddress:t[oQ]},(l,u)=>{l?c(l):a(u)})});if(t.destroyed){sk.destroy(o.on("error",ert),new Ter);return}jx(o);try{t[Wc]=o.alpnProtocol==="h2"?await zer(t,o):await Ver(t,o)}catch(a){throw o.destroy().on("error",ert),a}t[mN]=!1,o[Uer]=0,o[Hbe]=t[Hbe],o[Ser]=t,o[Per]=null,pN.connected.hasSubscribers&&pN.connected.publish({connectParams:{host:e,hostname:r,protocol:n,port:i,version:t[Wc]?.version,servername:t[ow],localAddress:t[oQ]},connector:t[iQ],socket:o}),t.emit("connect",t[o1],[t])}catch(o){if(t.destroyed)return;if(t[mN]=!1,pN.connectError.hasSubscribers&&pN.connectError.publish({connectParams:{host:e,hostname:r,protocol:n,port:i,version:t[Wc]?.version,servername:t[ow],localAddress:t[oQ]},connector:t[iQ],error:o}),o.code==="ERR_TLS_CERT_ALTNAME_INVALID")for(jx(t[cQ]===0);t[lQ]>0&&t[$A][t[WA]].servername===t[ow];){let a=t[$A][t[WA]++];sk.errorRequest(t,a,o)}else irt(t,o);t.emit("connectionError",t[o1],[t],o)}t[sQ]()}s(ort,"connect");function trt(t){t[aw]=0,t.emit("drain",t[o1],[t])}s(trt,"emitDrain");function Wbe(t,e){t[ak]!==2&&(t[ak]=2,Yer(t,e),t[ak]=0,t[Gx]>256&&(t[$A].splice(0,t[Gx]),t[WA]-=t[Gx],t[Gx]=0))}s(Wbe,"resume");function Yer(t,e){for(;;){if(t.destroyed){jx(t[lQ]===0);return}if(t[sw]&&!t[aQ]){t[sw](),t[sw]=null;return}if(t[Wc]&&t[Wc].resume(),t[qbe])t[aw]=2;else if(t[aw]===2){e?(t[aw]=1,queueMicrotask(()=>trt(t))):trt(t);continue}if(t[lQ]===0||t[cQ]>=(nrt(t)||1))return;let r=t[$A][t[WA]];if(t[o1].protocol==="https:"&&t[ow]!==r.servername){if(t[cQ]>0)return;t[ow]=r.servername,t[Wc]?.destroy(new Ier("servername changed"),()=>{t[Wc]=null,Wbe(t)})}if(t[mN])return;if(!t[Wc]){ort(t);return}if(t[Wc].destroyed||t[Wc].busy(r))return;!r.aborted&&t[Wc].write(r)?t[WA]++:t[$A].splice(t[WA],1)}}s(Yer,"_resume");srt.exports=$be});var jbe=H((Hpi,art)=>{"use strict";d();var gte=class{static{s(this,"FixedCircularBuffer")}constructor(){this.bottom=0,this.top=0,this.list=new Array(2048),this.next=null}isEmpty(){return this.top===this.bottom}isFull(){return(this.top+1&2047)===this.bottom}push(e){this.list[this.top]=e,this.top=this.top+1&2047}shift(){let e=this.list[this.bottom];return e===void 0?null:(this.list[this.bottom]=void 0,this.bottom=this.bottom+1&2047,e)}};art.exports=class{static{s(this,"FixedQueue")}constructor(){this.head=this.tail=new gte}isEmpty(){return this.head.isEmpty()}push(e){this.head.isFull()&&(this.head=this.head.next=new gte),this.head.push(e)}shift(){let e=this.tail,r=e.shift();return e.isEmpty()&&e.next!==null&&(this.tail=e.next),r}}});var lrt=H((jpi,crt)=>{d();var{kFree:Jer,kConnected:Xer,kPending:Zer,kQueued:etr,kRunning:ttr,kSize:rtr}=La(),ck=Symbol("pool"),Gbe=class{static{s(this,"PoolStats")}constructor(e){this[ck]=e}get connected(){return this[ck][Xer]}get free(){return this[ck][Jer]}get pending(){return this[ck][Zer]}get queued(){return this[ck][etr]}get running(){return this[ck][ttr]}get size(){return this[ck][rtr]}};crt.exports=Gbe});var Xbe=H((zpi,Crt)=>{"use strict";d();var ntr=Z3(),itr=jbe(),{kConnected:Vbe,kSize:urt,kRunning:drt,kPending:frt,kQueued:dQ,kBusy:otr,kFree:str,kUrl:atr,kClose:ctr,kDestroy:ltr,kDispatch:utr}=La(),dtr=lrt(),Fp=Symbol("clients"),Mf=Symbol("needDrain"),fQ=Symbol("queue"),zbe=Symbol("closed resolve"),Kbe=Symbol("onDrain"),prt=Symbol("onConnect"),mrt=Symbol("onDisconnect"),hrt=Symbol("onConnectionError"),Ybe=Symbol("get dispatcher"),Art=Symbol("add client"),yrt=Symbol("remove client"),grt=Symbol("stats"),Jbe=class extends ntr{static{s(this,"PoolBase")}constructor(){super(),this[fQ]=new itr,this[Fp]=[],this[dQ]=0;let e=this;this[Kbe]=s(function(n,i){let o=e[fQ],a=!1;for(;!a;){let c=o.shift();if(!c)break;e[dQ]--,a=!this.dispatch(c.opts,c.handler)}this[Mf]=a,!this[Mf]&&e[Mf]&&(e[Mf]=!1,e.emit("drain",n,[e,...i])),e[zbe]&&o.isEmpty()&&Promise.all(e[Fp].map(c=>c.close())).then(e[zbe])},"onDrain"),this[prt]=(r,n)=>{e.emit("connect",r,[e,...n])},this[mrt]=(r,n,i)=>{e.emit("disconnect",r,[e,...n],i)},this[hrt]=(r,n,i)=>{e.emit("connectionError",r,[e,...n],i)},this[grt]=new dtr(this)}get[otr](){return this[Mf]}get[Vbe](){return this[Fp].filter(e=>e[Vbe]).length}get[str](){return this[Fp].filter(e=>e[Vbe]&&!e[Mf]).length}get[frt](){let e=this[dQ];for(let{[frt]:r}of this[Fp])e+=r;return e}get[drt](){let e=0;for(let{[drt]:r}of this[Fp])e+=r;return e}get[urt](){let e=this[dQ];for(let{[urt]:r}of this[Fp])e+=r;return e}get stats(){return this[grt]}async[ctr](){this[fQ].isEmpty()?await Promise.all(this[Fp].map(e=>e.close())):await new Promise(e=>{this[zbe]=e})}async[ltr](e){for(;;){let r=this[fQ].shift();if(!r)break;r.handler.onError(e)}await Promise.all(this[Fp].map(r=>r.destroy(e)))}[utr](e,r){let n=this[Ybe]();return n?n.dispatch(e,r)||(n[Mf]=!0,this[Mf]=!this[Ybe]()):(this[Mf]=!0,this[fQ].push({opts:e,handler:r}),this[dQ]++),!this[Mf]}[Art](e){return e.on("drain",this[Kbe]).on("connect",this[prt]).on("disconnect",this[mrt]).on("connectionError",this[hrt]),this[Fp].push(e),this[Mf]&&queueMicrotask(()=>{this[Mf]&&this[Kbe](e[atr],[this,e])}),this}[yrt](e){e.close(()=>{let r=this[Fp].indexOf(e);r!==-1&&this[Fp].splice(r,1)}),this[Mf]=this[Fp].some(r=>!r[Mf]&&r.closed!==!0&&r.destroyed!==!0)}};Crt.exports={PoolBase:Jbe,kClients:Fp,kNeedDrain:Mf,kAddClient:Art,kRemoveClient:yrt,kGetDispatcher:Ybe}});var hN=H((Jpi,brt)=>{"use strict";d();var{PoolBase:ftr,kClients:Ate,kNeedDrain:ptr,kAddClient:mtr,kGetDispatcher:htr}=Xbe(),gtr=uQ(),{InvalidArgumentError:Zbe}=Jo(),vrt=$i(),{kUrl:xrt,kInterceptors:Atr}=La(),ytr=W7(),eIe=Symbol("options"),tIe=Symbol("connections"),Ert=Symbol("factory");function Ctr(t,e){return new gtr(t,e)}s(Ctr,"defaultFactory");var rIe=class extends ftr{static{s(this,"Pool")}constructor(e,{connections:r,factory:n=Ctr,connect:i,connectTimeout:o,tls:a,maxCachedSessions:c,socketPath:l,autoSelectFamily:u,autoSelectFamilyAttemptTimeout:f,allowH2:p,...m}={}){if(super(),r!=null&&(!Number.isFinite(r)||r<0))throw new Zbe("invalid connections");if(typeof n!="function")throw new Zbe("factory must be a function.");if(i!=null&&typeof i!="function"&&typeof i!="object")throw new Zbe("connect must be a function or an object");typeof i!="function"&&(i=ytr({...a,maxCachedSessions:c,allowH2:p,socketPath:l,timeout:o,...u?{autoSelectFamily:u,autoSelectFamilyAttemptTimeout:f}:void 0,...i})),this[Atr]=m.interceptors?.Pool&&Array.isArray(m.interceptors.Pool)?m.interceptors.Pool:[],this[tIe]=r||null,this[xrt]=vrt.parseOrigin(e),this[eIe]={...vrt.deepClone(m),connect:i,allowH2:p},this[eIe].interceptors=m.interceptors?{...m.interceptors}:void 0,this[Ert]=n,this.on("connectionError",(h,g,A)=>{for(let y of g){let E=this[Ate].indexOf(y);E!==-1&&this[Ate].splice(E,1)}})}[htr](){for(let e of this[Ate])if(!e[ptr])return e;if(!this[tIe]||this[Ate].length<this[tIe]){let e=this[Ert](this[xrt],this[eIe]);return this[mtr](e),e}}};brt.exports=rIe});var _rt=H((e0i,Srt)=>{"use strict";d();var{BalancedPoolMissingUpstreamError:vtr,InvalidArgumentError:xtr}=Jo(),{PoolBase:Etr,kClients:Wd,kNeedDrain:pQ,kAddClient:btr,kRemoveClient:Itr,kGetDispatcher:Ttr}=Xbe(),wtr=hN(),{kUrl:nIe,kInterceptors:Str}=La(),{parseOrigin:Irt}=$i(),Trt=Symbol("factory"),yte=Symbol("options"),wrt=Symbol("kGreatestCommonDivisor"),lk=Symbol("kCurrentWeight"),uk=Symbol("kIndex"),Hh=Symbol("kWeight"),Cte=Symbol("kMaxWeightPerServer"),vte=Symbol("kErrorPenalty");function _tr(t,e){if(t===0)return e;for(;e!==0;){let r=e;e=t%e,t=r}return t}s(_tr,"getGreatestCommonDivisor");function Rtr(t,e){return new wtr(t,e)}s(Rtr,"defaultFactory");var iIe=class extends Etr{static{s(this,"BalancedPool")}constructor(e=[],{factory:r=Rtr,...n}={}){if(super(),this[yte]=n,this[uk]=-1,this[lk]=0,this[Cte]=this[yte].maxWeightPerServer||100,this[vte]=this[yte].errorPenalty||15,Array.isArray(e)||(e=[e]),typeof r!="function")throw new xtr("factory must be a function.");this[Str]=n.interceptors?.BalancedPool&&Array.isArray(n.interceptors.BalancedPool)?n.interceptors.BalancedPool:[],this[Trt]=r;for(let i of e)this.addUpstream(i);this._updateBalancedPoolStats()}addUpstream(e){let r=Irt(e).origin;if(this[Wd].find(i=>i[nIe].origin===r&&i.closed!==!0&&i.destroyed!==!0))return this;let n=this[Trt](r,Object.assign({},this[yte]));this[btr](n),n.on("connect",()=>{n[Hh]=Math.min(this[Cte],n[Hh]+this[vte])}),n.on("connectionError",()=>{n[Hh]=Math.max(1,n[Hh]-this[vte]),this._updateBalancedPoolStats()}),n.on("disconnect",(...i)=>{let o=i[2];o&&o.code==="UND_ERR_SOCKET"&&(n[Hh]=Math.max(1,n[Hh]-this[vte]),this._updateBalancedPoolStats())});for(let i of this[Wd])i[Hh]=this[Cte];return this._updateBalancedPoolStats(),this}_updateBalancedPoolStats(){let e=0;for(let r=0;r<this[Wd].length;r++)e=_tr(this[Wd][r][Hh],e);this[wrt]=e}removeUpstream(e){let r=Irt(e).origin,n=this[Wd].find(i=>i[nIe].origin===r&&i.closed!==!0&&i.destroyed!==!0);return n&&this[Itr](n),this}get upstreams(){return this[Wd].filter(e=>e.closed!==!0&&e.destroyed!==!0).map(e=>e[nIe].origin)}[Ttr](){if(this[Wd].length===0)throw new vtr;if(!this[Wd].find(o=>!o[pQ]&&o.closed!==!0&&o.destroyed!==!0)||this[Wd].map(o=>o[pQ]).reduce((o,a)=>o&&a,!0))return;let n=0,i=this[Wd].findIndex(o=>!o[pQ]);for(;n++<this[Wd].length;){this[uk]=(this[uk]+1)%this[Wd].length;let o=this[Wd][this[uk]];if(o[Hh]>this[Wd][i][Hh]&&!o[pQ]&&(i=this[uk]),this[uk]===0&&(this[lk]=this[lk]-this[wrt],this[lk]<=0&&(this[lk]=this[Cte])),o[Hh]>=this[lk]&&!o[pQ])return o}return this[lk]=this[Wd][i][Hh],this[uk]=i,this[Wd][i]}};Srt.exports=iIe});var gN=H((n0i,Mrt)=>{"use strict";d();var{InvalidArgumentError:xte}=Jo(),{kClients:cw,kRunning:Rrt,kClose:ktr,kDestroy:Ptr,kDispatch:Dtr,kInterceptors:Btr}=La(),Ntr=Z3(),Mtr=hN(),Ltr=uQ(),Ftr=$i(),Otr=mte(),krt=Symbol("onConnect"),Prt=Symbol("onDisconnect"),Drt=Symbol("onConnectionError"),Qtr=Symbol("maxRedirections"),Brt=Symbol("onDrain"),Nrt=Symbol("factory"),oIe=Symbol("options");function Utr(t,e){return e&&e.connections===1?new Ltr(t,e):new Mtr(t,e)}s(Utr,"defaultFactory");var sIe=class extends Ntr{static{s(this,"Agent")}constructor({factory:e=Utr,maxRedirections:r=0,connect:n,...i}={}){if(super(),typeof e!="function")throw new xte("factory must be a function.");if(n!=null&&typeof n!="function"&&typeof n!="object")throw new xte("connect must be a function or an object");if(!Number.isInteger(r)||r<0)throw new xte("maxRedirections must be a positive number");n&&typeof n!="function"&&(n={...n}),this[Btr]=i.interceptors?.Agent&&Array.isArray(i.interceptors.Agent)?i.interceptors.Agent:[Otr({maxRedirections:r})],this[oIe]={...Ftr.deepClone(i),connect:n},this[oIe].interceptors=i.interceptors?{...i.interceptors}:void 0,this[Qtr]=r,this[Nrt]=e,this[cw]=new Map,this[Brt]=(o,a)=>{this.emit("drain",o,[this,...a])},this[krt]=(o,a)=>{this.emit("connect",o,[this,...a])},this[Prt]=(o,a,c)=>{this.emit("disconnect",o,[this,...a],c)},this[Drt]=(o,a,c)=>{this.emit("connectionError",o,[this,...a],c)}}get[Rrt](){let e=0;for(let r of this[cw].values())e+=r[Rrt];return e}[Dtr](e,r){let n;if(e.origin&&(typeof e.origin=="string"||e.origin instanceof URL))n=String(e.origin);else throw new xte("opts.origin must be a non-empty string or URL.");let i=this[cw].get(n);return i||(i=this[Nrt](e.origin,this[oIe]).on("drain",this[Brt]).on("connect",this[krt]).on("disconnect",this[Prt]).on("connectionError",this[Drt]),this[cw].set(n,i)),i.dispatch(e,r)}async[ktr](){let e=[];for(let r of this[cw].values())e.push(r.close());this[cw].clear(),await Promise.all(e)}async[Ptr](e){let r=[];for(let n of this[cw].values())r.push(n.destroy(e));this[cw].clear(),await Promise.all(r)}};Mrt.exports=sIe});var lIe=H((s0i,Qrt)=>{"use strict";d();var{kProxy:qtr,kClose:Htr,kDestroy:$tr,kInterceptors:Wtr}=La(),{URL:mQ}=require("node:url"),jtr=gN(),Gtr=hN(),Vtr=Z3(),{InvalidArgumentError:Ite,RequestAbortedError:ztr,SecureProxyConnectionError:Ktr}=Jo(),Lrt=W7(),Ete=Symbol("proxy agent"),bte=Symbol("proxy client"),hQ=Symbol("proxy headers"),aIe=Symbol("request tls settings"),Frt=Symbol("proxy tls settings"),Ort=Symbol("connect endpoint function");function Ytr(t){return t==="https:"?443:80}s(Ytr,"defaultProtocolPort");function Jtr(t,e){return new Gtr(t,e)}s(Jtr,"defaultFactory");var Xtr=s(()=>{},"noop"),cIe=class extends Vtr{static{s(this,"ProxyAgent")}constructor(e){if(super(),!e||typeof e=="object"&&!(e instanceof mQ)&&!e.uri)throw new Ite("Proxy uri is mandatory");let{clientFactory:r=Jtr}=e;if(typeof r!="function")throw new Ite("Proxy opts.clientFactory must be a function.");let n=this.#e(e),{href:i,origin:o,port:a,protocol:c,username:l,password:u,hostname:f}=n;if(this[qtr]={uri:i,protocol:c},this[Wtr]=e.interceptors?.ProxyAgent&&Array.isArray(e.interceptors.ProxyAgent)?e.interceptors.ProxyAgent:[],this[aIe]=e.requestTls,this[Frt]=e.proxyTls,this[hQ]=e.headers||{},e.auth&&e.token)throw new Ite("opts.auth cannot be used in combination with opts.token");e.auth?this[hQ]["proxy-authorization"]=`Basic ${e.auth}`:e.token?this[hQ]["proxy-authorization"]=e.token:l&&u&&(this[hQ]["proxy-authorization"]=`Basic ${Buffer.from(`${decodeURIComponent(l)}:${decodeURIComponent(u)}`).toString("base64")}`);let p=Lrt({...e.proxyTls});this[Ort]=Lrt({...e.requestTls}),this[bte]=r(n,{connect:p}),this[Ete]=new jtr({...e,connect:s(async(m,h)=>{let g=m.host;m.port||(g+=`:${Ytr(m.protocol)}`);try{let{socket:A,statusCode:y}=await this[bte].connect({origin:o,port:a,path:g,signal:m.signal,headers:{...this[hQ],host:m.host},servername:this[Frt]?.servername||f});if(y!==200&&(A.on("error",Xtr).destroy(),h(new ztr(`Proxy response (${y}) !== 200 when HTTP Tunneling`))),m.protocol!=="https:"){h(null,A);return}let E;this[aIe]?E=this[aIe].servername:E=m.servername,this[Ort]({...m,servername:E,httpSocket:A},h)}catch(A){A.code==="ERR_TLS_CERT_ALTNAME_INVALID"?h(new Ktr(A)):h(A)}},"connect")})}dispatch(e,r){let n=Ztr(e.headers);if(trr(n),n&&!("host"in n)&&!("Host"in n)){let{host:i}=new mQ(e.origin);n.host=i}return this[Ete].dispatch({...e,headers:n},r)}#e(e){return typeof e=="string"?new mQ(e):e instanceof mQ?e:new mQ(e.uri)}async[Htr](){await this[Ete].close(),await this[bte].close()}async[$tr](){await this[Ete].destroy(),await this[bte].destroy()}};function Ztr(t){if(Array.isArray(t)){let e={};for(let r=0;r<t.length;r+=2)e[t[r]]=t[r+1];return e}return t}s(Ztr,"buildHeaders");function trr(t){if(t&&Object.keys(t).find(r=>r.toLowerCase()==="proxy-authorization"))throw new Ite("Proxy-Authorization should be sent in ProxyAgent constructor")}s(trr,"throwIfProxyAuthIsSent");Qrt.exports=cIe});var jrt=H((l0i,Wrt)=>{"use strict";d();var rrr=Z3(),{kClose:nrr,kDestroy:irr,kClosed:Urt,kDestroyed:qrt,kDispatch:orr,kNoProxyAgent:gQ,kHttpProxyAgent:lw,kHttpsProxyAgent:dk}=La(),Hrt=lIe(),srr=gN(),arr={"http:":80,"https:":443},$rt=!1,uIe=class extends rrr{static{s(this,"EnvHttpProxyAgent")}#e=null;#t=null;#i=null;constructor(e={}){super(),this.#i=e,$rt||($rt=!0,process.emitWarning("EnvHttpProxyAgent is experimental, expect them to change at any time.",{code:"UNDICI-EHPA"}));let{httpProxy:r,httpsProxy:n,noProxy:i,...o}=e;this[gQ]=new srr(o);let a=r??process.env.http_proxy??process.env.HTTP_PROXY;a?this[lw]=new Hrt({...o,uri:a}):this[lw]=this[gQ];let c=n??process.env.https_proxy??process.env.HTTPS_PROXY;c?this[dk]=new Hrt({...o,uri:c}):this[dk]=this[lw],this.#o()}[orr](e,r){let n=new URL(e.origin);return this.#n(n).dispatch(e,r)}async[nrr](){await this[gQ].close(),this[lw][Urt]||await this[lw].close(),this[dk][Urt]||await this[dk].close()}async[irr](e){await this[gQ].destroy(e),this[lw][qrt]||await this[lw].destroy(e),this[dk][qrt]||await this[dk].destroy(e)}#n(e){let{protocol:r,host:n,port:i}=e;return n=n.replace(/:\d*$/,"").toLowerCase(),i=Number.parseInt(i,10)||arr[r]||0,this.#r(n,i)?r==="https:"?this[dk]:this[lw]:this[gQ]}#r(e,r){if(this.#s&&this.#o(),this.#t.length===0)return!0;if(this.#e==="*")return!1;for(let n=0;n<this.#t.length;n++){let i=this.#t[n];if(!(i.port&&i.port!==r)){if(/^[.*]/.test(i.hostname)){if(e.endsWith(i.hostname.replace(/^\*/,"")))return!1}else if(e===i.hostname)return!1}}return!0}#o(){let e=this.#i.noProxy??this.#a,r=e.split(/[,\s]/),n=[];for(let i=0;i<r.length;i++){let o=r[i];if(!o)continue;let a=o.match(/^(.+):(\d+)$/);n.push({hostname:(a?a[1]:o).toLowerCase(),port:a?Number.parseInt(a[2],10):0})}this.#e=e,this.#t=n}get#s(){return this.#i.noProxy!==void 0?!1:this.#e!==this.#a}get#a(){return process.env.no_proxy??process.env.NO_PROXY??""}};Wrt.exports=uIe});var Tte=H((f0i,Krt)=>{"use strict";d();var AN=require("node:assert"),{kRetryHandlerDefaultRetry:Grt}=La(),{RequestRetryError:AQ}=Jo(),{isDisturbed:Vrt,parseHeaders:crr,parseRangeHeader:zrt,wrapRequestBody:lrr}=$i();function urr(t){let e=Date.now();return new Date(t).getTime()-e}s(urr,"calculateRetryAfterHeader");var dIe=class t{static{s(this,"RetryHandler")}constructor(e,r){let{retryOptions:n,...i}=e,{retry:o,maxRetries:a,maxTimeout:c,minTimeout:l,timeoutFactor:u,methods:f,errorCodes:p,retryAfter:m,statusCodes:h}=n??{};this.dispatch=r.dispatch,this.handler=r.handler,this.opts={...i,body:lrr(e.body)},this.abort=null,this.aborted=!1,this.retryOpts={retry:o??t[Grt],retryAfter:m??!0,maxTimeout:c??30*1e3,minTimeout:l??500,timeoutFactor:u??2,maxRetries:a??5,methods:f??["GET","HEAD","OPTIONS","PUT","DELETE","TRACE"],statusCodes:h??[500,502,503,504,429],errorCodes:p??["ECONNRESET","ECONNREFUSED","ENOTFOUND","ENETDOWN","ENETUNREACH","EHOSTDOWN","EHOSTUNREACH","EPIPE","UND_ERR_SOCKET"]},this.retryCount=0,this.retryCountCheckpoint=0,this.start=0,this.end=null,this.etag=null,this.resume=null,this.handler.onConnect(g=>{this.aborted=!0,this.abort?this.abort(g):this.reason=g})}onRequestSent(){this.handler.onRequestSent&&this.handler.onRequestSent()}onUpgrade(e,r,n){this.handler.onUpgrade&&this.handler.onUpgrade(e,r,n)}onConnect(e){this.aborted?e(this.reason):this.abort=e}onBodySent(e){if(this.handler.onBodySent)return this.handler.onBodySent(e)}static[Grt](e,{state:r,opts:n},i){let{statusCode:o,code:a,headers:c}=e,{method:l,retryOptions:u}=n,{maxRetries:f,minTimeout:p,maxTimeout:m,timeoutFactor:h,statusCodes:g,errorCodes:A,methods:y}=u,{counter:E}=r;if(a&&a!=="UND_ERR_REQ_RETRY"&&!A.includes(a)){i(e);return}if(Array.isArray(y)&&!y.includes(l)){i(e);return}if(o!=null&&Array.isArray(g)&&!g.includes(o)){i(e);return}if(E>f){i(e);return}let b=c?.["retry-after"];b&&(b=Number(b),b=Number.isNaN(b)?urr(b):b*1e3);let S=b>0?Math.min(b,m):Math.min(p*h**(E-1),m);setTimeout(()=>i(null),S)}onHeaders(e,r,n,i){let o=crr(r);if(this.retryCount+=1,e>=300)return this.retryOpts.statusCodes.includes(e)===!1?this.handler.onHeaders(e,r,n,i):(this.abort(new AQ("Request failed",e,{headers:o,data:{count:this.retryCount}})),!1);if(this.resume!=null){if(this.resume=null,e!==206&&(this.start>0||e!==200))return this.abort(new AQ("server does not support the range header and the payload was partially consumed",e,{headers:o,data:{count:this.retryCount}})),!1;let c=zrt(o["content-range"]);if(!c)return this.abort(new AQ("Content-Range mismatch",e,{headers:o,data:{count:this.retryCount}})),!1;if(this.etag!=null&&this.etag!==o.etag)return this.abort(new AQ("ETag mismatch",e,{headers:o,data:{count:this.retryCount}})),!1;let{start:l,size:u,end:f=u-1}=c;return AN(this.start===l,"content-range mismatch"),AN(this.end==null||this.end===f,"content-range mismatch"),this.resume=n,!0}if(this.end==null){if(e===206){let c=zrt(o["content-range"]);if(c==null)return this.handler.onHeaders(e,r,n,i);let{start:l,size:u,end:f=u-1}=c;AN(l!=null&&Number.isFinite(l),"content-range mismatch"),AN(f!=null&&Number.isFinite(f),"invalid content-length"),this.start=l,this.end=f}if(this.end==null){let c=o["content-length"];this.end=c!=null?Number(c)-1:null}return AN(Number.isFinite(this.start)),AN(this.end==null||Number.isFinite(this.end),"invalid content-length"),this.resume=n,this.etag=o.etag!=null?o.etag:null,this.etag!=null&&this.etag.startsWith("W/")&&(this.etag=null),this.handler.onHeaders(e,r,n,i)}let a=new AQ("Request failed",e,{headers:o,data:{count:this.retryCount}});return this.abort(a),!1}onData(e){return this.start+=e.length,this.handler.onData(e)}onComplete(e){return this.retryCount=0,this.handler.onComplete(e)}onError(e){if(this.aborted||Vrt(this.opts.body))return this.handler.onError(e);this.retryCount-this.retryCountCheckpoint>0?this.retryCount=this.retryCountCheckpoint+(this.retryCount-this.retryCountCheckpoint):this.retryCount+=1,this.retryOpts.retry(e,{state:{counter:this.retryCount},opts:{retryOptions:this.retryOpts,...this.opts}},r.bind(this));function r(n){if(n!=null||this.aborted||Vrt(this.opts.body))return this.handler.onError(n);if(this.start!==0){let i={range:`bytes=${this.start}-${this.end??""}`};this.etag!=null&&(i["if-match"]=this.etag),this.opts={...this.opts,headers:{...this.opts.headers,...i}}}try{this.retryCountCheckpoint=this.retryCount,this.dispatch(this.opts,this)}catch(i){this.handler.onError(i)}}s(r,"onRetry")}};Krt.exports=dIe});var Jrt=H((h0i,Yrt)=>{"use strict";d();var drr=H7(),frr=Tte(),fIe=class extends drr{static{s(this,"RetryAgent")}#e=null;#t=null;constructor(e,r={}){super(r),this.#e=e,this.#t=r}dispatch(e,r){let n=new frr({...e,retryOptions:this.#t},{dispatch:this.#e.dispatch.bind(this.#e),handler:r});return this.#e.dispatch(e,n)}close(){return this.#e.close()}destroy(){return this.#e.destroy()}};Yrt.exports=fIe});var yIe=H((y0i,snt)=>{"use strict";d();var rnt=require("node:assert"),{Readable:prr}=require("node:stream"),{RequestAbortedError:nnt,NotSupportedError:mrr,InvalidArgumentError:hrr,AbortError:pIe}=Jo(),int=$i(),{ReadableStreamFrom:grr}=$i(),X0=Symbol("kConsume"),yQ=Symbol("kReading"),uw=Symbol("kBody"),Xrt=Symbol("kAbort"),ont=Symbol("kContentType"),Zrt=Symbol("kContentLength"),Arr=s(()=>{},"noop"),mIe=class extends prr{static{s(this,"BodyReadable")}constructor({resume:e,abort:r,contentType:n="",contentLength:i,highWaterMark:o=64*1024}){super({autoDestroy:!0,read:e,highWaterMark:o}),this._readableState.dataEmitted=!1,this[Xrt]=r,this[X0]=null,this[uw]=null,this[ont]=n,this[Zrt]=i,this[yQ]=!1}destroy(e){return!e&&!this._readableState.endEmitted&&(e=new nnt),e&&this[Xrt](),super.destroy(e)}_destroy(e,r){this[yQ]?r(e):setImmediate(()=>{r(e)})}on(e,...r){return(e==="data"||e==="readable")&&(this[yQ]=!0),super.on(e,...r)}addListener(e,...r){return this.on(e,...r)}off(e,...r){let n=super.off(e,...r);return(e==="data"||e==="readable")&&(this[yQ]=this.listenerCount("data")>0||this.listenerCount("readable")>0),n}removeListener(e,...r){return this.off(e,...r)}push(e){return this[X0]&&e!==null?(gIe(this[X0],e),this[yQ]?super.push(e):!0):super.push(e)}async text(){return CQ(this,"text")}async json(){return CQ(this,"json")}async blob(){return CQ(this,"blob")}async bytes(){return CQ(this,"bytes")}async arrayBuffer(){return CQ(this,"arrayBuffer")}async formData(){throw new mrr}get bodyUsed(){return int.isDisturbed(this)}get body(){return this[uw]||(this[uw]=grr(this),this[X0]&&(this[uw].getReader(),rnt(this[uw].locked))),this[uw]}async dump(e){let r=Number.isFinite(e?.limit)?e.limit:131072,n=e?.signal;if(n!=null&&(typeof n!="object"||!("aborted"in n)))throw new hrr("signal must be an AbortSignal");return n?.throwIfAborted(),this._readableState.closeEmitted?null:await new Promise((i,o)=>{this[Zrt]>r&&this.destroy(new pIe);let a=s(()=>{this.destroy(n.reason??new pIe)},"onAbort");n?.addEventListener("abort",a),this.on("close",function(){n?.removeEventListener("abort",a),n?.aborted?o(n.reason??new pIe):i(null)}).on("error",Arr).on("data",function(c){r-=c.length,r<=0&&this.destroy()}).resume()})}};function yrr(t){return t[uw]&&t[uw].locked===!0||t[X0]}s(yrr,"isLocked");function Crr(t){return int.isDisturbed(t)||yrr(t)}s(Crr,"isUnusable");async function CQ(t,e){return rnt(!t[X0]),new Promise((r,n)=>{if(Crr(t)){let i=t._readableState;i.destroyed&&i.closeEmitted===!1?t.on("error",o=>{n(o)}).on("close",()=>{n(new TypeError("unusable"))}):n(i.errored??new TypeError("unusable"))}else queueMicrotask(()=>{t[X0]={type:e,stream:t,resolve:r,reject:n,length:0,body:[]},t.on("error",function(i){AIe(this[X0],i)}).on("close",function(){this[X0].body!==null&&AIe(this[X0],new nnt)}),vrr(t[X0])})})}s(CQ,"consume");function vrr(t){if(t.body===null)return;let{_readableState:e}=t.stream;if(e.bufferIndex){let r=e.bufferIndex,n=e.buffer.length;for(let i=r;i<n;i++)gIe(t,e.buffer[i])}else for(let r of e.buffer)gIe(t,r);for(e.endEmitted?tnt(this[X0]):t.stream.on("end",function(){tnt(this[X0])}),t.stream.resume();t.stream.read()!=null;);}s(vrr,"consumeStart");function hIe(t,e){if(t.length===0||e===0)return"";let r=t.length===1?t[0]:Buffer.concat(t,e),n=r.length,i=n>2&&r[0]===239&&r[1]===187&&r[2]===191?3:0;return r.utf8Slice(i,n)}s(hIe,"chunksDecode");function ent(t,e){if(t.length===0||e===0)return new Uint8Array(0);if(t.length===1)return new Uint8Array(t[0]);let r=new Uint8Array(Buffer.allocUnsafeSlow(e).buffer),n=0;for(let i=0;i<t.length;++i){let o=t[i];r.set(o,n),n+=o.length}return r}s(ent,"chunksConcat");function tnt(t){let{type:e,body:r,resolve:n,stream:i,length:o}=t;try{e==="text"?n(hIe(r,o)):e==="json"?n(JSON.parse(hIe(r,o))):e==="arrayBuffer"?n(ent(r,o).buffer):e==="blob"?n(new Blob(r,{type:i[ont]})):e==="bytes"&&n(ent(r,o)),AIe(t)}catch(a){i.destroy(a)}}s(tnt,"consumeEnd");function gIe(t,e){t.length+=e.length,t.body.push(e)}s(gIe,"consumePush");function AIe(t,e){t.body!==null&&(e?t.reject(e):t.resolve(),t.type=null,t.stream=null,t.resolve=null,t.reject=null,t.length=0,t.body=null)}s(AIe,"consumeFinish");snt.exports={Readable:mIe,chunksDecode:hIe}});var CIe=H((x0i,dnt)=>{d();var xrr=require("node:assert"),{ResponseStatusCodeError:ant}=Jo(),{chunksDecode:cnt}=yIe(),Err=128*1024;async function brr({callback:t,body:e,contentType:r,statusCode:n,statusMessage:i,headers:o}){xrr(e);let a=[],c=0;try{for await(let p of e)if(a.push(p),c+=p.length,c>Err){a=[],c=0;break}}catch{a=[],c=0}let l=`Response status code ${n}${i?`: ${i}`:""}`;if(n===204||!r||!c){queueMicrotask(()=>t(new ant(l,n,o)));return}let u=Error.stackTraceLimit;Error.stackTraceLimit=0;let f;try{lnt(r)?f=JSON.parse(cnt(a,c)):unt(r)&&(f=cnt(a,c))}catch{}finally{Error.stackTraceLimit=u}queueMicrotask(()=>t(new ant(l,n,o,f)))}s(brr,"getResolveErrorBodyCallback");var lnt=s(t=>t.length>15&&t[11]==="/"&&t[0]==="a"&&t[1]==="p"&&t[2]==="p"&&t[3]==="l"&&t[4]==="i"&&t[5]==="c"&&t[6]==="a"&&t[7]==="t"&&t[8]==="i"&&t[9]==="o"&&t[10]==="n"&&t[12]==="j"&&t[13]==="s"&&t[14]==="o"&&t[15]==="n","isContentTypeApplicationJson"),unt=s(t=>t.length>4&&t[4]==="/"&&t[0]==="t"&&t[1]==="e"&&t[2]==="x"&&t[3]==="t","isContentTypeText");dnt.exports={getResolveErrorBodyCallback:brr,isContentTypeApplicationJson:lnt,isContentTypeText:unt}});var mnt=H((I0i,vIe)=>{"use strict";d();var Irr=require("node:assert"),{Readable:Trr}=yIe(),{InvalidArgumentError:yN,RequestAbortedError:fnt}=Jo(),Z0=$i(),{getResolveErrorBodyCallback:wrr}=CIe(),{AsyncResource:Srr}=require("node:async_hooks"),wte=class extends Srr{static{s(this,"RequestHandler")}constructor(e,r){if(!e||typeof e!="object")throw new yN("invalid opts");let{signal:n,method:i,opaque:o,body:a,onInfo:c,responseHeaders:l,throwOnError:u,highWaterMark:f}=e;try{if(typeof r!="function")throw new yN("invalid callback");if(f&&(typeof f!="number"||f<0))throw new yN("invalid highWaterMark");if(n&&typeof n.on!="function"&&typeof n.addEventListener!="function")throw new yN("signal must be an EventEmitter or EventTarget");if(i==="CONNECT")throw new yN("invalid method");if(c&&typeof c!="function")throw new yN("invalid onInfo callback");super("UNDICI_REQUEST")}catch(p){throw Z0.isStream(a)&&Z0.destroy(a.on("error",Z0.nop),p),p}this.method=i,this.responseHeaders=l||null,this.opaque=o||null,this.callback=r,this.res=null,this.abort=null,this.body=a,this.trailers={},this.context=null,this.onInfo=c||null,this.throwOnError=u,this.highWaterMark=f,this.signal=n,this.reason=null,this.removeAbortListener=null,Z0.isStream(a)&&a.on("error",p=>{this.onError(p)}),this.signal&&(this.signal.aborted?this.reason=this.signal.reason??new fnt:this.removeAbortListener=Z0.addAbortListener(this.signal,()=>{this.reason=this.signal.reason??new fnt,this.res?Z0.destroy(this.res.on("error",Z0.nop),this.reason):this.abort&&this.abort(this.reason),this.removeAbortListener&&(this.res?.off("close",this.removeAbortListener),this.removeAbortListener(),this.removeAbortListener=null)}))}onConnect(e,r){if(this.reason){e(this.reason);return}Irr(this.callback),this.abort=e,this.context=r}onHeaders(e,r,n,i){let{callback:o,opaque:a,abort:c,context:l,responseHeaders:u,highWaterMark:f}=this,p=u==="raw"?Z0.parseRawHeaders(r):Z0.parseHeaders(r);if(e<200){this.onInfo&&this.onInfo({statusCode:e,headers:p});return}let m=u==="raw"?Z0.parseHeaders(r):p,h=m["content-type"],g=m["content-length"],A=new Trr({resume:n,abort:c,contentType:h,contentLength:this.method!=="HEAD"&&g?Number(g):null,highWaterMark:f});this.removeAbortListener&&A.on("close",this.removeAbortListener),this.callback=null,this.res=A,o!==null&&(this.throwOnError&&e>=400?this.runInAsyncScope(wrr,null,{callback:o,body:A,contentType:h,statusCode:e,statusMessage:i,headers:p}):this.runInAsyncScope(o,null,null,{statusCode:e,headers:p,trailers:this.trailers,opaque:a,body:A,context:l}))}onData(e){return this.res.push(e)}onComplete(e){Z0.parseHeaders(e,this.trailers),this.res.push(null)}onError(e){let{res:r,callback:n,body:i,opaque:o}=this;n&&(this.callback=null,queueMicrotask(()=>{this.runInAsyncScope(n,null,e,{opaque:o})})),r&&(this.res=null,queueMicrotask(()=>{Z0.destroy(r,e)})),i&&(this.body=null,Z0.destroy(i,e)),this.removeAbortListener&&(r?.off("close",this.removeAbortListener),this.removeAbortListener(),this.removeAbortListener=null)}};function pnt(t,e){if(e===void 0)return new Promise((r,n)=>{pnt.call(this,t,(i,o)=>i?n(i):r(o))});try{this.dispatch(t,new wte(t,e))}catch(r){if(typeof e!="function")throw r;let n=t?.opaque;queueMicrotask(()=>e(r,{opaque:n}))}}s(pnt,"request");vIe.exports=pnt;vIe.exports.RequestHandler=wte});var vQ=H((S0i,Ant)=>{d();var{addAbortListener:_rr}=$i(),{RequestAbortedError:Rrr}=Jo(),CN=Symbol("kListener"),s1=Symbol("kSignal");function hnt(t){t.abort?t.abort(t[s1]?.reason):t.reason=t[s1]?.reason??new Rrr,gnt(t)}s(hnt,"abort");function krr(t,e){if(t.reason=null,t[s1]=null,t[CN]=null,!!e){if(e.aborted){hnt(t);return}t[s1]=e,t[CN]=()=>{hnt(t)},_rr(t[s1],t[CN])}}s(krr,"addSignal");function gnt(t){t[s1]&&("removeEventListener"in t[s1]?t[s1].removeEventListener("abort",t[CN]):t[s1].removeListener("abort",t[CN]),t[s1]=null,t[CN]=null)}s(gnt,"removeSignal");Ant.exports={addSignal:krr,removeSignal:gnt}});var xnt=H((k0i,vnt)=>{"use strict";d();var Prr=require("node:assert"),{finished:Drr,PassThrough:Brr}=require("node:stream"),{InvalidArgumentError:vN,InvalidReturnValueError:Nrr}=Jo(),jA=$i(),{getResolveErrorBodyCallback:Mrr}=CIe(),{AsyncResource:Lrr}=require("node:async_hooks"),{addSignal:Frr,removeSignal:ynt}=vQ(),xIe=class extends Lrr{static{s(this,"StreamHandler")}constructor(e,r,n){if(!e||typeof e!="object")throw new vN("invalid opts");let{signal:i,method:o,opaque:a,body:c,onInfo:l,responseHeaders:u,throwOnError:f}=e;try{if(typeof n!="function")throw new vN("invalid callback");if(typeof r!="function")throw new vN("invalid factory");if(i&&typeof i.on!="function"&&typeof i.addEventListener!="function")throw new vN("signal must be an EventEmitter or EventTarget");if(o==="CONNECT")throw new vN("invalid method");if(l&&typeof l!="function")throw new vN("invalid onInfo callback");super("UNDICI_STREAM")}catch(p){throw jA.isStream(c)&&jA.destroy(c.on("error",jA.nop),p),p}this.responseHeaders=u||null,this.opaque=a||null,this.factory=r,this.callback=n,this.res=null,this.abort=null,this.context=null,this.trailers=null,this.body=c,this.onInfo=l||null,this.throwOnError=f||!1,jA.isStream(c)&&c.on("error",p=>{this.onError(p)}),Frr(this,i)}onConnect(e,r){if(this.reason){e(this.reason);return}Prr(this.callback),this.abort=e,this.context=r}onHeaders(e,r,n,i){let{factory:o,opaque:a,context:c,callback:l,responseHeaders:u}=this,f=u==="raw"?jA.parseRawHeaders(r):jA.parseHeaders(r);if(e<200){this.onInfo&&this.onInfo({statusCode:e,headers:f});return}this.factory=null;let p;if(this.throwOnError&&e>=400){let g=(u==="raw"?jA.parseHeaders(r):f)["content-type"];p=new Brr,this.callback=null,this.runInAsyncScope(Mrr,null,{callback:l,body:p,contentType:g,statusCode:e,statusMessage:i,headers:f})}else{if(o===null)return;if(p=this.runInAsyncScope(o,null,{statusCode:e,headers:f,opaque:a,context:c}),!p||typeof p.write!="function"||typeof p.end!="function"||typeof p.on!="function")throw new Nrr("expected Writable");Drr(p,{readable:!1},h=>{let{callback:g,res:A,opaque:y,trailers:E,abort:b}=this;this.res=null,(h||!A.readable)&&jA.destroy(A,h),this.callback=null,this.runInAsyncScope(g,null,h||null,{opaque:y,trailers:E}),h&&b()})}return p.on("drain",n),this.res=p,(p.writableNeedDrain!==void 0?p.writableNeedDrain:p._writableState?.needDrain)!==!0}onData(e){let{res:r}=this;return r?r.write(e):!0}onComplete(e){let{res:r}=this;ynt(this),r&&(this.trailers=jA.parseHeaders(e),r.end())}onError(e){let{res:r,callback:n,opaque:i,body:o}=this;ynt(this),this.factory=null,r?(this.res=null,jA.destroy(r,e)):n&&(this.callback=null,queueMicrotask(()=>{this.runInAsyncScope(n,null,e,{opaque:i})})),o&&(this.body=null,jA.destroy(o,e))}};function Cnt(t,e,r){if(r===void 0)return new Promise((n,i)=>{Cnt.call(this,t,e,(o,a)=>o?i(o):n(a))});try{this.dispatch(t,new xIe(t,e,r))}catch(n){if(typeof r!="function")throw n;let i=t?.opaque;queueMicrotask(()=>r(n,{opaque:i}))}}s(Cnt,"stream");vnt.exports=Cnt});var Tnt=H((B0i,Int)=>{"use strict";d();var{Readable:bnt,Duplex:Orr,PassThrough:Qrr}=require("node:stream"),{InvalidArgumentError:xQ,InvalidReturnValueError:Urr,RequestAbortedError:EIe}=Jo(),$h=$i(),{AsyncResource:qrr}=require("node:async_hooks"),{addSignal:Hrr,removeSignal:$rr}=vQ(),Ent=require("node:assert"),xN=Symbol("resume"),bIe=class extends bnt{static{s(this,"PipelineRequest")}constructor(){super({autoDestroy:!0}),this[xN]=null}_read(){let{[xN]:e}=this;e&&(this[xN]=null,e())}_destroy(e,r){this._read(),r(e)}},IIe=class extends bnt{static{s(this,"PipelineResponse")}constructor(e){super({autoDestroy:!0}),this[xN]=e}_read(){this[xN]()}_destroy(e,r){!e&&!this._readableState.endEmitted&&(e=new EIe),r(e)}},TIe=class extends qrr{static{s(this,"PipelineHandler")}constructor(e,r){if(!e||typeof e!="object")throw new xQ("invalid opts");if(typeof r!="function")throw new xQ("invalid handler");let{signal:n,method:i,opaque:o,onInfo:a,responseHeaders:c}=e;if(n&&typeof n.on!="function"&&typeof n.addEventListener!="function")throw new xQ("signal must be an EventEmitter or EventTarget");if(i==="CONNECT")throw new xQ("invalid method");if(a&&typeof a!="function")throw new xQ("invalid onInfo callback");super("UNDICI_PIPELINE"),this.opaque=o||null,this.responseHeaders=c||null,this.handler=r,this.abort=null,this.context=null,this.onInfo=a||null,this.req=new bIe().on("error",$h.nop),this.ret=new Orr({readableObjectMode:e.objectMode,autoDestroy:!0,read:s(()=>{let{body:l}=this;l?.resume&&l.resume()},"read"),write:s((l,u,f)=>{let{req:p}=this;p.push(l,u)||p._readableState.destroyed?f():p[xN]=f},"write"),destroy:s((l,u)=>{let{body:f,req:p,res:m,ret:h,abort:g}=this;!l&&!h._readableState.endEmitted&&(l=new EIe),g&&l&&g(),$h.destroy(f,l),$h.destroy(p,l),$h.destroy(m,l),$rr(this),u(l)},"destroy")}).on("prefinish",()=>{let{req:l}=this;l.push(null)}),this.res=null,Hrr(this,n)}onConnect(e,r){let{ret:n,res:i}=this;if(this.reason){e(this.reason);return}Ent(!i,"pipeline cannot be retried"),Ent(!n.destroyed),this.abort=e,this.context=r}onHeaders(e,r,n){let{opaque:i,handler:o,context:a}=this;if(e<200){if(this.onInfo){let l=this.responseHeaders==="raw"?$h.parseRawHeaders(r):$h.parseHeaders(r);this.onInfo({statusCode:e,headers:l})}return}this.res=new IIe(n);let c;try{this.handler=null;let l=this.responseHeaders==="raw"?$h.parseRawHeaders(r):$h.parseHeaders(r);c=this.runInAsyncScope(o,null,{statusCode:e,headers:l,opaque:i,body:this.res,context:a})}catch(l){throw this.res.on("error",$h.nop),l}if(!c||typeof c.on!="function")throw new Urr("expected Readable");c.on("data",l=>{let{ret:u,body:f}=this;!u.push(l)&&f.pause&&f.pause()}).on("error",l=>{let{ret:u}=this;$h.destroy(u,l)}).on("end",()=>{let{ret:l}=this;l.push(null)}).on("close",()=>{let{ret:l}=this;l._readableState.ended||$h.destroy(l,new EIe)}),this.body=c}onData(e){let{res:r}=this;return r.push(e)}onComplete(e){let{res:r}=this;r.push(null)}onError(e){let{ret:r}=this;this.handler=null,$h.destroy(r,e)}};function Wrr(t,e){try{let r=new TIe(t,e);return this.dispatch({...t,body:r.req},r),r.ret}catch(r){return new Qrr().destroy(r)}}s(Wrr,"pipeline");Int.exports=Wrr});var Pnt=H((L0i,knt)=>{"use strict";d();var{InvalidArgumentError:wIe,SocketError:jrr}=Jo(),{AsyncResource:Grr}=require("node:async_hooks"),wnt=$i(),{addSignal:Vrr,removeSignal:Snt}=vQ(),_nt=require("node:assert"),SIe=class extends Grr{static{s(this,"UpgradeHandler")}constructor(e,r){if(!e||typeof e!="object")throw new wIe("invalid opts");if(typeof r!="function")throw new wIe("invalid callback");let{signal:n,opaque:i,responseHeaders:o}=e;if(n&&typeof n.on!="function"&&typeof n.addEventListener!="function")throw new wIe("signal must be an EventEmitter or EventTarget");super("UNDICI_UPGRADE"),this.responseHeaders=o||null,this.opaque=i||null,this.callback=r,this.abort=null,this.context=null,Vrr(this,n)}onConnect(e,r){if(this.reason){e(this.reason);return}_nt(this.callback),this.abort=e,this.context=null}onHeaders(){throw new jrr("bad upgrade",null)}onUpgrade(e,r,n){_nt(e===101);let{callback:i,opaque:o,context:a}=this;Snt(this),this.callback=null;let c=this.responseHeaders==="raw"?wnt.parseRawHeaders(r):wnt.parseHeaders(r);this.runInAsyncScope(i,null,null,{headers:c,socket:n,opaque:o,context:a})}onError(e){let{callback:r,opaque:n}=this;Snt(this),r&&(this.callback=null,queueMicrotask(()=>{this.runInAsyncScope(r,null,e,{opaque:n})}))}};function Rnt(t,e){if(e===void 0)return new Promise((r,n)=>{Rnt.call(this,t,(i,o)=>i?n(i):r(o))});try{let r=new SIe(t,e);this.dispatch({...t,method:t.method||"GET",upgrade:t.protocol||"Websocket"},r)}catch(r){if(typeof e!="function")throw r;let n=t?.opaque;queueMicrotask(()=>e(r,{opaque:n}))}}s(Rnt,"upgrade");knt.exports=Rnt});var Lnt=H((Q0i,Mnt)=>{"use strict";d();var zrr=require("node:assert"),{AsyncResource:Krr}=require("node:async_hooks"),{InvalidArgumentError:_Ie,SocketError:Yrr}=Jo(),Dnt=$i(),{addSignal:Jrr,removeSignal:Bnt}=vQ(),RIe=class extends Krr{static{s(this,"ConnectHandler")}constructor(e,r){if(!e||typeof e!="object")throw new _Ie("invalid opts");if(typeof r!="function")throw new _Ie("invalid callback");let{signal:n,opaque:i,responseHeaders:o}=e;if(n&&typeof n.on!="function"&&typeof n.addEventListener!="function")throw new _Ie("signal must be an EventEmitter or EventTarget");super("UNDICI_CONNECT"),this.opaque=i||null,this.responseHeaders=o||null,this.callback=r,this.abort=null,Jrr(this,n)}onConnect(e,r){if(this.reason){e(this.reason);return}zrr(this.callback),this.abort=e,this.context=r}onHeaders(){throw new Yrr("bad connect",null)}onUpgrade(e,r,n){let{callback:i,opaque:o,context:a}=this;Bnt(this),this.callback=null;let c=r;c!=null&&(c=this.responseHeaders==="raw"?Dnt.parseRawHeaders(r):Dnt.parseHeaders(r)),this.runInAsyncScope(i,null,null,{statusCode:e,headers:c,socket:n,opaque:o,context:a})}onError(e){let{callback:r,opaque:n}=this;Bnt(this),r&&(this.callback=null,queueMicrotask(()=>{this.runInAsyncScope(r,null,e,{opaque:n})}))}};function Nnt(t,e){if(e===void 0)return new Promise((r,n)=>{Nnt.call(this,t,(i,o)=>i?n(i):r(o))});try{let r=new RIe(t,e);this.dispatch({...t,method:"CONNECT"},r)}catch(r){if(typeof e!="function")throw r;let n=t?.opaque;queueMicrotask(()=>e(r,{opaque:n}))}}s(Nnt,"connect");Mnt.exports=Nnt});var Fnt=H((H0i,EN)=>{"use strict";d();EN.exports.request=mnt();EN.exports.stream=xnt();EN.exports.pipeline=Tnt();EN.exports.upgrade=Pnt();EN.exports.connect=Lnt()});var PIe=H((W0i,Ont)=>{"use strict";d();var{UndiciError:Xrr}=Jo(),kIe=class t extends Xrr{static{s(this,"MockNotMatchedError")}constructor(e){super(e),Error.captureStackTrace(this,t),this.name="MockNotMatchedError",this.message=e||"The request does not match any registered mock dispatches",this.code="UND_MOCK_ERR_MOCK_NOT_MATCHED"}};Ont.exports={MockNotMatchedError:kIe}});var bN=H((V0i,Qnt)=>{"use strict";d();Qnt.exports={kAgent:Symbol("agent"),kOptions:Symbol("options"),kFactory:Symbol("factory"),kDispatches:Symbol("dispatches"),kDispatchKey:Symbol("dispatch key"),kDefaultHeaders:Symbol("default headers"),kDefaultTrailers:Symbol("default trailers"),kContentLength:Symbol("content length"),kMockAgent:Symbol("mock agent"),kMockAgentSet:Symbol("mock agent set"),kMockAgentGet:Symbol("mock agent get"),kMockDispatch:Symbol("mock dispatch"),kClose:Symbol("close"),kOriginalClose:Symbol("original agent close"),kOrigin:Symbol("origin"),kIsMockActive:Symbol("is mock active"),kNetConnect:Symbol("net connect"),kGetNetConnect:Symbol("get net connect"),kConnected:Symbol("connected")}});var EQ=H((K0i,Ynt)=>{"use strict";d();var{MockNotMatchedError:fk}=PIe(),{kDispatches:Ste,kMockAgent:Zrr,kOriginalDispatch:enr,kOrigin:tnr,kGetNetConnect:rnr}=bN(),{buildURL:nnr}=$i(),{STATUS_CODES:inr}=require("node:http"),{types:{isPromise:onr}}=require("node:util");function Vx(t,e){return typeof t=="string"?t===e:t instanceof RegExp?t.test(e):typeof t=="function"?t(e)===!0:!1}s(Vx,"matchValue");function qnt(t){return Object.fromEntries(Object.entries(t).map(([e,r])=>[e.toLocaleLowerCase(),r]))}s(qnt,"lowerCaseEntries");function Hnt(t,e){if(Array.isArray(t)){for(let r=0;r<t.length;r+=2)if(t[r].toLocaleLowerCase()===e.toLocaleLowerCase())return t[r+1];return}else return typeof t.get=="function"?t.get(e):qnt(t)[e.toLocaleLowerCase()]}s(Hnt,"getHeaderByName");function NIe(t){let e=t.slice(),r=[];for(let n=0;n<e.length;n+=2)r.push([e[n],e[n+1]]);return Object.fromEntries(r)}s(NIe,"buildHeadersFromArray");function $nt(t,e){if(typeof t.headers=="function")return Array.isArray(e)&&(e=NIe(e)),t.headers(e?qnt(e):{});if(typeof t.headers>"u")return!0;if(typeof e!="object"||typeof t.headers!="object")return!1;for(let[r,n]of Object.entries(t.headers)){let i=Hnt(e,r);if(!Vx(n,i))return!1}return!0}s($nt,"matchHeaders");function Unt(t){if(typeof t!="string")return t;let e=t.split("?");if(e.length!==2)return t;let r=new URLSearchParams(e.pop());return r.sort(),[...e,r.toString()].join("?")}s(Unt,"safeUrl");function snr(t,{path:e,method:r,body:n,headers:i}){let o=Vx(t.path,e),a=Vx(t.method,r),c=typeof t.body<"u"?Vx(t.body,n):!0,l=$nt(t,i);return o&&a&&c&&l}s(snr,"matchKey");function Wnt(t){return Buffer.isBuffer(t)||t instanceof Uint8Array||t instanceof ArrayBuffer?t:typeof t=="object"?JSON.stringify(t):t.toString()}s(Wnt,"getResponseData");function jnt(t,e){let r=e.query?nnr(e.path,e.query):e.path,n=typeof r=="string"?Unt(r):r,i=t.filter(({consumed:o})=>!o).filter(({path:o})=>Vx(Unt(o),n));if(i.length===0)throw new fk(`Mock dispatch not matched for path '${n}'`);if(i=i.filter(({method:o})=>Vx(o,e.method)),i.length===0)throw new fk(`Mock dispatch not matched for method '${e.method}' on path '${n}'`);if(i=i.filter(({body:o})=>typeof o<"u"?Vx(o,e.body):!0),i.length===0)throw new fk(`Mock dispatch not matched for body '${e.body}' on path '${n}'`);if(i=i.filter(o=>$nt(o,e.headers)),i.length===0){let o=typeof e.headers=="object"?JSON.stringify(e.headers):e.headers;throw new fk(`Mock dispatch not matched for headers '${o}' on path '${n}'`)}return i[0]}s(jnt,"getMockDispatch");function anr(t,e,r){let n={timesInvoked:0,times:1,persist:!1,consumed:!1},i=typeof r=="function"?{callback:r}:{...r},o={...n,...e,pending:!0,data:{error:null,...i}};return t.push(o),o}s(anr,"addMockDispatch");function DIe(t,e){let r=t.findIndex(n=>n.consumed?snr(n,e):!1);r!==-1&&t.splice(r,1)}s(DIe,"deleteMockDispatch");function Gnt(t){let{path:e,method:r,body:n,headers:i,query:o}=t;return{path:e,method:r,body:n,headers:i,query:o}}s(Gnt,"buildKey");function BIe(t){let e=Object.keys(t),r=[];for(let n=0;n<e.length;++n){let i=e[n],o=t[i],a=Buffer.from(`${i}`);if(Array.isArray(o))for(let c=0;c<o.length;++c)r.push(a,Buffer.from(`${o[c]}`));else r.push(a,Buffer.from(`${o}`))}return r}s(BIe,"generateKeyValues");function Vnt(t){return inr[t]||"unknown"}s(Vnt,"getStatusText");async function cnr(t){let e=[];for await(let r of t)e.push(r);return Buffer.concat(e).toString("utf8")}s(cnr,"getResponse");function znt(t,e){let r=Gnt(t),n=jnt(this[Ste],r);n.timesInvoked++,n.data.callback&&(n.data={...n.data,...n.data.callback(t)});let{data:{statusCode:i,data:o,headers:a,trailers:c,error:l},delay:u,persist:f}=n,{timesInvoked:p,times:m}=n;if(n.consumed=!f&&p>=m,n.pending=p<m,l!==null)return DIe(this[Ste],r),e.onError(l),!0;typeof u=="number"&&u>0?setTimeout(()=>{h(this[Ste])},u):h(this[Ste]);function h(A,y=o){let E=Array.isArray(t.headers)?NIe(t.headers):t.headers,b=typeof y=="function"?y({...t,headers:E}):y;if(onr(b)){b.then(L=>h(A,L));return}let S=Wnt(b),R=BIe(a),B=BIe(c);e.onConnect?.(L=>e.onError(L),null),e.onHeaders?.(i,R,g,Vnt(i)),e.onData?.(Buffer.from(S)),e.onComplete?.(B),DIe(A,r)}s(h,"handleReply");function g(){}return s(g,"resume"),!0}s(znt,"mockDispatch");function lnr(){let t=this[Zrr],e=this[tnr],r=this[enr];return s(function(i,o){if(t.isMockActive)try{znt.call(this,i,o)}catch(a){if(a instanceof fk){let c=t[rnr]();if(c===!1)throw new fk(`${a.message}: subsequent request to origin ${e} was not allowed (net.connect disabled)`);if(Knt(c,e))r.call(this,i,o);else throw new fk(`${a.message}: subsequent request to origin ${e} was not allowed (net.connect is not enabled for this origin)`)}else throw a}else r.call(this,i,o)},"dispatch")}s(lnr,"buildMockDispatch");function Knt(t,e){let r=new URL(e);return t===!0?!0:!!(Array.isArray(t)&&t.some(n=>Vx(n,r.host)))}s(Knt,"checkNetConnect");function unr(t){if(t){let{agent:e,...r}=t;return r}}s(unr,"buildMockOptions");Ynt.exports={getResponseData:Wnt,getMockDispatch:jnt,addMockDispatch:anr,deleteMockDispatch:DIe,buildKey:Gnt,generateKeyValues:BIe,matchValue:Vx,getResponse:cnr,getStatusText:Vnt,mockDispatch:znt,buildMockDispatch:lnr,checkNetConnect:Knt,buildMockOptions:unr,getHeaderByName:Hnt,buildHeadersFromArray:NIe}});var qIe=H((X0i,UIe)=>{"use strict";d();var{getResponseData:dnr,buildKey:fnr,addMockDispatch:MIe}=EQ(),{kDispatches:_te,kDispatchKey:Rte,kDefaultHeaders:LIe,kDefaultTrailers:FIe,kContentLength:OIe,kMockDispatch:kte}=bN(),{InvalidArgumentError:a1}=Jo(),{buildURL:pnr}=$i(),IN=class{static{s(this,"MockScope")}constructor(e){this[kte]=e}delay(e){if(typeof e!="number"||!Number.isInteger(e)||e<=0)throw new a1("waitInMs must be a valid integer > 0");return this[kte].delay=e,this}persist(){return this[kte].persist=!0,this}times(e){if(typeof e!="number"||!Number.isInteger(e)||e<=0)throw new a1("repeatTimes must be a valid integer > 0");return this[kte].times=e,this}},QIe=class{static{s(this,"MockInterceptor")}constructor(e,r){if(typeof e!="object")throw new a1("opts must be an object");if(typeof e.path>"u")throw new a1("opts.path must be defined");if(typeof e.method>"u"&&(e.method="GET"),typeof e.path=="string")if(e.query)e.path=pnr(e.path,e.query);else{let n=new URL(e.path,"data://");e.path=n.pathname+n.search}typeof e.method=="string"&&(e.method=e.method.toUpperCase()),this[Rte]=fnr(e),this[_te]=r,this[LIe]={},this[FIe]={},this[OIe]=!1}createMockScopeDispatchData({statusCode:e,data:r,responseOptions:n}){let i=dnr(r),o=this[OIe]?{"content-length":i.length}:{},a={...this[LIe],...o,...n.headers},c={...this[FIe],...n.trailers};return{statusCode:e,data:r,headers:a,trailers:c}}validateReplyParameters(e){if(typeof e.statusCode>"u")throw new a1("statusCode must be defined");if(typeof e.responseOptions!="object"||e.responseOptions===null)throw new a1("responseOptions must be an object")}reply(e){if(typeof e=="function"){let o=s(c=>{let l=e(c);if(typeof l!="object"||l===null)throw new a1("reply options callback must return an object");let u={data:"",responseOptions:{},...l};return this.validateReplyParameters(u),{...this.createMockScopeDispatchData(u)}},"wrappedDefaultsCallback"),a=MIe(this[_te],this[Rte],o);return new IN(a)}let r={statusCode:e,data:arguments[1]===void 0?"":arguments[1],responseOptions:arguments[2]===void 0?{}:arguments[2]};this.validateReplyParameters(r);let n=this.createMockScopeDispatchData(r),i=MIe(this[_te],this[Rte],n);return new IN(i)}replyWithError(e){if(typeof e>"u")throw new a1("error must be defined");let r=MIe(this[_te],this[Rte],{error:e});return new IN(r)}defaultReplyHeaders(e){if(typeof e>"u")throw new a1("headers must be defined");return this[LIe]=e,this}defaultReplyTrailers(e){if(typeof e>"u")throw new a1("trailers must be defined");return this[FIe]=e,this}replyContentLength(){return this[OIe]=!0,this}};UIe.exports.MockInterceptor=QIe;UIe.exports.MockScope=IN});var WIe=H((tmi,nit)=>{"use strict";d();var{promisify:mnr}=require("node:util"),hnr=uQ(),{buildMockDispatch:gnr}=EQ(),{kDispatches:Jnt,kMockAgent:Xnt,kClose:Znt,kOriginalClose:eit,kOrigin:tit,kOriginalDispatch:Anr,kConnected:HIe}=bN(),{MockInterceptor:ynr}=qIe(),rit=La(),{InvalidArgumentError:Cnr}=Jo(),$Ie=class extends hnr{static{s(this,"MockClient")}constructor(e,r){if(super(e,r),!r||!r.agent||typeof r.agent.dispatch!="function")throw new Cnr("Argument opts.agent must implement Agent");this[Xnt]=r.agent,this[tit]=e,this[Jnt]=[],this[HIe]=1,this[Anr]=this.dispatch,this[eit]=this.close.bind(this),this.dispatch=gnr.call(this),this.close=this[Znt]}get[rit.kConnected](){return this[HIe]}intercept(e){return new ynr(e,this[Jnt])}async[Znt](){await mnr(this[eit])(),this[HIe]=0,this[Xnt][rit.kClients].delete(this[tit])}};nit.exports=$Ie});var VIe=H((imi,uit)=>{"use strict";d();var{promisify:vnr}=require("node:util"),xnr=hN(),{buildMockDispatch:Enr}=EQ(),{kDispatches:iit,kMockAgent:oit,kClose:sit,kOriginalClose:ait,kOrigin:cit,kOriginalDispatch:bnr,kConnected:jIe}=bN(),{MockInterceptor:Inr}=qIe(),lit=La(),{InvalidArgumentError:Tnr}=Jo(),GIe=class extends xnr{static{s(this,"MockPool")}constructor(e,r){if(super(e,r),!r||!r.agent||typeof r.agent.dispatch!="function")throw new Tnr("Argument opts.agent must implement Agent");this[oit]=r.agent,this[cit]=e,this[iit]=[],this[jIe]=1,this[bnr]=this.dispatch,this[ait]=this.close.bind(this),this.dispatch=Enr.call(this),this.close=this[sit]}get[lit.kConnected](){return this[jIe]}intercept(e){return new Inr(e,this[iit])}async[sit](){await vnr(this[ait])(),this[jIe]=0,this[oit][lit.kClients].delete(this[cit])}};uit.exports=GIe});var fit=H((cmi,dit)=>{"use strict";d();var wnr={pronoun:"it",is:"is",was:"was",this:"this"},Snr={pronoun:"they",is:"are",was:"were",this:"these"};dit.exports=class{static{s(this,"Pluralizer")}constructor(e,r){this.singular=e,this.plural=r}pluralize(e){let r=e===1,n=r?wnr:Snr,i=r?this.singular:this.plural;return{...n,count:e,noun:i}}}});var mit=H((fmi,pit)=>{"use strict";d();var{Transform:_nr}=require("node:stream"),{Console:Rnr}=require("node:console"),knr=process.versions.icu?"\u2705":"Y ",Pnr=process.versions.icu?"\u274C":"N ";pit.exports=class{static{s(this,"PendingInterceptorsFormatter")}constructor({disableColors:e}={}){this.transform=new _nr({transform(r,n,i){i(null,r)}}),this.logger=new Rnr({stdout:this.transform,inspectOptions:{colors:!e&&!process.env.CI}})}format(e){let r=e.map(({method:n,path:i,data:{statusCode:o},persist:a,times:c,timesInvoked:l,origin:u})=>({Method:n,Origin:u,Path:i,"Status code":o,Persistent:a?knr:Pnr,Invocations:l,Remaining:a?1/0:c-l}));return this.logger.table(r),this.transform.read().toString()}}});var yit=H((hmi,Ait)=>{"use strict";d();var{kClients:pk}=La(),Dnr=gN(),{kAgent:zIe,kMockAgentSet:Pte,kMockAgentGet:hit,kDispatches:KIe,kIsMockActive:Dte,kNetConnect:mk,kGetNetConnect:Bnr,kOptions:Bte,kFactory:Nte}=bN(),Nnr=WIe(),Mnr=VIe(),{matchValue:Lnr,buildMockOptions:Fnr}=EQ(),{InvalidArgumentError:git,UndiciError:Onr}=Jo(),Qnr=H7(),Unr=fit(),qnr=mit(),YIe=class extends Qnr{static{s(this,"MockAgent")}constructor(e){if(super(e),this[mk]=!0,this[Dte]=!0,e?.agent&&typeof e.agent.dispatch!="function")throw new git("Argument opts.agent must implement Agent");let r=e?.agent?e.agent:new Dnr(e);this[zIe]=r,this[pk]=r[pk],this[Bte]=Fnr(e)}get(e){let r=this[hit](e);return r||(r=this[Nte](e),this[Pte](e,r)),r}dispatch(e,r){return this.get(e.origin),this[zIe].dispatch(e,r)}async close(){await this[zIe].close(),this[pk].clear()}deactivate(){this[Dte]=!1}activate(){this[Dte]=!0}enableNetConnect(e){if(typeof e=="string"||typeof e=="function"||e instanceof RegExp)Array.isArray(this[mk])?this[mk].push(e):this[mk]=[e];else if(typeof e>"u")this[mk]=!0;else throw new git("Unsupported matcher. Must be one of String|Function|RegExp.")}disableNetConnect(){this[mk]=!1}get isMockActive(){return this[Dte]}[Pte](e,r){this[pk].set(e,r)}[Nte](e){let r=Object.assign({agent:this},this[Bte]);return this[Bte]&&this[Bte].connections===1?new Nnr(e,r):new Mnr(e,r)}[hit](e){let r=this[pk].get(e);if(r)return r;if(typeof e!="string"){let n=this[Nte]("http://localhost:9999");return this[Pte](e,n),n}for(let[n,i]of Array.from(this[pk]))if(i&&typeof n!="string"&&Lnr(n,e)){let o=this[Nte](e);return this[Pte](e,o),o[KIe]=i[KIe],o}}[Bnr](){return this[mk]}pendingInterceptors(){let e=this[pk];return Array.from(e.entries()).flatMap(([r,n])=>n[KIe].map(i=>({...i,origin:r}))).filter(({pending:r})=>r)}assertNoPendingInterceptors({pendingInterceptorsFormatter:e=new qnr}={}){let r=this.pendingInterceptors();if(r.length===0)return;let n=new Unr("interceptor","interceptors").pluralize(r.length);throw new Onr(`
${n.count} ${n.noun} ${n.is} pending:

${e.format(r)}
`.trim())}};Ait.exports=YIe});var Mte=H((ymi,Eit)=>{"use strict";d();var Cit=Symbol.for("undici.globalDispatcher.1"),{InvalidArgumentError:Hnr}=Jo(),$nr=gN();xit()===void 0&&vit(new $nr);function vit(t){if(!t||typeof t.dispatch!="function")throw new Hnr("Argument agent must implement Agent");Object.defineProperty(globalThis,Cit,{value:t,writable:!0,enumerable:!1,configurable:!1})}s(vit,"setGlobalDispatcher");function xit(){return globalThis[Cit]}s(xit,"getGlobalDispatcher");Eit.exports={setGlobalDispatcher:vit,getGlobalDispatcher:xit}});var Lte=H((Emi,bit)=>{"use strict";d();bit.exports=class{static{s(this,"DecoratorHandler")}#e;constructor(e){if(typeof e!="object"||e===null)throw new TypeError("handler must be an object");this.#e=e}onConnect(...e){return this.#e.onConnect?.(...e)}onError(...e){return this.#e.onError?.(...e)}onUpgrade(...e){return this.#e.onUpgrade?.(...e)}onResponseStarted(...e){return this.#e.onResponseStarted?.(...e)}onHeaders(...e){return this.#e.onHeaders?.(...e)}onData(...e){return this.#e.onData?.(...e)}onComplete(...e){return this.#e.onComplete?.(...e)}onBodySent(...e){return this.#e.onBodySent?.(...e)}}});var Tit=H((Tmi,Iit)=>{"use strict";d();var Wnr=pte();Iit.exports=t=>{let e=t?.maxRedirections;return r=>s(function(i,o){let{maxRedirections:a=e,...c}=i;if(!a)return r(i,o);let l=new Wnr(r,a,i,o);return r(c,l)},"redirectInterceptor")}});var Sit=H((_mi,wit)=>{"use strict";d();var jnr=Tte();wit.exports=t=>e=>s(function(n,i){return e(n,new jnr({...n,retryOptions:{...t,...n.retryOptions}},{handler:i,dispatch:e}))},"retryInterceptor")});var Rit=H((Pmi,_it)=>{"use strict";d();var Gnr=$i(),{InvalidArgumentError:Vnr,RequestAbortedError:znr}=Jo(),Knr=Lte(),JIe=class extends Knr{static{s(this,"DumpHandler")}#e=1024*1024;#t=null;#i=!1;#n=!1;#r=0;#o=null;#s=null;constructor({maxSize:e},r){if(super(r),e!=null&&(!Number.isFinite(e)||e<1))throw new Vnr("maxSize must be a number greater than 0");this.#e=e??this.#e,this.#s=r}onConnect(e){this.#t=e,this.#s.onConnect(this.#a.bind(this))}#a(e){this.#n=!0,this.#o=e}onHeaders(e,r,n,i){let a=Gnr.parseHeaders(r)["content-length"];if(a!=null&&a>this.#e)throw new znr(`Response size (${a}) larger than maxSize (${this.#e})`);return this.#n?!0:this.#s.onHeaders(e,r,n,i)}onError(e){this.#i||(e=this.#o??e,this.#s.onError(e))}onData(e){return this.#r=this.#r+e.length,this.#r>=this.#e&&(this.#i=!0,this.#n?this.#s.onError(this.#o):this.#s.onComplete([])),!0}onComplete(e){if(!this.#i){if(this.#n){this.#s.onError(this.reason);return}this.#s.onComplete(e)}}};function Ynr({maxSize:t}={maxSize:1024*1024}){return e=>s(function(n,i){let{dumpMaxSize:o=t}=n,a=new JIe({maxSize:o},i);return e(n,a)},"Intercept")}s(Ynr,"createDumpInterceptor");_it.exports=Ynr});var Dit=H((Nmi,Pit)=>{"use strict";d();var{isIP:Jnr}=require("node:net"),{lookup:Xnr}=require("node:dns"),Znr=Lte(),{InvalidArgumentError:TN,InformationalError:eir}=Jo(),kit=Math.pow(2,31)-1,XIe=class{static{s(this,"DNSInstance")}#e=0;#t=0;#i=new Map;dualStack=!0;affinity=null;lookup=null;pick=null;constructor(e){this.#e=e.maxTTL,this.#t=e.maxItems,this.dualStack=e.dualStack,this.affinity=e.affinity,this.lookup=e.lookup??this.#n,this.pick=e.pick??this.#r}get full(){return this.#i.size===this.#t}runLookup(e,r,n){let i=this.#i.get(e.hostname);if(i==null&&this.full){n(null,e.origin);return}let o={affinity:this.affinity,dualStack:this.dualStack,lookup:this.lookup,pick:this.pick,...r.dns,maxTTL:this.#e,maxItems:this.#t};if(i==null)this.lookup(e,o,(a,c)=>{if(a||c==null||c.length===0){n(a??new eir("No DNS entries found"));return}this.setRecords(e,c);let l=this.#i.get(e.hostname),u=this.pick(e,l,o.affinity),f;typeof u.port=="number"?f=`:${u.port}`:e.port!==""?f=`:${e.port}`:f="",n(null,`${e.protocol}//${u.family===6?`[${u.address}]`:u.address}${f}`)});else{let a=this.pick(e,i,o.affinity);if(a==null){this.#i.delete(e.hostname),this.runLookup(e,r,n);return}let c;typeof a.port=="number"?c=`:${a.port}`:e.port!==""?c=`:${e.port}`:c="",n(null,`${e.protocol}//${a.family===6?`[${a.address}]`:a.address}${c}`)}}#n(e,r,n){Xnr(e.hostname,{all:!0,family:this.dualStack===!1?this.affinity:0,order:"ipv4first"},(i,o)=>{if(i)return n(i);let a=new Map;for(let c of o)a.set(`${c.address}:${c.family}`,c);n(null,a.values())})}#r(e,r,n){let i=null,{records:o,offset:a}=r,c;if(this.dualStack?(n==null&&(a==null||a===kit?(r.offset=0,n=4):(r.offset++,n=(r.offset&1)===1?6:4)),o[n]!=null&&o[n].ips.length>0?c=o[n]:c=o[n===4?6:4]):c=o[n],c==null||c.ips.length===0)return i;c.offset==null||c.offset===kit?c.offset=0:c.offset++;let l=c.offset%c.ips.length;return i=c.ips[l]??null,i==null?i:Date.now()-i.timestamp>i.ttl?(c.ips.splice(l,1),this.pick(e,r,n)):i}setRecords(e,r){let n=Date.now(),i={records:{4:null,6:null}};for(let o of r){o.timestamp=n,typeof o.ttl=="number"?o.ttl=Math.min(o.ttl,this.#e):o.ttl=this.#e;let a=i.records[o.family]??{ips:[]};a.ips.push(o),i.records[o.family]=a}this.#i.set(e.hostname,i)}getHandler(e,r){return new ZIe(this,e,r)}},ZIe=class extends Znr{static{s(this,"DNSDispatchHandler")}#e=null;#t=null;#i=null;#n=null;#r=null;constructor(e,{origin:r,handler:n,dispatch:i},o){super(n),this.#r=r,this.#n=n,this.#t={...o},this.#e=e,this.#i=i}onError(e){switch(e.code){case"ETIMEDOUT":case"ECONNREFUSED":{if(this.#e.dualStack){this.#e.runLookup(this.#r,this.#t,(r,n)=>{if(r)return this.#n.onError(r);let i={...this.#t,origin:n};this.#i(i,this)});return}this.#n.onError(e);return}case"ENOTFOUND":this.#e.deleteRecord(this.#r);default:this.#n.onError(e);break}}};Pit.exports=t=>{if(t?.maxTTL!=null&&(typeof t?.maxTTL!="number"||t?.maxTTL<0))throw new TN("Invalid maxTTL. Must be a positive number");if(t?.maxItems!=null&&(typeof t?.maxItems!="number"||t?.maxItems<1))throw new TN("Invalid maxItems. Must be a positive number and greater than zero");if(t?.affinity!=null&&t?.affinity!==4&&t?.affinity!==6)throw new TN("Invalid affinity. Must be either 4 or 6");if(t?.dualStack!=null&&typeof t?.dualStack!="boolean")throw new TN("Invalid dualStack. Must be a boolean");if(t?.lookup!=null&&typeof t?.lookup!="function")throw new TN("Invalid lookup. Must be a function");if(t?.pick!=null&&typeof t?.pick!="function")throw new TN("Invalid pick. Must be a function");let e=t?.dualStack??!0,r;e?r=t?.affinity??null:r=t?.affinity??4;let n={maxTTL:t?.maxTTL??1e4,lookup:t?.lookup??null,pick:t?.pick??null,dualStack:e,affinity:r,maxItems:t?.maxItems??1/0},i=new XIe(n);return o=>s(function(c,l){let u=c.origin.constructor===URL?c.origin:new URL(c.origin);return Jnr(u.hostname)!==0?o(c,l):(i.runLookup(u,c,(f,p)=>{if(f)return l.onError(f);let m=null;m={...c,servername:u.hostname,origin:p,headers:{host:u.hostname,...c.headers}},o(m,i.getHandler({origin:u,dispatch:o,handler:l},c))}),!0)},"dnsInterceptor")}});var hk=H((Fmi,Qit)=>{"use strict";d();var{kConstruct:tir}=La(),{kEnumerableProperty:wN}=$i(),{iteratorMixin:rir,isValidHeaderName:bQ,isValidHeaderValue:Nit}=J0(),{webidl:Po}=nd(),eTe=require("node:assert"),Fte=require("node:util"),pl=Symbol("headers map"),em=Symbol("headers map sorted");function Bit(t){return t===10||t===13||t===9||t===32}s(Bit,"isHTTPWhiteSpaceCharCode");function Mit(t){let e=0,r=t.length;for(;r>e&&Bit(t.charCodeAt(r-1));)--r;for(;r>e&&Bit(t.charCodeAt(e));)++e;return e===0&&r===t.length?t:t.substring(e,r)}s(Mit,"headerValueNormalize");function Lit(t,e){if(Array.isArray(e))for(let r=0;r<e.length;++r){let n=e[r];if(n.length!==2)throw Po.errors.exception({header:"Headers constructor",message:`expected name/value pair to be length 2, found ${n.length}.`});tTe(t,n[0],n[1])}else if(typeof e=="object"&&e!==null){let r=Object.keys(e);for(let n=0;n<r.length;++n)tTe(t,r[n],e[r[n]])}else throw Po.errors.conversionFailed({prefix:"Headers constructor",argument:"Argument 1",types:["sequence<sequence<ByteString>>","record<ByteString, ByteString>"]})}s(Lit,"fill");function tTe(t,e,r){if(r=Mit(r),bQ(e)){if(!Nit(r))throw Po.errors.invalidArgument({prefix:"Headers.append",value:r,type:"header value"})}else throw Po.errors.invalidArgument({prefix:"Headers.append",value:e,type:"header name"});if(Oit(t)==="immutable")throw new TypeError("immutable");return rTe(t).append(e,r,!1)}s(tTe,"appendHeader");function Fit(t,e){return t[0]<e[0]?-1:1}s(Fit,"compareHeaderName");var Ote=class t{static{s(this,"HeadersList")}cookies=null;constructor(e){e instanceof t?(this[pl]=new Map(e[pl]),this[em]=e[em],this.cookies=e.cookies===null?null:[...e.cookies]):(this[pl]=new Map(e),this[em]=null)}contains(e,r){return this[pl].has(r?e:e.toLowerCase())}clear(){this[pl].clear(),this[em]=null,this.cookies=null}append(e,r,n){this[em]=null;let i=n?e:e.toLowerCase(),o=this[pl].get(i);if(o){let a=i==="cookie"?"; ":", ";this[pl].set(i,{name:o.name,value:`${o.value}${a}${r}`})}else this[pl].set(i,{name:e,value:r});i==="set-cookie"&&(this.cookies??=[]).push(r)}set(e,r,n){this[em]=null;let i=n?e:e.toLowerCase();i==="set-cookie"&&(this.cookies=[r]),this[pl].set(i,{name:e,value:r})}delete(e,r){this[em]=null,r||(e=e.toLowerCase()),e==="set-cookie"&&(this.cookies=null),this[pl].delete(e)}get(e,r){return this[pl].get(r?e:e.toLowerCase())?.value??null}*[Symbol.iterator](){for(let{0:e,1:{value:r}}of this[pl])yield[e,r]}get entries(){let e={};if(this[pl].size!==0)for(let{name:r,value:n}of this[pl].values())e[r]=n;return e}rawValues(){return this[pl].values()}get entriesList(){let e=[];if(this[pl].size!==0)for(let{0:r,1:{name:n,value:i}}of this[pl])if(r==="set-cookie")for(let o of this.cookies)e.push([n,o]);else e.push([n,i]);return e}toSortedArray(){let e=this[pl].size,r=new Array(e);if(e<=32){if(e===0)return r;let n=this[pl][Symbol.iterator](),i=n.next().value;r[0]=[i[0],i[1].value],eTe(i[1].value!==null);for(let o=1,a=0,c=0,l=0,u=0,f,p;o<e;++o){for(p=n.next().value,f=r[o]=[p[0],p[1].value],eTe(f[1]!==null),l=0,c=o;l<c;)u=l+(c-l>>1),r[u][0]<=f[0]?l=u+1:c=u;if(o!==u){for(a=o;a>l;)r[a]=r[--a];r[l]=f}}if(!n.next().done)throw new TypeError("Unreachable");return r}else{let n=0;for(let{0:i,1:{value:o}}of this[pl])r[n++]=[i,o],eTe(o!==null);return r.sort(Fit)}}},GA=class t{static{s(this,"Headers")}#e;#t;constructor(e=void 0){Po.util.markAsUncloneable(this),e!==tir&&(this.#t=new Ote,this.#e="none",e!==void 0&&(e=Po.converters.HeadersInit(e,"Headers contructor","init"),Lit(this,e)))}append(e,r){Po.brandCheck(this,t),Po.argumentLengthCheck(arguments,2,"Headers.append");let n="Headers.append";return e=Po.converters.ByteString(e,n,"name"),r=Po.converters.ByteString(r,n,"value"),tTe(this,e,r)}delete(e){if(Po.brandCheck(this,t),Po.argumentLengthCheck(arguments,1,"Headers.delete"),e=Po.converters.ByteString(e,"Headers.delete","name"),!bQ(e))throw Po.errors.invalidArgument({prefix:"Headers.delete",value:e,type:"header name"});if(this.#e==="immutable")throw new TypeError("immutable");this.#t.contains(e,!1)&&this.#t.delete(e,!1)}get(e){Po.brandCheck(this,t),Po.argumentLengthCheck(arguments,1,"Headers.get");let r="Headers.get";if(e=Po.converters.ByteString(e,r,"name"),!bQ(e))throw Po.errors.invalidArgument({prefix:r,value:e,type:"header name"});return this.#t.get(e,!1)}has(e){Po.brandCheck(this,t),Po.argumentLengthCheck(arguments,1,"Headers.has");let r="Headers.has";if(e=Po.converters.ByteString(e,r,"name"),!bQ(e))throw Po.errors.invalidArgument({prefix:r,value:e,type:"header name"});return this.#t.contains(e,!1)}set(e,r){Po.brandCheck(this,t),Po.argumentLengthCheck(arguments,2,"Headers.set");let n="Headers.set";if(e=Po.converters.ByteString(e,n,"name"),r=Po.converters.ByteString(r,n,"value"),r=Mit(r),bQ(e)){if(!Nit(r))throw Po.errors.invalidArgument({prefix:n,value:r,type:"header value"})}else throw Po.errors.invalidArgument({prefix:n,value:e,type:"header name"});if(this.#e==="immutable")throw new TypeError("immutable");this.#t.set(e,r,!1)}getSetCookie(){Po.brandCheck(this,t);let e=this.#t.cookies;return e?[...e]:[]}get[em](){if(this.#t[em])return this.#t[em];let e=[],r=this.#t.toSortedArray(),n=this.#t.cookies;if(n===null||n.length===1)return this.#t[em]=r;for(let i=0;i<r.length;++i){let{0:o,1:a}=r[i];if(o==="set-cookie")for(let c=0;c<n.length;++c)e.push([o,n[c]]);else e.push([o,a])}return this.#t[em]=e}[Fte.inspect.custom](e,r){return r.depth??=e,`Headers ${Fte.formatWithOptions(r,this.#t.entries)}`}static getHeadersGuard(e){return e.#e}static setHeadersGuard(e,r){e.#e=r}static getHeadersList(e){return e.#t}static setHeadersList(e,r){e.#t=r}},{getHeadersGuard:Oit,setHeadersGuard:nir,getHeadersList:rTe,setHeadersList:iir}=GA;Reflect.deleteProperty(GA,"getHeadersGuard");Reflect.deleteProperty(GA,"setHeadersGuard");Reflect.deleteProperty(GA,"getHeadersList");Reflect.deleteProperty(GA,"setHeadersList");rir("Headers",GA,em,0,1);Object.defineProperties(GA.prototype,{append:wN,delete:wN,get:wN,has:wN,set:wN,getSetCookie:wN,[Symbol.toStringTag]:{value:"Headers",configurable:!0},[Fte.inspect.custom]:{enumerable:!1}});Po.converters.HeadersInit=function(t,e,r){if(Po.util.Type(t)==="Object"){let n=Reflect.get(t,Symbol.iterator);if(!Fte.types.isProxy(t)&&n===GA.prototype.entries)try{return rTe(t).entriesList}catch{}return typeof n=="function"?Po.converters["sequence<sequence<ByteString>>"](t,e,r,n.bind(t)):Po.converters["record<ByteString, ByteString>"](t,e,r)}throw Po.errors.conversionFailed({prefix:"Headers constructor",argument:"Argument 1",types:["sequence<sequence<ByteString>>","record<ByteString, ByteString>"]})};Qit.exports={fill:Lit,compareHeaderName:Fit,Headers:GA,HeadersList:Ote,getHeadersGuard:Oit,setHeadersGuard:nir,setHeadersList:iir,getHeadersList:rTe}});var TQ=H((Umi,Kit)=>{"use strict";d();var{Headers:jit,HeadersList:Uit,fill:oir,getHeadersGuard:sir,setHeadersGuard:Git,setHeadersList:Vit}=hk(),{extractBody:qit,cloneBody:air,mixinBody:cir,hasFinalizationRegistry:lir,streamRegistry:uir,bodyUnusable:dir}=cN(),nTe=$i(),Hit=require("node:util"),{kEnumerableProperty:tm}=nTe,{isValidReasonPhrase:fir,isCancelled:pir,isAborted:mir,isBlobLike:hir,serializeJavascriptValueToJSONString:gir,isErrorLike:Air,isomorphicEncode:yir,environmentSettingsObject:Cir}=J0(),{redirectStatusSet:vir,nullBodyStatus:xir}=j7(),{kState:Ac,kHeaders:zx}=ew(),{webidl:bi}=nd(),{FormData:Eir}=J7(),{URLSerializer:$it}=Mp(),{kConstruct:Ute}=La(),iTe=require("node:assert"),{types:bir}=require("node:util"),Iir=new TextEncoder("utf-8"),gk=class t{static{s(this,"Response")}static error(){return IQ(qte(),"immutable")}static json(e,r={}){bi.argumentLengthCheck(arguments,1,"Response.json"),r!==null&&(r=bi.converters.ResponseInit(r));let n=Iir.encode(gir(e)),i=qit(n),o=IQ(SN({}),"response");return Wit(o,r,{body:i[0],type:"application/json"}),o}static redirect(e,r=302){bi.argumentLengthCheck(arguments,1,"Response.redirect"),e=bi.converters.USVString(e),r=bi.converters["unsigned short"](r);let n;try{n=new URL(e,Cir.settingsObject.baseUrl)}catch(a){throw new TypeError(`Failed to parse URL from ${e}`,{cause:a})}if(!vir.has(r))throw new RangeError(`Invalid status code ${r}`);let i=IQ(SN({}),"immutable");i[Ac].status=r;let o=yir($it(n));return i[Ac].headersList.append("location",o,!0),i}constructor(e=null,r={}){if(bi.util.markAsUncloneable(this),e===Ute)return;e!==null&&(e=bi.converters.BodyInit(e)),r=bi.converters.ResponseInit(r),this[Ac]=SN({}),this[zx]=new jit(Ute),Git(this[zx],"response"),Vit(this[zx],this[Ac].headersList);let n=null;if(e!=null){let[i,o]=qit(e);n={body:i,type:o}}Wit(this,r,n)}get type(){return bi.brandCheck(this,t),this[Ac].type}get url(){bi.brandCheck(this,t);let e=this[Ac].urlList,r=e[e.length-1]??null;return r===null?"":$it(r,!0)}get redirected(){return bi.brandCheck(this,t),this[Ac].urlList.length>1}get status(){return bi.brandCheck(this,t),this[Ac].status}get ok(){return bi.brandCheck(this,t),this[Ac].status>=200&&this[Ac].status<=299}get statusText(){return bi.brandCheck(this,t),this[Ac].statusText}get headers(){return bi.brandCheck(this,t),this[zx]}get body(){return bi.brandCheck(this,t),this[Ac].body?this[Ac].body.stream:null}get bodyUsed(){return bi.brandCheck(this,t),!!this[Ac].body&&nTe.isDisturbed(this[Ac].body.stream)}clone(){if(bi.brandCheck(this,t),dir(this))throw bi.errors.exception({header:"Response.clone",message:"Body has already been consumed."});let e=oTe(this[Ac]);return IQ(e,sir(this[zx]))}[Hit.inspect.custom](e,r){r.depth===null&&(r.depth=2),r.colors??=!0;let n={status:this.status,statusText:this.statusText,headers:this.headers,body:this.body,bodyUsed:this.bodyUsed,ok:this.ok,redirected:this.redirected,type:this.type,url:this.url};return`Response ${Hit.formatWithOptions(r,n)}`}};cir(gk);Object.defineProperties(gk.prototype,{type:tm,url:tm,status:tm,ok:tm,redirected:tm,statusText:tm,headers:tm,clone:tm,body:tm,bodyUsed:tm,[Symbol.toStringTag]:{value:"Response",configurable:!0}});Object.defineProperties(gk,{json:tm,redirect:tm,error:tm});function oTe(t){if(t.internalResponse)return zit(oTe(t.internalResponse),t.type);let e=SN({...t,body:null});return t.body!=null&&(e.body=air(e,t.body)),e}s(oTe,"cloneResponse");function SN(t){return{aborted:!1,rangeRequested:!1,timingAllowPassed:!1,requestIncludesCredentials:!1,type:"default",status:200,timingInfo:null,cacheState:"",statusText:"",...t,headersList:t?.headersList?new Uit(t?.headersList):new Uit,urlList:t?.urlList?[...t.urlList]:[]}}s(SN,"makeResponse");function qte(t){let e=Air(t);return SN({type:"error",status:0,error:e?t:new Error(t&&String(t)),aborted:t&&t.name==="AbortError"})}s(qte,"makeNetworkError");function Tir(t){return t.type==="error"&&t.status===0}s(Tir,"isNetworkError");function Qte(t,e){return e={internalResponse:t,...e},new Proxy(t,{get(r,n){return n in e?e[n]:r[n]},set(r,n,i){return iTe(!(n in e)),r[n]=i,!0}})}s(Qte,"makeFilteredResponse");function zit(t,e){if(e==="basic")return Qte(t,{type:"basic",headersList:t.headersList});if(e==="cors")return Qte(t,{type:"cors",headersList:t.headersList});if(e==="opaque")return Qte(t,{type:"opaque",urlList:Object.freeze([]),status:0,statusText:"",body:null});if(e==="opaqueredirect")return Qte(t,{type:"opaqueredirect",status:0,statusText:"",headersList:[],body:null});iTe(!1)}s(zit,"filterResponse");function wir(t,e=null){return iTe(pir(t)),mir(t)?qte(Object.assign(new DOMException("The operation was aborted.","AbortError"),{cause:e})):qte(Object.assign(new DOMException("Request was cancelled."),{cause:e}))}s(wir,"makeAppropriateNetworkError");function Wit(t,e,r){if(e.status!==null&&(e.status<200||e.status>599))throw new RangeError('init["status"] must be in the range of 200 to 599, inclusive.');if("statusText"in e&&e.statusText!=null&&!fir(String(e.statusText)))throw new TypeError("Invalid statusText");if("status"in e&&e.status!=null&&(t[Ac].status=e.status),"statusText"in e&&e.statusText!=null&&(t[Ac].statusText=e.statusText),"headers"in e&&e.headers!=null&&oir(t[zx],e.headers),r){if(xir.includes(t.status))throw bi.errors.exception({header:"Response constructor",message:`Invalid response status code ${t.status}`});t[Ac].body=r.body,r.type!=null&&!t[Ac].headersList.contains("content-type",!0)&&t[Ac].headersList.append("content-type",r.type,!0)}}s(Wit,"initializeResponse");function IQ(t,e){let r=new gk(Ute);return r[Ac]=t,r[zx]=new jit(Ute),Vit(r[zx],t.headersList),Git(r[zx],e),lir&&t.body?.stream&&uir.register(r,new WeakRef(t.body.stream)),r}s(IQ,"fromInnerResponse");bi.converters.ReadableStream=bi.interfaceConverter(ReadableStream);bi.converters.FormData=bi.interfaceConverter(Eir);bi.converters.URLSearchParams=bi.interfaceConverter(URLSearchParams);bi.converters.XMLHttpRequestBodyInit=function(t,e,r){return typeof t=="string"?bi.converters.USVString(t,e,r):hir(t)?bi.converters.Blob(t,e,r,{strict:!1}):ArrayBuffer.isView(t)||bir.isArrayBuffer(t)?bi.converters.BufferSource(t,e,r):nTe.isFormDataLike(t)?bi.converters.FormData(t,e,r,{strict:!1}):t instanceof URLSearchParams?bi.converters.URLSearchParams(t,e,r):bi.converters.DOMString(t,e,r)};bi.converters.BodyInit=function(t,e,r){return t instanceof ReadableStream?bi.converters.ReadableStream(t,e,r):t?.[Symbol.asyncIterator]?t:bi.converters.XMLHttpRequestBodyInit(t,e,r)};bi.converters.ResponseInit=bi.dictionaryConverter([{key:"status",converter:bi.converters["unsigned short"],defaultValue:s(()=>200,"defaultValue")},{key:"statusText",converter:bi.converters.ByteString,defaultValue:s(()=>"","defaultValue")},{key:"headers",converter:bi.converters.HeadersInit}]);Kit.exports={isNetworkError:Tir,makeNetworkError:qte,makeResponse:SN,makeAppropriateNetworkError:wir,filterResponse:zit,Response:gk,cloneResponse:oTe,fromInnerResponse:IQ}});var Zit=H(($mi,Xit)=>{"use strict";d();var{kConnected:Yit,kSize:Jit}=La(),sTe=class{static{s(this,"CompatWeakRef")}constructor(e){this.value=e}deref(){return this.value[Yit]===0&&this.value[Jit]===0?void 0:this.value}},aTe=class{static{s(this,"CompatFinalizer")}constructor(e){this.finalizer=e}register(e,r){e.on&&e.on("disconnect",()=>{e[Yit]===0&&e[Jit]===0&&this.finalizer(r)})}unregister(e){}};Xit.exports=function(){return process.env.NODE_V8_COVERAGE&&process.version.startsWith("v18")?(process._rawDebug("Using compatibility WeakRef and FinalizationRegistry"),{WeakRef:sTe,FinalizationRegistry:aTe}):{WeakRef,FinalizationRegistry}}});var _N=H((Gmi,mot)=>{"use strict";d();var{extractBody:Sir,mixinBody:_ir,cloneBody:Rir,bodyUnusable:eot}=cN(),{Headers:lot,fill:kir,HeadersList:jte,setHeadersGuard:lTe,getHeadersGuard:Pir,setHeadersList:uot,getHeadersList:tot}=hk(),{FinalizationRegistry:Dir}=Zit()(),$te=$i(),rot=require("node:util"),{isValidHTTPToken:Bir,sameOrigin:not,environmentSettingsObject:Hte}=J0(),{forbiddenMethodsSet:Nir,corsSafeListedMethodsSet:Mir,referrerPolicy:Lir,requestRedirect:Fir,requestMode:Oir,requestCredentials:Qir,requestCache:Uir,requestDuplex:qir}=j7(),{kEnumerableProperty:ml,normalizedMethodRecordsBase:Hir,normalizedMethodRecords:$ir}=$te,{kHeaders:rm,kSignal:Wte,kState:ua,kDispatcher:cTe}=ew(),{webidl:Mn}=nd(),{URLSerializer:Wir}=Mp(),{kConstruct:Gte}=La(),jir=require("node:assert"),{getMaxListeners:iot,setMaxListeners:oot,getEventListeners:Gir,defaultMaxListeners:sot}=require("node:events"),Vir=Symbol("abortController"),dot=new Dir(({signal:t,abort:e})=>{t.removeEventListener("abort",e)}),Vte=new WeakMap;function aot(t){return e;function e(){let r=t.deref();if(r!==void 0){dot.unregister(e),this.removeEventListener("abort",e),r.abort(this.reason);let n=Vte.get(r.signal);if(n!==void 0){if(n.size!==0){for(let i of n){let o=i.deref();o!==void 0&&o.abort(this.reason)}n.clear()}Vte.delete(r.signal)}}}}s(aot,"buildAbort");var cot=!1,dw=class t{static{s(this,"Request")}constructor(e,r={}){if(Mn.util.markAsUncloneable(this),e===Gte)return;let n="Request constructor";Mn.argumentLengthCheck(arguments,1,n),e=Mn.converters.RequestInfo(e,n,"input"),r=Mn.converters.RequestInit(r,n,"init");let i=null,o=null,a=Hte.settingsObject.baseUrl,c=null;if(typeof e=="string"){this[cTe]=r.dispatcher;let E;try{E=new URL(e,a)}catch(b){throw new TypeError("Failed to parse URL from "+e,{cause:b})}if(E.username||E.password)throw new TypeError("Request cannot be constructed from a URL that includes credentials: "+e);i=zte({urlList:[E]}),o="cors"}else this[cTe]=r.dispatcher||e[cTe],jir(e instanceof t),i=e[ua],c=e[Wte];let l=Hte.settingsObject.origin,u="client";if(i.window?.constructor?.name==="EnvironmentSettingsObject"&&not(i.window,l)&&(u=i.window),r.window!=null)throw new TypeError(`'window' option '${u}' must be null`);"window"in r&&(u="no-window"),i=zte({method:i.method,headersList:i.headersList,unsafeRequest:i.unsafeRequest,client:Hte.settingsObject,window:u,priority:i.priority,origin:i.origin,referrer:i.referrer,referrerPolicy:i.referrerPolicy,mode:i.mode,credentials:i.credentials,cache:i.cache,redirect:i.redirect,integrity:i.integrity,keepalive:i.keepalive,reloadNavigation:i.reloadNavigation,historyNavigation:i.historyNavigation,urlList:[...i.urlList]});let f=Object.keys(r).length!==0;if(f&&(i.mode==="navigate"&&(i.mode="same-origin"),i.reloadNavigation=!1,i.historyNavigation=!1,i.origin="client",i.referrer="client",i.referrerPolicy="",i.url=i.urlList[i.urlList.length-1],i.urlList=[i.url]),r.referrer!==void 0){let E=r.referrer;if(E==="")i.referrer="no-referrer";else{let b;try{b=new URL(E,a)}catch(S){throw new TypeError(`Referrer "${E}" is not a valid URL.`,{cause:S})}b.protocol==="about:"&&b.hostname==="client"||l&&!not(b,Hte.settingsObject.baseUrl)?i.referrer="client":i.referrer=b}}r.referrerPolicy!==void 0&&(i.referrerPolicy=r.referrerPolicy);let p;if(r.mode!==void 0?p=r.mode:p=o,p==="navigate")throw Mn.errors.exception({header:"Request constructor",message:"invalid request mode navigate."});if(p!=null&&(i.mode=p),r.credentials!==void 0&&(i.credentials=r.credentials),r.cache!==void 0&&(i.cache=r.cache),i.cache==="only-if-cached"&&i.mode!=="same-origin")throw new TypeError("'only-if-cached' can be set only with 'same-origin' mode");if(r.redirect!==void 0&&(i.redirect=r.redirect),r.integrity!=null&&(i.integrity=String(r.integrity)),r.keepalive!==void 0&&(i.keepalive=!!r.keepalive),r.method!==void 0){let E=r.method,b=$ir[E];if(b!==void 0)i.method=b;else{if(!Bir(E))throw new TypeError(`'${E}' is not a valid HTTP method.`);let S=E.toUpperCase();if(Nir.has(S))throw new TypeError(`'${E}' HTTP method is unsupported.`);E=Hir[S]??E,i.method=E}!cot&&i.method==="patch"&&(process.emitWarning("Using `patch` is highly likely to result in a `405 Method Not Allowed`. `PATCH` is much more likely to succeed.",{code:"UNDICI-FETCH-patch"}),cot=!0)}r.signal!==void 0&&(c=r.signal),this[ua]=i;let m=new AbortController;if(this[Wte]=m.signal,c!=null){if(!c||typeof c.aborted!="boolean"||typeof c.addEventListener!="function")throw new TypeError("Failed to construct 'Request': member signal is not of type AbortSignal.");if(c.aborted)m.abort(c.reason);else{this[Vir]=m;let E=new WeakRef(m),b=aot(E);try{(typeof iot=="function"&&iot(c)===sot||Gir(c,"abort").length>=sot)&&oot(1500,c)}catch{}$te.addAbortListener(c,b),dot.register(m,{signal:c,abort:b},b)}}if(this[rm]=new lot(Gte),uot(this[rm],i.headersList),lTe(this[rm],"request"),p==="no-cors"){if(!Mir.has(i.method))throw new TypeError(`'${i.method} is unsupported in no-cors mode.`);lTe(this[rm],"request-no-cors")}if(f){let E=tot(this[rm]),b=r.headers!==void 0?r.headers:new jte(E);if(E.clear(),b instanceof jte){for(let{name:S,value:R}of b.rawValues())E.append(S,R,!1);E.cookies=b.cookies}else kir(this[rm],b)}let h=e instanceof t?e[ua].body:null;if((r.body!=null||h!=null)&&(i.method==="GET"||i.method==="HEAD"))throw new TypeError("Request with GET/HEAD method cannot have body.");let g=null;if(r.body!=null){let[E,b]=Sir(r.body,i.keepalive);g=E,b&&!tot(this[rm]).contains("content-type",!0)&&this[rm].append("content-type",b)}let A=g??h;if(A!=null&&A.source==null){if(g!=null&&r.duplex==null)throw new TypeError("RequestInit: duplex option is required when sending a body.");if(i.mode!=="same-origin"&&i.mode!=="cors")throw new TypeError('If request is made from ReadableStream, mode should be "same-origin" or "cors"');i.useCORSPreflightFlag=!0}let y=A;if(g==null&&h!=null){if(eot(e))throw new TypeError("Cannot construct a Request with a Request object that has already been used.");let E=new TransformStream;h.stream.pipeThrough(E),y={source:h.source,length:h.length,stream:E.readable}}this[ua].body=y}get method(){return Mn.brandCheck(this,t),this[ua].method}get url(){return Mn.brandCheck(this,t),Wir(this[ua].url)}get headers(){return Mn.brandCheck(this,t),this[rm]}get destination(){return Mn.brandCheck(this,t),this[ua].destination}get referrer(){return Mn.brandCheck(this,t),this[ua].referrer==="no-referrer"?"":this[ua].referrer==="client"?"about:client":this[ua].referrer.toString()}get referrerPolicy(){return Mn.brandCheck(this,t),this[ua].referrerPolicy}get mode(){return Mn.brandCheck(this,t),this[ua].mode}get credentials(){return this[ua].credentials}get cache(){return Mn.brandCheck(this,t),this[ua].cache}get redirect(){return Mn.brandCheck(this,t),this[ua].redirect}get integrity(){return Mn.brandCheck(this,t),this[ua].integrity}get keepalive(){return Mn.brandCheck(this,t),this[ua].keepalive}get isReloadNavigation(){return Mn.brandCheck(this,t),this[ua].reloadNavigation}get isHistoryNavigation(){return Mn.brandCheck(this,t),this[ua].historyNavigation}get signal(){return Mn.brandCheck(this,t),this[Wte]}get body(){return Mn.brandCheck(this,t),this[ua].body?this[ua].body.stream:null}get bodyUsed(){return Mn.brandCheck(this,t),!!this[ua].body&&$te.isDisturbed(this[ua].body.stream)}get duplex(){return Mn.brandCheck(this,t),"half"}clone(){if(Mn.brandCheck(this,t),eot(this))throw new TypeError("unusable");let e=fot(this[ua]),r=new AbortController;if(this.signal.aborted)r.abort(this.signal.reason);else{let n=Vte.get(this.signal);n===void 0&&(n=new Set,Vte.set(this.signal,n));let i=new WeakRef(r);n.add(i),$te.addAbortListener(r.signal,aot(i))}return pot(e,r.signal,Pir(this[rm]))}[rot.inspect.custom](e,r){r.depth===null&&(r.depth=2),r.colors??=!0;let n={method:this.method,url:this.url,headers:this.headers,destination:this.destination,referrer:this.referrer,referrerPolicy:this.referrerPolicy,mode:this.mode,credentials:this.credentials,cache:this.cache,redirect:this.redirect,integrity:this.integrity,keepalive:this.keepalive,isReloadNavigation:this.isReloadNavigation,isHistoryNavigation:this.isHistoryNavigation,signal:this.signal};return`Request ${rot.formatWithOptions(r,n)}`}};_ir(dw);function zte(t){return{method:t.method??"GET",localURLsOnly:t.localURLsOnly??!1,unsafeRequest:t.unsafeRequest??!1,body:t.body??null,client:t.client??null,reservedClient:t.reservedClient??null,replacesClientId:t.replacesClientId??"",window:t.window??"client",keepalive:t.keepalive??!1,serviceWorkers:t.serviceWorkers??"all",initiator:t.initiator??"",destination:t.destination??"",priority:t.priority??null,origin:t.origin??"client",policyContainer:t.policyContainer??"client",referrer:t.referrer??"client",referrerPolicy:t.referrerPolicy??"",mode:t.mode??"no-cors",useCORSPreflightFlag:t.useCORSPreflightFlag??!1,credentials:t.credentials??"same-origin",useCredentials:t.useCredentials??!1,cache:t.cache??"default",redirect:t.redirect??"follow",integrity:t.integrity??"",cryptoGraphicsNonceMetadata:t.cryptoGraphicsNonceMetadata??"",parserMetadata:t.parserMetadata??"",reloadNavigation:t.reloadNavigation??!1,historyNavigation:t.historyNavigation??!1,userActivation:t.userActivation??!1,taintedOrigin:t.taintedOrigin??!1,redirectCount:t.redirectCount??0,responseTainting:t.responseTainting??"basic",preventNoCacheCacheControlHeaderModification:t.preventNoCacheCacheControlHeaderModification??!1,done:t.done??!1,timingAllowFailed:t.timingAllowFailed??!1,urlList:t.urlList,url:t.urlList[0],headersList:t.headersList?new jte(t.headersList):new jte}}s(zte,"makeRequest");function fot(t){let e=zte({...t,body:null});return t.body!=null&&(e.body=Rir(e,t.body)),e}s(fot,"cloneRequest");function pot(t,e,r){let n=new dw(Gte);return n[ua]=t,n[Wte]=e,n[rm]=new lot(Gte),uot(n[rm],t.headersList),lTe(n[rm],r),n}s(pot,"fromInnerRequest");Object.defineProperties(dw.prototype,{method:ml,url:ml,headers:ml,redirect:ml,clone:ml,signal:ml,duplex:ml,destination:ml,body:ml,bodyUsed:ml,isHistoryNavigation:ml,isReloadNavigation:ml,keepalive:ml,integrity:ml,cache:ml,credentials:ml,attribute:ml,referrerPolicy:ml,referrer:ml,mode:ml,[Symbol.toStringTag]:{value:"Request",configurable:!0}});Mn.converters.Request=Mn.interfaceConverter(dw);Mn.converters.RequestInfo=function(t,e,r){return typeof t=="string"?Mn.converters.USVString(t,e,r):t instanceof dw?Mn.converters.Request(t,e,r):Mn.converters.USVString(t,e,r)};Mn.converters.AbortSignal=Mn.interfaceConverter(AbortSignal);Mn.converters.RequestInit=Mn.dictionaryConverter([{key:"method",converter:Mn.converters.ByteString},{key:"headers",converter:Mn.converters.HeadersInit},{key:"body",converter:Mn.nullableConverter(Mn.converters.BodyInit)},{key:"referrer",converter:Mn.converters.USVString},{key:"referrerPolicy",converter:Mn.converters.DOMString,allowedValues:Lir},{key:"mode",converter:Mn.converters.DOMString,allowedValues:Oir},{key:"credentials",converter:Mn.converters.DOMString,allowedValues:Qir},{key:"cache",converter:Mn.converters.DOMString,allowedValues:Uir},{key:"redirect",converter:Mn.converters.DOMString,allowedValues:Fir},{key:"integrity",converter:Mn.converters.DOMString},{key:"keepalive",converter:Mn.converters.boolean},{key:"signal",converter:Mn.nullableConverter(t=>Mn.converters.AbortSignal(t,"RequestInit","signal",{strict:!1}))},{key:"window",converter:Mn.converters.any},{key:"duplex",converter:Mn.converters.DOMString,allowedValues:qir},{key:"dispatcher",converter:Mn.converters.any}]);mot.exports={Request:dw,makeRequest:zte,fromInnerRequest:pot,cloneRequest:fot}});var SQ=H((Kmi,Rot)=>{"use strict";d();var{makeNetworkError:ms,makeAppropriateNetworkError:Kte,filterResponse:uTe,makeResponse:Yte,fromInnerResponse:zir}=TQ(),{HeadersList:hot}=hk(),{Request:Kir,cloneRequest:Yir}=_N(),fw=require("node:zlib"),{bytesMatch:Jir,makePolicyContainer:Xir,clonePolicyContainer:Zir,requestBadPort:eor,TAOCheck:tor,appendRequestOriginHeader:ror,responseLocationURL:nor,requestCurrentURL:c1,setRequestReferrerPolicyOnRedirect:ior,tryUpgradeRequestToAPotentiallyTrustworthyURL:oor,createOpaqueTimingInfo:hTe,appendFetchMetadata:sor,corsCheck:aor,crossOriginResourcePolicyCheck:cor,determineRequestsReferrer:lor,coarsenedSharedCurrentTime:wQ,createDeferredPromise:uor,isBlobLike:dor,sameOrigin:mTe,isCancelled:Ak,isAborted:got,isErrorLike:por,fullyReadBody:mor,readableStreamClose:hor,isomorphicEncode:Jte,urlIsLocal:gor,urlIsHttpHttpsScheme:gTe,urlHasHttpsScheme:Aor,clampAndCoarsenConnectionTimingInfo:yor,simpleRangeHeaderValue:Cor,buildContentRange:vor,createInflate:xor,extractMimeType:Eor}=J0(),{kState:vot,kDispatcher:bor}=ew(),yk=require("node:assert"),{safelyExtractBody:ATe,extractBody:Aot}=cN(),{redirectStatusSet:xot,nullBodyStatus:Eot,safeMethodsSet:Ior,requestBodyHeader:Tor,subresourceSet:wor}=j7(),Sor=require("node:events"),{Readable:_or,pipeline:Ror,finished:kor}=require("node:stream"),{addAbortListener:Por,isErrored:Dor,isReadable:Xte,bufferToLowerCasedHeaderName:yot}=$i(),{dataURLProcessor:Bor,serializeAMimeType:Nor,minimizeSupportedMimeType:Mor}=Mp(),{getGlobalDispatcher:Lor}=Mte(),{webidl:For}=nd(),{STATUS_CODES:Oor}=require("node:http"),Qor=["GET","HEAD"],Uor=typeof __UNDICI_IS_NODE__<"u"||typeof esbuildDetection<"u"?"node":"undici",dTe,Zte=class extends Sor{static{s(this,"Fetch")}constructor(e){super(),this.dispatcher=e,this.connection=null,this.dump=!1,this.state="ongoing"}terminate(e){this.state==="ongoing"&&(this.state="terminated",this.connection?.destroy(e),this.emit("terminated",e))}abort(e){this.state==="ongoing"&&(this.state="aborted",e||(e=new DOMException("The operation was aborted.","AbortError")),this.serializedAbortReason=e,this.connection?.destroy(e),this.emit("terminated",e))}};function qor(t){bot(t,"fetch")}s(qor,"handleFetchDone");function Hor(t,e=void 0){For.argumentLengthCheck(arguments,1,"globalThis.fetch");let r=uor(),n;try{n=new Kir(t,e)}catch(f){return r.reject(f),r.promise}let i=n[vot];if(n.signal.aborted)return fTe(r,i,null,n.signal.reason),r.promise;i.client.globalObject?.constructor?.name==="ServiceWorkerGlobalScope"&&(i.serviceWorkers="none");let a=null,c=!1,l=null;return Por(n.signal,()=>{c=!0,yk(l!=null),l.abort(n.signal.reason);let f=a?.deref();fTe(r,i,f,n.signal.reason)}),l=Tot({request:i,processResponseEndOfBody:qor,processResponse:s(f=>{if(!c){if(f.aborted){fTe(r,i,a,l.serializedAbortReason);return}if(f.type==="error"){r.reject(new TypeError("fetch failed",{cause:f.error}));return}a=new WeakRef(zir(f,"immutable")),r.resolve(a.deref()),r=null}},"processResponse"),dispatcher:n[bor]}),r.promise}s(Hor,"fetch");function bot(t,e="other"){if(t.type==="error"&&t.aborted||!t.urlList?.length)return;let r=t.urlList[0],n=t.timingInfo,i=t.cacheState;gTe(r)&&n!==null&&(t.timingAllowPassed||(n=hTe({startTime:n.startTime}),i=""),n.endTime=wQ(),t.timingInfo=n,Iot(n,r.href,e,globalThis,i))}s(bot,"finalizeAndReportTiming");var Iot=performance.markResourceTiming;function fTe(t,e,r,n){if(t&&t.reject(n),e.body!=null&&Xte(e.body?.stream)&&e.body.stream.cancel(n).catch(o=>{if(o.code!=="ERR_INVALID_STATE")throw o}),r==null)return;let i=r[vot];i.body!=null&&Xte(i.body?.stream)&&i.body.stream.cancel(n).catch(o=>{if(o.code!=="ERR_INVALID_STATE")throw o})}s(fTe,"abortFetch");function Tot({request:t,processRequestBodyChunkLength:e,processRequestEndOfBody:r,processResponse:n,processResponseEndOfBody:i,processResponseConsumeBody:o,useParallelQueue:a=!1,dispatcher:c=Lor()}){yk(c);let l=null,u=!1;t.client!=null&&(l=t.client.globalObject,u=t.client.crossOriginIsolatedCapability);let f=wQ(u),p=hTe({startTime:f}),m={controller:new Zte(c),request:t,timingInfo:p,processRequestBodyChunkLength:e,processRequestEndOfBody:r,processResponse:n,processResponseConsumeBody:o,processResponseEndOfBody:i,taskDestination:l,crossOriginIsolatedCapability:u};return yk(!t.body||t.body.stream),t.window==="client"&&(t.window=t.client?.globalObject?.constructor?.name==="Window"?t.client:"no-window"),t.origin==="client"&&(t.origin=t.client.origin),t.policyContainer==="client"&&(t.client!=null?t.policyContainer=Zir(t.client.policyContainer):t.policyContainer=Xir()),t.headersList.contains("accept",!0)||t.headersList.append("accept","*/*",!0),t.headersList.contains("accept-language",!0)||t.headersList.append("accept-language","*",!0),t.priority,wor.has(t.destination),wot(m).catch(h=>{m.controller.terminate(h)}),m.controller}s(Tot,"fetching");async function wot(t,e=!1){let r=t.request,n=null;if(r.localURLsOnly&&!gor(c1(r))&&(n=ms("local URLs only")),oor(r),eor(r)==="blocked"&&(n=ms("bad port")),r.referrerPolicy===""&&(r.referrerPolicy=r.policyContainer.referrerPolicy),r.referrer!=="no-referrer"&&(r.referrer=lor(r)),n===null&&(n=await(async()=>{let o=c1(r);return mTe(o,r.url)&&r.responseTainting==="basic"||o.protocol==="data:"||r.mode==="navigate"||r.mode==="websocket"?(r.responseTainting="basic",await Cot(t)):r.mode==="same-origin"?ms('request mode cannot be "same-origin"'):r.mode==="no-cors"?r.redirect!=="follow"?ms('redirect mode cannot be "follow" for "no-cors" request'):(r.responseTainting="opaque",await Cot(t)):gTe(c1(r))?(r.responseTainting="cors",await Sot(t)):ms("URL scheme must be a HTTP(S) scheme")})()),e)return n;n.status!==0&&!n.internalResponse&&(r.responseTainting,r.responseTainting==="basic"?n=uTe(n,"basic"):r.responseTainting==="cors"?n=uTe(n,"cors"):r.responseTainting==="opaque"?n=uTe(n,"opaque"):yk(!1));let i=n.status===0?n:n.internalResponse;if(i.urlList.length===0&&i.urlList.push(...r.urlList),r.timingAllowFailed||(n.timingAllowPassed=!0),n.type==="opaque"&&i.status===206&&i.rangeRequested&&!r.headers.contains("range",!0)&&(n=i=ms()),n.status!==0&&(r.method==="HEAD"||r.method==="CONNECT"||Eot.includes(i.status))&&(i.body=null,t.controller.dump=!0),r.integrity){let o=s(c=>pTe(t,ms(c)),"processBodyError");if(r.responseTainting==="opaque"||n.body==null){o(n.error);return}let a=s(c=>{if(!Jir(c,r.integrity)){o("integrity mismatch");return}n.body=ATe(c)[0],pTe(t,n)},"processBody");await mor(n.body,a,o)}else pTe(t,n)}s(wot,"mainFetch");function Cot(t){if(Ak(t)&&t.request.redirectCount===0)return Promise.resolve(Kte(t));let{request:e}=t,{protocol:r}=c1(e);switch(r){case"about:":return Promise.resolve(ms("about scheme is not supported"));case"blob:":{dTe||(dTe=require("node:buffer").resolveObjectURL);let n=c1(e);if(n.search.length!==0)return Promise.resolve(ms("NetworkError when attempting to fetch resource."));let i=dTe(n.toString());if(e.method!=="GET"||!dor(i))return Promise.resolve(ms("invalid method"));let o=Yte(),a=i.size,c=Jte(`${a}`),l=i.type;if(e.headersList.contains("range",!0)){o.rangeRequested=!0;let u=e.headersList.get("range",!0),f=Cor(u,!0);if(f==="failure")return Promise.resolve(ms("failed to fetch the data URL"));let{rangeStartValue:p,rangeEndValue:m}=f;if(p===null)p=a-m,m=p+m-1;else{if(p>=a)return Promise.resolve(ms("Range start is greater than the blob's size."));(m===null||m>=a)&&(m=a-1)}let h=i.slice(p,m,l),g=Aot(h);o.body=g[0];let A=Jte(`${h.size}`),y=vor(p,m,a);o.status=206,o.statusText="Partial Content",o.headersList.set("content-length",A,!0),o.headersList.set("content-type",l,!0),o.headersList.set("content-range",y,!0)}else{let u=Aot(i);o.statusText="OK",o.body=u[0],o.headersList.set("content-length",c,!0),o.headersList.set("content-type",l,!0)}return Promise.resolve(o)}case"data:":{let n=c1(e),i=Bor(n);if(i==="failure")return Promise.resolve(ms("failed to fetch the data URL"));let o=Nor(i.mimeType);return Promise.resolve(Yte({statusText:"OK",headersList:[["content-type",{name:"Content-Type",value:o}]],body:ATe(i.body)[0]}))}case"file:":return Promise.resolve(ms("not implemented... yet..."));case"http:":case"https:":return Sot(t).catch(n=>ms(n));default:return Promise.resolve(ms("unknown scheme"))}}s(Cot,"schemeFetch");function $or(t,e){t.request.done=!0,t.processResponseDone!=null&&queueMicrotask(()=>t.processResponseDone(e))}s($or,"finalizeResponse");function pTe(t,e){let r=t.timingInfo,n=s(()=>{let o=Date.now();t.request.destination==="document"&&(t.controller.fullTimingInfo=r),t.controller.reportTimingSteps=()=>{if(t.request.url.protocol!=="https:")return;r.endTime=o;let c=e.cacheState,l=e.bodyInfo;e.timingAllowPassed||(r=hTe(r),c="");let u=0;if(t.request.mode!=="navigator"||!e.hasCrossOriginRedirects){u=e.status;let f=Eor(e.headersList);f!=="failure"&&(l.contentType=Mor(f))}t.request.initiatorType!=null&&Iot(r,t.request.url.href,t.request.initiatorType,globalThis,c,l,u)};let a=s(()=>{t.request.done=!0,t.processResponseEndOfBody!=null&&queueMicrotask(()=>t.processResponseEndOfBody(e)),t.request.initiatorType!=null&&t.controller.reportTimingSteps()},"processResponseEndOfBodyTask");queueMicrotask(()=>a())},"processResponseEndOfBody");t.processResponse!=null&&queueMicrotask(()=>{t.processResponse(e),t.processResponse=null});let i=e.type==="error"?e:e.internalResponse??e;i.body==null?n():kor(i.body.stream,()=>{n()})}s(pTe,"fetchFinale");async function Sot(t){let e=t.request,r=null,n=null,i=t.timingInfo;if(e.serviceWorkers,r===null){if(e.redirect==="follow"&&(e.serviceWorkers="none"),n=r=await _ot(t),e.responseTainting==="cors"&&aor(e,r)==="failure")return ms("cors failure");tor(e,r)==="failure"&&(e.timingAllowFailed=!0)}return(e.responseTainting==="opaque"||r.type==="opaque")&&cor(e.origin,e.client,e.destination,n)==="blocked"?ms("blocked"):(xot.has(n.status)&&(e.redirect!=="manual"&&t.controller.connection.destroy(void 0,!1),e.redirect==="error"?r=ms("unexpected redirect"):e.redirect==="manual"?r=n:e.redirect==="follow"?r=await Wor(t,r):yk(!1)),r.timingInfo=i,r)}s(Sot,"httpFetch");function Wor(t,e){let r=t.request,n=e.internalResponse?e.internalResponse:e,i;try{if(i=nor(n,c1(r).hash),i==null)return e}catch(a){return Promise.resolve(ms(a))}if(!gTe(i))return Promise.resolve(ms("URL scheme must be a HTTP(S) scheme"));if(r.redirectCount===20)return Promise.resolve(ms("redirect count exceeded"));if(r.redirectCount+=1,r.mode==="cors"&&(i.username||i.password)&&!mTe(r,i))return Promise.resolve(ms('cross origin not allowed for request mode "cors"'));if(r.responseTainting==="cors"&&(i.username||i.password))return Promise.resolve(ms('URL cannot contain credentials for request mode "cors"'));if(n.status!==303&&r.body!=null&&r.body.source==null)return Promise.resolve(ms());if([301,302].includes(n.status)&&r.method==="POST"||n.status===303&&!Qor.includes(r.method)){r.method="GET",r.body=null;for(let a of Tor)r.headersList.delete(a)}mTe(c1(r),i)||(r.headersList.delete("authorization",!0),r.headersList.delete("proxy-authorization",!0),r.headersList.delete("cookie",!0),r.headersList.delete("host",!0)),r.body!=null&&(yk(r.body.source!=null),r.body=ATe(r.body.source)[0]);let o=t.timingInfo;return o.redirectEndTime=o.postRedirectStartTime=wQ(t.crossOriginIsolatedCapability),o.redirectStartTime===0&&(o.redirectStartTime=o.startTime),r.urlList.push(i),ior(r,n),wot(t,!0)}s(Wor,"httpRedirectFetch");async function _ot(t,e=!1,r=!1){let n=t.request,i=null,o=null,a=null,c=null,l=!1;n.window==="no-window"&&n.redirect==="error"?(i=t,o=n):(o=Yir(n),i={...t},i.request=o);let u=n.credentials==="include"||n.credentials==="same-origin"&&n.responseTainting==="basic",f=o.body?o.body.length:null,p=null;if(o.body==null&&["POST","PUT"].includes(o.method)&&(p="0"),f!=null&&(p=Jte(`${f}`)),p!=null&&o.headersList.append("content-length",p,!0),f!=null&&o.keepalive,o.referrer instanceof URL&&o.headersList.append("referer",Jte(o.referrer.href),!0),ror(o),sor(o),o.headersList.contains("user-agent",!0)||o.headersList.append("user-agent",Uor),o.cache==="default"&&(o.headersList.contains("if-modified-since",!0)||o.headersList.contains("if-none-match",!0)||o.headersList.contains("if-unmodified-since",!0)||o.headersList.contains("if-match",!0)||o.headersList.contains("if-range",!0))&&(o.cache="no-store"),o.cache==="no-cache"&&!o.preventNoCacheCacheControlHeaderModification&&!o.headersList.contains("cache-control",!0)&&o.headersList.append("cache-control","max-age=0",!0),(o.cache==="no-store"||o.cache==="reload")&&(o.headersList.contains("pragma",!0)||o.headersList.append("pragma","no-cache",!0),o.headersList.contains("cache-control",!0)||o.headersList.append("cache-control","no-cache",!0)),o.headersList.contains("range",!0)&&o.headersList.append("accept-encoding","identity",!0),o.headersList.contains("accept-encoding",!0)||(Aor(c1(o))?o.headersList.append("accept-encoding","br, gzip, deflate",!0):o.headersList.append("accept-encoding","gzip, deflate",!0)),o.headersList.delete("host",!0),c==null&&(o.cache="no-store"),o.cache!=="no-store"&&o.cache,a==null){if(o.cache==="only-if-cached")return ms("only if cached");let m=await jor(i,u,r);!Ior.has(o.method)&&m.status>=200&&m.status<=399,l&&m.status,a==null&&(a=m)}if(a.urlList=[...o.urlList],o.headersList.contains("range",!0)&&(a.rangeRequested=!0),a.requestIncludesCredentials=u,a.status===407)return n.window==="no-window"?ms():Ak(t)?Kte(t):ms("proxy authentication required");if(a.status===421&&!r&&(n.body==null||n.body.source!=null)){if(Ak(t))return Kte(t);t.controller.connection.destroy(),a=await _ot(t,e,!0)}return a}s(_ot,"httpNetworkOrCacheFetch");async function jor(t,e=!1,r=!1){yk(!t.controller.connection||t.controller.connection.destroyed),t.controller.connection={abort:null,destroyed:!1,destroy(g,A=!0){this.destroyed||(this.destroyed=!0,A&&this.abort?.(g??new DOMException("The operation was aborted.","AbortError")))}};let n=t.request,i=null,o=t.timingInfo;null==null&&(n.cache="no-store");let c=r?"yes":"no";n.mode;let l=null;if(n.body==null&&t.processRequestEndOfBody)queueMicrotask(()=>t.processRequestEndOfBody());else if(n.body!=null){let g=s(async function*(E){Ak(t)||(yield E,t.processRequestBodyChunkLength?.(E.byteLength))},"processBodyChunk"),A=s(()=>{Ak(t)||t.processRequestEndOfBody&&t.processRequestEndOfBody()},"processEndOfBody"),y=s(E=>{Ak(t)||(E.name==="AbortError"?t.controller.abort():t.controller.terminate(E))},"processBodyError");l=async function*(){try{for await(let E of n.body.stream)yield*g(E);A()}catch(E){y(E)}}()}try{let{body:g,status:A,statusText:y,headersList:E,socket:b}=await h({body:l});if(b)i=Yte({status:A,statusText:y,headersList:E,socket:b});else{let S=g[Symbol.asyncIterator]();t.controller.next=()=>S.next(),i=Yte({status:A,statusText:y,headersList:E})}}catch(g){return g.name==="AbortError"?(t.controller.connection.destroy(),Kte(t,g)):ms(g)}let u=s(async()=>{await t.controller.resume()},"pullAlgorithm"),f=s(g=>{Ak(t)||t.controller.abort(g)},"cancelAlgorithm"),p=new ReadableStream({async start(g){t.controller.controller=g},async pull(g){await u(g)},async cancel(g){await f(g)},type:"bytes"});i.body={stream:p,source:null,length:null},t.controller.onAborted=m,t.controller.on("terminated",m),t.controller.resume=async()=>{for(;;){let g,A;try{let{done:E,value:b}=await t.controller.next();if(got(t))break;g=E?void 0:b}catch(E){t.controller.ended&&!o.encodedBodySize?g=void 0:(g=E,A=!0)}if(g===void 0){hor(t.controller.controller),$or(t,i);return}if(o.decodedBodySize+=g?.byteLength??0,A){t.controller.terminate(g);return}let y=new Uint8Array(g);if(y.byteLength&&t.controller.controller.enqueue(y),Dor(p)){t.controller.terminate();return}if(t.controller.controller.desiredSize<=0)return}};function m(g){got(t)?(i.aborted=!0,Xte(p)&&t.controller.controller.error(t.controller.serializedAbortReason)):Xte(p)&&t.controller.controller.error(new TypeError("terminated",{cause:por(g)?g:void 0})),t.controller.connection.destroy()}return s(m,"onAborted"),i;function h({body:g}){let A=c1(n),y=t.controller.dispatcher;return new Promise((E,b)=>y.dispatch({path:A.pathname+A.search,origin:A.origin,method:n.method,body:y.isMockActive?n.body&&(n.body.source||n.body.stream):g,headers:n.headersList.entries,maxRedirections:0,upgrade:n.mode==="websocket"?"websocket":void 0},{body:null,abort:null,onConnect(S){let{connection:R}=t.controller;o.finalConnectionTimingInfo=yor(void 0,o.postRedirectStartTime,t.crossOriginIsolatedCapability),R.destroyed?S(new DOMException("The operation was aborted.","AbortError")):(t.controller.on("terminated",S),this.abort=R.abort=S),o.finalNetworkRequestStartTime=wQ(t.crossOriginIsolatedCapability)},onResponseStarted(){o.finalNetworkResponseStartTime=wQ(t.crossOriginIsolatedCapability)},onHeaders(S,R,B,L){if(S<200)return;let O=[],Y="",V=new hot;for(let J=0;J<R.length;J+=2)V.append(yot(R[J]),R[J+1].toString("latin1"),!0);let z=V.get("content-encoding",!0);z&&(O=z.toLowerCase().split(",").map(J=>J.trim())),Y=V.get("location",!0),this.body=new _or({read:B});let Q=[],U=Y&&n.redirect==="follow"&&xot.has(S);if(O.length!==0&&n.method!=="HEAD"&&n.method!=="CONNECT"&&!Eot.includes(S)&&!U)for(let J=O.length-1;J>=0;--J){let j=O[J];if(j==="x-gzip"||j==="gzip")Q.push(fw.createGunzip({flush:fw.constants.Z_SYNC_FLUSH,finishFlush:fw.constants.Z_SYNC_FLUSH}));else if(j==="deflate")Q.push(xor({flush:fw.constants.Z_SYNC_FLUSH,finishFlush:fw.constants.Z_SYNC_FLUSH}));else if(j==="br")Q.push(fw.createBrotliDecompress({flush:fw.constants.BROTLI_OPERATION_FLUSH,finishFlush:fw.constants.BROTLI_OPERATION_FLUSH}));else{Q.length=0;break}}let Z=this.onError.bind(this);return E({status:S,statusText:L,headersList:V,body:Q.length?Ror(this.body,...Q,J=>{J&&this.onError(J)}).on("error",Z):this.body.on("error",Z)}),!0},onData(S){if(t.controller.dump)return;let R=S;return o.encodedBodySize+=R.byteLength,this.body.push(R)},onComplete(){this.abort&&t.controller.off("terminated",this.abort),t.controller.onAborted&&t.controller.off("terminated",t.controller.onAborted),t.controller.ended=!0,this.body.push(null)},onError(S){this.abort&&t.controller.off("terminated",this.abort),this.body?.destroy(S),t.controller.terminate(S),b(S)},onUpgrade(S,R,B){if(S!==101)return;let L=new hot;for(let O=0;O<R.length;O+=2)L.append(yot(R[O]),R[O+1].toString("latin1"),!0);return E({status:S,statusText:Oor[S],headersList:L,socket:B}),!0}}))}s(h,"dispatch")}s(jor,"httpNetworkFetch");Rot.exports={fetch:Hor,Fetch:Zte,fetching:Tot,finalizeAndReportTiming:bot}});var yTe=H((Xmi,kot)=>{"use strict";d();kot.exports={kState:Symbol("FileReader state"),kResult:Symbol("FileReader result"),kError:Symbol("FileReader error"),kLastProgressEventFired:Symbol("FileReader last progress event fired timestamp"),kEvents:Symbol("FileReader events"),kAborted:Symbol("FileReader aborted")}});var Dot=H((ehi,Pot)=>{"use strict";d();var{webidl:nm}=nd(),ere=Symbol("ProgressEvent state"),CTe=class t extends Event{static{s(this,"ProgressEvent")}constructor(e,r={}){e=nm.converters.DOMString(e,"ProgressEvent constructor","type"),r=nm.converters.ProgressEventInit(r??{}),super(e,r),this[ere]={lengthComputable:r.lengthComputable,loaded:r.loaded,total:r.total}}get lengthComputable(){return nm.brandCheck(this,t),this[ere].lengthComputable}get loaded(){return nm.brandCheck(this,t),this[ere].loaded}get total(){return nm.brandCheck(this,t),this[ere].total}};nm.converters.ProgressEventInit=nm.dictionaryConverter([{key:"lengthComputable",converter:nm.converters.boolean,defaultValue:s(()=>!1,"defaultValue")},{key:"loaded",converter:nm.converters["unsigned long long"],defaultValue:s(()=>0,"defaultValue")},{key:"total",converter:nm.converters["unsigned long long"],defaultValue:s(()=>0,"defaultValue")},{key:"bubbles",converter:nm.converters.boolean,defaultValue:s(()=>!1,"defaultValue")},{key:"cancelable",converter:nm.converters.boolean,defaultValue:s(()=>!1,"defaultValue")},{key:"composed",converter:nm.converters.boolean,defaultValue:s(()=>!1,"defaultValue")}]);Pot.exports={ProgressEvent:CTe}});var Not=H((nhi,Bot)=>{"use strict";d();function Gor(t){if(!t)return"failure";switch(t.trim().toLowerCase()){case"unicode-1-1-utf-8":case"unicode11utf8":case"unicode20utf8":case"utf-8":case"utf8":case"x-unicode20utf8":return"UTF-8";case"866":case"cp866":case"csibm866":case"ibm866":return"IBM866";case"csisolatin2":case"iso-8859-2":case"iso-ir-101":case"iso8859-2":case"iso88592":case"iso_8859-2":case"iso_8859-2:1987":case"l2":case"latin2":return"ISO-8859-2";case"csisolatin3":case"iso-8859-3":case"iso-ir-109":case"iso8859-3":case"iso88593":case"iso_8859-3":case"iso_8859-3:1988":case"l3":case"latin3":return"ISO-8859-3";case"csisolatin4":case"iso-8859-4":case"iso-ir-110":case"iso8859-4":case"iso88594":case"iso_8859-4":case"iso_8859-4:1988":case"l4":case"latin4":return"ISO-8859-4";case"csisolatincyrillic":case"cyrillic":case"iso-8859-5":case"iso-ir-144":case"iso8859-5":case"iso88595":case"iso_8859-5":case"iso_8859-5:1988":return"ISO-8859-5";case"arabic":case"asmo-708":case"csiso88596e":case"csiso88596i":case"csisolatinarabic":case"ecma-114":case"iso-8859-6":case"iso-8859-6-e":case"iso-8859-6-i":case"iso-ir-127":case"iso8859-6":case"iso88596":case"iso_8859-6":case"iso_8859-6:1987":return"ISO-8859-6";case"csisolatingreek":case"ecma-118":case"elot_928":case"greek":case"greek8":case"iso-8859-7":case"iso-ir-126":case"iso8859-7":case"iso88597":case"iso_8859-7":case"iso_8859-7:1987":case"sun_eu_greek":return"ISO-8859-7";case"csiso88598e":case"csisolatinhebrew":case"hebrew":case"iso-8859-8":case"iso-8859-8-e":case"iso-ir-138":case"iso8859-8":case"iso88598":case"iso_8859-8":case"iso_8859-8:1988":case"visual":return"ISO-8859-8";case"csiso88598i":case"iso-8859-8-i":case"logical":return"ISO-8859-8-I";case"csisolatin6":case"iso-8859-10":case"iso-ir-157":case"iso8859-10":case"iso885910":case"l6":case"latin6":return"ISO-8859-10";case"iso-8859-13":case"iso8859-13":case"iso885913":return"ISO-8859-13";case"iso-8859-14":case"iso8859-14":case"iso885914":return"ISO-8859-14";case"csisolatin9":case"iso-8859-15":case"iso8859-15":case"iso885915":case"iso_8859-15":case"l9":return"ISO-8859-15";case"iso-8859-16":return"ISO-8859-16";case"cskoi8r":case"koi":case"koi8":case"koi8-r":case"koi8_r":return"KOI8-R";case"koi8-ru":case"koi8-u":return"KOI8-U";case"csmacintosh":case"mac":case"macintosh":case"x-mac-roman":return"macintosh";case"iso-8859-11":case"iso8859-11":case"iso885911":case"tis-620":case"windows-874":return"windows-874";case"cp1250":case"windows-1250":case"x-cp1250":return"windows-1250";case"cp1251":case"windows-1251":case"x-cp1251":return"windows-1251";case"ansi_x3.4-1968":case"ascii":case"cp1252":case"cp819":case"csisolatin1":case"ibm819":case"iso-8859-1":case"iso-ir-100":case"iso8859-1":case"iso88591":case"iso_8859-1":case"iso_8859-1:1987":case"l1":case"latin1":case"us-ascii":case"windows-1252":case"x-cp1252":return"windows-1252";case"cp1253":case"windows-1253":case"x-cp1253":return"windows-1253";case"cp1254":case"csisolatin5":case"iso-8859-9":case"iso-ir-148":case"iso8859-9":case"iso88599":case"iso_8859-9":case"iso_8859-9:1989":case"l5":case"latin5":case"windows-1254":case"x-cp1254":return"windows-1254";case"cp1255":case"windows-1255":case"x-cp1255":return"windows-1255";case"cp1256":case"windows-1256":case"x-cp1256":return"windows-1256";case"cp1257":case"windows-1257":case"x-cp1257":return"windows-1257";case"cp1258":case"windows-1258":case"x-cp1258":return"windows-1258";case"x-mac-cyrillic":case"x-mac-ukrainian":return"x-mac-cyrillic";case"chinese":case"csgb2312":case"csiso58gb231280":case"gb2312":case"gb_2312":case"gb_2312-80":case"gbk":case"iso-ir-58":case"x-gbk":return"GBK";case"gb18030":return"gb18030";case"big5":case"big5-hkscs":case"cn-big5":case"csbig5":case"x-x-big5":return"Big5";case"cseucpkdfmtjapanese":case"euc-jp":case"x-euc-jp":return"EUC-JP";case"csiso2022jp":case"iso-2022-jp":return"ISO-2022-JP";case"csshiftjis":case"ms932":case"ms_kanji":case"shift-jis":case"shift_jis":case"sjis":case"windows-31j":case"x-sjis":return"Shift_JIS";case"cseuckr":case"csksc56011987":case"euc-kr":case"iso-ir-149":case"korean":case"ks_c_5601-1987":case"ks_c_5601-1989":case"ksc5601":case"ksc_5601":case"windows-949":return"EUC-KR";case"csiso2022kr":case"hz-gb-2312":case"iso-2022-cn":case"iso-2022-cn-ext":case"iso-2022-kr":case"replacement":return"replacement";case"unicodefffe":case"utf-16be":return"UTF-16BE";case"csunicode":case"iso-10646-ucs-2":case"ucs-2":case"unicode":case"unicodefeff":case"utf-16":case"utf-16le":return"UTF-16LE";case"x-user-defined":return"x-user-defined";default:return"failure"}}s(Gor,"getEncoding");Bot.exports={getEncoding:Gor}});var Hot=H((shi,qot)=>{"use strict";d();var{kState:RN,kError:vTe,kResult:Mot,kAborted:_Q,kLastProgressEventFired:xTe}=yTe(),{ProgressEvent:Vor}=Dot(),{getEncoding:Lot}=Not(),{serializeAMimeType:zor,parseMIMEType:Fot}=Mp(),{types:Kor}=require("node:util"),{StringDecoder:Oot}=require("string_decoder"),{btoa:Qot}=require("node:buffer"),Yor={enumerable:!0,writable:!1,configurable:!1};function Jor(t,e,r,n){if(t[RN]==="loading")throw new DOMException("Invalid state","InvalidStateError");t[RN]="loading",t[Mot]=null,t[vTe]=null;let o=e.stream().getReader(),a=[],c=o.read(),l=!0;(async()=>{for(;!t[_Q];)try{let{done:u,value:f}=await c;if(l&&!t[_Q]&&queueMicrotask(()=>{pw("loadstart",t)}),l=!1,!u&&Kor.isUint8Array(f))a.push(f),(t[xTe]===void 0||Date.now()-t[xTe]>=50)&&!t[_Q]&&(t[xTe]=Date.now(),queueMicrotask(()=>{pw("progress",t)})),c=o.read();else if(u){queueMicrotask(()=>{t[RN]="done";try{let p=Xor(a,r,e.type,n);if(t[_Q])return;t[Mot]=p,pw("load",t)}catch(p){t[vTe]=p,pw("error",t)}t[RN]!=="loading"&&pw("loadend",t)});break}}catch(u){if(t[_Q])return;queueMicrotask(()=>{t[RN]="done",t[vTe]=u,pw("error",t),t[RN]!=="loading"&&pw("loadend",t)});break}})()}s(Jor,"readOperation");function pw(t,e){let r=new Vor(t,{bubbles:!1,cancelable:!1});e.dispatchEvent(r)}s(pw,"fireAProgressEvent");function Xor(t,e,r,n){switch(e){case"DataURL":{let i="data:",o=Fot(r||"application/octet-stream");o!=="failure"&&(i+=zor(o)),i+=";base64,";let a=new Oot("latin1");for(let c of t)i+=Qot(a.write(c));return i+=Qot(a.end()),i}case"Text":{let i="failure";if(n&&(i=Lot(n)),i==="failure"&&r){let o=Fot(r);o!=="failure"&&(i=Lot(o.parameters.get("charset")))}return i==="failure"&&(i="UTF-8"),Zor(t,i)}case"ArrayBuffer":return Uot(t).buffer;case"BinaryString":{let i="",o=new Oot("latin1");for(let a of t)i+=o.write(a);return i+=o.end(),i}}}s(Xor,"packageData");function Zor(t,e){let r=Uot(t),n=esr(r),i=0;n!==null&&(e=n,i=n==="UTF-8"?3:2);let o=r.slice(i);return new TextDecoder(e).decode(o)}s(Zor,"decode");function esr(t){let[e,r,n]=t;return e===239&&r===187&&n===191?"UTF-8":e===254&&r===255?"UTF-16BE":e===255&&r===254?"UTF-16LE":null}s(esr,"BOMSniffing");function Uot(t){let e=t.reduce((n,i)=>n+i.byteLength,0),r=0;return t.reduce((n,i)=>(n.set(i,r),r+=i.byteLength,n),new Uint8Array(e))}s(Uot,"combineByteSequences");qot.exports={staticPropertyDescriptors:Yor,readOperation:Jor,fireAProgressEvent:pw}});var Got=H((lhi,jot)=>{"use strict";d();var{staticPropertyDescriptors:kN,readOperation:tre,fireAProgressEvent:$ot}=Hot(),{kState:Ck,kError:Wot,kResult:rre,kEvents:Xo,kAborted:tsr}=yTe(),{webidl:bs}=nd(),{kEnumerableProperty:Op}=$i(),VA=class t extends EventTarget{static{s(this,"FileReader")}constructor(){super(),this[Ck]="empty",this[rre]=null,this[Wot]=null,this[Xo]={loadend:null,error:null,abort:null,load:null,progress:null,loadstart:null}}readAsArrayBuffer(e){bs.brandCheck(this,t),bs.argumentLengthCheck(arguments,1,"FileReader.readAsArrayBuffer"),e=bs.converters.Blob(e,{strict:!1}),tre(this,e,"ArrayBuffer")}readAsBinaryString(e){bs.brandCheck(this,t),bs.argumentLengthCheck(arguments,1,"FileReader.readAsBinaryString"),e=bs.converters.Blob(e,{strict:!1}),tre(this,e,"BinaryString")}readAsText(e,r=void 0){bs.brandCheck(this,t),bs.argumentLengthCheck(arguments,1,"FileReader.readAsText"),e=bs.converters.Blob(e,{strict:!1}),r!==void 0&&(r=bs.converters.DOMString(r,"FileReader.readAsText","encoding")),tre(this,e,"Text",r)}readAsDataURL(e){bs.brandCheck(this,t),bs.argumentLengthCheck(arguments,1,"FileReader.readAsDataURL"),e=bs.converters.Blob(e,{strict:!1}),tre(this,e,"DataURL")}abort(){if(this[Ck]==="empty"||this[Ck]==="done"){this[rre]=null;return}this[Ck]==="loading"&&(this[Ck]="done",this[rre]=null),this[tsr]=!0,$ot("abort",this),this[Ck]!=="loading"&&$ot("loadend",this)}get readyState(){switch(bs.brandCheck(this,t),this[Ck]){case"empty":return this.EMPTY;case"loading":return this.LOADING;case"done":return this.DONE}}get result(){return bs.brandCheck(this,t),this[rre]}get error(){return bs.brandCheck(this,t),this[Wot]}get onloadend(){return bs.brandCheck(this,t),this[Xo].loadend}set onloadend(e){bs.brandCheck(this,t),this[Xo].loadend&&this.removeEventListener("loadend",this[Xo].loadend),typeof e=="function"?(this[Xo].loadend=e,this.addEventListener("loadend",e)):this[Xo].loadend=null}get onerror(){return bs.brandCheck(this,t),this[Xo].error}set onerror(e){bs.brandCheck(this,t),this[Xo].error&&this.removeEventListener("error",this[Xo].error),typeof e=="function"?(this[Xo].error=e,this.addEventListener("error",e)):this[Xo].error=null}get onloadstart(){return bs.brandCheck(this,t),this[Xo].loadstart}set onloadstart(e){bs.brandCheck(this,t),this[Xo].loadstart&&this.removeEventListener("loadstart",this[Xo].loadstart),typeof e=="function"?(this[Xo].loadstart=e,this.addEventListener("loadstart",e)):this[Xo].loadstart=null}get onprogress(){return bs.brandCheck(this,t),this[Xo].progress}set onprogress(e){bs.brandCheck(this,t),this[Xo].progress&&this.removeEventListener("progress",this[Xo].progress),typeof e=="function"?(this[Xo].progress=e,this.addEventListener("progress",e)):this[Xo].progress=null}get onload(){return bs.brandCheck(this,t),this[Xo].load}set onload(e){bs.brandCheck(this,t),this[Xo].load&&this.removeEventListener("load",this[Xo].load),typeof e=="function"?(this[Xo].load=e,this.addEventListener("load",e)):this[Xo].load=null}get onabort(){return bs.brandCheck(this,t),this[Xo].abort}set onabort(e){bs.brandCheck(this,t),this[Xo].abort&&this.removeEventListener("abort",this[Xo].abort),typeof e=="function"?(this[Xo].abort=e,this.addEventListener("abort",e)):this[Xo].abort=null}};VA.EMPTY=VA.prototype.EMPTY=0;VA.LOADING=VA.prototype.LOADING=1;VA.DONE=VA.prototype.DONE=2;Object.defineProperties(VA.prototype,{EMPTY:kN,LOADING:kN,DONE:kN,readAsArrayBuffer:Op,readAsBinaryString:Op,readAsText:Op,readAsDataURL:Op,abort:Op,readyState:Op,result:Op,error:Op,onloadstart:Op,onprogress:Op,onload:Op,onabort:Op,onerror:Op,onloadend:Op,[Symbol.toStringTag]:{value:"FileReader",writable:!1,enumerable:!1,configurable:!0}});Object.defineProperties(VA,{EMPTY:kN,LOADING:kN,DONE:kN});jot.exports={FileReader:VA}});var nre=H((fhi,Vot)=>{"use strict";d();Vot.exports={kConstruct:La().kConstruct}});var Yot=H((mhi,Kot)=>{"use strict";d();var rsr=require("node:assert"),{URLSerializer:zot}=Mp(),{isValidHeaderName:nsr}=J0();function isr(t,e,r=!1){let n=zot(t,r),i=zot(e,r);return n===i}s(isr,"urlEquals");function osr(t){rsr(t!==null);let e=[];for(let r of t.split(","))r=r.trim(),nsr(r)&&e.push(r);return e}s(osr,"getFieldValues");Kot.exports={urlEquals:isr,getFieldValues:osr}});var Zot=H((Ahi,Xot)=>{"use strict";d();var{kConstruct:ssr}=nre(),{urlEquals:asr,getFieldValues:ETe}=Yot(),{kEnumerableProperty:vk,isDisturbed:csr}=$i(),{webidl:gn}=nd(),{Response:lsr,cloneResponse:usr,fromInnerResponse:dsr}=TQ(),{Request:Kx,fromInnerRequest:fsr}=_N(),{kState:zA}=ew(),{fetching:psr}=SQ(),{urlIsHttpHttpsScheme:ire,createDeferredPromise:PN,readAllBytes:msr}=J0(),bTe=require("node:assert"),ore=class t{static{s(this,"Cache")}#e;constructor(){arguments[0]!==ssr&&gn.illegalConstructor(),gn.util.markAsUncloneable(this),this.#e=arguments[1]}async match(e,r={}){gn.brandCheck(this,t);let n="Cache.match";gn.argumentLengthCheck(arguments,1,n),e=gn.converters.RequestInfo(e,n,"request"),r=gn.converters.CacheQueryOptions(r,n,"options");let i=this.#r(e,r,1);if(i.length!==0)return i[0]}async matchAll(e=void 0,r={}){gn.brandCheck(this,t);let n="Cache.matchAll";return e!==void 0&&(e=gn.converters.RequestInfo(e,n,"request")),r=gn.converters.CacheQueryOptions(r,n,"options"),this.#r(e,r)}async add(e){gn.brandCheck(this,t);let r="Cache.add";gn.argumentLengthCheck(arguments,1,r),e=gn.converters.RequestInfo(e,r,"request");let n=[e];return await this.addAll(n)}async addAll(e){gn.brandCheck(this,t);let r="Cache.addAll";gn.argumentLengthCheck(arguments,1,r);let n=[],i=[];for(let m of e){if(m===void 0)throw gn.errors.conversionFailed({prefix:r,argument:"Argument 1",types:["undefined is not allowed"]});if(m=gn.converters.RequestInfo(m),typeof m=="string")continue;let h=m[zA];if(!ire(h.url)||h.method!=="GET")throw gn.errors.exception({header:r,message:"Expected http/s scheme when method is not GET."})}let o=[];for(let m of e){let h=new Kx(m)[zA];if(!ire(h.url))throw gn.errors.exception({header:r,message:"Expected http/s scheme."});h.initiator="fetch",h.destination="subresource",i.push(h);let g=PN();o.push(psr({request:h,processResponse(A){if(A.type==="error"||A.status===206||A.status<200||A.status>299)g.reject(gn.errors.exception({header:"Cache.addAll",message:"Received an invalid status code or the request failed."}));else if(A.headersList.contains("vary")){let y=ETe(A.headersList.get("vary"));for(let E of y)if(E==="*"){g.reject(gn.errors.exception({header:"Cache.addAll",message:"invalid vary field value"}));for(let b of o)b.abort();return}}},processResponseEndOfBody(A){if(A.aborted){g.reject(new DOMException("aborted","AbortError"));return}g.resolve(A)}})),n.push(g.promise)}let c=await Promise.all(n),l=[],u=0;for(let m of c){let h={type:"put",request:i[u],response:m};l.push(h),u++}let f=PN(),p=null;try{this.#t(l)}catch(m){p=m}return queueMicrotask(()=>{p===null?f.resolve(void 0):f.reject(p)}),f.promise}async put(e,r){gn.brandCheck(this,t);let n="Cache.put";gn.argumentLengthCheck(arguments,2,n),e=gn.converters.RequestInfo(e,n,"request"),r=gn.converters.Response(r,n,"response");let i=null;if(e instanceof Kx?i=e[zA]:i=new Kx(e)[zA],!ire(i.url)||i.method!=="GET")throw gn.errors.exception({header:n,message:"Expected an http/s scheme when method is not GET"});let o=r[zA];if(o.status===206)throw gn.errors.exception({header:n,message:"Got 206 status"});if(o.headersList.contains("vary")){let h=ETe(o.headersList.get("vary"));for(let g of h)if(g==="*")throw gn.errors.exception({header:n,message:"Got * vary field value"})}if(o.body&&(csr(o.body.stream)||o.body.stream.locked))throw gn.errors.exception({header:n,message:"Response body is locked or disturbed"});let a=usr(o),c=PN();if(o.body!=null){let g=o.body.stream.getReader();msr(g).then(c.resolve,c.reject)}else c.resolve(void 0);let l=[],u={type:"put",request:i,response:a};l.push(u);let f=await c.promise;a.body!=null&&(a.body.source=f);let p=PN(),m=null;try{this.#t(l)}catch(h){m=h}return queueMicrotask(()=>{m===null?p.resolve():p.reject(m)}),p.promise}async delete(e,r={}){gn.brandCheck(this,t);let n="Cache.delete";gn.argumentLengthCheck(arguments,1,n),e=gn.converters.RequestInfo(e,n,"request"),r=gn.converters.CacheQueryOptions(r,n,"options");let i=null;if(e instanceof Kx){if(i=e[zA],i.method!=="GET"&&!r.ignoreMethod)return!1}else bTe(typeof e=="string"),i=new Kx(e)[zA];let o=[],a={type:"delete",request:i,options:r};o.push(a);let c=PN(),l=null,u;try{u=this.#t(o)}catch(f){l=f}return queueMicrotask(()=>{l===null?c.resolve(!!u?.length):c.reject(l)}),c.promise}async keys(e=void 0,r={}){gn.brandCheck(this,t);let n="Cache.keys";e!==void 0&&(e=gn.converters.RequestInfo(e,n,"request")),r=gn.converters.CacheQueryOptions(r,n,"options");let i=null;if(e!==void 0)if(e instanceof Kx){if(i=e[zA],i.method!=="GET"&&!r.ignoreMethod)return[]}else typeof e=="string"&&(i=new Kx(e)[zA]);let o=PN(),a=[];if(e===void 0)for(let c of this.#e)a.push(c[0]);else{let c=this.#i(i,r);for(let l of c)a.push(l[0])}return queueMicrotask(()=>{let c=[];for(let l of a){let u=fsr(l,new AbortController().signal,"immutable");c.push(u)}o.resolve(Object.freeze(c))}),o.promise}#t(e){let r=this.#e,n=[...r],i=[],o=[];try{for(let a of e){if(a.type!=="delete"&&a.type!=="put")throw gn.errors.exception({header:"Cache.#batchCacheOperations",message:'operation type does not match "delete" or "put"'});if(a.type==="delete"&&a.response!=null)throw gn.errors.exception({header:"Cache.#batchCacheOperations",message:"delete operation should not have an associated response"});if(this.#i(a.request,a.options,i).length)throw new DOMException("???","InvalidStateError");let c;if(a.type==="delete"){if(c=this.#i(a.request,a.options),c.length===0)return[];for(let l of c){let u=r.indexOf(l);bTe(u!==-1),r.splice(u,1)}}else if(a.type==="put"){if(a.response==null)throw gn.errors.exception({header:"Cache.#batchCacheOperations",message:"put operation should have an associated response"});let l=a.request;if(!ire(l.url))throw gn.errors.exception({header:"Cache.#batchCacheOperations",message:"expected http or https scheme"});if(l.method!=="GET")throw gn.errors.exception({header:"Cache.#batchCacheOperations",message:"not get method"});if(a.options!=null)throw gn.errors.exception({header:"Cache.#batchCacheOperations",message:"options must not be defined"});c=this.#i(a.request);for(let u of c){let f=r.indexOf(u);bTe(f!==-1),r.splice(f,1)}r.push([a.request,a.response]),i.push([a.request,a.response])}o.push([a.request,a.response])}return o}catch(a){throw this.#e.length=0,this.#e=n,a}}#i(e,r,n){let i=[],o=n??this.#e;for(let a of o){let[c,l]=a;this.#n(e,c,l,r)&&i.push(a)}return i}#n(e,r,n=null,i){let o=new URL(e.url),a=new URL(r.url);if(i?.ignoreSearch&&(a.search="",o.search=""),!asr(o,a,!0))return!1;if(n==null||i?.ignoreVary||!n.headersList.contains("vary"))return!0;let c=ETe(n.headersList.get("vary"));for(let l of c){if(l==="*")return!1;let u=r.headersList.get(l),f=e.headersList.get(l);if(u!==f)return!1}return!0}#r(e,r,n=1/0){let i=null;if(e!==void 0)if(e instanceof Kx){if(i=e[zA],i.method!=="GET"&&!r.ignoreMethod)return[]}else typeof e=="string"&&(i=new Kx(e)[zA]);let o=[];if(e===void 0)for(let c of this.#e)o.push(c[1]);else{let c=this.#i(i,r);for(let l of c)o.push(l[1])}let a=[];for(let c of o){let l=dsr(c,"immutable");if(a.push(l.clone()),a.length>=n)break}return Object.freeze(a)}};Object.defineProperties(ore.prototype,{[Symbol.toStringTag]:{value:"Cache",configurable:!0},match:vk,matchAll:vk,add:vk,addAll:vk,put:vk,delete:vk,keys:vk});var Jot=[{key:"ignoreSearch",converter:gn.converters.boolean,defaultValue:s(()=>!1,"defaultValue")},{key:"ignoreMethod",converter:gn.converters.boolean,defaultValue:s(()=>!1,"defaultValue")},{key:"ignoreVary",converter:gn.converters.boolean,defaultValue:s(()=>!1,"defaultValue")}];gn.converters.CacheQueryOptions=gn.dictionaryConverter(Jot);gn.converters.MultiCacheQueryOptions=gn.dictionaryConverter([...Jot,{key:"cacheName",converter:gn.converters.DOMString}]);gn.converters.Response=gn.interfaceConverter(lsr);gn.converters["sequence<RequestInfo>"]=gn.sequenceConverter(gn.converters.RequestInfo);Xot.exports={Cache:ore}});var tst=H((vhi,est)=>{"use strict";d();var{kConstruct:RQ}=nre(),{Cache:sre}=Zot(),{webidl:jd}=nd(),{kEnumerableProperty:kQ}=$i(),are=class t{static{s(this,"CacheStorage")}#e=new Map;constructor(){arguments[0]!==RQ&&jd.illegalConstructor(),jd.util.markAsUncloneable(this)}async match(e,r={}){if(jd.brandCheck(this,t),jd.argumentLengthCheck(arguments,1,"CacheStorage.match"),e=jd.converters.RequestInfo(e),r=jd.converters.MultiCacheQueryOptions(r),r.cacheName!=null){if(this.#e.has(r.cacheName)){let n=this.#e.get(r.cacheName);return await new sre(RQ,n).match(e,r)}}else for(let n of this.#e.values()){let o=await new sre(RQ,n).match(e,r);if(o!==void 0)return o}}async has(e){jd.brandCheck(this,t);let r="CacheStorage.has";return jd.argumentLengthCheck(arguments,1,r),e=jd.converters.DOMString(e,r,"cacheName"),this.#e.has(e)}async open(e){jd.brandCheck(this,t);let r="CacheStorage.open";if(jd.argumentLengthCheck(arguments,1,r),e=jd.converters.DOMString(e,r,"cacheName"),this.#e.has(e)){let i=this.#e.get(e);return new sre(RQ,i)}let n=[];return this.#e.set(e,n),new sre(RQ,n)}async delete(e){jd.brandCheck(this,t);let r="CacheStorage.delete";return jd.argumentLengthCheck(arguments,1,r),e=jd.converters.DOMString(e,r,"cacheName"),this.#e.delete(e)}async keys(){return jd.brandCheck(this,t),[...this.#e.keys()]}};Object.defineProperties(are.prototype,{[Symbol.toStringTag]:{value:"CacheStorage",configurable:!0},match:kQ,has:kQ,open:kQ,delete:kQ,keys:kQ});est.exports={CacheStorage:are}});var nst=H((bhi,rst)=>{"use strict";d();rst.exports={maxAttributeValueSize:1024,maxNameValuePairSize:4096}});var ITe=H((Thi,cst)=>{"use strict";d();function hsr(t){for(let e=0;e<t.length;++e){let r=t.charCodeAt(e);if(r>=0&&r<=8||r>=10&&r<=31||r===127)return!0}return!1}s(hsr,"isCTLExcludingHtab");function ist(t){for(let e=0;e<t.length;++e){let r=t.charCodeAt(e);if(r<33||r>126||r===34||r===40||r===41||r===60||r===62||r===64||r===44||r===59||r===58||r===92||r===47||r===91||r===93||r===63||r===61||r===123||r===125)throw new Error("Invalid cookie name")}}s(ist,"validateCookieName");function ost(t){let e=t.length,r=0;if(t[0]==='"'){if(e===1||t[e-1]!=='"')throw new Error("Invalid cookie value");--e,++r}for(;r<e;){let n=t.charCodeAt(r++);if(n<33||n>126||n===34||n===44||n===59||n===92)throw new Error("Invalid cookie value")}}s(ost,"validateCookieValue");function sst(t){for(let e=0;e<t.length;++e){let r=t.charCodeAt(e);if(r<32||r===127||r===59)throw new Error("Invalid cookie path")}}s(sst,"validateCookiePath");function gsr(t){if(t.startsWith("-")||t.endsWith(".")||t.endsWith("-"))throw new Error("Invalid cookie domain")}s(gsr,"validateCookieDomain");var Asr=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],ysr=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],cre=Array(61).fill(0).map((t,e)=>e.toString().padStart(2,"0"));function ast(t){return typeof t=="number"&&(t=new Date(t)),`${Asr[t.getUTCDay()]}, ${cre[t.getUTCDate()]} ${ysr[t.getUTCMonth()]} ${t.getUTCFullYear()} ${cre[t.getUTCHours()]}:${cre[t.getUTCMinutes()]}:${cre[t.getUTCSeconds()]} GMT`}s(ast,"toIMFDate");function Csr(t){if(t<0)throw new Error("Invalid cookie max-age")}s(Csr,"validateCookieMaxAge");function vsr(t){if(t.name.length===0)return null;ist(t.name),ost(t.value);let e=[`${t.name}=${t.value}`];t.name.startsWith("__Secure-")&&(t.secure=!0),t.name.startsWith("__Host-")&&(t.secure=!0,t.domain=null,t.path="/"),t.secure&&e.push("Secure"),t.httpOnly&&e.push("HttpOnly"),typeof t.maxAge=="number"&&(Csr(t.maxAge),e.push(`Max-Age=${t.maxAge}`)),t.domain&&(gsr(t.domain),e.push(`Domain=${t.domain}`)),t.path&&(sst(t.path),e.push(`Path=${t.path}`)),t.expires&&t.expires.toString()!=="Invalid Date"&&e.push(`Expires=${ast(t.expires)}`),t.sameSite&&e.push(`SameSite=${t.sameSite}`);for(let r of t.unparsed){if(!r.includes("="))throw new Error("Invalid unparsed");let[n,...i]=r.split("=");e.push(`${n.trim()}=${i.join("=")}`)}return e.join("; ")}s(vsr,"stringify");cst.exports={isCTLExcludingHtab:hsr,validateCookieName:ist,validateCookiePath:sst,validateCookieValue:ost,toIMFDate:ast,stringify:vsr}});var ust=H((_hi,lst)=>{"use strict";d();var{maxNameValuePairSize:xsr,maxAttributeValueSize:Esr}=nst(),{isCTLExcludingHtab:bsr}=ITe(),{collectASequenceOfCodePointsFast:lre}=Mp(),Isr=require("node:assert");function Tsr(t){if(bsr(t))return null;let e="",r="",n="",i="";if(t.includes(";")){let o={position:0};e=lre(";",t,o),r=t.slice(o.position)}else e=t;if(!e.includes("="))i=e;else{let o={position:0};n=lre("=",e,o),i=e.slice(o.position+1)}return n=n.trim(),i=i.trim(),n.length+i.length>xsr?null:{name:n,value:i,...DN(r)}}s(Tsr,"parseSetCookie");function DN(t,e={}){if(t.length===0)return e;Isr(t[0]===";"),t=t.slice(1);let r="";t.includes(";")?(r=lre(";",t,{position:0}),t=t.slice(r.length)):(r=t,t="");let n="",i="";if(r.includes("=")){let a={position:0};n=lre("=",r,a),i=r.slice(a.position+1)}else n=r;if(n=n.trim(),i=i.trim(),i.length>Esr)return DN(t,e);let o=n.toLowerCase();if(o==="expires"){let a=new Date(i);e.expires=a}else if(o==="max-age"){let a=i.charCodeAt(0);if((a<48||a>57)&&i[0]!=="-"||!/^\d+$/.test(i))return DN(t,e);let c=Number(i);e.maxAge=c}else if(o==="domain"){let a=i;a[0]==="."&&(a=a.slice(1)),a=a.toLowerCase(),e.domain=a}else if(o==="path"){let a="";i.length===0||i[0]!=="/"?a="/":a=i,e.path=a}else if(o==="secure")e.secure=!0;else if(o==="httponly")e.httpOnly=!0;else if(o==="samesite"){let a="Default",c=i.toLowerCase();c.includes("none")&&(a="None"),c.includes("strict")&&(a="Strict"),c.includes("lax")&&(a="Lax"),e.sameSite=a}else e.unparsed??=[],e.unparsed.push(`${n}=${i}`);return DN(t,e)}s(DN,"parseUnparsedAttributes");lst.exports={parseSetCookie:Tsr,parseUnparsedAttributes:DN}});var pst=H((Phi,fst)=>{"use strict";d();var{parseSetCookie:wsr}=ust(),{stringify:Ssr}=ITe(),{webidl:mo}=nd(),{Headers:ure}=hk();function _sr(t){mo.argumentLengthCheck(arguments,1,"getCookies"),mo.brandCheck(t,ure,{strict:!1});let e=t.get("cookie"),r={};if(!e)return r;for(let n of e.split(";")){let[i,...o]=n.split("=");r[i.trim()]=o.join("=")}return r}s(_sr,"getCookies");function Rsr(t,e,r){mo.brandCheck(t,ure,{strict:!1});let n="deleteCookie";mo.argumentLengthCheck(arguments,2,n),e=mo.converters.DOMString(e,n,"name"),r=mo.converters.DeleteCookieAttributes(r),dst(t,{name:e,value:"",expires:new Date(0),...r})}s(Rsr,"deleteCookie");function ksr(t){mo.argumentLengthCheck(arguments,1,"getSetCookies"),mo.brandCheck(t,ure,{strict:!1});let e=t.getSetCookie();return e?e.map(r=>wsr(r)):[]}s(ksr,"getSetCookies");function dst(t,e){mo.argumentLengthCheck(arguments,2,"setCookie"),mo.brandCheck(t,ure,{strict:!1}),e=mo.converters.Cookie(e);let r=Ssr(e);r&&t.append("Set-Cookie",r)}s(dst,"setCookie");mo.converters.DeleteCookieAttributes=mo.dictionaryConverter([{converter:mo.nullableConverter(mo.converters.DOMString),key:"path",defaultValue:s(()=>null,"defaultValue")},{converter:mo.nullableConverter(mo.converters.DOMString),key:"domain",defaultValue:s(()=>null,"defaultValue")}]);mo.converters.Cookie=mo.dictionaryConverter([{converter:mo.converters.DOMString,key:"name"},{converter:mo.converters.DOMString,key:"value"},{converter:mo.nullableConverter(t=>typeof t=="number"?mo.converters["unsigned long long"](t):new Date(t)),key:"expires",defaultValue:s(()=>null,"defaultValue")},{converter:mo.nullableConverter(mo.converters["long long"]),key:"maxAge",defaultValue:s(()=>null,"defaultValue")},{converter:mo.nullableConverter(mo.converters.DOMString),key:"domain",defaultValue:s(()=>null,"defaultValue")},{converter:mo.nullableConverter(mo.converters.DOMString),key:"path",defaultValue:s(()=>null,"defaultValue")},{converter:mo.nullableConverter(mo.converters.boolean),key:"secure",defaultValue:s(()=>null,"defaultValue")},{converter:mo.nullableConverter(mo.converters.boolean),key:"httpOnly",defaultValue:s(()=>null,"defaultValue")},{converter:mo.converters.USVString,key:"sameSite",allowedValues:["Strict","Lax","None"]},{converter:mo.sequenceConverter(mo.converters.DOMString),key:"unparsed",defaultValue:s(()=>new Array(0),"defaultValue")}]);fst.exports={getCookies:_sr,deleteCookie:Rsr,getSetCookies:ksr,setCookie:dst}});var NN=H((Nhi,hst)=>{"use strict";d();var{webidl:pn}=nd(),{kEnumerableProperty:Qp}=$i(),{kConstruct:mst}=La(),{MessagePort:Psr}=require("node:worker_threads"),BN=class t extends Event{static{s(this,"MessageEvent")}#e;constructor(e,r={}){if(e===mst){super(arguments[1],arguments[2]),pn.util.markAsUncloneable(this);return}let n="MessageEvent constructor";pn.argumentLengthCheck(arguments,1,n),e=pn.converters.DOMString(e,n,"type"),r=pn.converters.MessageEventInit(r,n,"eventInitDict"),super(e,r),this.#e=r,pn.util.markAsUncloneable(this)}get data(){return pn.brandCheck(this,t),this.#e.data}get origin(){return pn.brandCheck(this,t),this.#e.origin}get lastEventId(){return pn.brandCheck(this,t),this.#e.lastEventId}get source(){return pn.brandCheck(this,t),this.#e.source}get ports(){return pn.brandCheck(this,t),Object.isFrozen(this.#e.ports)||Object.freeze(this.#e.ports),this.#e.ports}initMessageEvent(e,r=!1,n=!1,i=null,o="",a="",c=null,l=[]){return pn.brandCheck(this,t),pn.argumentLengthCheck(arguments,1,"MessageEvent.initMessageEvent"),new t(e,{bubbles:r,cancelable:n,data:i,origin:o,lastEventId:a,source:c,ports:l})}static createFastMessageEvent(e,r){let n=new t(mst,e,r);return n.#e=r,n.#e.data??=null,n.#e.origin??="",n.#e.lastEventId??="",n.#e.source??=null,n.#e.ports??=[],n}},{createFastMessageEvent:Dsr}=BN;delete BN.createFastMessageEvent;var dre=class t extends Event{static{s(this,"CloseEvent")}#e;constructor(e,r={}){let n="CloseEvent constructor";pn.argumentLengthCheck(arguments,1,n),e=pn.converters.DOMString(e,n,"type"),r=pn.converters.CloseEventInit(r),super(e,r),this.#e=r,pn.util.markAsUncloneable(this)}get wasClean(){return pn.brandCheck(this,t),this.#e.wasClean}get code(){return pn.brandCheck(this,t),this.#e.code}get reason(){return pn.brandCheck(this,t),this.#e.reason}},fre=class t extends Event{static{s(this,"ErrorEvent")}#e;constructor(e,r){let n="ErrorEvent constructor";pn.argumentLengthCheck(arguments,1,n),super(e,r),pn.util.markAsUncloneable(this),e=pn.converters.DOMString(e,n,"type"),r=pn.converters.ErrorEventInit(r??{}),this.#e=r}get message(){return pn.brandCheck(this,t),this.#e.message}get filename(){return pn.brandCheck(this,t),this.#e.filename}get lineno(){return pn.brandCheck(this,t),this.#e.lineno}get colno(){return pn.brandCheck(this,t),this.#e.colno}get error(){return pn.brandCheck(this,t),this.#e.error}};Object.defineProperties(BN.prototype,{[Symbol.toStringTag]:{value:"MessageEvent",configurable:!0},data:Qp,origin:Qp,lastEventId:Qp,source:Qp,ports:Qp,initMessageEvent:Qp});Object.defineProperties(dre.prototype,{[Symbol.toStringTag]:{value:"CloseEvent",configurable:!0},reason:Qp,code:Qp,wasClean:Qp});Object.defineProperties(fre.prototype,{[Symbol.toStringTag]:{value:"ErrorEvent",configurable:!0},message:Qp,filename:Qp,lineno:Qp,colno:Qp,error:Qp});pn.converters.MessagePort=pn.interfaceConverter(Psr);pn.converters["sequence<MessagePort>"]=pn.sequenceConverter(pn.converters.MessagePort);var TTe=[{key:"bubbles",converter:pn.converters.boolean,defaultValue:s(()=>!1,"defaultValue")},{key:"cancelable",converter:pn.converters.boolean,defaultValue:s(()=>!1,"defaultValue")},{key:"composed",converter:pn.converters.boolean,defaultValue:s(()=>!1,"defaultValue")}];pn.converters.MessageEventInit=pn.dictionaryConverter([...TTe,{key:"data",converter:pn.converters.any,defaultValue:s(()=>null,"defaultValue")},{key:"origin",converter:pn.converters.USVString,defaultValue:s(()=>"","defaultValue")},{key:"lastEventId",converter:pn.converters.DOMString,defaultValue:s(()=>"","defaultValue")},{key:"source",converter:pn.nullableConverter(pn.converters.MessagePort),defaultValue:s(()=>null,"defaultValue")},{key:"ports",converter:pn.converters["sequence<MessagePort>"],defaultValue:s(()=>new Array(0),"defaultValue")}]);pn.converters.CloseEventInit=pn.dictionaryConverter([...TTe,{key:"wasClean",converter:pn.converters.boolean,defaultValue:s(()=>!1,"defaultValue")},{key:"code",converter:pn.converters["unsigned short"],defaultValue:s(()=>0,"defaultValue")},{key:"reason",converter:pn.converters.USVString,defaultValue:s(()=>"","defaultValue")}]);pn.converters.ErrorEventInit=pn.dictionaryConverter([...TTe,{key:"message",converter:pn.converters.DOMString,defaultValue:s(()=>"","defaultValue")},{key:"filename",converter:pn.converters.USVString,defaultValue:s(()=>"","defaultValue")},{key:"lineno",converter:pn.converters["unsigned long"],defaultValue:s(()=>0,"defaultValue")},{key:"colno",converter:pn.converters["unsigned long"],defaultValue:s(()=>0,"defaultValue")},{key:"error",converter:pn.converters.any}]);hst.exports={MessageEvent:BN,CloseEvent:dre,ErrorEvent:fre,createFastMessageEvent:Dsr}});var xk=H((Fhi,gst)=>{"use strict";d();var Bsr="258EAFA5-E914-47DA-95CA-C5AB0DC85B11",Nsr={enumerable:!0,writable:!1,configurable:!1},Msr={CONNECTING:0,OPEN:1,CLOSING:2,CLOSED:3},Lsr={NOT_SENT:0,PROCESSING:1,SENT:2},Fsr={CONTINUATION:0,TEXT:1,BINARY:2,CLOSE:8,PING:9,PONG:10},Osr=2**16-1,Qsr={INFO:0,PAYLOADLENGTH_16:2,PAYLOADLENGTH_64:3,READ_DATA:4},Usr=Buffer.allocUnsafe(0),qsr={string:1,typedArray:2,arrayBuffer:3,blob:4};gst.exports={uid:Bsr,sentCloseFrameState:Lsr,staticPropertyDescriptors:Nsr,states:Msr,opcodes:Fsr,maxUnsigned16Bit:Osr,parserStates:Qsr,emptyBuffer:Usr,sendHints:qsr}});var PQ=H((Qhi,Ast)=>{"use strict";d();Ast.exports={kWebSocketURL:Symbol("url"),kReadyState:Symbol("ready state"),kController:Symbol("controller"),kResponse:Symbol("response"),kBinaryType:Symbol("binary type"),kSentClose:Symbol("sent close"),kReceivedClose:Symbol("received close"),kByteParser:Symbol("byte parser")}});var NQ=H((qhi,wst)=>{"use strict";d();var{kReadyState:DQ,kController:Hsr,kResponse:$sr,kBinaryType:Wsr,kWebSocketURL:jsr}=PQ(),{states:BQ,opcodes:mw}=xk(),{ErrorEvent:Gsr,createFastMessageEvent:Vsr}=NN(),{isUtf8:zsr}=require("node:buffer"),{collectASequenceOfCodePointsFast:Ksr,removeHTTPWhitespace:yst}=Mp();function Ysr(t){return t[DQ]===BQ.CONNECTING}s(Ysr,"isConnecting");function Jsr(t){return t[DQ]===BQ.OPEN}s(Jsr,"isEstablished");function Xsr(t){return t[DQ]===BQ.CLOSING}s(Xsr,"isClosing");function Zsr(t){return t[DQ]===BQ.CLOSED}s(Zsr,"isClosed");function wTe(t,e,r=(i,o)=>new Event(i,o),n={}){let i=r(t,n);e.dispatchEvent(i)}s(wTe,"fireEvent");function ear(t,e,r){if(t[DQ]!==BQ.OPEN)return;let n;if(e===mw.TEXT)try{n=Tst(r)}catch{vst(t,"Received invalid UTF-8 in text frame.");return}else e===mw.BINARY&&(t[Wsr]==="blob"?n=new Blob([r]):n=tar(r));wTe("message",t,Vsr,{origin:t[jsr].origin,data:n})}s(ear,"websocketMessageReceived");function tar(t){return t.byteLength===t.buffer.byteLength?t.buffer:t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength)}s(tar,"toArrayBuffer");function rar(t){if(t.length===0)return!1;for(let e=0;e<t.length;++e){let r=t.charCodeAt(e);if(r<33||r>126||r===34||r===40||r===41||r===44||r===47||r===58||r===59||r===60||r===61||r===62||r===63||r===64||r===91||r===92||r===93||r===123||r===125)return!1}return!0}s(rar,"isValidSubprotocol");function nar(t){return t>=1e3&&t<1015?t!==1004&&t!==1005&&t!==1006:t>=3e3&&t<=4999}s(nar,"isValidStatusCode");function vst(t,e){let{[Hsr]:r,[$sr]:n}=t;r.abort(),n?.socket&&!n.socket.destroyed&&n.socket.destroy(),e&&wTe("error",t,(i,o)=>new Gsr(i,o),{error:new Error(e),message:e})}s(vst,"failWebsocketConnection");function xst(t){return t===mw.CLOSE||t===mw.PING||t===mw.PONG}s(xst,"isControlFrame");function Est(t){return t===mw.CONTINUATION}s(Est,"isContinuationFrame");function bst(t){return t===mw.TEXT||t===mw.BINARY}s(bst,"isTextBinaryFrame");function iar(t){return bst(t)||Est(t)||xst(t)}s(iar,"isValidOpcode");function oar(t){let e={position:0},r=new Map;for(;e.position<t.length;){let n=Ksr(";",t,e),[i,o=""]=n.split("=");r.set(yst(i,!0,!1),yst(o,!1,!0)),e.position++}return r}s(oar,"parseExtensions");function sar(t){for(let e=0;e<t.length;e++){let r=t.charCodeAt(e);if(r<48||r>57)return!1}return!0}s(sar,"isValidClientWindowBits");var Ist=typeof process.versions.icu=="string",Cst=Ist?new TextDecoder("utf-8",{fatal:!0}):void 0,Tst=Ist?Cst.decode.bind(Cst):function(t){if(zsr(t))return t.toString("utf-8");throw new TypeError("Invalid utf-8 received.")};wst.exports={isConnecting:Ysr,isEstablished:Jsr,isClosing:Xsr,isClosed:Zsr,fireEvent:wTe,isValidSubprotocol:rar,isValidStatusCode:nar,failWebsocketConnection:vst,websocketMessageReceived:ear,utf8Decode:Tst,isControlFrame:xst,isContinuationFrame:Est,isTextBinaryFrame:bst,isValidOpcode:iar,parseExtensions:oar,isValidClientWindowBits:sar}});var mre=H((Whi,Sst)=>{"use strict";d();var{maxUnsigned16Bit:aar}=xk(),pre=16386,STe,MQ=null,MN=pre;try{STe=require("node:crypto")}catch{STe={randomFillSync:s(function(e,r,n){for(let i=0;i<e.length;++i)e[i]=Math.random()*255|0;return e},"randomFillSync")}}function car(){return MN===pre&&(MN=0,STe.randomFillSync(MQ??=Buffer.allocUnsafe(pre),0,pre)),[MQ[MN++],MQ[MN++],MQ[MN++],MQ[MN++]]}s(car,"generateMask");var _Te=class{static{s(this,"WebsocketFrameSend")}constructor(e){this.frameData=e}createFrame(e){let r=this.frameData,n=car(),i=r?.byteLength??0,o=i,a=6;i>aar?(a+=8,o=127):i>125&&(a+=2,o=126);let c=Buffer.allocUnsafe(i+a);c[0]=c[1]=0,c[0]|=128,c[0]=(c[0]&240)+e;c[a-4]=n[0],c[a-3]=n[1],c[a-2]=n[2],c[a-1]=n[3],c[1]=o,o===126?c.writeUInt16BE(i,2):o===127&&(c[2]=c[3]=0,c.writeUIntBE(i,4,6)),c[1]|=128;for(let l=0;l<i;++l)c[a+l]=r[l]^n[l&3];return c}};Sst.exports={WebsocketFrameSend:_Te}});var kTe=H((Vhi,Nst)=>{"use strict";d();var{uid:lar,states:LQ,sentCloseFrameState:hre,emptyBuffer:uar,opcodes:dar}=xk(),{kReadyState:FQ,kSentClose:gre,kByteParser:Rst,kReceivedClose:_st,kResponse:kst}=PQ(),{fireEvent:far,failWebsocketConnection:hw,isClosing:par,isClosed:mar,isEstablished:har,parseExtensions:gar}=NQ(),{channels:LN}=K3(),{CloseEvent:Aar}=NN(),{makeRequest:yar}=_N(),{fetching:Car}=SQ(),{Headers:xar,getHeadersList:Ear}=hk(),{getDecodeSplit:bar}=J0(),{WebsocketFrameSend:Iar}=mre(),RTe;try{RTe=require("node:crypto")}catch{}function Tar(t,e,r,n,i,o){let a=t;a.protocol=t.protocol==="ws:"?"http:":"https:";let c=yar({urlList:[a],client:r,serviceWorkers:"none",referrer:"no-referrer",mode:"websocket",credentials:"include",cache:"no-store",redirect:"error"});if(o.headers){let p=Ear(new xar(o.headers));c.headersList=p}let l=RTe.randomBytes(16).toString("base64");c.headersList.append("sec-websocket-key",l),c.headersList.append("sec-websocket-version","13");for(let p of e)c.headersList.append("sec-websocket-protocol",p);return c.headersList.append("sec-websocket-extensions","permessage-deflate; client_max_window_bits"),Car({request:c,useParallelQueue:!0,dispatcher:o.dispatcher,processResponse(p){if(p.type==="error"||p.status!==101){hw(n,"Received network error or non-101 status code.");return}if(e.length!==0&&!p.headersList.get("Sec-WebSocket-Protocol")){hw(n,"Server did not respond with sent protocols.");return}if(p.headersList.get("Upgrade")?.toLowerCase()!=="websocket"){hw(n,'Server did not set Upgrade header to "websocket".');return}if(p.headersList.get("Connection")?.toLowerCase()!=="upgrade"){hw(n,'Server did not set Connection header to "upgrade".');return}let m=p.headersList.get("Sec-WebSocket-Accept"),h=RTe.createHash("sha1").update(l+lar).digest("base64");if(m!==h){hw(n,"Incorrect hash received in Sec-WebSocket-Accept header.");return}let g=p.headersList.get("Sec-WebSocket-Extensions"),A;if(g!==null&&(A=gar(g),!A.has("permessage-deflate"))){hw(n,"Sec-WebSocket-Extensions header does not match.");return}let y=p.headersList.get("Sec-WebSocket-Protocol");if(y!==null&&!bar("sec-websocket-protocol",c.headersList).includes(y)){hw(n,"Protocol was not set in the opening handshake.");return}p.socket.on("data",Pst),p.socket.on("close",Dst),p.socket.on("error",Bst),LN.open.hasSubscribers&&LN.open.publish({address:p.socket.address(),protocol:y,extensions:g}),i(p,A)}})}s(Tar,"establishWebSocketConnection");function war(t,e,r,n){if(!(par(t)||mar(t)))if(!har(t))hw(t,"Connection was closed before it was established."),t[FQ]=LQ.CLOSING;else if(t[gre]===hre.NOT_SENT){t[gre]=hre.PROCESSING;let i=new Iar;e!==void 0&&r===void 0?(i.frameData=Buffer.allocUnsafe(2),i.frameData.writeUInt16BE(e,0)):e!==void 0&&r!==void 0?(i.frameData=Buffer.allocUnsafe(2+n),i.frameData.writeUInt16BE(e,0),i.frameData.write(r,2,"utf-8")):i.frameData=uar,t[kst].socket.write(i.createFrame(dar.CLOSE)),t[gre]=hre.SENT,t[FQ]=LQ.CLOSING}else t[FQ]=LQ.CLOSING}s(war,"closeWebSocketConnection");function Pst(t){this.ws[Rst].write(t)||this.pause()}s(Pst,"onSocketData");function Dst(){let{ws:t}=this,{[kst]:e}=t;e.socket.off("data",Pst),e.socket.off("close",Dst),e.socket.off("error",Bst);let r=t[gre]===hre.SENT&&t[_st],n=1005,i="",o=t[Rst].closingInfo;o&&!o.error?(n=o.code??1005,i=o.reason):t[_st]||(n=1006),t[FQ]=LQ.CLOSED,far("close",t,(a,c)=>new Aar(a,c),{wasClean:r,code:n,reason:i}),LN.close.hasSubscribers&&LN.close.publish({websocket:t,code:n,reason:i})}s(Dst,"onSocketClose");function Bst(t){let{ws:e}=this;e[FQ]=LQ.CLOSING,LN.socketError.hasSubscribers&&LN.socketError.publish(t),this.destroy()}s(Bst,"onSocketError");Nst.exports={establishWebSocketConnection:Tar,closeWebSocketConnection:war}});var Lst=H((Yhi,Mst)=>{"use strict";d();var{createInflateRaw:Sar,Z_DEFAULT_WINDOWBITS:_ar}=require("node:zlib"),{isValidClientWindowBits:Rar}=NQ(),kar=Buffer.from([0,0,255,255]),Are=Symbol("kBuffer"),yre=Symbol("kLength"),PTe=class{static{s(this,"PerMessageDeflate")}#e;#t={};constructor(e){this.#t.serverNoContextTakeover=e.has("server_no_context_takeover"),this.#t.serverMaxWindowBits=e.get("server_max_window_bits")}decompress(e,r,n){if(!this.#e){let i=_ar;if(this.#t.serverMaxWindowBits){if(!Rar(this.#t.serverMaxWindowBits)){n(new Error("Invalid server_max_window_bits"));return}i=Number.parseInt(this.#t.serverMaxWindowBits)}this.#e=Sar({windowBits:i}),this.#e[Are]=[],this.#e[yre]=0,this.#e.on("data",o=>{this.#e[Are].push(o),this.#e[yre]+=o.length}),this.#e.on("error",o=>{this.#e=null,n(o)})}this.#e.write(e),r&&this.#e.write(kar),this.#e.flush(()=>{let i=Buffer.concat(this.#e[Are],this.#e[yre]);this.#e[Are].length=0,this.#e[yre]=0,n(null,i)})}};Mst.exports={PerMessageDeflate:PTe}});var Vst=H((Zhi,Gst)=>{"use strict";d();var{Writable:Par}=require("node:stream"),Dar=require("node:assert"),{parserStates:Up,opcodes:FN,states:Bar,emptyBuffer:Fst,sentCloseFrameState:Ost}=xk(),{kReadyState:Nar,kSentClose:Qst,kResponse:Ust,kReceivedClose:qst}=PQ(),{channels:Cre}=K3(),{isValidStatusCode:Mar,isValidOpcode:Lar,failWebsocketConnection:Wh,websocketMessageReceived:Hst,utf8Decode:Far,isControlFrame:$st,isTextBinaryFrame:DTe,isContinuationFrame:Oar}=NQ(),{WebsocketFrameSend:Wst}=mre(),{closeWebSocketConnection:jst}=kTe(),{PerMessageDeflate:Qar}=Lst(),BTe=class extends Par{static{s(this,"ByteParser")}#e=[];#t=0;#i=!1;#n=Up.INFO;#r={};#o=[];#s;constructor(e,r){super(),this.ws=e,this.#s=r??new Map,this.#s.has("permessage-deflate")&&this.#s.set("permessage-deflate",new Qar(r))}_write(e,r,n){this.#e.push(e),this.#t+=e.length,this.#i=!0,this.run(n)}run(e){for(;this.#i;)if(this.#n===Up.INFO){if(this.#t<2)return e();let r=this.consume(2),n=(r[0]&128)!==0,i=r[0]&15,o=(r[1]&128)===128,a=!n&&i!==FN.CONTINUATION,c=r[1]&127,l=r[0]&64,u=r[0]&32,f=r[0]&16;if(!Lar(i))return Wh(this.ws,"Invalid opcode received"),e();if(o)return Wh(this.ws,"Frame cannot be masked"),e();if(l!==0&&!this.#s.has("permessage-deflate")){Wh(this.ws,"Expected RSV1 to be clear.");return}if(u!==0||f!==0){Wh(this.ws,"RSV1, RSV2, RSV3 must be clear");return}if(a&&!DTe(i)){Wh(this.ws,"Invalid frame type was fragmented.");return}if(DTe(i)&&this.#o.length>0){Wh(this.ws,"Expected continuation frame");return}if(this.#r.fragmented&&a){Wh(this.ws,"Fragmented frame exceeded 125 bytes.");return}if((c>125||a)&&$st(i)){Wh(this.ws,"Control frame either too large or fragmented");return}if(Oar(i)&&this.#o.length===0&&!this.#r.compressed){Wh(this.ws,"Unexpected continuation frame");return}c<=125?(this.#r.payloadLength=c,this.#n=Up.READ_DATA):c===126?this.#n=Up.PAYLOADLENGTH_16:c===127&&(this.#n=Up.PAYLOADLENGTH_64),DTe(i)&&(this.#r.binaryType=i,this.#r.compressed=l!==0),this.#r.opcode=i,this.#r.masked=o,this.#r.fin=n,this.#r.fragmented=a}else if(this.#n===Up.PAYLOADLENGTH_16){if(this.#t<2)return e();let r=this.consume(2);this.#r.payloadLength=r.readUInt16BE(0),this.#n=Up.READ_DATA}else if(this.#n===Up.PAYLOADLENGTH_64){if(this.#t<8)return e();let r=this.consume(8),n=r.readUInt32BE(0);if(n>2**31-1){Wh(this.ws,"Received payload length > 2^31 bytes.");return}let i=r.readUInt32BE(4);this.#r.payloadLength=(n<<8)+i,this.#n=Up.READ_DATA}else if(this.#n===Up.READ_DATA){if(this.#t<this.#r.payloadLength)return e();let r=this.consume(this.#r.payloadLength);if($st(this.#r.opcode))this.#i=this.parseControlFrame(r),this.#n=Up.INFO;else if(this.#r.compressed){this.#s.get("permessage-deflate").decompress(r,this.#r.fin,(n,i)=>{if(n){jst(this.ws,1007,n.message,n.message.length);return}if(this.#o.push(i),!this.#r.fin){this.#n=Up.INFO,this.#i=!0,this.run(e);return}Hst(this.ws,this.#r.binaryType,Buffer.concat(this.#o)),this.#i=!0,this.#n=Up.INFO,this.#o.length=0,this.run(e)}),this.#i=!1;break}else{if(this.#o.push(r),!this.#r.fragmented&&this.#r.fin){let n=Buffer.concat(this.#o);Hst(this.ws,this.#r.binaryType,n),this.#o.length=0}this.#n=Up.INFO}}}consume(e){if(e>this.#t)throw new Error("Called consume() before buffers satiated.");if(e===0)return Fst;if(this.#e[0].length===e)return this.#t-=this.#e[0].length,this.#e.shift();let r=Buffer.allocUnsafe(e),n=0;for(;n!==e;){let i=this.#e[0],{length:o}=i;if(o+n===e){r.set(this.#e.shift(),n);break}else if(o+n>e){r.set(i.subarray(0,e-n),n),this.#e[0]=i.subarray(e-n);break}else r.set(this.#e.shift(),n),n+=i.length}return this.#t-=e,r}parseCloseBody(e){Dar(e.length!==1);let r;if(e.length>=2&&(r=e.readUInt16BE(0)),r!==void 0&&!Mar(r))return{code:1002,reason:"Invalid status code",error:!0};let n=e.subarray(2);n[0]===239&&n[1]===187&&n[2]===191&&(n=n.subarray(3));try{n=Far(n)}catch{return{code:1007,reason:"Invalid UTF-8",error:!0}}return{code:r,reason:n,error:!1}}parseControlFrame(e){let{opcode:r,payloadLength:n}=this.#r;if(r===FN.CLOSE){if(n===1)return Wh(this.ws,"Received close frame with a 1-byte body."),!1;if(this.#r.closeInfo=this.parseCloseBody(e),this.#r.closeInfo.error){let{code:i,reason:o}=this.#r.closeInfo;return jst(this.ws,i,o,o.length),Wh(this.ws,o),!1}if(this.ws[Qst]!==Ost.SENT){let i=Fst;this.#r.closeInfo.code&&(i=Buffer.allocUnsafe(2),i.writeUInt16BE(this.#r.closeInfo.code,0));let o=new Wst(i);this.ws[Ust].socket.write(o.createFrame(FN.CLOSE),a=>{a||(this.ws[Qst]=Ost.SENT)})}return this.ws[Nar]=Bar.CLOSING,this.ws[qst]=!0,!1}else if(r===FN.PING){if(!this.ws[qst]){let i=new Wst(e);this.ws[Ust].socket.write(i.createFrame(FN.PONG)),Cre.ping.hasSubscribers&&Cre.ping.publish({payload:e})}}else r===FN.PONG&&Cre.pong.hasSubscribers&&Cre.pong.publish({payload:e});return!0}get closingInfo(){return this.#r.closeInfo}};Gst.exports={ByteParser:BTe}});var Xst=H((rgi,Jst)=>{"use strict";d();var{WebsocketFrameSend:Uar}=mre(),{opcodes:zst,sendHints:ON}=xk(),qar=jbe(),Kst=Buffer[Symbol.species],NTe=class{static{s(this,"SendQueue")}#e=new qar;#t=!1;#i;constructor(e){this.#i=e}add(e,r,n){if(n!==ON.blob){let o=Yst(e,n);if(!this.#t)this.#i.write(o,r);else{let a={promise:null,callback:r,frame:o};this.#e.push(a)}return}let i={promise:e.arrayBuffer().then(o=>{i.promise=null,i.frame=Yst(o,n)}),callback:r,frame:null};this.#e.push(i),this.#t||this.#n()}async#n(){this.#t=!0;let e=this.#e;for(;!e.isEmpty();){let r=e.shift();r.promise!==null&&await r.promise,this.#i.write(r.frame,r.callback),r.callback=r.frame=null}this.#t=!1}};function Yst(t,e){return new Uar(Har(t,e)).createFrame(e===ON.string?zst.TEXT:zst.BINARY)}s(Yst,"createFrame");function Har(t,e){switch(e){case ON.string:return Buffer.from(t);case ON.arrayBuffer:case ON.blob:return new Kst(t);case ON.typedArray:return new Kst(t.buffer,t.byteOffset,t.byteLength)}}s(Har,"toBuffer");Jst.exports={SendQueue:NTe}});var aat=H((ogi,sat)=>{"use strict";d();var{webidl:ei}=nd(),{URLSerializer:$ar}=Mp(),{environmentSettingsObject:Zst}=J0(),{staticPropertyDescriptors:gw,states:OQ,sentCloseFrameState:War,sendHints:vre}=xk(),{kWebSocketURL:eat,kReadyState:MTe,kController:jar,kBinaryType:xre,kResponse:tat,kSentClose:Gar,kByteParser:Var}=PQ(),{isConnecting:zar,isEstablished:Kar,isClosing:Yar,isValidSubprotocol:Jar,fireEvent:rat}=NQ(),{establishWebSocketConnection:Xar,closeWebSocketConnection:nat}=kTe(),{ByteParser:Zar}=Vst(),{kEnumerableProperty:jh,isBlobLike:iat}=$i(),{getGlobalDispatcher:ecr}=Mte(),{types:oat}=require("node:util"),{ErrorEvent:tcr,CloseEvent:rcr}=NN(),{SendQueue:ncr}=Xst(),im=class t extends EventTarget{static{s(this,"WebSocket")}#e={open:null,error:null,close:null,message:null};#t=0;#i="";#n="";#r;constructor(e,r=[]){super(),ei.util.markAsUncloneable(this);let n="WebSocket constructor";ei.argumentLengthCheck(arguments,1,n);let i=ei.converters["DOMString or sequence<DOMString> or WebSocketInit"](r,n,"options");e=ei.converters.USVString(e,n,"url"),r=i.protocols;let o=Zst.settingsObject.baseUrl,a;try{a=new URL(e,o)}catch(l){throw new DOMException(l,"SyntaxError")}if(a.protocol==="http:"?a.protocol="ws:":a.protocol==="https:"&&(a.protocol="wss:"),a.protocol!=="ws:"&&a.protocol!=="wss:")throw new DOMException(`Expected a ws: or wss: protocol, got ${a.protocol}`,"SyntaxError");if(a.hash||a.href.endsWith("#"))throw new DOMException("Got fragment","SyntaxError");if(typeof r=="string"&&(r=[r]),r.length!==new Set(r.map(l=>l.toLowerCase())).size)throw new DOMException("Invalid Sec-WebSocket-Protocol value","SyntaxError");if(r.length>0&&!r.every(l=>Jar(l)))throw new DOMException("Invalid Sec-WebSocket-Protocol value","SyntaxError");this[eat]=new URL(a.href);let c=Zst.settingsObject;this[jar]=Xar(a,r,c,this,(l,u)=>this.#o(l,u),i),this[MTe]=t.CONNECTING,this[Gar]=War.NOT_SENT,this[xre]="blob"}close(e=void 0,r=void 0){ei.brandCheck(this,t);let n="WebSocket.close";if(e!==void 0&&(e=ei.converters["unsigned short"](e,n,"code",{clamp:!0})),r!==void 0&&(r=ei.converters.USVString(r,n,"reason")),e!==void 0&&e!==1e3&&(e<3e3||e>4999))throw new DOMException("invalid code","InvalidAccessError");let i=0;if(r!==void 0&&(i=Buffer.byteLength(r),i>123))throw new DOMException(`Reason must be less than 123 bytes; received ${i}`,"SyntaxError");nat(this,e,r,i)}send(e){ei.brandCheck(this,t);let r="WebSocket.send";if(ei.argumentLengthCheck(arguments,1,r),e=ei.converters.WebSocketSendData(e,r,"data"),zar(this))throw new DOMException("Sent before connected.","InvalidStateError");if(!(!Kar(this)||Yar(this)))if(typeof e=="string"){let n=Buffer.byteLength(e);this.#t+=n,this.#r.add(e,()=>{this.#t-=n},vre.string)}else oat.isArrayBuffer(e)?(this.#t+=e.byteLength,this.#r.add(e,()=>{this.#t-=e.byteLength},vre.arrayBuffer)):ArrayBuffer.isView(e)?(this.#t+=e.byteLength,this.#r.add(e,()=>{this.#t-=e.byteLength},vre.typedArray)):iat(e)&&(this.#t+=e.size,this.#r.add(e,()=>{this.#t-=e.size},vre.blob))}get readyState(){return ei.brandCheck(this,t),this[MTe]}get bufferedAmount(){return ei.brandCheck(this,t),this.#t}get url(){return ei.brandCheck(this,t),$ar(this[eat])}get extensions(){return ei.brandCheck(this,t),this.#n}get protocol(){return ei.brandCheck(this,t),this.#i}get onopen(){return ei.brandCheck(this,t),this.#e.open}set onopen(e){ei.brandCheck(this,t),this.#e.open&&this.removeEventListener("open",this.#e.open),typeof e=="function"?(this.#e.open=e,this.addEventListener("open",e)):this.#e.open=null}get onerror(){return ei.brandCheck(this,t),this.#e.error}set onerror(e){ei.brandCheck(this,t),this.#e.error&&this.removeEventListener("error",this.#e.error),typeof e=="function"?(this.#e.error=e,this.addEventListener("error",e)):this.#e.error=null}get onclose(){return ei.brandCheck(this,t),this.#e.close}set onclose(e){ei.brandCheck(this,t),this.#e.close&&this.removeEventListener("close",this.#e.close),typeof e=="function"?(this.#e.close=e,this.addEventListener("close",e)):this.#e.close=null}get onmessage(){return ei.brandCheck(this,t),this.#e.message}set onmessage(e){ei.brandCheck(this,t),this.#e.message&&this.removeEventListener("message",this.#e.message),typeof e=="function"?(this.#e.message=e,this.addEventListener("message",e)):this.#e.message=null}get binaryType(){return ei.brandCheck(this,t),this[xre]}set binaryType(e){ei.brandCheck(this,t),e!=="blob"&&e!=="arraybuffer"?this[xre]="blob":this[xre]=e}#o(e,r){this[tat]=e;let n=new Zar(this,r);n.on("drain",icr),n.on("error",ocr.bind(this)),e.socket.ws=this,this[Var]=n,this.#r=new ncr(e.socket),this[MTe]=OQ.OPEN;let i=e.headersList.get("sec-websocket-extensions");i!==null&&(this.#n=i);let o=e.headersList.get("sec-websocket-protocol");o!==null&&(this.#i=o),rat("open",this)}};im.CONNECTING=im.prototype.CONNECTING=OQ.CONNECTING;im.OPEN=im.prototype.OPEN=OQ.OPEN;im.CLOSING=im.prototype.CLOSING=OQ.CLOSING;im.CLOSED=im.prototype.CLOSED=OQ.CLOSED;Object.defineProperties(im.prototype,{CONNECTING:gw,OPEN:gw,CLOSING:gw,CLOSED:gw,url:jh,readyState:jh,bufferedAmount:jh,onopen:jh,onerror:jh,onclose:jh,close:jh,onmessage:jh,binaryType:jh,send:jh,extensions:jh,protocol:jh,[Symbol.toStringTag]:{value:"WebSocket",writable:!1,enumerable:!1,configurable:!0}});Object.defineProperties(im,{CONNECTING:gw,OPEN:gw,CLOSING:gw,CLOSED:gw});ei.converters["sequence<DOMString>"]=ei.sequenceConverter(ei.converters.DOMString);ei.converters["DOMString or sequence<DOMString>"]=function(t,e,r){return ei.util.Type(t)==="Object"&&Symbol.iterator in t?ei.converters["sequence<DOMString>"](t):ei.converters.DOMString(t,e,r)};ei.converters.WebSocketInit=ei.dictionaryConverter([{key:"protocols",converter:ei.converters["DOMString or sequence<DOMString>"],defaultValue:s(()=>new Array(0),"defaultValue")},{key:"dispatcher",converter:ei.converters.any,defaultValue:s(()=>ecr(),"defaultValue")},{key:"headers",converter:ei.nullableConverter(ei.converters.HeadersInit)}]);ei.converters["DOMString or sequence<DOMString> or WebSocketInit"]=function(t){return ei.util.Type(t)==="Object"&&!(Symbol.iterator in t)?ei.converters.WebSocketInit(t):{protocols:ei.converters["DOMString or sequence<DOMString>"](t)}};ei.converters.WebSocketSendData=function(t){if(ei.util.Type(t)==="Object"){if(iat(t))return ei.converters.Blob(t,{strict:!1});if(ArrayBuffer.isView(t)||oat.isArrayBuffer(t))return ei.converters.BufferSource(t)}return ei.converters.USVString(t)};function icr(){this.ws[tat].socket.resume()}s(icr,"onParserDrain");function ocr(t){let e,r;t instanceof rcr?(e=t.reason,r=t.code):e=t.message,rat("error",this,()=>new tcr("error",{error:t,message:e})),nat(this,r)}s(ocr,"onParserError");sat.exports={WebSocket:im}});var LTe=H((cgi,cat)=>{"use strict";d();function scr(t){return t.indexOf("\0")===-1}s(scr,"isValidLastEventId");function acr(t){if(t.length===0)return!1;for(let e=0;e<t.length;e++)if(t.charCodeAt(e)<48||t.charCodeAt(e)>57)return!1;return!0}s(acr,"isASCIINumber");function ccr(t){return new Promise(e=>{setTimeout(e,t).unref()})}s(ccr,"delay");cat.exports={isValidLastEventId:scr,isASCIINumber:acr,delay:ccr}});var fat=H((dgi,dat)=>{"use strict";d();var{Transform:lcr}=require("node:stream"),{isASCIINumber:lat,isValidLastEventId:uat}=LTe(),Yx=[239,187,191],FTe=10,Ere=13,ucr=58,dcr=32,OTe=class extends lcr{static{s(this,"EventSourceStream")}state=null;checkBOM=!0;crlfCheck=!1;eventEndCheck=!1;buffer=null;pos=0;event={data:void 0,event:void 0,id:void 0,retry:void 0};constructor(e={}){e.readableObjectMode=!0,super(e),this.state=e.eventSourceSettings||{},e.push&&(this.push=e.push)}_transform(e,r,n){if(e.length===0){n();return}if(this.buffer?this.buffer=Buffer.concat([this.buffer,e]):this.buffer=e,this.checkBOM)switch(this.buffer.length){case 1:if(this.buffer[0]===Yx[0]){n();return}this.checkBOM=!1,n();return;case 2:if(this.buffer[0]===Yx[0]&&this.buffer[1]===Yx[1]){n();return}this.checkBOM=!1;break;case 3:if(this.buffer[0]===Yx[0]&&this.buffer[1]===Yx[1]&&this.buffer[2]===Yx[2]){this.buffer=Buffer.alloc(0),this.checkBOM=!1,n();return}this.checkBOM=!1;break;default:this.buffer[0]===Yx[0]&&this.buffer[1]===Yx[1]&&this.buffer[2]===Yx[2]&&(this.buffer=this.buffer.subarray(3)),this.checkBOM=!1;break}for(;this.pos<this.buffer.length;){if(this.eventEndCheck){if(this.crlfCheck){if(this.buffer[this.pos]===FTe){this.buffer=this.buffer.subarray(this.pos+1),this.pos=0,this.crlfCheck=!1;continue}this.crlfCheck=!1}if(this.buffer[this.pos]===FTe||this.buffer[this.pos]===Ere){this.buffer[this.pos]===Ere&&(this.crlfCheck=!0),this.buffer=this.buffer.subarray(this.pos+1),this.pos=0,(this.event.data!==void 0||this.event.event||this.event.id||this.event.retry)&&this.processEvent(this.event),this.clearEvent();continue}this.eventEndCheck=!1;continue}if(this.buffer[this.pos]===FTe||this.buffer[this.pos]===Ere){this.buffer[this.pos]===Ere&&(this.crlfCheck=!0),this.parseLine(this.buffer.subarray(0,this.pos),this.event),this.buffer=this.buffer.subarray(this.pos+1),this.pos=0,this.eventEndCheck=!0;continue}this.pos++}n()}parseLine(e,r){if(e.length===0)return;let n=e.indexOf(ucr);if(n===0)return;let i="",o="";if(n!==-1){i=e.subarray(0,n).toString("utf8");let a=n+1;e[a]===dcr&&++a,o=e.subarray(a).toString("utf8")}else i=e.toString("utf8"),o="";switch(i){case"data":r[i]===void 0?r[i]=o:r[i]+=`
${o}`;break;case"retry":lat(o)&&(r[i]=o);break;case"id":uat(o)&&(r[i]=o);break;case"event":o.length>0&&(r[i]=o);break}}processEvent(e){e.retry&&lat(e.retry)&&(this.state.reconnectionTime=parseInt(e.retry,10)),e.id&&uat(e.id)&&(this.state.lastEventId=e.id),e.data!==void 0&&this.push({type:e.event||"message",options:{data:e.data,lastEventId:this.state.lastEventId,origin:this.state.origin}})}clearEvent(){this.event={data:void 0,event:void 0,id:void 0,retry:void 0}}};dat.exports={EventSourceStream:OTe}});var vat=H((mgi,Cat)=>{"use strict";d();var{pipeline:fcr}=require("node:stream"),{fetching:pcr}=SQ(),{makeRequest:mcr}=_N(),{webidl:Jx}=nd(),{EventSourceStream:hcr}=fat(),{parseMIMEType:gcr}=Mp(),{createFastMessageEvent:Acr}=NN(),{isNetworkError:pat}=TQ(),{delay:ycr}=LTe(),{kEnumerableProperty:Ek}=$i(),{environmentSettingsObject:mat}=J0(),hat=!1,gat=3e3,QQ=0,Aat=1,UQ=2,Ccr="anonymous",vcr="use-credentials",QN=class t extends EventTarget{static{s(this,"EventSource")}#e={open:null,error:null,message:null};#t=null;#i=!1;#n=QQ;#r=null;#o=null;#s;#a;constructor(e,r={}){super(),Jx.util.markAsUncloneable(this);let n="EventSource constructor";Jx.argumentLengthCheck(arguments,1,n),hat||(hat=!0,process.emitWarning("EventSource is experimental, expect them to change at any time.",{code:"UNDICI-ES"})),e=Jx.converters.USVString(e,n,"url"),r=Jx.converters.EventSourceInitDict(r,n,"eventSourceInitDict"),this.#s=r.dispatcher,this.#a={lastEventId:"",reconnectionTime:gat};let i=mat,o;try{o=new URL(e,i.settingsObject.baseUrl),this.#a.origin=o.origin}catch(l){throw new DOMException(l,"SyntaxError")}this.#t=o.href;let a=Ccr;r.withCredentials&&(a=vcr,this.#i=!0);let c={redirect:"follow",keepalive:!0,mode:"cors",credentials:a==="anonymous"?"same-origin":"omit",referrer:"no-referrer"};c.client=mat.settingsObject,c.headersList=[["accept",{name:"accept",value:"text/event-stream"}]],c.cache="no-store",c.initiator="other",c.urlList=[new URL(this.#t)],this.#r=mcr(c),this.#c()}get readyState(){return this.#n}get url(){return this.#t}get withCredentials(){return this.#i}#c(){if(this.#n===UQ)return;this.#n=QQ;let e={request:this.#r,dispatcher:this.#s},r=s(n=>{pat(n)&&(this.dispatchEvent(new Event("error")),this.close()),this.#l()},"processEventSourceEndOfBody");e.processResponseEndOfBody=r,e.processResponse=n=>{if(pat(n))if(n.aborted){this.close(),this.dispatchEvent(new Event("error"));return}else{this.#l();return}let i=n.headersList.get("content-type",!0),o=i!==null?gcr(i):"failure",a=o!=="failure"&&o.essence==="text/event-stream";if(n.status!==200||a===!1){this.close(),this.dispatchEvent(new Event("error"));return}this.#n=Aat,this.dispatchEvent(new Event("open")),this.#a.origin=n.urlList[n.urlList.length-1].origin;let c=new hcr({eventSourceSettings:this.#a,push:s(l=>{this.dispatchEvent(Acr(l.type,l.options))},"push")});fcr(n.body.stream,c,l=>{l?.aborted===!1&&(this.close(),this.dispatchEvent(new Event("error")))})},this.#o=pcr(e)}async#l(){this.#n!==UQ&&(this.#n=QQ,this.dispatchEvent(new Event("error")),await ycr(this.#a.reconnectionTime),this.#n===QQ&&(this.#a.lastEventId.length&&this.#r.headersList.set("last-event-id",this.#a.lastEventId,!0),this.#c()))}close(){Jx.brandCheck(this,t),this.#n!==UQ&&(this.#n=UQ,this.#o.abort(),this.#r=null)}get onopen(){return this.#e.open}set onopen(e){this.#e.open&&this.removeEventListener("open",this.#e.open),typeof e=="function"?(this.#e.open=e,this.addEventListener("open",e)):this.#e.open=null}get onmessage(){return this.#e.message}set onmessage(e){this.#e.message&&this.removeEventListener("message",this.#e.message),typeof e=="function"?(this.#e.message=e,this.addEventListener("message",e)):this.#e.message=null}get onerror(){return this.#e.error}set onerror(e){this.#e.error&&this.removeEventListener("error",this.#e.error),typeof e=="function"?(this.#e.error=e,this.addEventListener("error",e)):this.#e.error=null}},yat={CONNECTING:{__proto__:null,configurable:!1,enumerable:!0,value:QQ,writable:!1},OPEN:{__proto__:null,configurable:!1,enumerable:!0,value:Aat,writable:!1},CLOSED:{__proto__:null,configurable:!1,enumerable:!0,value:UQ,writable:!1}};Object.defineProperties(QN,yat);Object.defineProperties(QN.prototype,yat);Object.defineProperties(QN.prototype,{close:Ek,onerror:Ek,onmessage:Ek,onopen:Ek,readyState:Ek,url:Ek,withCredentials:Ek});Jx.converters.EventSourceInitDict=Jx.dictionaryConverter([{key:"withCredentials",converter:Jx.converters.boolean,defaultValue:s(()=>!1,"defaultValue")},{key:"dispatcher",converter:Jx.converters.any}]);Cat.exports={EventSource:QN,defaultReconnectionTime:gat}});var Iat=H((Agi,$n)=>{"use strict";d();var xcr=uQ(),xat=H7(),Ecr=hN(),bcr=_rt(),Icr=gN(),Tcr=lIe(),wcr=jrt(),Scr=Jrt(),Eat=Jo(),Ire=$i(),{InvalidArgumentError:bre}=Eat,UN=Fnt(),_cr=W7(),Rcr=WIe(),kcr=yit(),Pcr=VIe(),Dcr=PIe(),Bcr=Tte(),{getGlobalDispatcher:bat,setGlobalDispatcher:Ncr}=Mte(),Mcr=Lte(),Lcr=pte(),Fcr=mte();Object.assign(xat.prototype,UN);$n.exports.Dispatcher=xat;$n.exports.Client=xcr;$n.exports.Pool=Ecr;$n.exports.BalancedPool=bcr;$n.exports.Agent=Icr;$n.exports.ProxyAgent=Tcr;$n.exports.EnvHttpProxyAgent=wcr;$n.exports.RetryAgent=Scr;$n.exports.RetryHandler=Bcr;$n.exports.DecoratorHandler=Mcr;$n.exports.RedirectHandler=Lcr;$n.exports.createRedirectInterceptor=Fcr;$n.exports.interceptors={redirect:Tit(),retry:Sit(),dump:Rit(),dns:Dit()};$n.exports.buildConnector=_cr;$n.exports.errors=Eat;$n.exports.util={parseHeaders:Ire.parseHeaders,headerNameToString:Ire.headerNameToString};function qQ(t){return(e,r,n)=>{if(typeof r=="function"&&(n=r,r=null),!e||typeof e!="string"&&typeof e!="object"&&!(e instanceof URL))throw new bre("invalid url");if(r!=null&&typeof r!="object")throw new bre("invalid opts");if(r&&r.path!=null){if(typeof r.path!="string")throw new bre("invalid opts.path");let a=r.path;r.path.startsWith("/")||(a=`/${a}`),e=new URL(Ire.parseOrigin(e).origin+a)}else r||(r=typeof e=="object"?e:{}),e=Ire.parseURL(e);let{agent:i,dispatcher:o=bat()}=r;if(i)throw new bre("unsupported opts.agent. Did you mean opts.client?");return t.call(o,{...r,origin:e.origin,path:e.search?`${e.pathname}${e.search}`:e.pathname,method:r.method||(r.body?"PUT":"GET")},n)}}s(qQ,"makeDispatcher");$n.exports.setGlobalDispatcher=Ncr;$n.exports.getGlobalDispatcher=bat;var Ocr=SQ().fetch;$n.exports.fetch=s(async function(e,r=void 0){try{return await Ocr(e,r)}catch(n){throw n&&typeof n=="object"&&Error.captureStackTrace(n),n}},"fetch");$n.exports.Headers=hk().Headers;$n.exports.Response=TQ().Response;$n.exports.Request=_N().Request;$n.exports.FormData=J7().FormData;$n.exports.File=globalThis.File??require("node:buffer").File;$n.exports.FileReader=Got().FileReader;var{setGlobalOrigin:Qcr,getGlobalOrigin:Ucr}=ube();$n.exports.setGlobalOrigin=Qcr;$n.exports.getGlobalOrigin=Ucr;var{CacheStorage:qcr}=tst(),{kConstruct:Hcr}=nre();$n.exports.caches=new qcr(Hcr);var{deleteCookie:$cr,getCookies:Wcr,getSetCookies:jcr,setCookie:Gcr}=pst();$n.exports.deleteCookie=$cr;$n.exports.getCookies=Wcr;$n.exports.getSetCookies=jcr;$n.exports.setCookie=Gcr;var{parseMIMEType:Vcr,serializeAMimeType:zcr}=Mp();$n.exports.parseMIMEType=Vcr;$n.exports.serializeAMimeType=zcr;var{CloseEvent:Kcr,ErrorEvent:Ycr,MessageEvent:Jcr}=NN();$n.exports.WebSocket=aat().WebSocket;$n.exports.CloseEvent=Kcr;$n.exports.ErrorEvent=Ycr;$n.exports.MessageEvent=Jcr;$n.exports.request=qQ(UN.request);$n.exports.stream=qQ(UN.stream);$n.exports.pipeline=qQ(UN.pipeline);$n.exports.connect=qQ(UN.connect);$n.exports.upgrade=qQ(UN.upgrade);$n.exports.MockClient=Rcr;$n.exports.MockPool=Pcr;$n.exports.MockAgent=kcr;$n.exports.mockErrors=Dcr;var{EventSource:Xcr}=vat();$n.exports.EventSource=Xcr});var Ri=H((vgi,Tat)=>{d();Tat.exports={options:{usePureJavaScript:!1}}});var _at=H((Egi,Sat)=>{d();var QTe={};Sat.exports=QTe;var wat={};QTe.encode=function(t,e,r){if(typeof e!="string")throw new TypeError('"alphabet" must be a string.');if(r!==void 0&&typeof r!="number")throw new TypeError('"maxline" must be a number.');var n="";if(!(t instanceof Uint8Array))n=Zcr(t,e);else{var i=0,o=e.length,a=e.charAt(0),c=[0];for(i=0;i<t.length;++i){for(var l=0,u=t[i];l<c.length;++l)u+=c[l]<<8,c[l]=u%o,u=u/o|0;for(;u>0;)c.push(u%o),u=u/o|0}for(i=0;t[i]===0&&i<t.length-1;++i)n+=a;for(i=c.length-1;i>=0;--i)n+=e[c[i]]}if(r){var f=new RegExp(".{1,"+r+"}","g");n=n.match(f).join(`\r
`)}return n};QTe.decode=function(t,e){if(typeof t!="string")throw new TypeError('"input" must be a string.');if(typeof e!="string")throw new TypeError('"alphabet" must be a string.');var r=wat[e];if(!r){r=wat[e]=[];for(var n=0;n<e.length;++n)r[e.charCodeAt(n)]=n}t=t.replace(/\s/g,"");for(var i=e.length,o=e.charAt(0),a=[0],n=0;n<t.length;n++){var c=r[t.charCodeAt(n)];if(c===void 0)return;for(var l=0,u=c;l<a.length;++l)u+=a[l]*i,a[l]=u&255,u>>=8;for(;u>0;)a.push(u&255),u>>=8}for(var f=0;t[f]===o&&f<t.length-1;++f)a.push(0);return typeof Buffer<"u"?Buffer.from(a.reverse()):new Uint8Array(a.reverse())};function Zcr(t,e){var r=0,n=e.length,i=e.charAt(0),o=[0];for(r=0;r<t.length();++r){for(var a=0,c=t.at(r);a<o.length;++a)c+=o[a]<<8,o[a]=c%n,c=c/n|0;for(;c>0;)o.push(c%n),c=c/n|0}var l="";for(r=0;t.at(r)===0&&r<t.length()-1;++r)l+=i;for(r=o.length-1;r>=0;--r)l+=e[o[r]];return l}s(Zcr,"_encodeWithByteBuffer")});var Ho=H((Tgi,Dat)=>{d();var Rat=Ri(),kat=_at(),Me=Dat.exports=Rat.util=Rat.util||{};(function(){if(typeof process<"u"&&process.nextTick&&!process.browser){Me.nextTick=process.nextTick,typeof setImmediate=="function"?Me.setImmediate=setImmediate:Me.setImmediate=Me.nextTick;return}if(typeof setImmediate=="function"){Me.setImmediate=function(){return setImmediate.apply(void 0,arguments)},Me.nextTick=function(c){return setImmediate(c)};return}if(Me.setImmediate=function(c){setTimeout(c,0)},typeof window<"u"&&typeof window.postMessage=="function"){let c=function(l){if(l.source===window&&l.data===t){l.stopPropagation();var u=e.slice();e.length=0,u.forEach(function(f){f()})}};var a=c;s(c,"handler");var t="forge.setImmediate",e=[];Me.setImmediate=function(l){e.push(l),e.length===1&&window.postMessage(t,"*")},window.addEventListener("message",c,!0)}if(typeof MutationObserver<"u"){var r=Date.now(),n=!0,i=document.createElement("div"),e=[];new MutationObserver(function(){var l=e.slice();e.length=0,l.forEach(function(u){u()})}).observe(i,{attributes:!0});var o=Me.setImmediate;Me.setImmediate=function(l){Date.now()-r>15?(r=Date.now(),o(l)):(e.push(l),e.length===1&&i.setAttribute("a",n=!n))}}Me.nextTick=Me.setImmediate})();Me.isNodejs=typeof process<"u"&&process.versions&&process.versions.node;Me.globalScope=function(){return Me.isNodejs?global:typeof self>"u"?window:self}();Me.isArray=Array.isArray||function(t){return Object.prototype.toString.call(t)==="[object Array]"};Me.isArrayBuffer=function(t){return typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer};Me.isArrayBufferView=function(t){return t&&Me.isArrayBuffer(t.buffer)&&t.byteLength!==void 0};function HQ(t){if(!(t===8||t===16||t===24||t===32))throw new Error("Only 8, 16, 24, or 32 bits supported: "+t)}s(HQ,"_checkBitsParam");Me.ByteBuffer=UTe;function UTe(t){if(this.data="",this.read=0,typeof t=="string")this.data=t;else if(Me.isArrayBuffer(t)||Me.isArrayBufferView(t))if(typeof Buffer<"u"&&t instanceof Buffer)this.data=t.toString("binary");else{var e=new Uint8Array(t);try{this.data=String.fromCharCode.apply(null,e)}catch{for(var r=0;r<e.length;++r)this.putByte(e[r])}}else(t instanceof UTe||typeof t=="object"&&typeof t.data=="string"&&typeof t.read=="number")&&(this.data=t.data,this.read=t.read);this._constructedStringLength=0}s(UTe,"ByteStringBuffer");Me.ByteStringBuffer=UTe;var elr=4096;Me.ByteStringBuffer.prototype._optimizeConstructedString=function(t){this._constructedStringLength+=t,this._constructedStringLength>elr&&(this.data.substr(0,1),this._constructedStringLength=0)};Me.ByteStringBuffer.prototype.length=function(){return this.data.length-this.read};Me.ByteStringBuffer.prototype.isEmpty=function(){return this.length()<=0};Me.ByteStringBuffer.prototype.putByte=function(t){return this.putBytes(String.fromCharCode(t))};Me.ByteStringBuffer.prototype.fillWithByte=function(t,e){t=String.fromCharCode(t);for(var r=this.data;e>0;)e&1&&(r+=t),e>>>=1,e>0&&(t+=t);return this.data=r,this._optimizeConstructedString(e),this};Me.ByteStringBuffer.prototype.putBytes=function(t){return this.data+=t,this._optimizeConstructedString(t.length),this};Me.ByteStringBuffer.prototype.putString=function(t){return this.putBytes(Me.encodeUtf8(t))};Me.ByteStringBuffer.prototype.putInt16=function(t){return this.putBytes(String.fromCharCode(t>>8&255)+String.fromCharCode(t&255))};Me.ByteStringBuffer.prototype.putInt24=function(t){return this.putBytes(String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t&255))};Me.ByteStringBuffer.prototype.putInt32=function(t){return this.putBytes(String.fromCharCode(t>>24&255)+String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t&255))};Me.ByteStringBuffer.prototype.putInt16Le=function(t){return this.putBytes(String.fromCharCode(t&255)+String.fromCharCode(t>>8&255))};Me.ByteStringBuffer.prototype.putInt24Le=function(t){return this.putBytes(String.fromCharCode(t&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t>>16&255))};Me.ByteStringBuffer.prototype.putInt32Le=function(t){return this.putBytes(String.fromCharCode(t&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t>>16&255)+String.fromCharCode(t>>24&255))};Me.ByteStringBuffer.prototype.putInt=function(t,e){HQ(e);var r="";do e-=8,r+=String.fromCharCode(t>>e&255);while(e>0);return this.putBytes(r)};Me.ByteStringBuffer.prototype.putSignedInt=function(t,e){return t<0&&(t+=2<<e-1),this.putInt(t,e)};Me.ByteStringBuffer.prototype.putBuffer=function(t){return this.putBytes(t.getBytes())};Me.ByteStringBuffer.prototype.getByte=function(){return this.data.charCodeAt(this.read++)};Me.ByteStringBuffer.prototype.getInt16=function(){var t=this.data.charCodeAt(this.read)<<8^this.data.charCodeAt(this.read+1);return this.read+=2,t};Me.ByteStringBuffer.prototype.getInt24=function(){var t=this.data.charCodeAt(this.read)<<16^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2);return this.read+=3,t};Me.ByteStringBuffer.prototype.getInt32=function(){var t=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3);return this.read+=4,t};Me.ByteStringBuffer.prototype.getInt16Le=function(){var t=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8;return this.read+=2,t};Me.ByteStringBuffer.prototype.getInt24Le=function(){var t=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16;return this.read+=3,t};Me.ByteStringBuffer.prototype.getInt32Le=function(){var t=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16^this.data.charCodeAt(this.read+3)<<24;return this.read+=4,t};Me.ByteStringBuffer.prototype.getInt=function(t){HQ(t);var e=0;do e=(e<<8)+this.data.charCodeAt(this.read++),t-=8;while(t>0);return e};Me.ByteStringBuffer.prototype.getSignedInt=function(t){var e=this.getInt(t),r=2<<t-2;return e>=r&&(e-=r<<1),e};Me.ByteStringBuffer.prototype.getBytes=function(t){var e;return t?(t=Math.min(this.length(),t),e=this.data.slice(this.read,this.read+t),this.read+=t):t===0?e="":(e=this.read===0?this.data:this.data.slice(this.read),this.clear()),e};Me.ByteStringBuffer.prototype.bytes=function(t){return typeof t>"u"?this.data.slice(this.read):this.data.slice(this.read,this.read+t)};Me.ByteStringBuffer.prototype.at=function(t){return this.data.charCodeAt(this.read+t)};Me.ByteStringBuffer.prototype.setAt=function(t,e){return this.data=this.data.substr(0,this.read+t)+String.fromCharCode(e)+this.data.substr(this.read+t+1),this};Me.ByteStringBuffer.prototype.last=function(){return this.data.charCodeAt(this.data.length-1)};Me.ByteStringBuffer.prototype.copy=function(){var t=Me.createBuffer(this.data);return t.read=this.read,t};Me.ByteStringBuffer.prototype.compact=function(){return this.read>0&&(this.data=this.data.slice(this.read),this.read=0),this};Me.ByteStringBuffer.prototype.clear=function(){return this.data="",this.read=0,this};Me.ByteStringBuffer.prototype.truncate=function(t){var e=Math.max(0,this.length()-t);return this.data=this.data.substr(this.read,e),this.read=0,this};Me.ByteStringBuffer.prototype.toHex=function(){for(var t="",e=this.read;e<this.data.length;++e){var r=this.data.charCodeAt(e);r<16&&(t+="0"),t+=r.toString(16)}return t};Me.ByteStringBuffer.prototype.toString=function(){return Me.decodeUtf8(this.bytes())};function tlr(t,e){e=e||{},this.read=e.readOffset||0,this.growSize=e.growSize||1024;var r=Me.isArrayBuffer(t),n=Me.isArrayBufferView(t);if(r||n){r?this.data=new DataView(t):this.data=new DataView(t.buffer,t.byteOffset,t.byteLength),this.write="writeOffset"in e?e.writeOffset:this.data.byteLength;return}this.data=new DataView(new ArrayBuffer(0)),this.write=0,t!=null&&this.putBytes(t),"writeOffset"in e&&(this.write=e.writeOffset)}s(tlr,"DataBuffer");Me.DataBuffer=tlr;Me.DataBuffer.prototype.length=function(){return this.write-this.read};Me.DataBuffer.prototype.isEmpty=function(){return this.length()<=0};Me.DataBuffer.prototype.accommodate=function(t,e){if(this.length()>=t)return this;e=Math.max(e||this.growSize,t);var r=new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength),n=new Uint8Array(this.length()+e);return n.set(r),this.data=new DataView(n.buffer),this};Me.DataBuffer.prototype.putByte=function(t){return this.accommodate(1),this.data.setUint8(this.write++,t),this};Me.DataBuffer.prototype.fillWithByte=function(t,e){this.accommodate(e);for(var r=0;r<e;++r)this.data.setUint8(t);return this};Me.DataBuffer.prototype.putBytes=function(t,e){if(Me.isArrayBufferView(t)){var r=new Uint8Array(t.buffer,t.byteOffset,t.byteLength),n=r.byteLength-r.byteOffset;this.accommodate(n);var i=new Uint8Array(this.data.buffer,this.write);return i.set(r),this.write+=n,this}if(Me.isArrayBuffer(t)){var r=new Uint8Array(t);this.accommodate(r.byteLength);var i=new Uint8Array(this.data.buffer);return i.set(r,this.write),this.write+=r.byteLength,this}if(t instanceof Me.DataBuffer||typeof t=="object"&&typeof t.read=="number"&&typeof t.write=="number"&&Me.isArrayBufferView(t.data)){var r=new Uint8Array(t.data.byteLength,t.read,t.length());this.accommodate(r.byteLength);var i=new Uint8Array(t.data.byteLength,this.write);return i.set(r),this.write+=r.byteLength,this}if(t instanceof Me.ByteStringBuffer&&(t=t.data,e="binary"),e=e||"binary",typeof t=="string"){var o;if(e==="hex")return this.accommodate(Math.ceil(t.length/2)),o=new Uint8Array(this.data.buffer,this.write),this.write+=Me.binary.hex.decode(t,o,this.write),this;if(e==="base64")return this.accommodate(Math.ceil(t.length/4)*3),o=new Uint8Array(this.data.buffer,this.write),this.write+=Me.binary.base64.decode(t,o,this.write),this;if(e==="utf8"&&(t=Me.encodeUtf8(t),e="binary"),e==="binary"||e==="raw")return this.accommodate(t.length),o=new Uint8Array(this.data.buffer,this.write),this.write+=Me.binary.raw.decode(o),this;if(e==="utf16")return this.accommodate(t.length*2),o=new Uint16Array(this.data.buffer,this.write),this.write+=Me.text.utf16.encode(o),this;throw new Error("Invalid encoding: "+e)}throw Error("Invalid parameter: "+t)};Me.DataBuffer.prototype.putBuffer=function(t){return this.putBytes(t),t.clear(),this};Me.DataBuffer.prototype.putString=function(t){return this.putBytes(t,"utf16")};Me.DataBuffer.prototype.putInt16=function(t){return this.accommodate(2),this.data.setInt16(this.write,t),this.write+=2,this};Me.DataBuffer.prototype.putInt24=function(t){return this.accommodate(3),this.data.setInt16(this.write,t>>8&65535),this.data.setInt8(this.write,t>>16&255),this.write+=3,this};Me.DataBuffer.prototype.putInt32=function(t){return this.accommodate(4),this.data.setInt32(this.write,t),this.write+=4,this};Me.DataBuffer.prototype.putInt16Le=function(t){return this.accommodate(2),this.data.setInt16(this.write,t,!0),this.write+=2,this};Me.DataBuffer.prototype.putInt24Le=function(t){return this.accommodate(3),this.data.setInt8(this.write,t>>16&255),this.data.setInt16(this.write,t>>8&65535,!0),this.write+=3,this};Me.DataBuffer.prototype.putInt32Le=function(t){return this.accommodate(4),this.data.setInt32(this.write,t,!0),this.write+=4,this};Me.DataBuffer.prototype.putInt=function(t,e){HQ(e),this.accommodate(e/8);do e-=8,this.data.setInt8(this.write++,t>>e&255);while(e>0);return this};Me.DataBuffer.prototype.putSignedInt=function(t,e){return HQ(e),this.accommodate(e/8),t<0&&(t+=2<<e-1),this.putInt(t,e)};Me.DataBuffer.prototype.getByte=function(){return this.data.getInt8(this.read++)};Me.DataBuffer.prototype.getInt16=function(){var t=this.data.getInt16(this.read);return this.read+=2,t};Me.DataBuffer.prototype.getInt24=function(){var t=this.data.getInt16(this.read)<<8^this.data.getInt8(this.read+2);return this.read+=3,t};Me.DataBuffer.prototype.getInt32=function(){var t=this.data.getInt32(this.read);return this.read+=4,t};Me.DataBuffer.prototype.getInt16Le=function(){var t=this.data.getInt16(this.read,!0);return this.read+=2,t};Me.DataBuffer.prototype.getInt24Le=function(){var t=this.data.getInt8(this.read)^this.data.getInt16(this.read+1,!0)<<8;return this.read+=3,t};Me.DataBuffer.prototype.getInt32Le=function(){var t=this.data.getInt32(this.read,!0);return this.read+=4,t};Me.DataBuffer.prototype.getInt=function(t){HQ(t);var e=0;do e=(e<<8)+this.data.getInt8(this.read++),t-=8;while(t>0);return e};Me.DataBuffer.prototype.getSignedInt=function(t){var e=this.getInt(t),r=2<<t-2;return e>=r&&(e-=r<<1),e};Me.DataBuffer.prototype.getBytes=function(t){var e;return t?(t=Math.min(this.length(),t),e=this.data.slice(this.read,this.read+t),this.read+=t):t===0?e="":(e=this.read===0?this.data:this.data.slice(this.read),this.clear()),e};Me.DataBuffer.prototype.bytes=function(t){return typeof t>"u"?this.data.slice(this.read):this.data.slice(this.read,this.read+t)};Me.DataBuffer.prototype.at=function(t){return this.data.getUint8(this.read+t)};Me.DataBuffer.prototype.setAt=function(t,e){return this.data.setUint8(t,e),this};Me.DataBuffer.prototype.last=function(){return this.data.getUint8(this.write-1)};Me.DataBuffer.prototype.copy=function(){return new Me.DataBuffer(this)};Me.DataBuffer.prototype.compact=function(){if(this.read>0){var t=new Uint8Array(this.data.buffer,this.read),e=new Uint8Array(t.byteLength);e.set(t),this.data=new DataView(e),this.write-=this.read,this.read=0}return this};Me.DataBuffer.prototype.clear=function(){return this.data=new DataView(new ArrayBuffer(0)),this.read=this.write=0,this};Me.DataBuffer.prototype.truncate=function(t){return this.write=Math.max(0,this.length()-t),this.read=Math.min(this.read,this.write),this};Me.DataBuffer.prototype.toHex=function(){for(var t="",e=this.read;e<this.data.byteLength;++e){var r=this.data.getUint8(e);r<16&&(t+="0"),t+=r.toString(16)}return t};Me.DataBuffer.prototype.toString=function(t){var e=new Uint8Array(this.data,this.read,this.length());if(t=t||"utf8",t==="binary"||t==="raw")return Me.binary.raw.encode(e);if(t==="hex")return Me.binary.hex.encode(e);if(t==="base64")return Me.binary.base64.encode(e);if(t==="utf8")return Me.text.utf8.decode(e);if(t==="utf16")return Me.text.utf16.decode(e);throw new Error("Invalid encoding: "+t)};Me.createBuffer=function(t,e){return e=e||"raw",t!==void 0&&e==="utf8"&&(t=Me.encodeUtf8(t)),new Me.ByteBuffer(t)};Me.fillString=function(t,e){for(var r="";e>0;)e&1&&(r+=t),e>>>=1,e>0&&(t+=t);return r};Me.xorBytes=function(t,e,r){for(var n="",i="",o="",a=0,c=0;r>0;--r,++a)i=t.charCodeAt(a)^e.charCodeAt(a),c>=10&&(n+=o,o="",c=0),o+=String.fromCharCode(i),++c;return n+=o,n};Me.hexToBytes=function(t){var e="",r=0;for(t.length&!0&&(r=1,e+=String.fromCharCode(parseInt(t[0],16)));r<t.length;r+=2)e+=String.fromCharCode(parseInt(t.substr(r,2),16));return e};Me.bytesToHex=function(t){return Me.createBuffer(t).toHex()};Me.int32ToBytes=function(t){return String.fromCharCode(t>>24&255)+String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t&255)};var Aw="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",yw=[62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,64,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51],Pat="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";Me.encode64=function(t,e){for(var r="",n="",i,o,a,c=0;c<t.length;)i=t.charCodeAt(c++),o=t.charCodeAt(c++),a=t.charCodeAt(c++),r+=Aw.charAt(i>>2),r+=Aw.charAt((i&3)<<4|o>>4),isNaN(o)?r+="==":(r+=Aw.charAt((o&15)<<2|a>>6),r+=isNaN(a)?"=":Aw.charAt(a&63)),e&&r.length>e&&(n+=r.substr(0,e)+`\r
`,r=r.substr(e));return n+=r,n};Me.decode64=function(t){t=t.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var e="",r,n,i,o,a=0;a<t.length;)r=yw[t.charCodeAt(a++)-43],n=yw[t.charCodeAt(a++)-43],i=yw[t.charCodeAt(a++)-43],o=yw[t.charCodeAt(a++)-43],e+=String.fromCharCode(r<<2|n>>4),i!==64&&(e+=String.fromCharCode((n&15)<<4|i>>2),o!==64&&(e+=String.fromCharCode((i&3)<<6|o)));return e};Me.encodeUtf8=function(t){return unescape(encodeURIComponent(t))};Me.decodeUtf8=function(t){return decodeURIComponent(escape(t))};Me.binary={raw:{},hex:{},base64:{},base58:{},baseN:{encode:kat.encode,decode:kat.decode}};Me.binary.raw.encode=function(t){return String.fromCharCode.apply(null,t)};Me.binary.raw.decode=function(t,e,r){var n=e;n||(n=new Uint8Array(t.length)),r=r||0;for(var i=r,o=0;o<t.length;++o)n[i++]=t.charCodeAt(o);return e?i-r:n};Me.binary.hex.encode=Me.bytesToHex;Me.binary.hex.decode=function(t,e,r){var n=e;n||(n=new Uint8Array(Math.ceil(t.length/2))),r=r||0;var i=0,o=r;for(t.length&1&&(i=1,n[o++]=parseInt(t[0],16));i<t.length;i+=2)n[o++]=parseInt(t.substr(i,2),16);return e?o-r:n};Me.binary.base64.encode=function(t,e){for(var r="",n="",i,o,a,c=0;c<t.byteLength;)i=t[c++],o=t[c++],a=t[c++],r+=Aw.charAt(i>>2),r+=Aw.charAt((i&3)<<4|o>>4),isNaN(o)?r+="==":(r+=Aw.charAt((o&15)<<2|a>>6),r+=isNaN(a)?"=":Aw.charAt(a&63)),e&&r.length>e&&(n+=r.substr(0,e)+`\r
`,r=r.substr(e));return n+=r,n};Me.binary.base64.decode=function(t,e,r){var n=e;n||(n=new Uint8Array(Math.ceil(t.length/4)*3)),t=t.replace(/[^A-Za-z0-9\+\/\=]/g,""),r=r||0;for(var i,o,a,c,l=0,u=r;l<t.length;)i=yw[t.charCodeAt(l++)-43],o=yw[t.charCodeAt(l++)-43],a=yw[t.charCodeAt(l++)-43],c=yw[t.charCodeAt(l++)-43],n[u++]=i<<2|o>>4,a!==64&&(n[u++]=(o&15)<<4|a>>2,c!==64&&(n[u++]=(a&3)<<6|c));return e?u-r:n.subarray(0,u)};Me.binary.base58.encode=function(t,e){return Me.binary.baseN.encode(t,Pat,e)};Me.binary.base58.decode=function(t,e){return Me.binary.baseN.decode(t,Pat,e)};Me.text={utf8:{},utf16:{}};Me.text.utf8.encode=function(t,e,r){t=Me.encodeUtf8(t);var n=e;n||(n=new Uint8Array(t.length)),r=r||0;for(var i=r,o=0;o<t.length;++o)n[i++]=t.charCodeAt(o);return e?i-r:n};Me.text.utf8.decode=function(t){return Me.decodeUtf8(String.fromCharCode.apply(null,t))};Me.text.utf16.encode=function(t,e,r){var n=e;n||(n=new Uint8Array(t.length*2));var i=new Uint16Array(n.buffer);r=r||0;for(var o=r,a=r,c=0;c<t.length;++c)i[a++]=t.charCodeAt(c),o+=2;return e?o-r:n};Me.text.utf16.decode=function(t){return String.fromCharCode.apply(null,new Uint16Array(t.buffer))};Me.deflate=function(t,e,r){if(e=Me.decode64(t.deflate(Me.encode64(e)).rval),r){var n=2,i=e.charCodeAt(1);i&32&&(n=6),e=e.substring(n,e.length-4)}return e};Me.inflate=function(t,e,r){var n=t.inflate(Me.encode64(e)).rval;return n===null?null:Me.decode64(n)};var qTe=s(function(t,e,r){if(!t)throw new Error("WebStorage not available.");var n;if(r===null?n=t.removeItem(e):(r=Me.encode64(JSON.stringify(r)),n=t.setItem(e,r)),typeof n<"u"&&n.rval!==!0){var i=new Error(n.error.message);throw i.id=n.error.id,i.name=n.error.name,i}},"_setStorageObject"),HTe=s(function(t,e){if(!t)throw new Error("WebStorage not available.");var r=t.getItem(e);if(t.init)if(r.rval===null){if(r.error){var n=new Error(r.error.message);throw n.id=r.error.id,n.name=r.error.name,n}r=null}else r=r.rval;return r!==null&&(r=JSON.parse(Me.decode64(r))),r},"_getStorageObject"),rlr=s(function(t,e,r,n){var i=HTe(t,e);i===null&&(i={}),i[r]=n,qTe(t,e,i)},"_setItem"),nlr=s(function(t,e,r){var n=HTe(t,e);return n!==null&&(n=r in n?n[r]:null),n},"_getItem"),ilr=s(function(t,e,r){var n=HTe(t,e);if(n!==null&&r in n){delete n[r];var i=!0;for(var o in n){i=!1;break}i&&(n=null),qTe(t,e,n)}},"_removeItem"),olr=s(function(t,e){qTe(t,e,null)},"_clearItems"),Tre=s(function(t,e,r){var n=null;typeof r>"u"&&(r=["web","flash"]);var i,o=!1,a=null;for(var c in r){i=r[c];try{if(i==="flash"||i==="both"){if(e[0]===null)throw new Error("Flash local storage not available.");n=t.apply(this,e),o=i==="flash"}(i==="web"||i==="both")&&(e[0]=localStorage,n=t.apply(this,e),o=!0)}catch(l){a=l}if(o)break}if(!o)throw a;return n},"_callStorageFunction");Me.setItem=function(t,e,r,n,i){Tre(rlr,arguments,i)};Me.getItem=function(t,e,r,n){return Tre(nlr,arguments,n)};Me.removeItem=function(t,e,r,n){Tre(ilr,arguments,n)};Me.clearItems=function(t,e,r){Tre(olr,arguments,r)};Me.isEmpty=function(t){for(var e in t)if(t.hasOwnProperty(e))return!1;return!0};Me.format=function(t){for(var e=/%./g,r,n,i=0,o=[],a=0;r=e.exec(t);){n=t.substring(a,e.lastIndex-2),n.length>0&&o.push(n),a=e.lastIndex;var c=r[0][1];switch(c){case"s":case"o":i<arguments.length?o.push(arguments[i+++1]):o.push("<?>");break;case"%":o.push("%");break;default:o.push("<%"+c+"?>")}}return o.push(t.substring(a)),o.join("")};Me.formatNumber=function(t,e,r,n){var i=t,o=isNaN(e=Math.abs(e))?2:e,a=r===void 0?",":r,c=n===void 0?".":n,l=i<0?"-":"",u=parseInt(i=Math.abs(+i||0).toFixed(o),10)+"",f=u.length>3?u.length%3:0;return l+(f?u.substr(0,f)+c:"")+u.substr(f).replace(/(\d{3})(?=\d)/g,"$1"+c)+(o?a+Math.abs(i-u).toFixed(o).slice(2):"")};Me.formatSize=function(t){return t>=1073741824?t=Me.formatNumber(t/1073741824,2,".","")+" GiB":t>=1048576?t=Me.formatNumber(t/1048576,2,".","")+" MiB":t>=1024?t=Me.formatNumber(t/1024,0)+" KiB":t=Me.formatNumber(t,0)+" bytes",t};Me.bytesFromIP=function(t){return t.indexOf(".")!==-1?Me.bytesFromIPv4(t):t.indexOf(":")!==-1?Me.bytesFromIPv6(t):null};Me.bytesFromIPv4=function(t){if(t=t.split("."),t.length!==4)return null;for(var e=Me.createBuffer(),r=0;r<t.length;++r){var n=parseInt(t[r],10);if(isNaN(n))return null;e.putByte(n)}return e.getBytes()};Me.bytesFromIPv6=function(t){var e=0;t=t.split(":").filter(function(a){return a.length===0&&++e,!0});for(var r=(8-t.length+e)*2,n=Me.createBuffer(),i=0;i<8;++i){if(!t[i]||t[i].length===0){n.fillWithByte(0,r),r=0;continue}var o=Me.hexToBytes(t[i]);o.length<2&&n.putByte(0),n.putBytes(o)}return n.getBytes()};Me.bytesToIP=function(t){return t.length===4?Me.bytesToIPv4(t):t.length===16?Me.bytesToIPv6(t):null};Me.bytesToIPv4=function(t){if(t.length!==4)return null;for(var e=[],r=0;r<t.length;++r)e.push(t.charCodeAt(r));return e.join(".")};Me.bytesToIPv6=function(t){if(t.length!==16)return null;for(var e=[],r=[],n=0,i=0;i<t.length;i+=2){for(var o=Me.bytesToHex(t[i]+t[i+1]);o[0]==="0"&&o!=="0";)o=o.substr(1);if(o==="0"){var a=r[r.length-1],c=e.length;!a||c!==a.end+1?r.push({start:c,end:c}):(a.end=c,a.end-a.start>r[n].end-r[n].start&&(n=r.length-1))}e.push(o)}if(r.length>0){var l=r[n];l.end-l.start>0&&(e.splice(l.start,l.end-l.start+1,""),l.start===0&&e.unshift(""),l.end===7&&e.push(""))}return e.join(":")};Me.estimateCores=function(t,e){if(typeof t=="function"&&(e=t,t={}),t=t||{},"cores"in Me&&!t.update)return e(null,Me.cores);if(typeof navigator<"u"&&"hardwareConcurrency"in navigator&&navigator.hardwareConcurrency>0)return Me.cores=navigator.hardwareConcurrency,e(null,Me.cores);if(typeof Worker>"u")return Me.cores=1,e(null,Me.cores);if(typeof Blob>"u")return Me.cores=2,e(null,Me.cores);var r=URL.createObjectURL(new Blob(["(",function(){self.addEventListener("message",function(a){for(var c=Date.now(),l=c+4;Date.now()<l;);self.postMessage({st:c,et:l})})}.toString(),")()"],{type:"application/javascript"}));n([],5,16);function n(a,c,l){if(c===0){var u=Math.floor(a.reduce(function(f,p){return f+p},0)/a.length);return Me.cores=Math.max(1,u),URL.revokeObjectURL(r),e(null,Me.cores)}i(l,function(f,p){a.push(o(l,p)),n(a,c-1,l)})}s(n,"sample");function i(a,c){for(var l=[],u=[],f=0;f<a;++f){var p=new Worker(r);p.addEventListener("message",function(m){if(u.push(m.data),u.length===a){for(var h=0;h<a;++h)l[h].terminate();c(null,u)}}),l.push(p)}for(var f=0;f<a;++f)l[f].postMessage(f)}s(i,"map");function o(a,c){for(var l=[],u=0;u<a;++u)for(var f=c[u],p=l[u]=[],m=0;m<a;++m)if(u!==m){var h=c[m];(f.st>h.st&&f.st<h.et||h.st>f.st&&h.st<f.et)&&p.push(m)}return l.reduce(function(g,A){return Math.max(g,A.length)},0)}s(o,"reduce")}});var wre=H((_gi,Bat)=>{d();var Au=Ri();Ho();Bat.exports=Au.cipher=Au.cipher||{};Au.cipher.algorithms=Au.cipher.algorithms||{};Au.cipher.createCipher=function(t,e){var r=t;if(typeof r=="string"&&(r=Au.cipher.getAlgorithm(r),r&&(r=r())),!r)throw new Error("Unsupported algorithm: "+t);return new Au.cipher.BlockCipher({algorithm:r,key:e,decrypt:!1})};Au.cipher.createDecipher=function(t,e){var r=t;if(typeof r=="string"&&(r=Au.cipher.getAlgorithm(r),r&&(r=r())),!r)throw new Error("Unsupported algorithm: "+t);return new Au.cipher.BlockCipher({algorithm:r,key:e,decrypt:!0})};Au.cipher.registerAlgorithm=function(t,e){t=t.toUpperCase(),Au.cipher.algorithms[t]=e};Au.cipher.getAlgorithm=function(t){return t=t.toUpperCase(),t in Au.cipher.algorithms?Au.cipher.algorithms[t]:null};var $Te=Au.cipher.BlockCipher=function(t){this.algorithm=t.algorithm,this.mode=this.algorithm.mode,this.blockSize=this.mode.blockSize,this._finish=!1,this._input=null,this.output=null,this._op=t.decrypt?this.mode.decrypt:this.mode.encrypt,this._decrypt=t.decrypt,this.algorithm.initialize(t)};$Te.prototype.start=function(t){t=t||{};var e={};for(var r in t)e[r]=t[r];e.decrypt=this._decrypt,this._finish=!1,this._input=Au.util.createBuffer(),this.output=t.output||Au.util.createBuffer(),this.mode.start(e)};$Te.prototype.update=function(t){for(t&&this._input.putBuffer(t);!this._op.call(this.mode,this._input,this.output,this._finish)&&!this._finish;);this._input.compact()};$Te.prototype.finish=function(t){t&&(this.mode.name==="ECB"||this.mode.name==="CBC")&&(this.mode.pad=function(r){return t(this.blockSize,r,!1)},this.mode.unpad=function(r){return t(this.blockSize,r,!0)});var e={};return e.decrypt=this._decrypt,e.overflow=this._input.length()%this.blockSize,!(!this._decrypt&&this.mode.pad&&!this.mode.pad(this._input,e)||(this._finish=!0,this.update(),this._decrypt&&this.mode.unpad&&!this.mode.unpad(this.output,e))||this.mode.afterFinish&&!this.mode.afterFinish(this.output,e))}});var jTe=H((kgi,Nat)=>{d();var yu=Ri();Ho();yu.cipher=yu.cipher||{};var Ji=Nat.exports=yu.cipher.modes=yu.cipher.modes||{};Ji.ecb=function(t){t=t||{},this.name="ECB",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)};Ji.ecb.prototype.start=function(t){};Ji.ecb.prototype.encrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=t.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._outBlock[n])};Ji.ecb.prototype.decrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=t.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._outBlock[n])};Ji.ecb.prototype.pad=function(t,e){var r=t.length()===this.blockSize?this.blockSize:this.blockSize-t.length();return t.fillWithByte(r,r),!0};Ji.ecb.prototype.unpad=function(t,e){if(e.overflow>0)return!1;var r=t.length(),n=t.at(r-1);return n>this.blockSize<<2?!1:(t.truncate(n),!0)};Ji.cbc=function(t){t=t||{},this.name="CBC",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)};Ji.cbc.prototype.start=function(t){if(t.iv===null){if(!this._prev)throw new Error("Invalid IV parameter.");this._iv=this._prev.slice(0)}else if("iv"in t)this._iv=Sre(t.iv,this.blockSize),this._prev=this._iv.slice(0);else throw new Error("Invalid IV parameter.")};Ji.cbc.prototype.encrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=this._prev[n]^t.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._outBlock[n]);this._prev=this._outBlock};Ji.cbc.prototype.decrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=t.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._prev[n]^this._outBlock[n]);this._prev=this._inBlock.slice(0)};Ji.cbc.prototype.pad=function(t,e){var r=t.length()===this.blockSize?this.blockSize:this.blockSize-t.length();return t.fillWithByte(r,r),!0};Ji.cbc.prototype.unpad=function(t,e){if(e.overflow>0)return!1;var r=t.length(),n=t.at(r-1);return n>this.blockSize<<2?!1:(t.truncate(n),!0)};Ji.cfb=function(t){t=t||{},this.name="CFB",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialBlock=new Array(this._ints),this._partialOutput=yu.util.createBuffer(),this._partialBytes=0};Ji.cfb.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");this._iv=Sre(t.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};Ji.cfb.prototype.encrypt=function(t,e,r){var n=t.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)this._inBlock[i]=t.getInt32()^this._outBlock[i],e.putInt32(this._inBlock[i]);return}var o=(this.blockSize-n)%this.blockSize;o>0&&(o=this.blockSize-o),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialBlock[i]=t.getInt32()^this._outBlock[i],this._partialOutput.putInt32(this._partialBlock[i]);if(o>0)t.read-=this.blockSize;else for(var i=0;i<this._ints;++i)this._inBlock[i]=this._partialBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),o>0&&!r)return e.putBytes(this._partialOutput.getBytes(o-this._partialBytes)),this._partialBytes=o,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};Ji.cfb.prototype.decrypt=function(t,e,r){var n=t.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)this._inBlock[i]=t.getInt32(),e.putInt32(this._inBlock[i]^this._outBlock[i]);return}var o=(this.blockSize-n)%this.blockSize;o>0&&(o=this.blockSize-o),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialBlock[i]=t.getInt32(),this._partialOutput.putInt32(this._partialBlock[i]^this._outBlock[i]);if(o>0)t.read-=this.blockSize;else for(var i=0;i<this._ints;++i)this._inBlock[i]=this._partialBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),o>0&&!r)return e.putBytes(this._partialOutput.getBytes(o-this._partialBytes)),this._partialBytes=o,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};Ji.ofb=function(t){t=t||{},this.name="OFB",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=yu.util.createBuffer(),this._partialBytes=0};Ji.ofb.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");this._iv=Sre(t.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};Ji.ofb.prototype.encrypt=function(t,e,r){var n=t.length();if(t.length()===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)e.putInt32(t.getInt32()^this._outBlock[i]),this._inBlock[i]=this._outBlock[i];return}var o=(this.blockSize-n)%this.blockSize;o>0&&(o=this.blockSize-o),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialOutput.putInt32(t.getInt32()^this._outBlock[i]);if(o>0)t.read-=this.blockSize;else for(var i=0;i<this._ints;++i)this._inBlock[i]=this._outBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),o>0&&!r)return e.putBytes(this._partialOutput.getBytes(o-this._partialBytes)),this._partialBytes=o,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};Ji.ofb.prototype.decrypt=Ji.ofb.prototype.encrypt;Ji.ctr=function(t){t=t||{},this.name="CTR",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=yu.util.createBuffer(),this._partialBytes=0};Ji.ctr.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");this._iv=Sre(t.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};Ji.ctr.prototype.encrypt=function(t,e,r){var n=t.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize)for(var i=0;i<this._ints;++i)e.putInt32(t.getInt32()^this._outBlock[i]);else{var o=(this.blockSize-n)%this.blockSize;o>0&&(o=this.blockSize-o),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialOutput.putInt32(t.getInt32()^this._outBlock[i]);if(o>0&&(t.read-=this.blockSize),this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),o>0&&!r)return e.putBytes(this._partialOutput.getBytes(o-this._partialBytes)),this._partialBytes=o,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}_re(this._inBlock)};Ji.ctr.prototype.decrypt=Ji.ctr.prototype.encrypt;Ji.gcm=function(t){t=t||{},this.name="GCM",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints),this._partialOutput=yu.util.createBuffer(),this._partialBytes=0,this._R=3774873600};Ji.gcm.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");var e=yu.util.createBuffer(t.iv);this._cipherLength=0;var r;if("additionalData"in t?r=yu.util.createBuffer(t.additionalData):r=yu.util.createBuffer(),"tagLength"in t?this._tagLength=t.tagLength:this._tagLength=128,this._tag=null,t.decrypt&&(this._tag=yu.util.createBuffer(t.tag).getBytes(),this._tag.length!==this._tagLength/8))throw new Error("Authentication tag does not match tag length.");this._hashBlock=new Array(this._ints),this.tag=null,this._hashSubkey=new Array(this._ints),this.cipher.encrypt([0,0,0,0],this._hashSubkey),this.componentBits=4,this._m=this.generateHashTable(this._hashSubkey,this.componentBits);var n=e.length();if(n===12)this._j0=[e.getInt32(),e.getInt32(),e.getInt32(),1];else{for(this._j0=[0,0,0,0];e.length()>0;)this._j0=this.ghash(this._hashSubkey,this._j0,[e.getInt32(),e.getInt32(),e.getInt32(),e.getInt32()]);this._j0=this.ghash(this._hashSubkey,this._j0,[0,0].concat(WTe(n*8)))}this._inBlock=this._j0.slice(0),_re(this._inBlock),this._partialBytes=0,r=yu.util.createBuffer(r),this._aDataLength=WTe(r.length()*8);var i=r.length()%this.blockSize;for(i&&r.fillWithByte(0,this.blockSize-i),this._s=[0,0,0,0];r.length()>0;)this._s=this.ghash(this._hashSubkey,this._s,[r.getInt32(),r.getInt32(),r.getInt32(),r.getInt32()])};Ji.gcm.prototype.encrypt=function(t,e,r){var n=t.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)e.putInt32(this._outBlock[i]^=t.getInt32());this._cipherLength+=this.blockSize}else{var o=(this.blockSize-n)%this.blockSize;o>0&&(o=this.blockSize-o),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialOutput.putInt32(t.getInt32()^this._outBlock[i]);if(o<=0||r){if(r){var a=n%this.blockSize;this._cipherLength+=a,this._partialOutput.truncate(this.blockSize-a)}else this._cipherLength+=this.blockSize;for(var i=0;i<this._ints;++i)this._outBlock[i]=this._partialOutput.getInt32();this._partialOutput.read-=this.blockSize}if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),o>0&&!r)return t.read-=this.blockSize,e.putBytes(this._partialOutput.getBytes(o-this._partialBytes)),this._partialBytes=o,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}this._s=this.ghash(this._hashSubkey,this._s,this._outBlock),_re(this._inBlock)};Ji.gcm.prototype.decrypt=function(t,e,r){var n=t.length();if(n<this.blockSize&&!(r&&n>0))return!0;this.cipher.encrypt(this._inBlock,this._outBlock),_re(this._inBlock),this._hashBlock[0]=t.getInt32(),this._hashBlock[1]=t.getInt32(),this._hashBlock[2]=t.getInt32(),this._hashBlock[3]=t.getInt32(),this._s=this.ghash(this._hashSubkey,this._s,this._hashBlock);for(var i=0;i<this._ints;++i)e.putInt32(this._outBlock[i]^this._hashBlock[i]);n<this.blockSize?this._cipherLength+=n%this.blockSize:this._cipherLength+=this.blockSize};Ji.gcm.prototype.afterFinish=function(t,e){var r=!0;e.decrypt&&e.overflow&&t.truncate(this.blockSize-e.overflow),this.tag=yu.util.createBuffer();var n=this._aDataLength.concat(WTe(this._cipherLength*8));this._s=this.ghash(this._hashSubkey,this._s,n);var i=[];this.cipher.encrypt(this._j0,i);for(var o=0;o<this._ints;++o)this.tag.putInt32(this._s[o]^i[o]);return this.tag.truncate(this.tag.length()%(this._tagLength/8)),e.decrypt&&this.tag.bytes()!==this._tag&&(r=!1),r};Ji.gcm.prototype.multiply=function(t,e){for(var r=[0,0,0,0],n=e.slice(0),i=0;i<128;++i){var o=t[i/32|0]&1<<31-i%32;o&&(r[0]^=n[0],r[1]^=n[1],r[2]^=n[2],r[3]^=n[3]),this.pow(n,n)}return r};Ji.gcm.prototype.pow=function(t,e){for(var r=t[3]&1,n=3;n>0;--n)e[n]=t[n]>>>1|(t[n-1]&1)<<31;e[0]=t[0]>>>1,r&&(e[0]^=this._R)};Ji.gcm.prototype.tableMultiply=function(t){for(var e=[0,0,0,0],r=0;r<32;++r){var n=r/8|0,i=t[n]>>>(7-r%8)*4&15,o=this._m[r][i];e[0]^=o[0],e[1]^=o[1],e[2]^=o[2],e[3]^=o[3]}return e};Ji.gcm.prototype.ghash=function(t,e,r){return e[0]^=r[0],e[1]^=r[1],e[2]^=r[2],e[3]^=r[3],this.tableMultiply(e)};Ji.gcm.prototype.generateHashTable=function(t,e){for(var r=8/e,n=4*r,i=16*r,o=new Array(i),a=0;a<i;++a){var c=[0,0,0,0],l=a/n|0,u=(n-1-a%n)*e;c[l]=1<<e-1<<u,o[a]=this.generateSubHashTable(this.multiply(c,t),e)}return o};Ji.gcm.prototype.generateSubHashTable=function(t,e){var r=1<<e,n=r>>>1,i=new Array(r);i[n]=t.slice(0);for(var o=n>>>1;o>0;)this.pow(i[2*o],i[o]=[]),o>>=1;for(o=2;o<n;){for(var a=1;a<o;++a){var c=i[o],l=i[a];i[o+a]=[c[0]^l[0],c[1]^l[1],c[2]^l[2],c[3]^l[3]]}o*=2}for(i[0]=[0,0,0,0],o=n+1;o<r;++o){var u=i[o^n];i[o]=[t[0]^u[0],t[1]^u[1],t[2]^u[2],t[3]^u[3]]}return i};function Sre(t,e){if(typeof t=="string"&&(t=yu.util.createBuffer(t)),yu.util.isArray(t)&&t.length>4){var r=t;t=yu.util.createBuffer();for(var n=0;n<r.length;++n)t.putByte(r[n])}if(t.length()<e)throw new Error("Invalid IV length; got "+t.length()+" bytes and expected "+e+" bytes.");if(!yu.util.isArray(t)){for(var i=[],o=e/4,n=0;n<o;++n)i.push(t.getInt32());t=i}return t}s(Sre,"transformIV");function _re(t){t[t.length-1]=t[t.length-1]+1&4294967295}s(_re,"inc32");function WTe(t){return[t/4294967296|0,t&4294967295]}s(WTe,"from64To32")});var Cw=H((Bgi,Oat)=>{d();var Ws=Ri();wre();jTe();Ho();Oat.exports=Ws.aes=Ws.aes||{};Ws.aes.startEncrypting=function(t,e,r,n){var i=Rre({key:t,output:r,decrypt:!1,mode:n});return i.start(e),i};Ws.aes.createEncryptionCipher=function(t,e){return Rre({key:t,output:null,decrypt:!1,mode:e})};Ws.aes.startDecrypting=function(t,e,r,n){var i=Rre({key:t,output:r,decrypt:!0,mode:n});return i.start(e),i};Ws.aes.createDecryptionCipher=function(t,e){return Rre({key:t,output:null,decrypt:!0,mode:e})};Ws.aes.Algorithm=function(t,e){zTe||Lat();var r=this;r.name=t,r.mode=new e({blockSize:16,cipher:{encrypt:s(function(n,i){return VTe(r._w,n,i,!1)},"encrypt"),decrypt:s(function(n,i){return VTe(r._w,n,i,!0)},"decrypt")}}),r._init=!1};Ws.aes.Algorithm.prototype.initialize=function(t){if(!this._init){var e=t.key,r;if(typeof e=="string"&&(e.length===16||e.length===24||e.length===32))e=Ws.util.createBuffer(e);else if(Ws.util.isArray(e)&&(e.length===16||e.length===24||e.length===32)){r=e,e=Ws.util.createBuffer();for(var n=0;n<r.length;++n)e.putByte(r[n])}if(!Ws.util.isArray(e)){r=e,e=[];var i=r.length();if(i===16||i===24||i===32){i=i>>>2;for(var n=0;n<i;++n)e.push(r.getInt32())}}if(!Ws.util.isArray(e)||!(e.length===4||e.length===6||e.length===8))throw new Error("Invalid key parameter.");var o=this.mode.name,a=["CFB","OFB","CTR","GCM"].indexOf(o)!==-1;this._w=Fat(e,t.decrypt&&!a),this._init=!0}};Ws.aes._expandKey=function(t,e){return zTe||Lat(),Fat(t,e)};Ws.aes._updateBlock=VTe;HN("AES-ECB",Ws.cipher.modes.ecb);HN("AES-CBC",Ws.cipher.modes.cbc);HN("AES-CFB",Ws.cipher.modes.cfb);HN("AES-OFB",Ws.cipher.modes.ofb);HN("AES-CTR",Ws.cipher.modes.ctr);HN("AES-GCM",Ws.cipher.modes.gcm);function HN(t,e){var r=s(function(){return new Ws.aes.Algorithm(t,e)},"factory");Ws.cipher.registerAlgorithm(t,r)}s(HN,"registerAlgorithm");var zTe=!1,qN=4,Lf,GTe,Mat,bk,KA;function Lat(){zTe=!0,Mat=[0,1,2,4,8,16,32,64,128,27,54];for(var t=new Array(256),e=0;e<128;++e)t[e]=e<<1,t[e+128]=e+128<<1^283;Lf=new Array(256),GTe=new Array(256),bk=new Array(4),KA=new Array(4);for(var e=0;e<4;++e)bk[e]=new Array(256),KA[e]=new Array(256);for(var r=0,n=0,i,o,a,c,l,u,f,e=0;e<256;++e){c=n^n<<1^n<<2^n<<3^n<<4,c=c>>8^c&255^99,Lf[r]=c,GTe[c]=r,l=t[c],i=t[r],o=t[i],a=t[o],u=l<<24^c<<16^c<<8^(c^l),f=(i^o^a)<<24^(r^a)<<16^(r^o^a)<<8^(r^i^a);for(var p=0;p<4;++p)bk[p][r]=u,KA[p][c]=f,u=u<<24|u>>>8,f=f<<24|f>>>8;r===0?r=n=1:(r=i^t[t[t[i^a]]],n^=t[t[n]])}}s(Lat,"initialize");function Fat(t,e){for(var r=t.slice(0),n,i=1,o=r.length,a=o+6+1,c=qN*a,l=o;l<c;++l)n=r[l-1],l%o===0?(n=Lf[n>>>16&255]<<24^Lf[n>>>8&255]<<16^Lf[n&255]<<8^Lf[n>>>24]^Mat[i]<<24,i++):o>6&&l%o===4&&(n=Lf[n>>>24]<<24^Lf[n>>>16&255]<<16^Lf[n>>>8&255]<<8^Lf[n&255]),r[l]=r[l-o]^n;if(e){var u,f=KA[0],p=KA[1],m=KA[2],h=KA[3],g=r.slice(0);c=r.length;for(var l=0,A=c-qN;l<c;l+=qN,A-=qN)if(l===0||l===c-qN)g[l]=r[A],g[l+1]=r[A+3],g[l+2]=r[A+2],g[l+3]=r[A+1];else for(var y=0;y<qN;++y)u=r[A+y],g[l+(3&-y)]=f[Lf[u>>>24]]^p[Lf[u>>>16&255]]^m[Lf[u>>>8&255]]^h[Lf[u&255]];r=g}return r}s(Fat,"_expandKey");function VTe(t,e,r,n){var i=t.length/4-1,o,a,c,l,u;n?(o=KA[0],a=KA[1],c=KA[2],l=KA[3],u=GTe):(o=bk[0],a=bk[1],c=bk[2],l=bk[3],u=Lf);var f,p,m,h,g,A,y;f=e[0]^t[0],p=e[n?3:1]^t[1],m=e[2]^t[2],h=e[n?1:3]^t[3];for(var E=3,b=1;b<i;++b)g=o[f>>>24]^a[p>>>16&255]^c[m>>>8&255]^l[h&255]^t[++E],A=o[p>>>24]^a[m>>>16&255]^c[h>>>8&255]^l[f&255]^t[++E],y=o[m>>>24]^a[h>>>16&255]^c[f>>>8&255]^l[p&255]^t[++E],h=o[h>>>24]^a[f>>>16&255]^c[p>>>8&255]^l[m&255]^t[++E],f=g,p=A,m=y;r[0]=u[f>>>24]<<24^u[p>>>16&255]<<16^u[m>>>8&255]<<8^u[h&255]^t[++E],r[n?3:1]=u[p>>>24]<<24^u[m>>>16&255]<<16^u[h>>>8&255]<<8^u[f&255]^t[++E],r[2]=u[m>>>24]<<24^u[h>>>16&255]<<16^u[f>>>8&255]<<8^u[p&255]^t[++E],r[n?1:3]=u[h>>>24]<<24^u[f>>>16&255]<<16^u[p>>>8&255]<<8^u[m&255]^t[++E]}s(VTe,"_updateBlock");function Rre(t){t=t||{};var e=(t.mode||"CBC").toUpperCase(),r="AES-"+e,n;t.decrypt?n=Ws.cipher.createDecipher(r,t.key):n=Ws.cipher.createCipher(r,t.key);var i=n.start;return n.start=function(o,a){var c=null;a instanceof Ws.util.ByteBuffer&&(c=a,a={}),a=a||{},a.output=c,a.iv=o,i.call(n,a)},n}s(Rre,"_createCipher")});var vw=H((Lgi,Qat)=>{d();var $Q=Ri();$Q.pki=$Q.pki||{};var KTe=Qat.exports=$Q.pki.oids=$Q.oids=$Q.oids||{};function Lt(t,e){KTe[t]=e,KTe[e]=t}s(Lt,"_IN");function is(t,e){KTe[t]=e}s(is,"_I_");Lt("1.2.840.113549.1.1.1","rsaEncryption");Lt("1.2.840.113549.1.1.4","md5WithRSAEncryption");Lt("1.2.840.113549.1.1.5","sha1WithRSAEncryption");Lt("1.2.840.113549.1.1.7","RSAES-OAEP");Lt("1.2.840.113549.1.1.8","mgf1");Lt("1.2.840.113549.1.1.9","pSpecified");Lt("1.2.840.113549.1.1.10","RSASSA-PSS");Lt("1.2.840.113549.1.1.11","sha256WithRSAEncryption");Lt("1.2.840.113549.1.1.12","sha384WithRSAEncryption");Lt("1.2.840.113549.1.1.13","sha512WithRSAEncryption");Lt("1.3.101.112","EdDSA25519");Lt("1.2.840.10040.4.3","dsa-with-sha1");Lt("1.3.14.3.2.7","desCBC");Lt("1.3.14.3.2.26","sha1");Lt("1.3.14.3.2.29","sha1WithRSASignature");Lt("2.16.840.1.101.3.4.2.1","sha256");Lt("2.16.840.1.101.3.4.2.2","sha384");Lt("2.16.840.1.101.3.4.2.3","sha512");Lt("2.16.840.1.101.3.4.2.4","sha224");Lt("2.16.840.1.101.3.4.2.5","sha512-224");Lt("2.16.840.1.101.3.4.2.6","sha512-256");Lt("1.2.840.113549.2.2","md2");Lt("1.2.840.113549.2.5","md5");Lt("1.2.840.113549.1.7.1","data");Lt("1.2.840.113549.1.7.2","signedData");Lt("1.2.840.113549.1.7.3","envelopedData");Lt("1.2.840.113549.1.7.4","signedAndEnvelopedData");Lt("1.2.840.113549.1.7.5","digestedData");Lt("1.2.840.113549.1.7.6","encryptedData");Lt("1.2.840.113549.1.9.1","emailAddress");Lt("1.2.840.113549.1.9.2","unstructuredName");Lt("1.2.840.113549.1.9.3","contentType");Lt("1.2.840.113549.1.9.4","messageDigest");Lt("1.2.840.113549.1.9.5","signingTime");Lt("1.2.840.113549.1.9.6","counterSignature");Lt("1.2.840.113549.1.9.7","challengePassword");Lt("1.2.840.113549.1.9.8","unstructuredAddress");Lt("1.2.840.113549.1.9.14","extensionRequest");Lt("1.2.840.113549.1.9.20","friendlyName");Lt("1.2.840.113549.1.9.21","localKeyId");Lt("1.2.840.113549.1.9.22.1","x509Certificate");Lt("1.2.840.113549.1.12.10.1.1","keyBag");Lt("1.2.840.113549.1.12.10.1.2","pkcs8ShroudedKeyBag");Lt("1.2.840.113549.1.12.10.1.3","certBag");Lt("1.2.840.113549.1.12.10.1.4","crlBag");Lt("1.2.840.113549.1.12.10.1.5","secretBag");Lt("1.2.840.113549.1.12.10.1.6","safeContentsBag");Lt("1.2.840.113549.1.5.13","pkcs5PBES2");Lt("1.2.840.113549.1.5.12","pkcs5PBKDF2");Lt("1.2.840.113549.1.12.1.1","pbeWithSHAAnd128BitRC4");Lt("1.2.840.113549.1.12.1.2","pbeWithSHAAnd40BitRC4");Lt("1.2.840.113549.1.12.1.3","pbeWithSHAAnd3-KeyTripleDES-CBC");Lt("1.2.840.113549.1.12.1.4","pbeWithSHAAnd2-KeyTripleDES-CBC");Lt("1.2.840.113549.1.12.1.5","pbeWithSHAAnd128BitRC2-CBC");Lt("1.2.840.113549.1.12.1.6","pbewithSHAAnd40BitRC2-CBC");Lt("1.2.840.113549.2.7","hmacWithSHA1");Lt("1.2.840.113549.2.8","hmacWithSHA224");Lt("1.2.840.113549.2.9","hmacWithSHA256");Lt("1.2.840.113549.2.10","hmacWithSHA384");Lt("1.2.840.113549.2.11","hmacWithSHA512");Lt("1.2.840.113549.3.7","des-EDE3-CBC");Lt("2.16.840.1.101.3.4.1.2","aes128-CBC");Lt("2.16.840.1.101.3.4.1.22","aes192-CBC");Lt("2.16.840.1.101.3.4.1.42","aes256-CBC");Lt("2.5.4.3","commonName");Lt("2.5.4.4","surname");Lt("2.5.4.5","serialNumber");Lt("2.5.4.6","countryName");Lt("2.5.4.7","localityName");Lt("2.5.4.8","stateOrProvinceName");Lt("2.5.4.9","streetAddress");Lt("2.5.4.10","organizationName");Lt("2.5.4.11","organizationalUnitName");Lt("2.5.4.12","title");Lt("2.5.4.13","description");Lt("2.5.4.15","businessCategory");Lt("2.5.4.17","postalCode");Lt("2.5.4.42","givenName");Lt("1.3.6.1.4.1.311.60.2.1.2","jurisdictionOfIncorporationStateOrProvinceName");Lt("1.3.6.1.4.1.311.60.2.1.3","jurisdictionOfIncorporationCountryName");Lt("2.16.840.1.113730.1.1","nsCertType");Lt("2.16.840.1.113730.1.13","nsComment");is("2.5.29.1","authorityKeyIdentifier");is("2.5.29.2","keyAttributes");is("2.5.29.3","certificatePolicies");is("2.5.29.4","keyUsageRestriction");is("2.5.29.5","policyMapping");is("2.5.29.6","subtreesConstraint");is("2.5.29.7","subjectAltName");is("2.5.29.8","issuerAltName");is("2.5.29.9","subjectDirectoryAttributes");is("2.5.29.10","basicConstraints");is("2.5.29.11","nameConstraints");is("2.5.29.12","policyConstraints");is("2.5.29.13","basicConstraints");Lt("2.5.29.14","subjectKeyIdentifier");Lt("2.5.29.15","keyUsage");is("2.5.29.16","privateKeyUsagePeriod");Lt("2.5.29.17","subjectAltName");Lt("2.5.29.18","issuerAltName");Lt("2.5.29.19","basicConstraints");is("2.5.29.20","cRLNumber");is("2.5.29.21","cRLReason");is("2.5.29.22","expirationDate");is("2.5.29.23","instructionCode");is("2.5.29.24","invalidityDate");is("2.5.29.25","cRLDistributionPoints");is("2.5.29.26","issuingDistributionPoint");is("2.5.29.27","deltaCRLIndicator");is("2.5.29.28","issuingDistributionPoint");is("2.5.29.29","certificateIssuer");is("2.5.29.30","nameConstraints");Lt("2.5.29.31","cRLDistributionPoints");Lt("2.5.29.32","certificatePolicies");is("2.5.29.33","policyMappings");is("2.5.29.34","policyConstraints");Lt("2.5.29.35","authorityKeyIdentifier");is("2.5.29.36","policyConstraints");Lt("2.5.29.37","extKeyUsage");is("2.5.29.46","freshestCRL");is("2.5.29.54","inhibitAnyPolicy");Lt("1.3.6.1.4.1.11129.2.4.2","timestampList");Lt("1.3.6.1.5.5.7.1.1","authorityInfoAccess");Lt("1.3.6.1.5.5.7.3.1","serverAuth");Lt("1.3.6.1.5.5.7.3.2","clientAuth");Lt("1.3.6.1.5.5.7.3.3","codeSigning");Lt("1.3.6.1.5.5.7.3.4","emailProtection");Lt("1.3.6.1.5.5.7.3.8","timeStamping")});var YA=H((Qgi,qat)=>{d();var da=Ri();Ho();vw();var Ar=qat.exports=da.asn1=da.asn1||{};Ar.Class={UNIVERSAL:0,APPLICATION:64,CONTEXT_SPECIFIC:128,PRIVATE:192};Ar.Type={NONE:0,BOOLEAN:1,INTEGER:2,BITSTRING:3,OCTETSTRING:4,NULL:5,OID:6,ODESC:7,EXTERNAL:8,REAL:9,ENUMERATED:10,EMBEDDED:11,UTF8:12,ROID:13,SEQUENCE:16,SET:17,PRINTABLESTRING:19,IA5STRING:22,UTCTIME:23,GENERALIZEDTIME:24,BMPSTRING:30};Ar.create=function(t,e,r,n,i){if(da.util.isArray(n)){for(var o=[],a=0;a<n.length;++a)n[a]!==void 0&&o.push(n[a]);n=o}var c={tagClass:t,type:e,constructed:r,composed:r||da.util.isArray(n),value:n};return i&&"bitStringContents"in i&&(c.bitStringContents=i.bitStringContents,c.original=Ar.copy(c)),c};Ar.copy=function(t,e){var r;if(da.util.isArray(t)){r=[];for(var n=0;n<t.length;++n)r.push(Ar.copy(t[n],e));return r}return typeof t=="string"?t:(r={tagClass:t.tagClass,type:t.type,constructed:t.constructed,composed:t.composed,value:Ar.copy(t.value,e)},e&&!e.excludeBitStringContents&&(r.bitStringContents=t.bitStringContents),r)};Ar.equals=function(t,e,r){if(da.util.isArray(t)){if(!da.util.isArray(e)||t.length!==e.length)return!1;for(var n=0;n<t.length;++n)if(!Ar.equals(t[n],e[n]))return!1;return!0}if(typeof t!=typeof e)return!1;if(typeof t=="string")return t===e;var i=t.tagClass===e.tagClass&&t.type===e.type&&t.constructed===e.constructed&&t.composed===e.composed&&Ar.equals(t.value,e.value);return r&&r.includeBitStringContents&&(i=i&&t.bitStringContents===e.bitStringContents),i};Ar.getBerValueLength=function(t){var e=t.getByte();if(e!==128){var r,n=e&128;return n?r=t.getInt((e&127)<<3):r=e,r}};function WQ(t,e,r){if(r>e){var n=new Error("Too few bytes to parse DER.");throw n.available=t.length(),n.remaining=e,n.requested=r,n}}s(WQ,"_checkBufferLength");var slr=s(function(t,e){var r=t.getByte();if(e--,r!==128){var n,i=r&128;if(!i)n=r;else{var o=r&127;WQ(t,e,o),n=t.getInt(o<<3)}if(n<0)throw new Error("Negative length: "+n);return n}},"_getValueLength");Ar.fromDer=function(t,e){e===void 0&&(e={strict:!0,parseAllBytes:!0,decodeBitStrings:!0}),typeof e=="boolean"&&(e={strict:e,parseAllBytes:!0,decodeBitStrings:!0}),"strict"in e||(e.strict=!0),"parseAllBytes"in e||(e.parseAllBytes=!0),"decodeBitStrings"in e||(e.decodeBitStrings=!0),typeof t=="string"&&(t=da.util.createBuffer(t));var r=t.length(),n=kre(t,t.length(),0,e);if(e.parseAllBytes&&t.length()!==0){var i=new Error("Unparsed DER bytes remain after ASN.1 parsing.");throw i.byteCount=r,i.remaining=t.length(),i}return n};function kre(t,e,r,n){var i;WQ(t,e,2);var o=t.getByte();e--;var a=o&192,c=o&31;i=t.length();var l=slr(t,e);if(e-=i-t.length(),l!==void 0&&l>e){if(n.strict){var u=new Error("Too few bytes to read ASN.1 value.");throw u.available=t.length(),u.remaining=e,u.requested=l,u}l=e}var f,p,m=(o&32)===32;if(m)if(f=[],l===void 0)for(;;){if(WQ(t,e,2),t.bytes(2)==="\0\0"){t.getBytes(2),e-=2;break}i=t.length(),f.push(kre(t,e,r+1,n)),e-=i-t.length()}else for(;l>0;)i=t.length(),f.push(kre(t,l,r+1,n)),e-=i-t.length(),l-=i-t.length();if(f===void 0&&a===Ar.Class.UNIVERSAL&&c===Ar.Type.BITSTRING&&(p=t.bytes(l)),f===void 0&&n.decodeBitStrings&&a===Ar.Class.UNIVERSAL&&c===Ar.Type.BITSTRING&&l>1){var h=t.read,g=e,A=0;if(c===Ar.Type.BITSTRING&&(WQ(t,e,1),A=t.getByte(),e--),A===0)try{i=t.length();var y={strict:!0,decodeBitStrings:!0},E=kre(t,e,r+1,y),b=i-t.length();e-=b,c==Ar.Type.BITSTRING&&b++;var S=E.tagClass;b===l&&(S===Ar.Class.UNIVERSAL||S===Ar.Class.CONTEXT_SPECIFIC)&&(f=[E])}catch{}f===void 0&&(t.read=h,e=g)}if(f===void 0){if(l===void 0){if(n.strict)throw new Error("Non-constructed ASN.1 object of indefinite length.");l=e}if(c===Ar.Type.BMPSTRING)for(f="";l>0;l-=2)WQ(t,e,2),f+=String.fromCharCode(t.getInt16()),e-=2;else f=t.getBytes(l),e-=l}var R=p===void 0?null:{bitStringContents:p};return Ar.create(a,c,m,f,R)}s(kre,"_fromDer");Ar.toDer=function(t){var e=da.util.createBuffer(),r=t.tagClass|t.type,n=da.util.createBuffer(),i=!1;if("bitStringContents"in t&&(i=!0,t.original&&(i=Ar.equals(t,t.original))),i)n.putBytes(t.bitStringContents);else if(t.composed){t.constructed?r|=32:n.putByte(0);for(var o=0;o<t.value.length;++o)t.value[o]!==void 0&&n.putBuffer(Ar.toDer(t.value[o]))}else if(t.type===Ar.Type.BMPSTRING)for(var o=0;o<t.value.length;++o)n.putInt16(t.value.charCodeAt(o));else t.type===Ar.Type.INTEGER&&t.value.length>1&&(t.value.charCodeAt(0)===0&&(t.value.charCodeAt(1)&128)===0||t.value.charCodeAt(0)===255&&(t.value.charCodeAt(1)&128)===128)?n.putBytes(t.value.substr(1)):n.putBytes(t.value);if(e.putByte(r),n.length()<=127)e.putByte(n.length()&127);else{var a=n.length(),c="";do c+=String.fromCharCode(a&255),a=a>>>8;while(a>0);e.putByte(c.length|128);for(var o=c.length-1;o>=0;--o)e.putByte(c.charCodeAt(o))}return e.putBuffer(n),e};Ar.oidToDer=function(t){var e=t.split("."),r=da.util.createBuffer();r.putByte(40*parseInt(e[0],10)+parseInt(e[1],10));for(var n,i,o,a,c=2;c<e.length;++c){n=!0,i=[],o=parseInt(e[c],10);do a=o&127,o=o>>>7,n||(a|=128),i.push(a),n=!1;while(o>0);for(var l=i.length-1;l>=0;--l)r.putByte(i[l])}return r};Ar.derToOid=function(t){var e;typeof t=="string"&&(t=da.util.createBuffer(t));var r=t.getByte();e=Math.floor(r/40)+"."+r%40;for(var n=0;t.length()>0;)r=t.getByte(),n=n<<7,r&128?n+=r&127:(e+="."+(n+r),n=0);return e};Ar.utcTimeToDate=function(t){var e=new Date,r=parseInt(t.substr(0,2),10);r=r>=50?1900+r:2e3+r;var n=parseInt(t.substr(2,2),10)-1,i=parseInt(t.substr(4,2),10),o=parseInt(t.substr(6,2),10),a=parseInt(t.substr(8,2),10),c=0;if(t.length>11){var l=t.charAt(10),u=10;l!=="+"&&l!=="-"&&(c=parseInt(t.substr(10,2),10),u+=2)}if(e.setUTCFullYear(r,n,i),e.setUTCHours(o,a,c,0),u&&(l=t.charAt(u),l==="+"||l==="-")){var f=parseInt(t.substr(u+1,2),10),p=parseInt(t.substr(u+4,2),10),m=f*60+p;m*=6e4,l==="+"?e.setTime(+e-m):e.setTime(+e+m)}return e};Ar.generalizedTimeToDate=function(t){var e=new Date,r=parseInt(t.substr(0,4),10),n=parseInt(t.substr(4,2),10)-1,i=parseInt(t.substr(6,2),10),o=parseInt(t.substr(8,2),10),a=parseInt(t.substr(10,2),10),c=parseInt(t.substr(12,2),10),l=0,u=0,f=!1;t.charAt(t.length-1)==="Z"&&(f=!0);var p=t.length-5,m=t.charAt(p);if(m==="+"||m==="-"){var h=parseInt(t.substr(p+1,2),10),g=parseInt(t.substr(p+4,2),10);u=h*60+g,u*=6e4,m==="+"&&(u*=-1),f=!0}return t.charAt(14)==="."&&(l=parseFloat(t.substr(14),10)*1e3),f?(e.setUTCFullYear(r,n,i),e.setUTCHours(o,a,c,l),e.setTime(+e+u)):(e.setFullYear(r,n,i),e.setHours(o,a,c,l)),e};Ar.dateToUtcTime=function(t){if(typeof t=="string")return t;var e="",r=[];r.push((""+t.getUTCFullYear()).substr(2)),r.push(""+(t.getUTCMonth()+1)),r.push(""+t.getUTCDate()),r.push(""+t.getUTCHours()),r.push(""+t.getUTCMinutes()),r.push(""+t.getUTCSeconds());for(var n=0;n<r.length;++n)r[n].length<2&&(e+="0"),e+=r[n];return e+="Z",e};Ar.dateToGeneralizedTime=function(t){if(typeof t=="string")return t;var e="",r=[];r.push(""+t.getUTCFullYear()),r.push(""+(t.getUTCMonth()+1)),r.push(""+t.getUTCDate()),r.push(""+t.getUTCHours()),r.push(""+t.getUTCMinutes()),r.push(""+t.getUTCSeconds());for(var n=0;n<r.length;++n)r[n].length<2&&(e+="0"),e+=r[n];return e+="Z",e};Ar.integerToDer=function(t){var e=da.util.createBuffer();if(t>=-128&&t<128)return e.putSignedInt(t,8);if(t>=-32768&&t<32768)return e.putSignedInt(t,16);if(t>=-8388608&&t<8388608)return e.putSignedInt(t,24);if(t>=-2147483648&&t<2147483648)return e.putSignedInt(t,32);var r=new Error("Integer too large; max is 32-bits.");throw r.integer=t,r};Ar.derToInteger=function(t){typeof t=="string"&&(t=da.util.createBuffer(t));var e=t.length()*8;if(e>32)throw new Error("Integer too large; max is 32-bits.");return t.getSignedInt(e)};Ar.validate=function(t,e,r,n){var i=!1;if((t.tagClass===e.tagClass||typeof e.tagClass>"u")&&(t.type===e.type||typeof e.type>"u"))if(t.constructed===e.constructed||typeof e.constructed>"u"){if(i=!0,e.value&&da.util.isArray(e.value))for(var o=0,a=0;i&&a<e.value.length;++a)i=e.value[a].optional||!1,t.value[o]&&(i=Ar.validate(t.value[o],e.value[a],r,n),i?++o:e.value[a].optional&&(i=!0)),!i&&n&&n.push("["+e.name+'] Tag class "'+e.tagClass+'", type "'+e.type+'" expected value length "'+e.value.length+'", got "'+t.value.length+'"');if(i&&r&&(e.capture&&(r[e.capture]=t.value),e.captureAsn1&&(r[e.captureAsn1]=t),e.captureBitStringContents&&"bitStringContents"in t&&(r[e.captureBitStringContents]=t.bitStringContents),e.captureBitStringValue&&"bitStringContents"in t)){var c;if(t.bitStringContents.length<2)r[e.captureBitStringValue]="";else{var l=t.bitStringContents.charCodeAt(0);if(l!==0)throw new Error("captureBitStringValue only supported for zero unused bits");r[e.captureBitStringValue]=t.bitStringContents.slice(1)}}}else n&&n.push("["+e.name+'] Expected constructed "'+e.constructed+'", got "'+t.constructed+'"');else n&&(t.tagClass!==e.tagClass&&n.push("["+e.name+'] Expected tag class "'+e.tagClass+'", got "'+t.tagClass+'"'),t.type!==e.type&&n.push("["+e.name+'] Expected type "'+e.type+'", got "'+t.type+'"'));return i};var Uat=/[^\\u0000-\\u00ff]/;Ar.prettyPrint=function(t,e,r){var n="";e=e||0,r=r||2,e>0&&(n+=`
`);for(var i="",o=0;o<e*r;++o)i+=" ";switch(n+=i+"Tag: ",t.tagClass){case Ar.Class.UNIVERSAL:n+="Universal:";break;case Ar.Class.APPLICATION:n+="Application:";break;case Ar.Class.CONTEXT_SPECIFIC:n+="Context-Specific:";break;case Ar.Class.PRIVATE:n+="Private:";break}if(t.tagClass===Ar.Class.UNIVERSAL)switch(n+=t.type,t.type){case Ar.Type.NONE:n+=" (None)";break;case Ar.Type.BOOLEAN:n+=" (Boolean)";break;case Ar.Type.INTEGER:n+=" (Integer)";break;case Ar.Type.BITSTRING:n+=" (Bit string)";break;case Ar.Type.OCTETSTRING:n+=" (Octet string)";break;case Ar.Type.NULL:n+=" (Null)";break;case Ar.Type.OID:n+=" (Object Identifier)";break;case Ar.Type.ODESC:n+=" (Object Descriptor)";break;case Ar.Type.EXTERNAL:n+=" (External or Instance of)";break;case Ar.Type.REAL:n+=" (Real)";break;case Ar.Type.ENUMERATED:n+=" (Enumerated)";break;case Ar.Type.EMBEDDED:n+=" (Embedded PDV)";break;case Ar.Type.UTF8:n+=" (UTF8)";break;case Ar.Type.ROID:n+=" (Relative Object Identifier)";break;case Ar.Type.SEQUENCE:n+=" (Sequence)";break;case Ar.Type.SET:n+=" (Set)";break;case Ar.Type.PRINTABLESTRING:n+=" (Printable String)";break;case Ar.Type.IA5String:n+=" (IA5String (ASCII))";break;case Ar.Type.UTCTIME:n+=" (UTC time)";break;case Ar.Type.GENERALIZEDTIME:n+=" (Generalized time)";break;case Ar.Type.BMPSTRING:n+=" (BMP String)";break}else n+=t.type;if(n+=`
`,n+=i+"Constructed: "+t.constructed+`
`,t.composed){for(var a=0,c="",o=0;o<t.value.length;++o)t.value[o]!==void 0&&(a+=1,c+=Ar.prettyPrint(t.value[o],e+1,r),o+1<t.value.length&&(c+=","));n+=i+"Sub values: "+a+c}else{if(n+=i+"Value: ",t.type===Ar.Type.OID){var l=Ar.derToOid(t.value);n+=l,da.pki&&da.pki.oids&&l in da.pki.oids&&(n+=" ("+da.pki.oids[l]+") ")}if(t.type===Ar.Type.INTEGER)try{n+=Ar.derToInteger(t.value)}catch{n+="0x"+da.util.bytesToHex(t.value)}else if(t.type===Ar.Type.BITSTRING){if(t.value.length>1?n+="0x"+da.util.bytesToHex(t.value.slice(1)):n+="(none)",t.value.length>0){var u=t.value.charCodeAt(0);u==1?n+=" (1 unused bit shown)":u>1&&(n+=" ("+u+" unused bits shown)")}}else if(t.type===Ar.Type.OCTETSTRING)Uat.test(t.value)||(n+="("+t.value+") "),n+="0x"+da.util.bytesToHex(t.value);else if(t.type===Ar.Type.UTF8)try{n+=da.util.decodeUtf8(t.value)}catch(f){if(f.message==="URI malformed")n+="0x"+da.util.bytesToHex(t.value)+" (malformed UTF8)";else throw f}else t.type===Ar.Type.PRINTABLESTRING||t.type===Ar.Type.IA5String?n+=t.value:Uat.test(t.value)?n+="0x"+da.util.bytesToHex(t.value):t.value.length===0?n+="[null]":n+=t.value}return n}});var l1=H((Hgi,Hat)=>{d();var Pre=Ri();Hat.exports=Pre.md=Pre.md||{};Pre.md.algorithms=Pre.md.algorithms||{}});var $N=H((Wgi,$at)=>{d();var Xx=Ri();l1();Ho();var alr=$at.exports=Xx.hmac=Xx.hmac||{};alr.create=function(){var t=null,e=null,r=null,n=null,i={};return i.start=function(o,a){if(o!==null)if(typeof o=="string")if(o=o.toLowerCase(),o in Xx.md.algorithms)e=Xx.md.algorithms[o].create();else throw new Error('Unknown hash algorithm "'+o+'"');else e=o;if(a===null)a=t;else{if(typeof a=="string")a=Xx.util.createBuffer(a);else if(Xx.util.isArray(a)){var c=a;a=Xx.util.createBuffer();for(var l=0;l<c.length;++l)a.putByte(c[l])}var u=a.length();u>e.blockLength&&(e.start(),e.update(a.bytes()),a=e.digest()),r=Xx.util.createBuffer(),n=Xx.util.createBuffer(),u=a.length();for(var l=0;l<u;++l){var c=a.at(l);r.putByte(54^c),n.putByte(92^c)}if(u<e.blockLength)for(var c=e.blockLength-u,l=0;l<c;++l)r.putByte(54),n.putByte(92);t=a,r=r.bytes(),n=n.bytes()}e.start(),e.update(r)},i.update=function(o){e.update(o)},i.getMac=function(){var o=e.digest().bytes();return e.start(),e.update(n),e.update(o),e.digest()},i.digest=i.getMac,i}});var Bre=H((Ggi,Vat)=>{d();var u1=Ri();l1();Ho();var jat=Vat.exports=u1.md5=u1.md5||{};u1.md.md5=u1.md.algorithms.md5=jat;jat.create=function(){Gat||clr();var t=null,e=u1.util.createBuffer(),r=new Array(16),n={algorithm:"md5",blockLength:64,digestLength:16,messageLength:0,fullMessageLength:null,messageLengthSize:8};return n.start=function(){n.messageLength=0,n.fullMessageLength=n.messageLength64=[];for(var i=n.messageLengthSize/4,o=0;o<i;++o)n.fullMessageLength.push(0);return e=u1.util.createBuffer(),t={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878},n},n.start(),n.update=function(i,o){o==="utf8"&&(i=u1.util.encodeUtf8(i));var a=i.length;n.messageLength+=a,a=[a/4294967296>>>0,a>>>0];for(var c=n.fullMessageLength.length-1;c>=0;--c)n.fullMessageLength[c]+=a[1],a[1]=a[0]+(n.fullMessageLength[c]/4294967296>>>0),n.fullMessageLength[c]=n.fullMessageLength[c]>>>0,a[0]=a[1]/4294967296>>>0;return e.putBytes(i),Wat(t,r,e),(e.read>2048||e.length()===0)&&e.compact(),n},n.digest=function(){var i=u1.util.createBuffer();i.putBytes(e.bytes());var o=n.fullMessageLength[n.fullMessageLength.length-1]+n.messageLengthSize,a=o&n.blockLength-1;i.putBytes(YTe.substr(0,n.blockLength-a));for(var c,l=0,u=n.fullMessageLength.length-1;u>=0;--u)c=n.fullMessageLength[u]*8+l,l=c/4294967296>>>0,i.putInt32Le(c>>>0);var f={h0:t.h0,h1:t.h1,h2:t.h2,h3:t.h3};Wat(f,r,i);var p=u1.util.createBuffer();return p.putInt32Le(f.h0),p.putInt32Le(f.h1),p.putInt32Le(f.h2),p.putInt32Le(f.h3),p},n};var YTe=null,Dre=null,jQ=null,WN=null,Gat=!1;function clr(){YTe="\x80",YTe+=u1.util.fillString("\0",64),Dre=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,1,6,11,0,5,10,15,4,9,14,3,8,13,2,7,12,5,8,11,14,1,4,7,10,13,0,3,6,9,12,15,2,0,7,14,5,12,3,10,1,8,15,6,13,4,11,2,9],jQ=[7,12,17,22,7,12,17,22,7,12,17,22,7,12,17,22,5,9,14,20,5,9,14,20,5,9,14,20,5,9,14,20,4,11,16,23,4,11,16,23,4,11,16,23,4,11,16,23,6,10,15,21,6,10,15,21,6,10,15,21,6,10,15,21],WN=new Array(64);for(var t=0;t<64;++t)WN[t]=Math.floor(Math.abs(Math.sin(t+1))*4294967296);Gat=!0}s(clr,"_init");function Wat(t,e,r){for(var n,i,o,a,c,l,u,f,p=r.length();p>=64;){for(i=t.h0,o=t.h1,a=t.h2,c=t.h3,f=0;f<16;++f)e[f]=r.getInt32Le(),l=c^o&(a^c),n=i+l+WN[f]+e[f],u=jQ[f],i=c,c=a,a=o,o+=n<<u|n>>>32-u;for(;f<32;++f)l=a^c&(o^a),n=i+l+WN[f]+e[Dre[f]],u=jQ[f],i=c,c=a,a=o,o+=n<<u|n>>>32-u;for(;f<48;++f)l=o^a^c,n=i+l+WN[f]+e[Dre[f]],u=jQ[f],i=c,c=a,a=o,o+=n<<u|n>>>32-u;for(;f<64;++f)l=a^(o|~c),n=i+l+WN[f]+e[Dre[f]],u=jQ[f],i=c,c=a,a=o,o+=n<<u|n>>>32-u;t.h0=t.h0+i|0,t.h1=t.h1+o|0,t.h2=t.h2+a|0,t.h3=t.h3+c|0,p-=64}}s(Wat,"_update")});var Ik=H((Kgi,Kat)=>{d();var Mre=Ri();Ho();var zat=Kat.exports=Mre.pem=Mre.pem||{};zat.encode=function(t,e){e=e||{};var r="-----BEGIN "+t.type+`-----\r
`,n;if(t.procType&&(n={name:"Proc-Type",values:[String(t.procType.version),t.procType.type]},r+=Nre(n)),t.contentDomain&&(n={name:"Content-Domain",values:[t.contentDomain]},r+=Nre(n)),t.dekInfo&&(n={name:"DEK-Info",values:[t.dekInfo.algorithm]},t.dekInfo.parameters&&n.values.push(t.dekInfo.parameters),r+=Nre(n)),t.headers)for(var i=0;i<t.headers.length;++i)r+=Nre(t.headers[i]);return t.procType&&(r+=`\r
`),r+=Mre.util.encode64(t.body,e.maxline||64)+`\r
`,r+="-----END "+t.type+`-----\r
`,r};zat.decode=function(t){for(var e=[],r=/\s*-----BEGIN ([A-Z0-9- ]+)-----\r?\n?([\x21-\x7e\s]+?(?:\r?\n\r?\n))?([:A-Za-z0-9+\/=\s]+?)-----END \1-----/g,n=/([\x21-\x7e]+):\s*([\x21-\x7e\s^:]+)/,i=/\r?\n/,o;o=r.exec(t),!!o;){var a=o[1];a==="NEW CERTIFICATE REQUEST"&&(a="CERTIFICATE REQUEST");var c={type:a,procType:null,contentDomain:null,dekInfo:null,headers:[],body:Mre.util.decode64(o[3])};if(e.push(c),!!o[2]){for(var l=o[2].split(i),u=0;o&&u<l.length;){for(var f=l[u].replace(/\s+$/,""),p=u+1;p<l.length;++p){var m=l[p];if(!/\s/.test(m[0]))break;f+=m,u=p}if(o=f.match(n),o){for(var h={name:o[1],values:[]},g=o[2].split(","),A=0;A<g.length;++A)h.values.push(llr(g[A]));if(c.procType)if(!c.contentDomain&&h.name==="Content-Domain")c.contentDomain=g[0]||"";else if(!c.dekInfo&&h.name==="DEK-Info"){if(h.values.length===0)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must have at least one subfield.');c.dekInfo={algorithm:g[0],parameters:g[1]||null}}else c.headers.push(h);else{if(h.name!=="Proc-Type")throw new Error('Invalid PEM formatted message. The first encapsulated header must be "Proc-Type".');if(h.values.length!==2)throw new Error('Invalid PEM formatted message. The "Proc-Type" header must have two subfields.');c.procType={version:g[0],type:g[1]}}}++u}if(c.procType==="ENCRYPTED"&&!c.dekInfo)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must be present if "Proc-Type" is "ENCRYPTED".')}}if(e.length===0)throw new Error("Invalid PEM formatted message.");return e};function Nre(t){for(var e=t.name+": ",r=[],n=s(function(l,u){return" "+u},"insertSpace"),i=0;i<t.values.length;++i)r.push(t.values[i].replace(/^(\S+\r\n)/,n));e+=r.join(",")+`\r
`;for(var o=0,a=-1,i=0;i<e.length;++i,++o)if(o>65&&a!==-1){var c=e[a];c===","?(++a,e=e.substr(0,a)+`\r
 `+e.substr(a)):e=e.substr(0,a)+`\r
`+c+e.substr(a+1),o=i-a-1,a=-1,++i}else(e[i]===" "||e[i]==="	"||e[i]===",")&&(a=i);return e}s(Nre,"foldHeader");function llr(t){return t.replace(/^\s+/,"")}s(llr,"ltrim")});var GQ=H((Xgi,Jat)=>{d();var Fa=Ri();wre();jTe();Ho();Jat.exports=Fa.des=Fa.des||{};Fa.des.startEncrypting=function(t,e,r,n){var i=Lre({key:t,output:r,decrypt:!1,mode:n||(e===null?"ECB":"CBC")});return i.start(e),i};Fa.des.createEncryptionCipher=function(t,e){return Lre({key:t,output:null,decrypt:!1,mode:e})};Fa.des.startDecrypting=function(t,e,r,n){var i=Lre({key:t,output:r,decrypt:!0,mode:n||(e===null?"ECB":"CBC")});return i.start(e),i};Fa.des.createDecryptionCipher=function(t,e){return Lre({key:t,output:null,decrypt:!0,mode:e})};Fa.des.Algorithm=function(t,e){var r=this;r.name=t,r.mode=new e({blockSize:8,cipher:{encrypt:s(function(n,i){return Yat(r._keys,n,i,!1)},"encrypt"),decrypt:s(function(n,i){return Yat(r._keys,n,i,!0)},"decrypt")}}),r._init=!1};Fa.des.Algorithm.prototype.initialize=function(t){if(!this._init){var e=Fa.util.createBuffer(t.key);if(this.name.indexOf("3DES")===0&&e.length()!==24)throw new Error("Invalid Triple-DES key size: "+e.length()*8);this._keys=ylr(e),this._init=!0}};d1("DES-ECB",Fa.cipher.modes.ecb);d1("DES-CBC",Fa.cipher.modes.cbc);d1("DES-CFB",Fa.cipher.modes.cfb);d1("DES-OFB",Fa.cipher.modes.ofb);d1("DES-CTR",Fa.cipher.modes.ctr);d1("3DES-ECB",Fa.cipher.modes.ecb);d1("3DES-CBC",Fa.cipher.modes.cbc);d1("3DES-CFB",Fa.cipher.modes.cfb);d1("3DES-OFB",Fa.cipher.modes.ofb);d1("3DES-CTR",Fa.cipher.modes.ctr);function d1(t,e){var r=s(function(){return new Fa.des.Algorithm(t,e)},"factory");Fa.cipher.registerAlgorithm(t,r)}s(d1,"registerAlgorithm");var ulr=[16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756],dlr=[-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344],flr=[520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584],plr=[8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928],mlr=[256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080],hlr=[536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312],glr=[2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154],Alr=[268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696];function ylr(t){for(var e=[0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964],r=[0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697],n=[0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272],i=[0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144],o=[0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256],a=[0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488],c=[0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746],l=[0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568],u=[0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578],f=[0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488],p=[0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800],m=[0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744],h=[0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128],g=[0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261],A=t.length()>8?3:1,y=[],E=[0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0],b=0,S,R=0;R<A;R++){var B=t.getInt32(),L=t.getInt32();S=(B>>>4^L)&252645135,L^=S,B^=S<<4,S=(L>>>-16^B)&65535,B^=S,L^=S<<-16,S=(B>>>2^L)&858993459,L^=S,B^=S<<2,S=(L>>>-16^B)&65535,B^=S,L^=S<<-16,S=(B>>>1^L)&1431655765,L^=S,B^=S<<1,S=(L>>>8^B)&16711935,B^=S,L^=S<<8,S=(B>>>1^L)&1431655765,L^=S,B^=S<<1,S=B<<8|L>>>20&240,B=L<<24|L<<8&16711680|L>>>8&65280|L>>>24&240,L=S;for(var O=0;O<E.length;++O){E[O]?(B=B<<2|B>>>26,L=L<<2|L>>>26):(B=B<<1|B>>>27,L=L<<1|L>>>27),B&=-15,L&=-15;var Y=e[B>>>28]|r[B>>>24&15]|n[B>>>20&15]|i[B>>>16&15]|o[B>>>12&15]|a[B>>>8&15]|c[B>>>4&15],V=l[L>>>28]|u[L>>>24&15]|f[L>>>20&15]|p[L>>>16&15]|m[L>>>12&15]|h[L>>>8&15]|g[L>>>4&15];S=(V>>>16^Y)&65535,y[b++]=Y^S,y[b++]=V^S<<16}}return y}s(ylr,"_createKeys");function Yat(t,e,r,n){var i=t.length===32?3:9,o;i===3?o=n?[30,-2,-2]:[0,32,2]:o=n?[94,62,-2,32,64,2,30,-2,-2]:[0,32,2,62,30,-2,64,96,2];var a,c=e[0],l=e[1];a=(c>>>4^l)&252645135,l^=a,c^=a<<4,a=(c>>>16^l)&65535,l^=a,c^=a<<16,a=(l>>>2^c)&858993459,c^=a,l^=a<<2,a=(l>>>8^c)&16711935,c^=a,l^=a<<8,a=(c>>>1^l)&1431655765,l^=a,c^=a<<1,c=c<<1|c>>>31,l=l<<1|l>>>31;for(var u=0;u<i;u+=3){for(var f=o[u+1],p=o[u+2],m=o[u];m!=f;m+=p){var h=l^t[m],g=(l>>>4|l<<28)^t[m+1];a=c,c=l,l=a^(dlr[h>>>24&63]|plr[h>>>16&63]|hlr[h>>>8&63]|Alr[h&63]|ulr[g>>>24&63]|flr[g>>>16&63]|mlr[g>>>8&63]|glr[g&63])}a=c,c=l,l=a}c=c>>>1|c<<31,l=l>>>1|l<<31,a=(c>>>1^l)&1431655765,l^=a,c^=a<<1,a=(l>>>8^c)&16711935,c^=a,l^=a<<8,a=(l>>>2^c)&858993459,c^=a,l^=a<<2,a=(c>>>16^l)&65535,l^=a,c^=a<<16,a=(c>>>4^l)&252645135,l^=a,c^=a<<4,r[0]=c,r[1]=l}s(Yat,"_updateBlock");function Lre(t){t=t||{};var e=(t.mode||"CBC").toUpperCase(),r="DES-"+e,n;t.decrypt?n=Fa.cipher.createDecipher(r,t.key):n=Fa.cipher.createCipher(r,t.key);var i=n.start;return n.start=function(o,a){var c=null;a instanceof Fa.util.ByteBuffer&&(c=a,a={}),a=a||{},a.output=c,a.iv=o,i.call(n,a)},n}s(Lre,"_createCipher")});var Fre=H((tAi,Xat)=>{d();var Ff=Ri();$N();l1();Ho();var Clr=Ff.pkcs5=Ff.pkcs5||{},Zx;Ff.util.isNodejs&&!Ff.options.usePureJavaScript&&(Zx=require("crypto"));Xat.exports=Ff.pbkdf2=Clr.pbkdf2=function(t,e,r,n,i,o){if(typeof i=="function"&&(o=i,i=null),Ff.util.isNodejs&&!Ff.options.usePureJavaScript&&Zx.pbkdf2&&(i===null||typeof i!="object")&&(Zx.pbkdf2Sync.length>4||!i||i==="sha1"))return typeof i!="string"&&(i="sha1"),t=Buffer.from(t,"binary"),e=Buffer.from(e,"binary"),o?Zx.pbkdf2Sync.length===4?Zx.pbkdf2(t,e,r,n,function(S,R){if(S)return o(S);o(null,R.toString("binary"))}):Zx.pbkdf2(t,e,r,n,i,function(S,R){if(S)return o(S);o(null,R.toString("binary"))}):Zx.pbkdf2Sync.length===4?Zx.pbkdf2Sync(t,e,r,n).toString("binary"):Zx.pbkdf2Sync(t,e,r,n,i).toString("binary");if((typeof i>"u"||i===null)&&(i="sha1"),typeof i=="string"){if(!(i in Ff.md.algorithms))throw new Error("Unknown hash algorithm: "+i);i=Ff.md[i].create()}var a=i.digestLength;if(n>4294967295*a){var c=new Error("Derived key is too long.");if(o)return o(c);throw c}var l=Math.ceil(n/a),u=n-(l-1)*a,f=Ff.hmac.create();f.start(i,t);var p="",m,h,g;if(!o){for(var A=1;A<=l;++A){f.start(null,null),f.update(e),f.update(Ff.util.int32ToBytes(A)),m=g=f.digest().getBytes();for(var y=2;y<=r;++y)f.start(null,null),f.update(g),h=f.digest().getBytes(),m=Ff.util.xorBytes(m,h,a),g=h;p+=A<l?m:m.substr(0,u)}return p}var A=1,y;function E(){if(A>l)return o(null,p);f.start(null,null),f.update(e),f.update(Ff.util.int32ToBytes(A)),m=g=f.digest().getBytes(),y=2,b()}s(E,"outer");function b(){if(y<=r)return f.start(null,null),f.update(g),h=f.digest().getBytes(),m=Ff.util.xorBytes(m,h,a),g=h,++y,Ff.util.setImmediate(b);p+=A<l?m:m.substr(0,u),++A,E()}s(b,"inner"),E()}});var XTe=H((iAi,nct)=>{d();var f1=Ri();l1();Ho();var ect=nct.exports=f1.sha256=f1.sha256||{};f1.md.sha256=f1.md.algorithms.sha256=ect;ect.create=function(){tct||vlr();var t=null,e=f1.util.createBuffer(),r=new Array(64),n={algorithm:"sha256",blockLength:64,digestLength:32,messageLength:0,fullMessageLength:null,messageLengthSize:8};return n.start=function(){n.messageLength=0,n.fullMessageLength=n.messageLength64=[];for(var i=n.messageLengthSize/4,o=0;o<i;++o)n.fullMessageLength.push(0);return e=f1.util.createBuffer(),t={h0:1779033703,h1:3144134277,h2:1013904242,h3:2773480762,h4:1359893119,h5:2600822924,h6:528734635,h7:1541459225},n},n.start(),n.update=function(i,o){o==="utf8"&&(i=f1.util.encodeUtf8(i));var a=i.length;n.messageLength+=a,a=[a/4294967296>>>0,a>>>0];for(var c=n.fullMessageLength.length-1;c>=0;--c)n.fullMessageLength[c]+=a[1],a[1]=a[0]+(n.fullMessageLength[c]/4294967296>>>0),n.fullMessageLength[c]=n.fullMessageLength[c]>>>0,a[0]=a[1]/4294967296>>>0;return e.putBytes(i),Zat(t,r,e),(e.read>2048||e.length()===0)&&e.compact(),n},n.digest=function(){var i=f1.util.createBuffer();i.putBytes(e.bytes());var o=n.fullMessageLength[n.fullMessageLength.length-1]+n.messageLengthSize,a=o&n.blockLength-1;i.putBytes(JTe.substr(0,n.blockLength-a));for(var c,l,u=n.fullMessageLength[0]*8,f=0;f<n.fullMessageLength.length-1;++f)c=n.fullMessageLength[f+1]*8,l=c/4294967296>>>0,u+=l,i.putInt32(u>>>0),u=c>>>0;i.putInt32(u);var p={h0:t.h0,h1:t.h1,h2:t.h2,h3:t.h3,h4:t.h4,h5:t.h5,h6:t.h6,h7:t.h7};Zat(p,r,i);var m=f1.util.createBuffer();return m.putInt32(p.h0),m.putInt32(p.h1),m.putInt32(p.h2),m.putInt32(p.h3),m.putInt32(p.h4),m.putInt32(p.h5),m.putInt32(p.h6),m.putInt32(p.h7),m},n};var JTe=null,tct=!1,rct=null;function vlr(){JTe="\x80",JTe+=f1.util.fillString("\0",64),rct=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],tct=!0}s(vlr,"_init");function Zat(t,e,r){for(var n,i,o,a,c,l,u,f,p,m,h,g,A,y,E,b=r.length();b>=64;){for(u=0;u<16;++u)e[u]=r.getInt32();for(;u<64;++u)n=e[u-2],n=(n>>>17|n<<15)^(n>>>19|n<<13)^n>>>10,i=e[u-15],i=(i>>>7|i<<25)^(i>>>18|i<<14)^i>>>3,e[u]=n+e[u-7]+i+e[u-16]|0;for(f=t.h0,p=t.h1,m=t.h2,h=t.h3,g=t.h4,A=t.h5,y=t.h6,E=t.h7,u=0;u<64;++u)a=(g>>>6|g<<26)^(g>>>11|g<<21)^(g>>>25|g<<7),c=y^g&(A^y),o=(f>>>2|f<<30)^(f>>>13|f<<19)^(f>>>22|f<<10),l=f&p|m&(f^p),n=E+a+c+rct[u]+e[u],i=o+l,E=y,y=A,A=g,g=h+n>>>0,h=m,m=p,p=f,f=n+i>>>0;t.h0=t.h0+f|0,t.h1=t.h1+p|0,t.h2=t.h2+m|0,t.h3=t.h3+h|0,t.h4=t.h4+g|0,t.h5=t.h5+A|0,t.h6=t.h6+y|0,t.h7=t.h7+E|0,b-=64}}s(Zat,"_update")});var ZTe=H((aAi,ict)=>{d();var p1=Ri();Ho();var Ore=null;p1.util.isNodejs&&!p1.options.usePureJavaScript&&!process.versions["node-webkit"]&&(Ore=require("crypto"));var xlr=ict.exports=p1.prng=p1.prng||{};xlr.create=function(t){for(var e={plugin:t,key:null,seed:null,time:null,reseeds:0,generated:0,keyBytes:""},r=t.md,n=new Array(32),i=0;i<32;++i)n[i]=r.create();e.pools=n,e.pool=0,e.generate=function(u,f){if(!f)return e.generateSync(u);var p=e.plugin.cipher,m=e.plugin.increment,h=e.plugin.formatKey,g=e.plugin.formatSeed,A=p1.util.createBuffer();e.key=null,y();function y(E){if(E)return f(E);if(A.length()>=u)return f(null,A.getBytes(u));if(e.generated>1048575&&(e.key=null),e.key===null)return p1.util.nextTick(function(){o(y)});var b=p(e.key,e.seed);e.generated+=b.length,A.putBytes(b),e.key=h(p(e.key,m(e.seed))),e.seed=g(p(e.key,e.seed)),p1.util.setImmediate(y)}s(y,"generate")},e.generateSync=function(u){var f=e.plugin.cipher,p=e.plugin.increment,m=e.plugin.formatKey,h=e.plugin.formatSeed;e.key=null;for(var g=p1.util.createBuffer();g.length()<u;){e.generated>1048575&&(e.key=null),e.key===null&&a();var A=f(e.key,e.seed);e.generated+=A.length,g.putBytes(A),e.key=m(f(e.key,p(e.seed))),e.seed=h(f(e.key,e.seed))}return g.getBytes(u)};function o(u){if(e.pools[0].messageLength>=32)return c(),u();var f=32-e.pools[0].messageLength<<5;e.seedFile(f,function(p,m){if(p)return u(p);e.collect(m),c(),u()})}s(o,"_reseed");function a(){if(e.pools[0].messageLength>=32)return c();var u=32-e.pools[0].messageLength<<5;e.collect(e.seedFileSync(u)),c()}s(a,"_reseedSync");function c(){e.reseeds=e.reseeds===4294967295?0:e.reseeds+1;var u=e.plugin.md.create();u.update(e.keyBytes);for(var f=1,p=0;p<32;++p)e.reseeds%f===0&&(u.update(e.pools[p].digest().getBytes()),e.pools[p].start()),f=f<<1;e.keyBytes=u.digest().getBytes(),u.start(),u.update(e.keyBytes);var m=u.digest().getBytes();e.key=e.plugin.formatKey(e.keyBytes),e.seed=e.plugin.formatSeed(m),e.generated=0}s(c,"_seed");function l(u){var f=null,p=p1.util.globalScope,m=p.crypto||p.msCrypto;m&&m.getRandomValues&&(f=s(function(B){return m.getRandomValues(B)},"getRandomValues"));var h=p1.util.createBuffer();if(f)for(;h.length()<u;){var g=Math.max(1,Math.min(u-h.length(),65536)/4),A=new Uint32Array(Math.floor(g));try{f(A);for(var y=0;y<A.length;++y)h.putInt32(A[y])}catch(B){if(!(typeof QuotaExceededError<"u"&&B instanceof QuotaExceededError))throw B}}if(h.length()<u)for(var E,b,S,R=Math.floor(Math.random()*65536);h.length()<u;){b=16807*(R&65535),E=16807*(R>>16),b+=(E&32767)<<16,b+=E>>15,b=(b&2147483647)+(b>>31),R=b&4294967295;for(var y=0;y<3;++y)S=R>>>(y<<3),S^=Math.floor(Math.random()*256),h.putByte(S&255)}return h.getBytes(u)}return s(l,"defaultSeedFile"),Ore?(e.seedFile=function(u,f){Ore.randomBytes(u,function(p,m){if(p)return f(p);f(null,m.toString())})},e.seedFileSync=function(u){return Ore.randomBytes(u).toString()}):(e.seedFile=function(u,f){try{f(null,l(u))}catch(p){f(p)}},e.seedFileSync=l),e.collect=function(u){for(var f=u.length,p=0;p<f;++p)e.pools[e.pool].update(u.substr(p,1)),e.pool=e.pool===31?0:e.pool+1},e.collectInt=function(u,f){for(var p="",m=0;m<f;m+=8)p+=String.fromCharCode(u>>m&255);e.collect(p)},e.registerWorker=function(u){if(u===self)e.seedFile=function(p,m){function h(g){var A=g.data;A.forge&&A.forge.prng&&(self.removeEventListener("message",h),m(A.forge.prng.err,A.forge.prng.bytes))}s(h,"listener"),self.addEventListener("message",h),self.postMessage({forge:{prng:{needed:p}}})};else{var f=s(function(p){var m=p.data;m.forge&&m.forge.prng&&e.seedFile(m.forge.prng.needed,function(h,g){u.postMessage({forge:{prng:{err:h,bytes:g}}})})},"listener");u.addEventListener("message",f)}},e}});var Gh=H((uAi,ewe)=>{d();var Cu=Ri();Cw();XTe();ZTe();Ho();(function(){if(Cu.random&&Cu.random.getBytes){ewe.exports=Cu.random;return}(function(t){var e={},r=new Array(4),n=Cu.util.createBuffer();e.formatKey=function(p){var m=Cu.util.createBuffer(p);return p=new Array(4),p[0]=m.getInt32(),p[1]=m.getInt32(),p[2]=m.getInt32(),p[3]=m.getInt32(),Cu.aes._expandKey(p,!1)},e.formatSeed=function(p){var m=Cu.util.createBuffer(p);return p=new Array(4),p[0]=m.getInt32(),p[1]=m.getInt32(),p[2]=m.getInt32(),p[3]=m.getInt32(),p},e.cipher=function(p,m){return Cu.aes._updateBlock(p,m,r,!1),n.putInt32(r[0]),n.putInt32(r[1]),n.putInt32(r[2]),n.putInt32(r[3]),n.getBytes()},e.increment=function(p){return++p[3],p},e.md=Cu.md.sha256;function i(){var p=Cu.prng.create(e);return p.getBytes=function(m,h){return p.generate(m,h)},p.getBytesSync=function(m){return p.generate(m)},p}s(i,"spawnPrng");var o=i(),a=null,c=Cu.util.globalScope,l=c.crypto||c.msCrypto;if(l&&l.getRandomValues&&(a=s(function(p){return l.getRandomValues(p)},"getRandomValues")),Cu.options.usePureJavaScript||!Cu.util.isNodejs&&!a){if(typeof window>"u"||window.document,o.collectInt(+new Date,32),typeof navigator<"u"){var u="";for(var f in navigator)try{typeof navigator[f]=="string"&&(u+=navigator[f])}catch{}o.collect(u),u=null}t&&(t().mousemove(function(p){o.collectInt(p.clientX,16),o.collectInt(p.clientY,16)}),t().keypress(function(p){o.collectInt(p.charCode,8)}))}if(!Cu.random)Cu.random=o;else for(var f in o)Cu.random[f]=o[f];Cu.random.createInstance=i,ewe.exports=Cu.random})(typeof jQuery<"u"?jQuery:null)})()});var rwe=H((pAi,act)=>{d();var qp=Ri();Ho();var twe=[217,120,249,196,25,221,181,237,40,233,253,121,74,160,216,157,198,126,55,131,43,118,83,142,98,76,100,136,68,139,251,162,23,154,89,245,135,179,79,19,97,69,109,141,9,129,125,50,189,143,64,235,134,183,123,11,240,149,33,34,92,107,78,130,84,214,101,147,206,96,178,28,115,86,192,20,167,140,241,220,18,117,202,31,59,190,228,209,66,61,212,48,163,60,182,38,111,191,14,218,70,105,7,87,39,242,29,155,188,148,67,3,248,17,199,246,144,239,62,231,6,195,213,47,200,102,30,215,8,232,234,222,128,82,238,247,132,170,114,172,53,77,106,42,150,26,210,113,90,21,73,116,75,159,208,94,4,24,164,236,194,224,65,110,15,81,203,204,36,145,175,80,161,244,112,57,153,124,58,133,35,184,180,122,252,2,54,91,37,85,151,49,45,93,250,152,227,138,146,174,5,223,41,16,103,108,186,201,211,0,230,207,225,158,168,44,99,22,1,63,88,226,137,169,13,56,52,27,171,51,255,176,187,72,12,95,185,177,205,46,197,243,219,71,229,165,156,119,10,166,32,104,254,127,193,173],oct=[1,2,3,5],Elr=s(function(t,e){return t<<e&65535|(t&65535)>>16-e},"rol"),blr=s(function(t,e){return(t&65535)>>e|t<<16-e&65535},"ror");act.exports=qp.rc2=qp.rc2||{};qp.rc2.expandKey=function(t,e){typeof t=="string"&&(t=qp.util.createBuffer(t)),e=e||128;var r=t,n=t.length(),i=e,o=Math.ceil(i/8),a=255>>(i&7),c;for(c=n;c<128;c++)r.putByte(twe[r.at(c-1)+r.at(c-n)&255]);for(r.setAt(128-o,twe[r.at(128-o)&a]),c=127-o;c>=0;c--)r.setAt(c,twe[r.at(c+1)^r.at(c+o)]);return r};var sct=s(function(t,e,r){var n=!1,i=null,o=null,a=null,c,l,u,f,p=[];for(t=qp.rc2.expandKey(t,e),u=0;u<64;u++)p.push(t.getInt16Le());r?(c=s(function(g){for(u=0;u<4;u++)g[u]+=p[f]+(g[(u+3)%4]&g[(u+2)%4])+(~g[(u+3)%4]&g[(u+1)%4]),g[u]=Elr(g[u],oct[u]),f++},"mixRound"),l=s(function(g){for(u=0;u<4;u++)g[u]+=p[g[(u+3)%4]&63]},"mashRound")):(c=s(function(g){for(u=3;u>=0;u--)g[u]=blr(g[u],oct[u]),g[u]-=p[f]+(g[(u+3)%4]&g[(u+2)%4])+(~g[(u+3)%4]&g[(u+1)%4]),f--},"mixRound"),l=s(function(g){for(u=3;u>=0;u--)g[u]-=p[g[(u+3)%4]&63]},"mashRound"));var m=s(function(g){var A=[];for(u=0;u<4;u++){var y=i.getInt16Le();a!==null&&(r?y^=a.getInt16Le():a.putInt16Le(y)),A.push(y&65535)}f=r?0:63;for(var E=0;E<g.length;E++)for(var b=0;b<g[E][0];b++)g[E][1](A);for(u=0;u<4;u++)a!==null&&(r?a.putInt16Le(A[u]):A[u]^=a.getInt16Le()),o.putInt16Le(A[u])},"runPlan"),h=null;return h={start:s(function(g,A){g&&typeof g=="string"&&(g=qp.util.createBuffer(g)),n=!1,i=qp.util.createBuffer(),o=A||new qp.util.createBuffer,a=g,h.output=o},"start"),update:s(function(g){for(n||i.putBuffer(g);i.length()>=8;)m([[5,c],[1,l],[6,c],[1,l],[5,c]])},"update"),finish:s(function(g){var A=!0;if(r)if(g)A=g(8,i,!r);else{var y=i.length()===8?8:8-i.length();i.fillWithByte(y,y)}if(A&&(n=!0,h.update()),!r&&(A=i.length()===0,A))if(g)A=g(8,o,!r);else{var E=o.length(),b=o.at(E-1);b>E?A=!1:o.truncate(b)}return A},"finish")},h},"createCipher");qp.rc2.startEncrypting=function(t,e,r){var n=qp.rc2.createEncryptionCipher(t,128);return n.start(e,r),n};qp.rc2.createEncryptionCipher=function(t,e){return sct(t,e,!0)};qp.rc2.startDecrypting=function(t,e,r){var n=qp.rc2.createDecryptionCipher(t,128);return n.start(e,r),n};qp.rc2.createDecryptionCipher=function(t,e){return sct(t,e,!1)}});var zQ=H((gAi,hct)=>{d();var nwe=Ri();hct.exports=nwe.jsbn=nwe.jsbn||{};var eE,Ilr=0xdeadbeefcafe,cct=(Ilr&16777215)==15715070;function kt(t,e,r){this.data=[],t!=null&&(typeof t=="number"?this.fromNumber(t,e,r):e==null&&typeof t!="string"?this.fromString(t,256):this.fromString(t,e))}s(kt,"BigInteger");nwe.jsbn.BigInteger=kt;function $o(){return new kt(null)}s($o,"nbi");function Tlr(t,e,r,n,i,o){for(;--o>=0;){var a=e*this.data[t++]+r.data[n]+i;i=Math.floor(a/67108864),r.data[n++]=a&67108863}return i}s(Tlr,"am1");function wlr(t,e,r,n,i,o){for(var a=e&32767,c=e>>15;--o>=0;){var l=this.data[t]&32767,u=this.data[t++]>>15,f=c*l+u*a;l=a*l+((f&32767)<<15)+r.data[n]+(i&1073741823),i=(l>>>30)+(f>>>15)+c*u+(i>>>30),r.data[n++]=l&1073741823}return i}s(wlr,"am2");function lct(t,e,r,n,i,o){for(var a=e&16383,c=e>>14;--o>=0;){var l=this.data[t]&16383,u=this.data[t++]>>14,f=c*l+u*a;l=a*l+((f&16383)<<14)+r.data[n]+i,i=(l>>28)+(f>>14)+c*u,r.data[n++]=l&268435455}return i}s(lct,"am3");typeof navigator>"u"?(kt.prototype.am=lct,eE=28):cct&&navigator.appName=="Microsoft Internet Explorer"?(kt.prototype.am=wlr,eE=30):cct&&navigator.appName!="Netscape"?(kt.prototype.am=Tlr,eE=26):(kt.prototype.am=lct,eE=28);kt.prototype.DB=eE;kt.prototype.DM=(1<<eE)-1;kt.prototype.DV=1<<eE;var iwe=52;kt.prototype.FV=Math.pow(2,iwe);kt.prototype.F1=iwe-eE;kt.prototype.F2=2*eE-iwe;var Slr="0123456789abcdefghijklmnopqrstuvwxyz",Qre=new Array,jN,Vh;jN=48;for(Vh=0;Vh<=9;++Vh)Qre[jN++]=Vh;jN=97;for(Vh=10;Vh<36;++Vh)Qre[jN++]=Vh;jN=65;for(Vh=10;Vh<36;++Vh)Qre[jN++]=Vh;function uct(t){return Slr.charAt(t)}s(uct,"int2char");function dct(t,e){var r=Qre[t.charCodeAt(e)];return r??-1}s(dct,"intAt");function _lr(t){for(var e=this.t-1;e>=0;--e)t.data[e]=this.data[e];t.t=this.t,t.s=this.s}s(_lr,"bnpCopyTo");function Rlr(t){this.t=1,this.s=t<0?-1:0,t>0?this.data[0]=t:t<-1?this.data[0]=t+this.DV:this.t=0}s(Rlr,"bnpFromInt");function xw(t){var e=$o();return e.fromInt(t),e}s(xw,"nbv");function klr(t,e){var r;if(e==16)r=4;else if(e==8)r=3;else if(e==256)r=8;else if(e==2)r=1;else if(e==32)r=5;else if(e==4)r=2;else{this.fromRadix(t,e);return}this.t=0,this.s=0;for(var n=t.length,i=!1,o=0;--n>=0;){var a=r==8?t[n]&255:dct(t,n);if(a<0){t.charAt(n)=="-"&&(i=!0);continue}i=!1,o==0?this.data[this.t++]=a:o+r>this.DB?(this.data[this.t-1]|=(a&(1<<this.DB-o)-1)<<o,this.data[this.t++]=a>>this.DB-o):this.data[this.t-1]|=a<<o,o+=r,o>=this.DB&&(o-=this.DB)}r==8&&(t[0]&128)!=0&&(this.s=-1,o>0&&(this.data[this.t-1]|=(1<<this.DB-o)-1<<o)),this.clamp(),i&&kt.ZERO.subTo(this,this)}s(klr,"bnpFromString");function Plr(){for(var t=this.s&this.DM;this.t>0&&this.data[this.t-1]==t;)--this.t}s(Plr,"bnpClamp");function Dlr(t){if(this.s<0)return"-"+this.negate().toString(t);var e;if(t==16)e=4;else if(t==8)e=3;else if(t==2)e=1;else if(t==32)e=5;else if(t==4)e=2;else return this.toRadix(t);var r=(1<<e)-1,n,i=!1,o="",a=this.t,c=this.DB-a*this.DB%e;if(a-- >0)for(c<this.DB&&(n=this.data[a]>>c)>0&&(i=!0,o=uct(n));a>=0;)c<e?(n=(this.data[a]&(1<<c)-1)<<e-c,n|=this.data[--a]>>(c+=this.DB-e)):(n=this.data[a]>>(c-=e)&r,c<=0&&(c+=this.DB,--a)),n>0&&(i=!0),i&&(o+=uct(n));return i?o:"0"}s(Dlr,"bnToString");function Blr(){var t=$o();return kt.ZERO.subTo(this,t),t}s(Blr,"bnNegate");function Nlr(){return this.s<0?this.negate():this}s(Nlr,"bnAbs");function Mlr(t){var e=this.s-t.s;if(e!=0)return e;var r=this.t;if(e=r-t.t,e!=0)return this.s<0?-e:e;for(;--r>=0;)if((e=this.data[r]-t.data[r])!=0)return e;return 0}s(Mlr,"bnCompareTo");function Ure(t){var e=1,r;return(r=t>>>16)!=0&&(t=r,e+=16),(r=t>>8)!=0&&(t=r,e+=8),(r=t>>4)!=0&&(t=r,e+=4),(r=t>>2)!=0&&(t=r,e+=2),(r=t>>1)!=0&&(t=r,e+=1),e}s(Ure,"nbits");function Llr(){return this.t<=0?0:this.DB*(this.t-1)+Ure(this.data[this.t-1]^this.s&this.DM)}s(Llr,"bnBitLength");function Flr(t,e){var r;for(r=this.t-1;r>=0;--r)e.data[r+t]=this.data[r];for(r=t-1;r>=0;--r)e.data[r]=0;e.t=this.t+t,e.s=this.s}s(Flr,"bnpDLShiftTo");function Olr(t,e){for(var r=t;r<this.t;++r)e.data[r-t]=this.data[r];e.t=Math.max(this.t-t,0),e.s=this.s}s(Olr,"bnpDRShiftTo");function Qlr(t,e){var r=t%this.DB,n=this.DB-r,i=(1<<n)-1,o=Math.floor(t/this.DB),a=this.s<<r&this.DM,c;for(c=this.t-1;c>=0;--c)e.data[c+o+1]=this.data[c]>>n|a,a=(this.data[c]&i)<<r;for(c=o-1;c>=0;--c)e.data[c]=0;e.data[o]=a,e.t=this.t+o+1,e.s=this.s,e.clamp()}s(Qlr,"bnpLShiftTo");function Ulr(t,e){e.s=this.s;var r=Math.floor(t/this.DB);if(r>=this.t){e.t=0;return}var n=t%this.DB,i=this.DB-n,o=(1<<n)-1;e.data[0]=this.data[r]>>n;for(var a=r+1;a<this.t;++a)e.data[a-r-1]|=(this.data[a]&o)<<i,e.data[a-r]=this.data[a]>>n;n>0&&(e.data[this.t-r-1]|=(this.s&o)<<i),e.t=this.t-r,e.clamp()}s(Ulr,"bnpRShiftTo");function qlr(t,e){for(var r=0,n=0,i=Math.min(t.t,this.t);r<i;)n+=this.data[r]-t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;if(t.t<this.t){for(n-=t.s;r<this.t;)n+=this.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<t.t;)n-=t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n-=t.s}e.s=n<0?-1:0,n<-1?e.data[r++]=this.DV+n:n>0&&(e.data[r++]=n),e.t=r,e.clamp()}s(qlr,"bnpSubTo");function Hlr(t,e){var r=this.abs(),n=t.abs(),i=r.t;for(e.t=i+n.t;--i>=0;)e.data[i]=0;for(i=0;i<n.t;++i)e.data[i+r.t]=r.am(0,n.data[i],e,i,0,r.t);e.s=0,e.clamp(),this.s!=t.s&&kt.ZERO.subTo(e,e)}s(Hlr,"bnpMultiplyTo");function $lr(t){for(var e=this.abs(),r=t.t=2*e.t;--r>=0;)t.data[r]=0;for(r=0;r<e.t-1;++r){var n=e.am(r,e.data[r],t,2*r,0,1);(t.data[r+e.t]+=e.am(r+1,2*e.data[r],t,2*r+1,n,e.t-r-1))>=e.DV&&(t.data[r+e.t]-=e.DV,t.data[r+e.t+1]=1)}t.t>0&&(t.data[t.t-1]+=e.am(r,e.data[r],t,2*r,0,1)),t.s=0,t.clamp()}s($lr,"bnpSquareTo");function Wlr(t,e,r){var n=t.abs();if(!(n.t<=0)){var i=this.abs();if(i.t<n.t){e?.fromInt(0),r!=null&&this.copyTo(r);return}r==null&&(r=$o());var o=$o(),a=this.s,c=t.s,l=this.DB-Ure(n.data[n.t-1]);l>0?(n.lShiftTo(l,o),i.lShiftTo(l,r)):(n.copyTo(o),i.copyTo(r));var u=o.t,f=o.data[u-1];if(f!=0){var p=f*(1<<this.F1)+(u>1?o.data[u-2]>>this.F2:0),m=this.FV/p,h=(1<<this.F1)/p,g=1<<this.F2,A=r.t,y=A-u,E=e??$o();for(o.dlShiftTo(y,E),r.compareTo(E)>=0&&(r.data[r.t++]=1,r.subTo(E,r)),kt.ONE.dlShiftTo(u,E),E.subTo(o,o);o.t<u;)o.data[o.t++]=0;for(;--y>=0;){var b=r.data[--A]==f?this.DM:Math.floor(r.data[A]*m+(r.data[A-1]+g)*h);if((r.data[A]+=o.am(0,b,r,y,0,u))<b)for(o.dlShiftTo(y,E),r.subTo(E,r);r.data[A]<--b;)r.subTo(E,r)}e!=null&&(r.drShiftTo(u,e),a!=c&&kt.ZERO.subTo(e,e)),r.t=u,r.clamp(),l>0&&r.rShiftTo(l,r),a<0&&kt.ZERO.subTo(r,r)}}}s(Wlr,"bnpDivRemTo");function jlr(t){var e=$o();return this.abs().divRemTo(t,null,e),this.s<0&&e.compareTo(kt.ZERO)>0&&t.subTo(e,e),e}s(jlr,"bnMod");function Tk(t){this.m=t}s(Tk,"Classic");function Glr(t){return t.s<0||t.compareTo(this.m)>=0?t.mod(this.m):t}s(Glr,"cConvert");function Vlr(t){return t}s(Vlr,"cRevert");function zlr(t){t.divRemTo(this.m,null,t)}s(zlr,"cReduce");function Klr(t,e,r){t.multiplyTo(e,r),this.reduce(r)}s(Klr,"cMulTo");function Ylr(t,e){t.squareTo(e),this.reduce(e)}s(Ylr,"cSqrTo");Tk.prototype.convert=Glr;Tk.prototype.revert=Vlr;Tk.prototype.reduce=zlr;Tk.prototype.mulTo=Klr;Tk.prototype.sqrTo=Ylr;function Jlr(){if(this.t<1)return 0;var t=this.data[0];if((t&1)==0)return 0;var e=t&3;return e=e*(2-(t&15)*e)&15,e=e*(2-(t&255)*e)&255,e=e*(2-((t&65535)*e&65535))&65535,e=e*(2-t*e%this.DV)%this.DV,e>0?this.DV-e:-e}s(Jlr,"bnpInvDigit");function wk(t){this.m=t,this.mp=t.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<t.DB-15)-1,this.mt2=2*t.t}s(wk,"Montgomery");function Xlr(t){var e=$o();return t.abs().dlShiftTo(this.m.t,e),e.divRemTo(this.m,null,e),t.s<0&&e.compareTo(kt.ZERO)>0&&this.m.subTo(e,e),e}s(Xlr,"montConvert");function Zlr(t){var e=$o();return t.copyTo(e),this.reduce(e),e}s(Zlr,"montRevert");function eur(t){for(;t.t<=this.mt2;)t.data[t.t++]=0;for(var e=0;e<this.m.t;++e){var r=t.data[e]&32767,n=r*this.mpl+((r*this.mph+(t.data[e]>>15)*this.mpl&this.um)<<15)&t.DM;for(r=e+this.m.t,t.data[r]+=this.m.am(0,n,t,e,0,this.m.t);t.data[r]>=t.DV;)t.data[r]-=t.DV,t.data[++r]++}t.clamp(),t.drShiftTo(this.m.t,t),t.compareTo(this.m)>=0&&t.subTo(this.m,t)}s(eur,"montReduce");function tur(t,e){t.squareTo(e),this.reduce(e)}s(tur,"montSqrTo");function rur(t,e,r){t.multiplyTo(e,r),this.reduce(r)}s(rur,"montMulTo");wk.prototype.convert=Xlr;wk.prototype.revert=Zlr;wk.prototype.reduce=eur;wk.prototype.mulTo=rur;wk.prototype.sqrTo=tur;function nur(){return(this.t>0?this.data[0]&1:this.s)==0}s(nur,"bnpIsEven");function iur(t,e){if(t>4294967295||t<1)return kt.ONE;var r=$o(),n=$o(),i=e.convert(this),o=Ure(t)-1;for(i.copyTo(r);--o>=0;)if(e.sqrTo(r,n),(t&1<<o)>0)e.mulTo(n,i,r);else{var a=r;r=n,n=a}return e.revert(r)}s(iur,"bnpExp");function our(t,e){var r;return t<256||e.isEven()?r=new Tk(e):r=new wk(e),this.exp(t,r)}s(our,"bnModPowInt");kt.prototype.copyTo=_lr;kt.prototype.fromInt=Rlr;kt.prototype.fromString=klr;kt.prototype.clamp=Plr;kt.prototype.dlShiftTo=Flr;kt.prototype.drShiftTo=Olr;kt.prototype.lShiftTo=Qlr;kt.prototype.rShiftTo=Ulr;kt.prototype.subTo=qlr;kt.prototype.multiplyTo=Hlr;kt.prototype.squareTo=$lr;kt.prototype.divRemTo=Wlr;kt.prototype.invDigit=Jlr;kt.prototype.isEven=nur;kt.prototype.exp=iur;kt.prototype.toString=Dlr;kt.prototype.negate=Blr;kt.prototype.abs=Nlr;kt.prototype.compareTo=Mlr;kt.prototype.bitLength=Llr;kt.prototype.mod=jlr;kt.prototype.modPowInt=our;kt.ZERO=xw(0);kt.ONE=xw(1);function sur(){var t=$o();return this.copyTo(t),t}s(sur,"bnClone");function aur(){if(this.s<0){if(this.t==1)return this.data[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this.data[0];if(this.t==0)return 0}return(this.data[1]&(1<<32-this.DB)-1)<<this.DB|this.data[0]}s(aur,"bnIntValue");function cur(){return this.t==0?this.s:this.data[0]<<24>>24}s(cur,"bnByteValue");function lur(){return this.t==0?this.s:this.data[0]<<16>>16}s(lur,"bnShortValue");function uur(t){return Math.floor(Math.LN2*this.DB/Math.log(t))}s(uur,"bnpChunkSize");function dur(){return this.s<0?-1:this.t<=0||this.t==1&&this.data[0]<=0?0:1}s(dur,"bnSigNum");function fur(t){if(t==null&&(t=10),this.signum()==0||t<2||t>36)return"0";var e=this.chunkSize(t),r=Math.pow(t,e),n=xw(r),i=$o(),o=$o(),a="";for(this.divRemTo(n,i,o);i.signum()>0;)a=(r+o.intValue()).toString(t).substr(1)+a,i.divRemTo(n,i,o);return o.intValue().toString(t)+a}s(fur,"bnpToRadix");function pur(t,e){this.fromInt(0),e==null&&(e=10);for(var r=this.chunkSize(e),n=Math.pow(e,r),i=!1,o=0,a=0,c=0;c<t.length;++c){var l=dct(t,c);if(l<0){t.charAt(c)=="-"&&this.signum()==0&&(i=!0);continue}a=e*a+l,++o>=r&&(this.dMultiply(n),this.dAddOffset(a,0),o=0,a=0)}o>0&&(this.dMultiply(Math.pow(e,o)),this.dAddOffset(a,0)),i&&kt.ZERO.subTo(this,this)}s(pur,"bnpFromRadix");function mur(t,e,r){if(typeof e=="number")if(t<2)this.fromInt(1);else for(this.fromNumber(t,r),this.testBit(t-1)||this.bitwiseTo(kt.ONE.shiftLeft(t-1),owe,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(e);)this.dAddOffset(2,0),this.bitLength()>t&&this.subTo(kt.ONE.shiftLeft(t-1),this);else{var n=new Array,i=t&7;n.length=(t>>3)+1,e.nextBytes(n),i>0?n[0]&=(1<<i)-1:n[0]=0,this.fromString(n,256)}}s(mur,"bnpFromNumber");function hur(){var t=this.t,e=new Array;e[0]=this.s;var r=this.DB-t*this.DB%8,n,i=0;if(t-- >0)for(r<this.DB&&(n=this.data[t]>>r)!=(this.s&this.DM)>>r&&(e[i++]=n|this.s<<this.DB-r);t>=0;)r<8?(n=(this.data[t]&(1<<r)-1)<<8-r,n|=this.data[--t]>>(r+=this.DB-8)):(n=this.data[t]>>(r-=8)&255,r<=0&&(r+=this.DB,--t)),(n&128)!=0&&(n|=-256),i==0&&(this.s&128)!=(n&128)&&++i,(i>0||n!=this.s)&&(e[i++]=n);return e}s(hur,"bnToByteArray");function gur(t){return this.compareTo(t)==0}s(gur,"bnEquals");function Aur(t){return this.compareTo(t)<0?this:t}s(Aur,"bnMin");function yur(t){return this.compareTo(t)>0?this:t}s(yur,"bnMax");function Cur(t,e,r){var n,i,o=Math.min(t.t,this.t);for(n=0;n<o;++n)r.data[n]=e(this.data[n],t.data[n]);if(t.t<this.t){for(i=t.s&this.DM,n=o;n<this.t;++n)r.data[n]=e(this.data[n],i);r.t=this.t}else{for(i=this.s&this.DM,n=o;n<t.t;++n)r.data[n]=e(i,t.data[n]);r.t=t.t}r.s=e(this.s,t.s),r.clamp()}s(Cur,"bnpBitwiseTo");function vur(t,e){return t&e}s(vur,"op_and");function xur(t){var e=$o();return this.bitwiseTo(t,vur,e),e}s(xur,"bnAnd");function owe(t,e){return t|e}s(owe,"op_or");function Eur(t){var e=$o();return this.bitwiseTo(t,owe,e),e}s(Eur,"bnOr");function fct(t,e){return t^e}s(fct,"op_xor");function bur(t){var e=$o();return this.bitwiseTo(t,fct,e),e}s(bur,"bnXor");function pct(t,e){return t&~e}s(pct,"op_andnot");function Iur(t){var e=$o();return this.bitwiseTo(t,pct,e),e}s(Iur,"bnAndNot");function Tur(){for(var t=$o(),e=0;e<this.t;++e)t.data[e]=this.DM&~this.data[e];return t.t=this.t,t.s=~this.s,t}s(Tur,"bnNot");function wur(t){var e=$o();return t<0?this.rShiftTo(-t,e):this.lShiftTo(t,e),e}s(wur,"bnShiftLeft");function Sur(t){var e=$o();return t<0?this.lShiftTo(-t,e):this.rShiftTo(t,e),e}s(Sur,"bnShiftRight");function _ur(t){if(t==0)return-1;var e=0;return(t&65535)==0&&(t>>=16,e+=16),(t&255)==0&&(t>>=8,e+=8),(t&15)==0&&(t>>=4,e+=4),(t&3)==0&&(t>>=2,e+=2),(t&1)==0&&++e,e}s(_ur,"lbit");function Rur(){for(var t=0;t<this.t;++t)if(this.data[t]!=0)return t*this.DB+_ur(this.data[t]);return this.s<0?this.t*this.DB:-1}s(Rur,"bnGetLowestSetBit");function kur(t){for(var e=0;t!=0;)t&=t-1,++e;return e}s(kur,"cbit");function Pur(){for(var t=0,e=this.s&this.DM,r=0;r<this.t;++r)t+=kur(this.data[r]^e);return t}s(Pur,"bnBitCount");function Dur(t){var e=Math.floor(t/this.DB);return e>=this.t?this.s!=0:(this.data[e]&1<<t%this.DB)!=0}s(Dur,"bnTestBit");function Bur(t,e){var r=kt.ONE.shiftLeft(t);return this.bitwiseTo(r,e,r),r}s(Bur,"bnpChangeBit");function Nur(t){return this.changeBit(t,owe)}s(Nur,"bnSetBit");function Mur(t){return this.changeBit(t,pct)}s(Mur,"bnClearBit");function Lur(t){return this.changeBit(t,fct)}s(Lur,"bnFlipBit");function Fur(t,e){for(var r=0,n=0,i=Math.min(t.t,this.t);r<i;)n+=this.data[r]+t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;if(t.t<this.t){for(n+=t.s;r<this.t;)n+=this.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<t.t;)n+=t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n+=t.s}e.s=n<0?-1:0,n>0?e.data[r++]=n:n<-1&&(e.data[r++]=this.DV+n),e.t=r,e.clamp()}s(Fur,"bnpAddTo");function Our(t){var e=$o();return this.addTo(t,e),e}s(Our,"bnAdd");function Qur(t){var e=$o();return this.subTo(t,e),e}s(Qur,"bnSubtract");function Uur(t){var e=$o();return this.multiplyTo(t,e),e}s(Uur,"bnMultiply");function qur(t){var e=$o();return this.divRemTo(t,e,null),e}s(qur,"bnDivide");function Hur(t){var e=$o();return this.divRemTo(t,null,e),e}s(Hur,"bnRemainder");function $ur(t){var e=$o(),r=$o();return this.divRemTo(t,e,r),new Array(e,r)}s($ur,"bnDivideAndRemainder");function Wur(t){this.data[this.t]=this.am(0,t-1,this,0,0,this.t),++this.t,this.clamp()}s(Wur,"bnpDMultiply");function jur(t,e){if(t!=0){for(;this.t<=e;)this.data[this.t++]=0;for(this.data[e]+=t;this.data[e]>=this.DV;)this.data[e]-=this.DV,++e>=this.t&&(this.data[this.t++]=0),++this.data[e]}}s(jur,"bnpDAddOffset");function VQ(){}s(VQ,"NullExp");function mct(t){return t}s(mct,"nNop");function Gur(t,e,r){t.multiplyTo(e,r)}s(Gur,"nMulTo");function Vur(t,e){t.squareTo(e)}s(Vur,"nSqrTo");VQ.prototype.convert=mct;VQ.prototype.revert=mct;VQ.prototype.mulTo=Gur;VQ.prototype.sqrTo=Vur;function zur(t){return this.exp(t,new VQ)}s(zur,"bnPow");function Kur(t,e,r){var n=Math.min(this.t+t.t,e);for(r.s=0,r.t=n;n>0;)r.data[--n]=0;var i;for(i=r.t-this.t;n<i;++n)r.data[n+this.t]=this.am(0,t.data[n],r,n,0,this.t);for(i=Math.min(t.t,e);n<i;++n)this.am(0,t.data[n],r,n,0,e-n);r.clamp()}s(Kur,"bnpMultiplyLowerTo");function Yur(t,e,r){--e;var n=r.t=this.t+t.t-e;for(r.s=0;--n>=0;)r.data[n]=0;for(n=Math.max(e-this.t,0);n<t.t;++n)r.data[this.t+n-e]=this.am(e-n,t.data[n],r,0,0,this.t+n-e);r.clamp(),r.drShiftTo(1,r)}s(Yur,"bnpMultiplyUpperTo");function GN(t){this.r2=$o(),this.q3=$o(),kt.ONE.dlShiftTo(2*t.t,this.r2),this.mu=this.r2.divide(t),this.m=t}s(GN,"Barrett");function Jur(t){if(t.s<0||t.t>2*this.m.t)return t.mod(this.m);if(t.compareTo(this.m)<0)return t;var e=$o();return t.copyTo(e),this.reduce(e),e}s(Jur,"barrettConvert");function Xur(t){return t}s(Xur,"barrettRevert");function Zur(t){for(t.drShiftTo(this.m.t-1,this.r2),t.t>this.m.t+1&&(t.t=this.m.t+1,t.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);t.compareTo(this.r2)<0;)t.dAddOffset(1,this.m.t+1);for(t.subTo(this.r2,t);t.compareTo(this.m)>=0;)t.subTo(this.m,t)}s(Zur,"barrettReduce");function edr(t,e){t.squareTo(e),this.reduce(e)}s(edr,"barrettSqrTo");function tdr(t,e,r){t.multiplyTo(e,r),this.reduce(r)}s(tdr,"barrettMulTo");GN.prototype.convert=Jur;GN.prototype.revert=Xur;GN.prototype.reduce=Zur;GN.prototype.mulTo=tdr;GN.prototype.sqrTo=edr;function rdr(t,e){var r=t.bitLength(),n,i=xw(1),o;if(r<=0)return i;r<18?n=1:r<48?n=3:r<144?n=4:r<768?n=5:n=6,r<8?o=new Tk(e):e.isEven()?o=new GN(e):o=new wk(e);var a=new Array,c=3,l=n-1,u=(1<<n)-1;if(a[1]=o.convert(this),n>1){var f=$o();for(o.sqrTo(a[1],f);c<=u;)a[c]=$o(),o.mulTo(f,a[c-2],a[c]),c+=2}var p=t.t-1,m,h=!0,g=$o(),A;for(r=Ure(t.data[p])-1;p>=0;){for(r>=l?m=t.data[p]>>r-l&u:(m=(t.data[p]&(1<<r+1)-1)<<l-r,p>0&&(m|=t.data[p-1]>>this.DB+r-l)),c=n;(m&1)==0;)m>>=1,--c;if((r-=c)<0&&(r+=this.DB,--p),h)a[m].copyTo(i),h=!1;else{for(;c>1;)o.sqrTo(i,g),o.sqrTo(g,i),c-=2;c>0?o.sqrTo(i,g):(A=i,i=g,g=A),o.mulTo(g,a[m],i)}for(;p>=0&&(t.data[p]&1<<r)==0;)o.sqrTo(i,g),A=i,i=g,g=A,--r<0&&(r=this.DB-1,--p)}return o.revert(i)}s(rdr,"bnModPow");function ndr(t){var e=this.s<0?this.negate():this.clone(),r=t.s<0?t.negate():t.clone();if(e.compareTo(r)<0){var n=e;e=r,r=n}var i=e.getLowestSetBit(),o=r.getLowestSetBit();if(o<0)return e;for(i<o&&(o=i),o>0&&(e.rShiftTo(o,e),r.rShiftTo(o,r));e.signum()>0;)(i=e.getLowestSetBit())>0&&e.rShiftTo(i,e),(i=r.getLowestSetBit())>0&&r.rShiftTo(i,r),e.compareTo(r)>=0?(e.subTo(r,e),e.rShiftTo(1,e)):(r.subTo(e,r),r.rShiftTo(1,r));return o>0&&r.lShiftTo(o,r),r}s(ndr,"bnGCD");function idr(t){if(t<=0)return 0;var e=this.DV%t,r=this.s<0?t-1:0;if(this.t>0)if(e==0)r=this.data[0]%t;else for(var n=this.t-1;n>=0;--n)r=(e*r+this.data[n])%t;return r}s(idr,"bnpModInt");function odr(t){var e=t.isEven();if(this.isEven()&&e||t.signum()==0)return kt.ZERO;for(var r=t.clone(),n=this.clone(),i=xw(1),o=xw(0),a=xw(0),c=xw(1);r.signum()!=0;){for(;r.isEven();)r.rShiftTo(1,r),e?((!i.isEven()||!o.isEven())&&(i.addTo(this,i),o.subTo(t,o)),i.rShiftTo(1,i)):o.isEven()||o.subTo(t,o),o.rShiftTo(1,o);for(;n.isEven();)n.rShiftTo(1,n),e?((!a.isEven()||!c.isEven())&&(a.addTo(this,a),c.subTo(t,c)),a.rShiftTo(1,a)):c.isEven()||c.subTo(t,c),c.rShiftTo(1,c);r.compareTo(n)>=0?(r.subTo(n,r),e&&i.subTo(a,i),o.subTo(c,o)):(n.subTo(r,n),e&&a.subTo(i,a),c.subTo(o,c))}if(n.compareTo(kt.ONE)!=0)return kt.ZERO;if(c.compareTo(t)>=0)return c.subtract(t);if(c.signum()<0)c.addTo(t,c);else return c;return c.signum()<0?c.add(t):c}s(odr,"bnModInverse");var JA=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509],sdr=(1<<26)/JA[JA.length-1];function adr(t){var e,r=this.abs();if(r.t==1&&r.data[0]<=JA[JA.length-1]){for(e=0;e<JA.length;++e)if(r.data[0]==JA[e])return!0;return!1}if(r.isEven())return!1;for(e=1;e<JA.length;){for(var n=JA[e],i=e+1;i<JA.length&&n<sdr;)n*=JA[i++];for(n=r.modInt(n);e<i;)if(n%JA[e++]==0)return!1}return r.millerRabin(t)}s(adr,"bnIsProbablePrime");function cdr(t){var e=this.subtract(kt.ONE),r=e.getLowestSetBit();if(r<=0)return!1;for(var n=e.shiftRight(r),i=ldr(),o,a=0;a<t;++a){do o=new kt(this.bitLength(),i);while(o.compareTo(kt.ONE)<=0||o.compareTo(e)>=0);var c=o.modPow(n,this);if(c.compareTo(kt.ONE)!=0&&c.compareTo(e)!=0){for(var l=1;l++<r&&c.compareTo(e)!=0;)if(c=c.modPowInt(2,this),c.compareTo(kt.ONE)==0)return!1;if(c.compareTo(e)!=0)return!1}}return!0}s(cdr,"bnpMillerRabin");function ldr(){return{nextBytes:s(function(t){for(var e=0;e<t.length;++e)t[e]=Math.floor(Math.random()*256)},"nextBytes")}}s(ldr,"bnGetPrng");kt.prototype.chunkSize=uur;kt.prototype.toRadix=fur;kt.prototype.fromRadix=pur;kt.prototype.fromNumber=mur;kt.prototype.bitwiseTo=Cur;kt.prototype.changeBit=Bur;kt.prototype.addTo=Fur;kt.prototype.dMultiply=Wur;kt.prototype.dAddOffset=jur;kt.prototype.multiplyLowerTo=Kur;kt.prototype.multiplyUpperTo=Yur;kt.prototype.modInt=idr;kt.prototype.millerRabin=cdr;kt.prototype.clone=sur;kt.prototype.intValue=aur;kt.prototype.byteValue=cur;kt.prototype.shortValue=lur;kt.prototype.signum=dur;kt.prototype.toByteArray=hur;kt.prototype.equals=gur;kt.prototype.min=Aur;kt.prototype.max=yur;kt.prototype.and=xur;kt.prototype.or=Eur;kt.prototype.xor=bur;kt.prototype.andNot=Iur;kt.prototype.not=Tur;kt.prototype.shiftLeft=wur;kt.prototype.shiftRight=Sur;kt.prototype.getLowestSetBit=Rur;kt.prototype.bitCount=Pur;kt.prototype.testBit=Dur;kt.prototype.setBit=Nur;kt.prototype.clearBit=Mur;kt.prototype.flipBit=Lur;kt.prototype.add=Our;kt.prototype.subtract=Qur;kt.prototype.multiply=Uur;kt.prototype.divide=qur;kt.prototype.remainder=Hur;kt.prototype.divideAndRemainder=$ur;kt.prototype.modPow=rdr;kt.prototype.modInverse=odr;kt.prototype.pow=zur;kt.prototype.gcd=ndr;kt.prototype.isProbablePrime=adr});var VN=H((CAi,Cct)=>{d();var m1=Ri();l1();Ho();var Act=Cct.exports=m1.sha1=m1.sha1||{};m1.md.sha1=m1.md.algorithms.sha1=Act;Act.create=function(){yct||udr();var t=null,e=m1.util.createBuffer(),r=new Array(80),n={algorithm:"sha1",blockLength:64,digestLength:20,messageLength:0,fullMessageLength:null,messageLengthSize:8};return n.start=function(){n.messageLength=0,n.fullMessageLength=n.messageLength64=[];for(var i=n.messageLengthSize/4,o=0;o<i;++o)n.fullMessageLength.push(0);return e=m1.util.createBuffer(),t={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520},n},n.start(),n.update=function(i,o){o==="utf8"&&(i=m1.util.encodeUtf8(i));var a=i.length;n.messageLength+=a,a=[a/4294967296>>>0,a>>>0];for(var c=n.fullMessageLength.length-1;c>=0;--c)n.fullMessageLength[c]+=a[1],a[1]=a[0]+(n.fullMessageLength[c]/4294967296>>>0),n.fullMessageLength[c]=n.fullMessageLength[c]>>>0,a[0]=a[1]/4294967296>>>0;return e.putBytes(i),gct(t,r,e),(e.read>2048||e.length()===0)&&e.compact(),n},n.digest=function(){var i=m1.util.createBuffer();i.putBytes(e.bytes());var o=n.fullMessageLength[n.fullMessageLength.length-1]+n.messageLengthSize,a=o&n.blockLength-1;i.putBytes(swe.substr(0,n.blockLength-a));for(var c,l,u=n.fullMessageLength[0]*8,f=0;f<n.fullMessageLength.length-1;++f)c=n.fullMessageLength[f+1]*8,l=c/4294967296>>>0,u+=l,i.putInt32(u>>>0),u=c>>>0;i.putInt32(u);var p={h0:t.h0,h1:t.h1,h2:t.h2,h3:t.h3,h4:t.h4};gct(p,r,i);var m=m1.util.createBuffer();return m.putInt32(p.h0),m.putInt32(p.h1),m.putInt32(p.h2),m.putInt32(p.h3),m.putInt32(p.h4),m},n};var swe=null,yct=!1;function udr(){swe="\x80",swe+=m1.util.fillString("\0",64),yct=!0}s(udr,"_init");function gct(t,e,r){for(var n,i,o,a,c,l,u,f,p=r.length();p>=64;){for(i=t.h0,o=t.h1,a=t.h2,c=t.h3,l=t.h4,f=0;f<16;++f)n=r.getInt32(),e[f]=n,u=c^o&(a^c),n=(i<<5|i>>>27)+u+l+1518500249+n,l=c,c=a,a=(o<<30|o>>>2)>>>0,o=i,i=n;for(;f<20;++f)n=e[f-3]^e[f-8]^e[f-14]^e[f-16],n=n<<1|n>>>31,e[f]=n,u=c^o&(a^c),n=(i<<5|i>>>27)+u+l+1518500249+n,l=c,c=a,a=(o<<30|o>>>2)>>>0,o=i,i=n;for(;f<32;++f)n=e[f-3]^e[f-8]^e[f-14]^e[f-16],n=n<<1|n>>>31,e[f]=n,u=o^a^c,n=(i<<5|i>>>27)+u+l+1859775393+n,l=c,c=a,a=(o<<30|o>>>2)>>>0,o=i,i=n;for(;f<40;++f)n=e[f-6]^e[f-16]^e[f-28]^e[f-32],n=n<<2|n>>>30,e[f]=n,u=o^a^c,n=(i<<5|i>>>27)+u+l+1859775393+n,l=c,c=a,a=(o<<30|o>>>2)>>>0,o=i,i=n;for(;f<60;++f)n=e[f-6]^e[f-16]^e[f-28]^e[f-32],n=n<<2|n>>>30,e[f]=n,u=o&a|c&(o^a),n=(i<<5|i>>>27)+u+l+2400959708+n,l=c,c=a,a=(o<<30|o>>>2)>>>0,o=i,i=n;for(;f<80;++f)n=e[f-6]^e[f-16]^e[f-28]^e[f-32],n=n<<2|n>>>30,e[f]=n,u=o^a^c,n=(i<<5|i>>>27)+u+l+3395469782+n,l=c,c=a,a=(o<<30|o>>>2)>>>0,o=i,i=n;t.h0=t.h0+i|0,t.h1=t.h1+o|0,t.h2=t.h2+a|0,t.h3=t.h3+c|0,t.h4=t.h4+l|0,p-=64}}s(gct,"_update")});var awe=H((EAi,xct)=>{d();var h1=Ri();Ho();Gh();VN();var vct=xct.exports=h1.pkcs1=h1.pkcs1||{};vct.encode_rsa_oaep=function(t,e,r){var n,i,o,a;typeof r=="string"?(n=r,i=arguments[3]||void 0,o=arguments[4]||void 0):r&&(n=r.label||void 0,i=r.seed||void 0,o=r.md||void 0,r.mgf1&&r.mgf1.md&&(a=r.mgf1.md)),o?o.start():o=h1.md.sha1.create(),a||(a=o);var c=Math.ceil(t.n.bitLength()/8),l=c-2*o.digestLength-2;if(e.length>l){var u=new Error("RSAES-OAEP input message length is too long.");throw u.length=e.length,u.maxLength=l,u}n||(n=""),o.update(n,"raw");for(var f=o.digest(),p="",m=l-e.length,h=0;h<m;h++)p+="\0";var g=f.getBytes()+p+""+e;if(!i)i=h1.random.getBytes(o.digestLength);else if(i.length!==o.digestLength){var u=new Error("Invalid RSAES-OAEP seed. The seed length must match the digest length.");throw u.seedLength=i.length,u.digestLength=o.digestLength,u}var A=qre(i,c-o.digestLength-1,a),y=h1.util.xorBytes(g,A,g.length),E=qre(y,o.digestLength,a),b=h1.util.xorBytes(i,E,i.length);return"\0"+b+y};vct.decode_rsa_oaep=function(t,e,r){var n,i,o;typeof r=="string"?(n=r,i=arguments[3]||void 0):r&&(n=r.label||void 0,i=r.md||void 0,r.mgf1&&r.mgf1.md&&(o=r.mgf1.md));var a=Math.ceil(t.n.bitLength()/8);if(e.length!==a){var y=new Error("RSAES-OAEP encoded message length is invalid.");throw y.length=e.length,y.expectedLength=a,y}if(i===void 0?i=h1.md.sha1.create():i.start(),o||(o=i),a<2*i.digestLength+2)throw new Error("RSAES-OAEP key is too short for the hash function.");n||(n=""),i.update(n,"raw");for(var c=i.digest().getBytes(),l=e.charAt(0),u=e.substring(1,i.digestLength+1),f=e.substring(1+i.digestLength),p=qre(f,i.digestLength,o),m=h1.util.xorBytes(u,p,u.length),h=qre(m,a-i.digestLength-1,o),g=h1.util.xorBytes(f,h,f.length),A=g.substring(0,i.digestLength),y=l!=="\0",E=0;E<i.digestLength;++E)y|=c.charAt(E)!==A.charAt(E);for(var b=1,S=i.digestLength,R=i.digestLength;R<g.length;R++){var B=g.charCodeAt(R),L=B&1^1,O=b?65534:0;y|=B&O,b=b&L,S+=b}if(y||g.charCodeAt(S)!==1)throw new Error("Invalid RSAES-OAEP padding.");return g.substring(S+1)};function qre(t,e,r){r||(r=h1.md.sha1.create());for(var n="",i=Math.ceil(e/r.digestLength),o=0;o<i;++o){var a=String.fromCharCode(o>>24&255,o>>16&255,o>>8&255,o&255);r.start(),r.update(t+a),n+=r.digest().getBytes()}return n.substring(0,e)}s(qre,"rsa_mgf1")});var lwe=H((TAi,cwe)=>{d();var Ew=Ri();Ho();zQ();Gh();(function(){if(Ew.prime){cwe.exports=Ew.prime;return}var t=cwe.exports=Ew.prime=Ew.prime||{},e=Ew.jsbn.BigInteger,r=[6,4,2,4,2,4,6,2],n=new e(null);n.fromInt(30);var i=s(function(p,m){return p|m},"op_or");t.generateProbablePrime=function(p,m,h){typeof m=="function"&&(h=m,m={}),m=m||{};var g=m.algorithm||"PRIMEINC";typeof g=="string"&&(g={name:g}),g.options=g.options||{};var A=m.prng||Ew.random,y={nextBytes:s(function(E){for(var b=A.getBytesSync(E.length),S=0;S<E.length;++S)E[S]=b.charCodeAt(S)},"nextBytes")};if(g.name==="PRIMEINC")return o(p,y,g.options,h);throw new Error("Invalid prime generation algorithm: "+g.name)};function o(p,m,h,g){return"workers"in h?l(p,m,h,g):a(p,m,h,g)}s(o,"primeincFindPrime");function a(p,m,h,g){var A=u(p,m),y=0,E=f(A.bitLength());"millerRabinTests"in h&&(E=h.millerRabinTests);var b=10;"maxBlockTime"in h&&(b=h.maxBlockTime),c(A,p,m,y,E,b,g)}s(a,"primeincFindPrimeWithoutWorkers");function c(p,m,h,g,A,y,E){var b=+new Date;do{if(p.bitLength()>m&&(p=u(m,h)),p.isProbablePrime(A))return E(null,p);p.dAddOffset(r[g++%8],0)}while(y<0||+new Date-b<y);Ew.util.setImmediate(function(){c(p,m,h,g,A,y,E)})}s(c,"_primeinc");function l(p,m,h,g){if(typeof Worker>"u")return a(p,m,h,g);var A=u(p,m),y=h.workers,E=h.workLoad||100,b=E*30/8,S=h.workerScript||"forge/prime.worker.js";if(y===-1)return Ew.util.estimateCores(function(B,L){B&&(L=2),y=L-1,R()});R();function R(){y=Math.max(1,y);for(var B=[],L=0;L<y;++L)B[L]=new Worker(S);for(var O=y,L=0;L<y;++L)B[L].addEventListener("message",V);var Y=!1;function V(z){if(!Y){--O;var Q=z.data;if(Q.found){for(var U=0;U<B.length;++U)B[U].terminate();return Y=!0,g(null,new e(Q.prime,16))}A.bitLength()>p&&(A=u(p,m));var Z=A.toString(16);z.target.postMessage({hex:Z,workLoad:E}),A.dAddOffset(b,0)}}s(V,"workerMessage")}s(R,"generate")}s(l,"primeincFindPrimeWithWorkers");function u(p,m){var h=new e(p,m),g=p-1;return h.testBit(g)||h.bitwiseTo(e.ONE.shiftLeft(g),i,h),h.dAddOffset(31-h.mod(n).byteValue(),0),h}s(u,"generateRandom");function f(p){return p<=100?27:p<=150?18:p<=200?15:p<=250?12:p<=300?9:p<=350?8:p<=400?7:p<=500?6:p<=600?5:p<=800?4:p<=1250?3:2}s(f,"getMillerRabinTests")})()});var KQ=H((_Ai,_ct)=>{d();var An=Ri();YA();zQ();vw();awe();lwe();Gh();Ho();typeof Do>"u"&&(Do=An.jsbn.BigInteger);var Do,uwe=An.util.isNodejs?require("crypto"):null,ze=An.asn1,zh=An.util;An.pki=An.pki||{};_ct.exports=An.pki.rsa=An.rsa=An.rsa||{};var Ai=An.pki,ddr=[6,4,2,4,2,4,6,2],fdr={name:"PrivateKeyInfo",tagClass:ze.Class.UNIVERSAL,type:ze.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:ze.Class.UNIVERSAL,type:ze.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:ze.Class.UNIVERSAL,type:ze.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:ze.Class.UNIVERSAL,type:ze.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:ze.Class.UNIVERSAL,type:ze.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]},pdr={name:"RSAPrivateKey",tagClass:ze.Class.UNIVERSAL,type:ze.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPrivateKey.version",tagClass:ze.Class.UNIVERSAL,type:ze.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"RSAPrivateKey.modulus",tagClass:ze.Class.UNIVERSAL,type:ze.Type.INTEGER,constructed:!1,capture:"privateKeyModulus"},{name:"RSAPrivateKey.publicExponent",tagClass:ze.Class.UNIVERSAL,type:ze.Type.INTEGER,constructed:!1,capture:"privateKeyPublicExponent"},{name:"RSAPrivateKey.privateExponent",tagClass:ze.Class.UNIVERSAL,type:ze.Type.INTEGER,constructed:!1,capture:"privateKeyPrivateExponent"},{name:"RSAPrivateKey.prime1",tagClass:ze.Class.UNIVERSAL,type:ze.Type.INTEGER,constructed:!1,capture:"privateKeyPrime1"},{name:"RSAPrivateKey.prime2",tagClass:ze.Class.UNIVERSAL,type:ze.Type.INTEGER,constructed:!1,capture:"privateKeyPrime2"},{name:"RSAPrivateKey.exponent1",tagClass:ze.Class.UNIVERSAL,type:ze.Type.INTEGER,constructed:!1,capture:"privateKeyExponent1"},{name:"RSAPrivateKey.exponent2",tagClass:ze.Class.UNIVERSAL,type:ze.Type.INTEGER,constructed:!1,capture:"privateKeyExponent2"},{name:"RSAPrivateKey.coefficient",tagClass:ze.Class.UNIVERSAL,type:ze.Type.INTEGER,constructed:!1,capture:"privateKeyCoefficient"}]},mdr={name:"RSAPublicKey",tagClass:ze.Class.UNIVERSAL,type:ze.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPublicKey.modulus",tagClass:ze.Class.UNIVERSAL,type:ze.Type.INTEGER,constructed:!1,capture:"publicKeyModulus"},{name:"RSAPublicKey.exponent",tagClass:ze.Class.UNIVERSAL,type:ze.Type.INTEGER,constructed:!1,capture:"publicKeyExponent"}]},hdr=An.pki.rsa.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:ze.Class.UNIVERSAL,type:ze.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:ze.Class.UNIVERSAL,type:ze.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:ze.Class.UNIVERSAL,type:ze.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{name:"SubjectPublicKeyInfo.subjectPublicKey",tagClass:ze.Class.UNIVERSAL,type:ze.Type.BITSTRING,constructed:!1,value:[{name:"SubjectPublicKeyInfo.subjectPublicKey.RSAPublicKey",tagClass:ze.Class.UNIVERSAL,type:ze.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"rsaPublicKey"}]}]},gdr={name:"DigestInfo",tagClass:ze.Class.UNIVERSAL,type:ze.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm",tagClass:ze.Class.UNIVERSAL,type:ze.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm.algorithmIdentifier",tagClass:ze.Class.UNIVERSAL,type:ze.Type.OID,constructed:!1,capture:"algorithmIdentifier"},{name:"DigestInfo.DigestAlgorithm.parameters",tagClass:ze.Class.UNIVERSAL,type:ze.Type.NULL,capture:"parameters",optional:!0,constructed:!1}]},{name:"DigestInfo.digest",tagClass:ze.Class.UNIVERSAL,type:ze.Type.OCTETSTRING,constructed:!1,capture:"digest"}]},Adr=s(function(t){var e;if(t.algorithm in Ai.oids)e=Ai.oids[t.algorithm];else{var r=new Error("Unknown message digest algorithm.");throw r.algorithm=t.algorithm,r}var n=ze.oidToDer(e).getBytes(),i=ze.create(ze.Class.UNIVERSAL,ze.Type.SEQUENCE,!0,[]),o=ze.create(ze.Class.UNIVERSAL,ze.Type.SEQUENCE,!0,[]);o.value.push(ze.create(ze.Class.UNIVERSAL,ze.Type.OID,!1,n)),o.value.push(ze.create(ze.Class.UNIVERSAL,ze.Type.NULL,!1,""));var a=ze.create(ze.Class.UNIVERSAL,ze.Type.OCTETSTRING,!1,t.digest().getBytes());return i.value.push(o),i.value.push(a),ze.toDer(i).getBytes()},"emsaPkcs1v15encode"),wct=s(function(t,e,r){if(r)return t.modPow(e.e,e.n);if(!e.p||!e.q)return t.modPow(e.d,e.n);e.dP||(e.dP=e.d.mod(e.p.subtract(Do.ONE))),e.dQ||(e.dQ=e.d.mod(e.q.subtract(Do.ONE))),e.qInv||(e.qInv=e.q.modInverse(e.p));var n;do n=new Do(An.util.bytesToHex(An.random.getBytes(e.n.bitLength()/8)),16);while(n.compareTo(e.n)>=0||!n.gcd(e.n).equals(Do.ONE));t=t.multiply(n.modPow(e.e,e.n)).mod(e.n);for(var i=t.mod(e.p).modPow(e.dP,e.p),o=t.mod(e.q).modPow(e.dQ,e.q);i.compareTo(o)<0;)i=i.add(e.p);var a=i.subtract(o).multiply(e.qInv).mod(e.p).multiply(e.q).add(o);return a=a.multiply(n.modInverse(e.n)).mod(e.n),a},"_modPow");Ai.rsa.encrypt=function(t,e,r){var n=r,i,o=Math.ceil(e.n.bitLength()/8);r!==!1&&r!==!0?(n=r===2,i=Sct(t,e,r)):(i=An.util.createBuffer(),i.putBytes(t));for(var a=new Do(i.toHex(),16),c=wct(a,e,n),l=c.toString(16),u=An.util.createBuffer(),f=o-Math.ceil(l.length/2);f>0;)u.putByte(0),--f;return u.putBytes(An.util.hexToBytes(l)),u.getBytes()};Ai.rsa.decrypt=function(t,e,r,n){var i=Math.ceil(e.n.bitLength()/8);if(t.length!==i){var o=new Error("Encrypted message length is invalid.");throw o.length=t.length,o.expected=i,o}var a=new Do(An.util.createBuffer(t).toHex(),16);if(a.compareTo(e.n)>=0)throw new Error("Encrypted message is invalid.");for(var c=wct(a,e,r),l=c.toString(16),u=An.util.createBuffer(),f=i-Math.ceil(l.length/2);f>0;)u.putByte(0),--f;return u.putBytes(An.util.hexToBytes(l)),n!==!1?Hre(u.getBytes(),e,r):u.getBytes()};Ai.rsa.createKeyPairGenerationState=function(t,e,r){typeof t=="string"&&(t=parseInt(t,10)),t=t||2048,r=r||{};var n=r.prng||An.random,i={nextBytes:s(function(c){for(var l=n.getBytesSync(c.length),u=0;u<c.length;++u)c[u]=l.charCodeAt(u)},"nextBytes")},o=r.algorithm||"PRIMEINC",a;if(o==="PRIMEINC")a={algorithm:o,state:0,bits:t,rng:i,eInt:e||65537,e:new Do(null),p:null,q:null,qBits:t>>1,pBits:t-(t>>1),pqState:0,num:null,keys:null},a.e.fromInt(a.eInt);else throw new Error("Invalid key generation algorithm: "+o);return a};Ai.rsa.stepKeyPairGenerationState=function(t,e){"algorithm"in t||(t.algorithm="PRIMEINC");var r=new Do(null);r.fromInt(30);for(var n=0,i=s(function(p,m){return p|m},"op_or"),o=+new Date,a,c=0;t.keys===null&&(e<=0||c<e);){if(t.state===0){var l=t.p===null?t.pBits:t.qBits,u=l-1;t.pqState===0?(t.num=new Do(l,t.rng),t.num.testBit(u)||t.num.bitwiseTo(Do.ONE.shiftLeft(u),i,t.num),t.num.dAddOffset(31-t.num.mod(r).byteValue(),0),n=0,++t.pqState):t.pqState===1?t.num.bitLength()>l?t.pqState=0:t.num.isProbablePrime(Cdr(t.num.bitLength()))?++t.pqState:t.num.dAddOffset(ddr[n++%8],0):t.pqState===2?t.pqState=t.num.subtract(Do.ONE).gcd(t.e).compareTo(Do.ONE)===0?3:0:t.pqState===3&&(t.pqState=0,t.p===null?t.p=t.num:t.q=t.num,t.p!==null&&t.q!==null&&++t.state,t.num=null)}else if(t.state===1)t.p.compareTo(t.q)<0&&(t.num=t.p,t.p=t.q,t.q=t.num),++t.state;else if(t.state===2)t.p1=t.p.subtract(Do.ONE),t.q1=t.q.subtract(Do.ONE),t.phi=t.p1.multiply(t.q1),++t.state;else if(t.state===3)t.phi.gcd(t.e).compareTo(Do.ONE)===0?++t.state:(t.p=null,t.q=null,t.state=0);else if(t.state===4)t.n=t.p.multiply(t.q),t.n.bitLength()===t.bits?++t.state:(t.q=null,t.state=0);else if(t.state===5){var f=t.e.modInverse(t.phi);t.keys={privateKey:Ai.rsa.setPrivateKey(t.n,t.e,f,t.p,t.q,f.mod(t.p1),f.mod(t.q1),t.q.modInverse(t.p)),publicKey:Ai.rsa.setPublicKey(t.n,t.e)}}a=+new Date,c+=a-o,o=a}return t.keys!==null};Ai.rsa.generateKeyPair=function(t,e,r,n){if(arguments.length===1?typeof t=="object"?(r=t,t=void 0):typeof t=="function"&&(n=t,t=void 0):arguments.length===2?typeof t=="number"?typeof e=="function"?(n=e,e=void 0):typeof e!="number"&&(r=e,e=void 0):(r=t,n=e,t=void 0,e=void 0):arguments.length===3&&(typeof e=="number"?typeof r=="function"&&(n=r,r=void 0):(n=r,r=e,e=void 0)),r=r||{},t===void 0&&(t=r.bits||2048),e===void 0&&(e=r.e||65537),!An.options.usePureJavaScript&&!r.prng&&t>=256&&t<=16384&&(e===65537||e===3)){if(n){if(Ect("generateKeyPair"))return uwe.generateKeyPair("rsa",{modulusLength:t,publicExponent:e,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}},function(c,l,u){if(c)return n(c);n(null,{privateKey:Ai.privateKeyFromPem(u),publicKey:Ai.publicKeyFromPem(l)})});if(bct("generateKey")&&bct("exportKey"))return zh.globalScope.crypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:t,publicExponent:Tct(e),hash:{name:"SHA-256"}},!0,["sign","verify"]).then(function(c){return zh.globalScope.crypto.subtle.exportKey("pkcs8",c.privateKey)}).then(void 0,function(c){n(c)}).then(function(c){if(c){var l=Ai.privateKeyFromAsn1(ze.fromDer(An.util.createBuffer(c)));n(null,{privateKey:l,publicKey:Ai.setRsaPublicKey(l.n,l.e)})}});if(Ict("generateKey")&&Ict("exportKey")){var i=zh.globalScope.msCrypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:t,publicExponent:Tct(e),hash:{name:"SHA-256"}},!0,["sign","verify"]);i.oncomplete=function(c){var l=c.target.result,u=zh.globalScope.msCrypto.subtle.exportKey("pkcs8",l.privateKey);u.oncomplete=function(f){var p=f.target.result,m=Ai.privateKeyFromAsn1(ze.fromDer(An.util.createBuffer(p)));n(null,{privateKey:m,publicKey:Ai.setRsaPublicKey(m.n,m.e)})},u.onerror=function(f){n(f)}},i.onerror=function(c){n(c)};return}}else if(Ect("generateKeyPairSync")){var o=uwe.generateKeyPairSync("rsa",{modulusLength:t,publicExponent:e,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}});return{privateKey:Ai.privateKeyFromPem(o.privateKey),publicKey:Ai.publicKeyFromPem(o.publicKey)}}}var a=Ai.rsa.createKeyPairGenerationState(t,e,r);if(!n)return Ai.rsa.stepKeyPairGenerationState(a,0),a.keys;ydr(a,r,n)};Ai.setRsaPublicKey=Ai.rsa.setPublicKey=function(t,e){var r={n:t,e};return r.encrypt=function(n,i,o){if(typeof i=="string"?i=i.toUpperCase():i===void 0&&(i="RSAES-PKCS1-V1_5"),i==="RSAES-PKCS1-V1_5")i={encode:s(function(c,l,u){return Sct(c,l,2).getBytes()},"encode")};else if(i==="RSA-OAEP"||i==="RSAES-OAEP")i={encode:s(function(c,l){return An.pkcs1.encode_rsa_oaep(l,c,o)},"encode")};else if(["RAW","NONE","NULL",null].indexOf(i)!==-1)i={encode:s(function(c){return c},"encode")};else if(typeof i=="string")throw new Error('Unsupported encryption scheme: "'+i+'".');var a=i.encode(n,r,!0);return Ai.rsa.encrypt(a,r,!0)},r.verify=function(n,i,o,a){typeof o=="string"?o=o.toUpperCase():o===void 0&&(o="RSASSA-PKCS1-V1_5"),a===void 0&&(a={_parseAllDigestBytes:!0}),"_parseAllDigestBytes"in a||(a._parseAllDigestBytes=!0),o==="RSASSA-PKCS1-V1_5"?o={verify:s(function(l,u){u=Hre(u,r,!0);var f=ze.fromDer(u,{parseAllBytes:a._parseAllDigestBytes}),p={},m=[];if(!ze.validate(f,gdr,p,m)){var h=new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value.");throw h.errors=m,h}var g=ze.derToOid(p.algorithmIdentifier);if(!(g===An.oids.md2||g===An.oids.md5||g===An.oids.sha1||g===An.oids.sha224||g===An.oids.sha256||g===An.oids.sha384||g===An.oids.sha512||g===An.oids["sha512-224"]||g===An.oids["sha512-256"])){var h=new Error("Unknown RSASSA-PKCS1-v1_5 DigestAlgorithm identifier.");throw h.oid=g,h}if((g===An.oids.md2||g===An.oids.md5)&&!("parameters"in p))throw new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value. Missing algorithm identifer NULL parameters.");return l===p.digest},"verify")}:(o==="NONE"||o==="NULL"||o===null)&&(o={verify:s(function(l,u){return u=Hre(u,r,!0),l===u},"verify")});var c=Ai.rsa.decrypt(i,r,!0,!1);return o.verify(n,c,r.n.bitLength())},r};Ai.setRsaPrivateKey=Ai.rsa.setPrivateKey=function(t,e,r,n,i,o,a,c){var l={n:t,e,d:r,p:n,q:i,dP:o,dQ:a,qInv:c};return l.decrypt=function(u,f,p){typeof f=="string"?f=f.toUpperCase():f===void 0&&(f="RSAES-PKCS1-V1_5");var m=Ai.rsa.decrypt(u,l,!1,!1);if(f==="RSAES-PKCS1-V1_5")f={decode:Hre};else if(f==="RSA-OAEP"||f==="RSAES-OAEP")f={decode:s(function(h,g){return An.pkcs1.decode_rsa_oaep(g,h,p)},"decode")};else if(["RAW","NONE","NULL",null].indexOf(f)!==-1)f={decode:s(function(h){return h},"decode")};else throw new Error('Unsupported encryption scheme: "'+f+'".');return f.decode(m,l,!1)},l.sign=function(u,f){var p=!1;typeof f=="string"&&(f=f.toUpperCase()),f===void 0||f==="RSASSA-PKCS1-V1_5"?(f={encode:Adr},p=1):(f==="NONE"||f==="NULL"||f===null)&&(f={encode:s(function(){return u},"encode")},p=1);var m=f.encode(u,l.n.bitLength());return Ai.rsa.encrypt(m,l,p)},l};Ai.wrapRsaPrivateKey=function(t){return ze.create(ze.Class.UNIVERSAL,ze.Type.SEQUENCE,!0,[ze.create(ze.Class.UNIVERSAL,ze.Type.INTEGER,!1,ze.integerToDer(0).getBytes()),ze.create(ze.Class.UNIVERSAL,ze.Type.SEQUENCE,!0,[ze.create(ze.Class.UNIVERSAL,ze.Type.OID,!1,ze.oidToDer(Ai.oids.rsaEncryption).getBytes()),ze.create(ze.Class.UNIVERSAL,ze.Type.NULL,!1,"")]),ze.create(ze.Class.UNIVERSAL,ze.Type.OCTETSTRING,!1,ze.toDer(t).getBytes())])};Ai.privateKeyFromAsn1=function(t){var e={},r=[];if(ze.validate(t,fdr,e,r)&&(t=ze.fromDer(An.util.createBuffer(e.privateKey))),e={},r=[],!ze.validate(t,pdr,e,r)){var n=new Error("Cannot read private key. ASN.1 object does not contain an RSAPrivateKey.");throw n.errors=r,n}var i,o,a,c,l,u,f,p;return i=An.util.createBuffer(e.privateKeyModulus).toHex(),o=An.util.createBuffer(e.privateKeyPublicExponent).toHex(),a=An.util.createBuffer(e.privateKeyPrivateExponent).toHex(),c=An.util.createBuffer(e.privateKeyPrime1).toHex(),l=An.util.createBuffer(e.privateKeyPrime2).toHex(),u=An.util.createBuffer(e.privateKeyExponent1).toHex(),f=An.util.createBuffer(e.privateKeyExponent2).toHex(),p=An.util.createBuffer(e.privateKeyCoefficient).toHex(),Ai.setRsaPrivateKey(new Do(i,16),new Do(o,16),new Do(a,16),new Do(c,16),new Do(l,16),new Do(u,16),new Do(f,16),new Do(p,16))};Ai.privateKeyToAsn1=Ai.privateKeyToRSAPrivateKey=function(t){return ze.create(ze.Class.UNIVERSAL,ze.Type.SEQUENCE,!0,[ze.create(ze.Class.UNIVERSAL,ze.Type.INTEGER,!1,ze.integerToDer(0).getBytes()),ze.create(ze.Class.UNIVERSAL,ze.Type.INTEGER,!1,g1(t.n)),ze.create(ze.Class.UNIVERSAL,ze.Type.INTEGER,!1,g1(t.e)),ze.create(ze.Class.UNIVERSAL,ze.Type.INTEGER,!1,g1(t.d)),ze.create(ze.Class.UNIVERSAL,ze.Type.INTEGER,!1,g1(t.p)),ze.create(ze.Class.UNIVERSAL,ze.Type.INTEGER,!1,g1(t.q)),ze.create(ze.Class.UNIVERSAL,ze.Type.INTEGER,!1,g1(t.dP)),ze.create(ze.Class.UNIVERSAL,ze.Type.INTEGER,!1,g1(t.dQ)),ze.create(ze.Class.UNIVERSAL,ze.Type.INTEGER,!1,g1(t.qInv))])};Ai.publicKeyFromAsn1=function(t){var e={},r=[];if(ze.validate(t,hdr,e,r)){var n=ze.derToOid(e.publicKeyOid);if(n!==Ai.oids.rsaEncryption){var i=new Error("Cannot read public key. Unknown OID.");throw i.oid=n,i}t=e.rsaPublicKey}if(r=[],!ze.validate(t,mdr,e,r)){var i=new Error("Cannot read public key. ASN.1 object does not contain an RSAPublicKey.");throw i.errors=r,i}var o=An.util.createBuffer(e.publicKeyModulus).toHex(),a=An.util.createBuffer(e.publicKeyExponent).toHex();return Ai.setRsaPublicKey(new Do(o,16),new Do(a,16))};Ai.publicKeyToAsn1=Ai.publicKeyToSubjectPublicKeyInfo=function(t){return ze.create(ze.Class.UNIVERSAL,ze.Type.SEQUENCE,!0,[ze.create(ze.Class.UNIVERSAL,ze.Type.SEQUENCE,!0,[ze.create(ze.Class.UNIVERSAL,ze.Type.OID,!1,ze.oidToDer(Ai.oids.rsaEncryption).getBytes()),ze.create(ze.Class.UNIVERSAL,ze.Type.NULL,!1,"")]),ze.create(ze.Class.UNIVERSAL,ze.Type.BITSTRING,!1,[Ai.publicKeyToRSAPublicKey(t)])])};Ai.publicKeyToRSAPublicKey=function(t){return ze.create(ze.Class.UNIVERSAL,ze.Type.SEQUENCE,!0,[ze.create(ze.Class.UNIVERSAL,ze.Type.INTEGER,!1,g1(t.n)),ze.create(ze.Class.UNIVERSAL,ze.Type.INTEGER,!1,g1(t.e))])};function Sct(t,e,r){var n=An.util.createBuffer(),i=Math.ceil(e.n.bitLength()/8);if(t.length>i-11){var o=new Error("Message is too long for PKCS#1 v1.5 padding.");throw o.length=t.length,o.max=i-11,o}n.putByte(0),n.putByte(r);var a=i-3-t.length,c;if(r===0||r===1){c=r===0?0:255;for(var l=0;l<a;++l)n.putByte(c)}else for(;a>0;){for(var u=0,f=An.random.getBytes(a),l=0;l<a;++l)c=f.charCodeAt(l),c===0?++u:n.putByte(c);a=u}return n.putByte(0),n.putBytes(t),n}s(Sct,"_encodePkcs1_v1_5");function Hre(t,e,r,n){var i=Math.ceil(e.n.bitLength()/8),o=An.util.createBuffer(t),a=o.getByte(),c=o.getByte();if(a!==0||r&&c!==0&&c!==1||!r&&c!=2||r&&c===0&&typeof n>"u")throw new Error("Encryption block is invalid.");var l=0;if(c===0){l=i-3-n;for(var u=0;u<l;++u)if(o.getByte()!==0)throw new Error("Encryption block is invalid.")}else if(c===1)for(l=0;o.length()>1;){if(o.getByte()!==255){--o.read;break}++l}else if(c===2)for(l=0;o.length()>1;){if(o.getByte()===0){--o.read;break}++l}var f=o.getByte();if(f!==0||l!==i-3-o.length())throw new Error("Encryption block is invalid.");return o.getBytes()}s(Hre,"_decodePkcs1_v1_5");function ydr(t,e,r){typeof e=="function"&&(r=e,e={}),e=e||{};var n={algorithm:{name:e.algorithm||"PRIMEINC",options:{workers:e.workers||2,workLoad:e.workLoad||100,workerScript:e.workerScript}}};"prng"in e&&(n.prng=e.prng),i();function i(){o(t.pBits,function(c,l){if(c)return r(c);if(t.p=l,t.q!==null)return a(c,t.q);o(t.qBits,a)})}s(i,"generate");function o(c,l){An.prime.generateProbablePrime(c,n,l)}s(o,"getPrime");function a(c,l){if(c)return r(c);if(t.q=l,t.p.compareTo(t.q)<0){var u=t.p;t.p=t.q,t.q=u}if(t.p.subtract(Do.ONE).gcd(t.e).compareTo(Do.ONE)!==0){t.p=null,i();return}if(t.q.subtract(Do.ONE).gcd(t.e).compareTo(Do.ONE)!==0){t.q=null,o(t.qBits,a);return}if(t.p1=t.p.subtract(Do.ONE),t.q1=t.q.subtract(Do.ONE),t.phi=t.p1.multiply(t.q1),t.phi.gcd(t.e).compareTo(Do.ONE)!==0){t.p=t.q=null,i();return}if(t.n=t.p.multiply(t.q),t.n.bitLength()!==t.bits){t.q=null,o(t.qBits,a);return}var f=t.e.modInverse(t.phi);t.keys={privateKey:Ai.rsa.setPrivateKey(t.n,t.e,f,t.p,t.q,f.mod(t.p1),f.mod(t.q1),t.q.modInverse(t.p)),publicKey:Ai.rsa.setPublicKey(t.n,t.e)},r(null,t.keys)}s(a,"finish")}s(ydr,"_generateKeyPair");function g1(t){var e=t.toString(16);e[0]>="8"&&(e="00"+e);var r=An.util.hexToBytes(e);return r.length>1&&(r.charCodeAt(0)===0&&(r.charCodeAt(1)&128)===0||r.charCodeAt(0)===255&&(r.charCodeAt(1)&128)===128)?r.substr(1):r}s(g1,"_bnToBytes");function Cdr(t){return t<=100?27:t<=150?18:t<=200?15:t<=250?12:t<=300?9:t<=350?8:t<=400?7:t<=500?6:t<=600?5:t<=800?4:t<=1250?3:2}s(Cdr,"_getMillerRabinTests");function Ect(t){return An.util.isNodejs&&typeof uwe[t]=="function"}s(Ect,"_detectNodeCrypto");function bct(t){return typeof zh.globalScope<"u"&&typeof zh.globalScope.crypto=="object"&&typeof zh.globalScope.crypto.subtle=="object"&&typeof zh.globalScope.crypto.subtle[t]=="function"}s(bct,"_detectSubtleCrypto");function Ict(t){return typeof zh.globalScope<"u"&&typeof zh.globalScope.msCrypto=="object"&&typeof zh.globalScope.msCrypto.subtle=="object"&&typeof zh.globalScope.msCrypto.subtle[t]=="function"}s(Ict,"_detectSubtleMsCrypto");function Tct(t){for(var e=An.util.hexToBytes(t.toString(16)),r=new Uint8Array(e.length),n=0;n<e.length;++n)r[n]=e.charCodeAt(n);return r}s(Tct,"_intToUint8Array")});var dwe=H((PAi,Bct)=>{d();var Ir=Ri();Cw();YA();GQ();l1();vw();Fre();Ik();Gh();rwe();KQ();Ho();typeof Rct>"u"&&(Rct=Ir.jsbn.BigInteger);var Rct,ht=Ir.asn1,Ii=Ir.pki=Ir.pki||{};Bct.exports=Ii.pbe=Ir.pbe=Ir.pbe||{};var Sk=Ii.oids,vdr={name:"EncryptedPrivateKeyInfo",tagClass:ht.Class.UNIVERSAL,type:ht.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedPrivateKeyInfo.encryptionAlgorithm",tagClass:ht.Class.UNIVERSAL,type:ht.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:ht.Class.UNIVERSAL,type:ht.Type.OID,constructed:!1,capture:"encryptionOid"},{name:"AlgorithmIdentifier.parameters",tagClass:ht.Class.UNIVERSAL,type:ht.Type.SEQUENCE,constructed:!0,captureAsn1:"encryptionParams"}]},{name:"EncryptedPrivateKeyInfo.encryptedData",tagClass:ht.Class.UNIVERSAL,type:ht.Type.OCTETSTRING,constructed:!1,capture:"encryptedData"}]},xdr={name:"PBES2Algorithms",tagClass:ht.Class.UNIVERSAL,type:ht.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc",tagClass:ht.Class.UNIVERSAL,type:ht.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc.oid",tagClass:ht.Class.UNIVERSAL,type:ht.Type.OID,constructed:!1,capture:"kdfOid"},{name:"PBES2Algorithms.params",tagClass:ht.Class.UNIVERSAL,type:ht.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.params.salt",tagClass:ht.Class.UNIVERSAL,type:ht.Type.OCTETSTRING,constructed:!1,capture:"kdfSalt"},{name:"PBES2Algorithms.params.iterationCount",tagClass:ht.Class.UNIVERSAL,type:ht.Type.INTEGER,constructed:!1,capture:"kdfIterationCount"},{name:"PBES2Algorithms.params.keyLength",tagClass:ht.Class.UNIVERSAL,type:ht.Type.INTEGER,constructed:!1,optional:!0,capture:"keyLength"},{name:"PBES2Algorithms.params.prf",tagClass:ht.Class.UNIVERSAL,type:ht.Type.SEQUENCE,constructed:!0,optional:!0,value:[{name:"PBES2Algorithms.params.prf.algorithm",tagClass:ht.Class.UNIVERSAL,type:ht.Type.OID,constructed:!1,capture:"prfOid"}]}]}]},{name:"PBES2Algorithms.encryptionScheme",tagClass:ht.Class.UNIVERSAL,type:ht.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.encryptionScheme.oid",tagClass:ht.Class.UNIVERSAL,type:ht.Type.OID,constructed:!1,capture:"encOid"},{name:"PBES2Algorithms.encryptionScheme.iv",tagClass:ht.Class.UNIVERSAL,type:ht.Type.OCTETSTRING,constructed:!1,capture:"encIv"}]}]},Edr={name:"pkcs-12PbeParams",tagClass:ht.Class.UNIVERSAL,type:ht.Type.SEQUENCE,constructed:!0,value:[{name:"pkcs-12PbeParams.salt",tagClass:ht.Class.UNIVERSAL,type:ht.Type.OCTETSTRING,constructed:!1,capture:"salt"},{name:"pkcs-12PbeParams.iterations",tagClass:ht.Class.UNIVERSAL,type:ht.Type.INTEGER,constructed:!1,capture:"iterations"}]};Ii.encryptPrivateKeyInfo=function(t,e,r){r=r||{},r.saltSize=r.saltSize||8,r.count=r.count||2048,r.algorithm=r.algorithm||"aes128",r.prfAlgorithm=r.prfAlgorithm||"sha1";var n=Ir.random.getBytesSync(r.saltSize),i=r.count,o=ht.integerToDer(i),a,c,l;if(r.algorithm.indexOf("aes")===0||r.algorithm==="des"){var u,f,p;switch(r.algorithm){case"aes128":a=16,u=16,f=Sk["aes128-CBC"],p=Ir.aes.createEncryptionCipher;break;case"aes192":a=24,u=16,f=Sk["aes192-CBC"],p=Ir.aes.createEncryptionCipher;break;case"aes256":a=32,u=16,f=Sk["aes256-CBC"],p=Ir.aes.createEncryptionCipher;break;case"des":a=8,u=8,f=Sk.desCBC,p=Ir.des.createEncryptionCipher;break;default:var m=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw m.algorithm=r.algorithm,m}var h="hmacWith"+r.prfAlgorithm.toUpperCase(),g=Dct(h),A=Ir.pkcs5.pbkdf2(e,n,i,a,g),y=Ir.random.getBytesSync(u),E=p(A);E.start(y),E.update(ht.toDer(t)),E.finish(),l=E.output.getBytes();var b=bdr(n,o,a,h);c=ht.create(ht.Class.UNIVERSAL,ht.Type.SEQUENCE,!0,[ht.create(ht.Class.UNIVERSAL,ht.Type.OID,!1,ht.oidToDer(Sk.pkcs5PBES2).getBytes()),ht.create(ht.Class.UNIVERSAL,ht.Type.SEQUENCE,!0,[ht.create(ht.Class.UNIVERSAL,ht.Type.SEQUENCE,!0,[ht.create(ht.Class.UNIVERSAL,ht.Type.OID,!1,ht.oidToDer(Sk.pkcs5PBKDF2).getBytes()),b]),ht.create(ht.Class.UNIVERSAL,ht.Type.SEQUENCE,!0,[ht.create(ht.Class.UNIVERSAL,ht.Type.OID,!1,ht.oidToDer(f).getBytes()),ht.create(ht.Class.UNIVERSAL,ht.Type.OCTETSTRING,!1,y)])])])}else if(r.algorithm==="3des"){a=24;var S=new Ir.util.ByteBuffer(n),A=Ii.pbe.generatePkcs12Key(e,S,1,i,a),y=Ii.pbe.generatePkcs12Key(e,S,2,i,a),E=Ir.des.createEncryptionCipher(A);E.start(y),E.update(ht.toDer(t)),E.finish(),l=E.output.getBytes(),c=ht.create(ht.Class.UNIVERSAL,ht.Type.SEQUENCE,!0,[ht.create(ht.Class.UNIVERSAL,ht.Type.OID,!1,ht.oidToDer(Sk["pbeWithSHAAnd3-KeyTripleDES-CBC"]).getBytes()),ht.create(ht.Class.UNIVERSAL,ht.Type.SEQUENCE,!0,[ht.create(ht.Class.UNIVERSAL,ht.Type.OCTETSTRING,!1,n),ht.create(ht.Class.UNIVERSAL,ht.Type.INTEGER,!1,o.getBytes())])])}else{var m=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw m.algorithm=r.algorithm,m}var R=ht.create(ht.Class.UNIVERSAL,ht.Type.SEQUENCE,!0,[c,ht.create(ht.Class.UNIVERSAL,ht.Type.OCTETSTRING,!1,l)]);return R};Ii.decryptPrivateKeyInfo=function(t,e){var r=null,n={},i=[];if(!ht.validate(t,vdr,n,i)){var o=new Error("Cannot read encrypted private key. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw o.errors=i,o}var a=ht.derToOid(n.encryptionOid),c=Ii.pbe.getCipher(a,n.encryptionParams,e),l=Ir.util.createBuffer(n.encryptedData);return c.update(l),c.finish()&&(r=ht.fromDer(c.output)),r};Ii.encryptedPrivateKeyToPem=function(t,e){var r={type:"ENCRYPTED PRIVATE KEY",body:ht.toDer(t).getBytes()};return Ir.pem.encode(r,{maxline:e})};Ii.encryptedPrivateKeyFromPem=function(t){var e=Ir.pem.decode(t)[0];if(e.type!=="ENCRYPTED PRIVATE KEY"){var r=new Error('Could not convert encrypted private key from PEM; PEM header type is "ENCRYPTED PRIVATE KEY".');throw r.headerType=e.type,r}if(e.procType&&e.procType.type==="ENCRYPTED")throw new Error("Could not convert encrypted private key from PEM; PEM is encrypted.");return ht.fromDer(e.body)};Ii.encryptRsaPrivateKey=function(t,e,r){if(r=r||{},!r.legacy){var n=Ii.wrapRsaPrivateKey(Ii.privateKeyToAsn1(t));return n=Ii.encryptPrivateKeyInfo(n,e,r),Ii.encryptedPrivateKeyToPem(n)}var i,o,a,c;switch(r.algorithm){case"aes128":i="AES-128-CBC",a=16,o=Ir.random.getBytesSync(16),c=Ir.aes.createEncryptionCipher;break;case"aes192":i="AES-192-CBC",a=24,o=Ir.random.getBytesSync(16),c=Ir.aes.createEncryptionCipher;break;case"aes256":i="AES-256-CBC",a=32,o=Ir.random.getBytesSync(16),c=Ir.aes.createEncryptionCipher;break;case"3des":i="DES-EDE3-CBC",a=24,o=Ir.random.getBytesSync(8),c=Ir.des.createEncryptionCipher;break;case"des":i="DES-CBC",a=8,o=Ir.random.getBytesSync(8),c=Ir.des.createEncryptionCipher;break;default:var l=new Error('Could not encrypt RSA private key; unsupported encryption algorithm "'+r.algorithm+'".');throw l.algorithm=r.algorithm,l}var u=Ir.pbe.opensslDeriveBytes(e,o.substr(0,8),a),f=c(u);f.start(o),f.update(ht.toDer(Ii.privateKeyToAsn1(t))),f.finish();var p={type:"RSA PRIVATE KEY",procType:{version:"4",type:"ENCRYPTED"},dekInfo:{algorithm:i,parameters:Ir.util.bytesToHex(o).toUpperCase()},body:f.output.getBytes()};return Ir.pem.encode(p)};Ii.decryptRsaPrivateKey=function(t,e){var r=null,n=Ir.pem.decode(t)[0];if(n.type!=="ENCRYPTED PRIVATE KEY"&&n.type!=="PRIVATE KEY"&&n.type!=="RSA PRIVATE KEY"){var i=new Error('Could not convert private key from PEM; PEM header type is not "ENCRYPTED PRIVATE KEY", "PRIVATE KEY", or "RSA PRIVATE KEY".');throw i.headerType=i,i}if(n.procType&&n.procType.type==="ENCRYPTED"){var o,a;switch(n.dekInfo.algorithm){case"DES-CBC":o=8,a=Ir.des.createDecryptionCipher;break;case"DES-EDE3-CBC":o=24,a=Ir.des.createDecryptionCipher;break;case"AES-128-CBC":o=16,a=Ir.aes.createDecryptionCipher;break;case"AES-192-CBC":o=24,a=Ir.aes.createDecryptionCipher;break;case"AES-256-CBC":o=32,a=Ir.aes.createDecryptionCipher;break;case"RC2-40-CBC":o=5,a=s(function(p){return Ir.rc2.createDecryptionCipher(p,40)},"cipherFn");break;case"RC2-64-CBC":o=8,a=s(function(p){return Ir.rc2.createDecryptionCipher(p,64)},"cipherFn");break;case"RC2-128-CBC":o=16,a=s(function(p){return Ir.rc2.createDecryptionCipher(p,128)},"cipherFn");break;default:var i=new Error('Could not decrypt private key; unsupported encryption algorithm "'+n.dekInfo.algorithm+'".');throw i.algorithm=n.dekInfo.algorithm,i}var c=Ir.util.hexToBytes(n.dekInfo.parameters),l=Ir.pbe.opensslDeriveBytes(e,c.substr(0,8),o),u=a(l);if(u.start(c),u.update(Ir.util.createBuffer(n.body)),u.finish())r=u.output.getBytes();else return r}else r=n.body;return n.type==="ENCRYPTED PRIVATE KEY"?r=Ii.decryptPrivateKeyInfo(ht.fromDer(r),e):r=ht.fromDer(r),r!==null&&(r=Ii.privateKeyFromAsn1(r)),r};Ii.pbe.generatePkcs12Key=function(t,e,r,n,i,o){var a,c;if(typeof o>"u"||o===null){if(!("sha1"in Ir.md))throw new Error('"sha1" hash algorithm unavailable.');o=Ir.md.sha1.create()}var l=o.digestLength,u=o.blockLength,f=new Ir.util.ByteBuffer,p=new Ir.util.ByteBuffer;if(t!=null){for(c=0;c<t.length;c++)p.putInt16(t.charCodeAt(c));p.putInt16(0)}var m=p.length(),h=e.length(),g=new Ir.util.ByteBuffer;g.fillWithByte(r,u);var A=u*Math.ceil(h/u),y=new Ir.util.ByteBuffer;for(c=0;c<A;c++)y.putByte(e.at(c%h));var E=u*Math.ceil(m/u),b=new Ir.util.ByteBuffer;for(c=0;c<E;c++)b.putByte(p.at(c%m));var S=y;S.putBuffer(b);for(var R=Math.ceil(i/l),B=1;B<=R;B++){var L=new Ir.util.ByteBuffer;L.putBytes(g.bytes()),L.putBytes(S.bytes());for(var O=0;O<n;O++)o.start(),o.update(L.getBytes()),L=o.digest();var Y=new Ir.util.ByteBuffer;for(c=0;c<u;c++)Y.putByte(L.at(c%l));var V=Math.ceil(h/u)+Math.ceil(m/u),z=new Ir.util.ByteBuffer;for(a=0;a<V;a++){var Q=new Ir.util.ByteBuffer(S.getBytes(u)),U=511;for(c=Y.length()-1;c>=0;c--)U=U>>8,U+=Y.at(c)+Q.at(c),Q.setAt(c,U&255);z.putBuffer(Q)}S=z,f.putBuffer(L)}return f.truncate(f.length()-i),f};Ii.pbe.getCipher=function(t,e,r){switch(t){case Ii.oids.pkcs5PBES2:return Ii.pbe.getCipherForPBES2(t,e,r);case Ii.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:case Ii.oids["pbewithSHAAnd40BitRC2-CBC"]:return Ii.pbe.getCipherForPKCS12PBE(t,e,r);default:var n=new Error("Cannot read encrypted PBE data block. Unsupported OID.");throw n.oid=t,n.supportedOids=["pkcs5PBES2","pbeWithSHAAnd3-KeyTripleDES-CBC","pbewithSHAAnd40BitRC2-CBC"],n}};Ii.pbe.getCipherForPBES2=function(t,e,r){var n={},i=[];if(!ht.validate(e,xdr,n,i)){var o=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw o.errors=i,o}if(t=ht.derToOid(n.kdfOid),t!==Ii.oids.pkcs5PBKDF2){var o=new Error("Cannot read encrypted private key. Unsupported key derivation function OID.");throw o.oid=t,o.supportedOids=["pkcs5PBKDF2"],o}if(t=ht.derToOid(n.encOid),t!==Ii.oids["aes128-CBC"]&&t!==Ii.oids["aes192-CBC"]&&t!==Ii.oids["aes256-CBC"]&&t!==Ii.oids["des-EDE3-CBC"]&&t!==Ii.oids.desCBC){var o=new Error("Cannot read encrypted private key. Unsupported encryption scheme OID.");throw o.oid=t,o.supportedOids=["aes128-CBC","aes192-CBC","aes256-CBC","des-EDE3-CBC","desCBC"],o}var a=n.kdfSalt,c=Ir.util.createBuffer(n.kdfIterationCount);c=c.getInt(c.length()<<3);var l,u;switch(Ii.oids[t]){case"aes128-CBC":l=16,u=Ir.aes.createDecryptionCipher;break;case"aes192-CBC":l=24,u=Ir.aes.createDecryptionCipher;break;case"aes256-CBC":l=32,u=Ir.aes.createDecryptionCipher;break;case"des-EDE3-CBC":l=24,u=Ir.des.createDecryptionCipher;break;case"desCBC":l=8,u=Ir.des.createDecryptionCipher;break}var f=Pct(n.prfOid),p=Ir.pkcs5.pbkdf2(r,a,c,l,f),m=n.encIv,h=u(p);return h.start(m),h};Ii.pbe.getCipherForPKCS12PBE=function(t,e,r){var n={},i=[];if(!ht.validate(e,Edr,n,i)){var o=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw o.errors=i,o}var a=Ir.util.createBuffer(n.salt),c=Ir.util.createBuffer(n.iterations);c=c.getInt(c.length()<<3);var l,u,f;switch(t){case Ii.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:l=24,u=8,f=Ir.des.startDecrypting;break;case Ii.oids["pbewithSHAAnd40BitRC2-CBC"]:l=5,u=8,f=s(function(A,y){var E=Ir.rc2.createDecryptionCipher(A,40);return E.start(y,null),E},"cipherFn");break;default:var o=new Error("Cannot read PKCS #12 PBE data block. Unsupported OID.");throw o.oid=t,o}var p=Pct(n.prfOid),m=Ii.pbe.generatePkcs12Key(r,a,1,c,l,p);p.start();var h=Ii.pbe.generatePkcs12Key(r,a,2,c,u,p);return f(m,h)};Ii.pbe.opensslDeriveBytes=function(t,e,r,n){if(typeof n>"u"||n===null){if(!("md5"in Ir.md))throw new Error('"md5" hash algorithm unavailable.');n=Ir.md.md5.create()}e===null&&(e="");for(var i=[kct(n,t+e)],o=16,a=1;o<r;++a,o+=16)i.push(kct(n,i[a-1]+t+e));return i.join("").substr(0,r)};function kct(t,e){return t.start().update(e).digest().getBytes()}s(kct,"hash");function Pct(t){var e;if(!t)e="hmacWithSHA1";else if(e=Ii.oids[ht.derToOid(t)],!e){var r=new Error("Unsupported PRF OID.");throw r.oid=t,r.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],r}return Dct(e)}s(Pct,"prfOidToMessageDigest");function Dct(t){var e=Ir.md;switch(t){case"hmacWithSHA224":e=Ir.md.sha512;case"hmacWithSHA1":case"hmacWithSHA256":case"hmacWithSHA384":case"hmacWithSHA512":t=t.substr(8).toLowerCase();break;default:var r=new Error("Unsupported PRF algorithm.");throw r.algorithm=t,r.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],r}if(!e||!(t in e))throw new Error("Unknown hash algorithm: "+t);return e[t].create()}s(Dct,"prfAlgorithmToMessageDigest");function bdr(t,e,r,n){var i=ht.create(ht.Class.UNIVERSAL,ht.Type.SEQUENCE,!0,[ht.create(ht.Class.UNIVERSAL,ht.Type.OCTETSTRING,!1,t),ht.create(ht.Class.UNIVERSAL,ht.Type.INTEGER,!1,e.getBytes())]);return n!=="hmacWithSHA1"&&i.value.push(ht.create(ht.Class.UNIVERSAL,ht.Type.INTEGER,!1,Ir.util.hexToBytes(r.toString(16))),ht.create(ht.Class.UNIVERSAL,ht.Type.SEQUENCE,!0,[ht.create(ht.Class.UNIVERSAL,ht.Type.OID,!1,ht.oidToDer(Ii.oids[n]).getBytes()),ht.create(ht.Class.UNIVERSAL,ht.Type.NULL,!1,"")])),i}s(bdr,"createPbkdf2Params")});var fwe=H((NAi,Lct)=>{d();var zN=Ri();YA();Ho();var Cr=zN.asn1,KN=Lct.exports=zN.pkcs7asn1=zN.pkcs7asn1||{};zN.pkcs7=zN.pkcs7||{};zN.pkcs7.asn1=KN;var Nct={name:"ContentInfo",tagClass:Cr.Class.UNIVERSAL,type:Cr.Type.SEQUENCE,constructed:!0,value:[{name:"ContentInfo.ContentType",tagClass:Cr.Class.UNIVERSAL,type:Cr.Type.OID,constructed:!1,capture:"contentType"},{name:"ContentInfo.content",tagClass:Cr.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,captureAsn1:"content"}]};KN.contentInfoValidator=Nct;var Mct={name:"EncryptedContentInfo",tagClass:Cr.Class.UNIVERSAL,type:Cr.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentType",tagClass:Cr.Class.UNIVERSAL,type:Cr.Type.OID,constructed:!1,capture:"contentType"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm",tagClass:Cr.Class.UNIVERSAL,type:Cr.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentEncryptionAlgorithm.algorithm",tagClass:Cr.Class.UNIVERSAL,type:Cr.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm.parameter",tagClass:Cr.Class.UNIVERSAL,captureAsn1:"encParameter"}]},{name:"EncryptedContentInfo.encryptedContent",tagClass:Cr.Class.CONTEXT_SPECIFIC,type:0,capture:"encryptedContent",captureAsn1:"encryptedContentAsn1"}]};KN.envelopedDataValidator={name:"EnvelopedData",tagClass:Cr.Class.UNIVERSAL,type:Cr.Type.SEQUENCE,constructed:!0,value:[{name:"EnvelopedData.Version",tagClass:Cr.Class.UNIVERSAL,type:Cr.Type.INTEGER,constructed:!1,capture:"version"},{name:"EnvelopedData.RecipientInfos",tagClass:Cr.Class.UNIVERSAL,type:Cr.Type.SET,constructed:!0,captureAsn1:"recipientInfos"}].concat(Mct)};KN.encryptedDataValidator={name:"EncryptedData",tagClass:Cr.Class.UNIVERSAL,type:Cr.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedData.Version",tagClass:Cr.Class.UNIVERSAL,type:Cr.Type.INTEGER,constructed:!1,capture:"version"}].concat(Mct)};var Idr={name:"SignerInfo",tagClass:Cr.Class.UNIVERSAL,type:Cr.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.version",tagClass:Cr.Class.UNIVERSAL,type:Cr.Type.INTEGER,constructed:!1},{name:"SignerInfo.issuerAndSerialNumber",tagClass:Cr.Class.UNIVERSAL,type:Cr.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.issuerAndSerialNumber.issuer",tagClass:Cr.Class.UNIVERSAL,type:Cr.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"SignerInfo.issuerAndSerialNumber.serialNumber",tagClass:Cr.Class.UNIVERSAL,type:Cr.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"SignerInfo.digestAlgorithm",tagClass:Cr.Class.UNIVERSAL,type:Cr.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.digestAlgorithm.algorithm",tagClass:Cr.Class.UNIVERSAL,type:Cr.Type.OID,constructed:!1,capture:"digestAlgorithm"},{name:"SignerInfo.digestAlgorithm.parameter",tagClass:Cr.Class.UNIVERSAL,constructed:!1,captureAsn1:"digestParameter",optional:!0}]},{name:"SignerInfo.authenticatedAttributes",tagClass:Cr.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"authenticatedAttributes"},{name:"SignerInfo.digestEncryptionAlgorithm",tagClass:Cr.Class.UNIVERSAL,type:Cr.Type.SEQUENCE,constructed:!0,capture:"signatureAlgorithm"},{name:"SignerInfo.encryptedDigest",tagClass:Cr.Class.UNIVERSAL,type:Cr.Type.OCTETSTRING,constructed:!1,capture:"signature"},{name:"SignerInfo.unauthenticatedAttributes",tagClass:Cr.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,capture:"unauthenticatedAttributes"}]};KN.signedDataValidator={name:"SignedData",tagClass:Cr.Class.UNIVERSAL,type:Cr.Type.SEQUENCE,constructed:!0,value:[{name:"SignedData.Version",tagClass:Cr.Class.UNIVERSAL,type:Cr.Type.INTEGER,constructed:!1,capture:"version"},{name:"SignedData.DigestAlgorithms",tagClass:Cr.Class.UNIVERSAL,type:Cr.Type.SET,constructed:!0,captureAsn1:"digestAlgorithms"},Nct,{name:"SignedData.Certificates",tagClass:Cr.Class.CONTEXT_SPECIFIC,type:0,optional:!0,captureAsn1:"certificates"},{name:"SignedData.CertificateRevocationLists",tagClass:Cr.Class.CONTEXT_SPECIFIC,type:1,optional:!0,captureAsn1:"crls"},{name:"SignedData.SignerInfos",tagClass:Cr.Class.UNIVERSAL,type:Cr.Type.SET,capture:"signerInfos",optional:!0,value:[Idr]}]};KN.recipientInfoValidator={name:"RecipientInfo",tagClass:Cr.Class.UNIVERSAL,type:Cr.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.version",tagClass:Cr.Class.UNIVERSAL,type:Cr.Type.INTEGER,constructed:!1,capture:"version"},{name:"RecipientInfo.issuerAndSerial",tagClass:Cr.Class.UNIVERSAL,type:Cr.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.issuerAndSerial.issuer",tagClass:Cr.Class.UNIVERSAL,type:Cr.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"RecipientInfo.issuerAndSerial.serialNumber",tagClass:Cr.Class.UNIVERSAL,type:Cr.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"RecipientInfo.keyEncryptionAlgorithm",tagClass:Cr.Class.UNIVERSAL,type:Cr.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.keyEncryptionAlgorithm.algorithm",tagClass:Cr.Class.UNIVERSAL,type:Cr.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"RecipientInfo.keyEncryptionAlgorithm.parameter",tagClass:Cr.Class.UNIVERSAL,constructed:!1,captureAsn1:"encParameter",optional:!0}]},{name:"RecipientInfo.encryptedKey",tagClass:Cr.Class.UNIVERSAL,type:Cr.Type.OCTETSTRING,constructed:!1,capture:"encKey"}]}});var pwe=H((LAi,Fct)=>{d();var _k=Ri();Ho();_k.mgf=_k.mgf||{};var Tdr=Fct.exports=_k.mgf.mgf1=_k.mgf1=_k.mgf1||{};Tdr.create=function(t){var e={generate:s(function(r,n){for(var i=new _k.util.ByteBuffer,o=Math.ceil(n/t.digestLength),a=0;a<o;a++){var c=new _k.util.ByteBuffer;c.putInt32(a),t.start(),t.update(r+c.getBytes()),i.putBuffer(t.digest())}return i.truncate(i.length()-n),i.getBytes()},"generate")};return e}});var Qct=H((QAi,Oct)=>{d();var $re=Ri();pwe();Oct.exports=$re.mgf=$re.mgf||{};$re.mgf.mgf1=$re.mgf1});var Wre=H((qAi,Uct)=>{d();var Rk=Ri();Gh();Ho();var wdr=Uct.exports=Rk.pss=Rk.pss||{};wdr.create=function(t){arguments.length===3&&(t={md:arguments[0],mgf:arguments[1],saltLength:arguments[2]});var e=t.md,r=t.mgf,n=e.digestLength,i=t.salt||null;typeof i=="string"&&(i=Rk.util.createBuffer(i));var o;if("saltLength"in t)o=t.saltLength;else if(i!==null)o=i.length();else throw new Error("Salt length not specified or specific salt not given.");if(i!==null&&i.length()!==o)throw new Error("Given salt length does not match length of given salt.");var a=t.prng||Rk.random,c={};return c.encode=function(l,u){var f,p=u-1,m=Math.ceil(p/8),h=l.digest().getBytes();if(m<n+o+2)throw new Error("Message is too long to encrypt.");var g;i===null?g=a.getBytesSync(o):g=i.bytes();var A=new Rk.util.ByteBuffer;A.fillWithByte(0,8),A.putBytes(h),A.putBytes(g),e.start(),e.update(A.getBytes());var y=e.digest().getBytes(),E=new Rk.util.ByteBuffer;E.fillWithByte(0,m-o-n-2),E.putByte(1),E.putBytes(g);var b=E.getBytes(),S=m-n-1,R=r.generate(y,S),B="";for(f=0;f<S;f++)B+=String.fromCharCode(b.charCodeAt(f)^R.charCodeAt(f));var L=65280>>8*m-p&255;return B=String.fromCharCode(B.charCodeAt(0)&~L)+B.substr(1),B+y+"\xBC"},c.verify=function(l,u,f){var p,m=f-1,h=Math.ceil(m/8);if(u=u.substr(-h),h<n+o+2)throw new Error("Inconsistent parameters to PSS signature verification.");if(u.charCodeAt(h-1)!==188)throw new Error("Encoded message does not end in 0xBC.");var g=h-n-1,A=u.substr(0,g),y=u.substr(g,n),E=65280>>8*h-m&255;if((A.charCodeAt(0)&E)!==0)throw new Error("Bits beyond keysize not zero as expected.");var b=r.generate(y,g),S="";for(p=0;p<g;p++)S+=String.fromCharCode(A.charCodeAt(p)^b.charCodeAt(p));S=String.fromCharCode(S.charCodeAt(0)&~E)+S.substr(1);var R=h-n-o-2;for(p=0;p<R;p++)if(S.charCodeAt(p)!==0)throw new Error("Leftmost octets not zero as expected");if(S.charCodeAt(R)!==1)throw new Error("Inconsistent PSS signature, 0x01 marker not found");var B=S.substr(-o),L=new Rk.util.ByteBuffer;L.fillWithByte(0,8),L.putBytes(l),L.putBytes(B),e.start(),e.update(L.getBytes());var O=e.digest().getBytes();return y===O},c}});var Vre=H(($Ai,jct)=>{d();var yn=Ri();Cw();YA();GQ();l1();Qct();vw();Ik();Wre();KQ();Ho();var ne=yn.asn1,Xt=jct.exports=yn.pki=yn.pki||{},Bo=Xt.oids,yc={};yc.CN=Bo.commonName;yc.commonName="CN";yc.C=Bo.countryName;yc.countryName="C";yc.L=Bo.localityName;yc.localityName="L";yc.ST=Bo.stateOrProvinceName;yc.stateOrProvinceName="ST";yc.O=Bo.organizationName;yc.organizationName="O";yc.OU=Bo.organizationalUnitName;yc.organizationalUnitName="OU";yc.E=Bo.emailAddress;yc.emailAddress="E";var Hct=yn.pki.rsa.publicKeyValidator,Sdr={name:"Certificate",tagClass:ne.Class.UNIVERSAL,type:ne.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate",tagClass:ne.Class.UNIVERSAL,type:ne.Type.SEQUENCE,constructed:!0,captureAsn1:"tbsCertificate",value:[{name:"Certificate.TBSCertificate.version",tagClass:ne.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.version.integer",tagClass:ne.Class.UNIVERSAL,type:ne.Type.INTEGER,constructed:!1,capture:"certVersion"}]},{name:"Certificate.TBSCertificate.serialNumber",tagClass:ne.Class.UNIVERSAL,type:ne.Type.INTEGER,constructed:!1,capture:"certSerialNumber"},{name:"Certificate.TBSCertificate.signature",tagClass:ne.Class.UNIVERSAL,type:ne.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.signature.algorithm",tagClass:ne.Class.UNIVERSAL,type:ne.Type.OID,constructed:!1,capture:"certinfoSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:ne.Class.UNIVERSAL,optional:!0,captureAsn1:"certinfoSignatureParams"}]},{name:"Certificate.TBSCertificate.issuer",tagClass:ne.Class.UNIVERSAL,type:ne.Type.SEQUENCE,constructed:!0,captureAsn1:"certIssuer"},{name:"Certificate.TBSCertificate.validity",tagClass:ne.Class.UNIVERSAL,type:ne.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.validity.notBefore (utc)",tagClass:ne.Class.UNIVERSAL,type:ne.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity1UTCTime"},{name:"Certificate.TBSCertificate.validity.notBefore (generalized)",tagClass:ne.Class.UNIVERSAL,type:ne.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity2GeneralizedTime"},{name:"Certificate.TBSCertificate.validity.notAfter (utc)",tagClass:ne.Class.UNIVERSAL,type:ne.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity3UTCTime"},{name:"Certificate.TBSCertificate.validity.notAfter (generalized)",tagClass:ne.Class.UNIVERSAL,type:ne.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity4GeneralizedTime"}]},{name:"Certificate.TBSCertificate.subject",tagClass:ne.Class.UNIVERSAL,type:ne.Type.SEQUENCE,constructed:!0,captureAsn1:"certSubject"},Hct,{name:"Certificate.TBSCertificate.issuerUniqueID",tagClass:ne.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.issuerUniqueID.id",tagClass:ne.Class.UNIVERSAL,type:ne.Type.BITSTRING,constructed:!1,captureBitStringValue:"certIssuerUniqueId"}]},{name:"Certificate.TBSCertificate.subjectUniqueID",tagClass:ne.Class.CONTEXT_SPECIFIC,type:2,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.subjectUniqueID.id",tagClass:ne.Class.UNIVERSAL,type:ne.Type.BITSTRING,constructed:!1,captureBitStringValue:"certSubjectUniqueId"}]},{name:"Certificate.TBSCertificate.extensions",tagClass:ne.Class.CONTEXT_SPECIFIC,type:3,constructed:!0,captureAsn1:"certExtensions",optional:!0}]},{name:"Certificate.signatureAlgorithm",tagClass:ne.Class.UNIVERSAL,type:ne.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.signatureAlgorithm.algorithm",tagClass:ne.Class.UNIVERSAL,type:ne.Type.OID,constructed:!1,capture:"certSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:ne.Class.UNIVERSAL,optional:!0,captureAsn1:"certSignatureParams"}]},{name:"Certificate.signatureValue",tagClass:ne.Class.UNIVERSAL,type:ne.Type.BITSTRING,constructed:!1,captureBitStringValue:"certSignature"}]},_dr={name:"rsapss",tagClass:ne.Class.UNIVERSAL,type:ne.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.hashAlgorithm",tagClass:ne.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier",tagClass:ne.Class.UNIVERSAL,type:ne.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier.algorithm",tagClass:ne.Class.UNIVERSAL,type:ne.Type.OID,constructed:!1,capture:"hashOid"}]}]},{name:"rsapss.maskGenAlgorithm",tagClass:ne.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier",tagClass:ne.Class.UNIVERSAL,type:ne.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.algorithm",tagClass:ne.Class.UNIVERSAL,type:ne.Type.OID,constructed:!1,capture:"maskGenOid"},{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params",tagClass:ne.Class.UNIVERSAL,type:ne.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params.algorithm",tagClass:ne.Class.UNIVERSAL,type:ne.Type.OID,constructed:!1,capture:"maskGenHashOid"}]}]}]},{name:"rsapss.saltLength",tagClass:ne.Class.CONTEXT_SPECIFIC,type:2,optional:!0,value:[{name:"rsapss.saltLength.saltLength",tagClass:ne.Class.UNIVERSAL,type:ne.Class.INTEGER,constructed:!1,capture:"saltLength"}]},{name:"rsapss.trailerField",tagClass:ne.Class.CONTEXT_SPECIFIC,type:3,optional:!0,value:[{name:"rsapss.trailer.trailer",tagClass:ne.Class.UNIVERSAL,type:ne.Class.INTEGER,constructed:!1,capture:"trailer"}]}]},Rdr={name:"CertificationRequestInfo",tagClass:ne.Class.UNIVERSAL,type:ne.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfo",value:[{name:"CertificationRequestInfo.integer",tagClass:ne.Class.UNIVERSAL,type:ne.Type.INTEGER,constructed:!1,capture:"certificationRequestInfoVersion"},{name:"CertificationRequestInfo.subject",tagClass:ne.Class.UNIVERSAL,type:ne.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfoSubject"},Hct,{name:"CertificationRequestInfo.attributes",tagClass:ne.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"certificationRequestInfoAttributes",value:[{name:"CertificationRequestInfo.attributes",tagClass:ne.Class.UNIVERSAL,type:ne.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequestInfo.attributes.type",tagClass:ne.Class.UNIVERSAL,type:ne.Type.OID,constructed:!1},{name:"CertificationRequestInfo.attributes.value",tagClass:ne.Class.UNIVERSAL,type:ne.Type.SET,constructed:!0}]}]}]},kdr={name:"CertificationRequest",tagClass:ne.Class.UNIVERSAL,type:ne.Type.SEQUENCE,constructed:!0,captureAsn1:"csr",value:[Rdr,{name:"CertificationRequest.signatureAlgorithm",tagClass:ne.Class.UNIVERSAL,type:ne.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequest.signatureAlgorithm.algorithm",tagClass:ne.Class.UNIVERSAL,type:ne.Type.OID,constructed:!1,capture:"csrSignatureOid"},{name:"CertificationRequest.signatureAlgorithm.parameters",tagClass:ne.Class.UNIVERSAL,optional:!0,captureAsn1:"csrSignatureParams"}]},{name:"CertificationRequest.signature",tagClass:ne.Class.UNIVERSAL,type:ne.Type.BITSTRING,constructed:!1,captureBitStringValue:"csrSignature"}]};Xt.RDNAttributesAsArray=function(t,e){for(var r=[],n,i,o,a=0;a<t.value.length;++a){n=t.value[a];for(var c=0;c<n.value.length;++c)o={},i=n.value[c],o.type=ne.derToOid(i.value[0].value),o.value=i.value[1].value,o.valueTagClass=i.value[1].type,o.type in Bo&&(o.name=Bo[o.type],o.name in yc&&(o.shortName=yc[o.name])),e&&(e.update(o.type),e.update(o.value)),r.push(o)}return r};Xt.CRIAttributesAsArray=function(t){for(var e=[],r=0;r<t.length;++r)for(var n=t[r],i=ne.derToOid(n.value[0].value),o=n.value[1].value,a=0;a<o.length;++a){var c={};if(c.type=i,c.value=o[a].value,c.valueTagClass=o[a].type,c.type in Bo&&(c.name=Bo[c.type],c.name in yc&&(c.shortName=yc[c.name])),c.type===Bo.extensionRequest){c.extensions=[];for(var l=0;l<c.value.length;++l)c.extensions.push(Xt.certificateExtensionFromAsn1(c.value[l]))}e.push(c)}return e};function bw(t,e){typeof e=="string"&&(e={shortName:e});for(var r=null,n,i=0;r===null&&i<t.attributes.length;++i)n=t.attributes[i],(e.type&&e.type===n.type||e.name&&e.name===n.name||e.shortName&&e.shortName===n.shortName)&&(r=n);return r}s(bw,"_getAttribute");var jre=s(function(t,e,r){var n={};if(t!==Bo["RSASSA-PSS"])return n;r&&(n={hash:{algorithmOid:Bo.sha1},mgf:{algorithmOid:Bo.mgf1,hash:{algorithmOid:Bo.sha1}},saltLength:20});var i={},o=[];if(!ne.validate(e,_dr,i,o)){var a=new Error("Cannot read RSASSA-PSS parameter block.");throw a.errors=o,a}return i.hashOid!==void 0&&(n.hash=n.hash||{},n.hash.algorithmOid=ne.derToOid(i.hashOid)),i.maskGenOid!==void 0&&(n.mgf=n.mgf||{},n.mgf.algorithmOid=ne.derToOid(i.maskGenOid),n.mgf.hash=n.mgf.hash||{},n.mgf.hash.algorithmOid=ne.derToOid(i.maskGenHashOid)),i.saltLength!==void 0&&(n.saltLength=i.saltLength.charCodeAt(0)),n},"_readSignatureParameters"),Gre=s(function(t){switch(Bo[t.signatureOid]){case"sha1WithRSAEncryption":case"sha1WithRSASignature":return yn.md.sha1.create();case"md5WithRSAEncryption":return yn.md.md5.create();case"sha256WithRSAEncryption":return yn.md.sha256.create();case"sha384WithRSAEncryption":return yn.md.sha384.create();case"sha512WithRSAEncryption":return yn.md.sha512.create();case"RSASSA-PSS":return yn.md.sha256.create();default:var e=new Error("Could not compute "+t.type+" digest. Unknown signature OID.");throw e.signatureOid=t.signatureOid,e}},"_createSignatureDigest"),$ct=s(function(t){var e=t.certificate,r;switch(e.signatureOid){case Bo.sha1WithRSAEncryption:case Bo.sha1WithRSASignature:break;case Bo["RSASSA-PSS"]:var n,i;if(n=Bo[e.signatureParameters.mgf.hash.algorithmOid],n===void 0||yn.md[n]===void 0){var o=new Error("Unsupported MGF hash function.");throw o.oid=e.signatureParameters.mgf.hash.algorithmOid,o.name=n,o}if(i=Bo[e.signatureParameters.mgf.algorithmOid],i===void 0||yn.mgf[i]===void 0){var o=new Error("Unsupported MGF function.");throw o.oid=e.signatureParameters.mgf.algorithmOid,o.name=i,o}if(i=yn.mgf[i].create(yn.md[n].create()),n=Bo[e.signatureParameters.hash.algorithmOid],n===void 0||yn.md[n]===void 0){var o=new Error("Unsupported RSASSA-PSS hash function.");throw o.oid=e.signatureParameters.hash.algorithmOid,o.name=n,o}r=yn.pss.create(yn.md[n].create(),i,e.signatureParameters.saltLength);break}return e.publicKey.verify(t.md.digest().getBytes(),t.signature,r)},"_verifySignature");Xt.certificateFromPem=function(t,e,r){var n=yn.pem.decode(t)[0];if(n.type!=="CERTIFICATE"&&n.type!=="X509 CERTIFICATE"&&n.type!=="TRUSTED CERTIFICATE"){var i=new Error('Could not convert certificate from PEM; PEM header type is not "CERTIFICATE", "X509 CERTIFICATE", or "TRUSTED CERTIFICATE".');throw i.headerType=n.type,i}if(n.procType&&n.procType.type==="ENCRYPTED")throw new Error("Could not convert certificate from PEM; PEM is encrypted.");var o=ne.fromDer(n.body,r);return Xt.certificateFromAsn1(o,e)};Xt.certificateToPem=function(t,e){var r={type:"CERTIFICATE",body:ne.toDer(Xt.certificateToAsn1(t)).getBytes()};return yn.pem.encode(r,{maxline:e})};Xt.publicKeyFromPem=function(t){var e=yn.pem.decode(t)[0];if(e.type!=="PUBLIC KEY"&&e.type!=="RSA PUBLIC KEY"){var r=new Error('Could not convert public key from PEM; PEM header type is not "PUBLIC KEY" or "RSA PUBLIC KEY".');throw r.headerType=e.type,r}if(e.procType&&e.procType.type==="ENCRYPTED")throw new Error("Could not convert public key from PEM; PEM is encrypted.");var n=ne.fromDer(e.body);return Xt.publicKeyFromAsn1(n)};Xt.publicKeyToPem=function(t,e){var r={type:"PUBLIC KEY",body:ne.toDer(Xt.publicKeyToAsn1(t)).getBytes()};return yn.pem.encode(r,{maxline:e})};Xt.publicKeyToRSAPublicKeyPem=function(t,e){var r={type:"RSA PUBLIC KEY",body:ne.toDer(Xt.publicKeyToRSAPublicKey(t)).getBytes()};return yn.pem.encode(r,{maxline:e})};Xt.getPublicKeyFingerprint=function(t,e){e=e||{};var r=e.md||yn.md.sha1.create(),n=e.type||"RSAPublicKey",i;switch(n){case"RSAPublicKey":i=ne.toDer(Xt.publicKeyToRSAPublicKey(t)).getBytes();break;case"SubjectPublicKeyInfo":i=ne.toDer(Xt.publicKeyToAsn1(t)).getBytes();break;default:throw new Error('Unknown fingerprint type "'+e.type+'".')}r.start(),r.update(i);var o=r.digest();if(e.encoding==="hex"){var a=o.toHex();return e.delimiter?a.match(/.{2}/g).join(e.delimiter):a}else{if(e.encoding==="binary")return o.getBytes();if(e.encoding)throw new Error('Unknown encoding "'+e.encoding+'".')}return o};Xt.certificationRequestFromPem=function(t,e,r){var n=yn.pem.decode(t)[0];if(n.type!=="CERTIFICATE REQUEST"){var i=new Error('Could not convert certification request from PEM; PEM header type is not "CERTIFICATE REQUEST".');throw i.headerType=n.type,i}if(n.procType&&n.procType.type==="ENCRYPTED")throw new Error("Could not convert certification request from PEM; PEM is encrypted.");var o=ne.fromDer(n.body,r);return Xt.certificationRequestFromAsn1(o,e)};Xt.certificationRequestToPem=function(t,e){var r={type:"CERTIFICATE REQUEST",body:ne.toDer(Xt.certificationRequestToAsn1(t)).getBytes()};return yn.pem.encode(r,{maxline:e})};Xt.createCertificate=function(){var t={};return t.version=2,t.serialNumber="00",t.signatureOid=null,t.signature=null,t.siginfo={},t.siginfo.algorithmOid=null,t.validity={},t.validity.notBefore=new Date,t.validity.notAfter=new Date,t.issuer={},t.issuer.getField=function(e){return bw(t.issuer,e)},t.issuer.addField=function(e){Kh([e]),t.issuer.attributes.push(e)},t.issuer.attributes=[],t.issuer.hash=null,t.subject={},t.subject.getField=function(e){return bw(t.subject,e)},t.subject.addField=function(e){Kh([e]),t.subject.attributes.push(e)},t.subject.attributes=[],t.subject.hash=null,t.extensions=[],t.publicKey=null,t.md=null,t.setSubject=function(e,r){Kh(e),t.subject.attributes=e,delete t.subject.uniqueId,r&&(t.subject.uniqueId=r),t.subject.hash=null},t.setIssuer=function(e,r){Kh(e),t.issuer.attributes=e,delete t.issuer.uniqueId,r&&(t.issuer.uniqueId=r),t.issuer.hash=null},t.setExtensions=function(e){for(var r=0;r<e.length;++r)Wct(e[r],{cert:t});t.extensions=e},t.getExtension=function(e){typeof e=="string"&&(e={name:e});for(var r=null,n,i=0;r===null&&i<t.extensions.length;++i)n=t.extensions[i],(e.id&&n.id===e.id||e.name&&n.name===e.name)&&(r=n);return r},t.sign=function(e,r){t.md=r||yn.md.sha1.create();var n=Bo[t.md.algorithm+"WithRSAEncryption"];if(!n){var i=new Error("Could not compute certificate digest. Unknown message digest algorithm OID.");throw i.algorithm=t.md.algorithm,i}t.signatureOid=t.siginfo.algorithmOid=n,t.tbsCertificate=Xt.getTBSCertificate(t);var o=ne.toDer(t.tbsCertificate);t.md.update(o.getBytes()),t.signature=e.sign(t.md)},t.verify=function(e){var r=!1;if(!t.issued(e)){var n=e.issuer,i=t.subject,o=new Error("The parent certificate did not issue the given child certificate; the child certificate's issuer does not match the parent's subject.");throw o.expectedIssuer=i.attributes,o.actualIssuer=n.attributes,o}var a=e.md;if(a===null){a=Gre({signatureOid:e.signatureOid,type:"certificate"});var c=e.tbsCertificate||Xt.getTBSCertificate(e),l=ne.toDer(c);a.update(l.getBytes())}return a!==null&&(r=$ct({certificate:t,md:a,signature:e.signature})),r},t.isIssuer=function(e){var r=!1,n=t.issuer,i=e.subject;if(n.hash&&i.hash)r=n.hash===i.hash;else if(n.attributes.length===i.attributes.length){r=!0;for(var o,a,c=0;r&&c<n.attributes.length;++c)o=n.attributes[c],a=i.attributes[c],(o.type!==a.type||o.value!==a.value)&&(r=!1)}return r},t.issued=function(e){return e.isIssuer(t)},t.generateSubjectKeyIdentifier=function(){return Xt.getPublicKeyFingerprint(t.publicKey,{type:"RSAPublicKey"})},t.verifySubjectKeyIdentifier=function(){for(var e=Bo.subjectKeyIdentifier,r=0;r<t.extensions.length;++r){var n=t.extensions[r];if(n.id===e){var i=t.generateSubjectKeyIdentifier().getBytes();return yn.util.hexToBytes(n.subjectKeyIdentifier)===i}}return!1},t};Xt.certificateFromAsn1=function(t,e){var r={},n=[];if(!ne.validate(t,Sdr,r,n)){var i=new Error("Cannot read X.509 certificate. ASN.1 object is not an X509v3 Certificate.");throw i.errors=n,i}var o=ne.derToOid(r.publicKeyOid);if(o!==Xt.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");var a=Xt.createCertificate();a.version=r.certVersion?r.certVersion.charCodeAt(0):0;var c=yn.util.createBuffer(r.certSerialNumber);a.serialNumber=c.toHex(),a.signatureOid=yn.asn1.derToOid(r.certSignatureOid),a.signatureParameters=jre(a.signatureOid,r.certSignatureParams,!0),a.siginfo.algorithmOid=yn.asn1.derToOid(r.certinfoSignatureOid),a.siginfo.parameters=jre(a.siginfo.algorithmOid,r.certinfoSignatureParams,!1),a.signature=r.certSignature;var l=[];if(r.certValidity1UTCTime!==void 0&&l.push(ne.utcTimeToDate(r.certValidity1UTCTime)),r.certValidity2GeneralizedTime!==void 0&&l.push(ne.generalizedTimeToDate(r.certValidity2GeneralizedTime)),r.certValidity3UTCTime!==void 0&&l.push(ne.utcTimeToDate(r.certValidity3UTCTime)),r.certValidity4GeneralizedTime!==void 0&&l.push(ne.generalizedTimeToDate(r.certValidity4GeneralizedTime)),l.length>2)throw new Error("Cannot read notBefore/notAfter validity times; more than two times were provided in the certificate.");if(l.length<2)throw new Error("Cannot read notBefore/notAfter validity times; they were not provided as either UTCTime or GeneralizedTime.");if(a.validity.notBefore=l[0],a.validity.notAfter=l[1],a.tbsCertificate=r.tbsCertificate,e){a.md=Gre({signatureOid:a.signatureOid,type:"certificate"});var u=ne.toDer(a.tbsCertificate);a.md.update(u.getBytes())}var f=yn.md.sha1.create(),p=ne.toDer(r.certIssuer);f.update(p.getBytes()),a.issuer.getField=function(g){return bw(a.issuer,g)},a.issuer.addField=function(g){Kh([g]),a.issuer.attributes.push(g)},a.issuer.attributes=Xt.RDNAttributesAsArray(r.certIssuer),r.certIssuerUniqueId&&(a.issuer.uniqueId=r.certIssuerUniqueId),a.issuer.hash=f.digest().toHex();var m=yn.md.sha1.create(),h=ne.toDer(r.certSubject);return m.update(h.getBytes()),a.subject.getField=function(g){return bw(a.subject,g)},a.subject.addField=function(g){Kh([g]),a.subject.attributes.push(g)},a.subject.attributes=Xt.RDNAttributesAsArray(r.certSubject),r.certSubjectUniqueId&&(a.subject.uniqueId=r.certSubjectUniqueId),a.subject.hash=m.digest().toHex(),r.certExtensions?a.extensions=Xt.certificateExtensionsFromAsn1(r.certExtensions):a.extensions=[],a.publicKey=Xt.publicKeyFromAsn1(r.subjectPublicKeyInfo),a};Xt.certificateExtensionsFromAsn1=function(t){for(var e=[],r=0;r<t.value.length;++r)for(var n=t.value[r],i=0;i<n.value.length;++i)e.push(Xt.certificateExtensionFromAsn1(n.value[i]));return e};Xt.certificateExtensionFromAsn1=function(t){var e={};if(e.id=ne.derToOid(t.value[0].value),e.critical=!1,t.value[1].type===ne.Type.BOOLEAN?(e.critical=t.value[1].value.charCodeAt(0)!==0,e.value=t.value[2].value):e.value=t.value[1].value,e.id in Bo){if(e.name=Bo[e.id],e.name==="keyUsage"){var r=ne.fromDer(e.value),n=0,i=0;r.value.length>1&&(n=r.value.charCodeAt(1),i=r.value.length>2?r.value.charCodeAt(2):0),e.digitalSignature=(n&128)===128,e.nonRepudiation=(n&64)===64,e.keyEncipherment=(n&32)===32,e.dataEncipherment=(n&16)===16,e.keyAgreement=(n&8)===8,e.keyCertSign=(n&4)===4,e.cRLSign=(n&2)===2,e.encipherOnly=(n&1)===1,e.decipherOnly=(i&128)===128}else if(e.name==="basicConstraints"){var r=ne.fromDer(e.value);r.value.length>0&&r.value[0].type===ne.Type.BOOLEAN?e.cA=r.value[0].value.charCodeAt(0)!==0:e.cA=!1;var o=null;r.value.length>0&&r.value[0].type===ne.Type.INTEGER?o=r.value[0].value:r.value.length>1&&(o=r.value[1].value),o!==null&&(e.pathLenConstraint=ne.derToInteger(o))}else if(e.name==="extKeyUsage")for(var r=ne.fromDer(e.value),a=0;a<r.value.length;++a){var c=ne.derToOid(r.value[a].value);c in Bo?e[Bo[c]]=!0:e[c]=!0}else if(e.name==="nsCertType"){var r=ne.fromDer(e.value),n=0;r.value.length>1&&(n=r.value.charCodeAt(1)),e.client=(n&128)===128,e.server=(n&64)===64,e.email=(n&32)===32,e.objsign=(n&16)===16,e.reserved=(n&8)===8,e.sslCA=(n&4)===4,e.emailCA=(n&2)===2,e.objCA=(n&1)===1}else if(e.name==="subjectAltName"||e.name==="issuerAltName"){e.altNames=[];for(var l,r=ne.fromDer(e.value),u=0;u<r.value.length;++u){l=r.value[u];var f={type:l.type,value:l.value};switch(e.altNames.push(f),l.type){case 1:case 2:case 6:break;case 7:f.ip=yn.util.bytesToIP(l.value);break;case 8:f.oid=ne.derToOid(l.value);break;default:}}}else if(e.name==="subjectKeyIdentifier"){var r=ne.fromDer(e.value);e.subjectKeyIdentifier=yn.util.bytesToHex(r.value)}}return e};Xt.certificationRequestFromAsn1=function(t,e){var r={},n=[];if(!ne.validate(t,kdr,r,n)){var i=new Error("Cannot read PKCS#10 certificate request. ASN.1 object is not a PKCS#10 CertificationRequest.");throw i.errors=n,i}var o=ne.derToOid(r.publicKeyOid);if(o!==Xt.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");var a=Xt.createCertificationRequest();if(a.version=r.csrVersion?r.csrVersion.charCodeAt(0):0,a.signatureOid=yn.asn1.derToOid(r.csrSignatureOid),a.signatureParameters=jre(a.signatureOid,r.csrSignatureParams,!0),a.siginfo.algorithmOid=yn.asn1.derToOid(r.csrSignatureOid),a.siginfo.parameters=jre(a.siginfo.algorithmOid,r.csrSignatureParams,!1),a.signature=r.csrSignature,a.certificationRequestInfo=r.certificationRequestInfo,e){a.md=Gre({signatureOid:a.signatureOid,type:"certification request"});var c=ne.toDer(a.certificationRequestInfo);a.md.update(c.getBytes())}var l=yn.md.sha1.create();return a.subject.getField=function(u){return bw(a.subject,u)},a.subject.addField=function(u){Kh([u]),a.subject.attributes.push(u)},a.subject.attributes=Xt.RDNAttributesAsArray(r.certificationRequestInfoSubject,l),a.subject.hash=l.digest().toHex(),a.publicKey=Xt.publicKeyFromAsn1(r.subjectPublicKeyInfo),a.getAttribute=function(u){return bw(a,u)},a.addAttribute=function(u){Kh([u]),a.attributes.push(u)},a.attributes=Xt.CRIAttributesAsArray(r.certificationRequestInfoAttributes||[]),a};Xt.createCertificationRequest=function(){var t={};return t.version=0,t.signatureOid=null,t.signature=null,t.siginfo={},t.siginfo.algorithmOid=null,t.subject={},t.subject.getField=function(e){return bw(t.subject,e)},t.subject.addField=function(e){Kh([e]),t.subject.attributes.push(e)},t.subject.attributes=[],t.subject.hash=null,t.publicKey=null,t.attributes=[],t.getAttribute=function(e){return bw(t,e)},t.addAttribute=function(e){Kh([e]),t.attributes.push(e)},t.md=null,t.setSubject=function(e){Kh(e),t.subject.attributes=e,t.subject.hash=null},t.setAttributes=function(e){Kh(e),t.attributes=e},t.sign=function(e,r){t.md=r||yn.md.sha1.create();var n=Bo[t.md.algorithm+"WithRSAEncryption"];if(!n){var i=new Error("Could not compute certification request digest. Unknown message digest algorithm OID.");throw i.algorithm=t.md.algorithm,i}t.signatureOid=t.siginfo.algorithmOid=n,t.certificationRequestInfo=Xt.getCertificationRequestInfo(t);var o=ne.toDer(t.certificationRequestInfo);t.md.update(o.getBytes()),t.signature=e.sign(t.md)},t.verify=function(){var e=!1,r=t.md;if(r===null){r=Gre({signatureOid:t.signatureOid,type:"certification request"});var n=t.certificationRequestInfo||Xt.getCertificationRequestInfo(t),i=ne.toDer(n);r.update(i.getBytes())}return r!==null&&(e=$ct({certificate:t,md:r,signature:t.signature})),e},t};function YN(t){for(var e=ne.create(ne.Class.UNIVERSAL,ne.Type.SEQUENCE,!0,[]),r,n,i=t.attributes,o=0;o<i.length;++o){r=i[o];var a=r.value,c=ne.Type.PRINTABLESTRING;"valueTagClass"in r&&(c=r.valueTagClass,c===ne.Type.UTF8&&(a=yn.util.encodeUtf8(a))),n=ne.create(ne.Class.UNIVERSAL,ne.Type.SET,!0,[ne.create(ne.Class.UNIVERSAL,ne.Type.SEQUENCE,!0,[ne.create(ne.Class.UNIVERSAL,ne.Type.OID,!1,ne.oidToDer(r.type).getBytes()),ne.create(ne.Class.UNIVERSAL,c,!1,a)])]),e.value.push(n)}return e}s(YN,"_dnToAsn1");function Kh(t){for(var e,r=0;r<t.length;++r){if(e=t[r],typeof e.name>"u"&&(e.type&&e.type in Xt.oids?e.name=Xt.oids[e.type]:e.shortName&&e.shortName in yc&&(e.name=Xt.oids[yc[e.shortName]])),typeof e.type>"u")if(e.name&&e.name in Xt.oids)e.type=Xt.oids[e.name];else{var n=new Error("Attribute type not specified.");throw n.attribute=e,n}if(typeof e.shortName>"u"&&e.name&&e.name in yc&&(e.shortName=yc[e.name]),e.type===Bo.extensionRequest&&(e.valueConstructed=!0,e.valueTagClass=ne.Type.SEQUENCE,!e.value&&e.extensions)){e.value=[];for(var i=0;i<e.extensions.length;++i)e.value.push(Xt.certificateExtensionToAsn1(Wct(e.extensions[i])))}if(typeof e.value>"u"){var n=new Error("Attribute value not specified.");throw n.attribute=e,n}}}s(Kh,"_fillMissingFields");function Wct(t,e){if(e=e||{},typeof t.name>"u"&&t.id&&t.id in Xt.oids&&(t.name=Xt.oids[t.id]),typeof t.id>"u")if(t.name&&t.name in Xt.oids)t.id=Xt.oids[t.name];else{var r=new Error("Extension ID not specified.");throw r.extension=t,r}if(typeof t.value<"u")return t;if(t.name==="keyUsage"){var n=0,i=0,o=0;t.digitalSignature&&(i|=128,n=7),t.nonRepudiation&&(i|=64,n=6),t.keyEncipherment&&(i|=32,n=5),t.dataEncipherment&&(i|=16,n=4),t.keyAgreement&&(i|=8,n=3),t.keyCertSign&&(i|=4,n=2),t.cRLSign&&(i|=2,n=1),t.encipherOnly&&(i|=1,n=0),t.decipherOnly&&(o|=128,n=7);var a=String.fromCharCode(n);o!==0?a+=String.fromCharCode(i)+String.fromCharCode(o):i!==0&&(a+=String.fromCharCode(i)),t.value=ne.create(ne.Class.UNIVERSAL,ne.Type.BITSTRING,!1,a)}else if(t.name==="basicConstraints")t.value=ne.create(ne.Class.UNIVERSAL,ne.Type.SEQUENCE,!0,[]),t.cA&&t.value.value.push(ne.create(ne.Class.UNIVERSAL,ne.Type.BOOLEAN,!1,"\xFF")),"pathLenConstraint"in t&&t.value.value.push(ne.create(ne.Class.UNIVERSAL,ne.Type.INTEGER,!1,ne.integerToDer(t.pathLenConstraint).getBytes()));else if(t.name==="extKeyUsage"){t.value=ne.create(ne.Class.UNIVERSAL,ne.Type.SEQUENCE,!0,[]);var c=t.value.value;for(var l in t)t[l]===!0&&(l in Bo?c.push(ne.create(ne.Class.UNIVERSAL,ne.Type.OID,!1,ne.oidToDer(Bo[l]).getBytes())):l.indexOf(".")!==-1&&c.push(ne.create(ne.Class.UNIVERSAL,ne.Type.OID,!1,ne.oidToDer(l).getBytes())))}else if(t.name==="nsCertType"){var n=0,i=0;t.client&&(i|=128,n=7),t.server&&(i|=64,n=6),t.email&&(i|=32,n=5),t.objsign&&(i|=16,n=4),t.reserved&&(i|=8,n=3),t.sslCA&&(i|=4,n=2),t.emailCA&&(i|=2,n=1),t.objCA&&(i|=1,n=0);var a=String.fromCharCode(n);i!==0&&(a+=String.fromCharCode(i)),t.value=ne.create(ne.Class.UNIVERSAL,ne.Type.BITSTRING,!1,a)}else if(t.name==="subjectAltName"||t.name==="issuerAltName"){t.value=ne.create(ne.Class.UNIVERSAL,ne.Type.SEQUENCE,!0,[]);for(var u,f=0;f<t.altNames.length;++f){u=t.altNames[f];var a=u.value;if(u.type===7&&u.ip){if(a=yn.util.bytesFromIP(u.ip),a===null){var r=new Error('Extension "ip" value is not a valid IPv4 or IPv6 address.');throw r.extension=t,r}}else u.type===8&&(u.oid?a=ne.oidToDer(ne.oidToDer(u.oid)):a=ne.oidToDer(a));t.value.value.push(ne.create(ne.Class.CONTEXT_SPECIFIC,u.type,!1,a))}}else if(t.name==="nsComment"&&e.cert){if(!/^[\x00-\x7F]*$/.test(t.comment)||t.comment.length<1||t.comment.length>128)throw new Error('Invalid "nsComment" content.');t.value=ne.create(ne.Class.UNIVERSAL,ne.Type.IA5STRING,!1,t.comment)}else if(t.name==="subjectKeyIdentifier"&&e.cert){var p=e.cert.generateSubjectKeyIdentifier();t.subjectKeyIdentifier=p.toHex(),t.value=ne.create(ne.Class.UNIVERSAL,ne.Type.OCTETSTRING,!1,p.getBytes())}else if(t.name==="authorityKeyIdentifier"&&e.cert){t.value=ne.create(ne.Class.UNIVERSAL,ne.Type.SEQUENCE,!0,[]);var c=t.value.value;if(t.keyIdentifier){var m=t.keyIdentifier===!0?e.cert.generateSubjectKeyIdentifier().getBytes():t.keyIdentifier;c.push(ne.create(ne.Class.CONTEXT_SPECIFIC,0,!1,m))}if(t.authorityCertIssuer){var h=[ne.create(ne.Class.CONTEXT_SPECIFIC,4,!0,[YN(t.authorityCertIssuer===!0?e.cert.issuer:t.authorityCertIssuer)])];c.push(ne.create(ne.Class.CONTEXT_SPECIFIC,1,!0,h))}if(t.serialNumber){var g=yn.util.hexToBytes(t.serialNumber===!0?e.cert.serialNumber:t.serialNumber);c.push(ne.create(ne.Class.CONTEXT_SPECIFIC,2,!1,g))}}else if(t.name==="cRLDistributionPoints"){t.value=ne.create(ne.Class.UNIVERSAL,ne.Type.SEQUENCE,!0,[]);for(var c=t.value.value,A=ne.create(ne.Class.UNIVERSAL,ne.Type.SEQUENCE,!0,[]),y=ne.create(ne.Class.CONTEXT_SPECIFIC,0,!0,[]),u,f=0;f<t.altNames.length;++f){u=t.altNames[f];var a=u.value;if(u.type===7&&u.ip){if(a=yn.util.bytesFromIP(u.ip),a===null){var r=new Error('Extension "ip" value is not a valid IPv4 or IPv6 address.');throw r.extension=t,r}}else u.type===8&&(u.oid?a=ne.oidToDer(ne.oidToDer(u.oid)):a=ne.oidToDer(a));y.value.push(ne.create(ne.Class.CONTEXT_SPECIFIC,u.type,!1,a))}A.value.push(ne.create(ne.Class.CONTEXT_SPECIFIC,0,!0,[y])),c.push(A)}if(typeof t.value>"u"){var r=new Error("Extension value not specified.");throw r.extension=t,r}return t}s(Wct,"_fillMissingExtensionFields");function mwe(t,e){switch(t){case Bo["RSASSA-PSS"]:var r=[];return e.hash.algorithmOid!==void 0&&r.push(ne.create(ne.Class.CONTEXT_SPECIFIC,0,!0,[ne.create(ne.Class.UNIVERSAL,ne.Type.SEQUENCE,!0,[ne.create(ne.Class.UNIVERSAL,ne.Type.OID,!1,ne.oidToDer(e.hash.algorithmOid).getBytes()),ne.create(ne.Class.UNIVERSAL,ne.Type.NULL,!1,"")])])),e.mgf.algorithmOid!==void 0&&r.push(ne.create(ne.Class.CONTEXT_SPECIFIC,1,!0,[ne.create(ne.Class.UNIVERSAL,ne.Type.SEQUENCE,!0,[ne.create(ne.Class.UNIVERSAL,ne.Type.OID,!1,ne.oidToDer(e.mgf.algorithmOid).getBytes()),ne.create(ne.Class.UNIVERSAL,ne.Type.SEQUENCE,!0,[ne.create(ne.Class.UNIVERSAL,ne.Type.OID,!1,ne.oidToDer(e.mgf.hash.algorithmOid).getBytes()),ne.create(ne.Class.UNIVERSAL,ne.Type.NULL,!1,"")])])])),e.saltLength!==void 0&&r.push(ne.create(ne.Class.CONTEXT_SPECIFIC,2,!0,[ne.create(ne.Class.UNIVERSAL,ne.Type.INTEGER,!1,ne.integerToDer(e.saltLength).getBytes())])),ne.create(ne.Class.UNIVERSAL,ne.Type.SEQUENCE,!0,r);default:return ne.create(ne.Class.UNIVERSAL,ne.Type.NULL,!1,"")}}s(mwe,"_signatureParametersToAsn1");function Pdr(t){var e=ne.create(ne.Class.CONTEXT_SPECIFIC,0,!0,[]);if(t.attributes.length===0)return e;for(var r=t.attributes,n=0;n<r.length;++n){var i=r[n],o=i.value,a=ne.Type.UTF8;"valueTagClass"in i&&(a=i.valueTagClass),a===ne.Type.UTF8&&(o=yn.util.encodeUtf8(o));var c=!1;"valueConstructed"in i&&(c=i.valueConstructed);var l=ne.create(ne.Class.UNIVERSAL,ne.Type.SEQUENCE,!0,[ne.create(ne.Class.UNIVERSAL,ne.Type.OID,!1,ne.oidToDer(i.type).getBytes()),ne.create(ne.Class.UNIVERSAL,ne.Type.SET,!0,[ne.create(ne.Class.UNIVERSAL,a,c,o)])]);e.value.push(l)}return e}s(Pdr,"_CRIAttributesToAsn1");var Ddr=new Date("1950-01-01T00:00:00Z"),Bdr=new Date("2050-01-01T00:00:00Z");function qct(t){return t>=Ddr&&t<Bdr?ne.create(ne.Class.UNIVERSAL,ne.Type.UTCTIME,!1,ne.dateToUtcTime(t)):ne.create(ne.Class.UNIVERSAL,ne.Type.GENERALIZEDTIME,!1,ne.dateToGeneralizedTime(t))}s(qct,"_dateToAsn1");Xt.getTBSCertificate=function(t){var e=qct(t.validity.notBefore),r=qct(t.validity.notAfter),n=ne.create(ne.Class.UNIVERSAL,ne.Type.SEQUENCE,!0,[ne.create(ne.Class.CONTEXT_SPECIFIC,0,!0,[ne.create(ne.Class.UNIVERSAL,ne.Type.INTEGER,!1,ne.integerToDer(t.version).getBytes())]),ne.create(ne.Class.UNIVERSAL,ne.Type.INTEGER,!1,yn.util.hexToBytes(t.serialNumber)),ne.create(ne.Class.UNIVERSAL,ne.Type.SEQUENCE,!0,[ne.create(ne.Class.UNIVERSAL,ne.Type.OID,!1,ne.oidToDer(t.siginfo.algorithmOid).getBytes()),mwe(t.siginfo.algorithmOid,t.siginfo.parameters)]),YN(t.issuer),ne.create(ne.Class.UNIVERSAL,ne.Type.SEQUENCE,!0,[e,r]),YN(t.subject),Xt.publicKeyToAsn1(t.publicKey)]);return t.issuer.uniqueId&&n.value.push(ne.create(ne.Class.CONTEXT_SPECIFIC,1,!0,[ne.create(ne.Class.UNIVERSAL,ne.Type.BITSTRING,!1,"\0"+t.issuer.uniqueId)])),t.subject.uniqueId&&n.value.push(ne.create(ne.Class.CONTEXT_SPECIFIC,2,!0,[ne.create(ne.Class.UNIVERSAL,ne.Type.BITSTRING,!1,"\0"+t.subject.uniqueId)])),t.extensions.length>0&&n.value.push(Xt.certificateExtensionsToAsn1(t.extensions)),n};Xt.getCertificationRequestInfo=function(t){var e=ne.create(ne.Class.UNIVERSAL,ne.Type.SEQUENCE,!0,[ne.create(ne.Class.UNIVERSAL,ne.Type.INTEGER,!1,ne.integerToDer(t.version).getBytes()),YN(t.subject),Xt.publicKeyToAsn1(t.publicKey),Pdr(t)]);return e};Xt.distinguishedNameToAsn1=function(t){return YN(t)};Xt.certificateToAsn1=function(t){var e=t.tbsCertificate||Xt.getTBSCertificate(t);return ne.create(ne.Class.UNIVERSAL,ne.Type.SEQUENCE,!0,[e,ne.create(ne.Class.UNIVERSAL,ne.Type.SEQUENCE,!0,[ne.create(ne.Class.UNIVERSAL,ne.Type.OID,!1,ne.oidToDer(t.signatureOid).getBytes()),mwe(t.signatureOid,t.signatureParameters)]),ne.create(ne.Class.UNIVERSAL,ne.Type.BITSTRING,!1,"\0"+t.signature)])};Xt.certificateExtensionsToAsn1=function(t){var e=ne.create(ne.Class.CONTEXT_SPECIFIC,3,!0,[]),r=ne.create(ne.Class.UNIVERSAL,ne.Type.SEQUENCE,!0,[]);e.value.push(r);for(var n=0;n<t.length;++n)r.value.push(Xt.certificateExtensionToAsn1(t[n]));return e};Xt.certificateExtensionToAsn1=function(t){var e=ne.create(ne.Class.UNIVERSAL,ne.Type.SEQUENCE,!0,[]);e.value.push(ne.create(ne.Class.UNIVERSAL,ne.Type.OID,!1,ne.oidToDer(t.id).getBytes())),t.critical&&e.value.push(ne.create(ne.Class.UNIVERSAL,ne.Type.BOOLEAN,!1,"\xFF"));var r=t.value;return typeof t.value!="string"&&(r=ne.toDer(r).getBytes()),e.value.push(ne.create(ne.Class.UNIVERSAL,ne.Type.OCTETSTRING,!1,r)),e};Xt.certificationRequestToAsn1=function(t){var e=t.certificationRequestInfo||Xt.getCertificationRequestInfo(t);return ne.create(ne.Class.UNIVERSAL,ne.Type.SEQUENCE,!0,[e,ne.create(ne.Class.UNIVERSAL,ne.Type.SEQUENCE,!0,[ne.create(ne.Class.UNIVERSAL,ne.Type.OID,!1,ne.oidToDer(t.signatureOid).getBytes()),mwe(t.signatureOid,t.signatureParameters)]),ne.create(ne.Class.UNIVERSAL,ne.Type.BITSTRING,!1,"\0"+t.signature)])};Xt.createCaStore=function(t){var e={certs:{}};e.getIssuer=function(a){var c=r(a.issuer);return c},e.addCertificate=function(a){if(typeof a=="string"&&(a=yn.pki.certificateFromPem(a)),n(a.subject),!e.hasCertificate(a))if(a.subject.hash in e.certs){var c=e.certs[a.subject.hash];yn.util.isArray(c)||(c=[c]),c.push(a),e.certs[a.subject.hash]=c}else e.certs[a.subject.hash]=a},e.hasCertificate=function(a){typeof a=="string"&&(a=yn.pki.certificateFromPem(a));var c=r(a.subject);if(!c)return!1;yn.util.isArray(c)||(c=[c]);for(var l=ne.toDer(Xt.certificateToAsn1(a)).getBytes(),u=0;u<c.length;++u){var f=ne.toDer(Xt.certificateToAsn1(c[u])).getBytes();if(l===f)return!0}return!1},e.listAllCertificates=function(){var a=[];for(var c in e.certs)if(e.certs.hasOwnProperty(c)){var l=e.certs[c];if(!yn.util.isArray(l))a.push(l);else for(var u=0;u<l.length;++u)a.push(l[u])}return a},e.removeCertificate=function(a){var c;if(typeof a=="string"&&(a=yn.pki.certificateFromPem(a)),n(a.subject),!e.hasCertificate(a))return null;var l=r(a.subject);if(!yn.util.isArray(l))return c=e.certs[a.subject.hash],delete e.certs[a.subject.hash],c;for(var u=ne.toDer(Xt.certificateToAsn1(a)).getBytes(),f=0;f<l.length;++f){var p=ne.toDer(Xt.certificateToAsn1(l[f])).getBytes();u===p&&(c=l[f],l.splice(f,1))}return l.length===0&&delete e.certs[a.subject.hash],c};function r(a){return n(a),e.certs[a.hash]||null}s(r,"getBySubject");function n(a){if(!a.hash){var c=yn.md.sha1.create();a.attributes=Xt.RDNAttributesAsArray(YN(a),c),a.hash=c.digest().toHex()}}if(s(n,"ensureSubjectHasHash"),t)for(var i=0;i<t.length;++i){var o=t[i];e.addCertificate(o)}return e};Xt.certificateError={bad_certificate:"forge.pki.BadCertificate",unsupported_certificate:"forge.pki.UnsupportedCertificate",certificate_revoked:"forge.pki.CertificateRevoked",certificate_expired:"forge.pki.CertificateExpired",certificate_unknown:"forge.pki.CertificateUnknown",unknown_ca:"forge.pki.UnknownCertificateAuthority"};Xt.verifyCertificateChain=function(t,e,r){typeof r=="function"&&(r={verify:r}),r=r||{},e=e.slice(0);var n=e.slice(0),i=r.validityCheckDate;typeof i>"u"&&(i=new Date);var o=!0,a=null,c=0;do{var l=e.shift(),u=null,f=!1;if(i&&(i<l.validity.notBefore||i>l.validity.notAfter)&&(a={message:"Certificate is not valid yet or has expired.",error:Xt.certificateError.certificate_expired,notBefore:l.validity.notBefore,notAfter:l.validity.notAfter,now:i}),a===null){if(u=e[0]||t.getIssuer(l),u===null&&l.isIssuer(l)&&(f=!0,u=l),u){var p=u;yn.util.isArray(p)||(p=[p]);for(var m=!1;!m&&p.length>0;){u=p.shift();try{m=u.verify(l)}catch{}}m||(a={message:"Certificate signature is invalid.",error:Xt.certificateError.bad_certificate})}a===null&&(!u||f)&&!t.hasCertificate(l)&&(a={message:"Certificate is not trusted.",error:Xt.certificateError.unknown_ca})}if(a===null&&u&&!l.isIssuer(u)&&(a={message:"Certificate issuer is invalid.",error:Xt.certificateError.bad_certificate}),a===null)for(var h={keyUsage:!0,basicConstraints:!0},g=0;a===null&&g<l.extensions.length;++g){var A=l.extensions[g];A.critical&&!(A.name in h)&&(a={message:"Certificate has an unsupported critical extension.",error:Xt.certificateError.unsupported_certificate})}if(a===null&&(!o||e.length===0&&(!u||f))){var y=l.getExtension("basicConstraints"),E=l.getExtension("keyUsage");if(E!==null&&(!E.keyCertSign||y===null)&&(a={message:"Certificate keyUsage or basicConstraints conflict or indicate that the certificate is not a CA. If the certificate is the only one in the chain or isn't the first then the certificate must be a valid CA.",error:Xt.certificateError.bad_certificate}),a===null&&y!==null&&!y.cA&&(a={message:"Certificate basicConstraints indicates the certificate is not a CA.",error:Xt.certificateError.bad_certificate}),a===null&&E!==null&&"pathLenConstraint"in y){var b=c-1;b>y.pathLenConstraint&&(a={message:"Certificate basicConstraints pathLenConstraint violated.",error:Xt.certificateError.bad_certificate})}}var S=a===null?!0:a.error,R=r.verify?r.verify(S,c,n):S;if(R===!0)a=null;else throw S===!0&&(a={message:"The application rejected the certificate.",error:Xt.certificateError.bad_certificate}),(R||R===0)&&(typeof R=="object"&&!yn.util.isArray(R)?(R.message&&(a.message=R.message),R.error&&(a.error=R.error)):typeof R=="string"&&(a.error=R)),a;o=!1,++c}while(e.length>0);return!0}});var gwe=H((GAi,Vct)=>{d();var js=Ri();YA();$N();vw();fwe();dwe();Gh();KQ();VN();Ho();Vre();var Se=js.asn1,Xi=js.pki,JQ=Vct.exports=js.pkcs12=js.pkcs12||{},Gct={name:"ContentInfo",tagClass:Se.Class.UNIVERSAL,type:Se.Type.SEQUENCE,constructed:!0,value:[{name:"ContentInfo.contentType",tagClass:Se.Class.UNIVERSAL,type:Se.Type.OID,constructed:!1,capture:"contentType"},{name:"ContentInfo.content",tagClass:Se.Class.CONTEXT_SPECIFIC,constructed:!0,captureAsn1:"content"}]},Ndr={name:"PFX",tagClass:Se.Class.UNIVERSAL,type:Se.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.version",tagClass:Se.Class.UNIVERSAL,type:Se.Type.INTEGER,constructed:!1,capture:"version"},Gct,{name:"PFX.macData",tagClass:Se.Class.UNIVERSAL,type:Se.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"mac",value:[{name:"PFX.macData.mac",tagClass:Se.Class.UNIVERSAL,type:Se.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.macData.mac.digestAlgorithm",tagClass:Se.Class.UNIVERSAL,type:Se.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.macData.mac.digestAlgorithm.algorithm",tagClass:Se.Class.UNIVERSAL,type:Se.Type.OID,constructed:!1,capture:"macAlgorithm"},{name:"PFX.macData.mac.digestAlgorithm.parameters",tagClass:Se.Class.UNIVERSAL,captureAsn1:"macAlgorithmParameters"}]},{name:"PFX.macData.mac.digest",tagClass:Se.Class.UNIVERSAL,type:Se.Type.OCTETSTRING,constructed:!1,capture:"macDigest"}]},{name:"PFX.macData.macSalt",tagClass:Se.Class.UNIVERSAL,type:Se.Type.OCTETSTRING,constructed:!1,capture:"macSalt"},{name:"PFX.macData.iterations",tagClass:Se.Class.UNIVERSAL,type:Se.Type.INTEGER,constructed:!1,optional:!0,capture:"macIterations"}]}]},Mdr={name:"SafeBag",tagClass:Se.Class.UNIVERSAL,type:Se.Type.SEQUENCE,constructed:!0,value:[{name:"SafeBag.bagId",tagClass:Se.Class.UNIVERSAL,type:Se.Type.OID,constructed:!1,capture:"bagId"},{name:"SafeBag.bagValue",tagClass:Se.Class.CONTEXT_SPECIFIC,constructed:!0,captureAsn1:"bagValue"},{name:"SafeBag.bagAttributes",tagClass:Se.Class.UNIVERSAL,type:Se.Type.SET,constructed:!0,optional:!0,capture:"bagAttributes"}]},Ldr={name:"Attribute",tagClass:Se.Class.UNIVERSAL,type:Se.Type.SEQUENCE,constructed:!0,value:[{name:"Attribute.attrId",tagClass:Se.Class.UNIVERSAL,type:Se.Type.OID,constructed:!1,capture:"oid"},{name:"Attribute.attrValues",tagClass:Se.Class.UNIVERSAL,type:Se.Type.SET,constructed:!0,capture:"values"}]},Fdr={name:"CertBag",tagClass:Se.Class.UNIVERSAL,type:Se.Type.SEQUENCE,constructed:!0,value:[{name:"CertBag.certId",tagClass:Se.Class.UNIVERSAL,type:Se.Type.OID,constructed:!1,capture:"certId"},{name:"CertBag.certValue",tagClass:Se.Class.CONTEXT_SPECIFIC,constructed:!0,value:[{name:"CertBag.certValue[0]",tagClass:Se.Class.UNIVERSAL,type:Se.Class.OCTETSTRING,constructed:!1,capture:"cert"}]}]};function YQ(t,e,r,n){for(var i=[],o=0;o<t.length;o++)for(var a=0;a<t[o].safeBags.length;a++){var c=t[o].safeBags[a];if(!(n!==void 0&&c.type!==n)){if(e===null){i.push(c);continue}c.attributes[e]!==void 0&&c.attributes[e].indexOf(r)>=0&&i.push(c)}}return i}s(YQ,"_getBagsByAttribute");JQ.pkcs12FromAsn1=function(t,e,r){typeof e=="string"?(r=e,e=!0):e===void 0&&(e=!0);var n={},i=[];if(!Se.validate(t,Ndr,n,i)){var o=new Error("Cannot read PKCS#12 PFX. ASN.1 object is not an PKCS#12 PFX.");throw o.errors=o,o}var a={version:n.version.charCodeAt(0),safeContents:[],getBags:s(function(y){var E={},b;return"localKeyId"in y?b=y.localKeyId:"localKeyIdHex"in y&&(b=js.util.hexToBytes(y.localKeyIdHex)),b===void 0&&!("friendlyName"in y)&&"bagType"in y&&(E[y.bagType]=YQ(a.safeContents,null,null,y.bagType)),b!==void 0&&(E.localKeyId=YQ(a.safeContents,"localKeyId",b,y.bagType)),"friendlyName"in y&&(E.friendlyName=YQ(a.safeContents,"friendlyName",y.friendlyName,y.bagType)),E},"getBags"),getBagsByFriendlyName:s(function(y,E){return YQ(a.safeContents,"friendlyName",y,E)},"getBagsByFriendlyName"),getBagsByLocalKeyId:s(function(y,E){return YQ(a.safeContents,"localKeyId",y,E)},"getBagsByLocalKeyId")};if(n.version.charCodeAt(0)!==3){var o=new Error("PKCS#12 PFX of version other than 3 not supported.");throw o.version=n.version.charCodeAt(0),o}if(Se.derToOid(n.contentType)!==Xi.oids.data){var o=new Error("Only PKCS#12 PFX in password integrity mode supported.");throw o.oid=Se.derToOid(n.contentType),o}var c=n.content.value[0];if(c.tagClass!==Se.Class.UNIVERSAL||c.type!==Se.Type.OCTETSTRING)throw new Error("PKCS#12 authSafe content data is not an OCTET STRING.");if(c=hwe(c),n.mac){var l=null,u=0,f=Se.derToOid(n.macAlgorithm);switch(f){case Xi.oids.sha1:l=js.md.sha1.create(),u=20;break;case Xi.oids.sha256:l=js.md.sha256.create(),u=32;break;case Xi.oids.sha384:l=js.md.sha384.create(),u=48;break;case Xi.oids.sha512:l=js.md.sha512.create(),u=64;break;case Xi.oids.md5:l=js.md.md5.create(),u=16;break}if(l===null)throw new Error("PKCS#12 uses unsupported MAC algorithm: "+f);var p=new js.util.ByteBuffer(n.macSalt),m="macIterations"in n?parseInt(js.util.bytesToHex(n.macIterations),16):1,h=JQ.generateKey(r,p,3,m,u,l),g=js.hmac.create();g.start(l,h),g.update(c.value);var A=g.getMac();if(A.getBytes()!==n.macDigest)throw new Error("PKCS#12 MAC could not be verified. Invalid password?")}return Odr(a,c.value,e,r),a};function hwe(t){if(t.composed||t.constructed){for(var e=js.util.createBuffer(),r=0;r<t.value.length;++r)e.putBytes(t.value[r].value);t.composed=t.constructed=!1,t.value=e.getBytes()}return t}s(hwe,"_decodePkcs7Data");function Odr(t,e,r,n){if(e=Se.fromDer(e,r),e.tagClass!==Se.Class.UNIVERSAL||e.type!==Se.Type.SEQUENCE||e.constructed!==!0)throw new Error("PKCS#12 AuthenticatedSafe expected to be a SEQUENCE OF ContentInfo");for(var i=0;i<e.value.length;i++){var o=e.value[i],a={},c=[];if(!Se.validate(o,Gct,a,c)){var l=new Error("Cannot read ContentInfo.");throw l.errors=c,l}var u={encrypted:!1},f=null,p=a.content.value[0];switch(Se.derToOid(a.contentType)){case Xi.oids.data:if(p.tagClass!==Se.Class.UNIVERSAL||p.type!==Se.Type.OCTETSTRING)throw new Error("PKCS#12 SafeContents Data is not an OCTET STRING.");f=hwe(p).value;break;case Xi.oids.encryptedData:f=Qdr(p,n),u.encrypted=!0;break;default:var l=new Error("Unsupported PKCS#12 contentType.");throw l.contentType=Se.derToOid(a.contentType),l}u.safeBags=Udr(f,r,n),t.safeContents.push(u)}}s(Odr,"_decodeAuthenticatedSafe");function Qdr(t,e){var r={},n=[];if(!Se.validate(t,js.pkcs7.asn1.encryptedDataValidator,r,n)){var i=new Error("Cannot read EncryptedContentInfo.");throw i.errors=n,i}var o=Se.derToOid(r.contentType);if(o!==Xi.oids.data){var i=new Error("PKCS#12 EncryptedContentInfo ContentType is not Data.");throw i.oid=o,i}o=Se.derToOid(r.encAlgorithm);var a=Xi.pbe.getCipher(o,r.encParameter,e),c=hwe(r.encryptedContentAsn1),l=js.util.createBuffer(c.value);if(a.update(l),!a.finish())throw new Error("Failed to decrypt PKCS#12 SafeContents.");return a.output.getBytes()}s(Qdr,"_decryptSafeContents");function Udr(t,e,r){if(!e&&t.length===0)return[];if(t=Se.fromDer(t,e),t.tagClass!==Se.Class.UNIVERSAL||t.type!==Se.Type.SEQUENCE||t.constructed!==!0)throw new Error("PKCS#12 SafeContents expected to be a SEQUENCE OF SafeBag.");for(var n=[],i=0;i<t.value.length;i++){var o=t.value[i],a={},c=[];if(!Se.validate(o,Mdr,a,c)){var l=new Error("Cannot read SafeBag.");throw l.errors=c,l}var u={type:Se.derToOid(a.bagId),attributes:qdr(a.bagAttributes)};n.push(u);var f,p,m=a.bagValue.value[0];switch(u.type){case Xi.oids.pkcs8ShroudedKeyBag:if(m=Xi.decryptPrivateKeyInfo(m,r),m===null)throw new Error("Unable to decrypt PKCS#8 ShroudedKeyBag, wrong password?");case Xi.oids.keyBag:try{u.key=Xi.privateKeyFromAsn1(m)}catch{u.key=null,u.asn1=m}continue;case Xi.oids.certBag:f=Fdr,p=s(function(){if(Se.derToOid(a.certId)!==Xi.oids.x509Certificate){var g=new Error("Unsupported certificate type, only X.509 supported.");throw g.oid=Se.derToOid(a.certId),g}var A=Se.fromDer(a.cert,e);try{u.cert=Xi.certificateFromAsn1(A,!0)}catch{u.cert=null,u.asn1=A}},"decoder");break;default:var l=new Error("Unsupported PKCS#12 SafeBag type.");throw l.oid=u.type,l}if(f!==void 0&&!Se.validate(m,f,a,c)){var l=new Error("Cannot read PKCS#12 "+f.name);throw l.errors=c,l}p()}return n}s(Udr,"_decodeSafeContents");function qdr(t){var e={};if(t!==void 0)for(var r=0;r<t.length;++r){var n={},i=[];if(!Se.validate(t[r],Ldr,n,i)){var o=new Error("Cannot read PKCS#12 BagAttribute.");throw o.errors=i,o}var a=Se.derToOid(n.oid);if(Xi.oids[a]!==void 0){e[Xi.oids[a]]=[];for(var c=0;c<n.values.length;++c)e[Xi.oids[a]].push(n.values[c].value)}}return e}s(qdr,"_decodeBagAttributes");JQ.toPkcs12Asn1=function(t,e,r,n){n=n||{},n.saltSize=n.saltSize||8,n.count=n.count||2048,n.algorithm=n.algorithm||n.encAlgorithm||"aes128","useMac"in n||(n.useMac=!0),"localKeyId"in n||(n.localKeyId=null),"generateLocalKeyId"in n||(n.generateLocalKeyId=!0);var i=n.localKeyId,o;if(i!==null)i=js.util.hexToBytes(i);else if(n.generateLocalKeyId)if(e){var a=js.util.isArray(e)?e[0]:e;typeof a=="string"&&(a=Xi.certificateFromPem(a));var c=js.md.sha1.create();c.update(Se.toDer(Xi.certificateToAsn1(a)).getBytes()),i=c.digest().getBytes()}else i=js.random.getBytes(20);var l=[];i!==null&&l.push(Se.create(Se.Class.UNIVERSAL,Se.Type.SEQUENCE,!0,[Se.create(Se.Class.UNIVERSAL,Se.Type.OID,!1,Se.oidToDer(Xi.oids.localKeyId).getBytes()),Se.create(Se.Class.UNIVERSAL,Se.Type.SET,!0,[Se.create(Se.Class.UNIVERSAL,Se.Type.OCTETSTRING,!1,i)])])),"friendlyName"in n&&l.push(Se.create(Se.Class.UNIVERSAL,Se.Type.SEQUENCE,!0,[Se.create(Se.Class.UNIVERSAL,Se.Type.OID,!1,Se.oidToDer(Xi.oids.friendlyName).getBytes()),Se.create(Se.Class.UNIVERSAL,Se.Type.SET,!0,[Se.create(Se.Class.UNIVERSAL,Se.Type.BMPSTRING,!1,n.friendlyName)])])),l.length>0&&(o=Se.create(Se.Class.UNIVERSAL,Se.Type.SET,!0,l));var u=[],f=[];e!==null&&(js.util.isArray(e)?f=e:f=[e]);for(var p=[],m=0;m<f.length;++m){e=f[m],typeof e=="string"&&(e=Xi.certificateFromPem(e));var h=m===0?o:void 0,g=Xi.certificateToAsn1(e),A=Se.create(Se.Class.UNIVERSAL,Se.Type.SEQUENCE,!0,[Se.create(Se.Class.UNIVERSAL,Se.Type.OID,!1,Se.oidToDer(Xi.oids.certBag).getBytes()),Se.create(Se.Class.CONTEXT_SPECIFIC,0,!0,[Se.create(Se.Class.UNIVERSAL,Se.Type.SEQUENCE,!0,[Se.create(Se.Class.UNIVERSAL,Se.Type.OID,!1,Se.oidToDer(Xi.oids.x509Certificate).getBytes()),Se.create(Se.Class.CONTEXT_SPECIFIC,0,!0,[Se.create(Se.Class.UNIVERSAL,Se.Type.OCTETSTRING,!1,Se.toDer(g).getBytes())])])]),h]);p.push(A)}if(p.length>0){var y=Se.create(Se.Class.UNIVERSAL,Se.Type.SEQUENCE,!0,p),E=Se.create(Se.Class.UNIVERSAL,Se.Type.SEQUENCE,!0,[Se.create(Se.Class.UNIVERSAL,Se.Type.OID,!1,Se.oidToDer(Xi.oids.data).getBytes()),Se.create(Se.Class.CONTEXT_SPECIFIC,0,!0,[Se.create(Se.Class.UNIVERSAL,Se.Type.OCTETSTRING,!1,Se.toDer(y).getBytes())])]);u.push(E)}var b=null;if(t!==null){var S=Xi.wrapRsaPrivateKey(Xi.privateKeyToAsn1(t));r===null?b=Se.create(Se.Class.UNIVERSAL,Se.Type.SEQUENCE,!0,[Se.create(Se.Class.UNIVERSAL,Se.Type.OID,!1,Se.oidToDer(Xi.oids.keyBag).getBytes()),Se.create(Se.Class.CONTEXT_SPECIFIC,0,!0,[S]),o]):b=Se.create(Se.Class.UNIVERSAL,Se.Type.SEQUENCE,!0,[Se.create(Se.Class.UNIVERSAL,Se.Type.OID,!1,Se.oidToDer(Xi.oids.pkcs8ShroudedKeyBag).getBytes()),Se.create(Se.Class.CONTEXT_SPECIFIC,0,!0,[Xi.encryptPrivateKeyInfo(S,r,n)]),o]);var R=Se.create(Se.Class.UNIVERSAL,Se.Type.SEQUENCE,!0,[b]),B=Se.create(Se.Class.UNIVERSAL,Se.Type.SEQUENCE,!0,[Se.create(Se.Class.UNIVERSAL,Se.Type.OID,!1,Se.oidToDer(Xi.oids.data).getBytes()),Se.create(Se.Class.CONTEXT_SPECIFIC,0,!0,[Se.create(Se.Class.UNIVERSAL,Se.Type.OCTETSTRING,!1,Se.toDer(R).getBytes())])]);u.push(B)}var L=Se.create(Se.Class.UNIVERSAL,Se.Type.SEQUENCE,!0,u),O;if(n.useMac){var c=js.md.sha1.create(),Y=new js.util.ByteBuffer(js.random.getBytes(n.saltSize)),V=n.count,t=JQ.generateKey(r,Y,3,V,20),z=js.hmac.create();z.start(c,t),z.update(Se.toDer(L).getBytes());var Q=z.getMac();O=Se.create(Se.Class.UNIVERSAL,Se.Type.SEQUENCE,!0,[Se.create(Se.Class.UNIVERSAL,Se.Type.SEQUENCE,!0,[Se.create(Se.Class.UNIVERSAL,Se.Type.SEQUENCE,!0,[Se.create(Se.Class.UNIVERSAL,Se.Type.OID,!1,Se.oidToDer(Xi.oids.sha1).getBytes()),Se.create(Se.Class.UNIVERSAL,Se.Type.NULL,!1,"")]),Se.create(Se.Class.UNIVERSAL,Se.Type.OCTETSTRING,!1,Q.getBytes())]),Se.create(Se.Class.UNIVERSAL,Se.Type.OCTETSTRING,!1,Y.getBytes()),Se.create(Se.Class.UNIVERSAL,Se.Type.INTEGER,!1,Se.integerToDer(V).getBytes())])}return Se.create(Se.Class.UNIVERSAL,Se.Type.SEQUENCE,!0,[Se.create(Se.Class.UNIVERSAL,Se.Type.INTEGER,!1,Se.integerToDer(3).getBytes()),Se.create(Se.Class.UNIVERSAL,Se.Type.SEQUENCE,!0,[Se.create(Se.Class.UNIVERSAL,Se.Type.OID,!1,Se.oidToDer(Xi.oids.data).getBytes()),Se.create(Se.Class.CONTEXT_SPECIFIC,0,!0,[Se.create(Se.Class.UNIVERSAL,Se.Type.OCTETSTRING,!1,Se.toDer(L).getBytes())])]),O])};JQ.generateKey=js.pbe.generatePkcs12Key});var ywe=H((KAi,zct)=>{d();var Iw=Ri();YA();vw();dwe();Ik();Fre();gwe();Wre();KQ();Ho();Vre();var Awe=Iw.asn1,JN=zct.exports=Iw.pki=Iw.pki||{};JN.pemToDer=function(t){var e=Iw.pem.decode(t)[0];if(e.procType&&e.procType.type==="ENCRYPTED")throw new Error("Could not convert PEM to DER; PEM is encrypted.");return Iw.util.createBuffer(e.body)};JN.privateKeyFromPem=function(t){var e=Iw.pem.decode(t)[0];if(e.type!=="PRIVATE KEY"&&e.type!=="RSA PRIVATE KEY"){var r=new Error('Could not convert private key from PEM; PEM header type is not "PRIVATE KEY" or "RSA PRIVATE KEY".');throw r.headerType=e.type,r}if(e.procType&&e.procType.type==="ENCRYPTED")throw new Error("Could not convert private key from PEM; PEM is encrypted.");var n=Awe.fromDer(e.body);return JN.privateKeyFromAsn1(n)};JN.privateKeyToPem=function(t,e){var r={type:"RSA PRIVATE KEY",body:Awe.toDer(JN.privateKeyToAsn1(t)).getBytes()};return Iw.pem.encode(r,{maxline:e})};JN.privateKeyInfoToPem=function(t,e){var r={type:"PRIVATE KEY",body:Awe.toDer(t).getBytes()};return Iw.pem.encode(r,{maxline:e})}});var Iwe=H((JAi,rlt)=>{d();var Pt=Ri();YA();$N();Bre();Ik();ywe();Gh();VN();Ho();var Jre=s(function(t,e,r,n){var i=Pt.util.createBuffer(),o=t.length>>1,a=o+(t.length&1),c=t.substr(0,a),l=t.substr(o,a),u=Pt.util.createBuffer(),f=Pt.hmac.create();r=e+r;var p=Math.ceil(n/16),m=Math.ceil(n/20);f.start("MD5",c);var h=Pt.util.createBuffer();u.putBytes(r);for(var g=0;g<p;++g)f.start(null,null),f.update(u.getBytes()),u.putBuffer(f.digest()),f.start(null,null),f.update(u.bytes()+r),h.putBuffer(f.digest());f.start("SHA1",l);var A=Pt.util.createBuffer();u.clear(),u.putBytes(r);for(var g=0;g<m;++g)f.start(null,null),f.update(u.getBytes()),u.putBuffer(f.digest()),f.start(null,null),f.update(u.bytes()+r),A.putBuffer(f.digest());return i.putBytes(Pt.util.xorBytes(h.getBytes(),A.getBytes(),n)),i},"prf_TLS1"),Hdr=s(function(t,e,r){var n=Pt.hmac.create();n.start("SHA1",t);var i=Pt.util.createBuffer();return i.putInt32(e[0]),i.putInt32(e[1]),i.putByte(r.type),i.putByte(r.version.major),i.putByte(r.version.minor),i.putInt16(r.length),i.putBytes(r.fragment.bytes()),n.update(i.getBytes()),n.digest().getBytes()},"hmac_sha1"),$dr=s(function(t,e,r){var n=!1;try{var i=t.deflate(e.fragment.getBytes());e.fragment=Pt.util.createBuffer(i),e.length=i.length,n=!0}catch{}return n},"deflate"),Wdr=s(function(t,e,r){var n=!1;try{var i=t.inflate(e.fragment.getBytes());e.fragment=Pt.util.createBuffer(i),e.length=i.length,n=!0}catch{}return n},"inflate"),om=s(function(t,e){var r=0;switch(e){case 1:r=t.getByte();break;case 2:r=t.getInt16();break;case 3:r=t.getInt24();break;case 4:r=t.getInt32();break}return Pt.util.createBuffer(t.getBytes(r))},"readVector"),Yh=s(function(t,e,r){t.putInt(r.length(),e<<3),t.putBuffer(r)},"writeVector"),se={};se.Versions={TLS_1_0:{major:3,minor:1},TLS_1_1:{major:3,minor:2},TLS_1_2:{major:3,minor:3}};se.SupportedVersions=[se.Versions.TLS_1_1,se.Versions.TLS_1_0];se.Version=se.SupportedVersions[0];se.MaxFragment=15360;se.ConnectionEnd={server:0,client:1};se.PRFAlgorithm={tls_prf_sha256:0};se.BulkCipherAlgorithm={none:null,rc4:0,des3:1,aes:2};se.CipherType={stream:0,block:1,aead:2};se.MACAlgorithm={none:null,hmac_md5:0,hmac_sha1:1,hmac_sha256:2,hmac_sha384:3,hmac_sha512:4};se.CompressionMethod={none:0,deflate:1};se.ContentType={change_cipher_spec:20,alert:21,handshake:22,application_data:23,heartbeat:24};se.HandshakeType={hello_request:0,client_hello:1,server_hello:2,certificate:11,server_key_exchange:12,certificate_request:13,server_hello_done:14,certificate_verify:15,client_key_exchange:16,finished:20};se.Alert={};se.Alert.Level={warning:1,fatal:2};se.Alert.Description={close_notify:0,unexpected_message:10,bad_record_mac:20,decryption_failed:21,record_overflow:22,decompression_failure:30,handshake_failure:40,bad_certificate:42,unsupported_certificate:43,certificate_revoked:44,certificate_expired:45,certificate_unknown:46,illegal_parameter:47,unknown_ca:48,access_denied:49,decode_error:50,decrypt_error:51,export_restriction:60,protocol_version:70,insufficient_security:71,internal_error:80,user_canceled:90,no_renegotiation:100};se.HeartbeatMessageType={heartbeat_request:1,heartbeat_response:2};se.CipherSuites={};se.getCipherSuite=function(t){var e=null;for(var r in se.CipherSuites){var n=se.CipherSuites[r];if(n.id[0]===t.charCodeAt(0)&&n.id[1]===t.charCodeAt(1)){e=n;break}}return e};se.handleUnexpected=function(t,e){var r=!t.open&&t.entity===se.ConnectionEnd.client;r||t.error(t,{message:"Unexpected message. Received TLS record out of order.",send:!0,alert:{level:se.Alert.Level.fatal,description:se.Alert.Description.unexpected_message}})};se.handleHelloRequest=function(t,e,r){!t.handshaking&&t.handshakes>0&&(se.queue(t,se.createAlert(t,{level:se.Alert.Level.warning,description:se.Alert.Description.no_renegotiation})),se.flush(t)),t.process()};se.parseHelloMessage=function(t,e,r){var n=null,i=t.entity===se.ConnectionEnd.client;if(r<38)t.error(t,{message:i?"Invalid ServerHello message. Message too short.":"Invalid ClientHello message. Message too short.",send:!0,alert:{level:se.Alert.Level.fatal,description:se.Alert.Description.illegal_parameter}});else{var o=e.fragment,a=o.length();if(n={version:{major:o.getByte(),minor:o.getByte()},random:Pt.util.createBuffer(o.getBytes(32)),session_id:om(o,1),extensions:[]},i?(n.cipher_suite=o.getBytes(2),n.compression_method=o.getByte()):(n.cipher_suites=om(o,2),n.compression_methods=om(o,1)),a=r-(a-o.length()),a>0){for(var c=om(o,2);c.length()>0;)n.extensions.push({type:[c.getByte(),c.getByte()],data:om(c,2)});if(!i)for(var l=0;l<n.extensions.length;++l){var u=n.extensions[l];if(u.type[0]===0&&u.type[1]===0)for(var f=om(u.data,2);f.length()>0;){var p=f.getByte();if(p!==0)break;t.session.extensions.server_name.serverNameList.push(om(f,2).getBytes())}}}if(t.session.version&&(n.version.major!==t.session.version.major||n.version.minor!==t.session.version.minor))return t.error(t,{message:"TLS version change is disallowed during renegotiation.",send:!0,alert:{level:se.Alert.Level.fatal,description:se.Alert.Description.protocol_version}});if(i)t.session.cipherSuite=se.getCipherSuite(n.cipher_suite);else for(var m=Pt.util.createBuffer(n.cipher_suites.bytes());m.length()>0&&(t.session.cipherSuite=se.getCipherSuite(m.getBytes(2)),t.session.cipherSuite===null););if(t.session.cipherSuite===null)return t.error(t,{message:"No cipher suites in common.",send:!0,alert:{level:se.Alert.Level.fatal,description:se.Alert.Description.handshake_failure},cipherSuite:Pt.util.bytesToHex(n.cipher_suite)});i?t.session.compressionMethod=n.compression_method:t.session.compressionMethod=se.CompressionMethod.none}return n};se.createSecurityParameters=function(t,e){var r=t.entity===se.ConnectionEnd.client,n=e.random.bytes(),i=r?t.session.sp.client_random:n,o=r?n:se.createRandom().getBytes();t.session.sp={entity:t.entity,prf_algorithm:se.PRFAlgorithm.tls_prf_sha256,bulk_cipher_algorithm:null,cipher_type:null,enc_key_length:null,block_length:null,fixed_iv_length:null,record_iv_length:null,mac_algorithm:null,mac_length:null,mac_key_length:null,compression_algorithm:t.session.compressionMethod,pre_master_secret:null,master_secret:null,client_random:i,server_random:o}};se.handleServerHello=function(t,e,r){var n=se.parseHelloMessage(t,e,r);if(!t.fail){if(n.version.minor<=t.version.minor)t.version.minor=n.version.minor;else return t.error(t,{message:"Incompatible TLS version.",send:!0,alert:{level:se.Alert.Level.fatal,description:se.Alert.Description.protocol_version}});t.session.version=t.version;var i=n.session_id.bytes();i.length>0&&i===t.session.id?(t.expect=Jct,t.session.resuming=!0,t.session.sp.server_random=n.random.bytes()):(t.expect=Gdr,t.session.resuming=!1,se.createSecurityParameters(t,n)),t.session.id=i,t.process()}};se.handleClientHello=function(t,e,r){var n=se.parseHelloMessage(t,e,r);if(!t.fail){var i=n.session_id.bytes(),o=null;if(t.sessionCache&&(o=t.sessionCache.getSession(i),o===null?i="":(o.version.major!==n.version.major||o.version.minor>n.version.minor)&&(o=null,i="")),i.length===0&&(i=Pt.random.getBytes(32)),t.session.id=i,t.session.clientHelloVersion=n.version,t.session.sp={},o)t.version=t.session.version=o.version,t.session.sp=o.sp;else{for(var a,c=1;c<se.SupportedVersions.length&&(a=se.SupportedVersions[c],!(a.minor<=n.version.minor));++c);t.version={major:a.major,minor:a.minor},t.session.version=t.version}o!==null?(t.expect=Ewe,t.session.resuming=!0,t.session.sp.client_random=n.random.bytes()):(t.expect=t.verifyClient!==!1?Zdr:xwe,t.session.resuming=!1,se.createSecurityParameters(t,n)),t.open=!0,se.queue(t,se.createRecord(t,{type:se.ContentType.handshake,data:se.createServerHello(t)})),t.session.resuming?(se.queue(t,se.createRecord(t,{type:se.ContentType.change_cipher_spec,data:se.createChangeCipherSpec()})),t.state.pending=se.createConnectionState(t),t.state.current.write=t.state.pending.write,se.queue(t,se.createRecord(t,{type:se.ContentType.handshake,data:se.createFinished(t)}))):(se.queue(t,se.createRecord(t,{type:se.ContentType.handshake,data:se.createCertificate(t)})),t.fail||(se.queue(t,se.createRecord(t,{type:se.ContentType.handshake,data:se.createServerKeyExchange(t)})),t.verifyClient!==!1&&se.queue(t,se.createRecord(t,{type:se.ContentType.handshake,data:se.createCertificateRequest(t)})),se.queue(t,se.createRecord(t,{type:se.ContentType.handshake,data:se.createServerHelloDone(t)})))),se.flush(t),t.process()}};se.handleCertificate=function(t,e,r){if(r<3)return t.error(t,{message:"Invalid Certificate message. Message too short.",send:!0,alert:{level:se.Alert.Level.fatal,description:se.Alert.Description.illegal_parameter}});var n=e.fragment,i={certificate_list:om(n,3)},o,a,c=[];try{for(;i.certificate_list.length()>0;)o=om(i.certificate_list,3),a=Pt.asn1.fromDer(o),o=Pt.pki.certificateFromAsn1(a,!0),c.push(o)}catch(u){return t.error(t,{message:"Could not parse certificate list.",cause:u,send:!0,alert:{level:se.Alert.Level.fatal,description:se.Alert.Description.bad_certificate}})}var l=t.entity===se.ConnectionEnd.client;(l||t.verifyClient===!0)&&c.length===0?t.error(t,{message:l?"No server certificate provided.":"No client certificate provided.",send:!0,alert:{level:se.Alert.Level.fatal,description:se.Alert.Description.illegal_parameter}}):c.length===0?t.expect=l?Kct:xwe:(l?t.session.serverCertificate=c[0]:t.session.clientCertificate=c[0],se.verifyCertificateChain(t,c)&&(t.expect=l?Kct:xwe)),t.process()};se.handleServerKeyExchange=function(t,e,r){if(r>0)return t.error(t,{message:"Invalid key parameters. Only RSA is supported.",send:!0,alert:{level:se.Alert.Level.fatal,description:se.Alert.Description.unsupported_certificate}});t.expect=Vdr,t.process()};se.handleClientKeyExchange=function(t,e,r){if(r<48)return t.error(t,{message:"Invalid key parameters. Only RSA is supported.",send:!0,alert:{level:se.Alert.Level.fatal,description:se.Alert.Description.unsupported_certificate}});var n=e.fragment,i={enc_pre_master_secret:om(n,2).getBytes()},o=null;if(t.getPrivateKey)try{o=t.getPrivateKey(t,t.session.serverCertificate),o=Pt.pki.privateKeyFromPem(o)}catch(l){t.error(t,{message:"Could not get private key.",cause:l,send:!0,alert:{level:se.Alert.Level.fatal,description:se.Alert.Description.internal_error}})}if(o===null)return t.error(t,{message:"No private key set.",send:!0,alert:{level:se.Alert.Level.fatal,description:se.Alert.Description.internal_error}});try{var a=t.session.sp;a.pre_master_secret=o.decrypt(i.enc_pre_master_secret);var c=t.session.clientHelloVersion;if(c.major!==a.pre_master_secret.charCodeAt(0)||c.minor!==a.pre_master_secret.charCodeAt(1))throw new Error("TLS version rollback attack detected.")}catch{a.pre_master_secret=Pt.random.getBytes(48)}t.expect=Ewe,t.session.clientCertificate!==null&&(t.expect=efr),t.process()};se.handleCertificateRequest=function(t,e,r){if(r<3)return t.error(t,{message:"Invalid CertificateRequest. Message too short.",send:!0,alert:{level:se.Alert.Level.fatal,description:se.Alert.Description.illegal_parameter}});var n=e.fragment,i={certificate_types:om(n,1),certificate_authorities:om(n,2)};t.session.certificateRequest=i,t.expect=zdr,t.process()};se.handleCertificateVerify=function(t,e,r){if(r<2)return t.error(t,{message:"Invalid CertificateVerify. Message too short.",send:!0,alert:{level:se.Alert.Level.fatal,description:se.Alert.Description.illegal_parameter}});var n=e.fragment;n.read-=4;var i=n.bytes();n.read+=4;var o={signature:om(n,2).getBytes()},a=Pt.util.createBuffer();a.putBuffer(t.session.md5.digest()),a.putBuffer(t.session.sha1.digest()),a=a.getBytes();try{var c=t.session.clientCertificate;if(!c.publicKey.verify(a,o.signature,"NONE"))throw new Error("CertificateVerify signature does not match.");t.session.md5.update(i),t.session.sha1.update(i)}catch{return t.error(t,{message:"Bad signature in CertificateVerify.",send:!0,alert:{level:se.Alert.Level.fatal,description:se.Alert.Description.handshake_failure}})}t.expect=Ewe,t.process()};se.handleServerHelloDone=function(t,e,r){if(r>0)return t.error(t,{message:"Invalid ServerHelloDone message. Invalid length.",send:!0,alert:{level:se.Alert.Level.fatal,description:se.Alert.Description.record_overflow}});if(t.serverCertificate===null){var n={message:"No server certificate provided. Not enough security.",send:!0,alert:{level:se.Alert.Level.fatal,description:se.Alert.Description.insufficient_security}},i=0,o=t.verify(t,n.alert.description,i,[]);if(o!==!0)return(o||o===0)&&(typeof o=="object"&&!Pt.util.isArray(o)?(o.message&&(n.message=o.message),o.alert&&(n.alert.description=o.alert)):typeof o=="number"&&(n.alert.description=o)),t.error(t,n)}t.session.certificateRequest!==null&&(e=se.createRecord(t,{type:se.ContentType.handshake,data:se.createCertificate(t)}),se.queue(t,e)),e=se.createRecord(t,{type:se.ContentType.handshake,data:se.createClientKeyExchange(t)}),se.queue(t,e),t.expect=Jdr;var a=s(function(c,l){c.session.certificateRequest!==null&&c.session.clientCertificate!==null&&se.queue(c,se.createRecord(c,{type:se.ContentType.handshake,data:se.createCertificateVerify(c,l)})),se.queue(c,se.createRecord(c,{type:se.ContentType.change_cipher_spec,data:se.createChangeCipherSpec()})),c.state.pending=se.createConnectionState(c),c.state.current.write=c.state.pending.write,se.queue(c,se.createRecord(c,{type:se.ContentType.handshake,data:se.createFinished(c)})),c.expect=Jct,se.flush(c),c.process()},"callback");if(t.session.certificateRequest===null||t.session.clientCertificate===null)return a(t,null);se.getClientSignature(t,a)};se.handleChangeCipherSpec=function(t,e){if(e.fragment.getByte()!==1)return t.error(t,{message:"Invalid ChangeCipherSpec message received.",send:!0,alert:{level:se.Alert.Level.fatal,description:se.Alert.Description.illegal_parameter}});var r=t.entity===se.ConnectionEnd.client;(t.session.resuming&&r||!t.session.resuming&&!r)&&(t.state.pending=se.createConnectionState(t)),t.state.current.read=t.state.pending.read,(!t.session.resuming&&r||t.session.resuming&&!r)&&(t.state.pending=null),t.expect=r?Kdr:tfr,t.process()};se.handleFinished=function(t,e,r){var n=e.fragment;n.read-=4;var i=n.bytes();n.read+=4;var o=e.fragment.getBytes();n=Pt.util.createBuffer(),n.putBuffer(t.session.md5.digest()),n.putBuffer(t.session.sha1.digest());var a=t.entity===se.ConnectionEnd.client,c=a?"server finished":"client finished",l=t.session.sp,u=12,f=Jre;if(n=f(l.master_secret,c,n.getBytes(),u),n.getBytes()!==o)return t.error(t,{message:"Invalid verify_data in Finished message.",send:!0,alert:{level:se.Alert.Level.fatal,description:se.Alert.Description.decrypt_error}});t.session.md5.update(i),t.session.sha1.update(i),(t.session.resuming&&a||!t.session.resuming&&!a)&&(se.queue(t,se.createRecord(t,{type:se.ContentType.change_cipher_spec,data:se.createChangeCipherSpec()})),t.state.current.write=t.state.pending.write,t.state.pending=null,se.queue(t,se.createRecord(t,{type:se.ContentType.handshake,data:se.createFinished(t)}))),t.expect=a?Ydr:rfr,t.handshaking=!1,++t.handshakes,t.peerCertificate=a?t.session.serverCertificate:t.session.clientCertificate,se.flush(t),t.isConnected=!0,t.connected(t),t.process()};se.handleAlert=function(t,e){var r=e.fragment,n={level:r.getByte(),description:r.getByte()},i;switch(n.description){case se.Alert.Description.close_notify:i="Connection closed.";break;case se.Alert.Description.unexpected_message:i="Unexpected message.";break;case se.Alert.Description.bad_record_mac:i="Bad record MAC.";break;case se.Alert.Description.decryption_failed:i="Decryption failed.";break;case se.Alert.Description.record_overflow:i="Record overflow.";break;case se.Alert.Description.decompression_failure:i="Decompression failed.";break;case se.Alert.Description.handshake_failure:i="Handshake failure.";break;case se.Alert.Description.bad_certificate:i="Bad certificate.";break;case se.Alert.Description.unsupported_certificate:i="Unsupported certificate.";break;case se.Alert.Description.certificate_revoked:i="Certificate revoked.";break;case se.Alert.Description.certificate_expired:i="Certificate expired.";break;case se.Alert.Description.certificate_unknown:i="Certificate unknown.";break;case se.Alert.Description.illegal_parameter:i="Illegal parameter.";break;case se.Alert.Description.unknown_ca:i="Unknown certificate authority.";break;case se.Alert.Description.access_denied:i="Access denied.";break;case se.Alert.Description.decode_error:i="Decode error.";break;case se.Alert.Description.decrypt_error:i="Decrypt error.";break;case se.Alert.Description.export_restriction:i="Export restriction.";break;case se.Alert.Description.protocol_version:i="Unsupported protocol version.";break;case se.Alert.Description.insufficient_security:i="Insufficient security.";break;case se.Alert.Description.internal_error:i="Internal error.";break;case se.Alert.Description.user_canceled:i="User canceled.";break;case se.Alert.Description.no_renegotiation:i="Renegotiation not supported.";break;default:i="Unknown error.";break}if(n.description===se.Alert.Description.close_notify)return t.close();t.error(t,{message:i,send:!1,origin:t.entity===se.ConnectionEnd.client?"server":"client",alert:n}),t.process()};se.handleHandshake=function(t,e){var r=e.fragment,n=r.getByte(),i=r.getInt24();if(i>r.length())return t.fragmented=e,e.fragment=Pt.util.createBuffer(),r.read-=4,t.process();t.fragmented=null,r.read-=4;var o=r.bytes(i+4);r.read+=4,n in Yre[t.entity][t.expect]?(t.entity===se.ConnectionEnd.server&&!t.open&&!t.fail&&(t.handshaking=!0,t.session={version:null,extensions:{server_name:{serverNameList:[]}},cipherSuite:null,compressionMethod:null,serverCertificate:null,clientCertificate:null,md5:Pt.md.md5.create(),sha1:Pt.md.sha1.create()}),n!==se.HandshakeType.hello_request&&n!==se.HandshakeType.certificate_verify&&n!==se.HandshakeType.finished&&(t.session.md5.update(o),t.session.sha1.update(o)),Yre[t.entity][t.expect][n](t,e,i)):se.handleUnexpected(t,e)};se.handleApplicationData=function(t,e){t.data.putBuffer(e.fragment),t.dataReady(t),t.process()};se.handleHeartbeat=function(t,e){var r=e.fragment,n=r.getByte(),i=r.getInt16(),o=r.getBytes(i);if(n===se.HeartbeatMessageType.heartbeat_request){if(t.handshaking||i>o.length)return t.process();se.queue(t,se.createRecord(t,{type:se.ContentType.heartbeat,data:se.createHeartbeat(se.HeartbeatMessageType.heartbeat_response,o)})),se.flush(t)}else if(n===se.HeartbeatMessageType.heartbeat_response){if(o!==t.expectedHeartbeatPayload)return t.process();t.heartbeatReceived&&t.heartbeatReceived(t,Pt.util.createBuffer(o))}t.process()};var jdr=0,Gdr=1,Kct=2,Vdr=3,zdr=4,Jct=5,Kdr=6,Ydr=7,Jdr=8,Xdr=0,Zdr=1,xwe=2,efr=3,Ewe=4,tfr=5,rfr=6,ie=se.handleUnexpected,Xct=se.handleChangeCipherSpec,id=se.handleAlert,Of=se.handleHandshake,Zct=se.handleApplicationData,od=se.handleHeartbeat,bwe=[];bwe[se.ConnectionEnd.client]=[[ie,id,Of,ie,od],[ie,id,Of,ie,od],[ie,id,Of,ie,od],[ie,id,Of,ie,od],[ie,id,Of,ie,od],[Xct,id,ie,ie,od],[ie,id,Of,ie,od],[ie,id,Of,Zct,od],[ie,id,Of,ie,od]];bwe[se.ConnectionEnd.server]=[[ie,id,Of,ie,od],[ie,id,Of,ie,od],[ie,id,Of,ie,od],[ie,id,Of,ie,od],[Xct,id,ie,ie,od],[ie,id,Of,ie,od],[ie,id,Of,Zct,od],[ie,id,Of,ie,od]];var Tw=se.handleHelloRequest,nfr=se.handleServerHello,elt=se.handleCertificate,Yct=se.handleServerKeyExchange,Cwe=se.handleCertificateRequest,zre=se.handleServerHelloDone,tlt=se.handleFinished,Yre=[];Yre[se.ConnectionEnd.client]=[[ie,ie,nfr,ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,ie],[Tw,ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,elt,Yct,Cwe,zre,ie,ie,ie,ie,ie,ie],[Tw,ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,Yct,Cwe,zre,ie,ie,ie,ie,ie,ie],[Tw,ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,Cwe,zre,ie,ie,ie,ie,ie,ie],[Tw,ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,zre,ie,ie,ie,ie,ie,ie],[Tw,ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,ie],[Tw,ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,tlt],[Tw,ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,ie],[Tw,ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,ie]];var ifr=se.handleClientHello,ofr=se.handleClientKeyExchange,sfr=se.handleCertificateVerify;Yre[se.ConnectionEnd.server]=[[ie,ifr,ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,ie],[ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,elt,ie,ie,ie,ie,ie,ie,ie,ie,ie],[ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,ofr,ie,ie,ie,ie],[ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,sfr,ie,ie,ie,ie,ie],[ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,ie],[ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,tlt],[ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,ie],[ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,ie]];se.generateKeys=function(t,e){var r=Jre,n=e.client_random+e.server_random;t.session.resuming||(e.master_secret=r(e.pre_master_secret,"master secret",n,48).bytes(),e.pre_master_secret=null),n=e.server_random+e.client_random;var i=2*e.mac_key_length+2*e.enc_key_length,o=t.version.major===se.Versions.TLS_1_0.major&&t.version.minor===se.Versions.TLS_1_0.minor;o&&(i+=2*e.fixed_iv_length);var a=r(e.master_secret,"key expansion",n,i),c={client_write_MAC_key:a.getBytes(e.mac_key_length),server_write_MAC_key:a.getBytes(e.mac_key_length),client_write_key:a.getBytes(e.enc_key_length),server_write_key:a.getBytes(e.enc_key_length)};return o&&(c.client_write_IV=a.getBytes(e.fixed_iv_length),c.server_write_IV=a.getBytes(e.fixed_iv_length)),c};se.createConnectionState=function(t){var e=t.entity===se.ConnectionEnd.client,r=s(function(){var o={sequenceNumber:[0,0],macKey:null,macLength:0,macFunction:null,cipherState:null,cipherFunction:s(function(a){return!0},"cipherFunction"),compressionState:null,compressFunction:s(function(a){return!0},"compressFunction"),updateSequenceNumber:s(function(){o.sequenceNumber[1]===4294967295?(o.sequenceNumber[1]=0,++o.sequenceNumber[0]):++o.sequenceNumber[1]},"updateSequenceNumber")};return o},"createMode"),n={read:r(),write:r()};if(n.read.update=function(o,a){return n.read.cipherFunction(a,n.read)?n.read.compressFunction(o,a,n.read)||o.error(o,{message:"Could not decompress record.",send:!0,alert:{level:se.Alert.Level.fatal,description:se.Alert.Description.decompression_failure}}):o.error(o,{message:"Could not decrypt record or bad MAC.",send:!0,alert:{level:se.Alert.Level.fatal,description:se.Alert.Description.bad_record_mac}}),!o.fail},n.write.update=function(o,a){return n.write.compressFunction(o,a,n.write)?n.write.cipherFunction(a,n.write)||o.error(o,{message:"Could not encrypt record.",send:!1,alert:{level:se.Alert.Level.fatal,description:se.Alert.Description.internal_error}}):o.error(o,{message:"Could not compress record.",send:!1,alert:{level:se.Alert.Level.fatal,description:se.Alert.Description.internal_error}}),!o.fail},t.session){var i=t.session.sp;switch(t.session.cipherSuite.initSecurityParameters(i),i.keys=se.generateKeys(t,i),n.read.macKey=e?i.keys.server_write_MAC_key:i.keys.client_write_MAC_key,n.write.macKey=e?i.keys.client_write_MAC_key:i.keys.server_write_MAC_key,t.session.cipherSuite.initConnectionState(n,t,i),i.compression_algorithm){case se.CompressionMethod.none:break;case se.CompressionMethod.deflate:n.read.compressFunction=Wdr,n.write.compressFunction=$dr;break;default:throw new Error("Unsupported compression algorithm.")}}return n};se.createRandom=function(){var t=new Date,e=+t+t.getTimezoneOffset()*6e4,r=Pt.util.createBuffer();return r.putInt32(e),r.putBytes(Pt.random.getBytes(28)),r};se.createRecord=function(t,e){if(!e.data)return null;var r={type:e.type,version:{major:t.version.major,minor:t.version.minor},length:e.data.length(),fragment:e.data};return r};se.createAlert=function(t,e){var r=Pt.util.createBuffer();return r.putByte(e.level),r.putByte(e.description),se.createRecord(t,{type:se.ContentType.alert,data:r})};se.createClientHello=function(t){t.session.clientHelloVersion={major:t.version.major,minor:t.version.minor};for(var e=Pt.util.createBuffer(),r=0;r<t.cipherSuites.length;++r){var n=t.cipherSuites[r];e.putByte(n.id[0]),e.putByte(n.id[1])}var i=e.length(),o=Pt.util.createBuffer();o.putByte(se.CompressionMethod.none);var a=o.length(),c=Pt.util.createBuffer();if(t.virtualHost){var l=Pt.util.createBuffer();l.putByte(0),l.putByte(0);var u=Pt.util.createBuffer();u.putByte(0),Yh(u,2,Pt.util.createBuffer(t.virtualHost));var f=Pt.util.createBuffer();Yh(f,2,u),Yh(l,2,f),c.putBuffer(l)}var p=c.length();p>0&&(p+=2);var m=t.session.id,h=m.length+1+2+4+28+2+i+1+a+p,g=Pt.util.createBuffer();return g.putByte(se.HandshakeType.client_hello),g.putInt24(h),g.putByte(t.version.major),g.putByte(t.version.minor),g.putBytes(t.session.sp.client_random),Yh(g,1,Pt.util.createBuffer(m)),Yh(g,2,e),Yh(g,1,o),p>0&&Yh(g,2,c),g};se.createServerHello=function(t){var e=t.session.id,r=e.length+1+2+4+28+2+1,n=Pt.util.createBuffer();return n.putByte(se.HandshakeType.server_hello),n.putInt24(r),n.putByte(t.version.major),n.putByte(t.version.minor),n.putBytes(t.session.sp.server_random),Yh(n,1,Pt.util.createBuffer(e)),n.putByte(t.session.cipherSuite.id[0]),n.putByte(t.session.cipherSuite.id[1]),n.putByte(t.session.compressionMethod),n};se.createCertificate=function(t){var e=t.entity===se.ConnectionEnd.client,r=null;if(t.getCertificate){var n;e?n=t.session.certificateRequest:n=t.session.extensions.server_name.serverNameList,r=t.getCertificate(t,n)}var i=Pt.util.createBuffer();if(r!==null)try{Pt.util.isArray(r)||(r=[r]);for(var o=null,a=0;a<r.length;++a){var c=Pt.pem.decode(r[a])[0];if(c.type!=="CERTIFICATE"&&c.type!=="X509 CERTIFICATE"&&c.type!=="TRUSTED CERTIFICATE"){var l=new Error('Could not convert certificate from PEM; PEM header type is not "CERTIFICATE", "X509 CERTIFICATE", or "TRUSTED CERTIFICATE".');throw l.headerType=c.type,l}if(c.procType&&c.procType.type==="ENCRYPTED")throw new Error("Could not convert certificate from PEM; PEM is encrypted.");var u=Pt.util.createBuffer(c.body);o===null&&(o=Pt.asn1.fromDer(u.bytes(),!1));var f=Pt.util.createBuffer();Yh(f,3,u),i.putBuffer(f)}r=Pt.pki.certificateFromAsn1(o),e?t.session.clientCertificate=r:t.session.serverCertificate=r}catch(h){return t.error(t,{message:"Could not send certificate list.",cause:h,send:!0,alert:{level:se.Alert.Level.fatal,description:se.Alert.Description.bad_certificate}})}var p=3+i.length(),m=Pt.util.createBuffer();return m.putByte(se.HandshakeType.certificate),m.putInt24(p),Yh(m,3,i),m};se.createClientKeyExchange=function(t){var e=Pt.util.createBuffer();e.putByte(t.session.clientHelloVersion.major),e.putByte(t.session.clientHelloVersion.minor),e.putBytes(Pt.random.getBytes(46));var r=t.session.sp;r.pre_master_secret=e.getBytes();var n=t.session.serverCertificate.publicKey;e=n.encrypt(r.pre_master_secret);var i=e.length+2,o=Pt.util.createBuffer();return o.putByte(se.HandshakeType.client_key_exchange),o.putInt24(i),o.putInt16(e.length),o.putBytes(e),o};se.createServerKeyExchange=function(t){var e=0,r=Pt.util.createBuffer();return e>0&&(r.putByte(se.HandshakeType.server_key_exchange),r.putInt24(e)),r};se.getClientSignature=function(t,e){var r=Pt.util.createBuffer();r.putBuffer(t.session.md5.digest()),r.putBuffer(t.session.sha1.digest()),r=r.getBytes(),t.getSignature=t.getSignature||function(n,i,o){var a=null;if(n.getPrivateKey)try{a=n.getPrivateKey(n,n.session.clientCertificate),a=Pt.pki.privateKeyFromPem(a)}catch(c){n.error(n,{message:"Could not get private key.",cause:c,send:!0,alert:{level:se.Alert.Level.fatal,description:se.Alert.Description.internal_error}})}a===null?n.error(n,{message:"No private key set.",send:!0,alert:{level:se.Alert.Level.fatal,description:se.Alert.Description.internal_error}}):i=a.sign(i,null),o(n,i)},t.getSignature(t,r,e)};se.createCertificateVerify=function(t,e){var r=e.length+2,n=Pt.util.createBuffer();return n.putByte(se.HandshakeType.certificate_verify),n.putInt24(r),n.putInt16(e.length),n.putBytes(e),n};se.createCertificateRequest=function(t){var e=Pt.util.createBuffer();e.putByte(1);var r=Pt.util.createBuffer();for(var n in t.caStore.certs){var i=t.caStore.certs[n],o=Pt.pki.distinguishedNameToAsn1(i.subject),a=Pt.asn1.toDer(o);r.putInt16(a.length()),r.putBuffer(a)}var c=1+e.length()+2+r.length(),l=Pt.util.createBuffer();return l.putByte(se.HandshakeType.certificate_request),l.putInt24(c),Yh(l,1,e),Yh(l,2,r),l};se.createServerHelloDone=function(t){var e=Pt.util.createBuffer();return e.putByte(se.HandshakeType.server_hello_done),e.putInt24(0),e};se.createChangeCipherSpec=function(){var t=Pt.util.createBuffer();return t.putByte(1),t};se.createFinished=function(t){var e=Pt.util.createBuffer();e.putBuffer(t.session.md5.digest()),e.putBuffer(t.session.sha1.digest());var r=t.entity===se.ConnectionEnd.client,n=t.session.sp,i=12,o=Jre,a=r?"client finished":"server finished";e=o(n.master_secret,a,e.getBytes(),i);var c=Pt.util.createBuffer();return c.putByte(se.HandshakeType.finished),c.putInt24(e.length()),c.putBuffer(e),c};se.createHeartbeat=function(t,e,r){typeof r>"u"&&(r=e.length);var n=Pt.util.createBuffer();n.putByte(t),n.putInt16(r),n.putBytes(e);var i=n.length(),o=Math.max(16,i-r-3);return n.putBytes(Pt.random.getBytes(o)),n};se.queue=function(t,e){if(e&&!(e.fragment.length()===0&&(e.type===se.ContentType.handshake||e.type===se.ContentType.alert||e.type===se.ContentType.change_cipher_spec))){if(e.type===se.ContentType.handshake){var r=e.fragment.bytes();t.session.md5.update(r),t.session.sha1.update(r),r=null}var n;if(e.fragment.length()<=se.MaxFragment)n=[e];else{n=[];for(var i=e.fragment.bytes();i.length>se.MaxFragment;)n.push(se.createRecord(t,{type:e.type,data:Pt.util.createBuffer(i.slice(0,se.MaxFragment))})),i=i.slice(se.MaxFragment);i.length>0&&n.push(se.createRecord(t,{type:e.type,data:Pt.util.createBuffer(i)}))}for(var o=0;o<n.length&&!t.fail;++o){var a=n[o],c=t.state.current.write;c.update(t,a)&&t.records.push(a)}}};se.flush=function(t){for(var e=0;e<t.records.length;++e){var r=t.records[e];t.tlsData.putByte(r.type),t.tlsData.putByte(r.version.major),t.tlsData.putByte(r.version.minor),t.tlsData.putInt16(r.fragment.length()),t.tlsData.putBuffer(t.records[e].fragment)}return t.records=[],t.tlsDataReady(t)};var vwe=s(function(t){switch(t){case!0:return!0;case Pt.pki.certificateError.bad_certificate:return se.Alert.Description.bad_certificate;case Pt.pki.certificateError.unsupported_certificate:return se.Alert.Description.unsupported_certificate;case Pt.pki.certificateError.certificate_revoked:return se.Alert.Description.certificate_revoked;case Pt.pki.certificateError.certificate_expired:return se.Alert.Description.certificate_expired;case Pt.pki.certificateError.certificate_unknown:return se.Alert.Description.certificate_unknown;case Pt.pki.certificateError.unknown_ca:return se.Alert.Description.unknown_ca;default:return se.Alert.Description.bad_certificate}},"_certErrorToAlertDesc"),afr=s(function(t){switch(t){case!0:return!0;case se.Alert.Description.bad_certificate:return Pt.pki.certificateError.bad_certificate;case se.Alert.Description.unsupported_certificate:return Pt.pki.certificateError.unsupported_certificate;case se.Alert.Description.certificate_revoked:return Pt.pki.certificateError.certificate_revoked;case se.Alert.Description.certificate_expired:return Pt.pki.certificateError.certificate_expired;case se.Alert.Description.certificate_unknown:return Pt.pki.certificateError.certificate_unknown;case se.Alert.Description.unknown_ca:return Pt.pki.certificateError.unknown_ca;default:return Pt.pki.certificateError.bad_certificate}},"_alertDescToCertError");se.verifyCertificateChain=function(t,e){try{var r={};for(var n in t.verifyOptions)r[n]=t.verifyOptions[n];r.verify=function(o,a,c){var l=vwe(o),u=t.verify(t,o,a,c);if(u!==!0){if(typeof u=="object"&&!Pt.util.isArray(u)){var f=new Error("The application rejected the certificate.");throw f.send=!0,f.alert={level:se.Alert.Level.fatal,description:se.Alert.Description.bad_certificate},u.message&&(f.message=u.message),u.alert&&(f.alert.description=u.alert),f}u!==o&&(u=afr(u))}return u},Pt.pki.verifyCertificateChain(t.caStore,e,r)}catch(o){var i=o;(typeof i!="object"||Pt.util.isArray(i))&&(i={send:!0,alert:{level:se.Alert.Level.fatal,description:vwe(o)}}),"send"in i||(i.send=!0),"alert"in i||(i.alert={level:se.Alert.Level.fatal,description:vwe(i.error)}),t.error(t,i)}return!t.fail};se.createSessionCache=function(t,e){var r=null;if(t&&t.getSession&&t.setSession&&t.order)r=t;else{r={},r.cache=t||{},r.capacity=Math.max(e||100,1),r.order=[];for(var n in t)r.order.length<=e?r.order.push(n):delete t[n];r.getSession=function(i){var o=null,a=null;if(i?a=Pt.util.bytesToHex(i):r.order.length>0&&(a=r.order[0]),a!==null&&a in r.cache){o=r.cache[a],delete r.cache[a];for(var c in r.order)if(r.order[c]===a){r.order.splice(c,1);break}}return o},r.setSession=function(i,o){if(r.order.length===r.capacity){var a=r.order.shift();delete r.cache[a]}var a=Pt.util.bytesToHex(i);r.order.push(a),r.cache[a]=o}}return r};se.createConnection=function(t){var e=null;t.caStore?Pt.util.isArray(t.caStore)?e=Pt.pki.createCaStore(t.caStore):e=t.caStore:e=Pt.pki.createCaStore();var r=t.cipherSuites||null;if(r===null){r=[];for(var n in se.CipherSuites)r.push(se.CipherSuites[n])}var i=t.server?se.ConnectionEnd.server:se.ConnectionEnd.client,o=t.sessionCache?se.createSessionCache(t.sessionCache):null,a={version:{major:se.Version.major,minor:se.Version.minor},entity:i,sessionId:t.sessionId,caStore:e,sessionCache:o,cipherSuites:r,connected:t.connected,virtualHost:t.virtualHost||null,verifyClient:t.verifyClient||!1,verify:t.verify||function(f,p,m,h){return p},verifyOptions:t.verifyOptions||{},getCertificate:t.getCertificate||null,getPrivateKey:t.getPrivateKey||null,getSignature:t.getSignature||null,input:Pt.util.createBuffer(),tlsData:Pt.util.createBuffer(),data:Pt.util.createBuffer(),tlsDataReady:t.tlsDataReady,dataReady:t.dataReady,heartbeatReceived:t.heartbeatReceived,closed:t.closed,error:s(function(f,p){p.origin=p.origin||(f.entity===se.ConnectionEnd.client?"client":"server"),p.send&&(se.queue(f,se.createAlert(f,p.alert)),se.flush(f));var m=p.fatal!==!1;m&&(f.fail=!0),t.error(f,p),m&&f.close(!1)},"error"),deflate:t.deflate||null,inflate:t.inflate||null};a.reset=function(f){a.version={major:se.Version.major,minor:se.Version.minor},a.record=null,a.session=null,a.peerCertificate=null,a.state={pending:null,current:null},a.expect=a.entity===se.ConnectionEnd.client?jdr:Xdr,a.fragmented=null,a.records=[],a.open=!1,a.handshakes=0,a.handshaking=!1,a.isConnected=!1,a.fail=!(f||typeof f>"u"),a.input.clear(),a.tlsData.clear(),a.data.clear(),a.state.current=se.createConnectionState(a)},a.reset();var c=s(function(f,p){var m=p.type-se.ContentType.change_cipher_spec,h=bwe[f.entity][f.expect];m in h?h[m](f,p):se.handleUnexpected(f,p)},"_update"),l=s(function(f){var p=0,m=f.input,h=m.length();if(h<5)p=5-h;else{f.record={type:m.getByte(),version:{major:m.getByte(),minor:m.getByte()},length:m.getInt16(),fragment:Pt.util.createBuffer(),ready:!1};var g=f.record.version.major===f.version.major;g&&f.session&&f.session.version&&(g=f.record.version.minor===f.version.minor),g||f.error(f,{message:"Incompatible TLS version.",send:!0,alert:{level:se.Alert.Level.fatal,description:se.Alert.Description.protocol_version}})}return p},"_readRecordHeader"),u=s(function(f){var p=0,m=f.input,h=m.length();if(h<f.record.length)p=f.record.length-h;else{f.record.fragment.putBytes(m.getBytes(f.record.length)),m.compact();var g=f.state.current.read;g.update(f,f.record)&&(f.fragmented!==null&&(f.fragmented.type===f.record.type?(f.fragmented.fragment.putBuffer(f.record.fragment),f.record=f.fragmented):f.error(f,{message:"Invalid fragmented record.",send:!0,alert:{level:se.Alert.Level.fatal,description:se.Alert.Description.unexpected_message}})),f.record.ready=!0)}return p},"_readRecord");return a.handshake=function(f){if(a.entity!==se.ConnectionEnd.client)a.error(a,{message:"Cannot initiate handshake as a server.",fatal:!1});else if(a.handshaking)a.error(a,{message:"Handshake already in progress.",fatal:!1});else{a.fail&&!a.open&&a.handshakes===0&&(a.fail=!1),a.handshaking=!0,f=f||"";var p=null;f.length>0&&(a.sessionCache&&(p=a.sessionCache.getSession(f)),p===null&&(f="")),f.length===0&&a.sessionCache&&(p=a.sessionCache.getSession(),p!==null&&(f=p.id)),a.session={id:f,version:null,cipherSuite:null,compressionMethod:null,serverCertificate:null,certificateRequest:null,clientCertificate:null,sp:{},md5:Pt.md.md5.create(),sha1:Pt.md.sha1.create()},p&&(a.version=p.version,a.session.sp=p.sp),a.session.sp.client_random=se.createRandom().getBytes(),a.open=!0,se.queue(a,se.createRecord(a,{type:se.ContentType.handshake,data:se.createClientHello(a)})),se.flush(a)}},a.process=function(f){var p=0;return f&&a.input.putBytes(f),a.fail||(a.record!==null&&a.record.ready&&a.record.fragment.isEmpty()&&(a.record=null),a.record===null&&(p=l(a)),!a.fail&&a.record!==null&&!a.record.ready&&(p=u(a)),!a.fail&&a.record!==null&&a.record.ready&&c(a,a.record)),p},a.prepare=function(f){return se.queue(a,se.createRecord(a,{type:se.ContentType.application_data,data:Pt.util.createBuffer(f)})),se.flush(a)},a.prepareHeartbeatRequest=function(f,p){return f instanceof Pt.util.ByteBuffer&&(f=f.bytes()),typeof p>"u"&&(p=f.length),a.expectedHeartbeatPayload=f,se.queue(a,se.createRecord(a,{type:se.ContentType.heartbeat,data:se.createHeartbeat(se.HeartbeatMessageType.heartbeat_request,f,p)})),se.flush(a)},a.close=function(f){if(!a.fail&&a.sessionCache&&a.session){var p={id:a.session.id,version:a.session.version,sp:a.session.sp};p.sp.keys=null,a.sessionCache.setSession(p.id,p)}a.open&&(a.open=!1,a.input.clear(),(a.isConnected||a.handshaking)&&(a.isConnected=a.handshaking=!1,se.queue(a,se.createAlert(a,{level:se.Alert.Level.warning,description:se.Alert.Description.close_notify})),se.flush(a)),a.closed(a)),a.reset(f)},a};rlt.exports=Pt.tls=Pt.tls||{};for(Kre in se)typeof se[Kre]!="function"&&(Pt.tls[Kre]=se[Kre]);var Kre;Pt.tls.prf_tls1=Jre;Pt.tls.hmac_sha1=Hdr;Pt.tls.createSessionCache=se.createSessionCache;Pt.tls.createConnection=se.createConnection});var olt=H((eyi,ilt)=>{d();var ww=Ri();Cw();Iwe();var Jh=ilt.exports=ww.tls;Jh.CipherSuites.TLS_RSA_WITH_AES_128_CBC_SHA={id:[0,47],name:"TLS_RSA_WITH_AES_128_CBC_SHA",initSecurityParameters:s(function(t){t.bulk_cipher_algorithm=Jh.BulkCipherAlgorithm.aes,t.cipher_type=Jh.CipherType.block,t.enc_key_length=16,t.block_length=16,t.fixed_iv_length=16,t.record_iv_length=16,t.mac_algorithm=Jh.MACAlgorithm.hmac_sha1,t.mac_length=20,t.mac_key_length=20},"initSecurityParameters"),initConnectionState:nlt};Jh.CipherSuites.TLS_RSA_WITH_AES_256_CBC_SHA={id:[0,53],name:"TLS_RSA_WITH_AES_256_CBC_SHA",initSecurityParameters:s(function(t){t.bulk_cipher_algorithm=Jh.BulkCipherAlgorithm.aes,t.cipher_type=Jh.CipherType.block,t.enc_key_length=32,t.block_length=16,t.fixed_iv_length=16,t.record_iv_length=16,t.mac_algorithm=Jh.MACAlgorithm.hmac_sha1,t.mac_length=20,t.mac_key_length=20},"initSecurityParameters"),initConnectionState:nlt};function nlt(t,e,r){var n=e.entity===ww.tls.ConnectionEnd.client;t.read.cipherState={init:!1,cipher:ww.cipher.createDecipher("AES-CBC",n?r.keys.server_write_key:r.keys.client_write_key),iv:n?r.keys.server_write_IV:r.keys.client_write_IV},t.write.cipherState={init:!1,cipher:ww.cipher.createCipher("AES-CBC",n?r.keys.client_write_key:r.keys.server_write_key),iv:n?r.keys.client_write_IV:r.keys.server_write_IV},t.read.cipherFunction=dfr,t.write.cipherFunction=cfr,t.read.macLength=t.write.macLength=r.mac_length,t.read.macFunction=t.write.macFunction=Jh.hmac_sha1}s(nlt,"initConnectionState");function cfr(t,e){var r=!1,n=e.macFunction(e.macKey,e.sequenceNumber,t);t.fragment.putBytes(n),e.updateSequenceNumber();var i;t.version.minor===Jh.Versions.TLS_1_0.minor?i=e.cipherState.init?null:e.cipherState.iv:i=ww.random.getBytesSync(16),e.cipherState.init=!0;var o=e.cipherState.cipher;return o.start({iv:i}),t.version.minor>=Jh.Versions.TLS_1_1.minor&&o.output.putBytes(i),o.update(t.fragment),o.finish(lfr)&&(t.fragment=o.output,t.length=t.fragment.length(),r=!0),r}s(cfr,"encrypt_aes_cbc_sha1");function lfr(t,e,r){if(!r){var n=t-e.length()%t;e.fillWithByte(n-1,n)}return!0}s(lfr,"encrypt_aes_cbc_sha1_padding");function ufr(t,e,r){var n=!0;if(r){for(var i=e.length(),o=e.last(),a=i-1-o;a<i-1;++a)n=n&&e.at(a)==o;n&&e.truncate(o+1)}return n}s(ufr,"decrypt_aes_cbc_sha1_padding");function dfr(t,e){var r=!1,n;t.version.minor===Jh.Versions.TLS_1_0.minor?n=e.cipherState.init?null:e.cipherState.iv:n=t.fragment.getBytes(16),e.cipherState.init=!0;var i=e.cipherState.cipher;i.start({iv:n}),i.update(t.fragment),r=i.finish(ufr);var o=e.macLength,a=ww.random.getBytesSync(o),c=i.output.length();c>=o?(t.fragment=i.output.getBytes(c-o),a=i.output.getBytes(o)):t.fragment=i.output.getBytes(),t.fragment=ww.util.createBuffer(t.fragment),t.length=t.fragment.length();var l=e.macFunction(e.macKey,e.sequenceNumber,t);return e.updateSequenceNumber(),r=ffr(e.macKey,a,l)&&r,r}s(dfr,"decrypt_aes_cbc_sha1");function ffr(t,e,r){var n=ww.hmac.create();return n.start("SHA1",t),n.update(e),e=n.digest().getBytes(),n.start(null,null),n.update(r),r=n.digest().getBytes(),e===r}s(ffr,"compareMacs")});var Swe=H((nyi,llt)=>{d();var fa=Ri();l1();Ho();var XQ=llt.exports=fa.sha512=fa.sha512||{};fa.md.sha512=fa.md.algorithms.sha512=XQ;var alt=fa.sha384=fa.sha512.sha384=fa.sha512.sha384||{};alt.create=function(){return XQ.create("SHA-384")};fa.md.sha384=fa.md.algorithms.sha384=alt;fa.sha512.sha256=fa.sha512.sha256||{create:s(function(){return XQ.create("SHA-512/256")},"create")};fa.md["sha512/256"]=fa.md.algorithms["sha512/256"]=fa.sha512.sha256;fa.sha512.sha224=fa.sha512.sha224||{create:s(function(){return XQ.create("SHA-512/224")},"create")};fa.md["sha512/224"]=fa.md.algorithms["sha512/224"]=fa.sha512.sha224;XQ.create=function(t){if(clt||pfr(),typeof t>"u"&&(t="SHA-512"),!(t in kk))throw new Error("Invalid SHA-512 algorithm: "+t);for(var e=kk[t],r=null,n=fa.util.createBuffer(),i=new Array(80),o=0;o<80;++o)i[o]=new Array(2);var a=64;switch(t){case"SHA-384":a=48;break;case"SHA-512/256":a=32;break;case"SHA-512/224":a=28;break}var c={algorithm:t.replace("-","").toLowerCase(),blockLength:128,digestLength:a,messageLength:0,fullMessageLength:null,messageLengthSize:16};return c.start=function(){c.messageLength=0,c.fullMessageLength=c.messageLength128=[];for(var l=c.messageLengthSize/4,u=0;u<l;++u)c.fullMessageLength.push(0);n=fa.util.createBuffer(),r=new Array(e.length);for(var u=0;u<e.length;++u)r[u]=e[u].slice(0);return c},c.start(),c.update=function(l,u){u==="utf8"&&(l=fa.util.encodeUtf8(l));var f=l.length;c.messageLength+=f,f=[f/4294967296>>>0,f>>>0];for(var p=c.fullMessageLength.length-1;p>=0;--p)c.fullMessageLength[p]+=f[1],f[1]=f[0]+(c.fullMessageLength[p]/4294967296>>>0),c.fullMessageLength[p]=c.fullMessageLength[p]>>>0,f[0]=f[1]/4294967296>>>0;return n.putBytes(l),slt(r,i,n),(n.read>2048||n.length()===0)&&n.compact(),c},c.digest=function(){var l=fa.util.createBuffer();l.putBytes(n.bytes());var u=c.fullMessageLength[c.fullMessageLength.length-1]+c.messageLengthSize,f=u&c.blockLength-1;l.putBytes(Twe.substr(0,c.blockLength-f));for(var p,m,h=c.fullMessageLength[0]*8,g=0;g<c.fullMessageLength.length-1;++g)p=c.fullMessageLength[g+1]*8,m=p/4294967296>>>0,h+=m,l.putInt32(h>>>0),h=p>>>0;l.putInt32(h);for(var A=new Array(r.length),g=0;g<r.length;++g)A[g]=r[g].slice(0);slt(A,i,l);var y=fa.util.createBuffer(),E;t==="SHA-512"?E=A.length:t==="SHA-384"?E=A.length-2:E=A.length-4;for(var g=0;g<E;++g)y.putInt32(A[g][0]),(g!==E-1||t!=="SHA-512/224")&&y.putInt32(A[g][1]);return y},c};var Twe=null,clt=!1,wwe=null,kk=null;function pfr(){Twe="\x80",Twe+=fa.util.fillString("\0",128),wwe=[[1116352408,3609767458],[1899447441,602891725],[3049323471,3964484399],[3921009573,2173295548],[961987163,4081628472],[1508970993,3053834265],[2453635748,2937671579],[2870763221,3664609560],[3624381080,2734883394],[310598401,1164996542],[607225278,1323610764],[1426881987,3590304994],[1925078388,4068182383],[2162078206,991336113],[2614888103,633803317],[3248222580,3479774868],[3835390401,2666613458],[4022224774,944711139],[264347078,2341262773],[604807628,2007800933],[770255983,1495990901],[1249150122,1856431235],[1555081692,3175218132],[1996064986,2198950837],[2554220882,3999719339],[2821834349,766784016],[2952996808,2566594879],[3210313671,3203337956],[3336571891,1034457026],[3584528711,2466948901],[113926993,3758326383],[338241895,168717936],[666307205,1188179964],[773529912,1546045734],[1294757372,1522805485],[1396182291,2643833823],[1695183700,2343527390],[1986661051,1014477480],[2177026350,1206759142],[2456956037,344077627],[2730485921,1290863460],[2820302411,3158454273],[3259730800,3505952657],[3345764771,106217008],[3516065817,3606008344],[3600352804,1432725776],[4094571909,1467031594],[275423344,851169720],[430227734,3100823752],[506948616,1363258195],[659060556,3750685593],[883997877,3785050280],[958139571,3318307427],[1322822218,3812723403],[1537002063,2003034995],[1747873779,3602036899],[1955562222,1575990012],[2024104815,1125592928],[2227730452,2716904306],[2361852424,442776044],[2428436474,593698344],[2756734187,3733110249],[3204031479,2999351573],[3329325298,3815920427],[3391569614,3928383900],[3515267271,566280711],[3940187606,3454069534],[4118630271,4000239992],[116418474,1914138554],[174292421,2731055270],[289380356,3203993006],[460393269,320620315],[685471733,587496836],[852142971,1086792851],[1017036298,365543100],[1126000580,2618297676],[1288033470,3409855158],[1501505948,4234509866],[1607167915,987167468],[1816402316,1246189591]],kk={},kk["SHA-512"]=[[1779033703,4089235720],[3144134277,2227873595],[1013904242,4271175723],[2773480762,1595750129],[1359893119,2917565137],[2600822924,725511199],[528734635,4215389547],[1541459225,327033209]],kk["SHA-384"]=[[3418070365,3238371032],[1654270250,914150663],[2438529370,812702999],[355462360,4144912697],[1731405415,4290775857],[2394180231,1750603025],[3675008525,1694076839],[1203062813,3204075428]],kk["SHA-512/256"]=[[573645204,4230739756],[2673172387,3360449730],[596883563,1867755857],[2520282905,1497426621],[2519219938,2827943907],[3193839141,1401305490],[721525244,746961066],[246885852,2177182882]],kk["SHA-512/224"]=[[2352822216,424955298],[1944164710,2312950998],[502970286,855612546],[1738396948,1479516111],[258812777,2077511080],[2011393907,79989058],[1067287976,1780299464],[286451373,2446758561]],clt=!0}s(pfr,"_init");function slt(t,e,r){for(var n,i,o,a,c,l,u,f,p,m,h,g,A,y,E,b,S,R,B,L,O,Y,V,z,Q,U,Z,J,j,W,X,oe,te,re,pe,Ae=r.length();Ae>=128;){for(j=0;j<16;++j)e[j][0]=r.getInt32()>>>0,e[j][1]=r.getInt32()>>>0;for(;j<80;++j)oe=e[j-2],W=oe[0],X=oe[1],n=((W>>>19|X<<13)^(X>>>29|W<<3)^W>>>6)>>>0,i=((W<<13|X>>>19)^(X<<3|W>>>29)^(W<<26|X>>>6))>>>0,re=e[j-15],W=re[0],X=re[1],o=((W>>>1|X<<31)^(W>>>8|X<<24)^W>>>7)>>>0,a=((W<<31|X>>>1)^(W<<24|X>>>8)^(W<<25|X>>>7))>>>0,te=e[j-7],pe=e[j-16],X=i+te[1]+a+pe[1],e[j][0]=n+te[0]+o+pe[0]+(X/4294967296>>>0)>>>0,e[j][1]=X>>>0;for(A=t[0][0],y=t[0][1],E=t[1][0],b=t[1][1],S=t[2][0],R=t[2][1],B=t[3][0],L=t[3][1],O=t[4][0],Y=t[4][1],V=t[5][0],z=t[5][1],Q=t[6][0],U=t[6][1],Z=t[7][0],J=t[7][1],j=0;j<80;++j)u=((O>>>14|Y<<18)^(O>>>18|Y<<14)^(Y>>>9|O<<23))>>>0,f=((O<<18|Y>>>14)^(O<<14|Y>>>18)^(Y<<23|O>>>9))>>>0,p=(Q^O&(V^Q))>>>0,m=(U^Y&(z^U))>>>0,c=((A>>>28|y<<4)^(y>>>2|A<<30)^(y>>>7|A<<25))>>>0,l=((A<<4|y>>>28)^(y<<30|A>>>2)^(y<<25|A>>>7))>>>0,h=(A&E|S&(A^E))>>>0,g=(y&b|R&(y^b))>>>0,X=J+f+m+wwe[j][1]+e[j][1],n=Z+u+p+wwe[j][0]+e[j][0]+(X/4294967296>>>0)>>>0,i=X>>>0,X=l+g,o=c+h+(X/4294967296>>>0)>>>0,a=X>>>0,Z=Q,J=U,Q=V,U=z,V=O,z=Y,X=L+i,O=B+n+(X/4294967296>>>0)>>>0,Y=X>>>0,B=S,L=R,S=E,R=b,E=A,b=y,X=i+a,A=n+o+(X/4294967296>>>0)>>>0,y=X>>>0;X=t[0][1]+y,t[0][0]=t[0][0]+A+(X/4294967296>>>0)>>>0,t[0][1]=X>>>0,X=t[1][1]+b,t[1][0]=t[1][0]+E+(X/4294967296>>>0)>>>0,t[1][1]=X>>>0,X=t[2][1]+R,t[2][0]=t[2][0]+S+(X/4294967296>>>0)>>>0,t[2][1]=X>>>0,X=t[3][1]+L,t[3][0]=t[3][0]+B+(X/4294967296>>>0)>>>0,t[3][1]=X>>>0,X=t[4][1]+Y,t[4][0]=t[4][0]+O+(X/4294967296>>>0)>>>0,t[4][1]=X>>>0,X=t[5][1]+z,t[5][0]=t[5][0]+V+(X/4294967296>>>0)>>>0,t[5][1]=X>>>0,X=t[6][1]+U,t[6][0]=t[6][0]+Q+(X/4294967296>>>0)>>>0,t[6][1]=X>>>0,X=t[7][1]+J,t[7][0]=t[7][0]+Z+(X/4294967296>>>0)>>>0,t[7][1]=X>>>0,Ae-=128}}s(slt,"_update")});var ult=H(_we=>{d();var mfr=Ri();YA();var vu=mfr.asn1;_we.privateKeyValidator={name:"PrivateKeyInfo",tagClass:vu.Class.UNIVERSAL,type:vu.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:vu.Class.UNIVERSAL,type:vu.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:vu.Class.UNIVERSAL,type:vu.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:vu.Class.UNIVERSAL,type:vu.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:vu.Class.UNIVERSAL,type:vu.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]};_we.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:vu.Class.UNIVERSAL,type:vu.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:vu.Class.UNIVERSAL,type:vu.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:vu.Class.UNIVERSAL,type:vu.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{tagClass:vu.Class.UNIVERSAL,type:vu.Type.BITSTRING,constructed:!1,composed:!0,captureBitStringValue:"ed25519PublicKey"}]}});var blt=H((cyi,Elt)=>{d();var sd=Ri();zQ();Gh();Swe();Ho();var glt=ult(),hfr=glt.publicKeyValidator,gfr=glt.privateKeyValidator;typeof dlt>"u"&&(dlt=sd.jsbn.BigInteger);var dlt,Pwe=sd.util.ByteBuffer,Hp=typeof Buffer>"u"?Uint8Array:Buffer;sd.pki=sd.pki||{};Elt.exports=sd.pki.ed25519=sd.ed25519=sd.ed25519||{};var Zi=sd.ed25519;Zi.constants={};Zi.constants.PUBLIC_KEY_BYTE_LENGTH=32;Zi.constants.PRIVATE_KEY_BYTE_LENGTH=64;Zi.constants.SEED_BYTE_LENGTH=32;Zi.constants.SIGN_BYTE_LENGTH=64;Zi.constants.HASH_BYTE_LENGTH=64;Zi.generateKeyPair=function(t){t=t||{};var e=t.seed;if(e===void 0)e=sd.random.getBytesSync(Zi.constants.SEED_BYTE_LENGTH);else if(typeof e=="string"){if(e.length!==Zi.constants.SEED_BYTE_LENGTH)throw new TypeError('"seed" must be '+Zi.constants.SEED_BYTE_LENGTH+" bytes in length.")}else if(!(e instanceof Uint8Array))throw new TypeError('"seed" must be a node.js Buffer, Uint8Array, or a binary string.');e=tE({message:e,encoding:"binary"});for(var r=new Hp(Zi.constants.PUBLIC_KEY_BYTE_LENGTH),n=new Hp(Zi.constants.PRIVATE_KEY_BYTE_LENGTH),i=0;i<32;++i)n[i]=e[i];return vfr(r,n),{publicKey:r,privateKey:n}};Zi.privateKeyFromAsn1=function(t){var e={},r=[],n=sd.asn1.validate(t,gfr,e,r);if(!n){var i=new Error("Invalid Key.");throw i.errors=r,i}var o=sd.asn1.derToOid(e.privateKeyOid),a=sd.oids.EdDSA25519;if(o!==a)throw new Error('Invalid OID "'+o+'"; OID must be "'+a+'".');var c=e.privateKey,l=tE({message:sd.asn1.fromDer(c).value,encoding:"binary"});return{privateKeyBytes:l}};Zi.publicKeyFromAsn1=function(t){var e={},r=[],n=sd.asn1.validate(t,hfr,e,r);if(!n){var i=new Error("Invalid Key.");throw i.errors=r,i}var o=sd.asn1.derToOid(e.publicKeyOid),a=sd.oids.EdDSA25519;if(o!==a)throw new Error('Invalid OID "'+o+'"; OID must be "'+a+'".');var c=e.ed25519PublicKey;if(c.length!==Zi.constants.PUBLIC_KEY_BYTE_LENGTH)throw new Error("Key length is invalid.");return tE({message:c,encoding:"binary"})};Zi.publicKeyFromPrivateKey=function(t){t=t||{};var e=tE({message:t.privateKey,encoding:"binary"});if(e.length!==Zi.constants.PRIVATE_KEY_BYTE_LENGTH)throw new TypeError('"options.privateKey" must have a byte length of '+Zi.constants.PRIVATE_KEY_BYTE_LENGTH);for(var r=new Hp(Zi.constants.PUBLIC_KEY_BYTE_LENGTH),n=0;n<r.length;++n)r[n]=e[32+n];return r};Zi.sign=function(t){t=t||{};var e=tE(t),r=tE({message:t.privateKey,encoding:"binary"});if(r.length===Zi.constants.SEED_BYTE_LENGTH){var n=Zi.generateKeyPair({seed:r});r=n.privateKey}else if(r.length!==Zi.constants.PRIVATE_KEY_BYTE_LENGTH)throw new TypeError('"options.privateKey" must have a byte length of '+Zi.constants.SEED_BYTE_LENGTH+" or "+Zi.constants.PRIVATE_KEY_BYTE_LENGTH);var i=new Hp(Zi.constants.SIGN_BYTE_LENGTH+e.length);xfr(i,e,e.length,r);for(var o=new Hp(Zi.constants.SIGN_BYTE_LENGTH),a=0;a<o.length;++a)o[a]=i[a];return o};Zi.verify=function(t){t=t||{};var e=tE(t);if(t.signature===void 0)throw new TypeError('"options.signature" must be a node.js Buffer, a Uint8Array, a forge ByteBuffer, or a binary string.');var r=tE({message:t.signature,encoding:"binary"});if(r.length!==Zi.constants.SIGN_BYTE_LENGTH)throw new TypeError('"options.signature" must have a byte length of '+Zi.constants.SIGN_BYTE_LENGTH);var n=tE({message:t.publicKey,encoding:"binary"});if(n.length!==Zi.constants.PUBLIC_KEY_BYTE_LENGTH)throw new TypeError('"options.publicKey" must have a byte length of '+Zi.constants.PUBLIC_KEY_BYTE_LENGTH);var i=new Hp(Zi.constants.SIGN_BYTE_LENGTH+e.length),o=new Hp(Zi.constants.SIGN_BYTE_LENGTH+e.length),a;for(a=0;a<Zi.constants.SIGN_BYTE_LENGTH;++a)i[a]=r[a];for(a=0;a<e.length;++a)i[a+Zi.constants.SIGN_BYTE_LENGTH]=e[a];return Efr(o,i,i.length,n)>=0};function tE(t){var e=t.message;if(e instanceof Uint8Array||e instanceof Hp)return e;var r=t.encoding;if(e===void 0)if(t.md)e=t.md.digest().getBytes(),r="binary";else throw new TypeError('"options.message" or "options.md" not specified.');if(typeof e=="string"&&!r)throw new TypeError('"options.encoding" must be "binary" or "utf8".');if(typeof e=="string"){if(typeof Buffer<"u")return Buffer.from(e,r);e=new Pwe(e,r)}else if(!(e instanceof Pwe))throw new TypeError('"options.message" must be a node.js Buffer, a Uint8Array, a forge ByteBuffer, or a string with "options.encoding" specifying its encoding.');for(var n=new Hp(e.length()),i=0;i<n.length;++i)n[i]=e.at(i);return n}s(tE,"messageToNativeBuffer");var Dwe=Ln(),Xre=Ln([1]),Afr=Ln([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),yfr=Ln([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),flt=Ln([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),plt=Ln([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),Rwe=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]),Cfr=Ln([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function ZQ(t,e){var r=sd.md.sha512.create(),n=new Pwe(t);r.update(n.getBytes(e),"binary");var i=r.digest().getBytes();if(typeof Buffer<"u")return Buffer.from(i,"binary");for(var o=new Hp(Zi.constants.HASH_BYTE_LENGTH),a=0;a<64;++a)o[a]=i.charCodeAt(a);return o}s(ZQ,"sha512");function vfr(t,e){var r=[Ln(),Ln(),Ln(),Ln()],n,i=ZQ(e,32);for(i[0]&=248,i[31]&=127,i[31]|=64,Lwe(r,i),Mwe(t,r),n=0;n<32;++n)e[n+32]=t[n];return 0}s(vfr,"crypto_sign_keypair");function xfr(t,e,r,n){var i,o,a=new Float64Array(64),c=[Ln(),Ln(),Ln(),Ln()],l=ZQ(n,32);l[0]&=248,l[31]&=127,l[31]|=64;var u=r+64;for(i=0;i<r;++i)t[64+i]=e[i];for(i=0;i<32;++i)t[32+i]=l[32+i];var f=ZQ(t.subarray(32),r+32);for(Bwe(f),Lwe(c,f),Mwe(t,c),i=32;i<64;++i)t[i]=n[i];var p=ZQ(t,r+64);for(Bwe(p),i=32;i<64;++i)a[i]=0;for(i=0;i<32;++i)a[i]=f[i];for(i=0;i<32;++i)for(o=0;o<32;o++)a[i+o]+=p[i]*l[o];return Alt(t.subarray(32),a),u}s(xfr,"crypto_sign");function Efr(t,e,r,n){var i,o,a=new Hp(32),c=[Ln(),Ln(),Ln(),Ln()],l=[Ln(),Ln(),Ln(),Ln()];if(o=-1,r<64||bfr(l,n))return-1;for(i=0;i<r;++i)t[i]=e[i];for(i=0;i<32;++i)t[i+32]=n[i];var u=ZQ(t,r);if(Bwe(u),vlt(c,l,u),Lwe(l,e.subarray(32)),Nwe(c,l),Mwe(a,c),r-=64,ylt(e,0,a,0)){for(i=0;i<r;++i)t[i]=0;return-1}for(i=0;i<r;++i)t[i]=e[i+64];return o=r,o}s(Efr,"crypto_sign_open");function Alt(t,e){var r,n,i,o;for(n=63;n>=32;--n){for(r=0,i=n-32,o=n-12;i<o;++i)e[i]+=r-16*e[n]*Rwe[i-(n-32)],r=e[i]+128>>8,e[i]-=r*256;e[i]+=r,e[n]=0}for(r=0,i=0;i<32;++i)e[i]+=r-(e[31]>>4)*Rwe[i],r=e[i]>>8,e[i]&=255;for(i=0;i<32;++i)e[i]-=r*Rwe[i];for(n=0;n<32;++n)e[n+1]+=e[n]>>8,t[n]=e[n]&255}s(Alt,"modL");function Bwe(t){for(var e=new Float64Array(64),r=0;r<64;++r)e[r]=t[r],t[r]=0;Alt(t,e)}s(Bwe,"reduce");function Nwe(t,e){var r=Ln(),n=Ln(),i=Ln(),o=Ln(),a=Ln(),c=Ln(),l=Ln(),u=Ln(),f=Ln();ZN(r,t[1],t[0]),ZN(f,e[1],e[0]),ks(r,r,f),XN(n,t[0],t[1]),XN(f,e[0],e[1]),ks(n,n,f),ks(i,t[3],e[3]),ks(i,i,yfr),ks(o,t[2],e[2]),XN(o,o,o),ZN(a,n,r),ZN(c,o,i),XN(l,o,i),XN(u,n,r),ks(t[0],a,c),ks(t[1],u,l),ks(t[2],l,c),ks(t[3],a,u)}s(Nwe,"add");function mlt(t,e,r){for(var n=0;n<4;++n)xlt(t[n],e[n],r)}s(mlt,"cswap");function Mwe(t,e){var r=Ln(),n=Ln(),i=Ln();Sfr(i,e[2]),ks(r,e[0],i),ks(n,e[1],i),Zre(t,n),t[31]^=Clt(r)<<7}s(Mwe,"pack");function Zre(t,e){var r,n,i,o=Ln(),a=Ln();for(r=0;r<16;++r)a[r]=e[r];for(kwe(a),kwe(a),kwe(a),n=0;n<2;++n){for(o[0]=a[0]-65517,r=1;r<15;++r)o[r]=a[r]-65535-(o[r-1]>>16&1),o[r-1]&=65535;o[15]=a[15]-32767-(o[14]>>16&1),i=o[15]>>16&1,o[14]&=65535,xlt(a,o,1-i)}for(r=0;r<16;r++)t[2*r]=a[r]&255,t[2*r+1]=a[r]>>8}s(Zre,"pack25519");function bfr(t,e){var r=Ln(),n=Ln(),i=Ln(),o=Ln(),a=Ln(),c=Ln(),l=Ln();return Sw(t[2],Xre),Ifr(t[1],e),Pk(i,t[1]),ks(o,i,Afr),ZN(i,i,t[2]),XN(o,t[2],o),Pk(a,o),Pk(c,a),ks(l,c,a),ks(r,l,i),ks(r,r,o),Tfr(r,r),ks(r,r,i),ks(r,r,o),ks(r,r,o),ks(t[0],r,o),Pk(n,t[0]),ks(n,n,o),hlt(n,i)&&ks(t[0],t[0],Cfr),Pk(n,t[0]),ks(n,n,o),hlt(n,i)?-1:(Clt(t[0])===e[31]>>7&&ZN(t[0],Dwe,t[0]),ks(t[3],t[0],t[1]),0)}s(bfr,"unpackneg");function Ifr(t,e){var r;for(r=0;r<16;++r)t[r]=e[2*r]+(e[2*r+1]<<8);t[15]&=32767}s(Ifr,"unpack25519");function Tfr(t,e){var r=Ln(),n;for(n=0;n<16;++n)r[n]=e[n];for(n=250;n>=0;--n)Pk(r,r),n!==1&&ks(r,r,e);for(n=0;n<16;++n)t[n]=r[n]}s(Tfr,"pow2523");function hlt(t,e){var r=new Hp(32),n=new Hp(32);return Zre(r,t),Zre(n,e),ylt(r,0,n,0)}s(hlt,"neq25519");function ylt(t,e,r,n){return wfr(t,e,r,n,32)}s(ylt,"crypto_verify_32");function wfr(t,e,r,n,i){var o,a=0;for(o=0;o<i;++o)a|=t[e+o]^r[n+o];return(1&a-1>>>8)-1}s(wfr,"vn");function Clt(t){var e=new Hp(32);return Zre(e,t),e[0]&1}s(Clt,"par25519");function vlt(t,e,r){var n,i;for(Sw(t[0],Dwe),Sw(t[1],Xre),Sw(t[2],Xre),Sw(t[3],Dwe),i=255;i>=0;--i)n=r[i/8|0]>>(i&7)&1,mlt(t,e,n),Nwe(e,t),Nwe(t,t),mlt(t,e,n)}s(vlt,"scalarmult");function Lwe(t,e){var r=[Ln(),Ln(),Ln(),Ln()];Sw(r[0],flt),Sw(r[1],plt),Sw(r[2],Xre),ks(r[3],flt,plt),vlt(t,r,e)}s(Lwe,"scalarbase");function Sw(t,e){var r;for(r=0;r<16;r++)t[r]=e[r]|0}s(Sw,"set25519");function Sfr(t,e){var r=Ln(),n;for(n=0;n<16;++n)r[n]=e[n];for(n=253;n>=0;--n)Pk(r,r),n!==2&&n!==4&&ks(r,r,e);for(n=0;n<16;++n)t[n]=r[n]}s(Sfr,"inv25519");function kwe(t){var e,r,n=1;for(e=0;e<16;++e)r=t[e]+n+65535,n=Math.floor(r/65536),t[e]=r-n*65536;t[0]+=n-1+37*(n-1)}s(kwe,"car25519");function xlt(t,e,r){for(var n,i=~(r-1),o=0;o<16;++o)n=i&(t[o]^e[o]),t[o]^=n,e[o]^=n}s(xlt,"sel25519");function Ln(t){var e,r=new Float64Array(16);if(t)for(e=0;e<t.length;++e)r[e]=t[e];return r}s(Ln,"gf");function XN(t,e,r){for(var n=0;n<16;++n)t[n]=e[n]+r[n]}s(XN,"A");function ZN(t,e,r){for(var n=0;n<16;++n)t[n]=e[n]-r[n]}s(ZN,"Z");function Pk(t,e){ks(t,e,e)}s(Pk,"S");function ks(t,e,r){var n,i,o=0,a=0,c=0,l=0,u=0,f=0,p=0,m=0,h=0,g=0,A=0,y=0,E=0,b=0,S=0,R=0,B=0,L=0,O=0,Y=0,V=0,z=0,Q=0,U=0,Z=0,J=0,j=0,W=0,X=0,oe=0,te=0,re=r[0],pe=r[1],Ae=r[2],Oe=r[3],Te=r[4],Je=r[5],Fe=r[6],lt=r[7],_t=r[8],xt=r[9],gt=r[10],ue=r[11],Ue=r[12],ye=r[13],$e=r[14],ae=r[15];n=e[0],o+=n*re,a+=n*pe,c+=n*Ae,l+=n*Oe,u+=n*Te,f+=n*Je,p+=n*Fe,m+=n*lt,h+=n*_t,g+=n*xt,A+=n*gt,y+=n*ue,E+=n*Ue,b+=n*ye,S+=n*$e,R+=n*ae,n=e[1],a+=n*re,c+=n*pe,l+=n*Ae,u+=n*Oe,f+=n*Te,p+=n*Je,m+=n*Fe,h+=n*lt,g+=n*_t,A+=n*xt,y+=n*gt,E+=n*ue,b+=n*Ue,S+=n*ye,R+=n*$e,B+=n*ae,n=e[2],c+=n*re,l+=n*pe,u+=n*Ae,f+=n*Oe,p+=n*Te,m+=n*Je,h+=n*Fe,g+=n*lt,A+=n*_t,y+=n*xt,E+=n*gt,b+=n*ue,S+=n*Ue,R+=n*ye,B+=n*$e,L+=n*ae,n=e[3],l+=n*re,u+=n*pe,f+=n*Ae,p+=n*Oe,m+=n*Te,h+=n*Je,g+=n*Fe,A+=n*lt,y+=n*_t,E+=n*xt,b+=n*gt,S+=n*ue,R+=n*Ue,B+=n*ye,L+=n*$e,O+=n*ae,n=e[4],u+=n*re,f+=n*pe,p+=n*Ae,m+=n*Oe,h+=n*Te,g+=n*Je,A+=n*Fe,y+=n*lt,E+=n*_t,b+=n*xt,S+=n*gt,R+=n*ue,B+=n*Ue,L+=n*ye,O+=n*$e,Y+=n*ae,n=e[5],f+=n*re,p+=n*pe,m+=n*Ae,h+=n*Oe,g+=n*Te,A+=n*Je,y+=n*Fe,E+=n*lt,b+=n*_t,S+=n*xt,R+=n*gt,B+=n*ue,L+=n*Ue,O+=n*ye,Y+=n*$e,V+=n*ae,n=e[6],p+=n*re,m+=n*pe,h+=n*Ae,g+=n*Oe,A+=n*Te,y+=n*Je,E+=n*Fe,b+=n*lt,S+=n*_t,R+=n*xt,B+=n*gt,L+=n*ue,O+=n*Ue,Y+=n*ye,V+=n*$e,z+=n*ae,n=e[7],m+=n*re,h+=n*pe,g+=n*Ae,A+=n*Oe,y+=n*Te,E+=n*Je,b+=n*Fe,S+=n*lt,R+=n*_t,B+=n*xt,L+=n*gt,O+=n*ue,Y+=n*Ue,V+=n*ye,z+=n*$e,Q+=n*ae,n=e[8],h+=n*re,g+=n*pe,A+=n*Ae,y+=n*Oe,E+=n*Te,b+=n*Je,S+=n*Fe,R+=n*lt,B+=n*_t,L+=n*xt,O+=n*gt,Y+=n*ue,V+=n*Ue,z+=n*ye,Q+=n*$e,U+=n*ae,n=e[9],g+=n*re,A+=n*pe,y+=n*Ae,E+=n*Oe,b+=n*Te,S+=n*Je,R+=n*Fe,B+=n*lt,L+=n*_t,O+=n*xt,Y+=n*gt,V+=n*ue,z+=n*Ue,Q+=n*ye,U+=n*$e,Z+=n*ae,n=e[10],A+=n*re,y+=n*pe,E+=n*Ae,b+=n*Oe,S+=n*Te,R+=n*Je,B+=n*Fe,L+=n*lt,O+=n*_t,Y+=n*xt,V+=n*gt,z+=n*ue,Q+=n*Ue,U+=n*ye,Z+=n*$e,J+=n*ae,n=e[11],y+=n*re,E+=n*pe,b+=n*Ae,S+=n*Oe,R+=n*Te,B+=n*Je,L+=n*Fe,O+=n*lt,Y+=n*_t,V+=n*xt,z+=n*gt,Q+=n*ue,U+=n*Ue,Z+=n*ye,J+=n*$e,j+=n*ae,n=e[12],E+=n*re,b+=n*pe,S+=n*Ae,R+=n*Oe,B+=n*Te,L+=n*Je,O+=n*Fe,Y+=n*lt,V+=n*_t,z+=n*xt,Q+=n*gt,U+=n*ue,Z+=n*Ue,J+=n*ye,j+=n*$e,W+=n*ae,n=e[13],b+=n*re,S+=n*pe,R+=n*Ae,B+=n*Oe,L+=n*Te,O+=n*Je,Y+=n*Fe,V+=n*lt,z+=n*_t,Q+=n*xt,U+=n*gt,Z+=n*ue,J+=n*Ue,j+=n*ye,W+=n*$e,X+=n*ae,n=e[14],S+=n*re,R+=n*pe,B+=n*Ae,L+=n*Oe,O+=n*Te,Y+=n*Je,V+=n*Fe,z+=n*lt,Q+=n*_t,U+=n*xt,Z+=n*gt,J+=n*ue,j+=n*Ue,W+=n*ye,X+=n*$e,oe+=n*ae,n=e[15],R+=n*re,B+=n*pe,L+=n*Ae,O+=n*Oe,Y+=n*Te,V+=n*Je,z+=n*Fe,Q+=n*lt,U+=n*_t,Z+=n*xt,J+=n*gt,j+=n*ue,W+=n*Ue,X+=n*ye,oe+=n*$e,te+=n*ae,o+=38*B,a+=38*L,c+=38*O,l+=38*Y,u+=38*V,f+=38*z,p+=38*Q,m+=38*U,h+=38*Z,g+=38*J,A+=38*j,y+=38*W,E+=38*X,b+=38*oe,S+=38*te,i=1,n=o+i+65535,i=Math.floor(n/65536),o=n-i*65536,n=a+i+65535,i=Math.floor(n/65536),a=n-i*65536,n=c+i+65535,i=Math.floor(n/65536),c=n-i*65536,n=l+i+65535,i=Math.floor(n/65536),l=n-i*65536,n=u+i+65535,i=Math.floor(n/65536),u=n-i*65536,n=f+i+65535,i=Math.floor(n/65536),f=n-i*65536,n=p+i+65535,i=Math.floor(n/65536),p=n-i*65536,n=m+i+65535,i=Math.floor(n/65536),m=n-i*65536,n=h+i+65535,i=Math.floor(n/65536),h=n-i*65536,n=g+i+65535,i=Math.floor(n/65536),g=n-i*65536,n=A+i+65535,i=Math.floor(n/65536),A=n-i*65536,n=y+i+65535,i=Math.floor(n/65536),y=n-i*65536,n=E+i+65535,i=Math.floor(n/65536),E=n-i*65536,n=b+i+65535,i=Math.floor(n/65536),b=n-i*65536,n=S+i+65535,i=Math.floor(n/65536),S=n-i*65536,n=R+i+65535,i=Math.floor(n/65536),R=n-i*65536,o+=i-1+37*(i-1),i=1,n=o+i+65535,i=Math.floor(n/65536),o=n-i*65536,n=a+i+65535,i=Math.floor(n/65536),a=n-i*65536,n=c+i+65535,i=Math.floor(n/65536),c=n-i*65536,n=l+i+65535,i=Math.floor(n/65536),l=n-i*65536,n=u+i+65535,i=Math.floor(n/65536),u=n-i*65536,n=f+i+65535,i=Math.floor(n/65536),f=n-i*65536,n=p+i+65535,i=Math.floor(n/65536),p=n-i*65536,n=m+i+65535,i=Math.floor(n/65536),m=n-i*65536,n=h+i+65535,i=Math.floor(n/65536),h=n-i*65536,n=g+i+65535,i=Math.floor(n/65536),g=n-i*65536,n=A+i+65535,i=Math.floor(n/65536),A=n-i*65536,n=y+i+65535,i=Math.floor(n/65536),y=n-i*65536,n=E+i+65535,i=Math.floor(n/65536),E=n-i*65536,n=b+i+65535,i=Math.floor(n/65536),b=n-i*65536,n=S+i+65535,i=Math.floor(n/65536),S=n-i*65536,n=R+i+65535,i=Math.floor(n/65536),R=n-i*65536,o+=i-1+37*(i-1),t[0]=o,t[1]=a,t[2]=c,t[3]=l,t[4]=u,t[5]=f,t[6]=p,t[7]=m,t[8]=h,t[9]=g,t[10]=A,t[11]=y,t[12]=E,t[13]=b,t[14]=S,t[15]=R}s(ks,"M")});var Slt=H((dyi,wlt)=>{d();var sm=Ri();Ho();Gh();zQ();wlt.exports=sm.kem=sm.kem||{};var Ilt=sm.jsbn.BigInteger;sm.kem.rsa={};sm.kem.rsa.create=function(t,e){e=e||{};var r=e.prng||sm.random,n={};return n.encrypt=function(i,o){var a=Math.ceil(i.n.bitLength()/8),c;do c=new Ilt(sm.util.bytesToHex(r.getBytesSync(a)),16).mod(i.n);while(c.compareTo(Ilt.ONE)<=0);c=sm.util.hexToBytes(c.toString(16));var l=a-c.length;l>0&&(c=sm.util.fillString("\0",l)+c);var u=i.encrypt(c,"NONE"),f=t.generate(c,o);return{encapsulation:u,key:f}},n.decrypt=function(i,o,a){var c=i.decrypt(o,"NONE");return t.generate(c,a)},n};sm.kem.kdf1=function(t,e){Tlt(this,t,0,e||t.digestLength)};sm.kem.kdf2=function(t,e){Tlt(this,t,1,e||t.digestLength)};function Tlt(t,e,r,n){t.generate=function(i,o){for(var a=new sm.util.ByteBuffer,c=Math.ceil(o/n)+r,l=new sm.util.ByteBuffer,u=r;u<c;++u){l.putInt32(u),e.start(),e.update(i+l.getBytes());var f=e.digest();a.putBytes(f.getBytes(n))}return a.truncate(a.length()-o),a.getBytes()}}s(Tlt,"_createKDF")});var Plt=H((myi,klt)=>{d();var ho=Ri();Ho();klt.exports=ho.log=ho.log||{};ho.log.levels=["none","error","warning","info","debug","verbose","max"];var ene={},Qwe=[],tU=null;ho.log.LEVEL_LOCKED=2;ho.log.NO_LEVEL_CHECK=4;ho.log.INTERPOLATE=8;for(A1=0;A1<ho.log.levels.length;++A1)Fwe=ho.log.levels[A1],ene[Fwe]={index:A1,name:Fwe.toUpperCase()};var Fwe,A1;ho.log.logMessage=function(t){for(var e=ene[t.level].index,r=0;r<Qwe.length;++r){var n=Qwe[r];if(n.flags&ho.log.NO_LEVEL_CHECK)n.f(t);else{var i=ene[n.level].index;e<=i&&n.f(n,t)}}};ho.log.prepareStandard=function(t){"standard"in t||(t.standard=ene[t.level].name+" ["+t.category+"] "+t.message)};ho.log.prepareFull=function(t){if(!("full"in t)){var e=[t.message];e=e.concat([]),t.full=ho.util.format.apply(this,e)}};ho.log.prepareStandardFull=function(t){"standardFull"in t||(ho.log.prepareStandard(t),t.standardFull=t.standard)};for(Owe=["error","warning","info","debug","verbose"],A1=0;A1<Owe.length;++A1)(function(e){ho.log[e]=function(r,n){var i=Array.prototype.slice.call(arguments).slice(2),o={timestamp:new Date,level:e,category:r,message:n,arguments:i};ho.log.logMessage(o)}})(Owe[A1]);var Owe,A1;ho.log.makeLogger=function(t){var e={flags:0,f:t};return ho.log.setLevel(e,"none"),e};ho.log.setLevel=function(t,e){var r=!1;if(t&&!(t.flags&ho.log.LEVEL_LOCKED))for(var n=0;n<ho.log.levels.length;++n){var i=ho.log.levels[n];if(e==i){t.level=e,r=!0;break}}return r};ho.log.lock=function(t,e){typeof e>"u"||e?t.flags|=ho.log.LEVEL_LOCKED:t.flags&=~ho.log.LEVEL_LOCKED};ho.log.addLogger=function(t){Qwe.push(t)};typeof console<"u"&&"log"in console?(console.error&&console.warn&&console.info&&console.debug?(_lt={error:console.error,warning:console.warn,info:console.info,debug:console.debug,verbose:console.debug},rU=s(function(t,e){ho.log.prepareStandard(e);var r=_lt[e.level],n=[e.standard];n=n.concat(e.arguments.slice()),r.apply(console,n)},"f"),e8=ho.log.makeLogger(rU)):(rU=s(function(e,r){ho.log.prepareStandardFull(r),console.log(r.standardFull)},"f"),e8=ho.log.makeLogger(rU)),ho.log.setLevel(e8,"debug"),ho.log.addLogger(e8),tU=e8):console={log:s(function(){},"log")};var e8,_lt,rU;tU!==null&&typeof window<"u"&&window.location&&(eU=new URL(window.location.href).searchParams,eU.has("console.level")&&ho.log.setLevel(tU,eU.get("console.level").slice(-1)[0]),eU.has("console.lock")&&(Rlt=eU.get("console.lock").slice(-1)[0],Rlt=="true"&&ho.log.lock(tU)));var eU,Rlt;ho.log.consoleLogger=tU});var Blt=H((Ayi,Dlt)=>{d();Dlt.exports=l1();Bre();VN();XTe();Swe()});var Llt=H((Cyi,Mlt)=>{d();var lr=Ri();Cw();YA();GQ();vw();Ik();fwe();Gh();Ho();Vre();var De=lr.asn1,Qf=Mlt.exports=lr.pkcs7=lr.pkcs7||{};Qf.messageFromPem=function(t){var e=lr.pem.decode(t)[0];if(e.type!=="PKCS7"){var r=new Error('Could not convert PKCS#7 message from PEM; PEM header type is not "PKCS#7".');throw r.headerType=e.type,r}if(e.procType&&e.procType.type==="ENCRYPTED")throw new Error("Could not convert PKCS#7 message from PEM; PEM is encrypted.");var n=De.fromDer(e.body);return Qf.messageFromAsn1(n)};Qf.messageToPem=function(t,e){var r={type:"PKCS7",body:De.toDer(t.toAsn1()).getBytes()};return lr.pem.encode(r,{maxline:e})};Qf.messageFromAsn1=function(t){var e={},r=[];if(!De.validate(t,Qf.asn1.contentInfoValidator,e,r)){var n=new Error("Cannot read PKCS#7 message. ASN.1 object is not an PKCS#7 ContentInfo.");throw n.errors=r,n}var i=De.derToOid(e.contentType),o;switch(i){case lr.pki.oids.envelopedData:o=Qf.createEnvelopedData();break;case lr.pki.oids.encryptedData:o=Qf.createEncryptedData();break;case lr.pki.oids.signedData:o=Qf.createSignedData();break;default:throw new Error("Cannot read PKCS#7 message. ContentType with OID "+i+" is not (yet) supported.")}return o.fromAsn1(e.content.value[0]),o};Qf.createSignedData=function(){var t=null;return t={type:lr.pki.oids.signedData,version:1,certificates:[],crls:[],signers:[],digestAlgorithmIdentifiers:[],contentInfo:null,signerInfos:[],fromAsn1:s(function(n){if(qwe(t,n,Qf.asn1.signedDataValidator),t.certificates=[],t.crls=[],t.digestAlgorithmIdentifiers=[],t.contentInfo=null,t.signerInfos=[],t.rawCapture.certificates)for(var i=t.rawCapture.certificates.value,o=0;o<i.length;++o)t.certificates.push(lr.pki.certificateFromAsn1(i[o]))},"fromAsn1"),toAsn1:s(function(){t.contentInfo||t.sign();for(var n=[],i=0;i<t.certificates.length;++i)n.push(lr.pki.certificateToAsn1(t.certificates[i]));var o=[],a=De.create(De.Class.CONTEXT_SPECIFIC,0,!0,[De.create(De.Class.UNIVERSAL,De.Type.SEQUENCE,!0,[De.create(De.Class.UNIVERSAL,De.Type.INTEGER,!1,De.integerToDer(t.version).getBytes()),De.create(De.Class.UNIVERSAL,De.Type.SET,!0,t.digestAlgorithmIdentifiers),t.contentInfo])]);return n.length>0&&a.value[0].value.push(De.create(De.Class.CONTEXT_SPECIFIC,0,!0,n)),o.length>0&&a.value[0].value.push(De.create(De.Class.CONTEXT_SPECIFIC,1,!0,o)),a.value[0].value.push(De.create(De.Class.UNIVERSAL,De.Type.SET,!0,t.signerInfos)),De.create(De.Class.UNIVERSAL,De.Type.SEQUENCE,!0,[De.create(De.Class.UNIVERSAL,De.Type.OID,!1,De.oidToDer(t.type).getBytes()),a])},"toAsn1"),addSigner:s(function(n){var i=n.issuer,o=n.serialNumber;if(n.certificate){var a=n.certificate;typeof a=="string"&&(a=lr.pki.certificateFromPem(a)),i=a.issuer.attributes,o=a.serialNumber}var c=n.key;if(!c)throw new Error("Could not add PKCS#7 signer; no private key specified.");typeof c=="string"&&(c=lr.pki.privateKeyFromPem(c));var l=n.digestAlgorithm||lr.pki.oids.sha1;switch(l){case lr.pki.oids.sha1:case lr.pki.oids.sha256:case lr.pki.oids.sha384:case lr.pki.oids.sha512:case lr.pki.oids.md5:break;default:throw new Error("Could not add PKCS#7 signer; unknown message digest algorithm: "+l)}var u=n.authenticatedAttributes||[];if(u.length>0){for(var f=!1,p=!1,m=0;m<u.length;++m){var h=u[m];if(!f&&h.type===lr.pki.oids.contentType){if(f=!0,p)break;continue}if(!p&&h.type===lr.pki.oids.messageDigest){if(p=!0,f)break;continue}}if(!f||!p)throw new Error("Invalid signer.authenticatedAttributes. If signer.authenticatedAttributes is specified, then it must contain at least two attributes, PKCS #9 content-type and PKCS #9 message-digest.")}t.signers.push({key:c,version:1,issuer:i,serialNumber:o,digestAlgorithm:l,signatureAlgorithm:lr.pki.oids.rsaEncryption,signature:null,authenticatedAttributes:u,unauthenticatedAttributes:[]})},"addSigner"),sign:s(function(n){if(n=n||{},(typeof t.content!="object"||t.contentInfo===null)&&(t.contentInfo=De.create(De.Class.UNIVERSAL,De.Type.SEQUENCE,!0,[De.create(De.Class.UNIVERSAL,De.Type.OID,!1,De.oidToDer(lr.pki.oids.data).getBytes())]),"content"in t)){var i;t.content instanceof lr.util.ByteBuffer?i=t.content.bytes():typeof t.content=="string"&&(i=lr.util.encodeUtf8(t.content)),n.detached?t.detachedContent=De.create(De.Class.UNIVERSAL,De.Type.OCTETSTRING,!1,i):t.contentInfo.value.push(De.create(De.Class.CONTEXT_SPECIFIC,0,!0,[De.create(De.Class.UNIVERSAL,De.Type.OCTETSTRING,!1,i)]))}if(t.signers.length!==0){var o=e();r(o)}},"sign"),verify:s(function(){throw new Error("PKCS#7 signature verification not yet implemented.")},"verify"),addCertificate:s(function(n){typeof n=="string"&&(n=lr.pki.certificateFromPem(n)),t.certificates.push(n)},"addCertificate"),addCertificateRevokationList:s(function(n){throw new Error("PKCS#7 CRL support not yet implemented.")},"addCertificateRevokationList")},t;function e(){for(var n={},i=0;i<t.signers.length;++i){var o=t.signers[i],a=o.digestAlgorithm;a in n||(n[a]=lr.md[lr.pki.oids[a]].create()),o.authenticatedAttributes.length===0?o.md=n[a]:o.md=lr.md[lr.pki.oids[a]].create()}t.digestAlgorithmIdentifiers=[];for(var a in n)t.digestAlgorithmIdentifiers.push(De.create(De.Class.UNIVERSAL,De.Type.SEQUENCE,!0,[De.create(De.Class.UNIVERSAL,De.Type.OID,!1,De.oidToDer(a).getBytes()),De.create(De.Class.UNIVERSAL,De.Type.NULL,!1,"")]));return n}s(e,"addDigestAlgorithmIds");function r(n){var i;if(t.detachedContent?i=t.detachedContent:(i=t.contentInfo.value[1],i=i.value[0]),!i)throw new Error("Could not sign PKCS#7 message; there is no content to sign.");var o=De.derToOid(t.contentInfo.value[0].value),a=De.toDer(i);a.getByte(),De.getBerValueLength(a),a=a.getBytes();for(var c in n)n[c].start().update(a);for(var l=new Date,u=0;u<t.signers.length;++u){var f=t.signers[u];if(f.authenticatedAttributes.length===0){if(o!==lr.pki.oids.data)throw new Error("Invalid signer; authenticatedAttributes must be present when the ContentInfo content type is not PKCS#7 Data.")}else{f.authenticatedAttributesAsn1=De.create(De.Class.CONTEXT_SPECIFIC,0,!0,[]);for(var p=De.create(De.Class.UNIVERSAL,De.Type.SET,!0,[]),m=0;m<f.authenticatedAttributes.length;++m){var h=f.authenticatedAttributes[m];h.type===lr.pki.oids.messageDigest?h.value=n[f.digestAlgorithm].digest():h.type===lr.pki.oids.signingTime&&(h.value||(h.value=l)),p.value.push(Uwe(h)),f.authenticatedAttributesAsn1.value.push(Uwe(h))}a=De.toDer(p).getBytes(),f.md.start().update(a)}f.signature=f.key.sign(f.md,"RSASSA-PKCS1-V1_5")}t.signerInfos=Bfr(t.signers)}s(r,"addSignerInfos")};Qf.createEncryptedData=function(){var t=null;return t={type:lr.pki.oids.encryptedData,version:0,encryptedContent:{algorithm:lr.pki.oids["aes256-CBC"]},fromAsn1:s(function(e){qwe(t,e,Qf.asn1.encryptedDataValidator)},"fromAsn1"),decrypt:s(function(e){e!==void 0&&(t.encryptedContent.key=e),Nlt(t)},"decrypt")},t};Qf.createEnvelopedData=function(){var t=null;return t={type:lr.pki.oids.envelopedData,version:0,recipients:[],encryptedContent:{algorithm:lr.pki.oids["aes256-CBC"]},fromAsn1:s(function(e){var r=qwe(t,e,Qf.asn1.envelopedDataValidator);t.recipients=kfr(r.recipientInfos.value)},"fromAsn1"),toAsn1:s(function(){return De.create(De.Class.UNIVERSAL,De.Type.SEQUENCE,!0,[De.create(De.Class.UNIVERSAL,De.Type.OID,!1,De.oidToDer(t.type).getBytes()),De.create(De.Class.CONTEXT_SPECIFIC,0,!0,[De.create(De.Class.UNIVERSAL,De.Type.SEQUENCE,!0,[De.create(De.Class.UNIVERSAL,De.Type.INTEGER,!1,De.integerToDer(t.version).getBytes()),De.create(De.Class.UNIVERSAL,De.Type.SET,!0,Pfr(t.recipients)),De.create(De.Class.UNIVERSAL,De.Type.SEQUENCE,!0,Nfr(t.encryptedContent))])])])},"toAsn1"),findRecipient:s(function(e){for(var r=e.issuer.attributes,n=0;n<t.recipients.length;++n){var i=t.recipients[n],o=i.issuer;if(i.serialNumber===e.serialNumber&&o.length===r.length){for(var a=!0,c=0;c<r.length;++c)if(o[c].type!==r[c].type||o[c].value!==r[c].value){a=!1;break}if(a)return i}}return null},"findRecipient"),decrypt:s(function(e,r){if(t.encryptedContent.key===void 0&&e!==void 0&&r!==void 0)switch(e.encryptedContent.algorithm){case lr.pki.oids.rsaEncryption:case lr.pki.oids.desCBC:var n=r.decrypt(e.encryptedContent.content);t.encryptedContent.key=lr.util.createBuffer(n);break;default:throw new Error("Unsupported asymmetric cipher, OID "+e.encryptedContent.algorithm)}Nlt(t)},"decrypt"),addRecipient:s(function(e){t.recipients.push({version:0,issuer:e.issuer.attributes,serialNumber:e.serialNumber,encryptedContent:{algorithm:lr.pki.oids.rsaEncryption,key:e.publicKey}})},"addRecipient"),encrypt:s(function(e,r){if(t.encryptedContent.content===void 0){r=r||t.encryptedContent.algorithm,e=e||t.encryptedContent.key;var n,i,o;switch(r){case lr.pki.oids["aes128-CBC"]:n=16,i=16,o=lr.aes.createEncryptionCipher;break;case lr.pki.oids["aes192-CBC"]:n=24,i=16,o=lr.aes.createEncryptionCipher;break;case lr.pki.oids["aes256-CBC"]:n=32,i=16,o=lr.aes.createEncryptionCipher;break;case lr.pki.oids["des-EDE3-CBC"]:n=24,i=8,o=lr.des.createEncryptionCipher;break;default:throw new Error("Unsupported symmetric cipher, OID "+r)}if(e===void 0)e=lr.util.createBuffer(lr.random.getBytes(n));else if(e.length()!=n)throw new Error("Symmetric key has wrong length; got "+e.length()+" bytes, expected "+n+".");t.encryptedContent.algorithm=r,t.encryptedContent.key=e,t.encryptedContent.parameter=lr.util.createBuffer(lr.random.getBytes(i));var a=o(e);if(a.start(t.encryptedContent.parameter.copy()),a.update(t.content),!a.finish())throw new Error("Symmetric encryption failed.");t.encryptedContent.content=a.output}for(var c=0;c<t.recipients.length;++c){var l=t.recipients[c];if(l.encryptedContent.content===void 0)switch(l.encryptedContent.algorithm){case lr.pki.oids.rsaEncryption:l.encryptedContent.content=l.encryptedContent.key.encrypt(t.encryptedContent.key.data);break;default:throw new Error("Unsupported asymmetric cipher, OID "+l.encryptedContent.algorithm)}}},"encrypt")},t};function _fr(t){var e={},r=[];if(!De.validate(t,Qf.asn1.recipientInfoValidator,e,r)){var n=new Error("Cannot read PKCS#7 RecipientInfo. ASN.1 object is not an PKCS#7 RecipientInfo.");throw n.errors=r,n}return{version:e.version.charCodeAt(0),issuer:lr.pki.RDNAttributesAsArray(e.issuer),serialNumber:lr.util.createBuffer(e.serial).toHex(),encryptedContent:{algorithm:De.derToOid(e.encAlgorithm),parameter:e.encParameter?e.encParameter.value:void 0,content:e.encKey}}}s(_fr,"_recipientFromAsn1");function Rfr(t){return De.create(De.Class.UNIVERSAL,De.Type.SEQUENCE,!0,[De.create(De.Class.UNIVERSAL,De.Type.INTEGER,!1,De.integerToDer(t.version).getBytes()),De.create(De.Class.UNIVERSAL,De.Type.SEQUENCE,!0,[lr.pki.distinguishedNameToAsn1({attributes:t.issuer}),De.create(De.Class.UNIVERSAL,De.Type.INTEGER,!1,lr.util.hexToBytes(t.serialNumber))]),De.create(De.Class.UNIVERSAL,De.Type.SEQUENCE,!0,[De.create(De.Class.UNIVERSAL,De.Type.OID,!1,De.oidToDer(t.encryptedContent.algorithm).getBytes()),De.create(De.Class.UNIVERSAL,De.Type.NULL,!1,"")]),De.create(De.Class.UNIVERSAL,De.Type.OCTETSTRING,!1,t.encryptedContent.content)])}s(Rfr,"_recipientToAsn1");function kfr(t){for(var e=[],r=0;r<t.length;++r)e.push(_fr(t[r]));return e}s(kfr,"_recipientsFromAsn1");function Pfr(t){for(var e=[],r=0;r<t.length;++r)e.push(Rfr(t[r]));return e}s(Pfr,"_recipientsToAsn1");function Dfr(t){var e=De.create(De.Class.UNIVERSAL,De.Type.SEQUENCE,!0,[De.create(De.Class.UNIVERSAL,De.Type.INTEGER,!1,De.integerToDer(t.version).getBytes()),De.create(De.Class.UNIVERSAL,De.Type.SEQUENCE,!0,[lr.pki.distinguishedNameToAsn1({attributes:t.issuer}),De.create(De.Class.UNIVERSAL,De.Type.INTEGER,!1,lr.util.hexToBytes(t.serialNumber))]),De.create(De.Class.UNIVERSAL,De.Type.SEQUENCE,!0,[De.create(De.Class.UNIVERSAL,De.Type.OID,!1,De.oidToDer(t.digestAlgorithm).getBytes()),De.create(De.Class.UNIVERSAL,De.Type.NULL,!1,"")])]);if(t.authenticatedAttributesAsn1&&e.value.push(t.authenticatedAttributesAsn1),e.value.push(De.create(De.Class.UNIVERSAL,De.Type.SEQUENCE,!0,[De.create(De.Class.UNIVERSAL,De.Type.OID,!1,De.oidToDer(t.signatureAlgorithm).getBytes()),De.create(De.Class.UNIVERSAL,De.Type.NULL,!1,"")])),e.value.push(De.create(De.Class.UNIVERSAL,De.Type.OCTETSTRING,!1,t.signature)),t.unauthenticatedAttributes.length>0){for(var r=De.create(De.Class.CONTEXT_SPECIFIC,1,!0,[]),n=0;n<t.unauthenticatedAttributes.length;++n){var i=t.unauthenticatedAttributes[n];r.values.push(Uwe(i))}e.value.push(r)}return e}s(Dfr,"_signerToAsn1");function Bfr(t){for(var e=[],r=0;r<t.length;++r)e.push(Dfr(t[r]));return e}s(Bfr,"_signersToAsn1");function Uwe(t){var e;if(t.type===lr.pki.oids.contentType)e=De.create(De.Class.UNIVERSAL,De.Type.OID,!1,De.oidToDer(t.value).getBytes());else if(t.type===lr.pki.oids.messageDigest)e=De.create(De.Class.UNIVERSAL,De.Type.OCTETSTRING,!1,t.value.bytes());else if(t.type===lr.pki.oids.signingTime){var r=new Date("1950-01-01T00:00:00Z"),n=new Date("2050-01-01T00:00:00Z"),i=t.value;if(typeof i=="string"){var o=Date.parse(i);isNaN(o)?i.length===13?i=De.utcTimeToDate(i):i=De.generalizedTimeToDate(i):i=new Date(o)}i>=r&&i<n?e=De.create(De.Class.UNIVERSAL,De.Type.UTCTIME,!1,De.dateToUtcTime(i)):e=De.create(De.Class.UNIVERSAL,De.Type.GENERALIZEDTIME,!1,De.dateToGeneralizedTime(i))}return De.create(De.Class.UNIVERSAL,De.Type.SEQUENCE,!0,[De.create(De.Class.UNIVERSAL,De.Type.OID,!1,De.oidToDer(t.type).getBytes()),De.create(De.Class.UNIVERSAL,De.Type.SET,!0,[e])])}s(Uwe,"_attributeToAsn1");function Nfr(t){return[De.create(De.Class.UNIVERSAL,De.Type.OID,!1,De.oidToDer(lr.pki.oids.data).getBytes()),De.create(De.Class.UNIVERSAL,De.Type.SEQUENCE,!0,[De.create(De.Class.UNIVERSAL,De.Type.OID,!1,De.oidToDer(t.algorithm).getBytes()),t.parameter?De.create(De.Class.UNIVERSAL,De.Type.OCTETSTRING,!1,t.parameter.getBytes()):void 0]),De.create(De.Class.CONTEXT_SPECIFIC,0,!0,[De.create(De.Class.UNIVERSAL,De.Type.OCTETSTRING,!1,t.content.getBytes())])]}s(Nfr,"_encryptedContentToAsn1");function qwe(t,e,r){var n={},i=[];if(!De.validate(e,r,n,i)){var o=new Error("Cannot read PKCS#7 message. ASN.1 object is not a supported PKCS#7 message.");throw o.errors=o,o}var a=De.derToOid(n.contentType);if(a!==lr.pki.oids.data)throw new Error("Unsupported PKCS#7 message. Only wrapped ContentType Data supported.");if(n.encryptedContent){var c="";if(lr.util.isArray(n.encryptedContent))for(var l=0;l<n.encryptedContent.length;++l){if(n.encryptedContent[l].type!==De.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting encrypted content constructed of only OCTET STRING objects.");c+=n.encryptedContent[l].value}else c=n.encryptedContent;t.encryptedContent={algorithm:De.derToOid(n.encAlgorithm),parameter:lr.util.createBuffer(n.encParameter.value),content:lr.util.createBuffer(c)}}if(n.content){var c="";if(lr.util.isArray(n.content))for(var l=0;l<n.content.length;++l){if(n.content[l].type!==De.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting content constructed of only OCTET STRING objects.");c+=n.content[l].value}else c=n.content;t.content=lr.util.createBuffer(c)}return t.version=n.version.charCodeAt(0),t.rawCapture=n,n}s(qwe,"_fromAsn1");function Nlt(t){if(t.encryptedContent.key===void 0)throw new Error("Symmetric key not available.");if(t.content===void 0){var e;switch(t.encryptedContent.algorithm){case lr.pki.oids["aes128-CBC"]:case lr.pki.oids["aes192-CBC"]:case lr.pki.oids["aes256-CBC"]:e=lr.aes.createDecryptionCipher(t.encryptedContent.key);break;case lr.pki.oids.desCBC:case lr.pki.oids["des-EDE3-CBC"]:e=lr.des.createDecryptionCipher(t.encryptedContent.key);break;default:throw new Error("Unsupported symmetric cipher, OID "+t.encryptedContent.algorithm)}if(e.start(t.encryptedContent.parameter),e.update(t.encryptedContent.content),!e.finish())throw new Error("Symmetric decryption failed.");t.content=e.output}}s(Nlt,"_decryptContent")});var Olt=H((Eyi,Flt)=>{d();var hl=Ri();Cw();$N();Bre();VN();Ho();var rne=Flt.exports=hl.ssh=hl.ssh||{};rne.privateKeyToPutty=function(t,e,r){r=r||"",e=e||"";var n="ssh-rsa",i=e===""?"none":"aes256-cbc",o="PuTTY-User-Key-File-2: "+n+`\r
`;o+="Encryption: "+i+`\r
`,o+="Comment: "+r+`\r
`;var a=hl.util.createBuffer();t8(a,n),y1(a,t.e),y1(a,t.n);var c=hl.util.encode64(a.bytes(),64),l=Math.floor(c.length/66)+1;o+="Public-Lines: "+l+`\r
`,o+=c;var u=hl.util.createBuffer();y1(u,t.d),y1(u,t.p),y1(u,t.q),y1(u,t.qInv);var f;if(!e)f=hl.util.encode64(u.bytes(),64);else{var p=u.length()+16-1;p-=p%16;var m=tne(u.bytes());m.truncate(m.length()-p+u.length()),u.putBuffer(m);var h=hl.util.createBuffer();h.putBuffer(tne("\0\0\0\0",e)),h.putBuffer(tne("\0\0\0",e));var g=hl.aes.createEncryptionCipher(h.truncate(8),"CBC");g.start(hl.util.createBuffer().fillWithByte(0,16)),g.update(u.copy()),g.finish();var A=g.output;A.truncate(16),f=hl.util.encode64(A.bytes(),64)}l=Math.floor(f.length/66)+1,o+=`\r
Private-Lines: `+l+`\r
`,o+=f;var y=tne("putty-private-key-file-mac-key",e),E=hl.util.createBuffer();t8(E,n),t8(E,i),t8(E,r),E.putInt32(a.length()),E.putBuffer(a),E.putInt32(u.length()),E.putBuffer(u);var b=hl.hmac.create();return b.start("sha1",y),b.update(E.bytes()),o+=`\r
Private-MAC: `+b.digest().toHex()+`\r
`,o};rne.publicKeyToOpenSSH=function(t,e){var r="ssh-rsa";e=e||"";var n=hl.util.createBuffer();return t8(n,r),y1(n,t.e),y1(n,t.n),r+" "+hl.util.encode64(n.bytes())+" "+e};rne.privateKeyToOpenSSH=function(t,e){return e?hl.pki.encryptRsaPrivateKey(t,e,{legacy:!0,algorithm:"aes128"}):hl.pki.privateKeyToPem(t)};rne.getPublicKeyFingerprint=function(t,e){e=e||{};var r=e.md||hl.md.md5.create(),n="ssh-rsa",i=hl.util.createBuffer();t8(i,n),y1(i,t.e),y1(i,t.n),r.start(),r.update(i.getBytes());var o=r.digest();if(e.encoding==="hex"){var a=o.toHex();return e.delimiter?a.match(/.{2}/g).join(e.delimiter):a}else{if(e.encoding==="binary")return o.getBytes();if(e.encoding)throw new Error('Unknown encoding "'+e.encoding+'".')}return o};function y1(t,e){var r=e.toString(16);r[0]>="8"&&(r="00"+r);var n=hl.util.hexToBytes(r);t.putInt32(n.length),t.putBytes(n)}s(y1,"_addBigIntegerToBuffer");function t8(t,e){t.putInt32(e.length),t.putString(e)}s(t8,"_addStringToBuffer");function tne(){for(var t=hl.md.sha1.create(),e=arguments.length,r=0;r<e;++r)t.update(arguments[r]);return t.digest()}s(tne,"_sha1")});var Ult=H((Tyi,Qlt)=>{d();Qlt.exports=Ri();Cw();olt();YA();wre();GQ();blt();$N();Slt();Plt();Blt();pwe();Fre();Ik();awe();gwe();Llt();ywe();lwe();ZTe();Wre();Gh();rwe();Olt();Iwe();Ho()});var $lt=H(Dk=>{"use strict";d();Object.defineProperty(Dk,"__esModule",{value:!0});Dk.convert=Dk.Format=void 0;var nU=Ult(),_w;(function(t){t.der="der",t.pem="pem",t.txt="txt",t.asn1="asn1",t.x509="x509",t.fingerprint="fingerprint"})(_w=Dk.Format||(Dk.Format={}));function qlt(t){var e=nU.pki.pemToDer(t),r=nU.asn1,n=r.fromDer(e.data.toString("binary")).value[0].value,i=n[0],o=i.tagClass===r.Class.CONTEXT_SPECIFIC&&i.type===0&&i.constructed,a=n.slice(o);return{serial:a[0],issuer:a[2],valid:a[3],subject:a[4]}}s(qlt,"myASN");function Mfr(t){var e=qlt(t),r=e.subject.value.map(function(i){return i.value[0].value[1].value}).join("/"),n=e.valid.value.map(function(i){return i.value}).join(" - ");return["Subject	".concat(r),"Valid	".concat(n),String(t)].join(`
`)}s(Mfr,"txtFormat");function Hlt(t,e){switch(e){case _w.der:return nU.pki.pemToDer(t);case _w.pem:return t;case _w.txt:return Mfr(t);case _w.asn1:return qlt(t);case _w.fingerprint:var r=nU.md.sha1.create(),n=Hlt(t,_w.der);return r.update(n.getBytes()),r.digest().toHex();case _w.x509:return nU.pki.certificateFromPem(t);default:throw new Error("unknown format ".concat(e))}}s(Hlt,"convert");Dk.convert=Hlt});var Klt=H($p=>{"use strict";d();var Rw=$p&&$p.__assign||function(){return Rw=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t},Rw.apply(this,arguments)},nne=$p&&$p.__spreadArray||function(t,e,r){if(r||arguments.length===2)for(var n=0,i=e.length,o;n<i;n++)(o||!(n in e))&&(o||(o=Array.prototype.slice.call(e,0,n)),o[n]=e[n]);return t.concat(o||Array.prototype.slice.call(e))};Object.defineProperty($p,"__esModule",{value:!0});$p.convert=$p.Format=$p.addToGlobalAgent=$p.get=void 0;var Hwe=require("https"),Lfr=require("tls"),Wlt=require("child_process"),jlt=Iat(),rE=$lt();Object.defineProperty($p,"Format",{enumerable:!0,get:s(function(){return rE.Format},"get")});Object.defineProperty($p,"convert",{enumerable:!0,get:s(function(){return rE.convert},"get")});var Glt=process.platform==="darwin",Vlt=Hwe.globalAgent,one={keychain:"all",unique:!0,excludeBundled:!0,format:rE.Format.pem};function zlt(t){if(t===void 0&&(t=one),!Glt)return[];t=Rw(Rw({},one),t);var e=/(?=-----BEGIN\sCERTIFICATE-----)/g,r=["find-certificate","-a","-p"],n=[];if(t.keychain==="all"||t.keychain==="SystemRootCertificates"){var i="/System/Library/Keychains/SystemRootCertificates.keychain",o=(0,Wlt.spawnSync)("/usr/bin/security",r.concat(i)).stdout.toString().split(e).map(function(u){return u.trim()});n=nne(nne([],n,!0),o,!0)}if(t.keychain==="all"||t.keychain==="current"){var a=(0,Wlt.spawnSync)("/usr/bin/security",r).stdout.toString().split(e).map(function(u){return u.trim()});n=nne(nne([],n,!0),a,!0)}if(t.unique||t.excludeBundled){var c=n.map(function(u){return(0,rE.convert)(u,rE.Format.fingerprint)}),l=t.excludeBundled?Lfr.rootCertificates.map(function(u){return(0,rE.convert)(u,rE.Format.fingerprint)}):[];n=n.filter(function(u,f){var p=c[f];return!(t.unique&&f!==c.indexOf(p)||t.excludeBundled&&l.includes(p))})}return n.map(function(u){return(0,rE.convert)(u,t.format)})}s(zlt,"get");$p.get=zlt;var ine=Vlt.options.ca,Ffr=s(function(t){if(t===void 0&&(t=one),!!Glt){var e;Array.isArray(ine)?e=Array.from(ine):e=typeof ine<"u"?[ine]:[],zlt(Rw(Rw(Rw({},one),t),{format:rE.Format.pem,excludeBundled:!1})).forEach(function(r){return e.push(r)}),Vlt.options.ca=e,Hwe.Agent=function(r){var n=s(function(i){var o=typeof i<"u"?Rw({},i):{};return typeof o.ca>"u"&&(o.ca=e),r.call(this,o)},"newAgent");return n.prototype=r.prototype,n}(Hwe.Agent),(0,jlt.setGlobalDispatcher)(new jlt.Agent({connect:{ca:e}}))}},"addToGlobalAgent");$p.addToGlobalAgent=Ffr});var Ylt=H((Byi,$we)=>{d();function Ofr(){let{X509Certificate:t}=require("crypto"),{join:e}=require("path");var r=typeof __webpack_require__=="function"?__non_webpack_require__:require;let n=process.arch==="arm64"?"crypt32-arm64.node":"crypt32.node",i=r(e(__dirname,n)),o=[],a=new i.Crypt32;try{let c;for(;c=a.next();){let l=new t(c);o.push(l.toString())}}finally{a.done()}return Array.from(new Set(o))}s(Ofr,"all");process.platform!=="win32"?$we.exports.all=()=>[]:$we.exports.all=Ofr});var iut=H((Uyi,nut)=>{"use strict";d();function rut(t,e,r){let n=e[r];if(t==null&&n.required===!1)return;if(t==null)throw new TypeError(`Required parameter \`${n.name}\` missing`);let i=typeof t;if(n.type&&i!==n.type){if(n.required===!1&&e.slice(r).some(o=>o.type===i))return!1;throw new TypeError(`Invalid type for parameter \`${n.name}\`, expected \`${n.type}\` but found \`${typeof t}\``)}return!0}s(rut,"validateParameter");function Ufr(t,e){return Object.prototype.hasOwnProperty.call(t,e)}s(Ufr,"hasOwnProperty");function qfr(t,e){return function(){let r=Array.prototype.slice.call(arguments),n=[];for(let o=0,a=0;o<e.length;++o,++a){let c=e[o],l=r[a];Ufr(c,"default")&&l==null&&(l=c.default),c.type==="object"&&c.default!=null&&(l=Object.assign({},c.default,l)),c.name==="options"&&(typeof l=="function"||l==null)&&(l={}),rut(l,e,o)?n.push(l):a--}if(typeof arguments[arguments.length-1]!="function")return new Promise((o,a)=>{n.push((c,l)=>{if(c)return a(c);o(l)}),t.apply(this,n)});t.apply(this,n)}}s(qfr,"defineOperation");nut.exports={defineOperation:qfr,validateParameter:rut}});var Xwe=H(($yi,cut)=>{"use strict";d();var i8=t1e()("kerberos"),n8=i8.KerberosClient,sut=i8.KerberosServer,kw=iut().defineOperation,Hfr=1,$fr=2,Wfr=4,jfr=8,Gfr=16,Vfr=32,zfr=64,Kfr=128,Yfr=256,aut=0,Jfr=9,Xfr=6;n8.prototype.step=kw(n8.prototype.step,[{name:"challenge",type:"string"},{name:"callback",type:"function",required:!1}]);n8.prototype.wrap=kw(n8.prototype.wrap,[{name:"challenge",type:"string"},{name:"options",type:"object"},{name:"callback",type:"function",required:!1}]);n8.prototype.unwrap=kw(n8.prototype.unwrap,[{name:"challenge",type:"string"},{name:"callback",type:"function",required:!1}]);sut.prototype.step=kw(sut.prototype.step,[{name:"challenge",type:"string"},{name:"callback",type:"function",required:!1}]);var Zfr=kw(i8.checkPassword,[{name:"username",type:"string"},{name:"password",type:"string"},{name:"service",type:"string"},{name:"defaultRealm",type:"string",required:!1},{name:"callback",type:"function",required:!1}]),epr=kw(i8.principalDetails,[{name:"service",type:"string"},{name:"hostname",type:"string"},{name:"callback",type:"function",required:!1}]),tpr=kw(i8.initializeClient,[{name:"service",type:"string"},{name:"options",type:"object",default:{mechOID:aut}},{name:"callback",type:"function",required:!1}]),rpr=kw(i8.initializeServer,[{name:"service",type:"string"},{name:"callback",type:"function",required:!1}]);cut.exports={initializeClient:tpr,initializeServer:rpr,principalDetails:epr,checkPassword:Zfr,GSS_C_DELEG_FLAG:Hfr,GSS_C_MUTUAL_FLAG:$fr,GSS_C_REPLAY_FLAG:Wfr,GSS_C_SEQUENCE_FLAG:jfr,GSS_C_CONF_FLAG:Gfr,GSS_C_INTEG_FLAG:Vfr,GSS_C_ANON_FLAG:zfr,GSS_C_PROT_READY_FLAG:Kfr,GSS_C_TRANS_FLAG:Yfr,GSS_C_NO_OID:aut,GSS_MECH_OID_KRB5:Jfr,GSS_MECH_OID_SPNEGO:Xfr}});var lut=H((jyi,npr)=>{npr.exports={name:"kerberos",version:"2.2.0",description:"Kerberos library for Node.js",main:"lib/index.js",files:["lib","src","binding.gyp","HISTORY.md","README.md"],repository:{type:"git",url:"https://github.com/mongodb-js/kerberos.git"},keywords:["kerberos","security","authentication"],author:{name:"The MongoDB NodeJS Team",email:"dbx-node@mongodb.com"},bugs:{url:"https://jira.mongodb.org/projects/NODE/issues/"},dependencies:{bindings:"^1.5.0","node-addon-api":"^6.1.0","prebuild-install":"^7.1.2"},devDependencies:{"@types/node":"^22.2.0",chai:"^4.4.1","chai-string":"^1.5.0",chalk:"^4.1.2","clang-format":"^1.8.0","dmd-clear":"^0.1.2",eslint:"^9.9.0","eslint-config-prettier":"^9.1.0","eslint-plugin-prettier":"^5.2.1","jsdoc-to-markdown":"^8.0.3",mocha:"^10.7.3",mongodb:"^6.8.0","node-gyp":"^10.1.0",prebuild:"^13.0.0",prettier:"^3.3.3",request:"^2.88.2"},overrides:{prebuild:{"node-gyp":"$node-gyp"}},scripts:{install:"prebuild-install --runtime napi || node-gyp rebuild","format-cxx":"clang-format -i 'src/**/*'","format-js":"ESLINT_USE_FLAT_CONFIG=false eslint lib test --fix","check:lint":"ESLINT_USE_FLAT_CONFIG=false eslint lib test",precommit:"check-clang-format",docs:"jsdoc2md --template etc/README.hbs --plugin dmd-clear --files lib/kerberos.js > README.md",test:"mocha test",prebuild:"prebuild --runtime napi --strip --verbose --all"},engines:{node:">=12.9.0"},binary:{napi_versions:[4]},license:"Apache-2.0",readmeFilename:"README.md"}});var dut=H((Gyi,uut)=>{"use strict";d();var ipr=require("dns"),opr=Xwe(),Zwe=class{static{s(this,"MongoAuthProcess")}constructor(e,r,n,i){i=i||{},this.host=e,this.port=r,this.serviceName=n||i.gssapiServiceName||"mongodb",this.canonicalizeHostName=typeof i.gssapiCanonicalizeHostName=="boolean"?i.gssapiCanonicalizeHostName:!1,this._transition=spr(this),this.retries=10}init(e,r,n){let i=this;this.username=e,this.password=r;function o(a,c,l){if(!a)return l();ipr.resolveCname(c,(u,f)=>{if(u)return l(u);Array.isArray(f)&&f.length>0&&(i.host=f[0]),l()})}s(o,"performGssapiCanonicalizeHostName"),o(this.canonicalizeHostName,this.host,a=>{if(a)return n(a);let c={};r!=null&&Object.assign(c,{user:e,password:r});let l=process.platform==="win32"?`${this.serviceName}/${this.host}`:`${this.serviceName}@${this.host}`;opr.initializeClient(l,c,(u,f)=>{if(u)return n(u,null);i.client=f,n(null,f)})})}transition(e,r){if(this._transition==null)return r(new Error("Transition finished"));this._transition(e,r)}};function spr(t){return(e,r)=>{t.client.step("",(n,i)=>{if(n)return r(n);t._transition=apr(t),r(null,i)})}}s(spr,"firstTransition");function apr(t){return(e,r)=>{t.client.step(e,(n,i)=>{if(n&&t.retries===0)return r(n);if(n)return t.retries=t.retries-1,t.transition(e,r);t._transition=cpr(t),r(null,i||"")})}}s(apr,"secondTransition");function cpr(t){return(e,r)=>{t.client.unwrap(e,(n,i)=>{if(n)return r(n,!1);t.client.wrap(i,{user:t.username},(o,a)=>{if(o)return r(o,!1);t._transition=lpr(t),r(null,a)})})}}s(cpr,"thirdTransition");function lpr(t){return(e,r)=>{t._transition=null,r(null,!0)}}s(lpr,"fourthTransition");uut.exports={MongoAuthProcess:Zwe}});var put=H((Kyi,iU)=>{"use strict";d();var fut=Xwe();iU.exports=fut;iU.exports.Kerberos=fut;iU.exports.version=lut().version;iU.exports.processes={MongoAuthProcess:dut().MongoAuthProcess}});var Idt=H(DSe=>{"use strict";d();Object.defineProperty(DSe,"__esModule",{value:!0});DSe.assertNever=V0r;function V0r(t,e=`unexpected value ${t}`){throw new Error(`Unreachable: ${e}`)}s(V0r,"assertNever")});var RU=H(mE=>{"use strict";d();Object.defineProperty(mE,"__esModule",{value:!0});mE.ChatCompletionContentPartOpaque=mE.ChatCompletionContentPartKind=mE.ChatRole=void 0;var z0r=Idt(),cie;(function(t){t[t.System=0]="System",t[t.User=1]="User",t[t.Assistant=2]="Assistant",t[t.Tool=3]="Tool"})(cie||(mE.ChatRole=cie={}));(function(t){function e(r){switch(r){case t.System:return"system";case t.User:return"user";case t.Assistant:return"assistant";case t.Tool:return"tool";default:(0,z0r.assertNever)(r,`unknown chat role ${r}}`)}}s(e,"display"),t.display=e})(cie||(mE.ChatRole=cie={}));var Tdt;(function(t){t[t.Image=0]="Image",t[t.Text=1]="Text",t[t.Opaque=2]="Opaque",t[t.CacheBreakpoint=3]="CacheBreakpoint"})(Tdt||(mE.ChatCompletionContentPartKind=Tdt={}));var wdt;(function(t){function e(r,n){return!r.scope||(r.scope&n)!==0}s(e,"usableIn"),t.usableIn=e})(wdt||(mE.ChatCompletionContentPartOpaque=wdt={}))});var BSe=H(R1=>{"use strict";d();Object.defineProperty(R1,"__esModule",{value:!0});R1.BaseTokensPerName=R1.BaseTokensPerMessage=R1.BaseTokensPerCompletion=R1.ChatRole=void 0;var Sdt;(function(t){t.System="system",t.User="user",t.Assistant="assistant",t.Function="function",t.Tool="tool"})(Sdt||(R1.ChatRole=Sdt={}));R1.BaseTokensPerCompletion=3;R1.BaseTokensPerMessage=3;R1.BaseTokensPerName=1});var Rdt=H(uie=>{"use strict";d();Object.defineProperty(uie,"__esModule",{value:!0});uie.toOpenAiChatMessage=_dt;uie.toOpenAIChatMessages=J0r;var hE=RU(),lie=BSe(),K0r=Hw();function NSe(t){return t.filter(e=>e.type===hE.ChatCompletionContentPartKind.Text).map(e=>e.text).join("")}s(NSe,"onlyStringContent");function Y0r(t){let e=t.map(r=>{if(r.type===hE.ChatCompletionContentPartKind.Text)return{type:"text",text:r.text};if(r.type===hE.ChatCompletionContentPartKind.Image)return{image_url:r.imageUrl,type:"image_url"};if(r.type===hE.ChatCompletionContentPartKind.Opaque&&hE.ChatCompletionContentPartOpaque.usableIn(r,K0r.OutputMode.OpenAI))return r}).filter(r=>!!r);return e.every(r=>r.type==="text")?e.map(r=>r.text).join(""):e}s(Y0r,"stringAndImageContent");function _dt(t){switch(t.role){case hE.ChatRole.System:return{role:lie.ChatRole.System,content:NSe(t.content),name:t.name};case hE.ChatRole.User:return{role:lie.ChatRole.User,content:Y0r(t.content),name:t.name};case hE.ChatRole.Assistant:return{role:lie.ChatRole.Assistant,content:NSe(t.content),name:t.name,tool_calls:t.toolCalls?.map(e=>({id:e.id,function:e.function,type:"function"}))};case hE.ChatRole.Tool:return{role:lie.ChatRole.Tool,content:NSe(t.content),tool_call_id:t.toolCallId};default:return}}s(_dt,"toOpenAiChatMessage");function J0r(t){return t.map(_dt).filter(e=>!!e)}s(J0r,"toOpenAIChatMessages")});var Pdt=H(pie=>{"use strict";d();Object.defineProperty(pie,"__esModule",{value:!0});pie.toVsCodeChatMessage=kdt;pie.toVsCodeChatMessages=X0r;var fie=RU();function die(t){return t.filter(e=>e.type===fie.ChatCompletionContentPartKind.Text).map(e=>e.text).join("")}s(die,"onlyStringContent");var $w;function kdt(t){switch($w??=require("vscode"),t.role){case fie.ChatRole.Assistant:let e=$w.LanguageModelChatMessage.Assistant(die(t.content),t.name);return t.toolCalls&&(e.content=[new $w.LanguageModelTextPart(die(t.content)),...t.toolCalls.map(r=>{let n;try{n=JSON.parse(r.function.arguments)}catch{throw new Error("Invalid JSON in tool call arguments for tool call: "+r.id)}return new $w.LanguageModelToolCallPart(r.id,r.function.name,n)})]),e;case fie.ChatRole.User:return $w.LanguageModelChatMessage.User(die(t.content),t.name);case fie.ChatRole.Tool:{let r=$w.LanguageModelChatMessage.User("");return r.content=[new $w.LanguageModelToolResultPart(t.toolCallId,[new $w.LanguageModelTextPart(die(t.content))])],r}default:return}}s(kdt,"toVsCodeChatMessage");function X0r(t){return t.map(kdt).filter(e=>!!e)}s(X0r,"toVsCodeChatMessages")});var Hw=H(iy=>{"use strict";d();Object.defineProperty(iy,"__esModule",{value:!0});iy.OutputMode=iy.Raw=iy.OpenAI=void 0;iy.toMode=MSe;iy.toVSCode=Z0r;iy.toOpenAI=emr;var Ddt=Rdt(),Bdt=Pdt();iy.OpenAI=BSe();iy.Raw=RU();var Wk;(function(t){t[t.Raw=1]="Raw",t[t.OpenAI=2]="OpenAI",t[t.VSCode=4]="VSCode"})(Wk||(iy.OutputMode=Wk={}));function MSe(t,e){switch(t){case Wk.Raw:return e;case Wk.VSCode:return e instanceof Array?(0,Bdt.toVsCodeChatMessages)(e):(0,Bdt.toVsCodeChatMessage)(e);case Wk.OpenAI:return e instanceof Array?(0,Ddt.toOpenAIChatMessages)(e):(0,Ddt.toOpenAiChatMessage)(e);default:throw new Error(`Unknown output mode: ${t}`)}}s(MSe,"toMode");function Z0r(t){return MSe(Wk.VSCode,t)}s(Z0r,"toVSCode");function emr(t){return MSe(Wk.OpenAI,t)}s(emr,"toOpenAI")});var LSe=H(kU=>{"use strict";d();Object.defineProperty(kU,"__esModule",{value:!0});kU.jsonRetainedProps=void 0;kU.forEachNode=Ndt;kU.jsonRetainedProps=Object.keys({flexBasis:1,flexGrow:1,flexReserve:1,passPriority:1,priority:1});function Ndt(t,e){if(e(t),t.type===1)for(let r of t.children)Ndt(r,e)}s(Ndt,"forEachNode")});var Mdt=H(FSe=>{"use strict";d();Object.defineProperty(FSe,"__esModule",{value:!0});FSe.once=tmr;function tmr(t){let e,r=!1,n=s((...i)=>(r||(e=t(...i),r=!0),e),"wrappedFunction");return n.clear=()=>{r=!1},n}s(tmr,"once")});var qSe=H(Yd=>{"use strict";d();Object.defineProperty(Yd,"__esModule",{value:!0});Yd.BudgetExceededError=Yd.MaterializedChatMessageImage=Yd.MaterializedChatMessageBreakpoint=Yd.MaterializedChatMessageOpaque=Yd.MaterializedChatMessage=Yd.MaterializedChatMessageTextChunk=Yd.GenericMaterializedContainer=void 0;var v8=Mdt(),um=Hw(),gE=class t{static{s(this,"GenericMaterializedContainer")}parent;id;name;priority;metadata;flags;children;keepWithId;constructor(e,r,n,i,o,a,c){if(this.parent=e,this.id=r,this.name=n,this.priority=i,this.metadata=a,this.flags=c,this.children=o(this),c&8){if(this.children.length!==2)throw new Error("Invalid number of children for EmptyAlternate flag");let[l,u]=this.children;u.isEmpty?this.children=[l]:this.children=[u]}}has(e){return!!(this.flags&e)}async tokenCount(e){let r=0;return await Promise.all(this.children.map(async n=>{let i=jw(n)?await n.tokenCount(e):await n.upperBoundTokenCount(e);r+=i})),r}async upperBoundTokenCount(e){let r=0;return await Promise.all(this.children.map(async n=>{let i=await n.upperBoundTokenCount(e);r+=i})),r}replaceNode(e,r){return Wdt(e,this.children,r)}allMetadata(){return $dt(this)}findById(e){return USe(e,this)}get isEmpty(){return!this.children.some(e=>!e.isEmpty)}onChunksChange(){this.parent?.onChunksChange()}*toChatMessages(){for(let e of this.children)rmr(e),e instanceof t?yield*e.toChatMessages():!e.isEmpty&&e instanceof sy&&(yield e.toChatMessage())}async baseMessageTokenCount(e){let r=0;return await Promise.all(this.children.map(async n=>{if(n instanceof sy||n instanceof t){let i=await n.baseMessageTokenCount(e);r+=i}})),r}removeLowestPriorityChild(){let e=[];return QSe(this,e),e}};Yd.GenericMaterializedContainer=gE;var PU=class{static{s(this,"MaterializedChatMessageTextChunk")}parent;text;priority;metadata;lineBreakBefore;constructor(e,r,n,i=[],o){this.parent=e,this.text=r,this.priority=n,this.metadata=i,this.lineBreakBefore=o}upperBoundTokenCount(e){return this._upperBound(e)}_upperBound=(0,v8.once)(async e=>await e.tokenLength({type:um.Raw.ChatCompletionContentPartKind.Text,text:this.text})+(this.lineBreakBefore!==0?1:0));get isEmpty(){return!/\S/.test(this.text)}};Yd.MaterializedChatMessageTextChunk=PU;var sy=class{static{s(this,"MaterializedChatMessage")}parent;id;role;name;toolCalls;toolCallId;priority;metadata;children;constructor(e,r,n,i,o,a,c,l,u){this.parent=e,this.id=r,this.role=n,this.name=i,this.toolCalls=o,this.toolCallId=a,this.priority=c,this.metadata=l,this.children=u(this)}async tokenCount(e){return this._tokenCount(e)}async upperBoundTokenCount(e){return this._upperBound(e)}get text(){return this._text()}get isEmpty(){return!this.toolCalls?.length&&!this.children.some(e=>!e.isEmpty)}replaceNode(e,r){let n=Wdt(e,this.children,r);return n&&this.onChunksChange(),n}removeLowestPriorityChild(){let e=[];return QSe(this,e),e}onChunksChange(){this._tokenCount.clear(),this._upperBound.clear(),this._text.clear(),this.parent?.onChunksChange()}findById(e){return USe(e,this)}_tokenCount=(0,v8.once)(async e=>{let r=this.toChatMessage();return e.countMessageTokens((0,um.toMode)(e.mode,r))});_upperBound=(0,v8.once)(async e=>{let r=await this.baseMessageTokenCount(e);return await Promise.all(this.children.map(async n=>{let i=await n.upperBoundTokenCount(e);r+=i})),r});baseMessageTokenCount=(0,v8.once)(e=>{let r=this.toChatMessage();return r.content=r.content.map(n=>n.type===um.Raw.ChatCompletionContentPartKind.Text?{...n,text:""}:n.type===um.Raw.ChatCompletionContentPartKind.Image?void 0:n).filter(n=>!!n),e.countMessageTokens((0,um.toMode)(e.mode,r))});_text=(0,v8.once)(()=>{let e=[];for(let{content:r,isTextSibling:n}of qdt(this)){if(r instanceof jk||r instanceof Ww){e.push(r);continue}if(r instanceof oy){e.at(-1)instanceof oy?e[e.length-1]=r:e.push(r);continue}if(r.lineBreakBefore===1||r.lineBreakBefore===2&&!n){let i=e[e.length-1];typeof i=="string"&&i&&!i.endsWith(`
`)&&(e[e.length-1]=i+`
`)}typeof e[e.length-1]=="string"?e[e.length-1]+=r.text:e.push(r.text)}return e});toChatMessage(){let e=this.text.map(r=>{if(typeof r=="string")return{type:um.Raw.ChatCompletionContentPartKind.Text,text:r};if(r instanceof jk)return{type:um.Raw.ChatCompletionContentPartKind.Image,imageUrl:{url:jdt(r.src),detail:r.detail}};if(r instanceof Ww)return r.value;if(r instanceof oy)return r.part;throw new Error("Unexpected element type")});if(this.role===um.Raw.ChatRole.System)return{role:this.role,content:e,...this.name?{name:this.name}:{}};if(this.role===um.Raw.ChatRole.Assistant){let r={role:this.role,content:e};return this.name&&(r.name=this.name),this.toolCalls?.length&&(r.toolCalls=this.toolCalls.map(n=>({function:n.function,id:n.id,type:n.type}))),r}else return this.role===um.Raw.ChatRole.User?{role:this.role,content:e,...this.name?{name:this.name}:{}}:this.role===um.Raw.ChatRole.Tool?{role:this.role,content:e,toolCallId:this.toolCallId}:{role:this.role,content:e,name:this.name}}};Yd.MaterializedChatMessage=sy;var Ww=class{static{s(this,"MaterializedChatMessageOpaque")}parent;part;metadata=[];priority=Number.MAX_SAFE_INTEGER;get value(){return this.part.value}constructor(e,r){this.parent=e,this.part=r}upperBoundTokenCount(e){return this.part.tokenUsage&&um.Raw.ChatCompletionContentPartOpaque.usableIn(this.part,e.mode)?this.part.tokenUsage:0}isEmpty=!1};Yd.MaterializedChatMessageOpaque=Ww;var oy=class{static{s(this,"MaterializedChatMessageBreakpoint")}parent;part;metadata=[];priority=Number.MAX_SAFE_INTEGER;constructor(e,r){this.parent=e,this.part=r}upperBoundTokenCount(e){return 0}isEmpty=!1};Yd.MaterializedChatMessageBreakpoint=oy;var jk=class{static{s(this,"MaterializedChatMessageImage")}parent;id;src;priority;metadata;lineBreakBefore;detail;constructor(e,r,n,i,o=[],a,c){this.parent=e,this.id=r,this.src=n,this.priority=i,this.metadata=o,this.lineBreakBefore=a,this.detail=c}upperBoundTokenCount(e){return this._upperBound(e)}_upperBound=(0,v8.once)(async e=>e.tokenLength({type:um.Raw.ChatCompletionContentPartKind.Image,imageUrl:{url:jdt(this.src),detail:this.detail}}));isEmpty=!1};Yd.MaterializedChatMessageImage=jk;function jw(t){return t instanceof gE||t instanceof sy}s(jw,"isContainerType");function Udt(t){return t instanceof PU||t instanceof jk||t instanceof Ww||t instanceof oy}s(Udt,"isContentType");function rmr(t){if(!jw(t))throw new Error(`Cannot have a text node outside a ChatMessage. Text: "${t.text}"`)}s(rmr,"assertContainerOrChatMessage");function*qdt(t,e=!1){for(let r of t.children)r instanceof PU?(yield{content:r,isTextSibling:e},e=!0):r instanceof jk||r instanceof Ww||r instanceof oy?yield{content:r,isTextSibling:!1}:r instanceof Ww?yield{content:r,isTextSibling:!0}:(r&&(yield*qdt(r,e)),e=!1)}s(qdt,"contentChunks");function nmr(t,e){let r;function n(i,o){if(Udt(i))(!r||i.priority<r.node.priority)&&(r={chain:o.slice(),node:i});else{o.push(i);for(let a of i.children)n(a,o);o.pop()}}if(s(n,"findLowestInTree"),n(t,[]),!r)throw new Error("No lowest priority node found");DU(r.node,e)}s(nmr,"removeLowestPriorityLegacy");var Ldt=new WeakMap;function Hdt(t){let e=Ldt.get(t);if(e!==void 0)return e;let r=!1;return t instanceof oy?r=!0:t instanceof sy?r=t.children.some(n=>n instanceof oy):t instanceof gE&&(r=t.children.some(Hdt)),Ldt.set(t,r),r}s(Hdt,"hasCachePoint");function imr(t){if(t instanceof sy)return!0;for(let e=t.parent;e;e=e.parent)if(e instanceof sy)return!1;return!0}s(imr,"shouldLookForCachePointInNode");function QSe(t,e){let r;if(t instanceof gE&&t.has(1)){nmr(t,e);return}let n=imr(t),i=t.children.map((o,a)=>({chain:[t],index:a}));for(let o=0;o<i.length;o++){let{chain:a,index:c}=i[o],l=a[a.length-1].children[c];if(!(n&&Hdt(l)&&(r=void 0,l instanceof oy))){if(l instanceof gE&&l.has(4)){let u=[...a,l];i.splice(o+1,0,...l.children.map((f,p)=>({chain:u,index:p})))}else if(!r||l.priority<r.value.priority)r={chain:a,index:c,value:l};else if(l.priority===r.value.priority){r.lowestNested??=Fdt(r.value);let u=Fdt(l);u<r.lowestNested&&(r={chain:a,index:c,value:l,lowestNested:u})}}}if(!r)throw new mie(t);Udt(r.value)||r.value instanceof gE&&r.value.has(2)||jw(r.value)&&!r.value.children.length?DU(r.value,e):QSe(r.value,e)}s(QSe,"removeLowestPriorityChild");var mie=class extends Error{static{s(this,"BudgetExceededError")}constructor(e){let r=[e];for(;r[0].parent;)r.unshift(r[0].parent);let n=r.map(i=>i instanceof sy?i.role:i.name||"(anonymous)");super(`No lowest priority node found (path: ${n.join(" -> ")})`)}};Yd.BudgetExceededError=mie;function Fdt(t){if(!jw(t))return-1;let e=Number.MAX_SAFE_INTEGER;for(let r of t.children)e=Math.min(e,r.priority);return e}s(Fdt,"getLowestPriorityAmongChildren");function*$dt(t){yield*t.metadata;for(let e of t.children)jw(e)?yield*$dt(e):yield*e.metadata}s($dt,"allMetadata");function Wdt(t,e,r){for(let n=0;n<e.length;n++){let i=e[n];if(jw(i)){if(i.id===t){let a=e[n];return r.parent=i.parent,e[n]=r,a}let o=i.replaceNode(t,r);if(o)return o}}}s(Wdt,"replaceNode");function*Odt(t){let e=[t];for(;e.length>0;){let r=e.pop();yield r,jw(r)&&e.push(...r.children)}}s(Odt,"forEachNode");function omr(t){let e=t;for(;e.parent;)e=e.parent;return e}s(omr,"getRoot");function Qdt(t){return t instanceof gE&&t.keepWithId!==void 0}s(Qdt,"isKeepWith");var OSe=new Set;function smr(t,e){let r=new Set;for(let n of Odt(t))Qdt(n)&&!OSe.has(n.keepWithId)&&r.add(n.keepWithId);if(r.size===0)return!1;for(let n of r)OSe.add(n);try{let n=omr(t);for(let i of Odt(n))Qdt(i)&&r.has(i.keepWithId)?DU(i,e):i instanceof sy&&i.toolCalls&&(i.toolCalls=amr(i.toolCalls,o=>!(o.keepWith&&r.has(o.keepWith.id))),i.isEmpty&&DU(i,e))}finally{for(let n of r)OSe.delete(n)}}s(smr,"removeOtherKeepWiths");function USe(t,e){if(e.id===t)return e;for(let r of e.children)if(jw(r)){let n=USe(t,r);if(n)return n}}s(USe,"findNodeById");function DU(t,e){let r=t.parent;if(!r)return;let n=r.children.indexOf(t);n!==-1&&(r.children.splice(n,1),e.push(t),smr(t,e),r.isEmpty?DU(r,e):r.onChunksChange())}s(DU,"removeNode");function jdt(t){let e={"/9j/":"image/jpeg",iVBOR:"image/png",R0lGOD:"image/gif",UklGR:"image/webp"};for(let r of Object.keys(e))if(t.startsWith(r))return`data:${e[r]};base64,${t}`;return t}s(jdt,"getEncodedBase64");function amr(t,e){for(let r=0;r<t.length;r++){if(e(t[r]))continue;let n=t.slice(0,r);for(let i=r+1;i<t.length;i++)e(t[i])&&n.push(t[i]);return n}return t}s(amr,"filterIfDifferent")});var Vdt=H(()=>{"use strict";d();function cmr(t,e,...r){return{ctor:t,props:e,children:r.flat()}}s(cmr,"_vscpp");function Gdt(){throw new Error("This should not be invoked!")}s(Gdt,"_vscppf");Gdt.isFragment=!0;globalThis.vscpp=cmr;globalThis.vscppf=Gdt});var $Se=H(hie=>{"use strict";d();Object.defineProperty(hie,"__esModule",{value:!0});hie.PromptElement=void 0;Vdt();var HSe=class{static{s(this,"PromptElement")}props;get priority(){return this.props.priority??Number.MAX_SAFE_INTEGER}get insertLineBreakBefore(){return!0}constructor(e){this.props=e}};hie.PromptElement=HSe});var ZSe=H(go=>{"use strict";d();Object.defineProperty(go,"__esModule",{value:!0});go.LogicalWrapper=go.IfEmpty=go.AbstractKeepWith=go.TokenLimit=go.Expandable=go.Chunk=go.LegacyPrioritization=go.ToolResult=go.PrioritizedList=go.Image=go.TextChunk=go.ToolMessage=go.AssistantMessage=go.UserMessage=go.SystemMessage=go.BaseChatMessage=void 0;go.isChatMessagePromptElement=lmr;go.useKeepWith=pmr;var NU=Aa(),ig=$Se();function lmr(t){return t instanceof gie||t instanceof Aie||t instanceof yie}s(lmr,"isChatMessagePromptElement");var Gk=class extends ig.PromptElement{static{s(this,"BaseChatMessage")}render(){return vscpp(vscppf,null,this.props.children)}};go.BaseChatMessage=Gk;var gie=class extends Gk{static{s(this,"SystemMessage")}constructor(e){e.role=NU.Raw.ChatRole.System,super(e)}};go.SystemMessage=gie;var Aie=class extends Gk{static{s(this,"UserMessage")}constructor(e){e.role=NU.Raw.ChatRole.User,super(e)}};go.UserMessage=Aie;var yie=class extends Gk{static{s(this,"AssistantMessage")}constructor(e){e.role=NU.Raw.ChatRole.Assistant,super(e)}};go.AssistantMessage=yie;var umr=/\s+/g,WSe=class extends Gk{static{s(this,"ToolMessage")}constructor(e){e.role=NU.Raw.ChatRole.Tool,super(e)}};go.ToolMessage=WSe;var Cie=class extends ig.PromptElement{static{s(this,"TextChunk")}async prepare(e,r,n){let i=this.props.breakOnWhitespace?umr:this.props.breakOn;if(!i)return vscpp(vscppf,null,this.props.children);let o="",a=[];for(let l of this.props.children||[])if(l&&typeof l=="object"){if(typeof l.ctor!="string")throw new Error("TextChunk children must be text literals or intrinsic attributes.");l.ctor==="br"?o+=`
`:a.push(l)}else l!=null&&(o+=l);let c=await dmr(e,i,o,n);return vscpp(vscppf,null,a,c)}render(e){return e}};go.TextChunk=Cie;async function dmr(t,e,r,n){if(e instanceof RegExp){if(!e.global)throw new Error(`\`breakOn\` expression must have the global flag set (got ${e})`);e.lastIndex=0}let i="",o=-1;for(;o<r.length;){let a;typeof e=="string"?a=r.indexOf(e,o===-1?0:o+e.length):a=e.exec(r)?.index??-1,a===-1&&(a=r.length);let c=i+r.slice(Math.max(0,o),a);if(await t.countTokens({type:NU.Raw.ChatCompletionContentPartKind.Text,text:c},n)>t.tokenBudget)return i;i=c,o=a}return i}s(dmr,"getTextContentBelowBudget");var jSe=class extends ig.PromptElement{static{s(this,"Image")}constructor(e){super(e)}render(){return vscpp(vscppf,null,this.props.children)}};go.Image=jSe;var GSe=class extends ig.PromptElement{static{s(this,"PrioritizedList")}render(){let{children:e,priority:r=0,descending:n}=this.props;if(e)return vscpp(vscppf,null,e.map((i,o)=>{if(!i)return;let a=n?r-o:r-e.length+o;return typeof i!="object"?vscpp(Cie,{priority:a},i):(i.props??={},i.props.priority=a,i)}))}};go.PrioritizedList=GSe;var VSe=class extends ig.PromptElement{static{s(this,"ToolResult")}render(){return vscpp(vscppf,null,this.props.data.content.map(e=>{if(e&&typeof e.value=="string")return e.value;if(e&&e.value&&typeof e.value.node=="object")return vscpp("elementJSON",{data:e.value})}))}};go.ToolResult=VSe;var zSe=class extends ig.PromptElement{static{s(this,"LegacyPrioritization")}render(){return vscpp(vscppf,null,this.props.children)}};go.LegacyPrioritization=zSe;var KSe=class extends ig.PromptElement{static{s(this,"Chunk")}render(){return vscpp(vscppf,null,this.props.children)}};go.Chunk=KSe;var YSe=class extends ig.PromptElement{static{s(this,"Expandable")}async render(e,r){return vscpp(vscppf,null,await this.props.value(r))}};go.Expandable=YSe;var JSe=class extends ig.PromptElement{static{s(this,"TokenLimit")}render(){return vscpp(vscppf,null,this.props.children)}};go.TokenLimit=JSe;var vie=class extends ig.PromptElement{static{s(this,"AbstractKeepWith")}};go.AbstractKeepWith=vie;var fmr=0;function pmr(){let t=fmr++;return class extends vie{static{s(this,"KeepWith")}static id=t;id=t;render(){return vscpp(vscppf,null,this.props.children)}}}s(pmr,"useKeepWith");var XSe=class extends ig.PromptElement{static{s(this,"IfEmpty")}render(){return vscpp(vscppf,null,vscpp(BU,null,this.props.alt),vscpp(BU,{flexGrow:1},this.props.children))}};go.IfEmpty=XSe;var BU=class extends ig.PromptElement{static{s(this,"LogicalWrapper")}render(){return vscpp(vscppf,null,this.props.children)}};go.LogicalWrapper=BU});var Kdt=H(MU=>{"use strict";d();Object.defineProperty(MU,"__esModule",{value:!0});MU.localize=mmr;MU.localize2=hmr;MU.getConfiguredDefaultLocale=gmr;function zdt(t,e){let r;return e.length===0?r=t:r=t.replace(/\{(\d+)\}/g,function(n,i){let o=i[0];return typeof e[o]<"u"?e[o]:n}),r}s(zdt,"_format");function mmr(t,e,...r){return zdt(e,r)}s(mmr,"localize");function hmr(t,e,...r){let n=zdt(e,r);return{original:n,value:n}}s(hmr,"localize2");function gmr(t){}s(gmr,"getConfiguredDefaultLocale")});var n_e=H(Gt=>{"use strict";d();Object.defineProperty(Gt,"__esModule",{value:!0});Gt.isAndroid=Gt.isEdge=Gt.isSafari=Gt.isFirefox=Gt.isChrome=Gt.OS=Gt.setTimeout0=Gt.setTimeout0IsFaster=Gt.translationsConfigFile=Gt.platformLocale=Gt.locale=Gt.Language=Gt.language=Gt.userAgent=Gt.platform=Gt.isCI=Gt.isMobile=Gt.isIOS=Gt.webWorkerOrigin=Gt.isWebWorker=Gt.isWeb=Gt.isElectron=Gt.isNative=Gt.isLinuxSnap=Gt.isLinux=Gt.isMacintosh=Gt.isWindows=Gt.LANGUAGE_DEFAULT=void 0;Gt.PlatformToString=ymr;Gt.isLittleEndian=Cmr;Gt.isBigSurOrNewer=vmr;var Ydt=Kdt();Gt.LANGUAGE_DEFAULT="en";var OU=!1,QU=!1,FU=!1,eft=!1,tft=!1,t_e=!1,rft=!1,r_e=!1,nft=!1,ift=!1,LU,xie=Gt.LANGUAGE_DEFAULT,e_e=Gt.LANGUAGE_DEFAULT,oft,AE,yE=globalThis,dm;typeof yE.vscode<"u"&&typeof yE.vscode.process<"u"?dm=yE.vscode.process:typeof process<"u"&&(dm=process);var sft=typeof dm?.versions?.electron=="string",Amr=sft&&dm?.type==="renderer";if(typeof dm=="object"){OU=dm.platform==="win32",QU=dm.platform==="darwin",FU=dm.platform==="linux",eft=FU&&!!dm.env.SNAP&&!!dm.env.SNAP_REVISION,rft=sft,nft=!!dm.env.CI||!!dm.env.BUILD_ARTIFACTSTAGINGDIRECTORY,LU=Gt.LANGUAGE_DEFAULT,xie=Gt.LANGUAGE_DEFAULT;let t=dm.env.VSCODE_NLS_CONFIG;if(t)try{let e=JSON.parse(t),r=e.availableLanguages["*"];LU=e.locale,e_e=e.osLocale,xie=r||Gt.LANGUAGE_DEFAULT,oft=e._translationsConfigFile}catch{}tft=!0}else typeof navigator=="object"&&!Amr?(AE=navigator.userAgent,OU=AE.indexOf("Windows")>=0,QU=AE.indexOf("Macintosh")>=0,r_e=(AE.indexOf("Macintosh")>=0||AE.indexOf("iPad")>=0||AE.indexOf("iPhone")>=0)&&!!navigator.maxTouchPoints&&navigator.maxTouchPoints>0,FU=AE.indexOf("Linux")>=0,ift=AE?.indexOf("Mobi")>=0,t_e=!0,LU=Ydt.getConfiguredDefaultLocale(Ydt.localize({key:"ensureLoaderPluginIsLoaded",comment:["{Locked}"]},"_"))||Gt.LANGUAGE_DEFAULT,xie=LU,e_e=navigator.language):console.error("Unable to resolve platform.");function ymr(t){switch(t){case 0:return"Web";case 1:return"Mac";case 2:return"Linux";case 3:return"Windows"}}s(ymr,"PlatformToString");var Eie=0;QU?Eie=1:OU?Eie=3:FU&&(Eie=2);Gt.isWindows=OU;Gt.isMacintosh=QU;Gt.isLinux=FU;Gt.isLinuxSnap=eft;Gt.isNative=tft;Gt.isElectron=rft;Gt.isWeb=t_e;Gt.isWebWorker=t_e&&typeof yE.importScripts=="function";Gt.webWorkerOrigin=Gt.isWebWorker?yE.origin:void 0;Gt.isIOS=r_e;Gt.isMobile=ift;Gt.isCI=nft;Gt.platform=Eie;Gt.userAgent=AE;Gt.language=xie;var Jdt;(function(t){function e(){return Gt.language}s(e,"value"),t.value=e;function r(){return Gt.language.length===2?Gt.language==="en":Gt.language.length>=3?Gt.language[0]==="e"&&Gt.language[1]==="n"&&Gt.language[2]==="-":!1}s(r,"isDefaultVariant"),t.isDefaultVariant=r;function n(){return Gt.language==="en"}s(n,"isDefault"),t.isDefault=n})(Jdt||(Gt.Language=Jdt={}));Gt.locale=LU;Gt.platformLocale=e_e;Gt.translationsConfigFile=oft;Gt.setTimeout0IsFaster=typeof yE.postMessage=="function"&&!yE.importScripts;Gt.setTimeout0=(()=>{if(Gt.setTimeout0IsFaster){let t=[];yE.addEventListener("message",r=>{if(r.data&&r.data.vscodeScheduleAsyncWork)for(let n=0,i=t.length;n<i;n++){let o=t[n];if(o.id===r.data.vscodeScheduleAsyncWork){t.splice(n,1),o.callback();return}}});let e=0;return r=>{let n=++e;t.push({id:n,callback:r}),yE.postMessage({vscodeScheduleAsyncWork:n},"*")}}return t=>setTimeout(t)})();Gt.OS=QU||r_e?2:OU?1:3;var Xdt=!0,Zdt=!1;function Cmr(){if(!Zdt){Zdt=!0;let t=new Uint8Array(2);t[0]=1,t[1]=2,Xdt=new Uint16Array(t.buffer)[0]===513}return Xdt}s(Cmr,"isLittleEndian");Gt.isChrome=!!(Gt.userAgent&&Gt.userAgent.indexOf("Chrome")>=0);Gt.isFirefox=!!(Gt.userAgent&&Gt.userAgent.indexOf("Firefox")>=0);Gt.isSafari=!!(!Gt.isChrome&&Gt.userAgent&&Gt.userAgent.indexOf("Safari")>=0);Gt.isEdge=!!(Gt.userAgent&&Gt.userAgent.indexOf("Edg/")>=0);Gt.isAndroid=!!(Gt.userAgent&&Gt.userAgent.indexOf("Android")>=0);function vmr(t){return parseFloat(t)>=20}s(vmr,"isBigSurOrNewer")});var cft=H(k1=>{"use strict";d();Object.defineProperty(k1,"__esModule",{value:!0});k1.arch=k1.platform=k1.env=k1.cwd=void 0;var aft=n_e(),Vk,i_e=globalThis.vscode;if(typeof i_e<"u"&&typeof i_e.process<"u"){let t=i_e.process;Vk={get platform(){return t.platform},get arch(){return t.arch},get env(){return t.env},cwd(){return t.cwd()}}}else typeof process<"u"?Vk={get platform(){return process.platform},get arch(){return process.arch},get env(){return process.env},cwd(){return process.env.VSCODE_CWD||process.cwd()}}:Vk={get platform(){return aft.isWindows?"win32":aft.isMacintosh?"darwin":"linux"},get arch(){},get env(){return{}},cwd(){return"/"}};k1.cwd=Vk.cwd;k1.env=Vk.env;k1.platform=Vk.platform;k1.arch=Vk.arch});var uft=H(xr=>{"use strict";d();Object.defineProperty(xr,"__esModule",{value:!0});xr.delimiter=xr.sep=xr.toNamespacedPath=xr.parse=xr.format=xr.extname=xr.basename=xr.dirname=xr.relative=xr.resolve=xr.join=xr.isAbsolute=xr.normalize=xr.posix=xr.win32=void 0;var x8=cft(),xmr=65,Emr=97,bmr=90,Imr=122,zw=46,Eu=47,Vp=92,Gw=58,Tmr=63,bie=class extends Error{static{s(this,"ErrorInvalidArgType")}code;constructor(e,r,n){let i;typeof r=="string"&&r.indexOf("not ")===0?(i="must not be",r=r.replace(/^not /,"")):i="must be";let o=e.indexOf(".")!==-1?"property":"argument",a=`The "${e}" ${o} ${i} of type ${r}`;a+=`. Received type ${typeof n}`,super(a),this.code="ERR_INVALID_ARG_TYPE"}};function wmr(t,e){if(t===null||typeof t!="object")throw new bie(e,"Object",t)}s(wmr,"validateObject");function xc(t,e){if(typeof t!="string")throw new bie(e,"string",t)}s(xc,"validateString");var zp=x8.platform==="win32";function wi(t){return t===Eu||t===Vp}s(wi,"isPathSeparator");function o_e(t){return t===Eu}s(o_e,"isPosixPathSeparator");function Vw(t){return t>=xmr&&t<=bmr||t>=Emr&&t<=Imr}s(Vw,"isWindowsDeviceRoot");function Iie(t,e,r,n){let i="",o=0,a=-1,c=0,l=0;for(let u=0;u<=t.length;++u){if(u<t.length)l=t.charCodeAt(u);else{if(n(l))break;l=Eu}if(n(l)){if(!(a===u-1||c===1))if(c===2){if(i.length<2||o!==2||i.charCodeAt(i.length-1)!==zw||i.charCodeAt(i.length-2)!==zw){if(i.length>2){let f=i.lastIndexOf(r);f===-1?(i="",o=0):(i=i.slice(0,f),o=i.length-1-i.lastIndexOf(r)),a=u,c=0;continue}else if(i.length!==0){i="",o=0,a=u,c=0;continue}}e&&(i+=i.length>0?`${r}..`:"..",o=2)}else i.length>0?i+=`${r}${t.slice(a+1,u)}`:i=t.slice(a+1,u),o=u-a-1;a=u,c=0}else l===zw&&c!==-1?++c:c=-1}return i}s(Iie,"normalizeString");function lft(t,e){wmr(e,"pathObject");let r=e.dir||e.root,n=e.base||`${e.name||""}${e.ext||""}`;return r?r===e.root?`${r}${n}`:`${r}${t}${n}`:n}s(lft,"_format");xr.win32={resolve(...t){let e="",r="",n=!1;for(let i=t.length-1;i>=-1;i--){let o;if(i>=0){if(o=t[i],xc(o,"path"),o.length===0)continue}else e.length===0?o=x8.cwd():(o=x8.env[`=${e}`]||x8.cwd(),(o===void 0||o.slice(0,2).toLowerCase()!==e.toLowerCase()&&o.charCodeAt(2)===Vp)&&(o=`${e}\\`));let a=o.length,c=0,l="",u=!1,f=o.charCodeAt(0);if(a===1)wi(f)&&(c=1,u=!0);else if(wi(f))if(u=!0,wi(o.charCodeAt(1))){let p=2,m=p;for(;p<a&&!wi(o.charCodeAt(p));)p++;if(p<a&&p!==m){let h=o.slice(m,p);for(m=p;p<a&&wi(o.charCodeAt(p));)p++;if(p<a&&p!==m){for(m=p;p<a&&!wi(o.charCodeAt(p));)p++;(p===a||p!==m)&&(l=`\\\\${h}\\${o.slice(m,p)}`,c=p)}}}else c=1;else Vw(f)&&o.charCodeAt(1)===Gw&&(l=o.slice(0,2),c=2,a>2&&wi(o.charCodeAt(2))&&(u=!0,c=3));if(l.length>0)if(e.length>0){if(l.toLowerCase()!==e.toLowerCase())continue}else e=l;if(n){if(e.length>0)break}else if(r=`${o.slice(c)}\\${r}`,n=u,u&&e.length>0)break}return r=Iie(r,!n,"\\",wi),n?`${e}\\${r}`:`${e}${r}`||"."},normalize(t){xc(t,"path");let e=t.length;if(e===0)return".";let r=0,n,i=!1,o=t.charCodeAt(0);if(e===1)return o_e(o)?"\\":t;if(wi(o))if(i=!0,wi(t.charCodeAt(1))){let c=2,l=c;for(;c<e&&!wi(t.charCodeAt(c));)c++;if(c<e&&c!==l){let u=t.slice(l,c);for(l=c;c<e&&wi(t.charCodeAt(c));)c++;if(c<e&&c!==l){for(l=c;c<e&&!wi(t.charCodeAt(c));)c++;if(c===e)return`\\\\${u}\\${t.slice(l)}\\`;c!==l&&(n=`\\\\${u}\\${t.slice(l,c)}`,r=c)}}}else r=1;else Vw(o)&&t.charCodeAt(1)===Gw&&(n=t.slice(0,2),r=2,e>2&&wi(t.charCodeAt(2))&&(i=!0,r=3));let a=r<e?Iie(t.slice(r),!i,"\\",wi):"";return a.length===0&&!i&&(a="."),a.length>0&&wi(t.charCodeAt(e-1))&&(a+="\\"),n===void 0?i?`\\${a}`:a:i?`${n}\\${a}`:`${n}${a}`},isAbsolute(t){xc(t,"path");let e=t.length;if(e===0)return!1;let r=t.charCodeAt(0);return wi(r)||e>2&&Vw(r)&&t.charCodeAt(1)===Gw&&wi(t.charCodeAt(2))},join(...t){if(t.length===0)return".";let e,r;for(let o=0;o<t.length;++o){let a=t[o];xc(a,"path"),a.length>0&&(e===void 0?e=r=a:e+=`\\${a}`)}if(e===void 0)return".";let n=!0,i=0;if(typeof r=="string"&&wi(r.charCodeAt(0))){++i;let o=r.length;o>1&&wi(r.charCodeAt(1))&&(++i,o>2&&(wi(r.charCodeAt(2))?++i:n=!1))}if(n){for(;i<e.length&&wi(e.charCodeAt(i));)i++;i>=2&&(e=`\\${e.slice(i)}`)}return xr.win32.normalize(e)},relative(t,e){if(xc(t,"from"),xc(e,"to"),t===e)return"";let r=xr.win32.resolve(t),n=xr.win32.resolve(e);if(r===n||(t=r.toLowerCase(),e=n.toLowerCase(),t===e))return"";let i=0;for(;i<t.length&&t.charCodeAt(i)===Vp;)i++;let o=t.length;for(;o-1>i&&t.charCodeAt(o-1)===Vp;)o--;let a=o-i,c=0;for(;c<e.length&&e.charCodeAt(c)===Vp;)c++;let l=e.length;for(;l-1>c&&e.charCodeAt(l-1)===Vp;)l--;let u=l-c,f=a<u?a:u,p=-1,m=0;for(;m<f;m++){let g=t.charCodeAt(i+m);if(g!==e.charCodeAt(c+m))break;g===Vp&&(p=m)}if(m!==f){if(p===-1)return n}else{if(u>f){if(e.charCodeAt(c+m)===Vp)return n.slice(c+m+1);if(m===2)return n.slice(c+m)}a>f&&(t.charCodeAt(i+m)===Vp?p=m:m===2&&(p=3)),p===-1&&(p=0)}let h="";for(m=i+p+1;m<=o;++m)(m===o||t.charCodeAt(m)===Vp)&&(h+=h.length===0?"..":"\\..");return c+=p,h.length>0?`${h}${n.slice(c,l)}`:(n.charCodeAt(c)===Vp&&++c,n.slice(c,l))},toNamespacedPath(t){if(typeof t!="string"||t.length===0)return t;let e=xr.win32.resolve(t);if(e.length<=2)return t;if(e.charCodeAt(0)===Vp){if(e.charCodeAt(1)===Vp){let r=e.charCodeAt(2);if(r!==Tmr&&r!==zw)return`\\\\?\\UNC\\${e.slice(2)}`}}else if(Vw(e.charCodeAt(0))&&e.charCodeAt(1)===Gw&&e.charCodeAt(2)===Vp)return`\\\\?\\${e}`;return t},dirname(t){xc(t,"path");let e=t.length;if(e===0)return".";let r=-1,n=0,i=t.charCodeAt(0);if(e===1)return wi(i)?t:".";if(wi(i)){if(r=n=1,wi(t.charCodeAt(1))){let c=2,l=c;for(;c<e&&!wi(t.charCodeAt(c));)c++;if(c<e&&c!==l){for(l=c;c<e&&wi(t.charCodeAt(c));)c++;if(c<e&&c!==l){for(l=c;c<e&&!wi(t.charCodeAt(c));)c++;if(c===e)return t;c!==l&&(r=n=c+1)}}}}else Vw(i)&&t.charCodeAt(1)===Gw&&(r=e>2&&wi(t.charCodeAt(2))?3:2,n=r);let o=-1,a=!0;for(let c=e-1;c>=n;--c)if(wi(t.charCodeAt(c))){if(!a){o=c;break}}else a=!1;if(o===-1){if(r===-1)return".";o=r}return t.slice(0,o)},basename(t,e){e!==void 0&&xc(e,"ext"),xc(t,"path");let r=0,n=-1,i=!0,o;if(t.length>=2&&Vw(t.charCodeAt(0))&&t.charCodeAt(1)===Gw&&(r=2),e!==void 0&&e.length>0&&e.length<=t.length){if(e===t)return"";let a=e.length-1,c=-1;for(o=t.length-1;o>=r;--o){let l=t.charCodeAt(o);if(wi(l)){if(!i){r=o+1;break}}else c===-1&&(i=!1,c=o+1),a>=0&&(l===e.charCodeAt(a)?--a===-1&&(n=o):(a=-1,n=c))}return r===n?n=c:n===-1&&(n=t.length),t.slice(r,n)}for(o=t.length-1;o>=r;--o)if(wi(t.charCodeAt(o))){if(!i){r=o+1;break}}else n===-1&&(i=!1,n=o+1);return n===-1?"":t.slice(r,n)},extname(t){xc(t,"path");let e=0,r=-1,n=0,i=-1,o=!0,a=0;t.length>=2&&t.charCodeAt(1)===Gw&&Vw(t.charCodeAt(0))&&(e=n=2);for(let c=t.length-1;c>=e;--c){let l=t.charCodeAt(c);if(wi(l)){if(!o){n=c+1;break}continue}i===-1&&(o=!1,i=c+1),l===zw?r===-1?r=c:a!==1&&(a=1):r!==-1&&(a=-1)}return r===-1||i===-1||a===0||a===1&&r===i-1&&r===n+1?"":t.slice(r,i)},format:lft.bind(null,"\\"),parse(t){xc(t,"path");let e={root:"",dir:"",base:"",ext:"",name:""};if(t.length===0)return e;let r=t.length,n=0,i=t.charCodeAt(0);if(r===1)return wi(i)?(e.root=e.dir=t,e):(e.base=e.name=t,e);if(wi(i)){if(n=1,wi(t.charCodeAt(1))){let p=2,m=p;for(;p<r&&!wi(t.charCodeAt(p));)p++;if(p<r&&p!==m){for(m=p;p<r&&wi(t.charCodeAt(p));)p++;if(p<r&&p!==m){for(m=p;p<r&&!wi(t.charCodeAt(p));)p++;p===r?n=p:p!==m&&(n=p+1)}}}}else if(Vw(i)&&t.charCodeAt(1)===Gw){if(r<=2)return e.root=e.dir=t,e;if(n=2,wi(t.charCodeAt(2))){if(r===3)return e.root=e.dir=t,e;n=3}}n>0&&(e.root=t.slice(0,n));let o=-1,a=n,c=-1,l=!0,u=t.length-1,f=0;for(;u>=n;--u){if(i=t.charCodeAt(u),wi(i)){if(!l){a=u+1;break}continue}c===-1&&(l=!1,c=u+1),i===zw?o===-1?o=u:f!==1&&(f=1):o!==-1&&(f=-1)}return c!==-1&&(o===-1||f===0||f===1&&o===c-1&&o===a+1?e.base=e.name=t.slice(a,c):(e.name=t.slice(a,o),e.base=t.slice(a,c),e.ext=t.slice(o,c))),a>0&&a!==n?e.dir=t.slice(0,a-1):e.dir=e.root,e},sep:"\\",delimiter:";",win32:null,posix:null};var Smr=(()=>{if(zp){let t=/\\/g;return()=>{let e=x8.cwd().replace(t,"/");return e.slice(e.indexOf("/"))}}return()=>x8.cwd()})();xr.posix={resolve(...t){let e="",r=!1;for(let n=t.length-1;n>=-1&&!r;n--){let i=n>=0?t[n]:Smr();xc(i,"path"),i.length!==0&&(e=`${i}/${e}`,r=i.charCodeAt(0)===Eu)}return e=Iie(e,!r,"/",o_e),r?`/${e}`:e.length>0?e:"."},normalize(t){if(xc(t,"path"),t.length===0)return".";let e=t.charCodeAt(0)===Eu,r=t.charCodeAt(t.length-1)===Eu;return t=Iie(t,!e,"/",o_e),t.length===0?e?"/":r?"./":".":(r&&(t+="/"),e?`/${t}`:t)},isAbsolute(t){return xc(t,"path"),t.length>0&&t.charCodeAt(0)===Eu},join(...t){if(t.length===0)return".";let e;for(let r=0;r<t.length;++r){let n=t[r];xc(n,"path"),n.length>0&&(e===void 0?e=n:e+=`/${n}`)}return e===void 0?".":xr.posix.normalize(e)},relative(t,e){if(xc(t,"from"),xc(e,"to"),t===e||(t=xr.posix.resolve(t),e=xr.posix.resolve(e),t===e))return"";let r=1,n=t.length,i=n-r,o=1,a=e.length-o,c=i<a?i:a,l=-1,u=0;for(;u<c;u++){let p=t.charCodeAt(r+u);if(p!==e.charCodeAt(o+u))break;p===Eu&&(l=u)}if(u===c)if(a>c){if(e.charCodeAt(o+u)===Eu)return e.slice(o+u+1);if(u===0)return e.slice(o+u)}else i>c&&(t.charCodeAt(r+u)===Eu?l=u:u===0&&(l=0));let f="";for(u=r+l+1;u<=n;++u)(u===n||t.charCodeAt(u)===Eu)&&(f+=f.length===0?"..":"/..");return`${f}${e.slice(o+l)}`},toNamespacedPath(t){return t},dirname(t){if(xc(t,"path"),t.length===0)return".";let e=t.charCodeAt(0)===Eu,r=-1,n=!0;for(let i=t.length-1;i>=1;--i)if(t.charCodeAt(i)===Eu){if(!n){r=i;break}}else n=!1;return r===-1?e?"/":".":e&&r===1?"//":t.slice(0,r)},basename(t,e){e!==void 0&&xc(e,"ext"),xc(t,"path");let r=0,n=-1,i=!0,o;if(e!==void 0&&e.length>0&&e.length<=t.length){if(e===t)return"";let a=e.length-1,c=-1;for(o=t.length-1;o>=0;--o){let l=t.charCodeAt(o);if(l===Eu){if(!i){r=o+1;break}}else c===-1&&(i=!1,c=o+1),a>=0&&(l===e.charCodeAt(a)?--a===-1&&(n=o):(a=-1,n=c))}return r===n?n=c:n===-1&&(n=t.length),t.slice(r,n)}for(o=t.length-1;o>=0;--o)if(t.charCodeAt(o)===Eu){if(!i){r=o+1;break}}else n===-1&&(i=!1,n=o+1);return n===-1?"":t.slice(r,n)},extname(t){xc(t,"path");let e=-1,r=0,n=-1,i=!0,o=0;for(let a=t.length-1;a>=0;--a){let c=t.charCodeAt(a);if(c===Eu){if(!i){r=a+1;break}continue}n===-1&&(i=!1,n=a+1),c===zw?e===-1?e=a:o!==1&&(o=1):e!==-1&&(o=-1)}return e===-1||n===-1||o===0||o===1&&e===n-1&&e===r+1?"":t.slice(e,n)},format:lft.bind(null,"/"),parse(t){xc(t,"path");let e={root:"",dir:"",base:"",ext:"",name:""};if(t.length===0)return e;let r=t.charCodeAt(0)===Eu,n;r?(e.root="/",n=1):n=0;let i=-1,o=0,a=-1,c=!0,l=t.length-1,u=0;for(;l>=n;--l){let f=t.charCodeAt(l);if(f===Eu){if(!c){o=l+1;break}continue}a===-1&&(c=!1,a=l+1),f===zw?i===-1?i=l:u!==1&&(u=1):i!==-1&&(u=-1)}if(a!==-1){let f=o===0&&r?1:o;i===-1||u===0||u===1&&i===a-1&&i===o+1?e.base=e.name=t.slice(f,a):(e.name=t.slice(f,i),e.base=t.slice(f,a),e.ext=t.slice(i,a))}return o>0?e.dir=t.slice(0,o-1):r&&(e.dir="/"),e},sep:"/",delimiter:":",win32:null,posix:null};xr.posix.win32=xr.win32.win32=xr.win32;xr.posix.posix=xr.win32.posix=xr.posix;xr.normalize=zp?xr.win32.normalize:xr.posix.normalize;xr.isAbsolute=zp?xr.win32.isAbsolute:xr.posix.isAbsolute;xr.join=zp?xr.win32.join:xr.posix.join;xr.resolve=zp?xr.win32.resolve:xr.posix.resolve;xr.relative=zp?xr.win32.relative:xr.posix.relative;xr.dirname=zp?xr.win32.dirname:xr.posix.dirname;xr.basename=zp?xr.win32.basename:xr.posix.basename;xr.extname=zp?xr.win32.extname:xr.posix.extname;xr.format=zp?xr.win32.format:xr.posix.format;xr.parse=zp?xr.win32.parse:xr.posix.parse;xr.toNamespacedPath=zp?xr.win32.toNamespacedPath:xr.posix.toNamespacedPath;xr.sep=zp?xr.win32.sep:xr.posix.sep;xr.delimiter=zp?xr.win32.delimiter:xr.posix.delimiter});var Aft=H(E8=>{"use strict";d();Object.defineProperty(E8,"__esModule",{value:!0});E8.URI=void 0;E8.isUriComponents=Mmr;E8.uriToFsPath=_ie;var dft=uft(),wie=n_e(),_mr=/^\w[\w\d+.-]*$/,Rmr=/^\//,kmr=/^\/\//;function Pmr(t,e){if(!t.scheme&&e)throw new Error(`[UriError]: Scheme is missing: {scheme: "", authority: "${t.authority}", path: "${t.path}", query: "${t.query}", fragment: "${t.fragment}"}`);if(t.scheme&&!_mr.test(t.scheme))throw new Error("[UriError]: Scheme contains illegal characters.");if(t.path){if(t.authority){if(!Rmr.test(t.path))throw new Error('[UriError]: If a URI contains an authority component, then the path component must either be empty or begin with a slash ("/") character')}else if(kmr.test(t.path))throw new Error('[UriError]: If a URI does not contain an authority component, then the path cannot begin with two slash characters ("//")')}}s(Pmr,"_validateUri");function Dmr(t,e){return!t&&!e?"file":t}s(Dmr,"_schemeFix");function Bmr(t,e){switch(t){case"https":case"http":case"file":e?e[0]!==ay&&(e=ay+e):e=ay;break}return e}s(Bmr,"_referenceResolution");var Ds="",ay="/",Nmr=/^(([^:/?#]+?):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?/,Sie=class t{static{s(this,"URI")}static isUri(e){return e instanceof t?!0:e?typeof e.authority=="string"&&typeof e.fragment=="string"&&typeof e.path=="string"&&typeof e.query=="string"&&typeof e.scheme=="string"&&typeof e.fsPath=="string"&&typeof e.with=="function"&&typeof e.toString=="function":!1}scheme;authority;path;query;fragment;constructor(e,r,n,i,o,a=!1){typeof e=="object"?(this.scheme=e.scheme||Ds,this.authority=e.authority||Ds,this.path=e.path||Ds,this.query=e.query||Ds,this.fragment=e.fragment||Ds):(this.scheme=Dmr(e,a),this.authority=r||Ds,this.path=Bmr(this.scheme,n||Ds),this.query=i||Ds,this.fragment=o||Ds,Pmr(this,a))}get fsPath(){return _ie(this,!1)}with(e){if(!e)return this;let{scheme:r,authority:n,path:i,query:o,fragment:a}=e;return r===void 0?r=this.scheme:r===null&&(r=Ds),n===void 0?n=this.authority:n===null&&(n=Ds),i===void 0?i=this.path:i===null&&(i=Ds),o===void 0?o=this.query:o===null&&(o=Ds),a===void 0?a=this.fragment:a===null&&(a=Ds),r===this.scheme&&n===this.authority&&i===this.path&&o===this.query&&a===this.fragment?this:new Kw(r,n,i,o,a)}static parse(e,r=!1){let n=Nmr.exec(e);return n?new Kw(n[2]||Ds,Tie(n[4]||Ds),Tie(n[5]||Ds),Tie(n[7]||Ds),Tie(n[9]||Ds),r):new Kw(Ds,Ds,Ds,Ds,Ds)}static file(e){let r=Ds;if(wie.isWindows&&(e=e.replace(/\\/g,ay)),e[0]===ay&&e[1]===ay){let n=e.indexOf(ay,2);n===-1?(r=e.substring(2),e=ay):(r=e.substring(2,n),e=e.substring(n)||ay)}return new Kw("file",r,e,Ds,Ds)}static from(e,r){return new Kw(e.scheme,e.authority,e.path,e.query,e.fragment,r)}static joinPath(e,...r){if(!e.path)throw new Error("[UriError]: cannot call joinPath on URI without path");let n;return wie.isWindows&&e.scheme==="file"?n=t.file(dft.win32.join(_ie(e,!0),...r)).path:n=dft.posix.join(e.path,...r),e.with({path:n})}toString(e=!1){return s_e(this,e)}toJSON(){return this}static revive(e){if(e){if(e instanceof t)return e;{let r=new Kw(e);return r._formatted=e.external??null,r._fsPath=e._sep===mft?e.fsPath??null:null,r}}else return e}};E8.URI=Sie;function Mmr(t){return!t||typeof t!="object"?!1:typeof t.scheme=="string"&&(typeof t.authority=="string"||typeof t.authority>"u")&&(typeof t.path=="string"||typeof t.path>"u")&&(typeof t.query=="string"||typeof t.query>"u")&&(typeof t.fragment=="string"||typeof t.fragment>"u")}s(Mmr,"isUriComponents");var mft=wie.isWindows?1:void 0,Kw=class extends Sie{static{s(this,"Uri")}_formatted=null;_fsPath=null;get fsPath(){return this._fsPath||(this._fsPath=_ie(this,!1)),this._fsPath}toString(e=!1){return e?s_e(this,!0):(this._formatted||(this._formatted=s_e(this,!1)),this._formatted)}toJSON(){let e={$mid:1};return this._fsPath&&(e.fsPath=this._fsPath,e._sep=mft),this._formatted&&(e.external=this._formatted),this.path&&(e.path=this.path),this.scheme&&(e.scheme=this.scheme),this.authority&&(e.authority=this.authority),this.query&&(e.query=this.query),this.fragment&&(e.fragment=this.fragment),e}},hft={58:"%3A",47:"%2F",63:"%3F",35:"%23",91:"%5B",93:"%5D",64:"%40",33:"%21",36:"%24",38:"%26",39:"%27",40:"%28",41:"%29",42:"%2A",43:"%2B",44:"%2C",59:"%3B",61:"%3D",32:"%20"};function fft(t,e,r){let n,i=-1;for(let o=0;o<t.length;o++){let a=t.charCodeAt(o);if(a>=97&&a<=122||a>=65&&a<=90||a>=48&&a<=57||a===45||a===46||a===95||a===126||e&&a===47||r&&a===91||r&&a===93||r&&a===58)i!==-1&&(n+=encodeURIComponent(t.substring(i,o)),i=-1),n!==void 0&&(n+=t.charAt(o));else{n===void 0&&(n=t.substr(0,o));let c=hft[a];c!==void 0?(i!==-1&&(n+=encodeURIComponent(t.substring(i,o)),i=-1),n+=c):i===-1&&(i=o)}}return i!==-1&&(n+=encodeURIComponent(t.substring(i))),n!==void 0?n:t}s(fft,"encodeURIComponentFast");function Lmr(t){let e;for(let r=0;r<t.length;r++){let n=t.charCodeAt(r);n===35||n===63?(e===void 0&&(e=t.substr(0,r)),e+=hft[n]):e!==void 0&&(e+=t[r])}return e!==void 0?e:t}s(Lmr,"encodeURIComponentMinimal");function _ie(t,e){let r;return t.authority&&t.path.length>1&&t.scheme==="file"?r=`//${t.authority}${t.path}`:t.path.charCodeAt(0)===47&&(t.path.charCodeAt(1)>=65&&t.path.charCodeAt(1)<=90||t.path.charCodeAt(1)>=97&&t.path.charCodeAt(1)<=122)&&t.path.charCodeAt(2)===58?e?r=t.path.substr(1):r=t.path[1].toLowerCase()+t.path.substr(2):r=t.path,wie.isWindows&&(r=r.replace(/\//g,"\\")),r}s(_ie,"uriToFsPath");function s_e(t,e){let r=e?Lmr:fft,n="",{scheme:i,authority:o,path:a,query:c,fragment:l}=t;if(i&&(n+=i,n+=":"),(o||i==="file")&&(n+=ay,n+=ay),o){let u=o.indexOf("@");if(u!==-1){let f=o.substr(0,u);o=o.substr(u+1),u=f.lastIndexOf(":"),u===-1?n+=r(f,!1,!1):(n+=r(f.substr(0,u),!1,!1),n+=":",n+=r(f.substr(u+1),!1,!0)),n+="@"}o=o.toLowerCase(),u=o.lastIndexOf(":"),u===-1?n+=r(o,!1,!0):(n+=r(o.substr(0,u),!1,!0),n+=o.substr(u))}if(a){if(a.length>=3&&a.charCodeAt(0)===47&&a.charCodeAt(2)===58){let u=a.charCodeAt(1);u>=65&&u<=90&&(a=`/${String.fromCharCode(u+32)}:${a.substr(3)}`)}else if(a.length>=2&&a.charCodeAt(1)===58){let u=a.charCodeAt(0);u>=65&&u<=90&&(a=`${String.fromCharCode(u+32)}:${a.substr(2)}`)}n+=r(a,!0,!1)}return c&&(n+="?",n+=r(c,!1,!1)),l&&(n+="#",n+=e?l:fft(l,!1,!1)),n}s(s_e,"_asFormatted");function gft(t){try{return decodeURIComponent(t)}catch{return t.length>3?t.substr(0,3)+gft(t.substr(3)):t}}s(gft,"decodeURIComponentGraceful");var pft=/(%[0-9A-Za-z][0-9A-Za-z])+/g;function Tie(t){return t.match(pft)?t.replace(pft,e=>gft(e)):t}s(Tie,"percentDecode")});var l_e=H(Yw=>{"use strict";d();Object.defineProperty(Yw,"__esModule",{value:!0});Yw.PromptReference=Yw.ChatResponseReferencePartStatusKind=Yw.PromptMetadata=void 0;var UU=Aft(),a_e=class{static{s(this,"PromptMetadata")}_marker;toString(){return Object.getPrototypeOf(this).constructor.name}};Yw.PromptMetadata=a_e;var yft;(function(t){t[t.Complete=1]="Complete",t[t.Partial=2]="Partial",t[t.Omitted=3]="Omitted"})(yft||(Yw.ChatResponseReferencePartStatusKind=yft={}));var c_e=class t{static{s(this,"PromptReference")}anchor;iconPath;options;static fromJSON(e){let r=s(n=>"scheme"in n?UU.URI.from(n):{uri:UU.URI.from(n.uri),range:n.range},"uriOrLocation");return new t("variableName"in e.anchor?{variableName:e.anchor.variableName,value:e.anchor.value&&r(e.anchor.value)}:r(e.anchor),e.iconPath&&("scheme"in e.iconPath?UU.URI.from(e.iconPath):"light"in e.iconPath?{light:UU.URI.from(e.iconPath.light),dark:UU.URI.from(e.iconPath.dark)}:e.iconPath),e.options)}constructor(e,r,n){this.anchor=e,this.iconPath=r,this.options=n}toJSON(){return{anchor:this.anchor,iconPath:this.iconPath,options:this.options}}};Yw.PromptReference=c_e});var y_e=H(I8=>{"use strict";d();Object.defineProperty(I8,"__esModule",{value:!0});I8.PromptRenderer=I8.MetadataMap=void 0;var Fmr=LSe(),qU=qSe(),b8=Hw(),jc=ZSe(),A_e=l_e(),Cft;(function(t){t.empty={get:s(()=>{},"get"),getAll:s(()=>[],"getAll")}})(Cft||(I8.MetadataMap=Cft={}));var d_e=class{static{s(this,"PromptRenderer")}_endpoint;_ctor;_props;_tokenizer;_usedContext=[];_ignoredFiles=[];_growables=[];_root=new kie(null,0);_tokenLimits=[];tracer=void 0;constructor(e,r,n,i){this._endpoint=e,this._ctor=r,this._props=n,this._tokenizer=i}getIgnoredFiles(){return Array.from(new Set(this._ignoredFiles))}getUsedContext(){return this._usedContext}createElement(e){return new e.ctor(e.props)}async _processPromptPieces(e,r,n,i){let o=new Map;for(let[l,u]of r.entries()){if(Array.isArray(u.children)&&(u.props=u.props??{},u.props.children=u.children),!u.ctor){let g=bft(u.path);throw new Error(`Invalid ChatMessage child! Child must be a TSX component that extends PromptElement at ${g}`)}let f=this.createElement(u),p;f instanceof jc.TokenLimit&&(p=u.props.max,this._tokenLimits.push({limit:p,id:u.node.id})),u.node.setObj(f);let m=u.props.flexGrow??1/0,h=o.get(m);h||(h=[],o.set(m,h)),h.push({element:u,promptElementInstance:f,tokenLimit:p})}if(o.size===0)return;let a=[...o.entries()].sort(([l],[u])=>u-l).map(([l,u])=>u),c=s(l=>{let u=0;for(let f=l+1;f<a.length;f++)for(let{element:p}of a[f]){if(!p.props.flexReserve)continue;let m=typeof p.props.flexReserve=="string"?Math.floor(e.remainingTokenBudget/Number(p.props.flexReserve.slice(1))):p.props.flexReserve;u+=m}return e.consume(u),u},"setReserved");for(let[l,u]of a.entries()){let f=c(l),p=0;for(let{element:y}of u)p+=y.props.flexBasis??1;let m=0,h=u.map(y=>{if(y.tokenLimit===void 0)return!1;let E=y.element.props.flexBasis??1,b=E/p;return Math.floor(e.remainingTokenBudget*b)<y.tokenLimit?!1:(p-=E,m+=y.tokenLimit,!0)}),g=u.map((y,E)=>{let b=(y.element.props.flexBasis??1)/p;return{tokenBudget:h[E]?y.tokenLimit:Math.floor((e.remainingTokenBudget-m)*b),endpoint:e.endpoint,countTokens:s((S,R)=>this._tokenizer.tokenLength(typeof S=="string"?{type:b8.Raw.ChatCompletionContentPartKind.Text,text:S}:S,R),"countTokens")}});e.consume(-f),this.tracer?.addRenderEpoch?.({inNode:u[0].element.node.parent?.id,flexValue:u[0].element.props.flexGrow??0,tokenBudget:e.remainingTokenBudget,reservedTokens:f,elements:u.map((y,E)=>({id:y.element.node.id,tokenBudget:g[E].tokenBudget}))}),await Promise.all(u.map(async({element:y,promptElementInstance:E},b)=>{let S=await xft(y,()=>E.prepare?.(g[b],n,i));y.node.setState(S)}));let A=await Promise.all(u.map(async({element:y,promptElementInstance:E},b)=>{let S=g[b];return await xft(y,()=>E.render(y.node.getState(),S,n,i))}));for(let[y,{element:E,promptElementInstance:b}]of u.entries()){let S=g[y],R=A[y];if(!R)continue;let B=await this._processPromptRenderPiece(new zk(S.tokenBudget,this._endpoint),E,b,R,n,i);b instanceof jc.Expandable&&this._growables.push({initialConsume:B,elem:E.node}),e.consume(B)}}}async _processPromptRenderPiece(e,r,n,i,o,a){let c=Eft(i),l=new zk(e.tokenBudget,this._endpoint),{tokensConsumed:u}=await Omr(this._tokenizer,r,n,c);return l.consume(u),await this._handlePromptChildren(r,c,l,o,a),l.consumed}async renderElementJSON(e){return await this._processPromptPieces(new zk(this._endpoint.modelMaxPromptTokens,this._endpoint),[{node:this._root,ctor:this._ctor,props:this._props,children:[],path:[this._ctor]}],void 0,e),{node:this._root.toJSON()}}async render(e,r){let n=await this.renderRaw(e,r);return{...n,messages:(0,b8.toMode)(this._tokenizer.mode,n.messages)}}async renderRaw(e,r){await this._processPromptPieces(new zk(this._endpoint.modelMaxPromptTokens,this._endpoint),[{node:this._root,ctor:this._ctor,props:this._props,children:[],path:[this._ctor]}],e,r);let{container:n,allMetadata:i,removed:o}=await this._getFinalElementTree(this._endpoint.modelMaxPromptTokens,r);this.tracer?.didMaterializeTree?.({budget:this._endpoint.modelMaxPromptTokens,renderedTree:{container:n,removed:o,budget:this._endpoint.modelMaxPromptTokens},tokenizer:this._tokenizer,renderTree:s(m=>this._getFinalElementTree(m,void 0).then(h=>({...h,budget:m})),"renderTree")});let a=[...n.toChatMessages()],c=await n.tokenCount(this._tokenizer),l=[...n.allMetadata()],u=new Set,f=l.map(m=>{if(!(m instanceof P1))return;let h=m.reference,g="variableName"in h.anchor;if(g&&!u.has(h.anchor.variableName))return u.add(h.anchor.variableName),h;if(!g)return h}).filter(Pie),p=i.map(m=>{if(!(m instanceof P1)||l.includes(m))return;let h=m.reference,g="variableName"in h.anchor;if(g&&!u.has(h.anchor.variableName))return u.add(h.anchor.variableName),h;if(!g)return h}).filter(Pie);return{metadata:{get:s(m=>l.find(h=>h instanceof m),"get"),getAll:s(m=>l.filter(h=>h instanceof m),"getAll")},messages:a,hasIgnoredFiles:this._ignoredFiles.length>0,tokenCount:c,references:f,omittedReferences:p}}async _getFinalElementTree(e,r){let n=this._root.materialize(),i=[...n.allMetadata()],o=[{limit:e,id:this._root.id},...this._tokenLimits],a=0;for(let c=o.length-1;c>=0;c--){let l=o[c];if(l.limit>e)continue;let u=n.findById(l.id);if(!u)continue;let f=await u.tokenCount(this._tokenizer);if(f<l.limit&&!await this._grow(u,f,l.limit,r))continue;let p=await u.tokenCount(this._tokenizer);for(;p>l.limit;){let m=await u.baseMessageTokenCount(this._tokenizer);do for(let h of u.removeLowestPriorityChild()){a++;let g=h.upperBoundTokenCount(this._tokenizer);p-=typeof g=="number"?g:await g}while(p-m>l.limit);p=await u.tokenCount(this._tokenizer)}}return{container:n,allMetadata:i,removed:a}}async _grow(e,r,n,i){if(!this._growables.length)return!1;for(let o of this._growables){if(!e.findById(o.elem.id))continue;let a=o.elem.getObj();if(!(a instanceof jc.Expandable))throw new Error("unreachable: expected growable");let c=new kie(null,0,o.elem.id),l=new zk(n-r+o.initialConsume,this._endpoint),u=await this._processPromptRenderPiece(l,{node:c,ctor:this._ctor,props:{},children:[],path:[this._ctor]},a,await a.render(void 0,{tokenBudget:l.tokenBudget,endpoint:this._endpoint,countTokens:s((m,h)=>this._tokenizer.tokenLength(typeof m=="string"?{type:b8.Raw.ChatCompletionContentPartKind.Text,text:m}:m,h),"countTokens")}),void 0,i),f=c.materialize();if(!e.replaceNode(o.elem.id,f))throw new Error("unreachable: could not find old element to replace");if(r-=o.initialConsume,r+=u,r>=n)break}return!0}_handlePromptChildren(e,r,n,i,o){if(e.ctor===jc.TextChunk){this._handleExtrinsicTextChunkChildren(e.node,e.node,e.props,r);return}let a=[];for(let c of r){if(c.kind==="literal"){e.node.appendStringChild(c.value,e.props.priority??Number.MAX_SAFE_INTEGER);continue}if(c.kind==="intrinsic"){this._handleIntrinsic(e.node,c.name,{priority:e.props.priority??Number.MAX_SAFE_INTEGER,...c.props},Rie(c.children));continue}let l=e.node.createChild();a.push({node:l,ctor:c.ctor,props:c.props,children:c.children,path:[...e.path,c.ctor]})}return this._processPromptPieces(n,a,i,o)}_handleIntrinsic(e,r,n,i,o){switch(r){case"meta":return this._handleIntrinsicMeta(e,n,i);case"br":return this._handleIntrinsicLineBreak(e,n,i,n.priority,o);case"usedContext":return this._handleIntrinsicUsedContext(e,n,i);case"references":return this._handleIntrinsicReferences(e,n,i);case"ignoredFiles":return this._handleIntrinsicIgnoredFiles(e,n,i);case"elementJSON":return this._handleIntrinsicElementJSON(e,n.data);case"cacheBreakpoint":return this._handleIntrinsicCacheBreakpoint(e,n,i,o)}throw new Error(`Unknown intrinsic element ${r}!`)}_handleIntrinsicCacheBreakpoint(e,r,n,i){if(n.length>0)throw new Error("<cacheBreakpoint /> must not have children!");e.addCacheBreakpoint(r,i)}_handleIntrinsicMeta(e,r,n){if(n.length>0)throw new Error("<meta /> must not have children!");r.local?e.addMetadata(r.value):this._root.addMetadata(r.value)}_handleIntrinsicLineBreak(e,r,n,i,o){if(n.length>0)throw new Error("<br /> must not have children!");e.appendLineBreak(i??Number.MAX_SAFE_INTEGER,o)}_handleIntrinsicElementJSON(e,r){let n=e.appendPieceJSON(r.node);if(this.tracer?.includeInEpoch)for(let i of n.elements())this.tracer.includeInEpoch({id:i.id,tokenBudget:0})}_handleIntrinsicUsedContext(e,r,n){if(n.length>0)throw new Error("<usedContext /> must not have children!");this._usedContext.push(...r.value)}_handleIntrinsicReferences(e,r,n){if(n.length>0)throw new Error("<reference /> must not have children!");for(let i of r.value)e.addMetadata(new P1(i))}_handleIntrinsicIgnoredFiles(e,r,n){if(n.length>0)throw new Error("<ignoredFiles /> must not have children!");this._ignoredFiles.push(...r.value)}_handleExtrinsicTextChunkChildren(e,r,n,i){let o=[],a=[];for(let c of i){if(c.kind==="extrinsic")throw new Error("TextChunk cannot have extrinsic children!");if(c.kind==="literal"&&o.push(c.value),c.kind==="intrinsic")if(c.name==="br")o.push(`
`);else if(c.name==="references")for(let l of c.props.value)a.push(new P1(l));else this._handleIntrinsic(e,c.name,c.props,Rie(c.children),r.childIndex)}e.appendStringChild(o.join(""),n?.priority??Number.MAX_SAFE_INTEGER,a,r.childIndex,!0)}};I8.PromptRenderer=d_e;async function Omr(t,e,r,n){let i=0;if((0,jc.isChatMessagePromptElement)(r)){let o={role:e.props.role,content:[],...e.props.name?{name:e.props.name}:void 0,...e.props.toolCalls?{toolCalls:e.props.toolCalls}:void 0,...e.props.toolCallId?{toolCallId:e.props.toolCallId}:void 0};i+=await t.countMessageTokens((0,b8.toMode)(t.mode,o))}for(let o of n)o.kind==="literal"&&(i+=await t.tokenLength({type:b8.Raw.ChatCompletionContentPartKind.Text,text:o.value}));return{tokensConsumed:i}}s(Omr,"computeTokensConsumedByLiterals");function Eft(t,e=[]){return typeof t>"u"||typeof t=="boolean"?[]:(typeof t=="string"||typeof t=="number"?e.push(new m_e(String(t))):Qmr(t)?Rie(t.children,e):Umr(t)?Rie(t,e):typeof t.ctor=="string"?e.push(new f_e(t.ctor,t.props,t.children)):e.push(new p_e(t.ctor,t.props,t.children)),e)}s(Eft,"flattenAndReduce");function Rie(t,e=[]){for(let r of t)Eft(r,e);return e}s(Rie,"flattenAndReduceArr");var f_e=class{static{s(this,"IntrinsicPromptPiece")}name;props;children;kind="intrinsic";constructor(e,r,n){this.name=e,this.props=r,this.children=n}},p_e=class{static{s(this,"ExtrinsicPromptPiece")}ctor;props;children;kind="extrinsic";constructor(e,r,n){this.ctor=e,this.props=r,this.children=n}},m_e=class{static{s(this,"LiteralPromptPiece")}value;priority;kind="literal";constructor(e,r){this.value=e,this.priority=r}},zk=class{static{s(this,"PromptSizingContext")}tokenBudget;endpoint;_consumed=0;constructor(e,r){this.tokenBudget=e,this.endpoint=r}get consumed(){return this._consumed>this.tokenBudget?this.tokenBudget:this._consumed}get remainingTokenBudget(){return Math.max(0,this.tokenBudget-this._consumed)}consume(e){this._consumed+=e}},kie=class t{static{s(this,"PromptTreeElement")}parent;childIndex;id;static _nextId=0;static fromJSON(e,r,n){let i=new t(null,e);switch(i._metadata=r.references?.map(o=>new P1(A_e.PromptReference.fromJSON(o)))??[],i._children=r.children.map((o,a)=>{switch(o.type){case 1:return t.fromJSON(a,o,n);case 2:return HU.fromJSON(i,a,o);default:}}).filter(Pie),r.ctor){case 1:i._objFlags=r.flags??0,i._obj=new jc.BaseChatMessage(r.props);break;case 2:{if(r.keepWithId!==void 0){let o=n.get(r.keepWithId);o||(o=(0,jc.useKeepWith)(),n.set(r.keepWithId,o)),i._obj=new o(r.props||{})}else i._obj=new jc.LogicalWrapper(r.props||{});i._objFlags=r.flags??0;break}case 3:i._obj=new jc.Image(r.props);break;default:}return i}kind=1;_obj=null;_state=void 0;_children=[];_metadata=[];_objFlags=0;constructor(e=null,r,n=t._nextId++){this.parent=e,this.childIndex=r,this.id=n}setObj(e){this._obj=e,this._obj instanceof jc.LegacyPrioritization&&(this._objFlags|=1),this._obj instanceof jc.Chunk&&(this._objFlags|=2),this._obj instanceof jc.IfEmpty&&(this._objFlags|=8),this._obj.props.passPriority&&(this._objFlags|=4)}getObj(){return this._obj}setState(e){this._state=e}getState(){return this._state}createChild(){let e=new t(this,this._children.length);return this._children.push(e),e}appendPieceJSON(e){let r=t.fromJSON(this._children.length,e,new Map);return this._children.push(r),r}appendStringChild(e,r,n,i=this._children.length,o=!1){this._children.push(new HU(this,i,e,r,n,o))}appendLineBreak(e,r=this._children.length){this._children.push(new HU(this,r,`
`,e))}toJSON(){let e={type:1,ctor:2,ctorName:this._obj?.constructor.name,children:this._children.slice().sort((r,n)=>r.childIndex-n.childIndex).map(r=>r.toJSON()).filter(Pie),props:{},references:this._metadata.filter(r=>r instanceof P1).map(r=>r.reference.toJSON())};if(this._obj&&(e.props=u_e(this._obj.props,Fmr.jsonRetainedProps)),this._obj instanceof jc.BaseChatMessage)e.ctor=1,Object.assign(e.props,u_e(this._obj.props,["role","name","toolCalls","toolCallId"]));else{if(this._obj instanceof jc.Image)return{...e,ctor:3,props:{...e.props,...u_e(this._obj.props,["src","detail"])}};this._obj instanceof jc.AbstractKeepWith&&(e.keepWithId=this._obj.id)}return this._objFlags!==0&&(e.flags=this._objFlags),e}materialize(e){if(this._children.sort((r,n)=>r.childIndex-n.childIndex),this._obj instanceof jc.Image)return new qU.MaterializedChatMessageImage(e,this.id,this._obj.props.src,this._obj.props.priority??Number.MAX_SAFE_INTEGER,this._metadata,0,this._obj.props.detail??void 0);if(this._obj instanceof jc.BaseChatMessage){if(this._obj.props.role===void 0||typeof this._obj.props.role!="number")throw new Error("Invalid ChatMessage!");return new qU.MaterializedChatMessage(e,this.id,this._obj.props.role,this._obj.props.name,this._obj instanceof jc.AssistantMessage?this._obj.props.toolCalls:void 0,this._obj instanceof jc.ToolMessage?this._obj.props.toolCallId:void 0,this._obj.props.priority??Number.MAX_SAFE_INTEGER,this._metadata,r=>this._children.map(n=>n.materialize(r)))}else{let r=new qU.GenericMaterializedContainer(e,this.id,this._obj?.constructor.name,this._obj?.props.priority??(this._obj?.props.passPriority?0:Number.MAX_SAFE_INTEGER),n=>this._children.map(i=>i.materialize(n)),this._metadata,this._objFlags);return this._obj instanceof jc.AbstractKeepWith&&(r.keepWithId=this._obj.id),r}}addMetadata(e){this._metadata.push(e)}addCacheBreakpoint(e,r=this._children.length){if(!(this._obj instanceof jc.BaseChatMessage))throw new Error("Cache breakpoints may only be direct children of chat messages");this._children.push(new h_e({type:b8.Raw.ChatCompletionContentPartKind.CacheBreakpoint,cacheType:e.type},r))}*elements(){yield this;for(let e of this._children)e instanceof t&&(yield*e.elements())}},h_e=class{static{s(this,"PromptCacheBreakpoint")}part;childIndex;constructor(e,r){this.part=e,this.childIndex=r}toJSON(){}materialize(e){return new qU.MaterializedChatMessageBreakpoint(e,this.part)}},HU=class t{static{s(this,"PromptText")}parent;childIndex;text;priority;metadata;lineBreakBefore;static fromJSON(e,r,n){return new t(e,r,n.text,n.priority,n.references?.map(i=>new P1(A_e.PromptReference.fromJSON(i))),n.lineBreakBefore)}kind=2;constructor(e,r,n,i,o,a=!1){this.parent=e,this.childIndex=r,this.text=n,this.priority=i,this.metadata=o,this.lineBreakBefore=a}collectLeafs(e){e.push(this)}materialize(e){let r=this.lineBreakBefore?1:this.childIndex===0?2:0;return new qU.MaterializedChatMessageTextChunk(e,this.text,this.priority??Number.MAX_SAFE_INTEGER,this.metadata||[],r)}toJSON(){return{type:2,priority:this.priority,text:this.text,references:this.metadata?.filter(e=>e instanceof P1).map(e=>e.reference.toJSON()),lineBreakBefore:this.lineBreakBefore}}};function Qmr(t){return(typeof t.ctor=="function"&&t.ctor.isFragment)??!1}s(Qmr,"isFragmentCtor");function Pie(t){return t!==void 0}s(Pie,"isDefined");var g_e=class extends A_e.PromptMetadata{static{s(this,"InternalMetadata")}},P1=class extends g_e{static{s(this,"ReferenceMetadata")}reference;constructor(e){super(),this.reference=e}};function Umr(t){return!!t&&typeof t[Symbol.iterator]=="function"}s(Umr,"isIterable");function u_e(t,e){let r={};for(let n of e)t.hasOwnProperty(n)&&(r[n]=t[n]);return r}s(u_e,"pickProps");function bft(t){return t.map(e=>typeof e=="string"?e:e?e.name||"<anonymous>":String(e)).join(" > ")}s(bft,"atPath");var vft=new WeakSet;async function xft(t,e){try{return await e()}catch(r){throw r instanceof Error&&!vft.has(r)&&r.constructor.name!=="CancellationError"&&(vft.add(r),r.message+=` (at tsx element ${bft(t.path)})`),r}}s(xft,"annotateError")});var Ift=H(Die=>{"use strict";d();Object.defineProperty(Die,"__esModule",{value:!0});Die.VSCodeTokenizer=void 0;var C_e=Hw(),v_e=class{static{s(this,"VSCodeTokenizer")}countTokens;mode=C_e.OutputMode.VSCode;constructor(e,r){if(this.countTokens=e,r!==C_e.OutputMode.VSCode)throw new Error("`mode` must be set to vscode when using vscode.LanguageModelChat as the tokenizer")}async tokenLength(e,r){return e.type===C_e.Raw.ChatCompletionContentPartKind.Text?this.countTokens(e.text,r):Promise.resolve(0)}async countMessageTokens(e){return this.countTokens(e)}};Die.VSCodeTokenizer=v_e});var Tft=H(T8=>{"use strict";d();Object.defineProperty(T8,"__esModule",{value:!0});T8.tracerCss=T8.tracerSrc=void 0;T8.tracerSrc='"use strict";(()=>{var $,m,se,Ue,w,re,le,q,X,G,K,Ae,D={},ce=[],Re=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,J=Array.isArray;function E(t,e){for(var n in e)t[n]=e[n];return t}function ue(t){t&&t.parentNode&&t.parentNode.removeChild(t)}function l(t,e,n){var o,r,_,c={};for(_ in e)_=="key"?o=e[_]:_=="ref"?r=e[_]:c[_]=e[_];if(arguments.length>2&&(c.children=arguments.length>3?$.call(arguments,2):n),typeof t=="function"&&t.defaultProps!=null)for(_ in t.defaultProps)c[_]===void 0&&(c[_]=t.defaultProps[_]);return R(t,c,o,r,null)}function R(t,e,n,o,r){var _={type:t,props:e,key:n,ref:o,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,constructor:void 0,__v:r??++se,__i:-1,__u:0};return r==null&&m.vnode!=null&&m.vnode(_),_}function N(t){return t.children}function B(t,e){this.props=t,this.context=e}function I(t,e){if(e==null)return t.__?I(t.__,t.__i+1):null;for(var n;e<t.__k.length;e++)if((n=t.__k[e])!=null&&n.__e!=null)return n.__e;return typeof t.type=="function"?I(t):null}function de(t){var e,n;if((t=t.__)!=null&&t.__c!=null){for(t.__e=t.__c.base=null,e=0;e<t.__k.length;e++)if((n=t.__k[e])!=null&&n.__e!=null){t.__e=t.__c.base=n.__e;break}return de(t)}}function ie(t){(!t.__d&&(t.__d=!0)&&w.push(t)&&!O.__r++||re!==m.debounceRendering)&&((re=m.debounceRendering)||le)(O)}function O(){var t,e,n,o,r,_,c,a;for(w.sort(q);t=w.shift();)t.__d&&(e=w.length,o=void 0,_=(r=(n=t).__v).__e,c=[],a=[],n.__P&&((o=E({},r)).__v=r.__v+1,m.vnode&&m.vnode(o),Q(n.__P,o,r,n.__n,n.__P.namespaceURI,32&r.__u?[_]:null,c,_??I(r),!!(32&r.__u),a),o.__v=r.__v,o.__.__k[o.__i]=o,me(c,o,a),o.__e!=_&&de(o)),w.length>e&&w.sort(q));O.__r=0}function pe(t,e,n,o,r,_,c,a,u,s,p){var i,f,d,b,x,C=o&&o.__k||ce,h=e.length;for(n.__d=u,Be(n,e,C),u=n.__d,i=0;i<h;i++)(d=n.__k[i])!=null&&(f=d.__i===-1?D:C[d.__i]||D,d.__i=i,Q(t,d,f,r,_,c,a,u,s,p),b=d.__e,d.ref&&f.ref!=d.ref&&(f.ref&&Y(f.ref,null,d),p.push(d.ref,d.__c||b,d)),x==null&&b!=null&&(x=b),65536&d.__u||f.__k===d.__k?u=fe(d,u,t):typeof d.type=="function"&&d.__d!==void 0?u=d.__d:b&&(u=b.nextSibling),d.__d=void 0,d.__u&=-196609);n.__d=u,n.__e=x}function Be(t,e,n){var o,r,_,c,a,u=e.length,s=n.length,p=s,i=0;for(t.__k=[],o=0;o<u;o++)(r=e[o])!=null&&typeof r!="boolean"&&typeof r!="function"?(c=o+i,(r=t.__k[o]=typeof r=="string"||typeof r=="number"||typeof r=="bigint"||r.constructor==String?R(null,r,null,null,null):J(r)?R(N,{children:r},null,null,null):r.constructor===void 0&&r.__b>0?R(r.type,r.props,r.key,r.ref?r.ref:null,r.__v):r).__=t,r.__b=t.__b+1,_=null,(a=r.__i=Oe(r,n,c,p))!==-1&&(p--,(_=n[a])&&(_.__u|=131072)),_==null||_.__v===null?(a==-1&&i--,typeof r.type!="function"&&(r.__u|=65536)):a!==c&&(a==c-1?i--:a==c+1?i++:(a>c?i--:i++,r.__u|=65536))):r=t.__k[o]=null;if(p)for(o=0;o<s;o++)(_=n[o])!=null&&!(131072&_.__u)&&(_.__e==t.__d&&(t.__d=I(_)),he(_,_))}function fe(t,e,n){var o,r;if(typeof t.type=="function"){for(o=t.__k,r=0;o&&r<o.length;r++)o[r]&&(o[r].__=t,e=fe(o[r],e,n));return e}t.__e!=e&&(e&&t.type&&!n.contains(e)&&(e=I(t)),n.insertBefore(t.__e,e||null),e=t.__e);do e=e&&e.nextSibling;while(e!=null&&e.nodeType===8);return e}function Oe(t,e,n,o){var r=t.key,_=t.type,c=n-1,a=n+1,u=e[n];if(u===null||u&&r==u.key&&_===u.type&&!(131072&u.__u))return n;if(o>(u!=null&&!(131072&u.__u)?1:0))for(;c>=0||a<e.length;){if(c>=0){if((u=e[c])&&!(131072&u.__u)&&r==u.key&&_===u.type)return c;c--}if(a<e.length){if((u=e[a])&&!(131072&u.__u)&&r==u.key&&_===u.type)return a;a++}}return-1}function _e(t,e,n){e[0]==="-"?t.setProperty(e,n??""):t[e]=n==null?"":typeof n!="number"||Re.test(e)?n:n+"px"}function A(t,e,n,o,r){var _;e:if(e==="style")if(typeof n=="string")t.style.cssText=n;else{if(typeof o=="string"&&(t.style.cssText=o=""),o)for(e in o)n&&e in n||_e(t.style,e,"");if(n)for(e in n)o&&n[e]===o[e]||_e(t.style,e,n[e])}else if(e[0]==="o"&&e[1]==="n")_=e!==(e=e.replace(/(PointerCapture)$|Capture$/i,"$1")),e=e.toLowerCase()in t||e==="onFocusOut"||e==="onFocusIn"?e.toLowerCase().slice(2):e.slice(2),t.l||(t.l={}),t.l[e+_]=n,n?o?n.u=o.u:(n.u=X,t.addEventListener(e,_?K:G,_)):t.removeEventListener(e,_?K:G,_);else{if(r=="http://www.w3.org/2000/svg")e=e.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(e!="width"&&e!="height"&&e!="href"&&e!="list"&&e!="form"&&e!="tabIndex"&&e!="download"&&e!="rowSpan"&&e!="colSpan"&&e!="role"&&e!="popover"&&e in t)try{t[e]=n??"";break e}catch{}typeof n=="function"||(n==null||n===!1&&e[4]!=="-"?t.removeAttribute(e):t.setAttribute(e,e=="popover"&&n==1?"":n))}}function ae(t){return function(e){if(this.l){var n=this.l[e.type+t];if(e.t==null)e.t=X++;else if(e.t<n.u)return;return n(m.event?m.event(e):e)}}}function Q(t,e,n,o,r,_,c,a,u,s){var p,i,f,d,b,x,C,h,v,H,M,P,F,oe,z,j,k=e.type;if(e.constructor!==void 0)return null;128&n.__u&&(u=!!(32&n.__u),_=[a=e.__e=n.__e]),(p=m.__b)&&p(e);e:if(typeof k=="function")try{if(h=e.props,v="prototype"in k&&k.prototype.render,H=(p=k.contextType)&&o[p.__c],M=p?H?H.props.value:p.__:o,n.__c?C=(i=e.__c=n.__c).__=i.__E:(v?e.__c=i=new k(h,M):(e.__c=i=new B(h,M),i.constructor=k,i.render=We),H&&H.sub(i),i.props=h,i.state||(i.state={}),i.context=M,i.__n=o,f=i.__d=!0,i.__h=[],i._sb=[]),v&&i.__s==null&&(i.__s=i.state),v&&k.getDerivedStateFromProps!=null&&(i.__s==i.state&&(i.__s=E({},i.__s)),E(i.__s,k.getDerivedStateFromProps(h,i.__s))),d=i.props,b=i.state,i.__v=e,f)v&&k.getDerivedStateFromProps==null&&i.componentWillMount!=null&&i.componentWillMount(),v&&i.componentDidMount!=null&&i.__h.push(i.componentDidMount);else{if(v&&k.getDerivedStateFromProps==null&&h!==d&&i.componentWillReceiveProps!=null&&i.componentWillReceiveProps(h,M),!i.__e&&(i.shouldComponentUpdate!=null&&i.shouldComponentUpdate(h,i.__s,M)===!1||e.__v===n.__v)){for(e.__v!==n.__v&&(i.props=h,i.state=i.__s,i.__d=!1),e.__e=n.__e,e.__k=n.__k,e.__k.some(function(U){U&&(U.__=e)}),P=0;P<i._sb.length;P++)i.__h.push(i._sb[P]);i._sb=[],i.__h.length&&c.push(i);break e}i.componentWillUpdate!=null&&i.componentWillUpdate(h,i.__s,M),v&&i.componentDidUpdate!=null&&i.__h.push(function(){i.componentDidUpdate(d,b,x)})}if(i.context=M,i.props=h,i.__P=t,i.__e=!1,F=m.__r,oe=0,v){for(i.state=i.__s,i.__d=!1,F&&F(e),p=i.render(i.props,i.state,i.context),z=0;z<i._sb.length;z++)i.__h.push(i._sb[z]);i._sb=[]}else do i.__d=!1,F&&F(e),p=i.render(i.props,i.state,i.context),i.state=i.__s;while(i.__d&&++oe<25);i.state=i.__s,i.getChildContext!=null&&(o=E(E({},o),i.getChildContext())),v&&!f&&i.getSnapshotBeforeUpdate!=null&&(x=i.getSnapshotBeforeUpdate(d,b)),pe(t,J(j=p!=null&&p.type===N&&p.key==null?p.props.children:p)?j:[j],e,n,o,r,_,c,a,u,s),i.base=e.__e,e.__u&=-161,i.__h.length&&c.push(i),C&&(i.__E=i.__=null)}catch(U){if(e.__v=null,u||_!=null){for(e.__u|=u?160:32;a&&a.nodeType===8&&a.nextSibling;)a=a.nextSibling;_[_.indexOf(a)]=null,e.__e=a}else e.__e=n.__e,e.__k=n.__k;m.__e(U,e,n)}else _==null&&e.__v===n.__v?(e.__k=n.__k,e.__e=n.__e):e.__e=$e(n.__e,e,n,o,r,_,c,u,s);(p=m.diffed)&&p(e)}function me(t,e,n){e.__d=void 0;for(var o=0;o<n.length;o++)Y(n[o],n[++o],n[++o]);m.__c&&m.__c(e,t),t.some(function(r){try{t=r.__h,r.__h=[],t.some(function(_){_.call(r)})}catch(_){m.__e(_,r.__v)}})}function $e(t,e,n,o,r,_,c,a,u){var s,p,i,f,d,b,x,C=n.props,h=e.props,v=e.type;if(v==="svg"?r="http://www.w3.org/2000/svg":v==="math"?r="http://www.w3.org/1998/Math/MathML":r||(r="http://www.w3.org/1999/xhtml"),_!=null){for(s=0;s<_.length;s++)if((d=_[s])&&"setAttribute"in d==!!v&&(v?d.localName===v:d.nodeType===3)){t=d,_[s]=null;break}}if(t==null){if(v===null)return document.createTextNode(h);t=document.createElementNS(r,v,h.is&&h),a&&(m.__m&&m.__m(e,_),a=!1),_=null}if(v===null)C===h||a&&t.data===h||(t.data=h);else{if(_=_&&$.call(t.childNodes),C=n.props||D,!a&&_!=null)for(C={},s=0;s<t.attributes.length;s++)C[(d=t.attributes[s]).name]=d.value;for(s in C)if(d=C[s],s!="children"){if(s=="dangerouslySetInnerHTML")i=d;else if(!(s in h)){if(s=="value"&&"defaultValue"in h||s=="checked"&&"defaultChecked"in h)continue;A(t,s,null,d,r)}}for(s in h)d=h[s],s=="children"?f=d:s=="dangerouslySetInnerHTML"?p=d:s=="value"?b=d:s=="checked"?x=d:a&&typeof d!="function"||C[s]===d||A(t,s,d,C[s],r);if(p)a||i&&(p.__html===i.__html||p.__html===t.innerHTML)||(t.innerHTML=p.__html),e.__k=[];else if(i&&(t.innerHTML=""),pe(t,J(f)?f:[f],e,n,o,v==="foreignObject"?"http://www.w3.org/1999/xhtml":r,_,c,_?_[0]:n.__k&&I(n,0),a,u),_!=null)for(s=_.length;s--;)ue(_[s]);a||(s="value",v==="progress"&&b==null?t.removeAttribute("value"):b!==void 0&&(b!==t[s]||v==="progress"&&!b||v==="option"&&b!==C[s])&&A(t,s,b,C[s],r),s="checked",x!==void 0&&x!==t[s]&&A(t,s,x,C[s],r))}return t}function Y(t,e,n){try{if(typeof t=="function"){var o=typeof t.__u=="function";o&&t.__u(),o&&e==null||(t.__u=t(e))}else t.current=e}catch(r){m.__e(r,n)}}function he(t,e,n){var o,r;if(m.unmount&&m.unmount(t),(o=t.ref)&&(o.current&&o.current!==t.__e||Y(o,null,e)),(o=t.__c)!=null){if(o.componentWillUnmount)try{o.componentWillUnmount()}catch(_){m.__e(_,e)}o.base=o.__P=null}if(o=t.__k)for(r=0;r<o.length;r++)o[r]&&he(o[r],e,n||typeof t.type!="function");n||ue(t.__e),t.__c=t.__=t.__e=t.__d=void 0}function We(t,e,n){return this.constructor(t,n)}function ve(t,e,n){var o,r,_,c;m.__&&m.__(t,e),r=(o=typeof n=="function")?null:n&&n.__k||e.__k,_=[],c=[],Q(e,t=(!o&&n||e).__k=l(N,null,[t]),r||D,D,e.namespaceURI,!o&&n?[n]:r?null:e.firstChild?$.call(e.childNodes):null,_,!o&&n?n:r?r.__e:e.firstChild,o,c),me(_,t,c)}$=ce.slice,m={__e:function(t,e,n,o){for(var r,_,c;e=e.__;)if((r=e.__c)&&!r.__)try{if((_=r.constructor)&&_.getDerivedStateFromError!=null&&(r.setState(_.getDerivedStateFromError(t)),c=r.__d),r.componentDidCatch!=null&&(r.componentDidCatch(t,o||{}),c=r.__d),c)return r.__E=r}catch(a){t=a}throw t}},se=0,Ue=function(t){return t!=null&&t.constructor==null},B.prototype.setState=function(t,e){var n;n=this.__s!=null&&this.__s!==this.state?this.__s:this.__s=E({},this.state),typeof t=="function"&&(t=t(E({},n),this.props)),t&&E(n,t),t!=null&&this.__v&&(e&&this._sb.push(e),ie(this))},B.prototype.forceUpdate=function(t){this.__v&&(this.__e=!0,t&&this.__h.push(t),ie(this))},B.prototype.render=N,w=[],le=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,q=function(t,e){return t.__v.__b-e.__v.__b},O.__r=0,X=0,G=ae(!1),K=ae(!0),Ae=0;var L,g,Z,ge,V=0,Ee=[],y=m,be=y.__b,ye=y.__r,Ce=y.diffed,xe=y.__c,ke=y.unmount,Te=y.__;function te(t,e){y.__h&&y.__h(g,t,V||e),V=0;var n=g.__H||(g.__H={__:[],__h:[]});return t>=n.__.length&&n.__.push({}),n.__[t]}function S(t){return V=1,Ve(Ne,t)}function Ve(t,e,n){var o=te(L++,2);if(o.t=t,!o.__c&&(o.__=[n?n(e):Ne(void 0,e),function(a){var u=o.__N?o.__N[0]:o.__[0],s=o.t(u,a);u!==s&&(o.__N=[s,o.__[1]],o.__c.setState({}))}],o.__c=g,!g.u)){var r=function(a,u,s){if(!o.__c.__H)return!0;var p=o.__c.__H.__.filter(function(f){return!!f.__c});if(p.every(function(f){return!f.__N}))return!_||_.call(this,a,u,s);var i=!1;return p.forEach(function(f){if(f.__N){var d=f.__[0];f.__=f.__N,f.__N=void 0,d!==f.__[0]&&(i=!0)}}),!(!i&&o.__c.props===a)&&(!_||_.call(this,a,u,s))};g.u=!0;var _=g.shouldComponentUpdate,c=g.componentWillUpdate;g.componentWillUpdate=function(a,u,s){if(this.__e){var p=_;_=void 0,r(a,u,s),_=p}c&&c.call(this,a,u,s)},g.shouldComponentUpdate=r}return o.__N||o.__}function Se(t,e){var n=te(L++,3);!y.__s&&Ie(n.__H,e)&&(n.__=t,n.i=e,g.__H.__h.push(n))}function we(t){return V=5,je(function(){return{current:t}},[])}function je(t,e){var n=te(L++,7);return Ie(n.__H,e)&&(n.__=t(),n.__H=e,n.__h=t),n.__}function qe(){for(var t;t=Ee.shift();)if(t.__P&&t.__H)try{t.__H.__h.forEach(W),t.__H.__h.forEach(ee),t.__H.__h=[]}catch(e){t.__H.__h=[],y.__e(e,t.__v)}}y.__b=function(t){g=null,be&&be(t)},y.__=function(t,e){t&&e.__k&&e.__k.__m&&(t.__m=e.__k.__m),Te&&Te(t,e)},y.__r=function(t){ye&&ye(t),L=0;var e=(g=t.__c).__H;e&&(Z===g?(e.__h=[],g.__h=[],e.__.forEach(function(n){n.__N&&(n.__=n.__N),n.i=n.__N=void 0})):(e.__h.forEach(W),e.__h.forEach(ee),e.__h=[],L=0)),Z=g},y.diffed=function(t){Ce&&Ce(t);var e=t.__c;e&&e.__H&&(e.__H.__h.length&&(Ee.push(e)!==1&&ge===y.requestAnimationFrame||((ge=y.requestAnimationFrame)||Ge)(qe)),e.__H.__.forEach(function(n){n.i&&(n.__H=n.i),n.i=void 0})),Z=g=null},y.__c=function(t,e){e.some(function(n){try{n.__h.forEach(W),n.__h=n.__h.filter(function(o){return!o.__||ee(o)})}catch(o){e.some(function(r){r.__h&&(r.__h=[])}),e=[],y.__e(o,n.__v)}}),xe&&xe(t,e)},y.unmount=function(t){ke&&ke(t);var e,n=t.__c;n&&n.__H&&(n.__H.__.forEach(function(o){try{W(o)}catch(r){e=r}}),n.__H=void 0,e&&y.__e(e,n.__v))};var Me=typeof requestAnimationFrame=="function";function Ge(t){var e,n=function(){clearTimeout(o),Me&&cancelAnimationFrame(e),setTimeout(t)},o=setTimeout(n,100);Me&&(e=requestAnimationFrame(n))}function W(t){var e=g,n=t.__c;typeof n=="function"&&(t.__c=void 0,n()),g=e}function ee(t){var e=g;t.__c=t.__(),g=e}function Ie(t,e){return!t||t.length!==e.length||e.some(function(n,o){return n!==t[o]})}function Ne(t,e){return typeof e=="function"?e(t):e}function He(t,e){let n=we(void 0),o=(...r)=>{n.current&&clearTimeout(n.current),n.current=window.setTimeout(()=>{t(...r)},e)};return Se(()=>()=>{n.current&&clearTimeout(n.current)},[]),o}var Ke=new Intl.NumberFormat("en-US"),T=({value:t})=>l(N,null,Ke.format(t));var ne=[{bg:"#c1e7ff",fg:"#000"},{bg:"#abd2ec",fg:"#000"},{bg:"#94bed9",fg:"#000"},{bg:"#7faac6",fg:"#000"},{bg:"#6996b3",fg:"#fff"},{bg:"#5383a1",fg:"#fff"},{bg:"#3d708f",fg:"#fff"},{bg:"#255e7e",fg:"#fff"}],Xe=({scoreBy:t,nodes:e,epoch:n})=>{if(e.length===0)return null;let o=t;if(t.field!=="tokens"){let r=e[0][t.field],_=e[0][t.field];for(let c=1;c<e.length;c++)r=Math.max(r,e[c][t.field]),_=Math.max(_,e[c][t.field]);o={field:t.field,max:r,min:_}}return l("div",{className:"node-children"},e.map((r,_)=>r.type===2?l(Je,{scoreBy:o,key:_,node:r}):l(Le,{scoreBy:o,key:_,node:r,epoch:n})))},Fe=({node:t})=>l("div",{className:"node-stats"},"Used Tokens: ",l(T,{value:t.tokens})," / ","Priority:"," ",t.priority===Number.MAX_SAFE_INTEGER?"MAX":l(T,{value:t.priority})),De=({scoreBy:t,node:e,children:n,...o})=>{let r=0;if(t.max!==t.min){let _=(e[t.field]-t.min)/(t.max-t.min);r=Math.round((ne.length-1)*_)}return l("div",{...o,className:`node ${o.className||""}`,style:{backgroundColor:ne[r].bg,color:ne[r].fg}},n)},Je=({scoreBy:t,node:e})=>l(De,{node:e,scoreBy:t,tabIndex:0,className:"node-text"},l(Fe,{node:e}),l("div",{className:"node-content"},e.value)),Le=({scoreBy:t,node:e,epoch:n})=>{let[o,r]=S(!1),_=EPOCHS.findIndex(i=>i.elements.some(f=>f.id===e.id));if(_===void 0)throw new Error(`epoch not found for ${e.id}`);let c=EPOCHS[_],a=EPOCHS.at(n),u=c.elements.find(i=>i.id===e.id).tokenBudget,s=e.type===1?e.name||e.role.slice(0,1).toUpperCase()+e.role.slice(1)+"Message":e.name,p=_===n?"new-in-epoch":n<_?"before-epoch":"";return l(De,{node:e,scoreBy:t,className:p},l(Fe,{node:e}),l("div",{className:"node-content node-toggler",onClick:()=>r(i=>!i)},l("span",null,a?.inNode===e.id?"\\u{1F3C3} ":"",`<${s}>`),l("span",{className:"indicator"},o?"[+]":"[-]")),n===_&&l("div",{className:"node-stats"},"Token Budget: ",l(T,{value:u})),a?.inNode===e.id&&l("div",{className:"node-stats"},"Rendering flexGrow=",a.flexValue,l("br",null),l("br",null),"Splitting"," ",a.reservedTokens?`${a.tokenBudget} - ${a.reservedTokens} (reserved) = `:"",l(T,{value:a.tokenBudget})," tokens among ",a.elements.length," ","elements"),!o&&l(Xe,{nodes:e.children,scoreBy:t,epoch:n}))},Pe=({scoreBy:t,node:e,epoch:n})=>{let o;return t==="tokens"?o={field:"tokens",max:e.tokens,min:0}:o={field:"priority",max:e.priority,min:e.priority},l(Le,{scoreBy:o,node:e,epoch:n})};var ze=({label:t,value:e,onChange:n,min:o,max:r})=>{let _=a=>{n(a.target.valueAsNumber)},c=`number-slider-${Math.random()}`;return l("div",{className:"controls-slider"},l("label",{htmlFor:c},t),l("input",{id:c,type:"range",min:o,max:r,value:e,onInput:_}),l("input",{type:"number",min:o,value:e,onInput:_,onChange:_}))},Qe=({scoreBy:t,onScoreByChange:e})=>{let n=o=>{let r=o.target.value;e(r)};return l("div",{className:"controls-scoreby"},"Visualize by",l("label",null,l("input",{type:"radio",name:"scoreBy",value:"tokens",checked:t==="tokens",onChange:n}),"Tokens"),l("label",null,l("input",{type:"radio",name:"scoreBy",value:"priority",checked:t==="priority",onChange:n}),"Priority"))},Ye=()=>{let[t,e]=S(DEFAULT_TOKENS),[n,o]=S(EPOCHS.length),[r,_]=S(DEFAULT_MODEL),[c,a]=S("tokens"),[u,s]=S("epoch"),p=He(async f=>{if(f===DEFAULT_TOKENS)return DEFAULT_MODEL;let b=await(await fetch(`${SERVER_ADDRESS}regen?n=${f}`)).json();_(b)},100),i=f=>{e(f),p(f),o(EPOCHS.length)};return l("div",{className:"app"},l("div",{className:"controls"},l("div",{className:"tabs"},l("div",{className:`tab ${u==="epoch"?"active":""}`,onClick:()=>s("epoch")},"View Order"),l("div",{className:`tab ${u==="tokens"?"active":""}`,onClick:()=>s("tokens")},"Change Token Budget")),l("div",{className:`tab-content ${u==="epoch"?"active":""}`},l(ze,{label:"Render Epoch",value:n,onChange:o,min:0,max:EPOCHS.length})),l("div",{className:`tab-content ${u==="tokens"?"active":""}`},l(ze,{label:"Token Budget",value:t,onChange:i,min:0,max:DEFAULT_TOKENS*2}))),l("div",{className:"control-description"},u==="tokens"?l("p",null,"Token changes here will prune elements and re-render Expandable ones, but the entire prompt is not being re-rendered"):l("p",null,"Changing the render epoch lets you see the order in which elements are rendered and how the token budget is allocated."),l("div",{className:"controls-stats"},l("span",null,"Used ",l(T,{value:r.container.tokens}),"/",l(T,{value:r.budget})," tokens"),l("span",null,"Removed ",l(T,{value:r.removed})," nodes"),l(Qe,{scoreBy:c,onScoreByChange:a}))),l(Pe,{node:r.container,scoreBy:c,epoch:n}))};ve(l(Ye,null),document.body);})();\n';T8.tracerCss=`body{font-family:-apple-system,BlinkMacSystemFont,Segoe WPC,Segoe UI,system-ui,Ubuntu,Droid Sans,sans-serif;background:#fff;margin:0}.render-pass{border-left:2px solid #ccc;&:hover{border-left-color:#000}}.literals li{white-space:pre;font-family:SF Mono,Monaco,Menlo,Consolas,Ubuntu Mono,Liberation Mono,DejaVu Sans Mono,Courier New,monospace}.render-flex,.render-element{padding-left:10px}.node{border:1px solid rgba(255,255,255,.5);margin:3px 10px;padding:3px 10px;border-radius:4px;width:fit-content;&.new-in-epoch{box-shadow:0 0 3px 2px red}&.before-epoch{pointer-events:none;filter:grayscale(1);color:#777!important;.node{color:#777!important}}&:last-child{margin-bottom:0}}.node-content{font-weight:700}.node-children{margin-left:20px;border-left:2px dashed rgba(255,255,255,.5);padding-left:10px}.node-toggler{cursor:pointer;display:flex;align-items:center;justify-content:space-between;.indicator{font-size:.7em}}.node-text{width:400px;&:focus,&:focus-within{outline:1px solid orange;.node-content{white-space:normal}}.node-content{font-weight:400;font-size:.8em;white-space:nowrap;text-overflow:ellipsis;overflow:hidden}}.node-stats{font-family:SF Mono,Monaco,Menlo,Consolas,Ubuntu Mono,Liberation Mono,DejaVu Sans Mono,Courier New,monospace;font-size:.8em}.control-description{padding:10px;p{font-size:.9em;max-width:500px;margin-top:0}}.controls{display:flex;flex-direction:column;gap:10px;position:sticky;top:0;padding:10px;background:#fff;border-bottom:1px solid #ccc;z-index:1}.controls-slider{display:flex;align-items:center;gap:10px}.controls-stats{display:flex;gap:20px;list-style:none;padding:0;margin-top:0}.controls-scoreby{display:flex;gap:10px}.tabs{display:flex;border-bottom:1px solid #ccc;margin-bottom:10px}.tab{padding:10px;cursor:pointer;border:1px solid transparent;border-bottom:none}.tab.active{border-color:#ccc;border-bottom:1px solid #fff;background-color:#f9f9f9}.tab-content{display:none}.tab-content.active{display:block}
`});var kft=H(Nie=>{"use strict";d();Object.defineProperty(Nie,"__esModule",{value:!0});Nie.HTMLTracer=void 0;var wft=Tft(),Kk=qSe(),qmr=Hw(),x_e=class{static{s(this,"HTMLTracer")}traceData;epochs=[];addRenderEpoch(e){this.epochs.push(e)}includeInEpoch(e){this.epochs[this.epochs.length-1].elements.push(e)}didMaterializeTree(e){this.traceData=e}async serveHTML(){return E_e.create({epochs:this.epochs,traceData:_ft(this.traceData)})}serveRouter(e){return new Bie({baseAddress:e,epochs:this.epochs,traceData:_ft(this.traceData)})}};Nie.HTMLTracer=x_e;var Bie=class{static{s(this,"RequestRouter")}opts;serverToken=crypto.randomUUID();constructor(e){this.opts=e}route(e,r){let n=e,i=r,o=new URL(n.url||"/","http://localhost"),a=`/${this.serverToken}`;switch(o.pathname){case a:case`${a}/`:this.onRoot(o,n,i);break;case`${a}/regen`:this.onRegen(o,n,i);break;default:return!1}return!0}get address(){return this.opts.baseAddress+"/"+this.serverToken}async getHTML(){let{traceData:e,epochs:r}=this.opts;return`<body>
			<style>${wft.tracerCss}</style>
			<script>
				const DEFAULT_TOKENS = ${JSON.stringify(e.budget)};
				const EPOCHS = ${JSON.stringify(r)};
				const DEFAULT_MODEL = ${JSON.stringify(await Sft(e.tokenizer,e.renderedTree))};
				const SERVER_ADDRESS = ${JSON.stringify(this.opts.baseAddress+"/"+this.serverToken+"/")};
				${wft.tracerSrc}
			</script>
		</body>`}async onRegen(e,r,n){let{traceData:i}=this.opts,o=Number(e.searchParams.get("n")||i.budget),a=await i.renderTree(o),c=await Sft(i.tokenizer,a),l=JSON.stringify(c);n.setHeader("Content-Type","application/json"),n.setHeader("Content-Length",Buffer.byteLength(l)),n.end(l)}onRoot(e,r,n){this.getHTML().then(i=>{n.setHeader("Content-Type","text/html"),n.setHeader("Content-Length",Buffer.byteLength(i)),n.end(i)})}},E_e=class t extends Bie{static{s(this,"RequestServer")}server;static async create(e){let{createServer:r}=await Promise.resolve().then(()=>require("http")),n=r((a,c)=>{try{o.route(a,c)||(c.statusCode=404,c.end("Not Found"))}catch(l){c.statusCode=500,c.end(String(l))}}),i=await new Promise((a,c)=>{n.listen(0,"127.0.0.1",()=>a(n.address().port)).on("error",c)}),o=new t({...e,baseAddress:`http://127.0.0.1:${i}`},n);return o}constructor(e,r){super(e),this.server=r}dispose(){this.server.closeAllConnections(),this.server.close()}};async function Sft(t,e){return{container:await Rft(t,e.container,!1),removed:e.removed,budget:e.budget}}s(Sft,"serializeRenderData");async function Rft(t,e,r){let n={metadata:e.metadata.map($mr),priority:e.priority};if(e instanceof Kk.MaterializedChatMessageTextChunk)return{...n,type:2,value:e.text,tokens:await e.upperBoundTokenCount(t)};if(e instanceof Kk.MaterializedChatMessageImage)return{...n,name:e.id.toString(),id:e.id,type:3,value:e.src,tokens:await e.upperBoundTokenCount(t)};if(e instanceof Kk.MaterializedChatMessageOpaque||e instanceof Kk.MaterializedChatMessageBreakpoint)return;{let i={...n,id:e.id,name:e.name,children:(await Promise.all(e.children.map(o=>Rft(t,o,r||e instanceof Kk.MaterializedChatMessage)))).filter(o=>!!o),tokens:r?await e.upperBoundTokenCount(t):await e.tokenCount(t)};if(e instanceof Kk.GenericMaterializedContainer)return{...i,type:0};if(e instanceof Kk.MaterializedChatMessage){let o=e.text.filter(a=>typeof a=="string").join("").trim();return{...i,type:1,role:qmr.Raw.ChatRole.display(e.role),text:o}}}Hmr(e)}s(Rft,"serializeMaterialized");function Hmr(t){throw new Error("unreachable")}s(Hmr,"assertNever");function $mr(t){return{name:t.constructor.name,value:JSON.stringify(t)}}s($mr,"serializeMetadata");var _ft=s(t=>{if(t===void 0)throw new Error("Prompt must be rendered before calling HTMLTRacer.serveHTML");return t},"mustGet")});var Dft=H(Pft=>{"use strict";d();Object.defineProperty(Pft,"__esModule",{value:!0})});var Nft=H(Bft=>{"use strict";d();Object.defineProperty(Bft,"__esModule",{value:!0})});var Lft=H(Mft=>{"use strict";d();Object.defineProperty(Mft,"__esModule",{value:!0})});var Aa=H(ya=>{"use strict";d();var Wmr=ya&&ya.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:s(function(){return e[r]},"get")}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),Yk=ya&&ya.__exportStar||function(t,e){for(var r in t)r!=="default"&&!Object.prototype.hasOwnProperty.call(e,r)&&Wmr(e,t,r)};Object.defineProperty(ya,"__esModule",{value:!0});ya.contentType=ya.PromptRenderer=ya.MetadataMap=ya.PromptElement=ya.JSONTree=void 0;ya.renderPrompt=Vmr;ya.renderElementJSON=zmr;var b_e=Hw(),Fft=y_e(),jmr=Ift();Yk(kft(),ya);ya.JSONTree=LSe();Yk(Hw(),ya);Yk(ZSe(),ya);Yk(l_e(),ya);Yk(Dft(),ya);Yk(Nft(),ya);Yk(Lft(),ya);var Gmr=$Se();Object.defineProperty(ya,"PromptElement",{enumerable:!0,get:s(function(){return Gmr.PromptElement},"get")});var Oft=y_e();Object.defineProperty(ya,"MetadataMap",{enumerable:!0,get:s(function(){return Oft.MetadataMap},"get")});Object.defineProperty(ya,"PromptRenderer",{enumerable:!0,get:s(function(){return Oft.PromptRenderer},"get")});async function Vmr(t,e,r,n,i,o,a=b_e.OutputMode.VSCode){let c="countTokens"in n?new jmr.VSCodeTokenizer((p,m)=>n.countTokens(p,m),a):n,l=new Fft.PromptRenderer(r,t,e,c),u=await l.render(i,o),f=l.getUsedContext();return{...u,usedContext:f}}s(Vmr,"renderPrompt");ya.contentType="application/vnd.codechat.prompt+json.1";function zmr(t,e,r,n){return new Fft.PromptRenderer({modelMaxPromptTokens:r?.tokenBudget??Number.MAX_SAFE_INTEGER},t,e,{mode:b_e.OutputMode.Raw,countMessageTokens(o){throw new Error("Tools may only return text, not messages.")},tokenLength(o,a){return o.type===b_e.Raw.ChatCompletionContentPartKind.Text?Promise.resolve(r?.countTokens(o.text,a)??Promise.resolve(1)):Promise.resolve(1)}}).renderElementJSON(n)}s(zmr,"renderElementJSON")});var gm=H(Pq=>{"use strict";d();Object.defineProperty(Pq,"__esModule",{value:!0});Pq.dedent=void 0;function hmt(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];var n=Array.from(typeof t=="string"?[t]:t);n[n.length-1]=n[n.length-1].replace(/\r?\n([\t ]*)$/,"");var i=n.reduce(function(c,l){var u=l.match(/\n([\t ]+|(?!\s).)/g);return u?c.concat(u.map(function(f){var p,m;return(m=(p=f.match(/[\t ]/g))===null||p===void 0?void 0:p.length)!==null&&m!==void 0?m:0})):c},[]);if(i.length){var o=new RegExp(`
[	 ]{`+Math.min.apply(Math,i)+"}","g");n=n.map(function(c){return c.replace(o,`
`)})}n[0]=n[0].replace(/^\r?\n/,"");var a=n[0];return e.forEach(function(c,l){var u=a.match(/(?:^|\n)( *)$/),f=u?u[1]:"",p=c;typeof c=="string"&&c.includes(`
`)&&(p=String(c).split(`
`).map(function(m,h){return h===0?m:""+f+m}).join(`
`)),a+=p+n[l+1]}),a}s(hmt,"dedent");Pq.dedent=hmt;Pq.default=hmt});var Emt=H(gRe=>{"use strict";d();Object.defineProperty(gRe,"__esModule",{value:!0});gRe.workerFile=`
const { parentPort } = require('worker_threads')

parentPort.on('message', async worker => {
  const response = {
    error: null,
    data: null
  }

  try {
    eval(worker)
    // __executor__ is defined in worker
    response.data = await __executor__()
    parentPort.postMessage(response)
  } catch (err) {
    response.data = null
    response.error = {
      message: err.message,
      stack: err.stack
    }

    try {
      parentPort.postMessage(response)
    } catch (err) {
      console.error(err)
    }
  }
})
`});var _mt=H(yRe=>{"use strict";d();Object.defineProperty(yRe,"__esModule",{value:!0});var bmt=require("worker_threads"),NAr=require("v8"),MAr=require("os"),Imt=Emt(),kse="ready",Tmt="spawning",LAr="busy",Pse="off",wmt=MAr.cpus().length,Smt=process.version.replace("v","").split("."),FAr=parseInt(Smt[0]),OAr=parseInt(Smt[1]),ARe=class{static{s(this,"WorkerPool")}constructor(){this.maxWorkers=wmt,this.taskQueue=[],this.workers=[]}resurrect(e){let r=new bmt.Worker(Imt.workerFile,{eval:!0});e.status=Tmt,e.worker=r,r.once("online",()=>process.nextTick(()=>{e.status=kse,r.removeAllListeners(),this.tick()})),r.once("error",n=>{console.error(n),e.status=Pse,r.removeAllListeners(),this.tick()})}tick(){if(this.workers.filter(({status:l})=>l===Pse).forEach(l=>this.resurrect(l)),this.taskQueue.length===0)return;let e;for(let l=0;l<this.workers.length;l++)if(this.workers[l].status===kse){e=this.workers[l];break}if(typeof e>"u")return;let r=this.taskQueue.shift();e.status=LAr;let{worker:n}=e,{handler:i,config:o,resolve:a,reject:c}=r;try{let l="";for(let m in o.ctx){if(!o.ctx.hasOwnProperty(m))continue;let h;switch(typeof o.ctx[m]){case"string":h=`'${o.ctx[m]}'`;break;case"object":h=JSON.stringify(o.ctx[m]);break;default:h=o.ctx[m]}l+=`let ${m} = ${h}
`}let u=NAr.serialize(o.data),f=JSON.stringify(u),p=`
      async function __executor__() {
        const v8 = require('v8')
        ${l}
        const dataParsed = JSON.parse('${f}')
        const dataBuffer = Buffer.from(dataParsed.data)
        const dataDeserialized = v8.deserialize(dataBuffer)
        return await (${i.toString()})(dataDeserialized)
      }
      `;n.once("message",m=>{if(this.free(n),typeof m.error>"u"||m.error===null)return a(m.data);let h=new Error(m.error.message);h.stack=m.error.stack,c(h)}),n.once("error",m=>{e.status=Pse,c(m),this.tick()}),n.postMessage(p)}catch(l){this.free(n),c(l)}}enqueue({handler:e,config:r,resolve:n,reject:i}){this.taskQueue.push({handler:e,config:r,resolve:n,reject:i}),this.tick()}free(e){for(let r=0;r<this.workers.length;r++)if(e.threadId===this.workers[r].worker.threadId){this.workers[r].status=kse,this.workers[r].worker.removeAllListeners(),this.tick();break}}setup(e={}){return this.maxWorkers=e.maxWorkers>0?e.maxWorkers:wmt,this.maxWorkers>10&&console.warn(`Worker pool has more than 10 workers.
You should also increase the Max Listeners of Node.js (https://nodejs.org/docs/latest/api/events.html#events_emitter_setmaxlisteners_n)
Otherwise, limit them with start({maxWorkers: 10})`),new Promise((r,n)=>{let i=0,o=0;for(let a=0;a<this.maxWorkers;a++){let c=new bmt.Worker(Imt.workerFile,{eval:!0});this.workers.push({status:Tmt,worker:c}),c.once("online",(l=>()=>{process.nextTick(()=>{this.workers[l].status=kse,this.workers[l].worker.removeAllListeners(),i++,i>0&&i+o===this.maxWorkers&&r()})})(a)),c.once("error",(l=>u=>{this.workers[l].status=Pse,this.workers[l].worker.removeAllListeners(),o++,o===this.maxWorkers&&n(u)})(a))}})}async teardown(){if(FAr>=12&&OAr>=5){let e=[];for(let{worker:r}of this.workers)e.push(r.terminate());await Promise.all(e),this.workers=[]}else await new Promise(r=>{let n=0;for(let i=0;i<this.workers.length;i++)this.workers[i].worker.terminate(()=>{n++,n===this.workers.length&&(this.workers=[],r())})})}};yRe.default=new ARe});var Dse=H(CP=>{"use strict";d();var QAr=CP&&CP.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(CP,"__esModule",{value:!0});var Mq=QAr(_mt()),UAr=`job needs a function.
Try with:
> job(() => {...}, config)`,qAr=`job needs an object as ctx.
Try with:
> job(() => {...}, {ctx: {...}})`;function HAr(t,e={ctx:{},data:{}}){return new Promise((r,n)=>{if(typeof t!="function")return n(new Error(UAr));if(e.ctx=e.ctx||{},e.data=e.data||{},typeof e.ctx!="object")return n(new Error(qAr));Mq.default.enqueue({handler:t,config:e,resolve:r,reject:n})})}s(HAr,"job");CP.job=HAr;CP.stop=Mq.default.teardown.bind(Mq.default);CP.start=Mq.default.setup.bind(Mq.default)});var Qmt=H(vP=>{"use strict";d();var W1=vP&&vP.__classPrivateFieldGet||function(t,e,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(t):n?n.value:e.get(t)},ERe=vP&&vP.__classPrivateFieldSet||function(t,e,r,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!i:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(t,r):i?i.value=r:e.set(t,r),r},DE,gS;Object.defineProperty(vP,"__esModule",{value:!0});var bRe=class{static{s(this,"AwaitLock")}constructor(){DE.set(this,!1),gS.set(this,new Set)}get acquired(){return W1(this,DE,"f")}acquireAsync({timeout:e}={}){if(!W1(this,DE,"f"))return ERe(this,DE,!0,"f"),Promise.resolve();if(e==null)return new Promise(i=>{W1(this,gS,"f").add(i)});let r,n;return Promise.race([new Promise(i=>{r=s(()=>{clearTimeout(n),i()},"resolver"),W1(this,gS,"f").add(r)}),new Promise((i,o)=>{n=setTimeout(()=>{W1(this,gS,"f").delete(r),o(new Error("Timed out waiting for lock"))},e)})])}tryAcquire(){return W1(this,DE,"f")?!1:(ERe(this,DE,!0,"f"),!0)}release(){if(!W1(this,DE,"f"))throw new Error("Cannot release an unacquired lock");if(W1(this,gS,"f").size>0){let[e]=W1(this,gS,"f");W1(this,gS,"f").delete(e),e()}else ERe(this,DE,!1,"f")}};vP.default=bRe;DE=new WeakMap,gS=new WeakMap});var uPe=H((Fbo,byt)=>{d();var aH=typeof performance=="object"&&performance&&typeof performance.now=="function"?performance:Date,Kbr=typeof AbortController=="function",Nce=Kbr?AbortController:class{static{s(this,"AbortController")}constructor(){this.signal=new vyt}abort(){this.signal.dispatchEvent("abort")}},Ybr=typeof AbortSignal=="function",Jbr=typeof Nce.AbortSignal=="function",vyt=Ybr?AbortSignal:Jbr?Nce.AbortController:class{static{s(this,"AbortSignal")}constructor(){this.aborted=!1,this._listeners=[]}dispatchEvent(e){if(e==="abort"){this.aborted=!0;let r={type:e,target:this};this.onabort(r),this._listeners.forEach(n=>n(r),this)}}onabort(){}addEventListener(e,r){e==="abort"&&this._listeners.push(r)}removeEventListener(e,r){e==="abort"&&(this._listeners=this._listeners.filter(n=>n!==r))}},cPe=new Set,oPe=s((t,e)=>{let r=`LRU_CACHE_OPTION_${t}`;Mce(r)&&lPe(r,`${t} option`,`options.${e}`,LM)},"deprecatedOption"),sPe=s((t,e)=>{let r=`LRU_CACHE_METHOD_${t}`;if(Mce(r)){let{prototype:n}=LM,{get:i}=Object.getOwnPropertyDescriptor(n,t);lPe(r,`${t} method`,`cache.${e}()`,i)}},"deprecatedMethod"),Xbr=s((t,e)=>{let r=`LRU_CACHE_PROPERTY_${t}`;if(Mce(r)){let{prototype:n}=LM,{get:i}=Object.getOwnPropertyDescriptor(n,t);lPe(r,`${t} property`,`cache.${e}`,i)}},"deprecatedProperty"),xyt=s((...t)=>{typeof process=="object"&&process&&typeof process.emitWarning=="function"?process.emitWarning(...t):console.error(...t)},"emitWarning"),Mce=s(t=>!cPe.has(t),"shouldWarn"),lPe=s((t,e,r,n)=>{cPe.add(t);let i=`The ${e} is deprecated. Please use ${r} instead.`;xyt(i,"DeprecationWarning",t,n)},"warn"),NP=s(t=>t&&t===Math.floor(t)&&t>0&&isFinite(t),"isPosInt"),Eyt=s(t=>NP(t)?t<=Math.pow(2,8)?Uint8Array:t<=Math.pow(2,16)?Uint16Array:t<=Math.pow(2,32)?Uint32Array:t<=Number.MAX_SAFE_INTEGER?MM:null:null,"getUintArray"),MM=class extends Array{static{s(this,"ZeroArray")}constructor(e){super(e),this.fill(0)}},aPe=class{static{s(this,"Stack")}constructor(e){if(e===0)return[];let r=Eyt(e);this.heap=new r(e),this.length=0}push(e){this.heap[this.length++]=e}pop(){return this.heap[--this.length]}},LM=class t{static{s(this,"LRUCache")}constructor(e={}){let{max:r=0,ttl:n,ttlResolution:i=1,ttlAutopurge:o,updateAgeOnGet:a,updateAgeOnHas:c,allowStale:l,dispose:u,disposeAfter:f,noDisposeOnSet:p,noUpdateTTL:m,maxSize:h=0,sizeCalculation:g,fetchMethod:A,fetchContext:y,noDeleteOnFetchRejection:E,noDeleteOnStaleGet:b}=e,{length:S,maxAge:R,stale:B}=e instanceof t?{}:e;if(r!==0&&!NP(r))throw new TypeError("max option must be a nonnegative integer");let L=r?Eyt(r):Array;if(!L)throw new Error("invalid max value: "+r);if(this.max=r,this.maxSize=h,this.sizeCalculation=g||S,this.sizeCalculation){if(!this.maxSize)throw new TypeError("cannot set sizeCalculation without setting maxSize");if(typeof this.sizeCalculation!="function")throw new TypeError("sizeCalculation set to non-function")}if(this.fetchMethod=A||null,this.fetchMethod&&typeof this.fetchMethod!="function")throw new TypeError("fetchMethod must be a function if specified");if(this.fetchContext=y,!this.fetchMethod&&y!==void 0)throw new TypeError("cannot set fetchContext without fetchMethod");if(this.keyMap=new Map,this.keyList=new Array(r).fill(null),this.valList=new Array(r).fill(null),this.next=new L(r),this.prev=new L(r),this.head=0,this.tail=0,this.free=new aPe(r),this.initialFill=1,this.size=0,typeof u=="function"&&(this.dispose=u),typeof f=="function"?(this.disposeAfter=f,this.disposed=[]):(this.disposeAfter=null,this.disposed=null),this.noDisposeOnSet=!!p,this.noUpdateTTL=!!m,this.noDeleteOnFetchRejection=!!E,this.maxSize!==0){if(!NP(this.maxSize))throw new TypeError("maxSize must be a positive integer if specified");this.initializeSizeTracking()}if(this.allowStale=!!l||!!B,this.noDeleteOnStaleGet=!!b,this.updateAgeOnGet=!!a,this.updateAgeOnHas=!!c,this.ttlResolution=NP(i)||i===0?i:1,this.ttlAutopurge=!!o,this.ttl=n||R||0,this.ttl){if(!NP(this.ttl))throw new TypeError("ttl must be a positive integer if specified");this.initializeTTLTracking()}if(this.max===0&&this.ttl===0&&this.maxSize===0)throw new TypeError("At least one of max, maxSize, or ttl is required");if(!this.ttlAutopurge&&!this.max&&!this.maxSize){let O="LRU_CACHE_UNBOUNDED";Mce(O)&&(cPe.add(O),xyt("TTL caching without ttlAutopurge, max, or maxSize can result in unbounded memory consumption.","UnboundedCacheWarning",O,t))}B&&oPe("stale","allowStale"),R&&oPe("maxAge","ttl"),S&&oPe("length","sizeCalculation")}getRemainingTTL(e){return this.has(e,{updateAgeOnHas:!1})?1/0:0}initializeTTLTracking(){this.ttls=new MM(this.max),this.starts=new MM(this.max),this.setItemTTL=(n,i,o=aH.now())=>{if(this.starts[n]=i!==0?o:0,this.ttls[n]=i,i!==0&&this.ttlAutopurge){let a=setTimeout(()=>{this.isStale(n)&&this.delete(this.keyList[n])},i+1);a.unref&&a.unref()}},this.updateItemAge=n=>{this.starts[n]=this.ttls[n]!==0?aH.now():0};let e=0,r=s(()=>{let n=aH.now();if(this.ttlResolution>0){e=n;let i=setTimeout(()=>e=0,this.ttlResolution);i.unref&&i.unref()}return n},"getNow");this.getRemainingTTL=n=>{let i=this.keyMap.get(n);return i===void 0?0:this.ttls[i]===0||this.starts[i]===0?1/0:this.starts[i]+this.ttls[i]-(e||r())},this.isStale=n=>this.ttls[n]!==0&&this.starts[n]!==0&&(e||r())-this.starts[n]>this.ttls[n]}updateItemAge(e){}setItemTTL(e,r,n){}isStale(e){return!1}initializeSizeTracking(){this.calculatedSize=0,this.sizes=new MM(this.max),this.removeItemSize=e=>{this.calculatedSize-=this.sizes[e],this.sizes[e]=0},this.requireSize=(e,r,n,i)=>{if(!NP(n))if(i){if(typeof i!="function")throw new TypeError("sizeCalculation must be a function");if(n=i(r,e),!NP(n))throw new TypeError("sizeCalculation return invalid (expect positive integer)")}else throw new TypeError("invalid size value (must be positive integer)");return n},this.addItemSize=(e,r)=>{this.sizes[e]=r;let n=this.maxSize-this.sizes[e];for(;this.calculatedSize>n;)this.evict(!0);this.calculatedSize+=this.sizes[e]}}removeItemSize(e){}addItemSize(e,r){}requireSize(e,r,n,i){if(n||i)throw new TypeError("cannot set size without setting maxSize on cache")}*indexes({allowStale:e=this.allowStale}={}){if(this.size)for(let r=this.tail;!(!this.isValidIndex(r)||((e||!this.isStale(r))&&(yield r),r===this.head));)r=this.prev[r]}*rindexes({allowStale:e=this.allowStale}={}){if(this.size)for(let r=this.head;!(!this.isValidIndex(r)||((e||!this.isStale(r))&&(yield r),r===this.tail));)r=this.next[r]}isValidIndex(e){return this.keyMap.get(this.keyList[e])===e}*entries(){for(let e of this.indexes())yield[this.keyList[e],this.valList[e]]}*rentries(){for(let e of this.rindexes())yield[this.keyList[e],this.valList[e]]}*keys(){for(let e of this.indexes())yield this.keyList[e]}*rkeys(){for(let e of this.rindexes())yield this.keyList[e]}*values(){for(let e of this.indexes())yield this.valList[e]}*rvalues(){for(let e of this.rindexes())yield this.valList[e]}[Symbol.iterator](){return this.entries()}find(e,r={}){for(let n of this.indexes())if(e(this.valList[n],this.keyList[n],this))return this.get(this.keyList[n],r)}forEach(e,r=this){for(let n of this.indexes())e.call(r,this.valList[n],this.keyList[n],this)}rforEach(e,r=this){for(let n of this.rindexes())e.call(r,this.valList[n],this.keyList[n],this)}get prune(){return sPe("prune","purgeStale"),this.purgeStale}purgeStale(){let e=!1;for(let r of this.rindexes({allowStale:!0}))this.isStale(r)&&(this.delete(this.keyList[r]),e=!0);return e}dump(){let e=[];for(let r of this.indexes({allowStale:!0})){let n=this.keyList[r],i=this.valList[r],a={value:this.isBackgroundFetch(i)?i.__staleWhileFetching:i};if(this.ttls){a.ttl=this.ttls[r];let c=aH.now()-this.starts[r];a.start=Math.floor(Date.now()-c)}this.sizes&&(a.size=this.sizes[r]),e.unshift([n,a])}return e}load(e){this.clear();for(let[r,n]of e){if(n.start){let i=Date.now()-n.start;n.start=aH.now()-i}this.set(r,n.value,n)}}dispose(e,r,n){}set(e,r,{ttl:n=this.ttl,start:i,noDisposeOnSet:o=this.noDisposeOnSet,size:a=0,sizeCalculation:c=this.sizeCalculation,noUpdateTTL:l=this.noUpdateTTL}={}){if(a=this.requireSize(e,r,a,c),this.maxSize&&a>this.maxSize)return this;let u=this.size===0?void 0:this.keyMap.get(e);if(u===void 0)u=this.newIndex(),this.keyList[u]=e,this.valList[u]=r,this.keyMap.set(e,u),this.next[this.tail]=u,this.prev[u]=this.tail,this.tail=u,this.size++,this.addItemSize(u,a),l=!1;else{let f=this.valList[u];r!==f&&(this.isBackgroundFetch(f)?f.__abortController.abort():o||(this.dispose(f,e,"set"),this.disposeAfter&&this.disposed.push([f,e,"set"])),this.removeItemSize(u),this.valList[u]=r,this.addItemSize(u,a)),this.moveToTail(u)}if(n!==0&&this.ttl===0&&!this.ttls&&this.initializeTTLTracking(),l||this.setItemTTL(u,n,i),this.disposeAfter)for(;this.disposed.length;)this.disposeAfter(...this.disposed.shift());return this}newIndex(){return this.size===0?this.tail:this.size===this.max&&this.max!==0?this.evict(!1):this.free.length!==0?this.free.pop():this.initialFill++}pop(){if(this.size){let e=this.valList[this.head];return this.evict(!0),e}}evict(e){let r=this.head,n=this.keyList[r],i=this.valList[r];return this.isBackgroundFetch(i)?i.__abortController.abort():(this.dispose(i,n,"evict"),this.disposeAfter&&this.disposed.push([i,n,"evict"])),this.removeItemSize(r),e&&(this.keyList[r]=null,this.valList[r]=null,this.free.push(r)),this.head=this.next[r],this.keyMap.delete(n),this.size--,r}has(e,{updateAgeOnHas:r=this.updateAgeOnHas}={}){let n=this.keyMap.get(e);return n!==void 0&&!this.isStale(n)?(r&&this.updateItemAge(n),!0):!1}peek(e,{allowStale:r=this.allowStale}={}){let n=this.keyMap.get(e);if(n!==void 0&&(r||!this.isStale(n))){let i=this.valList[n];return this.isBackgroundFetch(i)?i.__staleWhileFetching:i}}backgroundFetch(e,r,n,i){let o=r===void 0?void 0:this.valList[r];if(this.isBackgroundFetch(o))return o;let a=new Nce,c={signal:a.signal,options:n,context:i},l=s(m=>(a.signal.aborted||this.set(e,m,c.options),m),"cb"),u=s(m=>{if(this.valList[r]===p&&(!n.noDeleteOnFetchRejection||p.__staleWhileFetching===void 0?this.delete(e):this.valList[r]=p.__staleWhileFetching),p.__returned===p)throw m},"eb"),f=s(m=>m(this.fetchMethod(e,o,c)),"pcall"),p=new Promise(f).then(l,u);return p.__abortController=a,p.__staleWhileFetching=o,p.__returned=null,r===void 0?(this.set(e,p,c.options),r=this.keyMap.get(e)):this.valList[r]=p,p}isBackgroundFetch(e){return e&&typeof e=="object"&&typeof e.then=="function"&&Object.prototype.hasOwnProperty.call(e,"__staleWhileFetching")&&Object.prototype.hasOwnProperty.call(e,"__returned")&&(e.__returned===e||e.__returned===null)}async fetch(e,{allowStale:r=this.allowStale,updateAgeOnGet:n=this.updateAgeOnGet,noDeleteOnStaleGet:i=this.noDeleteOnStaleGet,ttl:o=this.ttl,noDisposeOnSet:a=this.noDisposeOnSet,size:c=0,sizeCalculation:l=this.sizeCalculation,noUpdateTTL:u=this.noUpdateTTL,noDeleteOnFetchRejection:f=this.noDeleteOnFetchRejection,fetchContext:p=this.fetchContext,forceRefresh:m=!1}={}){if(!this.fetchMethod)return this.get(e,{allowStale:r,updateAgeOnGet:n,noDeleteOnStaleGet:i});let h={allowStale:r,updateAgeOnGet:n,noDeleteOnStaleGet:i,ttl:o,noDisposeOnSet:a,size:c,sizeCalculation:l,noUpdateTTL:u,noDeleteOnFetchRejection:f},g=this.keyMap.get(e);if(g===void 0){let A=this.backgroundFetch(e,g,h,p);return A.__returned=A}else{let A=this.valList[g];if(this.isBackgroundFetch(A))return r&&A.__staleWhileFetching!==void 0?A.__staleWhileFetching:A.__returned=A;if(!m&&!this.isStale(g))return this.moveToTail(g),n&&this.updateItemAge(g),A;let y=this.backgroundFetch(e,g,h,p);return r&&y.__staleWhileFetching!==void 0?y.__staleWhileFetching:y.__returned=y}}get(e,{allowStale:r=this.allowStale,updateAgeOnGet:n=this.updateAgeOnGet,noDeleteOnStaleGet:i=this.noDeleteOnStaleGet}={}){let o=this.keyMap.get(e);if(o!==void 0){let a=this.valList[o],c=this.isBackgroundFetch(a);return this.isStale(o)?c?r?a.__staleWhileFetching:void 0:(i||this.delete(e),r?a:void 0):c?void 0:(this.moveToTail(o),n&&this.updateItemAge(o),a)}}connect(e,r){this.prev[r]=e,this.next[e]=r}moveToTail(e){e!==this.tail&&(e===this.head?this.head=this.next[e]:this.connect(this.prev[e],this.next[e]),this.connect(this.tail,e),this.tail=e)}get del(){return sPe("del","delete"),this.delete}delete(e){let r=!1;if(this.size!==0){let n=this.keyMap.get(e);if(n!==void 0)if(r=!0,this.size===1)this.clear();else{this.removeItemSize(n);let i=this.valList[n];this.isBackgroundFetch(i)?i.__abortController.abort():(this.dispose(i,e,"delete"),this.disposeAfter&&this.disposed.push([i,e,"delete"])),this.keyMap.delete(e),this.keyList[n]=null,this.valList[n]=null,n===this.tail?this.tail=this.prev[n]:n===this.head?this.head=this.next[n]:(this.next[this.prev[n]]=this.next[n],this.prev[this.next[n]]=this.prev[n]),this.size--,this.free.push(n)}}if(this.disposed)for(;this.disposed.length;)this.disposeAfter(...this.disposed.shift());return r}clear(){for(let e of this.rindexes({allowStale:!0})){let r=this.valList[e];if(this.isBackgroundFetch(r))r.__abortController.abort();else{let n=this.keyList[e];this.dispose(r,n,"delete"),this.disposeAfter&&this.disposed.push([r,n,"delete"])}}if(this.keyMap.clear(),this.valList.fill(null),this.keyList.fill(null),this.ttls&&(this.ttls.fill(0),this.starts.fill(0)),this.sizes&&this.sizes.fill(0),this.head=0,this.tail=0,this.initialFill=1,this.free.length=0,this.calculatedSize=0,this.size=0,this.disposed)for(;this.disposed.length;)this.disposeAfter(...this.disposed.shift())}get reset(){return sPe("reset","clear"),this.clear}get length(){return Xbr("length","size"),this.size}static get AbortController(){return Nce}static get AbortSignal(){return vyt}};byt.exports=LM});var pPe=H((Ubo,Iyt)=>{"use strict";d();var cH=class extends Error{static{s(this,"FetchBaseError")}constructor(e,r,n){super(e),this.type=r,this._name=n}get name(){return this._name}get[Symbol.toStringTag](){return this._name}},dPe=class extends cH{static{s(this,"FetchError")}constructor(e,r,n){super(e,r,"FetchError"),n&&(this.code=n.code,this.errno=n.errno,this.erroredSysCall=n.syscall)}},fPe=class extends cH{static{s(this,"AbortError")}constructor(e,r="aborted"){super(e,r,"AbortError")}};Iyt.exports={FetchBaseError:cH,FetchError:dPe,AbortError:fPe}});var QE=H(($bo,wyt)=>{"use strict";d();var{constants:{MAX_LENGTH:Zbr}}=require("buffer"),{pipeline:Lce,PassThrough:eIr}=require("stream"),{promisify:tIr}=require("util"),{createGunzip:rIr,createInflate:nIr,createBrotliDecompress:iIr,constants:{Z_SYNC_FLUSH:Tyt}}=require("zlib"),oIr=kC()("helix-fetch:utils"),sIr=tIr(Lce),aIr=s((t,e)=>t===204||t===304||+e["content-length"]==0?!1:/^\s*(?:(x-)?deflate|(x-)?gzip|br)\s*$/.test(e["content-encoding"]),"canDecode"),cIr=s((t,e,r,n)=>{if(!aIr(t,e))return r;let i=s(o=>{o&&(oIr(`encountered error while decoding stream: ${o}`),n(o))},"cb");switch(e["content-encoding"].trim()){case"gzip":case"x-gzip":return Lce(r,rIr({flush:Tyt,finishFlush:Tyt}),i);case"deflate":case"x-deflate":return Lce(r,nIr(),i);case"br":return Lce(r,iIr(),i);default:return r}},"decodeStream"),lIr=s(t=>{if(!t||typeof t!="object"||Object.prototype.toString.call(t)!=="[object Object]")return!1;if(Object.getPrototypeOf(t)===null)return!0;let e=t;for(;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e},"isPlainObject"),Fce=s((t,e)=>{if(Buffer.isBuffer(t))return t.length;switch(typeof t){case"string":return t.length*2;case"boolean":return 4;case"number":return 8;case"symbol":return Symbol.keyFor(t)?Symbol.keyFor(t).length*2:(t.toString().length-8)*2;case"object":return Array.isArray(t)?uIr(t,e):dIr(t,e);default:return 0}},"calcSize"),uIr=s((t,e)=>(e.add(t),t.map(r=>e.has(r)?0:Fce(r,e)).reduce((r,n)=>r+n,0)),"calcArraySize"),dIr=s((t,e)=>{if(t==null)return 0;e.add(t);let r=0,n=[];for(let i in t)n.push(i);return n.push(...Object.getOwnPropertySymbols(t)),n.forEach(i=>{if(r+=Fce(i,e),typeof t[i]=="object"&&t[i]!==null){if(e.has(t[i]))return;e.add(t[i])}r+=Fce(t[i],e)}),r},"calcObjectSize"),fIr=s(t=>Fce(t,new WeakSet),"sizeof"),pIr=s(async t=>{let e=new eIr,r=0,n=[];return e.on("data",i=>{if(r+i.length>Zbr)throw new Error("Buffer.constants.MAX_SIZE exceeded");n.push(i),r+=i.length}),await sIr(t,e),Buffer.concat(n,r)},"streamToBuffer");wyt.exports={decodeStream:cIr,isPlainObject:lIr,sizeof:fIr,streamToBuffer:pIr}});var Qce=H((Gbo,kyt)=>{"use strict";d();var{PassThrough:Syt,Readable:UE}=require("stream"),{types:{isAnyArrayBuffer:Ryt}}=require("util"),{FetchError:mIr,FetchBaseError:hIr}=pPe(),{streamToBuffer:gIr}=QE(),AIr=Buffer.alloc(0),hg=Symbol("Body internals"),yIr=s(t=>t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength),"toArrayBuffer"),_yt=s(async t=>{if(t[hg].disturbed)throw new TypeError("Already read");if(t[hg].error)throw new TypeError(`Stream had error: ${t[hg].error.message}`);t[hg].disturbed=!0;let{stream:e}=t[hg];return e===null?AIr:gIr(e)},"consume"),Oce=class{static{s(this,"Body")}constructor(e){let r;e==null?r=null:e instanceof URLSearchParams?r=UE.from(e.toString()):e instanceof UE?r=e:Buffer.isBuffer(e)?r=UE.from(e):Ryt(e)?r=UE.from(Buffer.from(e)):typeof e=="string"||e instanceof String?r=UE.from(e):r=UE.from(String(e)),this[hg]={stream:r,disturbed:!1,error:null},e instanceof UE&&r.on("error",n=>{let i=n instanceof hIr?n:new mIr(`Invalid response body while trying to fetch ${this.url}: ${n.message}`,"system",n);this[hg].error=i})}get body(){return this[hg].stream}get bodyUsed(){return this[hg].disturbed}async buffer(){return _yt(this)}async arrayBuffer(){return yIr(await this.buffer())}async text(){return(await _yt(this)).toString()}async json(){return JSON.parse(await this.text())}};Object.defineProperties(Oce.prototype,{body:{enumerable:!0},bodyUsed:{enumerable:!0},arrayBuffer:{enumerable:!0},json:{enumerable:!0},text:{enumerable:!0}});var CIr=s(t=>{if(t[hg].disturbed)throw new TypeError("Cannot clone: already read");let{stream:e}=t[hg],r=e;if(e instanceof UE){r=new Syt;let n=new Syt;e.pipe(r),e.pipe(n),t[hg].stream=n}return r},"cloneStream"),vIr=s(t=>t===null?null:typeof t=="string"?"text/plain; charset=utf-8":t instanceof URLSearchParams?"application/x-www-form-urlencoded; charset=utf-8":Buffer.isBuffer(t)||Ryt(t)||t instanceof UE?null:"text/plain; charset=utf-8","guessContentType");kyt.exports={Body:Oce,cloneStream:CIr,guessContentType:vIr}});var FM=H((Kbo,Nyt)=>{"use strict";d();var{validateHeaderName:Pyt,validateHeaderValue:Dyt}=require("http"),{isPlainObject:xIr}=QE(),qE=Symbol("Headers internals"),lH=s(t=>{let e=typeof t!="string"?String(t):t;if(typeof Pyt=="function")Pyt(e);else if(!/^[\^`\-\w!#$%&'*+.|~]+$/.test(e)){let r=new TypeError(`Header name must be a valid HTTP token [${e}]`);throw Object.defineProperty(r,"code",{value:"ERR_INVALID_HTTP_TOKEN"}),r}return e.toLowerCase()},"normalizeName"),Byt=s((t,e)=>{let r=typeof t!="string"?String(t):t;if(typeof Dyt=="function")Dyt(e,r);else if(/[^\t\u0020-\u007E\u0080-\u00FF]/.test(r)){let n=new TypeError(`Invalid character in header content ["${e}"]`);throw Object.defineProperty(n,"code",{value:"ERR_INVALID_CHAR"}),n}return r},"normalizeValue"),Uce=class t{static{s(this,"Headers")}constructor(e={}){if(this[qE]={map:new Map},e instanceof t)e.forEach((r,n)=>{this.append(n,r)});else if(Array.isArray(e))e.forEach(([r,n])=>{this.append(r,n)});else if(xIr(e))for(let[r,n]of Object.entries(e))this.append(r,n)}set(e,r){this[qE].map.set(lH(e),Byt(r,e))}has(e){return this[qE].map.has(lH(e))}get(e){let r=this[qE].map.get(lH(e));return r===void 0?null:r}append(e,r){let n=lH(e),i=Byt(r,e),o=this[qE].map.get(n);this[qE].map.set(n,o?`${o}, ${i}`:i)}delete(e){this[qE].map.delete(lH(e))}forEach(e,r){for(let n of this.keys())e.call(r,this.get(n),n)}keys(){return Array.from(this[qE].map.keys()).sort()}*values(){for(let e of this.keys())yield this.get(e)}*entries(){for(let e of this.keys())yield[e,this.get(e)]}[Symbol.iterator](){return this.entries()}get[Symbol.toStringTag](){return this.constructor.name}plain(){return Object.fromEntries(this[qE].map)}};Object.defineProperties(Uce.prototype,["append","delete","entries","forEach","get","has","keys","set","values"].reduce((t,e)=>(t[e]={enumerable:!0},t),{}));Nyt.exports={Headers:Uce}});var mPe=H((Xbo,Myt)=>{"use strict";d();var{EventEmitter:EIr}=require("events"),by=Symbol("AbortSignal internals"),OM=class{static{s(this,"AbortSignal")}constructor(){this[by]={eventEmitter:new EIr,onabort:null,aborted:!1}}get aborted(){return this[by].aborted}get onabort(){return this[by].onabort}set onabort(e){this[by].onabort=e}get[Symbol.toStringTag](){return this.constructor.name}removeEventListener(e,r){this[by].eventEmitter.removeListener(e,r)}addEventListener(e,r){this[by].eventEmitter.on(e,r)}dispatchEvent(e){let r={type:e,target:this},n=`on${e}`;typeof this[by][n]=="function"&&this[n](r),this[by].eventEmitter.emit(e,r)}fire(){this[by].aborted=!0,this.dispatchEvent("abort")}};Object.defineProperties(OM.prototype,{addEventListener:{enumerable:!0},removeEventListener:{enumerable:!0},dispatchEvent:{enumerable:!0},aborted:{enumerable:!0},onabort:{enumerable:!0}});var Hce=class extends OM{static{s(this,"TimeoutSignal")}constructor(e){if(!Number.isInteger(e))throw new TypeError(`Expected an integer, got ${typeof e}`);super(),this[by].timerId=setTimeout(()=>{this.fire()},e)}clear(){clearTimeout(this[by].timerId)}};Object.defineProperties(Hce.prototype,{clear:{enumerable:!0}});var qce=Symbol("AbortController internals"),$ce=class{static{s(this,"AbortController")}constructor(){this[qce]={signal:new OM}}get signal(){return this[qce].signal}get[Symbol.toStringTag](){return this.constructor.name}abort(){this[qce].signal.aborted||this[qce].signal.fire()}};Object.defineProperties($ce.prototype,{signal:{enumerable:!0},abort:{enumerable:!0}});Myt.exports={AbortController:$ce,AbortSignal:OM,TimeoutSignal:Hce}});var uH=H((tIo,Oyt)=>{"use strict";d();var{randomBytes:bIr}=require("crypto"),{Readable:IIr}=require("stream"),gPe=s(t=>typeof t=="object"&&["arrayBuffer","stream","text","slice","constructor"].map(e=>typeof t[e]).filter(e=>e!=="function").length===0&&typeof t.type=="string"&&typeof t.size=="number"&&/^(Blob|File)$/.test(t[Symbol.toStringTag]),"isBlob"),TIr=s(t=>t!=null&&typeof t=="object"&&["append","delete","get","getAll","has","set","keys","values","entries","constructor"].map(e=>typeof t[e]).filter(e=>e!=="function").length===0&&t[Symbol.toStringTag]==="FormData","isFormData"),Lyt=s(t=>`--${t}--\r
\r
`,"getFooter"),Fyt=s((t,e,r)=>{let n="";return n+=`--${t}\r
`,n+=`Content-Disposition: form-data; name="${e}"`,gPe(r)&&(n+=`; filename="${r.name}"\r
`,n+=`Content-Type: ${r.type||"application/octet-stream"}`),`${n}\r
\r
`},"getHeader");async function*wIr(t,e){for(let[r,n]of t)yield Fyt(e,r,n),gPe(n)?yield*n.stream():yield n,yield`\r
`;yield Lyt(e)}s(wIr,"formDataIterator");var SIr=s((t,e)=>{let r=0;for(let[n,i]of t)r+=Buffer.byteLength(Fyt(e,n,i)),r+=gPe(i)?i.size:Buffer.byteLength(String(i)),r+=Buffer.byteLength(`\r
`);return r+=Buffer.byteLength(Lyt(e)),r},"getFormDataLength"),hPe=class{static{s(this,"FormDataSerializer")}constructor(e){this.fd=e,this.boundary=bIr(8).toString("hex")}length(){return typeof this._length>"u"&&(this._length=SIr(this.fd,this.boundary)),this._length}contentType(){return`multipart/form-data; boundary=${this.boundary}`}stream(){return IIr.from(wIr(this.fd,this.boundary))}};Oyt.exports={isFormData:TIr,FormDataSerializer:hPe}});var Uyt=H((oIo,Qyt)=>{"use strict";d();var{AbortSignal:iIo}=mPe(),{Body:_Ir,cloneStream:RIr,guessContentType:kIr}=Qce(),{Headers:PIr}=FM(),{isPlainObject:DIr}=QE(),{isFormData:BIr,FormDataSerializer:NIr}=uH(),MIr=20,RS=Symbol("Request internals"),Wce=class t extends _Ir{static{s(this,"Request")}constructor(e,r={}){let n=e instanceof t?e:null,i=n?new URL(n.url):new URL(e),o=r.method||n&&n.method||"GET";if(o=o.toUpperCase(),(r.body!=null||n&&n.body!==null)&&["GET","HEAD"].includes(o))throw new TypeError("Request with GET/HEAD method cannot have body");let a=r.body||(n&&n.body?RIr(n):null),c=new PIr(r.headers||n&&n.headers||{});if(BIr(a)&&!c.has("content-type")){let p=new NIr(a);a=p.stream(),c.set("content-type",p.contentType()),!c.has("transfer-encoding")&&!c.has("content-length")&&c.set("content-length",p.length())}if(!c.has("content-type"))if(DIr(a))a=JSON.stringify(a),c.set("content-type","application/json");else{let p=kIr(a);p&&c.set("content-type",p)}super(a);let l=n?n.signal:null;"signal"in r&&(l=r.signal);let u=r.redirect||n&&n.redirect||"follow";if(!["follow","error","manual"].includes(u))throw new TypeError(`'${u}' is not a valid redirect option`);let f=r.cache||n&&n.cache||"default";if(!["default","no-store","reload","no-cache","force-cache","only-if-cached"].includes(f))throw new TypeError(`'${f}' is not a valid cache option`);this[RS]={init:{...r},method:o,redirect:u,cache:f,headers:c,parsedURL:i,signal:l},r.follow===void 0?!n||n.follow===void 0?this.follow=MIr:this.follow=n.follow:this.follow=r.follow,this.counter=r.counter||n&&n.counter||0,r.compress===void 0?!n||n.compress===void 0?this.compress=!0:this.compress=n.compress:this.compress=r.compress,r.decode===void 0?!n||n.decode===void 0?this.decode=!0:this.decode=n.decode:this.decode=r.decode}get method(){return this[RS].method}get url(){return this[RS].parsedURL.toString()}get headers(){return this[RS].headers}get redirect(){return this[RS].redirect}get cache(){return this[RS].cache}get signal(){return this[RS].signal}clone(){return new t(this)}get init(){return this[RS].init}get[Symbol.toStringTag](){return this.constructor.name}};Object.defineProperties(Wce.prototype,{method:{enumerable:!0},url:{enumerable:!0},headers:{enumerable:!0},redirect:{enumerable:!0},cache:{enumerable:!0},clone:{enumerable:!0},signal:{enumerable:!0}});Qyt.exports={Request:Wce}});var APe=H((cIo,qyt)=>{"use strict";d();var{Body:LIr,cloneStream:FIr,guessContentType:OIr}=Qce(),{Headers:QIr}=FM(),{isPlainObject:UIr}=QE(),{isFormData:qIr,FormDataSerializer:HIr}=uH(),Iy=Symbol("Response internals"),jce=class t extends LIr{static{s(this,"Response")}constructor(e=null,r={}){let n=new QIr(r.headers),i=e;if(qIr(i)&&!n.has("content-type")){let o=new HIr(i);i=o.stream(),n.set("content-type",o.contentType()),!n.has("transfer-encoding")&&!n.has("content-length")&&n.set("content-length",o.length())}if(i!==null&&!n.has("content-type"))if(UIr(i))i=JSON.stringify(i),n.set("content-type","application/json");else{let o=OIr(i);o&&n.set("content-type",o)}super(i),this[Iy]={url:r.url,status:r.status||200,statusText:r.statusText||"",headers:n,httpVersion:r.httpVersion,decoded:r.decoded,counter:r.counter}}get url(){return this[Iy].url||""}get status(){return this[Iy].status}get statusText(){return this[Iy].statusText}get ok(){return this[Iy].status>=200&&this[Iy].status<300}get redirected(){return this[Iy].counter>0}get headers(){return this[Iy].headers}get httpVersion(){return this[Iy].httpVersion}get decoded(){return this[Iy].decoded}static redirect(e,r=302){if(![301,302,303,307,308].includes(r))throw new RangeError("Invalid status code");return new t(null,{headers:{location:new URL(e).toString()},status:r})}clone(){if(this.bodyUsed)throw new TypeError("Cannot clone: already read");return new t(FIr(this),{...this[Iy]})}get[Symbol.toStringTag](){return this.constructor.name}};Object.defineProperties(jce.prototype,{url:{enumerable:!0},status:{enumerable:!0},ok:{enumerable:!0},redirected:{enumerable:!0},statusText:{enumerable:!0},headers:{enumerable:!0},clone:{enumerable:!0}});qyt.exports={Response:jce}});var $yt=H((fIo,Hyt)=>{"use strict";d();var $Ir=new Set([200,203,204,206,300,301,308,404,405,410,414,501]),WIr=new Set([200,203,204,300,301,302,303,307,308,404,405,410,414,501]),jIr=new Set([500,502,503,504]),GIr={date:!0,connection:!0,"keep-alive":!0,"proxy-authenticate":!0,"proxy-authorization":!0,te:!0,trailer:!0,"transfer-encoding":!0,upgrade:!0},VIr={"content-length":!0,"content-encoding":!0,"transfer-encoding":!0,"content-range":!0};function MP(t){let e=parseInt(t,10);return isFinite(e)?e:0}s(MP,"toNumberOrZero");function zIr(t){return t?jIr.has(t.status):!0}s(zIr,"isErrorResponse");function yPe(t){let e={};if(!t)return e;let r=t.trim().split(/,/);for(let n of r){let[i,o]=n.split(/=/,2);e[i.trim()]=o===void 0?!0:o.trim().replace(/^"|"$/g,"")}return e}s(yPe,"parseCacheControl");function KIr(t){let e=[];for(let r in t){let n=t[r];e.push(n===!0?r:r+"="+n)}if(e.length)return e.join(", ")}s(KIr,"formatCacheControl");Hyt.exports=class{static{s(this,"CachePolicy")}constructor(e,r,{shared:n,cacheHeuristic:i,immutableMinTimeToLive:o,ignoreCargoCult:a,_fromObject:c}={}){if(c){this._fromObject(c);return}if(!r||!r.headers)throw Error("Response headers missing");this._assertRequestHasHeaders(e),this._responseTime=this.now(),this._isShared=n!==!1,this._cacheHeuristic=i!==void 0?i:.1,this._immutableMinTtl=o!==void 0?o:24*3600*1e3,this._status="status"in r?r.status:200,this._resHeaders=r.headers,this._rescc=yPe(r.headers["cache-control"]),this._method="method"in e?e.method:"GET",this._url=e.url,this._host=e.headers.host,this._noAuthorization=!e.headers.authorization,this._reqHeaders=r.headers.vary?e.headers:null,this._reqcc=yPe(e.headers["cache-control"]),a&&"pre-check"in this._rescc&&"post-check"in this._rescc&&(delete this._rescc["pre-check"],delete this._rescc["post-check"],delete this._rescc["no-cache"],delete this._rescc["no-store"],delete this._rescc["must-revalidate"],this._resHeaders=Object.assign({},this._resHeaders,{"cache-control":KIr(this._rescc)}),delete this._resHeaders.expires,delete this._resHeaders.pragma),r.headers["cache-control"]==null&&/no-cache/.test(r.headers.pragma)&&(this._rescc["no-cache"]=!0)}now(){return Date.now()}storable(){return!!(!this._reqcc["no-store"]&&(this._method==="GET"||this._method==="HEAD"||this._method==="POST"&&this._hasExplicitExpiration())&&WIr.has(this._status)&&!this._rescc["no-store"]&&(!this._isShared||!this._rescc.private)&&(!this._isShared||this._noAuthorization||this._allowsStoringAuthenticated())&&(this._resHeaders.expires||this._rescc["max-age"]||this._isShared&&this._rescc["s-maxage"]||this._rescc.public||$Ir.has(this._status)))}_hasExplicitExpiration(){return this._isShared&&this._rescc["s-maxage"]||this._rescc["max-age"]||this._resHeaders.expires}_assertRequestHasHeaders(e){if(!e||!e.headers)throw Error("Request headers missing")}satisfiesWithoutRevalidation(e){this._assertRequestHasHeaders(e);let r=yPe(e.headers["cache-control"]);return r["no-cache"]||/no-cache/.test(e.headers.pragma)||r["max-age"]&&this.age()>r["max-age"]||r["min-fresh"]&&this.timeToLive()<1e3*r["min-fresh"]||this.stale()&&!(r["max-stale"]&&!this._rescc["must-revalidate"]&&(r["max-stale"]===!0||r["max-stale"]>this.age()-this.maxAge()))?!1:this._requestMatches(e,!1)}_requestMatches(e,r){return(!this._url||this._url===e.url)&&this._host===e.headers.host&&(!e.method||this._method===e.method||r&&e.method==="HEAD")&&this._varyMatches(e)}_allowsStoringAuthenticated(){return this._rescc["must-revalidate"]||this._rescc.public||this._rescc["s-maxage"]}_varyMatches(e){if(!this._resHeaders.vary)return!0;if(this._resHeaders.vary==="*")return!1;let r=this._resHeaders.vary.trim().toLowerCase().split(/\s*,\s*/);for(let n of r)if(e.headers[n]!==this._reqHeaders[n])return!1;return!0}_copyWithoutHopByHopHeaders(e){let r={};for(let n in e)GIr[n]||(r[n]=e[n]);if(e.connection){let n=e.connection.trim().split(/\s*,\s*/);for(let i of n)delete r[i]}if(r.warning){let n=r.warning.split(/,/).filter(i=>!/^\s*1[0-9][0-9]/.test(i));n.length?r.warning=n.join(",").trim():delete r.warning}return r}responseHeaders(){let e=this._copyWithoutHopByHopHeaders(this._resHeaders),r=this.age();return r>3600*24&&!this._hasExplicitExpiration()&&this.maxAge()>3600*24&&(e.warning=(e.warning?`${e.warning}, `:"")+'113 - "rfc7234 5.5.4"'),e.age=`${Math.round(r)}`,e.date=new Date(this.now()).toUTCString(),e}date(){let e=Date.parse(this._resHeaders.date);return isFinite(e)?e:this._responseTime}age(){let e=this._ageValue(),r=(this.now()-this._responseTime)/1e3;return e+r}_ageValue(){return MP(this._resHeaders.age)}maxAge(){if(!this.storable()||this._rescc["no-cache"]||this._isShared&&this._resHeaders["set-cookie"]&&!this._rescc.public&&!this._rescc.immutable||this._resHeaders.vary==="*")return 0;if(this._isShared){if(this._rescc["proxy-revalidate"])return 0;if(this._rescc["s-maxage"])return MP(this._rescc["s-maxage"])}if(this._rescc["max-age"])return MP(this._rescc["max-age"]);let e=this._rescc.immutable?this._immutableMinTtl:0,r=this.date();if(this._resHeaders.expires){let n=Date.parse(this._resHeaders.expires);return Number.isNaN(n)||n<r?0:Math.max(e,(n-r)/1e3)}if(this._resHeaders["last-modified"]){let n=Date.parse(this._resHeaders["last-modified"]);if(isFinite(n)&&r>n)return Math.max(e,(r-n)/1e3*this._cacheHeuristic)}return e}timeToLive(){let e=this.maxAge()-this.age(),r=e+MP(this._rescc["stale-if-error"]),n=e+MP(this._rescc["stale-while-revalidate"]);return Math.max(0,e,r,n)*1e3}stale(){return this.maxAge()<=this.age()}_useStaleIfError(){return this.maxAge()+MP(this._rescc["stale-if-error"])>this.age()}useStaleWhileRevalidate(){return this.maxAge()+MP(this._rescc["stale-while-revalidate"])>this.age()}static fromObject(e){return new this(void 0,void 0,{_fromObject:e})}_fromObject(e){if(this._responseTime)throw Error("Reinitialized");if(!e||e.v!==1)throw Error("Invalid serialization");this._responseTime=e.t,this._isShared=e.sh,this._cacheHeuristic=e.ch,this._immutableMinTtl=e.imm!==void 0?e.imm:24*3600*1e3,this._status=e.st,this._resHeaders=e.resh,this._rescc=e.rescc,this._method=e.m,this._url=e.u,this._host=e.h,this._noAuthorization=e.a,this._reqHeaders=e.reqh,this._reqcc=e.reqcc}toObject(){return{v:1,t:this._responseTime,sh:this._isShared,ch:this._cacheHeuristic,imm:this._immutableMinTtl,st:this._status,resh:this._resHeaders,rescc:this._rescc,m:this._method,u:this._url,h:this._host,a:this._noAuthorization,reqh:this._reqHeaders,reqcc:this._reqcc}}revalidationHeaders(e){this._assertRequestHasHeaders(e);let r=this._copyWithoutHopByHopHeaders(e.headers);if(delete r["if-range"],!this._requestMatches(e,!0)||!this.storable())return delete r["if-none-match"],delete r["if-modified-since"],r;if(this._resHeaders.etag&&(r["if-none-match"]=r["if-none-match"]?`${r["if-none-match"]}, ${this._resHeaders.etag}`:this._resHeaders.etag),r["accept-ranges"]||r["if-match"]||r["if-unmodified-since"]||this._method&&this._method!="GET"){if(delete r["if-modified-since"],r["if-none-match"]){let i=r["if-none-match"].split(/,/).filter(o=>!/^\s*W\//.test(o));i.length?r["if-none-match"]=i.join(",").trim():delete r["if-none-match"]}}else this._resHeaders["last-modified"]&&!r["if-modified-since"]&&(r["if-modified-since"]=this._resHeaders["last-modified"]);return r}revalidatedPolicy(e,r){if(this._assertRequestHasHeaders(e),this._useStaleIfError()&&zIr(r))return{modified:!1,matches:!1,policy:this};if(!r||!r.headers)throw Error("Response headers missing");let n=!1;if(r.status!==void 0&&r.status!=304?n=!1:r.headers.etag&&!/^\s*W\//.test(r.headers.etag)?n=this._resHeaders.etag&&this._resHeaders.etag.replace(/^\s*W\//,"")===r.headers.etag:this._resHeaders.etag&&r.headers.etag?n=this._resHeaders.etag.replace(/^\s*W\//,"")===r.headers.etag.replace(/^\s*W\//,""):this._resHeaders["last-modified"]?n=this._resHeaders["last-modified"]===r.headers["last-modified"]:!this._resHeaders.etag&&!this._resHeaders["last-modified"]&&!r.headers.etag&&!r.headers["last-modified"]&&(n=!0),!n)return{policy:new this.constructor(e,r),modified:r.status!=304,matches:!1};let i={};for(let a in this._resHeaders)i[a]=a in r.headers&&!VIr[a]?r.headers[a]:this._resHeaders[a];let o=Object.assign({},r,{status:this._status,method:this._method,headers:i});return{policy:new this.constructor(e,o,{shared:this._isShared,cacheHeuristic:this._cacheHeuristic,immutableMinTimeToLive:this._immutableMinTtl}),modified:!1,matches:!0}}}});var Vyt=H((hIo,Gyt)=>{"use strict";d();var YIr=$yt(),{Headers:JIr}=FM(),Wyt=s(t=>({url:t.url,method:t.method,headers:t.headers.plain()}),"convertRequest"),jyt=s(t=>({status:t.status,headers:t.headers.plain()}),"convertResponse"),CPe=class{static{s(this,"CachePolicyWrapper")}constructor(e,r,n){this.policy=new YIr(Wyt(e),jyt(r),n)}storable(){return this.policy.storable()}satisfiesWithoutRevalidation(e){return this.policy.satisfiesWithoutRevalidation(Wyt(e))}responseHeaders(e){return new JIr(this.policy.responseHeaders(jyt(e)))}timeToLive(){return this.policy.timeToLive()}};Gyt.exports=CPe});var Yyt=H((yIo,Kyt)=>{"use strict";d();var{Readable:XIr}=require("stream"),{Headers:zyt}=FM(),{Response:ZIr}=APe(),kS=Symbol("CacheableResponse internals"),eTr=s(t=>t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength),"toArrayBuffer"),vPe=class t extends ZIr{static{s(this,"CacheableResponse")}constructor(e,r){super(e,r);let n=new zyt(r.headers);this[kS]={headers:n,bufferedBody:e}}get headers(){return this[kS].headers}set headers(e){if(e instanceof zyt)this[kS].headers=e;else throw new TypeError("instance of Headers expected")}get body(){return XIr.from(this[kS].bufferedBody)}get bodyUsed(){return!1}async buffer(){return this[kS].bufferedBody}async arrayBuffer(){return eTr(this[kS].bufferedBody)}async text(){return this[kS].bufferedBody.toString()}async json(){return JSON.parse(await this.text())}clone(){let{url:e,status:r,statusText:n,headers:i,httpVersion:o,decoded:a,counter:c}=this;return new t(this[kS].bufferedBody,{url:e,status:r,statusText:n,headers:i,httpVersion:o,decoded:a,counter:c})}get[Symbol.toStringTag](){return this.constructor.name}},tTr=s(async t=>{let e=await t.buffer(),{url:r,status:n,statusText:i,headers:o,httpVersion:a,decoded:c,counter:l}=t;return new vPe(e,{url:r,status:n,statusText:i,headers:o,httpVersion:a,decoded:c,counter:l})},"cacheableResponse");Kyt.exports={cacheableResponse:tTr}});var Gce=H((xIo,Jyt)=>{"use strict";d();var xPe=class extends Error{static{s(this,"RequestAbortedError")}get name(){return this.constructor.name}get[Symbol.toStringTag](){return this.constructor.name}};Jyt.exports={RequestAbortedError:xPe}});var rCt=H((IIo,tCt)=>{"use strict";d();var Zyt=require("http"),eCt=require("https"),{Readable:rTr}=require("stream"),HE=kC()("helix-fetch:h1"),{RequestAbortedError:Xyt}=Gce(),{decodeStream:nTr}=QE(),iTr=s((t,e)=>{let{h1:r,options:{h1:n,rejectUnauthorized:i}}=t;return e==="https:"?r.httpsAgent?r.httpsAgent:n||typeof i=="boolean"?(r.httpsAgent=new eCt.Agent(typeof i=="boolean"?{...n||{},rejectUnauthorized:i}:n),r.httpsAgent):void 0:r.httpAgent?r.httpAgent:n?(r.httpAgent=new Zyt.Agent(n),r.httpAgent):void 0},"getAgent"),oTr=s(t=>{t.h1={}},"setupContext"),sTr=s(async({h1:t})=>{t.httpAgent&&(HE("resetContext: destroying httpAgent"),t.httpAgent.destroy(),delete t.httpAgent),t.httpsAgent&&(HE("resetContext: destroying httpsAgent"),t.httpsAgent.destroy(),delete t.httpsAgent)},"resetContext"),aTr=s((t,e,r)=>{let{statusCode:n,statusMessage:i,httpVersion:o,httpVersionMajor:a,httpVersionMinor:c,headers:l}=t,u=e?nTr(n,l,t,r):t;return{statusCode:n,statusText:i,httpVersion:o,httpVersionMajor:a,httpVersionMinor:c,headers:l,readable:u,decoded:!!(e&&u!==t)}},"createResponse"),cTr=s(async(t,e,r)=>{let{request:n}=e.protocol==="https:"?eCt:Zyt,i=iTr(t,e.protocol),o={...r,agent:i},{socket:a,body:c}=o;return a&&(delete o.socket,a.assigned||(a.assigned=!0,i?o.agent=new Proxy(i,{get:s((l,u)=>u==="createConnection"&&!a.inUse?(f,p)=>{HE(`agent reusing socket #${a.id} (${a.servername})`),a.inUse=!0,p(null,a)}:l[u],"get")}):o.createConnection=(l,u)=>{HE(`reusing socket #${a.id} (${a.servername})`),a.inUse=!0,u(null,a)})),new Promise((l,u)=>{HE(`${o.method} ${e.href}`);let f,{signal:p}=o,m=s(()=>{p.removeEventListener("abort",m),a&&!a.inUse&&(HE(`discarding redundant socket used for ALPN: #${a.id} ${a.servername}`),a.destroy()),u(new Xyt),f&&f.abort()},"onAbortSignal");if(p){if(p.aborted){u(new Xyt);return}p.addEventListener("abort",m)}f=n(e,o),f.once("response",h=>{p&&p.removeEventListener("abort",m),a&&!a.inUse&&(HE(`discarding redundant socket used for ALPN: #${a.id} ${a.servername}`),a.destroy()),l(aTr(h,o.decode,u))}),f.once("error",h=>{p&&p.removeEventListener("abort",m),a&&!a.inUse&&(HE(`discarding redundant socket used for ALPN: #${a.id} ${a.servername}`),a.destroy()),f.aborted||(HE(`${o.method} ${e.href} failed with: ${h.message}`),f.abort(),u(h))}),c instanceof rTr?c.pipe(f):(c&&f.write(c),f.end())})},"h1Request");tCt.exports={request:cTr,setupContext:oTr,resetContext:sTr}});var sCt=H((SIo,oCt)=>{"use strict";d();var{connect:lTr,constants:uTr}=require("http2"),{Readable:dTr}=require("stream"),Ca=kC()("helix-fetch:h2"),{RequestAbortedError:nCt}=Gce(),{decodeStream:fTr}=QE(),{NGHTTP2_CANCEL:dH}=uTr,pTr=300*1e3,mTr=5e3,hTr=s(t=>{t.h2={sessionCache:{}}},"setupContext"),gTr=s(async({h2:t})=>Promise.all(Object.values(t.sessionCache).map(e=>new Promise(r=>{e.on("close",r),Ca(`resetContext: destroying session (socket #${e.socket&&e.socket.id}, ${e.socket&&e.socket.servername})`),e.destroy()}))),"resetContext"),iCt=s((t,e,r,n=()=>{})=>{let i={...t},o=i[":status"];delete i[":status"];let a=r?fTr(o,t,e,n):e;return{statusCode:o,statusText:"",httpVersion:"2.0",httpVersionMajor:2,httpVersionMinor:0,headers:i,readable:a,decoded:!!(r&&a!==e)}},"createResponse"),ATr=s((t,e,r,n,i,o)=>{let{options:{h2:{pushPromiseHandler:a,pushHandler:c,pushedStreamIdleTimeout:l=mTr}}}=t,u=i[":path"],f=`${e}${u}`;Ca(`received PUSH_PROMISE: ${f}, stream #${n.id}, headers: ${JSON.stringify(i)}, flags: ${o}`),a&&a(f,i,s(()=>{n.close(dH)},"rejectPush")),n.on("push",(p,m)=>{Ca(`received push headers for ${e}${u}, stream #${n.id}, headers: ${JSON.stringify(p)}, flags: ${m}`),n.setTimeout(l,()=>{Ca(`closing pushed stream #${n.id} after ${l} ms of inactivity`),n.close(dH)}),c&&c(f,i,iCt(p,n,r))}),n.on("aborted",()=>{Ca(`pushed stream #${n.id} aborted`)}),n.on("error",p=>{Ca(`pushed stream #${n.id} encountered error: ${p}`)}),n.on("frameError",(p,m,h)=>{Ca(`pushed stream #${n.id} encountered frameError: type: ${p}, code: ${m}, id: ${h}`)})},"handlePush"),yTr=s(async(t,e,r)=>{let{origin:n,pathname:i,search:o,hash:a}=e,c=`${i}${o}${a}`,{options:{h2:l={}},h2:{sessionCache:u}}=t,{idleSessionTimeout:f=pTr,pushPromiseHandler:p,pushHandler:m}=l,h={...r},{method:g,headers:A,socket:y,body:E,decode:b}=h;return y&&delete h.socket,A.host&&(A[":authority"]=A.host,delete A.host),new Promise((S,R)=>{let B=u[n];if(!B||B.closed||B.destroyed){let z=!(t.options.rejectUnauthorized===!1||l.rejectUnauthorized===!1),Q={...l,rejectUnauthorized:z};y&&!y.inUse&&(Q.createConnection=()=>(Ca(`reusing socket #${y.id} (${y.servername})`),y.inUse=!0,y)),B=lTr(n,{...Q,settings:{enablePush:!!(p||m)}}),B.setMaxListeners(1e3),B.setTimeout(f,()=>{Ca(`closing session ${n} after ${f} ms of inactivity`),B.close()}),B.once("connect",()=>{Ca(`session ${n} established`),Ca(`caching session ${n}`),u[n]=B}),B.on("localSettings",Z=>{Ca(`session ${n} localSettings: ${JSON.stringify(Z)}`)}),B.on("remoteSettings",Z=>{Ca(`session ${n} remoteSettings: ${JSON.stringify(Z)}`)}),B.once("close",()=>{Ca(`session ${n} closed`),u[n]===B&&(Ca(`discarding cached session ${n}`),delete u[n])}),B.once("error",Z=>{Ca(`session ${n} encountered error: ${Z}`),u[n]===B&&(Ca(`discarding cached session ${n}`),delete u[n])}),B.on("frameError",(Z,J,j)=>{Ca(`session ${n} encountered frameError: type: ${Z}, code: ${J}, id: ${j}`)}),B.once("goaway",(Z,J,j)=>{Ca(`session ${n} received GOAWAY frame: errorCode: ${Z}, lastStreamID: ${J}, opaqueData: ${j?j.toString():void 0}`)}),B.on("stream",(Z,J,j)=>{ATr(t,n,b,Z,J,j)})}else y&&y.id!==B.socket.id&&!y.inUse&&(Ca(`discarding redundant socket used for ALPN: #${y.id} ${y.servername}`),y.destroy());Ca(`${g} ${e.host}${c}`);let L,{signal:O}=h,Y=s(()=>{O.removeEventListener("abort",Y),R(new nCt),L&&L.close(dH)},"onAbortSignal");if(O){if(O.aborted){R(new nCt);return}O.addEventListener("abort",Y)}let V=s(z=>{Ca(`session ${n} encountered error during ${h.method} ${e.href}: ${z}`),R(z)},"onSessionError");B.once("error",V),L=B.request({":method":g,":path":c,...A}),L.once("response",z=>{B.off("error",V),O&&O.removeEventListener("abort",Y),S(iCt(z,L,h.decode,R))}),L.once("error",z=>{B.off("error",V),O&&O.removeEventListener("abort",Y),L.rstCode!==dH&&(Ca(`${h.method} ${e.href} failed with: ${z.message}`),L.close(dH),R(z))}),L.once("frameError",(z,Q,U)=>{B.off("error",V),Ca(`encountered frameError during ${h.method} ${e.href}: type: ${z}, code: ${Q}, id: ${U}`)}),L.on("push",(z,Q)=>{Ca(`received 'push' event: headers: ${JSON.stringify(z)}, flags: ${Q}`)}),E instanceof dTr?E.pipe(L):(E&&L.write(E),L.end())})},"request");oCt.exports={request:yTr,setupContext:hTr,resetContext:gTr}});var cCt=H((kIo,aCt)=>{"use strict";d();var{EventEmitter:CTr}=require("events"),vTr=s(()=>{let t={},e=new CTr;return e.setMaxListeners(0),{acquire:s(r=>new Promise(n=>{if(!t[r]){t[r]=!0,n();return}let i=s(o=>{t[r]||(t[r]=!0,e.removeListener(r,i),n(o))},"tryAcquire");e.on(r,i)}),"acquire"),release:s((r,n)=>{Reflect.deleteProperty(t,r),setImmediate(()=>e.emit(r,n))},"release")}},"lock");aCt.exports=vTr});var lCt=H((BIo,xTr)=>{xTr.exports={name:"@adobe/helix-fetch",version:"3.1.1",description:"Light-weight Fetch implementation transparently supporting both HTTP/1(.1) and HTTP/2",main:"src/index.js",scripts:{test:"nyc mocha",lint:"./node_modules/.bin/eslint .","semantic-release":"semantic-release"},mocha:{timeout:"5000",recursive:"true",reporter:"mocha-multi-reporters","reporter-options":"configFile=.mocha-multi.json"},engines:{node:">=12.0"},types:"src/index.d.ts",exports:{import:"./src/index.mjs",require:"./src/index.js"},repository:{type:"git",url:"https://github.com/adobe/helix-fetch"},author:"",license:"Apache-2.0",bugs:{url:"https://github.com/adobe/helix-fetch/issues"},homepage:"https://github.com/adobe/helix-fetch#readme",keywords:["fetch","whatwg","Fetch API","http","https","http2","h2","promise","async","request","RFC 7234","7234","caching","cache"],dependencies:{debug:"4.3.4","http-cache-semantics":"^4.1.1","lru-cache":"7.13.1"},devDependencies:{"@adobe/eslint-config-helix":"1.3.2","@semantic-release/changelog":"6.0.1","@semantic-release/git":"10.0.1",chai:"4.3.6","chai-as-promised":"7.1.1","chai-bytes":"0.1.2","chai-iterator":"3.0.2",eslint:"8.21.0","eslint-plugin-header":"3.1.1","eslint-plugin-import":"2.26.0","formdata-node":"4.3.3","lint-staged":"13.0.3",mocha:"10.0.0","mocha-multi-reporters":"1.5.1",nock:"13.2.9",nyc:"15.1.0","parse-cache-control":"1.0.1",pem:"1.14.6",proxy:"^1.0.2","semantic-release":"19.0.3",sinon:"14.0.0","stream-buffers":"3.0.2",tunnel:"^0.0.6"},"lint-staged":{"*.js":"eslint"},config:{commitizen:{path:"node_modules/cz-conventional-changelog"},ghooks:{"pre-commit":"npx lint-staged"}}}});var mCt=H((NIo,pCt)=>{"use strict";d();var{Readable:ETr}=require("stream"),bTr=require("tls"),{types:{isAnyArrayBuffer:ITr}}=require("util"),TTr=uPe(),EPe=kC()("helix-fetch:core"),{RequestAbortedError:Vce}=Gce(),bPe=rCt(),zce=sCt(),wTr=cCt(),{isPlainObject:STr}=QE(),{isFormData:_Tr,FormDataSerializer:RTr}=uH(),{version:kTr}=lCt(),IPe="h2",TPe="h2c",wPe="http/1.0",LP="http/1.1",PTr=100,DTr=3600*1e3,BTr=[IPe,LP,wPe],NTr=`helix-fetch/${kTr}`,MTr={method:"GET",compress:!0,decode:!0},uCt=0,dCt=wTr(),fCt=s((t,e)=>new Promise((r,n)=>{let{signal:i}=e,o,a=s(()=>{i.removeEventListener("abort",a);let u=new Vce;n(u),o&&o.destroy(u)},"onAbortSignal");if(i){if(i.aborted){n(new Vce);return}i.addEventListener("abort",a)}let c=+t.port||443,l=s(u=>{i&&i.removeEventListener("abort",a),u instanceof Vce||(EPe(`connecting to ${t.hostname}:${c} failed with: ${u.message}`),n(u))},"onError");o=bTr.connect(c,t.hostname,e),o.once("secureConnect",()=>{i&&i.removeEventListener("abort",a),o.off("error",l),uCt+=1,o.id=uCt,o.secureConnecting=!1,EPe(`established TLS connection: #${o.id} (${o.servername})`),r(o)}),o.once("error",l)}),"connectTLS"),LTr=s(async(t,e)=>{let r=await dCt.acquire(t.origin);try{return r||(r=await fCt(t,e)),r}finally{dCt.release(t.origin,r)}},"connect"),FTr=s(async(t,e,r)=>{let n=`${e.protocol}//${e.host}`,i=t.alpnCache.get(n);if(i)return{protocol:i};switch(e.protocol){case"http:":return i=LP,t.alpnCache.set(n,i),{protocol:i};case"http2:":return i=TPe,t.alpnCache.set(n,i),{protocol:i};case"https:":break;default:throw new TypeError(`unsupported protocol: ${e.protocol}`)}let{options:{rejectUnauthorized:o,h1:a={},h2:c={}}}=t,l=!(o===!1||a.rejectUnauthorized===!1||c.rejectUnauthorized===!1),u={servername:e.hostname,ALPNProtocols:t.alpnProtocols,signal:r,rejectUnauthorized:l};t.options.ca&&(u.ca=t.options.ca);let f=await LTr(e,u);return i=f.alpnProtocol,i||(i=LP),t.alpnCache.set(n,i),{protocol:i,socket:f}},"determineProtocol"),OTr=s(t=>{let e={};return Object.keys(t).forEach(r=>{e[r.toLowerCase()]=t[r]}),e},"sanitizeHeaders"),QTr=s(async(t,e,r,n)=>{let i=e.protocol==="https:",o;e.port?o=e.port:i?o=443:o=80;let a={...r,host:e.host,hostname:e.hostname,port:o},c=await t(a);if(i){let u={...a,ALPNProtocols:n};u.socket=c,u.servername=a.host;let f=await fCt(e,u);return{protocol:f.alpnProtocol||LP,socket:f}}return{protocol:c.alpnProtocol||LP,socket:c}},"getProtocolAndSocketFromFactory"),UTr=s(async(t,e,r)=>{let n=new URL(e),i={...MTr,...r||{}};typeof i.method=="string"&&(i.method=i.method.toUpperCase()),i.headers=OTr(i.headers||{}),i.headers.host===void 0&&(i.headers.host=n.host),t.userAgent&&i.headers["user-agent"]===void 0&&(i.headers["user-agent"]=t.userAgent);let o;if(i.body instanceof URLSearchParams)o="application/x-www-form-urlencoded; charset=utf-8",i.body=i.body.toString();else if(_Tr(i.body)){let u=new RTr(i.body);o=u.contentType(),i.body=u.stream(),i.headers["transfer-encoding"]===void 0&&i.headers["content-length"]===void 0&&(i.headers["content-length"]=String(u.length()))}else typeof i.body=="string"||i.body instanceof String?o="text/plain; charset=utf-8":STr(i.body)?(i.body=JSON.stringify(i.body),o="application/json"):ITr(i.body)&&(i.body=Buffer.from(i.body));i.headers["content-type"]===void 0&&o!==void 0&&(i.headers["content-type"]=o),i.body!=null&&(i.body instanceof ETr||(!(typeof i.body=="string"||i.body instanceof String)&&!Buffer.isBuffer(i.body)&&(i.body=String(i.body)),i.headers["transfer-encoding"]===void 0&&i.headers["content-length"]===void 0&&(i.headers["content-length"]=String(Buffer.isBuffer(i.body)?i.body.length:Buffer.byteLength(i.body,"utf-8"))))),i.headers.accept===void 0&&(i.headers.accept="*/*"),i.body==null&&["POST","PUT"].includes(i.method)&&(i.headers["content-length"]="0"),i.compress&&i.headers["accept-encoding"]===void 0&&(i.headers["accept-encoding"]="gzip,deflate,br");let{signal:a}=i,{protocol:c,socket:l=null}=t.socketFactory?await QTr(t.socketFactory,n,i,t.alpnProtocols):await FTr(t,n,a);switch(EPe(`${n.host} -> ${c}`),c){case IPe:try{return await zce.request(t,n,l?{...i,socket:l}:i)}catch(u){let{code:f,message:p}=u;throw f==="ERR_HTTP2_ERROR"&&p==="Protocol error"&&t.alpnCache.delete(`${n.protocol}//${n.host}`),u}case TPe:return zce.request(t,new URL(`http://${n.host}${n.pathname}${n.hash}${n.search}`),l?{...i,socket:l}:i);case wPe:case LP:return bPe.request(t,n,l?{...i,socket:l}:i);default:throw new TypeError(`unsupported protocol: ${c}`)}},"request"),qTr=s(async t=>(t.alpnCache.clear(),Promise.all([bPe.resetContext(t),zce.resetContext(t)])),"resetContext"),HTr=s(t=>{let{options:{alpnProtocols:e=BTr,alpnCacheTTL:r=DTr,alpnCacheSize:n=PTr,userAgent:i=NTr,socketFactory:o}}=t;t.alpnProtocols=e,t.alpnCache=new TTr({max:n,ttl:r}),t.userAgent=i,t.socketFactory=o,bPe.setupContext(t),zce.setupContext(t)},"setupContext");pCt.exports={request:UTr,setupContext:HTr,resetContext:qTr,RequestAbortedError:Vce,ALPN_HTTP2:IPe,ALPN_HTTP2C:TPe,ALPN_HTTP1_1:LP,ALPN_HTTP1_0:wPe}});var gCt=H((FIo,hCt)=>{"use strict";d();var $Tr=kC()("helix-fetch:core"),{request:WTr,setupContext:jTr,resetContext:GTr,RequestAbortedError:VTr,ALPN_HTTP2:zTr,ALPN_HTTP2C:KTr,ALPN_HTTP1_1:YTr,ALPN_HTTP1_0:JTr}=mCt(),SPe=class t{static{s(this,"RequestContext")}constructor(e){this.options={...e||{}},jTr(this)}api(){return{request:s(async(e,r)=>this.request(e,r),"request"),context:s((e={})=>new t(e).api(),"context"),setCA:s(e=>this.setCA(e),"setCA"),reset:s(async()=>this.reset(),"reset"),RequestAbortedError:VTr,ALPN_HTTP2:zTr,ALPN_HTTP2C:KTr,ALPN_HTTP1_1:YTr,ALPN_HTTP1_0:JTr}}async request(e,r){return WTr(this,e,r)}setCA(e){this.options.ca=e}async reset(){return $Tr("resetting context"),GTr(this)}};hCt.exports=new SPe().api()});var xCt=H((UIo,vCt)=>{"use strict";d();var{EventEmitter:XTr}=require("events"),{Readable:fH}=require("stream"),_Pe=kC()("helix-fetch"),ZTr=uPe(),{Body:ewr}=Qce(),{Headers:DPe}=FM(),{Request:FP}=Uyt(),{Response:kPe}=APe(),{FetchBaseError:twr,FetchError:pH,AbortError:Kce}=pPe(),{AbortController:rwr,AbortSignal:nwr,TimeoutSignal:iwr}=mPe(),owr=Vyt(),{cacheableResponse:swr}=Yyt(),{sizeof:awr}=QE(),{isFormData:cwr}=uH(),{context:lwr,RequestAbortedError:uwr}=gCt(),ACt=["GET","HEAD"],dwr=500,fwr=100*1024*1024,RPe="push",yCt=s(async(t,e,r)=>{let{request:n}=t.context,i=e instanceof FP&&typeof r>"u"?e:new FP(e,r),{method:o,body:a,signal:c,compress:l,decode:u,follow:f,redirect:p,init:{body:m}}=i,h;if(c&&c.aborted){let B=new Kce("The operation was aborted.");throw i.init.body instanceof fH&&i.init.body.destroy(B),B}try{h=await n(i.url,{...r,method:o,headers:i.headers.plain(),body:m&&!(m instanceof fH)&&!cwr(m)?m:a,compress:l,decode:u,follow:f,redirect:p,signal:c})}catch(B){throw m instanceof fH&&m.destroy(B),B instanceof TypeError?B:B instanceof uwr?new Kce("The operation was aborted."):new pH(B.message,"system",B)}let g=s(()=>{c.removeEventListener("abort",g);let B=new Kce("The operation was aborted.");i.init.body instanceof fH&&i.init.body.destroy(B),h.readable.emit("error",B)},"abortHandler");c&&c.addEventListener("abort",g);let{statusCode:A,statusText:y,httpVersion:E,headers:b,readable:S,decoded:R}=h;if([301,302,303,307,308].includes(A)){let{location:B}=b,L=B==null?null:new URL(B,i.url);switch(i.redirect){case"manual":break;case"error":throw c&&c.removeEventListener("abort",g),new pH(`uri requested responds with a redirect, redirect mode is set to 'error': ${i.url}`,"no-redirect");case"follow":{if(L===null)break;if(i.counter>=i.follow)throw c&&c.removeEventListener("abort",g),new pH(`maximum redirect reached at: ${i.url}`,"max-redirect");let O={headers:new DPe(i.headers),follow:i.follow,compress:i.compress,decode:i.decode,counter:i.counter+1,method:i.method,body:i.body,signal:i.signal};if(A!==303&&i.body&&i.init.body instanceof fH)throw c&&c.removeEventListener("abort",g),new pH("Cannot follow redirect with body being a readable stream","unsupported-redirect");return(A===303||(A===301||A===302)&&i.method==="POST")&&(O.method="GET",O.body=void 0,O.headers.delete("content-length")),c&&c.removeEventListener("abort",g),yCt(t,new FP(L,O))}default:}}return c&&(S.once("end",()=>{c.removeEventListener("abort",g)}),S.once("error",()=>{c.removeEventListener("abort",g)})),new kPe(S,{url:i.url,status:A,statusText:y,headers:b,httpVersion:E,decoded:R,counter:i.counter})},"fetch"),CCt=s(async(t,e,r)=>{if(t.options.maxCacheSize===0||!ACt.includes(e.method))return r;let n=new owr(e,r,{shared:!1});if(n.storable()){let i=await swr(r);return t.cache.set(e.url,{policy:n,response:i},n.timeToLive()),i}else return r},"cacheResponse"),pwr=s(async(t,e,r)=>{let n=new FP(e,r);if(t.options.maxCacheSize!==0&&ACt.includes(n.method)&&!["no-store","reload"].includes(n.cache)){let{policy:a,response:c}=t.cache.get(n.url)||{};if(a&&a.satisfiesWithoutRevalidation(n)){c.headers=new DPe(a.responseHeaders(c));let l=c.clone();return l.fromCache=!0,l}}let o=await yCt(t,n);return n.cache!=="no-store"?CCt(t,n,o):o},"cachingFetch"),mwr=s((t,e={})=>{let r=new URL(t);if(typeof e!="object"||Array.isArray(e))throw new TypeError("qs: object expected");return Object.entries(e).forEach(([n,i])=>{Array.isArray(i)?i.forEach(o=>r.searchParams.append(n,o)):r.searchParams.append(n,i)}),r.href},"createUrl"),hwr=s(t=>new iwr(t),"timeoutSignal"),PPe=class t{static{s(this,"FetchContext")}constructor(e){this.options={...e};let{maxCacheSize:r}=this.options,n=typeof r=="number"&&r>=0?r:fwr,i=dwr;n===0&&(n=1,i=1);let o=s(({response:c},l)=>awr(c),"sizeCalculation");this.cache=new ZTr({max:i,maxSize:n,sizeCalculation:o}),this.eventEmitter=new XTr,this.options.h2=this.options.h2||{},typeof this.options.h2.enablePush>"u"&&(this.options.h2.enablePush=!0);let{enablePush:a}=this.options.h2;a&&(this.options.h2.pushPromiseHandler=(c,l,u)=>{let f={...l};Object.keys(f).filter(p=>p.startsWith(":")).forEach(p=>delete f[p]),this.pushPromiseHandler(c,f,u)},this.options.h2.pushHandler=(c,l,u)=>{let f={...l};Object.keys(f).filter(E=>E.startsWith(":")).forEach(E=>delete f[E]);let{statusCode:p,statusText:m,httpVersion:h,headers:g,readable:A,decoded:y}=u;this.pushHandler(c,f,new kPe(A,{url:c,status:p,statusText:m,headers:g,httpVersion:h,decoded:y}))}),this.context=lwr(this.options)}api(){return{fetch:s(async(e,r)=>this.fetch(e,r),"fetch"),Body:ewr,Headers:DPe,Request:FP,Response:kPe,AbortController:rwr,AbortSignal:nwr,FetchBaseError:twr,FetchError:pH,AbortError:Kce,context:s((e={})=>new t(e).api(),"context"),setCA:s(e=>this.setCA(e),"setCA"),noCache:s((e={})=>new t({...e,maxCacheSize:0}).api(),"noCache"),h1:s((e={})=>new t({...e,alpnProtocols:[this.context.ALPN_HTTP1_1]}).api(),"h1"),keepAlive:s((e={})=>new t({...e,alpnProtocols:[this.context.ALPN_HTTP1_1],h1:{keepAlive:!0}}).api(),"keepAlive"),h1NoCache:s((e={})=>new t({...e,maxCacheSize:0,alpnProtocols:[this.context.ALPN_HTTP1_1]}).api(),"h1NoCache"),keepAliveNoCache:s((e={})=>new t({...e,maxCacheSize:0,alpnProtocols:[this.context.ALPN_HTTP1_1],h1:{keepAlive:!0}}).api(),"keepAliveNoCache"),reset:s(async()=>this.context.reset(),"reset"),onPush:s(e=>this.onPush(e),"onPush"),offPush:s(e=>this.offPush(e),"offPush"),createUrl:mwr,timeoutSignal:hwr,clearCache:s(()=>this.clearCache(),"clearCache"),cacheStats:s(()=>this.cacheStats(),"cacheStats"),ALPN_HTTP2:this.context.ALPN_HTTP2,ALPN_HTTP2C:this.context.ALPN_HTTP2C,ALPN_HTTP1_1:this.context.ALPN_HTTP1_1,ALPN_HTTP1_0:this.context.ALPN_HTTP1_0}}async fetch(e,r){return pwr(this,e,r)}setCA(e){this.options.ca=e,this.context.setCA(e)}onPush(e){return this.eventEmitter.on(RPe,e)}offPush(e){return this.eventEmitter.off(RPe,e)}clearCache(){this.cache.clear()}cacheStats(){return{size:this.cache.calculatedSize,count:this.cache.size}}pushPromiseHandler(e,r,n){_Pe(`received server push promise: ${e}, headers: ${JSON.stringify(r)}`);let i=new FP(e,{headers:r}),{policy:o}=this.cache.get(e)||{};o&&o.satisfiesWithoutRevalidation(i)&&(_Pe(`already cached, reject push promise: ${e}, headers: ${JSON.stringify(r)}`),n())}async pushHandler(e,r,n){_Pe(`caching resource pushed by server: ${e}, reqHeaders: ${JSON.stringify(r)}, status: ${n.status}, respHeaders: ${JSON.stringify(n.headers)}`);let i=await CCt(this,new FP(e,{headers:r}),n);this.eventEmitter.emit(RPe,e,i)}};vCt.exports=new PPe().api()});var bCt=H(($Io,ECt)=>{"use strict";d();ECt.exports=xCt()});var Dvt=H((Xle,Pvt)=>{d();(function(t,e){typeof Xle=="object"&&typeof Pvt<"u"?e(Xle):typeof define=="function"&&define.amd?define(["exports"],e):e(t.URI=t.URI||{})})(Xle,function(t){"use strict";function e(){for(var F=arguments.length,D=Array(F),ee=0;ee<F;ee++)D[ee]=arguments[ee];if(D.length>1){D[0]=D[0].slice(0,-1);for(var ge=D.length-1,_e=1;_e<ge;++_e)D[_e]=D[_e].slice(1,-1);return D[ge]=D[ge].slice(1),D.join("")}else return D[0]}s(e,"merge");function r(F){return"(?:"+F+")"}s(r,"subexp");function n(F){return F===void 0?"undefined":F===null?"null":Object.prototype.toString.call(F).split(" ").pop().split("]").shift().toLowerCase()}s(n,"typeOf");function i(F){return F.toUpperCase()}s(i,"toUpperCase");function o(F){return F!=null?F instanceof Array?F:typeof F.length!="number"||F.split||F.setInterval||F.call?[F]:Array.prototype.slice.call(F):[]}s(o,"toArray");function a(F,D){var ee=F;if(D)for(var ge in D)ee[ge]=D[ge];return ee}s(a,"assign");function c(F){var D="[A-Za-z]",ee="[\\x0D]",ge="[0-9]",_e="[\\x22]",ut=e(ge,"[A-Fa-f]"),St="[\\x0A]",Kt="[\\x20]",er=r(r("%[EFef]"+ut+"%"+ut+ut+"%"+ut+ut)+"|"+r("%[89A-Fa-f]"+ut+"%"+ut+ut)+"|"+r("%"+ut+ut)),Yt="[\\:\\/\\?\\#\\[\\]\\@]",bt="[\\!\\$\\&\\'\\(\\)\\*\\+\\,\\;\\=]",vr=e(Yt,bt),di=F?"[\\xA0-\\u200D\\u2010-\\u2029\\u202F-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]":"[]",no=F?"[\\uE000-\\uF8FF]":"[]",Tn=e(D,ge,"[\\-\\.\\_\\~]",di),yo=r(D+e(D,ge,"[\\+\\-\\.]")+"*"),xi=r(r(er+"|"+e(Tn,bt,"[\\:]"))+"*"),Zo=r(r("25[0-5]")+"|"+r("2[0-4]"+ge)+"|"+r("1"+ge+ge)+"|"+r("[1-9]"+ge)+"|"+ge),va=r(r("25[0-5]")+"|"+r("2[0-4]"+ge)+"|"+r("1"+ge+ge)+"|"+r("0?[1-9]"+ge)+"|0?0?"+ge),Ic=r(va+"\\."+va+"\\."+va+"\\."+va),Mo=r(ut+"{1,4}"),Vs=r(r(Mo+"\\:"+Mo)+"|"+Ic),gd=r(r(Mo+"\\:")+"{6}"+Vs),Tc=r("\\:\\:"+r(Mo+"\\:")+"{5}"+Vs),Tg=r(r(Mo)+"?\\:\\:"+r(Mo+"\\:")+"{4}"+Vs),Tl=r(r(r(Mo+"\\:")+"{0,1}"+Mo)+"?\\:\\:"+r(Mo+"\\:")+"{3}"+Vs),wg=r(r(r(Mo+"\\:")+"{0,2}"+Mo)+"?\\:\\:"+r(Mo+"\\:")+"{2}"+Vs),Sg=r(r(r(Mo+"\\:")+"{0,3}"+Mo)+"?\\:\\:"+Mo+"\\:"+Vs),YE=r(r(r(Mo+"\\:")+"{0,4}"+Mo)+"?\\:\\:"+Vs),qa=r(r(r(Mo+"\\:")+"{0,5}"+Mo)+"?\\:\\:"+Mo),ku=r(r(r(Mo+"\\:")+"{0,6}"+Mo)+"?\\:\\:"),Pu=r([gd,Tc,Tg,Tl,wg,Sg,YE,qa,ku].join("|")),Ad=r(r(Tn+"|"+er)+"+"),_g=r(Pu+"\\%25"+Ad),jl=r(Pu+r("\\%25|\\%(?!"+ut+"{2})")+Ad),JE=r("[vV]"+ut+"+\\."+e(Tn,bt,"[\\:]")+"+"),ov=r("\\["+r(jl+"|"+Pu+"|"+JE)+"\\]"),XE=r(r(er+"|"+e(Tn,bt))+"*"),jf=r(ov+"|"+Ic+"(?!"+XE+")|"+XE),Gf=r(ge+"*"),Yr=r(r(xi+"@")+"?"+jf+r("\\:"+Gf)+"?"),wc=r(er+"|"+e(Tn,bt,"[\\:\\@]")),Rg=r(wc+"*"),kg=r(wc+"+"),lL=r(r(er+"|"+e(Tn,bt,"[\\@]"))+"+"),Gc=r(r("\\/"+Rg)+"*"),Sy=r("\\/"+r(kg+Gc)+"?"),sv=r(lL+Gc),Em=r(kg+Gc),_y="(?!"+wc+")",ZE=r(Gc+"|"+Sy+"|"+sv+"|"+Em+"|"+_y),Is=r(r(wc+"|"+e("[\\/\\?]",no))+"*"),yd=r(r(wc+"|[\\/\\?]")+"*"),Ry=r(r("\\/\\/"+Yr+Gc)+"|"+Sy+"|"+Em+"|"+_y),f5=r(yo+"\\:"+Ry+r("\\?"+Is)+"?"+r("\\#"+yd)+"?"),uL=r(r("\\/\\/"+Yr+Gc)+"|"+Sy+"|"+sv+"|"+_y),io=r(uL+r("\\?"+Is)+"?"+r("\\#"+yd)+"?"),ky=r(f5+"|"+io),Pg=r(yo+"\\:"+Ry+r("\\?"+Is)+"?"),p5="^("+yo+")\\:"+r(r("\\/\\/("+r("("+xi+")@")+"?("+jf+")"+r("\\:("+Gf+")")+"?)")+"?("+Gc+"|"+Sy+"|"+Em+"|"+_y+")")+r("\\?("+Is+")")+"?"+r("\\#("+yd+")")+"?$",eb="^(){0}"+r(r("\\/\\/("+r("("+xi+")@")+"?("+jf+")"+r("\\:("+Gf+")")+"?)")+"?("+Gc+"|"+Sy+"|"+sv+"|"+_y+")")+r("\\?("+Is+")")+"?"+r("\\#("+yd+")")+"?$",Cd="^("+yo+")\\:"+r(r("\\/\\/("+r("("+xi+")@")+"?("+jf+")"+r("\\:("+Gf+")")+"?)")+"?("+Gc+"|"+Sy+"|"+Em+"|"+_y+")")+r("\\?("+Is+")")+"?$",dL="^"+r("\\#("+yd+")")+"?$",fL="^"+r("("+xi+")@")+"?("+jf+")"+r("\\:("+Gf+")")+"?$";return{NOT_SCHEME:new RegExp(e("[^]",D,ge,"[\\+\\-\\.]"),"g"),NOT_USERINFO:new RegExp(e("[^\\%\\:]",Tn,bt),"g"),NOT_HOST:new RegExp(e("[^\\%\\[\\]\\:]",Tn,bt),"g"),NOT_PATH:new RegExp(e("[^\\%\\/\\:\\@]",Tn,bt),"g"),NOT_PATH_NOSCHEME:new RegExp(e("[^\\%\\/\\@]",Tn,bt),"g"),NOT_QUERY:new RegExp(e("[^\\%]",Tn,bt,"[\\:\\@\\/\\?]",no),"g"),NOT_FRAGMENT:new RegExp(e("[^\\%]",Tn,bt,"[\\:\\@\\/\\?]"),"g"),ESCAPE:new RegExp(e("[^]",Tn,bt),"g"),UNRESERVED:new RegExp(Tn,"g"),OTHER_CHARS:new RegExp(e("[^\\%]",Tn,vr),"g"),PCT_ENCODED:new RegExp(er,"g"),IPV4ADDRESS:new RegExp("^("+Ic+")$"),IPV6ADDRESS:new RegExp("^\\[?("+Pu+")"+r(r("\\%25|\\%(?!"+ut+"{2})")+"("+Ad+")")+"?\\]?$")}}s(c,"buildExps");var l=c(!1),u=c(!0),f=function(){function F(D,ee){var ge=[],_e=!0,ut=!1,St=void 0;try{for(var Kt=D[Symbol.iterator](),er;!(_e=(er=Kt.next()).done)&&(ge.push(er.value),!(ee&&ge.length===ee));_e=!0);}catch(Yt){ut=!0,St=Yt}finally{try{!_e&&Kt.return&&Kt.return()}finally{if(ut)throw St}}return ge}return s(F,"sliceIterator"),function(D,ee){if(Array.isArray(D))return D;if(Symbol.iterator in Object(D))return F(D,ee);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),p=s(function(F){if(Array.isArray(F)){for(var D=0,ee=Array(F.length);D<F.length;D++)ee[D]=F[D];return ee}else return Array.from(F)},"toConsumableArray"),m=2147483647,h=36,g=1,A=26,y=38,E=700,b=72,S=128,R="-",B=/^xn--/,L=/[^\0-\x7E]/,O=/[\x2E\u3002\uFF0E\uFF61]/g,Y={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},V=h-g,z=Math.floor,Q=String.fromCharCode;function U(F){throw new RangeError(Y[F])}s(U,"error$1");function Z(F,D){for(var ee=[],ge=F.length;ge--;)ee[ge]=D(F[ge]);return ee}s(Z,"map");function J(F,D){var ee=F.split("@"),ge="";ee.length>1&&(ge=ee[0]+"@",F=ee[1]),F=F.replace(O,".");var _e=F.split("."),ut=Z(_e,D).join(".");return ge+ut}s(J,"mapDomain");function j(F){for(var D=[],ee=0,ge=F.length;ee<ge;){var _e=F.charCodeAt(ee++);if(_e>=55296&&_e<=56319&&ee<ge){var ut=F.charCodeAt(ee++);(ut&64512)==56320?D.push(((_e&1023)<<10)+(ut&1023)+65536):(D.push(_e),ee--)}else D.push(_e)}return D}s(j,"ucs2decode");var W=s(function(D){return String.fromCodePoint.apply(String,p(D))},"ucs2encode"),X=s(function(D){return D-48<10?D-22:D-65<26?D-65:D-97<26?D-97:h},"basicToDigit"),oe=s(function(D,ee){return D+22+75*(D<26)-((ee!=0)<<5)},"digitToBasic"),te=s(function(D,ee,ge){var _e=0;for(D=ge?z(D/E):D>>1,D+=z(D/ee);D>V*A>>1;_e+=h)D=z(D/V);return z(_e+(V+1)*D/(D+y))},"adapt"),re=s(function(D){var ee=[],ge=D.length,_e=0,ut=S,St=b,Kt=D.lastIndexOf(R);Kt<0&&(Kt=0);for(var er=0;er<Kt;++er)D.charCodeAt(er)>=128&&U("not-basic"),ee.push(D.charCodeAt(er));for(var Yt=Kt>0?Kt+1:0;Yt<ge;){for(var bt=_e,vr=1,di=h;;di+=h){Yt>=ge&&U("invalid-input");var no=X(D.charCodeAt(Yt++));(no>=h||no>z((m-_e)/vr))&&U("overflow"),_e+=no*vr;var Tn=di<=St?g:di>=St+A?A:di-St;if(no<Tn)break;var yo=h-Tn;vr>z(m/yo)&&U("overflow"),vr*=yo}var xi=ee.length+1;St=te(_e-bt,xi,bt==0),z(_e/xi)>m-ut&&U("overflow"),ut+=z(_e/xi),_e%=xi,ee.splice(_e++,0,ut)}return String.fromCodePoint.apply(String,ee)},"decode"),pe=s(function(D){var ee=[];D=j(D);var ge=D.length,_e=S,ut=0,St=b,Kt=!0,er=!1,Yt=void 0;try{for(var bt=D[Symbol.iterator](),vr;!(Kt=(vr=bt.next()).done);Kt=!0){var di=vr.value;di<128&&ee.push(Q(di))}}catch(jl){er=!0,Yt=jl}finally{try{!Kt&&bt.return&&bt.return()}finally{if(er)throw Yt}}var no=ee.length,Tn=no;for(no&&ee.push(R);Tn<ge;){var yo=m,xi=!0,Zo=!1,va=void 0;try{for(var Ic=D[Symbol.iterator](),Mo;!(xi=(Mo=Ic.next()).done);xi=!0){var Vs=Mo.value;Vs>=_e&&Vs<yo&&(yo=Vs)}}catch(jl){Zo=!0,va=jl}finally{try{!xi&&Ic.return&&Ic.return()}finally{if(Zo)throw va}}var gd=Tn+1;yo-_e>z((m-ut)/gd)&&U("overflow"),ut+=(yo-_e)*gd,_e=yo;var Tc=!0,Tg=!1,Tl=void 0;try{for(var wg=D[Symbol.iterator](),Sg;!(Tc=(Sg=wg.next()).done);Tc=!0){var YE=Sg.value;if(YE<_e&&++ut>m&&U("overflow"),YE==_e){for(var qa=ut,ku=h;;ku+=h){var Pu=ku<=St?g:ku>=St+A?A:ku-St;if(qa<Pu)break;var Ad=qa-Pu,_g=h-Pu;ee.push(Q(oe(Pu+Ad%_g,0))),qa=z(Ad/_g)}ee.push(Q(oe(qa,0))),St=te(ut,gd,Tn==no),ut=0,++Tn}}}catch(jl){Tg=!0,Tl=jl}finally{try{!Tc&&wg.return&&wg.return()}finally{if(Tg)throw Tl}}++ut,++_e}return ee.join("")},"encode"),Ae=s(function(D){return J(D,function(ee){return B.test(ee)?re(ee.slice(4).toLowerCase()):ee})},"toUnicode"),Oe=s(function(D){return J(D,function(ee){return L.test(ee)?"xn--"+pe(ee):ee})},"toASCII"),Te={version:"2.1.0",ucs2:{decode:j,encode:W},decode:re,encode:pe,toASCII:Oe,toUnicode:Ae},Je={};function Fe(F){var D=F.charCodeAt(0),ee=void 0;return D<16?ee="%0"+D.toString(16).toUpperCase():D<128?ee="%"+D.toString(16).toUpperCase():D<2048?ee="%"+(D>>6|192).toString(16).toUpperCase()+"%"+(D&63|128).toString(16).toUpperCase():ee="%"+(D>>12|224).toString(16).toUpperCase()+"%"+(D>>6&63|128).toString(16).toUpperCase()+"%"+(D&63|128).toString(16).toUpperCase(),ee}s(Fe,"pctEncChar");function lt(F){for(var D="",ee=0,ge=F.length;ee<ge;){var _e=parseInt(F.substr(ee+1,2),16);if(_e<128)D+=String.fromCharCode(_e),ee+=3;else if(_e>=194&&_e<224){if(ge-ee>=6){var ut=parseInt(F.substr(ee+4,2),16);D+=String.fromCharCode((_e&31)<<6|ut&63)}else D+=F.substr(ee,6);ee+=6}else if(_e>=224){if(ge-ee>=9){var St=parseInt(F.substr(ee+4,2),16),Kt=parseInt(F.substr(ee+7,2),16);D+=String.fromCharCode((_e&15)<<12|(St&63)<<6|Kt&63)}else D+=F.substr(ee,9);ee+=9}else D+=F.substr(ee,3),ee+=3}return D}s(lt,"pctDecChars");function _t(F,D){function ee(ge){var _e=lt(ge);return _e.match(D.UNRESERVED)?_e:ge}return s(ee,"decodeUnreserved"),F.scheme&&(F.scheme=String(F.scheme).replace(D.PCT_ENCODED,ee).toLowerCase().replace(D.NOT_SCHEME,"")),F.userinfo!==void 0&&(F.userinfo=String(F.userinfo).replace(D.PCT_ENCODED,ee).replace(D.NOT_USERINFO,Fe).replace(D.PCT_ENCODED,i)),F.host!==void 0&&(F.host=String(F.host).replace(D.PCT_ENCODED,ee).toLowerCase().replace(D.NOT_HOST,Fe).replace(D.PCT_ENCODED,i)),F.path!==void 0&&(F.path=String(F.path).replace(D.PCT_ENCODED,ee).replace(F.scheme?D.NOT_PATH:D.NOT_PATH_NOSCHEME,Fe).replace(D.PCT_ENCODED,i)),F.query!==void 0&&(F.query=String(F.query).replace(D.PCT_ENCODED,ee).replace(D.NOT_QUERY,Fe).replace(D.PCT_ENCODED,i)),F.fragment!==void 0&&(F.fragment=String(F.fragment).replace(D.PCT_ENCODED,ee).replace(D.NOT_FRAGMENT,Fe).replace(D.PCT_ENCODED,i)),F}s(_t,"_normalizeComponentEncoding");function xt(F){return F.replace(/^0*(.*)/,"$1")||"0"}s(xt,"_stripLeadingZeros");function gt(F,D){var ee=F.match(D.IPV4ADDRESS)||[],ge=f(ee,2),_e=ge[1];return _e?_e.split(".").map(xt).join("."):F}s(gt,"_normalizeIPv4");function ue(F,D){var ee=F.match(D.IPV6ADDRESS)||[],ge=f(ee,3),_e=ge[1],ut=ge[2];if(_e){for(var St=_e.toLowerCase().split("::").reverse(),Kt=f(St,2),er=Kt[0],Yt=Kt[1],bt=Yt?Yt.split(":").map(xt):[],vr=er.split(":").map(xt),di=D.IPV4ADDRESS.test(vr[vr.length-1]),no=di?7:8,Tn=vr.length-no,yo=Array(no),xi=0;xi<no;++xi)yo[xi]=bt[xi]||vr[Tn+xi]||"";di&&(yo[no-1]=gt(yo[no-1],D));var Zo=yo.reduce(function(gd,Tc,Tg){if(!Tc||Tc==="0"){var Tl=gd[gd.length-1];Tl&&Tl.index+Tl.length===Tg?Tl.length++:gd.push({index:Tg,length:1})}return gd},[]),va=Zo.sort(function(gd,Tc){return Tc.length-gd.length})[0],Ic=void 0;if(va&&va.length>1){var Mo=yo.slice(0,va.index),Vs=yo.slice(va.index+va.length);Ic=Mo.join(":")+"::"+Vs.join(":")}else Ic=yo.join(":");return ut&&(Ic+="%"+ut),Ic}else return F}s(ue,"_normalizeIPv6");var Ue=/^(?:([^:\/?#]+):)?(?:\/\/((?:([^\/?#@]*)@)?(\[[^\/?#\]]+\]|[^\/?#:]*)(?:\:(\d*))?))?([^?#]*)(?:\?([^#]*))?(?:#((?:.|\n|\r)*))?/i,ye="".match(/(){0}/)[1]===void 0;function $e(F){var D=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},ee={},ge=D.iri!==!1?u:l;D.reference==="suffix"&&(F=(D.scheme?D.scheme+":":"")+"//"+F);var _e=F.match(Ue);if(_e){ye?(ee.scheme=_e[1],ee.userinfo=_e[3],ee.host=_e[4],ee.port=parseInt(_e[5],10),ee.path=_e[6]||"",ee.query=_e[7],ee.fragment=_e[8],isNaN(ee.port)&&(ee.port=_e[5])):(ee.scheme=_e[1]||void 0,ee.userinfo=F.indexOf("@")!==-1?_e[3]:void 0,ee.host=F.indexOf("//")!==-1?_e[4]:void 0,ee.port=parseInt(_e[5],10),ee.path=_e[6]||"",ee.query=F.indexOf("?")!==-1?_e[7]:void 0,ee.fragment=F.indexOf("#")!==-1?_e[8]:void 0,isNaN(ee.port)&&(ee.port=F.match(/\/\/(?:.|\n)*\:(?:\/|\?|\#|$)/)?_e[4]:void 0)),ee.host&&(ee.host=ue(gt(ee.host,ge),ge)),ee.scheme===void 0&&ee.userinfo===void 0&&ee.host===void 0&&ee.port===void 0&&!ee.path&&ee.query===void 0?ee.reference="same-document":ee.scheme===void 0?ee.reference="relative":ee.fragment===void 0?ee.reference="absolute":ee.reference="uri",D.reference&&D.reference!=="suffix"&&D.reference!==ee.reference&&(ee.error=ee.error||"URI is not a "+D.reference+" reference.");var ut=Je[(D.scheme||ee.scheme||"").toLowerCase()];if(!D.unicodeSupport&&(!ut||!ut.unicodeSupport)){if(ee.host&&(D.domainHost||ut&&ut.domainHost))try{ee.host=Te.toASCII(ee.host.replace(ge.PCT_ENCODED,lt).toLowerCase())}catch(St){ee.error=ee.error||"Host's domain name can not be converted to ASCII via punycode: "+St}_t(ee,l)}else _t(ee,ge);ut&&ut.parse&&ut.parse(ee,D)}else ee.error=ee.error||"URI can not be parsed.";return ee}s($e,"parse");function ae(F,D){var ee=D.iri!==!1?u:l,ge=[];return F.userinfo!==void 0&&(ge.push(F.userinfo),ge.push("@")),F.host!==void 0&&ge.push(ue(gt(String(F.host),ee),ee).replace(ee.IPV6ADDRESS,function(_e,ut,St){return"["+ut+(St?"%25"+St:"")+"]"})),(typeof F.port=="number"||typeof F.port=="string")&&(ge.push(":"),ge.push(String(F.port))),ge.length?ge.join(""):void 0}s(ae,"_recomposeAuthority");var le=/^\.\.?\//,qe=/^\/\.(\/|$)/,Ne=/^\/\.\.(\/|$)/,Ee=/^\/?(?:.|\n)*?(?=\/|$)/;function je(F){for(var D=[];F.length;)if(F.match(le))F=F.replace(le,"");else if(F.match(qe))F=F.replace(qe,"/");else if(F.match(Ne))F=F.replace(Ne,"/"),D.pop();else if(F==="."||F==="..")F="";else{var ee=F.match(Ee);if(ee){var ge=ee[0];F=F.slice(ge.length),D.push(ge)}else throw new Error("Unexpected dot segment condition")}return D.join("")}s(je,"removeDotSegments");function tt(F){var D=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},ee=D.iri?u:l,ge=[],_e=Je[(D.scheme||F.scheme||"").toLowerCase()];if(_e&&_e.serialize&&_e.serialize(F,D),F.host&&!ee.IPV6ADDRESS.test(F.host)){if(D.domainHost||_e&&_e.domainHost)try{F.host=D.iri?Te.toUnicode(F.host):Te.toASCII(F.host.replace(ee.PCT_ENCODED,lt).toLowerCase())}catch(Kt){F.error=F.error||"Host's domain name can not be converted to "+(D.iri?"Unicode":"ASCII")+" via punycode: "+Kt}}_t(F,ee),D.reference!=="suffix"&&F.scheme&&(ge.push(F.scheme),ge.push(":"));var ut=ae(F,D);if(ut!==void 0&&(D.reference!=="suffix"&&ge.push("//"),ge.push(ut),F.path&&F.path.charAt(0)!=="/"&&ge.push("/")),F.path!==void 0){var St=F.path;!D.absolutePath&&(!_e||!_e.absolutePath)&&(St=je(St)),ut===void 0&&(St=St.replace(/^\/\//,"/%2F")),ge.push(St)}return F.query!==void 0&&(ge.push("?"),ge.push(F.query)),F.fragment!==void 0&&(ge.push("#"),ge.push(F.fragment)),ge.join("")}s(tt,"serialize");function mt(F,D){var ee=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},ge=arguments[3],_e={};return ge||(F=$e(tt(F,ee),ee),D=$e(tt(D,ee),ee)),ee=ee||{},!ee.tolerant&&D.scheme?(_e.scheme=D.scheme,_e.userinfo=D.userinfo,_e.host=D.host,_e.port=D.port,_e.path=je(D.path||""),_e.query=D.query):(D.userinfo!==void 0||D.host!==void 0||D.port!==void 0?(_e.userinfo=D.userinfo,_e.host=D.host,_e.port=D.port,_e.path=je(D.path||""),_e.query=D.query):(D.path?(D.path.charAt(0)==="/"?_e.path=je(D.path):((F.userinfo!==void 0||F.host!==void 0||F.port!==void 0)&&!F.path?_e.path="/"+D.path:F.path?_e.path=F.path.slice(0,F.path.lastIndexOf("/")+1)+D.path:_e.path=D.path,_e.path=je(_e.path)),_e.query=D.query):(_e.path=F.path,D.query!==void 0?_e.query=D.query:_e.query=F.query),_e.userinfo=F.userinfo,_e.host=F.host,_e.port=F.port),_e.scheme=F.scheme),_e.fragment=D.fragment,_e}s(mt,"resolveComponents");function Ft(F,D,ee){var ge=a({scheme:"null"},ee);return tt(mt($e(F,ge),$e(D,ge),ge,!0),ge)}s(Ft,"resolve");function Jt(F,D){return typeof F=="string"?F=tt($e(F,D),D):n(F)==="object"&&(F=$e(tt(F,D),D)),F}s(Jt,"normalize");function Qt(F,D,ee){return typeof F=="string"?F=tt($e(F,ee),ee):n(F)==="object"&&(F=tt(F,ee)),typeof D=="string"?D=tt($e(D,ee),ee):n(D)==="object"&&(D=tt(D,ee)),F===D}s(Qt,"equal");function zr(F,D){return F&&F.toString().replace(!D||!D.iri?l.ESCAPE:u.ESCAPE,Fe)}s(zr,"escapeComponent");function Br(F,D){return F&&F.toString().replace(!D||!D.iri?l.PCT_ENCODED:u.PCT_ENCODED,lt)}s(Br,"unescapeComponent");var un={scheme:"http",domainHost:!0,parse:s(function(D,ee){return D.host||(D.error=D.error||"HTTP URIs must have a host."),D},"parse"),serialize:s(function(D,ee){var ge=String(D.scheme).toLowerCase()==="https";return(D.port===(ge?443:80)||D.port==="")&&(D.port=void 0),D.path||(D.path="/"),D},"serialize")},ve={scheme:"https",domainHost:un.domainHost,parse:un.parse,serialize:un.serialize};function Ge(F){return typeof F.secure=="boolean"?F.secure:String(F.scheme).toLowerCase()==="wss"}s(Ge,"isSecure");var pt={scheme:"ws",domainHost:!0,parse:s(function(D,ee){var ge=D;return ge.secure=Ge(ge),ge.resourceName=(ge.path||"/")+(ge.query?"?"+ge.query:""),ge.path=void 0,ge.query=void 0,ge},"parse"),serialize:s(function(D,ee){if((D.port===(Ge(D)?443:80)||D.port==="")&&(D.port=void 0),typeof D.secure=="boolean"&&(D.scheme=D.secure?"wss":"ws",D.secure=void 0),D.resourceName){var ge=D.resourceName.split("?"),_e=f(ge,2),ut=_e[0],St=_e[1];D.path=ut&&ut!=="/"?ut:void 0,D.query=St,D.resourceName=void 0}return D.fragment=void 0,D},"serialize")},Tt={scheme:"wss",domainHost:pt.domainHost,parse:pt.parse,serialize:pt.serialize},or={},Zt=!0,Tr="[A-Za-z0-9\\-\\.\\_\\~"+(Zt?"\\xA0-\\u200D\\u2010-\\u2029\\u202F-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF":"")+"]",fr="[0-9A-Fa-f]",rr=r(r("%[EFef]"+fr+"%"+fr+fr+"%"+fr+fr)+"|"+r("%[89A-Fa-f]"+fr+"%"+fr+fr)+"|"+r("%"+fr+fr)),ur="[A-Za-z0-9\\!\\$\\%\\'\\*\\+\\-\\^\\_\\`\\{\\|\\}\\~]",nr="[\\!\\$\\%\\'\\(\\)\\*\\+\\,\\-\\.0-9\\<\\>A-Z\\x5E-\\x7E]",Mr=e(nr,'[\\"\\\\]'),Kr="[\\!\\$\\'\\(\\)\\*\\+\\,\\;\\:\\@]",sn=new RegExp(Tr,"g"),Cn=new RegExp(rr,"g"),ii=new RegExp(e("[^]",ur,"[\\.]",'[\\"]',Mr),"g"),Rn=new RegExp(e("[^]",Tr,Kr),"g"),ti=Rn;function an(F){var D=lt(F);return D.match(sn)?D:F}s(an,"decodeUnreserved");var Jn={scheme:"mailto",parse:s(function(D,ee){var ge=D,_e=ge.to=ge.path?ge.path.split(","):[];if(ge.path=void 0,ge.query){for(var ut=!1,St={},Kt=ge.query.split("&"),er=0,Yt=Kt.length;er<Yt;++er){var bt=Kt[er].split("=");switch(bt[0]){case"to":for(var vr=bt[1].split(","),di=0,no=vr.length;di<no;++di)_e.push(vr[di]);break;case"subject":ge.subject=Br(bt[1],ee);break;case"body":ge.body=Br(bt[1],ee);break;default:ut=!0,St[Br(bt[0],ee)]=Br(bt[1],ee);break}}ut&&(ge.headers=St)}ge.query=void 0;for(var Tn=0,yo=_e.length;Tn<yo;++Tn){var xi=_e[Tn].split("@");if(xi[0]=Br(xi[0]),ee.unicodeSupport)xi[1]=Br(xi[1],ee).toLowerCase();else try{xi[1]=Te.toASCII(Br(xi[1],ee).toLowerCase())}catch(Zo){ge.error=ge.error||"Email address's domain name can not be converted to ASCII via punycode: "+Zo}_e[Tn]=xi.join("@")}return ge},"parse$$1"),serialize:s(function(D,ee){var ge=D,_e=o(D.to);if(_e){for(var ut=0,St=_e.length;ut<St;++ut){var Kt=String(_e[ut]),er=Kt.lastIndexOf("@"),Yt=Kt.slice(0,er).replace(Cn,an).replace(Cn,i).replace(ii,Fe),bt=Kt.slice(er+1);try{bt=ee.iri?Te.toUnicode(bt):Te.toASCII(Br(bt,ee).toLowerCase())}catch(Tn){ge.error=ge.error||"Email address's domain name can not be converted to "+(ee.iri?"Unicode":"ASCII")+" via punycode: "+Tn}_e[ut]=Yt+"@"+bt}ge.path=_e.join(",")}var vr=D.headers=D.headers||{};D.subject&&(vr.subject=D.subject),D.body&&(vr.body=D.body);var di=[];for(var no in vr)vr[no]!==or[no]&&di.push(no.replace(Cn,an).replace(Cn,i).replace(Rn,Fe)+"="+vr[no].replace(Cn,an).replace(Cn,i).replace(ti,Fe));return di.length&&(ge.query=di.join("&")),ge},"serialize$$1")},Pe=/^([^\:]+)\:(.*)/,K={scheme:"urn",parse:s(function(D,ee){var ge=D.path&&D.path.match(Pe),_e=D;if(ge){var ut=ee.scheme||_e.scheme||"urn",St=ge[1].toLowerCase(),Kt=ge[2],er=ut+":"+(ee.nid||St),Yt=Je[er];_e.nid=St,_e.nss=Kt,_e.path=void 0,Yt&&(_e=Yt.parse(_e,ee))}else _e.error=_e.error||"URN can not be parsed.";return _e},"parse$$1"),serialize:s(function(D,ee){var ge=ee.scheme||D.scheme||"urn",_e=D.nid,ut=ge+":"+(ee.nid||_e),St=Je[ut];St&&(D=St.serialize(D,ee));var Kt=D,er=D.nss;return Kt.path=(_e||ee.nid)+":"+er,Kt},"serialize$$1")},Ce=/^[0-9A-Fa-f]{8}(?:\-[0-9A-Fa-f]{4}){3}\-[0-9A-Fa-f]{12}$/,Ie={scheme:"urn:uuid",parse:s(function(D,ee){var ge=D;return ge.uuid=ge.nss,ge.nss=void 0,!ee.tolerant&&(!ge.uuid||!ge.uuid.match(Ce))&&(ge.error=ge.error||"UUID is not valid."),ge},"parse"),serialize:s(function(D,ee){var ge=D;return ge.nss=(D.uuid||"").toLowerCase(),ge},"serialize")};Je[un.scheme]=un,Je[ve.scheme]=ve,Je[pt.scheme]=pt,Je[Tt.scheme]=Tt,Je[Jn.scheme]=Jn,Je[K.scheme]=K,Je[Ie.scheme]=Ie,t.SCHEMES=Je,t.pctEncChar=Fe,t.pctDecChars=lt,t.parse=$e,t.removeDotSegments=je,t.serialize=tt,t.resolveComponents=mt,t.resolve=Ft,t.normalize=Jt,t.equal=Qt,t.escapeComponent=zr,t.unescapeComponent=Br,Object.defineProperty(t,"__esModule",{value:!0})})});var Zle=H((Z8o,Bvt)=>{"use strict";d();Bvt.exports=s(function t(e,r){if(e===r)return!0;if(e&&r&&typeof e=="object"&&typeof r=="object"){if(e.constructor!==r.constructor)return!1;var n,i,o;if(Array.isArray(e)){if(n=e.length,n!=r.length)return!1;for(i=n;i--!==0;)if(!t(e[i],r[i]))return!1;return!0}if(e.constructor===RegExp)return e.source===r.source&&e.flags===r.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===r.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===r.toString();if(o=Object.keys(e),n=o.length,n!==Object.keys(r).length)return!1;for(i=n;i--!==0;)if(!Object.prototype.hasOwnProperty.call(r,o[i]))return!1;for(i=n;i--!==0;){var a=o[i];if(!t(e[a],r[a]))return!1}return!0}return e!==e&&r!==r},"equal")});var Mvt=H((rMo,Nvt)=>{"use strict";d();Nvt.exports=s(function(e){for(var r=0,n=e.length,i=0,o;i<n;)r++,o=e.charCodeAt(i++),o>=55296&&o<=56319&&i<n&&(o=e.charCodeAt(i),(o&64512)==56320&&i++);return r},"ucs2length")});var o5=H((oMo,Ovt)=>{"use strict";d();Ovt.exports={copy:SRr,checkDataType:N5e,checkDataTypes:_Rr,coerceToTypes:RRr,toHash:L5e,getProperty:F5e,escapeQuotes:O5e,equal:Zle(),ucs2length:Mvt(),varOccurences:DRr,varReplace:BRr,schemaHasRules:NRr,schemaHasRulesExcept:MRr,schemaUnknownRules:LRr,toQuotedString:M5e,getPathExpr:FRr,getPath:ORr,getData:qRr,unescapeFragment:HRr,unescapeJsonPointer:U5e,escapeFragment:$Rr,escapeJsonPointer:Q5e};function SRr(t,e){e=e||{};for(var r in t)e[r]=t[r];return e}s(SRr,"copy");function N5e(t,e,r,n){var i=n?" !== ":" === ",o=n?" || ":" && ",a=n?"!":"",c=n?"":"!";switch(t){case"null":return e+i+"null";case"array":return a+"Array.isArray("+e+")";case"object":return"("+a+e+o+"typeof "+e+i+'"object"'+o+c+"Array.isArray("+e+"))";case"integer":return"(typeof "+e+i+'"number"'+o+c+"("+e+" % 1)"+o+e+i+e+(r?o+a+"isFinite("+e+")":"")+")";case"number":return"(typeof "+e+i+'"'+t+'"'+(r?o+a+"isFinite("+e+")":"")+")";default:return"typeof "+e+i+'"'+t+'"'}}s(N5e,"checkDataType");function _Rr(t,e,r){switch(t.length){case 1:return N5e(t[0],e,r,!0);default:var n="",i=L5e(t);i.array&&i.object&&(n=i.null?"(":"(!"+e+" || ",n+="typeof "+e+' !== "object")',delete i.null,delete i.array,delete i.object),i.number&&delete i.integer;for(var o in i)n+=(n?" && ":"")+N5e(o,e,r,!0);return n}}s(_Rr,"checkDataTypes");var Lvt=L5e(["string","number","integer","boolean","null"]);function RRr(t,e){if(Array.isArray(e)){for(var r=[],n=0;n<e.length;n++){var i=e[n];(Lvt[i]||t==="array"&&i==="array")&&(r[r.length]=i)}if(r.length)return r}else{if(Lvt[e])return[e];if(t==="array"&&e==="array")return["array"]}}s(RRr,"coerceToTypes");function L5e(t){for(var e={},r=0;r<t.length;r++)e[t[r]]=!0;return e}s(L5e,"toHash");var kRr=/^[a-z$_][a-z$_0-9]*$/i,PRr=/'|\\/g;function F5e(t){return typeof t=="number"?"["+t+"]":kRr.test(t)?"."+t:"['"+O5e(t)+"']"}s(F5e,"getProperty");function O5e(t){return t.replace(PRr,"\\$&").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\f/g,"\\f").replace(/\t/g,"\\t")}s(O5e,"escapeQuotes");function DRr(t,e){e+="[^0-9]";var r=t.match(new RegExp(e,"g"));return r?r.length:0}s(DRr,"varOccurences");function BRr(t,e,r){return e+="([^0-9])",r=r.replace(/\$/g,"$$$$"),t.replace(new RegExp(e,"g"),r+"$1")}s(BRr,"varReplace");function NRr(t,e){if(typeof t=="boolean")return!t;for(var r in t)if(e[r])return!0}s(NRr,"schemaHasRules");function MRr(t,e,r){if(typeof t=="boolean")return!t&&r!="not";for(var n in t)if(n!=r&&e[n])return!0}s(MRr,"schemaHasRulesExcept");function LRr(t,e){if(typeof t!="boolean"){for(var r in t)if(!e[r])return r}}s(LRr,"schemaUnknownRules");function M5e(t){return"'"+O5e(t)+"'"}s(M5e,"toQuotedString");function FRr(t,e,r,n){var i=r?"'/' + "+e+(n?"":".replace(/~/g, '~0').replace(/\\//g, '~1')"):n?"'[' + "+e+" + ']'":"'[\\'' + "+e+" + '\\']'";return Fvt(t,i)}s(FRr,"getPathExpr");function ORr(t,e,r){var n=M5e(r?"/"+Q5e(e):F5e(e));return Fvt(t,n)}s(ORr,"getPath");var QRr=/^\/(?:[^~]|~0|~1)*$/,URr=/^([0-9]+)(#|\/(?:[^~]|~0|~1)*)?$/;function qRr(t,e,r){var n,i,o,a;if(t==="")return"rootData";if(t[0]=="/"){if(!QRr.test(t))throw new Error("Invalid JSON-pointer: "+t);i=t,o="rootData"}else{if(a=t.match(URr),!a)throw new Error("Invalid JSON-pointer: "+t);if(n=+a[1],i=a[2],i=="#"){if(n>=e)throw new Error("Cannot access property/index "+n+" levels up, current level is "+e);return r[e-n]}if(n>e)throw new Error("Cannot access data "+n+" levels up, current level is "+e);if(o="data"+(e-n||""),!i)return o}for(var c=o,l=i.split("/"),u=0;u<l.length;u++){var f=l[u];f&&(o+=F5e(U5e(f)),c+=" && "+o)}return c}s(qRr,"getData");function Fvt(t,e){return t=='""'?e:(t+" + "+e).replace(/([^\\])' \+ '/g,"$1")}s(Fvt,"joinPaths");function HRr(t){return U5e(decodeURIComponent(t))}s(HRr,"unescapeFragment");function $Rr(t){return encodeURIComponent(Q5e(t))}s($Rr,"escapeFragment");function Q5e(t){return t.replace(/~/g,"~0").replace(/\//g,"~1")}s(Q5e,"escapeJsonPointer");function U5e(t){return t.replace(/~1/g,"/").replace(/~0/g,"~")}s(U5e,"unescapeJsonPointer")});var q5e=H((cMo,Qvt)=>{"use strict";d();var WRr=o5();Qvt.exports=jRr;function jRr(t){WRr.copy(t,this)}s(jRr,"SchemaObject")});var qvt=H((dMo,Uvt)=>{"use strict";d();var OS=Uvt.exports=function(t,e,r){typeof e=="function"&&(r=e,e={}),r=e.cb||r;var n=typeof r=="function"?r:r.pre||function(){},i=r.post||function(){};eue(e,n,i,t,"",t)};OS.keywords={additionalItems:!0,items:!0,contains:!0,additionalProperties:!0,propertyNames:!0,not:!0};OS.arrayKeywords={items:!0,allOf:!0,anyOf:!0,oneOf:!0};OS.propsKeywords={definitions:!0,properties:!0,patternProperties:!0,dependencies:!0};OS.skipKeywords={default:!0,enum:!0,const:!0,required:!0,maximum:!0,minimum:!0,exclusiveMaximum:!0,exclusiveMinimum:!0,multipleOf:!0,maxLength:!0,minLength:!0,pattern:!0,format:!0,maxItems:!0,minItems:!0,uniqueItems:!0,maxProperties:!0,minProperties:!0};function eue(t,e,r,n,i,o,a,c,l,u){if(n&&typeof n=="object"&&!Array.isArray(n)){e(n,i,o,a,c,l,u);for(var f in n){var p=n[f];if(Array.isArray(p)){if(f in OS.arrayKeywords)for(var m=0;m<p.length;m++)eue(t,e,r,p[m],i+"/"+f+"/"+m,o,i,f,n,m)}else if(f in OS.propsKeywords){if(p&&typeof p=="object")for(var h in p)eue(t,e,r,p[h],i+"/"+f+"/"+GRr(h),o,i,f,n,h)}else(f in OS.keywords||t.allKeys&&!(f in OS.skipKeywords))&&eue(t,e,r,p,i+"/"+f,o,i,f,n)}r(n,i,o,a,c,l,u)}}s(eue,"_traverse");function GRr(t){return t.replace(/~/g,"~0").replace(/\//g,"~1")}s(GRr,"escapeJsonPtr")});var sue=H((mMo,jvt)=>{"use strict";d();var DH=Dvt(),Hvt=Zle(),iue=o5(),tue=q5e(),VRr=qvt();jvt.exports=US;US.normalizeId=QS;US.fullPath=rue;US.url=nue;US.ids=XRr;US.inlineRef=H5e;US.schema=oue;function US(t,e,r){var n=this._refs[r];if(typeof n=="string")if(this._refs[n])n=this._refs[n];else return US.call(this,t,e,n);if(n=n||this._schemas[r],n instanceof tue)return H5e(n.schema,this._opts.inlineRefs)?n.schema:n.validate||this._compile(n);var i=oue.call(this,e,r),o,a,c;return i&&(o=i.schema,e=i.root,c=i.baseId),o instanceof tue?a=o.validate||t.call(this,o.schema,e,void 0,c):o!==void 0&&(a=H5e(o,this._opts.inlineRefs)?o:t.call(this,o,e,void 0,c)),a}s(US,"resolve");function oue(t,e){var r=DH.parse(e),n=Wvt(r),i=rue(this._getId(t.schema));if(Object.keys(t.schema).length===0||n!==i){var o=QS(n),a=this._refs[o];if(typeof a=="string")return zRr.call(this,t,a,r);if(a instanceof tue)a.validate||this._compile(a),t=a;else if(a=this._schemas[o],a instanceof tue){if(a.validate||this._compile(a),o==QS(e))return{schema:a,root:t,baseId:i};t=a}else return;if(!t.schema)return;i=rue(this._getId(t.schema))}return $vt.call(this,r,i,t.schema,t)}s(oue,"resolveSchema");function zRr(t,e,r){var n=oue.call(this,t,e);if(n){var i=n.schema,o=n.baseId;t=n.root;var a=this._getId(i);return a&&(o=nue(o,a)),$vt.call(this,r,o,i,t)}}s(zRr,"resolveRecursive");var KRr=iue.toHash(["properties","patternProperties","enum","dependencies","definitions"]);function $vt(t,e,r,n){if(t.fragment=t.fragment||"",t.fragment.slice(0,1)=="/"){for(var i=t.fragment.split("/"),o=1;o<i.length;o++){var a=i[o];if(a){if(a=iue.unescapeFragment(a),r=r[a],r===void 0)break;var c;if(!KRr[a]&&(c=this._getId(r),c&&(e=nue(e,c)),r.$ref)){var l=nue(e,r.$ref),u=oue.call(this,n,l);u&&(r=u.schema,n=u.root,e=u.baseId)}}}if(r!==void 0&&r!==n.schema)return{schema:r,root:n,baseId:e}}}s($vt,"getJsonPointer");var YRr=iue.toHash(["type","format","pattern","maxLength","minLength","maxProperties","minProperties","maxItems","minItems","maximum","minimum","uniqueItems","multipleOf","required","enum"]);function H5e(t,e){if(e===!1)return!1;if(e===void 0||e===!0)return $5e(t);if(e)return W5e(t)<=e}s(H5e,"inlineRef");function $5e(t){var e;if(Array.isArray(t)){for(var r=0;r<t.length;r++)if(e=t[r],typeof e=="object"&&!$5e(e))return!1}else for(var n in t)if(n=="$ref"||(e=t[n],typeof e=="object"&&!$5e(e)))return!1;return!0}s($5e,"checkNoRef");function W5e(t){var e=0,r;if(Array.isArray(t)){for(var n=0;n<t.length;n++)if(r=t[n],typeof r=="object"&&(e+=W5e(r)),e==1/0)return 1/0}else for(var i in t){if(i=="$ref")return 1/0;if(YRr[i])e++;else if(r=t[i],typeof r=="object"&&(e+=W5e(r)+1),e==1/0)return 1/0}return e}s(W5e,"countKeys");function rue(t,e){e!==!1&&(t=QS(t));var r=DH.parse(t);return Wvt(r)}s(rue,"getFullPath");function Wvt(t){return DH.serialize(t).split("#")[0]+"#"}s(Wvt,"_getFullPath");var JRr=/#\/?$/;function QS(t){return t?t.replace(JRr,""):""}s(QS,"normalizeId");function nue(t,e){return e=QS(e),DH.resolve(t,e)}s(nue,"resolveUrl");function XRr(t){var e=QS(this._getId(t)),r={"":e},n={"":rue(e,!1)},i={},o=this;return VRr(t,{allKeys:!0},function(a,c,l,u,f,p,m){if(c!==""){var h=o._getId(a),g=r[u],A=n[u]+"/"+f;if(m!==void 0&&(A+="/"+(typeof m=="number"?m:iue.escapeFragment(m))),typeof h=="string"){h=g=QS(g?DH.resolve(g,h):h);var y=o._refs[h];if(typeof y=="string"&&(y=o._refs[y]),y&&y.schema){if(!Hvt(a,y.schema))throw new Error('id "'+h+'" resolves to more than one schema')}else if(h!=QS(A))if(h[0]=="#"){if(i[h]&&!Hvt(a,i[h]))throw new Error('id "'+h+'" resolves to more than one schema');i[h]=a}else o._refs[h]=A}r[c]=g,n[c]=A}}),i}s(XRr,"resolveIds")});var aue=H((AMo,Vvt)=>{"use strict";d();var j5e=sue();Vvt.exports={Validation:Gvt(ZRr),MissingRef:Gvt(G5e)};function ZRr(t){this.message="validation failed",this.errors=t,this.ajv=this.validation=!0}s(ZRr,"ValidationError");G5e.message=function(t,e){return"can't resolve reference "+e+" from id "+t};function G5e(t,e,r){this.message=r||G5e.message(t,e),this.missingRef=j5e.url(t,e),this.missingSchema=j5e.normalizeId(j5e.fullPath(this.missingRef))}s(G5e,"MissingRefError");function Gvt(t){return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}s(Gvt,"errorSubclass")});var V5e=H((vMo,zvt)=>{"use strict";d();zvt.exports=function(t,e){e||(e={}),typeof e=="function"&&(e={cmp:e});var r=typeof e.cycles=="boolean"?e.cycles:!1,n=e.cmp&&function(o){return function(a){return function(c,l){var u={key:c,value:a[c]},f={key:l,value:a[l]};return o(u,f)}}}(e.cmp),i=[];return s(function o(a){if(a&&a.toJSON&&typeof a.toJSON=="function"&&(a=a.toJSON()),a!==void 0){if(typeof a=="number")return isFinite(a)?""+a:"null";if(typeof a!="object")return JSON.stringify(a);var c,l;if(Array.isArray(a)){for(l="[",c=0;c<a.length;c++)c&&(l+=","),l+=o(a[c])||"null";return l+"]"}if(a===null)return"null";if(i.indexOf(a)!==-1){if(r)return JSON.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON")}var u=i.push(a)-1,f=Object.keys(a).sort(n&&n(a));for(l="",c=0;c<f.length;c++){var p=f[c],m=o(a[p]);m&&(l&&(l+=","),l+=JSON.stringify(p)+":"+m)}return i.splice(u,1),"{"+l+"}"}},"stringify")(t)}});var z5e=H((bMo,Kvt)=>{"use strict";d();Kvt.exports=s(function(e,r,n){var i="",o=e.schema.$async===!0,a=e.util.schemaHasRulesExcept(e.schema,e.RULES.all,"$ref"),c=e.self._getId(e.schema);if(e.opts.strictKeywords){var l=e.util.schemaUnknownRules(e.schema,e.RULES.keywords);if(l){var u="unknown keyword: "+l;if(e.opts.strictKeywords==="log")e.logger.warn(u);else throw new Error(u)}}if(e.isTop&&(i+=" var validate = ",o&&(e.async=!0,i+="async "),i+="function(data, dataPath, parentData, parentDataProperty, rootData) { 'use strict'; ",c&&(e.opts.sourceCode||e.opts.processCode)&&(i+=" "+("/*# sourceURL="+c+" */")+" ")),typeof e.schema=="boolean"||!(a||e.schema.$ref)){var r="false schema",f=e.level,p=e.dataLevel,m=e.schema[r],h=e.schemaPath+e.util.getProperty(r),g=e.errSchemaPath+"/"+r,B=!e.opts.allErrors,Y,A="data"+(p||""),R="valid"+f;if(e.schema===!1){e.isTop?B=!0:i+=" var "+R+" = false; ";var y=y||[];y.push(i),i="",e.createErrors!==!1?(i+=" { keyword: '"+(Y||"false schema")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(g)+" , params: {} ",e.opts.messages!==!1&&(i+=" , message: 'boolean schema is false' "),e.opts.verbose&&(i+=" , schema: false , parentSchema: validate.schema"+e.schemaPath+" , data: "+A+" "),i+=" } "):i+=" {} ";var E=i;i=y.pop(),!e.compositeRule&&B?e.async?i+=" throw new ValidationError(["+E+"]); ":i+=" validate.errors = ["+E+"]; return false; ":i+=" var err = "+E+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; "}else e.isTop?o?i+=" return data; ":i+=" validate.errors = null; return true; ":i+=" var "+R+" = true; ";return e.isTop&&(i+=" }; return validate; "),i}if(e.isTop){var b=e.isTop,f=e.level=0,p=e.dataLevel=0,A="data";if(e.rootId=e.resolve.fullPath(e.self._getId(e.root.schema)),e.baseId=e.baseId||e.rootId,delete e.isTop,e.dataPathArr=[""],e.schema.default!==void 0&&e.opts.useDefaults&&e.opts.strictDefaults){var S="default is ignored in the schema root";if(e.opts.strictDefaults==="log")e.logger.warn(S);else throw new Error(S)}i+=" var vErrors = null; ",i+=" var errors = 0;     ",i+=" if (rootData === undefined) rootData = data; "}else{var f=e.level,p=e.dataLevel,A="data"+(p||"");if(c&&(e.baseId=e.resolve.url(e.baseId,c)),o&&!e.async)throw new Error("async schema in sync schema");i+=" var errs_"+f+" = errors;"}var R="valid"+f,B=!e.opts.allErrors,L="",O="",Y,V=e.schema.type,z=Array.isArray(V);if(V&&e.opts.nullable&&e.schema.nullable===!0&&(z?V.indexOf("null")==-1&&(V=V.concat("null")):V!="null"&&(V=[V,"null"],z=!0)),z&&V.length==1&&(V=V[0],z=!1),e.schema.$ref&&a){if(e.opts.extendRefs=="fail")throw new Error('$ref: validation keywords used in schema at path "'+e.errSchemaPath+'" (see option extendRefs)');e.opts.extendRefs!==!0&&(a=!1,e.logger.warn('$ref: keywords ignored in schema at path "'+e.errSchemaPath+'"'))}if(e.schema.$comment&&e.opts.$comment&&(i+=" "+e.RULES.all.$comment.code(e,"$comment")),V){if(e.opts.coerceTypes)var Q=e.util.coerceToTypes(e.opts.coerceTypes,V);var U=e.RULES.types[V];if(Q||z||U===!0||U&&!Ee(U)){var h=e.schemaPath+".type",g=e.errSchemaPath+"/type",h=e.schemaPath+".type",g=e.errSchemaPath+"/type",Z=z?"checkDataTypes":"checkDataType";if(i+=" if ("+e.util[Z](V,A,e.opts.strictNumbers,!0)+") { ",Q){var J="dataType"+f,j="coerced"+f;i+=" var "+J+" = typeof "+A+"; var "+j+" = undefined; ",e.opts.coerceTypes=="array"&&(i+=" if ("+J+" == 'object' && Array.isArray("+A+") && "+A+".length == 1) { "+A+" = "+A+"[0]; "+J+" = typeof "+A+"; if ("+e.util.checkDataType(e.schema.type,A,e.opts.strictNumbers)+") "+j+" = "+A+"; } "),i+=" if ("+j+" !== undefined) ; ";var W=Q;if(W)for(var X,oe=-1,te=W.length-1;oe<te;)X=W[oe+=1],X=="string"?i+=" else if ("+J+" == 'number' || "+J+" == 'boolean') "+j+" = '' + "+A+"; else if ("+A+" === null) "+j+" = ''; ":X=="number"||X=="integer"?(i+=" else if ("+J+" == 'boolean' || "+A+" === null || ("+J+" == 'string' && "+A+" && "+A+" == +"+A+" ",X=="integer"&&(i+=" && !("+A+" % 1)"),i+=")) "+j+" = +"+A+"; "):X=="boolean"?i+=" else if ("+A+" === 'false' || "+A+" === 0 || "+A+" === null) "+j+" = false; else if ("+A+" === 'true' || "+A+" === 1) "+j+" = true; ":X=="null"?i+=" else if ("+A+" === '' || "+A+" === 0 || "+A+" === false) "+j+" = null; ":e.opts.coerceTypes=="array"&&X=="array"&&(i+=" else if ("+J+" == 'string' || "+J+" == 'number' || "+J+" == 'boolean' || "+A+" == null) "+j+" = ["+A+"]; ");i+=" else {   ";var y=y||[];y.push(i),i="",e.createErrors!==!1?(i+=" { keyword: '"+(Y||"type")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(g)+" , params: { type: '",z?i+=""+V.join(","):i+=""+V,i+="' } ",e.opts.messages!==!1&&(i+=" , message: 'should be ",z?i+=""+V.join(","):i+=""+V,i+="' "),e.opts.verbose&&(i+=" , schema: validate.schema"+h+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+A+" "),i+=" } "):i+=" {} ";var E=i;i=y.pop(),!e.compositeRule&&B?e.async?i+=" throw new ValidationError(["+E+"]); ":i+=" validate.errors = ["+E+"]; return false; ":i+=" var err = "+E+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",i+=" } if ("+j+" !== undefined) {  ";var re=p?"data"+(p-1||""):"parentData",pe=p?e.dataPathArr[p]:"parentDataProperty";i+=" "+A+" = "+j+"; ",p||(i+="if ("+re+" !== undefined)"),i+=" "+re+"["+pe+"] = "+j+"; } "}else{var y=y||[];y.push(i),i="",e.createErrors!==!1?(i+=" { keyword: '"+(Y||"type")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(g)+" , params: { type: '",z?i+=""+V.join(","):i+=""+V,i+="' } ",e.opts.messages!==!1&&(i+=" , message: 'should be ",z?i+=""+V.join(","):i+=""+V,i+="' "),e.opts.verbose&&(i+=" , schema: validate.schema"+h+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+A+" "),i+=" } "):i+=" {} ";var E=i;i=y.pop(),!e.compositeRule&&B?e.async?i+=" throw new ValidationError(["+E+"]); ":i+=" validate.errors = ["+E+"]; return false; ":i+=" var err = "+E+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; "}i+=" } "}}if(e.schema.$ref&&!a)i+=" "+e.RULES.all.$ref.code(e,"$ref")+" ",B&&(i+=" } if (errors === ",b?i+="0":i+="errs_"+f,i+=") { ",O+="}");else{var Ae=e.RULES;if(Ae){for(var U,Oe=-1,Te=Ae.length-1;Oe<Te;)if(U=Ae[Oe+=1],Ee(U)){if(U.type&&(i+=" if ("+e.util.checkDataType(U.type,A,e.opts.strictNumbers)+") { "),e.opts.useDefaults){if(U.type=="object"&&e.schema.properties){var m=e.schema.properties,Je=Object.keys(m),Fe=Je;if(Fe)for(var lt,_t=-1,xt=Fe.length-1;_t<xt;){lt=Fe[_t+=1];var gt=m[lt];if(gt.default!==void 0){var ue=A+e.util.getProperty(lt);if(e.compositeRule){if(e.opts.strictDefaults){var S="default is ignored for: "+ue;if(e.opts.strictDefaults==="log")e.logger.warn(S);else throw new Error(S)}}else i+=" if ("+ue+" === undefined ",e.opts.useDefaults=="empty"&&(i+=" || "+ue+" === null || "+ue+" === '' "),i+=" ) "+ue+" = ",e.opts.useDefaults=="shared"?i+=" "+e.useDefault(gt.default)+" ":i+=" "+JSON.stringify(gt.default)+" ",i+="; "}}}else if(U.type=="array"&&Array.isArray(e.schema.items)){var Ue=e.schema.items;if(Ue){for(var gt,oe=-1,ye=Ue.length-1;oe<ye;)if(gt=Ue[oe+=1],gt.default!==void 0){var ue=A+"["+oe+"]";if(e.compositeRule){if(e.opts.strictDefaults){var S="default is ignored for: "+ue;if(e.opts.strictDefaults==="log")e.logger.warn(S);else throw new Error(S)}}else i+=" if ("+ue+" === undefined ",e.opts.useDefaults=="empty"&&(i+=" || "+ue+" === null || "+ue+" === '' "),i+=" ) "+ue+" = ",e.opts.useDefaults=="shared"?i+=" "+e.useDefault(gt.default)+" ":i+=" "+JSON.stringify(gt.default)+" ",i+="; "}}}}var $e=U.rules;if($e){for(var ae,le=-1,qe=$e.length-1;le<qe;)if(ae=$e[le+=1],je(ae)){var Ne=ae.code(e,ae.keyword,U.type);Ne&&(i+=" "+Ne+" ",B&&(L+="}"))}}if(B&&(i+=" "+L+" ",L=""),U.type&&(i+=" } ",V&&V===U.type&&!Q)){i+=" else { ";var h=e.schemaPath+".type",g=e.errSchemaPath+"/type",y=y||[];y.push(i),i="",e.createErrors!==!1?(i+=" { keyword: '"+(Y||"type")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(g)+" , params: { type: '",z?i+=""+V.join(","):i+=""+V,i+="' } ",e.opts.messages!==!1&&(i+=" , message: 'should be ",z?i+=""+V.join(","):i+=""+V,i+="' "),e.opts.verbose&&(i+=" , schema: validate.schema"+h+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+A+" "),i+=" } "):i+=" {} ";var E=i;i=y.pop(),!e.compositeRule&&B?e.async?i+=" throw new ValidationError(["+E+"]); ":i+=" validate.errors = ["+E+"]; return false; ":i+=" var err = "+E+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",i+=" } "}B&&(i+=" if (errors === ",b?i+="0":i+="errs_"+f,i+=") { ",O+="}")}}}B&&(i+=" "+O+" "),b?(o?(i+=" if (errors === 0) return data;           ",i+=" else throw new ValidationError(vErrors); "):(i+=" validate.errors = vErrors; ",i+=" return errors === 0;       "),i+=" }; return validate;"):i+=" var "+R+" = errors === errs_"+f+";";function Ee(mt){for(var Ft=mt.rules,Jt=0;Jt<Ft.length;Jt++)if(je(Ft[Jt]))return!0}s(Ee,"$shouldUseGroup");function je(mt){return e.schema[mt.keyword]!==void 0||mt.implements&&tt(mt)}s(je,"$shouldUseRule");function tt(mt){for(var Ft=mt.implements,Jt=0;Jt<Ft.length;Jt++)if(e.schema[Ft[Jt]]!==void 0)return!0}return s(tt,"$ruleImplementsSomeKeyword"),i},"generate_validate")});var ext=H((wMo,Zvt)=>{"use strict";d();var cue=sue(),uue=o5(),Jvt=aue(),ekr=V5e(),Yvt=z5e(),tkr=uue.ucs2length,rkr=Zle(),nkr=Jvt.Validation;Zvt.exports=K5e;function K5e(t,e,r,n){var i=this,o=this._opts,a=[void 0],c={},l=[],u={},f=[],p={},m=[];e=e||{schema:t,refVal:a,refs:c};var h=ikr.call(this,t,e,n),g=this._compilations[h.index];if(h.compiling)return g.callValidate=S;var A=this._formats,y=this.RULES;try{var E=R(t,e,r,n);g.validate=E;var b=g.callValidate;return b&&(b.schema=E.schema,b.errors=null,b.refs=E.refs,b.refVal=E.refVal,b.root=E.root,b.$async=E.$async,o.sourceCode&&(b.source=E.source)),E}finally{okr.call(this,t,e,n)}function S(){var Z=g.validate,J=Z.apply(this,arguments);return S.errors=Z.errors,J}s(S,"callValidate");function R(Z,J,j,W){var X=!J||J&&J.schema==Z;if(J.schema!=e.schema)return K5e.call(i,Z,J,j,W);var oe=Z.$async===!0,te=Yvt({isTop:!0,schema:Z,isRoot:X,baseId:W,root:J,schemaPath:"",errSchemaPath:"#",errorPath:'""',MissingRefError:Jvt.MissingRef,RULES:y,validate:Yvt,util:uue,resolve:cue,resolveRef:B,usePattern:z,useDefault:Q,useCustomRule:U,opts:o,formats:A,logger:i.logger,self:i});te=lue(a,ckr)+lue(l,skr)+lue(f,akr)+lue(m,lkr)+te,o.processCode&&(te=o.processCode(te,Z));var re;try{var pe=new Function("self","RULES","formats","root","refVal","defaults","customRules","equal","ucs2length","ValidationError",te);re=pe(i,y,A,e,a,f,m,rkr,tkr,nkr),a[0]=re}catch(Ae){throw i.logger.error("Error compiling schema, function code:",te),Ae}return re.schema=Z,re.errors=null,re.refs=c,re.refVal=a,re.root=X?re:J,oe&&(re.$async=!0),o.sourceCode===!0&&(re.source={code:te,patterns:l,defaults:f}),re}s(R,"localCompile");function B(Z,J,j){J=cue.url(Z,J);var W=c[J],X,oe;if(W!==void 0)return X=a[W],oe="refVal["+W+"]",V(X,oe);if(!j&&e.refs){var te=e.refs[J];if(te!==void 0)return X=e.refVal[te],oe=L(J,X),V(X,oe)}oe=L(J);var re=cue.call(i,R,e,J);if(re===void 0){var pe=r&&r[J];pe&&(re=cue.inlineRef(pe,o.inlineRefs)?pe:K5e.call(i,pe,e,r,Z))}if(re===void 0)O(J);else return Y(J,re),V(re,oe)}s(B,"resolveRef");function L(Z,J){var j=a.length;return a[j]=J,c[Z]=j,"refVal"+j}s(L,"addLocalRef");function O(Z){delete c[Z]}s(O,"removeLocalRef");function Y(Z,J){var j=c[Z];a[j]=J}s(Y,"replaceLocalRef");function V(Z,J){return typeof Z=="object"||typeof Z=="boolean"?{code:J,schema:Z,inline:!0}:{code:J,$async:Z&&!!Z.$async}}s(V,"resolvedRef");function z(Z){var J=u[Z];return J===void 0&&(J=u[Z]=l.length,l[J]=Z),"pattern"+J}s(z,"usePattern");function Q(Z){switch(typeof Z){case"boolean":case"number":return""+Z;case"string":return uue.toQuotedString(Z);case"object":if(Z===null)return"null";var J=ekr(Z),j=p[J];return j===void 0&&(j=p[J]=f.length,f[j]=Z),"default"+j}}s(Q,"useDefault");function U(Z,J,j,W){if(i._opts.validateSchema!==!1){var X=Z.definition.dependencies;if(X&&!X.every(function(Fe){return Object.prototype.hasOwnProperty.call(j,Fe)}))throw new Error("parent schema must have all required keywords: "+X.join(","));var oe=Z.definition.validateSchema;if(oe){var te=oe(J);if(!te){var re="keyword schema is invalid: "+i.errorsText(oe.errors);if(i._opts.validateSchema=="log")i.logger.error(re);else throw new Error(re)}}}var pe=Z.definition.compile,Ae=Z.definition.inline,Oe=Z.definition.macro,Te;if(pe)Te=pe.call(i,J,j,W);else if(Oe)Te=Oe.call(i,J,j,W),o.validateSchema!==!1&&i.validateSchema(Te,!0);else if(Ae)Te=Ae.call(i,W,Z.keyword,J,j);else if(Te=Z.definition.validate,!Te)return;if(Te===void 0)throw new Error('custom keyword "'+Z.keyword+'"failed to compile');var Je=m.length;return m[Je]=Te,{code:"customRule"+Je,validate:Te}}s(U,"useCustomRule")}s(K5e,"compile");function ikr(t,e,r){var n=Xvt.call(this,t,e,r);return n>=0?{index:n,compiling:!0}:(n=this._compilations.length,this._compilations[n]={schema:t,root:e,baseId:r},{index:n,compiling:!1})}s(ikr,"checkCompiling");function okr(t,e,r){var n=Xvt.call(this,t,e,r);n>=0&&this._compilations.splice(n,1)}s(okr,"endCompiling");function Xvt(t,e,r){for(var n=0;n<this._compilations.length;n++){var i=this._compilations[n];if(i.schema==t&&i.root==e&&i.baseId==r)return n}return-1}s(Xvt,"compIndex");function skr(t,e){return"var pattern"+t+" = new RegExp("+uue.toQuotedString(e[t])+");"}s(skr,"patternCode");function akr(t){return"var default"+t+" = defaults["+t+"];"}s(akr,"defaultCode");function ckr(t,e){return e[t]===void 0?"":"var refVal"+t+" = refVal["+t+"];"}s(ckr,"refValCode");function lkr(t){return"var customRule"+t+" = customRules["+t+"];"}s(lkr,"customRuleCode");function lue(t,e){if(!t.length)return"";for(var r="",n=0;n<t.length;n++)r+=e(n,t);return r}s(lue,"vars")});var rxt=H((RMo,txt)=>{"use strict";d();var due=txt.exports=s(function(){this._cache={}},"Cache");due.prototype.put=s(function(e,r){this._cache[e]=r},"Cache_put");due.prototype.get=s(function(e){return this._cache[e]},"Cache_get");due.prototype.del=s(function(e){delete this._cache[e]},"Cache_del");due.prototype.clear=s(function(){this._cache={}},"Cache_clear")});var mxt=H((DMo,pxt)=>{"use strict";d();var ukr=o5(),dkr=/^(\d\d\d\d)-(\d\d)-(\d\d)$/,fkr=[0,31,28,31,30,31,30,31,31,30,31,30,31],pkr=/^(\d\d):(\d\d):(\d\d)(\.\d+)?(z|[+-]\d\d(?::?\d\d)?)?$/i,nxt=/^(?=.{1,253}\.?$)[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[-0-9a-z]{0,61}[0-9a-z])?)*\.?$/i,mkr=/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)(?:\?(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i,hkr=/^(?:[a-z][a-z0-9+\-.]*:)?(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'"()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?(?:\?(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i,ixt=/^(?:(?:[^\x00-\x20"'<>%\\^`{|}]|%[0-9a-f]{2})|\{[+#./;?&=,!@|]?(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?(?:,(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?)*\})*$/i,oxt=/^(?:(?:http[s\u017F]?|ftp):\/\/)(?:(?:[\0-\x08\x0E-\x1F!-\x9F\xA1-\u167F\u1681-\u1FFF\u200B-\u2027\u202A-\u202E\u2030-\u205E\u2060-\u2FFF\u3001-\uD7FF\uE000-\uFEFE\uFF00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+(?::(?:[\0-\x08\x0E-\x1F!-\x9F\xA1-\u167F\u1681-\u1FFF\u200B-\u2027\u202A-\u202E\u2030-\u205E\u2060-\u2FFF\u3001-\uD7FF\uE000-\uFEFE\uFF00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*)?@)?(?:(?!10(?:\.[0-9]{1,3}){3})(?!127(?:\.[0-9]{1,3}){3})(?!169\.254(?:\.[0-9]{1,3}){2})(?!192\.168(?:\.[0-9]{1,3}){2})(?!172\.(?:1[6-9]|2[0-9]|3[01])(?:\.[0-9]{1,3}){2})(?:[1-9][0-9]?|1[0-9][0-9]|2[01][0-9]|22[0-3])(?:\.(?:1?[0-9]{1,2}|2[0-4][0-9]|25[0-5])){2}(?:\.(?:[1-9][0-9]?|1[0-9][0-9]|2[0-4][0-9]|25[0-4]))|(?:(?:(?:[0-9a-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+-)*(?:[0-9a-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+)(?:\.(?:(?:[0-9a-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+-)*(?:[0-9a-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+)*(?:\.(?:(?:[a-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]){2,})))(?::[0-9]{2,5})?(?:\/(?:[\0-\x08\x0E-\x1F!-\x9F\xA1-\u167F\u1681-\u1FFF\u200B-\u2027\u202A-\u202E\u2030-\u205E\u2060-\u2FFF\u3001-\uD7FF\uE000-\uFEFE\uFF00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*)?$/i,sxt=/^(?:urn:uuid:)?[0-9a-f]{8}-(?:[0-9a-f]{4}-){3}[0-9a-f]{12}$/i,axt=/^(?:\/(?:[^~/]|~0|~1)*)*$/,cxt=/^#(?:\/(?:[a-z0-9_\-.!$&'()*+,;:=@]|%[0-9a-f]{2}|~0|~1)*)*$/i,lxt=/^(?:0|[1-9][0-9]*)(?:#|(?:\/(?:[^~/]|~0|~1)*)*)$/;pxt.exports=fue;function fue(t){return t=t=="full"?"full":"fast",ukr.copy(fue[t])}s(fue,"formats");fue.fast={date:/^\d\d\d\d-[0-1]\d-[0-3]\d$/,time:/^(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)?$/i,"date-time":/^\d\d\d\d-[0-1]\d-[0-3]\d[t\s](?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)$/i,uri:/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/)?[^\s]*$/i,"uri-reference":/^(?:(?:[a-z][a-z0-9+\-.]*:)?\/?\/)?(?:[^\\\s#][^\s#]*)?(?:#[^\\\s]*)?$/i,"uri-template":ixt,url:oxt,email:/^[a-z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?)*$/i,hostname:nxt,ipv4:/^(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)$/,ipv6:/^\s*(?:(?:(?:[0-9a-f]{1,4}:){7}(?:[0-9a-f]{1,4}|:))|(?:(?:[0-9a-f]{1,4}:){6}(?::[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){5}(?:(?:(?::[0-9a-f]{1,4}){1,2})|:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){4}(?:(?:(?::[0-9a-f]{1,4}){1,3})|(?:(?::[0-9a-f]{1,4})?:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){3}(?:(?:(?::[0-9a-f]{1,4}){1,4})|(?:(?::[0-9a-f]{1,4}){0,2}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){2}(?:(?:(?::[0-9a-f]{1,4}){1,5})|(?:(?::[0-9a-f]{1,4}){0,3}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){1}(?:(?:(?::[0-9a-f]{1,4}){1,6})|(?:(?::[0-9a-f]{1,4}){0,4}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?::(?:(?:(?::[0-9a-f]{1,4}){1,7})|(?:(?::[0-9a-f]{1,4}){0,5}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(?:%.+)?\s*$/i,regex:fxt,uuid:sxt,"json-pointer":axt,"json-pointer-uri-fragment":cxt,"relative-json-pointer":lxt};fue.full={date:uxt,time:dxt,"date-time":ykr,uri:vkr,"uri-reference":hkr,"uri-template":ixt,url:oxt,email:/^[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?$/i,hostname:nxt,ipv4:/^(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)$/,ipv6:/^\s*(?:(?:(?:[0-9a-f]{1,4}:){7}(?:[0-9a-f]{1,4}|:))|(?:(?:[0-9a-f]{1,4}:){6}(?::[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){5}(?:(?:(?::[0-9a-f]{1,4}){1,2})|:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){4}(?:(?:(?::[0-9a-f]{1,4}){1,3})|(?:(?::[0-9a-f]{1,4})?:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){3}(?:(?:(?::[0-9a-f]{1,4}){1,4})|(?:(?::[0-9a-f]{1,4}){0,2}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){2}(?:(?:(?::[0-9a-f]{1,4}){1,5})|(?:(?::[0-9a-f]{1,4}){0,3}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){1}(?:(?:(?::[0-9a-f]{1,4}){1,6})|(?:(?::[0-9a-f]{1,4}){0,4}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?::(?:(?:(?::[0-9a-f]{1,4}){1,7})|(?:(?::[0-9a-f]{1,4}){0,5}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(?:%.+)?\s*$/i,regex:fxt,uuid:sxt,"json-pointer":axt,"json-pointer-uri-fragment":cxt,"relative-json-pointer":lxt};function gkr(t){return t%4===0&&(t%100!==0||t%400===0)}s(gkr,"isLeapYear");function uxt(t){var e=t.match(dkr);if(!e)return!1;var r=+e[1],n=+e[2],i=+e[3];return n>=1&&n<=12&&i>=1&&i<=(n==2&&gkr(r)?29:fkr[n])}s(uxt,"date");function dxt(t,e){var r=t.match(pkr);if(!r)return!1;var n=r[1],i=r[2],o=r[3],a=r[5];return(n<=23&&i<=59&&o<=59||n==23&&i==59&&o==60)&&(!e||a)}s(dxt,"time");var Akr=/t|\s/i;function ykr(t){var e=t.split(Akr);return e.length==2&&uxt(e[0])&&dxt(e[1],!0)}s(ykr,"date_time");var Ckr=/\/|:/;function vkr(t){return Ckr.test(t)&&mkr.test(t)}s(vkr,"uri");var xkr=/[^\\]\\Z/;function fxt(t){if(xkr.test(t))return!1;try{return new RegExp(t),!0}catch{return!1}}s(fxt,"regex")});var gxt=H((MMo,hxt)=>{"use strict";d();hxt.exports=s(function(e,r,n){var i=" ",o=e.level,a=e.dataLevel,c=e.schema[r],l=e.errSchemaPath+"/"+r,u=!e.opts.allErrors,f="data"+(a||""),p="valid"+o,m,h;if(c=="#"||c=="#/")e.isRoot?(m=e.async,h="validate"):(m=e.root.schema.$async===!0,h="root.refVal[0]");else{var g=e.resolveRef(e.baseId,c,e.isRoot);if(g===void 0){var A=e.MissingRefError.message(e.baseId,c);if(e.opts.missingRefs=="fail"){e.logger.error(A);var y=y||[];y.push(i),i="",e.createErrors!==!1?(i+=" { keyword: '$ref' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { ref: '"+e.util.escapeQuotes(c)+"' } ",e.opts.messages!==!1&&(i+=" , message: 'can\\'t resolve reference "+e.util.escapeQuotes(c)+"' "),e.opts.verbose&&(i+=" , schema: "+e.util.toQuotedString(c)+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+f+" "),i+=" } "):i+=" {} ";var E=i;i=y.pop(),!e.compositeRule&&u?e.async?i+=" throw new ValidationError(["+E+"]); ":i+=" validate.errors = ["+E+"]; return false; ":i+=" var err = "+E+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",u&&(i+=" if (false) { ")}else if(e.opts.missingRefs=="ignore")e.logger.warn(A),u&&(i+=" if (true) { ");else throw new e.MissingRefError(e.baseId,c,A)}else if(g.inline){var b=e.util.copy(e);b.level++;var S="valid"+b.level;b.schema=g.schema,b.schemaPath="",b.errSchemaPath=c;var R=e.validate(b).replace(/validate\.schema/g,g.code);i+=" "+R+" ",u&&(i+=" if ("+S+") { ")}else m=g.$async===!0||e.async&&g.$async!==!1,h=g.code}if(h){var y=y||[];y.push(i),i="",e.opts.passContext?i+=" "+h+".call(this, ":i+=" "+h+"( ",i+=" "+f+", (dataPath || '')",e.errorPath!='""'&&(i+=" + "+e.errorPath);var B=a?"data"+(a-1||""):"parentData",L=a?e.dataPathArr[a]:"parentDataProperty";i+=" , "+B+" , "+L+", rootData)  ";var O=i;if(i=y.pop(),m){if(!e.async)throw new Error("async schema referenced by sync schema");u&&(i+=" var "+p+"; "),i+=" try { await "+O+"; ",u&&(i+=" "+p+" = true; "),i+=" } catch (e) { if (!(e instanceof ValidationError)) throw e; if (vErrors === null) vErrors = e.errors; else vErrors = vErrors.concat(e.errors); errors = vErrors.length; ",u&&(i+=" "+p+" = false; "),i+=" } ",u&&(i+=" if ("+p+") { ")}else i+=" if (!"+O+") { if (vErrors === null) vErrors = "+h+".errors; else vErrors = vErrors.concat("+h+".errors); errors = vErrors.length; } ",u&&(i+=" else { ")}return i},"generate_ref")});var yxt=H((OMo,Axt)=>{"use strict";d();Axt.exports=s(function(e,r,n){var i=" ",o=e.schema[r],a=e.schemaPath+e.util.getProperty(r),c=e.errSchemaPath+"/"+r,l=!e.opts.allErrors,u=e.util.copy(e),f="";u.level++;var p="valid"+u.level,m=u.baseId,h=!0,g=o;if(g)for(var A,y=-1,E=g.length-1;y<E;)A=g[y+=1],(e.opts.strictKeywords?typeof A=="object"&&Object.keys(A).length>0||A===!1:e.util.schemaHasRules(A,e.RULES.all))&&(h=!1,u.schema=A,u.schemaPath=a+"["+y+"]",u.errSchemaPath=c+"/"+y,i+="  "+e.validate(u)+" ",u.baseId=m,l&&(i+=" if ("+p+") { ",f+="}"));return l&&(h?i+=" if (true) { ":i+=" "+f.slice(0,-1)+" "),i},"generate_allOf")});var vxt=H((qMo,Cxt)=>{"use strict";d();Cxt.exports=s(function(e,r,n){var i=" ",o=e.level,a=e.dataLevel,c=e.schema[r],l=e.schemaPath+e.util.getProperty(r),u=e.errSchemaPath+"/"+r,f=!e.opts.allErrors,p="data"+(a||""),m="valid"+o,h="errs__"+o,g=e.util.copy(e),A="";g.level++;var y="valid"+g.level,E=c.every(function(Y){return e.opts.strictKeywords?typeof Y=="object"&&Object.keys(Y).length>0||Y===!1:e.util.schemaHasRules(Y,e.RULES.all)});if(E){var b=g.baseId;i+=" var "+h+" = errors; var "+m+" = false;  ";var S=e.compositeRule;e.compositeRule=g.compositeRule=!0;var R=c;if(R)for(var B,L=-1,O=R.length-1;L<O;)B=R[L+=1],g.schema=B,g.schemaPath=l+"["+L+"]",g.errSchemaPath=u+"/"+L,i+="  "+e.validate(g)+" ",g.baseId=b,i+=" "+m+" = "+m+" || "+y+"; if (!"+m+") { ",A+="}";e.compositeRule=g.compositeRule=S,i+=" "+A+" if (!"+m+") {   var err =   ",e.createErrors!==!1?(i+=" { keyword: 'anyOf' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: {} ",e.opts.messages!==!1&&(i+=" , message: 'should match some schema in anyOf' "),e.opts.verbose&&(i+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),i+=" } "):i+=" {} ",i+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",!e.compositeRule&&f&&(e.async?i+=" throw new ValidationError(vErrors); ":i+=" validate.errors = vErrors; return false; "),i+=" } else {  errors = "+h+"; if (vErrors !== null) { if ("+h+") vErrors.length = "+h+"; else vErrors = null; } ",e.opts.allErrors&&(i+=" } ")}else f&&(i+=" if (true) { ");return i},"generate_anyOf")});var Ext=H((WMo,xxt)=>{"use strict";d();xxt.exports=s(function(e,r,n){var i=" ",o=e.schema[r],a=e.errSchemaPath+"/"+r,c=!e.opts.allErrors,l=e.util.toQuotedString(o);return e.opts.$comment===!0?i+=" console.log("+l+");":typeof e.opts.$comment=="function"&&(i+=" self._opts.$comment("+l+", "+e.util.toQuotedString(a)+", validate.root.schema);"),i},"generate_comment")});var Ixt=H((VMo,bxt)=>{"use strict";d();bxt.exports=s(function(e,r,n){var i=" ",o=e.level,a=e.dataLevel,c=e.schema[r],l=e.schemaPath+e.util.getProperty(r),u=e.errSchemaPath+"/"+r,f=!e.opts.allErrors,p="data"+(a||""),m="valid"+o,h=e.opts.$data&&c&&c.$data,g;h?(i+=" var schema"+o+" = "+e.util.getData(c.$data,a,e.dataPathArr)+"; ",g="schema"+o):g=c,h||(i+=" var schema"+o+" = validate.schema"+l+";"),i+="var "+m+" = equal("+p+", schema"+o+"); if (!"+m+") {   ";var A=A||[];A.push(i),i="",e.createErrors!==!1?(i+=" { keyword: 'const' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { allowedValue: schema"+o+" } ",e.opts.messages!==!1&&(i+=" , message: 'should be equal to constant' "),e.opts.verbose&&(i+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),i+=" } "):i+=" {} ";var y=i;return i=A.pop(),!e.compositeRule&&f?e.async?i+=" throw new ValidationError(["+y+"]); ":i+=" validate.errors = ["+y+"]; return false; ":i+=" var err = "+y+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",i+=" }",f&&(i+=" else { "),i},"generate_const")});var wxt=H((YMo,Txt)=>{"use strict";d();Txt.exports=s(function(e,r,n){var i=" ",o=e.level,a=e.dataLevel,c=e.schema[r],l=e.schemaPath+e.util.getProperty(r),u=e.errSchemaPath+"/"+r,f=!e.opts.allErrors,p="data"+(a||""),m="valid"+o,h="errs__"+o,g=e.util.copy(e),A="";g.level++;var y="valid"+g.level,E="i"+o,b=g.dataLevel=e.dataLevel+1,S="data"+b,R=e.baseId,B=e.opts.strictKeywords?typeof c=="object"&&Object.keys(c).length>0||c===!1:e.util.schemaHasRules(c,e.RULES.all);if(i+="var "+h+" = errors;var "+m+";",B){var L=e.compositeRule;e.compositeRule=g.compositeRule=!0,g.schema=c,g.schemaPath=l,g.errSchemaPath=u,i+=" var "+y+" = false; for (var "+E+" = 0; "+E+" < "+p+".length; "+E+"++) { ",g.errorPath=e.util.getPathExpr(e.errorPath,E,e.opts.jsonPointers,!0);var O=p+"["+E+"]";g.dataPathArr[b]=E;var Y=e.validate(g);g.baseId=R,e.util.varOccurences(Y,S)<2?i+=" "+e.util.varReplace(Y,S,O)+" ":i+=" var "+S+" = "+O+"; "+Y+" ",i+=" if ("+y+") break; }  ",e.compositeRule=g.compositeRule=L,i+=" "+A+" if (!"+y+") {"}else i+=" if ("+p+".length == 0) {";var V=V||[];V.push(i),i="",e.createErrors!==!1?(i+=" { keyword: 'contains' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: {} ",e.opts.messages!==!1&&(i+=" , message: 'should contain a valid item' "),e.opts.verbose&&(i+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),i+=" } "):i+=" {} ";var z=i;return i=V.pop(),!e.compositeRule&&f?e.async?i+=" throw new ValidationError(["+z+"]); ":i+=" validate.errors = ["+z+"]; return false; ":i+=" var err = "+z+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",i+=" } else { ",B&&(i+="  errors = "+h+"; if (vErrors !== null) { if ("+h+") vErrors.length = "+h+"; else vErrors = null; } "),e.opts.allErrors&&(i+=" } "),i},"generate_contains")});var _xt=H((ZMo,Sxt)=>{"use strict";d();Sxt.exports=s(function(e,r,n){var i=" ",o=e.level,a=e.dataLevel,c=e.schema[r],l=e.schemaPath+e.util.getProperty(r),u=e.errSchemaPath+"/"+r,f=!e.opts.allErrors,p="data"+(a||""),m="errs__"+o,h=e.util.copy(e),g="";h.level++;var A="valid"+h.level,y={},E={},b=e.opts.ownProperties;for(L in c)if(L!="__proto__"){var S=c[L],R=Array.isArray(S)?E:y;R[L]=S}i+="var "+m+" = errors;";var B=e.errorPath;i+="var missing"+o+";";for(var L in E)if(R=E[L],R.length){if(i+=" if ( "+p+e.util.getProperty(L)+" !== undefined ",b&&(i+=" && Object.prototype.hasOwnProperty.call("+p+", '"+e.util.escapeQuotes(L)+"') "),f){i+=" && ( ";var O=R;if(O)for(var Y,V=-1,z=O.length-1;V<z;){Y=O[V+=1],V&&(i+=" || ");var Q=e.util.getProperty(Y),U=p+Q;i+=" ( ( "+U+" === undefined ",b&&(i+=" || ! Object.prototype.hasOwnProperty.call("+p+", '"+e.util.escapeQuotes(Y)+"') "),i+=") && (missing"+o+" = "+e.util.toQuotedString(e.opts.jsonPointers?Y:Q)+") ) "}i+=")) {  ";var Z="missing"+o,J="' + "+Z+" + '";e.opts._errorDataPathProperty&&(e.errorPath=e.opts.jsonPointers?e.util.getPathExpr(B,Z,!0):B+" + "+Z);var j=j||[];j.push(i),i="",e.createErrors!==!1?(i+=" { keyword: 'dependencies' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { property: '"+e.util.escapeQuotes(L)+"', missingProperty: '"+J+"', depsCount: "+R.length+", deps: '"+e.util.escapeQuotes(R.length==1?R[0]:R.join(", "))+"' } ",e.opts.messages!==!1&&(i+=" , message: 'should have ",R.length==1?i+="property "+e.util.escapeQuotes(R[0]):i+="properties "+e.util.escapeQuotes(R.join(", ")),i+=" when property "+e.util.escapeQuotes(L)+" is present' "),e.opts.verbose&&(i+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),i+=" } "):i+=" {} ";var W=i;i=j.pop(),!e.compositeRule&&f?e.async?i+=" throw new ValidationError(["+W+"]); ":i+=" validate.errors = ["+W+"]; return false; ":i+=" var err = "+W+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; "}else{i+=" ) { ";var X=R;if(X)for(var Y,oe=-1,te=X.length-1;oe<te;){Y=X[oe+=1];var Q=e.util.getProperty(Y),J=e.util.escapeQuotes(Y),U=p+Q;e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPath(B,Y,e.opts.jsonPointers)),i+=" if ( "+U+" === undefined ",b&&(i+=" || ! Object.prototype.hasOwnProperty.call("+p+", '"+e.util.escapeQuotes(Y)+"') "),i+=") {  var err =   ",e.createErrors!==!1?(i+=" { keyword: 'dependencies' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { property: '"+e.util.escapeQuotes(L)+"', missingProperty: '"+J+"', depsCount: "+R.length+", deps: '"+e.util.escapeQuotes(R.length==1?R[0]:R.join(", "))+"' } ",e.opts.messages!==!1&&(i+=" , message: 'should have ",R.length==1?i+="property "+e.util.escapeQuotes(R[0]):i+="properties "+e.util.escapeQuotes(R.join(", ")),i+=" when property "+e.util.escapeQuotes(L)+" is present' "),e.opts.verbose&&(i+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),i+=" } "):i+=" {} ",i+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; } "}}i+=" }   ",f&&(g+="}",i+=" else { ")}e.errorPath=B;var re=h.baseId;for(var L in y){var S=y[L];(e.opts.strictKeywords?typeof S=="object"&&Object.keys(S).length>0||S===!1:e.util.schemaHasRules(S,e.RULES.all))&&(i+=" "+A+" = true; if ( "+p+e.util.getProperty(L)+" !== undefined ",b&&(i+=" && Object.prototype.hasOwnProperty.call("+p+", '"+e.util.escapeQuotes(L)+"') "),i+=") { ",h.schema=S,h.schemaPath=l+e.util.getProperty(L),h.errSchemaPath=u+"/"+e.util.escapeFragment(L),i+="  "+e.validate(h)+" ",h.baseId=re,i+=" }  ",f&&(i+=" if ("+A+") { ",g+="}"))}return f&&(i+="   "+g+" if ("+m+" == errors) {"),i},"generate_dependencies")});var kxt=H((rLo,Rxt)=>{"use strict";d();Rxt.exports=s(function(e,r,n){var i=" ",o=e.level,a=e.dataLevel,c=e.schema[r],l=e.schemaPath+e.util.getProperty(r),u=e.errSchemaPath+"/"+r,f=!e.opts.allErrors,p="data"+(a||""),m="valid"+o,h=e.opts.$data&&c&&c.$data,g;h?(i+=" var schema"+o+" = "+e.util.getData(c.$data,a,e.dataPathArr)+"; ",g="schema"+o):g=c;var A="i"+o,y="schema"+o;h||(i+=" var "+y+" = validate.schema"+l+";"),i+="var "+m+";",h&&(i+=" if (schema"+o+" === undefined) "+m+" = true; else if (!Array.isArray(schema"+o+")) "+m+" = false; else {"),i+=""+m+" = false;for (var "+A+"=0; "+A+"<"+y+".length; "+A+"++) if (equal("+p+", "+y+"["+A+"])) { "+m+" = true; break; }",h&&(i+="  }  "),i+=" if (!"+m+") {   ";var E=E||[];E.push(i),i="",e.createErrors!==!1?(i+=" { keyword: 'enum' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { allowedValues: schema"+o+" } ",e.opts.messages!==!1&&(i+=" , message: 'should be equal to one of the allowed values' "),e.opts.verbose&&(i+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),i+=" } "):i+=" {} ";var b=i;return i=E.pop(),!e.compositeRule&&f?e.async?i+=" throw new ValidationError(["+b+"]); ":i+=" validate.errors = ["+b+"]; return false; ":i+=" var err = "+b+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",i+=" }",f&&(i+=" else { "),i},"generate_enum")});var Dxt=H((oLo,Pxt)=>{"use strict";d();Pxt.exports=s(function(e,r,n){var i=" ",o=e.level,a=e.dataLevel,c=e.schema[r],l=e.schemaPath+e.util.getProperty(r),u=e.errSchemaPath+"/"+r,f=!e.opts.allErrors,p="data"+(a||"");if(e.opts.format===!1)return f&&(i+=" if (true) { "),i;var m=e.opts.$data&&c&&c.$data,h;m?(i+=" var schema"+o+" = "+e.util.getData(c.$data,a,e.dataPathArr)+"; ",h="schema"+o):h=c;var g=e.opts.unknownFormats,A=Array.isArray(g);if(m){var y="format"+o,E="isObject"+o,b="formatType"+o;i+=" var "+y+" = formats["+h+"]; var "+E+" = typeof "+y+" == 'object' && !("+y+" instanceof RegExp) && "+y+".validate; var "+b+" = "+E+" && "+y+".type || 'string'; if ("+E+") { ",e.async&&(i+=" var async"+o+" = "+y+".async; "),i+=" "+y+" = "+y+".validate; } if (  ",m&&(i+=" ("+h+" !== undefined && typeof "+h+" != 'string') || "),i+=" (",g!="ignore"&&(i+=" ("+h+" && !"+y+" ",A&&(i+=" && self._opts.unknownFormats.indexOf("+h+") == -1 "),i+=") || "),i+=" ("+y+" && "+b+" == '"+n+"' && !(typeof "+y+" == 'function' ? ",e.async?i+=" (async"+o+" ? await "+y+"("+p+") : "+y+"("+p+")) ":i+=" "+y+"("+p+") ",i+=" : "+y+".test("+p+"))))) {"}else{var y=e.formats[c];if(!y){if(g=="ignore")return e.logger.warn('unknown format "'+c+'" ignored in schema at path "'+e.errSchemaPath+'"'),f&&(i+=" if (true) { "),i;if(A&&g.indexOf(c)>=0)return f&&(i+=" if (true) { "),i;throw new Error('unknown format "'+c+'" is used in schema at path "'+e.errSchemaPath+'"')}var E=typeof y=="object"&&!(y instanceof RegExp)&&y.validate,b=E&&y.type||"string";if(E){var S=y.async===!0;y=y.validate}if(b!=n)return f&&(i+=" if (true) { "),i;if(S){if(!e.async)throw new Error("async format in sync schema");var R="formats"+e.util.getProperty(c)+".validate";i+=" if (!(await "+R+"("+p+"))) { "}else{i+=" if (! ";var R="formats"+e.util.getProperty(c);E&&(R+=".validate"),typeof y=="function"?i+=" "+R+"("+p+") ":i+=" "+R+".test("+p+") ",i+=") { "}}var B=B||[];B.push(i),i="",e.createErrors!==!1?(i+=" { keyword: 'format' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { format:  ",m?i+=""+h:i+=""+e.util.toQuotedString(c),i+="  } ",e.opts.messages!==!1&&(i+=` , message: 'should match format "`,m?i+="' + "+h+" + '":i+=""+e.util.escapeQuotes(c),i+=`"' `),e.opts.verbose&&(i+=" , schema:  ",m?i+="validate.schema"+l:i+=""+e.util.toQuotedString(c),i+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),i+=" } "):i+=" {} ";var L=i;return i=B.pop(),!e.compositeRule&&f?e.async?i+=" throw new ValidationError(["+L+"]); ":i+=" validate.errors = ["+L+"]; return false; ":i+=" var err = "+L+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",i+=" } ",f&&(i+=" else { "),i},"generate_format")});var Nxt=H((cLo,Bxt)=>{"use strict";d();Bxt.exports=s(function(e,r,n){var i=" ",o=e.level,a=e.dataLevel,c=e.schema[r],l=e.schemaPath+e.util.getProperty(r),u=e.errSchemaPath+"/"+r,f=!e.opts.allErrors,p="data"+(a||""),m="valid"+o,h="errs__"+o,g=e.util.copy(e);g.level++;var A="valid"+g.level,y=e.schema.then,E=e.schema.else,b=y!==void 0&&(e.opts.strictKeywords?typeof y=="object"&&Object.keys(y).length>0||y===!1:e.util.schemaHasRules(y,e.RULES.all)),S=E!==void 0&&(e.opts.strictKeywords?typeof E=="object"&&Object.keys(E).length>0||E===!1:e.util.schemaHasRules(E,e.RULES.all)),R=g.baseId;if(b||S){var B;g.createErrors=!1,g.schema=c,g.schemaPath=l,g.errSchemaPath=u,i+=" var "+h+" = errors; var "+m+" = true;  ";var L=e.compositeRule;e.compositeRule=g.compositeRule=!0,i+="  "+e.validate(g)+" ",g.baseId=R,g.createErrors=!0,i+="  errors = "+h+"; if (vErrors !== null) { if ("+h+") vErrors.length = "+h+"; else vErrors = null; }  ",e.compositeRule=g.compositeRule=L,b?(i+=" if ("+A+") {  ",g.schema=e.schema.then,g.schemaPath=e.schemaPath+".then",g.errSchemaPath=e.errSchemaPath+"/then",i+="  "+e.validate(g)+" ",g.baseId=R,i+=" "+m+" = "+A+"; ",b&&S?(B="ifClause"+o,i+=" var "+B+" = 'then'; "):B="'then'",i+=" } ",S&&(i+=" else { ")):i+=" if (!"+A+") { ",S&&(g.schema=e.schema.else,g.schemaPath=e.schemaPath+".else",g.errSchemaPath=e.errSchemaPath+"/else",i+="  "+e.validate(g)+" ",g.baseId=R,i+=" "+m+" = "+A+"; ",b&&S?(B="ifClause"+o,i+=" var "+B+" = 'else'; "):B="'else'",i+=" } "),i+=" if (!"+m+") {   var err =   ",e.createErrors!==!1?(i+=" { keyword: 'if' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { failingKeyword: "+B+" } ",e.opts.messages!==!1&&(i+=` , message: 'should match "' + `+B+` + '" schema' `),e.opts.verbose&&(i+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),i+=" } "):i+=" {} ",i+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",!e.compositeRule&&f&&(e.async?i+=" throw new ValidationError(vErrors); ":i+=" validate.errors = vErrors; return false; "),i+=" }   ",f&&(i+=" else { ")}else f&&(i+=" if (true) { ");return i},"generate_if")});var Lxt=H((dLo,Mxt)=>{"use strict";d();Mxt.exports=s(function(e,r,n){var i=" ",o=e.level,a=e.dataLevel,c=e.schema[r],l=e.schemaPath+e.util.getProperty(r),u=e.errSchemaPath+"/"+r,f=!e.opts.allErrors,p="data"+(a||""),m="valid"+o,h="errs__"+o,g=e.util.copy(e),A="";g.level++;var y="valid"+g.level,E="i"+o,b=g.dataLevel=e.dataLevel+1,S="data"+b,R=e.baseId;if(i+="var "+h+" = errors;var "+m+";",Array.isArray(c)){var B=e.schema.additionalItems;if(B===!1){i+=" "+m+" = "+p+".length <= "+c.length+"; ";var L=u;u=e.errSchemaPath+"/additionalItems",i+="  if (!"+m+") {   ";var O=O||[];O.push(i),i="",e.createErrors!==!1?(i+=" { keyword: 'additionalItems' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { limit: "+c.length+" } ",e.opts.messages!==!1&&(i+=" , message: 'should NOT have more than "+c.length+" items' "),e.opts.verbose&&(i+=" , schema: false , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),i+=" } "):i+=" {} ";var Y=i;i=O.pop(),!e.compositeRule&&f?e.async?i+=" throw new ValidationError(["+Y+"]); ":i+=" validate.errors = ["+Y+"]; return false; ":i+=" var err = "+Y+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",i+=" } ",u=L,f&&(A+="}",i+=" else { ")}var V=c;if(V){for(var z,Q=-1,U=V.length-1;Q<U;)if(z=V[Q+=1],e.opts.strictKeywords?typeof z=="object"&&Object.keys(z).length>0||z===!1:e.util.schemaHasRules(z,e.RULES.all)){i+=" "+y+" = true; if ("+p+".length > "+Q+") { ";var Z=p+"["+Q+"]";g.schema=z,g.schemaPath=l+"["+Q+"]",g.errSchemaPath=u+"/"+Q,g.errorPath=e.util.getPathExpr(e.errorPath,Q,e.opts.jsonPointers,!0),g.dataPathArr[b]=Q;var J=e.validate(g);g.baseId=R,e.util.varOccurences(J,S)<2?i+=" "+e.util.varReplace(J,S,Z)+" ":i+=" var "+S+" = "+Z+"; "+J+" ",i+=" }  ",f&&(i+=" if ("+y+") { ",A+="}")}}if(typeof B=="object"&&(e.opts.strictKeywords?typeof B=="object"&&Object.keys(B).length>0||B===!1:e.util.schemaHasRules(B,e.RULES.all))){g.schema=B,g.schemaPath=e.schemaPath+".additionalItems",g.errSchemaPath=e.errSchemaPath+"/additionalItems",i+=" "+y+" = true; if ("+p+".length > "+c.length+") {  for (var "+E+" = "+c.length+"; "+E+" < "+p+".length; "+E+"++) { ",g.errorPath=e.util.getPathExpr(e.errorPath,E,e.opts.jsonPointers,!0);var Z=p+"["+E+"]";g.dataPathArr[b]=E;var J=e.validate(g);g.baseId=R,e.util.varOccurences(J,S)<2?i+=" "+e.util.varReplace(J,S,Z)+" ":i+=" var "+S+" = "+Z+"; "+J+" ",f&&(i+=" if (!"+y+") break; "),i+=" } }  ",f&&(i+=" if ("+y+") { ",A+="}")}}else if(e.opts.strictKeywords?typeof c=="object"&&Object.keys(c).length>0||c===!1:e.util.schemaHasRules(c,e.RULES.all)){g.schema=c,g.schemaPath=l,g.errSchemaPath=u,i+="  for (var "+E+" = 0; "+E+" < "+p+".length; "+E+"++) { ",g.errorPath=e.util.getPathExpr(e.errorPath,E,e.opts.jsonPointers,!0);var Z=p+"["+E+"]";g.dataPathArr[b]=E;var J=e.validate(g);g.baseId=R,e.util.varOccurences(J,S)<2?i+=" "+e.util.varReplace(J,S,Z)+" ":i+=" var "+S+" = "+Z+"; "+J+" ",f&&(i+=" if (!"+y+") break; "),i+=" }"}return f&&(i+=" "+A+" if ("+h+" == errors) {"),i},"generate_items")});var Y5e=H((mLo,Fxt)=>{"use strict";d();Fxt.exports=s(function(e,r,n){var i=" ",o=e.level,a=e.dataLevel,c=e.schema[r],l=e.schemaPath+e.util.getProperty(r),u=e.errSchemaPath+"/"+r,f=!e.opts.allErrors,R,p="data"+(a||""),m=e.opts.$data&&c&&c.$data,h;m?(i+=" var schema"+o+" = "+e.util.getData(c.$data,a,e.dataPathArr)+"; ",h="schema"+o):h=c;var g=r=="maximum",A=g?"exclusiveMaximum":"exclusiveMinimum",y=e.schema[A],E=e.opts.$data&&y&&y.$data,b=g?"<":">",S=g?">":"<",R=void 0;if(!(m||typeof c=="number"||c===void 0))throw new Error(r+" must be number");if(!(E||y===void 0||typeof y=="number"||typeof y=="boolean"))throw new Error(A+" must be number or boolean");if(E){var B=e.util.getData(y.$data,a,e.dataPathArr),L="exclusive"+o,O="exclType"+o,Y="exclIsNumber"+o,V="op"+o,z="' + "+V+" + '";i+=" var schemaExcl"+o+" = "+B+"; ",B="schemaExcl"+o,i+=" var "+L+"; var "+O+" = typeof "+B+"; if ("+O+" != 'boolean' && "+O+" != 'undefined' && "+O+" != 'number') { ";var R=A,Q=Q||[];Q.push(i),i="",e.createErrors!==!1?(i+=" { keyword: '"+(R||"_exclusiveLimit")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: {} ",e.opts.messages!==!1&&(i+=" , message: '"+A+" should be boolean' "),e.opts.verbose&&(i+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),i+=" } "):i+=" {} ";var U=i;i=Q.pop(),!e.compositeRule&&f?e.async?i+=" throw new ValidationError(["+U+"]); ":i+=" validate.errors = ["+U+"]; return false; ":i+=" var err = "+U+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",i+=" } else if ( ",m&&(i+=" ("+h+" !== undefined && typeof "+h+" != 'number') || "),i+=" "+O+" == 'number' ? ( ("+L+" = "+h+" === undefined || "+B+" "+b+"= "+h+") ? "+p+" "+S+"= "+B+" : "+p+" "+S+" "+h+" ) : ( ("+L+" = "+B+" === true) ? "+p+" "+S+"= "+h+" : "+p+" "+S+" "+h+" ) || "+p+" !== "+p+") { var op"+o+" = "+L+" ? '"+b+"' : '"+b+"='; ",c===void 0&&(R=A,u=e.errSchemaPath+"/"+A,h=B,m=E)}else{var Y=typeof y=="number",z=b;if(Y&&m){var V="'"+z+"'";i+=" if ( ",m&&(i+=" ("+h+" !== undefined && typeof "+h+" != 'number') || "),i+=" ( "+h+" === undefined || "+y+" "+b+"= "+h+" ? "+p+" "+S+"= "+y+" : "+p+" "+S+" "+h+" ) || "+p+" !== "+p+") { "}else{Y&&c===void 0?(L=!0,R=A,u=e.errSchemaPath+"/"+A,h=y,S+="="):(Y&&(h=Math[g?"min":"max"](y,c)),y===(Y?h:!0)?(L=!0,R=A,u=e.errSchemaPath+"/"+A,S+="="):(L=!1,z+="="));var V="'"+z+"'";i+=" if ( ",m&&(i+=" ("+h+" !== undefined && typeof "+h+" != 'number') || "),i+=" "+p+" "+S+" "+h+" || "+p+" !== "+p+") { "}}R=R||r;var Q=Q||[];Q.push(i),i="",e.createErrors!==!1?(i+=" { keyword: '"+(R||"_limit")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { comparison: "+V+", limit: "+h+", exclusive: "+L+" } ",e.opts.messages!==!1&&(i+=" , message: 'should be "+z+" ",m?i+="' + "+h:i+=""+h+"'"),e.opts.verbose&&(i+=" , schema:  ",m?i+="validate.schema"+l:i+=""+c,i+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),i+=" } "):i+=" {} ";var U=i;return i=Q.pop(),!e.compositeRule&&f?e.async?i+=" throw new ValidationError(["+U+"]); ":i+=" validate.errors = ["+U+"]; return false; ":i+=" var err = "+U+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",i+=" } ",f&&(i+=" else { "),i},"generate__limit")});var J5e=H((ALo,Oxt)=>{"use strict";d();Oxt.exports=s(function(e,r,n){var i=" ",o=e.level,a=e.dataLevel,c=e.schema[r],l=e.schemaPath+e.util.getProperty(r),u=e.errSchemaPath+"/"+r,f=!e.opts.allErrors,A,p="data"+(a||""),m=e.opts.$data&&c&&c.$data,h;if(m?(i+=" var schema"+o+" = "+e.util.getData(c.$data,a,e.dataPathArr)+"; ",h="schema"+o):h=c,!(m||typeof c=="number"))throw new Error(r+" must be number");var g=r=="maxItems"?">":"<";i+="if ( ",m&&(i+=" ("+h+" !== undefined && typeof "+h+" != 'number') || "),i+=" "+p+".length "+g+" "+h+") { ";var A=r,y=y||[];y.push(i),i="",e.createErrors!==!1?(i+=" { keyword: '"+(A||"_limitItems")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { limit: "+h+" } ",e.opts.messages!==!1&&(i+=" , message: 'should NOT have ",r=="maxItems"?i+="more":i+="fewer",i+=" than ",m?i+="' + "+h+" + '":i+=""+c,i+=" items' "),e.opts.verbose&&(i+=" , schema:  ",m?i+="validate.schema"+l:i+=""+c,i+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),i+=" } "):i+=" {} ";var E=i;return i=y.pop(),!e.compositeRule&&f?e.async?i+=" throw new ValidationError(["+E+"]); ":i+=" validate.errors = ["+E+"]; return false; ":i+=" var err = "+E+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",i+="} ",f&&(i+=" else { "),i},"generate__limitItems")});var X5e=H((vLo,Qxt)=>{"use strict";d();Qxt.exports=s(function(e,r,n){var i=" ",o=e.level,a=e.dataLevel,c=e.schema[r],l=e.schemaPath+e.util.getProperty(r),u=e.errSchemaPath+"/"+r,f=!e.opts.allErrors,A,p="data"+(a||""),m=e.opts.$data&&c&&c.$data,h;if(m?(i+=" var schema"+o+" = "+e.util.getData(c.$data,a,e.dataPathArr)+"; ",h="schema"+o):h=c,!(m||typeof c=="number"))throw new Error(r+" must be number");var g=r=="maxLength"?">":"<";i+="if ( ",m&&(i+=" ("+h+" !== undefined && typeof "+h+" != 'number') || "),e.opts.unicode===!1?i+=" "+p+".length ":i+=" ucs2length("+p+") ",i+=" "+g+" "+h+") { ";var A=r,y=y||[];y.push(i),i="",e.createErrors!==!1?(i+=" { keyword: '"+(A||"_limitLength")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { limit: "+h+" } ",e.opts.messages!==!1&&(i+=" , message: 'should NOT be ",r=="maxLength"?i+="longer":i+="shorter",i+=" than ",m?i+="' + "+h+" + '":i+=""+c,i+=" characters' "),e.opts.verbose&&(i+=" , schema:  ",m?i+="validate.schema"+l:i+=""+c,i+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),i+=" } "):i+=" {} ";var E=i;return i=y.pop(),!e.compositeRule&&f?e.async?i+=" throw new ValidationError(["+E+"]); ":i+=" validate.errors = ["+E+"]; return false; ":i+=" var err = "+E+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",i+="} ",f&&(i+=" else { "),i},"generate__limitLength")});var Z5e=H((bLo,Uxt)=>{"use strict";d();Uxt.exports=s(function(e,r,n){var i=" ",o=e.level,a=e.dataLevel,c=e.schema[r],l=e.schemaPath+e.util.getProperty(r),u=e.errSchemaPath+"/"+r,f=!e.opts.allErrors,A,p="data"+(a||""),m=e.opts.$data&&c&&c.$data,h;if(m?(i+=" var schema"+o+" = "+e.util.getData(c.$data,a,e.dataPathArr)+"; ",h="schema"+o):h=c,!(m||typeof c=="number"))throw new Error(r+" must be number");var g=r=="maxProperties"?">":"<";i+="if ( ",m&&(i+=" ("+h+" !== undefined && typeof "+h+" != 'number') || "),i+=" Object.keys("+p+").length "+g+" "+h+") { ";var A=r,y=y||[];y.push(i),i="",e.createErrors!==!1?(i+=" { keyword: '"+(A||"_limitProperties")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { limit: "+h+" } ",e.opts.messages!==!1&&(i+=" , message: 'should NOT have ",r=="maxProperties"?i+="more":i+="fewer",i+=" than ",m?i+="' + "+h+" + '":i+=""+c,i+=" properties' "),e.opts.verbose&&(i+=" , schema:  ",m?i+="validate.schema"+l:i+=""+c,i+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),i+=" } "):i+=" {} ";var E=i;return i=y.pop(),!e.compositeRule&&f?e.async?i+=" throw new ValidationError(["+E+"]); ":i+=" validate.errors = ["+E+"]; return false; ":i+=" var err = "+E+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",i+="} ",f&&(i+=" else { "),i},"generate__limitProperties")});var Hxt=H((wLo,qxt)=>{"use strict";d();qxt.exports=s(function(e,r,n){var i=" ",o=e.level,a=e.dataLevel,c=e.schema[r],l=e.schemaPath+e.util.getProperty(r),u=e.errSchemaPath+"/"+r,f=!e.opts.allErrors,p="data"+(a||""),m=e.opts.$data&&c&&c.$data,h;if(m?(i+=" var schema"+o+" = "+e.util.getData(c.$data,a,e.dataPathArr)+"; ",h="schema"+o):h=c,!(m||typeof c=="number"))throw new Error(r+" must be number");i+="var division"+o+";if (",m&&(i+=" "+h+" !== undefined && ( typeof "+h+" != 'number' || "),i+=" (division"+o+" = "+p+" / "+h+", ",e.opts.multipleOfPrecision?i+=" Math.abs(Math.round(division"+o+") - division"+o+") > 1e-"+e.opts.multipleOfPrecision+" ":i+=" division"+o+" !== parseInt(division"+o+") ",i+=" ) ",m&&(i+="  )  "),i+=" ) {   ";var g=g||[];g.push(i),i="",e.createErrors!==!1?(i+=" { keyword: 'multipleOf' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { multipleOf: "+h+" } ",e.opts.messages!==!1&&(i+=" , message: 'should be multiple of ",m?i+="' + "+h:i+=""+h+"'"),e.opts.verbose&&(i+=" , schema:  ",m?i+="validate.schema"+l:i+=""+c,i+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),i+=" } "):i+=" {} ";var A=i;return i=g.pop(),!e.compositeRule&&f?e.async?i+=" throw new ValidationError(["+A+"]); ":i+=" validate.errors = ["+A+"]; return false; ":i+=" var err = "+A+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",i+="} ",f&&(i+=" else { "),i},"generate_multipleOf")});var Wxt=H((RLo,$xt)=>{"use strict";d();$xt.exports=s(function(e,r,n){var i=" ",o=e.level,a=e.dataLevel,c=e.schema[r],l=e.schemaPath+e.util.getProperty(r),u=e.errSchemaPath+"/"+r,f=!e.opts.allErrors,p="data"+(a||""),m="errs__"+o,h=e.util.copy(e);h.level++;var g="valid"+h.level;if(e.opts.strictKeywords?typeof c=="object"&&Object.keys(c).length>0||c===!1:e.util.schemaHasRules(c,e.RULES.all)){h.schema=c,h.schemaPath=l,h.errSchemaPath=u,i+=" var "+m+" = errors;  ";var A=e.compositeRule;e.compositeRule=h.compositeRule=!0,h.createErrors=!1;var y;h.opts.allErrors&&(y=h.opts.allErrors,h.opts.allErrors=!1),i+=" "+e.validate(h)+" ",h.createErrors=!0,y&&(h.opts.allErrors=y),e.compositeRule=h.compositeRule=A,i+=" if ("+g+") {   ";var E=E||[];E.push(i),i="",e.createErrors!==!1?(i+=" { keyword: 'not' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: {} ",e.opts.messages!==!1&&(i+=" , message: 'should NOT be valid' "),e.opts.verbose&&(i+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),i+=" } "):i+=" {} ";var b=i;i=E.pop(),!e.compositeRule&&f?e.async?i+=" throw new ValidationError(["+b+"]); ":i+=" validate.errors = ["+b+"]; return false; ":i+=" var err = "+b+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",i+=" } else {  errors = "+m+"; if (vErrors !== null) { if ("+m+") vErrors.length = "+m+"; else vErrors = null; } ",e.opts.allErrors&&(i+=" } ")}else i+="  var err =   ",e.createErrors!==!1?(i+=" { keyword: 'not' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: {} ",e.opts.messages!==!1&&(i+=" , message: 'should NOT be valid' "),e.opts.verbose&&(i+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),i+=" } "):i+=" {} ",i+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",f&&(i+=" if (false) { ");return i},"generate_not")});var Gxt=H((DLo,jxt)=>{"use strict";d();jxt.exports=s(function(e,r,n){var i=" ",o=e.level,a=e.dataLevel,c=e.schema[r],l=e.schemaPath+e.util.getProperty(r),u=e.errSchemaPath+"/"+r,f=!e.opts.allErrors,p="data"+(a||""),m="valid"+o,h="errs__"+o,g=e.util.copy(e),A="";g.level++;var y="valid"+g.level,E=g.baseId,b="prevValid"+o,S="passingSchemas"+o;i+="var "+h+" = errors , "+b+" = false , "+m+" = false , "+S+" = null; ";var R=e.compositeRule;e.compositeRule=g.compositeRule=!0;var B=c;if(B)for(var L,O=-1,Y=B.length-1;O<Y;)L=B[O+=1],(e.opts.strictKeywords?typeof L=="object"&&Object.keys(L).length>0||L===!1:e.util.schemaHasRules(L,e.RULES.all))?(g.schema=L,g.schemaPath=l+"["+O+"]",g.errSchemaPath=u+"/"+O,i+="  "+e.validate(g)+" ",g.baseId=E):i+=" var "+y+" = true; ",O&&(i+=" if ("+y+" && "+b+") { "+m+" = false; "+S+" = ["+S+", "+O+"]; } else { ",A+="}"),i+=" if ("+y+") { "+m+" = "+b+" = true; "+S+" = "+O+"; }";return e.compositeRule=g.compositeRule=R,i+=""+A+"if (!"+m+") {   var err =   ",e.createErrors!==!1?(i+=" { keyword: 'oneOf' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { passingSchemas: "+S+" } ",e.opts.messages!==!1&&(i+=" , message: 'should match exactly one schema in oneOf' "),e.opts.verbose&&(i+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),i+=" } "):i+=" {} ",i+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",!e.compositeRule&&f&&(e.async?i+=" throw new ValidationError(vErrors); ":i+=" validate.errors = vErrors; return false; "),i+="} else {  errors = "+h+"; if (vErrors !== null) { if ("+h+") vErrors.length = "+h+"; else vErrors = null; }",e.opts.allErrors&&(i+=" } "),i},"generate_oneOf")});var zxt=H((MLo,Vxt)=>{"use strict";d();Vxt.exports=s(function(e,r,n){var i=" ",o=e.level,a=e.dataLevel,c=e.schema[r],l=e.schemaPath+e.util.getProperty(r),u=e.errSchemaPath+"/"+r,f=!e.opts.allErrors,p="data"+(a||""),m=e.opts.$data&&c&&c.$data,h;m?(i+=" var schema"+o+" = "+e.util.getData(c.$data,a,e.dataPathArr)+"; ",h="schema"+o):h=c;var g=m?"(new RegExp("+h+"))":e.usePattern(c);i+="if ( ",m&&(i+=" ("+h+" !== undefined && typeof "+h+" != 'string') || "),i+=" !"+g+".test("+p+") ) {   ";var A=A||[];A.push(i),i="",e.createErrors!==!1?(i+=" { keyword: 'pattern' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { pattern:  ",m?i+=""+h:i+=""+e.util.toQuotedString(c),i+="  } ",e.opts.messages!==!1&&(i+=` , message: 'should match pattern "`,m?i+="' + "+h+" + '":i+=""+e.util.escapeQuotes(c),i+=`"' `),e.opts.verbose&&(i+=" , schema:  ",m?i+="validate.schema"+l:i+=""+e.util.toQuotedString(c),i+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),i+=" } "):i+=" {} ";var y=i;return i=A.pop(),!e.compositeRule&&f?e.async?i+=" throw new ValidationError(["+y+"]); ":i+=" validate.errors = ["+y+"]; return false; ":i+=" var err = "+y+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",i+="} ",f&&(i+=" else { "),i},"generate_pattern")});var Yxt=H((OLo,Kxt)=>{"use strict";d();Kxt.exports=s(function(e,r,n){var i=" ",o=e.level,a=e.dataLevel,c=e.schema[r],l=e.schemaPath+e.util.getProperty(r),u=e.errSchemaPath+"/"+r,f=!e.opts.allErrors,p="data"+(a||""),m="errs__"+o,h=e.util.copy(e),g="";h.level++;var A="valid"+h.level,y="key"+o,E="idx"+o,b=h.dataLevel=e.dataLevel+1,S="data"+b,R="dataProperties"+o,B=Object.keys(c||{}).filter(oe),L=e.schema.patternProperties||{},O=Object.keys(L).filter(oe),Y=e.schema.additionalProperties,V=B.length||O.length,z=Y===!1,Q=typeof Y=="object"&&Object.keys(Y).length,U=e.opts.removeAdditional,Z=z||Q||U,J=e.opts.ownProperties,j=e.baseId,W=e.schema.required;if(W&&!(e.opts.$data&&W.$data)&&W.length<e.opts.loopRequired)var X=e.util.toHash(W);function oe(Br){return Br!=="__proto__"}if(s(oe,"notProto"),i+="var "+m+" = errors;var "+A+" = true;",J&&(i+=" var "+R+" = undefined;"),Z){if(J?i+=" "+R+" = "+R+" || Object.keys("+p+"); for (var "+E+"=0; "+E+"<"+R+".length; "+E+"++) { var "+y+" = "+R+"["+E+"]; ":i+=" for (var "+y+" in "+p+") { ",V){if(i+=" var isAdditional"+o+" = !(false ",B.length)if(B.length>8)i+=" || validate.schema"+l+".hasOwnProperty("+y+") ";else{var te=B;if(te)for(var re,pe=-1,Ae=te.length-1;pe<Ae;)re=te[pe+=1],i+=" || "+y+" == "+e.util.toQuotedString(re)+" "}if(O.length){var Oe=O;if(Oe)for(var Te,Je=-1,Fe=Oe.length-1;Je<Fe;)Te=Oe[Je+=1],i+=" || "+e.usePattern(Te)+".test("+y+") "}i+=" ); if (isAdditional"+o+") { "}if(U=="all")i+=" delete "+p+"["+y+"]; ";else{var lt=e.errorPath,_t="' + "+y+" + '";if(e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPathExpr(e.errorPath,y,e.opts.jsonPointers)),z)if(U)i+=" delete "+p+"["+y+"]; ";else{i+=" "+A+" = false; ";var xt=u;u=e.errSchemaPath+"/additionalProperties";var gt=gt||[];gt.push(i),i="",e.createErrors!==!1?(i+=" { keyword: 'additionalProperties' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { additionalProperty: '"+_t+"' } ",e.opts.messages!==!1&&(i+=" , message: '",e.opts._errorDataPathProperty?i+="is an invalid additional property":i+="should NOT have additional properties",i+="' "),e.opts.verbose&&(i+=" , schema: false , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),i+=" } "):i+=" {} ";var ue=i;i=gt.pop(),!e.compositeRule&&f?e.async?i+=" throw new ValidationError(["+ue+"]); ":i+=" validate.errors = ["+ue+"]; return false; ":i+=" var err = "+ue+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",u=xt,f&&(i+=" break; ")}else if(Q)if(U=="failing"){i+=" var "+m+" = errors;  ";var Ue=e.compositeRule;e.compositeRule=h.compositeRule=!0,h.schema=Y,h.schemaPath=e.schemaPath+".additionalProperties",h.errSchemaPath=e.errSchemaPath+"/additionalProperties",h.errorPath=e.opts._errorDataPathProperty?e.errorPath:e.util.getPathExpr(e.errorPath,y,e.opts.jsonPointers);var ye=p+"["+y+"]";h.dataPathArr[b]=y;var $e=e.validate(h);h.baseId=j,e.util.varOccurences($e,S)<2?i+=" "+e.util.varReplace($e,S,ye)+" ":i+=" var "+S+" = "+ye+"; "+$e+" ",i+=" if (!"+A+") { errors = "+m+"; if (validate.errors !== null) { if (errors) validate.errors.length = errors; else validate.errors = null; } delete "+p+"["+y+"]; }  ",e.compositeRule=h.compositeRule=Ue}else{h.schema=Y,h.schemaPath=e.schemaPath+".additionalProperties",h.errSchemaPath=e.errSchemaPath+"/additionalProperties",h.errorPath=e.opts._errorDataPathProperty?e.errorPath:e.util.getPathExpr(e.errorPath,y,e.opts.jsonPointers);var ye=p+"["+y+"]";h.dataPathArr[b]=y;var $e=e.validate(h);h.baseId=j,e.util.varOccurences($e,S)<2?i+=" "+e.util.varReplace($e,S,ye)+" ":i+=" var "+S+" = "+ye+"; "+$e+" ",f&&(i+=" if (!"+A+") break; ")}e.errorPath=lt}V&&(i+=" } "),i+=" }  ",f&&(i+=" if ("+A+") { ",g+="}")}var ae=e.opts.useDefaults&&!e.compositeRule;if(B.length){var le=B;if(le)for(var re,qe=-1,Ne=le.length-1;qe<Ne;){re=le[qe+=1];var Ee=c[re];if(e.opts.strictKeywords?typeof Ee=="object"&&Object.keys(Ee).length>0||Ee===!1:e.util.schemaHasRules(Ee,e.RULES.all)){var je=e.util.getProperty(re),ye=p+je,tt=ae&&Ee.default!==void 0;h.schema=Ee,h.schemaPath=l+je,h.errSchemaPath=u+"/"+e.util.escapeFragment(re),h.errorPath=e.util.getPath(e.errorPath,re,e.opts.jsonPointers),h.dataPathArr[b]=e.util.toQuotedString(re);var $e=e.validate(h);if(h.baseId=j,e.util.varOccurences($e,S)<2){$e=e.util.varReplace($e,S,ye);var mt=ye}else{var mt=S;i+=" var "+S+" = "+ye+"; "}if(tt)i+=" "+$e+" ";else{if(X&&X[re]){i+=" if ( "+mt+" === undefined ",J&&(i+=" || ! Object.prototype.hasOwnProperty.call("+p+", '"+e.util.escapeQuotes(re)+"') "),i+=") { "+A+" = false; ";var lt=e.errorPath,xt=u,Ft=e.util.escapeQuotes(re);e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPath(lt,re,e.opts.jsonPointers)),u=e.errSchemaPath+"/required";var gt=gt||[];gt.push(i),i="",e.createErrors!==!1?(i+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { missingProperty: '"+Ft+"' } ",e.opts.messages!==!1&&(i+=" , message: '",e.opts._errorDataPathProperty?i+="is a required property":i+="should have required property \\'"+Ft+"\\'",i+="' "),e.opts.verbose&&(i+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),i+=" } "):i+=" {} ";var ue=i;i=gt.pop(),!e.compositeRule&&f?e.async?i+=" throw new ValidationError(["+ue+"]); ":i+=" validate.errors = ["+ue+"]; return false; ":i+=" var err = "+ue+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",u=xt,e.errorPath=lt,i+=" } else { "}else f?(i+=" if ( "+mt+" === undefined ",J&&(i+=" || ! Object.prototype.hasOwnProperty.call("+p+", '"+e.util.escapeQuotes(re)+"') "),i+=") { "+A+" = true; } else { "):(i+=" if ("+mt+" !== undefined ",J&&(i+=" &&   Object.prototype.hasOwnProperty.call("+p+", '"+e.util.escapeQuotes(re)+"') "),i+=" ) { ");i+=" "+$e+" } "}}f&&(i+=" if ("+A+") { ",g+="}")}}if(O.length){var Jt=O;if(Jt)for(var Te,Qt=-1,zr=Jt.length-1;Qt<zr;){Te=Jt[Qt+=1];var Ee=L[Te];if(e.opts.strictKeywords?typeof Ee=="object"&&Object.keys(Ee).length>0||Ee===!1:e.util.schemaHasRules(Ee,e.RULES.all)){h.schema=Ee,h.schemaPath=e.schemaPath+".patternProperties"+e.util.getProperty(Te),h.errSchemaPath=e.errSchemaPath+"/patternProperties/"+e.util.escapeFragment(Te),J?i+=" "+R+" = "+R+" || Object.keys("+p+"); for (var "+E+"=0; "+E+"<"+R+".length; "+E+"++) { var "+y+" = "+R+"["+E+"]; ":i+=" for (var "+y+" in "+p+") { ",i+=" if ("+e.usePattern(Te)+".test("+y+")) { ",h.errorPath=e.util.getPathExpr(e.errorPath,y,e.opts.jsonPointers);var ye=p+"["+y+"]";h.dataPathArr[b]=y;var $e=e.validate(h);h.baseId=j,e.util.varOccurences($e,S)<2?i+=" "+e.util.varReplace($e,S,ye)+" ":i+=" var "+S+" = "+ye+"; "+$e+" ",f&&(i+=" if (!"+A+") break; "),i+=" } ",f&&(i+=" else "+A+" = true; "),i+=" }  ",f&&(i+=" if ("+A+") { ",g+="}")}}}return f&&(i+=" "+g+" if ("+m+" == errors) {"),i},"generate_properties")});var Xxt=H((qLo,Jxt)=>{"use strict";d();Jxt.exports=s(function(e,r,n){var i=" ",o=e.level,a=e.dataLevel,c=e.schema[r],l=e.schemaPath+e.util.getProperty(r),u=e.errSchemaPath+"/"+r,f=!e.opts.allErrors,p="data"+(a||""),m="errs__"+o,h=e.util.copy(e),g="";h.level++;var A="valid"+h.level;if(i+="var "+m+" = errors;",e.opts.strictKeywords?typeof c=="object"&&Object.keys(c).length>0||c===!1:e.util.schemaHasRules(c,e.RULES.all)){h.schema=c,h.schemaPath=l,h.errSchemaPath=u;var y="key"+o,E="idx"+o,b="i"+o,S="' + "+y+" + '",R=h.dataLevel=e.dataLevel+1,B="data"+R,L="dataProperties"+o,O=e.opts.ownProperties,Y=e.baseId;O&&(i+=" var "+L+" = undefined; "),O?i+=" "+L+" = "+L+" || Object.keys("+p+"); for (var "+E+"=0; "+E+"<"+L+".length; "+E+"++) { var "+y+" = "+L+"["+E+"]; ":i+=" for (var "+y+" in "+p+") { ",i+=" var startErrs"+o+" = errors; ";var V=y,z=e.compositeRule;e.compositeRule=h.compositeRule=!0;var Q=e.validate(h);h.baseId=Y,e.util.varOccurences(Q,B)<2?i+=" "+e.util.varReplace(Q,B,V)+" ":i+=" var "+B+" = "+V+"; "+Q+" ",e.compositeRule=h.compositeRule=z,i+=" if (!"+A+") { for (var "+b+"=startErrs"+o+"; "+b+"<errors; "+b+"++) { vErrors["+b+"].propertyName = "+y+"; }   var err =   ",e.createErrors!==!1?(i+=" { keyword: 'propertyNames' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { propertyName: '"+S+"' } ",e.opts.messages!==!1&&(i+=" , message: 'property name \\'"+S+"\\' is invalid' "),e.opts.verbose&&(i+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),i+=" } "):i+=" {} ",i+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",!e.compositeRule&&f&&(e.async?i+=" throw new ValidationError(vErrors); ":i+=" validate.errors = vErrors; return false; "),f&&(i+=" break; "),i+=" } }"}return f&&(i+=" "+g+" if ("+m+" == errors) {"),i},"generate_propertyNames")});var eEt=H((WLo,Zxt)=>{"use strict";d();Zxt.exports=s(function(e,r,n){var i=" ",o=e.level,a=e.dataLevel,c=e.schema[r],l=e.schemaPath+e.util.getProperty(r),u=e.errSchemaPath+"/"+r,f=!e.opts.allErrors,p="data"+(a||""),m="valid"+o,h=e.opts.$data&&c&&c.$data,g;h?(i+=" var schema"+o+" = "+e.util.getData(c.$data,a,e.dataPathArr)+"; ",g="schema"+o):g=c;var A="schema"+o;if(!h)if(c.length<e.opts.loopRequired&&e.schema.properties&&Object.keys(e.schema.properties).length){var y=[],E=c;if(E)for(var b,S=-1,R=E.length-1;S<R;){b=E[S+=1];var B=e.schema.properties[b];B&&(e.opts.strictKeywords?typeof B=="object"&&Object.keys(B).length>0||B===!1:e.util.schemaHasRules(B,e.RULES.all))||(y[y.length]=b)}}else var y=c;if(h||y.length){var L=e.errorPath,O=h||y.length>=e.opts.loopRequired,Y=e.opts.ownProperties;if(f)if(i+=" var missing"+o+"; ",O){h||(i+=" var "+A+" = validate.schema"+l+"; ");var V="i"+o,z="schema"+o+"["+V+"]",Q="' + "+z+" + '";e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPathExpr(L,z,e.opts.jsonPointers)),i+=" var "+m+" = true; ",h&&(i+=" if (schema"+o+" === undefined) "+m+" = true; else if (!Array.isArray(schema"+o+")) "+m+" = false; else {"),i+=" for (var "+V+" = 0; "+V+" < "+A+".length; "+V+"++) { "+m+" = "+p+"["+A+"["+V+"]] !== undefined ",Y&&(i+=" &&   Object.prototype.hasOwnProperty.call("+p+", "+A+"["+V+"]) "),i+="; if (!"+m+") break; } ",h&&(i+="  }  "),i+="  if (!"+m+") {   ";var U=U||[];U.push(i),i="",e.createErrors!==!1?(i+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { missingProperty: '"+Q+"' } ",e.opts.messages!==!1&&(i+=" , message: '",e.opts._errorDataPathProperty?i+="is a required property":i+="should have required property \\'"+Q+"\\'",i+="' "),e.opts.verbose&&(i+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),i+=" } "):i+=" {} ";var Z=i;i=U.pop(),!e.compositeRule&&f?e.async?i+=" throw new ValidationError(["+Z+"]); ":i+=" validate.errors = ["+Z+"]; return false; ":i+=" var err = "+Z+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",i+=" } else { "}else{i+=" if ( ";var J=y;if(J)for(var j,V=-1,W=J.length-1;V<W;){j=J[V+=1],V&&(i+=" || ");var X=e.util.getProperty(j),oe=p+X;i+=" ( ( "+oe+" === undefined ",Y&&(i+=" || ! Object.prototype.hasOwnProperty.call("+p+", '"+e.util.escapeQuotes(j)+"') "),i+=") && (missing"+o+" = "+e.util.toQuotedString(e.opts.jsonPointers?j:X)+") ) "}i+=") {  ";var z="missing"+o,Q="' + "+z+" + '";e.opts._errorDataPathProperty&&(e.errorPath=e.opts.jsonPointers?e.util.getPathExpr(L,z,!0):L+" + "+z);var U=U||[];U.push(i),i="",e.createErrors!==!1?(i+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { missingProperty: '"+Q+"' } ",e.opts.messages!==!1&&(i+=" , message: '",e.opts._errorDataPathProperty?i+="is a required property":i+="should have required property \\'"+Q+"\\'",i+="' "),e.opts.verbose&&(i+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),i+=" } "):i+=" {} ";var Z=i;i=U.pop(),!e.compositeRule&&f?e.async?i+=" throw new ValidationError(["+Z+"]); ":i+=" validate.errors = ["+Z+"]; return false; ":i+=" var err = "+Z+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",i+=" } else { "}else if(O){h||(i+=" var "+A+" = validate.schema"+l+"; ");var V="i"+o,z="schema"+o+"["+V+"]",Q="' + "+z+" + '";e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPathExpr(L,z,e.opts.jsonPointers)),h&&(i+=" if ("+A+" && !Array.isArray("+A+")) {  var err =   ",e.createErrors!==!1?(i+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { missingProperty: '"+Q+"' } ",e.opts.messages!==!1&&(i+=" , message: '",e.opts._errorDataPathProperty?i+="is a required property":i+="should have required property \\'"+Q+"\\'",i+="' "),e.opts.verbose&&(i+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),i+=" } "):i+=" {} ",i+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; } else if ("+A+" !== undefined) { "),i+=" for (var "+V+" = 0; "+V+" < "+A+".length; "+V+"++) { if ("+p+"["+A+"["+V+"]] === undefined ",Y&&(i+=" || ! Object.prototype.hasOwnProperty.call("+p+", "+A+"["+V+"]) "),i+=") {  var err =   ",e.createErrors!==!1?(i+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { missingProperty: '"+Q+"' } ",e.opts.messages!==!1&&(i+=" , message: '",e.opts._errorDataPathProperty?i+="is a required property":i+="should have required property \\'"+Q+"\\'",i+="' "),e.opts.verbose&&(i+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),i+=" } "):i+=" {} ",i+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; } } ",h&&(i+="  }  ")}else{var te=y;if(te)for(var j,re=-1,pe=te.length-1;re<pe;){j=te[re+=1];var X=e.util.getProperty(j),Q=e.util.escapeQuotes(j),oe=p+X;e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPath(L,j,e.opts.jsonPointers)),i+=" if ( "+oe+" === undefined ",Y&&(i+=" || ! Object.prototype.hasOwnProperty.call("+p+", '"+e.util.escapeQuotes(j)+"') "),i+=") {  var err =   ",e.createErrors!==!1?(i+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { missingProperty: '"+Q+"' } ",e.opts.messages!==!1&&(i+=" , message: '",e.opts._errorDataPathProperty?i+="is a required property":i+="should have required property \\'"+Q+"\\'",i+="' "),e.opts.verbose&&(i+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),i+=" } "):i+=" {} ",i+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; } "}}e.errorPath=L}else f&&(i+=" if (true) {");return i},"generate_required")});var rEt=H((VLo,tEt)=>{"use strict";d();tEt.exports=s(function(e,r,n){var i=" ",o=e.level,a=e.dataLevel,c=e.schema[r],l=e.schemaPath+e.util.getProperty(r),u=e.errSchemaPath+"/"+r,f=!e.opts.allErrors,p="data"+(a||""),m="valid"+o,h=e.opts.$data&&c&&c.$data,g;if(h?(i+=" var schema"+o+" = "+e.util.getData(c.$data,a,e.dataPathArr)+"; ",g="schema"+o):g=c,(c||h)&&e.opts.uniqueItems!==!1){h&&(i+=" var "+m+"; if ("+g+" === false || "+g+" === undefined) "+m+" = true; else if (typeof "+g+" != 'boolean') "+m+" = false; else { "),i+=" var i = "+p+".length , "+m+" = true , j; if (i > 1) { ";var A=e.schema.items&&e.schema.items.type,y=Array.isArray(A);if(!A||A=="object"||A=="array"||y&&(A.indexOf("object")>=0||A.indexOf("array")>=0))i+=" outer: for (;i--;) { for (j = i; j--;) { if (equal("+p+"[i], "+p+"[j])) { "+m+" = false; break outer; } } } ";else{i+=" var itemIndices = {}, item; for (;i--;) { var item = "+p+"[i]; ";var E="checkDataType"+(y?"s":"");i+=" if ("+e.util[E](A,"item",e.opts.strictNumbers,!0)+") continue; ",y&&(i+=` if (typeof item == 'string') item = '"' + item; `),i+=" if (typeof itemIndices[item] == 'number') { "+m+" = false; j = itemIndices[item]; break; } itemIndices[item] = i; } "}i+=" } ",h&&(i+="  }  "),i+=" if (!"+m+") {   ";var b=b||[];b.push(i),i="",e.createErrors!==!1?(i+=" { keyword: 'uniqueItems' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { i: i, j: j } ",e.opts.messages!==!1&&(i+=" , message: 'should NOT have duplicate items (items ## ' + j + ' and ' + i + ' are identical)' "),e.opts.verbose&&(i+=" , schema:  ",h?i+="validate.schema"+l:i+=""+c,i+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),i+=" } "):i+=" {} ";var S=i;i=b.pop(),!e.compositeRule&&f?e.async?i+=" throw new ValidationError(["+S+"]); ":i+=" validate.errors = ["+S+"]; return false; ":i+=" var err = "+S+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",i+=" } ",f&&(i+=" else { ")}else f&&(i+=" if (true) { ");return i},"generate_uniqueItems")});var iEt=H((YLo,nEt)=>{"use strict";d();nEt.exports={$ref:gxt(),allOf:yxt(),anyOf:vxt(),$comment:Ext(),const:Ixt(),contains:wxt(),dependencies:_xt(),enum:kxt(),format:Dxt(),if:Nxt(),items:Lxt(),maximum:Y5e(),minimum:Y5e(),maxItems:J5e(),minItems:J5e(),maxLength:X5e(),minLength:X5e(),maxProperties:Z5e(),minProperties:Z5e(),multipleOf:Hxt(),not:Wxt(),oneOf:Gxt(),pattern:zxt(),properties:Yxt(),propertyNames:Xxt(),required:eEt(),uniqueItems:rEt(),validate:z5e()}});var aEt=H((XLo,sEt)=>{"use strict";d();var oEt=iEt(),e4e=o5().toHash;sEt.exports=s(function(){var e=[{type:"number",rules:[{maximum:["exclusiveMaximum"]},{minimum:["exclusiveMinimum"]},"multipleOf","format"]},{type:"string",rules:["maxLength","minLength","pattern","format"]},{type:"array",rules:["maxItems","minItems","items","contains","uniqueItems"]},{type:"object",rules:["maxProperties","minProperties","required","dependencies","propertyNames",{properties:["additionalProperties","patternProperties"]}]},{rules:["$ref","const","enum","not","anyOf","oneOf","allOf","if"]}],r=["type","$comment"],n=["$schema","$id","id","$data","$async","title","description","default","definitions","examples","readOnly","writeOnly","contentMediaType","contentEncoding","additionalItems","then","else"],i=["number","integer","string","array","object","boolean","null"];return e.all=e4e(r),e.types=e4e(i),e.forEach(function(o){o.rules=o.rules.map(function(a){var c;if(typeof a=="object"){var l=Object.keys(a)[0];c=a[l],a=l,c.forEach(function(f){r.push(f),e.all[f]=!0})}r.push(a);var u=e.all[a]={keyword:a,code:oEt[a],implements:c};return u}),e.all.$comment={keyword:"$comment",code:oEt.$comment},o.type&&(e.types[o.type]=o)}),e.keywords=e4e(r.concat(n)),e.custom={},e},"rules")});var uEt=H((tFo,lEt)=>{"use strict";d();var cEt=["multipleOf","maximum","exclusiveMaximum","minimum","exclusiveMinimum","maxLength","minLength","pattern","additionalItems","maxItems","minItems","uniqueItems","maxProperties","minProperties","required","additionalProperties","enum","format","const"];lEt.exports=function(t,e){for(var r=0;r<e.length;r++){t=JSON.parse(JSON.stringify(t));var n=e[r].split("/"),i=t,o;for(o=1;o<n.length;o++)i=i[n[o]];for(o=0;o<cEt.length;o++){var a=cEt[o],c=i[a];c&&(i[a]={anyOf:[c,{$ref:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#"}]})}}return t}});var pEt=H((nFo,fEt)=>{"use strict";d();var Ekr=aue().MissingRef;fEt.exports=dEt;function dEt(t,e,r){var n=this;if(typeof this._opts.loadSchema!="function")throw new Error("options.loadSchema should be a function");typeof e=="function"&&(r=e,e=void 0);var i=o(t).then(function(){var c=n._addSchema(t,void 0,e);return c.validate||a(c)});return r&&i.then(function(c){r(null,c)},r),i;function o(c){var l=c.$schema;return l&&!n.getSchema(l)?dEt.call(n,{$ref:l},!0):Promise.resolve()}s(o,"loadMetaSchemaOf");function a(c){try{return n._compile(c)}catch(u){if(u instanceof Ekr)return l(u);throw u}function l(u){var f=u.missingSchema;if(h(f))throw new Error("Schema "+f+" is loaded but "+u.missingRef+" cannot be resolved");var p=n._loadingSchemas[f];return p||(p=n._loadingSchemas[f]=n._opts.loadSchema(f),p.then(m,m)),p.then(function(g){if(!h(f))return o(g).then(function(){h(f)||n.addSchema(g,f,void 0,e)})}).then(function(){return a(c)});function m(){delete n._loadingSchemas[f]}s(m,"removePromise");function h(g){return n._refs[g]||n._schemas[g]}s(h,"added")}s(l,"loadMissingSchema")}s(a,"_compileAsync")}s(dEt,"compileAsync")});var hEt=H((sFo,mEt)=>{"use strict";d();mEt.exports=s(function(e,r,n){var i=" ",o=e.level,a=e.dataLevel,c=e.schema[r],l=e.schemaPath+e.util.getProperty(r),u=e.errSchemaPath+"/"+r,f=!e.opts.allErrors,p,m="data"+(a||""),h="valid"+o,g="errs__"+o,A=e.opts.$data&&c&&c.$data,y;A?(i+=" var schema"+o+" = "+e.util.getData(c.$data,a,e.dataPathArr)+"; ",y="schema"+o):y=c;var E=this,b="definition"+o,S=E.definition,R="",B,L,O,Y,V;if(A&&S.$data){V="keywordValidate"+o;var z=S.validateSchema;i+=" var "+b+" = RULES.custom['"+r+"'].definition; var "+V+" = "+b+".validate;"}else{if(Y=e.useCustomRule(E,c,e.schema,e),!Y)return;y="validate.schema"+l,V=Y.code,B=S.compile,L=S.inline,O=S.macro}var Q=V+".errors",U="i"+o,Z="ruleErr"+o,J=S.async;if(J&&!e.async)throw new Error("async keyword in sync schema");if(L||O||(i+=""+Q+" = null;"),i+="var "+g+" = errors;var "+h+";",A&&S.$data&&(R+="}",i+=" if ("+y+" === undefined) { "+h+" = true; } else { ",z&&(R+="}",i+=" "+h+" = "+b+".validateSchema("+y+"); if ("+h+") { ")),L)S.statements?i+=" "+Y.validate+" ":i+=" "+h+" = "+Y.validate+"; ";else if(O){var j=e.util.copy(e),R="";j.level++;var W="valid"+j.level;j.schema=Y.validate,j.schemaPath="";var X=e.compositeRule;e.compositeRule=j.compositeRule=!0;var oe=e.validate(j).replace(/validate\.schema/g,V);e.compositeRule=j.compositeRule=X,i+=" "+oe}else{var te=te||[];te.push(i),i="",i+="  "+V+".call( ",e.opts.passContext?i+="this":i+="self",B||S.schema===!1?i+=" , "+m+" ":i+=" , "+y+" , "+m+" , validate.schema"+e.schemaPath+" ",i+=" , (dataPath || '')",e.errorPath!='""'&&(i+=" + "+e.errorPath);var re=a?"data"+(a-1||""):"parentData",pe=a?e.dataPathArr[a]:"parentDataProperty";i+=" , "+re+" , "+pe+" , rootData )  ";var Ae=i;i=te.pop(),S.errors===!1?(i+=" "+h+" = ",J&&(i+="await "),i+=""+Ae+"; "):J?(Q="customErrors"+o,i+=" var "+Q+" = null; try { "+h+" = await "+Ae+"; } catch (e) { "+h+" = false; if (e instanceof ValidationError) "+Q+" = e.errors; else throw e; } "):i+=" "+Q+" = null; "+h+" = "+Ae+"; "}if(S.modifying&&(i+=" if ("+re+") "+m+" = "+re+"["+pe+"];"),i+=""+R,S.valid)f&&(i+=" if (true) { ");else{i+=" if ( ",S.valid===void 0?(i+=" !",O?i+=""+W:i+=""+h):i+=" "+!S.valid+" ",i+=") { ",p=E.keyword;var te=te||[];te.push(i),i="";var te=te||[];te.push(i),i="",e.createErrors!==!1?(i+=" { keyword: '"+(p||"custom")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { keyword: '"+E.keyword+"' } ",e.opts.messages!==!1&&(i+=` , message: 'should pass "`+E.keyword+`" keyword validation' `),e.opts.verbose&&(i+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+m+" "),i+=" } "):i+=" {} ";var Oe=i;i=te.pop(),!e.compositeRule&&f?e.async?i+=" throw new ValidationError(["+Oe+"]); ":i+=" validate.errors = ["+Oe+"]; return false; ":i+=" var err = "+Oe+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ";var Te=i;i=te.pop(),L?S.errors?S.errors!="full"&&(i+="  for (var "+U+"="+g+"; "+U+"<errors; "+U+"++) { var "+Z+" = vErrors["+U+"]; if ("+Z+".dataPath === undefined) "+Z+".dataPath = (dataPath || '') + "+e.errorPath+"; if ("+Z+".schemaPath === undefined) { "+Z+'.schemaPath = "'+u+'"; } ',e.opts.verbose&&(i+=" "+Z+".schema = "+y+"; "+Z+".data = "+m+"; "),i+=" } "):S.errors===!1?i+=" "+Te+" ":(i+=" if ("+g+" == errors) { "+Te+" } else {  for (var "+U+"="+g+"; "+U+"<errors; "+U+"++) { var "+Z+" = vErrors["+U+"]; if ("+Z+".dataPath === undefined) "+Z+".dataPath = (dataPath || '') + "+e.errorPath+"; if ("+Z+".schemaPath === undefined) { "+Z+'.schemaPath = "'+u+'"; } ',e.opts.verbose&&(i+=" "+Z+".schema = "+y+"; "+Z+".data = "+m+"; "),i+=" } } "):O?(i+="   var err =   ",e.createErrors!==!1?(i+=" { keyword: '"+(p||"custom")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { keyword: '"+E.keyword+"' } ",e.opts.messages!==!1&&(i+=` , message: 'should pass "`+E.keyword+`" keyword validation' `),e.opts.verbose&&(i+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+m+" "),i+=" } "):i+=" {} ",i+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",!e.compositeRule&&f&&(e.async?i+=" throw new ValidationError(vErrors); ":i+=" validate.errors = vErrors; return false; ")):S.errors===!1?i+=" "+Te+" ":(i+=" if (Array.isArray("+Q+")) { if (vErrors === null) vErrors = "+Q+"; else vErrors = vErrors.concat("+Q+"); errors = vErrors.length;  for (var "+U+"="+g+"; "+U+"<errors; "+U+"++) { var "+Z+" = vErrors["+U+"]; if ("+Z+".dataPath === undefined) "+Z+".dataPath = (dataPath || '') + "+e.errorPath+";  "+Z+'.schemaPath = "'+u+'";  ',e.opts.verbose&&(i+=" "+Z+".schema = "+y+"; "+Z+".data = "+m+"; "),i+=" } } else { "+Te+" } "),i+=" } ",f&&(i+=" else { ")}return i},"generate_custom")});var t4e=H((lFo,bkr)=>{bkr.exports={$schema:"http://json-schema.org/draft-07/schema#",$id:"http://json-schema.org/draft-07/schema#",title:"Core schema meta-schema",definitions:{schemaArray:{type:"array",minItems:1,items:{$ref:"#"}},nonNegativeInteger:{type:"integer",minimum:0},nonNegativeIntegerDefault0:{allOf:[{$ref:"#/definitions/nonNegativeInteger"},{default:0}]},simpleTypes:{enum:["array","boolean","integer","null","number","object","string"]},stringArray:{type:"array",items:{type:"string"},uniqueItems:!0,default:[]}},type:["object","boolean"],properties:{$id:{type:"string",format:"uri-reference"},$schema:{type:"string",format:"uri"},$ref:{type:"string",format:"uri-reference"},$comment:{type:"string"},title:{type:"string"},description:{type:"string"},default:!0,readOnly:{type:"boolean",default:!1},examples:{type:"array",items:!0},multipleOf:{type:"number",exclusiveMinimum:0},maximum:{type:"number"},exclusiveMaximum:{type:"number"},minimum:{type:"number"},exclusiveMinimum:{type:"number"},maxLength:{$ref:"#/definitions/nonNegativeInteger"},minLength:{$ref:"#/definitions/nonNegativeIntegerDefault0"},pattern:{type:"string",format:"regex"},additionalItems:{$ref:"#"},items:{anyOf:[{$ref:"#"},{$ref:"#/definitions/schemaArray"}],default:!0},maxItems:{$ref:"#/definitions/nonNegativeInteger"},minItems:{$ref:"#/definitions/nonNegativeIntegerDefault0"},uniqueItems:{type:"boolean",default:!1},contains:{$ref:"#"},maxProperties:{$ref:"#/definitions/nonNegativeInteger"},minProperties:{$ref:"#/definitions/nonNegativeIntegerDefault0"},required:{$ref:"#/definitions/stringArray"},additionalProperties:{$ref:"#"},definitions:{type:"object",additionalProperties:{$ref:"#"},default:{}},properties:{type:"object",additionalProperties:{$ref:"#"},default:{}},patternProperties:{type:"object",additionalProperties:{$ref:"#"},propertyNames:{format:"regex"},default:{}},dependencies:{type:"object",additionalProperties:{anyOf:[{$ref:"#"},{$ref:"#/definitions/stringArray"}]}},propertyNames:{$ref:"#"},const:!0,enum:{type:"array",items:!0,minItems:1,uniqueItems:!0},type:{anyOf:[{$ref:"#/definitions/simpleTypes"},{type:"array",items:{$ref:"#/definitions/simpleTypes"},minItems:1,uniqueItems:!0}]},format:{type:"string"},contentMediaType:{type:"string"},contentEncoding:{type:"string"},if:{$ref:"#"},then:{$ref:"#"},else:{$ref:"#"},allOf:{$ref:"#/definitions/schemaArray"},anyOf:{$ref:"#/definitions/schemaArray"},oneOf:{$ref:"#/definitions/schemaArray"},not:{$ref:"#"}},default:!0}});var yEt=H((uFo,AEt)=>{"use strict";d();var gEt=t4e();AEt.exports={$id:"https://github.com/ajv-validator/ajv/blob/master/lib/definition_schema.js",definitions:{simpleTypes:gEt.definitions.simpleTypes},type:"object",dependencies:{schema:["validate"],$data:["validate"],statements:["inline"],valid:{not:{required:["macro"]}}},properties:{type:gEt.properties.type,schema:{type:"boolean"},statements:{type:"boolean"},dependencies:{type:"array",items:{type:"string"}},metaSchema:{type:"object"},modifying:{type:"boolean"},valid:{type:"boolean"},$data:{type:"boolean"},async:{type:"boolean"},errors:{anyOf:[{type:"boolean"},{const:"full"}]}}}});var vEt=H((fFo,CEt)=>{"use strict";d();var Ikr=/^[a-z_$][a-z0-9_$-]*$/i,Tkr=hEt(),wkr=yEt();CEt.exports={add:Skr,get:_kr,remove:Rkr,validate:r4e};function Skr(t,e){var r=this.RULES;if(r.keywords[t])throw new Error("Keyword "+t+" is already defined");if(!Ikr.test(t))throw new Error("Keyword "+t+" is not a valid identifier");if(e){this.validateKeyword(e,!0);var n=e.type;if(Array.isArray(n))for(var i=0;i<n.length;i++)a(t,n[i],e);else a(t,n,e);var o=e.metaSchema;o&&(e.$data&&this._opts.$data&&(o={anyOf:[o,{$ref:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#"}]}),e.validateSchema=this.compile(o,!0))}r.keywords[t]=r.all[t]=!0;function a(c,l,u){for(var f,p=0;p<r.length;p++){var m=r[p];if(m.type==l){f=m;break}}f||(f={type:l,rules:[]},r.push(f));var h={keyword:c,definition:u,custom:!0,code:Tkr,implements:u.implements};f.rules.push(h),r.custom[c]=h}return s(a,"_addRule"),this}s(Skr,"addKeyword");function _kr(t){var e=this.RULES.custom[t];return e?e.definition:this.RULES.keywords[t]||!1}s(_kr,"getKeyword");function Rkr(t){var e=this.RULES;delete e.keywords[t],delete e.all[t],delete e.custom[t];for(var r=0;r<e.length;r++)for(var n=e[r].rules,i=0;i<n.length;i++)if(n[i].keyword==t){n.splice(i,1);break}return this}s(Rkr,"removeKeyword");function r4e(t,e){r4e.errors=null;var r=this._validateKeyword=this._validateKeyword||this.compile(wkr,!0);if(r(t))return!0;if(r4e.errors=r.errors,e)throw new Error("custom keyword definition is invalid: "+this.errorsText(r.errors));return!1}s(r4e,"validateKeyword")});var xEt=H((hFo,kkr)=>{kkr.exports={$schema:"http://json-schema.org/draft-07/schema#",$id:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#",description:"Meta-schema for $data reference (JSON Schema extension proposal)",type:"object",required:["$data"],properties:{$data:{type:"string",anyOf:[{format:"relative-json-pointer"},{format:"json-pointer"}]}},additionalProperties:!1}});var PEt=H((gFo,kEt)=>{"use strict";d();var bEt=ext(),s5=sue(),Pkr=rxt(),IEt=q5e(),Dkr=V5e(),Bkr=mxt(),Nkr=aEt(),TEt=uEt(),wEt=o5();kEt.exports=bc;bc.prototype.validate=Lkr;bc.prototype.compile=Fkr;bc.prototype.addSchema=Okr;bc.prototype.addMetaSchema=Qkr;bc.prototype.validateSchema=Ukr;bc.prototype.getSchema=Hkr;bc.prototype.removeSchema=Wkr;bc.prototype.addFormat=Xkr;bc.prototype.errorsText=Jkr;bc.prototype._addSchema=jkr;bc.prototype._compile=Gkr;bc.prototype.compileAsync=pEt();var hue=vEt();bc.prototype.addKeyword=hue.add;bc.prototype.getKeyword=hue.get;bc.prototype.removeKeyword=hue.remove;bc.prototype.validateKeyword=hue.validate;var SEt=aue();bc.ValidationError=SEt.Validation;bc.MissingRefError=SEt.MissingRef;bc.$dataMetaSchema=TEt;var mue="http://json-schema.org/draft-07/schema",EEt=["removeAdditional","useDefaults","coerceTypes","strictDefaults"],Mkr=["/properties"];function bc(t){if(!(this instanceof bc))return new bc(t);t=this._opts=wEt.copy(t)||{},iPr(this),this._schemas={},this._refs={},this._fragments={},this._formats=Bkr(t.format),this._cache=t.cache||new Pkr,this._loadingSchemas={},this._compilations=[],this.RULES=Nkr(),this._getId=Vkr(t),t.loopRequired=t.loopRequired||1/0,t.errorDataPath=="property"&&(t._errorDataPathProperty=!0),t.serialize===void 0&&(t.serialize=Dkr),this._metaOpts=nPr(this),t.formats&&tPr(this),t.keywords&&rPr(this),Zkr(this),typeof t.meta=="object"&&this.addMetaSchema(t.meta),t.nullable&&this.addKeyword("nullable",{metaSchema:{type:"boolean"}}),ePr(this)}s(bc,"Ajv");function Lkr(t,e){var r;if(typeof t=="string"){if(r=this.getSchema(t),!r)throw new Error('no schema with key or ref "'+t+'"')}else{var n=this._addSchema(t);r=n.validate||this._compile(n)}var i=r(e);return r.$async!==!0&&(this.errors=r.errors),i}s(Lkr,"validate");function Fkr(t,e){var r=this._addSchema(t,void 0,e);return r.validate||this._compile(r)}s(Fkr,"compile");function Okr(t,e,r,n){if(Array.isArray(t)){for(var i=0;i<t.length;i++)this.addSchema(t[i],void 0,r,n);return this}var o=this._getId(t);if(o!==void 0&&typeof o!="string")throw new Error("schema id must be string");return e=s5.normalizeId(e||o),REt(this,e),this._schemas[e]=this._addSchema(t,r,n,!0),this}s(Okr,"addSchema");function Qkr(t,e,r){return this.addSchema(t,e,r,!0),this}s(Qkr,"addMetaSchema");function Ukr(t,e){var r=t.$schema;if(r!==void 0&&typeof r!="string")throw new Error("$schema must be a string");if(r=r||this._opts.defaultMeta||qkr(this),!r)return this.logger.warn("meta-schema not available"),this.errors=null,!0;var n=this.validate(r,t);if(!n&&e){var i="schema is invalid: "+this.errorsText();if(this._opts.validateSchema=="log")this.logger.error(i);else throw new Error(i)}return n}s(Ukr,"validateSchema");function qkr(t){var e=t._opts.meta;return t._opts.defaultMeta=typeof e=="object"?t._getId(e)||e:t.getSchema(mue)?mue:void 0,t._opts.defaultMeta}s(qkr,"defaultMeta");function Hkr(t){var e=_Et(this,t);switch(typeof e){case"object":return e.validate||this._compile(e);case"string":return this.getSchema(e);case"undefined":return $kr(this,t)}}s(Hkr,"getSchema");function $kr(t,e){var r=s5.schema.call(t,{schema:{}},e);if(r){var n=r.schema,i=r.root,o=r.baseId,a=bEt.call(t,n,i,void 0,o);return t._fragments[e]=new IEt({ref:e,fragment:!0,schema:n,root:i,baseId:o,validate:a}),a}}s($kr,"_getSchemaFragment");function _Et(t,e){return e=s5.normalizeId(e),t._schemas[e]||t._refs[e]||t._fragments[e]}s(_Et,"_getSchemaObj");function Wkr(t){if(t instanceof RegExp)return pue(this,this._schemas,t),pue(this,this._refs,t),this;switch(typeof t){case"undefined":return pue(this,this._schemas),pue(this,this._refs),this._cache.clear(),this;case"string":var e=_Et(this,t);return e&&this._cache.del(e.cacheKey),delete this._schemas[t],delete this._refs[t],this;case"object":var r=this._opts.serialize,n=r?r(t):t;this._cache.del(n);var i=this._getId(t);i&&(i=s5.normalizeId(i),delete this._schemas[i],delete this._refs[i])}return this}s(Wkr,"removeSchema");function pue(t,e,r){for(var n in e){var i=e[n];!i.meta&&(!r||r.test(n))&&(t._cache.del(i.cacheKey),delete e[n])}}s(pue,"_removeAllSchemas");function jkr(t,e,r,n){if(typeof t!="object"&&typeof t!="boolean")throw new Error("schema should be object or boolean");var i=this._opts.serialize,o=i?i(t):t,a=this._cache.get(o);if(a)return a;n=n||this._opts.addUsedSchema!==!1;var c=s5.normalizeId(this._getId(t));c&&n&&REt(this,c);var l=this._opts.validateSchema!==!1&&!e,u;l&&!(u=c&&c==s5.normalizeId(t.$schema))&&this.validateSchema(t,!0);var f=s5.ids.call(this,t),p=new IEt({id:c,schema:t,localRefs:f,cacheKey:o,meta:r});return c[0]!="#"&&n&&(this._refs[c]=p),this._cache.put(o,p),l&&u&&this.validateSchema(t,!0),p}s(jkr,"_addSchema");function Gkr(t,e){if(t.compiling)return t.validate=i,i.schema=t.schema,i.errors=null,i.root=e||i,t.schema.$async===!0&&(i.$async=!0),i;t.compiling=!0;var r;t.meta&&(r=this._opts,this._opts=this._metaOpts);var n;try{n=bEt.call(this,t.schema,e,t.localRefs)}catch(o){throw delete t.validate,o}finally{t.compiling=!1,t.meta&&(this._opts=r)}return t.validate=n,t.refs=n.refs,t.refVal=n.refVal,t.root=n.root,n;function i(){var o=t.validate,a=o.apply(this,arguments);return i.errors=o.errors,a}s(i,"callValidate")}s(Gkr,"_compile");function Vkr(t){switch(t.schemaId){case"auto":return Ykr;case"id":return zkr;default:return Kkr}}s(Vkr,"chooseGetId");function zkr(t){return t.$id&&this.logger.warn("schema $id ignored",t.$id),t.id}s(zkr,"_getId");function Kkr(t){return t.id&&this.logger.warn("schema id ignored",t.id),t.$id}s(Kkr,"_get$Id");function Ykr(t){if(t.$id&&t.id&&t.$id!=t.id)throw new Error("schema $id is different from id");return t.$id||t.id}s(Ykr,"_get$IdOrId");function Jkr(t,e){if(t=t||this.errors,!t)return"No errors";e=e||{};for(var r=e.separator===void 0?", ":e.separator,n=e.dataVar===void 0?"data":e.dataVar,i="",o=0;o<t.length;o++){var a=t[o];a&&(i+=n+a.dataPath+" "+a.message+r)}return i.slice(0,-r.length)}s(Jkr,"errorsText");function Xkr(t,e){return typeof e=="string"&&(e=new RegExp(e)),this._formats[t]=e,this}s(Xkr,"addFormat");function Zkr(t){var e;if(t._opts.$data&&(e=xEt(),t.addMetaSchema(e,e.$id,!0)),t._opts.meta!==!1){var r=t4e();t._opts.$data&&(r=TEt(r,Mkr)),t.addMetaSchema(r,mue,!0),t._refs["http://json-schema.org/schema"]=mue}}s(Zkr,"addDefaultMetaSchema");function ePr(t){var e=t._opts.schemas;if(e)if(Array.isArray(e))t.addSchema(e);else for(var r in e)t.addSchema(e[r],r)}s(ePr,"addInitialSchemas");function tPr(t){for(var e in t._opts.formats){var r=t._opts.formats[e];t.addFormat(e,r)}}s(tPr,"addInitialFormats");function rPr(t){for(var e in t._opts.keywords){var r=t._opts.keywords[e];t.addKeyword(e,r)}}s(rPr,"addInitialKeywords");function REt(t,e){if(t._schemas[e]||t._refs[e])throw new Error('schema with key or id "'+e+'" already exists')}s(REt,"checkUnique");function nPr(t){for(var e=wEt.copy(t._opts),r=0;r<EEt.length;r++)delete e[EEt[r]];return e}s(nPr,"getMetaSchemaOptions");function iPr(t){var e=t._opts.logger;if(e===!1)t.logger={log:n4e,warn:n4e,error:n4e};else{if(e===void 0&&(e=console),!(typeof e=="object"&&e.log&&e.warn&&e.error))throw new Error("logger must implement log, warn and error methods");t.logger=e}}s(iPr,"setLogger");function n4e(){}s(n4e,"noop")});var JEt=H((L9o,YEt)=>{d();YEt.exports=KEt;KEt.sync=PPr;var VEt=require("fs");function kPr(t,e){var r=e.pathExt!==void 0?e.pathExt:process.env.PATHEXT;if(!r||(r=r.split(";"),r.indexOf("")!==-1))return!0;for(var n=0;n<r.length;n++){var i=r[n].toLowerCase();if(i&&t.substr(-i.length).toLowerCase()===i)return!0}return!1}s(kPr,"checkPathExt");function zEt(t,e,r){return!t.isSymbolicLink()&&!t.isFile()?!1:kPr(e,r)}s(zEt,"checkStat");function KEt(t,e,r){VEt.stat(t,function(n,i){r(n,n?!1:zEt(i,t,e))})}s(KEt,"isexe");function PPr(t,e){return zEt(VEt.statSync(t),t,e)}s(PPr,"sync")});var rbt=H((Q9o,tbt)=>{d();tbt.exports=ZEt;ZEt.sync=DPr;var XEt=require("fs");function ZEt(t,e,r){XEt.stat(t,function(n,i){r(n,n?!1:ebt(i,e))})}s(ZEt,"isexe");function DPr(t,e){return ebt(XEt.statSync(t),e)}s(DPr,"sync");function ebt(t,e){return t.isFile()&&BPr(t,e)}s(ebt,"checkStat");function BPr(t,e){var r=t.mode,n=t.uid,i=t.gid,o=e.uid!==void 0?e.uid:process.getuid&&process.getuid(),a=e.gid!==void 0?e.gid:process.getgid&&process.getgid(),c=parseInt("100",8),l=parseInt("010",8),u=parseInt("001",8),f=c|l,p=r&u||r&l&&i===a||r&c&&n===o||r&f&&o===0;return p}s(BPr,"checkMode")});var ibt=H(($9o,nbt)=>{d();var H9o=require("fs"),Tue;process.platform==="win32"||global.TESTING_WINDOWS?Tue=JEt():Tue=rbt();nbt.exports=E4e;E4e.sync=NPr;function E4e(t,e,r){if(typeof e=="function"&&(r=e,e={}),!r){if(typeof Promise!="function")throw new TypeError("callback not provided");return new Promise(function(n,i){E4e(t,e||{},function(o,a){o?i(o):n(a)})})}Tue(t,e||{},function(n,i){n&&(n.code==="EACCES"||e&&e.ignoreErrors)&&(n=null,i=!1),r(n,i)})}s(E4e,"isexe");function NPr(t,e){try{return Tue.sync(t,e||{})}catch(r){if(e&&e.ignoreErrors||r.code==="EACCES")return!1;throw r}}s(NPr,"sync")});var dbt=H((G9o,ubt)=>{d();var oL=process.platform==="win32"||process.env.OSTYPE==="cygwin"||process.env.OSTYPE==="msys",obt=require("path"),MPr=oL?";":":",sbt=ibt(),abt=s(t=>Object.assign(new Error(`not found: ${t}`),{code:"ENOENT"}),"getNotFoundError"),cbt=s((t,e)=>{let r=e.colon||MPr,n=t.match(/\//)||oL&&t.match(/\\/)?[""]:[...oL?[process.cwd()]:[],...(e.path||process.env.PATH||"").split(r)],i=oL?e.pathExt||process.env.PATHEXT||".EXE;.CMD;.BAT;.COM":"",o=oL?i.split(r):[""];return oL&&t.indexOf(".")!==-1&&o[0]!==""&&o.unshift(""),{pathEnv:n,pathExt:o,pathExtExe:i}},"getPathInfo"),lbt=s((t,e,r)=>{typeof e=="function"&&(r=e,e={}),e||(e={});let{pathEnv:n,pathExt:i,pathExtExe:o}=cbt(t,e),a=[],c=s(u=>new Promise((f,p)=>{if(u===n.length)return e.all&&a.length?f(a):p(abt(t));let m=n[u],h=/^".*"$/.test(m)?m.slice(1,-1):m,g=obt.join(h,t),A=!h&&/^\.[\\\/]/.test(t)?t.slice(0,2)+g:g;f(l(A,u,0))}),"step"),l=s((u,f,p)=>new Promise((m,h)=>{if(p===i.length)return m(c(f+1));let g=i[p];sbt(u+g,{pathExt:o},(A,y)=>{if(!A&&y)if(e.all)a.push(u+g);else return m(u+g);return m(l(u,f,p+1))})}),"subStep");return r?c(0).then(u=>r(null,u),r):c(0)},"which"),LPr=s((t,e)=>{e=e||{};let{pathEnv:r,pathExt:n,pathExtExe:i}=cbt(t,e),o=[];for(let a=0;a<r.length;a++){let c=r[a],l=/^".*"$/.test(c)?c.slice(1,-1):c,u=obt.join(l,t),f=!l&&/^\.[\\\/]/.test(t)?t.slice(0,2)+u:u;for(let p=0;p<n.length;p++){let m=f+n[p];try{if(sbt.sync(m,{pathExt:i}))if(e.all)o.push(m);else return m}catch{}}}if(e.all&&o.length)return o;if(e.nothrow)return null;throw abt(t)},"whichSync");ubt.exports=lbt;lbt.sync=LPr});var pbt=H((K9o,b4e)=>{"use strict";d();var fbt=s((t={})=>{let e=t.env||process.env;return(t.platform||process.platform)!=="win32"?"PATH":Object.keys(e).reverse().find(n=>n.toUpperCase()==="PATH")||"Path"},"pathKey");b4e.exports=fbt;b4e.exports.default=fbt});var Abt=H((X9o,gbt)=>{"use strict";d();var mbt=require("path"),FPr=dbt(),OPr=pbt();function hbt(t,e){let r=t.options.env||process.env,n=process.cwd(),i=t.options.cwd!=null,o=i&&process.chdir!==void 0&&!process.chdir.disabled;if(o)try{process.chdir(t.options.cwd)}catch{}let a;try{a=FPr.sync(t.command,{path:r[OPr({env:r})],pathExt:e?mbt.delimiter:void 0})}catch{}finally{o&&process.chdir(n)}return a&&(a=mbt.resolve(i?t.options.cwd:"",a)),a}s(hbt,"resolveCommandAttempt");function QPr(t){return hbt(t)||hbt(t,!0)}s(QPr,"resolveCommand");gbt.exports=QPr});var ybt=H((t6o,T4e)=>{"use strict";d();var I4e=/([()\][%!^"`<>&|;, *?])/g;function UPr(t){return t=t.replace(I4e,"^$1"),t}s(UPr,"escapeCommand");function qPr(t,e){return t=`${t}`,t=t.replace(/(?=(\\+?)?)\1"/g,'$1$1\\"'),t=t.replace(/(?=(\\+?)?)\1$/,"$1$1"),t=`"${t}"`,t=t.replace(I4e,"^$1"),e&&(t=t.replace(I4e,"^$1")),t}s(qPr,"escapeArgument");T4e.exports.command=UPr;T4e.exports.argument=qPr});var vbt=H((i6o,Cbt)=>{"use strict";d();Cbt.exports=/^#!(.*)/});var Ebt=H((s6o,xbt)=>{"use strict";d();var HPr=vbt();xbt.exports=(t="")=>{let e=t.match(HPr);if(!e)return null;let[r,n]=e[0].replace(/#! ?/,"").split(" "),i=r.split("/").pop();return i==="env"?n:n?`${i} ${n}`:i}});var Ibt=H((c6o,bbt)=>{"use strict";d();var w4e=require("fs"),$Pr=Ebt();function WPr(t){let r=Buffer.alloc(150),n;try{n=w4e.openSync(t,"r"),w4e.readSync(n,r,0,150,0),w4e.closeSync(n)}catch{}return $Pr(r.toString())}s(WPr,"readShebang");bbt.exports=WPr});var _bt=H((d6o,Sbt)=>{"use strict";d();var jPr=require("path"),Tbt=Abt(),wbt=ybt(),GPr=Ibt(),VPr=process.platform==="win32",zPr=/\.(?:com|exe)$/i,KPr=/node_modules[\\/].bin[\\/][^\\/]+\.cmd$/i;function YPr(t){t.file=Tbt(t);let e=t.file&&GPr(t.file);return e?(t.args.unshift(t.file),t.command=e,Tbt(t)):t.file}s(YPr,"detectShebang");function JPr(t){if(!VPr)return t;let e=YPr(t),r=!zPr.test(e);if(t.options.forceShell||r){let n=KPr.test(e);t.command=jPr.normalize(t.command),t.command=wbt.command(t.command),t.args=t.args.map(o=>wbt.argument(o,n));let i=[t.command].concat(t.args).join(" ");t.args=["/d","/s","/c",`"${i}"`],t.command=process.env.comspec||"cmd.exe",t.options.windowsVerbatimArguments=!0}return t}s(JPr,"parseNonShell");function XPr(t,e,r){e&&!Array.isArray(e)&&(r=e,e=null),e=e?e.slice(0):[],r=Object.assign({},r);let n={command:t,args:e,options:r,file:void 0,original:{command:t,args:e}};return r.shell?n:JPr(n)}s(XPr,"parse");Sbt.exports=XPr});var Pbt=H((m6o,kbt)=>{"use strict";d();var S4e=process.platform==="win32";function _4e(t,e){return Object.assign(new Error(`${e} ${t.command} ENOENT`),{code:"ENOENT",errno:"ENOENT",syscall:`${e} ${t.command}`,path:t.command,spawnargs:t.args})}s(_4e,"notFoundError");function ZPr(t,e){if(!S4e)return;let r=t.emit;t.emit=function(n,i){if(n==="exit"){let o=Rbt(i,e);if(o)return r.call(t,"error",o)}return r.apply(t,arguments)}}s(ZPr,"hookChildProcess");function Rbt(t,e){return S4e&&t===1&&!e.file?_4e(e.original,"spawn"):null}s(Rbt,"verifyENOENT");function e5r(t,e){return S4e&&t===1&&!e.file?_4e(e.original,"spawnSync"):null}s(e5r,"verifyENOENTSync");kbt.exports={hookChildProcess:ZPr,verifyENOENT:Rbt,verifyENOENTSync:e5r,notFoundError:_4e}});var Nbt=H((A6o,sL)=>{"use strict";d();var Dbt=require("child_process"),R4e=_bt(),k4e=Pbt();function Bbt(t,e,r){let n=R4e(t,e,r),i=Dbt.spawn(n.command,n.args,n.options);return k4e.hookChildProcess(i,n),i}s(Bbt,"spawn");function t5r(t,e,r){let n=R4e(t,e,r),i=Dbt.spawnSync(n.command,n.args,n.options);return i.error=i.error||k4e.verifyENOENTSync(i.status,n),i}s(t5r,"spawnSync");sL.exports=Bbt;sL.exports.spawn=Bbt;sL.exports.sync=t5r;sL.exports._parse=R4e;sL.exports._enoent=k4e});var A5r={};Ia(A5r,{getTokenizer:()=>Li,getTokenizerAsync:()=>DWe,main:()=>Zbt});module.exports=bTt(A5r);d();d();xBe().install();d();d();d();var Q_=(i=>(i[i.DEBUG=4]="DEBUG",i[i.INFO=3]="INFO",i[i.WARN=2]="WARN",i[i.ERROR=1]="ERROR",i))(Q_||{}),Xc=class{static{s(this,"LogTarget")}},nC=class{static{s(this,"TelemetryLogSender")}},dt=class{constructor(e){this.category=e}static{s(this,"Logger")}log(e,r,...n){e.get(Xc).logIt(e,r,this.category,...n)}debug(e,...r){this.log(e,4,...r)}info(e,...r){this.log(e,3,...r)}warn(e,...r){this.log(e,2,...r)}error(e,...r){e.get(nC).sendError(e,this.category,...r),this.log(e,1,...r)}exception(e,r,n){if(r instanceof Error&&r.name==="Canceled"&&r.message==="Canceled")return;let i=n;n.startsWith(".")&&(i=n.substring(1),n=`${this.category}${n}`),e.get(nC).sendException(e,r,n);let o=r instanceof Error?r:new Error(`Non-error thrown: ${String(r)}`);this.log(e,1,`${i}:`,o)}},dn=new dt("default");d();d();d();var LF="github.copilot",EBe="github-enterprise";d();d();d();d();var FW=class{constructor(e){this.userInfo=e}static{s(this,"CopilotUserInfoWrapper")}get sku(){return this.userInfo?.access_type_sku}get isFreeUser(){return this.sku==="free_limited_copilot"}get copilotPlan(){if(this.isFreeUser)return"free";let e=this.userInfo?.copilot_plan;switch(e){case"individual":case"individual_pro":case"business":case"enterprise":return e;default:return"individual"}}get quotaInfo(){return{quota_snapshots:this.userInfo?.quota_snapshots,quota_reset_date:this.userInfo?.quota_reset_date}}get raw(){return this.userInfo}};d();function jfe(t){return["a5db0bcaae94032fe715fb34a5e4bce2","7184f66dfcee98cb5f08a1cb936d5225","faef89d9169d5eacf1d8c8dde3412e37","4535c7beffc844b46bb1ed4aa04d759a"].find(r=>t.includes(r))}s(jfe,"findKnownOrg");function bBe(t){let e=t.organization_list??[];return jfe(e)??""}s(bBe,"getUserKind");d();d();var FF=class extends Error{static{s(this,"HttpTimeoutError")}constructor(e,r){super(e,{cause:r}),this.name="HttpTimeoutError"}};function Td(t){return!t||typeof t!="object"?!1:t instanceof FF||"name"in t&&t.name==="AbortError"||"code"in t&&t.code==="ABORT_ERR"}s(Td,"isAbortError");var N4=class extends SyntaxError{constructor(r,n){super(r);this.code=n;this.name="JsonParseError"}static{s(this,"JsonParseError")}},iC=class extends Error{static{s(this,"FetchResponseError")}constructor(e,r=`HTTP ${e.status} ${e.statusText}`){super(r),this.name="FetchResponseError",this.code=`HTTP${e.status}`}},cwt=new Set(["ECONNABORTED","ECONNRESET","EHOSTUNREACH","ENETUNREACH","ENOTCONN","ENOTFOUND","ETIMEDOUT","ERR_HTTP2_STREAM_ERROR","ERR_SSL_BAD_DECRYPT","ERR_SSL_DECRYPTION_FAILED_OR_BAD_RECORD_MAC","ERR_SSL_INVALID_LIBRARY_(0)","ERR_SSL_SSLV3_ALERT_BAD_RECORD_MAC","ERR_SSL_WRONG_VERSION_NUMBER","ERR_STREAM_PREMATURE_CLOSE","ERR_TLS_CERT_ALTNAME_INVALID"]);function OF(t,e=!0){return t instanceof Error?e&&"cause"in t&&OF(t.cause,!1)?!0:t.name==="EditorFetcherError"||t.name==="FetchError"||t instanceof N4||t instanceof iC||t?.message?.startsWith("net::")||cwt.has(t.code??""):!1}s(OF,"isNetworkError");var hI=class{constructor(e,r,n,i,o){this.status=e;this.statusText=r;this.headers=n;this.getText=i;this.getBody=o;this.ok=this.status>=200&&this.status<300;this.clientError=this.status>=400&&this.status<500}static{s(this,"Response")}async text(){return this.getText()}async json(){let e=await this.text(),r=this.headers.get("content-type");if(!r||!r.includes("json"))throw new N4(`Response content-type is ${r??"missing"} (status=${this.status})`,`ContentType=${r}`);try{return JSON.parse(e)}catch(n){if(n instanceof SyntaxError){let i=n.message.match(/^(.*?) in JSON at position (\d+)(?: \(line \d+ column \d+\))?$/);if(i&&parseInt(i[2],10)==e.length||n.message==="Unexpected end of JSON input"){let o=new TextEncoder().encode(e).length,a=this.headers.get("content-length");throw a===null?new N4(`Response body truncated: actualLength=${o}`,"Truncated"):new N4(`Response body truncated: actualLength=${o}, headerLength=${a}`,"Truncated")}}throw n}}body(){return this.getBody()}};d();function OW(){return typeof process>"u"}s(OW,"isWeb");function Pv(){return typeof process<"u"&&process.env.MSBENCH_MODE==="true"}s(Pv,"isMsBenchModeEnabled");function IBe(){return typeof process<"u"&&process.env.SIMULATOR_MODE==="true"}s(IBe,"isSimulatorModeEnabled");var Gfe=class extends iC{static{s(this,"ProxiedResponseError")}constructor(e){super(e,`HTTP ${e.status} response does not appear to originate from GitHub. Is a proxy or firewall intercepting this request? https://gh.io/copilot-firewall`)}};async function Qm(t,e,r,n={}){n={...n,headers:{Authorization:`Bearer ${e.accessToken}`,...OW()?{}:p0(t),...n.headers}};let i=await t.get(Or).fetch(new URL(r,e.apiUrl).href,n);if(i.status>=500)throw new iC(i);if(!i.headers.get("x-github-request-id"))throw new Gfe(i);return i}s(Qm,"apiFetch");d();d();d();var D3e=Be(yI());var Sr=class{constructor(e=10){this.valueMap=new Map;if(e<1)throw new Error("Size limit must be at least 1");this.sizeLimit=e}static{s(this,"LRUCacheMap")}set(e,r){if(this.has(e))this.valueMap.delete(e);else if(this.valueMap.size>=this.sizeLimit){let n=this.valueMap.keys().next().value;this.delete(n)}return this.valueMap.set(e,r),this}get(e){if(this.valueMap.has(e)){let r=this.valueMap.get(e);return this.valueMap.delete(e),this.valueMap.set(e,r),r}}delete(e){return this.valueMap.delete(e)}clear(){this.valueMap.clear()}get size(){return this.valueMap.size}keys(){return new Map(this.valueMap).keys()}values(){return new Map(this.valueMap).values()}entries(){return new Map(this.valueMap).entries()}[Symbol.iterator](){return this.entries()}has(e){return this.valueMap.has(e)}forEach(e,r){new Map(this.valueMap).forEach(e,r)}get[Symbol.toStringTag](){return"LRUCacheMap"}peek(e){return this.valueMap.get(e)}},U_=class extends Sr{constructor(r,n=120*1e3){super(r);this.defaultTtl=n;this.expiration=new Map}static{s(this,"LRUExpirationCacheMap")}has(r){let n=!1,i=this.expiration.get(r);return i!==void 0&&(i>performance.now()&&(n=super.has(r)),n||this.delete(r)),n}get(r){let n=this.expiration.get(r);if(n!==void 0){if(n>performance.now())return super.get(r);this.delete(r)}}peek(r){let n=this.expiration.get(r);if(n!==void 0){if(n>performance.now())return super.peek(r);this.delete(r)}}set(r,n,i=this.defaultTtl){if(i<=0)throw new Error("TTL must be greater than 0");let o=super.set(r,n);return this.expiration.set(r,performance.now()+i),o}clear(){super.clear(),this.expiration.clear()}delete(r){return this.expiration.delete(r),super.delete(r)}get[Symbol.toStringTag](){return"LRUExpirationCacheMap"}},bj=class extends Sr{static{s(this,"LRUDisposableCacheMap")}delete(e){let r=this.peek(e);return r&&r.dispose(),super.delete(e)}clear(){for(let e of this.values())e.dispose();super.clear()}uncache(e){let r=this.peek(e);return super.delete(e),r}dispose(){this.clear()}};var wa=class{constructor(){this.recentNotifications=new Sr(100)}static{s(this,"NotificationSender")}async showWarningMessageOnlyOnce(e,r,...n){if(!this.recentNotifications.has(e??r))return this.recentNotifications.set(e??r,!0),this.showWarningMessage(r,...n)}async showInformationMessageOnlyOnce(e,r,...n){if(!this.recentNotifications.has(e??r))return this.recentNotifications.set(e??r,!0),this.showInformationMessage(r,...n)}};d();var Um=class t{constructor(e){this.flags=e}static{s(this,"RuntimeMode")}static fromEnvironment(e,r=process.argv,n=process.env){return new t({debug:N3e(r,n),verboseLogging:uwt(r,n),testMode:e,simulation:lwt(n)})}};function Kg(t){return t.get(Um).flags.testMode}s(Kg,"isRunningInTest");function M4(t){return Kg(t)}s(M4,"shouldFailForDebugPurposes");function UF(t){return t.get(Um).flags.debug}s(UF,"isDebugEnabled");function B3e(t){return t.get(Um).flags.verboseLogging}s(B3e,"isVerboseLoggingEnabled");function N3e(t,e){return t.includes("--debug")||Kfe(e,"DEBUG")}s(N3e,"determineDebugFlag");function lwt(t){return Kfe(t,"SIMULATION")}s(lwt,"determineSimulationFlag");function Ij(t){return t.get(Um).flags.simulation}s(Ij,"isRunningInSimulation");function uwt(t,e){return e.COPILOT_AGENT_VERBOSE==="1"||e.COPILOT_AGENT_VERBOSE?.toLowerCase()==="true"||Kfe(e,"VERBOSE")||N3e(t,e)}s(uwt,"determineVerboseLoggingEnabled");function Kfe(t,e){for(let r of["GH_COPILOT_","GITHUB_COPILOT_"]){let n=t[`${r}${e}`];if(n)return n==="1"||n?.toLowerCase()==="true"}return!1}s(Kfe,"determineEnvFlagEnabled");d();var F3e=require("os"),Tj=require("path");d();var M3e;(()=>{"use strict";var t={975:Q=>{function U(j){if(typeof j!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(j))}s(U,"e");function Z(j,W){for(var X,oe="",te=0,re=-1,pe=0,Ae=0;Ae<=j.length;++Ae){if(Ae<j.length)X=j.charCodeAt(Ae);else{if(X===47)break;X=47}if(X===47){if(!(re===Ae-1||pe===1))if(re!==Ae-1&&pe===2){if(oe.length<2||te!==2||oe.charCodeAt(oe.length-1)!==46||oe.charCodeAt(oe.length-2)!==46){if(oe.length>2){var Oe=oe.lastIndexOf("/");if(Oe!==oe.length-1){Oe===-1?(oe="",te=0):te=(oe=oe.slice(0,Oe)).length-1-oe.lastIndexOf("/"),re=Ae,pe=0;continue}}else if(oe.length===2||oe.length===1){oe="",te=0,re=Ae,pe=0;continue}}W&&(oe.length>0?oe+="/..":oe="..",te=2)}else oe.length>0?oe+="/"+j.slice(re+1,Ae):oe=j.slice(re+1,Ae),te=Ae-re-1;re=Ae,pe=0}else X===46&&pe!==-1?++pe:pe=-1}return oe}s(Z,"r");var J={resolve:s(function(){for(var j,W="",X=!1,oe=arguments.length-1;oe>=-1&&!X;oe--){var te;oe>=0?te=arguments[oe]:(j===void 0&&(j=process.cwd()),te=j),U(te),te.length!==0&&(W=te+"/"+W,X=te.charCodeAt(0)===47)}return W=Z(W,!X),X?W.length>0?"/"+W:"/":W.length>0?W:"."},"resolve"),normalize:s(function(j){if(U(j),j.length===0)return".";var W=j.charCodeAt(0)===47,X=j.charCodeAt(j.length-1)===47;return(j=Z(j,!W)).length!==0||W||(j="."),j.length>0&&X&&(j+="/"),W?"/"+j:j},"normalize"),isAbsolute:s(function(j){return U(j),j.length>0&&j.charCodeAt(0)===47},"isAbsolute"),join:s(function(){if(arguments.length===0)return".";for(var j,W=0;W<arguments.length;++W){var X=arguments[W];U(X),X.length>0&&(j===void 0?j=X:j+="/"+X)}return j===void 0?".":J.normalize(j)},"join"),relative:s(function(j,W){if(U(j),U(W),j===W||(j=J.resolve(j))===(W=J.resolve(W)))return"";for(var X=1;X<j.length&&j.charCodeAt(X)===47;++X);for(var oe=j.length,te=oe-X,re=1;re<W.length&&W.charCodeAt(re)===47;++re);for(var pe=W.length-re,Ae=te<pe?te:pe,Oe=-1,Te=0;Te<=Ae;++Te){if(Te===Ae){if(pe>Ae){if(W.charCodeAt(re+Te)===47)return W.slice(re+Te+1);if(Te===0)return W.slice(re+Te)}else te>Ae&&(j.charCodeAt(X+Te)===47?Oe=Te:Te===0&&(Oe=0));break}var Je=j.charCodeAt(X+Te);if(Je!==W.charCodeAt(re+Te))break;Je===47&&(Oe=Te)}var Fe="";for(Te=X+Oe+1;Te<=oe;++Te)Te!==oe&&j.charCodeAt(Te)!==47||(Fe.length===0?Fe+="..":Fe+="/..");return Fe.length>0?Fe+W.slice(re+Oe):(re+=Oe,W.charCodeAt(re)===47&&++re,W.slice(re))},"relative"),_makeLong:s(function(j){return j},"_makeLong"),dirname:s(function(j){if(U(j),j.length===0)return".";for(var W=j.charCodeAt(0),X=W===47,oe=-1,te=!0,re=j.length-1;re>=1;--re)if((W=j.charCodeAt(re))===47){if(!te){oe=re;break}}else te=!1;return oe===-1?X?"/":".":X&&oe===1?"//":j.slice(0,oe)},"dirname"),basename:s(function(j,W){if(W!==void 0&&typeof W!="string")throw new TypeError('"ext" argument must be a string');U(j);var X,oe=0,te=-1,re=!0;if(W!==void 0&&W.length>0&&W.length<=j.length){if(W.length===j.length&&W===j)return"";var pe=W.length-1,Ae=-1;for(X=j.length-1;X>=0;--X){var Oe=j.charCodeAt(X);if(Oe===47){if(!re){oe=X+1;break}}else Ae===-1&&(re=!1,Ae=X+1),pe>=0&&(Oe===W.charCodeAt(pe)?--pe==-1&&(te=X):(pe=-1,te=Ae))}return oe===te?te=Ae:te===-1&&(te=j.length),j.slice(oe,te)}for(X=j.length-1;X>=0;--X)if(j.charCodeAt(X)===47){if(!re){oe=X+1;break}}else te===-1&&(re=!1,te=X+1);return te===-1?"":j.slice(oe,te)},"basename"),extname:s(function(j){U(j);for(var W=-1,X=0,oe=-1,te=!0,re=0,pe=j.length-1;pe>=0;--pe){var Ae=j.charCodeAt(pe);if(Ae!==47)oe===-1&&(te=!1,oe=pe+1),Ae===46?W===-1?W=pe:re!==1&&(re=1):W!==-1&&(re=-1);else if(!te){X=pe+1;break}}return W===-1||oe===-1||re===0||re===1&&W===oe-1&&W===X+1?"":j.slice(W,oe)},"extname"),format:s(function(j){if(j===null||typeof j!="object")throw new TypeError('The "pathObject" argument must be of type Object. Received type '+typeof j);return function(W,X){var oe=X.dir||X.root,te=X.base||(X.name||"")+(X.ext||"");return oe?oe===X.root?oe+te:oe+"/"+te:te}(0,j)},"format"),parse:s(function(j){U(j);var W={root:"",dir:"",base:"",ext:"",name:""};if(j.length===0)return W;var X,oe=j.charCodeAt(0),te=oe===47;te?(W.root="/",X=1):X=0;for(var re=-1,pe=0,Ae=-1,Oe=!0,Te=j.length-1,Je=0;Te>=X;--Te)if((oe=j.charCodeAt(Te))!==47)Ae===-1&&(Oe=!1,Ae=Te+1),oe===46?re===-1?re=Te:Je!==1&&(Je=1):re!==-1&&(Je=-1);else if(!Oe){pe=Te+1;break}return re===-1||Ae===-1||Je===0||Je===1&&re===Ae-1&&re===pe+1?Ae!==-1&&(W.base=W.name=pe===0&&te?j.slice(1,Ae):j.slice(pe,Ae)):(pe===0&&te?(W.name=j.slice(1,re),W.base=j.slice(1,Ae)):(W.name=j.slice(pe,re),W.base=j.slice(pe,Ae)),W.ext=j.slice(re,Ae)),pe>0?W.dir=j.slice(0,pe-1):te&&(W.dir="/"),W},"parse"),sep:"/",delimiter:":",win32:null,posix:null};J.posix=J,Q.exports=J}},e={};function r(Q){var U=e[Q];if(U!==void 0)return U.exports;var Z=e[Q]={exports:{}};return t[Q](Z,Z.exports,r),Z.exports}s(r,"r"),r.d=(Q,U)=>{for(var Z in U)r.o(U,Z)&&!r.o(Q,Z)&&Object.defineProperty(Q,Z,{enumerable:!0,get:U[Z]})},r.o=(Q,U)=>Object.prototype.hasOwnProperty.call(Q,U),r.r=Q=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(Q,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(Q,"__esModule",{value:!0})};var n={};let i;r.r(n),r.d(n,{URI:s(()=>m,"URI"),Utils:s(()=>z,"Utils")}),typeof process=="object"?i=process.platform==="win32":typeof navigator=="object"&&(i=navigator.userAgent.indexOf("Windows")>=0);let o=/^\w[\w\d+.-]*$/,a=/^\//,c=/^\/\//;function l(Q,U){if(!Q.scheme&&U)throw new Error(`[UriError]: Scheme is missing: {scheme: "", authority: "${Q.authority}", path: "${Q.path}", query: "${Q.query}", fragment: "${Q.fragment}"}`);if(Q.scheme&&!o.test(Q.scheme))throw new Error("[UriError]: Scheme contains illegal characters.");if(Q.path){if(Q.authority){if(!a.test(Q.path))throw new Error('[UriError]: If a URI contains an authority component, then the path component must either be empty or begin with a slash ("/") character')}else if(c.test(Q.path))throw new Error('[UriError]: If a URI does not contain an authority component, then the path cannot begin with two slash characters ("//")')}}s(l,"a");let u="",f="/",p=/^(([^:/?#]+?):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?/;class m{static{s(this,"l")}static isUri(U){return U instanceof m||!!U&&typeof U.authority=="string"&&typeof U.fragment=="string"&&typeof U.path=="string"&&typeof U.query=="string"&&typeof U.scheme=="string"&&typeof U.fsPath=="string"&&typeof U.with=="function"&&typeof U.toString=="function"}scheme;authority;path;query;fragment;constructor(U,Z,J,j,W,X=!1){typeof U=="object"?(this.scheme=U.scheme||u,this.authority=U.authority||u,this.path=U.path||u,this.query=U.query||u,this.fragment=U.fragment||u):(this.scheme=function(oe,te){return oe||te?oe:"file"}(U,X),this.authority=Z||u,this.path=function(oe,te){switch(oe){case"https":case"http":case"file":te?te[0]!==f&&(te=f+te):te=f}return te}(this.scheme,J||u),this.query=j||u,this.fragment=W||u,l(this,X))}get fsPath(){return b(this,!1)}with(U){if(!U)return this;let{scheme:Z,authority:J,path:j,query:W,fragment:X}=U;return Z===void 0?Z=this.scheme:Z===null&&(Z=u),J===void 0?J=this.authority:J===null&&(J=u),j===void 0?j=this.path:j===null&&(j=u),W===void 0?W=this.query:W===null&&(W=u),X===void 0?X=this.fragment:X===null&&(X=u),Z===this.scheme&&J===this.authority&&j===this.path&&W===this.query&&X===this.fragment?this:new g(Z,J,j,W,X)}static parse(U,Z=!1){let J=p.exec(U);return J?new g(J[2]||u,L(J[4]||u),L(J[5]||u),L(J[7]||u),L(J[9]||u),Z):new g(u,u,u,u,u)}static file(U){let Z=u;if(i&&(U=U.replace(/\\/g,f)),U[0]===f&&U[1]===f){let J=U.indexOf(f,2);J===-1?(Z=U.substring(2),U=f):(Z=U.substring(2,J),U=U.substring(J)||f)}return new g("file",Z,U,u,u)}static from(U){let Z=new g(U.scheme,U.authority,U.path,U.query,U.fragment);return l(Z,!0),Z}toString(U=!1){return S(this,U)}toJSON(){return this}static revive(U){if(U){if(U instanceof m)return U;{let Z=new g(U);return Z._formatted=U.external,Z._fsPath=U._sep===h?U.fsPath:null,Z}}return U}}let h=i?1:void 0;class g extends m{static{s(this,"d")}_formatted=null;_fsPath=null;get fsPath(){return this._fsPath||(this._fsPath=b(this,!1)),this._fsPath}toString(U=!1){return U?S(this,!0):(this._formatted||(this._formatted=S(this,!1)),this._formatted)}toJSON(){let U={$mid:1};return this._fsPath&&(U.fsPath=this._fsPath,U._sep=h),this._formatted&&(U.external=this._formatted),this.path&&(U.path=this.path),this.scheme&&(U.scheme=this.scheme),this.authority&&(U.authority=this.authority),this.query&&(U.query=this.query),this.fragment&&(U.fragment=this.fragment),U}}let A={58:"%3A",47:"%2F",63:"%3F",35:"%23",91:"%5B",93:"%5D",64:"%40",33:"%21",36:"%24",38:"%26",39:"%27",40:"%28",41:"%29",42:"%2A",43:"%2B",44:"%2C",59:"%3B",61:"%3D",32:"%20"};function y(Q,U,Z){let J,j=-1;for(let W=0;W<Q.length;W++){let X=Q.charCodeAt(W);if(X>=97&&X<=122||X>=65&&X<=90||X>=48&&X<=57||X===45||X===46||X===95||X===126||U&&X===47||Z&&X===91||Z&&X===93||Z&&X===58)j!==-1&&(J+=encodeURIComponent(Q.substring(j,W)),j=-1),J!==void 0&&(J+=Q.charAt(W));else{J===void 0&&(J=Q.substr(0,W));let oe=A[X];oe!==void 0?(j!==-1&&(J+=encodeURIComponent(Q.substring(j,W)),j=-1),J+=oe):j===-1&&(j=W)}}return j!==-1&&(J+=encodeURIComponent(Q.substring(j))),J!==void 0?J:Q}s(y,"m");function E(Q){let U;for(let Z=0;Z<Q.length;Z++){let J=Q.charCodeAt(Z);J===35||J===63?(U===void 0&&(U=Q.substr(0,Z)),U+=A[J]):U!==void 0&&(U+=Q[Z])}return U!==void 0?U:Q}s(E,"y");function b(Q,U){let Z;return Z=Q.authority&&Q.path.length>1&&Q.scheme==="file"?`//${Q.authority}${Q.path}`:Q.path.charCodeAt(0)===47&&(Q.path.charCodeAt(1)>=65&&Q.path.charCodeAt(1)<=90||Q.path.charCodeAt(1)>=97&&Q.path.charCodeAt(1)<=122)&&Q.path.charCodeAt(2)===58?U?Q.path.substr(1):Q.path[1].toLowerCase()+Q.path.substr(2):Q.path,i&&(Z=Z.replace(/\//g,"\\")),Z}s(b,"v");function S(Q,U){let Z=U?E:y,J="",{scheme:j,authority:W,path:X,query:oe,fragment:te}=Q;if(j&&(J+=j,J+=":"),(W||j==="file")&&(J+=f,J+=f),W){let re=W.indexOf("@");if(re!==-1){let pe=W.substr(0,re);W=W.substr(re+1),re=pe.lastIndexOf(":"),re===-1?J+=Z(pe,!1,!1):(J+=Z(pe.substr(0,re),!1,!1),J+=":",J+=Z(pe.substr(re+1),!1,!0)),J+="@"}W=W.toLowerCase(),re=W.lastIndexOf(":"),re===-1?J+=Z(W,!1,!0):(J+=Z(W.substr(0,re),!1,!0),J+=W.substr(re))}if(X){if(X.length>=3&&X.charCodeAt(0)===47&&X.charCodeAt(2)===58){let re=X.charCodeAt(1);re>=65&&re<=90&&(X=`/${String.fromCharCode(re+32)}:${X.substr(3)}`)}else if(X.length>=2&&X.charCodeAt(1)===58){let re=X.charCodeAt(0);re>=65&&re<=90&&(X=`${String.fromCharCode(re+32)}:${X.substr(2)}`)}J+=Z(X,!0,!1)}return oe&&(J+="?",J+=Z(oe,!1,!1)),te&&(J+="#",J+=U?te:y(te,!1,!1)),J}s(S,"b");function R(Q){try{return decodeURIComponent(Q)}catch{return Q.length>3?Q.substr(0,3)+R(Q.substr(3)):Q}}s(R,"C");let B=/(%[0-9A-Za-z][0-9A-Za-z])+/g;function L(Q){return Q.match(B)?Q.replace(B,U=>R(U)):Q}s(L,"w");var O=r(975);let Y=O.posix||O,V="/";var z;(function(Q){Q.joinPath=function(U,...Z){return U.with({path:Y.join(U.path,...Z)})},Q.resolvePath=function(U,...Z){let J=U.path,j=!1;J[0]!==V&&(J=V+J,j=!0);let W=Y.resolve(J,...Z);return j&&W[0]===V&&!U.authority&&(W=W.substring(1)),U.with({path:W})},Q.dirname=function(U){if(U.path.length===0||U.path===V)return U;let Z=Y.dirname(U.path);return Z.length===1&&Z.charCodeAt(0)===46&&(Z=""),U.with({path:Z})},Q.basename=function(U){return Y.basename(U.path)},Q.extname=function(U){return Y.extname(U.path)}})(z||(z={})),M3e=n})();var{URI:CI,Utils:qF}=M3e;function O3e(t){try{return decodeURIComponent(t)}catch{return t.length>3?t.substring(0,3)+O3e(t.substring(3)):t}}s(O3e,"decodeURIComponentGraceful");var L3e=/(%[0-9A-Za-z][0-9A-Za-z])+/g;function Yfe(t){return t.match(L3e)?t.replace(L3e,e=>O3e(e)):t}s(Yfe,"percentDecode");function kl(t){if(/^[A-Za-z][A-Za-z0-9+.-]+:/.test(t))throw new Error("Path must not contain a scheme");if(!t)throw new Error("Path must not be empty");return CI.file(t).toString()}s(kl,"makeFsUri");function q_(t){if(typeof t!="string"&&(t=t.uri),/^[A-Za-z]:\\/.test(t))throw new Error(`Could not parse <${t}>: Windows-style path`);try{let e=t.match(/^(?:([^:/?#]+?:)?\/\/)(\/\/.*)$/);return e?CI.parse(e[1]+e[2],!0):CI.parse(t,!0)}catch(e){throw new Error(`Could not parse <${t}>`,{cause:e})}}s(q_,"parseUri");function wj(t){return q_(t),t}s(wj,"validateUri");function Pl(t){try{return q_(t).toString()}catch{return t}}s(Pl,"normalizeUri");var Q3e=new Set(["file","notebook","vscode-notebook","vscode-notebook-cell"]);function sc(t){let e=q_(t);if(!Q3e.has(e.scheme))throw new Error(`Copilot currently does not support URI with scheme: ${e.scheme}`);if((0,F3e.platform)()==="win32"){let r=e.path;return e.authority?r=`//${e.authority}${e.path}`:/^\/[A-Za-z]:/.test(r)&&(r=r.substring(1)),(0,Tj.normalize)(r)}else{if(e.authority)throw new Error("Unsupported remote file path");return e.path}}s(sc,"fsPath");function ts(t){try{return sc(t)}catch{return}}s(ts,"getFsPath");function U3e(t){let e=ts(t);if(e)return CI.file(e).toString()}s(U3e,"getFsUri");function H_(t,...e){let r,n=ts(t);return n?r=kl((0,Tj.resolve)(n,...e)):r=qF.resolvePath(q_(t),...e.map(i=>q3e(i))).toString(),typeof t=="string"?r:{uri:r}}s(H_,"resolveFilePath");function Vi(t,...e){let r=qF.joinPath(q_(t),...e.map(q3e)).toString();return typeof t=="string"?r:{uri:r}}s(Vi,"joinPath");function q3e(t){return dwt(t)?t.replaceAll("\\","/"):t}s(q3e,"pathToURIPath");function dwt(t){return/^[^/\\]*\\/.test(t)}s(dwt,"isWinPath");function Pi(t){return Yfe((typeof t=="string"?t:t.uri).replace(/[#?].*$/,"").replace(/\/$/,"").replace(/^.*[/:]/,""))}s(Pi,"basename");function wd(t){let e=qF.dirname(q_(t)),r;return Q3e.has(e.scheme)&&e.scheme!=="file"?r=e.with({scheme:"file",fragment:""}).toString():r=e.toString(),typeof t=="string"?r:{uri:r}}s(wd,"dirname");function H3e(t){return qF.extname(q_(t))}s(H3e,"extname");var df=class{static{s(this,"NetworkConfiguration")}};function Sj(t,e){try{let r=new URL(e??"");if(r.protocol==="https:"||!Xfe(t)&&r.protocol==="http:")return r.href}catch{}}s(Sj,"ensurePermittedUrl");var $_={api:"https://api.githubcopilot.com",proxy:"https://copilot-proxy.githubusercontent.com",telemetry:"https://copilot-telemetry.githubusercontent.com","origin-tracker":"https://origin-tracker.githubusercontent.com"};function Jfe(t,e,r){if(r&&Kg(t)){for(let n of r){let i=zi(t,n);if(i)return i}return}for(let n of e){let i=zi(t,n);if(i)return i}}s(Jfe,"urlConfigOverride");function fwt(t,e){switch(e){case"api":return Jfe(t,[Ht.DebugOverrideCapiUrl,Ht.DebugOverrideCapiUrlLegacy],[Ht.DebugTestOverrideCapiUrl,Ht.DebugTestOverrideCapiUrlLegacy]);case"proxy":return Jfe(t,[Ht.DebugOverrideProxyUrl,Ht.DebugOverrideProxyUrlLegacy],[Ht.DebugTestOverrideProxyUrl,Ht.DebugTestOverrideProxyUrlLegacy]);case"origin-tracker":if(!Xfe(t))return Jfe(t,[Ht.DebugSnippyOverrideUrl])}}s(fwt,"getEndpointOverrideUrl");function qm(t,e,r,...n){let i=fwt(t,r)??e.endpoints[r];return Vi(i,...n)}s(qm,"getEndpointUrl");function L4(t){return _j(t)?.endpoints??$_}s(L4,"getLastKnownEndpoints");function $3e(t,e){if(e&&!Sj(t,e)){t.get(wa).showWarningMessage(`Ignoring invalid or unsupported authentication URL "${e}".`);return}t.get(df).setConfiguredUrls(t,{serverUrl:e})}s($3e,"updateServerUrl");d();d();var Sa=class extends Error{static{s(this,"CopilotAuthError")}constructor(e,r){super(e,{cause:r}),this.name="CopilotAuthError"}};d();d();var Hm=class t{static{s(this,"ExpConfig")}constructor(e,r,n){this.variables=e,this.assignmentContext=r,this.features=n}static createFallbackConfig(e,r){return Rj(e,{reason:r}),this.createEmptyConfig()}static createEmptyConfig(){return new t({},"","")}addToTelemetry(e){e.properties["VSCode.ABExp.Features"]=this.features,e.properties["abexp.assignmentcontext"]=this.assignmentContext}};d();var rp="X-Copilot-RelatedPluginVersion-",F4=(te=>(te.Market="X-MSEdge-Market",te.CorpNet="X-FD-Corpnet",te.Build="X-VSCode-Build",te.ApplicationVersion="X-VSCode-AppVersion",te.TargetPopulation="X-VSCode-TargetPopulation",te.ClientId="X-MSEdge-ClientId",te.ExtensionName="X-VSCode-ExtensionName",te.ExtensionVersion="X-VSCode-ExtensionVersion",te.ExtensionRelease="X-VSCode-ExtensionRelease",te.CompletionsInChatExtensionVersion="X-VSCode-CompletionsInChatExtensionVersion",te.Language="X-VSCode-Language",te.CopilotClientTimeBucket="X-Copilot-ClientTimeBucket",te.CopilotEngine="X-Copilot-Engine",te.CopilotOverrideEngine="X-Copilot-OverrideEngine",te.CopilotRepository="X-Copilot-Repository",te.CopilotFileType="X-Copilot-FileType",te.CopilotUserKind="X-Copilot-UserKind",te.CopilotDogfood="X-Copilot-Dogfood",te.CopilotCustomModel="X-Copilot-CustomModel",te.CopilotOrgs="X-Copilot-Orgs",te.CopilotCustomModelNames="X-Copilot-CustomModelNames",te.CopilotTrackingId="X-Copilot-CopilotTrackingId",te.CopilotClientVersion="X-Copilot-ClientVersion",te.CopilotRelatedPluginVersionCppTools=rp+"msvscodecpptools",te.CopilotRelatedPluginVersionCMakeTools=rp+"msvscodecmaketools",te.CopilotRelatedPluginVersionMakefileTools=rp+"msvscodemakefiletools",te.CopilotRelatedPluginVersionCSharpDevKit=rp+"msdotnettoolscsdevkit",te.CopilotRelatedPluginVersionPython=rp+"mspythonpython",te.CopilotRelatedPluginVersionPylance=rp+"mspythonvscodepylance",te.CopilotRelatedPluginVersionJavaPack=rp+"vscjavavscodejavapack",te.CopilotRelatedPluginVersionTypescript=rp+"vscodetypescriptlanguagefeatures",te.CopilotRelatedPluginVersionTypescriptNext=rp+"msvscodevscodetypescriptnext",te.CopilotRelatedPluginVersionCSharp=rp+"msdotnettoolscsharp",te.CopilotRelatedPluginVersionGithubCopilotChat=rp+"githubcopilotchat",te.CopilotRelatedPluginVersionGithubCopilot=rp+"githubcopilot",te))(F4||{});var pwt={"X-Copilot-ClientTimeBucket":"timeBucket","X-Copilot-OverrideEngine":"engine","X-Copilot-Repository":"repo","X-Copilot-FileType":"fileType","X-Copilot-UserKind":"userKind"},W_=class t{constructor(e){this.filters=e;for(let[r,n]of Object.entries(this.filters))n===""&&delete this.filters[r]}static{s(this,"FilterSettings")}extends(e){for(let[r,n]of Object.entries(e.filters))if(this.filters[r]!==n)return!1;return!0}addToTelemetry(e){for(let[r,n]of Object.entries(this.filters)){let i=pwt[r];i!==void 0&&(e.properties[i]=n)}}stringify(){let e=Object.keys(this.filters);return e.sort(),e.map(r=>`${r}:${this.filters[r]}`).join(";")}toHeaders(){return{...this.filters}}withChange(e,r){return new t({...this.filters,[e]:r})}};d();d();d();function _a(t,e){let r=Xl(t,e,"event.CopilotToken");return t.get(ar).onDidChangeTokenResult(n=>{n.copilotToken&&r(n.copilotToken)})}s(_a,"onCopilotToken");function Zfe(t){let e=t.getTokenValue("tid"),r=t.organization_list,n=t.enterprise_list,i=t.getTokenValue("sku");if(!e)return;let o={copilot_trackingId:e};return r&&(o.organizations_list=r.toString()),n&&(o.enterprise_list=n.toString()),i&&(o.sku=i),o}s(Zfe,"propertiesFromCopilotToken");var Ou=class{constructor(e){this.#e={};this.optedIn=!1;this.ftFlag="";_a(e,r=>this.updateFromToken(r))}static{s(this,"TelemetryUserConfig")}#e;getProperties(){return this.#e}get trackingId(){return this.#e.copilot_trackingId}updateFromToken(e){let r=Zfe(e);r&&(this.#e=r,this.optedIn=e.getTokenValue("rt")==="1",this.ftFlag=e.getTokenValue("ft")??"")}};var kj=Be(yI()),Pj=Be(require("os"));var mwt=/^(\s+at)?(.*?)(@|\s\(|\s)([^(\n]+?)(:\d+)?(:\d+)?(\)?)$/;function hwt(t){let e={type:t.name,value:t.message},r=t.stack?.replace(/^.*?:\d+\n.*\n *\^?\n\n/,"");if(r?.startsWith(t.toString()+`
`)){e.stacktrace=[];for(let n of r.slice(t.toString().length+1).split(/\n/).reverse()){let i=n.match(mwt),o={filename:"",function:""};i&&(o.function=i[2]?.trim()?.replace(/^[^.]{1,2}(\.|$)/,"_$1")??o.function,o.filename=(i[4]?.trim()??o.filename).replace(/^\.\/dist\//,"/github-copilot/dist/"),i[5]&&i[5]!==":0"&&(o.lineno=i[5].slice(1)),i[6]&&i[5]!==":0"&&(o.colno=i[6].slice(1)),o.in_app=!/[[<:]|(?:^|\/)node_modules\//.test(o.filename)),e.stacktrace.push(o)}}return e}s(hwt,"buildExceptionDetail");function epe(t,e){let r=t.get(cn),n=r.getEditorInfo(),i=t.get(Ou),o={"#editor":n.devName??n.name,"#editor_version":oC({name:n.devName??n.name,version:n.version}),"#plugin":r.getEditorPluginInfo().name,"#plugin_version":oC(r.getEditorPluginInfo()),"#session_id":t.get(Ms).sessionId,"#machine_id":t.get(Ms).machineId,"#architecture":Pj.arch(),"#os_platform":Pj.platform(),...e};return i.trackingId&&(o.user=i.trackingId,o["#tracking_id"]=i.trackingId),o}s(epe,"buildContext");function j3e(t,e){let r=t.get(To),n=t.get(cn).getEditorInfo(),i=typeof process<"u"?process.versions.node:"web",o={app:"copilot-client",rollup_id:"auto",platform:"node",release:r.getBuildType()!=="dev"?`copilot-client@${r.getVersion()}`:void 0,deployed_to:r.getBuildType(),catalog_service:n.name==="vscode"?"CopilotCompletionsVSCode":"CopilotLanguageServer",context:epe(t,{"#node_version":i}),sensitive_context:{}},a=[];o.exception_detail=[];let c=0,l=e;for(;l instanceof Error&&c<10;){let f=hwt(l);o.exception_detail.unshift(f),a.unshift([l,f]),c+=1,l=l.cause}let u=[];for(let[f,p]of a)if(p.stacktrace&&p.stacktrace.length>0){u.push(`${p.type}: ${f.code??""}`);let m=[...p.stacktrace].reverse();for(let h of m)if(h.filename?.startsWith("/github-copilot/"))return o;for(let h of m)if(h.in_app){u.push(`${h.filename?.replace(/^\.\//,"")}:${h.lineno}:${h.colno}`);break}u.push(`${m[0].filename?.replace(/^\.\//,"")}`)}else return o;return o.exception_detail.length>0&&(o.rollup_id=(0,kj.SHA256)(kj.enc.Utf16.parse(u.join(`
`))).toString()),o}s(j3e,"buildPayload");d();var HF=class{static{s(this,"FailingTelemetryReporter")}sendTelemetryEvent(e,r,n){throw new Error("Telemetry disabled")}sendTelemetryErrorEvent(e,r,n,i){throw new Error("Telemetry disabled")}dispose(){return Promise.resolve()}hackOptOutListener(){}};d();var sC=class{constructor(e=5){this.perTenMinutes=e;this.cache=new Sr}static{s(this,"ExceptionRateLimiter")}isThrottled(e){let r=Date.now(),n=this.cache.get(e)||new Array(this.perTenMinutes).fill(0);return r-n[0]<6e5?!0:(n.push(r),n.shift(),this.cache.set(e,n),!1)}};d();var Zc=class{constructor(){this.promises=new Set}static{s(this,"PromiseQueue")}register(e){this.promises.add(e),e.finally(()=>this.promises.delete(e))}async flush(){await Promise.allSettled(this.promises)}};d();var K3e=require("os"),Y3e=Be(require("path"));function $F(t){return t.replace(/(file:\/\/)([^\s<>]+)/gi,"$1[redacted]").replace(/(^|[\s|:=(<'"`])((?:\/(?=[^/])|\\|[a-zA-Z]:[\\/])[^\s:)>'"`]+)/g,"$1[redacted]")}s($F,"redactPaths");var gwt=new Set(["Maximum call stack size exceeded","Set maximum size exceeded","Invalid arguments"]),Awt=[/^[\p{L}\p{Nl}$\p{Mn}\p{Mc}\p{Nd}\p{Pc}.]+ is not a function[ \w]*$/u,/^Cannot read properties of undefined \(reading '[\p{L}\p{Nl}$\p{Mn}\p{Mc}\p{Nd}\p{Pc}]+'\)$/u];function rpe(t){if(gwt.has(t))return t;for(let e of Awt)if(e.test(t))return t;return $F(t).replace(/\bDNS:(?:\*\.)?[\w.-]+/gi,"DNS:[redacted]")}s(rpe,"redactMessage");function Bj(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}s(Bj,"escapeForRegExp");var ywt=new RegExp("(?<=^|[\\s|(\"'`]|file://)"+Bj((0,K3e.homedir)())+"(?=$|[\\\\/:\"'`])","gi");function tpe(t){return t.replace(ywt,"~")}s(tpe,"redactHomeDir");var J3e="[\\\\/]?([^:)]*)(?=:\\d)",V3e=new RegExp(Bj(Y3e.sep),"g"),z3e=new RegExp(Bj(__dirname.replace(/[\\/]lib[\\/]src[\\/]util$|[\\/]dist$/,""))+J3e,"gi");function npe(t,e,r=!1,n=[]){let i=new Error(e(t));i.name=t.name,typeof t.syscall=="string"&&(i.syscall=t.syscall),typeof t.code=="string"&&(i.code=t.code),typeof t.errno=="number"&&(i.errno=t.errno),i.stack=void 0;let o=t.stack?.replace(/^.*?:\d+\n.*\n *\^?\n\n/,""),a;for(let c of[t.toString(),`${t.name}: ${t.message}`])if(o?.startsWith(c+`
`)){a=o.slice(c.length+1).split(/\n/);break}if(a){i.stack=i.toString();for(let c of a)if(z3e.test(c))i.stack+=`
${$F(c.replace(z3e,(l,u)=>"./"+u.replace(V3e,"/")))}`;else if(/[ (]node:|[ (]wasm:\/\/wasm\/| \(<anonymous>\)$/.test(c))i.stack+=`
${$F(c)}`;else{let l=!1;for(let{prefix:u,path:f}of n){let p=new RegExp(Bj(f.replace(/[\\/]$/,""))+J3e,"gi");if(p.test(c)){i.stack+=`
${$F(c.replace(p,(m,h)=>u+h.replace(V3e,"/")))}`,l=!0;break}}if(l)continue;r?i.stack+=`
${tpe(c)}`:i.stack+=`
    at [redacted]:0:0`}}else r&&o&&(i.stack=tpe(o));return t.cause instanceof Error&&(i.cause=npe(t.cause,e,r,n)),i}s(npe,"cloneError");function X3e(t){let e=t.message;return typeof t.path=="string"&&t.path.length>0&&(e=e.replaceAll(t.path,"<path>")),e}s(X3e,"errorMessageWithoutPath");function Z3e(t,e){return npe(t,s(function(n){return tpe(X3e(n))},"prepareMessage"),!0,e)}s(Z3e,"prepareErrorForRestrictedTelemetry");function eNe(t,e,r=!1){return npe(t,s(function(i){if(r)return rpe(X3e(i));let o="[redacted]";return typeof i.code=="string"&&(o=i.code+" "+o),typeof i.syscall=="string"?o=$F(i.syscall)+" "+o:"erroredSysCall"in i&&typeof i.erroredSysCall=="string"&&(o=i.erroredSysCall+" "+o),o},"prepareMessage"),!1,e)}s(eNe,"redactError");d();d();var Sd={};Ia(Sd,{HasPropertyKey:()=>Nj,IsArray:()=>Dc,IsAsyncIterator:()=>ipe,IsBigInt:()=>WF,IsBoolean:()=>Bv,IsDate:()=>j_,IsFunction:()=>ope,IsIterator:()=>spe,IsNull:()=>ape,IsNumber:()=>m0,IsObject:()=>as,IsRegExp:()=>jF,IsString:()=>ws,IsSymbol:()=>cpe,IsUint8Array:()=>Nv,IsUndefined:()=>Bc});d();function Nj(t,e){return e in t}s(Nj,"HasPropertyKey");function ipe(t){return as(t)&&!Dc(t)&&!Nv(t)&&Symbol.asyncIterator in t}s(ipe,"IsAsyncIterator");function Dc(t){return Array.isArray(t)}s(Dc,"IsArray");function WF(t){return typeof t=="bigint"}s(WF,"IsBigInt");function Bv(t){return typeof t=="boolean"}s(Bv,"IsBoolean");function j_(t){return t instanceof globalThis.Date}s(j_,"IsDate");function ope(t){return typeof t=="function"}s(ope,"IsFunction");function spe(t){return as(t)&&!Dc(t)&&!Nv(t)&&Symbol.iterator in t}s(spe,"IsIterator");function ape(t){return t===null}s(ape,"IsNull");function m0(t){return typeof t=="number"}s(m0,"IsNumber");function as(t){return typeof t=="object"&&t!==null}s(as,"IsObject");function jF(t){return t instanceof globalThis.RegExp}s(jF,"IsRegExp");function ws(t){return typeof t=="string"}s(ws,"IsString");function cpe(t){return typeof t=="symbol"}s(cpe,"IsSymbol");function Nv(t){return t instanceof globalThis.Uint8Array}s(Nv,"IsUint8Array");function Bc(t){return t===void 0}s(Bc,"IsUndefined");function Cwt(t){return t.map(e=>Mj(e))}s(Cwt,"ArrayType");function vwt(t){return new Date(t.getTime())}s(vwt,"DateType");function xwt(t){return new Uint8Array(t)}s(xwt,"Uint8ArrayType");function Ewt(t){return new RegExp(t.source,t.flags)}s(Ewt,"RegExpType");function bwt(t){let e={};for(let r of Object.getOwnPropertyNames(t))e[r]=Mj(t[r]);for(let r of Object.getOwnPropertySymbols(t))e[r]=Mj(t[r]);return e}s(bwt,"ObjectType");function Mj(t){return Dc(t)?Cwt(t):j_(t)?vwt(t):Nv(t)?xwt(t):jF(t)?Ewt(t):as(t)?bwt(t):t}s(Mj,"Visit");function Js(t){return Mj(t)}s(Js,"Clone");function O4(t,e){return e===void 0?Js(t):Js({...e,...t})}s(O4,"CloneType");d();d();d();function Lj(t){return _i(t)&&globalThis.Symbol.asyncIterator in t}s(Lj,"IsAsyncIterator");function Fj(t){return _i(t)&&globalThis.Symbol.iterator in t}s(Fj,"IsIterator");function lpe(t){return _i(t)&&(globalThis.Object.getPrototypeOf(t)===Object.prototype||globalThis.Object.getPrototypeOf(t)===null)}s(lpe,"IsStandardObject");function Oj(t){return t instanceof globalThis.Promise}s(Oj,"IsPromise");function ff(t){return t instanceof Date&&globalThis.Number.isFinite(t.getTime())}s(ff,"IsDate");function tNe(t){return t instanceof globalThis.Map}s(tNe,"IsMap");function rNe(t){return t instanceof globalThis.Set}s(rNe,"IsSet");function $m(t){return globalThis.ArrayBuffer.isView(t)}s($m,"IsTypedArray");function Q4(t){return t instanceof globalThis.Uint8Array}s(Q4,"IsUint8Array");function Pn(t,e){return e in t}s(Pn,"HasPropertyKey");function _i(t){return t!==null&&typeof t=="object"}s(_i,"IsObject");function Dn(t){return globalThis.Array.isArray(t)&&!globalThis.ArrayBuffer.isView(t)}s(Dn,"IsArray");function Xs(t){return t===void 0}s(Xs,"IsUndefined");function Mv(t){return t===null}s(Mv,"IsNull");function aC(t){return typeof t=="boolean"}s(aC,"IsBoolean");function ln(t){return typeof t=="number"}s(ln,"IsNumber");function Qj(t){return globalThis.Number.isInteger(t)}s(Qj,"IsInteger");function Qu(t){return typeof t=="bigint"}s(Qu,"IsBigInt");function Co(t){return typeof t=="string"}s(Co,"IsString");function vI(t){return typeof t=="function"}s(vI,"IsFunction");function Lv(t){return typeof t=="symbol"}s(Lv,"IsSymbol");function h0(t){return Qu(t)||aC(t)||Mv(t)||ln(t)||Co(t)||Lv(t)||Xs(t)}s(h0,"IsValueType");var Ls;(function(t){t.InstanceMode="default",t.ExactOptionalPropertyTypes=!1,t.AllowArrayObject=!1,t.AllowNaN=!1,t.AllowNullVoid=!1;function e(a,c){return t.ExactOptionalPropertyTypes?c in a:a[c]!==void 0}s(e,"IsExactOptionalProperty"),t.IsExactOptionalProperty=e;function r(a){let c=_i(a);return t.AllowArrayObject?c:c&&!Dn(a)}s(r,"IsObjectLike"),t.IsObjectLike=r;function n(a){return r(a)&&!(a instanceof Date)&&!(a instanceof Uint8Array)}s(n,"IsRecordLike"),t.IsRecordLike=n;function i(a){return t.AllowNaN?ln(a):Number.isFinite(a)}s(i,"IsNumberLike"),t.IsNumberLike=i;function o(a){let c=Xs(a);return t.AllowNullVoid?c||a===null:c}s(o,"IsVoidLike"),t.IsVoidLike=o})(Ls||(Ls={}));d();function Iwt(t){return globalThis.Object.freeze(t).map(e=>GF(e))}s(Iwt,"ImmutableArray");function Twt(t){let e={};for(let r of Object.getOwnPropertyNames(t))e[r]=GF(t[r]);for(let r of Object.getOwnPropertySymbols(t))e[r]=GF(t[r]);return globalThis.Object.freeze(e)}s(Twt,"ImmutableObject");function GF(t){return Dc(t)?Iwt(t):j_(t)?t:Nv(t)?t:jF(t)?t:as(t)?Twt(t):t}s(GF,"Immutable");function at(t,e){let r=e!==void 0?{...e,...t}:t;switch(Ls.InstanceMode){case"freeze":return GF(r);case"clone":return Js(r);default:return r}}s(at,"CreateType");d();var Bn=class extends Error{static{s(this,"TypeBoxError")}constructor(e){super(e)}};d();d();d();var Ra=Symbol.for("TypeBox.Transform"),Yg=Symbol.for("TypeBox.Readonly"),Uu=Symbol.for("TypeBox.Optional"),Wm=Symbol.for("TypeBox.Hint"),ot=Symbol.for("TypeBox.Kind");function U4(t){return as(t)&&t[Yg]==="Readonly"}s(U4,"IsReadonly");function np(t){return as(t)&&t[Uu]==="Optional"}s(np,"IsOptional");function upe(t){return ao(t,"Any")}s(upe,"IsAny");function dpe(t){return ao(t,"Argument")}s(dpe,"IsArgument");function Jg(t){return ao(t,"Array")}s(Jg,"IsArray");function G_(t){return ao(t,"AsyncIterator")}s(G_,"IsAsyncIterator");function V_(t){return ao(t,"BigInt")}s(V_,"IsBigInt");function Fv(t){return ao(t,"Boolean")}s(Fv,"IsBoolean");function Xg(t){return ao(t,"Computed")}s(Xg,"IsComputed");function Zg(t){return ao(t,"Constructor")}s(Zg,"IsConstructor");function wwt(t){return ao(t,"Date")}s(wwt,"IsDate");function eA(t){return ao(t,"Function")}s(eA,"IsFunction");function tA(t){return ao(t,"Integer")}s(tA,"IsInteger");function Ga(t){return ao(t,"Intersect")}s(Ga,"IsIntersect");function z_(t){return ao(t,"Iterator")}s(z_,"IsIterator");function ao(t,e){return as(t)&&ot in t&&t[ot]===e}s(ao,"IsKindOf");function Uj(t){return Bv(t)||m0(t)||ws(t)}s(Uj,"IsLiteralValue");function g0(t){return ao(t,"Literal")}s(g0,"IsLiteral");function A0(t){return ao(t,"MappedKey")}s(A0,"IsMappedKey");function Zs(t){return ao(t,"MappedResult")}s(Zs,"IsMappedResult");function xI(t){return ao(t,"Never")}s(xI,"IsNever");function Swt(t){return ao(t,"Not")}s(Swt,"IsNot");function VF(t){return ao(t,"Null")}s(VF,"IsNull");function rA(t){return ao(t,"Number")}s(rA,"IsNumber");function Nc(t){return ao(t,"Object")}s(Nc,"IsObject");function K_(t){return ao(t,"Promise")}s(K_,"IsPromise");function Y_(t){return ao(t,"Record")}s(Y_,"IsRecord");function ac(t){return ao(t,"Ref")}s(ac,"IsRef");function fpe(t){return ao(t,"RegExp")}s(fpe,"IsRegExp");function Ov(t){return ao(t,"String")}s(Ov,"IsString");function zF(t){return ao(t,"Symbol")}s(zF,"IsSymbol");function y0(t){return ao(t,"TemplateLiteral")}s(y0,"IsTemplateLiteral");function _wt(t){return ao(t,"This")}s(_wt,"IsThis");function Oo(t){return as(t)&&Ra in t}s(Oo,"IsTransform");function C0(t){return ao(t,"Tuple")}s(C0,"IsTuple");function Qv(t){return ao(t,"Undefined")}s(Qv,"IsUndefined");function vo(t){return ao(t,"Union")}s(vo,"IsUnion");function Rwt(t){return ao(t,"Uint8Array")}s(Rwt,"IsUint8Array");function kwt(t){return ao(t,"Unknown")}s(kwt,"IsUnknown");function Pwt(t){return ao(t,"Unsafe")}s(Pwt,"IsUnsafe");function Dwt(t){return ao(t,"Void")}s(Dwt,"IsVoid");function EI(t){return as(t)&&ot in t&&ws(t[ot])}s(EI,"IsKind");function ka(t){return upe(t)||dpe(t)||Jg(t)||Fv(t)||V_(t)||G_(t)||Xg(t)||Zg(t)||wwt(t)||eA(t)||tA(t)||Ga(t)||z_(t)||g0(t)||A0(t)||Zs(t)||xI(t)||Swt(t)||VF(t)||rA(t)||Nc(t)||K_(t)||Y_(t)||ac(t)||fpe(t)||Ov(t)||zF(t)||y0(t)||_wt(t)||C0(t)||Qv(t)||vo(t)||Rwt(t)||kwt(t)||Pwt(t)||Dwt(t)||EI(t)}s(ka,"IsSchema");var Le={};Ia(Le,{IsAny:()=>sNe,IsArgument:()=>aNe,IsArray:()=>cNe,IsAsyncIterator:()=>lNe,IsBigInt:()=>uNe,IsBoolean:()=>dNe,IsComputed:()=>fNe,IsConstructor:()=>pNe,IsDate:()=>mNe,IsFunction:()=>hNe,IsImport:()=>Owt,IsInteger:()=>gNe,IsIntersect:()=>ANe,IsIterator:()=>yNe,IsKind:()=>WNe,IsKindOf:()=>Hi,IsLiteral:()=>YF,IsLiteralBoolean:()=>Qwt,IsLiteralNumber:()=>vNe,IsLiteralString:()=>CNe,IsLiteralValue:()=>xNe,IsMappedKey:()=>ENe,IsMappedResult:()=>bNe,IsNever:()=>INe,IsNot:()=>TNe,IsNull:()=>wNe,IsNumber:()=>SNe,IsObject:()=>_Ne,IsOptional:()=>Fwt,IsPromise:()=>RNe,IsProperties:()=>qj,IsReadonly:()=>Lwt,IsRecord:()=>kNe,IsRecursive:()=>Uwt,IsRef:()=>PNe,IsRegExp:()=>DNe,IsSchema:()=>ea,IsString:()=>BNe,IsSymbol:()=>NNe,IsTemplateLiteral:()=>MNe,IsThis:()=>LNe,IsTransform:()=>FNe,IsTuple:()=>ONe,IsUint8Array:()=>UNe,IsUndefined:()=>QNe,IsUnion:()=>gpe,IsUnionLiteral:()=>qwt,IsUnknown:()=>qNe,IsUnsafe:()=>HNe,IsVoid:()=>$Ne,TypeGuardUnknownTypeError:()=>ppe});d();var ppe=class extends Bn{static{s(this,"TypeGuardUnknownTypeError")}},Bwt=["Argument","Any","Array","AsyncIterator","BigInt","Boolean","Computed","Constructor","Date","Enum","Function","Integer","Intersect","Iterator","Literal","MappedKey","MappedResult","Not","Null","Number","Object","Promise","Record","Ref","RegExp","String","Symbol","TemplateLiteral","This","Tuple","Undefined","Union","Uint8Array","Unknown","Void"];function nNe(t){try{return new RegExp(t),!0}catch{return!1}}s(nNe,"IsPattern");function mpe(t){if(!ws(t))return!1;for(let e=0;e<t.length;e++){let r=t.charCodeAt(e);if(r>=7&&r<=13||r===27||r===127)return!1}return!0}s(mpe,"IsControlCharacterFree");function iNe(t){return hpe(t)||ea(t)}s(iNe,"IsAdditionalProperties");function KF(t){return Bc(t)||WF(t)}s(KF,"IsOptionalBigInt");function Ss(t){return Bc(t)||m0(t)}s(Ss,"IsOptionalNumber");function hpe(t){return Bc(t)||Bv(t)}s(hpe,"IsOptionalBoolean");function cs(t){return Bc(t)||ws(t)}s(cs,"IsOptionalString");function Nwt(t){return Bc(t)||ws(t)&&mpe(t)&&nNe(t)}s(Nwt,"IsOptionalPattern");function Mwt(t){return Bc(t)||ws(t)&&mpe(t)}s(Mwt,"IsOptionalFormat");function oNe(t){return Bc(t)||ea(t)}s(oNe,"IsOptionalSchema");function Lwt(t){return as(t)&&t[Yg]==="Readonly"}s(Lwt,"IsReadonly");function Fwt(t){return as(t)&&t[Uu]==="Optional"}s(Fwt,"IsOptional");function sNe(t){return Hi(t,"Any")&&cs(t.$id)}s(sNe,"IsAny");function aNe(t){return Hi(t,"Argument")&&m0(t.index)}s(aNe,"IsArgument");function cNe(t){return Hi(t,"Array")&&t.type==="array"&&cs(t.$id)&&ea(t.items)&&Ss(t.minItems)&&Ss(t.maxItems)&&hpe(t.uniqueItems)&&oNe(t.contains)&&Ss(t.minContains)&&Ss(t.maxContains)}s(cNe,"IsArray");function lNe(t){return Hi(t,"AsyncIterator")&&t.type==="AsyncIterator"&&cs(t.$id)&&ea(t.items)}s(lNe,"IsAsyncIterator");function uNe(t){return Hi(t,"BigInt")&&t.type==="bigint"&&cs(t.$id)&&KF(t.exclusiveMaximum)&&KF(t.exclusiveMinimum)&&KF(t.maximum)&&KF(t.minimum)&&KF(t.multipleOf)}s(uNe,"IsBigInt");function dNe(t){return Hi(t,"Boolean")&&t.type==="boolean"&&cs(t.$id)}s(dNe,"IsBoolean");function fNe(t){return Hi(t,"Computed")&&ws(t.target)&&Dc(t.parameters)&&t.parameters.every(e=>ea(e))}s(fNe,"IsComputed");function pNe(t){return Hi(t,"Constructor")&&t.type==="Constructor"&&cs(t.$id)&&Dc(t.parameters)&&t.parameters.every(e=>ea(e))&&ea(t.returns)}s(pNe,"IsConstructor");function mNe(t){return Hi(t,"Date")&&t.type==="Date"&&cs(t.$id)&&Ss(t.exclusiveMaximumTimestamp)&&Ss(t.exclusiveMinimumTimestamp)&&Ss(t.maximumTimestamp)&&Ss(t.minimumTimestamp)&&Ss(t.multipleOfTimestamp)}s(mNe,"IsDate");function hNe(t){return Hi(t,"Function")&&t.type==="Function"&&cs(t.$id)&&Dc(t.parameters)&&t.parameters.every(e=>ea(e))&&ea(t.returns)}s(hNe,"IsFunction");function Owt(t){return Hi(t,"Import")&&Nj(t,"$defs")&&as(t.$defs)&&qj(t.$defs)&&Nj(t,"$ref")&&ws(t.$ref)&&t.$ref in t.$defs}s(Owt,"IsImport");function gNe(t){return Hi(t,"Integer")&&t.type==="integer"&&cs(t.$id)&&Ss(t.exclusiveMaximum)&&Ss(t.exclusiveMinimum)&&Ss(t.maximum)&&Ss(t.minimum)&&Ss(t.multipleOf)}s(gNe,"IsInteger");function qj(t){return as(t)&&Object.entries(t).every(([e,r])=>mpe(e)&&ea(r))}s(qj,"IsProperties");function ANe(t){return Hi(t,"Intersect")&&!(ws(t.type)&&t.type!=="object")&&Dc(t.allOf)&&t.allOf.every(e=>ea(e)&&!FNe(e))&&cs(t.type)&&(hpe(t.unevaluatedProperties)||oNe(t.unevaluatedProperties))&&cs(t.$id)}s(ANe,"IsIntersect");function yNe(t){return Hi(t,"Iterator")&&t.type==="Iterator"&&cs(t.$id)&&ea(t.items)}s(yNe,"IsIterator");function Hi(t,e){return as(t)&&ot in t&&t[ot]===e}s(Hi,"IsKindOf");function CNe(t){return YF(t)&&ws(t.const)}s(CNe,"IsLiteralString");function vNe(t){return YF(t)&&m0(t.const)}s(vNe,"IsLiteralNumber");function Qwt(t){return YF(t)&&Bv(t.const)}s(Qwt,"IsLiteralBoolean");function YF(t){return Hi(t,"Literal")&&cs(t.$id)&&xNe(t.const)}s(YF,"IsLiteral");function xNe(t){return Bv(t)||m0(t)||ws(t)}s(xNe,"IsLiteralValue");function ENe(t){return Hi(t,"MappedKey")&&Dc(t.keys)&&t.keys.every(e=>m0(e)||ws(e))}s(ENe,"IsMappedKey");function bNe(t){return Hi(t,"MappedResult")&&qj(t.properties)}s(bNe,"IsMappedResult");function INe(t){return Hi(t,"Never")&&as(t.not)&&Object.getOwnPropertyNames(t.not).length===0}s(INe,"IsNever");function TNe(t){return Hi(t,"Not")&&ea(t.not)}s(TNe,"IsNot");function wNe(t){return Hi(t,"Null")&&t.type==="null"&&cs(t.$id)}s(wNe,"IsNull");function SNe(t){return Hi(t,"Number")&&t.type==="number"&&cs(t.$id)&&Ss(t.exclusiveMaximum)&&Ss(t.exclusiveMinimum)&&Ss(t.maximum)&&Ss(t.minimum)&&Ss(t.multipleOf)}s(SNe,"IsNumber");function _Ne(t){return Hi(t,"Object")&&t.type==="object"&&cs(t.$id)&&qj(t.properties)&&iNe(t.additionalProperties)&&Ss(t.minProperties)&&Ss(t.maxProperties)}s(_Ne,"IsObject");function RNe(t){return Hi(t,"Promise")&&t.type==="Promise"&&cs(t.$id)&&ea(t.item)}s(RNe,"IsPromise");function kNe(t){return Hi(t,"Record")&&t.type==="object"&&cs(t.$id)&&iNe(t.additionalProperties)&&as(t.patternProperties)&&(e=>{let r=Object.getOwnPropertyNames(e.patternProperties);return r.length===1&&nNe(r[0])&&as(e.patternProperties)&&ea(e.patternProperties[r[0]])})(t)}s(kNe,"IsRecord");function Uwt(t){return as(t)&&Wm in t&&t[Wm]==="Recursive"}s(Uwt,"IsRecursive");function PNe(t){return Hi(t,"Ref")&&cs(t.$id)&&ws(t.$ref)}s(PNe,"IsRef");function DNe(t){return Hi(t,"RegExp")&&cs(t.$id)&&ws(t.source)&&ws(t.flags)&&Ss(t.maxLength)&&Ss(t.minLength)}s(DNe,"IsRegExp");function BNe(t){return Hi(t,"String")&&t.type==="string"&&cs(t.$id)&&Ss(t.minLength)&&Ss(t.maxLength)&&Nwt(t.pattern)&&Mwt(t.format)}s(BNe,"IsString");function NNe(t){return Hi(t,"Symbol")&&t.type==="symbol"&&cs(t.$id)}s(NNe,"IsSymbol");function MNe(t){return Hi(t,"TemplateLiteral")&&t.type==="string"&&ws(t.pattern)&&t.pattern[0]==="^"&&t.pattern[t.pattern.length-1]==="$"}s(MNe,"IsTemplateLiteral");function LNe(t){return Hi(t,"This")&&cs(t.$id)&&ws(t.$ref)}s(LNe,"IsThis");function FNe(t){return as(t)&&Ra in t}s(FNe,"IsTransform");function ONe(t){return Hi(t,"Tuple")&&t.type==="array"&&cs(t.$id)&&m0(t.minItems)&&m0(t.maxItems)&&t.minItems===t.maxItems&&(Bc(t.items)&&Bc(t.additionalItems)&&t.minItems===0||Dc(t.items)&&t.items.every(e=>ea(e)))}s(ONe,"IsTuple");function QNe(t){return Hi(t,"Undefined")&&t.type==="undefined"&&cs(t.$id)}s(QNe,"IsUndefined");function qwt(t){return gpe(t)&&t.anyOf.every(e=>CNe(e)||vNe(e))}s(qwt,"IsUnionLiteral");function gpe(t){return Hi(t,"Union")&&cs(t.$id)&&as(t)&&Dc(t.anyOf)&&t.anyOf.every(e=>ea(e))}s(gpe,"IsUnion");function UNe(t){return Hi(t,"Uint8Array")&&t.type==="Uint8Array"&&cs(t.$id)&&Ss(t.minByteLength)&&Ss(t.maxByteLength)}s(UNe,"IsUint8Array");function qNe(t){return Hi(t,"Unknown")&&cs(t.$id)}s(qNe,"IsUnknown");function HNe(t){return Hi(t,"Unsafe")}s(HNe,"IsUnsafe");function $Ne(t){return Hi(t,"Void")&&t.type==="void"&&cs(t.$id)}s($Ne,"IsVoid");function WNe(t){return as(t)&&ot in t&&ws(t[ot])&&!Bwt.includes(t[ot])}s(WNe,"IsKind");function ea(t){return as(t)&&(sNe(t)||aNe(t)||cNe(t)||dNe(t)||uNe(t)||lNe(t)||fNe(t)||pNe(t)||mNe(t)||hNe(t)||gNe(t)||ANe(t)||yNe(t)||YF(t)||ENe(t)||bNe(t)||INe(t)||TNe(t)||wNe(t)||SNe(t)||_Ne(t)||RNe(t)||kNe(t)||PNe(t)||DNe(t)||BNe(t)||NNe(t)||MNe(t)||LNe(t)||ONe(t)||QNe(t)||gpe(t)||UNe(t)||qNe(t)||HNe(t)||$Ne(t)||WNe(t))}s(ea,"IsSchema");d();var Ape="(true|false)",JF="(0|[1-9][0-9]*)",ype="(.*)",Hwt="(?!.*)",H3r=`^${Ape}$`,cC=`^${JF}$`,lC=`^${ype}$`,jNe=`^${Hwt}$`;d();var nA={};Ia(nA,{Clear:()=>Wwt,Delete:()=>jwt,Entries:()=>$wt,Get:()=>zwt,Has:()=>Gwt,Set:()=>Vwt});d();var q4=new Map;function $wt(){return new Map(q4)}s($wt,"Entries");function Wwt(){return q4.clear()}s(Wwt,"Clear");function jwt(t){return q4.delete(t)}s(jwt,"Delete");function Gwt(t){return q4.has(t)}s(Gwt,"Has");function Vwt(t,e){q4.set(t,e)}s(Vwt,"Set");function zwt(t){return q4.get(t)}s(zwt,"Get");var pf={};Ia(pf,{Clear:()=>Ywt,Delete:()=>Jwt,Entries:()=>Kwt,Get:()=>eSt,Has:()=>Xwt,Set:()=>Zwt});d();var H4=new Map;function Kwt(){return new Map(H4)}s(Kwt,"Entries");function Ywt(){return H4.clear()}s(Ywt,"Clear");function Jwt(t){return H4.delete(t)}s(Jwt,"Delete");function Xwt(t){return H4.has(t)}s(Xwt,"Has");function Zwt(t,e){H4.set(t,e)}s(Zwt,"Set");function eSt(t){return H4.get(t)}s(eSt,"Get");d();function GNe(t,e){return t.includes(e)}s(GNe,"SetIncludes");function VNe(t){return[...new Set(t)]}s(VNe,"SetDistinct");function tSt(t,e){return t.filter(r=>e.includes(r))}s(tSt,"SetIntersect");function rSt(t,e){return t.reduce((r,n)=>tSt(r,n),e)}s(rSt,"SetIntersectManyResolve");function zNe(t){return t.length===1?t[0]:t.length>1?rSt(t.slice(1),t[0]):[]}s(zNe,"SetIntersectMany");function KNe(t){let e=[];for(let r of t)e.push(...r);return e}s(KNe,"SetUnionMany");d();function bI(t){return at({[ot]:"Any"},t)}s(bI,"Any");d();function $4(t,e){return at({[ot]:"Array",type:"array",items:t},e)}s($4,"Array");d();function YNe(t){return at({[ot]:"Argument",index:t})}s(YNe,"Argument");d();function W4(t,e){return at({[ot]:"AsyncIterator",type:"AsyncIterator",items:t},e)}s(W4,"AsyncIterator");d();d();function Fs(t,e,r){return at({[ot]:"Computed",target:t,parameters:e},r)}s(Fs,"Computed");d();d();function nSt(t,e){let{[e]:r,...n}=t;return n}s(nSt,"DiscardKey");function Va(t,e){return e.reduce((r,n)=>nSt(r,n),t)}s(Va,"Discard");d();function Ei(t){return at({[ot]:"Never",not:{}},t)}s(Ei,"Never");d();d();function wo(t){return at({[ot]:"MappedResult",properties:t})}s(wo,"MappedResult");d();d();function j4(t,e,r){return at({[ot]:"Constructor",type:"Constructor",parameters:t,returns:e},r)}s(j4,"Constructor");d();function uC(t,e,r){return at({[ot]:"Function",type:"Function",parameters:t,returns:e},r)}s(uC,"Function");d();d();d();d();function XF(t,e){return at({[ot]:"Union",anyOf:t},e)}s(XF,"UnionCreate");function iSt(t){return t.some(e=>np(e))}s(iSt,"IsUnionOptional");function JNe(t){return t.map(e=>np(e)?oSt(e):e)}s(JNe,"RemoveOptionalFromRest");function oSt(t){return Va(t,[Uu])}s(oSt,"RemoveOptionalFromType");function sSt(t,e){return iSt(t)?_d(XF(JNe(t),e)):XF(JNe(t),e)}s(sSt,"ResolveUnion");function dC(t,e){return t.length===1?at(t[0],e):t.length===0?Ei(e):sSt(t,e)}s(dC,"UnionEvaluated");d();function Qo(t,e){return t.length===0?Ei(e):t.length===1?at(t[0],e):XF(t,e)}s(Qo,"Union");d();d();d();var Hj=class extends Bn{static{s(this,"TemplateLiteralParserError")}};function aSt(t){return t.replace(/\\\$/g,"$").replace(/\\\*/g,"*").replace(/\\\^/g,"^").replace(/\\\|/g,"|").replace(/\\\(/g,"(").replace(/\\\)/g,")")}s(aSt,"Unescape");function Cpe(t,e,r){return t[e]===r&&t.charCodeAt(e-1)!==92}s(Cpe,"IsNonEscaped");function qv(t,e){return Cpe(t,e,"(")}s(qv,"IsOpenParen");function ZF(t,e){return Cpe(t,e,")")}s(ZF,"IsCloseParen");function XNe(t,e){return Cpe(t,e,"|")}s(XNe,"IsSeparator");function cSt(t){if(!(qv(t,0)&&ZF(t,t.length-1)))return!1;let e=0;for(let r=0;r<t.length;r++)if(qv(t,r)&&(e+=1),ZF(t,r)&&(e-=1),e===0&&r!==t.length-1)return!1;return!0}s(cSt,"IsGroup");function lSt(t){return t.slice(1,t.length-1)}s(lSt,"InGroup");function uSt(t){let e=0;for(let r=0;r<t.length;r++)if(qv(t,r)&&(e+=1),ZF(t,r)&&(e-=1),XNe(t,r)&&e===0)return!0;return!1}s(uSt,"IsPrecedenceOr");function dSt(t){for(let e=0;e<t.length;e++)if(qv(t,e))return!0;return!1}s(dSt,"IsPrecedenceAnd");function fSt(t){let[e,r]=[0,0],n=[];for(let o=0;o<t.length;o++)if(qv(t,o)&&(e+=1),ZF(t,o)&&(e-=1),XNe(t,o)&&e===0){let a=t.slice(r,o);a.length>0&&n.push(G4(a)),r=o+1}let i=t.slice(r);return i.length>0&&n.push(G4(i)),n.length===0?{type:"const",const:""}:n.length===1?n[0]:{type:"or",expr:n}}s(fSt,"Or");function pSt(t){function e(i,o){if(!qv(i,o))throw new Hj("TemplateLiteralParser: Index must point to open parens");let a=0;for(let c=o;c<i.length;c++)if(qv(i,c)&&(a+=1),ZF(i,c)&&(a-=1),a===0)return[o,c];throw new Hj("TemplateLiteralParser: Unclosed group parens in expression")}s(e,"Group");function r(i,o){for(let a=o;a<i.length;a++)if(qv(i,a))return[o,a];return[o,i.length]}s(r,"Range");let n=[];for(let i=0;i<t.length;i++)if(qv(t,i)){let[o,a]=e(t,i),c=t.slice(o,a+1);n.push(G4(c)),i=a}else{let[o,a]=r(t,i),c=t.slice(o,a);c.length>0&&n.push(G4(c)),i=a-1}return n.length===0?{type:"const",const:""}:n.length===1?n[0]:{type:"and",expr:n}}s(pSt,"And");function G4(t){return cSt(t)?G4(lSt(t)):uSt(t)?fSt(t):dSt(t)?pSt(t):{type:"const",const:aSt(t)}}s(G4,"TemplateLiteralParse");function V4(t){return G4(t.slice(1,t.length-1))}s(V4,"TemplateLiteralParseExact");var vpe=class extends Bn{static{s(this,"TemplateLiteralFiniteError")}};function mSt(t){return t.type==="or"&&t.expr.length===2&&t.expr[0].type==="const"&&t.expr[0].const==="0"&&t.expr[1].type==="const"&&t.expr[1].const==="[1-9][0-9]*"}s(mSt,"IsNumberExpression");function hSt(t){return t.type==="or"&&t.expr.length===2&&t.expr[0].type==="const"&&t.expr[0].const==="true"&&t.expr[1].type==="const"&&t.expr[1].const==="false"}s(hSt,"IsBooleanExpression");function gSt(t){return t.type==="const"&&t.const===".*"}s(gSt,"IsStringExpression");function J_(t){return mSt(t)||gSt(t)?!1:hSt(t)?!0:t.type==="and"?t.expr.every(e=>J_(e)):t.type==="or"?t.expr.every(e=>J_(e)):t.type==="const"?!0:(()=>{throw new vpe("Unknown expression type")})()}s(J_,"IsTemplateLiteralExpressionFinite");function $j(t){let e=V4(t.pattern);return J_(e)}s($j,"IsTemplateLiteralFinite");d();var xpe=class extends Bn{static{s(this,"TemplateLiteralGenerateError")}};function*ZNe(t){if(t.length===1)return yield*t[0];for(let e of t[0])for(let r of ZNe(t.slice(1)))yield`${e}${r}`}s(ZNe,"GenerateReduce");function*ASt(t){return yield*ZNe(t.expr.map(e=>[...e9(e)]))}s(ASt,"GenerateAnd");function*ySt(t){for(let e of t.expr)yield*e9(e)}s(ySt,"GenerateOr");function*CSt(t){return yield t.const}s(CSt,"GenerateConst");function*e9(t){return t.type==="and"?yield*ASt(t):t.type==="or"?yield*ySt(t):t.type==="const"?yield*CSt(t):(()=>{throw new xpe("Unknown expression")})()}s(e9,"TemplateLiteralExpressionGenerate");function z4(t){let e=V4(t.pattern);return J_(e)?[...e9(e)]:[]}s(z4,"TemplateLiteralGenerate");d();d();function co(t,e){return at({[ot]:"Literal",const:t,type:typeof t},e)}s(co,"Literal");d();function Wj(t){return at({[ot]:"Boolean",type:"boolean"},t)}s(Wj,"Boolean");d();function K4(t){return at({[ot]:"BigInt",type:"bigint"},t)}s(K4,"BigInt");d();function jm(t){return at({[ot]:"Number",type:"number"},t)}s(jm,"Number");d();function mf(t){return at({[ot]:"String",type:"string"},t)}s(mf,"String");function*vSt(t){let e=t.trim().replace(/"|'/g,"");return e==="boolean"?yield Wj():e==="number"?yield jm():e==="bigint"?yield K4():e==="string"?yield mf():yield(()=>{let r=e.split("|").map(n=>co(n.trim()));return r.length===0?Ei():r.length===1?r[0]:dC(r)})()}s(vSt,"FromUnion");function*xSt(t){if(t[1]!=="{"){let e=co("$"),r=Epe(t.slice(1));return yield*[e,...r]}for(let e=2;e<t.length;e++)if(t[e]==="}"){let r=vSt(t.slice(2,e)),n=Epe(t.slice(e+1));return yield*[...r,...n]}yield co(t)}s(xSt,"FromTerminal");function*Epe(t){for(let e=0;e<t.length;e++)if(t[e]==="$"){let r=co(t.slice(0,e)),n=xSt(t.slice(e));return yield*[r,...n]}yield co(t)}s(Epe,"FromSyntax");function e8e(t){return[...Epe(t)]}s(e8e,"TemplateLiteralSyntax");d();var bpe=class extends Bn{static{s(this,"TemplateLiteralPatternError")}};function ESt(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}s(ESt,"Escape");function t8e(t,e){return y0(t)?t.pattern.slice(1,t.pattern.length-1):vo(t)?`(${t.anyOf.map(r=>t8e(r,e)).join("|")})`:rA(t)?`${e}${JF}`:tA(t)?`${e}${JF}`:V_(t)?`${e}${JF}`:Ov(t)?`${e}${ype}`:g0(t)?`${e}${ESt(t.const.toString())}`:Fv(t)?`${e}${Ape}`:(()=>{throw new bpe(`Unexpected Kind '${t[ot]}'`)})()}s(t8e,"Visit");function Ipe(t){return`^${t.map(e=>t8e(e,"")).join("")}$`}s(Ipe,"TemplateLiteralPattern");d();function X_(t){let r=z4(t).map(n=>co(n));return dC(r)}s(X_,"TemplateLiteralToUnion");d();function jj(t,e){let r=ws(t)?Ipe(e8e(t)):Ipe(t);return at({[ot]:"TemplateLiteral",type:"string",pattern:r},e)}s(jj,"TemplateLiteral");function bSt(t){return z4(t).map(r=>r.toString())}s(bSt,"FromTemplateLiteral");function ISt(t){let e=[];for(let r of t)e.push(...ip(r));return e}s(ISt,"FromUnion");function TSt(t){return[t.toString()]}s(TSt,"FromLiteral");function ip(t){return[...new Set(y0(t)?bSt(t):vo(t)?ISt(t.anyOf):g0(t)?TSt(t.const):rA(t)?["[number]"]:tA(t)?["[number]"]:[])]}s(ip,"IndexPropertyKeys");d();function wSt(t,e,r){let n={};for(let i of Object.getOwnPropertyNames(e))n[i]=II(t,ip(e[i]),r);return n}s(wSt,"FromProperties");function SSt(t,e,r){return wSt(t,e.properties,r)}s(SSt,"FromMappedResult");function r8e(t,e,r){let n=SSt(t,e,r);return wo(n)}s(r8e,"IndexFromMappedResult");function i8e(t,e){return t.map(r=>o8e(r,e))}s(i8e,"FromRest");function _St(t){return t.filter(e=>!xI(e))}s(_St,"FromIntersectRest");function RSt(t,e){return Gj(_St(i8e(t,e)))}s(RSt,"FromIntersect");function kSt(t){return t.some(e=>xI(e))?[]:t}s(kSt,"FromUnionRest");function PSt(t,e){return dC(kSt(i8e(t,e)))}s(PSt,"FromUnion");function DSt(t,e){return e in t?t[e]:e==="[number]"?dC(t):Ei()}s(DSt,"FromTuple");function BSt(t,e){return e==="[number]"?t:Ei()}s(BSt,"FromArray");function NSt(t,e){return e in t?t[e]:Ei()}s(NSt,"FromProperty");function o8e(t,e){return Ga(t)?RSt(t.allOf,e):vo(t)?PSt(t.anyOf,e):C0(t)?DSt(t.items??[],e):Jg(t)?BSt(t.items,e):Nc(t)?NSt(t.properties,e):Ei()}s(o8e,"IndexFromPropertyKey");function t9(t,e){return e.map(r=>o8e(t,r))}s(t9,"IndexFromPropertyKeys");function n8e(t,e){return dC(t9(t,e))}s(n8e,"FromSchema");function II(t,e,r){if(ac(t)||ac(e)){let n="Index types using Ref parameters require both Type and Key to be of TSchema";if(!ka(t)||!ka(e))throw new Bn(n);return Fs("Index",[t,e])}return Zs(e)?r8e(t,e,r):A0(e)?s8e(t,e,r):at(ka(e)?n8e(t,ip(e)):n8e(t,e),r)}s(II,"Index");function MSt(t,e,r){return{[e]:II(t,[e],Js(r))}}s(MSt,"MappedIndexPropertyKey");function LSt(t,e,r){return e.reduce((n,i)=>({...n,...MSt(t,i,r)}),{})}s(LSt,"MappedIndexPropertyKeys");function FSt(t,e,r){return LSt(t,e.keys,r)}s(FSt,"MappedIndexProperties");function s8e(t,e,r){let n=FSt(t,e,r);return wo(n)}s(s8e,"IndexFromMappedKey");d();function Y4(t,e){return at({[ot]:"Iterator",type:"Iterator",items:t},e)}s(Y4,"Iterator");d();function OSt(t){let e=[];for(let r in t)np(t[r])||e.push(r);return e}s(OSt,"RequiredKeys");function QSt(t,e){let r=OSt(t),n=r.length>0?{[ot]:"Object",type:"object",properties:t,required:r}:{[ot]:"Object",type:"object",properties:t};return at(n,e)}s(QSt,"_Object");var Uo=QSt;d();function Vj(t,e){return at({[ot]:"Promise",type:"Promise",item:t},e)}s(Vj,"Promise");d();d();function USt(t){return at(Va(t,[Yg]))}s(USt,"RemoveReadonly");function qSt(t){return at({...t,[Yg]:"Readonly"})}s(qSt,"AddReadonly");function HSt(t,e){return e===!1?USt(t):qSt(t)}s(HSt,"ReadonlyWithFlag");function op(t,e){let r=e??!0;return Zs(t)?a8e(t,r):HSt(t,r)}s(op,"Readonly");function $St(t,e){let r={};for(let n of globalThis.Object.getOwnPropertyNames(t))r[n]=op(t[n],e);return r}s($St,"FromProperties");function WSt(t,e){return $St(t.properties,e)}s(WSt,"FromMappedResult");function a8e(t,e){let r=WSt(t,e);return wo(r)}s(a8e,"ReadonlyFromMappedResult");d();function Gm(t,e){return at(t.length>0?{[ot]:"Tuple",type:"array",items:t,additionalItems:!1,minItems:t.length,maxItems:t.length}:{[ot]:"Tuple",type:"array",minItems:t.length,maxItems:t.length},e)}s(Gm,"Tuple");function c8e(t,e){return t in e?Vm(t,e[t]):wo(e)}s(c8e,"FromMappedResult");function jSt(t){return{[t]:co(t)}}s(jSt,"MappedKeyToKnownMappedResultProperties");function GSt(t){let e={};for(let r of t)e[r]=co(r);return e}s(GSt,"MappedKeyToUnknownMappedResultProperties");function VSt(t,e){return GNe(e,t)?jSt(t):GSt(e)}s(VSt,"MappedKeyToMappedResultProperties");function zSt(t,e){let r=VSt(t,e);return c8e(t,r)}s(zSt,"FromMappedKey");function r9(t,e){return e.map(r=>Vm(t,r))}s(r9,"FromRest");function KSt(t,e){let r={};for(let n of globalThis.Object.getOwnPropertyNames(e))r[n]=Vm(t,e[n]);return r}s(KSt,"FromProperties");function Vm(t,e){let r={...e};return np(e)?_d(Vm(t,Va(e,[Uu]))):U4(e)?op(Vm(t,Va(e,[Yg]))):Zs(e)?c8e(t,e.properties):A0(e)?zSt(t,e.keys):Zg(e)?j4(r9(t,e.parameters),Vm(t,e.returns),r):eA(e)?uC(r9(t,e.parameters),Vm(t,e.returns),r):G_(e)?W4(Vm(t,e.items),r):z_(e)?Y4(Vm(t,e.items),r):Ga(e)?Rd(r9(t,e.allOf),r):vo(e)?Qo(r9(t,e.anyOf),r):C0(e)?Gm(r9(t,e.items??[]),r):Nc(e)?Uo(KSt(t,e.properties),r):Jg(e)?$4(Vm(t,e.items),r):K_(e)?Vj(Vm(t,e.item),r):e}s(Vm,"FromSchemaType");function YSt(t,e){let r={};for(let n of t)r[n]=Vm(n,e);return r}s(YSt,"MappedFunctionReturnType");function l8e(t,e,r){let n=ka(t)?ip(t):t,i=e({[ot]:"MappedKey",keys:n}),o=YSt(n,i);return Uo(o,r)}s(l8e,"Mapped");d();function JSt(t){return at(Va(t,[Uu]))}s(JSt,"RemoveOptional");function XSt(t){return at({...t,[Uu]:"Optional"})}s(XSt,"AddOptional");function ZSt(t,e){return e===!1?JSt(t):XSt(t)}s(ZSt,"OptionalWithFlag");function _d(t,e){let r=e??!0;return Zs(t)?u8e(t,r):ZSt(t,r)}s(_d,"Optional");function e_t(t,e){let r={};for(let n of globalThis.Object.getOwnPropertyNames(t))r[n]=_d(t[n],e);return r}s(e_t,"FromProperties");function t_t(t,e){return e_t(t.properties,e)}s(t_t,"FromMappedResult");function u8e(t,e){let r=t_t(t,e);return wo(r)}s(u8e,"OptionalFromMappedResult");d();function n9(t,e={}){let r=t.every(i=>Nc(i)),n=ka(e.unevaluatedProperties)?{unevaluatedProperties:e.unevaluatedProperties}:{};return at(e.unevaluatedProperties===!1||ka(e.unevaluatedProperties)||r?{...n,[ot]:"Intersect",type:"object",allOf:t}:{...n,[ot]:"Intersect",allOf:t},e)}s(n9,"IntersectCreate");function r_t(t){return t.every(e=>np(e))}s(r_t,"IsIntersectOptional");function n_t(t){return Va(t,[Uu])}s(n_t,"RemoveOptionalFromType");function d8e(t){return t.map(e=>np(e)?n_t(e):e)}s(d8e,"RemoveOptionalFromRest");function i_t(t,e){return r_t(t)?_d(n9(d8e(t),e)):n9(d8e(t),e)}s(i_t,"ResolveIntersect");function Gj(t,e={}){if(t.length===1)return at(t[0],e);if(t.length===0)return Ei(e);if(t.some(r=>Oo(r)))throw new Error("Cannot intersect transform types");return i_t(t,e)}s(Gj,"IntersectEvaluated");d();function Rd(t,e){if(t.length===1)return at(t[0],e);if(t.length===0)return Ei(e);if(t.some(r=>Oo(r)))throw new Error("Cannot intersect transform types");return n9(t,e)}s(Rd,"Intersect");d();function zm(...t){let[e,r]=typeof t[0]=="string"?[t[0],t[1]]:[t[0].$id,t[1]];if(typeof e!="string")throw new Bn("Ref: $ref must be a string");return at({[ot]:"Ref",$ref:e},r)}s(zm,"Ref");function o_t(t,e){return Fs("Awaited",[Fs(t,e)])}s(o_t,"FromComputed");function s_t(t){return Fs("Awaited",[zm(t)])}s(s_t,"FromRef");function a_t(t){return Rd(f8e(t))}s(a_t,"FromIntersect");function c_t(t){return Qo(f8e(t))}s(c_t,"FromUnion");function l_t(t){return J4(t)}s(l_t,"FromPromise");function f8e(t){return t.map(e=>J4(e))}s(f8e,"FromRest");function J4(t,e){return at(Xg(t)?o_t(t.target,t.parameters):Ga(t)?a_t(t.allOf):vo(t)?c_t(t.anyOf):K_(t)?l_t(t.item):ac(t)?s_t(t.$ref):t,e)}s(J4,"Awaited");d();d();d();d();function p8e(t){let e=[];for(let r of t)e.push(sp(r));return e}s(p8e,"FromRest");function u_t(t){let e=p8e(t);return KNe(e)}s(u_t,"FromIntersect");function d_t(t){let e=p8e(t);return zNe(e)}s(d_t,"FromUnion");function f_t(t){return t.map((e,r)=>r.toString())}s(f_t,"FromTuple");function p_t(t){return["[number]"]}s(p_t,"FromArray");function m_t(t){return globalThis.Object.getOwnPropertyNames(t)}s(m_t,"FromProperties");function h_t(t){return Tpe?globalThis.Object.getOwnPropertyNames(t).map(r=>r[0]==="^"&&r[r.length-1]==="$"?r.slice(1,r.length-1):r):[]}s(h_t,"FromPatternProperties");function sp(t){return Ga(t)?u_t(t.allOf):vo(t)?d_t(t.anyOf):C0(t)?f_t(t.items??[]):Jg(t)?p_t(t.items):Nc(t)?m_t(t.properties):Y_(t)?h_t(t.patternProperties):[]}s(sp,"KeyOfPropertyKeys");var Tpe=!1;function Hv(t){Tpe=!0;let e=sp(t);return Tpe=!1,`^(${e.map(n=>`(${n})`).join("|")})$`}s(Hv,"KeyOfPattern");function g_t(t,e){return Fs("KeyOf",[Fs(t,e)])}s(g_t,"FromComputed");function A_t(t){return Fs("KeyOf",[zm(t)])}s(A_t,"FromRef");function y_t(t,e){let r=sp(t),n=C_t(r),i=dC(n);return at(i,e)}s(y_t,"KeyOfFromType");function C_t(t){return t.map(e=>e==="[number]"?jm():co(e))}s(C_t,"KeyOfPropertyKeysToRest");function X4(t,e){return Xg(t)?g_t(t.target,t.parameters):ac(t)?A_t(t.$ref):Zs(t)?m8e(t,e):y_t(t,e)}s(X4,"KeyOf");function v_t(t,e){let r={};for(let n of globalThis.Object.getOwnPropertyNames(t))r[n]=X4(t[n],Js(e));return r}s(v_t,"FromProperties");function x_t(t,e){return v_t(t.properties,e)}s(x_t,"FromMappedResult");function m8e(t,e){let r=x_t(t,e);return wo(r)}s(m8e,"KeyOfFromMappedResult");d();function zj(t){let e=sp(t),r=t9(t,e);return e.map((n,i)=>[e[i],r[i]])}s(zj,"KeyOfPropertyEntries");function E_t(t){let e=[];for(let r of t)e.push(...sp(r));return VNe(e)}s(E_t,"CompositeKeys");function b_t(t){return t.filter(e=>!xI(e))}s(b_t,"FilterNever");function I_t(t,e){let r=[];for(let n of t)r.push(...t9(n,[e]));return b_t(r)}s(I_t,"CompositeProperty");function T_t(t,e){let r={};for(let n of e)r[n]=Gj(I_t(t,n));return r}s(T_t,"CompositeProperties");function h8e(t,e){let r=E_t(t),n=T_t(t,r);return Uo(n,e)}s(h8e,"Composite");d();d();function Kj(t){return at({[ot]:"Date",type:"Date"},t)}s(Kj,"Date");d();function Yj(t){return at({[ot]:"Null",type:"null"},t)}s(Yj,"Null");d();function Jj(t){return at({[ot]:"Symbol",type:"symbol"},t)}s(Jj,"Symbol");d();function Xj(t){return at({[ot]:"Undefined",type:"undefined"},t)}s(Xj,"Undefined");d();function Zj(t){return at({[ot]:"Uint8Array",type:"Uint8Array"},t)}s(Zj,"Uint8Array");d();function iA(t){return at({[ot]:"Unknown"},t)}s(iA,"Unknown");function w_t(t){return t.map(e=>wpe(e,!1))}s(w_t,"FromArray");function S_t(t){let e={};for(let r of globalThis.Object.getOwnPropertyNames(t))e[r]=op(wpe(t[r],!1));return e}s(S_t,"FromProperties");function eG(t,e){return e===!0?t:op(t)}s(eG,"ConditionalReadonly");function wpe(t,e){return ipe(t)?eG(bI(),e):spe(t)?eG(bI(),e):Dc(t)?op(Gm(w_t(t))):Nv(t)?Zj():j_(t)?Kj():as(t)?eG(Uo(S_t(t)),e):ope(t)?eG(uC([],iA()),e):Bc(t)?Xj():ape(t)?Yj():cpe(t)?Jj():WF(t)?K4():m0(t)?co(t):Bv(t)?co(t):ws(t)?co(t):Uo({})}s(wpe,"FromValue");function g8e(t,e){return at(wpe(t,!0),e)}s(g8e,"Const");d();function A8e(t,e){return Zg(t)?Gm(t.parameters,e):Ei(e)}s(A8e,"ConstructorParameters");d();function y8e(t,e){if(Bc(t))throw new Error("Enum undefined or empty");let r=globalThis.Object.getOwnPropertyNames(t).filter(o=>isNaN(o)).map(o=>t[o]),i=[...new Set(r)].map(o=>co(o));return Qo(i,{...e,[Wm]:"Enum"})}s(y8e,"Enum");d();d();d();var _pe=class extends Bn{static{s(this,"ExtendsResolverError")}},ct;(function(t){t[t.Union=0]="Union",t[t.True=1]="True",t[t.False=2]="False"})(ct||(ct={}));function Km(t){return t===ct.False?t:ct.True}s(Km,"IntoBooleanResult");function Z4(t){throw new _pe(t)}s(Z4,"Throw");function el(t){return Le.IsNever(t)||Le.IsIntersect(t)||Le.IsUnion(t)||Le.IsUnknown(t)||Le.IsAny(t)}s(el,"IsStructuralRight");function tl(t,e){return Le.IsNever(e)?T8e(t,e):Le.IsIntersect(e)?tG(t,e):Le.IsUnion(e)?Dpe(t,e):Le.IsUnknown(e)?R8e(t,e):Le.IsAny(e)?Ppe(t,e):Z4("StructuralRight")}s(tl,"StructuralRight");function Ppe(t,e){return ct.True}s(Ppe,"FromAnyRight");function __t(t,e){return Le.IsIntersect(e)?tG(t,e):Le.IsUnion(e)&&e.anyOf.some(r=>Le.IsAny(r)||Le.IsUnknown(r))?ct.True:Le.IsUnion(e)?ct.Union:Le.IsUnknown(e)||Le.IsAny(e)?ct.True:ct.Union}s(__t,"FromAny");function R_t(t,e){return Le.IsUnknown(t)?ct.False:Le.IsAny(t)?ct.Union:Le.IsNever(t)?ct.True:ct.False}s(R_t,"FromArrayRight");function k_t(t,e){return Le.IsObject(e)&&rG(e)?ct.True:el(e)?tl(t,e):Le.IsArray(e)?Km(ls(t.items,e.items)):ct.False}s(k_t,"FromArray");function P_t(t,e){return el(e)?tl(t,e):Le.IsAsyncIterator(e)?Km(ls(t.items,e.items)):ct.False}s(P_t,"FromAsyncIterator");function D_t(t,e){return el(e)?tl(t,e):Le.IsObject(e)?kd(t,e):Le.IsRecord(e)?Ym(t,e):Le.IsBigInt(e)?ct.True:ct.False}s(D_t,"FromBigInt");function b8e(t,e){return Le.IsLiteralBoolean(t)||Le.IsBoolean(t)?ct.True:ct.False}s(b8e,"FromBooleanRight");function B_t(t,e){return el(e)?tl(t,e):Le.IsObject(e)?kd(t,e):Le.IsRecord(e)?Ym(t,e):Le.IsBoolean(e)?ct.True:ct.False}s(B_t,"FromBoolean");function N_t(t,e){return el(e)?tl(t,e):Le.IsObject(e)?kd(t,e):Le.IsConstructor(e)?t.parameters.length>e.parameters.length?ct.False:t.parameters.every((r,n)=>Km(ls(e.parameters[n],r))===ct.True)?Km(ls(t.returns,e.returns)):ct.False:ct.False}s(N_t,"FromConstructor");function M_t(t,e){return el(e)?tl(t,e):Le.IsObject(e)?kd(t,e):Le.IsRecord(e)?Ym(t,e):Le.IsDate(e)?ct.True:ct.False}s(M_t,"FromDate");function L_t(t,e){return el(e)?tl(t,e):Le.IsObject(e)?kd(t,e):Le.IsFunction(e)?t.parameters.length>e.parameters.length?ct.False:t.parameters.every((r,n)=>Km(ls(e.parameters[n],r))===ct.True)?Km(ls(t.returns,e.returns)):ct.False:ct.False}s(L_t,"FromFunction");function I8e(t,e){return Le.IsLiteral(t)&&Sd.IsNumber(t.const)||Le.IsNumber(t)||Le.IsInteger(t)?ct.True:ct.False}s(I8e,"FromIntegerRight");function F_t(t,e){return Le.IsInteger(e)||Le.IsNumber(e)?ct.True:el(e)?tl(t,e):Le.IsObject(e)?kd(t,e):Le.IsRecord(e)?Ym(t,e):ct.False}s(F_t,"FromInteger");function tG(t,e){return e.allOf.every(r=>ls(t,r)===ct.True)?ct.True:ct.False}s(tG,"FromIntersectRight");function O_t(t,e){return t.allOf.some(r=>ls(r,e)===ct.True)?ct.True:ct.False}s(O_t,"FromIntersect");function Q_t(t,e){return el(e)?tl(t,e):Le.IsIterator(e)?Km(ls(t.items,e.items)):ct.False}s(Q_t,"FromIterator");function U_t(t,e){return Le.IsLiteral(e)&&e.const===t.const?ct.True:el(e)?tl(t,e):Le.IsObject(e)?kd(t,e):Le.IsRecord(e)?Ym(t,e):Le.IsString(e)?_8e(t,e):Le.IsNumber(e)?w8e(t,e):Le.IsInteger(e)?I8e(t,e):Le.IsBoolean(e)?b8e(t,e):ct.False}s(U_t,"FromLiteral");function T8e(t,e){return ct.False}s(T8e,"FromNeverRight");function q_t(t,e){return ct.True}s(q_t,"FromNever");function C8e(t){let[e,r]=[t,0];for(;Le.IsNot(e);)e=e.not,r+=1;return r%2===0?e:iA()}s(C8e,"UnwrapTNot");function H_t(t,e){return Le.IsNot(t)?ls(C8e(t),e):Le.IsNot(e)?ls(t,C8e(e)):Z4("Invalid fallthrough for Not")}s(H_t,"FromNot");function $_t(t,e){return el(e)?tl(t,e):Le.IsObject(e)?kd(t,e):Le.IsRecord(e)?Ym(t,e):Le.IsNull(e)?ct.True:ct.False}s($_t,"FromNull");function w8e(t,e){return Le.IsLiteralNumber(t)||Le.IsNumber(t)||Le.IsInteger(t)?ct.True:ct.False}s(w8e,"FromNumberRight");function W_t(t,e){return el(e)?tl(t,e):Le.IsObject(e)?kd(t,e):Le.IsRecord(e)?Ym(t,e):Le.IsInteger(e)||Le.IsNumber(e)?ct.True:ct.False}s(W_t,"FromNumber");function ap(t,e){return Object.getOwnPropertyNames(t.properties).length===e}s(ap,"IsObjectPropertyCount");function v8e(t){return rG(t)}s(v8e,"IsObjectStringLike");function x8e(t){return ap(t,0)||ap(t,1)&&"description"in t.properties&&Le.IsUnion(t.properties.description)&&t.properties.description.anyOf.length===2&&(Le.IsString(t.properties.description.anyOf[0])&&Le.IsUndefined(t.properties.description.anyOf[1])||Le.IsString(t.properties.description.anyOf[1])&&Le.IsUndefined(t.properties.description.anyOf[0]))}s(x8e,"IsObjectSymbolLike");function Spe(t){return ap(t,0)}s(Spe,"IsObjectNumberLike");function E8e(t){return ap(t,0)}s(E8e,"IsObjectBooleanLike");function j_t(t){return ap(t,0)}s(j_t,"IsObjectBigIntLike");function G_t(t){return ap(t,0)}s(G_t,"IsObjectDateLike");function V_t(t){return rG(t)}s(V_t,"IsObjectUint8ArrayLike");function z_t(t){let e=jm();return ap(t,0)||ap(t,1)&&"length"in t.properties&&Km(ls(t.properties.length,e))===ct.True}s(z_t,"IsObjectFunctionLike");function K_t(t){return ap(t,0)}s(K_t,"IsObjectConstructorLike");function rG(t){let e=jm();return ap(t,0)||ap(t,1)&&"length"in t.properties&&Km(ls(t.properties.length,e))===ct.True}s(rG,"IsObjectArrayLike");function Y_t(t){let e=uC([bI()],bI());return ap(t,0)||ap(t,1)&&"then"in t.properties&&Km(ls(t.properties.then,e))===ct.True}s(Y_t,"IsObjectPromiseLike");function S8e(t,e){return ls(t,e)===ct.False||Le.IsOptional(t)&&!Le.IsOptional(e)?ct.False:ct.True}s(S8e,"Property");function kd(t,e){return Le.IsUnknown(t)?ct.False:Le.IsAny(t)?ct.Union:Le.IsNever(t)||Le.IsLiteralString(t)&&v8e(e)||Le.IsLiteralNumber(t)&&Spe(e)||Le.IsLiteralBoolean(t)&&E8e(e)||Le.IsSymbol(t)&&x8e(e)||Le.IsBigInt(t)&&j_t(e)||Le.IsString(t)&&v8e(e)||Le.IsSymbol(t)&&x8e(e)||Le.IsNumber(t)&&Spe(e)||Le.IsInteger(t)&&Spe(e)||Le.IsBoolean(t)&&E8e(e)||Le.IsUint8Array(t)&&V_t(e)||Le.IsDate(t)&&G_t(e)||Le.IsConstructor(t)&&K_t(e)||Le.IsFunction(t)&&z_t(e)?ct.True:Le.IsRecord(t)&&Le.IsString(Rpe(t))?e[Wm]==="Record"?ct.True:ct.False:Le.IsRecord(t)&&Le.IsNumber(Rpe(t))?ap(e,0)?ct.True:ct.False:ct.False}s(kd,"FromObjectRight");function J_t(t,e){return el(e)?tl(t,e):Le.IsRecord(e)?Ym(t,e):Le.IsObject(e)?(()=>{for(let r of Object.getOwnPropertyNames(e.properties)){if(!(r in t.properties)&&!Le.IsOptional(e.properties[r]))return ct.False;if(Le.IsOptional(e.properties[r]))return ct.True;if(S8e(t.properties[r],e.properties[r])===ct.False)return ct.False}return ct.True})():ct.False}s(J_t,"FromObject");function X_t(t,e){return el(e)?tl(t,e):Le.IsObject(e)&&Y_t(e)?ct.True:Le.IsPromise(e)?Km(ls(t.item,e.item)):ct.False}s(X_t,"FromPromise");function Rpe(t){return cC in t.patternProperties?jm():lC in t.patternProperties?mf():Z4("Unknown record key pattern")}s(Rpe,"RecordKey");function kpe(t){return cC in t.patternProperties?t.patternProperties[cC]:lC in t.patternProperties?t.patternProperties[lC]:Z4("Unable to get record value schema")}s(kpe,"RecordValue");function Ym(t,e){let[r,n]=[Rpe(e),kpe(e)];return Le.IsLiteralString(t)&&Le.IsNumber(r)&&Km(ls(t,n))===ct.True?ct.True:Le.IsUint8Array(t)&&Le.IsNumber(r)||Le.IsString(t)&&Le.IsNumber(r)||Le.IsArray(t)&&Le.IsNumber(r)?ls(t,n):Le.IsObject(t)?(()=>{for(let i of Object.getOwnPropertyNames(t.properties))if(S8e(n,t.properties[i])===ct.False)return ct.False;return ct.True})():ct.False}s(Ym,"FromRecordRight");function Z_t(t,e){return el(e)?tl(t,e):Le.IsObject(e)?kd(t,e):Le.IsRecord(e)?ls(kpe(t),kpe(e)):ct.False}s(Z_t,"FromRecord");function e2t(t,e){let r=Le.IsRegExp(t)?mf():t,n=Le.IsRegExp(e)?mf():e;return ls(r,n)}s(e2t,"FromRegExp");function _8e(t,e){return Le.IsLiteral(t)&&Sd.IsString(t.const)||Le.IsString(t)?ct.True:ct.False}s(_8e,"FromStringRight");function t2t(t,e){return el(e)?tl(t,e):Le.IsObject(e)?kd(t,e):Le.IsRecord(e)?Ym(t,e):Le.IsString(e)?ct.True:ct.False}s(t2t,"FromString");function r2t(t,e){return el(e)?tl(t,e):Le.IsObject(e)?kd(t,e):Le.IsRecord(e)?Ym(t,e):Le.IsSymbol(e)?ct.True:ct.False}s(r2t,"FromSymbol");function n2t(t,e){return Le.IsTemplateLiteral(t)?ls(X_(t),e):Le.IsTemplateLiteral(e)?ls(t,X_(e)):Z4("Invalid fallthrough for TemplateLiteral")}s(n2t,"FromTemplateLiteral");function i2t(t,e){return Le.IsArray(e)&&t.items!==void 0&&t.items.every(r=>ls(r,e.items)===ct.True)}s(i2t,"IsArrayOfTuple");function o2t(t,e){return Le.IsNever(t)?ct.True:Le.IsUnknown(t)?ct.False:Le.IsAny(t)?ct.Union:ct.False}s(o2t,"FromTupleRight");function s2t(t,e){return el(e)?tl(t,e):Le.IsObject(e)&&rG(e)||Le.IsArray(e)&&i2t(t,e)?ct.True:Le.IsTuple(e)?Sd.IsUndefined(t.items)&&!Sd.IsUndefined(e.items)||!Sd.IsUndefined(t.items)&&Sd.IsUndefined(e.items)?ct.False:Sd.IsUndefined(t.items)&&!Sd.IsUndefined(e.items)||t.items.every((r,n)=>ls(r,e.items[n])===ct.True)?ct.True:ct.False:ct.False}s(s2t,"FromTuple");function a2t(t,e){return el(e)?tl(t,e):Le.IsObject(e)?kd(t,e):Le.IsRecord(e)?Ym(t,e):Le.IsUint8Array(e)?ct.True:ct.False}s(a2t,"FromUint8Array");function c2t(t,e){return el(e)?tl(t,e):Le.IsObject(e)?kd(t,e):Le.IsRecord(e)?Ym(t,e):Le.IsVoid(e)?d2t(t,e):Le.IsUndefined(e)?ct.True:ct.False}s(c2t,"FromUndefined");function Dpe(t,e){return e.anyOf.some(r=>ls(t,r)===ct.True)?ct.True:ct.False}s(Dpe,"FromUnionRight");function l2t(t,e){return t.anyOf.every(r=>ls(r,e)===ct.True)?ct.True:ct.False}s(l2t,"FromUnion");function R8e(t,e){return ct.True}s(R8e,"FromUnknownRight");function u2t(t,e){return Le.IsNever(e)?T8e(t,e):Le.IsIntersect(e)?tG(t,e):Le.IsUnion(e)?Dpe(t,e):Le.IsAny(e)?Ppe(t,e):Le.IsString(e)?_8e(t,e):Le.IsNumber(e)?w8e(t,e):Le.IsInteger(e)?I8e(t,e):Le.IsBoolean(e)?b8e(t,e):Le.IsArray(e)?R_t(t,e):Le.IsTuple(e)?o2t(t,e):Le.IsObject(e)?kd(t,e):Le.IsUnknown(e)?ct.True:ct.False}s(u2t,"FromUnknown");function d2t(t,e){return Le.IsUndefined(t)||Le.IsUndefined(t)?ct.True:ct.False}s(d2t,"FromVoidRight");function f2t(t,e){return Le.IsIntersect(e)?tG(t,e):Le.IsUnion(e)?Dpe(t,e):Le.IsUnknown(e)?R8e(t,e):Le.IsAny(e)?Ppe(t,e):Le.IsObject(e)?kd(t,e):Le.IsVoid(e)?ct.True:ct.False}s(f2t,"FromVoid");function ls(t,e){return Le.IsTemplateLiteral(t)||Le.IsTemplateLiteral(e)?n2t(t,e):Le.IsRegExp(t)||Le.IsRegExp(e)?e2t(t,e):Le.IsNot(t)||Le.IsNot(e)?H_t(t,e):Le.IsAny(t)?__t(t,e):Le.IsArray(t)?k_t(t,e):Le.IsBigInt(t)?D_t(t,e):Le.IsBoolean(t)?B_t(t,e):Le.IsAsyncIterator(t)?P_t(t,e):Le.IsConstructor(t)?N_t(t,e):Le.IsDate(t)?M_t(t,e):Le.IsFunction(t)?L_t(t,e):Le.IsInteger(t)?F_t(t,e):Le.IsIntersect(t)?O_t(t,e):Le.IsIterator(t)?Q_t(t,e):Le.IsLiteral(t)?U_t(t,e):Le.IsNever(t)?q_t(t,e):Le.IsNull(t)?$_t(t,e):Le.IsNumber(t)?W_t(t,e):Le.IsObject(t)?J_t(t,e):Le.IsRecord(t)?Z_t(t,e):Le.IsString(t)?t2t(t,e):Le.IsSymbol(t)?r2t(t,e):Le.IsTuple(t)?s2t(t,e):Le.IsPromise(t)?X_t(t,e):Le.IsUint8Array(t)?a2t(t,e):Le.IsUndefined(t)?c2t(t,e):Le.IsUnion(t)?l2t(t,e):Le.IsUnknown(t)?u2t(t,e):Le.IsVoid(t)?f2t(t,e):Z4(`Unknown left type operand '${t[ot]}'`)}s(ls,"Visit");function TI(t,e){return ls(t,e)}s(TI,"ExtendsCheck");d();d();d();function p2t(t,e,r,n,i){let o={};for(let a of globalThis.Object.getOwnPropertyNames(t))o[a]=eD(t[a],e,r,n,Js(i));return o}s(p2t,"FromProperties");function m2t(t,e,r,n,i){return p2t(t.properties,e,r,n,i)}s(m2t,"FromMappedResult");function k8e(t,e,r,n,i){let o=m2t(t,e,r,n,i);return wo(o)}s(k8e,"ExtendsFromMappedResult");function h2t(t,e,r,n){let i=TI(t,e);return i===ct.Union?Qo([r,n]):i===ct.True?r:n}s(h2t,"ExtendsResolve");function eD(t,e,r,n,i){return Zs(t)?k8e(t,e,r,n,i):A0(t)?at(P8e(t,e,r,n,i)):at(h2t(t,e,r,n),i)}s(eD,"Extends");function g2t(t,e,r,n,i){return{[t]:eD(co(t),e,r,n,Js(i))}}s(g2t,"FromPropertyKey");function A2t(t,e,r,n,i){return t.reduce((o,a)=>({...o,...g2t(a,e,r,n,i)}),{})}s(A2t,"FromPropertyKeys");function y2t(t,e,r,n,i){return A2t(t.keys,e,r,n,i)}s(y2t,"FromMappedKey");function P8e(t,e,r,n,i){let o=y2t(t,e,r,n,i);return wo(o)}s(P8e,"ExtendsFromMappedKey");d();function C2t(t){return t.allOf.every(e=>$v(e))}s(C2t,"Intersect");function v2t(t){return t.anyOf.some(e=>$v(e))}s(v2t,"Union");function x2t(t){return!$v(t.not)}s(x2t,"Not");function $v(t){return t[ot]==="Intersect"?C2t(t):t[ot]==="Union"?v2t(t):t[ot]==="Not"?x2t(t):t[ot]==="Undefined"}s($v,"ExtendsUndefinedCheck");d();function D8e(t,e){return tD(X_(t),e)}s(D8e,"ExcludeFromTemplateLiteral");function E2t(t,e){let r=t.filter(n=>TI(n,e)===ct.False);return r.length===1?r[0]:Qo(r)}s(E2t,"ExcludeRest");function tD(t,e,r={}){return y0(t)?at(D8e(t,e),r):Zs(t)?at(B8e(t,e),r):at(vo(t)?E2t(t.anyOf,e):TI(t,e)!==ct.False?Ei():t,r)}s(tD,"Exclude");function b2t(t,e){let r={};for(let n of globalThis.Object.getOwnPropertyNames(t))r[n]=tD(t[n],e);return r}s(b2t,"FromProperties");function I2t(t,e){return b2t(t.properties,e)}s(I2t,"FromMappedResult");function B8e(t,e){let r=I2t(t,e);return wo(r)}s(B8e,"ExcludeFromMappedResult");d();d();d();function N8e(t,e){return rD(X_(t),e)}s(N8e,"ExtractFromTemplateLiteral");function T2t(t,e){let r=t.filter(n=>TI(n,e)!==ct.False);return r.length===1?r[0]:Qo(r)}s(T2t,"ExtractRest");function rD(t,e,r){return y0(t)?at(N8e(t,e),r):Zs(t)?at(M8e(t,e),r):at(vo(t)?T2t(t.anyOf,e):TI(t,e)!==ct.False?t:Ei(),r)}s(rD,"Extract");function w2t(t,e){let r={};for(let n of globalThis.Object.getOwnPropertyNames(t))r[n]=rD(t[n],e);return r}s(w2t,"FromProperties");function S2t(t,e){return w2t(t.properties,e)}s(S2t,"FromMappedResult");function M8e(t,e){let r=S2t(t,e);return wo(r)}s(M8e,"ExtractFromMappedResult");d();function L8e(t,e){return Zg(t)?at(t.returns,e):Ei(e)}s(L8e,"InstanceType");d();d();function nG(t){return op(_d(t))}s(nG,"ReadonlyOptional");d();function Z_(t,e,r){return at({[ot]:"Record",type:"object",patternProperties:{[t]:e}},r)}s(Z_,"RecordCreateFromPattern");function Bpe(t,e,r){let n={};for(let i of t)n[i]=e;return Uo(n,{...r,[Wm]:"Record"})}s(Bpe,"RecordCreateFromKeys");function _2t(t,e,r){return $j(t)?Bpe(ip(t),e,r):Z_(t.pattern,e,r)}s(_2t,"FromTemplateLiteralKey");function R2t(t,e,r){return Bpe(ip(Qo(t)),e,r)}s(R2t,"FromUnionKey");function k2t(t,e,r){return Bpe([t.toString()],e,r)}s(k2t,"FromLiteralKey");function P2t(t,e,r){return Z_(t.source,e,r)}s(P2t,"FromRegExpKey");function D2t(t,e,r){let n=Bc(t.pattern)?lC:t.pattern;return Z_(n,e,r)}s(D2t,"FromStringKey");function B2t(t,e,r){return Z_(lC,e,r)}s(B2t,"FromAnyKey");function N2t(t,e,r){return Z_(jNe,e,r)}s(N2t,"FromNeverKey");function M2t(t,e,r){return Uo({true:e,false:e},r)}s(M2t,"FromBooleanKey");function L2t(t,e,r){return Z_(cC,e,r)}s(L2t,"FromIntegerKey");function F2t(t,e,r){return Z_(cC,e,r)}s(F2t,"FromNumberKey");function iG(t,e,r={}){return vo(t)?R2t(t.anyOf,e,r):y0(t)?_2t(t,e,r):g0(t)?k2t(t.const,e,r):Fv(t)?M2t(t,e,r):tA(t)?L2t(t,e,r):rA(t)?F2t(t,e,r):fpe(t)?P2t(t,e,r):Ov(t)?D2t(t,e,r):upe(t)?B2t(t,e,r):xI(t)?N2t(t,e,r):Ei(r)}s(iG,"Record");function oG(t){return globalThis.Object.getOwnPropertyNames(t.patternProperties)[0]}s(oG,"RecordPattern");function F8e(t){let e=oG(t);return e===lC?mf():e===cC?jm():mf({pattern:e})}s(F8e,"RecordKey");function sG(t){return t.patternProperties[oG(t)]}s(sG,"RecordValue");function O2t(t,e){return e.parameters=i9(t,e.parameters),e.returns=oA(t,e.returns),e}s(O2t,"FromConstructor");function Q2t(t,e){return e.parameters=i9(t,e.parameters),e.returns=oA(t,e.returns),e}s(Q2t,"FromFunction");function U2t(t,e){return e.allOf=i9(t,e.allOf),e}s(U2t,"FromIntersect");function q2t(t,e){return e.anyOf=i9(t,e.anyOf),e}s(q2t,"FromUnion");function H2t(t,e){return Bc(e.items)||(e.items=i9(t,e.items)),e}s(H2t,"FromTuple");function $2t(t,e){return e.items=oA(t,e.items),e}s($2t,"FromArray");function W2t(t,e){return e.items=oA(t,e.items),e}s(W2t,"FromAsyncIterator");function j2t(t,e){return e.items=oA(t,e.items),e}s(j2t,"FromIterator");function G2t(t,e){return e.item=oA(t,e.item),e}s(G2t,"FromPromise");function V2t(t,e){let r=J2t(t,e.properties);return{...e,...Uo(r)}}s(V2t,"FromObject");function z2t(t,e){let r=oA(t,F8e(e)),n=oA(t,sG(e)),i=iG(r,n);return{...e,...i}}s(z2t,"FromRecord");function K2t(t,e){return e.index in t?t[e.index]:iA()}s(K2t,"FromArgument");function Y2t(t,e){let r=U4(e),n=np(e),i=oA(t,e);return r&&n?nG(i):r&&!n?op(i):!r&&n?_d(i):i}s(Y2t,"FromProperty");function J2t(t,e){return globalThis.Object.getOwnPropertyNames(e).reduce((r,n)=>({...r,[n]:Y2t(t,e[n])}),{})}s(J2t,"FromProperties");function i9(t,e){return e.map(r=>oA(t,r))}s(i9,"FromTypes");function oA(t,e){return Zg(e)?O2t(t,e):eA(e)?Q2t(t,e):Ga(e)?U2t(t,e):vo(e)?q2t(t,e):C0(e)?H2t(t,e):Jg(e)?$2t(t,e):G_(e)?W2t(t,e):z_(e)?j2t(t,e):K_(e)?G2t(t,e):Nc(e)?V2t(t,e):Y_(e)?z2t(t,e):dpe(e)?K2t(t,e):e}s(oA,"FromType");function O8e(t,e){return oA(e,O4(t))}s(O8e,"Instantiate");d();function Q8e(t){return at({[ot]:"Integer",type:"integer"},t)}s(Q8e,"Integer");d();d();d();function X2t(t,e,r){return{[t]:sA(co(t),e,Js(r))}}s(X2t,"MappedIntrinsicPropertyKey");function Z2t(t,e,r){return t.reduce((i,o)=>({...i,...X2t(o,e,r)}),{})}s(Z2t,"MappedIntrinsicPropertyKeys");function eRt(t,e,r){return Z2t(t.keys,e,r)}s(eRt,"MappedIntrinsicProperties");function U8e(t,e,r){let n=eRt(t,e,r);return wo(n)}s(U8e,"IntrinsicFromMappedKey");function tRt(t){let[e,r]=[t.slice(0,1),t.slice(1)];return[e.toLowerCase(),r].join("")}s(tRt,"ApplyUncapitalize");function rRt(t){let[e,r]=[t.slice(0,1),t.slice(1)];return[e.toUpperCase(),r].join("")}s(rRt,"ApplyCapitalize");function nRt(t){return t.toUpperCase()}s(nRt,"ApplyUppercase");function iRt(t){return t.toLowerCase()}s(iRt,"ApplyLowercase");function oRt(t,e,r){let n=V4(t.pattern);if(!J_(n))return{...t,pattern:q8e(t.pattern,e)};let a=[...e9(n)].map(u=>co(u)),c=H8e(a,e),l=Qo(c);return jj([l],r)}s(oRt,"FromTemplateLiteral");function q8e(t,e){return typeof t=="string"?e==="Uncapitalize"?tRt(t):e==="Capitalize"?rRt(t):e==="Uppercase"?nRt(t):e==="Lowercase"?iRt(t):t:t.toString()}s(q8e,"FromLiteralValue");function H8e(t,e){return t.map(r=>sA(r,e))}s(H8e,"FromRest");function sA(t,e,r={}){return A0(t)?U8e(t,e,r):y0(t)?oRt(t,e,r):vo(t)?Qo(H8e(t.anyOf,e),r):g0(t)?co(q8e(t.const,e),r):at(t,r)}s(sA,"Intrinsic");function $8e(t,e={}){return sA(t,"Capitalize",e)}s($8e,"Capitalize");d();function W8e(t,e={}){return sA(t,"Lowercase",e)}s(W8e,"Lowercase");d();function j8e(t,e={}){return sA(t,"Uncapitalize",e)}s(j8e,"Uncapitalize");d();function G8e(t,e={}){return sA(t,"Uppercase",e)}s(G8e,"Uppercase");d();d();d();d();d();function sRt(t,e,r){let n={};for(let i of globalThis.Object.getOwnPropertyNames(t))n[i]=wI(t[i],e,Js(r));return n}s(sRt,"FromProperties");function aRt(t,e,r){return sRt(t.properties,e,r)}s(aRt,"FromMappedResult");function V8e(t,e,r){let n=aRt(t,e,r);return wo(n)}s(V8e,"OmitFromMappedResult");function cRt(t,e){return t.map(r=>Npe(r,e))}s(cRt,"FromIntersect");function lRt(t,e){return t.map(r=>Npe(r,e))}s(lRt,"FromUnion");function uRt(t,e){let{[e]:r,...n}=t;return n}s(uRt,"FromProperty");function dRt(t,e){return e.reduce((r,n)=>uRt(r,n),t)}s(dRt,"FromProperties");function fRt(t,e){let r=Va(t,[Ra,"$id","required","properties"]),n=dRt(t.properties,e);return Uo(n,r)}s(fRt,"FromObject");function pRt(t){let e=t.reduce((r,n)=>Uj(n)?[...r,co(n)]:r,[]);return Qo(e)}s(pRt,"UnionFromPropertyKeys");function Npe(t,e){return Ga(t)?Rd(cRt(t.allOf,e)):vo(t)?Qo(lRt(t.anyOf,e)):Nc(t)?fRt(t,e):Uo({})}s(Npe,"OmitResolve");function wI(t,e,r){let n=Dc(e)?pRt(e):e,i=ka(e)?ip(e):e,o=ac(t),a=ac(e);return Zs(t)?V8e(t,i,r):A0(e)?z8e(t,e,r):o&&a?Fs("Omit",[t,n],r):!o&&a?Fs("Omit",[t,n],r):o&&!a?Fs("Omit",[t,n],r):at({...Npe(t,i),...r})}s(wI,"Omit");function mRt(t,e,r){return{[e]:wI(t,[e],Js(r))}}s(mRt,"FromPropertyKey");function hRt(t,e,r){return e.reduce((n,i)=>({...n,...mRt(t,i,r)}),{})}s(hRt,"FromPropertyKeys");function gRt(t,e,r){return hRt(t,e.keys,r)}s(gRt,"FromMappedKey");function z8e(t,e,r){let n=gRt(t,e,r);return wo(n)}s(z8e,"OmitFromMappedKey");d();d();d();function ARt(t,e,r){let n={};for(let i of globalThis.Object.getOwnPropertyNames(t))n[i]=SI(t[i],e,Js(r));return n}s(ARt,"FromProperties");function yRt(t,e,r){return ARt(t.properties,e,r)}s(yRt,"FromMappedResult");function K8e(t,e,r){let n=yRt(t,e,r);return wo(n)}s(K8e,"PickFromMappedResult");function CRt(t,e){return t.map(r=>Mpe(r,e))}s(CRt,"FromIntersect");function vRt(t,e){return t.map(r=>Mpe(r,e))}s(vRt,"FromUnion");function xRt(t,e){let r={};for(let n of e)n in t&&(r[n]=t[n]);return r}s(xRt,"FromProperties");function ERt(t,e){let r=Va(t,[Ra,"$id","required","properties"]),n=xRt(t.properties,e);return Uo(n,r)}s(ERt,"FromObject");function bRt(t){let e=t.reduce((r,n)=>Uj(n)?[...r,co(n)]:r,[]);return Qo(e)}s(bRt,"UnionFromPropertyKeys");function Mpe(t,e){return Ga(t)?Rd(CRt(t.allOf,e)):vo(t)?Qo(vRt(t.anyOf,e)):Nc(t)?ERt(t,e):Uo({})}s(Mpe,"PickResolve");function SI(t,e,r){let n=Dc(e)?bRt(e):e,i=ka(e)?ip(e):e,o=ac(t),a=ac(e);return Zs(t)?K8e(t,i,r):A0(e)?Y8e(t,e,r):o&&a?Fs("Pick",[t,n],r):!o&&a?Fs("Pick",[t,n],r):o&&!a?Fs("Pick",[t,n],r):at({...Mpe(t,i),...r})}s(SI,"Pick");function IRt(t,e,r){return{[e]:SI(t,[e],Js(r))}}s(IRt,"FromPropertyKey");function TRt(t,e,r){return e.reduce((n,i)=>({...n,...IRt(t,i,r)}),{})}s(TRt,"FromPropertyKeys");function wRt(t,e,r){return TRt(t,e.keys,r)}s(wRt,"FromMappedKey");function Y8e(t,e,r){let n=wRt(t,e,r);return wo(n)}s(Y8e,"PickFromMappedKey");d();d();function SRt(t,e){return Fs("Partial",[Fs(t,e)])}s(SRt,"FromComputed");function _Rt(t){return Fs("Partial",[zm(t)])}s(_Rt,"FromRef");function RRt(t){let e={};for(let r of globalThis.Object.getOwnPropertyNames(t))e[r]=_d(t[r]);return e}s(RRt,"FromProperties");function kRt(t){let e=Va(t,[Ra,"$id","required","properties"]),r=RRt(t.properties);return Uo(r,e)}s(kRt,"FromObject");function J8e(t){return t.map(e=>X8e(e))}s(J8e,"FromRest");function X8e(t){return Xg(t)?SRt(t.target,t.parameters):ac(t)?_Rt(t.$ref):Ga(t)?Rd(J8e(t.allOf)):vo(t)?Qo(J8e(t.anyOf)):Nc(t)?kRt(t):V_(t)||Fv(t)||tA(t)||g0(t)||VF(t)||rA(t)||Ov(t)||zF(t)||Qv(t)?t:Uo({})}s(X8e,"PartialResolve");function nD(t,e){return Zs(t)?Z8e(t,e):at({...X8e(t),...e})}s(nD,"Partial");function PRt(t,e){let r={};for(let n of globalThis.Object.getOwnPropertyNames(t))r[n]=nD(t[n],Js(e));return r}s(PRt,"FromProperties");function DRt(t,e){return PRt(t.properties,e)}s(DRt,"FromMappedResult");function Z8e(t,e){let r=DRt(t,e);return wo(r)}s(Z8e,"PartialFromMappedResult");d();d();function BRt(t,e){return Fs("Required",[Fs(t,e)])}s(BRt,"FromComputed");function NRt(t){return Fs("Required",[zm(t)])}s(NRt,"FromRef");function MRt(t){let e={};for(let r of globalThis.Object.getOwnPropertyNames(t))e[r]=Va(t[r],[Uu]);return e}s(MRt,"FromProperties");function LRt(t){let e=Va(t,[Ra,"$id","required","properties"]),r=MRt(t.properties);return Uo(r,e)}s(LRt,"FromObject");function eMe(t){return t.map(e=>tMe(e))}s(eMe,"FromRest");function tMe(t){return Xg(t)?BRt(t.target,t.parameters):ac(t)?NRt(t.$ref):Ga(t)?Rd(eMe(t.allOf)):vo(t)?Qo(eMe(t.anyOf)):Nc(t)?LRt(t):V_(t)||Fv(t)||tA(t)||g0(t)||VF(t)||rA(t)||Ov(t)||zF(t)||Qv(t)?t:Uo({})}s(tMe,"RequiredResolve");function iD(t,e){return Zs(t)?rMe(t,e):at({...tMe(t),...e})}s(iD,"Required");function FRt(t,e){let r={};for(let n of globalThis.Object.getOwnPropertyNames(t))r[n]=iD(t[n],e);return r}s(FRt,"FromProperties");function ORt(t,e){return FRt(t.properties,e)}s(ORt,"FromMappedResult");function rMe(t,e){let r=ORt(t,e);return wo(r)}s(rMe,"RequiredFromMappedResult");function QRt(t,e){return e.map(r=>ac(r)?Lpe(t,r.$ref):v0(t,r))}s(QRt,"DereferenceParameters");function Lpe(t,e){return e in t?ac(t[e])?Lpe(t,t[e].$ref):v0(t,t[e]):Ei()}s(Lpe,"Dereference");function URt(t){return J4(t[0])}s(URt,"FromAwaited");function qRt(t){return II(t[0],t[1])}s(qRt,"FromIndex");function HRt(t){return X4(t[0])}s(HRt,"FromKeyOf");function $Rt(t){return nD(t[0])}s($Rt,"FromPartial");function WRt(t){return wI(t[0],t[1])}s(WRt,"FromOmit");function jRt(t){return SI(t[0],t[1])}s(jRt,"FromPick");function GRt(t){return iD(t[0])}s(GRt,"FromRequired");function VRt(t,e,r){let n=QRt(t,r);return e==="Awaited"?URt(n):e==="Index"?qRt(n):e==="KeyOf"?HRt(n):e==="Partial"?$Rt(n):e==="Omit"?WRt(n):e==="Pick"?jRt(n):e==="Required"?GRt(n):Ei()}s(VRt,"FromComputed");function zRt(t,e){return $4(v0(t,e))}s(zRt,"FromArray");function KRt(t,e){return W4(v0(t,e))}s(KRt,"FromAsyncIterator");function YRt(t,e,r){return j4(o9(t,e),v0(t,r))}s(YRt,"FromConstructor");function JRt(t,e,r){return uC(o9(t,e),v0(t,r))}s(JRt,"FromFunction");function XRt(t,e){return Rd(o9(t,e))}s(XRt,"FromIntersect");function ZRt(t,e){return Y4(v0(t,e))}s(ZRt,"FromIterator");function ekt(t,e){return Uo(globalThis.Object.keys(e).reduce((r,n)=>({...r,[n]:v0(t,e[n])}),{}))}s(ekt,"FromObject");function tkt(t,e){let[r,n]=[v0(t,sG(e)),oG(e)],i=O4(e);return i.patternProperties[n]=r,i}s(tkt,"FromRecord");function rkt(t,e){return ac(e)?{...Lpe(t,e.$ref),[Ra]:e[Ra]}:e}s(rkt,"FromTransform");function nkt(t,e){return Gm(o9(t,e))}s(nkt,"FromTuple");function ikt(t,e){return Qo(o9(t,e))}s(ikt,"FromUnion");function o9(t,e){return e.map(r=>v0(t,r))}s(o9,"FromTypes");function v0(t,e){return np(e)?at(v0(t,Va(e,[Uu])),e):U4(e)?at(v0(t,Va(e,[Yg])),e):Oo(e)?at(rkt(t,e),e):Jg(e)?at(zRt(t,e.items),e):G_(e)?at(KRt(t,e.items),e):Xg(e)?at(VRt(t,e.target,e.parameters)):Zg(e)?at(YRt(t,e.parameters,e.returns),e):eA(e)?at(JRt(t,e.parameters,e.returns),e):Ga(e)?at(XRt(t,e.allOf),e):z_(e)?at(ZRt(t,e.items),e):Nc(e)?at(ekt(t,e.properties),e):Y_(e)?at(tkt(t,e)):C0(e)?at(nkt(t,e.items||[]),e):vo(e)?at(ikt(t,e.anyOf),e):e}s(v0,"FromType");function okt(t,e){return e in t?v0(t,t[e]):Ei()}s(okt,"ComputeType");function nMe(t){return globalThis.Object.getOwnPropertyNames(t).reduce((e,r)=>({...e,[r]:okt(t,r)}),{})}s(nMe,"ComputeModuleProperties");var Fpe=class{static{s(this,"TModule")}constructor(e){let r=nMe(e),n=this.WithIdentifiers(r);this.$defs=n}Import(e,r){let n={...this.$defs,[e]:at(this.$defs[e],r)};return at({[ot]:"Import",$defs:n,$ref:e})}WithIdentifiers(e){return globalThis.Object.getOwnPropertyNames(e).reduce((r,n)=>({...r,[n]:{...e[n],$id:n}}),{})}};function iMe(t){return new Fpe(t)}s(iMe,"Module");d();function oMe(t,e){return at({[ot]:"Not",not:t},e)}s(oMe,"Not");d();function sMe(t,e){return eA(t)?Gm(t.parameters,e):Ei()}s(sMe,"Parameters");d();var skt=0;function aMe(t,e={}){Bc(e.$id)&&(e.$id=`T${skt++}`);let r=O4(t({[ot]:"This",$ref:`${e.$id}`}));return r.$id=e.$id,at({[Wm]:"Recursive",...r},e)}s(aMe,"Recursive");d();function cMe(t,e){let r=ws(t)?new globalThis.RegExp(t):t;return at({[ot]:"RegExp",type:"RegExp",source:r.source,flags:r.flags},e)}s(cMe,"RegExp");d();function akt(t){return Ga(t)?t.allOf:vo(t)?t.anyOf:C0(t)?t.items??[]:[]}s(akt,"RestResolve");function lMe(t){return akt(t)}s(lMe,"Rest");d();function uMe(t,e){return eA(t)?at(t.returns,e):Ei(e)}s(uMe,"ReturnType");d();var Ope=class{static{s(this,"TransformDecodeBuilder")}constructor(e){this.schema=e}Decode(e){return new Qpe(this.schema,e)}},Qpe=class{static{s(this,"TransformEncodeBuilder")}constructor(e,r){this.schema=e,this.decode=r}EncodeTransform(e,r){let o={Encode:s(a=>r[Ra].Encode(e(a)),"Encode"),Decode:s(a=>this.decode(r[Ra].Decode(a)),"Decode")};return{...r,[Ra]:o}}EncodeSchema(e,r){let n={Decode:this.decode,Encode:e};return{...r,[Ra]:n}}Encode(e){return Oo(this.schema)?this.EncodeTransform(e,this.schema):this.EncodeSchema(e,this.schema)}};function dMe(t){return new Ope(t)}s(dMe,"Transform");d();function fMe(t={}){return at({[ot]:t[ot]??"Unsafe"},t)}s(fMe,"Unsafe");d();function pMe(t){return at({[ot]:"Void",type:"void"},t)}s(pMe,"Void");d();var Upe={};Ia(Upe,{Any:()=>bI,Argument:()=>YNe,Array:()=>$4,AsyncIterator:()=>W4,Awaited:()=>J4,BigInt:()=>K4,Boolean:()=>Wj,Capitalize:()=>$8e,Composite:()=>h8e,Const:()=>g8e,Constructor:()=>j4,ConstructorParameters:()=>A8e,Date:()=>Kj,Enum:()=>y8e,Exclude:()=>tD,Extends:()=>eD,Extract:()=>rD,Function:()=>uC,Index:()=>II,InstanceType:()=>L8e,Instantiate:()=>O8e,Integer:()=>Q8e,Intersect:()=>Rd,Iterator:()=>Y4,KeyOf:()=>X4,Literal:()=>co,Lowercase:()=>W8e,Mapped:()=>l8e,Module:()=>iMe,Never:()=>Ei,Not:()=>oMe,Null:()=>Yj,Number:()=>jm,Object:()=>Uo,Omit:()=>wI,Optional:()=>_d,Parameters:()=>sMe,Partial:()=>nD,Pick:()=>SI,Promise:()=>Vj,Readonly:()=>op,ReadonlyOptional:()=>nG,Record:()=>iG,Recursive:()=>aMe,Ref:()=>zm,RegExp:()=>cMe,Required:()=>iD,Rest:()=>lMe,ReturnType:()=>uMe,String:()=>mf,Symbol:()=>Jj,TemplateLiteral:()=>jj,Transform:()=>dMe,Tuple:()=>Gm,Uint8Array:()=>Zj,Uncapitalize:()=>j8e,Undefined:()=>Xj,Union:()=>Qo,Unknown:()=>iA,Unsafe:()=>fMe,Uppercase:()=>G8e,Void:()=>pMe});d();var x=Upe;d();d();function ckt(t){switch(t.errorType){case nt.ArrayContains:return"Expected array to contain at least one matching value";case nt.ArrayMaxContains:return`Expected array to contain no more than ${t.schema.maxContains} matching values`;case nt.ArrayMinContains:return`Expected array to contain at least ${t.schema.minContains} matching values`;case nt.ArrayMaxItems:return`Expected array length to be less or equal to ${t.schema.maxItems}`;case nt.ArrayMinItems:return`Expected array length to be greater or equal to ${t.schema.minItems}`;case nt.ArrayUniqueItems:return"Expected array elements to be unique";case nt.Array:return"Expected array";case nt.AsyncIterator:return"Expected AsyncIterator";case nt.BigIntExclusiveMaximum:return`Expected bigint to be less than ${t.schema.exclusiveMaximum}`;case nt.BigIntExclusiveMinimum:return`Expected bigint to be greater than ${t.schema.exclusiveMinimum}`;case nt.BigIntMaximum:return`Expected bigint to be less or equal to ${t.schema.maximum}`;case nt.BigIntMinimum:return`Expected bigint to be greater or equal to ${t.schema.minimum}`;case nt.BigIntMultipleOf:return`Expected bigint to be a multiple of ${t.schema.multipleOf}`;case nt.BigInt:return"Expected bigint";case nt.Boolean:return"Expected boolean";case nt.DateExclusiveMinimumTimestamp:return`Expected Date timestamp to be greater than ${t.schema.exclusiveMinimumTimestamp}`;case nt.DateExclusiveMaximumTimestamp:return`Expected Date timestamp to be less than ${t.schema.exclusiveMaximumTimestamp}`;case nt.DateMinimumTimestamp:return`Expected Date timestamp to be greater or equal to ${t.schema.minimumTimestamp}`;case nt.DateMaximumTimestamp:return`Expected Date timestamp to be less or equal to ${t.schema.maximumTimestamp}`;case nt.DateMultipleOfTimestamp:return`Expected Date timestamp to be a multiple of ${t.schema.multipleOfTimestamp}`;case nt.Date:return"Expected Date";case nt.Function:return"Expected function";case nt.IntegerExclusiveMaximum:return`Expected integer to be less than ${t.schema.exclusiveMaximum}`;case nt.IntegerExclusiveMinimum:return`Expected integer to be greater than ${t.schema.exclusiveMinimum}`;case nt.IntegerMaximum:return`Expected integer to be less or equal to ${t.schema.maximum}`;case nt.IntegerMinimum:return`Expected integer to be greater or equal to ${t.schema.minimum}`;case nt.IntegerMultipleOf:return`Expected integer to be a multiple of ${t.schema.multipleOf}`;case nt.Integer:return"Expected integer";case nt.IntersectUnevaluatedProperties:return"Unexpected property";case nt.Intersect:return"Expected all values to match";case nt.Iterator:return"Expected Iterator";case nt.Literal:return`Expected ${typeof t.schema.const=="string"?`'${t.schema.const}'`:t.schema.const}`;case nt.Never:return"Never";case nt.Not:return"Value should not match";case nt.Null:return"Expected null";case nt.NumberExclusiveMaximum:return`Expected number to be less than ${t.schema.exclusiveMaximum}`;case nt.NumberExclusiveMinimum:return`Expected number to be greater than ${t.schema.exclusiveMinimum}`;case nt.NumberMaximum:return`Expected number to be less or equal to ${t.schema.maximum}`;case nt.NumberMinimum:return`Expected number to be greater or equal to ${t.schema.minimum}`;case nt.NumberMultipleOf:return`Expected number to be a multiple of ${t.schema.multipleOf}`;case nt.Number:return"Expected number";case nt.Object:return"Expected object";case nt.ObjectAdditionalProperties:return"Unexpected property";case nt.ObjectMaxProperties:return`Expected object to have no more than ${t.schema.maxProperties} properties`;case nt.ObjectMinProperties:return`Expected object to have at least ${t.schema.minProperties} properties`;case nt.ObjectRequiredProperty:return"Expected required property";case nt.Promise:return"Expected Promise";case nt.RegExp:return"Expected string to match regular expression";case nt.StringFormatUnknown:return`Unknown format '${t.schema.format}'`;case nt.StringFormat:return`Expected string to match '${t.schema.format}' format`;case nt.StringMaxLength:return`Expected string length less or equal to ${t.schema.maxLength}`;case nt.StringMinLength:return`Expected string length greater or equal to ${t.schema.minLength}`;case nt.StringPattern:return`Expected string to match '${t.schema.pattern}'`;case nt.String:return"Expected string";case nt.Symbol:return"Expected symbol";case nt.TupleLength:return`Expected tuple to have ${t.schema.maxItems||0} elements`;case nt.Tuple:return"Expected tuple";case nt.Uint8ArrayMaxByteLength:return`Expected byte length less or equal to ${t.schema.maxByteLength}`;case nt.Uint8ArrayMinByteLength:return`Expected byte length greater or equal to ${t.schema.minByteLength}`;case nt.Uint8Array:return"Expected Uint8Array";case nt.Undefined:return"Expected undefined";case nt.Union:return"Expected union value";case nt.Void:return"Expected void";case nt.Kind:return`Expected kind '${t.schema[ot]}'`;default:return"Unknown error type"}}s(ckt,"DefaultErrorFunction");var lkt=ckt;function mMe(){return lkt}s(mMe,"GetErrorFunction");d();var qpe=class extends Bn{static{s(this,"TypeDereferenceError")}constructor(e){super(`Unable to dereference schema with $id '${e.$ref}'`),this.schema=e}};function ukt(t,e){let r=e.find(n=>n.$id===t.$ref);if(r===void 0)throw new qpe(t);return So(r,e)}s(ukt,"Resolve");function Zl(t,e){return!Co(t.$id)||e.some(r=>r.$id===t.$id)||e.push(t),e}s(Zl,"Pushref");function So(t,e){return t[ot]==="This"||t[ot]==="Ref"?ukt(t,e):t}s(So,"Deref");d();var Hpe=class extends Bn{static{s(this,"ValueHashError")}constructor(e){super("Unable to hash value"),this.value=e}},x0;(function(t){t[t.Undefined=0]="Undefined",t[t.Null=1]="Null",t[t.Boolean=2]="Boolean",t[t.Number=3]="Number",t[t.String=4]="String",t[t.Object=5]="Object",t[t.Array=6]="Array",t[t.Date=7]="Date",t[t.Uint8Array=8]="Uint8Array",t[t.Symbol=9]="Symbol",t[t.BigInt=10]="BigInt"})(x0||(x0={}));var oD=BigInt("14695981039346656037"),[dkt,fkt]=[BigInt("1099511628211"),BigInt("18446744073709551616")],pkt=Array.from({length:256}).map((t,e)=>BigInt(e)),hMe=new Float64Array(1),gMe=new DataView(hMe.buffer),AMe=new Uint8Array(hMe.buffer);function*mkt(t){let e=t===0?1:Math.ceil(Math.floor(Math.log2(t)+1)/8);for(let r=0;r<e;r++)yield t>>8*(e-1-r)&255}s(mkt,"NumberToBytes");function hkt(t){Pd(x0.Array);for(let e of t)sD(e)}s(hkt,"ArrayType");function gkt(t){Pd(x0.Boolean),Pd(t?1:0)}s(gkt,"BooleanType");function Akt(t){Pd(x0.BigInt),gMe.setBigInt64(0,t);for(let e of AMe)Pd(e)}s(Akt,"BigIntType");function ykt(t){Pd(x0.Date),sD(t.getTime())}s(ykt,"DateType");function Ckt(t){Pd(x0.Null)}s(Ckt,"NullType");function vkt(t){Pd(x0.Number),gMe.setFloat64(0,t);for(let e of AMe)Pd(e)}s(vkt,"NumberType");function xkt(t){Pd(x0.Object);for(let e of globalThis.Object.getOwnPropertyNames(t).sort())sD(e),sD(t[e])}s(xkt,"ObjectType");function Ekt(t){Pd(x0.String);for(let e=0;e<t.length;e++)for(let r of mkt(t.charCodeAt(e)))Pd(r)}s(Ekt,"StringType");function bkt(t){Pd(x0.Symbol),sD(t.description)}s(bkt,"SymbolType");function Ikt(t){Pd(x0.Uint8Array);for(let e=0;e<t.length;e++)Pd(t[e])}s(Ikt,"Uint8ArrayType");function Tkt(t){return Pd(x0.Undefined)}s(Tkt,"UndefinedType");function sD(t){if(Dn(t))return hkt(t);if(aC(t))return gkt(t);if(Qu(t))return Akt(t);if(ff(t))return ykt(t);if(Mv(t))return Ckt(t);if(ln(t))return vkt(t);if(_i(t))return xkt(t);if(Co(t))return Ekt(t);if(Lv(t))return bkt(t);if(Q4(t))return Ikt(t);if(Xs(t))return Tkt(t);throw new Hpe(t)}s(sD,"Visit");function Pd(t){oD=oD^pkt[t],oD=oD*dkt%fkt}s(Pd,"FNV1A64");function _I(t){return oD=BigInt("14695981039346656037"),sD(t),oD}s(_I,"Hash");d();var $pe=class extends Bn{static{s(this,"ValueCheckUnknownTypeError")}constructor(e){super("Unknown type"),this.schema=e}};function wkt(t){return t[ot]==="Any"||t[ot]==="Unknown"}s(wkt,"IsAnyOrUnknown");function Ki(t){return t!==void 0}s(Ki,"IsDefined");function Skt(t,e,r){return!0}s(Skt,"FromAny");function _kt(t,e,r){return!0}s(_kt,"FromArgument");function Rkt(t,e,r){if(!Dn(r)||Ki(t.minItems)&&!(r.length>=t.minItems)||Ki(t.maxItems)&&!(r.length<=t.maxItems)||!r.every(o=>eu(t.items,e,o))||t.uniqueItems===!0&&!function(){let o=new Set;for(let a of r){let c=_I(a);if(o.has(c))return!1;o.add(c)}return!0}())return!1;if(!(Ki(t.contains)||ln(t.minContains)||ln(t.maxContains)))return!0;let n=Ki(t.contains)?t.contains:Ei(),i=r.reduce((o,a)=>eu(n,e,a)?o+1:o,0);return!(i===0||ln(t.minContains)&&i<t.minContains||ln(t.maxContains)&&i>t.maxContains)}s(Rkt,"FromArray");function kkt(t,e,r){return Lj(r)}s(kkt,"FromAsyncIterator");function Pkt(t,e,r){return!(!Qu(r)||Ki(t.exclusiveMaximum)&&!(r<t.exclusiveMaximum)||Ki(t.exclusiveMinimum)&&!(r>t.exclusiveMinimum)||Ki(t.maximum)&&!(r<=t.maximum)||Ki(t.minimum)&&!(r>=t.minimum)||Ki(t.multipleOf)&&r%t.multipleOf!==BigInt(0))}s(Pkt,"FromBigInt");function Dkt(t,e,r){return aC(r)}s(Dkt,"FromBoolean");function Bkt(t,e,r){return eu(t.returns,e,r.prototype)}s(Bkt,"FromConstructor");function Nkt(t,e,r){return!(!ff(r)||Ki(t.exclusiveMaximumTimestamp)&&!(r.getTime()<t.exclusiveMaximumTimestamp)||Ki(t.exclusiveMinimumTimestamp)&&!(r.getTime()>t.exclusiveMinimumTimestamp)||Ki(t.maximumTimestamp)&&!(r.getTime()<=t.maximumTimestamp)||Ki(t.minimumTimestamp)&&!(r.getTime()>=t.minimumTimestamp)||Ki(t.multipleOfTimestamp)&&r.getTime()%t.multipleOfTimestamp!==0)}s(Nkt,"FromDate");function Mkt(t,e,r){return vI(r)}s(Mkt,"FromFunction");function Lkt(t,e,r){let n=globalThis.Object.values(t.$defs),i=t.$defs[t.$ref];return eu(i,[...e,...n],r)}s(Lkt,"FromImport");function Fkt(t,e,r){return!(!Qj(r)||Ki(t.exclusiveMaximum)&&!(r<t.exclusiveMaximum)||Ki(t.exclusiveMinimum)&&!(r>t.exclusiveMinimum)||Ki(t.maximum)&&!(r<=t.maximum)||Ki(t.minimum)&&!(r>=t.minimum)||Ki(t.multipleOf)&&r%t.multipleOf!==0)}s(Fkt,"FromInteger");function Okt(t,e,r){let n=t.allOf.every(i=>eu(i,e,r));if(t.unevaluatedProperties===!1){let i=new RegExp(Hv(t)),o=Object.getOwnPropertyNames(r).every(a=>i.test(a));return n&&o}else if(ka(t.unevaluatedProperties)){let i=new RegExp(Hv(t)),o=Object.getOwnPropertyNames(r).every(a=>i.test(a)||eu(t.unevaluatedProperties,e,r[a]));return n&&o}else return n}s(Okt,"FromIntersect");function Qkt(t,e,r){return Fj(r)}s(Qkt,"FromIterator");function Ukt(t,e,r){return r===t.const}s(Ukt,"FromLiteral");function qkt(t,e,r){return!1}s(qkt,"FromNever");function Hkt(t,e,r){return!eu(t.not,e,r)}s(Hkt,"FromNot");function $kt(t,e,r){return Mv(r)}s($kt,"FromNull");function Wkt(t,e,r){return!(!Ls.IsNumberLike(r)||Ki(t.exclusiveMaximum)&&!(r<t.exclusiveMaximum)||Ki(t.exclusiveMinimum)&&!(r>t.exclusiveMinimum)||Ki(t.minimum)&&!(r>=t.minimum)||Ki(t.maximum)&&!(r<=t.maximum)||Ki(t.multipleOf)&&r%t.multipleOf!==0)}s(Wkt,"FromNumber");function jkt(t,e,r){if(!Ls.IsObjectLike(r)||Ki(t.minProperties)&&!(Object.getOwnPropertyNames(r).length>=t.minProperties)||Ki(t.maxProperties)&&!(Object.getOwnPropertyNames(r).length<=t.maxProperties))return!1;let n=Object.getOwnPropertyNames(t.properties);for(let i of n){let o=t.properties[i];if(t.required&&t.required.includes(i)){if(!eu(o,e,r[i])||($v(o)||wkt(o))&&!(i in r))return!1}else if(Ls.IsExactOptionalProperty(r,i)&&!eu(o,e,r[i]))return!1}if(t.additionalProperties===!1){let i=Object.getOwnPropertyNames(r);return t.required&&t.required.length===n.length&&i.length===n.length?!0:i.every(o=>n.includes(o))}else return typeof t.additionalProperties=="object"?Object.getOwnPropertyNames(r).every(o=>n.includes(o)||eu(t.additionalProperties,e,r[o])):!0}s(jkt,"FromObject");function Gkt(t,e,r){return Oj(r)}s(Gkt,"FromPromise");function Vkt(t,e,r){if(!Ls.IsRecordLike(r)||Ki(t.minProperties)&&!(Object.getOwnPropertyNames(r).length>=t.minProperties)||Ki(t.maxProperties)&&!(Object.getOwnPropertyNames(r).length<=t.maxProperties))return!1;let[n,i]=Object.entries(t.patternProperties)[0],o=new RegExp(n),a=Object.entries(r).every(([u,f])=>o.test(u)?eu(i,e,f):!0),c=typeof t.additionalProperties=="object"?Object.entries(r).every(([u,f])=>o.test(u)?!0:eu(t.additionalProperties,e,f)):!0,l=t.additionalProperties===!1?Object.getOwnPropertyNames(r).every(u=>o.test(u)):!0;return a&&c&&l}s(Vkt,"FromRecord");function zkt(t,e,r){return eu(So(t,e),e,r)}s(zkt,"FromRef");function Kkt(t,e,r){let n=new RegExp(t.source,t.flags);return Ki(t.minLength)&&!(r.length>=t.minLength)||Ki(t.maxLength)&&!(r.length<=t.maxLength)?!1:n.test(r)}s(Kkt,"FromRegExp");function Ykt(t,e,r){return!Co(r)||Ki(t.minLength)&&!(r.length>=t.minLength)||Ki(t.maxLength)&&!(r.length<=t.maxLength)||Ki(t.pattern)&&!new RegExp(t.pattern).test(r)?!1:Ki(t.format)?nA.Has(t.format)?nA.Get(t.format)(r):!1:!0}s(Ykt,"FromString");function Jkt(t,e,r){return Lv(r)}s(Jkt,"FromSymbol");function Xkt(t,e,r){return Co(r)&&new RegExp(t.pattern).test(r)}s(Xkt,"FromTemplateLiteral");function Zkt(t,e,r){return eu(So(t,e),e,r)}s(Zkt,"FromThis");function ePt(t,e,r){if(!Dn(r)||t.items===void 0&&r.length!==0||r.length!==t.maxItems)return!1;if(!t.items)return!0;for(let n=0;n<t.items.length;n++)if(!eu(t.items[n],e,r[n]))return!1;return!0}s(ePt,"FromTuple");function tPt(t,e,r){return Xs(r)}s(tPt,"FromUndefined");function rPt(t,e,r){return t.anyOf.some(n=>eu(n,e,r))}s(rPt,"FromUnion");function nPt(t,e,r){return!(!Q4(r)||Ki(t.maxByteLength)&&!(r.length<=t.maxByteLength)||Ki(t.minByteLength)&&!(r.length>=t.minByteLength))}s(nPt,"FromUint8Array");function iPt(t,e,r){return!0}s(iPt,"FromUnknown");function oPt(t,e,r){return Ls.IsVoidLike(r)}s(oPt,"FromVoid");function sPt(t,e,r){return pf.Has(t[ot])?pf.Get(t[ot])(t,r):!1}s(sPt,"FromKind");function eu(t,e,r){let n=Ki(t.$id)?Zl(t,e):e,i=t;switch(i[ot]){case"Any":return Skt(i,n,r);case"Argument":return _kt(i,n,r);case"Array":return Rkt(i,n,r);case"AsyncIterator":return kkt(i,n,r);case"BigInt":return Pkt(i,n,r);case"Boolean":return Dkt(i,n,r);case"Constructor":return Bkt(i,n,r);case"Date":return Nkt(i,n,r);case"Function":return Mkt(i,n,r);case"Import":return Lkt(i,n,r);case"Integer":return Fkt(i,n,r);case"Intersect":return Okt(i,n,r);case"Iterator":return Qkt(i,n,r);case"Literal":return Ukt(i,n,r);case"Never":return qkt(i,n,r);case"Not":return Hkt(i,n,r);case"Null":return $kt(i,n,r);case"Number":return Wkt(i,n,r);case"Object":return jkt(i,n,r);case"Promise":return Gkt(i,n,r);case"Record":return Vkt(i,n,r);case"Ref":return zkt(i,n,r);case"RegExp":return Kkt(i,n,r);case"String":return Ykt(i,n,r);case"Symbol":return Jkt(i,n,r);case"TemplateLiteral":return Xkt(i,n,r);case"This":return Zkt(i,n,r);case"Tuple":return ePt(i,n,r);case"Undefined":return tPt(i,n,r);case"Union":return rPt(i,n,r);case"Uint8Array":return nPt(i,n,r);case"Unknown":return iPt(i,n,r);case"Void":return oPt(i,n,r);default:if(!pf.Has(i[ot]))throw new $pe(i);return sPt(i,n,r)}}s(eu,"Visit");function Di(...t){return t.length===3?eu(t[0],t[1],t[2]):eu(t[0],[],t[1])}s(Di,"Check");var nt;(function(t){t[t.ArrayContains=0]="ArrayContains",t[t.ArrayMaxContains=1]="ArrayMaxContains",t[t.ArrayMaxItems=2]="ArrayMaxItems",t[t.ArrayMinContains=3]="ArrayMinContains",t[t.ArrayMinItems=4]="ArrayMinItems",t[t.ArrayUniqueItems=5]="ArrayUniqueItems",t[t.Array=6]="Array",t[t.AsyncIterator=7]="AsyncIterator",t[t.BigIntExclusiveMaximum=8]="BigIntExclusiveMaximum",t[t.BigIntExclusiveMinimum=9]="BigIntExclusiveMinimum",t[t.BigIntMaximum=10]="BigIntMaximum",t[t.BigIntMinimum=11]="BigIntMinimum",t[t.BigIntMultipleOf=12]="BigIntMultipleOf",t[t.BigInt=13]="BigInt",t[t.Boolean=14]="Boolean",t[t.DateExclusiveMaximumTimestamp=15]="DateExclusiveMaximumTimestamp",t[t.DateExclusiveMinimumTimestamp=16]="DateExclusiveMinimumTimestamp",t[t.DateMaximumTimestamp=17]="DateMaximumTimestamp",t[t.DateMinimumTimestamp=18]="DateMinimumTimestamp",t[t.DateMultipleOfTimestamp=19]="DateMultipleOfTimestamp",t[t.Date=20]="Date",t[t.Function=21]="Function",t[t.IntegerExclusiveMaximum=22]="IntegerExclusiveMaximum",t[t.IntegerExclusiveMinimum=23]="IntegerExclusiveMinimum",t[t.IntegerMaximum=24]="IntegerMaximum",t[t.IntegerMinimum=25]="IntegerMinimum",t[t.IntegerMultipleOf=26]="IntegerMultipleOf",t[t.Integer=27]="Integer",t[t.IntersectUnevaluatedProperties=28]="IntersectUnevaluatedProperties",t[t.Intersect=29]="Intersect",t[t.Iterator=30]="Iterator",t[t.Kind=31]="Kind",t[t.Literal=32]="Literal",t[t.Never=33]="Never",t[t.Not=34]="Not",t[t.Null=35]="Null",t[t.NumberExclusiveMaximum=36]="NumberExclusiveMaximum",t[t.NumberExclusiveMinimum=37]="NumberExclusiveMinimum",t[t.NumberMaximum=38]="NumberMaximum",t[t.NumberMinimum=39]="NumberMinimum",t[t.NumberMultipleOf=40]="NumberMultipleOf",t[t.Number=41]="Number",t[t.ObjectAdditionalProperties=42]="ObjectAdditionalProperties",t[t.ObjectMaxProperties=43]="ObjectMaxProperties",t[t.ObjectMinProperties=44]="ObjectMinProperties",t[t.ObjectRequiredProperty=45]="ObjectRequiredProperty",t[t.Object=46]="Object",t[t.Promise=47]="Promise",t[t.RegExp=48]="RegExp",t[t.StringFormatUnknown=49]="StringFormatUnknown",t[t.StringFormat=50]="StringFormat",t[t.StringMaxLength=51]="StringMaxLength",t[t.StringMinLength=52]="StringMinLength",t[t.StringPattern=53]="StringPattern",t[t.String=54]="String",t[t.Symbol=55]="Symbol",t[t.TupleLength=56]="TupleLength",t[t.Tuple=57]="Tuple",t[t.Uint8ArrayMaxByteLength=58]="Uint8ArrayMaxByteLength",t[t.Uint8ArrayMinByteLength=59]="Uint8ArrayMinByteLength",t[t.Uint8Array=60]="Uint8Array",t[t.Undefined=61]="Undefined",t[t.Union=62]="Union",t[t.Void=63]="Void"})(nt||(nt={}));var Wpe=class extends Bn{static{s(this,"ValueErrorsUnknownTypeError")}constructor(e){super("Unknown type"),this.schema=e}};function Wv(t){return t.replace(/~/g,"~0").replace(/\//g,"~1")}s(Wv,"EscapeKey");function Yi(t){return t!==void 0}s(Yi,"IsDefined");var RI=class{static{s(this,"ValueErrorIterator")}constructor(e){this.iterator=e}[Symbol.iterator](){return this.iterator}First(){let e=this.iterator.next();return e.done?void 0:e.value}};function mr(t,e,r,n,i=[]){return{type:t,schema:e,path:r,value:n,message:mMe()({errorType:t,path:r,schema:e,value:n,errors:i}),errors:i}}s(mr,"Create");function*aPt(t,e,r,n){}s(aPt,"FromAny");function*cPt(t,e,r,n){}s(cPt,"FromArgument");function*lPt(t,e,r,n){if(!Dn(n))return yield mr(nt.Array,t,r,n);Yi(t.minItems)&&!(n.length>=t.minItems)&&(yield mr(nt.ArrayMinItems,t,r,n)),Yi(t.maxItems)&&!(n.length<=t.maxItems)&&(yield mr(nt.ArrayMaxItems,t,r,n));for(let a=0;a<n.length;a++)yield*tu(t.items,e,`${r}/${a}`,n[a]);if(t.uniqueItems===!0&&!function(){let a=new Set;for(let c of n){let l=_I(c);if(a.has(l))return!1;a.add(l)}return!0}()&&(yield mr(nt.ArrayUniqueItems,t,r,n)),!(Yi(t.contains)||Yi(t.minContains)||Yi(t.maxContains)))return;let i=Yi(t.contains)?t.contains:Ei(),o=n.reduce((a,c,l)=>tu(i,e,`${r}${l}`,c).next().done===!0?a+1:a,0);o===0&&(yield mr(nt.ArrayContains,t,r,n)),ln(t.minContains)&&o<t.minContains&&(yield mr(nt.ArrayMinContains,t,r,n)),ln(t.maxContains)&&o>t.maxContains&&(yield mr(nt.ArrayMaxContains,t,r,n))}s(lPt,"FromArray");function*uPt(t,e,r,n){Lj(n)||(yield mr(nt.AsyncIterator,t,r,n))}s(uPt,"FromAsyncIterator");function*dPt(t,e,r,n){if(!Qu(n))return yield mr(nt.BigInt,t,r,n);Yi(t.exclusiveMaximum)&&!(n<t.exclusiveMaximum)&&(yield mr(nt.BigIntExclusiveMaximum,t,r,n)),Yi(t.exclusiveMinimum)&&!(n>t.exclusiveMinimum)&&(yield mr(nt.BigIntExclusiveMinimum,t,r,n)),Yi(t.maximum)&&!(n<=t.maximum)&&(yield mr(nt.BigIntMaximum,t,r,n)),Yi(t.minimum)&&!(n>=t.minimum)&&(yield mr(nt.BigIntMinimum,t,r,n)),Yi(t.multipleOf)&&n%t.multipleOf!==BigInt(0)&&(yield mr(nt.BigIntMultipleOf,t,r,n))}s(dPt,"FromBigInt");function*fPt(t,e,r,n){aC(n)||(yield mr(nt.Boolean,t,r,n))}s(fPt,"FromBoolean");function*pPt(t,e,r,n){yield*tu(t.returns,e,r,n.prototype)}s(pPt,"FromConstructor");function*mPt(t,e,r,n){if(!ff(n))return yield mr(nt.Date,t,r,n);Yi(t.exclusiveMaximumTimestamp)&&!(n.getTime()<t.exclusiveMaximumTimestamp)&&(yield mr(nt.DateExclusiveMaximumTimestamp,t,r,n)),Yi(t.exclusiveMinimumTimestamp)&&!(n.getTime()>t.exclusiveMinimumTimestamp)&&(yield mr(nt.DateExclusiveMinimumTimestamp,t,r,n)),Yi(t.maximumTimestamp)&&!(n.getTime()<=t.maximumTimestamp)&&(yield mr(nt.DateMaximumTimestamp,t,r,n)),Yi(t.minimumTimestamp)&&!(n.getTime()>=t.minimumTimestamp)&&(yield mr(nt.DateMinimumTimestamp,t,r,n)),Yi(t.multipleOfTimestamp)&&n.getTime()%t.multipleOfTimestamp!==0&&(yield mr(nt.DateMultipleOfTimestamp,t,r,n))}s(mPt,"FromDate");function*hPt(t,e,r,n){vI(n)||(yield mr(nt.Function,t,r,n))}s(hPt,"FromFunction");function*gPt(t,e,r,n){let i=globalThis.Object.values(t.$defs),o=t.$defs[t.$ref];yield*tu(o,[...e,...i],r,n)}s(gPt,"FromImport");function*APt(t,e,r,n){if(!Qj(n))return yield mr(nt.Integer,t,r,n);Yi(t.exclusiveMaximum)&&!(n<t.exclusiveMaximum)&&(yield mr(nt.IntegerExclusiveMaximum,t,r,n)),Yi(t.exclusiveMinimum)&&!(n>t.exclusiveMinimum)&&(yield mr(nt.IntegerExclusiveMinimum,t,r,n)),Yi(t.maximum)&&!(n<=t.maximum)&&(yield mr(nt.IntegerMaximum,t,r,n)),Yi(t.minimum)&&!(n>=t.minimum)&&(yield mr(nt.IntegerMinimum,t,r,n)),Yi(t.multipleOf)&&n%t.multipleOf!==0&&(yield mr(nt.IntegerMultipleOf,t,r,n))}s(APt,"FromInteger");function*yPt(t,e,r,n){let i=!1;for(let o of t.allOf)for(let a of tu(o,e,r,n))i=!0,yield a;if(i)return yield mr(nt.Intersect,t,r,n);if(t.unevaluatedProperties===!1){let o=new RegExp(Hv(t));for(let a of Object.getOwnPropertyNames(n))o.test(a)||(yield mr(nt.IntersectUnevaluatedProperties,t,`${r}/${a}`,n))}if(typeof t.unevaluatedProperties=="object"){let o=new RegExp(Hv(t));for(let a of Object.getOwnPropertyNames(n))if(!o.test(a)){let c=tu(t.unevaluatedProperties,e,`${r}/${a}`,n[a]).next();c.done||(yield c.value)}}}s(yPt,"FromIntersect");function*CPt(t,e,r,n){Fj(n)||(yield mr(nt.Iterator,t,r,n))}s(CPt,"FromIterator");function*vPt(t,e,r,n){n!==t.const&&(yield mr(nt.Literal,t,r,n))}s(vPt,"FromLiteral");function*xPt(t,e,r,n){yield mr(nt.Never,t,r,n)}s(xPt,"FromNever");function*EPt(t,e,r,n){tu(t.not,e,r,n).next().done===!0&&(yield mr(nt.Not,t,r,n))}s(EPt,"FromNot");function*bPt(t,e,r,n){Mv(n)||(yield mr(nt.Null,t,r,n))}s(bPt,"FromNull");function*IPt(t,e,r,n){if(!Ls.IsNumberLike(n))return yield mr(nt.Number,t,r,n);Yi(t.exclusiveMaximum)&&!(n<t.exclusiveMaximum)&&(yield mr(nt.NumberExclusiveMaximum,t,r,n)),Yi(t.exclusiveMinimum)&&!(n>t.exclusiveMinimum)&&(yield mr(nt.NumberExclusiveMinimum,t,r,n)),Yi(t.maximum)&&!(n<=t.maximum)&&(yield mr(nt.NumberMaximum,t,r,n)),Yi(t.minimum)&&!(n>=t.minimum)&&(yield mr(nt.NumberMinimum,t,r,n)),Yi(t.multipleOf)&&n%t.multipleOf!==0&&(yield mr(nt.NumberMultipleOf,t,r,n))}s(IPt,"FromNumber");function*TPt(t,e,r,n){if(!Ls.IsObjectLike(n))return yield mr(nt.Object,t,r,n);Yi(t.minProperties)&&!(Object.getOwnPropertyNames(n).length>=t.minProperties)&&(yield mr(nt.ObjectMinProperties,t,r,n)),Yi(t.maxProperties)&&!(Object.getOwnPropertyNames(n).length<=t.maxProperties)&&(yield mr(nt.ObjectMaxProperties,t,r,n));let i=Array.isArray(t.required)?t.required:[],o=Object.getOwnPropertyNames(t.properties),a=Object.getOwnPropertyNames(n);for(let c of i)a.includes(c)||(yield mr(nt.ObjectRequiredProperty,t.properties[c],`${r}/${Wv(c)}`,void 0));if(t.additionalProperties===!1)for(let c of a)o.includes(c)||(yield mr(nt.ObjectAdditionalProperties,t,`${r}/${Wv(c)}`,n[c]));if(typeof t.additionalProperties=="object")for(let c of a)o.includes(c)||(yield*tu(t.additionalProperties,e,`${r}/${Wv(c)}`,n[c]));for(let c of o){let l=t.properties[c];t.required&&t.required.includes(c)?(yield*tu(l,e,`${r}/${Wv(c)}`,n[c]),$v(t)&&!(c in n)&&(yield mr(nt.ObjectRequiredProperty,l,`${r}/${Wv(c)}`,void 0))):Ls.IsExactOptionalProperty(n,c)&&(yield*tu(l,e,`${r}/${Wv(c)}`,n[c]))}}s(TPt,"FromObject");function*wPt(t,e,r,n){Oj(n)||(yield mr(nt.Promise,t,r,n))}s(wPt,"FromPromise");function*SPt(t,e,r,n){if(!Ls.IsRecordLike(n))return yield mr(nt.Object,t,r,n);Yi(t.minProperties)&&!(Object.getOwnPropertyNames(n).length>=t.minProperties)&&(yield mr(nt.ObjectMinProperties,t,r,n)),Yi(t.maxProperties)&&!(Object.getOwnPropertyNames(n).length<=t.maxProperties)&&(yield mr(nt.ObjectMaxProperties,t,r,n));let[i,o]=Object.entries(t.patternProperties)[0],a=new RegExp(i);for(let[c,l]of Object.entries(n))a.test(c)&&(yield*tu(o,e,`${r}/${Wv(c)}`,l));if(typeof t.additionalProperties=="object")for(let[c,l]of Object.entries(n))a.test(c)||(yield*tu(t.additionalProperties,e,`${r}/${Wv(c)}`,l));if(t.additionalProperties===!1){for(let[c,l]of Object.entries(n))if(!a.test(c))return yield mr(nt.ObjectAdditionalProperties,t,`${r}/${Wv(c)}`,l)}}s(SPt,"FromRecord");function*_Pt(t,e,r,n){yield*tu(So(t,e),e,r,n)}s(_Pt,"FromRef");function*RPt(t,e,r,n){if(!Co(n))return yield mr(nt.String,t,r,n);if(Yi(t.minLength)&&!(n.length>=t.minLength)&&(yield mr(nt.StringMinLength,t,r,n)),Yi(t.maxLength)&&!(n.length<=t.maxLength)&&(yield mr(nt.StringMaxLength,t,r,n)),!new RegExp(t.source,t.flags).test(n))return yield mr(nt.RegExp,t,r,n)}s(RPt,"FromRegExp");function*kPt(t,e,r,n){if(!Co(n))return yield mr(nt.String,t,r,n);Yi(t.minLength)&&!(n.length>=t.minLength)&&(yield mr(nt.StringMinLength,t,r,n)),Yi(t.maxLength)&&!(n.length<=t.maxLength)&&(yield mr(nt.StringMaxLength,t,r,n)),Co(t.pattern)&&(new RegExp(t.pattern).test(n)||(yield mr(nt.StringPattern,t,r,n))),Co(t.format)&&(nA.Has(t.format)?nA.Get(t.format)(n)||(yield mr(nt.StringFormat,t,r,n)):yield mr(nt.StringFormatUnknown,t,r,n))}s(kPt,"FromString");function*PPt(t,e,r,n){Lv(n)||(yield mr(nt.Symbol,t,r,n))}s(PPt,"FromSymbol");function*DPt(t,e,r,n){if(!Co(n))return yield mr(nt.String,t,r,n);new RegExp(t.pattern).test(n)||(yield mr(nt.StringPattern,t,r,n))}s(DPt,"FromTemplateLiteral");function*BPt(t,e,r,n){yield*tu(So(t,e),e,r,n)}s(BPt,"FromThis");function*NPt(t,e,r,n){if(!Dn(n))return yield mr(nt.Tuple,t,r,n);if(t.items===void 0&&n.length!==0)return yield mr(nt.TupleLength,t,r,n);if(n.length!==t.maxItems)return yield mr(nt.TupleLength,t,r,n);if(t.items)for(let i=0;i<t.items.length;i++)yield*tu(t.items[i],e,`${r}/${i}`,n[i])}s(NPt,"FromTuple");function*MPt(t,e,r,n){Xs(n)||(yield mr(nt.Undefined,t,r,n))}s(MPt,"FromUndefined");function*LPt(t,e,r,n){if(Di(t,e,n))return;let i=t.anyOf.map(o=>new RI(tu(o,e,r,n)));yield mr(nt.Union,t,r,n,i)}s(LPt,"FromUnion");function*FPt(t,e,r,n){if(!Q4(n))return yield mr(nt.Uint8Array,t,r,n);Yi(t.maxByteLength)&&!(n.length<=t.maxByteLength)&&(yield mr(nt.Uint8ArrayMaxByteLength,t,r,n)),Yi(t.minByteLength)&&!(n.length>=t.minByteLength)&&(yield mr(nt.Uint8ArrayMinByteLength,t,r,n))}s(FPt,"FromUint8Array");function*OPt(t,e,r,n){}s(OPt,"FromUnknown");function*QPt(t,e,r,n){Ls.IsVoidLike(n)||(yield mr(nt.Void,t,r,n))}s(QPt,"FromVoid");function*UPt(t,e,r,n){pf.Get(t[ot])(t,n)||(yield mr(nt.Kind,t,r,n))}s(UPt,"FromKind");function*tu(t,e,r,n){let i=Yi(t.$id)?[...e,t]:e,o=t;switch(o[ot]){case"Any":return yield*aPt(o,i,r,n);case"Argument":return yield*cPt(o,i,r,n);case"Array":return yield*lPt(o,i,r,n);case"AsyncIterator":return yield*uPt(o,i,r,n);case"BigInt":return yield*dPt(o,i,r,n);case"Boolean":return yield*fPt(o,i,r,n);case"Constructor":return yield*pPt(o,i,r,n);case"Date":return yield*mPt(o,i,r,n);case"Function":return yield*hPt(o,i,r,n);case"Import":return yield*gPt(o,i,r,n);case"Integer":return yield*APt(o,i,r,n);case"Intersect":return yield*yPt(o,i,r,n);case"Iterator":return yield*CPt(o,i,r,n);case"Literal":return yield*vPt(o,i,r,n);case"Never":return yield*xPt(o,i,r,n);case"Not":return yield*EPt(o,i,r,n);case"Null":return yield*bPt(o,i,r,n);case"Number":return yield*IPt(o,i,r,n);case"Object":return yield*TPt(o,i,r,n);case"Promise":return yield*wPt(o,i,r,n);case"Record":return yield*SPt(o,i,r,n);case"Ref":return yield*_Pt(o,i,r,n);case"RegExp":return yield*RPt(o,i,r,n);case"String":return yield*kPt(o,i,r,n);case"Symbol":return yield*PPt(o,i,r,n);case"TemplateLiteral":return yield*DPt(o,i,r,n);case"This":return yield*BPt(o,i,r,n);case"Tuple":return yield*NPt(o,i,r,n);case"Undefined":return yield*MPt(o,i,r,n);case"Union":return yield*LPt(o,i,r,n);case"Uint8Array":return yield*FPt(o,i,r,n);case"Unknown":return yield*OPt(o,i,r,n);case"Void":return yield*QPt(o,i,r,n);default:if(!pf.Has(o[ot]))throw new Wpe(t);return yield*UPt(o,i,r,n)}}s(tu,"Visit");function fC(...t){let e=t.length===3?tu(t[0],t[1],"",t[2]):tu(t[0],[],"",t[1]);return new RI(e)}s(fC,"Errors");d();d();var aD=class extends Bn{static{s(this,"TransformDecodeCheckError")}constructor(e,r,n){super("Unable to decode value as it does not match the expected schema"),this.schema=e,this.value=r,this.error=n}},jpe=class extends Bn{static{s(this,"TransformDecodeError")}constructor(e,r,n,i){super(i instanceof Error?i.message:"Unknown error"),this.schema=e,this.path=r,this.value=n,this.error=i}};function Pa(t,e,r){try{return Oo(t)?t[Ra].Decode(r):r}catch(n){throw new jpe(t,e,r,n)}}s(Pa,"Default");function qPt(t,e,r,n){return Dn(n)?Pa(t,r,n.map((i,o)=>aA(t.items,e,`${r}/${o}`,i))):Pa(t,r,n)}s(qPt,"FromArray");function HPt(t,e,r,n){if(!_i(n)||h0(n))return Pa(t,r,n);let i=zj(t),o=i.map(f=>f[0]),a={...n};for(let[f,p]of i)f in a&&(a[f]=aA(p,e,`${r}/${f}`,a[f]));if(!Oo(t.unevaluatedProperties))return Pa(t,r,a);let c=Object.getOwnPropertyNames(a),l=t.unevaluatedProperties,u={...a};for(let f of c)o.includes(f)||(u[f]=Pa(l,`${r}/${f}`,u[f]));return Pa(t,r,u)}s(HPt,"FromIntersect");function $Pt(t,e,r,n){let i=globalThis.Object.values(t.$defs),o=t.$defs[t.$ref],a=aA(o,[...e,...i],r,n);return Pa(t,r,a)}s($Pt,"FromImport");function WPt(t,e,r,n){return Pa(t,r,aA(t.not,e,r,n))}s(WPt,"FromNot");function jPt(t,e,r,n){if(!_i(n))return Pa(t,r,n);let i=sp(t),o={...n};for(let u of i)Pn(o,u)&&(Xs(o[u])&&(!Qv(t.properties[u])||Ls.IsExactOptionalProperty(o,u))||(o[u]=aA(t.properties[u],e,`${r}/${u}`,o[u])));if(!ka(t.additionalProperties))return Pa(t,r,o);let a=Object.getOwnPropertyNames(o),c=t.additionalProperties,l={...o};for(let u of a)i.includes(u)||(l[u]=Pa(c,`${r}/${u}`,l[u]));return Pa(t,r,l)}s(jPt,"FromObject");function GPt(t,e,r,n){if(!_i(n))return Pa(t,r,n);let i=Object.getOwnPropertyNames(t.patternProperties)[0],o=new RegExp(i),a={...n};for(let f of Object.getOwnPropertyNames(n))o.test(f)&&(a[f]=aA(t.patternProperties[i],e,`${r}/${f}`,a[f]));if(!ka(t.additionalProperties))return Pa(t,r,a);let c=Object.getOwnPropertyNames(a),l=t.additionalProperties,u={...a};for(let f of c)o.test(f)||(u[f]=Pa(l,`${r}/${f}`,u[f]));return Pa(t,r,u)}s(GPt,"FromRecord");function VPt(t,e,r,n){let i=So(t,e);return Pa(t,r,aA(i,e,r,n))}s(VPt,"FromRef");function zPt(t,e,r,n){let i=So(t,e);return Pa(t,r,aA(i,e,r,n))}s(zPt,"FromThis");function KPt(t,e,r,n){return Dn(n)&&Dn(t.items)?Pa(t,r,t.items.map((i,o)=>aA(i,e,`${r}/${o}`,n[o]))):Pa(t,r,n)}s(KPt,"FromTuple");function YPt(t,e,r,n){for(let i of t.anyOf){if(!Di(i,e,n))continue;let o=aA(i,e,r,n);return Pa(t,r,o)}return Pa(t,r,n)}s(YPt,"FromUnion");function aA(t,e,r,n){let i=Zl(t,e),o=t;switch(t[ot]){case"Array":return qPt(o,i,r,n);case"Import":return $Pt(o,i,r,n);case"Intersect":return HPt(o,i,r,n);case"Not":return WPt(o,i,r,n);case"Object":return jPt(o,i,r,n);case"Record":return GPt(o,i,r,n);case"Ref":return VPt(o,i,r,n);case"Symbol":return Pa(o,r,n);case"This":return zPt(o,i,r,n);case"Tuple":return KPt(o,i,r,n);case"Union":return YPt(o,i,r,n);default:return Pa(o,r,n)}}s(aA,"Visit");function cD(t,e,r){return aA(t,e,"",r)}s(cD,"TransformDecode");d();var lD=class extends Bn{static{s(this,"TransformEncodeCheckError")}constructor(e,r,n){super("The encoded value does not match the expected schema"),this.schema=e,this.value=r,this.error=n}},Gpe=class extends Bn{static{s(this,"TransformEncodeError")}constructor(e,r,n,i){super(`${i instanceof Error?i.message:"Unknown error"}`),this.schema=e,this.path=r,this.value=n,this.error=i}};function qu(t,e,r){try{return Oo(t)?t[Ra].Encode(r):r}catch(n){throw new Gpe(t,e,r,n)}}s(qu,"Default");function JPt(t,e,r,n){let i=qu(t,r,n);return Dn(i)?i.map((o,a)=>cA(t.items,e,`${r}/${a}`,o)):i}s(JPt,"FromArray");function XPt(t,e,r,n){let i=globalThis.Object.values(t.$defs),o=t.$defs[t.$ref],a=qu(t,r,n);return cA(o,[...e,...i],r,a)}s(XPt,"FromImport");function ZPt(t,e,r,n){let i=qu(t,r,n);if(!_i(n)||h0(n))return i;let o=zj(t),a=o.map(p=>p[0]),c={...i};for(let[p,m]of o)p in c&&(c[p]=cA(m,e,`${r}/${p}`,c[p]));if(!Oo(t.unevaluatedProperties))return c;let l=Object.getOwnPropertyNames(c),u=t.unevaluatedProperties,f={...c};for(let p of l)a.includes(p)||(f[p]=qu(u,`${r}/${p}`,f[p]));return f}s(ZPt,"FromIntersect");function e5t(t,e,r,n){return qu(t.not,r,qu(t,r,n))}s(e5t,"FromNot");function t5t(t,e,r,n){let i=qu(t,r,n);if(!_i(i))return i;let o=sp(t),a={...i};for(let f of o)Pn(a,f)&&(Xs(a[f])&&(!Qv(t.properties[f])||Ls.IsExactOptionalProperty(a,f))||(a[f]=cA(t.properties[f],e,`${r}/${f}`,a[f])));if(!ka(t.additionalProperties))return a;let c=Object.getOwnPropertyNames(a),l=t.additionalProperties,u={...a};for(let f of c)o.includes(f)||(u[f]=qu(l,`${r}/${f}`,u[f]));return u}s(t5t,"FromObject");function r5t(t,e,r,n){let i=qu(t,r,n);if(!_i(n))return i;let o=Object.getOwnPropertyNames(t.patternProperties)[0],a=new RegExp(o),c={...i};for(let p of Object.getOwnPropertyNames(n))a.test(p)&&(c[p]=cA(t.patternProperties[o],e,`${r}/${p}`,c[p]));if(!ka(t.additionalProperties))return c;let l=Object.getOwnPropertyNames(c),u=t.additionalProperties,f={...c};for(let p of l)a.test(p)||(f[p]=qu(u,`${r}/${p}`,f[p]));return f}s(r5t,"FromRecord");function n5t(t,e,r,n){let i=So(t,e),o=cA(i,e,r,n);return qu(t,r,o)}s(n5t,"FromRef");function i5t(t,e,r,n){let i=So(t,e),o=cA(i,e,r,n);return qu(t,r,o)}s(i5t,"FromThis");function o5t(t,e,r,n){let i=qu(t,r,n);return Dn(t.items)?t.items.map((o,a)=>cA(o,e,`${r}/${a}`,i[a])):[]}s(o5t,"FromTuple");function s5t(t,e,r,n){for(let i of t.anyOf){if(!Di(i,e,n))continue;let o=cA(i,e,r,n);return qu(t,r,o)}for(let i of t.anyOf){let o=cA(i,e,r,n);if(Di(t,e,o))return qu(t,r,o)}return qu(t,r,n)}s(s5t,"FromUnion");function cA(t,e,r,n){let i=Zl(t,e),o=t;switch(t[ot]){case"Array":return JPt(o,i,r,n);case"Import":return XPt(o,i,r,n);case"Intersect":return ZPt(o,i,r,n);case"Not":return e5t(o,i,r,n);case"Object":return t5t(o,i,r,n);case"Record":return r5t(o,i,r,n);case"Ref":return n5t(o,i,r,n);case"This":return i5t(o,i,r,n);case"Tuple":return o5t(o,i,r,n);case"Union":return s5t(o,i,r,n);default:return qu(o,r,n)}}s(cA,"Visit");function uD(t,e,r){return cA(t,e,"",r)}s(uD,"TransformEncode");d();function a5t(t,e){return Oo(t)||Dl(t.items,e)}s(a5t,"FromArray");function c5t(t,e){return Oo(t)||Dl(t.items,e)}s(c5t,"FromAsyncIterator");function l5t(t,e){return Oo(t)||Dl(t.returns,e)||t.parameters.some(r=>Dl(r,e))}s(l5t,"FromConstructor");function u5t(t,e){return Oo(t)||Dl(t.returns,e)||t.parameters.some(r=>Dl(r,e))}s(u5t,"FromFunction");function d5t(t,e){return Oo(t)||Oo(t.unevaluatedProperties)||t.allOf.some(r=>Dl(r,e))}s(d5t,"FromIntersect");function f5t(t,e){let r=globalThis.Object.getOwnPropertyNames(t.$defs).reduce((i,o)=>[...i,t.$defs[o]],[]),n=t.$defs[t.$ref];return Oo(t)||Dl(n,[...r,...e])}s(f5t,"FromImport");function p5t(t,e){return Oo(t)||Dl(t.items,e)}s(p5t,"FromIterator");function m5t(t,e){return Oo(t)||Dl(t.not,e)}s(m5t,"FromNot");function h5t(t,e){return Oo(t)||Object.values(t.properties).some(r=>Dl(r,e))||ka(t.additionalProperties)&&Dl(t.additionalProperties,e)}s(h5t,"FromObject");function g5t(t,e){return Oo(t)||Dl(t.item,e)}s(g5t,"FromPromise");function A5t(t,e){let r=Object.getOwnPropertyNames(t.patternProperties)[0],n=t.patternProperties[r];return Oo(t)||Dl(n,e)||ka(t.additionalProperties)&&Oo(t.additionalProperties)}s(A5t,"FromRecord");function y5t(t,e){return Oo(t)?!0:Dl(So(t,e),e)}s(y5t,"FromRef");function C5t(t,e){return Oo(t)?!0:Dl(So(t,e),e)}s(C5t,"FromThis");function v5t(t,e){return Oo(t)||!Xs(t.items)&&t.items.some(r=>Dl(r,e))}s(v5t,"FromTuple");function x5t(t,e){return Oo(t)||t.anyOf.some(r=>Dl(r,e))}s(x5t,"FromUnion");function Dl(t,e){let r=Zl(t,e),n=t;if(t.$id&&Vpe.has(t.$id))return!1;switch(t.$id&&Vpe.add(t.$id),t[ot]){case"Array":return a5t(n,r);case"AsyncIterator":return c5t(n,r);case"Constructor":return l5t(n,r);case"Function":return u5t(n,r);case"Import":return f5t(n,r);case"Intersect":return d5t(n,r);case"Iterator":return p5t(n,r);case"Not":return m5t(n,r);case"Object":return h5t(n,r);case"Promise":return g5t(n,r);case"Record":return A5t(n,r);case"Ref":return y5t(n,r);case"This":return C5t(n,r);case"Tuple":return v5t(n,r);case"Union":return x5t(n,r);default:return Oo(t)}}s(Dl,"Visit");var Vpe=new Set;function jv(t,e){return Vpe.clear(),Dl(t,e)}s(jv,"HasTransform");var zpe=class{static{s(this,"TypeCheck")}constructor(e,r,n,i){this.schema=e,this.references=r,this.checkFunc=n,this.code=i,this.hasTransform=jv(e,r)}Code(){return this.code}Schema(){return this.schema}References(){return this.references}Errors(e){return fC(this.schema,this.references,e)}Check(e){return this.checkFunc(e)}Decode(e){if(!this.checkFunc(e))throw new aD(this.schema,e,this.Errors(e).First());return this.hasTransform?cD(this.schema,this.references,e):e}Encode(e){let r=this.hasTransform?uD(this.schema,this.references,e):e;if(!this.checkFunc(r))throw new lD(this.schema,e,this.Errors(e).First());return r}},Gv;(function(t){function e(o){return o===36}s(e,"DollarSign"),t.DollarSign=e;function r(o){return o===95}s(r,"IsUnderscore"),t.IsUnderscore=r;function n(o){return o>=65&&o<=90||o>=97&&o<=122}s(n,"IsAlpha"),t.IsAlpha=n;function i(o){return o>=48&&o<=57}s(i,"IsNumeric"),t.IsNumeric=i})(Gv||(Gv={}));var aG;(function(t){function e(o){return o.length===0?!1:Gv.IsNumeric(o.charCodeAt(0))}s(e,"IsFirstCharacterNumeric");function r(o){if(e(o))return!1;for(let a=0;a<o.length;a++){let c=o.charCodeAt(a);if(!(Gv.IsAlpha(c)||Gv.IsNumeric(c)||Gv.DollarSign(c)||Gv.IsUnderscore(c)))return!1}return!0}s(r,"IsAccessor");function n(o){return o.replace(/'/g,"\\'")}s(n,"EscapeHyphen");function i(o,a){return r(a)?`${o}.${a}`:`${o}['${n(a)}']`}s(i,"Encode"),t.Encode=i})(aG||(aG={}));var Kpe;(function(t){function e(r){let n=[];for(let i=0;i<r.length;i++){let o=r.charCodeAt(i);Gv.IsNumeric(o)||Gv.IsAlpha(o)?n.push(r.charAt(i)):n.push(`_${o}_`)}return n.join("").replace(/__/g,"_")}s(e,"Encode"),t.Encode=e})(Kpe||(Kpe={}));var Ype;(function(t){function e(r){return r.replace(/'/g,"\\'")}s(e,"Escape"),t.Escape=e})(Ype||(Ype={}));var Jpe=class extends Bn{static{s(this,"TypeCompilerUnknownTypeError")}constructor(e){super("Unknown type"),this.schema=e}},cG=class extends Bn{static{s(this,"TypeCompilerTypeGuardError")}constructor(e){super("Preflight validation check failed to guard for the given schema"),this.schema=e}},e2;(function(t){function e(a,c,l){return Ls.ExactOptionalPropertyTypes?`('${c}' in ${a} ? ${l} : true)`:`(${aG.Encode(a,c)} !== undefined ? ${l} : true)`}s(e,"IsExactOptionalProperty"),t.IsExactOptionalProperty=e;function r(a){return Ls.AllowArrayObject?`(typeof ${a} === 'object' && ${a} !== null)`:`(typeof ${a} === 'object' && ${a} !== null && !Array.isArray(${a}))`}s(r,"IsObjectLike"),t.IsObjectLike=r;function n(a){return Ls.AllowArrayObject?`(typeof ${a} === 'object' && ${a} !== null && !(${a} instanceof Date) && !(${a} instanceof Uint8Array))`:`(typeof ${a} === 'object' && ${a} !== null && !Array.isArray(${a}) && !(${a} instanceof Date) && !(${a} instanceof Uint8Array))`}s(n,"IsRecordLike"),t.IsRecordLike=n;function i(a){return Ls.AllowNaN?`typeof ${a} === 'number'`:`Number.isFinite(${a})`}s(i,"IsNumberLike"),t.IsNumberLike=i;function o(a){return Ls.AllowNullVoid?`(${a} === undefined || ${a} === null)`:`${a} === undefined`}s(o,"IsVoidLike"),t.IsVoidLike=o})(e2||(e2={}));var ta;(function(t){function e(ue){return ue[ot]==="Any"||ue[ot]==="Unknown"}s(e,"IsAnyOrUnknown");function*r(ue,Ue,ye){yield"true"}s(r,"FromAny");function*n(ue,Ue,ye){yield"true"}s(n,"FromArgument");function*i(ue,Ue,ye){yield`Array.isArray(${ye})`;let[$e,ae]=[Fe("value","any"),Fe("acc","number")];ln(ue.maxItems)&&(yield`${ye}.length <= ${ue.maxItems}`),ln(ue.minItems)&&(yield`${ye}.length >= ${ue.minItems}`);let le=Ae(ue.items,Ue,"value");if(yield`${ye}.every((${$e}) => ${le})`,ea(ue.contains)||ln(ue.minContains)||ln(ue.maxContains)){let qe=ea(ue.contains)?ue.contains:Ei(),Ne=Ae(qe,Ue,"value"),Ee=ln(ue.minContains)?[`(count >= ${ue.minContains})`]:[],je=ln(ue.maxContains)?[`(count <= ${ue.maxContains})`]:[],tt=`const count = value.reduce((${ae}, ${$e}) => ${Ne} ? acc + 1 : acc, 0)`,mt=["(count > 0)",...Ee,...je].join(" && ");yield`((${$e}) => { ${tt}; return ${mt}})(${ye})`}ue.uniqueItems===!0&&(yield`((${$e}) => { const set = new Set(); for(const element of value) { const hashed = hash(element); if(set.has(hashed)) { return false } else { set.add(hashed) } } return true } )(${ye})`)}s(i,"FromArray");function*o(ue,Ue,ye){yield`(typeof value === 'object' && Symbol.asyncIterator in ${ye})`}s(o,"FromAsyncIterator");function*a(ue,Ue,ye){yield`(typeof ${ye} === 'bigint')`,Qu(ue.exclusiveMaximum)&&(yield`${ye} < BigInt(${ue.exclusiveMaximum})`),Qu(ue.exclusiveMinimum)&&(yield`${ye} > BigInt(${ue.exclusiveMinimum})`),Qu(ue.maximum)&&(yield`${ye} <= BigInt(${ue.maximum})`),Qu(ue.minimum)&&(yield`${ye} >= BigInt(${ue.minimum})`),Qu(ue.multipleOf)&&(yield`(${ye} % BigInt(${ue.multipleOf})) === 0`)}s(a,"FromBigInt");function*c(ue,Ue,ye){yield`(typeof ${ye} === 'boolean')`}s(c,"FromBoolean");function*l(ue,Ue,ye){yield*re(ue.returns,Ue,`${ye}.prototype`)}s(l,"FromConstructor");function*u(ue,Ue,ye){yield`(${ye} instanceof Date) && Number.isFinite(${ye}.getTime())`,ln(ue.exclusiveMaximumTimestamp)&&(yield`${ye}.getTime() < ${ue.exclusiveMaximumTimestamp}`),ln(ue.exclusiveMinimumTimestamp)&&(yield`${ye}.getTime() > ${ue.exclusiveMinimumTimestamp}`),ln(ue.maximumTimestamp)&&(yield`${ye}.getTime() <= ${ue.maximumTimestamp}`),ln(ue.minimumTimestamp)&&(yield`${ye}.getTime() >= ${ue.minimumTimestamp}`),ln(ue.multipleOfTimestamp)&&(yield`(${ye}.getTime() % ${ue.multipleOfTimestamp}) === 0`)}s(u,"FromDate");function*f(ue,Ue,ye){yield`(typeof ${ye} === 'function')`}s(f,"FromFunction");function*p(ue,Ue,ye){let $e=globalThis.Object.getOwnPropertyNames(ue.$defs).reduce((ae,le)=>[...ae,ue.$defs[le]],[]);yield*re(zm(ue.$ref),[...Ue,...$e],ye)}s(p,"FromImport");function*m(ue,Ue,ye){yield`Number.isInteger(${ye})`,ln(ue.exclusiveMaximum)&&(yield`${ye} < ${ue.exclusiveMaximum}`),ln(ue.exclusiveMinimum)&&(yield`${ye} > ${ue.exclusiveMinimum}`),ln(ue.maximum)&&(yield`${ye} <= ${ue.maximum}`),ln(ue.minimum)&&(yield`${ye} >= ${ue.minimum}`),ln(ue.multipleOf)&&(yield`(${ye} % ${ue.multipleOf}) === 0`)}s(m,"FromInteger");function*h(ue,Ue,ye){let $e=ue.allOf.map(ae=>Ae(ae,Ue,ye)).join(" && ");if(ue.unevaluatedProperties===!1){let ae=Te(`${new RegExp(Hv(ue))};`),le=`Object.getOwnPropertyNames(${ye}).every(key => ${ae}.test(key))`;yield`(${$e} && ${le})`}else if(ea(ue.unevaluatedProperties)){let ae=Te(`${new RegExp(Hv(ue))};`),le=`Object.getOwnPropertyNames(${ye}).every(key => ${ae}.test(key) || ${Ae(ue.unevaluatedProperties,Ue,`${ye}[key]`)})`;yield`(${$e} && ${le})`}else yield`(${$e})`}s(h,"FromIntersect");function*g(ue,Ue,ye){yield`(typeof value === 'object' && Symbol.iterator in ${ye})`}s(g,"FromIterator");function*A(ue,Ue,ye){typeof ue.const=="number"||typeof ue.const=="boolean"?yield`(${ye} === ${ue.const})`:yield`(${ye} === '${Ype.Escape(ue.const)}')`}s(A,"FromLiteral");function*y(ue,Ue,ye){yield"false"}s(y,"FromNever");function*E(ue,Ue,ye){yield`(!${Ae(ue.not,Ue,ye)})`}s(E,"FromNot");function*b(ue,Ue,ye){yield`(${ye} === null)`}s(b,"FromNull");function*S(ue,Ue,ye){yield e2.IsNumberLike(ye),ln(ue.exclusiveMaximum)&&(yield`${ye} < ${ue.exclusiveMaximum}`),ln(ue.exclusiveMinimum)&&(yield`${ye} > ${ue.exclusiveMinimum}`),ln(ue.maximum)&&(yield`${ye} <= ${ue.maximum}`),ln(ue.minimum)&&(yield`${ye} >= ${ue.minimum}`),ln(ue.multipleOf)&&(yield`(${ye} % ${ue.multipleOf}) === 0`)}s(S,"FromNumber");function*R(ue,Ue,ye){yield e2.IsObjectLike(ye),ln(ue.minProperties)&&(yield`Object.getOwnPropertyNames(${ye}).length >= ${ue.minProperties}`),ln(ue.maxProperties)&&(yield`Object.getOwnPropertyNames(${ye}).length <= ${ue.maxProperties}`);let $e=Object.getOwnPropertyNames(ue.properties);for(let ae of $e){let le=aG.Encode(ye,ae),qe=ue.properties[ae];if(ue.required&&ue.required.includes(ae))yield*re(qe,Ue,le),($v(qe)||e(qe))&&(yield`('${ae}' in ${ye})`);else{let Ne=Ae(qe,Ue,le);yield e2.IsExactOptionalProperty(ye,ae,Ne)}}if(ue.additionalProperties===!1)if(ue.required&&ue.required.length===$e.length)yield`Object.getOwnPropertyNames(${ye}).length === ${$e.length}`;else{let ae=`[${$e.map(le=>`'${le}'`).join(", ")}]`;yield`Object.getOwnPropertyNames(${ye}).every(key => ${ae}.includes(key))`}if(typeof ue.additionalProperties=="object"){let ae=Ae(ue.additionalProperties,Ue,`${ye}[key]`),le=`[${$e.map(qe=>`'${qe}'`).join(", ")}]`;yield`(Object.getOwnPropertyNames(${ye}).every(key => ${le}.includes(key) || ${ae}))`}}s(R,"FromObject");function*B(ue,Ue,ye){yield`${ye} instanceof Promise`}s(B,"FromPromise");function*L(ue,Ue,ye){yield e2.IsRecordLike(ye),ln(ue.minProperties)&&(yield`Object.getOwnPropertyNames(${ye}).length >= ${ue.minProperties}`),ln(ue.maxProperties)&&(yield`Object.getOwnPropertyNames(${ye}).length <= ${ue.maxProperties}`);let[$e,ae]=Object.entries(ue.patternProperties)[0],le=Te(`${new RegExp($e)}`),qe=Ae(ae,Ue,"value"),Ne=ea(ue.additionalProperties)?Ae(ue.additionalProperties,Ue,ye):ue.additionalProperties===!1?"false":"true",Ee=`(${le}.test(key) ? ${qe} : ${Ne})`;yield`(Object.entries(${ye}).every(([key, value]) => ${Ee}))`}s(L,"FromRecord");function*O(ue,Ue,ye){let $e=So(ue,Ue);if(pe.functions.has(ue.$ref))return yield`${Oe(ue.$ref)}(${ye})`;yield*re($e,Ue,ye)}s(O,"FromRef");function*Y(ue,Ue,ye){let $e=Te(`${new RegExp(ue.source,ue.flags)};`);yield`(typeof ${ye} === 'string')`,ln(ue.maxLength)&&(yield`${ye}.length <= ${ue.maxLength}`),ln(ue.minLength)&&(yield`${ye}.length >= ${ue.minLength}`),yield`${$e}.test(${ye})`}s(Y,"FromRegExp");function*V(ue,Ue,ye){yield`(typeof ${ye} === 'string')`,ln(ue.maxLength)&&(yield`${ye}.length <= ${ue.maxLength}`),ln(ue.minLength)&&(yield`${ye}.length >= ${ue.minLength}`),ue.pattern!==void 0&&(yield`${Te(`${new RegExp(ue.pattern)};`)}.test(${ye})`),ue.format!==void 0&&(yield`format('${ue.format}', ${ye})`)}s(V,"FromString");function*z(ue,Ue,ye){yield`(typeof ${ye} === 'symbol')`}s(z,"FromSymbol");function*Q(ue,Ue,ye){yield`(typeof ${ye} === 'string')`,yield`${Te(`${new RegExp(ue.pattern)};`)}.test(${ye})`}s(Q,"FromTemplateLiteral");function*U(ue,Ue,ye){yield`${Oe(ue.$ref)}(${ye})`}s(U,"FromThis");function*Z(ue,Ue,ye){if(yield`Array.isArray(${ye})`,ue.items===void 0)return yield`${ye}.length === 0`;yield`(${ye}.length === ${ue.maxItems})`;for(let $e=0;$e<ue.items.length;$e++)yield`${Ae(ue.items[$e],Ue,`${ye}[${$e}]`)}`}s(Z,"FromTuple");function*J(ue,Ue,ye){yield`${ye} === undefined`}s(J,"FromUndefined");function*j(ue,Ue,ye){yield`(${ue.anyOf.map(ae=>Ae(ae,Ue,ye)).join(" || ")})`}s(j,"FromUnion");function*W(ue,Ue,ye){yield`${ye} instanceof Uint8Array`,ln(ue.maxByteLength)&&(yield`(${ye}.length <= ${ue.maxByteLength})`),ln(ue.minByteLength)&&(yield`(${ye}.length >= ${ue.minByteLength})`)}s(W,"FromUint8Array");function*X(ue,Ue,ye){yield"true"}s(X,"FromUnknown");function*oe(ue,Ue,ye){yield e2.IsVoidLike(ye)}s(oe,"FromVoid");function*te(ue,Ue,ye){let $e=pe.instances.size;pe.instances.set($e,ue),yield`kind('${ue[ot]}', ${$e}, ${ye})`}s(te,"FromKind");function*re(ue,Ue,ye,$e=!0){let ae=Co(ue.$id)?[...Ue,ue]:Ue,le=ue;if($e&&Co(ue.$id)){let qe=Oe(ue.$id);if(pe.functions.has(qe))return yield`${qe}(${ye})`;{pe.functions.set(qe,"<deferred>");let Ne=Je(qe,ue,Ue,"value",!1);return pe.functions.set(qe,Ne),yield`${qe}(${ye})`}}switch(le[ot]){case"Any":return yield*r(le,ae,ye);case"Argument":return yield*n(le,ae,ye);case"Array":return yield*i(le,ae,ye);case"AsyncIterator":return yield*o(le,ae,ye);case"BigInt":return yield*a(le,ae,ye);case"Boolean":return yield*c(le,ae,ye);case"Constructor":return yield*l(le,ae,ye);case"Date":return yield*u(le,ae,ye);case"Function":return yield*f(le,ae,ye);case"Import":return yield*p(le,ae,ye);case"Integer":return yield*m(le,ae,ye);case"Intersect":return yield*h(le,ae,ye);case"Iterator":return yield*g(le,ae,ye);case"Literal":return yield*A(le,ae,ye);case"Never":return yield*y(le,ae,ye);case"Not":return yield*E(le,ae,ye);case"Null":return yield*b(le,ae,ye);case"Number":return yield*S(le,ae,ye);case"Object":return yield*R(le,ae,ye);case"Promise":return yield*B(le,ae,ye);case"Record":return yield*L(le,ae,ye);case"Ref":return yield*O(le,ae,ye);case"RegExp":return yield*Y(le,ae,ye);case"String":return yield*V(le,ae,ye);case"Symbol":return yield*z(le,ae,ye);case"TemplateLiteral":return yield*Q(le,ae,ye);case"This":return yield*U(le,ae,ye);case"Tuple":return yield*Z(le,ae,ye);case"Undefined":return yield*J(le,ae,ye);case"Union":return yield*j(le,ae,ye);case"Uint8Array":return yield*W(le,ae,ye);case"Unknown":return yield*X(le,ae,ye);case"Void":return yield*oe(le,ae,ye);default:if(!pf.Has(le[ot]))throw new Jpe(ue);return yield*te(le,ae,ye)}}s(re,"Visit");let pe={language:"javascript",functions:new Map,variables:new Map,instances:new Map};function Ae(ue,Ue,ye,$e=!0){return`(${[...re(ue,Ue,ye,$e)].join(" && ")})`}s(Ae,"CreateExpression");function Oe(ue){return`check_${Kpe.Encode(ue)}`}s(Oe,"CreateFunctionName");function Te(ue){let Ue=`local_${pe.variables.size}`;return pe.variables.set(Ue,`const ${Ue} = ${ue}`),Ue}s(Te,"CreateVariable");function Je(ue,Ue,ye,$e,ae=!0){let[le,qe]=[`
`,tt=>"".padStart(tt," ")],Ne=Fe("value","any"),Ee=lt("boolean"),je=[...re(Ue,ye,$e,ae)].map(tt=>`${qe(4)}${tt}`).join(` &&${le}`);return`function ${ue}(${Ne})${Ee} {${le}${qe(2)}return (${le}${je}${le}${qe(2)})
}`}s(Je,"CreateFunction");function Fe(ue,Ue){let ye=pe.language==="typescript"?`: ${Ue}`:"";return`${ue}${ye}`}s(Fe,"CreateParameter");function lt(ue){return pe.language==="typescript"?`: ${ue}`:""}s(lt,"CreateReturns");function _t(ue,Ue,ye){let $e=Je("check",ue,Ue,"value"),ae=Fe("value","any"),le=lt("boolean"),qe=[...pe.functions.values()],Ne=[...pe.variables.values()],Ee=Co(ue.$id)?`return function check(${ae})${le} {
  return ${Oe(ue.$id)}(value)
}`:`return ${$e}`;return[...Ne,...qe,Ee].join(`
`)}s(_t,"Build");function xt(...ue){let Ue={language:"javascript"},[ye,$e,ae]=ue.length===2&&Dn(ue[1])?[ue[0],ue[1],Ue]:ue.length===2&&!Dn(ue[1])?[ue[0],[],ue[1]]:ue.length===3?[ue[0],ue[1],ue[2]]:ue.length===1?[ue[0],[],Ue]:[null,[],Ue];if(pe.language=ae.language,pe.variables.clear(),pe.functions.clear(),pe.instances.clear(),!ea(ye))throw new cG(ye);for(let le of $e)if(!ea(le))throw new cG(le);return _t(ye,$e,ae)}s(xt,"Code"),t.Code=xt;function gt(ue,Ue=[]){let ye=xt(ue,Ue,{language:"javascript"}),$e=globalThis.Function("kind","format","hash",ye),ae=new Map(pe.instances);function le(je,tt,mt){if(!pf.Has(je)||!ae.has(tt))return!1;let Ft=pf.Get(je),Jt=ae.get(tt);return Ft(Jt,mt)}s(le,"typeRegistryFunction");function qe(je,tt){return nA.Has(je)?nA.Get(je)(tt):!1}s(qe,"formatRegistryFunction");function Ne(je){return _I(je)}s(Ne,"hashFunction");let Ee=$e(le,qe,Ne);return new zpe(ue,Ue,Ee,ye)}s(gt,"Compile"),t.Compile=gt})(ta||(ta={}));var JG=Be(yI());d();d();var Hu=[];for(let t=0;t<256;++t)Hu.push((t+256).toString(16).slice(1));function yMe(t,e=0){return(Hu[t[e+0]]+Hu[t[e+1]]+Hu[t[e+2]]+Hu[t[e+3]]+"-"+Hu[t[e+4]]+Hu[t[e+5]]+"-"+Hu[t[e+6]]+Hu[t[e+7]]+"-"+Hu[t[e+8]]+Hu[t[e+9]]+"-"+Hu[t[e+10]]+Hu[t[e+11]]+Hu[t[e+12]]+Hu[t[e+13]]+Hu[t[e+14]]+Hu[t[e+15]]).toLowerCase()}s(yMe,"unsafeStringify");d();var CMe=require("crypto");var uG=new Uint8Array(256),lG=uG.length;function Xpe(){return lG>uG.length-16&&((0,CMe.randomFillSync)(uG),lG=0),uG.slice(lG,lG+=16)}s(Xpe,"rng");d();d();var vMe=require("crypto"),Zpe={randomUUID:vMe.randomUUID};function E5t(t,e,r){if(Zpe.randomUUID&&!e&&!t)return Zpe.randomUUID();t=t||{};let n=t.random??t.rng?.()??Xpe();if(n.length<16)throw new Error("Random bytes length must be >= 16");if(n[6]=n[6]&15|64,n[8]=n[8]&63|128,e){if(r=r||0,r<0||r+16>e.length)throw new RangeError(`UUID byte range ${r}:${r+15} is out of buffer bounds`);for(let i=0;i<16;++i)e[r+i]=n[i];return e}return yMe(n)}s(E5t,"v4");var br=E5t;var XG=Be(hi());function kD(t){return t===1}s(kD,"isRestricted");var w4t=["engine.prompt","engine.completion","ghostText.capturedAfterAccepted","ghostText.capturedAfterRejected"],h9=8192,S4t=21;var Wu=class{static{s(this,"TelemetryReporters")}getReporter(e,r=0){return kD(r)?this.getRestrictedReporter(e):this.reporter}getRestrictedReporter(e){if(DD(e))return this.reporterRestricted;if(M4(e))return new HF}getFTReporter(e){if(Y9e(e))return this.reporterFT;if(M4(e))return new HF}setReporter(e){this.reporter=e}setRestrictedReporter(e){this.reporterRestricted=e}setFTReporter(e){this.reporterFT=e}async deactivate(){let e=[this.reporter,this.reporterRestricted,this.reporterFT];this.reporter=this.reporterRestricted=this.reporterFT=void 0,await Promise.all(e.map(r=>r?.dispose()))}},_4t=x.Object({},{additionalProperties:x.String()}),R4t=x.Object({meanLogProb:x.Optional(x.Number()),meanAlternativeLogProb:x.Optional(x.Number())},{additionalProperties:x.Number()}),k4t=new Set(["ERR_WORKER_OUT_OF_MEMORY","ENOMEM"]);function P4t(t){return k4t.has(t.code??"")||t.name==="RangeError"&&t.message==="WebAssembly.Memory(): could not allocate memory"}s(P4t,"isOomError");function D4t(t){return OF(t)?"network":P4t(t)||t.code==="EMFILE"||t.code==="ENFILE"||t.syscall==="uv_cwd"&&(t.code==="ENOENT"||t.code=="EIO")||t.code==="CopilotPromptLoadFailure"||`${t.code}`.startsWith("CopilotPromptWorkerExit")?"local":"exception"}s(D4t,"getErrorType");var Vr=class t{static{s(this,"TelemetryData")}static{this.validateTelemetryProperties=ta.Compile(_4t)}static{this.validateTelemetryMeasurements=ta.Compile(R4t)}static{this.keysExemptedFromSanitization=["abexp.assignmentcontext","VSCode.ABExp.Features"]}constructor(e,r,n){this.properties=e,this.measurements=r,this.issuedTime=n}static createAndMarkAsIssued(e,r){return new t(e||{},r||{},Ba())}extendedBy(e,r){let n={...this.properties,...e},i={...this.measurements,...r},o=new t(n,i,this.issuedTime);return o.displayedTime=this.displayedTime,o}markAsDisplayed(){this.displayedTime===void 0&&(this.displayedTime=Ba())}async extendWithExpTelemetry(e){let{filters:r,exp:n}=await e.get(Mt).getFallbackExpAndFilters();n.addToTelemetry(this),r.addToTelemetry(this)}extendWithEditorAgnosticFields(e){this.properties.editor_version=oC(e.get(cn).getEditorInfo()),this.properties.editor_plugin_version=oC(e.get(cn).getEditorPluginInfo());let r=e.get(Ms);this.properties.client_machineid=r.machineId,this.properties.client_sessionid=r.sessionId,this.properties.copilot_version=`copilot/${s2(e)}`,typeof process<"u"&&(this.properties.runtime_version=`node/${process.versions.node}`);let n=e.get(cn);this.properties.common_extname=n.getEditorPluginInfo().name,this.properties.common_extversion=n.getEditorPluginInfo().version,this.properties.common_vscodeversion=oC(n.getEditorInfo());let i=e.get(Or);this.properties.fetcher=i.name;let o=e.get(Mc).getHttpSettings();this.properties.proxy_enabled=o.proxy?"true":"false",this.properties.proxy_auth=o.proxyAuthorization?"true":"false",this.properties.proxy_kerberos_spn=o.proxyKerberosServicePrincipal?"true":"false",this.properties.reject_unauthorized=o.proxyStrictSSL!==!1?"true":"false"}extendWithConfigProperties(e){let r=t6e(e);r["copilot.build"]=r6e(e),r["copilot.buildType"]=AC(e),this.properties={...this.properties,...r}}extendWithRequestId(e){let r={headerRequestId:e.headerRequestId,serverExperiments:e.serverExperiments,deploymentId:e.deploymentId};this.properties={...this.properties,...r}}static{this.keysToRemoveFromStandardTelemetryHack=["gitRepoHost","gitRepoName","gitRepoOwner","gitRepoUrl","gitRepoPath","repo","request_option_nwo","userKind"]}static maybeRemoveRepoInfoFromPropertiesHack(e,r){if(kD(e))return r;let n={};for(let i in r)t.keysToRemoveFromStandardTelemetryHack.includes(i)||(n[i]=r[i]);return n}sanitizeKeys(){this.properties=t.sanitizeKeys(this.properties),this.measurements=t.sanitizeKeys(this.measurements);for(let e in this.measurements)isNaN(this.measurements[e])&&delete this.measurements[e]}multiplexProperties(){this.properties=t.multiplexProperties(this.properties)}static sanitizeKeys(e){e=e||{};let r={};for(let n in e){let i=t.keysExemptedFromSanitization.includes(n)?n:n.replace(/\./g,"_");r[i]=e[n]}return r}static multiplexProperties(e){let r={...e};for(let n in e){let i=e[n],o=i?.length??0;if(o>h9){let a=0,c=0;for(;o>0&&c<S4t;){c+=1;let l=n;c>1&&(l=n+"_"+(c<10?"0":"")+c);let u=a+h9;o<h9&&(u=a+o),r[l]=i.slice(a,u),o-=h9,a+=h9}}}return r}updateMeasurements(e){let r=e-this.issuedTime;if(this.measurements.timeSinceIssuedMs=r,this.displayedTime!==void 0){let n=e-this.displayedTime;this.measurements.timeSinceDisplayedMs=n}this.measurements.current_time===void 0&&(this.measurements.current_time=M4t(e))}validateData(e,r){let n;if(t.validateTelemetryProperties.Check(this.properties)||(n={problem:"properties",error:JSON.stringify([...t.validateTelemetryProperties.Errors(this.properties)])}),!t.validateTelemetryMeasurements.Check(this.measurements)){let i=JSON.stringify([...t.validateTelemetryMeasurements.Errors(this.measurements)]);n===void 0?n={problem:"measurements",error:i}:(n.problem="both",n.error+=`; ${i}`)}if(n===void 0)return!0;if(M4(e))throw new Error(`Invalid telemetry data: ${n.problem} ${n.error} properties=${JSON.stringify(this.properties)} measurements=${JSON.stringify(this.measurements)}`);return dA(e,"invalidTelemetryData",t.createAndMarkAsIssued({properties:JSON.stringify(this.properties),measurements:JSON.stringify(this.measurements),problem:n.problem,validationError:n.error}),r),kD(r)&&dA(e,"invalidTelemetryData_in_secure",t.createAndMarkAsIssued({problem:n.problem,requestId:this.properties.requestId??"unknown"}),0),!1}async makeReadyForSending(e,r,n,i){this.extendWithConfigProperties(e),this.extendWithEditorAgnosticFields(e),this.sanitizeKeys(),this.multiplexProperties(),n==="IncludeExp"&&await this.extendWithExpTelemetry(e),this.updateMeasurements(i),this.validateData(e,r)||(this.properties.telemetry_failed_validation="true"),Object.assign(this.properties,J9e(e))}},gC=class t extends Vr{static{s(this,"TelemetryWithExp")}constructor(e,r,n,i){super(e,r,n),this.filtersAndExp=i}extendedBy(e,r){let n={...this.properties,...e},i={...this.measurements,...r},o=new t(n,i,this.issuedTime,this.filtersAndExp);return o.displayedTime=this.displayedTime,o}extendWithExpTelemetry(){return this.filtersAndExp.exp.addToTelemetry(this),this.filtersAndExp.filters.addToTelemetry(this),Promise.resolve()}static createEmptyConfigForTesting(){return new t({},{},0,{filters:new W_({}),exp:Hm.createEmptyConfig()})}};function g9(t,e,r,n){t.get(Wu).getReporter(t,e)?.sendTelemetryEvent(r,Vr.maybeRemoveRepoInfoFromPropertiesHack(e,n.properties),n.measurements)}s(g9,"sendTelemetryEvent");function B4t(t,e,r,n){t.get(Wu).getReporter(t,e)?.sendTelemetryErrorEvent(r,Vr.maybeRemoveRepoInfoFromPropertiesHack(e,n.properties),n.measurements)}s(B4t,"sendTelemetryErrorEvent");function N4t(t,e,r,n){t.get(Wu).getFTReporter(t)?.sendTelemetryEvent(r,Vr.maybeRemoveRepoInfoFromPropertiesHack(e,n.properties),n.measurements)}s(N4t,"sendFTTelemetryEvent");function PD(t){return{promptCharLen:t.prefix.length+(t.context?.reduce((e,r)=>e+r.length,0)??0),promptSuffixCharLen:t.suffix.length}}s(PD,"telemetrizePromptLength");function Ba(){return performance.now()}s(Ba,"now");function M4t(t){return Math.floor(t/1e3)}s(M4t,"nowSeconds");function DD(t){return t.get(Ou).optedIn}s(DD,"shouldSendRestricted");function Y9e(t){return t.get(Ou).ftFlag!==""}s(Y9e,"shouldSendFinetuningTelemetry");function Bt(t,e,r,n){return t.get(Zc).register(L4t(t,e,Ba(),r?.extendedBy(),n))}s(Bt,"telemetry");async function L4t(t,e,r,n,i=0){let o=n||Vr.createAndMarkAsIssued({},{});await o.makeReadyForSending(t,i??!1,"IncludeExp",r),(!kD(i)||DD(t))&&g9(t,i,e,o),kD(i)&&w4t.includes(e)&&Y9e(t)&&N4t(t,i,e,o)}s(L4t,"_telemetry");function Rj(t,e){return t.get(Zc).register(F4t(t,e,Ba()))}s(Rj,"telemetryExpProblem");async function F4t(t,e,r){let n="expProblem",i=Vr.createAndMarkAsIssued(e,{});await i.makeReadyForSending(t,0,"SkipExp",r),g9(t,0,n,i)}s(F4t,"_telemetryExpProblem");function _me(t,e,r,n){let i={...r,...J9e(t)};g9(t,0,e,{properties:i,measurements:n})}s(_me,"telemetryRaw");function J9e(t){let e=t.get(cn),r={unique_id:br(),common_extname:e.getEditorPluginInfo().name,common_extversion:e.getEditorPluginInfo().version,common_vscodeversion:oC(e.getEditorInfo())};return{...t.get(Ou).getProperties(),...r}}s(J9e,"createRequiredProperties");var Sme=class extends Error{static{s(this,"CopilotNonError")}constructor(e){let r;try{r=JSON.stringify(e)}catch{r=String(e)}super(r),this.name="CopilotNonError",this.code=(0,JG.SHA256)(JG.enc.Utf16.parse(this.message)).toString().slice(0,16)}};function Ka(t,e,r,n,i){return t.get(Zc).register(X9e(t,e,Ba(),r,{...n},i))}s(Ka,"telemetryException");async function X9e(t,e,r,n,i,o){let a;if(e instanceof Error){if(a=e,a.name==="Canceled"&&a.message==="Canceled"||a.name==="CodeExpectedError"||Td(a)||a instanceof Sa||a instanceof XG.ConnectionError||a instanceof XG.ResponseError)return}else{if(a=new Sme(e),e&&typeof e=="object"&&e.name==="ExitStatus")return;if(a.stack?.startsWith(`${a}
`)){let A=a.stack.slice(`${a}
`.length).split(`
`);/^\s*(?:at )?(?:\w+\.)*_telemetryException\b/.test(A[0]??"")&&A.shift(),/^\s*(?:at )?(?:\w+\.)*telemetryException\b/.test(A[0]??"")&&A.shift(),a.stack=`${a}
${A.join(`
`)}`}}let c=t.get(cn).getEditorInfo(),l;c.root&&(l=[{prefix:`${c.name}:`,path:c.root}]);let u=DD(t),f=eNe(a,l,u),p=D4t(a),m=p==="exception",h=Vr.createAndMarkAsIssued({origin:n??"",type:a.name,code:`${a.code??""}`,reason:f.stack||f.toString(),message:f.message,...i});if(await h.makeReadyForSending(t,0,"IncludeExp",r),o?.exception_detail)for(let A of o.exception_detail)A.value&&(u?A.value=rpe(A.value):A.value="[redacted]");if(o??=j3e(t,f),o.context={...o.context,"copilot_event.unique_id":h.properties.unique_id,"#restricted_telemetry":u?"true":"false"},n&&(o.context["#origin"]=n,o.transaction=n),o.rollup_id!=="auto"&&(h.properties.errno=o.rollup_id),o.created_at=new Date(h.issuedTime).toISOString(),u){let A=Z3e(a,l),y=Vr.createAndMarkAsIssued({origin:n??"",type:a.name,code:`${a.code??""}`,reason:A.stack||A.toString(),message:A.message,...i});o.rollup_id!=="auto"&&(y.properties.errno=o.rollup_id),await y.makeReadyForSending(t,1,"IncludeExp",r),y.properties.unique_id=h.properties.unique_id,h.properties.restricted_unique_id=y.properties.unique_id,g9(t,1,`error.${p}`,y)}let g=o.rollup_id==="auto"?a.stack??"":o.rollup_id;m&&!t.get(sC).isThrottled(g)&&(h.properties.failbot_payload=JSON.stringify(o)),g9(t,0,`error.${p}`,h)}s(X9e,"_telemetryException");function Xl(t,e,r,n){let i=s(async(...o)=>{try{await e(...o)}catch(a){await X9e(t,a,Ba(),r,n)}},"wrapped");return(...o)=>t.get(Zc).register(i(...o))}s(Xl,"telemetryCatch");function dA(t,e,r,n){return t.get(Zc).register(O4t(t,e,Ba(),r?.extendedBy(),n))}s(dA,"telemetryError");async function O4t(t,e,r,n,i=0){if(kD(i)&&!DD(t))return;let o=n||Vr.createAndMarkAsIssued({},{});await o.makeReadyForSending(t,i,"IncludeExp",r),B4t(t,i,e,o)}s(O4t,"_telemetryError");function Z9e(t,e,r,n,i){let o=Vr.createAndMarkAsIssued({completionTextJson:JSON.stringify(e),choiceIndex:i.toString()});if(r.logprobs)for(let[a,c]of Object.entries(r.logprobs))o.properties["logprobs_"+a]=JSON.stringify(c)??"unset";return o.extendWithRequestId(n),Bt(t,"engine.completion",o,1)}s(Z9e,"logEngineCompletion");function e6e(t,e,r){let n={promptJson:JSON.stringify({prefix:e.prefix,context:e.context}),promptSuffixJson:JSON.stringify(e.suffix)};if(e.context){let o=r.properties["request.option.extra"]?JSON.parse(r.properties["request.option.extra"]):{};o.context=e.context,n["request.option.extra"]=JSON.stringify(o)}let i=r.extendedBy(n);return Bt(t,"engine.prompt",i,1)}s(e6e,"logEnginePrompt");d();var ju=class{static{s(this,"UrlOpener")}};var I0=new dt("auth"),eV=60;function T0(t){let e=t.serverUrl?.match(/^https?:\/\//)?t.serverUrl:"",r=t.apiUrl?.match(/^https?:\/\//)?t.apiUrl:"";return e?r||=e.replace("://","://api."):r?.includes("://api.")&&(e||=r.replace("://api.","://")),(!e||!r)&&(e="https://github.com/",r="https://api.github.com/"),{apiUrl:r,serverUrl:e}}s(T0,"fillGitHubUrls");function n6e(){return Math.floor(Date.now()/1e3)}s(n6e,"nowSeconds");async function Rme(t,e,r){let n=Vr.createAndMarkAsIssued({},{});Bt(t,"auth.new_login");let i={"X-GitHub-Api-Version":"2024-12-15"};r?.hasKnownOrg&&(i["X-GitHub-Staff-Request"]="1");let o=e.devOverride?.copilotTokenUrl??"copilot_internal/v2/token",a=await Qm(t,e,o,{timeout:12e4,headers:i}),c=await a.json(),l=c.user_notification;if(i6e(t,l,e),a.status===401){let h="Failed to get copilot token due to 401 status. Please sign out and try again.";return I0.info(t,h),dA(t,"auth.unknown_401",n),{failureKind:"HTTP401",message:h}}if(!a.ok||!c.token){I0.info(t,`Invalid copilot token: missing token: ${a.status} ${a.statusText}`),dA(t,"auth.invalid_token",n.extendedBy({status:a.status.toString(),status_text:a.statusText}));let h=c.error_details;return h?.notification_id!=="not_signed_up"&&i6e(t,h,e),{failureKind:"NotAuthorized",message:h?.message??"Could not retrieve token",canSignUpForLimited:c.can_signup_for_limited??!1}}let u=n6e()+c.refresh_in+eV,f=await kme(t,e),p;f.ok&&(p=await f.json());let m=new a2(c,p,u);return Bt(t,"auth.new_token",n.extendedBy({...Zfe(m)},{adjusted_expires_at:m.expiresAt,expires_at:c.expires_at,current_time:n6e()})),{copilotToken:m}}s(Rme,"authFromGitHubSession");var nu=class{static{s(this,"CopilotTokenFetcher")}},ZG=class extends nu{static{s(this,"NetworkCopilotTokenFetcher")}async fetchTokenResult(e,r,n){return await Rme(e,r,n)}};async function kme(t,e){let r={"X-GitHub-Api-Version":"2025-05-01"},n=e.devOverride?.copilotUserInfoUrl??"copilot_internal/user";return await Qm(t,e,n,{timeout:12e4,headers:r})}s(kme,"fetchCopilotUserInfo");function i6e(t,e,r){e&&t.get(wa).showWarningMessageOnlyOnce(e.notification_id,e.message,{title:e.title},{title:"Dismiss"}).then(async n=>{let i=n?.title===e.title,o=i||n?.title==="Dismiss";if(i){let a=t.get(cn).getEditorPluginInfo(),c=e.url.replace("{EDITOR}",encodeURIComponent(a.name+"_"+a.version));await t.get(ju).open(c)}e.notification_id&&o&&await Q4t(t,e.notification_id,r)}).catch(n=>{I0.exception(t,n,"copilotToken.notification")})}s(i6e,"notifyUser");async function Q4t(t,e,r){let n=r.devOverride?.notificationUrl??"copilot_internal/notification",i=await Qm(t,r,n,{method:"POST",body:JSON.stringify({notification_id:e})});(!i||!i.ok)&&I0.error(t,`Failed to send notification result to GitHub: ${i?.status} ${i?.statusText}`)}s(Q4t,"sendNotificationResultToGitHub");var a2=class{constructor(e,r,n){this.envelope=e;this.expiresAt=n;this.token=e.token,this.organization_list=e.organization_list,this.enterprise_list=e.enterprise_list,this.tokenMap=this.parseToken(this.token),this.userInfo=new FW(r)}static{s(this,"CopilotToken")}get endpoints(){return{...$_,...this.envelope.endpoints??{}}}needsRefresh(){return(this.expiresAt-eV)*1e3<Date.now()}isExpired(){return this.expiresAt*1e3<Date.now()}get hasKnownOrg(){return jfe(this.organization_list||[])!==void 0}parseToken(e){let r=new Map,i=(e??"").split(":")[0].split(";");for(let o of i){let[a,c]=o.split("=");r.set(a,c)}return r}getTokenValue(e){return this.tokenMap.get(e)}getTokenValues(){return Object.fromEntries(this.tokenMap)}get isCopilotCodeReviewEnabled(){return this.getTokenValue("ccr")==="1"}};d();d();var A9="apps",Pme="hosts",fA=class{constructor(e,r){this.ctx=e;this.persistenceManager=r}static{s(this,"AuthPersistence")}async getAuthRecord(e){let r=this.getAuthAuthority(e),n=e.githubAppId,i=await this.persistenceManager.read(A9,this.authRecordKey(this.ctx,{authAuthority:r,githubAppId:n}));if(!n&&!i?(n=w0,i=await this.persistenceManager.read(A9,this.authRecordKey(this.ctx,{authAuthority:r,githubAppId:n}))):n??=this.ctx.get(iu).findAppIdToAuthenticate(),i){let o={...i,oauth_token:i.access_token||i.oauth_token,user:i.login||i.user,githubAppId:n,authAuthority:r};if(o.oauth_token&&o.user)return o}return await this.legacyAuthRecordMaybe(r)}async legacyAuthRecordMaybe(e){let r=await this.persistenceManager.read(Pme,e);if(r)return{...r,githubAppId:w0}}async saveAuthRecord(e){await this.persistenceManager.update(A9,this.authRecordKey(this.ctx,e),{user:e.user,oauth_token:e.oauth_token,githubAppId:e.githubAppId,dev_override:e.dev_override})}async deleteAuthRecord(e){let r=this.getAuthAuthority(e),n=await this.getAuthRecord({authAuthority:r});n&&(n.githubAppId===w0&&await this.persistenceManager.delete(Pme,r),await this.persistenceManager.delete(A9,this.authRecordKey(this.ctx,{authAuthority:r})),await this.persistenceManager.delete(A9,this.authRecordKey(this.ctx,{authAuthority:r,githubAppId:w0})))}async purgeLegacyAuthRecords(){await this.persistenceManager.deleteSetting(Pme)}authRecordKey(e,r){let n=r.githubAppId??e.get(iu).findAppIdToAuthenticate();return`${this.getAuthAuthority(r)}:${n}`}getAuthAuthority(e){return e.authAuthority}};d();d();d();var l6e=Be(s6e()),u6e=Be(c6e()),S0=Be(require("os"));var BD=class{constructor(e,r,n,i,o=!1){this.ctx=e;this.namespace=r;this.includeAuthorizationHeader=o;this.onCopilotToken=s(e=>{this.token=e;let r=e.getTokenValue("tid");r!==void 0&&(this.tags["ai.user.id"]=r)},"onCopilotToken");this.xhrOverride={sendPOST:s((e,r)=>{if(typeof e.data!="string")throw new Error(`AppInsightsReporter only supports string payloads, received ${typeof e.data}`);let n=e.headers??{};n["Content-Type"]="application/json",this.includeAuthorizationHeader&&this.token&&(n.Authorization=`Bearer ${this.token.token}`);let i={method:"POST",headers:n,body:e.data};this.ctx.get(Or).fetch(e.urlString,i).then(o=>o.text().then(a=>{r(o.status,Object.fromEntries(o.headers),a)})).catch(o=>{dn.debug(this.ctx,"Error sending telemetry",o),r(0,{})})},"sendPOST")};this.client=new u6e.ApplicationInsights({instrumentationKey:i,disableAjaxTracking:!0,disableExceptionTracking:!0,disableFetchTracking:!0,disableCorrelationHeaders:!0,disableCookiesUsage:!0,autoTrackPageVisitTime:!1,emitLineDelimitedJson:!1,disableInstrumentationKeyValidation:!0,endpointUrl:n,extensionConfig:{[l6e.BreezeChannelIdentifier]:{alwaysUseXhrOverride:!0,httpXHROverride:this.xhrOverride}}}),this.tags=U4t(e),this.commonProperties=q4t(e),this.#e=_a(e,this.onCopilotToken)}static{s(this,"AppInsightsReporter")}#e;sendTelemetryEvent(e,r,n){r={...r,...this.commonProperties};let i=this.qualifyEventName(e);this.client.track({name:i,tags:this.tags,data:{...r,...n},baseType:"EventData",baseData:{name:i,properties:r,measurements:n}})}sendTelemetryErrorEvent(e,r,n){this.sendTelemetryEvent(this.qualifyEventName(e),r,n)}async dispose(){this.#e.dispose(),await this.client.unload(!0,void 0,200)}qualifyEventName(e){return e.startsWith(this.namespace)?e:`${this.namespace}/${e}`}};function U4t(t){let e={},r=t.get(Ms);e["ai.session.id"]=r.sessionId;let n=t.get(Ou);return n.trackingId&&(e["ai.user.id"]=n.trackingId),e["ai.cloud.roleInstance"]="REDACTED",e["ai.device.osVersion"]=`${S0.type()} ${S0.release()}`,e["ai.device.osArchitecture"]=S0.arch(),e["ai.device.osPlatform"]=S0.platform(),e["ai.cloud.role"]="Web",e["ai.application.ver"]=t.get(To).getVersion(),e}s(U4t,"getTags");function q4t(t){let e={};e.common_os=S0.platform(),e.common_platformversion=S0.release(),e.common_arch=S0.arch(),e.common_cpu=Array.from(new Set(S0.cpus().map(n=>n.model))).join();let r=t.get(Ms);return e.common_vscodemachineid=r.machineId,e.common_vscodesessionid=r.sessionId,e.common_uikind=r.uiKind,e.common_remotename=r.remoteName,e.common_isnewappinstall="",e}s(q4t,"getCommonProperties");var H4t="7d7048df-6dd0-4048-bb23-b716c1461f8f",$4t="3fdd7f28-937a-48c8-9a21-ba337db23bd1",W4t="f0000000-0000-0000-0000-000000000000";function d6e(t){return new URL(t).hostname==="github.com"?$_.telemetry:t.replace("://","://copilot-telemetry-service.")}s(d6e,"getEndpointForServerUrl");var Md=class{constructor(e,r){this.ctx=e;this.namespace=r;this.serverUrl="https://github.com/";this.rootUrl=d6e(this.serverUrl);this.shuttingDown=new Set;_a(e,n=>this.updateServiceEndpoints(n.endpoints))}static{s(this,"TelemetryInitialization")}get endpointUrl(){return this.overrideEndpointUrlForTesting||new URL("telemetry",this.rootUrl).href}get isInitialized(){return this.initializedWith!==void 0}get isEnabled(){return this._enabled??!1}initialize(e){let r=this.ctx;this._enabled=e;let n=this.endpointUrl;if(!(this.initializedWith?.enabled===this._enabled&&this.initializedWith?.endpointUrl===this.endpointUrl)&&(this.shutdownWithoutWaiting(),this.initializedWith={endpointUrl:n,enabled:this._enabled},e)){let i=r.get(Wu);i.setReporter(new BD(r,this.namespace,n,H4t)),i.setRestrictedReporter(new BD(r,this.namespace,n,$4t)),i.setFTReporter(new BD(r,this.namespace,n,W4t,!0))}}setCustomReporters(e,r){this.shutdownWithoutWaiting();let n=this.ctx.get(Wu);n.setReporter(e),n.setRestrictedReporter(r)}async shutdown(){this.shutdownWithoutWaiting(),await Promise.all(this.shuttingDown)}shutdownWithoutWaiting(){this.initializedWith=void 0;let e=this.ctx.get(Wu).deactivate().finally(()=>{this.shuttingDown.delete(e)});this.shuttingDown.add(e)}updateSessionConfig(e){e?.serverUrl&&e.serverUrl!==this.serverUrl&&(this.serverUrl=e.serverUrl,this.rootUrl=d6e(e.serverUrl)),this.isInitialized&&this.initialize(this._enabled)}updateServiceEndpoints(e){this.rootUrl=e.telemetry,this.isInitialized&&this.initialize(this._enabled)}};async function j4t(t,e){let r="copilot_internal/subscribe_limited_user";try{return(await(await Qm(t,e,r,{method:"POST",headers:{"X-GitHub-Api-Version":"2025-05-01"},body:JSON.stringify({restricted_telemetry:t.get(Md).isEnabled?"enabled":"disabled",public_code_suggestions:"enabled"})})).json()).subscribed}catch(n){return I0.exception(t,n,"signUpLimited failed"),!1}}s(j4t,"apiFetchSignUpLimited");async function Bme(t,e,r){let n=await t.get(ar).getTokenResult();switch(n.failureKind){case void 0:return"OK";case"HTTP401":case"NotSignedIn":return"NotSignedIn";case"NotAuthorized":return r&&n.canSignUpForLimited&&await j4t(t,e)?Bme(t,e,!1):"NotAuthorized";case"Exception":throw n.exception}}s(Bme,"getTokenWithSignUpLimited");var Bi=class{constructor(e,r){this.ctx=e;this.env=r}static{s(this,"AuthManager")}hasTransientSession(){return this.transientSession!==void 0}get _copilotTokenManager(){return this.ctx.get(ar)}getConfiguredUrls(){return this.ctx.get(df).getConfiguredUrls()}async checkAndUpdateStatus(e){let r=e?.localChecksOnly??!1,n;return e?.githubAppId!==void 0?n=await this.getPersistedSession(e):n=await this.getSession(),n===void 0?(this._copilotTokenManager.resetToken(),await this._copilotTokenManager.primeToken(),{status:"NotSignedIn"}):r?{status:"MaybeOK",user:n.login}:(e?.forceRefresh&&this._copilotTokenManager.resetToken(),{status:await Bme(this.ctx,n,e?.freshSignIn??!1),user:n.login})}async getSession(){await this.ctx.get(Mc).requireReady();let e=Nme(this.env)??await this.transientSession;if(!(e&&e.accessToken===void 0))return e?{...e,...T0(e)}:await this.getPersistedSession()}setTransientSession(e){this.transientSession=e&&Promise.resolve(e),this._copilotTokenManager.resetToken()}getAuthAuthority(){return new URL(this.getConfiguredUrls().serverUrl).hostname}},nV=class extends Bi{static{s(this,"PersistentAuthManager")}get authPersistence(){return this.ctx.get(fA)}async getPersistedSession(e){let r=await this.authPersistence.getAuthRecord({...e,authAuthority:this.getAuthAuthority()});if(r===void 0)return;let n={...this.getConfiguredUrls(),accessToken:r.oauth_token,login:r.user,githubAppId:r.githubAppId};return r.dev_override&&AC(this.ctx)==="dev"&&(n.devOverride={copilotTokenUrl:r.dev_override.copilot_token_url,copilotUserInfoUrl:r.dev_override.copilot_user_info_url,notificationUrl:r.dev_override.notification_url,contentRestrictionsUrl:r.dev_override.content_restrictions_url}),n}};function Nme(t){if(t.GH_COPILOT_TOKEN&&!/=/.test(t.GH_COPILOT_TOKEN))return{...T0({apiUrl:t.GH_COPILOT_API_URL,serverUrl:t.GH_COPILOT_SERVER_URL}),login:"<GH_COPILOT_TOKEN-user>",accessToken:t.GH_COPILOT_TOKEN};if(t.GITHUB_COPILOT_TOKEN)return{...T0({apiUrl:t.GITHUB_COPILOT_API_URL,serverUrl:t.GITHUB_COPILOT_SERVER_URL}),login:"<GITHUB_COPILOT_TOKEN-user>",accessToken:t.GITHUB_COPILOT_TOKEN};if(t.CODESPACES==="true"&&t.GITHUB_TOKEN)return{...T0({apiUrl:t.GITHUB_API_URL,serverUrl:t.GITHUB_SERVER_URL}),login:t.GITHUB_USER||"<codespaces-user>",accessToken:t.GITHUB_TOKEN}}s(Nme,"getSessionFromEnv");d();var G4t=["UNABLE_TO_VERIFY_LEAF_SIGNATURE","CERT_SIGNATURE_FAILURE"],f6e="Your proxy connection requires a trusted certificate. Please make sure the proxy certificate and any issuers are configured correctly and trusted by your operating system.",p6e="https://gh.io/copilot-network-errors",fp=class{constructor(){this.notifiedErrorCodes=[]}static{s(this,"UserErrorNotifier")}notifyUser(e,r){if(!(r instanceof Error))return;let n=r;n.code&&G4t.includes(n.code)&&!this.didNotifyBefore(n.code)&&(this.notifiedErrorCodes.push(n.code),this.displayCertificateErrorNotification(e,n))}async displayCertificateErrorNotification(e,r){new dt("certificates").error(e,`${f6e} Please visit ${p6e} to learn more. Original cause:`,r);let n={title:"Learn more"};return e.get(wa).showWarningMessage(f6e,n).then(i=>{if(i?.title===n.title)return e.get(ju).open(p6e)})}didNotifyBefore(e){return this.notifiedErrorCodes.indexOf(e)!==-1}};d();var qo=class{static{s(this,"StatusReporter")}#e=0;#t="Normal";#i;#n;#r=!0;get busy(){return this.#e>0}withProgress(e){return this.#t==="Warning"&&this.forceNormal(),this.#e++===0&&this.#o(),e().finally(()=>{--this.#e===0&&this.#o()})}forceStatus(e,r,n){this.#t===e&&this.#i===r&&!n&&!this.#n&&!this.#r||(this.#t=e,this.#i=r,this.#n=n,this.#r=!1,this.#o())}forceNormal(){this.#t!=="Inactive"&&this.forceStatus("Normal")}setError(e,r){this.forceStatus("Error",e,r)}setWarning(e){this.#t!=="Error"&&this.forceStatus("Warning",e)}setInactive(e){this.#t==="Error"||this.#t==="Warning"||this.forceStatus("Inactive",e)}clearInactive(){this.#t==="Inactive"&&this.forceStatus("Normal")}#o(){let e={kind:this.#t,message:this.#i,busy:this.busy,command:this.#n};this.didChange(e)}},iV=class extends qo{static{s(this,"NoOpStatusReporter")}didChange(){}};d();var m6e=Be(hi());var ys=class extends m6e.Emitter{static{s(this,"Emitter")}get event(){return super.event}};var Mme=class extends Sa{constructor(r){super("message"in r?r.message:`${r.failureKind}`);this.result=r}static{s(this,"TokenResultError")}},ar=class{constructor(e,r=!1){this.ctx=e;this.primed=r;this.lastToken=void 0;this.activeToken=void 0;this.tokenPromise=void 0;this.tokenPrimingError=void 0;this.didChangeTokenResult=new ys;this.onDidChangeTokenResult=this.didChangeTokenResult.event;this.didResetToken=new ys;this.onDidResetToken=this.didResetToken.event}static{s(this,"CopilotTokenManager")}async getGitHubSession(){return await this.ctx.get(Bi).getSession()}primeToken(){if(this.tokenPrimingError)return Promise.reject(this.tokenPrimingError);this.primed=!0;try{return this.getToken().then(()=>!0,()=>!1)}catch{return Promise.resolve(!1)}}async fetchTokenResult(e){return await this.ctx.get(nu).fetchTokenResult(this.ctx,e,this.lastToken)}setToken(e){this.activeToken=this.lastToken=e}async getTokenResult(){if(!this.primed){let e=new Error("Token requested before initialization");if(h6e(this.ctx))throw this.tokenPrimingError=e,e;I0.exception(this.ctx,e,".getToken")}if(!this.tokenPromise&&(!this.activeToken||this.activeToken?.needsRefresh())){let r=this.getGitHubSession().then(async n=>n?await this.fetchTokenResult(n):{failureKind:"NotSignedIn"}).catch(n=>{if(!(n instanceof Error))throw n;return{failureKind:"Exception",message:String(n),exception:n}}).then(n=>(this.tokenPromise!==r||(this.tokenPromise=void 0,this.handleTokenResult(n)),n));this.tokenPromise=r}return this.activeToken&&!this.activeToken.isExpired()?{copilotToken:this.activeToken}:await this.tokenPromise}handleTokenResult(e){let r=this.ctx.get(qo);switch(e.failureKind){case"NotSignedIn":r.setError("You are not signed into GitHub.",{command:"github.copilot.signIn",title:"Sign In"});break;case"HTTP401":r.setError("Your GitHub token is invalid. Try signing in again.");break;case"NotAuthorized":r.setError(e.message);break;case"Exception":r.setWarning(e.message),this.ctx.get(fp).notifyUser(this.ctx,e.exception);break;case void 0:r.forceNormal(),this.setToken(e.copilotToken)}this.didChangeTokenResult.fire(e)}async getToken(){let e=await this.getTokenResult();if(e.copilotToken)return e.copilotToken;throw e.exception?e.exception:new Mme(e)}resetToken(e){e!==void 0?(Bt(this.ctx,"auth.reset_token_"+e),I0.debug(this.ctx,`Resetting copilot token on HTTP error ${e}`)):I0.debug(this.ctx,"Resetting copilot token"),!(!this.activeToken&&!this.tokenPromise)&&(this.activeToken=void 0,this.tokenPromise=void 0,this.didResetToken.fire())}getLastToken(){return this.lastToken}};function _j(t){return t.get(ar).getLastToken()}s(_j,"getLastCopilotToken");d();var yC=class{static{s(this,"Clock")}now(){return new Date}};d();var pA=class{static{s(this,"ExpConfigMaker")}},y9=class extends pA{constructor(r={}){super();this.defaultFilters=r}static{s(this,"ExpConfigFromTAS")}async fetchExperiments(r,n,i){let o=r.get(Or),a=Object.keys(i).length===0?this.defaultFilters:i,c=new URL("telemetry",n.telemetry).href,l;try{l=await o.fetch(c,{method:"GET",headers:a,timeout:5e3})}catch(m){return Hm.createFallbackConfig(r,`Error fetching ExP config: ${String(m)}`)}if(!l.ok)return Hm.createFallbackConfig(r,`ExP responded with ${l.status}`);let u;try{u=await l.json()}catch(m){if(m instanceof SyntaxError)return Ka(r,m,"fetchExperiments"),Hm.createFallbackConfig(r,"ExP responded with invalid JSON");throw m}let f=u.Configs.find(m=>m.Id==="vscode")??{Id:"vscode",Parameters:{}},p=Object.entries(f.Parameters).map(([m,h])=>m+(h?"":"cf"));return new Hm(f.Parameters,u.AssignmentContext,p.join(";"))}},oV=class extends pA{static{s(this,"ExpConfigNone")}fetchExperiments(){return Promise.resolve(Hm.createEmptyConfig())}};d();d();var sV=class{constructor(e){this.prefix=e}static{s(this,"GranularityImplementation")}getCurrentAndUpComingValues(e){let r=this.getValue(e),n=this.getUpcomingValues(e);return[r,n]}},Lme=class extends sV{static{s(this,"ConstantGranularity")}getValue(e){return this.prefix}getUpcomingValues(e){return[]}},g6e=s(t=>new Lme(t),"DEFAULT_GRANULARITY"),aV=class extends sV{constructor(r,n=.5,i=new Date().setUTCHours(0,0,0,0)){super(r);this.prefix=r;this.fetchBeforeFactor=n;this.anchor=i}static{s(this,"TimeBucketGranularity")}setTimePeriod(r){isNaN(r)?this.timePeriodLengthMs=void 0:this.timePeriodLengthMs=r}setByCallBuckets(r){isNaN(r)?this.numByCallBuckets=void 0:this.numByCallBuckets=r}getValue(r){return this.prefix+this.getTimePeriodBucketString(r)+(this.numByCallBuckets?this.timeHash(r):"")}getTimePeriodBucketString(r){return this.timePeriodLengthMs?this.dateToTimePartString(r):""}getUpcomingValues(r){let n=[],i=this.getUpcomingTimePeriodBucketStrings(r),o=this.getUpcomingByCallBucketStrings();for(let a of i)for(let c of o)n.push(this.prefix+a+c);return n}getUpcomingTimePeriodBucketStrings(r){if(this.timePeriodLengthMs===void 0)return[""];if((r.getTime()-this.anchor)%this.timePeriodLengthMs<this.fetchBeforeFactor*this.timePeriodLengthMs)return[this.getTimePeriodBucketString(r)];{let n=new Date(r.getTime()+this.timePeriodLengthMs);return[this.getTimePeriodBucketString(r),this.getTimePeriodBucketString(n)]}}getUpcomingByCallBucketStrings(){return this.numByCallBuckets===void 0?[""]:Array.from(Array(this.numByCallBuckets).keys()).map(r=>r.toString())}timeHash(r){return this.numByCallBuckets==null?0:7883*(r.getTime()%this.numByCallBuckets)%this.numByCallBuckets}dateToTimePartString(r){return this.timePeriodLengthMs==null?"":Math.floor((r.getTime()-this.anchor)/this.timePeriodLengthMs).toString()}};var A6e="X-Copilot-ClientTimeBucket",cV=class{constructor(e,r){this.specs=new Map;this.prefix=e,this.clock=r,this.defaultGranularity=g6e(e)}static{s(this,"GranularityDirectory")}selectGranularity(e){for(let[r,n]of this.specs.entries())if(e.extends(r))return n;return this.defaultGranularity}update(e,r,n){if(r=r>1?r:NaN,n=n>0?n:NaN,isNaN(r)&&isNaN(n))this.specs.delete(e);else{let i=new aV(this.prefix);isNaN(r)||i.setByCallBuckets(r),isNaN(n)||i.setTimePeriod(n*3600*1e3),this.specs.set(e,i)}}extendFilters(e){let r=this.selectGranularity(e),[n,i]=r.getCurrentAndUpComingValues(this.clock.now());return{newFilterSettings:e.withChange(A6e,n),otherFilterSettingsToPrefetch:i.map(o=>e.withChange(A6e,o))}}};d();d();d();d();var Fme=new Map;async function V4t(t){if(Fme.has(t))return Fme.get(t);let e=await crypto.subtle.importKey("raw",new TextEncoder().encode(t),{name:"HMAC",hash:"SHA-256"},!1,["sign"]);return Fme.set(t,e),e}s(V4t,"getCachedHmacKey");async function z4t(t){if(t)try{let e=await V4t(t),r=Math.floor(Date.now()/1e3).toString(),n=new TextEncoder().encode(r),i=await crypto.subtle.sign("HMAC",e,n),a=Array.from(new Uint8Array(i)).map(c=>c.toString(16).padStart(2,"0")).join("");return`${r}.${a}`}catch{return}}s(z4t,"createRequestHMAC");async function y6e(t){let e=await z4t(t);return e?{"Request-Hmac":e,"Copilot-Integration-Id":"jetbrains-chat-dev"}:{}}s(y6e,"createMsBenchHmacHeaders");d();d();d();d();var uV="4.11.0",c2="04b07795-8ddb-461a-bbee-02f9e1bf7b46",C6e="common",lV;(function(t){t.AzureChina="https://login.chinacloudapi.cn",t.AzureGermany="https://login.microsoftonline.de",t.AzureGovernment="https://login.microsoftonline.us",t.AzurePublicCloud="https://login.microsoftonline.com"})(lV||(lV={}));var C9=lV.AzurePublicCloud,v6e="login.microsoftonline.com",x6e=["*"],E6e="cae",b6e="nocae",I6e="msal.cache";var Ome;var T6e,dV,Qme;function w6e(){return dV!==void 0&&Qme!==void 0}s(w6e,"hasVSCodePlugin");function K4t(t){let e={cache:{},broker:{...t.brokerOptions,isEnabled:t.brokerOptions?.enabled??!1,enableMsaPassthrough:t.brokerOptions?.legacyEnableMsaPassthrough??!1}};if(t.tokenCachePersistenceOptions?.enabled){if(Ome===void 0)throw new Error(["Persistent token caching was requested, but no persistence provider was configured.","You must install the identity-cache-persistence plugin package (`npm install --save @azure/identity-cache-persistence`)","and enable it by importing `useIdentityPlugin` from `@azure/identity` and calling","`useIdentityPlugin(cachePersistencePlugin)` before using `tokenCachePersistenceOptions`."].join(" "));let r=t.tokenCachePersistenceOptions.name||I6e;e.cache.cachePlugin=Ome({name:`${r}.${b6e}`,...t.tokenCachePersistenceOptions}),e.cache.cachePluginCae=Ome({name:`${r}.${E6e}`,...t.tokenCachePersistenceOptions})}if(t.brokerOptions?.enabled)if(t.isVSCodeCredential){if(Qme===void 0)throw new Error(["Visual Studio Code Credential was requested, but no plugin was configured or no authentication record was found.","You must install the identity-vscode plugin package (`npm install --save @azure/identity-vscode`)","and enable it by importing `useIdentityPlugin` from `@azure/identity` and calling","`useIdentityPlugin(vsCodePlugin)` before using `enableBroker`."].join(" "));e.broker.nativeBrokerPlugin=Qme.broker}else{if(T6e===void 0)throw new Error(["Broker for WAM was requested to be enabled, but no native broker was configured.","You must install the identity-broker plugin package (`npm install --save @azure/identity-broker`)","and enable it by importing `useIdentityPlugin` from `@azure/identity` and calling","`useIdentityPlugin(brokerPlugin)` before using `enableBroker`."].join(" "));e.broker.nativeBrokerPlugin=T6e.broker}return e}s(K4t,"generatePluginConfiguration");var S6e={generatePluginConfiguration:K4t};d();d();d();function Y4t(t){return t&&typeof t.error=="string"&&typeof t.error_description=="string"}s(Y4t,"isErrorResponse");var R6e="CredentialUnavailableError",Hr=class extends Error{static{s(this,"CredentialUnavailableError")}constructor(e,r){super(e,r),this.name=R6e}},fV="AuthenticationError",QI=class extends Error{static{s(this,"AuthenticationError")}statusCode;errorResponse;constructor(e,r,n){let i={error:"unknown",errorDescription:"An unknown error occurred and no additional details are available."};if(Y4t(r))i=_6e(r);else if(typeof r=="string")try{let o=JSON.parse(r);i=_6e(o)}catch{e===400?i={error:"invalid_request",errorDescription:`The service indicated that the request was invalid.

${r}`}:i={error:"unknown_error",errorDescription:`An unknown error has occurred. Response body:

${r}`}}else i={error:"unknown_error",errorDescription:"An unknown error occurred and no additional details are available."};super(`${i.error} Status code: ${e}
More details:
${i.errorDescription},`,n),this.statusCode=e,this.errorResponse=i,this.name=fV}},k6e="AggregateAuthenticationError",v9=class extends Error{static{s(this,"AggregateAuthenticationError")}errors;constructor(e,r){let n=e.join(`
`);super(`${r}
${n}`),this.errors=e,this.name=k6e}};function _6e(t){return{error:t.error,errorDescription:t.error_description,correlationId:t.correlation_id,errorCodes:t.error_codes,timestamp:t.timestamp,traceId:t.trace_id}}s(_6e,"convertOAuthErrorResponseToErrorResponse");var Zm=class extends Error{static{s(this,"AuthenticationRequiredError")}scopes;getTokenOptions;constructor(e){super(e.message,e.cause?{cause:e.cause}:void 0),this.scopes=e.scopes,this.getTokenOptions=e.getTokenOptions,this.name="AuthenticationRequiredError"}};d();d();d();d();var P6e=require("node:os"),D6e=Be(require("node:util"),1),B6e=Be(require("node:process"),1);function N6e(t,...e){B6e.stderr.write(`${D6e.default.format(t,...e)}${P6e.EOL}`)}s(N6e,"log");var M6e=typeof process<"u"&&process.env&&process.env.DEBUG||void 0,L6e,Ume=[],qme=[],pV=[];M6e&&Hme(M6e);var F6e=Object.assign(t=>O6e(t),{enable:Hme,enabled:$me,disable:J4t,log:N6e});function Hme(t){L6e=t,Ume=[],qme=[];let e=/\*/g,r=t.split(",").map(n=>n.trim().replace(e,".*?"));for(let n of r)n.startsWith("-")?qme.push(new RegExp(`^${n.substr(1)}$`)):Ume.push(new RegExp(`^${n}$`));for(let n of pV)n.enabled=$me(n.namespace)}s(Hme,"enable");function $me(t){if(t.endsWith("*"))return!0;for(let e of qme)if(e.test(t))return!1;for(let e of Ume)if(e.test(t))return!0;return!1}s($me,"enabled");function J4t(){let t=L6e||"";return Hme(""),t}s(J4t,"disable");function O6e(t){let e=Object.assign(r,{enabled:$me(t),destroy:X4t,log:F6e.log,namespace:t,extend:Z4t});function r(...n){e.enabled&&(n.length>0&&(n[0]=`${t} ${n[0]}`),e.log(...n))}return s(r,"debug"),pV.push(e),e}s(O6e,"createDebugger");function X4t(){let t=pV.indexOf(this);return t>=0?(pV.splice(t,1),!0):!1}s(X4t,"destroy");function Z4t(t){let e=O6e(`${this.namespace}:${t}`);return e.log=this.log,e}s(Z4t,"extend");var ND=F6e;var U6e=new Set,mV=typeof process<"u"&&process.env&&process.env.AZURE_LOG_LEVEL||void 0,gV,Wme=ND("azure");Wme.log=(...t)=>{ND.log(...t)};var jme=["verbose","info","warning","error"];mV&&($6e(mV)?eDt(mV):console.error(`AZURE_LOG_LEVEL set to unknown log level '${mV}'; logging is not enabled. Acceptable values: ${jme.join(", ")}.`));function eDt(t){if(t&&!$6e(t))throw new Error(`Unknown log level '${t}'. Acceptable values: ${jme.join(",")}`);gV=t;let e=[];for(let r of U6e)H6e(r)&&e.push(r.namespace);ND.enable(e.join(","))}s(eDt,"setLogLevel");function AV(){return gV}s(AV,"getLogLevel");var Q6e={verbose:400,info:300,warning:200,error:100};function UI(t){let e=Wme.extend(t);return q6e(Wme,e),{error:hV(e,"error"),warning:hV(e,"warning"),info:hV(e,"info"),verbose:hV(e,"verbose")}}s(UI,"createClientLogger");function q6e(t,e){e.log=(...r)=>{t.log(...r)}}s(q6e,"patchLogMethod");function hV(t,e){let r=Object.assign(t.extend(e),{level:e});if(q6e(t,r),H6e(r)){let n=ND.disable();ND.enable(n+","+r.namespace)}return U6e.add(r),r}s(hV,"createLogger");function H6e(t){return!!(gV&&Q6e[t.level]<=Q6e[gV])}s(H6e,"shouldEnable");function $6e(t){return jme.includes(t)}s($6e,"isAzureLogLevel");var _0=UI("identity");function yV(t){return t.reduce((e,r)=>(process.env[r]?e.assigned.push(r):e.missing.push(r),e),{missing:[],assigned:[]})}s(yV,"processEnvVars");function Bl(t){return`SUCCESS. Scopes: ${Array.isArray(t)?t.join(", "):t}.`}s(Bl,"formatSuccess");function Eo(t,e){let r="ERROR.";return t?.length&&(r+=` Scopes: ${Array.isArray(t)?t.join(", "):t}.`),`${r} Error message: ${typeof e=="string"?e:e.message}.`}s(Eo,"formatError");function W6e(t,e,r=_0){let n=e?`${e.fullTitle} ${t}`:t;function i(l){r.info(`${n} =>`,l)}s(i,"info");function o(l){r.warning(`${n} =>`,l)}s(o,"warning");function a(l){r.verbose(`${n} =>`,l)}s(a,"verbose");function c(l){r.error(`${n} =>`,l)}return s(c,"error"),{title:t,fullTitle:n,info:i,warning:o,verbose:a,error:c}}s(W6e,"credentialLoggerInstance");function ni(t,e=_0){let r=W6e(t,void 0,e);return{...r,parent:e,getToken:W6e("=> getToken()",r,e)}}s(ni,"credentialLogger");d();d();d();d();var MD={span:Symbol.for("@azure/core-tracing span"),namespace:Symbol.for("@azure/core-tracing namespace")};function j6e(t={}){let e=new Gme(t.parentContext);return t.span&&(e=e.setValue(MD.span,t.span)),t.namespace&&(e=e.setValue(MD.namespace,t.namespace)),e}s(j6e,"createTracingContext");var Gme=class t{static{s(this,"TracingContextImpl")}constructor(e){this._contextMap=e instanceof t?new Map(e._contextMap):new Map}setValue(e,r){let n=new t(this);return n._contextMap.set(e,r),n}getValue(e){return this._contextMap.get(e)}deleteValue(e){let r=new t(this);return r._contextMap.delete(e),r}};d();var V6e=Be(G6e(),1),vV=V6e.state;function tDt(){return{end:s(()=>{},"end"),isRecording:s(()=>!1,"isRecording"),recordException:s(()=>{},"recordException"),setAttribute:s(()=>{},"setAttribute"),setStatus:s(()=>{},"setStatus"),addEvent:s(()=>{},"addEvent")}}s(tDt,"createDefaultTracingSpan");function rDt(){return{createRequestHeaders:s(()=>({}),"createRequestHeaders"),parseTraceparentHeader:s(()=>{},"parseTraceparentHeader"),startSpan:s((t,e)=>({span:tDt(),tracingContext:j6e({parentContext:e.tracingContext})}),"startSpan"),withContext(t,e,...r){return e(...r)}}}s(rDt,"createDefaultInstrumenter");function x9(){return vV.instrumenterImplementation||(vV.instrumenterImplementation=rDt()),vV.instrumenterImplementation}s(x9,"getInstrumenter");d();function E9(t){let{namespace:e,packageName:r,packageVersion:n}=t;function i(u,f,p){var m;let h=x9().startSpan(u,Object.assign(Object.assign({},p),{packageName:r,packageVersion:n,tracingContext:(m=f?.tracingOptions)===null||m===void 0?void 0:m.tracingContext})),g=h.tracingContext,A=h.span;g.getValue(MD.namespace)||(g=g.setValue(MD.namespace,e)),A.setAttribute("az.namespace",g.getValue(MD.namespace));let y=Object.assign({},f,{tracingOptions:Object.assign(Object.assign({},f?.tracingOptions),{tracingContext:g})});return{span:A,updatedOptions:y}}s(i,"startSpan");async function o(u,f,p,m){let{span:h,updatedOptions:g}=i(u,f,m);try{let A=await a(g.tracingOptions.tracingContext,()=>Promise.resolve(p(g,h)));return h.setStatus({status:"success"}),A}catch(A){throw h.setStatus({status:"error",error:A}),A}finally{h.end()}}s(o,"withSpan");function a(u,f,...p){return x9().withContext(u,f,...p)}s(a,"withContext");function c(u){return x9().parseTraceparentHeader(u)}s(c,"parseTraceparentHeader");function l(u){return x9().createRequestHeaders(u)}return s(l,"createRequestHeaders"),{startSpan:i,withSpan:o,withContext:a,parseTraceparentHeader:c,createRequestHeaders:l}}s(E9,"createTracingClient");var rs=E9({namespace:"Microsoft.AAD",packageName:"@azure/identity",packageVersion:uV});var Vme=ni("ChainedTokenCredential"),b9=class{static{s(this,"ChainedTokenCredential")}_sources=[];constructor(...e){this._sources=e}async getToken(e,r={}){let{token:n}=await this.getTokenInternal(e,r);return n}async getTokenInternal(e,r={}){let n=null,i,o=[];return rs.withSpan("ChainedTokenCredential.getToken",r,async a=>{for(let c=0;c<this._sources.length&&n===null;c++)try{n=await this._sources[c].getToken(e,a),i=this._sources[c]}catch(l){if(l.name==="CredentialUnavailableError"||l.name==="AuthenticationRequiredError")o.push(l);else throw Vme.getToken.info(Eo(e,l)),l}if(!n&&o.length>0){let c=new v9(o,"ChainedTokenCredential authentication failed.");throw Vme.getToken.info(Eo(e,c)),c}if(Vme.getToken.info(`Result for ${i.constructor.name}: ${Bl(e)}`),n===null)throw new Hr("Failed to retrieve a valid token");return{token:n,successfulCredential:i}})}};d();d();d();d();var N0={};Ia(N0,{AuthError:()=>ai,AuthErrorCodes:()=>QD,AuthErrorMessage:()=>Kme,AzureCloudInstance:()=>ex,ClientApplication:()=>aT,ClientAssertion:()=>cx,ClientAuthError:()=>zI,ClientAuthErrorCodes:()=>Cs,ClientAuthErrorMessage:()=>Jme,ClientConfigurationError:()=>jD,ClientConfigurationErrorCodes:()=>WD,ClientConfigurationErrorMessage:()=>rhe,ClientCredentialClient:()=>cT,ConfidentialClientApplication:()=>mB,CryptoProvider:()=>TC,DeviceCodeClient:()=>dB,DistributedCachePlugin:()=>Kz,InteractionRequiredAuthError:()=>P0,InteractionRequiredAuthErrorCodes:()=>WV,InteractionRequiredAuthErrorMessage:()=>cge,LogLevel:()=>Ya,Logger:()=>R0,ManagedIdentityApplication:()=>hB,ManagedIdentitySourceNames:()=>Zn,OnBehalfOfClient:()=>pB,PromptValue:()=>HI,ProtocolMode:()=>Ld,PublicClientApplication:()=>fB,ResponseMode:()=>CC,ServerError:()=>yf,TokenCache:()=>ZD,TokenCacheContext:()=>D0,UsernamePasswordClient:()=>uB,internals:()=>lge,version:()=>AA});d();var lge={};Ia(lge,{Deserializer:()=>sx,Serializer:()=>qI});d();d();var qI=class{static{s(this,"Serializer")}static serializeJSONBlob(e){return JSON.stringify(e)}static serializeAccounts(e){let r={};return Object.keys(e).map(function(n){let i=e[n];r[n]={home_account_id:i.homeAccountId,environment:i.environment,realm:i.realm,local_account_id:i.localAccountId,username:i.username,authority_type:i.authorityType,name:i.name,client_info:i.clientInfo,last_modification_time:i.lastModificationTime,last_modification_app:i.lastModificationApp,tenantProfiles:i.tenantProfiles?.map(o=>JSON.stringify(o))}}),r}static serializeIdTokens(e){let r={};return Object.keys(e).map(function(n){let i=e[n];r[n]={home_account_id:i.homeAccountId,environment:i.environment,credential_type:i.credentialType,client_id:i.clientId,secret:i.secret,realm:i.realm}}),r}static serializeAccessTokens(e){let r={};return Object.keys(e).map(function(n){let i=e[n];r[n]={home_account_id:i.homeAccountId,environment:i.environment,credential_type:i.credentialType,client_id:i.clientId,secret:i.secret,realm:i.realm,target:i.target,cached_at:i.cachedAt,expires_on:i.expiresOn,extended_expires_on:i.extendedExpiresOn,refresh_on:i.refreshOn,key_id:i.keyId,token_type:i.tokenType,requestedClaims:i.requestedClaims,requestedClaimsHash:i.requestedClaimsHash,userAssertionHash:i.userAssertionHash}}),r}static serializeRefreshTokens(e){let r={};return Object.keys(e).map(function(n){let i=e[n];r[n]={home_account_id:i.homeAccountId,environment:i.environment,credential_type:i.credentialType,client_id:i.clientId,secret:i.secret,family_id:i.familyId,target:i.target,realm:i.realm}}),r}static serializeAppMetadata(e){let r={};return Object.keys(e).map(function(n){let i=e[n];r[n]={client_id:i.clientId,environment:i.environment,family_id:i.familyId}}),r}static serializeAllCache(e){return{Account:this.serializeAccounts(e.accounts),IdToken:this.serializeIdTokens(e.idTokens),AccessToken:this.serializeAccessTokens(e.accessTokens),RefreshToken:this.serializeRefreshTokens(e.refreshTokens),AppMetadata:this.serializeAppMetadata(e.appMetadata)}}};d();d();d();d();d();d();d();d();d();var rt={LIBRARY_NAME:"MSAL.JS",SKU:"msal.js.common",CACHE_PREFIX:"msal",DEFAULT_AUTHORITY:"https://login.microsoftonline.com/common/",DEFAULT_AUTHORITY_HOST:"login.microsoftonline.com",DEFAULT_COMMON_TENANT:"common",ADFS:"adfs",DSTS:"dstsv2",AAD_INSTANCE_DISCOVERY_ENDPT:"https://login.microsoftonline.com/common/discovery/instance?api-version=1.1&authorization_endpoint=",CIAM_AUTH_URL:".ciamlogin.com",AAD_TENANT_DOMAIN_SUFFIX:".onmicrosoft.com",RESOURCE_DELIM:"|",NO_ACCOUNT:"NO_ACCOUNT",CLAIMS:"claims",CONSUMER_UTID:"9188040d-6c67-4c5b-b112-36a304b66dad",OPENID_SCOPE:"openid",PROFILE_SCOPE:"profile",OFFLINE_ACCESS_SCOPE:"offline_access",EMAIL_SCOPE:"email",CODE_GRANT_TYPE:"authorization_code",RT_GRANT_TYPE:"refresh_token",S256_CODE_CHALLENGE_METHOD:"S256",URL_FORM_CONTENT_TYPE:"application/x-www-form-urlencoded;charset=utf-8",AUTHORIZATION_PENDING:"authorization_pending",NOT_DEFINED:"not_defined",EMPTY_STRING:"",NOT_APPLICABLE:"N/A",NOT_AVAILABLE:"Not Available",FORWARD_SLASH:"/",IMDS_ENDPOINT:"http://169.254.169.254/metadata/instance/compute/location",IMDS_VERSION:"2020-06-01",IMDS_TIMEOUT:2e3,AZURE_REGION_AUTO_DISCOVER_FLAG:"TryAutoDetect",REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX:"login.microsoft.com",KNOWN_PUBLIC_CLOUDS:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"],SHR_NONCE_VALIDITY:240,INVALID_INSTANCE:"invalid_instance"},si={SUCCESS:200,SUCCESS_RANGE_START:200,SUCCESS_RANGE_END:299,REDIRECT:302,CLIENT_ERROR:400,CLIENT_ERROR_RANGE_START:400,BAD_REQUEST:400,UNAUTHORIZED:401,NOT_FOUND:404,REQUEST_TIMEOUT:408,GONE:410,TOO_MANY_REQUESTS:429,CLIENT_ERROR_RANGE_END:499,SERVER_ERROR:500,SERVER_ERROR_RANGE_START:500,SERVICE_UNAVAILABLE:503,GATEWAY_TIMEOUT:504,SERVER_ERROR_RANGE_END:599,MULTI_SIDED_ERROR:600},pp=[rt.OPENID_SCOPE,rt.PROFILE_SCOPE,rt.OFFLINE_ACCESS_SCOPE],zme=[...pp,rt.EMAIL_SCOPE],Qs={CONTENT_TYPE:"Content-Type",CONTENT_LENGTH:"Content-Length",RETRY_AFTER:"Retry-After",CCS_HEADER:"X-AnchorMailbox",WWWAuthenticate:"WWW-Authenticate",AuthenticationInfo:"Authentication-Info",X_MS_REQUEST_ID:"x-ms-request-id",X_MS_HTTP_VERSION:"x-ms-httpver"};var mp={COMMON:"common",ORGANIZATIONS:"organizations",CONSUMERS:"consumers"},l2={ACCESS_TOKEN:"access_token",XMS_CC:"xms_cc"},HI={LOGIN:"login",SELECT_ACCOUNT:"select_account",CONSENT:"consent",NONE:"none",CREATE:"create",NO_SESSION:"no_session"},xV={PLAIN:"plain",S256:"S256"},LD={CODE:"code",IDTOKEN_TOKEN:"id_token token",IDTOKEN_TOKEN_REFRESHTOKEN:"id_token token refresh_token"};var CC={QUERY:"query",FRAGMENT:"fragment",FORM_POST:"form_post"},hp={IMPLICIT_GRANT:"implicit",AUTHORIZATION_CODE_GRANT:"authorization_code",CLIENT_CREDENTIALS_GRANT:"client_credentials",RESOURCE_OWNER_PASSWORD_GRANT:"password",REFRESH_TOKEN_GRANT:"refresh_token",DEVICE_CODE_GRANT:"device_code",JWT_BEARER:"urn:ietf:params:oauth:grant-type:jwt-bearer"},u2={MSSTS_ACCOUNT_TYPE:"MSSTS",ADFS_ACCOUNT_TYPE:"ADFS",MSAV1_ACCOUNT_TYPE:"MSA",GENERIC_ACCOUNT_TYPE:"Generic"},lc={CACHE_KEY_SEPARATOR:"-",CLIENT_INFO_SEPARATOR:"."},_o={ID_TOKEN:"IdToken",ACCESS_TOKEN:"AccessToken",ACCESS_TOKEN_WITH_AUTH_SCHEME:"AccessToken_With_AuthScheme",REFRESH_TOKEN:"RefreshToken"};var I9="appmetadata",z6e="client_info",Kv="1",FD={CACHE_KEY:"authority-metadata",REFRESH_TIME_SECONDS:3600*24},hf={CONFIG:"config",CACHE:"cache",NETWORK:"network",HARDCODED_VALUES:"hardcoded_values"},Nl={SCHEMA_VERSION:5,MAX_LAST_HEADER_BYTES:330,MAX_CACHED_ERRORS:50,CACHE_KEY:"server-telemetry",CATEGORY_SEPARATOR:"|",VALUE_SEPARATOR:",",OVERFLOW_TRUE:"1",OVERFLOW_FALSE:"0",UNKNOWN_ERROR:"unknown_error"},lo={BEARER:"Bearer",POP:"pop",SSH:"ssh-cert"},vC={DEFAULT_THROTTLE_TIME_SECONDS:60,DEFAULT_MAX_THROTTLE_TIME_SECONDS:3600,THROTTLING_PREFIX:"throttling",X_MS_LIB_CAPABILITY_VALUE:"retry-after, h429"},T9={INVALID_GRANT_ERROR:"invalid_grant",CLIENT_MISMATCH_ERROR:"client_mismatch"},w9={username:"username",password:"password"},d2={FAILED_AUTO_DETECTION:"1",INTERNAL_CACHE:"2",ENVIRONMENT_VARIABLE:"3",IMDS:"4"},EV={CONFIGURED_NO_AUTO_DETECTION:"2",AUTO_DETECTION_REQUESTED_SUCCESSFUL:"4",AUTO_DETECTION_REQUESTED_FAILED:"5"},_s={NOT_APPLICABLE:"0",FORCE_REFRESH_OR_CLAIMS:"1",NO_CACHED_ACCESS_TOKEN:"2",CACHED_ACCESS_TOKEN_EXPIRED:"3",PROACTIVELY_REFRESHED:"4"};var OD=300,Gu={BASE64:"base64",HEX:"hex",UTF8:"utf-8"};var QD={};Ia(QD,{postRequestFailed:()=>_9,unexpectedError:()=>S9});d();var S9="unexpected_error",_9="post_request_failed";var bV={[S9]:"Unexpected error in authentication.",[_9]:"Post request failed from the network, could be a 4xx/5xx or a network unavailability. Please check the exact error code for details."},Kme={unexpectedError:{code:S9,desc:bV[S9]},postRequestFailed:{code:_9,desc:bV[_9]}},ai=class t extends Error{static{s(this,"AuthError")}constructor(e,r,n){let i=r?`${e}: ${r}`:e;super(i),Object.setPrototypeOf(this,t.prototype),this.errorCode=e||rt.EMPTY_STRING,this.errorMessage=r||rt.EMPTY_STRING,this.subError=n||rt.EMPTY_STRING,this.name="AuthError"}setCorrelationId(e){this.correlationId=e}};function Yme(t,e){return new ai(t,e?`${bV[t]} ${e}`:bV[t])}s(Yme,"createAuthError");var Cs={};Ia(Cs,{authTimeNotFound:()=>Yv,authorizationCodeMissingFromServerResponse:()=>w2,bindingKeyNotRemoved:()=>Q9,cannotAppendScopeSet:()=>b2,cannotRemoveEmptyScope:()=>E2,clientInfoDecodingError:()=>$I,clientInfoEmptyError:()=>f2,deviceCodeExpired:()=>D9,deviceCodePollingCancelled:()=>P9,deviceCodeUnknownError:()=>B9,emptyInputScopeSet:()=>GI,endSessionEndpointNotSupported:()=>S2,endpointResolutionError:()=>gf,hashNotDeserialized:()=>g2,invalidAssertion:()=>L9,invalidCacheEnvironment:()=>Xv,invalidCacheRecord:()=>I2,invalidClientCredential:()=>F9,invalidState:()=>mA,keyIdMissing:()=>_2,maxAgeTranspired:()=>C2,methodNotImplemented:()=>Ni,missingTenantIdError:()=>H9,multipleMatchingAccounts:()=>k9,multipleMatchingAppMetadata:()=>v2,multipleMatchingTokens:()=>R9,nestedAppAuthBridgeDisabled:()=>$9,networkError:()=>m2,noAccountFound:()=>N9,noAccountInSilentRequest:()=>Jv,noCryptoObject:()=>VI,noNetworkConnectivity:()=>U9,nonceMismatch:()=>y2,nullOrEmptyToken:()=>p2,openIdConfigError:()=>h2,requestCannotBeMade:()=>x2,stateMismatch:()=>A2,stateNotFound:()=>jI,tokenClaimsCnfRequiredForSignedJwt:()=>T2,tokenParsingError:()=>WI,tokenRefreshRequired:()=>Zv,unexpectedCredentialType:()=>M9,userCanceled:()=>q9,userTimeoutReached:()=>O9});d();var $I="client_info_decoding_error",f2="client_info_empty_error",WI="token_parsing_error",p2="null_or_empty_token",gf="endpoints_resolution_error",m2="network_error",h2="openid_config_error",g2="hash_not_deserialized",mA="invalid_state",A2="state_mismatch",jI="state_not_found",y2="nonce_mismatch",Yv="auth_time_not_found",C2="max_age_transpired",R9="multiple_matching_tokens",k9="multiple_matching_accounts",v2="multiple_matching_appMetadata",x2="request_cannot_be_made",E2="cannot_remove_empty_scope",b2="cannot_append_scopeset",GI="empty_input_scopeset",P9="device_code_polling_cancelled",D9="device_code_expired",B9="device_code_unknown_error",Jv="no_account_in_silent_request",I2="invalid_cache_record",Xv="invalid_cache_environment",N9="no_account_found",VI="no_crypto_object",M9="unexpected_credential_type",L9="invalid_assertion",F9="invalid_client_credential",Zv="token_refresh_required",O9="user_timeout_reached",T2="token_claims_cnf_required_for_signedjwt",w2="authorization_code_missing_from_server_response",Q9="binding_key_not_removed",S2="end_session_endpoint_not_supported",_2="key_id_missing",U9="no_network_connectivity",q9="user_canceled",H9="missing_tenant_id_error",Ni="method_not_implemented",$9="nested_app_auth_bridge_disabled";var ci={[$I]:"The client info could not be parsed/decoded correctly",[f2]:"The client info was empty",[WI]:"Token cannot be parsed",[p2]:"The token is null or empty",[gf]:"Endpoints cannot be resolved",[m2]:"Network request failed",[h2]:"Could not retrieve endpoints. Check your authority and verify the .well-known/openid-configuration endpoint returns the required endpoints.",[g2]:"The hash parameters could not be deserialized",[mA]:"State was not the expected format",[A2]:"State mismatch error",[jI]:"State not found",[y2]:"Nonce mismatch error",[Yv]:"Max Age was requested and the ID token is missing the auth_time variable. auth_time is an optional claim and is not enabled by default - it must be enabled. See https://aka.ms/msaljs/optional-claims for more information.",[C2]:"Max Age is set to 0, or too much time has elapsed since the last end-user authentication.",[R9]:"The cache contains multiple tokens satisfying the requirements. Call AcquireToken again providing more requirements such as authority or account.",[k9]:"The cache contains multiple accounts satisfying the given parameters. Please pass more info to obtain the correct account",[v2]:"The cache contains multiple appMetadata satisfying the given parameters. Please pass more info to obtain the correct appMetadata",[x2]:"Token request cannot be made without authorization code or refresh token.",[E2]:"Cannot remove null or empty scope from ScopeSet",[b2]:"Cannot append ScopeSet",[GI]:"Empty input ScopeSet cannot be processed",[P9]:"Caller has cancelled token endpoint polling during device code flow by setting DeviceCodeRequest.cancel = true.",[D9]:"Device code is expired.",[B9]:"Device code stopped polling for unknown reasons.",[Jv]:"Please pass an account object, silent flow is not supported without account information",[I2]:"Cache record object was null or undefined.",[Xv]:"Invalid environment when attempting to create cache entry",[N9]:"No account found in cache for given key.",[VI]:"No crypto object detected.",[M9]:"Unexpected credential type.",[L9]:"Client assertion must meet requirements described in https://tools.ietf.org/html/rfc7515",[F9]:"Client credential (secret, certificate, or assertion) must not be empty when creating a confidential client. An application should at most have one credential",[Zv]:"Cannot return token from cache because it must be refreshed. This may be due to one of the following reasons: forceRefresh parameter is set to true, claims have been requested, there is no cached access token or it is expired.",[O9]:"User defined timeout for device code polling reached",[T2]:"Cannot generate a POP jwt if the token_claims are not populated",[w2]:"Server response does not contain an authorization code to proceed",[Q9]:"Could not remove the credential's binding key from storage.",[S2]:"The provided authority does not support logout",[_2]:"A keyId value is missing from the requested bound token's cache record and is required to match the token to it's stored binding key.",[U9]:"No network connectivity. Check your internet connection.",[q9]:"User cancelled the flow.",[H9]:"A tenant id - not common, organizations, or consumers - must be specified when using the client_credentials flow.",[Ni]:"This method has not been implemented",[$9]:"The nested app auth bridge is disabled"},Jme={clientInfoDecodingError:{code:$I,desc:ci[$I]},clientInfoEmptyError:{code:f2,desc:ci[f2]},tokenParsingError:{code:WI,desc:ci[WI]},nullOrEmptyToken:{code:p2,desc:ci[p2]},endpointResolutionError:{code:gf,desc:ci[gf]},networkError:{code:m2,desc:ci[m2]},unableToGetOpenidConfigError:{code:h2,desc:ci[h2]},hashNotDeserialized:{code:g2,desc:ci[g2]},invalidStateError:{code:mA,desc:ci[mA]},stateMismatchError:{code:A2,desc:ci[A2]},stateNotFoundError:{code:jI,desc:ci[jI]},nonceMismatchError:{code:y2,desc:ci[y2]},authTimeNotFoundError:{code:Yv,desc:ci[Yv]},maxAgeTranspired:{code:C2,desc:ci[C2]},multipleMatchingTokens:{code:R9,desc:ci[R9]},multipleMatchingAccounts:{code:k9,desc:ci[k9]},multipleMatchingAppMetadata:{code:v2,desc:ci[v2]},tokenRequestCannotBeMade:{code:x2,desc:ci[x2]},removeEmptyScopeError:{code:E2,desc:ci[E2]},appendScopeSetError:{code:b2,desc:ci[b2]},emptyInputScopeSetError:{code:GI,desc:ci[GI]},DeviceCodePollingCancelled:{code:P9,desc:ci[P9]},DeviceCodeExpired:{code:D9,desc:ci[D9]},DeviceCodeUnknownError:{code:B9,desc:ci[B9]},NoAccountInSilentRequest:{code:Jv,desc:ci[Jv]},invalidCacheRecord:{code:I2,desc:ci[I2]},invalidCacheEnvironment:{code:Xv,desc:ci[Xv]},noAccountFound:{code:N9,desc:ci[N9]},noCryptoObj:{code:VI,desc:ci[VI]},unexpectedCredentialType:{code:M9,desc:ci[M9]},invalidAssertion:{code:L9,desc:ci[L9]},invalidClientCredential:{code:F9,desc:ci[F9]},tokenRefreshRequired:{code:Zv,desc:ci[Zv]},userTimeoutReached:{code:O9,desc:ci[O9]},tokenClaimsRequired:{code:T2,desc:ci[T2]},noAuthorizationCodeFromServer:{code:w2,desc:ci[w2]},bindingKeyNotRemovedError:{code:Q9,desc:ci[Q9]},logoutNotSupported:{code:S2,desc:ci[S2]},keyIdMissing:{code:_2,desc:ci[_2]},noNetworkConnectivity:{code:U9,desc:ci[U9]},userCanceledError:{code:q9,desc:ci[q9]},missingTenantIdError:{code:H9,desc:ci[H9]},nestedAppAuthBridgeDisabled:{code:$9,desc:ci[$9]}},zI=class t extends ai{static{s(this,"ClientAuthError")}constructor(e,r){super(e,r?`${ci[e]}: ${r}`:ci[e]),this.name="ClientAuthError",Object.setPrototypeOf(this,t.prototype)}};function vt(t,e){return new zI(t,e)}s(vt,"createClientAuthError");var UD={createNewGuid:s(()=>{throw vt(Ni)},"createNewGuid"),base64Decode:s(()=>{throw vt(Ni)},"base64Decode"),base64Encode:s(()=>{throw vt(Ni)},"base64Encode"),base64UrlEncode:s(()=>{throw vt(Ni)},"base64UrlEncode"),encodeKid:s(()=>{throw vt(Ni)},"encodeKid"),async getPublicKeyThumbprint(){throw vt(Ni)},async removeTokenBindingKey(){throw vt(Ni)},async clearKeystore(){throw vt(Ni)},async signJwt(){throw vt(Ni)},async hashString(){throw vt(Ni)}};d();var Ya;(function(t){t[t.Error=0]="Error",t[t.Warning=1]="Warning",t[t.Info=2]="Info",t[t.Verbose=3]="Verbose",t[t.Trace=4]="Trace"})(Ya||(Ya={}));var R0=class t{static{s(this,"Logger")}constructor(e,r,n){this.level=Ya.Info;let i=s(()=>{},"defaultLoggerCallback"),o=e||t.createDefaultLoggerOptions();this.localCallback=o.loggerCallback||i,this.piiLoggingEnabled=o.piiLoggingEnabled||!1,this.level=typeof o.logLevel=="number"?o.logLevel:Ya.Info,this.correlationId=o.correlationId||rt.EMPTY_STRING,this.packageName=r||rt.EMPTY_STRING,this.packageVersion=n||rt.EMPTY_STRING}static createDefaultLoggerOptions(){return{loggerCallback:s(()=>{},"loggerCallback"),piiLoggingEnabled:!1,logLevel:Ya.Info}}clone(e,r,n){return new t({loggerCallback:this.localCallback,piiLoggingEnabled:this.piiLoggingEnabled,logLevel:this.level,correlationId:n||this.correlationId},e,r)}logMessage(e,r){if(r.logLevel>this.level||!this.piiLoggingEnabled&&r.containsPii)return;let o=`${`[${new Date().toUTCString()}] : [${r.correlationId||this.correlationId||""}]`} : ${this.packageName}@${this.packageVersion} : ${Ya[r.logLevel]} - ${e}`;this.executeCallback(r.logLevel,o,r.containsPii||!1)}executeCallback(e,r,n){this.localCallback&&this.localCallback(e,r,n)}error(e,r){this.logMessage(e,{logLevel:Ya.Error,containsPii:!1,correlationId:r||rt.EMPTY_STRING})}errorPii(e,r){this.logMessage(e,{logLevel:Ya.Error,containsPii:!0,correlationId:r||rt.EMPTY_STRING})}warning(e,r){this.logMessage(e,{logLevel:Ya.Warning,containsPii:!1,correlationId:r||rt.EMPTY_STRING})}warningPii(e,r){this.logMessage(e,{logLevel:Ya.Warning,containsPii:!0,correlationId:r||rt.EMPTY_STRING})}info(e,r){this.logMessage(e,{logLevel:Ya.Info,containsPii:!1,correlationId:r||rt.EMPTY_STRING})}infoPii(e,r){this.logMessage(e,{logLevel:Ya.Info,containsPii:!0,correlationId:r||rt.EMPTY_STRING})}verbose(e,r){this.logMessage(e,{logLevel:Ya.Verbose,containsPii:!1,correlationId:r||rt.EMPTY_STRING})}verbosePii(e,r){this.logMessage(e,{logLevel:Ya.Verbose,containsPii:!0,correlationId:r||rt.EMPTY_STRING})}trace(e,r){this.logMessage(e,{logLevel:Ya.Trace,containsPii:!1,correlationId:r||rt.EMPTY_STRING})}tracePii(e,r){this.logMessage(e,{logLevel:Ya.Trace,containsPii:!0,correlationId:r||rt.EMPTY_STRING})}isPiiLoggingEnabled(){return this.piiLoggingEnabled||!1}};d();var IV="@azure/msal-common",qD="15.8.1";d();var ex={None:"none",AzurePublic:"https://login.microsoftonline.com",AzurePpe:"https://login.windows-ppe.net",AzureChina:"https://login.chinacloudapi.cn",AzureGermany:"https://login.microsoftonline.de",AzureUsGovernment:"https://login.microsoftonline.us"};d();var Ml={};Ia(Ml,{createAccessTokenEntity:()=>ehe,createIdTokenEntity:()=>Zme,createRefreshTokenEntity:()=>the,generateAppMetadataKey:()=>hDt,generateAuthorityMetadataExpiresAt:()=>SV,generateCredentialKey:()=>G9,isAccessTokenEntity:()=>oDt,isAppMetadataEntity:()=>gDt,isAuthorityMetadataEntity:()=>ADt,isAuthorityMetadataExpired:()=>_V,isCredentialEntity:()=>wV,isIdTokenEntity:()=>sDt,isRefreshTokenEntity:()=>aDt,isServerTelemetryEntity:()=>pDt,isThrottlingEntity:()=>mDt,updateAuthorityEndpointMetadata:()=>$D,updateCloudDiscoveryMetadata:()=>V9});d();var TV={};Ia(TV,{checkMaxAge:()=>W9,extractTokenClaims:()=>tx,getJWSPayload:()=>K6e});d();function tx(t,e){let r=K6e(t);try{let n=e(r);return JSON.parse(n)}catch{throw vt(WI)}}s(tx,"extractTokenClaims");function K6e(t){if(!t)throw vt(p2);let r=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(t);if(!r||r.length<4)throw vt(WI);return r[2]}s(K6e,"getJWSPayload");function W9(t,e){if(e===0||Date.now()-3e5>t+e)throw vt(C2)}s(W9,"checkMaxAge");var na={};Ia(na,{delay:()=>iDt,isTokenExpired:()=>HD,nowSeconds:()=>k0,toDateFromSeconds:()=>j9,toSecondsFromDate:()=>nDt,wasClockTurnedBack:()=>Xme});d();function k0(){return Math.round(new Date().getTime()/1e3)}s(k0,"nowSeconds");function nDt(t){return t.getTime()/1e3}s(nDt,"toSecondsFromDate");function j9(t){return t?new Date(Number(t)*1e3):new Date}s(j9,"toDateFromSeconds");function HD(t,e){let r=Number(t)||0;return k0()+e>r}s(HD,"isTokenExpired");function Xme(t){return Number(t)>k0()}s(Xme,"wasClockTurnedBack");function iDt(t,e){return new Promise(r=>setTimeout(()=>r(e),t))}s(iDt,"delay");function G9(t){return[cDt(t),lDt(t),uDt(t),dDt(t),fDt(t)].join(lc.CACHE_KEY_SEPARATOR).toLowerCase()}s(G9,"generateCredentialKey");function Zme(t,e,r,n,i){return{credentialType:_o.ID_TOKEN,homeAccountId:t,environment:e,clientId:n,secret:r,realm:i}}s(Zme,"createIdTokenEntity");function ehe(t,e,r,n,i,o,a,c,l,u,f,p,m,h,g){let A={homeAccountId:t,credentialType:_o.ACCESS_TOKEN,secret:r,cachedAt:k0().toString(),expiresOn:a.toString(),extendedExpiresOn:c.toString(),environment:e,clientId:n,realm:i,target:o,tokenType:f||lo.BEARER};if(p&&(A.userAssertionHash=p),u&&(A.refreshOn=u.toString()),h&&(A.requestedClaims=h,A.requestedClaimsHash=g),A.tokenType?.toLowerCase()!==lo.BEARER.toLowerCase())switch(A.credentialType=_o.ACCESS_TOKEN_WITH_AUTH_SCHEME,A.tokenType){case lo.POP:let y=tx(r,l);if(!y?.cnf?.kid)throw vt(T2);A.keyId=y.cnf.kid;break;case lo.SSH:A.keyId=m}return A}s(ehe,"createAccessTokenEntity");function the(t,e,r,n,i,o,a){let c={credentialType:_o.REFRESH_TOKEN,homeAccountId:t,environment:e,clientId:n,secret:r};return o&&(c.userAssertionHash=o),i&&(c.familyId=i),a&&(c.expiresOn=a.toString()),c}s(the,"createRefreshTokenEntity");function wV(t){return t.hasOwnProperty("homeAccountId")&&t.hasOwnProperty("environment")&&t.hasOwnProperty("credentialType")&&t.hasOwnProperty("clientId")&&t.hasOwnProperty("secret")}s(wV,"isCredentialEntity");function oDt(t){return t?wV(t)&&t.hasOwnProperty("realm")&&t.hasOwnProperty("target")&&(t.credentialType===_o.ACCESS_TOKEN||t.credentialType===_o.ACCESS_TOKEN_WITH_AUTH_SCHEME):!1}s(oDt,"isAccessTokenEntity");function sDt(t){return t?wV(t)&&t.hasOwnProperty("realm")&&t.credentialType===_o.ID_TOKEN:!1}s(sDt,"isIdTokenEntity");function aDt(t){return t?wV(t)&&t.credentialType===_o.REFRESH_TOKEN:!1}s(aDt,"isRefreshTokenEntity");function cDt(t){return[t.homeAccountId,t.environment].join(lc.CACHE_KEY_SEPARATOR).toLowerCase()}s(cDt,"generateAccountId");function lDt(t){let e=t.credentialType===_o.REFRESH_TOKEN&&t.familyId||t.clientId;return[t.credentialType,e,t.realm||""].join(lc.CACHE_KEY_SEPARATOR).toLowerCase()}s(lDt,"generateCredentialId");function uDt(t){return(t.target||"").toLowerCase()}s(uDt,"generateTarget");function dDt(t){return(t.requestedClaimsHash||"").toLowerCase()}s(dDt,"generateClaimsHash");function fDt(t){return t.tokenType&&t.tokenType.toLowerCase()!==lo.BEARER.toLowerCase()?t.tokenType.toLowerCase():""}s(fDt,"generateScheme");function pDt(t,e){let r=t.indexOf(Nl.CACHE_KEY)===0,n=!0;return e&&(n=e.hasOwnProperty("failedRequests")&&e.hasOwnProperty("errors")&&e.hasOwnProperty("cacheHits")),r&&n}s(pDt,"isServerTelemetryEntity");function mDt(t,e){let r=!1;t&&(r=t.indexOf(vC.THROTTLING_PREFIX)===0);let n=!0;return e&&(n=e.hasOwnProperty("throttleTime")),r&&n}s(mDt,"isThrottlingEntity");function hDt({environment:t,clientId:e}){return[I9,t,e].join(lc.CACHE_KEY_SEPARATOR).toLowerCase()}s(hDt,"generateAppMetadataKey");function gDt(t,e){return e?t.indexOf(I9)===0&&e.hasOwnProperty("clientId")&&e.hasOwnProperty("environment"):!1}s(gDt,"isAppMetadataEntity");function ADt(t,e){return e?t.indexOf(FD.CACHE_KEY)===0&&e.hasOwnProperty("aliases")&&e.hasOwnProperty("preferred_cache")&&e.hasOwnProperty("preferred_network")&&e.hasOwnProperty("canonical_authority")&&e.hasOwnProperty("authorization_endpoint")&&e.hasOwnProperty("token_endpoint")&&e.hasOwnProperty("issuer")&&e.hasOwnProperty("aliasesFromNetwork")&&e.hasOwnProperty("endpointsFromNetwork")&&e.hasOwnProperty("expiresAt")&&e.hasOwnProperty("jwks_uri"):!1}s(ADt,"isAuthorityMetadataEntity");function SV(){return k0()+FD.REFRESH_TIME_SECONDS}s(SV,"generateAuthorityMetadataExpiresAt");function $D(t,e,r){t.authorization_endpoint=e.authorization_endpoint,t.token_endpoint=e.token_endpoint,t.end_session_endpoint=e.end_session_endpoint,t.issuer=e.issuer,t.endpointsFromNetwork=r,t.jwks_uri=e.jwks_uri}s($D,"updateAuthorityEndpointMetadata");function V9(t,e,r){t.aliases=e.aliases,t.preferred_cache=e.preferred_cache,t.preferred_network=e.preferred_network,t.aliasesFromNetwork=r}s(V9,"updateCloudDiscoveryMetadata");function _V(t){return t.expiresAt<=k0()}s(_V,"isAuthorityMetadataExpired");d();d();var WD={};Ia(WD,{authorityMismatch:()=>t6,authorityUriInsecure:()=>k2,cannotAllowPlatformBroker:()=>e6,cannotSetOIDCOptions:()=>Z9,claimsRequestParsingError:()=>z9,emptyInputScopesError:()=>D2,invalidAuthenticationHeader:()=>X9,invalidAuthorityMetadata:()=>L2,invalidClaims:()=>KI,invalidCloudDiscoveryMetadata:()=>YI,invalidCodeChallengeMethod:()=>K9,logoutRequestEmpty:()=>N2,missingNonceAuthenticationHeader:()=>J9,missingSshJwk:()=>rx,missingSshKid:()=>Y9,pkceParamsMissing:()=>M2,redirectUriEmpty:()=>R2,tokenRequestEmpty:()=>B2,untrustedAuthority:()=>F2,urlEmptyError:()=>P2,urlParseError:()=>xC});d();var R2="redirect_uri_empty",z9="claims_request_parsing_error",k2="authority_uri_insecure",xC="url_parse_error",P2="empty_url_error",D2="empty_input_scopes_error",KI="invalid_claims",B2="token_request_empty",N2="logout_request_empty",K9="invalid_code_challenge_method",M2="pkce_params_missing",YI="invalid_cloud_discovery_metadata",L2="invalid_authority_metadata",F2="untrusted_authority",rx="missing_ssh_jwk",Y9="missing_ssh_kid",J9="missing_nonce_authentication_header",X9="invalid_authentication_header",Z9="cannot_set_OIDCOptions",e6="cannot_allow_platform_broker",t6="authority_mismatch";var uc={[R2]:"A redirect URI is required for all calls, and none has been set.",[z9]:"Could not parse the given claims request object.",[k2]:"Authority URIs must use https.  Please see here for valid authority configuration options: https://docs.microsoft.com/en-us/azure/active-directory/develop/msal-js-initializing-client-applications#configuration-options",[xC]:"URL could not be parsed into appropriate segments.",[P2]:"URL was empty or null.",[D2]:"Scopes cannot be passed as null, undefined or empty array because they are required to obtain an access token.",[KI]:"Given claims parameter must be a stringified JSON object.",[B2]:"Token request was empty and not found in cache.",[N2]:"The logout request was null or undefined.",[K9]:'code_challenge_method passed is invalid. Valid values are "plain" and "S256".',[M2]:"Both params: code_challenge and code_challenge_method are to be passed if to be sent in the request",[YI]:"Invalid cloudDiscoveryMetadata provided. Must be a stringified JSON object containing tenant_discovery_endpoint and metadata fields",[L2]:"Invalid authorityMetadata provided. Must by a stringified JSON object containing authorization_endpoint, token_endpoint, issuer fields.",[F2]:"The provided authority is not a trusted authority. Please include this authority in the knownAuthorities config parameter.",[rx]:"Missing sshJwk in SSH certificate request. A stringified JSON Web Key is required when using the SSH authentication scheme.",[Y9]:"Missing sshKid in SSH certificate request. A string that uniquely identifies the public SSH key is required when using the SSH authentication scheme.",[J9]:"Unable to find an authentication header containing server nonce. Either the Authentication-Info or WWW-Authenticate headers must be present in order to obtain a server nonce.",[X9]:"Invalid authentication header provided",[Z9]:"Cannot set OIDCOptions parameter. Please change the protocol mode to OIDC or use a non-Microsoft authority.",[e6]:"Cannot set allowPlatformBroker parameter to true when not in AAD protocol mode.",[t6]:"Authority mismatch error. Authority provided in login request or PublicClientApplication config does not match the environment of the provided account. Please use a matching account or make an interactive request to login to this authority."},rhe={redirectUriNotSet:{code:R2,desc:uc[R2]},claimsRequestParsingError:{code:z9,desc:uc[z9]},authorityUriInsecure:{code:k2,desc:uc[k2]},urlParseError:{code:xC,desc:uc[xC]},urlEmptyError:{code:P2,desc:uc[P2]},emptyScopesError:{code:D2,desc:uc[D2]},invalidClaimsRequest:{code:KI,desc:uc[KI]},tokenRequestEmptyError:{code:B2,desc:uc[B2]},logoutRequestEmptyError:{code:N2,desc:uc[N2]},invalidCodeChallengeMethod:{code:K9,desc:uc[K9]},invalidCodeChallengeParams:{code:M2,desc:uc[M2]},invalidCloudDiscoveryMetadata:{code:YI,desc:uc[YI]},invalidAuthorityMetadata:{code:L2,desc:uc[L2]},untrustedAuthority:{code:F2,desc:uc[F2]},missingSshJwk:{code:rx,desc:uc[rx]},missingSshKid:{code:Y9,desc:uc[Y9]},missingNonceAuthenticationHeader:{code:J9,desc:uc[J9]},invalidAuthenticationHeader:{code:X9,desc:uc[X9]},cannotSetOIDCOptions:{code:Z9,desc:uc[Z9]},cannotAllowPlatformBroker:{code:e6,desc:uc[e6]},authorityMismatch:{code:t6,desc:uc[t6]}},jD=class t extends ai{static{s(this,"ClientConfigurationError")}constructor(e){super(e,uc[e]),this.name="ClientConfigurationError",Object.setPrototypeOf(this,t.prototype)}};function vs(t){return new jD(t)}s(vs,"createClientConfigurationError");d();var Na=class{static{s(this,"StringUtils")}static isEmptyObj(e){if(e)try{let r=JSON.parse(e);return Object.keys(r).length===0}catch{}return!0}static startsWith(e,r){return e.indexOf(r)===0}static endsWith(e,r){return e.length>=r.length&&e.lastIndexOf(r)===e.length-r.length}static queryStringToObject(e){let r={},n=e.split("&"),i=s(o=>decodeURIComponent(o.replace(/\+/g," ")),"decode");return n.forEach(o=>{if(o.trim()){let[a,c]=o.split(/=(.+)/g,2);a&&c&&(r[i(a)]=i(c))}}),r}static trimArrayEntries(e){return e.map(r=>r.trim())}static removeEmptyStringsFromArray(e){return e.filter(r=>!!r)}static jsonParseHelper(e){try{return JSON.parse(e)}catch{return null}}static matchPattern(e,r){return new RegExp(e.replace(/\\/g,"\\\\").replace(/\*/g,"[^ ]*").replace(/\?/g,"\\?")).test(r)}};var nl=class t{static{s(this,"ScopeSet")}constructor(e){let r=e?Na.trimArrayEntries([...e]):[],n=r?Na.removeEmptyStringsFromArray(r):[];if(!n||!n.length)throw vs(D2);this.scopes=new Set,n.forEach(i=>this.scopes.add(i))}static fromString(e){let n=(e||rt.EMPTY_STRING).split(" ");return new t(n)}static createSearchScopes(e){let r=new t(e);return r.containsOnlyOIDCScopes()?r.removeScope(rt.OFFLINE_ACCESS_SCOPE):r.removeOIDCScopes(),r}containsScope(e){let r=this.printScopesLowerCase().split(" "),n=new t(r);return e?n.scopes.has(e.toLowerCase()):!1}containsScopeSet(e){return!e||e.scopes.size<=0?!1:this.scopes.size>=e.scopes.size&&e.asArray().every(r=>this.containsScope(r))}containsOnlyOIDCScopes(){let e=0;return zme.forEach(r=>{this.containsScope(r)&&(e+=1)}),this.scopes.size===e}appendScope(e){e&&this.scopes.add(e.trim())}appendScopes(e){try{e.forEach(r=>this.appendScope(r))}catch{throw vt(b2)}}removeScope(e){if(!e)throw vt(E2);this.scopes.delete(e.trim())}removeOIDCScopes(){zme.forEach(e=>{this.scopes.delete(e)})}unionScopeSets(e){if(!e)throw vt(GI);let r=new Set;return e.scopes.forEach(n=>r.add(n.toLowerCase())),this.scopes.forEach(n=>r.add(n.toLowerCase())),r}intersectingScopeSets(e){if(!e)throw vt(GI);e.containsOnlyOIDCScopes()||e.removeOIDCScopes();let r=this.unionScopeSets(e),n=e.getScopeCount(),i=this.getScopeCount();return r.size<i+n}getScopeCount(){return this.scopes.size}asArray(){let e=[];return this.scopes.forEach(r=>e.push(r)),e}printScopes(){return this.scopes?this.asArray().join(" "):rt.EMPTY_STRING}printScopesLowerCase(){return this.printScopes().toLowerCase()}};d();d();function GD(t,e){if(!t)throw vt(f2);try{let r=e(t);return JSON.parse(r)}catch{throw vt($I)}}s(GD,"buildClientInfo");function EC(t){if(!t)throw vt($I);let e=t.split(lc.CLIENT_INFO_SEPARATOR,2);return{uid:e[0],utid:e.length<2?rt.EMPTY_STRING:e[1]}}s(EC,"buildClientInfoFromHomeAccountId");d();function Y6e(t,e){return!!t&&!!e&&t===e.split(".")[1]}s(Y6e,"tenantIdMatchesHomeTenant");function r6(t,e,r,n){if(n){let{oid:i,sub:o,tid:a,name:c,tfp:l,acr:u}=n,f=a||l||u||"";return{tenantId:f,localAccountId:i||o||"",name:c,isHomeTenant:Y6e(f,t)}}else return{tenantId:r,localAccountId:e,isHomeTenant:Y6e(r,t)}}s(r6,"buildTenantProfile");function RV(t,e,r,n){let i=t;if(e){let{isHomeTenant:o,...a}=e;i={...t,...a}}if(r){let{isHomeTenant:o,...a}=r6(t.homeAccountId,t.localAccountId,t.tenantId,r);return i={...i,...a,idTokenClaims:r,idToken:n},i}return i}s(RV,"updateAccountTenantProfileData");d();var eh={Default:0,Adfs:1,Dsts:2,Ciam:3};d();function kV(t){return t&&(t.tid||t.tfp||t.acr)||null}s(kV,"getTenantIdFromIdTokenClaims");d();var Ld={AAD:"AAD",OIDC:"OIDC",EAR:"EAR"};var Vu=class t{static{s(this,"AccountEntity")}generateAccountId(){return[this.homeAccountId,this.environment].join(lc.CACHE_KEY_SEPARATOR).toLowerCase()}generateAccountKey(){return t.generateAccountCacheKey({homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId})}getAccountInfo(){return{homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId,name:this.name,nativeAccountId:this.nativeAccountId,authorityType:this.authorityType,tenantProfiles:new Map((this.tenantProfiles||[]).map(e=>[e.tenantId,e]))}}isSingleTenant(){return!this.tenantProfiles}static generateAccountCacheKey(e){let r=e.homeAccountId.split(".")[1];return[e.homeAccountId,e.environment||"",r||e.tenantId||""].join(lc.CACHE_KEY_SEPARATOR).toLowerCase()}static createAccount(e,r,n){let i=new t;r.authorityType===eh.Adfs?i.authorityType=u2.ADFS_ACCOUNT_TYPE:r.protocolMode===Ld.OIDC?i.authorityType=u2.GENERIC_ACCOUNT_TYPE:i.authorityType=u2.MSSTS_ACCOUNT_TYPE;let o;e.clientInfo&&n&&(o=GD(e.clientInfo,n)),i.clientInfo=e.clientInfo,i.homeAccountId=e.homeAccountId,i.nativeAccountId=e.nativeAccountId;let a=e.environment||r&&r.getPreferredCache();if(!a)throw vt(Xv);i.environment=a,i.realm=o?.utid||kV(e.idTokenClaims)||"",i.localAccountId=o?.uid||e.idTokenClaims?.oid||e.idTokenClaims?.sub||"";let c=e.idTokenClaims?.preferred_username||e.idTokenClaims?.upn,l=e.idTokenClaims?.emails?e.idTokenClaims.emails[0]:null;if(i.username=c||l||"",i.name=e.idTokenClaims?.name||"",i.cloudGraphHostName=e.cloudGraphHostName,i.msGraphHost=e.msGraphHost,e.tenantProfiles)i.tenantProfiles=e.tenantProfiles;else{let u=r6(e.homeAccountId,i.localAccountId,i.realm,e.idTokenClaims);i.tenantProfiles=[u]}return i}static createFromAccountInfo(e,r,n){let i=new t;return i.authorityType=e.authorityType||u2.GENERIC_ACCOUNT_TYPE,i.homeAccountId=e.homeAccountId,i.localAccountId=e.localAccountId,i.nativeAccountId=e.nativeAccountId,i.realm=e.tenantId,i.environment=e.environment,i.username=e.username,i.name=e.name,i.cloudGraphHostName=r,i.msGraphHost=n,i.tenantProfiles=Array.from(e.tenantProfiles?.values()||[]),i}static generateHomeAccountId(e,r,n,i,o){if(!(r===eh.Adfs||r===eh.Dsts)){if(e)try{let a=GD(e,i.base64Decode);if(a.uid&&a.utid)return`${a.uid}.${a.utid}`}catch{}n.warning("No client info in response")}return o?.sub||""}static isAccountEntity(e){return e?e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("realm")&&e.hasOwnProperty("localAccountId")&&e.hasOwnProperty("username")&&e.hasOwnProperty("authorityType"):!1}static accountInfoIsEqual(e,r,n){if(!e||!r)return!1;let i=!0;if(n){let o=e.idTokenClaims||{},a=r.idTokenClaims||{};i=o.iat===a.iat&&o.nonce===a.nonce}return e.homeAccountId===r.homeAccountId&&e.localAccountId===r.localAccountId&&e.username===r.username&&e.tenantId===r.tenantId&&e.environment===r.environment&&e.nativeAccountId===r.nativeAccountId&&i}};d();d();var zu={};Ia(zu,{getDeserializedResponse:()=>nhe,mapToQueryString:()=>bC,stripLeadingHashOrQuery:()=>J6e});d();function J6e(t){return t.startsWith("#/")?t.substring(2):t.startsWith("#")||t.startsWith("?")?t.substring(1):t}s(J6e,"stripLeadingHashOrQuery");function nhe(t){if(!t||t.indexOf("=")<0)return null;try{let e=J6e(t),r=Object.fromEntries(new URLSearchParams(e));if(r.code||r.ear_jwe||r.error||r.error_description||r.state)return r}catch{throw vt(g2)}return null}s(nhe,"getDeserializedResponse");function bC(t,e=!0,r){let n=new Array;return t.forEach((i,o)=>{!e&&r&&o in r?n.push(`${o}=${i}`):n.push(`${o}=${encodeURIComponent(i)}`)}),n.join("&")}s(bC,"mapToQueryString");var Mi=class t{static{s(this,"UrlString")}get urlString(){return this._urlString}constructor(e){if(this._urlString=e,!this._urlString)throw vs(P2);e.includes("#")||(this._urlString=t.canonicalizeUri(e))}static canonicalizeUri(e){if(e){let r=e.toLowerCase();return Na.endsWith(r,"?")?r=r.slice(0,-1):Na.endsWith(r,"?/")&&(r=r.slice(0,-2)),Na.endsWith(r,"/")||(r+="/"),r}return e}validateAsUri(){let e;try{e=this.getUrlComponents()}catch{throw vs(xC)}if(!e.HostNameAndPort||!e.PathSegments)throw vs(xC);if(!e.Protocol||e.Protocol.toLowerCase()!=="https:")throw vs(k2)}static appendQueryString(e,r){return r?e.indexOf("?")<0?`${e}?${r}`:`${e}&${r}`:e}static removeHashFromUrl(e){return t.canonicalizeUri(e.split("#")[0])}replaceTenantPath(e){let r=this.getUrlComponents(),n=r.PathSegments;return e&&n.length!==0&&(n[0]===mp.COMMON||n[0]===mp.ORGANIZATIONS)&&(n[0]=e),t.constructAuthorityUriFromObject(r)}getUrlComponents(){let e=RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?"),r=this.urlString.match(e);if(!r)throw vs(xC);let n={Protocol:r[1],HostNameAndPort:r[4],AbsolutePath:r[5],QueryString:r[7]},i=n.AbsolutePath.split("/");return i=i.filter(o=>o&&o.length>0),n.PathSegments=i,n.QueryString&&n.QueryString.endsWith("/")&&(n.QueryString=n.QueryString.substring(0,n.QueryString.length-1)),n}static getDomainFromUrl(e){let r=RegExp("^([^:/?#]+://)?([^/?#]*)"),n=e.match(r);if(!n)throw vs(xC);return n[2]}static getAbsoluteUrl(e,r){if(e[0]===rt.FORWARD_SLASH){let i=new t(r).getUrlComponents();return i.Protocol+"//"+i.HostNameAndPort+e}return e}static constructAuthorityUriFromObject(e){return new t(e.Protocol+"//"+e.HostNameAndPort+"/"+e.PathSegments.join("/"))}static hashContainsKnownProperties(e){return!!nhe(e)}};var Z6e={endpointMetadata:{"login.microsoftonline.com":{token_endpoint:"https://login.microsoftonline.com/{tenantid}/oauth2/v2.0/token",jwks_uri:"https://login.microsoftonline.com/{tenantid}/discovery/v2.0/keys",issuer:"https://login.microsoftonline.com/{tenantid}/v2.0",authorization_endpoint:"https://login.microsoftonline.com/{tenantid}/oauth2/v2.0/authorize",end_session_endpoint:"https://login.microsoftonline.com/{tenantid}/oauth2/v2.0/logout"},"login.chinacloudapi.cn":{token_endpoint:"https://login.chinacloudapi.cn/{tenantid}/oauth2/v2.0/token",jwks_uri:"https://login.chinacloudapi.cn/{tenantid}/discovery/v2.0/keys",issuer:"https://login.partner.microsoftonline.cn/{tenantid}/v2.0",authorization_endpoint:"https://login.chinacloudapi.cn/{tenantid}/oauth2/v2.0/authorize",end_session_endpoint:"https://login.chinacloudapi.cn/{tenantid}/oauth2/v2.0/logout"},"login.microsoftonline.us":{token_endpoint:"https://login.microsoftonline.us/{tenantid}/oauth2/v2.0/token",jwks_uri:"https://login.microsoftonline.us/{tenantid}/discovery/v2.0/keys",issuer:"https://login.microsoftonline.us/{tenantid}/v2.0",authorization_endpoint:"https://login.microsoftonline.us/{tenantid}/oauth2/v2.0/authorize",end_session_endpoint:"https://login.microsoftonline.us/{tenantid}/oauth2/v2.0/logout"}},instanceDiscoveryMetadata:{metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]}},ihe=Z6e.endpointMetadata,ohe=Z6e.instanceDiscoveryMetadata,she=new Set;ohe.metadata.forEach(t=>{t.aliases.forEach(e=>{she.add(e)})});function eOe(t,e){let r,n=t.canonicalAuthority;if(n){let i=new Mi(n).getUrlComponents().HostNameAndPort;r=X6e(i,t.cloudDiscoveryMetadata?.metadata,hf.CONFIG,e)||X6e(i,ohe.metadata,hf.HARDCODED_VALUES,e)||t.knownAuthorities}return r||[]}s(eOe,"getAliasesFromStaticSources");function X6e(t,e,r,n){if(n?.trace(`getAliasesFromMetadata called with source: ${r}`),t&&e){let i=n6(e,t);if(i)return n?.trace(`getAliasesFromMetadata: found cloud discovery metadata in ${r}, returning aliases`),i.aliases;n?.trace(`getAliasesFromMetadata: did not find cloud discovery metadata in ${r}`)}return null}s(X6e,"getAliasesFromMetadata");function tOe(t){return n6(ohe.metadata,t)}s(tOe,"getCloudDiscoveryMetadataFromHardcodedValues");function n6(t,e){for(let r=0;r<t.length;r++){let n=t[r];if(n.aliases.includes(e))return n}return null}s(n6,"getCloudDiscoveryMetadataFromNetworkResponse");d();d();var ahe="cache_quota_exceeded",PV="cache_error_unknown";var che={[ahe]:"Exceeded cache storage capacity.",[PV]:"Unexpected error occurred when using cache storage."},i6=class t extends ai{static{s(this,"CacheError")}constructor(e,r){let n=r||(che[e]?che[e]:che[PV]);super(`${e}: ${n}`),Object.setPrototypeOf(this,t.prototype),this.name="CacheError",this.errorCode=e,this.errorMessage=n}};function rOe(t){return t instanceof Error?t.name==="QuotaExceededError"||t.name==="NS_ERROR_DOM_QUOTA_REACHED"||t.message.includes("exceeded the quota")?new i6(ahe):new i6(t.name,t.message):new i6(PV)}s(rOe,"createCacheError");var JI=class{static{s(this,"CacheManager")}constructor(e,r,n,i,o){this.clientId=e,this.cryptoImpl=r,this.commonLogger=n.clone(IV,qD),this.staticAuthorityOptions=o,this.performanceClient=i}getAllAccounts(e,r){return this.buildTenantProfiles(this.getAccountsFilteredBy(e,r),r,e)}getAccountInfoFilteredBy(e,r){let n=this.getAllAccounts(e,r);return n.length>1?n.sort(o=>o.idTokenClaims?-1:1)[0]:n.length===1?n[0]:null}getBaseAccountInfo(e,r){let n=this.getAccountsFilteredBy(e,r);return n.length>0?n[0].getAccountInfo():null}buildTenantProfiles(e,r,n){return e.flatMap(i=>this.getTenantProfilesFromAccountEntity(i,r,n?.tenantId,n))}getTenantedAccountInfoByFilter(e,r,n,i,o){let a=null,c;if(o&&!this.tenantProfileMatchesFilter(n,o))return null;let l=this.getIdToken(e,i,r,n.tenantId);return l&&(c=tx(l.secret,this.cryptoImpl.base64Decode),!this.idTokenClaimsMatchTenantProfileFilter(c,o))?null:(a=RV(e,n,c,l?.secret),a)}getTenantProfilesFromAccountEntity(e,r,n,i){let o=e.getAccountInfo(),a=o.tenantProfiles||new Map,c=this.getTokenKeys();if(n){let u=a.get(n);if(u)a=new Map([[n,u]]);else return[]}let l=[];return a.forEach(u=>{let f=this.getTenantedAccountInfoByFilter(o,c,u,r,i);f&&l.push(f)}),l}tenantProfileMatchesFilter(e,r){return!(r.localAccountId&&!this.matchLocalAccountIdFromTenantProfile(e,r.localAccountId)||r.name&&e.name!==r.name||r.isHomeTenant!==void 0&&e.isHomeTenant!==r.isHomeTenant)}idTokenClaimsMatchTenantProfileFilter(e,r){return!(r&&(r.localAccountId&&!this.matchLocalAccountIdFromTokenClaims(e,r.localAccountId)||r.loginHint&&!this.matchLoginHintFromTokenClaims(e,r.loginHint)||r.username&&!this.matchUsername(e.preferred_username,r.username)||r.name&&!this.matchName(e,r.name)||r.sid&&!this.matchSid(e,r.sid)))}async saveCacheRecord(e,r,n){if(!e)throw vt(I2);try{e.account&&await this.setAccount(e.account,r),e.idToken&&n?.idToken!==!1&&await this.setIdTokenCredential(e.idToken,r),e.accessToken&&n?.accessToken!==!1&&await this.saveAccessToken(e.accessToken,r),e.refreshToken&&n?.refreshToken!==!1&&await this.setRefreshTokenCredential(e.refreshToken,r),e.appMetadata&&this.setAppMetadata(e.appMetadata,r)}catch(i){throw this.commonLogger?.error("CacheManager.saveCacheRecord: failed"),i instanceof ai?i:rOe(i)}}async saveAccessToken(e,r){let n={clientId:e.clientId,credentialType:e.credentialType,environment:e.environment,homeAccountId:e.homeAccountId,realm:e.realm,tokenType:e.tokenType,requestedClaimsHash:e.requestedClaimsHash},i=this.getTokenKeys(),o=nl.fromString(e.target);i.accessToken.forEach(a=>{if(!this.accessTokenKeyMatchesFilter(a,n,!1))return;let c=this.getAccessTokenCredential(a,r);c&&this.credentialMatchesFilter(c,n)&&nl.fromString(c.target).intersectingScopeSets(o)&&this.removeAccessToken(a,r)}),await this.setAccessTokenCredential(e,r)}getAccountsFilteredBy(e,r){let n=this.getAccountKeys(),i=[];return n.forEach(o=>{if(!this.isAccountKey(o,e.homeAccountId))return;let a=this.getAccount(o,r);if(!a||e.homeAccountId&&!this.matchHomeAccountId(a,e.homeAccountId)||e.username&&!this.matchUsername(a.username,e.username)||e.environment&&!this.matchEnvironment(a,e.environment)||e.realm&&!this.matchRealm(a,e.realm)||e.nativeAccountId&&!this.matchNativeAccountId(a,e.nativeAccountId)||e.authorityType&&!this.matchAuthorityType(a,e.authorityType))return;let c={localAccountId:e?.localAccountId,name:e?.name},l=a.tenantProfiles?.filter(u=>this.tenantProfileMatchesFilter(u,c));l&&l.length===0||i.push(a)}),i}isAccountKey(e,r,n){return!(e.split(lc.CACHE_KEY_SEPARATOR).length<3||r&&!e.toLowerCase().includes(r.toLowerCase())||n&&!e.toLowerCase().includes(n.toLowerCase()))}isCredentialKey(e){if(e.split(lc.CACHE_KEY_SEPARATOR).length<6)return!1;let r=e.toLowerCase();if(r.indexOf(_o.ID_TOKEN.toLowerCase())===-1&&r.indexOf(_o.ACCESS_TOKEN.toLowerCase())===-1&&r.indexOf(_o.ACCESS_TOKEN_WITH_AUTH_SCHEME.toLowerCase())===-1&&r.indexOf(_o.REFRESH_TOKEN.toLowerCase())===-1)return!1;if(r.indexOf(_o.REFRESH_TOKEN.toLowerCase())>-1){let n=`${_o.REFRESH_TOKEN}${lc.CACHE_KEY_SEPARATOR}${this.clientId}${lc.CACHE_KEY_SEPARATOR}`,i=`${_o.REFRESH_TOKEN}${lc.CACHE_KEY_SEPARATOR}${Kv}${lc.CACHE_KEY_SEPARATOR}`;if(r.indexOf(n.toLowerCase())===-1&&r.indexOf(i.toLowerCase())===-1)return!1}else if(r.indexOf(this.clientId.toLowerCase())===-1)return!1;return!0}credentialMatchesFilter(e,r){return!(r.clientId&&!this.matchClientId(e,r.clientId)||r.userAssertionHash&&!this.matchUserAssertionHash(e,r.userAssertionHash)||typeof r.homeAccountId=="string"&&!this.matchHomeAccountId(e,r.homeAccountId)||r.environment&&!this.matchEnvironment(e,r.environment)||r.realm&&!this.matchRealm(e,r.realm)||r.credentialType&&!this.matchCredentialType(e,r.credentialType)||r.familyId&&!this.matchFamilyId(e,r.familyId)||r.target&&!this.matchTarget(e,r.target)||(r.requestedClaimsHash||e.requestedClaimsHash)&&e.requestedClaimsHash!==r.requestedClaimsHash||e.credentialType===_o.ACCESS_TOKEN_WITH_AUTH_SCHEME&&(r.tokenType&&!this.matchTokenType(e,r.tokenType)||r.tokenType===lo.SSH&&r.keyId&&!this.matchKeyId(e,r.keyId)))}getAppMetadataFilteredBy(e){let r=this.getKeys(),n={};return r.forEach(i=>{if(!this.isAppMetadata(i))return;let o=this.getAppMetadata(i);o&&(e.environment&&!this.matchEnvironment(o,e.environment)||e.clientId&&!this.matchClientId(o,e.clientId)||(n[i]=o))}),n}getAuthorityMetadataByAlias(e){let r=this.getAuthorityMetadataKeys(),n=null;return r.forEach(i=>{if(!this.isAuthorityMetadata(i)||i.indexOf(this.clientId)===-1)return;let o=this.getAuthorityMetadata(i);o&&o.aliases.indexOf(e)!==-1&&(n=o)}),n}removeAllAccounts(e){this.getAccountKeys().forEach(n=>{this.removeAccount(n,e)})}removeAccount(e,r){let n=this.getAccount(e,r);n&&(this.removeAccountContext(n,r),this.removeItem(e,r))}removeAccountContext(e,r){let n=this.getTokenKeys(),i=e.generateAccountId();n.idToken.forEach(o=>{o.indexOf(i)===0&&this.removeIdToken(o,r)}),n.accessToken.forEach(o=>{o.indexOf(i)===0&&this.removeAccessToken(o,r)}),n.refreshToken.forEach(o=>{o.indexOf(i)===0&&this.removeRefreshToken(o,r)})}removeAccessToken(e,r){let n=this.getAccessTokenCredential(e,r);if(this.removeItem(e,r),this.performanceClient.incrementFields({accessTokensRemoved:1},r),!n||n.credentialType.toLowerCase()!==_o.ACCESS_TOKEN_WITH_AUTH_SCHEME.toLowerCase()||n.tokenType!==lo.POP)return;let i=n.keyId;i&&this.cryptoImpl.removeTokenBindingKey(i).catch(()=>{this.commonLogger.error(`Failed to remove token binding key ${i}`,r),this.performanceClient?.incrementFields({removeTokenBindingKeyFailure:1},r)})}removeAppMetadata(e){return this.getKeys().forEach(n=>{this.isAppMetadata(n)&&this.removeItem(n,e)}),!0}readAccountFromCache(e,r){let n=Vu.generateAccountCacheKey(e);return this.getAccount(n,r)}getIdToken(e,r,n,i,o){this.commonLogger.trace("CacheManager - getIdToken called");let a={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:_o.ID_TOKEN,clientId:this.clientId,realm:i},c=this.getIdTokensByFilter(a,r,n),l=c.size;if(l<1)return this.commonLogger.info("CacheManager:getIdToken - No token found"),null;if(l>1){let u=c;if(!i){let f=new Map;c.forEach((m,h)=>{m.realm===e.tenantId&&f.set(h,m)});let p=f.size;if(p<1)return this.commonLogger.info("CacheManager:getIdToken - Multiple ID tokens found for account but none match account entity tenant id, returning first result"),c.values().next().value;if(p===1)return this.commonLogger.info("CacheManager:getIdToken - Multiple ID tokens found for account, defaulting to home tenant profile"),f.values().next().value;u=f}return this.commonLogger.info("CacheManager:getIdToken - Multiple matching ID tokens found, clearing them"),u.forEach((f,p)=>{this.removeIdToken(p,r)}),o&&r&&o.addFields({multiMatchedID:c.size},r),null}return this.commonLogger.info("CacheManager:getIdToken - Returning ID token"),c.values().next().value}getIdTokensByFilter(e,r,n){let i=n&&n.idToken||this.getTokenKeys().idToken,o=new Map;return i.forEach(a=>{if(!this.idTokenKeyMatchesFilter(a,{clientId:this.clientId,...e}))return;let c=this.getIdTokenCredential(a,r);c&&this.credentialMatchesFilter(c,e)&&o.set(a,c)}),o}idTokenKeyMatchesFilter(e,r){let n=e.toLowerCase();return!(r.clientId&&n.indexOf(r.clientId.toLowerCase())===-1||r.homeAccountId&&n.indexOf(r.homeAccountId.toLowerCase())===-1)}removeIdToken(e,r){this.removeItem(e,r)}removeRefreshToken(e,r){this.removeItem(e,r)}getAccessToken(e,r,n,i){let o=r.correlationId;this.commonLogger.trace("CacheManager - getAccessToken called",o);let a=nl.createSearchScopes(r.scopes),c=r.authenticationScheme||lo.BEARER,l=c&&c.toLowerCase()!==lo.BEARER.toLowerCase()?_o.ACCESS_TOKEN_WITH_AUTH_SCHEME:_o.ACCESS_TOKEN,u={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:l,clientId:this.clientId,realm:i||e.tenantId,target:a,tokenType:c,keyId:r.sshKid,requestedClaimsHash:r.requestedClaimsHash},f=n&&n.accessToken||this.getTokenKeys().accessToken,p=[];f.forEach(h=>{if(this.accessTokenKeyMatchesFilter(h,u,!0)){let g=this.getAccessTokenCredential(h,o);g&&this.credentialMatchesFilter(g,u)&&p.push(g)}});let m=p.length;return m<1?(this.commonLogger.info("CacheManager:getAccessToken - No token found",o),null):m>1?(this.commonLogger.info("CacheManager:getAccessToken - Multiple access tokens found, clearing them",o),p.forEach(h=>{this.removeAccessToken(G9(h),o)}),this.performanceClient.addFields({multiMatchedAT:p.length},o),null):(this.commonLogger.info("CacheManager:getAccessToken - Returning access token",o),p[0])}accessTokenKeyMatchesFilter(e,r,n){let i=e.toLowerCase();if(r.clientId&&i.indexOf(r.clientId.toLowerCase())===-1||r.homeAccountId&&i.indexOf(r.homeAccountId.toLowerCase())===-1||r.realm&&i.indexOf(r.realm.toLowerCase())===-1||r.requestedClaimsHash&&i.indexOf(r.requestedClaimsHash.toLowerCase())===-1)return!1;if(r.target){let o=r.target.asArray();for(let a=0;a<o.length;a++){if(n&&!i.includes(o[a].toLowerCase()))return!1;if(!n&&i.includes(o[a].toLowerCase()))return!0}}return!0}getAccessTokensByFilter(e,r){let n=this.getTokenKeys(),i=[];return n.accessToken.forEach(o=>{if(!this.accessTokenKeyMatchesFilter(o,e,!0))return;let a=this.getAccessTokenCredential(o,r);a&&this.credentialMatchesFilter(a,e)&&i.push(a)}),i}getRefreshToken(e,r,n,i,o){this.commonLogger.trace("CacheManager - getRefreshToken called");let a=r?Kv:void 0,c={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:_o.REFRESH_TOKEN,clientId:this.clientId,familyId:a},l=i&&i.refreshToken||this.getTokenKeys().refreshToken,u=[];l.forEach(p=>{if(this.refreshTokenKeyMatchesFilter(p,c)){let m=this.getRefreshTokenCredential(p,n);m&&this.credentialMatchesFilter(m,c)&&u.push(m)}});let f=u.length;return f<1?(this.commonLogger.info("CacheManager:getRefreshToken - No refresh token found."),null):(f>1&&o&&n&&o.addFields({multiMatchedRT:f},n),this.commonLogger.info("CacheManager:getRefreshToken - returning refresh token"),u[0])}refreshTokenKeyMatchesFilter(e,r){let n=e.toLowerCase();return!(r.familyId&&n.indexOf(r.familyId.toLowerCase())===-1||!r.familyId&&r.clientId&&n.indexOf(r.clientId.toLowerCase())===-1||r.homeAccountId&&n.indexOf(r.homeAccountId.toLowerCase())===-1)}readAppMetadataFromCache(e){let r={environment:e,clientId:this.clientId},n=this.getAppMetadataFilteredBy(r),i=Object.keys(n).map(a=>n[a]),o=i.length;if(o<1)return null;if(o>1)throw vt(v2);return i[0]}isAppMetadataFOCI(e){let r=this.readAppMetadataFromCache(e);return!!(r&&r.familyId===Kv)}matchHomeAccountId(e,r){return typeof e.homeAccountId=="string"&&r===e.homeAccountId}matchLocalAccountIdFromTokenClaims(e,r){let n=e.oid||e.sub;return r===n}matchLocalAccountIdFromTenantProfile(e,r){return e.localAccountId===r}matchName(e,r){return r.toLowerCase()===e.name?.toLowerCase()}matchUsername(e,r){return!!(e&&typeof e=="string"&&r?.toLowerCase()===e.toLowerCase())}matchUserAssertionHash(e,r){return!!(e.userAssertionHash&&r===e.userAssertionHash)}matchEnvironment(e,r){if(this.staticAuthorityOptions){let i=eOe(this.staticAuthorityOptions,this.commonLogger);if(i.includes(r)&&i.includes(e.environment))return!0}let n=this.getAuthorityMetadataByAlias(r);return!!(n&&n.aliases.indexOf(e.environment)>-1)}matchCredentialType(e,r){return e.credentialType&&r.toLowerCase()===e.credentialType.toLowerCase()}matchClientId(e,r){return!!(e.clientId&&r===e.clientId)}matchFamilyId(e,r){return!!(e.familyId&&r===e.familyId)}matchRealm(e,r){return e.realm?.toLowerCase()===r.toLowerCase()}matchNativeAccountId(e,r){return!!(e.nativeAccountId&&r===e.nativeAccountId)}matchLoginHintFromTokenClaims(e,r){return e.login_hint===r||e.preferred_username===r||e.upn===r}matchSid(e,r){return e.sid===r}matchAuthorityType(e,r){return!!(e.authorityType&&r.toLowerCase()===e.authorityType.toLowerCase())}matchTarget(e,r){return e.credentialType!==_o.ACCESS_TOKEN&&e.credentialType!==_o.ACCESS_TOKEN_WITH_AUTH_SCHEME||!e.target?!1:nl.fromString(e.target).containsScopeSet(r)}matchTokenType(e,r){return!!(e.tokenType&&e.tokenType===r)}matchKeyId(e,r){return!!(e.keyId&&e.keyId===r)}isAppMetadata(e){return e.indexOf(I9)!==-1}isAuthorityMetadata(e){return e.indexOf(FD.CACHE_KEY)!==-1}generateAuthorityMetadataCacheKey(e){return`${FD.CACHE_KEY}-${this.clientId}-${e}`}static toObject(e,r){for(let n in r)e[n]=r[n];return e}},o6=class extends JI{static{s(this,"DefaultStorageClass")}async setAccount(){throw vt(Ni)}getAccount(){throw vt(Ni)}async setIdTokenCredential(){throw vt(Ni)}getIdTokenCredential(){throw vt(Ni)}async setAccessTokenCredential(){throw vt(Ni)}getAccessTokenCredential(){throw vt(Ni)}async setRefreshTokenCredential(){throw vt(Ni)}getRefreshTokenCredential(){throw vt(Ni)}setAppMetadata(){throw vt(Ni)}getAppMetadata(){throw vt(Ni)}setServerTelemetry(){throw vt(Ni)}getServerTelemetry(){throw vt(Ni)}setAuthorityMetadata(){throw vt(Ni)}getAuthorityMetadata(){throw vt(Ni)}getAuthorityMetadataKeys(){throw vt(Ni)}setThrottlingCache(){throw vt(Ni)}getThrottlingCache(){throw vt(Ni)}removeItem(){throw vt(Ni)}getKeys(){throw vt(Ni)}getAccountKeys(){throw vt(Ni)}getTokenKeys(){throw vt(Ni)}};d();d();var Ye={AcquireTokenByCode:"acquireTokenByCode",AcquireTokenByRefreshToken:"acquireTokenByRefreshToken",AcquireTokenSilent:"acquireTokenSilent",AcquireTokenSilentAsync:"acquireTokenSilentAsync",AcquireTokenPopup:"acquireTokenPopup",AcquireTokenPreRedirect:"acquireTokenPreRedirect",AcquireTokenRedirect:"acquireTokenRedirect",CryptoOptsGetPublicKeyThumbprint:"cryptoOptsGetPublicKeyThumbprint",CryptoOptsSignJwt:"cryptoOptsSignJwt",SilentCacheClientAcquireToken:"silentCacheClientAcquireToken",SilentIframeClientAcquireToken:"silentIframeClientAcquireToken",AwaitConcurrentIframe:"awaitConcurrentIframe",SilentRefreshClientAcquireToken:"silentRefreshClientAcquireToken",SsoSilent:"ssoSilent",StandardInteractionClientGetDiscoveredAuthority:"standardInteractionClientGetDiscoveredAuthority",FetchAccountIdWithNativeBroker:"fetchAccountIdWithNativeBroker",NativeInteractionClientAcquireToken:"nativeInteractionClientAcquireToken",BaseClientCreateTokenRequestHeaders:"baseClientCreateTokenRequestHeaders",NetworkClientSendPostRequestAsync:"networkClientSendPostRequestAsync",RefreshTokenClientExecutePostToTokenEndpoint:"refreshTokenClientExecutePostToTokenEndpoint",AuthorizationCodeClientExecutePostToTokenEndpoint:"authorizationCodeClientExecutePostToTokenEndpoint",BrokerHandhshake:"brokerHandshake",AcquireTokenByRefreshTokenInBroker:"acquireTokenByRefreshTokenInBroker",AcquireTokenByBroker:"acquireTokenByBroker",RefreshTokenClientExecuteTokenRequest:"refreshTokenClientExecuteTokenRequest",RefreshTokenClientAcquireToken:"refreshTokenClientAcquireToken",RefreshTokenClientAcquireTokenWithCachedRefreshToken:"refreshTokenClientAcquireTokenWithCachedRefreshToken",RefreshTokenClientAcquireTokenByRefreshToken:"refreshTokenClientAcquireTokenByRefreshToken",RefreshTokenClientCreateTokenRequestBody:"refreshTokenClientCreateTokenRequestBody",AcquireTokenFromCache:"acquireTokenFromCache",SilentFlowClientAcquireCachedToken:"silentFlowClientAcquireCachedToken",SilentFlowClientGenerateResultFromCacheRecord:"silentFlowClientGenerateResultFromCacheRecord",AcquireTokenBySilentIframe:"acquireTokenBySilentIframe",InitializeBaseRequest:"initializeBaseRequest",InitializeSilentRequest:"initializeSilentRequest",InitializeClientApplication:"initializeClientApplication",InitializeCache:"initializeCache",SilentIframeClientTokenHelper:"silentIframeClientTokenHelper",SilentHandlerInitiateAuthRequest:"silentHandlerInitiateAuthRequest",SilentHandlerMonitorIframeForHash:"silentHandlerMonitorIframeForHash",SilentHandlerLoadFrame:"silentHandlerLoadFrame",SilentHandlerLoadFrameSync:"silentHandlerLoadFrameSync",StandardInteractionClientCreateAuthCodeClient:"standardInteractionClientCreateAuthCodeClient",StandardInteractionClientGetClientConfiguration:"standardInteractionClientGetClientConfiguration",StandardInteractionClientInitializeAuthorizationRequest:"standardInteractionClientInitializeAuthorizationRequest",GetAuthCodeUrl:"getAuthCodeUrl",GetStandardParams:"getStandardParams",HandleCodeResponseFromServer:"handleCodeResponseFromServer",HandleCodeResponse:"handleCodeResponse",HandleResponseEar:"handleResponseEar",HandleResponsePlatformBroker:"handleResponsePlatformBroker",HandleResponseCode:"handleResponseCode",UpdateTokenEndpointAuthority:"updateTokenEndpointAuthority",AuthClientAcquireToken:"authClientAcquireToken",AuthClientExecuteTokenRequest:"authClientExecuteTokenRequest",AuthClientCreateTokenRequestBody:"authClientCreateTokenRequestBody",PopTokenGenerateCnf:"popTokenGenerateCnf",PopTokenGenerateKid:"popTokenGenerateKid",HandleServerTokenResponse:"handleServerTokenResponse",DeserializeResponse:"deserializeResponse",AuthorityFactoryCreateDiscoveredInstance:"authorityFactoryCreateDiscoveredInstance",AuthorityResolveEndpointsAsync:"authorityResolveEndpointsAsync",AuthorityResolveEndpointsFromLocalSources:"authorityResolveEndpointsFromLocalSources",AuthorityGetCloudDiscoveryMetadataFromNetwork:"authorityGetCloudDiscoveryMetadataFromNetwork",AuthorityUpdateCloudDiscoveryMetadata:"authorityUpdateCloudDiscoveryMetadata",AuthorityGetEndpointMetadataFromNetwork:"authorityGetEndpointMetadataFromNetwork",AuthorityUpdateEndpointMetadata:"authorityUpdateEndpointMetadata",AuthorityUpdateMetadataWithRegionalInformation:"authorityUpdateMetadataWithRegionalInformation",RegionDiscoveryDetectRegion:"regionDiscoveryDetectRegion",RegionDiscoveryGetRegionFromIMDS:"regionDiscoveryGetRegionFromIMDS",RegionDiscoveryGetCurrentVersion:"regionDiscoveryGetCurrentVersion",AcquireTokenByCodeAsync:"acquireTokenByCodeAsync",GetEndpointMetadataFromNetwork:"getEndpointMetadataFromNetwork",GetCloudDiscoveryMetadataFromNetworkMeasurement:"getCloudDiscoveryMetadataFromNetworkMeasurement",HandleRedirectPromiseMeasurement:"handleRedirectPromise",HandleNativeRedirectPromiseMeasurement:"handleNativeRedirectPromise",UpdateCloudDiscoveryMetadataMeasurement:"updateCloudDiscoveryMetadataMeasurement",UsernamePasswordClientAcquireToken:"usernamePasswordClientAcquireToken",NativeMessageHandlerHandshake:"nativeMessageHandlerHandshake",NativeGenerateAuthResult:"nativeGenerateAuthResult",RemoveHiddenIframe:"removeHiddenIframe",ClearTokensAndKeysWithClaims:"clearTokensAndKeysWithClaims",CacheManagerGetRefreshToken:"cacheManagerGetRefreshToken",ImportExistingCache:"importExistingCache",SetUserData:"setUserData",LocalStorageUpdated:"localStorageUpdated",GeneratePkceCodes:"generatePkceCodes",GenerateCodeVerifier:"generateCodeVerifier",GenerateCodeChallengeFromVerifier:"generateCodeChallengeFromVerifier",Sha256Digest:"sha256Digest",GetRandomValues:"getRandomValues",GenerateHKDF:"generateHKDF",GenerateBaseKey:"generateBaseKey",Base64Decode:"base64Decode",UrlEncodeArr:"urlEncodeArr",Encrypt:"encrypt",Decrypt:"decrypt",GenerateEarKey:"generateEarKey",DecryptEarResponse:"decryptEarResponse"},sen=new Map([[Ye.AcquireTokenByCode,"ATByCode"],[Ye.AcquireTokenByRefreshToken,"ATByRT"],[Ye.AcquireTokenSilent,"ATS"],[Ye.AcquireTokenSilentAsync,"ATSAsync"],[Ye.AcquireTokenPopup,"ATPopup"],[Ye.AcquireTokenRedirect,"ATRedirect"],[Ye.CryptoOptsGetPublicKeyThumbprint,"CryptoGetPKThumb"],[Ye.CryptoOptsSignJwt,"CryptoSignJwt"],[Ye.SilentCacheClientAcquireToken,"SltCacheClientAT"],[Ye.SilentIframeClientAcquireToken,"SltIframeClientAT"],[Ye.SilentRefreshClientAcquireToken,"SltRClientAT"],[Ye.SsoSilent,"SsoSlt"],[Ye.StandardInteractionClientGetDiscoveredAuthority,"StdIntClientGetDiscAuth"],[Ye.FetchAccountIdWithNativeBroker,"FetchAccIdWithNtvBroker"],[Ye.NativeInteractionClientAcquireToken,"NtvIntClientAT"],[Ye.BaseClientCreateTokenRequestHeaders,"BaseClientCreateTReqHead"],[Ye.NetworkClientSendPostRequestAsync,"NetClientSendPost"],[Ye.RefreshTokenClientExecutePostToTokenEndpoint,"RTClientExecPost"],[Ye.AuthorizationCodeClientExecutePostToTokenEndpoint,"AuthCodeClientExecPost"],[Ye.BrokerHandhshake,"BrokerHandshake"],[Ye.AcquireTokenByRefreshTokenInBroker,"ATByRTInBroker"],[Ye.AcquireTokenByBroker,"ATByBroker"],[Ye.RefreshTokenClientExecuteTokenRequest,"RTClientExecTReq"],[Ye.RefreshTokenClientAcquireToken,"RTClientAT"],[Ye.RefreshTokenClientAcquireTokenWithCachedRefreshToken,"RTClientATWithCachedRT"],[Ye.RefreshTokenClientAcquireTokenByRefreshToken,"RTClientATByRT"],[Ye.RefreshTokenClientCreateTokenRequestBody,"RTClientCreateTReqBody"],[Ye.AcquireTokenFromCache,"ATFromCache"],[Ye.SilentFlowClientAcquireCachedToken,"SltFlowClientATCached"],[Ye.SilentFlowClientGenerateResultFromCacheRecord,"SltFlowClientGenResFromCache"],[Ye.AcquireTokenBySilentIframe,"ATBySltIframe"],[Ye.InitializeBaseRequest,"InitBaseReq"],[Ye.InitializeSilentRequest,"InitSltReq"],[Ye.InitializeClientApplication,"InitClientApplication"],[Ye.InitializeCache,"InitCache"],[Ye.ImportExistingCache,"importCache"],[Ye.SetUserData,"setUserData"],[Ye.LocalStorageUpdated,"localStorageUpdated"],[Ye.SilentIframeClientTokenHelper,"SIClientTHelper"],[Ye.SilentHandlerInitiateAuthRequest,"SHandlerInitAuthReq"],[Ye.SilentHandlerMonitorIframeForHash,"SltHandlerMonitorIframeForHash"],[Ye.SilentHandlerLoadFrame,"SHandlerLoadFrame"],[Ye.SilentHandlerLoadFrameSync,"SHandlerLoadFrameSync"],[Ye.StandardInteractionClientCreateAuthCodeClient,"StdIntClientCreateAuthCodeClient"],[Ye.StandardInteractionClientGetClientConfiguration,"StdIntClientGetClientConf"],[Ye.StandardInteractionClientInitializeAuthorizationRequest,"StdIntClientInitAuthReq"],[Ye.GetAuthCodeUrl,"GetAuthCodeUrl"],[Ye.HandleCodeResponseFromServer,"HandleCodeResFromServer"],[Ye.HandleCodeResponse,"HandleCodeResp"],[Ye.HandleResponseEar,"HandleRespEar"],[Ye.HandleResponseCode,"HandleRespCode"],[Ye.HandleResponsePlatformBroker,"HandleRespPlatBroker"],[Ye.UpdateTokenEndpointAuthority,"UpdTEndpointAuth"],[Ye.AuthClientAcquireToken,"AuthClientAT"],[Ye.AuthClientExecuteTokenRequest,"AuthClientExecTReq"],[Ye.AuthClientCreateTokenRequestBody,"AuthClientCreateTReqBody"],[Ye.PopTokenGenerateCnf,"PopTGenCnf"],[Ye.PopTokenGenerateKid,"PopTGenKid"],[Ye.HandleServerTokenResponse,"HandleServerTRes"],[Ye.DeserializeResponse,"DeserializeRes"],[Ye.AuthorityFactoryCreateDiscoveredInstance,"AuthFactCreateDiscInst"],[Ye.AuthorityResolveEndpointsAsync,"AuthResolveEndpointsAsync"],[Ye.AuthorityResolveEndpointsFromLocalSources,"AuthResolveEndpointsFromLocal"],[Ye.AuthorityGetCloudDiscoveryMetadataFromNetwork,"AuthGetCDMetaFromNet"],[Ye.AuthorityUpdateCloudDiscoveryMetadata,"AuthUpdCDMeta"],[Ye.AuthorityGetEndpointMetadataFromNetwork,"AuthUpdCDMetaFromNet"],[Ye.AuthorityUpdateEndpointMetadata,"AuthUpdEndpointMeta"],[Ye.AuthorityUpdateMetadataWithRegionalInformation,"AuthUpdMetaWithRegInfo"],[Ye.RegionDiscoveryDetectRegion,"RegDiscDetectReg"],[Ye.RegionDiscoveryGetRegionFromIMDS,"RegDiscGetRegFromIMDS"],[Ye.RegionDiscoveryGetCurrentVersion,"RegDiscGetCurrentVer"],[Ye.AcquireTokenByCodeAsync,"ATByCodeAsync"],[Ye.GetEndpointMetadataFromNetwork,"GetEndpointMetaFromNet"],[Ye.GetCloudDiscoveryMetadataFromNetworkMeasurement,"GetCDMetaFromNet"],[Ye.HandleRedirectPromiseMeasurement,"HandleRedirectPromise"],[Ye.HandleNativeRedirectPromiseMeasurement,"HandleNtvRedirectPromise"],[Ye.UpdateCloudDiscoveryMetadataMeasurement,"UpdateCDMeta"],[Ye.UsernamePasswordClientAcquireToken,"UserPassClientAT"],[Ye.NativeMessageHandlerHandshake,"NtvMsgHandlerHandshake"],[Ye.NativeGenerateAuthResult,"NtvGenAuthRes"],[Ye.RemoveHiddenIframe,"RemoveHiddenIframe"],[Ye.ClearTokensAndKeysWithClaims,"ClearTAndKeysWithClaims"],[Ye.CacheManagerGetRefreshToken,"CacheManagerGetRT"],[Ye.GeneratePkceCodes,"GenPkceCodes"],[Ye.GenerateCodeVerifier,"GenCodeVerifier"],[Ye.GenerateCodeChallengeFromVerifier,"GenCodeChallengeFromVerifier"],[Ye.Sha256Digest,"Sha256Digest"],[Ye.GetRandomValues,"GetRandomValues"],[Ye.GenerateHKDF,"genHKDF"],[Ye.GenerateBaseKey,"genBaseKey"],[Ye.Base64Decode,"b64Decode"],[Ye.UrlEncodeArr,"urlEncArr"],[Ye.Encrypt,"encrypt"],[Ye.Decrypt,"decrypt"],[Ye.GenerateEarKey,"genEarKey"],[Ye.DecryptEarResponse,"decryptEarResp"]]),nOe={NotStarted:0,InProgress:1,Completed:2};var DV=class{static{s(this,"StubPerformanceMeasurement")}startMeasurement(){}endMeasurement(){}flushMeasurement(){return null}},O2=class{static{s(this,"StubPerformanceClient")}generateId(){return"callback-id"}startMeasurement(e,r){return{end:s(()=>null,"end"),discard:s(()=>{},"discard"),add:s(()=>{},"add"),increment:s(()=>{},"increment"),event:{eventId:this.generateId(),status:nOe.InProgress,authority:"",libraryName:"",libraryVersion:"",clientId:"",name:e,startTimeMs:Date.now(),correlationId:r||""},measurement:new DV}}startPerformanceMeasurement(){return new DV}calculateQueuedTime(){return 0}addQueueMeasurement(){}setPreQueueTime(){}endMeasurement(){return null}discardMeasurements(){}removePerformanceCallback(){return!0}addPerformanceCallback(){return""}emitEvents(){}addFields(){}incrementFields(){}cacheEventByCorrelationId(){}};var yDt={tokenRenewalOffsetSeconds:OD,preventCorsPreflight:!1},CDt={loggerCallback:s(()=>{},"loggerCallback"),piiLoggingEnabled:!1,logLevel:Ya.Info,correlationId:rt.EMPTY_STRING},vDt={claimsBasedCachingEnabled:!1},xDt={async sendGetRequestAsync(){throw vt(Ni)},async sendPostRequestAsync(){throw vt(Ni)}},EDt={sku:rt.SKU,version:qD,cpu:rt.EMPTY_STRING,os:rt.EMPTY_STRING},bDt={clientSecret:rt.EMPTY_STRING,clientAssertion:void 0},IDt={azureCloudInstance:ex.None,tenant:`${rt.DEFAULT_COMMON_TENANT}`},TDt={application:{appName:"",appVersion:""}};function iOe({authOptions:t,systemOptions:e,loggerOptions:r,cacheOptions:n,storageInterface:i,networkInterface:o,cryptoInterface:a,clientCredentials:c,libraryInfo:l,telemetry:u,serverTelemetryManager:f,persistencePlugin:p,serializableCache:m}){let h={...CDt,...r};return{authOptions:wDt(t),systemOptions:{...yDt,...e},loggerOptions:h,cacheOptions:{...vDt,...n},storageInterface:i||new o6(t.clientId,UD,new R0(h),new O2),networkInterface:o||xDt,cryptoInterface:a||UD,clientCredentials:c||bDt,libraryInfo:{...EDt,...l},telemetry:{...TDt,...u},serverTelemetryManager:f||null,persistencePlugin:p||null,serializableCache:m||null}}s(iOe,"buildClientConfiguration");function wDt(t){return{clientCapabilities:[],azureCloudOptions:IDt,skipAuthorityMetadataCache:!1,instanceAware:!1,encodeExtraQueryParams:!1,...t}}s(wDt,"buildAuthOptions");function BV(t){return t.authOptions.authority.options.protocolMode===Ld.OIDC}s(BV,"isOidcProtocolMode");d();var Af={HOME_ACCOUNT_ID:"home_account_id",UPN:"UPN"};var hr={};Ia(hr,{addApplicationTelemetry:()=>c6,addAuthorizationCode:()=>Zhe,addBrokerParameters:()=>ox,addCcsOid:()=>nx,addCcsUpn:()=>XI,addClaims:()=>W2,addClientAssertion:()=>d6,addClientAssertionType:()=>f6,addClientCapabilitiesToClaims:()=>oOe,addClientId:()=>H2,addClientInfo:()=>G2,addClientSecret:()=>u6,addCodeChallengeParams:()=>qDt,addCodeVerifier:()=>tge,addCorrelationId:()=>j2,addDeviceCode:()=>HDt,addDomainHint:()=>Yhe,addEARParameters:()=>VDt,addExtraQueryParameters:()=>ix,addGrantType:()=>p6,addIdTokenHint:()=>Khe,addInstanceAware:()=>m6,addLibraryInfo:()=>a6,addLoginHint:()=>zD,addLogoutHint:()=>rge,addNativeBroker:()=>UDt,addNonce:()=>Xhe,addOboAssertion:()=>$Dt,addPassword:()=>GDt,addPopToken:()=>h6,addPostLogoutRedirectUri:()=>zhe,addPrompt:()=>Jhe,addRedirectUri:()=>$2,addRefreshToken:()=>ege,addRequestTokenUse:()=>WDt,addResponseMode:()=>Vhe,addResponseType:()=>QDt,addScopes:()=>q2,addServerTelemetry:()=>A6,addSid:()=>QV,addSshJwk:()=>g6,addState:()=>l6,addThrottling:()=>y6,addUsername:()=>jDt,instrumentBrokerParams:()=>U2});d();var Q2={};Ia(Q2,{ACCESS_TOKEN:()=>RDt,BROKER_CLIENT_ID:()=>s6,BROKER_REDIRECT_URI:()=>OV,CCS_HEADER:()=>FDt,CLAIMS:()=>fhe,CLIENT_ASSERTION:()=>Lhe,CLIENT_ASSERTION_TYPE:()=>Fhe,CLIENT_ID:()=>IC,CLIENT_INFO:()=>NDt,CLIENT_REQUEST_ID:()=>Ehe,CLIENT_SECRET:()=>Mhe,CODE:()=>yhe,CODE_CHALLENGE:()=>Che,CODE_CHALLENGE_METHOD:()=>vhe,CODE_VERIFIER:()=>xhe,DEVICE_CODE:()=>Nhe,DOMAIN_HINT:()=>Whe,EAR_JWE_CRYPTO:()=>Ghe,EAR_JWK:()=>jhe,ERROR:()=>SDt,ERROR_DESCRIPTION:()=>_Dt,EXPIRES_IN:()=>PDt,FOCI:()=>LDt,GRANT_TYPE:()=>dhe,ID_TOKEN:()=>kDt,ID_TOKEN_HINT:()=>Bhe,INSTANCE_AWARE:()=>VD,LOGIN_HINT:()=>$he,LOGOUT_HINT:()=>qhe,NATIVE_BROKER:()=>Uhe,NONCE:()=>ghe,OBO_ASSERTION:()=>Ohe,ON_BEHALF_OF:()=>MDt,POST_LOGOUT_URI:()=>Dhe,PROMPT:()=>Ahe,REDIRECT_URI:()=>NV,REFRESH_TOKEN:()=>mhe,REFRESH_TOKEN_EXPIRES_IN:()=>DDt,REQUESTED_TOKEN_USE:()=>Qhe,REQ_CNF:()=>LV,RESPONSE_MODE:()=>uhe,RESPONSE_TYPE:()=>lhe,RETURN_SPA_CODE:()=>FV,SCOPE:()=>phe,SESSION_STATE:()=>BDt,SID:()=>Hhe,STATE:()=>hhe,TOKEN_TYPE:()=>MV,X_APP_NAME:()=>khe,X_APP_VER:()=>Phe,X_CLIENT_CPU:()=>whe,X_CLIENT_CURR_TELEM:()=>She,X_CLIENT_EXTRA_SKU:()=>ODt,X_CLIENT_LAST_TELEM:()=>_he,X_CLIENT_OS:()=>The,X_CLIENT_SKU:()=>bhe,X_CLIENT_VER:()=>Ihe,X_MS_LIB_CAPABILITY:()=>Rhe});d();var IC="client_id",NV="redirect_uri",lhe="response_type",uhe="response_mode",dhe="grant_type",fhe="claims",phe="scope",SDt="error",_Dt="error_description",RDt="access_token",kDt="id_token",mhe="refresh_token",PDt="expires_in",DDt="refresh_token_expires_in",hhe="state",ghe="nonce",Ahe="prompt",BDt="session_state",NDt="client_info",yhe="code",Che="code_challenge",vhe="code_challenge_method",xhe="code_verifier",Ehe="client-request-id",bhe="x-client-SKU",Ihe="x-client-VER",The="x-client-OS",whe="x-client-CPU",She="x-client-current-telemetry",_he="x-client-last-telemetry",Rhe="x-ms-lib-capability",khe="x-app-name",Phe="x-app-ver",Dhe="post_logout_redirect_uri",Bhe="id_token_hint",Nhe="device_code",Mhe="client_secret",Lhe="client_assertion",Fhe="client_assertion_type",MV="token_type",LV="req_cnf",Ohe="assertion",Qhe="requested_token_use",MDt="on_behalf_of",LDt="foci",FDt="X-AnchorMailbox",FV="return_spa_code",Uhe="nativebroker",qhe="logout_hint",Hhe="sid",$he="login_hint",Whe="domain_hint",ODt="x-client-xtra-sku",s6="brk_client_id",OV="brk_redirect_uri",VD="instance_aware",jhe="ear_jwk",Ghe="ear_jwe_crypto";function U2(t,e,r){if(!e)return;let n=t.get(IC);n&&t.has(s6)&&r?.addFields({embeddedClientId:n,embeddedRedirectUri:t.get(NV)},e)}s(U2,"instrumentBrokerParams");function QDt(t,e){t.set(lhe,e)}s(QDt,"addResponseType");function Vhe(t,e){t.set(uhe,e||CC.QUERY)}s(Vhe,"addResponseMode");function UDt(t){t.set(Uhe,"1")}s(UDt,"addNativeBroker");function q2(t,e,r=!0,n=pp){r&&!n.includes("openid")&&!e.includes("openid")&&n.push("openid");let i=r?[...e||[],...n]:e||[],o=new nl(i);t.set(phe,o.printScopes())}s(q2,"addScopes");function H2(t,e){t.set(IC,e)}s(H2,"addClientId");function $2(t,e){t.set(NV,e)}s($2,"addRedirectUri");function zhe(t,e){t.set(Dhe,e)}s(zhe,"addPostLogoutRedirectUri");function Khe(t,e){t.set(Bhe,e)}s(Khe,"addIdTokenHint");function Yhe(t,e){t.set(Whe,e)}s(Yhe,"addDomainHint");function zD(t,e){t.set($he,e)}s(zD,"addLoginHint");function XI(t,e){t.set(Qs.CCS_HEADER,`UPN:${e}`)}s(XI,"addCcsUpn");function nx(t,e){t.set(Qs.CCS_HEADER,`Oid:${e.uid}@${e.utid}`)}s(nx,"addCcsOid");function QV(t,e){t.set("sid",e)}s(QV,"addSid");function W2(t,e,r){let n=oOe(e,r);try{JSON.parse(n)}catch{throw vs(KI)}t.set(fhe,n)}s(W2,"addClaims");function j2(t,e){t.set(Ehe,e)}s(j2,"addCorrelationId");function a6(t,e){t.set(bhe,e.sku),t.set(Ihe,e.version),e.os&&t.set(The,e.os),e.cpu&&t.set(whe,e.cpu)}s(a6,"addLibraryInfo");function c6(t,e){e?.appName&&t.set(khe,e.appName),e?.appVersion&&t.set(Phe,e.appVersion)}s(c6,"addApplicationTelemetry");function Jhe(t,e){t.set(Ahe,e)}s(Jhe,"addPrompt");function l6(t,e){e&&t.set(hhe,e)}s(l6,"addState");function Xhe(t,e){t.set(ghe,e)}s(Xhe,"addNonce");function qDt(t,e,r){if(e&&r)t.set(Che,e),t.set(vhe,r);else throw vs(M2)}s(qDt,"addCodeChallengeParams");function Zhe(t,e){t.set(yhe,e)}s(Zhe,"addAuthorizationCode");function HDt(t,e){t.set(Nhe,e)}s(HDt,"addDeviceCode");function ege(t,e){t.set(mhe,e)}s(ege,"addRefreshToken");function tge(t,e){t.set(xhe,e)}s(tge,"addCodeVerifier");function u6(t,e){t.set(Mhe,e)}s(u6,"addClientSecret");function d6(t,e){e&&t.set(Lhe,e)}s(d6,"addClientAssertion");function f6(t,e){e&&t.set(Fhe,e)}s(f6,"addClientAssertionType");function $Dt(t,e){t.set(Ohe,e)}s($Dt,"addOboAssertion");function WDt(t,e){t.set(Qhe,e)}s(WDt,"addRequestTokenUse");function p6(t,e){t.set(dhe,e)}s(p6,"addGrantType");function G2(t){t.set(z6e,"1")}s(G2,"addClientInfo");function m6(t){t.has(VD)||t.set(VD,"true")}s(m6,"addInstanceAware");function ix(t,e){Object.entries(e).forEach(([r,n])=>{!t.has(r)&&n&&t.set(r,n)})}s(ix,"addExtraQueryParameters");function oOe(t,e){let r;if(!t)r={};else try{r=JSON.parse(t)}catch{throw vs(KI)}return e&&e.length>0&&(r.hasOwnProperty(l2.ACCESS_TOKEN)||(r[l2.ACCESS_TOKEN]={}),r[l2.ACCESS_TOKEN][l2.XMS_CC]={values:e}),JSON.stringify(r)}s(oOe,"addClientCapabilitiesToClaims");function jDt(t,e){t.set(w9.username,e)}s(jDt,"addUsername");function GDt(t,e){t.set(w9.password,e)}s(GDt,"addPassword");function h6(t,e){e&&(t.set(MV,lo.POP),t.set(LV,e))}s(h6,"addPopToken");function g6(t,e){e&&(t.set(MV,lo.SSH),t.set(LV,e))}s(g6,"addSshJwk");function A6(t,e){t.set(She,e.generateCurrentRequestHeaderValue()),t.set(_he,e.generateLastRequestHeaderValue())}s(A6,"addServerTelemetry");function y6(t){t.set(Rhe,vC.X_MS_LIB_CAPABILITY_VALUE)}s(y6,"addThrottling");function rge(t,e){t.set(qhe,e)}s(rge,"addLogoutHint");function ox(t,e,r){t.has(s6)||t.set(s6,e),t.has(OV)||t.set(OV,r)}s(ox,"addBrokerParameters");function VDt(t,e){t.set(jhe,encodeURIComponent(e)),t.set(Ghe,"eyJhbGciOiJkaXIiLCJlbmMiOiJBMjU2R0NNIn0")}s(VDt,"addEARParameters");var qV={};Ia(qV,{createDiscoveredInstance:()=>ige});d();d();d();function sOe(t){return t.hasOwnProperty("authorization_endpoint")&&t.hasOwnProperty("token_endpoint")&&t.hasOwnProperty("issuer")&&t.hasOwnProperty("jwks_uri")}s(sOe,"isOpenIdConfigResponse");d();function aOe(t){return t.hasOwnProperty("tenant_discovery_endpoint")&&t.hasOwnProperty("metadata")}s(aOe,"isCloudInstanceDiscoveryResponse");d();function cOe(t){return t.hasOwnProperty("error")&&t.hasOwnProperty("error_description")}s(cOe,"isCloudInstanceDiscoveryErrorResponse");d();d();var lOe=s((t,e,r,n,i)=>(...o)=>{r.trace(`Executing function ${e}`);let a=n?.startMeasurement(e,i);if(i){let c=e+"CallCount";n?.incrementFields({[c]:1},i)}try{let c=t(...o);return a?.end({success:!0}),r.trace(`Returning result from ${e}`),c}catch(c){r.trace(`Error occurred in ${e}`);try{r.trace(JSON.stringify(c))}catch{r.trace("Unable to print error message.")}throw a?.end({success:!1},c),c}},"invoke"),uo=s((t,e,r,n,i)=>(...o)=>{r.trace(`Executing function ${e}`);let a=n?.startMeasurement(e,i);if(i){let c=e+"CallCount";n?.incrementFields({[c]:1},i)}return n?.setPreQueueTime(e,i),t(...o).then(c=>(r.trace(`Returning result from ${e}`),a?.end({success:!0}),c)).catch(c=>{r.trace(`Error occurred in ${e}`);try{r.trace(JSON.stringify(c))}catch{r.trace("Unable to print error message.")}throw a?.end({success:!1},c),c})},"invokeAsync");var C6=class t{static{s(this,"RegionDiscovery")}constructor(e,r,n,i){this.networkInterface=e,this.logger=r,this.performanceClient=n,this.correlationId=i}async detectRegion(e,r){this.performanceClient?.addQueueMeasurement(Ye.RegionDiscoveryDetectRegion,this.correlationId);let n=e;if(n)r.region_source=d2.ENVIRONMENT_VARIABLE;else{let i=t.IMDS_OPTIONS;try{let o=await uo(this.getRegionFromIMDS.bind(this),Ye.RegionDiscoveryGetRegionFromIMDS,this.logger,this.performanceClient,this.correlationId)(rt.IMDS_VERSION,i);if(o.status===si.SUCCESS&&(n=o.body,r.region_source=d2.IMDS),o.status===si.BAD_REQUEST){let a=await uo(this.getCurrentVersion.bind(this),Ye.RegionDiscoveryGetCurrentVersion,this.logger,this.performanceClient,this.correlationId)(i);if(!a)return r.region_source=d2.FAILED_AUTO_DETECTION,null;let c=await uo(this.getRegionFromIMDS.bind(this),Ye.RegionDiscoveryGetRegionFromIMDS,this.logger,this.performanceClient,this.correlationId)(a,i);c.status===si.SUCCESS&&(n=c.body,r.region_source=d2.IMDS)}}catch{return r.region_source=d2.FAILED_AUTO_DETECTION,null}}return n||(r.region_source=d2.FAILED_AUTO_DETECTION),n||null}async getRegionFromIMDS(e,r){return this.performanceClient?.addQueueMeasurement(Ye.RegionDiscoveryGetRegionFromIMDS,this.correlationId),this.networkInterface.sendGetRequestAsync(`${rt.IMDS_ENDPOINT}?api-version=${e}&format=text`,r,rt.IMDS_TIMEOUT)}async getCurrentVersion(e){this.performanceClient?.addQueueMeasurement(Ye.RegionDiscoveryGetCurrentVersion,this.correlationId);try{let r=await this.networkInterface.sendGetRequestAsync(`${rt.IMDS_ENDPOINT}?format=json`,e);return r.status===si.BAD_REQUEST&&r.body&&r.body["newest-versions"]&&r.body["newest-versions"].length>0?r.body["newest-versions"][0]:null}catch{return null}}};C6.IMDS_OPTIONS={headers:{Metadata:"true"}};var hA=class t{static{s(this,"Authority")}constructor(e,r,n,i,o,a,c,l){this.canonicalAuthority=e,this._canonicalAuthority.validateAsUri(),this.networkInterface=r,this.cacheManager=n,this.authorityOptions=i,this.regionDiscoveryMetadata={region_used:void 0,region_source:void 0,region_outcome:void 0},this.logger=o,this.performanceClient=c,this.correlationId=a,this.managedIdentity=l||!1,this.regionDiscovery=new C6(r,this.logger,this.performanceClient,this.correlationId)}getAuthorityType(e){if(e.HostNameAndPort.endsWith(rt.CIAM_AUTH_URL))return eh.Ciam;let r=e.PathSegments;if(r.length)switch(r[0].toLowerCase()){case rt.ADFS:return eh.Adfs;case rt.DSTS:return eh.Dsts}return eh.Default}get authorityType(){return this.getAuthorityType(this.canonicalAuthorityUrlComponents)}get protocolMode(){return this.authorityOptions.protocolMode}get options(){return this.authorityOptions}get canonicalAuthority(){return this._canonicalAuthority.urlString}set canonicalAuthority(e){this._canonicalAuthority=new Mi(e),this._canonicalAuthority.validateAsUri(),this._canonicalAuthorityUrlComponents=null}get canonicalAuthorityUrlComponents(){return this._canonicalAuthorityUrlComponents||(this._canonicalAuthorityUrlComponents=this._canonicalAuthority.getUrlComponents()),this._canonicalAuthorityUrlComponents}get hostnameAndPort(){return this.canonicalAuthorityUrlComponents.HostNameAndPort.toLowerCase()}get tenant(){return this.canonicalAuthorityUrlComponents.PathSegments[0]}get authorizationEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.authorization_endpoint);throw vt(gf)}get tokenEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.token_endpoint);throw vt(gf)}get deviceCodeEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.token_endpoint.replace("/token","/devicecode"));throw vt(gf)}get endSessionEndpoint(){if(this.discoveryComplete()){if(!this.metadata.end_session_endpoint)throw vt(S2);return this.replacePath(this.metadata.end_session_endpoint)}else throw vt(gf)}get selfSignedJwtAudience(){if(this.discoveryComplete())return this.replacePath(this.metadata.issuer);throw vt(gf)}get jwksUri(){if(this.discoveryComplete())return this.replacePath(this.metadata.jwks_uri);throw vt(gf)}canReplaceTenant(e){return e.PathSegments.length===1&&!t.reservedTenantDomains.has(e.PathSegments[0])&&this.getAuthorityType(e)===eh.Default&&this.protocolMode!==Ld.OIDC}replaceTenant(e){return e.replace(/{tenant}|{tenantid}/g,this.tenant)}replacePath(e){let r=e,i=new Mi(this.metadata.canonical_authority).getUrlComponents(),o=i.PathSegments;return this.canonicalAuthorityUrlComponents.PathSegments.forEach((c,l)=>{let u=o[l];if(l===0&&this.canReplaceTenant(i)){let f=new Mi(this.metadata.authorization_endpoint).getUrlComponents().PathSegments[0];u!==f&&(this.logger.verbose(`Replacing tenant domain name ${u} with id ${f}`),u=f)}c!==u&&(r=r.replace(`/${u}/`,`/${c}/`))}),this.replaceTenant(r)}get defaultOpenIdConfigurationEndpoint(){let e=this.hostnameAndPort;return this.canonicalAuthority.endsWith("v2.0/")||this.authorityType===eh.Adfs||this.protocolMode===Ld.OIDC&&!this.isAliasOfKnownMicrosoftAuthority(e)?`${this.canonicalAuthority}.well-known/openid-configuration`:`${this.canonicalAuthority}v2.0/.well-known/openid-configuration`}discoveryComplete(){return!!this.metadata}async resolveEndpointsAsync(){this.performanceClient?.addQueueMeasurement(Ye.AuthorityResolveEndpointsAsync,this.correlationId);let e=this.getCurrentMetadataEntity(),r=await uo(this.updateCloudDiscoveryMetadata.bind(this),Ye.AuthorityUpdateCloudDiscoveryMetadata,this.logger,this.performanceClient,this.correlationId)(e);this.canonicalAuthority=this.canonicalAuthority.replace(this.hostnameAndPort,e.preferred_network);let n=await uo(this.updateEndpointMetadata.bind(this),Ye.AuthorityUpdateEndpointMetadata,this.logger,this.performanceClient,this.correlationId)(e);this.updateCachedMetadata(e,r,{source:n}),this.performanceClient?.addFields({cloudDiscoverySource:r,authorityEndpointSource:n},this.correlationId)}getCurrentMetadataEntity(){let e=this.cacheManager.getAuthorityMetadataByAlias(this.hostnameAndPort);return e||(e={aliases:[],preferred_cache:this.hostnameAndPort,preferred_network:this.hostnameAndPort,canonical_authority:this.canonicalAuthority,authorization_endpoint:"",token_endpoint:"",end_session_endpoint:"",issuer:"",aliasesFromNetwork:!1,endpointsFromNetwork:!1,expiresAt:SV(),jwks_uri:""}),e}updateCachedMetadata(e,r,n){r!==hf.CACHE&&n?.source!==hf.CACHE&&(e.expiresAt=SV(),e.canonical_authority=this.canonicalAuthority);let i=this.cacheManager.generateAuthorityMetadataCacheKey(e.preferred_cache);this.cacheManager.setAuthorityMetadata(i,e),this.metadata=e}async updateEndpointMetadata(e){this.performanceClient?.addQueueMeasurement(Ye.AuthorityUpdateEndpointMetadata,this.correlationId);let r=this.updateEndpointMetadataFromLocalSources(e);if(r){if(r.source===hf.HARDCODED_VALUES&&this.authorityOptions.azureRegionConfiguration?.azureRegion&&r.metadata){let i=await uo(this.updateMetadataWithRegionalInformation.bind(this),Ye.AuthorityUpdateMetadataWithRegionalInformation,this.logger,this.performanceClient,this.correlationId)(r.metadata);$D(e,i,!1),e.canonical_authority=this.canonicalAuthority}return r.source}let n=await uo(this.getEndpointMetadataFromNetwork.bind(this),Ye.AuthorityGetEndpointMetadataFromNetwork,this.logger,this.performanceClient,this.correlationId)();if(n)return this.authorityOptions.azureRegionConfiguration?.azureRegion&&(n=await uo(this.updateMetadataWithRegionalInformation.bind(this),Ye.AuthorityUpdateMetadataWithRegionalInformation,this.logger,this.performanceClient,this.correlationId)(n)),$D(e,n,!0),hf.NETWORK;throw vt(h2,this.defaultOpenIdConfigurationEndpoint)}updateEndpointMetadataFromLocalSources(e){this.logger.verbose("Attempting to get endpoint metadata from authority configuration");let r=this.getEndpointMetadataFromConfig();if(r)return this.logger.verbose("Found endpoint metadata in authority configuration"),$D(e,r,!1),{source:hf.CONFIG};if(this.logger.verbose("Did not find endpoint metadata in the config... Attempting to get endpoint metadata from the hardcoded values."),this.authorityOptions.skipAuthorityMetadataCache)this.logger.verbose("Skipping hardcoded metadata cache since skipAuthorityMetadataCache is set to true. Attempting to get endpoint metadata from the network metadata cache.");else{let i=this.getEndpointMetadataFromHardcodedValues();if(i)return $D(e,i,!1),{source:hf.HARDCODED_VALUES,metadata:i};this.logger.verbose("Did not find endpoint metadata in hardcoded values... Attempting to get endpoint metadata from the network metadata cache.")}let n=_V(e);return this.isAuthoritySameType(e)&&e.endpointsFromNetwork&&!n?(this.logger.verbose("Found endpoint metadata in the cache."),{source:hf.CACHE}):(n&&this.logger.verbose("The metadata entity is expired."),null)}isAuthoritySameType(e){return new Mi(e.canonical_authority).getUrlComponents().PathSegments.length===this.canonicalAuthorityUrlComponents.PathSegments.length}getEndpointMetadataFromConfig(){if(this.authorityOptions.authorityMetadata)try{return JSON.parse(this.authorityOptions.authorityMetadata)}catch{throw vs(L2)}return null}async getEndpointMetadataFromNetwork(){this.performanceClient?.addQueueMeasurement(Ye.AuthorityGetEndpointMetadataFromNetwork,this.correlationId);let e={},r=this.defaultOpenIdConfigurationEndpoint;this.logger.verbose(`Authority.getEndpointMetadataFromNetwork: attempting to retrieve OAuth endpoints from ${r}`);try{let n=await this.networkInterface.sendGetRequestAsync(r,e);return sOe(n.body)?n.body:(this.logger.verbose("Authority.getEndpointMetadataFromNetwork: could not parse response as OpenID configuration"),null)}catch(n){return this.logger.verbose(`Authority.getEndpointMetadataFromNetwork: ${n}`),null}}getEndpointMetadataFromHardcodedValues(){return this.hostnameAndPort in ihe?ihe[this.hostnameAndPort]:null}async updateMetadataWithRegionalInformation(e){this.performanceClient?.addQueueMeasurement(Ye.AuthorityUpdateMetadataWithRegionalInformation,this.correlationId);let r=this.authorityOptions.azureRegionConfiguration?.azureRegion;if(r){if(r!==rt.AZURE_REGION_AUTO_DISCOVER_FLAG)return this.regionDiscoveryMetadata.region_outcome=EV.CONFIGURED_NO_AUTO_DETECTION,this.regionDiscoveryMetadata.region_used=r,t.replaceWithRegionalInformation(e,r);let n=await uo(this.regionDiscovery.detectRegion.bind(this.regionDiscovery),Ye.RegionDiscoveryDetectRegion,this.logger,this.performanceClient,this.correlationId)(this.authorityOptions.azureRegionConfiguration?.environmentRegion,this.regionDiscoveryMetadata);if(n)return this.regionDiscoveryMetadata.region_outcome=EV.AUTO_DETECTION_REQUESTED_SUCCESSFUL,this.regionDiscoveryMetadata.region_used=n,t.replaceWithRegionalInformation(e,n);this.regionDiscoveryMetadata.region_outcome=EV.AUTO_DETECTION_REQUESTED_FAILED}return e}async updateCloudDiscoveryMetadata(e){this.performanceClient?.addQueueMeasurement(Ye.AuthorityUpdateCloudDiscoveryMetadata,this.correlationId);let r=this.updateCloudDiscoveryMetadataFromLocalSources(e);if(r)return r;let n=await uo(this.getCloudDiscoveryMetadataFromNetwork.bind(this),Ye.AuthorityGetCloudDiscoveryMetadataFromNetwork,this.logger,this.performanceClient,this.correlationId)();if(n)return V9(e,n,!0),hf.NETWORK;throw vs(F2)}updateCloudDiscoveryMetadataFromLocalSources(e){this.logger.verbose("Attempting to get cloud discovery metadata  from authority configuration"),this.logger.verbosePii(`Known Authorities: ${this.authorityOptions.knownAuthorities||rt.NOT_APPLICABLE}`),this.logger.verbosePii(`Authority Metadata: ${this.authorityOptions.authorityMetadata||rt.NOT_APPLICABLE}`),this.logger.verbosePii(`Canonical Authority: ${e.canonical_authority||rt.NOT_APPLICABLE}`);let r=this.getCloudDiscoveryMetadataFromConfig();if(r)return this.logger.verbose("Found cloud discovery metadata in authority configuration"),V9(e,r,!1),hf.CONFIG;if(this.logger.verbose("Did not find cloud discovery metadata in the config... Attempting to get cloud discovery metadata from the hardcoded values."),this.options.skipAuthorityMetadataCache)this.logger.verbose("Skipping hardcoded cloud discovery metadata cache since skipAuthorityMetadataCache is set to true. Attempting to get cloud discovery metadata from the network metadata cache.");else{let i=tOe(this.hostnameAndPort);if(i)return this.logger.verbose("Found cloud discovery metadata from hardcoded values."),V9(e,i,!1),hf.HARDCODED_VALUES;this.logger.verbose("Did not find cloud discovery metadata in hardcoded values... Attempting to get cloud discovery metadata from the network metadata cache.")}let n=_V(e);return this.isAuthoritySameType(e)&&e.aliasesFromNetwork&&!n?(this.logger.verbose("Found cloud discovery metadata in the cache."),hf.CACHE):(n&&this.logger.verbose("The metadata entity is expired."),null)}getCloudDiscoveryMetadataFromConfig(){if(this.authorityType===eh.Ciam)return this.logger.verbose("CIAM authorities do not support cloud discovery metadata, generate the aliases from authority host."),t.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort);if(this.authorityOptions.cloudDiscoveryMetadata){this.logger.verbose("The cloud discovery metadata has been provided as a network response, in the config.");try{this.logger.verbose("Attempting to parse the cloud discovery metadata.");let e=JSON.parse(this.authorityOptions.cloudDiscoveryMetadata),r=n6(e.metadata,this.hostnameAndPort);if(this.logger.verbose("Parsed the cloud discovery metadata."),r)return this.logger.verbose("There is returnable metadata attached to the parsed cloud discovery metadata."),r;this.logger.verbose("There is no metadata attached to the parsed cloud discovery metadata.")}catch{throw this.logger.verbose("Unable to parse the cloud discovery metadata. Throwing Invalid Cloud Discovery Metadata Error."),vs(YI)}}return this.isInKnownAuthorities()?(this.logger.verbose("The host is included in knownAuthorities. Creating new cloud discovery metadata from the host."),t.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort)):null}async getCloudDiscoveryMetadataFromNetwork(){this.performanceClient?.addQueueMeasurement(Ye.AuthorityGetCloudDiscoveryMetadataFromNetwork,this.correlationId);let e=`${rt.AAD_INSTANCE_DISCOVERY_ENDPT}${this.canonicalAuthority}oauth2/v2.0/authorize`,r={},n=null;try{let i=await this.networkInterface.sendGetRequestAsync(e,r),o,a;if(aOe(i.body))o=i.body,a=o.metadata,this.logger.verbosePii(`tenant_discovery_endpoint is: ${o.tenant_discovery_endpoint}`);else if(cOe(i.body)){if(this.logger.warning(`A CloudInstanceDiscoveryErrorResponse was returned. The cloud instance discovery network request's status code is: ${i.status}`),o=i.body,o.error===rt.INVALID_INSTANCE)return this.logger.error("The CloudInstanceDiscoveryErrorResponse error is invalid_instance."),null;this.logger.warning(`The CloudInstanceDiscoveryErrorResponse error is ${o.error}`),this.logger.warning(`The CloudInstanceDiscoveryErrorResponse error description is ${o.error_description}`),this.logger.warning("Setting the value of the CloudInstanceDiscoveryMetadata (returned from the network) to []"),a=[]}else return this.logger.error("AAD did not return a CloudInstanceDiscoveryResponse or CloudInstanceDiscoveryErrorResponse"),null;this.logger.verbose("Attempting to find a match between the developer's authority and the CloudInstanceDiscoveryMetadata returned from the network request."),n=n6(a,this.hostnameAndPort)}catch(i){if(i instanceof ai)this.logger.error(`There was a network error while attempting to get the cloud discovery instance metadata.
Error: ${i.errorCode}
Error Description: ${i.errorMessage}`);else{let o=i;this.logger.error(`A non-MSALJS error was thrown while attempting to get the cloud instance discovery metadata.
Error: ${o.name}
Error Description: ${o.message}`)}return null}return n||(this.logger.warning("The developer's authority was not found within the CloudInstanceDiscoveryMetadata returned from the network request."),this.logger.verbose("Creating custom Authority for custom domain scenario."),n=t.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort)),n}isInKnownAuthorities(){return this.authorityOptions.knownAuthorities.filter(r=>r&&Mi.getDomainFromUrl(r).toLowerCase()===this.hostnameAndPort).length>0}static generateAuthority(e,r){let n;if(r&&r.azureCloudInstance!==ex.None){let i=r.tenant?r.tenant:rt.DEFAULT_COMMON_TENANT;n=`${r.azureCloudInstance}/${i}/`}return n||e}static createCloudDiscoveryMetadataFromHost(e){return{preferred_network:e,preferred_cache:e,aliases:[e]}}getPreferredCache(){if(this.managedIdentity)return rt.DEFAULT_AUTHORITY_HOST;if(this.discoveryComplete())return this.metadata.preferred_cache;throw vt(gf)}isAlias(e){return this.metadata.aliases.indexOf(e)>-1}isAliasOfKnownMicrosoftAuthority(e){return she.has(e)}static isPublicCloudAuthority(e){return rt.KNOWN_PUBLIC_CLOUDS.indexOf(e)>=0}static buildRegionalAuthorityString(e,r,n){let i=new Mi(e);i.validateAsUri();let o=i.getUrlComponents(),a=`${r}.${o.HostNameAndPort}`;this.isPublicCloudAuthority(o.HostNameAndPort)&&(a=`${r}.${rt.REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX}`);let c=Mi.constructAuthorityUriFromObject({...i.getUrlComponents(),HostNameAndPort:a}).urlString;return n?`${c}?${n}`:c}static replaceWithRegionalInformation(e,r){let n={...e};return n.authorization_endpoint=t.buildRegionalAuthorityString(n.authorization_endpoint,r),n.token_endpoint=t.buildRegionalAuthorityString(n.token_endpoint,r),n.end_session_endpoint&&(n.end_session_endpoint=t.buildRegionalAuthorityString(n.end_session_endpoint,r)),n}static transformCIAMAuthority(e){let r=e,i=new Mi(e).getUrlComponents();if(i.PathSegments.length===0&&i.HostNameAndPort.endsWith(rt.CIAM_AUTH_URL)){let o=i.HostNameAndPort.split(".")[0];r=`${r}${o}${rt.AAD_TENANT_DOMAIN_SUFFIX}`}return r}};hA.reservedTenantDomains=new Set(["{tenant}","{tenantid}",mp.COMMON,mp.CONSUMERS,mp.ORGANIZATIONS]);function uOe(t){let n=new Mi(t).getUrlComponents().PathSegments.slice(-1)[0]?.toLowerCase();switch(n){case mp.COMMON:case mp.ORGANIZATIONS:case mp.CONSUMERS:return;default:return n}}s(uOe,"getTenantFromAuthorityString");function UV(t){return t.endsWith(rt.FORWARD_SLASH)?t:`${t}${rt.FORWARD_SLASH}`}s(UV,"formatAuthorityUri");function nge(t){let e=t.cloudDiscoveryMetadata,r;if(e)try{r=JSON.parse(e)}catch{throw vs(YI)}return{canonicalAuthority:t.authority?UV(t.authority):void 0,knownAuthorities:t.knownAuthorities,cloudDiscoveryMetadata:r}}s(nge,"buildStaticAuthorityOptions");async function ige(t,e,r,n,i,o,a){a?.addQueueMeasurement(Ye.AuthorityFactoryCreateDiscoveredInstance,o);let c=hA.transformCIAMAuthority(UV(t)),l=new hA(c,e,r,n,i,o,a);try{return await uo(l.resolveEndpointsAsync.bind(l),Ye.AuthorityResolveEndpointsAsync,i,a,o)(),l}catch{throw vt(gf)}}s(ige,"createDiscoveredInstance");d();d();var yf=class t extends ai{static{s(this,"ServerError")}constructor(e,r,n,i,o){super(e,r,n),this.name="ServerError",this.errorNo=i,this.status=o,Object.setPrototypeOf(this,t.prototype)}};d();function KD(t,e,r){return{clientId:t,authority:e.authority,scopes:e.scopes,homeAccountIdentifier:r,claims:e.claims,authenticationScheme:e.authenticationScheme,resourceRequestMethod:e.resourceRequestMethod,resourceRequestUri:e.resourceRequestUri,shrClaims:e.shrClaims,sshKid:e.sshKid,embeddedClientId:e.embeddedClientId||e.tokenBodyParameters?.clientId}}s(KD,"getRequestThumbprint");var v6=class t{static{s(this,"ThrottlingUtils")}static generateThrottlingStorageKey(e){return`${vC.THROTTLING_PREFIX}.${JSON.stringify(e)}`}static preProcess(e,r,n){let i=t.generateThrottlingStorageKey(r),o=e.getThrottlingCache(i);if(o){if(o.throttleTime<Date.now()){e.removeItem(i,n);return}throw new yf(o.errorCodes?.join(" ")||rt.EMPTY_STRING,o.errorMessage,o.subError)}}static postProcess(e,r,n,i){if(t.checkResponseStatus(n)||t.checkResponseForRetryAfter(n)){let o={throttleTime:t.calculateThrottleTime(parseInt(n.headers[Qs.RETRY_AFTER])),error:n.body.error,errorCodes:n.body.error_codes,errorMessage:n.body.error_description,subError:n.body.suberror};e.setThrottlingCache(t.generateThrottlingStorageKey(r),o,i)}}static checkResponseStatus(e){return e.status===429||e.status>=500&&e.status<600}static checkResponseForRetryAfter(e){return e.headers?e.headers.hasOwnProperty(Qs.RETRY_AFTER)&&(e.status<200||e.status>=300):!1}static calculateThrottleTime(e){let r=e<=0?0:e,n=Date.now()/1e3;return Math.floor(Math.min(n+(r||vC.DEFAULT_THROTTLE_TIME_SECONDS),n+vC.DEFAULT_MAX_THROTTLE_TIME_SECONDS)*1e3)}static removeThrottle(e,r,n,i){let o=KD(r,n,i),a=this.generateThrottlingStorageKey(o);e.removeItem(a,n.correlationId)}};d();var HV=class t extends ai{static{s(this,"NetworkError")}constructor(e,r,n){super(e.errorCode,e.errorMessage,e.subError),Object.setPrototypeOf(this,t.prototype),this.name="NetworkError",this.error=e,this.httpStatus=r,this.responseHeaders=n}};var Ku=class{static{s(this,"BaseClient")}constructor(e,r){this.config=iOe(e),this.logger=new R0(this.config.loggerOptions,IV,qD),this.cryptoUtils=this.config.cryptoInterface,this.cacheManager=this.config.storageInterface,this.networkClient=this.config.networkInterface,this.serverTelemetryManager=this.config.serverTelemetryManager,this.authority=this.config.authOptions.authority,this.performanceClient=r}createTokenRequestHeaders(e){let r={};if(r[Qs.CONTENT_TYPE]=rt.URL_FORM_CONTENT_TYPE,!this.config.systemOptions.preventCorsPreflight&&e)switch(e.type){case Af.HOME_ACCOUNT_ID:try{let n=EC(e.credential);r[Qs.CCS_HEADER]=`Oid:${n.uid}@${n.utid}`}catch(n){this.logger.verbose("Could not parse home account ID for CCS Header: "+n)}break;case Af.UPN:r[Qs.CCS_HEADER]=`UPN: ${e.credential}`;break}return r}async executePostToTokenEndpoint(e,r,n,i,o,a){a&&this.performanceClient?.addQueueMeasurement(a,o);let c=await this.sendPostRequest(i,e,{body:r,headers:n},o);return this.config.serverTelemetryManager&&c.status<500&&c.status!==429&&this.config.serverTelemetryManager.clearTelemetryCache(),c}async sendPostRequest(e,r,n,i){v6.preProcess(this.cacheManager,e,i);let o;try{o=await uo(this.networkClient.sendPostRequestAsync.bind(this.networkClient),Ye.NetworkClientSendPostRequestAsync,this.logger,this.performanceClient,i)(r,n);let a=o.headers||{};this.performanceClient?.addFields({refreshTokenSize:o.body.refresh_token?.length||0,httpVerToken:a[Qs.X_MS_HTTP_VERSION]||"",requestId:a[Qs.X_MS_REQUEST_ID]||""},i)}catch(a){if(a instanceof HV){let c=a.responseHeaders;throw c&&this.performanceClient?.addFields({httpVerToken:c[Qs.X_MS_HTTP_VERSION]||"",requestId:c[Qs.X_MS_REQUEST_ID]||"",contentTypeHeader:c[Qs.CONTENT_TYPE]||void 0,contentLengthHeader:c[Qs.CONTENT_LENGTH]||void 0,httpStatus:a.httpStatus},i),a.error}throw a instanceof ai?a:vt(m2)}return v6.postProcess(this.cacheManager,e,o,i),o}async updateAuthority(e,r){this.performanceClient?.addQueueMeasurement(Ye.UpdateTokenEndpointAuthority,r);let n=`https://${e}/${this.authority.tenant}/`,i=await ige(n,this.networkClient,this.cacheManager,this.authority.options,this.logger,r,this.performanceClient);this.authority=i}createTokenQueryParameters(e){let r=new Map;return e.embeddedClientId&&ox(r,this.config.authOptions.clientId,this.config.authOptions.redirectUri),e.tokenQueryParameters&&ix(r,e.tokenQueryParameters),j2(r,e.correlationId),U2(r,e.correlationId,this.performanceClient),bC(r)}};d();d();var WV={};Ia(WV,{badToken:()=>eT,consentRequired:()=>sge,interactionRequired:()=>oge,loginRequired:()=>age,nativeAccountUnavailable:()=>x6,noTokensFound:()=>ZI,refreshTokenExpired:()=>E6,uxNotAllowed:()=>$V});d();var ZI="no_tokens_found",x6="native_account_unavailable",E6="refresh_token_expired",$V="ux_not_allowed",oge="interaction_required",sge="consent_required",age="login_required",eT="bad_token";var dOe=[oge,sge,age,eT,$V],zDt=["message_only","additional_action","basic_action","user_password_expired","consent_required","bad_token"],jV={[ZI]:"No refresh token found in the cache. Please sign-in.",[x6]:"The requested account is not available in the native broker. It may have been deleted or logged out. Please sign-in again using an interactive API.",[E6]:"Refresh token has expired.",[eT]:"Identity provider returned bad_token due to an expired or invalid refresh token. Please invoke an interactive API to resolve.",[$V]:"`canShowUI` flag in Edge was set to false. User interaction required on web page. Please invoke an interactive API to resolve."},cge={noTokensFoundError:{code:ZI,desc:jV[ZI]},native_account_unavailable:{code:x6,desc:jV[x6]},bad_token:{code:eT,desc:jV[eT]}},P0=class t extends ai{static{s(this,"InteractionRequiredAuthError")}constructor(e,r,n,i,o,a,c,l){super(e,r,n),Object.setPrototypeOf(this,t.prototype),this.timestamp=i||rt.EMPTY_STRING,this.traceId=o||rt.EMPTY_STRING,this.correlationId=a||rt.EMPTY_STRING,this.claims=c||rt.EMPTY_STRING,this.name="InteractionRequiredAuthError",this.errorNo=l}};function GV(t,e,r){let n=!!t&&dOe.indexOf(t)>-1,i=!!r&&zDt.indexOf(r)>-1,o=!!e&&dOe.some(a=>e.indexOf(a)>-1);return n||o||i}s(GV,"isInteractionRequiredError");function VV(t){return new P0(t,jV[t])}s(VV,"createInteractionRequiredAuthError");d();var zV=class t{static{s(this,"ProtocolUtils")}static setRequestState(e,r,n){let i=t.generateLibraryState(e,n);return r?`${i}${rt.RESOURCE_DELIM}${r}`:i}static generateLibraryState(e,r){if(!e)throw vt(VI);let n={id:e.createNewGuid()};r&&(n.meta=r);let i=JSON.stringify(n);return e.base64Encode(i)}static parseRequestState(e,r){if(!e)throw vt(VI);if(!r)throw vt(mA);try{let n=r.split(rt.RESOURCE_DELIM),i=n[0],o=n.length>1?n.slice(1).join(rt.RESOURCE_DELIM):rt.EMPTY_STRING,a=e.base64Decode(i),c=JSON.parse(a);return{userRequestState:o||rt.EMPTY_STRING,libraryState:c}}catch{throw vt(mA)}}};d();var KDt={SW:"sw"},tT=class{static{s(this,"PopTokenGenerator")}constructor(e,r){this.cryptoUtils=e,this.performanceClient=r}async generateCnf(e,r){this.performanceClient?.addQueueMeasurement(Ye.PopTokenGenerateCnf,e.correlationId);let n=await uo(this.generateKid.bind(this),Ye.PopTokenGenerateCnf,r,this.performanceClient,e.correlationId)(e),i=this.cryptoUtils.base64UrlEncode(JSON.stringify(n));return{kid:n.kid,reqCnfString:i}}async generateKid(e){return this.performanceClient?.addQueueMeasurement(Ye.PopTokenGenerateKid,e.correlationId),{kid:await this.cryptoUtils.getPublicKeyThumbprint(e),xms_ksl:KDt.SW}}async signPopToken(e,r,n){return this.signPayload(e,r,n)}async signPayload(e,r,n,i){let{resourceRequestMethod:o,resourceRequestUri:a,shrClaims:c,shrNonce:l,shrOptions:u}=n,p=(a?new Mi(a):void 0)?.getUrlComponents();return this.cryptoUtils.signJwt({at:e,ts:k0(),m:o?.toUpperCase(),u:p?.HostNameAndPort,nonce:l||this.cryptoUtils.createNewGuid(),p:p?.AbsolutePath,q:p?.QueryString?[[],p.QueryString]:void 0,client_claims:c||void 0,...i},r,u,n.correlationId)}};d();var D0=class{static{s(this,"TokenCacheContext")}constructor(e,r){this.cache=e,this.hasChanged=r}get cacheHasChanged(){return this.hasChanged}get tokenCache(){return this.cache}};var Lc=class t{static{s(this,"ResponseHandler")}constructor(e,r,n,i,o,a,c){this.clientId=e,this.cacheStorage=r,this.cryptoObj=n,this.logger=i,this.serializableCache=o,this.persistencePlugin=a,this.performanceClient=c}validateTokenResponse(e,r){if(e.error||e.error_description||e.suberror){let n=`Error(s): ${e.error_codes||rt.NOT_AVAILABLE} - Timestamp: ${e.timestamp||rt.NOT_AVAILABLE} - Description: ${e.error_description||rt.NOT_AVAILABLE} - Correlation ID: ${e.correlation_id||rt.NOT_AVAILABLE} - Trace ID: ${e.trace_id||rt.NOT_AVAILABLE}`,i=e.error_codes?.length?e.error_codes[0]:void 0,o=new yf(e.error,n,e.suberror,i,e.status);if(r&&e.status&&e.status>=si.SERVER_ERROR_RANGE_START&&e.status<=si.SERVER_ERROR_RANGE_END){this.logger.warning(`executeTokenRequest:validateTokenResponse - AAD is currently unavailable and the access token is unable to be refreshed.
${o}`);return}else if(r&&e.status&&e.status>=si.CLIENT_ERROR_RANGE_START&&e.status<=si.CLIENT_ERROR_RANGE_END){this.logger.warning(`executeTokenRequest:validateTokenResponse - AAD is currently available but is unable to refresh the access token.
${o}`);return}throw GV(e.error,e.error_description,e.suberror)?new P0(e.error,e.error_description,e.suberror,e.timestamp||rt.EMPTY_STRING,e.trace_id||rt.EMPTY_STRING,e.correlation_id||rt.EMPTY_STRING,e.claims||rt.EMPTY_STRING,i):o}}async handleServerTokenResponse(e,r,n,i,o,a,c,l,u){this.performanceClient?.addQueueMeasurement(Ye.HandleServerTokenResponse,e.correlation_id);let f;if(e.id_token){if(f=tx(e.id_token||rt.EMPTY_STRING,this.cryptoObj.base64Decode),o&&o.nonce&&f.nonce!==o.nonce)throw vt(y2);if(i.maxAge||i.maxAge===0){let g=f.auth_time;if(!g)throw vt(Yv);W9(g,i.maxAge)}}this.homeAccountIdentifier=Vu.generateHomeAccountId(e.client_info||rt.EMPTY_STRING,r.authorityType,this.logger,this.cryptoObj,f);let p;o&&o.state&&(p=zV.parseRequestState(this.cryptoObj,o.state)),e.key_id=e.key_id||i.sshKid||void 0;let m=this.generateCacheRecord(e,r,n,i,f,a,o),h;try{if(this.persistencePlugin&&this.serializableCache&&(this.logger.verbose("Persistence enabled, calling beforeCacheAccess"),h=new D0(this.serializableCache,!0),await this.persistencePlugin.beforeCacheAccess(h)),c&&!l&&m.account){let g=m.account.generateAccountKey();if(!this.cacheStorage.getAccount(g,i.correlationId))return this.logger.warning("Account used to refresh tokens not in persistence, refreshed tokens will not be stored in the cache"),await t.generateAuthenticationResult(this.cryptoObj,r,m,!1,i,f,p,void 0,u)}await this.cacheStorage.saveCacheRecord(m,i.correlationId,i.storeInCache)}finally{this.persistencePlugin&&this.serializableCache&&h&&(this.logger.verbose("Persistence enabled, calling afterCacheAccess"),await this.persistencePlugin.afterCacheAccess(h))}return t.generateAuthenticationResult(this.cryptoObj,r,m,!1,i,f,p,e,u)}generateCacheRecord(e,r,n,i,o,a,c){let l=r.getPreferredCache();if(!l)throw vt(Xv);let u=kV(o),f,p;e.id_token&&o&&(f=Zme(this.homeAccountIdentifier,l,e.id_token,this.clientId,u||""),p=fOe(this.cacheStorage,r,this.homeAccountIdentifier,this.cryptoObj.base64Decode,i.correlationId,o,e.client_info,l,u,c,void 0,this.logger));let m=null;if(e.access_token){let A=e.scope?nl.fromString(e.scope):new nl(i.scopes||[]),y=(typeof e.expires_in=="string"?parseInt(e.expires_in,10):e.expires_in)||0,E=(typeof e.ext_expires_in=="string"?parseInt(e.ext_expires_in,10):e.ext_expires_in)||0,b=(typeof e.refresh_in=="string"?parseInt(e.refresh_in,10):e.refresh_in)||void 0,S=n+y,R=S+E,B=b&&b>0?n+b:void 0;m=ehe(this.homeAccountIdentifier,l,e.access_token,this.clientId,u||r.tenant||"",A.printScopes(),S,R,this.cryptoObj.base64Decode,B,e.token_type,a,e.key_id,i.claims,i.requestedClaimsHash)}let h=null;if(e.refresh_token){let A;if(e.refresh_token_expires_in){let y=typeof e.refresh_token_expires_in=="string"?parseInt(e.refresh_token_expires_in,10):e.refresh_token_expires_in;A=n+y}h=the(this.homeAccountIdentifier,l,e.refresh_token,this.clientId,e.foci,a,A)}let g=null;return e.foci&&(g={clientId:this.clientId,environment:l,familyId:e.foci}),{account:p,idToken:f,accessToken:m,refreshToken:h,appMetadata:g}}static async generateAuthenticationResult(e,r,n,i,o,a,c,l,u){let f=rt.EMPTY_STRING,p=[],m=null,h,g,A=rt.EMPTY_STRING;if(n.accessToken){if(n.accessToken.tokenType===lo.POP&&!o.popKid){let S=new tT(e),{secret:R,keyId:B}=n.accessToken;if(!B)throw vt(_2);f=await S.signPopToken(R,B,o)}else f=n.accessToken.secret;p=nl.fromString(n.accessToken.target).asArray(),m=j9(n.accessToken.expiresOn),h=j9(n.accessToken.extendedExpiresOn),n.accessToken.refreshOn&&(g=j9(n.accessToken.refreshOn))}n.appMetadata&&(A=n.appMetadata.familyId===Kv?Kv:"");let y=a?.oid||a?.sub||"",E=a?.tid||"";l?.spa_accountid&&n.account&&(n.account.nativeAccountId=l?.spa_accountid);let b=n.account?RV(n.account.getAccountInfo(),void 0,a,n.idToken?.secret):null;return{authority:r.canonicalAuthority,uniqueId:y,tenantId:E,scopes:p,account:b,idToken:n?.idToken?.secret||"",idTokenClaims:a||{},accessToken:f,fromCache:i,expiresOn:m,extExpiresOn:h,refreshOn:g,correlationId:o.correlationId,requestId:u||rt.EMPTY_STRING,familyId:A,tokenType:n.accessToken?.tokenType||rt.EMPTY_STRING,state:c?c.userRequestState:rt.EMPTY_STRING,cloudGraphHostName:n.account?.cloudGraphHostName||rt.EMPTY_STRING,msGraphHost:n.account?.msGraphHost||rt.EMPTY_STRING,code:l?.spa_code,fromNativeBroker:!1}}};function fOe(t,e,r,n,i,o,a,c,l,u,f,p){p?.verbose("setCachedAccount called");let h=t.getAccountKeys().find(b=>b.startsWith(r)),g=null;h&&(g=t.getAccount(h,i));let A=g||Vu.createAccount({homeAccountId:r,idTokenClaims:o,clientInfo:a,environment:c,cloudGraphHostName:u?.cloud_graph_host_name,msGraphHost:u?.msgraph_host,nativeAccountId:f},e,n),y=A.tenantProfiles||[],E=l||A.realm;if(E&&!y.find(b=>b.tenantId===E)){let b=r6(r,A.localAccountId,E,o);y.push(b)}return A.tenantProfiles=y,A}s(fOe,"buildAccountToCache");d();async function Cf(t,e,r){return typeof t=="string"?t:t({clientId:e,tokenEndpoint:r})}s(Cf,"getClientAssertion");var b6=class extends Ku{static{s(this,"AuthorizationCodeClient")}constructor(e,r){super(e,r),this.includeRedirectUri=!0,this.oidcDefaultScopes=this.config.authOptions.authority.options.OIDCOptions?.defaultScopes}async acquireToken(e,r){if(this.performanceClient?.addQueueMeasurement(Ye.AuthClientAcquireToken,e.correlationId),!e.code)throw vt(x2);let n=k0(),i=await uo(this.executeTokenRequest.bind(this),Ye.AuthClientExecuteTokenRequest,this.logger,this.performanceClient,e.correlationId)(this.authority,e),o=i.headers?.[Qs.X_MS_REQUEST_ID],a=new Lc(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin,this.performanceClient);return a.validateTokenResponse(i.body),uo(a.handleServerTokenResponse.bind(a),Ye.HandleServerTokenResponse,this.logger,this.performanceClient,e.correlationId)(i.body,this.authority,n,e,r,void 0,void 0,void 0,o)}getLogoutUri(e){if(!e)throw vs(N2);let r=this.createLogoutUrlQueryString(e);return Mi.appendQueryString(this.authority.endSessionEndpoint,r)}async executeTokenRequest(e,r){this.performanceClient?.addQueueMeasurement(Ye.AuthClientExecuteTokenRequest,r.correlationId);let n=this.createTokenQueryParameters(r),i=Mi.appendQueryString(e.tokenEndpoint,n),o=await uo(this.createTokenRequestBody.bind(this),Ye.AuthClientCreateTokenRequestBody,this.logger,this.performanceClient,r.correlationId)(r),a;if(r.clientInfo)try{let u=GD(r.clientInfo,this.cryptoUtils.base64Decode);a={credential:`${u.uid}${lc.CLIENT_INFO_SEPARATOR}${u.utid}`,type:Af.HOME_ACCOUNT_ID}}catch(u){this.logger.verbose("Could not parse client info for CCS Header: "+u)}let c=this.createTokenRequestHeaders(a||r.ccsCredential),l=KD(this.config.authOptions.clientId,r);return uo(this.executePostToTokenEndpoint.bind(this),Ye.AuthorizationCodeClientExecutePostToTokenEndpoint,this.logger,this.performanceClient,r.correlationId)(i,o,c,l,r.correlationId,Ye.AuthorizationCodeClientExecutePostToTokenEndpoint)}async createTokenRequestBody(e){this.performanceClient?.addQueueMeasurement(Ye.AuthClientCreateTokenRequestBody,e.correlationId);let r=new Map;if(H2(r,e.embeddedClientId||e.tokenBodyParameters?.[IC]||this.config.authOptions.clientId),this.includeRedirectUri)$2(r,e.redirectUri);else if(!e.redirectUri)throw vs(R2);if(q2(r,e.scopes,!0,this.oidcDefaultScopes),Zhe(r,e.code),a6(r,this.config.libraryInfo),c6(r,this.config.telemetry.application),y6(r),this.serverTelemetryManager&&!BV(this.config)&&A6(r,this.serverTelemetryManager),e.codeVerifier&&tge(r,e.codeVerifier),this.config.clientCredentials.clientSecret&&u6(r,this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion){let i=this.config.clientCredentials.clientAssertion;d6(r,await Cf(i.assertion,this.config.authOptions.clientId,e.resourceRequestUri)),f6(r,i.assertionType)}if(p6(r,hp.AUTHORIZATION_CODE_GRANT),G2(r),e.authenticationScheme===lo.POP){let i=new tT(this.cryptoUtils,this.performanceClient),o;e.popKid?o=this.cryptoUtils.encodeKid(e.popKid):o=(await uo(i.generateCnf.bind(i),Ye.PopTokenGenerateCnf,this.logger,this.performanceClient,e.correlationId)(e,this.logger)).reqCnfString,h6(r,o)}else if(e.authenticationScheme===lo.SSH)if(e.sshJwk)g6(r,e.sshJwk);else throw vs(rx);(!Na.isEmptyObj(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&W2(r,e.claims,this.config.authOptions.clientCapabilities);let n;if(e.clientInfo)try{let i=GD(e.clientInfo,this.cryptoUtils.base64Decode);n={credential:`${i.uid}${lc.CLIENT_INFO_SEPARATOR}${i.utid}`,type:Af.HOME_ACCOUNT_ID}}catch(i){this.logger.verbose("Could not parse client info for CCS Header: "+i)}else n=e.ccsCredential;if(this.config.systemOptions.preventCorsPreflight&&n)switch(n.type){case Af.HOME_ACCOUNT_ID:try{let i=EC(n.credential);nx(r,i)}catch(i){this.logger.verbose("Could not parse home account ID for CCS Header: "+i)}break;case Af.UPN:XI(r,n.credential);break}return e.embeddedClientId&&ox(r,this.config.authOptions.clientId,this.config.authOptions.redirectUri),e.tokenBodyParameters&&ix(r,e.tokenBodyParameters),e.enableSpaAuthorizationCode&&(!e.tokenBodyParameters||!e.tokenBodyParameters[FV])&&ix(r,{[FV]:"1"}),U2(r,e.correlationId,this.performanceClient),bC(r)}createLogoutUrlQueryString(e){let r=new Map;return e.postLogoutRedirectUri&&zhe(r,e.postLogoutRedirectUri),e.correlationId&&j2(r,e.correlationId),e.idTokenHint&&Khe(r,e.idTokenHint),e.state&&l6(r,e.state),e.logoutHint&&rge(r,e.logoutHint),e.extraQueryParameters&&ix(r,e.extraQueryParameters),this.config.authOptions.instanceAware&&m6(r),bC(r,this.config.authOptions.encodeExtraQueryParams,e.extraQueryParameters)}};d();var YDt=300,V2=class extends Ku{static{s(this,"RefreshTokenClient")}constructor(e,r){super(e,r)}async acquireToken(e){this.performanceClient?.addQueueMeasurement(Ye.RefreshTokenClientAcquireToken,e.correlationId);let r=k0(),n=await uo(this.executeTokenRequest.bind(this),Ye.RefreshTokenClientExecuteTokenRequest,this.logger,this.performanceClient,e.correlationId)(e,this.authority),i=n.headers?.[Qs.X_MS_REQUEST_ID],o=new Lc(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin);return o.validateTokenResponse(n.body),uo(o.handleServerTokenResponse.bind(o),Ye.HandleServerTokenResponse,this.logger,this.performanceClient,e.correlationId)(n.body,this.authority,r,e,void 0,void 0,!0,e.forceCache,i)}async acquireTokenByRefreshToken(e){if(!e)throw vs(B2);if(this.performanceClient?.addQueueMeasurement(Ye.RefreshTokenClientAcquireTokenByRefreshToken,e.correlationId),!e.account)throw vt(Jv);if(this.cacheManager.isAppMetadataFOCI(e.account.environment))try{return await uo(this.acquireTokenWithCachedRefreshToken.bind(this),Ye.RefreshTokenClientAcquireTokenWithCachedRefreshToken,this.logger,this.performanceClient,e.correlationId)(e,!0)}catch(n){let i=n instanceof P0&&n.errorCode===ZI,o=n instanceof yf&&n.errorCode===T9.INVALID_GRANT_ERROR&&n.subError===T9.CLIENT_MISMATCH_ERROR;if(i||o)return uo(this.acquireTokenWithCachedRefreshToken.bind(this),Ye.RefreshTokenClientAcquireTokenWithCachedRefreshToken,this.logger,this.performanceClient,e.correlationId)(e,!1);throw n}return uo(this.acquireTokenWithCachedRefreshToken.bind(this),Ye.RefreshTokenClientAcquireTokenWithCachedRefreshToken,this.logger,this.performanceClient,e.correlationId)(e,!1)}async acquireTokenWithCachedRefreshToken(e,r){this.performanceClient?.addQueueMeasurement(Ye.RefreshTokenClientAcquireTokenWithCachedRefreshToken,e.correlationId);let n=lOe(this.cacheManager.getRefreshToken.bind(this.cacheManager),Ye.CacheManagerGetRefreshToken,this.logger,this.performanceClient,e.correlationId)(e.account,r,e.correlationId,void 0,this.performanceClient);if(!n)throw VV(ZI);if(n.expiresOn&&HD(n.expiresOn,e.refreshTokenExpirationOffsetSeconds||YDt))throw this.performanceClient?.addFields({rtExpiresOnMs:Number(n.expiresOn)},e.correlationId),VV(E6);let i={...e,refreshToken:n.secret,authenticationScheme:e.authenticationScheme||lo.BEARER,ccsCredential:{credential:e.account.homeAccountId,type:Af.HOME_ACCOUNT_ID}};try{return await uo(this.acquireToken.bind(this),Ye.RefreshTokenClientAcquireToken,this.logger,this.performanceClient,e.correlationId)(i)}catch(o){if(o instanceof P0&&(this.performanceClient?.addFields({rtExpiresOnMs:Number(n.expiresOn)},e.correlationId),o.subError===eT)){this.logger.verbose("acquireTokenWithRefreshToken: bad refresh token, removing from cache");let a=G9(n);this.cacheManager.removeRefreshToken(a,e.correlationId)}throw o}}async executeTokenRequest(e,r){this.performanceClient?.addQueueMeasurement(Ye.RefreshTokenClientExecuteTokenRequest,e.correlationId);let n=this.createTokenQueryParameters(e),i=Mi.appendQueryString(r.tokenEndpoint,n),o=await uo(this.createTokenRequestBody.bind(this),Ye.RefreshTokenClientCreateTokenRequestBody,this.logger,this.performanceClient,e.correlationId)(e),a=this.createTokenRequestHeaders(e.ccsCredential),c=KD(this.config.authOptions.clientId,e);return uo(this.executePostToTokenEndpoint.bind(this),Ye.RefreshTokenClientExecutePostToTokenEndpoint,this.logger,this.performanceClient,e.correlationId)(i,o,a,c,e.correlationId,Ye.RefreshTokenClientExecutePostToTokenEndpoint)}async createTokenRequestBody(e){this.performanceClient?.addQueueMeasurement(Ye.RefreshTokenClientCreateTokenRequestBody,e.correlationId);let r=new Map;if(H2(r,e.embeddedClientId||e.tokenBodyParameters?.[IC]||this.config.authOptions.clientId),e.redirectUri&&$2(r,e.redirectUri),q2(r,e.scopes,!0,this.config.authOptions.authority.options.OIDCOptions?.defaultScopes),p6(r,hp.REFRESH_TOKEN_GRANT),G2(r),a6(r,this.config.libraryInfo),c6(r,this.config.telemetry.application),y6(r),this.serverTelemetryManager&&!BV(this.config)&&A6(r,this.serverTelemetryManager),ege(r,e.refreshToken),this.config.clientCredentials.clientSecret&&u6(r,this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion){let n=this.config.clientCredentials.clientAssertion;d6(r,await Cf(n.assertion,this.config.authOptions.clientId,e.resourceRequestUri)),f6(r,n.assertionType)}if(e.authenticationScheme===lo.POP){let n=new tT(this.cryptoUtils,this.performanceClient),i;e.popKid?i=this.cryptoUtils.encodeKid(e.popKid):i=(await uo(n.generateCnf.bind(n),Ye.PopTokenGenerateCnf,this.logger,this.performanceClient,e.correlationId)(e,this.logger)).reqCnfString,h6(r,i)}else if(e.authenticationScheme===lo.SSH)if(e.sshJwk)g6(r,e.sshJwk);else throw vs(rx);if((!Na.isEmptyObj(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&W2(r,e.claims,this.config.authOptions.clientCapabilities),this.config.systemOptions.preventCorsPreflight&&e.ccsCredential)switch(e.ccsCredential.type){case Af.HOME_ACCOUNT_ID:try{let n=EC(e.ccsCredential.credential);nx(r,n)}catch(n){this.logger.verbose("Could not parse home account ID for CCS Header: "+n)}break;case Af.UPN:XI(r,e.ccsCredential.credential);break}return e.embeddedClientId&&ox(r,this.config.authOptions.clientId,this.config.authOptions.redirectUri),e.tokenBodyParameters&&ix(r,e.tokenBodyParameters),U2(r,e.correlationId,this.performanceClient),bC(r)}};d();var I6=class extends Ku{static{s(this,"SilentFlowClient")}constructor(e,r){super(e,r)}async acquireCachedToken(e){this.performanceClient?.addQueueMeasurement(Ye.SilentFlowClientAcquireCachedToken,e.correlationId);let r=_s.NOT_APPLICABLE;if(e.forceRefresh||!this.config.cacheOptions.claimsBasedCachingEnabled&&!Na.isEmptyObj(e.claims))throw this.setCacheOutcome(_s.FORCE_REFRESH_OR_CLAIMS,e.correlationId),vt(Zv);if(!e.account)throw vt(Jv);let n=e.account.tenantId||uOe(e.authority),i=this.cacheManager.getTokenKeys(),o=this.cacheManager.getAccessToken(e.account,e,i,n);if(o){if(Xme(o.cachedAt)||HD(o.expiresOn,this.config.systemOptions.tokenRenewalOffsetSeconds))throw this.setCacheOutcome(_s.CACHED_ACCESS_TOKEN_EXPIRED,e.correlationId),vt(Zv);o.refreshOn&&HD(o.refreshOn,0)&&(r=_s.PROACTIVELY_REFRESHED)}else throw this.setCacheOutcome(_s.NO_CACHED_ACCESS_TOKEN,e.correlationId),vt(Zv);let a=e.authority||this.authority.getPreferredCache(),c={account:this.cacheManager.readAccountFromCache(e.account,e.correlationId),accessToken:o,idToken:this.cacheManager.getIdToken(e.account,e.correlationId,i,n,this.performanceClient),refreshToken:null,appMetadata:this.cacheManager.readAppMetadataFromCache(a)};return this.setCacheOutcome(r,e.correlationId),this.config.serverTelemetryManager&&this.config.serverTelemetryManager.incrementCacheHits(),[await uo(this.generateResultFromCacheRecord.bind(this),Ye.SilentFlowClientGenerateResultFromCacheRecord,this.logger,this.performanceClient,e.correlationId)(c,e),r]}setCacheOutcome(e,r){this.serverTelemetryManager?.setCacheOutcome(e),this.performanceClient?.addFields({cacheOutcome:e},r),e!==_s.NOT_APPLICABLE&&this.logger.info(`Token refresh is required due to cache outcome: ${e}`)}async generateResultFromCacheRecord(e,r){this.performanceClient?.addQueueMeasurement(Ye.SilentFlowClientGenerateResultFromCacheRecord,r.correlationId);let n;if(e.idToken&&(n=tx(e.idToken.secret,this.config.cryptoInterface.base64Decode)),r.maxAge||r.maxAge===0){let i=n?.auth_time;if(!i)throw vt(Yv);W9(i,r.maxAge)}return Lc.generateAuthenticationResult(this.cryptoUtils,this.authority,e,!0,r,n)}};var T6={};Ia(T6,{getAuthorizationCodePayload:()=>ZDt,getAuthorizeUrl:()=>XDt,getStandardAuthorizeRequestParameters:()=>JDt,validateAuthorizationResponse:()=>pOe});d();function JDt(t,e,r,n){let i=e.correlationId,o=new Map;H2(o,e.embeddedClientId||e.extraQueryParameters?.[IC]||t.clientId);let a=[...e.scopes||[],...e.extraScopesToConsent||[]];if(q2(o,a,!0,t.authority.options.OIDCOptions?.defaultScopes),$2(o,e.redirectUri),j2(o,i),Vhe(o,e.responseMode),G2(o),e.prompt&&(Jhe(o,e.prompt),n?.addFields({prompt:e.prompt},i)),e.domainHint&&(Yhe(o,e.domainHint),n?.addFields({domainHintFromRequest:!0},i)),e.prompt!==HI.SELECT_ACCOUNT)if(e.sid&&e.prompt===HI.NONE)r.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from request"),QV(o,e.sid),n?.addFields({sidFromRequest:!0},i);else if(e.account){let c=tBt(e.account),l=rBt(e.account);if(l&&e.domainHint&&(r.warning('AuthorizationCodeClient.createAuthCodeUrlQueryString: "domainHint" param is set, skipping opaque "login_hint" claim. Please consider not passing domainHint'),l=null),l){r.verbose("createAuthCodeUrlQueryString: login_hint claim present on account"),zD(o,l),n?.addFields({loginHintFromClaim:!0},i);try{let u=EC(e.account.homeAccountId);nx(o,u)}catch{r.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}else if(c&&e.prompt===HI.NONE){r.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from account"),QV(o,c),n?.addFields({sidFromClaim:!0},i);try{let u=EC(e.account.homeAccountId);nx(o,u)}catch{r.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}else if(e.loginHint)r.verbose("createAuthCodeUrlQueryString: Adding login_hint from request"),zD(o,e.loginHint),XI(o,e.loginHint),n?.addFields({loginHintFromRequest:!0},i);else if(e.account.username){r.verbose("createAuthCodeUrlQueryString: Adding login_hint from account"),zD(o,e.account.username),n?.addFields({loginHintFromUpn:!0},i);try{let u=EC(e.account.homeAccountId);nx(o,u)}catch{r.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}}else e.loginHint&&(r.verbose("createAuthCodeUrlQueryString: No account, adding login_hint from request"),zD(o,e.loginHint),XI(o,e.loginHint),n?.addFields({loginHintFromRequest:!0},i));else r.verbose("createAuthCodeUrlQueryString: Prompt is select_account, ignoring account hints");return e.nonce&&Xhe(o,e.nonce),e.state&&l6(o,e.state),(e.claims||t.clientCapabilities&&t.clientCapabilities.length>0)&&W2(o,e.claims,t.clientCapabilities),e.embeddedClientId&&ox(o,t.clientId,t.redirectUri),t.instanceAware&&(!e.extraQueryParameters||!Object.keys(e.extraQueryParameters).includes(VD))&&m6(o),o}s(JDt,"getStandardAuthorizeRequestParameters");function XDt(t,e,r,n){let i=bC(e,r,n);return Mi.appendQueryString(t.authorizationEndpoint,i)}s(XDt,"getAuthorizeUrl");function ZDt(t,e){if(pOe(t,e),!t.code)throw vt(w2);return t}s(ZDt,"getAuthorizationCodePayload");function pOe(t,e){if(!t.state||!e)throw t.state?vt(jI,"Cached State"):vt(jI,"Server State");let r,n;try{r=decodeURIComponent(t.state)}catch{throw vt(mA,t.state)}try{n=decodeURIComponent(e)}catch{throw vt(mA,t.state)}if(r!==n)throw vt(A2);if(t.error||t.error_description||t.suberror){let i=eBt(t);throw GV(t.error,t.error_description,t.suberror)?new P0(t.error||"",t.error_description,t.suberror,t.timestamp||"",t.trace_id||"",t.correlation_id||"",t.claims||"",i):new yf(t.error||"",t.error_description,t.suberror,i)}}s(pOe,"validateAuthorizationResponse");function eBt(t){let e="code=",r=t.error_uri?.lastIndexOf(e);return r&&r>=0?t.error_uri?.substring(r+e.length):void 0}s(eBt,"parseServerErrorNo");function tBt(t){return t.idTokenClaims?.sid||null}s(tBt,"extractAccountSid");function rBt(t){return t.idTokenClaims?.login_hint||null}s(rBt,"extractLoginHint");d();var mOe=",",hOe="|";function nBt(t){let{skus:e,libraryName:r,libraryVersion:n,extensionName:i,extensionVersion:o}=t,a=new Map([[0,[r,n]],[2,[i,o]]]),c=[];if(e?.length){if(c=e.split(mOe),c.length<4)return e}else c=Array.from({length:4},()=>hOe);return a.forEach((l,u)=>{l.length===2&&l[0]?.length&&l[1]?.length&&iBt({skuArr:c,index:u,skuName:l[0],skuVersion:l[1]})}),c.join(mOe)}s(nBt,"makeExtraSkuString");function iBt(t){let{skuArr:e,index:r,skuName:n,skuVersion:i}=t;r>=e.length||(e[r]=[n,i].join(hOe))}s(iBt,"setSku");var z2=class t{static{s(this,"ServerTelemetryManager")}constructor(e,r){this.cacheOutcome=_s.NOT_APPLICABLE,this.cacheManager=r,this.apiId=e.apiId,this.correlationId=e.correlationId,this.wrapperSKU=e.wrapperSKU||rt.EMPTY_STRING,this.wrapperVer=e.wrapperVer||rt.EMPTY_STRING,this.telemetryCacheKey=Nl.CACHE_KEY+lc.CACHE_KEY_SEPARATOR+e.clientId}generateCurrentRequestHeaderValue(){let e=`${this.apiId}${Nl.VALUE_SEPARATOR}${this.cacheOutcome}`,r=[this.wrapperSKU,this.wrapperVer],n=this.getNativeBrokerErrorCode();n?.length&&r.push(`broker_error=${n}`);let i=r.join(Nl.VALUE_SEPARATOR),o=this.getRegionDiscoveryFields(),a=[e,o].join(Nl.VALUE_SEPARATOR);return[Nl.SCHEMA_VERSION,a,i].join(Nl.CATEGORY_SEPARATOR)}generateLastRequestHeaderValue(){let e=this.getLastRequests(),r=t.maxErrorsToSend(e),n=e.failedRequests.slice(0,2*r).join(Nl.VALUE_SEPARATOR),i=e.errors.slice(0,r).join(Nl.VALUE_SEPARATOR),o=e.errors.length,a=r<o?Nl.OVERFLOW_TRUE:Nl.OVERFLOW_FALSE,c=[o,a].join(Nl.VALUE_SEPARATOR);return[Nl.SCHEMA_VERSION,e.cacheHits,n,i,c].join(Nl.CATEGORY_SEPARATOR)}cacheFailedRequest(e){let r=this.getLastRequests();r.errors.length>=Nl.MAX_CACHED_ERRORS&&(r.failedRequests.shift(),r.failedRequests.shift(),r.errors.shift()),r.failedRequests.push(this.apiId,this.correlationId),e instanceof Error&&e&&e.toString()?e instanceof ai?e.subError?r.errors.push(e.subError):e.errorCode?r.errors.push(e.errorCode):r.errors.push(e.toString()):r.errors.push(e.toString()):r.errors.push(Nl.UNKNOWN_ERROR),this.cacheManager.setServerTelemetry(this.telemetryCacheKey,r,this.correlationId)}incrementCacheHits(){let e=this.getLastRequests();return e.cacheHits+=1,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,e,this.correlationId),e.cacheHits}getLastRequests(){let e={failedRequests:[],errors:[],cacheHits:0};return this.cacheManager.getServerTelemetry(this.telemetryCacheKey)||e}clearTelemetryCache(){let e=this.getLastRequests(),r=t.maxErrorsToSend(e),n=e.errors.length;if(r===n)this.cacheManager.removeItem(this.telemetryCacheKey,this.correlationId);else{let i={failedRequests:e.failedRequests.slice(r*2),errors:e.errors.slice(r),cacheHits:0};this.cacheManager.setServerTelemetry(this.telemetryCacheKey,i,this.correlationId)}}static maxErrorsToSend(e){let r,n=0,i=0,o=e.errors.length;for(r=0;r<o;r++){let a=e.failedRequests[2*r]||rt.EMPTY_STRING,c=e.failedRequests[2*r+1]||rt.EMPTY_STRING,l=e.errors[r]||rt.EMPTY_STRING;if(i+=a.toString().length+c.toString().length+l.length+3,i<Nl.MAX_LAST_HEADER_BYTES)n+=1;else break}return n}getRegionDiscoveryFields(){let e=[];return e.push(this.regionUsed||rt.EMPTY_STRING),e.push(this.regionSource||rt.EMPTY_STRING),e.push(this.regionOutcome||rt.EMPTY_STRING),e.join(",")}updateRegionDiscoveryMetadata(e){this.regionUsed=e.region_used,this.regionSource=e.region_source,this.regionOutcome=e.region_outcome}setCacheOutcome(e){this.cacheOutcome=e}setNativeBrokerErrorCode(e){let r=this.getLastRequests();r.nativeBrokerErrorCode=e,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,r,this.correlationId)}getNativeBrokerErrorCode(){return this.getLastRequests().nativeBrokerErrorCode}clearNativeBrokerErrorCode(){let e=this.getLastRequests();delete e.nativeBrokerErrorCode,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,e,this.correlationId)}static makeExtraSkuString(e){return nBt(e)}};var sx=class{static{s(this,"Deserializer")}static deserializeJSONBlob(e){return e?JSON.parse(e):{}}static deserializeAccounts(e){let r={};return e&&Object.keys(e).map(function(n){let i=e[n],o={homeAccountId:i.home_account_id,environment:i.environment,realm:i.realm,localAccountId:i.local_account_id,username:i.username,authorityType:i.authority_type,name:i.name,clientInfo:i.client_info,lastModificationTime:i.last_modification_time,lastModificationApp:i.last_modification_app,tenantProfiles:i.tenantProfiles?.map(c=>JSON.parse(c))},a=new Vu;JI.toObject(a,o),r[n]=a}),r}static deserializeIdTokens(e){let r={};return e&&Object.keys(e).map(function(n){let i=e[n],o={homeAccountId:i.home_account_id,environment:i.environment,credentialType:i.credential_type,clientId:i.client_id,secret:i.secret,realm:i.realm};r[n]=o}),r}static deserializeAccessTokens(e){let r={};return e&&Object.keys(e).map(function(n){let i=e[n],o={homeAccountId:i.home_account_id,environment:i.environment,credentialType:i.credential_type,clientId:i.client_id,secret:i.secret,realm:i.realm,target:i.target,cachedAt:i.cached_at,expiresOn:i.expires_on,extendedExpiresOn:i.extended_expires_on,refreshOn:i.refresh_on,keyId:i.key_id,tokenType:i.token_type,requestedClaims:i.requestedClaims,requestedClaimsHash:i.requestedClaimsHash,userAssertionHash:i.userAssertionHash};r[n]=o}),r}static deserializeRefreshTokens(e){let r={};return e&&Object.keys(e).map(function(n){let i=e[n],o={homeAccountId:i.home_account_id,environment:i.environment,credentialType:i.credential_type,clientId:i.client_id,secret:i.secret,familyId:i.family_id,target:i.target,realm:i.realm};r[n]=o}),r}static deserializeAppMetadata(e){let r={};return e&&Object.keys(e).map(function(n){let i=e[n];r[n]={clientId:i.client_id,environment:i.environment,familyId:i.family_id}}),r}static deserializeAllCache(e){return{accounts:e.Account?this.deserializeAccounts(e.Account):{},idTokens:e.IdToken?this.deserializeIdTokens(e.IdToken):{},accessTokens:e.AccessToken?this.deserializeAccessTokens(e.AccessToken):{},refreshTokens:e.RefreshToken?this.deserializeRefreshTokens(e.RefreshToken):{},appMetadata:e.AppMetadata?this.deserializeAppMetadata(e.AppMetadata):{}}}};d();d();var gOe="system_assigned_managed_identity",uBt="managed_identity",uge=`https://login.microsoftonline.com/${uBt}/`,gp={AUTHORIZATION_HEADER_NAME:"Authorization",METADATA_HEADER_NAME:"Metadata",APP_SERVICE_SECRET_HEADER_NAME:"X-IDENTITY-HEADER",ML_AND_SF_SECRET_HEADER_NAME:"secret"},il={API_VERSION:"api-version",RESOURCE:"resource",SHA256_TOKEN_TO_REFRESH:"token_sha256_to_refresh",XMS_CC:"xms_cc"},Hn={AZURE_POD_IDENTITY_AUTHORITY_HOST:"AZURE_POD_IDENTITY_AUTHORITY_HOST",DEFAULT_IDENTITY_CLIENT_ID:"DEFAULT_IDENTITY_CLIENT_ID",IDENTITY_ENDPOINT:"IDENTITY_ENDPOINT",IDENTITY_HEADER:"IDENTITY_HEADER",IDENTITY_SERVER_THUMBPRINT:"IDENTITY_SERVER_THUMBPRINT",IMDS_ENDPOINT:"IMDS_ENDPOINT",MSI_ENDPOINT:"MSI_ENDPOINT",MSI_SECRET:"MSI_SECRET"},Zn={APP_SERVICE:"AppService",AZURE_ARC:"AzureArc",CLOUD_SHELL:"CloudShell",DEFAULT_TO_IMDS:"DefaultToImds",IMDS:"Imds",MACHINE_LEARNING:"MachineLearning",SERVICE_FABRIC:"ServiceFabric"},Ja={SYSTEM_ASSIGNED:"system-assigned",USER_ASSIGNED_CLIENT_ID:"user-assigned-client-id",USER_ASSIGNED_RESOURCE_ID:"user-assigned-resource-id",USER_ASSIGNED_OBJECT_ID:"user-assigned-object-id"},ia={GET:"get",POST:"post"},KV={SUCCESS_RANGE_START:si.SUCCESS_RANGE_START,SUCCESS_RANGE_END:si.SUCCESS_RANGE_END,SERVER_ERROR:si.SERVER_ERROR},AOe="REGION_NAME",yOe="MSAL_FORCE_REGION",COe=32,vOe={SHA256:"sha256"},YV={CV_CHARSET:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~"},Ll={MSAL_SKU:"msal.js.node",JWT_BEARER_ASSERTION_TYPE:"urn:ietf:params:oauth:client-assertion-type:jwt-bearer",AUTHORIZATION_PENDING:"authorization_pending",HTTP_PROTOCOL:"http://",LOCALHOST:"localhost"},ax={acquireTokenSilent:62,acquireTokenByUsernamePassword:371,acquireTokenByDeviceCode:671,acquireTokenByClientCredential:771,acquireTokenByCode:871,acquireTokenByRefreshToken:872},th={RSA_256:"RS256",PSS_256:"PS256",X5T_256:"x5t#S256",X5T:"x5t",X5C:"x5c",AUDIENCE:"aud",EXPIRATION_TIME:"exp",ISSUER:"iss",SUBJECT:"sub",NOT_BEFORE:"nbf",JWT_ID:"jti"},JV={INTERVAL_MS:100,TIMEOUT_MS:5e3},xOe=4096;d();d();d();d();var YD=class{static{s(this,"NetworkUtils")}static getNetworkResponse(e,r,n){return{headers:e,body:r,status:n}}static urlToHttpOptions(e){let r={protocol:e.protocol,hostname:e.hostname&&e.hostname.startsWith("[")?e.hostname.slice(1,-1):e.hostname,hash:e.hash,search:e.search,pathname:e.pathname,path:`${e.pathname||""}${e.search||""}`,href:e.href};return e.port!==""&&(r.port=Number(e.port)),(e.username||e.password)&&(r.auth=`${decodeURIComponent(e.username)}:${decodeURIComponent(e.password)}`),r}};var XV=Be(require("http"),1),dge=Be(require("https"),1);var JD=class{static{s(this,"HttpClient")}constructor(e,r){this.proxyUrl=e||"",this.customAgentOptions=r||{}}async sendGetRequestAsync(e,r,n){return this.proxyUrl?EOe(e,this.proxyUrl,ia.GET,r,this.customAgentOptions,n):bOe(e,ia.GET,r,this.customAgentOptions,n)}async sendPostRequestAsync(e,r){return this.proxyUrl?EOe(e,this.proxyUrl,ia.POST,r,this.customAgentOptions):bOe(e,ia.POST,r,this.customAgentOptions)}},EOe=s((t,e,r,n,i,o)=>{let a=new URL(t),c=new URL(e),l=n?.headers||{},u={host:c.hostname,port:c.port,method:"CONNECT",path:a.hostname,headers:l};i&&Object.keys(i).length&&(u.agent=new XV.default.Agent(i));let f="";if(r===ia.POST){let m=n?.body||"";f=`Content-Type: application/x-www-form-urlencoded\r
Content-Length: ${m.length}\r
\r
${m}`}else o&&(u.timeout=o);let p=`${r.toUpperCase()} ${a.href} HTTP/1.1\r
Host: ${a.host}\r
Connection: close\r
`+f+`\r
`;return new Promise((m,h)=>{let g=XV.default.request(u);o&&g.on("timeout",()=>{g.destroy(),h(new Error("Request time out"))}),g.end(),g.on("connect",(A,y)=>{let E=A?.statusCode||KV.SERVER_ERROR;(E<KV.SUCCESS_RANGE_START||E>KV.SUCCESS_RANGE_END)&&(g.destroy(),y.destroy(),h(new Error(`Error connecting to proxy. Http status code: ${A.statusCode}. Http status message: ${A?.statusMessage||"Unknown"}`))),y.write(p);let b=[];y.on("data",S=>{b.push(S)}),y.on("end",()=>{let R=Buffer.concat([...b]).toString().split(`\r
`),B=parseInt(R[0].split(" ")[1]),L=R[0].split(" ").slice(2).join(" "),O=R[R.length-1],Y=R.slice(1,R.length-2),V=new Map;Y.forEach(Z=>{let J=Z.split(new RegExp(/:\s(.*)/s)),j=J[0],W=J[1];try{let X=JSON.parse(W);X&&typeof X=="object"&&(W=X)}catch{}V.set(j,W)});let Q=Object.fromEntries(V),U=YD.getNetworkResponse(Q,IOe(B,L,Q,O),B);(B<si.SUCCESS_RANGE_START||B>si.SUCCESS_RANGE_END)&&U.body.error!==Ll.AUTHORIZATION_PENDING&&g.destroy(),m(U)}),y.on("error",S=>{g.destroy(),y.destroy(),h(new Error(S.toString()))})}),g.on("error",A=>{g.destroy(),h(new Error(A.toString()))})})},"networkRequestViaProxy"),bOe=s((t,e,r,n,i)=>{let o=e===ia.POST,a=r?.body||"",c=new URL(t),l=r?.headers||{},u={method:e,headers:l,...YD.urlToHttpOptions(c)};return n&&Object.keys(n).length&&(u.agent=new dge.default.Agent(n)),o?u.headers={...u.headers,"Content-Length":a.length}:i&&(u.timeout=i),new Promise((f,p)=>{let m;u.protocol==="http:"?m=XV.default.request(u):m=dge.default.request(u),o&&m.write(a),i&&m.on("timeout",()=>{m.destroy(),p(new Error("Request time out"))}),m.end(),m.on("response",h=>{let g=h.headers,A=h.statusCode,y=h.statusMessage,E=[];h.on("data",b=>{E.push(b)}),h.on("end",()=>{let b=Buffer.concat([...E]).toString(),S=g,R=YD.getNetworkResponse(S,IOe(A,y,S,b),A);(A<si.SUCCESS_RANGE_START||A>si.SUCCESS_RANGE_END)&&R.body.error!==Ll.AUTHORIZATION_PENDING&&m.destroy(),f(R)})}),m.on("error",h=>{m.destroy(),p(new Error(h.toString()))})})},"networkRequestViaHttps"),IOe=s((t,e,r,n)=>{let i;try{i=JSON.parse(n)}catch{let a,c;t>=si.CLIENT_ERROR_RANGE_START&&t<=si.CLIENT_ERROR_RANGE_END?(a="client_error",c="A client"):t>=si.SERVER_ERROR_RANGE_START&&t<=si.SERVER_ERROR_RANGE_END?(a="server_error",c="A server"):(a="unknown_error",c="An unknown"),i={error:a,error_description:`${c} error occured.
Http status code: ${t}
Http status message: ${e||"Unknown"}
Headers: ${JSON.stringify(r)}`}}return i},"parseBody");d();d();d();var ZV="invalid_file_extension",ez="invalid_file_path",rT="invalid_managed_identity_id_type",tz="invalid_secret",TOe="missing_client_id",wOe="network_unavailable",rz="platform_not_supported",nz="unable_to_create_azure_arc",iz="unable_to_create_cloud_shell",oz="unable_to_create_source",w6="unable_to_read_secret_file",SOe="user_assigned_not_available_at_runtime",sz="www_authenticate_header_missing",az="www_authenticate_header_unsupported_format",K2={[Hn.AZURE_POD_IDENTITY_AUTHORITY_HOST]:"azure_pod_identity_authority_host_url_malformed",[Hn.IDENTITY_ENDPOINT]:"identity_endpoint_url_malformed",[Hn.IMDS_ENDPOINT]:"imds_endpoint_url_malformed",[Hn.MSI_ENDPOINT]:"msi_endpoint_url_malformed"};var dBt={[ZV]:"The file path in the WWW-Authenticate header does not contain a .key file.",[ez]:"The file path in the WWW-Authenticate header is not in a valid Windows or Linux Format.",[rT]:"More than one ManagedIdentityIdType was provided.",[tz]:"The secret in the file on the file path in the WWW-Authenticate header is greater than 4096 bytes.",[rz]:"The platform is not supported by Azure Arc. Azure Arc only supports Windows and Linux.",[TOe]:"A ManagedIdentityId id was not provided.",[K2.AZURE_POD_IDENTITY_AUTHORITY_HOST]:`The Managed Identity's '${Hn.AZURE_POD_IDENTITY_AUTHORITY_HOST}' environment variable is malformed.`,[K2.IDENTITY_ENDPOINT]:`The Managed Identity's '${Hn.IDENTITY_ENDPOINT}' environment variable is malformed.`,[K2.IMDS_ENDPOINT]:`The Managed Identity's '${Hn.IMDS_ENDPOINT}' environment variable is malformed.`,[K2.MSI_ENDPOINT]:`The Managed Identity's '${Hn.MSI_ENDPOINT}' environment variable is malformed.`,[wOe]:"Authentication unavailable. The request to the managed identity endpoint timed out.",[nz]:"Azure Arc Managed Identities can only be system assigned.",[iz]:"Cloud Shell Managed Identities can only be system assigned.",[oz]:"Unable to create a Managed Identity source based on environment variables.",[w6]:"Unable to read the secret file.",[SOe]:"Service Fabric user assigned managed identity ClientId or ResourceId is not configurable at runtime.",[sz]:"A 401 response was received form the Azure Arc Managed Identity, but the www-authenticate header is missing.",[az]:"A 401 response was received form the Azure Arc Managed Identity, but the www-authenticate header is in an unsupported format."},fge=class t extends ai{static{s(this,"ManagedIdentityError")}constructor(e){super(e,dBt[e]),this.name="ManagedIdentityError",Object.setPrototypeOf(this,t.prototype)}};function Fc(t){return new fge(t)}s(Fc,"createManagedIdentityError");var cz=class{static{s(this,"ManagedIdentityId")}get id(){return this._id}set id(e){this._id=e}get idType(){return this._idType}set idType(e){this._idType=e}constructor(e){let r=e?.userAssignedClientId,n=e?.userAssignedResourceId,i=e?.userAssignedObjectId;if(r){if(n||i)throw Fc(rT);this.id=r,this.idType=Ja.USER_ASSIGNED_CLIENT_ID}else if(n){if(r||i)throw Fc(rT);this.id=n,this.idType=Ja.USER_ASSIGNED_RESOURCE_ID}else if(i){if(r||n)throw Fc(rT);this.id=i,this.idType=Ja.USER_ASSIGNED_OBJECT_ID}else this.id=gOe,this.idType=Ja.SYSTEM_ASSIGNED}};d();var ou={invalidLoopbackAddressType:{code:"invalid_loopback_server_address_type",desc:"Loopback server address is not type string. This is unexpected."},unableToLoadRedirectUri:{code:"unable_to_load_redirectUrl",desc:"Loopback server callback was invoked without a url. This is unexpected."},noAuthCodeInResponse:{code:"no_auth_code_in_response",desc:"No auth code found in the server response. Please check your network trace to determine what happened."},noLoopbackServerExists:{code:"no_loopback_server_exists",desc:"No loopback server exists yet."},loopbackServerAlreadyExists:{code:"loopback_server_already_exists",desc:"Loopback server already exists. Cannot create another."},loopbackServerTimeout:{code:"loopback_server_timeout",desc:"Timed out waiting for auth code listener to be registered."},stateNotFoundError:{code:"state_not_found",desc:"State not found. Please verify that the request originated from msal."},thumbprintMissing:{code:"thumbprint_missing_from_client_certificate",desc:"Client certificate does not contain a SHA-1 or SHA-256 thumbprint."}},Ap=class t extends ai{static{s(this,"NodeAuthError")}constructor(e,r){super(e,r),this.name="NodeAuthError"}static createInvalidLoopbackAddressTypeError(){return new t(ou.invalidLoopbackAddressType.code,`${ou.invalidLoopbackAddressType.desc}`)}static createUnableToLoadRedirectUrlError(){return new t(ou.unableToLoadRedirectUri.code,`${ou.unableToLoadRedirectUri.desc}`)}static createNoAuthCodeInResponseError(){return new t(ou.noAuthCodeInResponse.code,`${ou.noAuthCodeInResponse.desc}`)}static createNoLoopbackServerExistsError(){return new t(ou.noLoopbackServerExists.code,`${ou.noLoopbackServerExists.desc}`)}static createLoopbackServerAlreadyExistsError(){return new t(ou.loopbackServerAlreadyExists.code,`${ou.loopbackServerAlreadyExists.desc}`)}static createLoopbackServerTimeoutError(){return new t(ou.loopbackServerTimeout.code,`${ou.loopbackServerTimeout.desc}`)}static createStateNotFoundError(){return new t(ou.stateNotFoundError.code,ou.stateNotFoundError.desc)}static createThumbprintMissingError(){return new t(ou.thumbprintMissing.code,ou.thumbprintMissing.desc)}};var fBt={clientId:rt.EMPTY_STRING,authority:rt.DEFAULT_AUTHORITY,clientSecret:rt.EMPTY_STRING,clientAssertion:rt.EMPTY_STRING,clientCertificate:{thumbprint:rt.EMPTY_STRING,thumbprintSha256:rt.EMPTY_STRING,privateKey:rt.EMPTY_STRING,x5c:rt.EMPTY_STRING},knownAuthorities:[],cloudDiscoveryMetadata:rt.EMPTY_STRING,authorityMetadata:rt.EMPTY_STRING,clientCapabilities:[],protocolMode:Ld.AAD,azureCloudOptions:{azureCloudInstance:ex.None,tenant:rt.EMPTY_STRING},skipAuthorityMetadataCache:!1,encodeExtraQueryParams:!1},pBt={claimsBasedCachingEnabled:!1},pge={loggerCallback:s(()=>{},"loggerCallback"),piiLoggingEnabled:!1,logLevel:Ya.Info},mBt={loggerOptions:pge,networkClient:new JD,proxyUrl:rt.EMPTY_STRING,customAgentOptions:{},disableInternalRetries:!1},hBt={application:{appName:rt.EMPTY_STRING,appVersion:rt.EMPTY_STRING}};function _Oe({auth:t,broker:e,cache:r,system:n,telemetry:i}){let o={...mBt,networkClient:new JD(n?.proxyUrl,n?.customAgentOptions),loggerOptions:n?.loggerOptions||pge,disableInternalRetries:n?.disableInternalRetries||!1};if(t.clientCertificate&&!t.clientCertificate.thumbprint&&!t.clientCertificate.thumbprintSha256)throw Ap.createStateNotFoundError();return{auth:{...fBt,...t},broker:{...e},cache:{...pBt,...r},system:{...o,...n},telemetry:{...hBt,...i}}}s(_Oe,"buildAppConfiguration");function ROe({clientCapabilities:t,managedIdentityIdParams:e,system:r}){let n=new cz(e),i=r?.loggerOptions||pge,o;return r?.networkClient?o=r.networkClient:o=new JD(r?.proxyUrl,r?.customAgentOptions),{clientCapabilities:t||[],managedIdentityId:n,system:{loggerOptions:i,networkClient:o},disableInternalRetries:r?.disableInternalRetries||!1}}s(ROe,"buildManagedIdentityConfiguration");d();d();d();d();var kOe=Be(require("crypto"));var uz=new Uint8Array(256),lz=uz.length;function mge(){return lz>uz.length-16&&(kOe.default.randomFillSync(uz),lz=0),uz.slice(lz,lz+=16)}s(mge,"rng");d();d();d();var POe=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function gBt(t){return typeof t=="string"&&POe.test(t)}s(gBt,"validate");var DOe=gBt;var Yu=[];for(let t=0;t<256;++t)Yu.push((t+256).toString(16).substr(1));function ABt(t,e=0){let r=(Yu[t[e+0]]+Yu[t[e+1]]+Yu[t[e+2]]+Yu[t[e+3]]+"-"+Yu[t[e+4]]+Yu[t[e+5]]+"-"+Yu[t[e+6]]+Yu[t[e+7]]+"-"+Yu[t[e+8]]+Yu[t[e+9]]+"-"+Yu[t[e+10]]+Yu[t[e+11]]+Yu[t[e+12]]+Yu[t[e+13]]+Yu[t[e+14]]+Yu[t[e+15]]).toLowerCase();if(!DOe(r))throw TypeError("Stringified UUID is invalid");return r}s(ABt,"stringify");var BOe=ABt;d();function yBt(t,e,r){t=t||{};let n=t.random||(t.rng||mge)();if(n[6]=n[6]&15|64,n[8]=n[8]&63|128,e){r=r||0;for(let i=0;i<16;++i)e[r+i]=n[i];return e}return BOe(n)}s(yBt,"v4");var hge=yBt;var XD=class{static{s(this,"GuidGenerator")}generateGuid(){return hge()}isGuid(e){return/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e)}};d();var B0=class t{static{s(this,"EncodingUtils")}static base64Encode(e,r){return Buffer.from(e,r).toString(Gu.BASE64)}static base64EncodeUrl(e,r){return t.base64Encode(e,r).replace(/=/g,rt.EMPTY_STRING).replace(/\+/g,"-").replace(/\//g,"_")}static base64Decode(e){return Buffer.from(e,Gu.BASE64).toString("utf8")}static base64DecodeUrl(e){let r=e.replace(/-/g,"+").replace(/_/g,"/");for(;r.length%4;)r+="=";return t.base64Decode(r)}};d();d();var NOe=Be(require("crypto"),1);var nT=class{static{s(this,"HashUtils")}sha256(e){return NOe.default.createHash(vOe.SHA256).update(e).digest()}};var MOe=Be(require("crypto"),1);var dz=class{static{s(this,"PkceGenerator")}constructor(){this.hashUtils=new nT}async generatePkceCodes(){let e=this.generateCodeVerifier(),r=this.generateCodeChallengeFromVerifier(e);return{verifier:e,challenge:r}}generateCodeVerifier(){let e=[],r=256-256%YV.CV_CHARSET.length;for(;e.length<=COe;){let i=MOe.default.randomBytes(1)[0];if(i>=r)continue;let o=i%YV.CV_CHARSET.length;e.push(YV.CV_CHARSET[o])}let n=e.join(rt.EMPTY_STRING);return B0.base64EncodeUrl(n)}generateCodeChallengeFromVerifier(e){return B0.base64EncodeUrl(this.hashUtils.sha256(e).toString(Gu.BASE64),Gu.BASE64)}};var TC=class{static{s(this,"CryptoProvider")}constructor(){this.pkceGenerator=new dz,this.guidGenerator=new XD,this.hashUtils=new nT}base64UrlEncode(){throw new Error("Method not implemented.")}encodeKid(){throw new Error("Method not implemented.")}createNewGuid(){return this.guidGenerator.generateGuid()}base64Encode(e){return B0.base64Encode(e)}base64Decode(e){return B0.base64Decode(e)}generatePkceCodes(){return this.pkceGenerator.generatePkceCodes()}getPublicKeyThumbprint(){throw new Error("Method not implemented.")}removeTokenBindingKey(){throw new Error("Method not implemented.")}clearKeystore(){throw new Error("Method not implemented.")}signJwt(){throw new Error("Method not implemented.")}async hashString(e){return B0.base64EncodeUrl(this.hashUtils.sha256(e).toString(Gu.BASE64),Gu.BASE64)}};d();d();var iT=class extends JI{static{s(this,"NodeStorage")}constructor(e,r,n,i){super(r,n,e,new O2,i),this.cache={},this.changeEmitters=[],this.logger=e}registerChangeEmitter(e){this.changeEmitters.push(e)}emitChange(){this.changeEmitters.forEach(e=>e.call(null))}cacheToInMemoryCache(e){let r={accounts:{},idTokens:{},accessTokens:{},refreshTokens:{},appMetadata:{}};for(let n in e){let i=e[n];if(typeof i=="object")if(i instanceof Vu)r.accounts[n]=i;else if(Ml.isIdTokenEntity(i))r.idTokens[n]=i;else if(Ml.isAccessTokenEntity(i))r.accessTokens[n]=i;else if(Ml.isRefreshTokenEntity(i))r.refreshTokens[n]=i;else if(Ml.isAppMetadataEntity(n,i))r.appMetadata[n]=i;else continue}return r}inMemoryCacheToCache(e){let r=this.getCache();return r={...r,...e.accounts,...e.idTokens,...e.accessTokens,...e.refreshTokens,...e.appMetadata},r}getInMemoryCache(){return this.logger.trace("Getting in-memory cache"),this.cacheToInMemoryCache(this.getCache())}setInMemoryCache(e){this.logger.trace("Setting in-memory cache");let r=this.inMemoryCacheToCache(e);this.setCache(r),this.emitChange()}getCache(){return this.logger.trace("Getting cache key-value store"),this.cache}setCache(e){this.logger.trace("Setting cache key value store"),this.cache=e,this.emitChange()}getItem(e){return this.logger.tracePii(`Item key: ${e}`),this.getCache()[e]}setItem(e,r){this.logger.tracePii(`Item key: ${e}`);let n=this.getCache();n[e]=r,this.setCache(n)}getAccountKeys(){let e=this.getInMemoryCache();return Object.keys(e.accounts)}getTokenKeys(){let e=this.getInMemoryCache();return{idToken:Object.keys(e.idTokens),accessToken:Object.keys(e.accessTokens),refreshToken:Object.keys(e.refreshTokens)}}getAccount(e){return this.getItem(e)?Object.assign(new Vu,this.getItem(e)):null}async setAccount(e){let r=e.generateAccountKey();this.setItem(r,e)}getIdTokenCredential(e){let r=this.getItem(e);return Ml.isIdTokenEntity(r)?r:null}async setIdTokenCredential(e){let r=Ml.generateCredentialKey(e);this.setItem(r,e)}getAccessTokenCredential(e){let r=this.getItem(e);return Ml.isAccessTokenEntity(r)?r:null}async setAccessTokenCredential(e){let r=Ml.generateCredentialKey(e);this.setItem(r,e)}getRefreshTokenCredential(e){let r=this.getItem(e);return Ml.isRefreshTokenEntity(r)?r:null}async setRefreshTokenCredential(e){let r=Ml.generateCredentialKey(e);this.setItem(r,e)}getAppMetadata(e){let r=this.getItem(e);return Ml.isAppMetadataEntity(e,r)?r:null}setAppMetadata(e){let r=Ml.generateAppMetadataKey(e);this.setItem(r,e)}getServerTelemetry(e){let r=this.getItem(e);return r&&Ml.isServerTelemetryEntity(e,r)?r:null}setServerTelemetry(e,r){this.setItem(e,r)}getAuthorityMetadata(e){let r=this.getItem(e);return r&&Ml.isAuthorityMetadataEntity(e,r)?r:null}getAuthorityMetadataKeys(){return this.getKeys().filter(e=>this.isAuthorityMetadata(e))}setAuthorityMetadata(e,r){this.setItem(e,r)}getThrottlingCache(e){let r=this.getItem(e);return r&&Ml.isThrottlingEntity(e,r)?r:null}setThrottlingCache(e,r){this.setItem(e,r)}removeItem(e){this.logger.tracePii(`Item key: ${e}`);let r=!1,n=this.getCache();return n[e]&&(delete n[e],r=!0),r&&(this.setCache(n),this.emitChange()),r}removeOutdatedAccount(e){this.removeItem(e)}containsKey(e){return this.getKeys().includes(e)}getKeys(){this.logger.trace("Retrieving all cache keys");let e=this.getCache();return[...Object.keys(e)]}clear(){this.logger.trace("Clearing cache entries created by MSAL"),this.getKeys().forEach(r=>{this.removeItem(r)}),this.emitChange()}static generateInMemoryCache(e){return sx.deserializeAllCache(sx.deserializeJSONBlob(e))}static generateJsonCache(e){return qI.serializeAllCache(e)}updateCredentialCacheKey(e,r){let n=Ml.generateCredentialKey(r);if(e!==n){let i=this.getItem(e);if(i)return this.removeItem(e),this.setItem(n,i),this.logger.verbose(`Updated an outdated ${r.credentialType} cache key`),n;this.logger.error(`Attempted to update an outdated ${r.credentialType} cache key but no item matching the outdated key was found in storage`)}return e}};d();var S6={Account:{},IdToken:{},AccessToken:{},RefreshToken:{},AppMetadata:{}},ZD=class{static{s(this,"TokenCache")}constructor(e,r,n){this.cacheHasChanged=!1,this.storage=e,this.storage.registerChangeEmitter(this.handleChangeEvent.bind(this)),n&&(this.persistence=n),this.logger=r}hasChanged(){return this.cacheHasChanged}serialize(){this.logger.trace("Serializing in-memory cache");let e=qI.serializeAllCache(this.storage.getInMemoryCache());return this.cacheSnapshot?(this.logger.trace("Reading cache snapshot from disk"),e=this.mergeState(JSON.parse(this.cacheSnapshot),e)):this.logger.trace("No cache snapshot to merge"),this.cacheHasChanged=!1,JSON.stringify(e)}deserialize(e){if(this.logger.trace("Deserializing JSON to in-memory cache"),this.cacheSnapshot=e,this.cacheSnapshot){this.logger.trace("Reading cache snapshot from disk");let r=sx.deserializeAllCache(this.overlayDefaults(JSON.parse(this.cacheSnapshot)));this.storage.setInMemoryCache(r)}else this.logger.trace("No cache snapshot to deserialize")}getKVStore(){return this.storage.getCache()}getCacheSnapshot(){let e=iT.generateInMemoryCache(this.cacheSnapshot);return this.storage.inMemoryCacheToCache(e)}async getAllAccounts(e=new TC().createNewGuid()){this.logger.trace("getAllAccounts called");let r;try{return this.persistence&&(r=new D0(this,!1),await this.persistence.beforeCacheAccess(r)),this.storage.getAllAccounts({},e)}finally{this.persistence&&r&&await this.persistence.afterCacheAccess(r)}}async getAccountByHomeId(e){let r=await this.getAllAccounts();return e&&r&&r.length&&r.filter(n=>n.homeAccountId===e)[0]||null}async getAccountByLocalId(e){let r=await this.getAllAccounts();return e&&r&&r.length&&r.filter(n=>n.localAccountId===e)[0]||null}async removeAccount(e,r){this.logger.trace("removeAccount called");let n;try{this.persistence&&(n=new D0(this,!0),await this.persistence.beforeCacheAccess(n)),this.storage.removeAccount(Vu.generateAccountCacheKey(e),r||new XD().generateGuid())}finally{this.persistence&&n&&await this.persistence.afterCacheAccess(n)}}async overwriteCache(){if(!this.persistence){this.logger.info("No persistence layer specified, cache cannot be overwritten");return}this.logger.info("Overwriting in-memory cache with persistent cache"),this.storage.clear();let e=new D0(this,!1);await this.persistence.beforeCacheAccess(e);let r=this.getCacheSnapshot();this.storage.setCache(r),await this.persistence.afterCacheAccess(e)}handleChangeEvent(){this.cacheHasChanged=!0}mergeState(e,r){this.logger.trace("Merging in-memory cache with cache snapshot");let n=this.mergeRemovals(e,r);return this.mergeUpdates(n,r)}mergeUpdates(e,r){return Object.keys(r).forEach(n=>{let i=r[n];if(!e.hasOwnProperty(n))i!==null&&(e[n]=i);else{let o=i!==null,a=typeof i=="object",c=!Array.isArray(i),l=typeof e[n]<"u"&&e[n]!==null;o&&a&&c&&l?this.mergeUpdates(e[n],i):e[n]=i}}),e}mergeRemovals(e,r){this.logger.trace("Remove updated entries in cache");let n=e.Account?this.mergeRemovalsDict(e.Account,r.Account):e.Account,i=e.AccessToken?this.mergeRemovalsDict(e.AccessToken,r.AccessToken):e.AccessToken,o=e.RefreshToken?this.mergeRemovalsDict(e.RefreshToken,r.RefreshToken):e.RefreshToken,a=e.IdToken?this.mergeRemovalsDict(e.IdToken,r.IdToken):e.IdToken,c=e.AppMetadata?this.mergeRemovalsDict(e.AppMetadata,r.AppMetadata):e.AppMetadata;return{...e,Account:n,AccessToken:i,RefreshToken:o,IdToken:a,AppMetadata:c}}mergeRemovalsDict(e,r){let n={...e};return Object.keys(e).forEach(i=>{(!r||!r.hasOwnProperty(i))&&delete n[i]}),n}overlayDefaults(e){return this.logger.trace("Overlaying input cache with the default cache"),{Account:{...S6.Account,...e.Account},IdToken:{...S6.IdToken,...e.IdToken},AccessToken:{...S6.AccessToken,...e.AccessToken},RefreshToken:{...S6.RefreshToken,...e.RefreshToken},AppMetadata:{...S6.AppMetadata,...e.AppMetadata}}}};d();var dqe=Be(uqe(),1);var cx=class t{static{s(this,"ClientAssertion")}static fromAssertion(e){let r=new t;return r.jwt=e,r}static fromCertificate(e,r,n){let i=new t;return i.privateKey=r,i.thumbprint=e,i.useSha256=!1,n&&(i.publicCertificate=this.parseCertificate(n)),i}static fromCertificateWithSha256Thumbprint(e,r,n){let i=new t;return i.privateKey=r,i.thumbprint=e,i.useSha256=!0,n&&(i.publicCertificate=this.parseCertificate(n)),i}getJwt(e,r,n){if(this.privateKey&&this.thumbprint)return this.jwt&&!this.isExpired()&&r===this.issuer&&n===this.jwtAudience?this.jwt:this.createJwt(e,r,n);if(this.jwt)return this.jwt;throw vt(Cs.invalidAssertion)}createJwt(e,r,n){this.issuer=r,this.jwtAudience=n;let i=na.nowSeconds();this.expirationTime=i+600;let a={alg:this.useSha256?th.PSS_256:th.RSA_256},c=this.useSha256?th.X5T_256:th.X5T;Object.assign(a,{[c]:B0.base64EncodeUrl(this.thumbprint,Gu.HEX)}),this.publicCertificate&&Object.assign(a,{[th.X5C]:this.publicCertificate});let l={[th.AUDIENCE]:this.jwtAudience,[th.EXPIRATION_TIME]:this.expirationTime,[th.ISSUER]:this.issuer,[th.SUBJECT]:this.issuer,[th.NOT_BEFORE]:i,[th.JWT_ID]:e.createNewGuid()};return this.jwt=dqe.default.sign(l,this.privateKey,{header:a}),this.jwt}isExpired(){return this.expirationTime<na.nowSeconds()}static parseCertificate(e){let r=/-----BEGIN CERTIFICATE-----\r*\n(.+?)\r*\n-----END CERTIFICATE-----/gs,n=[],i;for(;(i=r.exec(e))!==null;)n.push(i[1].replace(/\r*\n/g,rt.EMPTY_STRING));return n}};d();var qz="@azure/msal-node",AA="3.6.3";d();var uB=class extends Ku{static{s(this,"UsernamePasswordClient")}constructor(e){super(e)}async acquireToken(e){this.logger.info("in acquireToken call in username-password client");let r=na.nowSeconds(),n=await this.executeTokenRequest(this.authority,e),i=new Lc(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin);return i.validateTokenResponse(n.body),i.handleServerTokenResponse(n.body,this.authority,r,e)}async executeTokenRequest(e,r){let n=this.createTokenQueryParameters(r),i=Mi.appendQueryString(e.tokenEndpoint,n),o=await this.createTokenRequestBody(r),a=this.createTokenRequestHeaders({credential:r.username,type:Af.UPN}),c={clientId:this.config.authOptions.clientId,authority:e.canonicalAuthority,scopes:r.scopes,claims:r.claims,authenticationScheme:r.authenticationScheme,resourceRequestMethod:r.resourceRequestMethod,resourceRequestUri:r.resourceRequestUri,shrClaims:r.shrClaims,sshKid:r.sshKid};return this.executePostToTokenEndpoint(i,o,a,c,r.correlationId)}async createTokenRequestBody(e){let r=new Map;hr.addClientId(r,this.config.authOptions.clientId),hr.addUsername(r,e.username),hr.addPassword(r,e.password),hr.addScopes(r,e.scopes),hr.addResponseType(r,LD.IDTOKEN_TOKEN),hr.addGrantType(r,hp.RESOURCE_OWNER_PASSWORD_GRANT),hr.addClientInfo(r),hr.addLibraryInfo(r,this.config.libraryInfo),hr.addApplicationTelemetry(r,this.config.telemetry.application),hr.addThrottling(r),this.serverTelemetryManager&&hr.addServerTelemetry(r,this.serverTelemetryManager);let n=e.correlationId||this.config.cryptoInterface.createNewGuid();hr.addCorrelationId(r,n),this.config.clientCredentials.clientSecret&&hr.addClientSecret(r,this.config.clientCredentials.clientSecret);let i=this.config.clientCredentials.clientAssertion;return i&&(hr.addClientAssertion(r,await Cf(i.assertion,this.config.authOptions.clientId,e.resourceRequestUri)),hr.addClientAssertionType(r,i.assertionType)),(!Na.isEmptyObj(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&hr.addClaims(r,e.claims,this.config.authOptions.clientCapabilities),this.config.systemOptions.preventCorsPreflight&&e.username&&hr.addCcsUpn(r,e.username),zu.mapToQueryString(r)}};d();function fqe(t,e,r,n){let i=T6.getStandardAuthorizeRequestParameters({...t.auth,authority:e,redirectUri:r.redirectUri||""},r,n);return hr.addLibraryInfo(i,{sku:Ll.MSAL_SKU,version:AA,cpu:process.arch||"",os:process.platform||""}),t.auth.protocolMode!==Ld.OIDC&&hr.addApplicationTelemetry(i,t.telemetry.application),hr.addResponseType(i,LD.CODE),r.codeChallenge&&r.codeChallengeMethod&&hr.addCodeChallengeParams(i,r.codeChallenge,r.codeChallengeMethod),hr.addExtraQueryParameters(i,r.extraQueryParameters||{}),T6.getAuthorizeUrl(e,i,t.auth.encodeExtraQueryParams,r.extraQueryParameters)}s(fqe,"getAuthCodeRequestUrl");var aT=class{static{s(this,"ClientApplication")}constructor(e){this.config=_Oe(e),this.cryptoProvider=new TC,this.logger=new R0(this.config.system.loggerOptions,qz,AA),this.storage=new iT(this.logger,this.config.auth.clientId,this.cryptoProvider,nge(this.config.auth)),this.tokenCache=new ZD(this.storage,this.logger,this.config.cache.cachePlugin)}async getAuthCodeUrl(e){this.logger.info("getAuthCodeUrl called",e.correlationId);let r={...e,...await this.initializeBaseRequest(e),responseMode:e.responseMode||CC.QUERY,authenticationScheme:lo.BEARER,state:e.state||"",nonce:e.nonce||""},n=await this.createAuthority(r.authority,r.correlationId,void 0,e.azureCloudOptions);return fqe(this.config,n,r,this.logger)}async acquireTokenByCode(e,r){this.logger.info("acquireTokenByCode called"),e.state&&r&&(this.logger.info("acquireTokenByCode - validating state"),this.validateState(e.state,r.state||""),r={...r,state:""});let n={...e,...await this.initializeBaseRequest(e),authenticationScheme:lo.BEARER},i=this.initializeServerTelemetryManager(ax.acquireTokenByCode,n.correlationId);try{let o=await this.createAuthority(n.authority,n.correlationId,void 0,e.azureCloudOptions),a=await this.buildOauthClientConfiguration(o,n.correlationId,n.redirectUri,i),c=new b6(a);return this.logger.verbose("Auth code client created",n.correlationId),await c.acquireToken(n,r)}catch(o){throw o instanceof ai&&o.setCorrelationId(n.correlationId),i.cacheFailedRequest(o),o}}async acquireTokenByRefreshToken(e){this.logger.info("acquireTokenByRefreshToken called",e.correlationId);let r={...e,...await this.initializeBaseRequest(e),authenticationScheme:lo.BEARER},n=this.initializeServerTelemetryManager(ax.acquireTokenByRefreshToken,r.correlationId);try{let i=await this.createAuthority(r.authority,r.correlationId,void 0,e.azureCloudOptions),o=await this.buildOauthClientConfiguration(i,r.correlationId,r.redirectUri||"",n),a=new V2(o);return this.logger.verbose("Refresh token client created",r.correlationId),await a.acquireToken(r)}catch(i){throw i instanceof ai&&i.setCorrelationId(r.correlationId),n.cacheFailedRequest(i),i}}async acquireTokenSilent(e){let r={...e,...await this.initializeBaseRequest(e),forceRefresh:e.forceRefresh||!1},n=this.initializeServerTelemetryManager(ax.acquireTokenSilent,r.correlationId,r.forceRefresh);try{let i=await this.createAuthority(r.authority,r.correlationId,void 0,e.azureCloudOptions),o=await this.buildOauthClientConfiguration(i,r.correlationId,r.redirectUri||"",n),a=new I6(o);this.logger.verbose("Silent flow client created",r.correlationId);try{return await this.tokenCache.overwriteCache(),await this.acquireCachedTokenSilent(r,a,o)}catch(c){if(c instanceof zI&&c.errorCode===Cs.tokenRefreshRequired)return new V2(o).acquireTokenByRefreshToken(r);throw c}}catch(i){throw i instanceof ai&&i.setCorrelationId(r.correlationId),n.cacheFailedRequest(i),i}}async acquireCachedTokenSilent(e,r,n){let[i,o]=await r.acquireCachedToken({...e,scopes:e.scopes?.length?e.scopes:[...pp]});if(o===_s.PROACTIVELY_REFRESHED){this.logger.info("ClientApplication:acquireCachedTokenSilent - Cached access token's refreshOn property has been exceeded'. It's not expired, but must be refreshed.");let a=new V2(n);try{await a.acquireTokenByRefreshToken(e)}catch{}}return i}async acquireTokenByUsernamePassword(e){this.logger.info("acquireTokenByUsernamePassword called",e.correlationId);let r={...e,...await this.initializeBaseRequest(e)},n=this.initializeServerTelemetryManager(ax.acquireTokenByUsernamePassword,r.correlationId);try{let i=await this.createAuthority(r.authority,r.correlationId,void 0,e.azureCloudOptions),o=await this.buildOauthClientConfiguration(i,r.correlationId,"",n),a=new uB(o);return this.logger.verbose("Username password client created",r.correlationId),await a.acquireToken(r)}catch(i){throw i instanceof ai&&i.setCorrelationId(r.correlationId),n.cacheFailedRequest(i),i}}getTokenCache(){return this.logger.info("getTokenCache called"),this.tokenCache}validateState(e,r){if(!e)throw Ap.createStateNotFoundError();if(e!==r)throw vt(Cs.stateMismatch)}getLogger(){return this.logger}setLogger(e){this.logger=e}async buildOauthClientConfiguration(e,r,n,i){return this.logger.verbose("buildOauthClientConfiguration called",r),this.logger.info(`Building oauth client configuration with the following authority: ${e.tokenEndpoint}.`,r),i?.updateRegionDiscoveryMetadata(e.regionDiscoveryMetadata),{authOptions:{clientId:this.config.auth.clientId,authority:e,clientCapabilities:this.config.auth.clientCapabilities,redirectUri:n},loggerOptions:{logLevel:this.config.system.loggerOptions.logLevel,loggerCallback:this.config.system.loggerOptions.loggerCallback,piiLoggingEnabled:this.config.system.loggerOptions.piiLoggingEnabled,correlationId:r},cacheOptions:{claimsBasedCachingEnabled:this.config.cache.claimsBasedCachingEnabled},cryptoInterface:this.cryptoProvider,networkInterface:this.config.system.networkClient,storageInterface:this.storage,serverTelemetryManager:i,clientCredentials:{clientSecret:this.clientSecret,clientAssertion:await this.getClientAssertion(e)},libraryInfo:{sku:Ll.MSAL_SKU,version:AA,cpu:process.arch||rt.EMPTY_STRING,os:process.platform||rt.EMPTY_STRING},telemetry:this.config.telemetry,persistencePlugin:this.config.cache.cachePlugin,serializableCache:this.tokenCache}}async getClientAssertion(e){return this.developerProvidedClientAssertion&&(this.clientAssertion=cx.fromAssertion(await Cf(this.developerProvidedClientAssertion,this.config.auth.clientId,e.tokenEndpoint))),this.clientAssertion&&{assertion:this.clientAssertion.getJwt(this.cryptoProvider,this.config.auth.clientId,e.tokenEndpoint),assertionType:Ll.JWT_BEARER_ASSERTION_TYPE}}async initializeBaseRequest(e){return this.logger.verbose("initializeRequestScopes called",e.correlationId),e.authenticationScheme&&e.authenticationScheme===lo.POP&&this.logger.verbose("Authentication Scheme 'pop' is not supported yet, setting Authentication Scheme to 'Bearer' for request",e.correlationId),e.authenticationScheme=lo.BEARER,this.config.cache.claimsBasedCachingEnabled&&e.claims&&!Na.isEmptyObj(e.claims)&&(e.requestedClaimsHash=await this.cryptoProvider.hashString(e.claims)),{...e,scopes:[...e&&e.scopes||[],...pp],correlationId:e&&e.correlationId||this.cryptoProvider.createNewGuid(),authority:e.authority||this.config.auth.authority}}initializeServerTelemetryManager(e,r,n){let i={clientId:this.config.auth.clientId,correlationId:r,apiId:e,forceRefresh:n||!1};return new z2(i,this.storage)}async createAuthority(e,r,n,i){this.logger.verbose("createAuthority called",r);let o=hA.generateAuthority(e,i||this.config.auth.azureCloudOptions),a={protocolMode:this.config.auth.protocolMode,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata,azureRegionConfiguration:n,skipAuthorityMetadataCache:this.config.auth.skipAuthorityMetadataCache};return qV.createDiscoveredInstance(o,this.config.system.networkClient,this.storage,a,this.logger,r)}clearCache(){this.storage.clear()}};d();var pqe=Be(require("http"),1);var Hz=class{static{s(this,"LoopbackClient")}async listenForAuthCode(e,r){if(this.server)throw Ap.createLoopbackServerAlreadyExistsError();return new Promise((n,i)=>{this.server=pqe.default.createServer((o,a)=>{let c=o.url;if(c){if(c===rt.FORWARD_SLASH){a.end(e||"Auth code was successfully acquired. You can close this window now.");return}}else{a.end(r||"Error occurred loading redirectUrl"),i(Ap.createUnableToLoadRedirectUrlError());return}let l=this.getRedirectUri(),u=new URL(c,l),f=zu.getDeserializedResponse(u.search)||{};f.code&&(a.writeHead(si.REDIRECT,{location:l}),a.end()),f.error&&a.end(r||`Error occurred: ${f.error}`),n(f)}),this.server.listen(0,"127.0.0.1")})}getRedirectUri(){if(!this.server||!this.server.listening)throw Ap.createNoLoopbackServerExistsError();let e=this.server.address();if(!e||typeof e=="string"||!e.port)throw this.closeServer(),Ap.createInvalidLoopbackAddressTypeError();let r=e&&e.port;return`${Ll.HTTP_PROTOCOL}${Ll.LOCALHOST}:${r}`}closeServer(){this.server&&(this.server.close(),typeof this.server.closeAllConnections=="function"&&this.server.closeAllConnections(),this.server.unref(),this.server=void 0)}};d();var dB=class extends Ku{static{s(this,"DeviceCodeClient")}constructor(e){super(e)}async acquireToken(e){let r=await this.getDeviceCode(e);e.deviceCodeCallback(r);let n=na.nowSeconds(),i=await this.acquireTokenWithDeviceCode(e,r),o=new Lc(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin);return o.validateTokenResponse(i),o.handleServerTokenResponse(i,this.authority,n,e)}async getDeviceCode(e){let r=this.createExtraQueryParameters(e),n=Mi.appendQueryString(this.authority.deviceCodeEndpoint,r),i=this.createQueryString(e),o=this.createTokenRequestHeaders(),a={clientId:this.config.authOptions.clientId,authority:e.authority,scopes:e.scopes,claims:e.claims,authenticationScheme:e.authenticationScheme,resourceRequestMethod:e.resourceRequestMethod,resourceRequestUri:e.resourceRequestUri,shrClaims:e.shrClaims,sshKid:e.sshKid};return this.executePostRequestToDeviceCodeEndpoint(n,i,o,a,e.correlationId)}createExtraQueryParameters(e){let r=new Map;return e.extraQueryParameters&&hr.addExtraQueryParameters(r,e.extraQueryParameters),zu.mapToQueryString(r)}async executePostRequestToDeviceCodeEndpoint(e,r,n,i,o){let{body:{user_code:a,device_code:c,verification_uri:l,expires_in:u,interval:f,message:p}}=await this.sendPostRequest(i,e,{body:r,headers:n},o);return{userCode:a,deviceCode:c,verificationUri:l,expiresIn:u,interval:f,message:p}}createQueryString(e){let r=new Map;return hr.addScopes(r,e.scopes),hr.addClientId(r,this.config.authOptions.clientId),e.extraQueryParameters&&hr.addExtraQueryParameters(r,e.extraQueryParameters),(e.claims||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&hr.addClaims(r,e.claims,this.config.authOptions.clientCapabilities),zu.mapToQueryString(r)}continuePolling(e,r,n){if(n)throw this.logger.error("Token request cancelled by setting DeviceCodeRequest.cancel = true"),vt(Cs.deviceCodePollingCancelled);if(r&&r<e&&na.nowSeconds()>r)throw this.logger.error(`User defined timeout for device code polling reached. The timeout was set for ${r}`),vt(Cs.userTimeoutReached);if(na.nowSeconds()>e)throw r&&this.logger.verbose(`User specified timeout ignored as the device code has expired before the timeout elapsed. The user specified timeout was set for ${r}`),this.logger.error(`Device code expired. Expiration time of device code was ${e}`),vt(Cs.deviceCodeExpired);return!0}async acquireTokenWithDeviceCode(e,r){let n=this.createTokenQueryParameters(e),i=Mi.appendQueryString(this.authority.tokenEndpoint,n),o=this.createTokenRequestBody(e,r),a=this.createTokenRequestHeaders(),c=e.timeout?na.nowSeconds()+e.timeout:void 0,l=na.nowSeconds()+r.expiresIn,u=r.interval*1e3;for(;this.continuePolling(l,c,e.cancel);){let f={clientId:this.config.authOptions.clientId,authority:e.authority,scopes:e.scopes,claims:e.claims,authenticationScheme:e.authenticationScheme,resourceRequestMethod:e.resourceRequestMethod,resourceRequestUri:e.resourceRequestUri,shrClaims:e.shrClaims,sshKid:e.sshKid},p=await this.executePostToTokenEndpoint(i,o,a,f,e.correlationId);if(p.body&&p.body.error)if(p.body.error===rt.AUTHORIZATION_PENDING)this.logger.info("Authorization pending. Continue polling."),await na.delay(u);else throw this.logger.info("Unexpected error in polling from the server"),Yme(QD.postRequestFailed,p.body.error);else return this.logger.verbose("Authorization completed successfully. Polling stopped."),p.body}throw this.logger.error("Polling stopped for unknown reasons."),vt(Cs.deviceCodeUnknownError)}createTokenRequestBody(e,r){let n=new Map;hr.addScopes(n,e.scopes),hr.addClientId(n,this.config.authOptions.clientId),hr.addGrantType(n,hp.DEVICE_CODE_GRANT),hr.addDeviceCode(n,r.deviceCode);let i=e.correlationId||this.config.cryptoInterface.createNewGuid();return hr.addCorrelationId(n,i),hr.addClientInfo(n),hr.addLibraryInfo(n,this.config.libraryInfo),hr.addApplicationTelemetry(n,this.config.telemetry.application),hr.addThrottling(n),this.serverTelemetryManager&&hr.addServerTelemetry(n,this.serverTelemetryManager),(!Na.isEmptyObj(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&hr.addClaims(n,e.claims,this.config.authOptions.clientCapabilities),zu.mapToQueryString(n)}};var fB=class extends aT{static{s(this,"PublicClientApplication")}constructor(e){super(e),this.config.broker.nativeBrokerPlugin&&(this.config.broker.nativeBrokerPlugin.isBrokerAvailable?(this.nativeBrokerPlugin=this.config.broker.nativeBrokerPlugin,this.nativeBrokerPlugin.setLogger(this.config.system.loggerOptions)):this.logger.warning("NativeBroker implementation was provided but the broker is unavailable.")),this.skus=z2.makeExtraSkuString({libraryName:Ll.MSAL_SKU,libraryVersion:AA})}async acquireTokenByDeviceCode(e){this.logger.info("acquireTokenByDeviceCode called",e.correlationId);let r=Object.assign(e,await this.initializeBaseRequest(e)),n=this.initializeServerTelemetryManager(ax.acquireTokenByDeviceCode,r.correlationId);try{let i=await this.createAuthority(r.authority,r.correlationId,void 0,e.azureCloudOptions),o=await this.buildOauthClientConfiguration(i,r.correlationId,"",n),a=new dB(o);return this.logger.verbose("Device code client created",r.correlationId),await a.acquireToken(r)}catch(i){throw i instanceof ai&&i.setCorrelationId(r.correlationId),n.cacheFailedRequest(i),i}}async acquireTokenInteractive(e){let r=e.correlationId||this.cryptoProvider.createNewGuid();this.logger.trace("acquireTokenInteractive called",r);let{openBrowser:n,successTemplate:i,errorTemplate:o,windowHandle:a,loopbackClient:c,...l}=e;if(this.nativeBrokerPlugin){let g={...l,clientId:this.config.auth.clientId,scopes:e.scopes||pp,redirectUri:`${Ll.HTTP_PROTOCOL}${Ll.LOCALHOST}`,authority:e.authority||this.config.auth.authority,correlationId:r,extraParameters:{...l.extraQueryParameters,...l.tokenQueryParameters,[Q2.X_CLIENT_EXTRA_SKU]:this.skus},accountId:l.account?.nativeAccountId};return this.nativeBrokerPlugin.acquireTokenInteractive(g,a)}let{verifier:u,challenge:f}=await this.cryptoProvider.generatePkceCodes(),p=c||new Hz,m={},h=null;try{let g=p.listenForAuthCode(i,o).then(R=>{m=R}).catch(R=>{h=R}),A=await this.waitForRedirectUri(p),y={...l,correlationId:r,scopes:e.scopes||pp,redirectUri:A,responseMode:CC.QUERY,codeChallenge:f,codeChallengeMethod:xV.S256},E=await this.getAuthCodeUrl(y);if(await n(E),await g,h)throw h;if(m.error)throw new yf(m.error,m.error_description,m.suberror);if(!m.code)throw Ap.createNoAuthCodeInResponseError();let b=m.client_info,S={code:m.code,codeVerifier:u,clientInfo:b||rt.EMPTY_STRING,...y};return await this.acquireTokenByCode(S)}finally{p.closeServer()}}async acquireTokenSilent(e){let r=e.correlationId||this.cryptoProvider.createNewGuid();if(this.logger.trace("acquireTokenSilent called",r),this.nativeBrokerPlugin){let n={...e,clientId:this.config.auth.clientId,scopes:e.scopes||pp,redirectUri:`${Ll.HTTP_PROTOCOL}${Ll.LOCALHOST}`,authority:e.authority||this.config.auth.authority,correlationId:r,extraParameters:{...e.tokenQueryParameters,[Q2.X_CLIENT_EXTRA_SKU]:this.skus},accountId:e.account.nativeAccountId,forceRefresh:e.forceRefresh||!1};return this.nativeBrokerPlugin.acquireTokenSilent(n)}return super.acquireTokenSilent(e)}async signOut(e){if(this.nativeBrokerPlugin&&e.account.nativeAccountId){let r={clientId:this.config.auth.clientId,accountId:e.account.nativeAccountId,correlationId:e.correlationId||this.cryptoProvider.createNewGuid()};await this.nativeBrokerPlugin.signOut(r)}await this.getTokenCache().removeAccount(e.account,e.correlationId)}async getAllAccounts(){if(this.nativeBrokerPlugin){let e=this.cryptoProvider.createNewGuid();return this.nativeBrokerPlugin.getAllAccounts(this.config.auth.clientId,e)}return this.getTokenCache().getAllAccounts()}async waitForRedirectUri(e){return new Promise((r,n)=>{let i=0,o=setInterval(()=>{if(JV.TIMEOUT_MS/JV.INTERVAL_MS<i){clearInterval(o),n(Ap.createLoopbackServerTimeoutError());return}try{let a=e.getRedirectUri();clearInterval(o),r(a);return}catch(a){if(a instanceof ai&&a.errorCode===ou.noLoopbackServerExists.code){i++;return}clearInterval(o),n(a);return}},JV.INTERVAL_MS)})}};d();d();var cT=class extends Ku{static{s(this,"ClientCredentialClient")}constructor(e,r){super(e),this.appTokenProvider=r}async acquireToken(e){if(e.skipCache||e.claims)return this.executeTokenRequest(e,this.authority);let[r,n]=await this.getCachedAuthenticationResult(e,this.config,this.cryptoUtils,this.authority,this.cacheManager,this.serverTelemetryManager);return r?(n===_s.PROACTIVELY_REFRESHED&&(this.logger.info("ClientCredentialClient:getCachedAuthenticationResult - Cached access token's refreshOn property has been exceeded'. It's not expired, but must be refreshed."),await this.executeTokenRequest(e,this.authority,!0)),r):this.executeTokenRequest(e,this.authority)}async getCachedAuthenticationResult(e,r,n,i,o,a){let c=r,l=r,u=_s.NOT_APPLICABLE,f;c.serializableCache&&c.persistencePlugin&&(f=new D0(c.serializableCache,!1),await c.persistencePlugin.beforeCacheAccess(f));let p=this.readAccessTokenFromCache(i,l.managedIdentityId?.id||c.authOptions.clientId,new nl(e.scopes||[]),o,e.correlationId);return c.serializableCache&&c.persistencePlugin&&f&&await c.persistencePlugin.afterCacheAccess(f),p?na.isTokenExpired(p.expiresOn,c.systemOptions?.tokenRenewalOffsetSeconds||OD)?(a?.setCacheOutcome(_s.CACHED_ACCESS_TOKEN_EXPIRED),[null,_s.CACHED_ACCESS_TOKEN_EXPIRED]):(p.refreshOn&&na.isTokenExpired(p.refreshOn.toString(),0)&&(u=_s.PROACTIVELY_REFRESHED,a?.setCacheOutcome(_s.PROACTIVELY_REFRESHED)),[await Lc.generateAuthenticationResult(n,i,{account:null,idToken:null,accessToken:p,refreshToken:null,appMetadata:null},!0,e),u]):(a?.setCacheOutcome(_s.NO_CACHED_ACCESS_TOKEN),[null,_s.NO_CACHED_ACCESS_TOKEN])}readAccessTokenFromCache(e,r,n,i,o){let a={homeAccountId:rt.EMPTY_STRING,environment:e.canonicalAuthorityUrlComponents.HostNameAndPort,credentialType:_o.ACCESS_TOKEN,clientId:r,realm:e.tenant,target:nl.createSearchScopes(n.asArray())},c=i.getAccessTokensByFilter(a,o);if(c.length<1)return null;if(c.length>1)throw vt(Cs.multipleMatchingTokens);return c[0]}async executeTokenRequest(e,r,n){let i,o;if(this.appTokenProvider){this.logger.info("Using appTokenProvider extensibility.");let l={correlationId:e.correlationId,tenantId:this.config.authOptions.authority.tenant,scopes:e.scopes,claims:e.claims};o=na.nowSeconds();let u=await this.appTokenProvider(l);i={access_token:u.accessToken,expires_in:u.expiresInSeconds,refresh_in:u.refreshInSeconds,token_type:lo.BEARER}}else{let l=this.createTokenQueryParameters(e),u=Mi.appendQueryString(r.tokenEndpoint,l),f=await this.createTokenRequestBody(e),p=this.createTokenRequestHeaders(),m={clientId:this.config.authOptions.clientId,authority:e.authority,scopes:e.scopes,claims:e.claims,authenticationScheme:e.authenticationScheme,resourceRequestMethod:e.resourceRequestMethod,resourceRequestUri:e.resourceRequestUri,shrClaims:e.shrClaims,sshKid:e.sshKid};this.logger.info("Sending token request to endpoint: "+r.tokenEndpoint),o=na.nowSeconds();let h=await this.executePostToTokenEndpoint(u,f,p,m,e.correlationId);i=h.body,i.status=h.status}let a=new Lc(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin);return a.validateTokenResponse(i,n),await a.handleServerTokenResponse(i,this.authority,o,e)}async createTokenRequestBody(e){let r=new Map;hr.addClientId(r,this.config.authOptions.clientId),hr.addScopes(r,e.scopes,!1),hr.addGrantType(r,hp.CLIENT_CREDENTIALS_GRANT),hr.addLibraryInfo(r,this.config.libraryInfo),hr.addApplicationTelemetry(r,this.config.telemetry.application),hr.addThrottling(r),this.serverTelemetryManager&&hr.addServerTelemetry(r,this.serverTelemetryManager);let n=e.correlationId||this.config.cryptoInterface.createNewGuid();hr.addCorrelationId(r,n),this.config.clientCredentials.clientSecret&&hr.addClientSecret(r,this.config.clientCredentials.clientSecret);let i=e.clientAssertion||this.config.clientCredentials.clientAssertion;return i&&(hr.addClientAssertion(r,await Cf(i.assertion,this.config.authOptions.clientId,e.resourceRequestUri)),hr.addClientAssertionType(r,i.assertionType)),(!Na.isEmptyObj(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&hr.addClaims(r,e.claims,this.config.authOptions.clientCapabilities),zu.mapToQueryString(r)}};d();var pB=class extends Ku{static{s(this,"OnBehalfOfClient")}constructor(e){super(e)}async acquireToken(e){if(this.scopeSet=new nl(e.scopes||[]),this.userAssertionHash=await this.cryptoUtils.hashString(e.oboAssertion),e.skipCache||e.claims)return this.executeTokenRequest(e,this.authority,this.userAssertionHash);try{return await this.getCachedAuthenticationResult(e)}catch{return await this.executeTokenRequest(e,this.authority,this.userAssertionHash)}}async getCachedAuthenticationResult(e){let r=this.readAccessTokenFromCacheForOBO(this.config.authOptions.clientId,e);if(r){if(na.isTokenExpired(r.expiresOn,this.config.systemOptions.tokenRenewalOffsetSeconds))throw this.serverTelemetryManager?.setCacheOutcome(_s.CACHED_ACCESS_TOKEN_EXPIRED),this.logger.info(`OnbehalfofFlow:getCachedAuthenticationResult - Cached access token is expired or will expire within ${this.config.systemOptions.tokenRenewalOffsetSeconds} seconds.`),vt(Cs.tokenRefreshRequired)}else throw this.serverTelemetryManager?.setCacheOutcome(_s.NO_CACHED_ACCESS_TOKEN),this.logger.info("SilentFlowClient:acquireCachedToken - No access token found in cache for the given properties."),vt(Cs.tokenRefreshRequired);let n=this.readIdTokenFromCacheForOBO(r.homeAccountId,e.correlationId),i,o=null;if(n){i=TV.extractTokenClaims(n.secret,B0.base64Decode);let a=i.oid||i.sub,c={homeAccountId:n.homeAccountId,environment:n.environment,tenantId:n.realm,username:rt.EMPTY_STRING,localAccountId:a||rt.EMPTY_STRING};o=this.cacheManager.readAccountFromCache(c,e.correlationId)}return this.config.serverTelemetryManager&&this.config.serverTelemetryManager.incrementCacheHits(),Lc.generateAuthenticationResult(this.cryptoUtils,this.authority,{account:o,accessToken:r,idToken:n,refreshToken:null,appMetadata:null},!0,e,i)}readIdTokenFromCacheForOBO(e,r){let n={homeAccountId:e,environment:this.authority.canonicalAuthorityUrlComponents.HostNameAndPort,credentialType:_o.ID_TOKEN,clientId:this.config.authOptions.clientId,realm:this.authority.tenant},i=this.cacheManager.getIdTokensByFilter(n,r);return Object.values(i).length<1?null:Object.values(i)[0]}readAccessTokenFromCacheForOBO(e,r){let n=r.authenticationScheme||lo.BEARER,o={credentialType:n&&n.toLowerCase()!==lo.BEARER.toLowerCase()?_o.ACCESS_TOKEN_WITH_AUTH_SCHEME:_o.ACCESS_TOKEN,clientId:e,target:nl.createSearchScopes(this.scopeSet.asArray()),tokenType:n,keyId:r.sshKid,requestedClaimsHash:r.requestedClaimsHash,userAssertionHash:this.userAssertionHash},a=this.cacheManager.getAccessTokensByFilter(o,r.correlationId),c=a.length;if(c<1)return null;if(c>1)throw vt(Cs.multipleMatchingTokens);return a[0]}async executeTokenRequest(e,r,n){let i=this.createTokenQueryParameters(e),o=Mi.appendQueryString(r.tokenEndpoint,i),a=await this.createTokenRequestBody(e),c=this.createTokenRequestHeaders(),l={clientId:this.config.authOptions.clientId,authority:e.authority,scopes:e.scopes,claims:e.claims,authenticationScheme:e.authenticationScheme,resourceRequestMethod:e.resourceRequestMethod,resourceRequestUri:e.resourceRequestUri,shrClaims:e.shrClaims,sshKid:e.sshKid},u=na.nowSeconds(),f=await this.executePostToTokenEndpoint(o,a,c,l,e.correlationId),p=new Lc(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin);return p.validateTokenResponse(f.body),await p.handleServerTokenResponse(f.body,this.authority,u,e,void 0,n)}async createTokenRequestBody(e){let r=new Map;hr.addClientId(r,this.config.authOptions.clientId),hr.addScopes(r,e.scopes),hr.addGrantType(r,hp.JWT_BEARER),hr.addClientInfo(r),hr.addLibraryInfo(r,this.config.libraryInfo),hr.addApplicationTelemetry(r,this.config.telemetry.application),hr.addThrottling(r),this.serverTelemetryManager&&hr.addServerTelemetry(r,this.serverTelemetryManager);let n=e.correlationId||this.config.cryptoInterface.createNewGuid();hr.addCorrelationId(r,n),hr.addRequestTokenUse(r,Q2.ON_BEHALF_OF),hr.addOboAssertion(r,e.oboAssertion),this.config.clientCredentials.clientSecret&&hr.addClientSecret(r,this.config.clientCredentials.clientSecret);let i=this.config.clientCredentials.clientAssertion;return i&&(hr.addClientAssertion(r,await Cf(i.assertion,this.config.authOptions.clientId,e.resourceRequestUri)),hr.addClientAssertionType(r,i.assertionType)),(e.claims||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&hr.addClaims(r,e.claims,this.config.authOptions.clientCapabilities),zu.mapToQueryString(r)}};var mB=class extends aT{static{s(this,"ConfidentialClientApplication")}constructor(e){super(e);let r=!!this.config.auth.clientSecret,n=!!this.config.auth.clientAssertion,i=(!!this.config.auth.clientCertificate?.thumbprint||!!this.config.auth.clientCertificate?.thumbprintSha256)&&!!this.config.auth.clientCertificate?.privateKey;if(!this.appTokenProvider){if(r&&n||n&&i||r&&i)throw vt(Cs.invalidClientCredential);if(this.config.auth.clientSecret){this.clientSecret=this.config.auth.clientSecret;return}if(this.config.auth.clientAssertion){this.developerProvidedClientAssertion=this.config.auth.clientAssertion;return}if(i)this.clientAssertion=this.config.auth.clientCertificate.thumbprintSha256?cx.fromCertificateWithSha256Thumbprint(this.config.auth.clientCertificate.thumbprintSha256,this.config.auth.clientCertificate.privateKey,this.config.auth.clientCertificate.x5c):cx.fromCertificate(this.config.auth.clientCertificate.thumbprint,this.config.auth.clientCertificate.privateKey,this.config.auth.clientCertificate.x5c);else throw vt(Cs.invalidClientCredential);this.appTokenProvider=void 0}}SetAppTokenProvider(e){this.appTokenProvider=e}async acquireTokenByClientCredential(e){this.logger.info("acquireTokenByClientCredential called",e.correlationId);let r;e.clientAssertion&&(r={assertion:await Cf(e.clientAssertion,this.config.auth.clientId),assertionType:Ll.JWT_BEARER_ASSERTION_TYPE});let n=await this.initializeBaseRequest(e),i={...n,scopes:n.scopes.filter(m=>!pp.includes(m))},o={...e,...i,clientAssertion:r},c=new Mi(o.authority).getUrlComponents().PathSegments[0];if(Object.values(mp).includes(c))throw vt(Cs.missingTenantIdError);let l=process.env[yOe],u;o.azureRegion!=="DisableMsalForceRegion"&&(!o.azureRegion&&l?u=l:u=o.azureRegion);let f={azureRegion:u,environmentRegion:process.env[AOe]},p=this.initializeServerTelemetryManager(ax.acquireTokenByClientCredential,o.correlationId,o.skipCache);try{let m=await this.createAuthority(o.authority,o.correlationId,f,e.azureCloudOptions),h=await this.buildOauthClientConfiguration(m,o.correlationId,"",p),g=new cT(h,this.appTokenProvider);return this.logger.verbose("Client credential client created",o.correlationId),await g.acquireToken(o)}catch(m){throw m instanceof ai&&m.setCorrelationId(o.correlationId),p.cacheFailedRequest(m),m}}async acquireTokenOnBehalfOf(e){this.logger.info("acquireTokenOnBehalfOf called",e.correlationId);let r={...e,...await this.initializeBaseRequest(e)};try{let n=await this.createAuthority(r.authority,r.correlationId,void 0,e.azureCloudOptions),i=await this.buildOauthClientConfiguration(n,r.correlationId,"",void 0),o=new pB(i);return this.logger.verbose("On behalf of client created",r.correlationId),await o.acquireToken(r)}catch(n){throw n instanceof ai&&n.setCorrelationId(r.correlationId),n}}};d();d();d();d();d();function mqe(t){if(typeof t!="string")return!1;let e=new Date(t);return!isNaN(e.getTime())&&e.toISOString()===t}s(mqe,"isIso8601");d();var $z=class{static{s(this,"HttpClientWithRetries")}constructor(e,r,n){this.httpClientNoRetries=e,this.retryPolicy=r,this.logger=n}async sendNetworkRequestAsyncHelper(e,r,n){return e===ia.GET?this.httpClientNoRetries.sendGetRequestAsync(r,n):this.httpClientNoRetries.sendPostRequestAsync(r,n)}async sendNetworkRequestAsync(e,r,n){let i=await this.sendNetworkRequestAsyncHelper(e,r,n);"isNewRequest"in this.retryPolicy&&(this.retryPolicy.isNewRequest=!0);let o=0;for(;await this.retryPolicy.pauseForRetry(i.status,o,this.logger,i.headers[Qs.RETRY_AFTER]);)i=await this.sendNetworkRequestAsyncHelper(e,r,n),o++;return i}async sendGetRequestAsync(e,r){return this.sendNetworkRequestAsync(ia.GET,e,r)}async sendPostRequestAsync(e,r){return this.sendNetworkRequestAsync(ia.POST,e,r)}};var Z2={MANAGED_IDENTITY_CLIENT_ID_2017:"clientid",MANAGED_IDENTITY_CLIENT_ID:"client_id",MANAGED_IDENTITY_OBJECT_ID:"object_id",MANAGED_IDENTITY_RESOURCE_ID_IMDS:"msi_res_id",MANAGED_IDENTITY_RESOURCE_ID_NON_IMDS:"mi_res_id"},Ef=class{static{s(this,"BaseManagedIdentitySource")}constructor(e,r,n,i,o){this.logger=e,this.nodeStorage=r,this.networkClient=n,this.cryptoProvider=i,this.disableInternalRetries=o}async getServerTokenResponseAsync(e,r,n,i){return this.getServerTokenResponse(e)}getServerTokenResponse(e){let r,n;return e.body.expires_on&&(mqe(e.body.expires_on)&&(e.body.expires_on=new Date(e.body.expires_on).getTime()/1e3),n=e.body.expires_on-na.nowSeconds(),n>2*3600&&(r=n/2)),{status:e.status,access_token:e.body.access_token,expires_in:n,scope:e.body.resource,token_type:e.body.token_type,refresh_in:r,correlation_id:e.body.correlation_id||e.body.correlationId,error:typeof e.body.error=="string"?e.body.error:e.body.error?.code,error_description:e.body.message||(typeof e.body.error=="string"?e.body.error_description:e.body.error?.message),error_codes:e.body.error_codes,timestamp:e.body.timestamp,trace_id:e.body.trace_id}}async acquireTokenWithManagedIdentity(e,r,n,i){let o=this.createRequest(e.resource,r);if(e.revokedTokenSha256Hash&&(this.logger.info(`[Managed Identity] The following claims are present in the request: ${e.claims}`),o.queryParameters[il.SHA256_TOKEN_TO_REFRESH]=e.revokedTokenSha256Hash),e.clientCapabilities?.length){let h=e.clientCapabilities.toString();this.logger.info(`[Managed Identity] The following client capabilities are present in the request: ${h}`),o.queryParameters[il.XMS_CC]=h}let a=o.headers;a[Qs.CONTENT_TYPE]=rt.URL_FORM_CONTENT_TYPE;let c={headers:a};Object.keys(o.bodyParameters).length&&(c.body=o.computeParametersBodyString());let l=this.disableInternalRetries?this.networkClient:new $z(this.networkClient,o.retryPolicy,this.logger),u=na.nowSeconds(),f;try{o.httpMethod===ia.POST?f=await l.sendPostRequestAsync(o.computeUri(),c):f=await l.sendGetRequestAsync(o.computeUri(),c)}catch(h){throw h instanceof ai?h:vt(Cs.networkError)}let p=new Lc(r.id,this.nodeStorage,this.cryptoProvider,this.logger,null,null),m=await this.getServerTokenResponseAsync(f,l,o,c);return p.validateTokenResponse(m,i),p.handleServerTokenResponse(m,n,u,e)}getManagedIdentityUserAssignedIdQueryParameterKey(e,r,n){switch(e){case Ja.USER_ASSIGNED_CLIENT_ID:return this.logger.info(`[Managed Identity] [API version ${n?"2017+":"2019+"}] Adding user assigned client id to the request.`),n?Z2.MANAGED_IDENTITY_CLIENT_ID_2017:Z2.MANAGED_IDENTITY_CLIENT_ID;case Ja.USER_ASSIGNED_RESOURCE_ID:return this.logger.info("[Managed Identity] Adding user assigned resource id to the request."),r?Z2.MANAGED_IDENTITY_RESOURCE_ID_IMDS:Z2.MANAGED_IDENTITY_RESOURCE_ID_NON_IMDS;case Ja.USER_ASSIGNED_OBJECT_ID:return this.logger.info("[Managed Identity] Adding user assigned object id to the request."),Z2.MANAGED_IDENTITY_OBJECT_ID;default:throw Fc(rT)}}};Ef.getValidatedEnvVariableUrlString=(t,e,r,n)=>{try{return new Mi(e).urlString}catch{throw n.info(`[Managed Identity] ${r} managed identity is unavailable because the '${t}' environment variable is malformed.`),Fc(K2[t])}};d();d();d();var Wz=class{static{s(this,"LinearRetryStrategy")}calculateDelay(e,r){if(!e)return r;let n=Math.round(parseFloat(e)*1e3);return isNaN(n)&&(n=new Date(e).valueOf()-new Date().valueOf()),Math.max(r,n)}};var bFt=3,IFt=1e3,TFt=[si.NOT_FOUND,si.REQUEST_TIMEOUT,si.TOO_MANY_REQUESTS,si.SERVER_ERROR,si.SERVICE_UNAVAILABLE,si.GATEWAY_TIMEOUT],jz=class t{static{s(this,"DefaultManagedIdentityRetryPolicy")}constructor(){this.linearRetryStrategy=new Wz}static get DEFAULT_MANAGED_IDENTITY_RETRY_DELAY_MS(){return IFt}async pauseForRetry(e,r,n,i){if(TFt.includes(e)&&r<bFt){let o=this.linearRetryStrategy.calculateDelay(i,t.DEFAULT_MANAGED_IDENTITY_RETRY_DELAY_MS);return n.verbose(`Retrying request in ${o}ms (retry attempt: ${r+1})`),await new Promise(a=>setTimeout(a,o)),!0}return!1}};var Cp=class{static{s(this,"ManagedIdentityRequestParameters")}constructor(e,r,n){this.httpMethod=e,this._baseEndpoint=r,this.headers={},this.bodyParameters={},this.queryParameters={},this.retryPolicy=n||new jz}computeUri(){let e=new Map;this.queryParameters&&hr.addExtraQueryParameters(e,this.queryParameters);let r=zu.mapToQueryString(e);return Mi.appendQueryString(this._baseEndpoint,r)}computeParametersBodyString(){let e=new Map;return this.bodyParameters&&hr.addExtraQueryParameters(e,this.bodyParameters),zu.mapToQueryString(e)}};var wFt="2019-08-01",Q6=class t extends Ef{static{s(this,"AppService")}constructor(e,r,n,i,o,a,c){super(e,r,n,i,o),this.identityEndpoint=a,this.identityHeader=c}static getEnvironmentVariables(){let e=process.env[Hn.IDENTITY_ENDPOINT],r=process.env[Hn.IDENTITY_HEADER];return[e,r]}static tryCreate(e,r,n,i,o){let[a,c]=t.getEnvironmentVariables();if(!a||!c)return e.info(`[Managed Identity] ${Zn.APP_SERVICE} managed identity is unavailable because one or both of the '${Hn.IDENTITY_HEADER}' and '${Hn.IDENTITY_ENDPOINT}' environment variables are not defined.`),null;let l=t.getValidatedEnvVariableUrlString(Hn.IDENTITY_ENDPOINT,a,Zn.APP_SERVICE,e);return e.info(`[Managed Identity] Environment variables validation passed for ${Zn.APP_SERVICE} managed identity. Endpoint URI: ${l}. Creating ${Zn.APP_SERVICE} managed identity.`),new t(e,r,n,i,o,a,c)}createRequest(e,r){let n=new Cp(ia.GET,this.identityEndpoint);return n.headers[gp.APP_SERVICE_SECRET_HEADER_NAME]=this.identityHeader,n.queryParameters[il.API_VERSION]=wFt,n.queryParameters[il.RESOURCE]=e,r.idType!==Ja.SYSTEM_ASSIGNED&&(n.queryParameters[this.getManagedIdentityUserAssignedIdQueryParameterKey(r.idType)]=r.id),n}};d();var lx=require("fs"),yqe=Be(require("path"),1);var SFt="2019-11-01",hqe="http://127.0.0.1:40342/metadata/identity/oauth2/token",gqe="N/A: himds executable exists",Aqe={win32:`${process.env.ProgramData}\\AzureConnectedMachineAgent\\Tokens\\`,linux:"/var/opt/azcmagent/tokens/"},_Ft={win32:`${process.env.ProgramFiles}\\AzureConnectedMachineAgent\\himds.exe`,linux:"/opt/azcmagent/bin/himds"},U6=class t extends Ef{static{s(this,"AzureArc")}constructor(e,r,n,i,o,a){super(e,r,n,i,o),this.identityEndpoint=a}static getEnvironmentVariables(){let e=process.env[Hn.IDENTITY_ENDPOINT],r=process.env[Hn.IMDS_ENDPOINT];if(!e||!r){let n=_Ft[process.platform];try{(0,lx.accessSync)(n,lx.constants.F_OK|lx.constants.R_OK),e=hqe,r=gqe}catch{}}return[e,r]}static tryCreate(e,r,n,i,o,a){let[c,l]=t.getEnvironmentVariables();if(!c||!l)return e.info(`[Managed Identity] ${Zn.AZURE_ARC} managed identity is unavailable through environment variables because one or both of '${Hn.IDENTITY_ENDPOINT}' and '${Hn.IMDS_ENDPOINT}' are not defined. ${Zn.AZURE_ARC} managed identity is also unavailable through file detection.`),null;if(l===gqe)e.info(`[Managed Identity] ${Zn.AZURE_ARC} managed identity is available through file detection. Defaulting to known ${Zn.AZURE_ARC} endpoint: ${hqe}. Creating ${Zn.AZURE_ARC} managed identity.`);else{let u=t.getValidatedEnvVariableUrlString(Hn.IDENTITY_ENDPOINT,c,Zn.AZURE_ARC,e);u.endsWith("/")&&u.slice(0,-1),t.getValidatedEnvVariableUrlString(Hn.IMDS_ENDPOINT,l,Zn.AZURE_ARC,e),e.info(`[Managed Identity] Environment variables validation passed for ${Zn.AZURE_ARC} managed identity. Endpoint URI: ${u}. Creating ${Zn.AZURE_ARC} managed identity.`)}if(a.idType!==Ja.SYSTEM_ASSIGNED)throw Fc(nz);return new t(e,r,n,i,o,c)}createRequest(e){let r=new Cp(ia.GET,this.identityEndpoint.replace("localhost","127.0.0.1"));return r.headers[gp.METADATA_HEADER_NAME]="true",r.queryParameters[il.API_VERSION]=SFt,r.queryParameters[il.RESOURCE]=e,r}async getServerTokenResponseAsync(e,r,n,i){let o;if(e.status===si.UNAUTHORIZED){let a=e.headers["www-authenticate"];if(!a)throw Fc(sz);if(!a.includes("Basic realm="))throw Fc(az);let c=a.split("Basic realm=")[1];if(!Aqe.hasOwnProperty(process.platform))throw Fc(rz);let l=Aqe[process.platform],u=yqe.default.basename(c);if(!u.endsWith(".key"))throw Fc(ZV);if(l+u!==c)throw Fc(ez);let f;try{f=await(0,lx.statSync)(c).size}catch{throw Fc(w6)}if(f>xOe)throw Fc(tz);let p;try{p=(0,lx.readFileSync)(c,Gu.UTF8)}catch{throw Fc(w6)}let m=`Basic ${p}`;this.logger.info("[Managed Identity] Adding authorization header to the request."),n.headers[gp.AUTHORIZATION_HEADER_NAME]=m;try{o=await r.sendGetRequestAsync(n.computeUri(),i)}catch(h){throw h instanceof ai?h:vt(Cs.networkError)}}return this.getServerTokenResponse(o||e)}};d();var q6=class t extends Ef{static{s(this,"CloudShell")}constructor(e,r,n,i,o,a){super(e,r,n,i,o),this.msiEndpoint=a}static getEnvironmentVariables(){return[process.env[Hn.MSI_ENDPOINT]]}static tryCreate(e,r,n,i,o,a){let[c]=t.getEnvironmentVariables();if(!c)return e.info(`[Managed Identity] ${Zn.CLOUD_SHELL} managed identity is unavailable because the '${Hn.MSI_ENDPOINT} environment variable is not defined.`),null;let l=t.getValidatedEnvVariableUrlString(Hn.MSI_ENDPOINT,c,Zn.CLOUD_SHELL,e);if(e.info(`[Managed Identity] Environment variable validation passed for ${Zn.CLOUD_SHELL} managed identity. Endpoint URI: ${l}. Creating ${Zn.CLOUD_SHELL} managed identity.`),a.idType!==Ja.SYSTEM_ASSIGNED)throw Fc(iz);return new t(e,r,n,i,o,c)}createRequest(e){let r=new Cp(ia.POST,this.msiEndpoint);return r.headers[gp.METADATA_HEADER_NAME]="true",r.bodyParameters[il.RESOURCE]=e,r}};d();d();d();var Gz=class{static{s(this,"ExponentialRetryStrategy")}constructor(e,r,n){this.minExponentialBackoff=e,this.maxExponentialBackoff=r,this.exponentialDeltaBackoff=n}calculateDelay(e){return e===0?this.minExponentialBackoff:Math.min(Math.pow(2,e-1)*this.exponentialDeltaBackoff,this.maxExponentialBackoff)}};var RFt=[si.NOT_FOUND,si.REQUEST_TIMEOUT,si.GONE,si.TOO_MANY_REQUESTS],kFt=3,PFt=7,DFt=1e3,BFt=4e3,NFt=2e3,MFt=10*1e3,Vz=class t{static{s(this,"ImdsRetryPolicy")}constructor(){this.exponentialRetryStrategy=new Gz(t.MIN_EXPONENTIAL_BACKOFF_MS,t.MAX_EXPONENTIAL_BACKOFF_MS,t.EXPONENTIAL_DELTA_BACKOFF_MS)}static get MIN_EXPONENTIAL_BACKOFF_MS(){return DFt}static get MAX_EXPONENTIAL_BACKOFF_MS(){return BFt}static get EXPONENTIAL_DELTA_BACKOFF_MS(){return NFt}static get HTTP_STATUS_GONE_RETRY_AFTER_MS(){return MFt}set isNewRequest(e){this._isNewRequest=e}async pauseForRetry(e,r,n){if(this._isNewRequest&&(this._isNewRequest=!1,this.maxRetries=e===si.GONE?PFt:kFt),(RFt.includes(e)||e>=si.SERVER_ERROR_RANGE_START&&e<=si.SERVER_ERROR_RANGE_END&&r<this.maxRetries)&&r<this.maxRetries){let i=e===si.GONE?t.HTTP_STATUS_GONE_RETRY_AFTER_MS:this.exponentialRetryStrategy.calculateDelay(r);return n.verbose(`Retrying request in ${i}ms (retry attempt: ${r+1})`),await new Promise(o=>setTimeout(o,i)),!0}return!1}};var Cqe="/metadata/identity/oauth2/token",LFt=`http://169.254.169.254${Cqe}`,FFt="2018-02-01",zz=class t extends Ef{static{s(this,"Imds")}constructor(e,r,n,i,o,a){super(e,r,n,i,o),this.identityEndpoint=a}static tryCreate(e,r,n,i,o){let a;return process.env[Hn.AZURE_POD_IDENTITY_AUTHORITY_HOST]?(e.info(`[Managed Identity] Environment variable ${Hn.AZURE_POD_IDENTITY_AUTHORITY_HOST} for ${Zn.IMDS} returned endpoint: ${process.env[Hn.AZURE_POD_IDENTITY_AUTHORITY_HOST]}`),a=t.getValidatedEnvVariableUrlString(Hn.AZURE_POD_IDENTITY_AUTHORITY_HOST,`${process.env[Hn.AZURE_POD_IDENTITY_AUTHORITY_HOST]}${Cqe}`,Zn.IMDS,e)):(e.info(`[Managed Identity] Unable to find ${Hn.AZURE_POD_IDENTITY_AUTHORITY_HOST} environment variable for ${Zn.IMDS}, using the default endpoint.`),a=LFt),new t(e,r,n,i,o,a)}createRequest(e,r){let n=new Cp(ia.GET,this.identityEndpoint);return n.headers[gp.METADATA_HEADER_NAME]="true",n.queryParameters[il.API_VERSION]=FFt,n.queryParameters[il.RESOURCE]=e,r.idType!==Ja.SYSTEM_ASSIGNED&&(n.queryParameters[this.getManagedIdentityUserAssignedIdQueryParameterKey(r.idType,!0)]=r.id),n.retryPolicy=new Vz,n}};d();var OFt="2019-07-01-preview",H6=class t extends Ef{static{s(this,"ServiceFabric")}constructor(e,r,n,i,o,a,c){super(e,r,n,i,o),this.identityEndpoint=a,this.identityHeader=c}static getEnvironmentVariables(){let e=process.env[Hn.IDENTITY_ENDPOINT],r=process.env[Hn.IDENTITY_HEADER],n=process.env[Hn.IDENTITY_SERVER_THUMBPRINT];return[e,r,n]}static tryCreate(e,r,n,i,o,a){let[c,l,u]=t.getEnvironmentVariables();if(!c||!l||!u)return e.info(`[Managed Identity] ${Zn.SERVICE_FABRIC} managed identity is unavailable because one or all of the '${Hn.IDENTITY_HEADER}', '${Hn.IDENTITY_ENDPOINT}' or '${Hn.IDENTITY_SERVER_THUMBPRINT}' environment variables are not defined.`),null;let f=t.getValidatedEnvVariableUrlString(Hn.IDENTITY_ENDPOINT,c,Zn.SERVICE_FABRIC,e);return e.info(`[Managed Identity] Environment variables validation passed for ${Zn.SERVICE_FABRIC} managed identity. Endpoint URI: ${f}. Creating ${Zn.SERVICE_FABRIC} managed identity.`),a.idType!==Ja.SYSTEM_ASSIGNED&&e.warning(`[Managed Identity] ${Zn.SERVICE_FABRIC} user assigned managed identity is configured in the cluster, not during runtime. See also: https://learn.microsoft.com/en-us/azure/service-fabric/configure-existing-cluster-enable-managed-identity-token-service.`),new t(e,r,n,i,o,c,l)}createRequest(e,r){let n=new Cp(ia.GET,this.identityEndpoint);return n.headers[gp.ML_AND_SF_SECRET_HEADER_NAME]=this.identityHeader,n.queryParameters[il.API_VERSION]=OFt,n.queryParameters[il.RESOURCE]=e,r.idType!==Ja.SYSTEM_ASSIGNED&&(n.queryParameters[this.getManagedIdentityUserAssignedIdQueryParameterKey(r.idType)]=r.id),n}};d();var QFt="2017-09-01",UFt=`Only client id is supported for user-assigned managed identity in ${Zn.MACHINE_LEARNING}.`,$6=class t extends Ef{static{s(this,"MachineLearning")}constructor(e,r,n,i,o,a,c){super(e,r,n,i,o),this.msiEndpoint=a,this.secret=c}static getEnvironmentVariables(){let e=process.env[Hn.MSI_ENDPOINT],r=process.env[Hn.MSI_SECRET];return[e,r]}static tryCreate(e,r,n,i,o){let[a,c]=t.getEnvironmentVariables();if(!a||!c)return e.info(`[Managed Identity] ${Zn.MACHINE_LEARNING} managed identity is unavailable because one or both of the '${Hn.MSI_ENDPOINT}' and '${Hn.MSI_SECRET}' environment variables are not defined.`),null;let l=t.getValidatedEnvVariableUrlString(Hn.MSI_ENDPOINT,a,Zn.MACHINE_LEARNING,e);return e.info(`[Managed Identity] Environment variables validation passed for ${Zn.MACHINE_LEARNING} managed identity. Endpoint URI: ${l}. Creating ${Zn.MACHINE_LEARNING} managed identity.`),new t(e,r,n,i,o,a,c)}createRequest(e,r){let n=new Cp(ia.GET,this.msiEndpoint);if(n.headers[gp.METADATA_HEADER_NAME]="true",n.headers[gp.ML_AND_SF_SECRET_HEADER_NAME]=this.secret,n.queryParameters[il.API_VERSION]=QFt,n.queryParameters[il.RESOURCE]=e,r.idType===Ja.SYSTEM_ASSIGNED)n.queryParameters[Z2.MANAGED_IDENTITY_CLIENT_ID_2017]=process.env[Hn.DEFAULT_IDENTITY_CLIENT_ID];else if(r.idType===Ja.USER_ASSIGNED_CLIENT_ID)n.queryParameters[this.getManagedIdentityUserAssignedIdQueryParameterKey(r.idType,!1,!0)]=r.id;else throw new Error(UFt);return n}};var W6=class t{static{s(this,"ManagedIdentityClient")}constructor(e,r,n,i,o){this.logger=e,this.nodeStorage=r,this.networkClient=n,this.cryptoProvider=i,this.disableInternalRetries=o}async sendManagedIdentityTokenRequest(e,r,n,i){return t.identitySource||(t.identitySource=this.selectManagedIdentitySource(this.logger,this.nodeStorage,this.networkClient,this.cryptoProvider,this.disableInternalRetries,r)),t.identitySource.acquireTokenWithManagedIdentity(e,r,n,i)}allEnvironmentVariablesAreDefined(e){return Object.values(e).every(r=>r!==void 0)}getManagedIdentitySource(){return t.sourceName=this.allEnvironmentVariablesAreDefined(H6.getEnvironmentVariables())?Zn.SERVICE_FABRIC:this.allEnvironmentVariablesAreDefined(Q6.getEnvironmentVariables())?Zn.APP_SERVICE:this.allEnvironmentVariablesAreDefined($6.getEnvironmentVariables())?Zn.MACHINE_LEARNING:this.allEnvironmentVariablesAreDefined(q6.getEnvironmentVariables())?Zn.CLOUD_SHELL:this.allEnvironmentVariablesAreDefined(U6.getEnvironmentVariables())?Zn.AZURE_ARC:Zn.DEFAULT_TO_IMDS,t.sourceName}selectManagedIdentitySource(e,r,n,i,o,a){let c=H6.tryCreate(e,r,n,i,o,a)||Q6.tryCreate(e,r,n,i,o)||$6.tryCreate(e,r,n,i,o)||q6.tryCreate(e,r,n,i,o,a)||U6.tryCreate(e,r,n,i,o,a)||zz.tryCreate(e,r,n,i,o);if(!c)throw Fc(oz);return c}};var qFt=[Zn.SERVICE_FABRIC],hB=class t{static{s(this,"ManagedIdentityApplication")}constructor(e){this.config=ROe(e||{}),this.logger=new R0(this.config.system.loggerOptions,qz,AA);let r={canonicalAuthority:rt.DEFAULT_AUTHORITY};t.nodeStorage||(t.nodeStorage=new iT(this.logger,this.config.managedIdentityId.id,UD,r)),this.networkClient=this.config.system.networkClient,this.cryptoProvider=new TC;let n={protocolMode:Ld.AAD,knownAuthorities:[uge],cloudDiscoveryMetadata:"",authorityMetadata:""};this.fakeAuthority=new hA(uge,this.networkClient,t.nodeStorage,n,this.logger,this.cryptoProvider.createNewGuid(),void 0,!0),this.fakeClientCredentialClient=new cT({authOptions:{clientId:this.config.managedIdentityId.id,authority:this.fakeAuthority}}),this.managedIdentityClient=new W6(this.logger,t.nodeStorage,this.networkClient,this.cryptoProvider,this.config.disableInternalRetries),this.hashUtils=new nT}async acquireToken(e){if(!e.resource)throw vs(WD.urlEmptyError);let r={forceRefresh:e.forceRefresh,resource:e.resource.replace("/.default",""),scopes:[e.resource.replace("/.default","")],authority:this.fakeAuthority.canonicalAuthority,correlationId:this.cryptoProvider.createNewGuid(),claims:e.claims,clientCapabilities:this.config.clientCapabilities};if(r.forceRefresh)return this.acquireTokenFromManagedIdentity(r,this.config.managedIdentityId,this.fakeAuthority);let[n,i]=await this.fakeClientCredentialClient.getCachedAuthenticationResult(r,this.config,this.cryptoProvider,this.fakeAuthority,t.nodeStorage);if(r.claims){let o=this.managedIdentityClient.getManagedIdentitySource();if(n&&qFt.includes(o)){let a=this.hashUtils.sha256(n.accessToken).toString(Gu.HEX);r.revokedTokenSha256Hash=a}return this.acquireTokenFromManagedIdentity(r,this.config.managedIdentityId,this.fakeAuthority)}return n?(i===_s.PROACTIVELY_REFRESHED&&(this.logger.info("ClientCredentialClient:getCachedAuthenticationResult - Cached access token's refreshOn property has been exceeded'. It's not expired, but must be refreshed."),await this.acquireTokenFromManagedIdentity(r,this.config.managedIdentityId,this.fakeAuthority,!0)),n):this.acquireTokenFromManagedIdentity(r,this.config.managedIdentityId,this.fakeAuthority)}async acquireTokenFromManagedIdentity(e,r,n,i){return this.managedIdentityClient.sendManagedIdentityTokenRequest(e,r,n,i)}getManagedIdentitySource(){return W6.sourceName||this.managedIdentityClient.getManagedIdentitySource()}};d();var Kz=class{static{s(this,"DistributedCachePlugin")}constructor(e,r){this.client=e,this.partitionManager=r}async beforeCacheAccess(e){let r=await this.partitionManager.getKey(),n=await this.client.get(r);e.tokenCache.deserialize(n)}async afterCacheAccess(e){if(e.cacheHasChanged){let r=e.tokenCache.getKVStore(),n=Object.values(r).filter(o=>Vu.isAccountEntity(o)),i;if(n.length>0){let o=n[0];i=await this.partitionManager.extractKey(o)}else i=await this.partitionManager.getKey();await this.client.set(i,e.tokenCache.serialize())}}};d();d();d();d();d();function j6(t,e){return t=Math.ceil(t),e=Math.floor(e),Math.floor(Math.random()*(e-t+1))+t}s(j6,"getRandomIntegerInclusive");function G6(t,e){let r=e.retryDelayInMs*Math.pow(2,t),n=Math.min(e.maxRetryDelayInMs,r);return{retryAfterInMs:n/2+j6(0,n/2)}}s(G6,"calculateRetryDelay");d();function gB(t){return typeof t=="object"&&t!==null&&!Array.isArray(t)&&!(t instanceof RegExp)&&!(t instanceof Date)}s(gB,"isObject");d();function eR(t){if(gB(t)){let e=typeof t.name=="string",r=typeof t.message=="string";return e&&r}return!1}s(eR,"isError");d();d();var vqe=require("node:crypto");var iAe,HFt=typeof((iAe=globalThis?.crypto)===null||iAe===void 0?void 0:iAe.randomUUID)=="function"?globalThis.crypto.randomUUID.bind(globalThis.crypto):vqe.randomUUID;function AB(){return HFt()}s(AB,"randomUUID");d();var oAe,sAe,aAe,cAe,xqe=typeof window<"u"&&typeof window.document<"u",Eqe=typeof self=="object"&&typeof self?.importScripts=="function"&&(((oAe=self.constructor)===null||oAe===void 0?void 0:oAe.name)==="DedicatedWorkerGlobalScope"||((sAe=self.constructor)===null||sAe===void 0?void 0:sAe.name)==="ServiceWorkerGlobalScope"||((aAe=self.constructor)===null||aAe===void 0?void 0:aAe.name)==="SharedWorkerGlobalScope"),bqe=typeof Deno<"u"&&typeof Deno.version<"u"&&typeof Deno.version.deno<"u",Iqe=typeof Bun<"u"&&typeof Bun.version<"u",lT=typeof globalThis.process<"u"&&!!globalThis.process.version&&!!(!((cAe=globalThis.process.versions)===null||cAe===void 0)&&cAe.node);var Tqe=typeof navigator<"u"&&navigator?.product==="ReactNative";d();function vp(t,e){return Buffer.from(t,e)}s(vp,"stringToUint8Array");d();var lAe="REDACTED",$Ft=["x-ms-client-request-id","x-ms-return-client-request-id","x-ms-useragent","x-ms-correlation-request-id","x-ms-request-id","client-request-id","ms-cv","return-client-request-id","traceparent","Access-Control-Allow-Credentials","Access-Control-Allow-Headers","Access-Control-Allow-Methods","Access-Control-Allow-Origin","Access-Control-Expose-Headers","Access-Control-Max-Age","Access-Control-Request-Headers","Access-Control-Request-Method","Origin","Accept","Accept-Encoding","Cache-Control","Connection","Content-Length","Content-Type","Date","ETag","Expires","If-Match","If-Modified-Since","If-None-Match","If-Unmodified-Since","Last-Modified","Pragma","Request-Id","Retry-After","Server","Transfer-Encoding","User-Agent","WWW-Authenticate"],WFt=["api-version"],yA=class{static{s(this,"Sanitizer")}constructor({additionalAllowedHeaderNames:e=[],additionalAllowedQueryParameters:r=[]}={}){e=$Ft.concat(e),r=WFt.concat(r),this.allowedHeaderNames=new Set(e.map(n=>n.toLowerCase())),this.allowedQueryParameters=new Set(r.map(n=>n.toLowerCase()))}sanitize(e){let r=new Set;return JSON.stringify(e,(n,i)=>{if(i instanceof Error)return Object.assign(Object.assign({},i),{name:i.name,message:i.message});if(n==="headers")return this.sanitizeHeaders(i);if(n==="url")return this.sanitizeUrl(i);if(n==="query")return this.sanitizeQuery(i);if(n==="body")return;if(n==="response")return;if(n==="operationSpec")return;if(Array.isArray(i)||gB(i)){if(r.has(i))return"[Circular]";r.add(i)}return i},2)}sanitizeUrl(e){if(typeof e!="string"||e===null||e==="")return e;let r=new URL(e);if(!r.search)return e;for(let[n]of r.searchParams)this.allowedQueryParameters.has(n.toLowerCase())||r.searchParams.set(n,lAe);return r.toString()}sanitizeHeaders(e){let r={};for(let n of Object.keys(e))this.allowedHeaderNames.has(n.toLowerCase())?r[n]=e[n]:r[n]=lAe;return r}sanitizeQuery(e){if(typeof e!="object"||e===null)return e;let r={};for(let n of Object.keys(e))this.allowedQueryParameters.has(n.toLowerCase())?r[n]=e[n]:r[n]=lAe;return r}};d();d();d();d();var tR=class extends Error{static{s(this,"AbortError")}constructor(e){super(e),this.name="AbortError"}};function dAe(t,e){let{cleanupBeforeAbort:r,abortSignal:n,abortErrorMsg:i}=e??{};return new Promise((o,a)=>{function c(){a(new tR(i??"The operation was aborted."))}s(c,"rejectOnAbort");function l(){n?.removeEventListener("abort",u)}s(l,"removeListeners");function u(){r?.(),l(),c()}if(s(u,"onAbort"),n?.aborted)return c();try{t(f=>{l(),o(f)},f=>{l(),a(f)})}catch(f){a(f)}n?.addEventListener("abort",u)})}s(dAe,"createAbortablePromise");d();var KFt="The delay was aborted.";function fAe(t,e){let r,{abortSignal:n,abortErrorMsg:i}=e??{};return dAe(o=>{r=setTimeout(o,t)},{cleanupBeforeAbort:s(()=>clearTimeout(r),"cleanupBeforeAbort"),abortSignal:n,abortErrorMsg:i??KFt})}s(fAe,"delay");d();function yB(t){if(eR(t))return t.message;{let e;try{typeof t=="object"&&t?e=JSON.stringify(t):e=String(t)}catch{e="[unable to stringify input]"}return`Unknown error ${e}`}}s(yB,"getErrorMessage");d();function wqe(t,e){return G6(t,e)}s(wqe,"calculateRetryDelay");function Yz(t){return eR(t)}s(Yz,"isError");var Jz=lT,CB=lT;d();var V6=ni("IdentityUtils"),Sqe="1.0";function rR(t,e,r){let n=s(i=>(V6.getToken.info(i),new Zm({scopes:Array.isArray(t)?t:[t],getTokenOptions:r,message:i})),"error");if(!e)throw n("No response");if(!e.expiresOn)throw n('Response had no "expiresOn" property.');if(!e.accessToken)throw n('Response had no "accessToken" property.')}s(rR,"ensureValidMsalToken");function pAe(t){let e=t?.authorityHost;return!e&&CB&&(e=process.env.AZURE_AUTHORITY_HOST),e??C9}s(pAe,"getAuthorityHost");function mAe(t,e){return e||(e=C9),new RegExp(`${t}/?$`).test(e)?e:e.endsWith("/")?e+t:`${e}/${t}`}s(mAe,"getAuthority");function _qe(t,e,r){return t==="adfs"&&e||r?[e]:[]}s(_qe,"getKnownAuthorities");var Xz=s((t,e=Jz?"Node":"Browser")=>(r,n,i)=>{if(!i)switch(r){case N0.LogLevel.Error:t.info(`MSAL ${e} V2 error: ${n}`);return;case N0.LogLevel.Info:t.info(`MSAL ${e} V2 info message: ${n}`);return;case N0.LogLevel.Verbose:t.info(`MSAL ${e} V2 verbose message: ${n}`);return;case N0.LogLevel.Warning:t.info(`MSAL ${e} V2 warning: ${n}`);return}},"defaultLoggerCallback");function Zz(t){switch(t){case"error":return N0.LogLevel.Error;case"info":return N0.LogLevel.Info;case"verbose":return N0.LogLevel.Verbose;case"warning":return N0.LogLevel.Warning;default:return N0.LogLevel.Info}}s(Zz,"getMSALLogLevel");function nR(t,e,r){if(e.name==="AuthError"||e.name==="ClientAuthError"||e.name==="BrowserAuthError"){let n=e;switch(n.errorCode){case"endpoints_resolution_error":return V6.info(Eo(t,e.message)),new Hr(e.message);case"device_code_polling_cancelled":return new tR("The authentication has been aborted by the caller.");case"consent_required":case"interaction_required":case"login_required":V6.info(Eo(t,`Authentication returned errorCode ${n.errorCode}`));break;default:V6.info(Eo(t,`Failed to acquire token: ${e.message}`));break}}return e.name==="ClientConfigurationError"||e.name==="BrowserConfigurationAuthError"||e.name==="AbortError"||e.name==="AuthenticationError"?e:e.name==="NativeAuthError"?(V6.info(Eo(t,`Error from the native broker: ${e.message} with status code: ${e.statusCode}`)),e):new Zm({scopes:t,getTokenOptions:r,message:e.message})}s(nR,"handleMsalError");function Rqe(t){return{localAccountId:t.homeAccountId,environment:t.authority,username:t.username,homeAccountId:t.homeAccountId,tenantId:t.tenantId}}s(Rqe,"publicToMsal");function kqe(t,e){return{authority:e.environment??v6e,homeAccountId:e.homeAccountId,tenantId:e.tenantId||C6e,username:e.username,clientId:t,version:Sqe}}s(kqe,"msalToPublic");function hAe(t){let e=JSON.parse(t);if(e.version&&e.version!==Sqe)throw Error("Unsupported AuthenticationRecord version");return e}s(hAe,"deserializeAuthenticationRecord");d();d();d();d();d();d();function JFt(t,e){return e!=="Composite"&&e!=="Dictionary"&&(typeof t=="string"||typeof t=="number"||typeof t=="boolean"||e?.match(/^(Date|DateTime|DateTimeRfc1123|UnixTime|ByteArray|Base64Url)$/i)!==null||t===void 0||t===null)}s(JFt,"isPrimitiveBody");function XFt(t){let e=Object.assign(Object.assign({},t.headers),t.body);return t.hasNullableType&&Object.getOwnPropertyNames(e).length===0?t.shouldWrapBody?{body:null}:null:t.shouldWrapBody?Object.assign(Object.assign({},t.headers),{body:t.body}):e}s(XFt,"handleNullableResponseAndWrappableBody");function gAe(t,e){var r,n;let i=t.parsedHeaders;if(t.request.method==="HEAD")return Object.assign(Object.assign({},i),{body:t.parsedBody});let o=e&&e.bodyMapper,a=!!o?.nullable,c=o?.type.name;if(c==="Stream")return Object.assign(Object.assign({},i),{blobBody:t.blobBody,readableStreamBody:t.readableStreamBody});let l=c==="Composite"&&o.type.modelProperties||{},u=Object.keys(l).some(f=>l[f].serializedName==="");if(c==="Sequence"||u){let f=(r=t.parsedBody)!==null&&r!==void 0?r:[];for(let p of Object.keys(l))l[p].serializedName&&(f[p]=(n=t.parsedBody)===null||n===void 0?void 0:n[p]);if(i)for(let p of Object.keys(i))f[p]=i[p];return a&&!t.parsedBody&&!i&&Object.getOwnPropertyNames(l).length===0?null:f}return XFt({body:t.parsedBody,headers:i,hasNullableType:a,shouldWrapBody:JFt(t.parsedBody,c)})}s(gAe,"flattenResponse");var _C={Base64Url:"Base64Url",Boolean:"Boolean",ByteArray:"ByteArray",Composite:"Composite",Date:"Date",DateTime:"DateTime",DateTimeRfc1123:"DateTimeRfc1123",Dictionary:"Dictionary",Enum:"Enum",Number:"Number",Object:"Object",Sequence:"Sequence",String:"String",Stream:"Stream",TimeSpan:"TimeSpan",UnixTime:"UnixTime"};d();d();d();d();d();var RC=class extends Error{static{s(this,"AbortError")}constructor(e){super(e),this.name="AbortError"}};d();d();d();var Pqe=require("node:os"),Dqe=Be(require("node:util"),1),Bqe=Be(require("node:process"),1);function Nqe(t,...e){Bqe.stderr.write(`${Dqe.default.format(t,...e)}${Pqe.EOL}`)}s(Nqe,"log");var Mqe=typeof process<"u"&&process.env&&process.env.DEBUG||void 0,Lqe,AAe=[],yAe=[],tK=[];Mqe&&CAe(Mqe);var Fqe=Object.assign(t=>Oqe(t),{enable:CAe,enabled:vAe,disable:ZFt,log:Nqe});function CAe(t){Lqe=t,AAe=[],yAe=[];let e=/\*/g,r=t.split(",").map(n=>n.trim().replace(e,".*?"));for(let n of r)n.startsWith("-")?yAe.push(new RegExp(`^${n.substr(1)}$`)):AAe.push(new RegExp(`^${n}$`));for(let n of tK)n.enabled=vAe(n.namespace)}s(CAe,"enable");function vAe(t){if(t.endsWith("*"))return!0;for(let e of yAe)if(e.test(t))return!1;for(let e of AAe)if(e.test(t))return!0;return!1}s(vAe,"enabled");function ZFt(){let t=Lqe||"";return CAe(""),t}s(ZFt,"disable");function Oqe(t){let e=Object.assign(r,{enabled:vAe(t),destroy:e9t,log:Fqe.log,namespace:t,extend:t9t});function r(...n){e.enabled&&(n.length>0&&(n[0]=`${t} ${n[0]}`),e.log(...n))}return s(r,"debug"),tK.push(e),e}s(Oqe,"createDebugger");function e9t(){let t=tK.indexOf(this);return t>=0?(tK.splice(t,1),!0):!1}s(e9t,"destroy");function t9t(t){let e=Oqe(`${this.namespace}:${t}`);return e.log=this.log,e}s(t9t,"extend");var vB=Fqe;var xAe=["verbose","info","warning","error"],Qqe={verbose:400,info:300,warning:200,error:100};function Uqe(t,e){e.log=(...r)=>{t.log(...r)}}s(Uqe,"patchLogMethod");function qqe(t){return xAe.includes(t)}s(qqe,"isTypeSpecRuntimeLogLevel");function r9t(t){let e=new Set,r=typeof process<"u"&&process.env&&process.env[t.logLevelEnvVarName]||void 0,n,i=vB(t.namespace);i.log=(...f)=>{vB.log(...f)};function o(f){if(f&&!qqe(f))throw new Error(`Unknown log level '${f}'. Acceptable values: ${xAe.join(",")}`);n=f;let p=[];for(let m of e)a(m)&&p.push(m.namespace);vB.enable(p.join(","))}s(o,"contextSetLogLevel"),r&&(qqe(r)?o(r):console.error(`${t.logLevelEnvVarName} set to unknown log level '${r}'; logging is not enabled. Acceptable values: ${xAe.join(", ")}.`));function a(f){return!!(n&&Qqe[f.level]<=Qqe[n])}s(a,"shouldEnable");function c(f,p){let m=Object.assign(f.extend(p),{level:p});if(Uqe(f,m),a(m)){let h=vB.disable();vB.enable(h+","+m.namespace)}return e.add(m),m}s(c,"createLogger");function l(){return n}s(l,"contextGetLogLevel");function u(f){let p=i.extend(f);return Uqe(i,p),{error:c(p,"error"),warning:c(p,"warning"),info:c(p,"info"),verbose:c(p,"verbose")}}return s(u,"contextCreateClientLogger"),{setLogLevel:o,getLogLevel:l,createClientLogger:u,logger:i}}s(r9t,"createLoggerContext");var Hqe=r9t({logLevelEnvVarName:"TYPESPEC_RUNTIME_LOG_LEVEL",namespace:"typeSpecRuntime"}),n9t=Hqe.logger;function K6(t){return Hqe.createClientLogger(t)}s(K6,"createClientLogger");d();function rK(t){return t.toLowerCase()}s(rK,"normalizeName");function*i9t(t){for(let e of t.values())yield[e.name,e.value]}s(i9t,"headerIterator");var EAe=class{static{s(this,"HttpHeadersImpl")}constructor(e){if(this._headersMap=new Map,e)for(let r of Object.keys(e))this.set(r,e[r])}set(e,r){this._headersMap.set(rK(e),{name:e,value:String(r).trim()})}get(e){var r;return(r=this._headersMap.get(rK(e)))===null||r===void 0?void 0:r.value}has(e){return this._headersMap.has(rK(e))}delete(e){this._headersMap.delete(rK(e))}toJSON(e={}){let r={};if(e.preserveCase)for(let n of this._headersMap.values())r[n.name]=n.value;else for(let[n,i]of this._headersMap)r[n]=i.value;return r}toString(){return JSON.stringify(this.toJSON({preserveCase:!0}))}[Symbol.iterator](){return i9t(this._headersMap)}};function M0(t){return new EAe(t)}s(M0,"createHttpHeaders");d();d();d();var bAe=class{static{s(this,"PipelineRequestImpl")}constructor(e){var r,n,i,o,a,c,l;this.url=e.url,this.body=e.body,this.headers=(r=e.headers)!==null&&r!==void 0?r:M0(),this.method=(n=e.method)!==null&&n!==void 0?n:"GET",this.timeout=(i=e.timeout)!==null&&i!==void 0?i:0,this.multipartBody=e.multipartBody,this.formData=e.formData,this.disableKeepAlive=(o=e.disableKeepAlive)!==null&&o!==void 0?o:!1,this.proxySettings=e.proxySettings,this.streamResponseStatusCodes=e.streamResponseStatusCodes,this.withCredentials=(a=e.withCredentials)!==null&&a!==void 0?a:!1,this.abortSignal=e.abortSignal,this.onUploadProgress=e.onUploadProgress,this.onDownloadProgress=e.onDownloadProgress,this.requestId=e.requestId||AB(),this.allowInsecureConnection=(c=e.allowInsecureConnection)!==null&&c!==void 0?c:!1,this.enableBrowserStreams=(l=e.enableBrowserStreams)!==null&&l!==void 0?l:!1,this.requestOverrides=e.requestOverrides,this.authSchemes=e.authSchemes}};function nK(t){return new bAe(t)}s(nK,"createPipelineRequest");d();var $qe=new Set(["Deserialize","Serialize","Retry","Sign"]),IAe=class t{static{s(this,"HttpPipeline")}constructor(e){var r;this._policies=[],this._policies=(r=e?.slice(0))!==null&&r!==void 0?r:[],this._orderedPolicies=void 0}addPolicy(e,r={}){if(r.phase&&r.afterPhase)throw new Error("Policies inside a phase cannot specify afterPhase.");if(r.phase&&!$qe.has(r.phase))throw new Error(`Invalid phase name: ${r.phase}`);if(r.afterPhase&&!$qe.has(r.afterPhase))throw new Error(`Invalid afterPhase name: ${r.afterPhase}`);this._policies.push({policy:e,options:r}),this._orderedPolicies=void 0}removePolicy(e){let r=[];return this._policies=this._policies.filter(n=>e.name&&n.policy.name===e.name||e.phase&&n.options.phase===e.phase?(r.push(n.policy),!1):!0),this._orderedPolicies=void 0,r}sendRequest(e,r){return this.getOrderedPolicies().reduceRight((o,a)=>c=>a.sendRequest(c,o),o=>e.sendRequest(o))(r)}getOrderedPolicies(){return this._orderedPolicies||(this._orderedPolicies=this.orderPolicies()),this._orderedPolicies}clone(){return new t(this._policies)}static create(){return new t}orderPolicies(){let e=[],r=new Map;function n(g){return{name:g,policies:new Set,hasRun:!1,hasAfterPolicies:!1}}s(n,"createPhase");let i=n("Serialize"),o=n("None"),a=n("Deserialize"),c=n("Retry"),l=n("Sign"),u=[i,o,a,c,l];function f(g){return g==="Retry"?c:g==="Serialize"?i:g==="Deserialize"?a:g==="Sign"?l:o}s(f,"getPhase");for(let g of this._policies){let A=g.policy,y=g.options,E=A.name;if(r.has(E))throw new Error("Duplicate policy names not allowed in pipeline");let b={policy:A,dependsOn:new Set,dependants:new Set};y.afterPhase&&(b.afterPhase=f(y.afterPhase),b.afterPhase.hasAfterPolicies=!0),r.set(E,b),f(y.phase).policies.add(b)}for(let g of this._policies){let{policy:A,options:y}=g,E=A.name,b=r.get(E);if(!b)throw new Error(`Missing node for policy ${E}`);if(y.afterPolicies)for(let S of y.afterPolicies){let R=r.get(S);R&&(b.dependsOn.add(R),R.dependants.add(b))}if(y.beforePolicies)for(let S of y.beforePolicies){let R=r.get(S);R&&(R.dependsOn.add(b),b.dependants.add(R))}}function p(g){g.hasRun=!0;for(let A of g.policies)if(!(A.afterPhase&&(!A.afterPhase.hasRun||A.afterPhase.policies.size))&&A.dependsOn.size===0){e.push(A.policy);for(let y of A.dependants)y.dependsOn.delete(A);r.delete(A.policy.name),g.policies.delete(A)}}s(p,"walkPhase");function m(){for(let g of u){if(p(g),g.policies.size>0&&g!==o){o.hasRun||p(o);return}g.hasAfterPolicies&&p(o)}}s(m,"walkPhases");let h=0;for(;r.size>0;){h++;let g=e.length;if(m(),e.length<=g&&h>1)throw new Error("Cannot satisfy policy dependencies due to requirements cycle.")}return e}};function iK(){return IAe.create()}s(iK,"createEmptyPipeline");d();d();var Wqe=require("node:util"),jqe=Wqe.inspect.custom;var o9t=new yA,Ju=class t extends Error{static{s(this,"RestError")}constructor(e,r={}){super(e),this.name="RestError",this.code=r.code,this.statusCode=r.statusCode,Object.defineProperty(this,"request",{value:r.request,enumerable:!1}),Object.defineProperty(this,"response",{value:r.response,enumerable:!1}),Object.defineProperty(this,jqe,{value:s(()=>`RestError: ${this.message} 
 ${o9t.sanitize(Object.assign(Object.assign({},this),{request:this.request,response:this.response}))}`,"value"),enumerable:!1}),Object.setPrototypeOf(this,t.prototype)}};Ju.REQUEST_SEND_ERROR="REQUEST_SEND_ERROR";Ju.PARSE_ERROR="PARSE_ERROR";function oK(t){return t instanceof Ju?!0:eR(t)&&t.name==="RestError"}s(oK,"isRestError");d();d();var xB=Be(require("node:http"),1),EB=Be(require("node:https"),1),aK=Be(require("node:zlib"),1),Vqe=require("node:stream");d();var oh=K6("ts-http-runtime");var s9t={};function Y6(t){return t&&typeof t.pipe=="function"}s(Y6,"isReadableStream");function Gqe(t){return t.readable===!1?Promise.resolve():new Promise(e=>{let r=s(()=>{e(),t.removeListener("close",r),t.removeListener("end",r),t.removeListener("error",r)},"handler");t.on("close",r),t.on("end",r),t.on("error",r)})}s(Gqe,"isStreamComplete");function zqe(t){return t&&typeof t.byteLength=="number"}s(zqe,"isArrayBuffer");var sK=class extends Vqe.Transform{static{s(this,"ReportTransform")}_transform(e,r,n){this.push(e),this.loadedBytes+=e.length;try{this.progressCallback({loadedBytes:this.loadedBytes}),n()}catch(i){n(i)}}constructor(e){super(),this.loadedBytes=0,this.progressCallback=e}},TAe=class{static{s(this,"NodeHttpClient")}constructor(){this.cachedHttpsAgents=new WeakMap}async sendRequest(e){var r,n,i;let o=new AbortController,a;if(e.abortSignal){if(e.abortSignal.aborted)throw new RC("The operation was aborted. Request has already been canceled.");a=s(m=>{m.type==="abort"&&o.abort()},"abortListener"),e.abortSignal.addEventListener("abort",a)}let c;e.timeout>0&&(c=setTimeout(()=>{let m=new yA;oh.info(`request to '${m.sanitizeUrl(e.url)}' timed out. canceling...`),o.abort()},e.timeout));let l=e.headers.get("Accept-Encoding"),u=l?.includes("gzip")||l?.includes("deflate"),f=typeof e.body=="function"?e.body():e.body;if(f&&!e.headers.has("Content-Length")){let m=u9t(f);m!==null&&e.headers.set("Content-Length",m)}let p;try{if(f&&e.onUploadProgress){let E=e.onUploadProgress,b=new sK(E);b.on("error",S=>{oh.error("Error in upload progress",S)}),Y6(f)?f.pipe(b):b.end(f),f=b}let m=await this.makeRequest(e,o,f);c!==void 0&&clearTimeout(c);let h=a9t(m),A={status:(r=m.statusCode)!==null&&r!==void 0?r:0,headers:h,request:e};if(e.method==="HEAD")return m.resume(),A;p=u?c9t(m,h):m;let y=e.onDownloadProgress;if(y){let E=new sK(y);E.on("error",b=>{oh.error("Error in download progress",b)}),p.pipe(E),p=E}return!((n=e.streamResponseStatusCodes)===null||n===void 0)&&n.has(Number.POSITIVE_INFINITY)||!((i=e.streamResponseStatusCodes)===null||i===void 0)&&i.has(A.status)?A.readableStreamBody=p:A.bodyAsText=await l9t(p),A}finally{if(e.abortSignal&&a){let m=Promise.resolve();Y6(f)&&(m=Gqe(f));let h=Promise.resolve();Y6(p)&&(h=Gqe(p)),Promise.all([m,h]).then(()=>{var g;a&&((g=e.abortSignal)===null||g===void 0||g.removeEventListener("abort",a))}).catch(g=>{oh.warning("Error when cleaning up abortListener on httpRequest",g)})}}}makeRequest(e,r,n){var i;let o=new URL(e.url),a=o.protocol!=="https:";if(a&&!e.allowInsecureConnection)throw new Error(`Cannot connect to ${e.url} while allowInsecureConnection is false.`);let c=(i=e.agent)!==null&&i!==void 0?i:this.getOrCreateAgent(e,a),l=Object.assign({agent:c,hostname:o.hostname,path:`${o.pathname}${o.search}`,port:o.port,method:e.method,headers:e.headers.toJSON({preserveCase:!0})},e.requestOverrides);return new Promise((u,f)=>{let p=a?xB.request(l,u):EB.request(l,u);p.once("error",m=>{var h;f(new Ju(m.message,{code:(h=m.code)!==null&&h!==void 0?h:Ju.REQUEST_SEND_ERROR,request:e}))}),r.signal.addEventListener("abort",()=>{let m=new RC("The operation was aborted. Rejecting from abort signal callback while making request.");p.destroy(m),f(m)}),n&&Y6(n)?n.pipe(p):n?typeof n=="string"||Buffer.isBuffer(n)?p.end(n):zqe(n)?p.end(ArrayBuffer.isView(n)?Buffer.from(n.buffer):Buffer.from(n)):(oh.error("Unrecognized body type",n),f(new Ju("Unrecognized body type"))):p.end()})}getOrCreateAgent(e,r){var n;let i=e.disableKeepAlive;if(r)return i?xB.globalAgent:(this.cachedHttpAgent||(this.cachedHttpAgent=new xB.Agent({keepAlive:!0})),this.cachedHttpAgent);{if(i&&!e.tlsSettings)return EB.globalAgent;let o=(n=e.tlsSettings)!==null&&n!==void 0?n:s9t,a=this.cachedHttpsAgents.get(o);return a&&a.options.keepAlive===!i||(oh.info("No cached TLS Agent exist, creating a new Agent"),a=new EB.Agent(Object.assign({keepAlive:!i},o)),this.cachedHttpsAgents.set(o,a)),a}}};function a9t(t){let e=M0();for(let r of Object.keys(t.headers)){let n=t.headers[r];Array.isArray(n)?n.length>0&&e.set(r,n[0]):n&&e.set(r,n)}return e}s(a9t,"getResponseHeaders");function c9t(t,e){let r=e.get("Content-Encoding");if(r==="gzip"){let n=aK.createGunzip();return t.pipe(n),n}else if(r==="deflate"){let n=aK.createInflate();return t.pipe(n),n}return t}s(c9t,"getDecodedResponseStream");function l9t(t){return new Promise((e,r)=>{let n=[];t.on("data",i=>{Buffer.isBuffer(i)?n.push(i):n.push(Buffer.from(i))}),t.on("end",()=>{e(Buffer.concat(n).toString("utf8"))}),t.on("error",i=>{i&&i?.name==="AbortError"?r(i):r(new Ju(`Error reading response as text: ${i.message}`,{code:Ju.PARSE_ERROR}))})})}s(l9t,"streamToText");function u9t(t){return t?Buffer.isBuffer(t)?t.length:Y6(t)?null:zqe(t)?t.byteLength:typeof t=="string"?Buffer.from(t).length:null:0}s(u9t,"getBodyLength");function Kqe(){return new TAe}s(Kqe,"createNodeHttpClient");function cK(){return Kqe()}s(cK,"createDefaultHttpClient");d();d();d();d();var wAe="logPolicy";function lK(t={}){var e;let r=(e=t.logger)!==null&&e!==void 0?e:oh.info,n=new yA({additionalAllowedHeaderNames:t.additionalAllowedHeaderNames,additionalAllowedQueryParameters:t.additionalAllowedQueryParameters});return{name:wAe,async sendRequest(i,o){if(!r.enabled)return o(i);r(`Request: ${n.sanitize(i)}`);let a=await o(i);return r(`Response status code: ${a.status}`),r(`Headers: ${n.sanitize(a.headers)}`),a}}}s(lK,"logPolicy");d();var SAe="redirectPolicy",Yqe=["GET","HEAD"];function uK(t={}){let{maxRetries:e=20}=t;return{name:SAe,async sendRequest(r,n){let i=await n(r);return Jqe(n,i,e)}}}s(uK,"redirectPolicy");async function Jqe(t,e,r,n=0){let{request:i,status:o,headers:a}=e,c=a.get("location");if(c&&(o===300||o===301&&Yqe.includes(i.method)||o===302&&Yqe.includes(i.method)||o===303&&i.method==="POST"||o===307)&&n<r){let l=new URL(c,i.url);i.url=l.toString(),o===303&&(i.method="GET",i.headers.delete("Content-Length"),delete i.body),i.headers.delete("Authorization");let u=await t(i);return Jqe(t,u,r,n+1)}return e}s(Jqe,"handleRedirect");d();d();d();function Xqe(){return"User-Agent"}s(Xqe,"getHeaderName");d();function Zqe(){return Xqe()}s(Zqe,"getUserAgentHeaderName");var Xgn=Zqe();d();var _Ae="decompressResponsePolicy";function dK(){return{name:_Ae,async sendRequest(t,e){return t.method!=="HEAD"&&t.headers.set("Accept-Encoding","gzip,deflate"),e(t)}}}s(dK,"decompressResponsePolicy");d();d();d();d();var d9t="The operation was aborted.";function eHe(t,e,r){return new Promise((n,i)=>{let o,a,c=s(()=>i(new RC(r?.abortErrorMsg?r?.abortErrorMsg:d9t)),"rejectOnAbort"),l=s(()=>{r?.abortSignal&&a&&r.abortSignal.removeEventListener("abort",a)},"removeListeners");if(a=s(()=>(o&&clearTimeout(o),l(),c()),"onAborted"),r?.abortSignal&&r.abortSignal.aborted)return c();o=setTimeout(()=>{l(),n(e)},t),r?.abortSignal&&r.abortSignal.addEventListener("abort",a)})}s(eHe,"delay");function tHe(t,e){let r=t.headers.get(e);if(!r)return;let n=Number(r);if(!Number.isNaN(n))return n}s(tHe,"parseHeaderValueAsNumber");var RAe="Retry-After",f9t=["retry-after-ms","x-ms-retry-after-ms",RAe];function rHe(t){if(t&&[429,503].includes(t.status))try{for(let i of f9t){let o=tHe(t,i);if(o===0||o)return o*(i===RAe?1e3:1)}let e=t.headers.get(RAe);if(!e)return;let n=Date.parse(e)-Date.now();return Number.isFinite(n)?Math.max(0,n):void 0}catch{return}}s(rHe,"getRetryAfterInMs");function nHe(t){return Number.isFinite(rHe(t))}s(nHe,"isThrottlingRetryResponse");function kAe(){return{name:"throttlingRetryStrategy",retry({response:t}){let e=rHe(t);return Number.isFinite(e)?{retryAfterInMs:e}:{skipStrategy:!0}}}}s(kAe,"throttlingRetryStrategy");var p9t=1e3,m9t=1e3*64;function fK(t={}){var e,r;let n=(e=t.retryDelayInMs)!==null&&e!==void 0?e:p9t,i=(r=t.maxRetryDelayInMs)!==null&&r!==void 0?r:m9t;return{name:"exponentialRetryStrategy",retry({retryCount:o,response:a,responseError:c}){let l=g9t(c),u=l&&t.ignoreSystemErrors,f=h9t(a),p=f&&t.ignoreHttpStatusCodes;return a&&(nHe(a)||!f)||p||u?{skipStrategy:!0}:c&&!l&&!f?{errorToThrow:c}:G6(o,{retryDelayInMs:n,maxRetryDelayInMs:i})}}}s(fK,"exponentialRetryStrategy");function h9t(t){return!!(t&&t.status!==void 0&&(t.status>=500||t.status===408)&&t.status!==501&&t.status!==505)}s(h9t,"isExponentialRetryResponse");function g9t(t){return t?t.code==="ETIMEDOUT"||t.code==="ESOCKETTIMEDOUT"||t.code==="ECONNREFUSED"||t.code==="ECONNRESET"||t.code==="ENOENT"||t.code==="ENOTFOUND":!1}s(g9t,"isSystemError");d();var A9t=K6("ts-http-runtime retryPolicy"),y9t="retryPolicy";function uT(t,e={maxRetries:3}){let r=e.logger||A9t;return{name:y9t,async sendRequest(n,i){var o,a;let c,l,u=-1;e:for(;;){u+=1,c=void 0,l=void 0;try{r.info(`Retry ${u}: Attempting to send request`,n.requestId),c=await i(n),r.info(`Retry ${u}: Received a response from request`,n.requestId)}catch(f){if(r.error(`Retry ${u}: Received an error from request`,n.requestId),l=f,!f||l.name!=="RestError")throw f;c=l.response}if(!((o=n.abortSignal)===null||o===void 0)&&o.aborted)throw r.error(`Retry ${u}: Request aborted.`),new RC;if(u>=((a=e.maxRetries)!==null&&a!==void 0?a:3)){if(r.info(`Retry ${u}: Maximum retries reached. Returning the last received response, or throwing the last received error.`),l)throw l;if(c)return c;throw new Error("Maximum retries reached with no response or error to throw")}r.info(`Retry ${u}: Processing ${t.length} retry strategies.`);t:for(let f of t){let p=f.logger||r;p.info(`Retry ${u}: Processing retry strategy ${f.name}.`);let m=f.retry({retryCount:u,response:c,responseError:l});if(m.skipStrategy){p.info(`Retry ${u}: Skipped.`);continue t}let{errorToThrow:h,retryAfterInMs:g,redirectTo:A}=m;if(h)throw p.error(`Retry ${u}: Retry strategy ${f.name} throws error:`,h),h;if(g||g===0){p.info(`Retry ${u}: Retry strategy ${f.name} retries after ${g}`),await eHe(g,void 0,{abortSignal:n.abortSignal});continue e}if(A){p.info(`Retry ${u}: Retry strategy ${f.name} redirects to ${A}`),n.url=A;continue e}}if(l)throw r.info("None of the retry strategies could work with the received error. Throwing it."),l;if(c)return r.info("None of the retry strategies could work with the received response. Returning it."),c}}}}s(uT,"retryPolicy");var PAe="defaultRetryPolicy";function pK(t={}){var e;return{name:PAe,sendRequest:uT([kAe(),fK(t)],{maxRetries:(e=t.maxRetries)!==null&&e!==void 0?e:3}).sendRequest}}s(pK,"defaultRetryPolicy");d();var DAe="formDataPolicy";function C9t(t){var e;let r={};for(let[n,i]of t.entries())(e=r[n])!==null&&e!==void 0||(r[n]=[]),r[n].push(i);return r}s(C9t,"formDataToFormDataMap");function mK(){return{name:DAe,async sendRequest(t,e){if(lT&&typeof FormData<"u"&&t.body instanceof FormData&&(t.formData=C9t(t.body),t.body=void 0),t.formData){let r=t.headers.get("Content-Type");r&&r.indexOf("application/x-www-form-urlencoded")!==-1?t.body=v9t(t.formData):await x9t(t.formData,t),t.formData=void 0}return e(t)}}}s(mK,"formDataPolicy");function v9t(t){let e=new URLSearchParams;for(let[r,n]of Object.entries(t))if(Array.isArray(n))for(let i of n)e.append(r,i.toString());else e.append(r,n.toString());return e.toString()}s(v9t,"wwwFormUrlEncode");async function x9t(t,e){let r=e.headers.get("Content-Type");if(r&&!r.startsWith("multipart/form-data"))return;e.headers.set("Content-Type",r??"multipart/form-data");let n=[];for(let[i,o]of Object.entries(t))for(let a of Array.isArray(o)?o:[o])if(typeof a=="string")n.push({headers:M0({"Content-Disposition":`form-data; name="${i}"`}),body:vp(a,"utf-8")});else{if(a==null||typeof a!="object")throw new Error(`Unexpected value for key ${i}: ${a}. Value should be serialized to string first.`);{let c=a.name||"blob",l=M0();l.set("Content-Disposition",`form-data; name="${i}"; filename="${c}"`),l.set("Content-Type",a.type||"application/octet-stream"),n.push({headers:l,body:a})}}e.multipartBody={parts:n}}s(x9t,"prepareFormData");d();var PHe=Be(IHe(),1),DHe=Be(SHe(),1);var h6t="HTTPS_PROXY",g6t="HTTP_PROXY",A6t="ALL_PROXY",y6t="NO_PROXY",UAe="proxyPolicy",_He=[],BHe=!1,C6t=new Map;function xK(t){if(process.env[t])return process.env[t];if(process.env[t.toLowerCase()])return process.env[t.toLowerCase()]}s(xK,"getEnvironmentValue");function v6t(){if(!process)return;let t=xK(h6t),e=xK(A6t),r=xK(g6t);return t||e||r}s(v6t,"loadEnvironmentProxyValue");function x6t(t,e,r){if(e.length===0)return!1;let n=new URL(t).hostname;if(r?.has(n))return r.get(n);let i=!1;for(let o of e)o[0]==="."?(n.endsWith(o)||n.length===o.length-1&&n===o.slice(1))&&(i=!0):n===o&&(i=!0);return r?.set(n,i),i}s(x6t,"isBypassed");function E6t(){let t=xK(y6t);return BHe=!0,t?t.split(",").map(e=>e.trim()).filter(e=>e.length):[]}s(E6t,"loadNoProxy");function b6t(){let t=v6t();return t?new URL(t):void 0}s(b6t,"getDefaultProxySettingsInternal");function RHe(t){let e;try{e=new URL(t.host)}catch{throw new Error(`Expecting a valid host string in proxy settings, but found "${t.host}".`)}return e.port=String(t.port),t.username&&(e.username=t.username),t.password&&(e.password=t.password),e}s(RHe,"getUrlFromProxySettings");function kHe(t,e,r){if(t.agent)return;let i=new URL(t.url).protocol!=="https:";t.tlsSettings&&oh.warning("TLS settings are not supported in combination with custom Proxy, certificates provided to the client will be ignored.");let o=t.headers.toJSON();i?(e.httpProxyAgent||(e.httpProxyAgent=new DHe.HttpProxyAgent(r,{headers:o})),t.agent=e.httpProxyAgent):(e.httpsProxyAgent||(e.httpsProxyAgent=new PHe.HttpsProxyAgent(r,{headers:o})),t.agent=e.httpsProxyAgent)}s(kHe,"setProxyAgentOnRequest");function EK(t,e){BHe||_He.push(...E6t());let r=t?RHe(t):b6t(),n={};return{name:UAe,async sendRequest(i,o){var a;return!i.proxySettings&&r&&!x6t(i.url,(a=e?.customNoProxyList)!==null&&a!==void 0?a:_He,e?.customNoProxyList?void 0:C6t)?kHe(i,n,r):i.proxySettings&&kHe(i,n,RHe(i.proxySettings)),o(i)}}}s(EK,"proxyPolicy");d();var qAe="agentPolicy";function bK(t){return{name:qAe,sendRequest:s(async(e,r)=>(e.agent||(e.agent=t),r(e)),"sendRequest")}}s(bK,"agentPolicy");d();var HAe="tlsPolicy";function IK(t){return{name:HAe,sendRequest:s(async(e,r)=>(e.tlsSettings||(e.tlsSettings=t),r(e)),"sendRequest")}}s(IK,"tlsPolicy");d();d();function TK(t){return typeof t.stream=="function"}s(TK,"isBlob");d();d();function NHe(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:s(function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}},"next")};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}s(NHe,"__values");function DC(t){return this instanceof DC?(this.v=t,this):new DC(t)}s(DC,"__await");function $Ae(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(t,e||[]),i,o=[];return i=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),c("next"),c("throw"),c("return",a),i[Symbol.asyncIterator]=function(){return this},i;function a(h){return function(g){return Promise.resolve(g).then(h,p)}}function c(h,g){n[h]&&(i[h]=function(A){return new Promise(function(y,E){o.push([h,A,y,E])>1||l(h,A)})},g&&(i[h]=g(i[h])))}function l(h,g){try{u(n[h](g))}catch(A){m(o[0][3],A)}}function u(h){h.value instanceof DC?Promise.resolve(h.value.v).then(f,p):m(o[0][2],h)}function f(h){l("next",h)}function p(h){l("throw",h)}function m(h,g){h(g),o.shift(),o.length&&l(o[0][0],o[0][1])}}s($Ae,"__asyncGenerator");function MHe(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof NHe=="function"?NHe(t):t[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(o){r[o]=t[o]&&function(a){return new Promise(function(c,l){a=t[o](a),i(c,l,a.done,a.value)})}}function i(o,a,c,l){Promise.resolve(l).then(function(u){o({value:u,done:c})},a)}}s(MHe,"__asyncValues");var wK=require("stream");function LHe(){return $Ae(this,arguments,s(function*(){let e=this.getReader();try{for(;;){let{done:r,value:n}=yield DC(e.read());if(r)return yield DC(void 0);yield yield DC(n)}}finally{e.releaseLock()}},"streamAsyncIterator_1"))}s(LHe,"streamAsyncIterator");function I6t(t){t[Symbol.asyncIterator]||(t[Symbol.asyncIterator]=LHe.bind(t)),t.values||(t.values=LHe.bind(t))}s(I6t,"makeAsyncIterable");function FHe(t){return t instanceof ReadableStream?(I6t(t),wK.Readable.fromWeb(t)):t}s(FHe,"ensureNodeStream");function T6t(t){return t instanceof Uint8Array?wK.Readable.from(Buffer.from(t)):TK(t)?FHe(t.stream()):FHe(t)}s(T6t,"toStream");async function OHe(t){return function(){let e=t.map(r=>typeof r=="function"?r():r).map(T6t);return wK.Readable.from(function(){return $Ae(this,arguments,function*(){var r,n,i,o;for(let u of e)try{for(var a=!0,c=(n=void 0,MHe(u)),l;l=yield DC(c.next()),r=l.done,!r;a=!0)o=l.value,a=!1,yield yield DC(o)}catch(f){n={error:f}}finally{try{!a&&!r&&(i=c.return)&&(yield DC(i.call(c)))}finally{if(n)throw n.error}}})}())}}s(OHe,"concat");function w6t(){return`----AzSDKFormBoundary${AB()}`}s(w6t,"generateBoundary");function S6t(t){let e="";for(let[r,n]of t)e+=`${r}: ${n}\r
`;return e}s(S6t,"encodeHeaders");function _6t(t){return t instanceof Uint8Array?t.byteLength:TK(t)?t.size===-1?void 0:t.size:void 0}s(_6t,"getLength");function R6t(t){let e=0;for(let r of t){let n=_6t(r);if(n===void 0)return;e+=n}return e}s(R6t,"getTotalLength");async function k6t(t,e,r){let n=[vp(`--${r}`,"utf-8"),...e.flatMap(o=>[vp(`\r
`,"utf-8"),vp(S6t(o.headers),"utf-8"),vp(`\r
`,"utf-8"),o.body,vp(`\r
--${r}`,"utf-8")]),vp(`--\r
\r
`,"utf-8")],i=R6t(n);i&&t.headers.set("Content-Length",i),t.body=await OHe(n)}s(k6t,"buildRequestBody");var X6="multipartPolicy",P6t=70,D6t=new Set("abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789'()+,-./:=?");function B6t(t){if(t.length>P6t)throw new Error(`Multipart boundary "${t}" exceeds maximum length of 70 characters`);if(Array.from(t).some(e=>!D6t.has(e)))throw new Error(`Multipart boundary "${t}" contains invalid characters`)}s(B6t,"assertValidBoundary");function SK(){return{name:X6,async sendRequest(t,e){var r;if(!t.multipartBody)return e(t);if(t.body)throw new Error("multipartBody and regular body cannot be set at the same time");let n=t.multipartBody.boundary,i=(r=t.headers.get("Content-Type"))!==null&&r!==void 0?r:"multipart/mixed",o=i.match(/^(multipart\/[^ ;]+)(?:; *boundary=(.+))?$/);if(!o)throw new Error(`Got multipart request body, but content-type header was not multipart: ${i}`);let[,a,c]=o;if(c&&n&&c!==n)throw new Error(`Multipart boundary was specified as ${c} in the header, but got ${n} in the request body`);return n??(n=c),n?B6t(n):n=w6t(),t.headers.set("Content-Type",`${a}; boundary=${n}`),await k6t(t,t.multipartBody.parts,n),t.multipartBody=void 0,e(t)}}}s(SK,"multipartPolicy");d();d();d();d();d();d();d();d();d();d();d();d();function _K(){return iK()}s(_K,"createEmptyPipeline");d();d();d();var BC=UI("core-rest-pipeline");d();d();d();d();function jAe(t={}){return lK(Object.assign({logger:BC.info},t))}s(jAe,"logPolicy");d();function GAe(t={}){return uK(t)}s(GAe,"redirectPolicy");d();d();d();var TB=Be(require("node:os"),1),RK=Be(require("node:process"),1);function QHe(){return"User-Agent"}s(QHe,"getHeaderName");async function UHe(t){if(RK&&RK.versions){let e=RK.versions;e.bun?t.set("Bun",e.bun):e.deno?t.set("Deno",e.deno):e.node&&t.set("Node",e.node)}t.set("OS",`(${TB.arch()}-${TB.type()}-${TB.release()})`)}s(UHe,"setPlatformSpecificData");d();var kK="1.22.0";function H6t(t){let e=[];for(let[r,n]of t){let i=n?`${r}/${n}`:r;e.push(i)}return e.join(" ")}s(H6t,"getUserAgentString");function qHe(){return QHe()}s(qHe,"getUserAgentHeaderName");async function PK(t){let e=new Map;e.set("core-rest-pipeline",kK),await UHe(e);let r=H6t(e);return t?`${t} ${r}`:r}s(PK,"getUserAgentValue");var HHe=qHe(),$He="userAgentPolicy";function VAe(t={}){let e=PK(t.userAgentPrefix);return{name:$He,async sendRequest(r,n){return r.headers.has(HHe)||r.headers.set(HHe,await e),n(r)}}}s(VAe,"userAgentPolicy");d();d();var WHe=Symbol("rawContent");function zAe(t){return typeof t[WHe]=="function"}s(zAe,"hasRawContent");function jHe(t){return zAe(t)?t[WHe]():t}s(jHe,"getRawContent");var DK=X6;function KAe(){let t=SK();return{name:DK,sendRequest:s(async(e,r)=>{if(e.multipartBody)for(let n of e.multipartBody.parts)zAe(n.body)&&(n.body=jHe(n.body));return t.sendRequest(e,r)},"sendRequest")}}s(KAe,"multipartPolicy");d();function YAe(){return dK()}s(YAe,"decompressResponsePolicy");d();function JAe(t={}){return pK(t)}s(JAe,"defaultRetryPolicy");d();function XAe(){return mK()}s(XAe,"formDataPolicy");d();function ZAe(t,e){return EK(t,e)}s(ZAe,"proxyPolicy");d();var GHe="setClientRequestIdPolicy";function eye(t="x-ms-client-request-id"){return{name:GHe,async sendRequest(e,r){return e.headers.has(t)||e.headers.set(t,e.requestId),r(e)}}}s(eye,"setClientRequestIdPolicy");d();function tye(t){return bK(t)}s(tye,"agentPolicy");d();function rye(t){return IK(t)}s(rye,"tlsPolicy");d();d();var wB=Ju;function Z6(t){return oK(t)}s(Z6,"isRestError");var VHe="tracingPolicy";function nye(t={}){let e=PK(t.userAgentPrefix),r=new yA({additionalAllowedQueryParameters:t.additionalAllowedQueryParameters}),n=$6t();return{name:VHe,async sendRequest(i,o){var a;if(!n)return o(i);let c=await e,l={"http.url":r.sanitizeUrl(i.url),"http.method":i.method,"http.user_agent":c,requestId:i.requestId};c&&(l["http.user_agent"]=c);let{span:u,tracingContext:f}=(a=W6t(n,i,l))!==null&&a!==void 0?a:{};if(!u||!f)return o(i);try{let p=await n.withContext(f,o,i);return G6t(u,p),p}catch(p){throw j6t(u,p),p}}}}s(nye,"tracingPolicy");function $6t(){try{return E9({namespace:"",packageName:"@azure/core-rest-pipeline",packageVersion:kK})}catch(t){BC.warning(`Error when creating the TracingClient: ${yB(t)}`);return}}s($6t,"tryCreateTracingClient");function W6t(t,e,r){try{let{span:n,updatedOptions:i}=t.startSpan(`HTTP ${e.method}`,{tracingOptions:e.tracingOptions},{spanKind:"client",spanAttributes:r});if(!n.isRecording()){n.end();return}let o=t.createRequestHeaders(i.tracingOptions.tracingContext);for(let[a,c]of Object.entries(o))e.headers.set(a,c);return{span:n,tracingContext:i.tracingOptions.tracingContext}}catch(n){BC.warning(`Skipping creating a tracing span due to an error: ${yB(n)}`);return}}s(W6t,"tryCreateSpan");function j6t(t,e){try{t.setStatus({status:"error",error:Yz(e)?e:void 0}),Z6(e)&&e.statusCode&&t.setAttribute("http.status_code",e.statusCode),t.end()}catch(r){BC.warning(`Skipping tracing span processing due to an error: ${yB(r)}`)}}s(j6t,"tryProcessError");function G6t(t,e){try{t.setAttribute("http.status_code",e.status);let r=e.headers.get("x-ms-request-id");r&&t.setAttribute("serviceRequestId",r),e.status>=400&&t.setStatus({status:"error"}),t.end()}catch(r){BC.warning(`Skipping tracing span processing due to an error: ${yB(r)}`)}}s(G6t,"tryProcessResponse");d();d();function BK(t){if(t instanceof AbortSignal)return{abortSignal:t};if(t.aborted)return{abortSignal:AbortSignal.abort(t.reason)};let e=new AbortController,r=!0;function n(){r&&(t.removeEventListener("abort",i),r=!1)}s(n,"cleanup");function i(){e.abort(t.reason),n()}return s(i,"listener"),t.addEventListener("abort",i),{abortSignal:e.signal,cleanup:n}}s(BK,"wrapAbortSignalLike");var V6t="wrapAbortSignalLikePolicy";function zHe(){return{name:V6t,sendRequest:s(async(t,e)=>{if(!t.abortSignal)return e(t);let{abortSignal:r,cleanup:n}=BK(t.abortSignal);t.abortSignal=r;try{return await e(t)}finally{n?.()}},"sendRequest")}}s(zHe,"wrapAbortSignalLikePolicy");function iye(t){var e;let r=_K();return CB&&(t.agent&&r.addPolicy(tye(t.agent)),t.tlsOptions&&r.addPolicy(rye(t.tlsOptions)),r.addPolicy(ZAe(t.proxyOptions)),r.addPolicy(YAe())),r.addPolicy(zHe()),r.addPolicy(XAe(),{beforePolicies:[DK]}),r.addPolicy(VAe(t.userAgentOptions)),r.addPolicy(eye((e=t.telemetryOptions)===null||e===void 0?void 0:e.clientRequestIdHeaderName)),r.addPolicy(KAe(),{afterPhase:"Deserialize"}),r.addPolicy(JAe(t.retryOptions),{phase:"Retry"}),r.addPolicy(nye(Object.assign(Object.assign({},t.userAgentOptions),t.loggingOptions)),{afterPhase:"Retry"}),CB&&r.addPolicy(GAe(t.redirectOptions),{afterPhase:"Retry"}),r.addPolicy(jAe(t.loggingOptions),{afterPhase:"Sign"}),r}s(iye,"createPipelineFromOptions");d();function oye(){let t=cK();return{async sendRequest(e){let{abortSignal:r,cleanup:n}=e.abortSignal?BK(e.abortSignal):{};try{return e.abortSignal=r,await t.sendRequest(e)}finally{n?.()}}}}s(oye,"createDefaultHttpClient");d();function fT(t){return M0(t)}s(fT,"createHttpHeaders");d();function CA(t){return nK(t)}s(CA,"createPipelineRequest");d();d();d();d();var K6t=UI("core-rest-pipeline retryPolicy");function sye(t,e={maxRetries:3}){return uT(t,Object.assign({logger:K6t},e))}s(sye,"retryPolicy");d();d();var Y6t={forcedRefreshWindowInMs:1e3,retryIntervalInMs:3e3,refreshWindowInMs:1e3*60*2};async function J6t(t,e,r){async function n(){if(Date.now()<r)try{return await t()}catch{return null}else{let o=await t();if(o===null)throw new Error("Failed to refresh access token.");return o}}s(n,"tryGetAccessToken");let i=await n();for(;i===null;)await fAe(e),i=await n();return i}s(J6t,"beginRefresh");function aye(t,e){let r=null,n=null,i,o=Object.assign(Object.assign({},Y6t),e),a={get isRefreshing(){return r!==null},get shouldRefresh(){var l;return a.isRefreshing?!1:n?.refreshAfterTimestamp&&n.refreshAfterTimestamp<Date.now()?!0:((l=n?.expiresOnTimestamp)!==null&&l!==void 0?l:0)-o.refreshWindowInMs<Date.now()},get mustRefresh(){return n===null||n.expiresOnTimestamp-o.forcedRefreshWindowInMs<Date.now()}};function c(l,u){var f;return a.isRefreshing||(r=J6t(s(()=>t.getToken(l,u),"tryGetAccessToken"),o.retryIntervalInMs,(f=n?.expiresOnTimestamp)!==null&&f!==void 0?f:Date.now()).then(m=>(r=null,n=m,i=u.tenantId,n)).catch(m=>{throw r=null,n=null,i=void 0,m})),r}return s(c,"refresh"),async(l,u)=>{let f=!!u.claims,p=i!==u.tenantId;return f&&(n=null),p||f||a.mustRefresh?c(l,u):(a.shouldRefresh&&c(l,u),n)}}s(aye,"createTokenCycler");var XHe="bearerTokenAuthenticationPolicy";async function NK(t,e){try{return[await e(t),void 0]}catch(r){if(Z6(r)&&r.response)return[r.response,r];throw r}}s(NK,"trySendRequest");async function X6t(t){let{scopes:e,getAccessToken:r,request:n}=t,i={abortSignal:n.abortSignal,tracingOptions:n.tracingOptions,enableCae:!0},o=await r(e,i);o&&t.request.headers.set("Authorization",`Bearer ${o.token}`)}s(X6t,"defaultAuthorizeRequest");function KHe(t){return t.status===401&&t.headers.has("WWW-Authenticate")}s(KHe,"isChallengeResponse");async function YHe(t,e){var r;let{scopes:n}=t,i=await t.getAccessToken(n,{enableCae:!0,claims:e});return i?(t.request.headers.set("Authorization",`${(r=i.tokenType)!==null&&r!==void 0?r:"Bearer"} ${i.token}`),!0):!1}s(YHe,"authorizeRequestOnCaeChallenge");function MK(t){var e,r,n;let{credential:i,scopes:o,challengeCallbacks:a}=t,c=t.logger||BC,l={authorizeRequest:(r=(e=a?.authorizeRequest)===null||e===void 0?void 0:e.bind(a))!==null&&r!==void 0?r:X6t,authorizeRequestOnChallenge:(n=a?.authorizeRequestOnChallenge)===null||n===void 0?void 0:n.bind(a)},u=i?aye(i):()=>Promise.resolve(null);return{name:XHe,async sendRequest(f,p){if(!f.url.toLowerCase().startsWith("https://"))throw new Error("Bearer token authentication is not permitted for non-TLS protected (non-https) URLs.");await l.authorizeRequest({scopes:Array.isArray(o)?o:[o],request:f,getAccessToken:u,logger:c});let m,h,g;if([m,h]=await NK(f,p),KHe(m)){let A=JHe(m.headers.get("WWW-Authenticate"));if(A){let y;try{y=atob(A)}catch{return c.warning(`The WWW-Authenticate header contains "claims" that cannot be parsed. Unable to perform the Continuous Access Evaluation authentication flow. Unparsable claims: ${A}`),m}g=await YHe({scopes:Array.isArray(o)?o:[o],response:m,request:f,getAccessToken:u,logger:c},y),g&&([m,h]=await NK(f,p))}else if(l.authorizeRequestOnChallenge&&(g=await l.authorizeRequestOnChallenge({scopes:Array.isArray(o)?o:[o],request:f,response:m,getAccessToken:u,logger:c}),g&&([m,h]=await NK(f,p)),KHe(m)&&(A=JHe(m.headers.get("WWW-Authenticate")),A))){let y;try{y=atob(A)}catch{return c.warning(`The WWW-Authenticate header contains "claims" that cannot be parsed. Unable to perform the Continuous Access Evaluation authentication flow. Unparsable claims: ${A}`),m}g=await YHe({scopes:Array.isArray(o)?o:[o],response:m,request:f,getAccessToken:u,logger:c},y),g&&([m,h]=await NK(f,p))}}if(h)throw h;return m}}}s(MK,"bearerTokenAuthenticationPolicy");function Z6t(t){let e=/(\w+)\s+((?:\w+=(?:"[^"]*"|[^,]*),?\s*)+)/g,r=/(\w+)="([^"]*)"/g,n=[],i;for(;(i=e.exec(t))!==null;){let o=i[1],a=i[2],c={},l;for(;(l=r.exec(a))!==null;)c[l[1]]=l[2];n.push({scheme:o,params:c})}return n}s(Z6t,"parseChallenges");function JHe(t){var e;return t?(e=Z6t(t).find(n=>n.scheme==="Bearer"&&n.params.claims&&n.params.error==="insufficient_claims"))===null||e===void 0?void 0:e.params.claims:void 0}s(JHe,"getCaeChallengeClaims");d();d();d();d();d();d();var e$e=Be(ZHe(),1),cye=e$e.state;function pT(t,e,r){let n=e.parameterPath,i=e.mapper,o;if(typeof n=="string"&&(n=[n]),Array.isArray(n)){if(n.length>0)if(i.isConstant)o=i.defaultValue;else{let a=t$e(t,n);!a.propertyFound&&r&&(a=t$e(r,n));let c=!1;a.propertyFound||(c=i.required||n[0]==="options"&&n.length===2),o=c?i.defaultValue:a.propertyValue}}else{i.required&&(o={});for(let a in n){let c=i.type.modelProperties[a],l=n[a],u=pT(t,{parameterPath:l,mapper:c},r);u!==void 0&&(o||(o={}),o[a]=u)}}return o}s(pT,"getOperationArgumentValueFromParameter");function t$e(t,e){let r={propertyFound:!1},n=0;for(;n<e.length;++n){let i=e[n];if(t&&i in t)t=t[i];else break}return n===e.length&&(r.propertyValue=t,r.propertyFound=!0),r}s(t$e,"getPropertyFromParameterPath");var r$e=Symbol.for("@azure/core-client original request");function eOt(t){return r$e in t}s(eOt,"hasOriginalRequest");function ux(t){if(eOt(t))return ux(t[r$e]);let e=cye.operationRequestMap.get(t);return e||(e={},cye.operationRequestMap.set(t,e)),e}s(ux,"getOperationRequestInfo");var tOt=["application/json","text/json"],rOt=["application/xml","application/atom+xml"],n$e="deserializationPolicy";function lye(t={}){var e,r,n,i,o,a,c;let l=(r=(e=t.expectedContentTypes)===null||e===void 0?void 0:e.json)!==null&&r!==void 0?r:tOt,u=(i=(n=t.expectedContentTypes)===null||n===void 0?void 0:n.xml)!==null&&i!==void 0?i:rOt,f=t.parseXML,p=t.serializerOptions,m={xml:{rootName:(o=p?.xml.rootName)!==null&&o!==void 0?o:"",includeRoot:(a=p?.xml.includeRoot)!==null&&a!==void 0?a:!1,xmlCharKey:(c=p?.xml.xmlCharKey)!==null&&c!==void 0?c:"_"}};return{name:n$e,async sendRequest(h,g){let A=await g(h);return oOt(l,u,A,m,f)}}}s(lye,"deserializationPolicy");function nOt(t){let e,r=t.request,n=ux(r),i=n?.operationSpec;return i&&(n?.operationResponseGetter?e=n?.operationResponseGetter(i,t):e=i.responses[t.status]),e}s(nOt,"getOperationResponseMap");function iOt(t){let e=t.request,r=ux(e),n=r?.shouldDeserialize,i;return n===void 0?i=!0:typeof n=="boolean"?i=n:i=n(t),i}s(iOt,"shouldDeserializeResponse");async function oOt(t,e,r,n,i){let o=await cOt(t,e,r,n,i);if(!iOt(o))return o;let a=ux(o.request),c=a?.operationSpec;if(!c||!c.responses)return o;let l=nOt(o),{error:u,shouldReturnResponse:f}=aOt(o,c,l,n);if(u)throw u;if(f)return o;if(l){if(l.bodyMapper){let p=o.parsedBody;c.isXML&&l.bodyMapper.type.name===_C.Sequence&&(p=typeof p=="object"?p[l.bodyMapper.xmlElementName]:[]);try{o.parsedBody=c.serializer.deserialize(l.bodyMapper,p,"operationRes.parsedBody",n)}catch(m){throw new wB(`Error ${m} occurred in deserializing the responseBody - ${o.bodyAsText}`,{statusCode:o.status,request:o.request,response:o})}}else c.httpMethod==="HEAD"&&(o.parsedBody=r.status>=200&&r.status<300);l.headersMapper&&(o.parsedHeaders=c.serializer.deserialize(l.headersMapper,o.headers.toJSON(),"operationRes.parsedHeaders",{xml:{},ignoreUnknownProperties:!0}))}return o}s(oOt,"deserializeResponseBody");function sOt(t){let e=Object.keys(t.responses);return e.length===0||e.length===1&&e[0]==="default"}s(sOt,"isOperationSpecEmpty");function aOt(t,e,r,n){var i;let o=200<=t.status&&t.status<300;if(sOt(e)?o:!!r)if(r){if(!r.isError)return{error:null,shouldReturnResponse:!1}}else return{error:null,shouldReturnResponse:!1};let c=r??e.responses.default,l=!((i=t.request.streamResponseStatusCodes)===null||i===void 0)&&i.has(t.status)?`Unexpected status code: ${t.status}`:t.bodyAsText,u=new wB(l,{statusCode:t.status,request:t.request,response:t});if(!c)throw u;let f=c.bodyMapper,p=c.headersMapper;try{if(t.parsedBody){let m=t.parsedBody,h;if(f){let A=m;if(e.isXML&&f.type.name===_C.Sequence){A=[];let y=f.xmlElementName;typeof m=="object"&&y&&(A=m[y])}h=e.serializer.deserialize(f,A,"error.response.parsedBody",n)}let g=m.error||h||m;u.code=g.code,g.message&&(u.message=g.message),f&&(u.response.parsedBody=h)}t.headers&&p&&(u.response.parsedHeaders=e.serializer.deserialize(p,t.headers.toJSON(),"operationRes.parsedHeaders"))}catch(m){u.message=`Error "${m.message}" occurred in deserializing the responseBody - "${t.bodyAsText}" for the default response.`}return{error:u,shouldReturnResponse:!1}}s(aOt,"handleErrorResponse");async function cOt(t,e,r,n,i){var o;if(!(!((o=r.request.streamResponseStatusCodes)===null||o===void 0)&&o.has(r.status))&&r.bodyAsText){let a=r.bodyAsText,c=r.headers.get("Content-Type")||"",l=c?c.split(";").map(u=>u.toLowerCase()):[];try{if(l.length===0||l.some(u=>t.indexOf(u)!==-1))return r.parsedBody=JSON.parse(a),r;if(l.some(u=>e.indexOf(u)!==-1)){if(!i)throw new Error("Parsing XML not supported.");let u=await i(a,n.xml);return r.parsedBody=u,r}}catch(u){let f=`Error "${u}" occurred while parsing the response body - ${r.bodyAsText}.`,p=u.code||wB.PARSE_ERROR;throw new wB(f,{code:p,statusCode:r.status,request:r.request,response:r})}}return r}s(cOt,"parse");d();d();function i$e(t){let e=new Set;for(let r in t.responses){let n=t.responses[r];n.bodyMapper&&n.bodyMapper.type.name===_C.Stream&&e.add(Number(r))}return e}s(i$e,"getStreamingResponseStatusCodes");function NC(t){let{parameterPath:e,mapper:r}=t,n;return typeof e=="string"?n=e:Array.isArray(e)?n=e.join("."):n=r.serializedName,n}s(NC,"getPathStringFromParameter");var o$e="serializationPolicy";function uye(t={}){let e=t.stringifyXML;return{name:o$e,async sendRequest(r,n){let i=ux(r),o=i?.operationSpec,a=i?.operationArguments;return o&&a&&(lOt(r,a,o),uOt(r,a,o,e)),n(r)}}}s(uye,"serializationPolicy");function lOt(t,e,r){var n,i;if(r.headerParameters)for(let a of r.headerParameters){let c=pT(e,a);if(c!=null||a.mapper.required){c=r.serializer.serialize(a.mapper,c,NC(a));let l=a.mapper.headerCollectionPrefix;if(l)for(let u of Object.keys(c))t.headers.set(l+u,c[u]);else t.headers.set(a.mapper.serializedName||NC(a),c)}}let o=(i=(n=e.options)===null||n===void 0?void 0:n.requestOptions)===null||i===void 0?void 0:i.customHeaders;if(o)for(let a of Object.keys(o))t.headers.set(a,o[a])}s(lOt,"serializeHeaders");function uOt(t,e,r,n=function(){throw new Error("XML serialization unsupported!")}){var i,o,a,c,l;let u=(i=e.options)===null||i===void 0?void 0:i.serializerOptions,f={xml:{rootName:(o=u?.xml.rootName)!==null&&o!==void 0?o:"",includeRoot:(a=u?.xml.includeRoot)!==null&&a!==void 0?a:!1,xmlCharKey:(c=u?.xml.xmlCharKey)!==null&&c!==void 0?c:"_"}},p=f.xml.xmlCharKey;if(r.requestBody&&r.requestBody.mapper){t.body=pT(e,r.requestBody);let m=r.requestBody.mapper,{required:h,serializedName:g,xmlName:A,xmlElementName:y,xmlNamespace:E,xmlNamespacePrefix:b,nullable:S}=m,R=m.type.name;try{if(t.body!==void 0&&t.body!==null||S&&t.body===null||h){let B=NC(r.requestBody);t.body=r.serializer.serialize(m,t.body,B,f);let L=R===_C.Stream;if(r.isXML){let O=b?`xmlns:${b}`:"xmlns",Y=dOt(E,O,R,t.body,f);R===_C.Sequence?t.body=n(fOt(Y,y||A||g,O,E),{rootName:A||g,xmlCharKey:p}):L||(t.body=n(Y,{rootName:A||g,xmlCharKey:p}))}else{if(R===_C.String&&(!((l=r.contentType)===null||l===void 0)&&l.match("text/plain")||r.mediaType==="text"))return;L||(t.body=JSON.stringify(t.body))}}}catch(B){throw new Error(`Error "${B.message}" occurred in serializing the payload - ${JSON.stringify(g,void 0,"  ")}.`)}}else if(r.formDataParameters&&r.formDataParameters.length>0){t.formData={};for(let m of r.formDataParameters){let h=pT(e,m);if(h!=null){let g=m.mapper.serializedName||NC(m);t.formData[g]=r.serializer.serialize(m.mapper,h,NC(m),f)}}}}s(uOt,"serializeRequestBody");function dOt(t,e,r,n,i){if(t&&!["Composite","Sequence","Dictionary"].includes(r)){let o={};return o[i.xml.xmlCharKey]=n,o["$"]={[e]:t},o}return n}s(dOt,"getXmlValueWithNamespace");function fOt(t,e,r,n){if(Array.isArray(t)||(t=[t]),!r||!n)return{[e]:t};let i={[e]:t};return i["$"]={[r]:n},i}s(fOt,"prepareXMLRootList");function dye(t={}){let e=iye(t??{});return t.credentialOptions&&e.addPolicy(MK({credential:t.credentialOptions.credential,scopes:t.credentialOptions.credentialScopes})),e.addPolicy(uye(t.serializationOptions),{phase:"Serialize"}),e.addPolicy(lye(t.deserializationOptions),{phase:"Deserialize"}),e}s(dye,"createClientPipeline");d();var fye;function s$e(){return fye||(fye=oye()),fye}s(s$e,"getCachedDefaultHttpClient");d();var pOt={CSV:",",SSV:" ",Multi:"Multi",TSV:"	",Pipes:"|"};function c$e(t,e,r,n){let i=mOt(e,r,n),o=!1,a=a$e(t,i);if(e.path){let u=a$e(e.path,i);e.path==="/{nextLink}"&&u.startsWith("/")&&(u=u.substring(1)),hOt(u)?(a=u,o=!0):a=gOt(a,u)}let{queryParams:c,sequenceParams:l}=AOt(e,r,n);return a=COt(a,c,l,o),a}s(c$e,"getRequestUrl");function a$e(t,e){let r=t;for(let[n,i]of e)r=r.split(n).join(i);return r}s(a$e,"replaceAll");function mOt(t,e,r){var n;let i=new Map;if(!((n=t.urlParameters)===null||n===void 0)&&n.length)for(let o of t.urlParameters){let a=pT(e,o,r),c=NC(o);a=t.serializer.serialize(o.mapper,a,c),o.skipEncoding||(a=encodeURIComponent(a)),i.set(`{${o.mapper.serializedName||c}}`,a)}return i}s(mOt,"calculateUrlReplacements");function hOt(t){return t.includes("://")}s(hOt,"isAbsoluteUrl");function gOt(t,e){if(!e)return t;let r=new URL(t),n=r.pathname;n.endsWith("/")||(n=`${n}/`),e.startsWith("/")&&(e=e.substring(1));let i=e.indexOf("?");if(i!==-1){let o=e.substring(0,i),a=e.substring(i+1);n=n+o,a&&(r.search=r.search?`${r.search}&${a}`:a)}else n=n+e;return r.pathname=n,r.toString()}s(gOt,"appendPath");function AOt(t,e,r){var n;let i=new Map,o=new Set;if(!((n=t.queryParameters)===null||n===void 0)&&n.length)for(let a of t.queryParameters){a.mapper.type.name==="Sequence"&&a.mapper.serializedName&&o.add(a.mapper.serializedName);let c=pT(e,a,r);if(c!=null||a.mapper.required){c=t.serializer.serialize(a.mapper,c,NC(a));let l=a.collectionFormat?pOt[a.collectionFormat]:"";if(Array.isArray(c)&&(c=c.map(u=>u??"")),a.collectionFormat==="Multi"&&c.length===0)continue;Array.isArray(c)&&(a.collectionFormat==="SSV"||a.collectionFormat==="TSV")&&(c=c.join(l)),a.skipEncoding||(Array.isArray(c)?c=c.map(u=>encodeURIComponent(u)):c=encodeURIComponent(c)),Array.isArray(c)&&(a.collectionFormat==="CSV"||a.collectionFormat==="Pipes")&&(c=c.join(l)),i.set(a.mapper.serializedName||NC(a),c)}}return{queryParams:i,sequenceParams:o}}s(AOt,"calculateQueryParameters");function yOt(t){let e=new Map;if(!t||t[0]!=="?")return e;t=t.slice(1);let r=t.split("&");for(let n of r){let[i,o]=n.split("=",2),a=e.get(i);a?Array.isArray(a)?a.push(o):e.set(i,[a,o]):e.set(i,o)}return e}s(yOt,"simpleParseQueryParams");function COt(t,e,r,n=!1){if(e.size===0)return t;let i=new URL(t),o=yOt(i.search);for(let[c,l]of e){let u=o.get(c);if(Array.isArray(u))if(Array.isArray(l)){u.push(...l);let f=new Set(u);o.set(c,Array.from(f))}else u.push(l);else u?(Array.isArray(l)?l.unshift(u):r.has(c)&&o.set(c,[u,l]),n||o.set(c,l)):o.set(c,l)}let a=[];for(let[c,l]of o)if(typeof l=="string")a.push(`${c}=${l}`);else if(Array.isArray(l))for(let u of l)a.push(`${c}=${u}`);else a.push(`${c}=${l}`);return i.search=a.length?`?${a.join("&")}`:"",i.toString()}s(COt,"appendQueryParams");d();var pye=UI("core-client");var eO=class{static{s(this,"ServiceClient")}constructor(e={}){var r,n;if(this._requestContentType=e.requestContentType,this._endpoint=(r=e.endpoint)!==null&&r!==void 0?r:e.baseUri,e.baseUri&&pye.warning("The baseUri option for SDK Clients has been deprecated, please use endpoint instead."),this._allowInsecureConnection=e.allowInsecureConnection,this._httpClient=e.httpClient||s$e(),this.pipeline=e.pipeline||vOt(e),!((n=e.additionalPolicies)===null||n===void 0)&&n.length)for(let{policy:i,position:o}of e.additionalPolicies){let a=o==="perRetry"?"Sign":void 0;this.pipeline.addPolicy(i,{afterPhase:a})}}async sendRequest(e){return this.pipeline.sendRequest(this._httpClient,e)}async sendOperationRequest(e,r){let n=r.baseUrl||this._endpoint;if(!n)throw new Error("If operationSpec.baseUrl is not specified, then the ServiceClient must have a endpoint string property that contains the base URL to use.");let i=c$e(n,r,e,this),o=CA({url:i});o.method=r.httpMethod;let a=ux(o);a.operationSpec=r,a.operationArguments=e;let c=r.contentType||this._requestContentType;c&&r.requestBody&&o.headers.set("Content-Type",c);let l=e.options;if(l){let u=l.requestOptions;u&&(u.timeout&&(o.timeout=u.timeout),u.onUploadProgress&&(o.onUploadProgress=u.onUploadProgress),u.onDownloadProgress&&(o.onDownloadProgress=u.onDownloadProgress),u.shouldDeserialize!==void 0&&(a.shouldDeserialize=u.shouldDeserialize),u.allowInsecureConnection&&(o.allowInsecureConnection=!0)),l.abortSignal&&(o.abortSignal=l.abortSignal),l.tracingOptions&&(o.tracingOptions=l.tracingOptions)}this._allowInsecureConnection&&(o.allowInsecureConnection=!0),o.streamResponseStatusCodes===void 0&&(o.streamResponseStatusCodes=i$e(r));try{let u=await this.sendRequest(o),f=gAe(u,r.responses[u.status]);return l?.onResponse&&l.onResponse(u,f),f}catch(u){if(typeof u=="object"&&u?.response){let f=u.response,p=gAe(f,r.responses[u.statusCode]||r.responses.default);u.details=p,l?.onResponse&&l.onResponse(f,p,u)}throw u}}};function vOt(t){let e=xOt(t),r=t.credential&&e?{credentialScopes:e,credential:t.credential}:void 0;return dye(Object.assign(Object.assign({},t),{credentialOptions:r}))}s(vOt,"createDefaultPipeline");function xOt(t){if(t.credentialScopes)return t.credentialScopes;if(t.endpoint)return`${t.endpoint}/.default`;if(t.baseUri)return`${t.baseUri}/.default`;if(t.credential&&!t.credentialScopes)throw new Error("When using credentials, the ServiceClientOptions must contain either a endpoint or a credentialScopes. Unable to create a bearerTokenAuthenticationPolicy")}s(xOt,"getCredentialScopes");d();d();d();function l$e(t){return t==="adfs"?"oauth2/token":"oauth2/v2.0/token"}s(l$e,"getIdentityTokenEndpointSuffix");d();var u$e="/.default",d$e="Specifying a `clientId` or `resourceId` is not supported by the Service Fabric managed identity environment. The managed identity configuration is determined by the Service Fabric cluster resource configuration. See https://aka.ms/servicefabricmi for more information";function tO(t){let e="";if(Array.isArray(t)){if(t.length!==1)return;e=t[0]}else typeof t=="string"&&(e=t);return e.endsWith(u$e)?e.substr(0,e.lastIndexOf(u$e)):e}s(tO,"mapScopesToResource");function f$e(t){if(typeof t.expires_on=="number")return t.expires_on*1e3;if(typeof t.expires_on=="string"){let e=+t.expires_on;if(!isNaN(e))return e*1e3;let r=Date.parse(t.expires_on);if(!isNaN(r))return r}if(typeof t.expires_in=="number")return Date.now()+t.expires_in*1e3;throw new Error(`Failed to parse token expiration from body. expires_in="${t.expires_in}", expires_on="${t.expires_on}"`)}s(f$e,"parseExpirationTimestamp");function p$e(t){if(t.refresh_on){if(typeof t.refresh_on=="number")return t.refresh_on*1e3;if(typeof t.refresh_on=="string"){let e=+t.refresh_on;if(!isNaN(e))return e*1e3;let r=Date.parse(t.refresh_on);if(!isNaN(r))return r}throw new Error(`Failed to parse refresh_on from body. refresh_on="${t.refresh_on}"`)}else return}s(p$e,"parseRefreshTimestamp");var rO="noCorrelationId";function EOt(t){let e=t?.authorityHost;return Jz&&(e=e??process.env.AZURE_AUTHORITY_HOST),e??C9}s(EOt,"getIdentityClientAuthorityHost");var mT=class extends eO{static{s(this,"IdentityClient")}authorityHost;allowLoggingAccountIdentifiers;abortControllers;allowInsecureConnection=!1;tokenCredentialOptions;constructor(e){let r=`azsdk-js-identity/${uV}`,n=e?.userAgentOptions?.userAgentPrefix?`${e.userAgentOptions.userAgentPrefix} ${r}`:`${r}`,i=EOt(e);if(!i.startsWith("https:"))throw new Error("The authorityHost address must use the 'https' protocol.");super({requestContentType:"application/json; charset=utf-8",retryOptions:{maxRetries:3},...e,userAgentOptions:{userAgentPrefix:n},baseUri:i}),this.authorityHost=i,this.abortControllers=new Map,this.allowLoggingAccountIdentifiers=e?.loggingOptions?.allowLoggingAccountIdentifiers,this.tokenCredentialOptions={...e},e?.allowInsecureConnection&&(this.allowInsecureConnection=e.allowInsecureConnection)}async sendTokenRequest(e){_0.info(`IdentityClient: sending token request to [${e.url}]`);let r=await this.sendRequest(e);if(r.bodyAsText&&(r.status===200||r.status===201)){let n=JSON.parse(r.bodyAsText);if(!n.access_token)return null;this.logIdentifiers(r);let i={accessToken:{token:n.access_token,expiresOnTimestamp:f$e(n),refreshAfterTimestamp:p$e(n),tokenType:"Bearer"},refreshToken:n.refresh_token};return _0.info(`IdentityClient: [${e.url}] token acquired, expires on ${i.accessToken.expiresOnTimestamp}`),i}else{let n=new QI(r.status,r.bodyAsText);throw _0.warning(`IdentityClient: authentication error. HTTP status: ${r.status}, ${n.errorResponse.errorDescription}`),n}}async refreshAccessToken(e,r,n,i,o,a={}){if(i===void 0)return null;_0.info(`IdentityClient: refreshing access token with client ID: ${r}, scopes: ${n} started`);let c={grant_type:"refresh_token",client_id:r,refresh_token:i,scope:n};o!==void 0&&(c.client_secret=o);let l=new URLSearchParams(c);return rs.withSpan("IdentityClient.refreshAccessToken",a,async u=>{try{let f=l$e(e),p=CA({url:`${this.authorityHost}/${e}/${f}`,method:"POST",body:l.toString(),abortSignal:a.abortSignal,headers:fT({Accept:"application/json","Content-Type":"application/x-www-form-urlencoded"}),tracingOptions:u.tracingOptions}),m=await this.sendTokenRequest(p);return _0.info(`IdentityClient: refreshed token for client ID: ${r}`),m}catch(f){if(f.name===fV&&f.errorResponse.error==="interaction_required")return _0.info(`IdentityClient: interaction required for client ID: ${r}`),null;throw _0.warning(`IdentityClient: failed refreshing token for client ID: ${r}: ${f}`),f}})}generateAbortSignal(e){let r=new AbortController,n=this.abortControllers.get(e)||[];n.push(r),this.abortControllers.set(e,n);let i=r.signal.onabort;return r.signal.onabort=(...o)=>{this.abortControllers.set(e,void 0),i&&i.apply(r.signal,o)},r.signal}abortRequests(e){let r=e||rO,n=[...this.abortControllers.get(r)||[],...this.abortControllers.get(rO)||[]];if(n.length){for(let i of n)i.abort();this.abortControllers.set(r,void 0)}}getCorrelationId(e){let r=e?.body?.split("&").map(n=>n.split("=")).find(([n])=>n==="client-request-id");return r&&r.length&&r[1]||rO}async sendGetRequestAsync(e,r){let n=CA({url:e,method:"GET",body:r?.body,allowInsecureConnection:this.allowInsecureConnection,headers:fT(r?.headers),abortSignal:this.generateAbortSignal(rO)}),i=await this.sendRequest(n);return this.logIdentifiers(i),{body:i.bodyAsText?JSON.parse(i.bodyAsText):void 0,headers:i.headers.toJSON(),status:i.status}}async sendPostRequestAsync(e,r){let n=CA({url:e,method:"POST",body:r?.body,headers:fT(r?.headers),allowInsecureConnection:this.allowInsecureConnection,abortSignal:this.generateAbortSignal(this.getCorrelationId(r))}),i=await this.sendRequest(n);return this.logIdentifiers(i),{body:i.bodyAsText?JSON.parse(i.bodyAsText):void 0,headers:i.headers.toJSON(),status:i.status}}getTokenCredentialOptions(){return this.tokenCredentialOptions}logIdentifiers(e){if(!this.allowLoggingAccountIdentifiers||!e.bodyAsText)return;let r="No User Principal Name available";try{let i=(e.parsedBody||JSON.parse(e.bodyAsText)).access_token;if(!i)return;let o=i.split(".")[1],{appid:a,upn:c,tid:l,oid:u}=JSON.parse(Buffer.from(o,"base64").toString("utf8"));_0.info(`[Authenticated account] Client ID: ${a}. Tenant ID: ${l}. User Principal Name: ${c||r}. Object ID (user): ${u}`)}catch(n){_0.warning("allowLoggingAccountIdentifiers was set, but we couldn't log the account information. Error:",n.message)}}};d();var mye;(function(t){t.AutoDiscoverRegion="AutoDiscoverRegion",t.USWest="westus",t.USWest2="westus2",t.USCentral="centralus",t.USEast="eastus",t.USEast2="eastus2",t.USNorthCentral="northcentralus",t.USSouthCentral="southcentralus",t.USWestCentral="westcentralus",t.CanadaCentral="canadacentral",t.CanadaEast="canadaeast",t.BrazilSouth="brazilsouth",t.EuropeNorth="northeurope",t.EuropeWest="westeurope",t.UKSouth="uksouth",t.UKWest="ukwest",t.FranceCentral="francecentral",t.FranceSouth="francesouth",t.SwitzerlandNorth="switzerlandnorth",t.SwitzerlandWest="switzerlandwest",t.GermanyNorth="germanynorth",t.GermanyWestCentral="germanywestcentral",t.NorwayWest="norwaywest",t.NorwayEast="norwayeast",t.AsiaEast="eastasia",t.AsiaSouthEast="southeastasia",t.JapanEast="japaneast",t.JapanWest="japanwest",t.AustraliaEast="australiaeast",t.AustraliaSouthEast="australiasoutheast",t.AustraliaCentral="australiacentral",t.AustraliaCentral2="australiacentral2",t.IndiaCentral="centralindia",t.IndiaSouth="southindia",t.IndiaWest="westindia",t.KoreaSouth="koreasouth",t.KoreaCentral="koreacentral",t.UAECentral="uaecentral",t.UAENorth="uaenorth",t.SouthAfricaNorth="southafricanorth",t.SouthAfricaWest="southafricawest",t.ChinaNorth="chinanorth",t.ChinaEast="chinaeast",t.ChinaNorth2="chinanorth2",t.ChinaEast2="chinaeast2",t.GermanyCentral="germanycentral",t.GermanyNorthEast="germanynortheast",t.GovernmentUSVirginia="usgovvirginia",t.GovernmentUSIowa="usgoviowa",t.GovernmentUSArizona="usgovarizona",t.GovernmentUSTexas="usgovtexas",t.GovernmentUSDodEast="usdodeast",t.GovernmentUSDodCentral="usdodcentral"})(mye||(mye={}));function FK(t){let e=t;return e===void 0&&globalThis.process?.env?.AZURE_REGIONAL_AUTHORITY_NAME!==void 0&&(e=process.env.AZURE_REGIONAL_AUTHORITY_NAME),e===mye.AutoDiscoverRegion?"AUTO_DISCOVER":e}s(FK,"calculateRegionalAuthority");d();d();function bOt(t){return`The current credential is not configured to acquire tokens for tenant ${t}. To enable acquiring tokens for this tenant add it to the AdditionallyAllowedTenants on the credential options, or add "*" to AdditionallyAllowedTenants to allow acquiring tokens for any tenant.`}s(bOt,"createConfigurationErrorMessage");function Xa(t,e,r=[],n){let i;if(process.env.AZURE_IDENTITY_DISABLE_MULTITENANTAUTH||t==="adfs"?i=t:i=e?.tenantId??t,t&&i!==t&&!r.includes("*")&&!r.some(o=>o.localeCompare(i)===0)){let o=bOt(i);throw n?.info(o),new Hr(o)}return i}s(Xa,"processMultiTenantRequest");function au(t,e){if(!e.match(/^[0-9a-zA-Z-.]+$/)){let r=new Error("Invalid tenant id provided. You can locate your tenant id by following the instructions listed here: https://learn.microsoft.com/partner-center/find-ids-and-domain-names.");throw t.info(Eo("",r)),r}}s(au,"checkTenantId");function SB(t,e,r){return e?(au(t,e),e):(r||(r=c2),r!==c2?"common":"organizations")}s(SB,"resolveTenantId");function dc(t){return!t||t.length===0?[]:t.includes("*")?x6e:t}s(dc,"resolveAdditionallyAllowedTenantIds");var bf=ni("MsalClient");function QOt(t,e,r={}){let n=SB(r.logger??bf,e,t),i=mAe(n,pAe(r)),o=new mT({...r.tokenCredentialOptions,authorityHost:i,loggingOptions:r.loggingOptions});return{auth:{clientId:t,authority:i,knownAuthorities:_qe(n,i,r.disableInstanceDiscovery)},system:{networkClient:o,loggerOptions:{loggerCallback:Xz(r.logger??bf),logLevel:Zz(AV()),piiLoggingEnabled:r.loggingOptions?.enableUnsafeSupportLogging}}}}s(QOt,"generateMsalConfiguration");function Od(t,e,r={}){let n={msalConfig:QOt(t,e,r),cachedAccount:r.authenticationRecord?Rqe(r.authenticationRecord):null,pluginConfiguration:S6e.generatePluginConfiguration(r),logger:r.logger??bf},i=new Map;async function o(O={}){let Y=O.enableCae?"CAE":"default",V=i.get(Y);if(V)return n.logger.getToken.info("Existing PublicClientApplication found in cache, returning it."),V;n.logger.getToken.info(`Creating new PublicClientApplication with CAE ${O.enableCae?"enabled":"disabled"}.`);let z=O.enableCae?n.pluginConfiguration.cache.cachePluginCae:n.pluginConfiguration.cache.cachePlugin;return n.msalConfig.auth.clientCapabilities=O.enableCae?["cp1"]:void 0,V=new fB({...n.msalConfig,broker:{nativeBrokerPlugin:n.pluginConfiguration.broker.nativeBrokerPlugin},cache:{cachePlugin:await z}}),i.set(Y,V),V}s(o,"getPublicApp");let a=new Map;async function c(O={}){let Y=O.enableCae?"CAE":"default",V=a.get(Y);if(V)return n.logger.getToken.info("Existing ConfidentialClientApplication found in cache, returning it."),V;n.logger.getToken.info(`Creating new ConfidentialClientApplication with CAE ${O.enableCae?"enabled":"disabled"}.`);let z=O.enableCae?n.pluginConfiguration.cache.cachePluginCae:n.pluginConfiguration.cache.cachePlugin;return n.msalConfig.auth.clientCapabilities=O.enableCae?["cp1"]:void 0,V=new mB({...n.msalConfig,broker:{nativeBrokerPlugin:n.pluginConfiguration.broker.nativeBrokerPlugin},cache:{cachePlugin:await z}}),a.set(Y,V),V}s(c,"getConfidentialApp");async function l(O,Y,V={}){if(n.cachedAccount===null)throw n.logger.getToken.info("No cached account found in local state."),new Zm({scopes:Y});V.claims&&(n.cachedClaims=V.claims);let z={account:n.cachedAccount,scopes:Y,claims:n.cachedClaims};n.pluginConfiguration.broker.isEnabled&&(z.tokenQueryParameters||={},n.pluginConfiguration.broker.enableMsaPassthrough&&(z.tokenQueryParameters.msal_request_type="consumer_passthrough")),V.proofOfPossessionOptions&&(z.shrNonce=V.proofOfPossessionOptions.nonce,z.authenticationScheme="pop",z.resourceRequestMethod=V.proofOfPossessionOptions.resourceRequestMethod,z.resourceRequestUri=V.proofOfPossessionOptions.resourceRequestUrl),n.logger.getToken.info("Attempting to acquire token silently");try{return await O.acquireTokenSilent(z)}catch(Q){throw nR(Y,Q,V)}}s(l,"getTokenSilent");function u(O){return O?.tenantId?mAe(O.tenantId,pAe(r)):n.msalConfig.auth.authority}s(u,"calculateRequestAuthority");async function f(O,Y,V,z){let Q=null;try{Q=await l(O,Y,V)}catch(U){if(U.name!=="AuthenticationRequiredError")throw U;if(V.disableAutomaticAuthentication)throw new Zm({scopes:Y,getTokenOptions:V,message:"Automatic authentication has been disabled. You may call the authentication() method."})}if(Q===null)try{Q=await z()}catch(U){throw nR(Y,U,V)}return rR(Y,Q,V),n.cachedAccount=Q?.account??null,n.logger.getToken.info(Bl(Y)),{token:Q.accessToken,expiresOnTimestamp:Q.expiresOn.getTime(),refreshAfterTimestamp:Q.refreshOn?.getTime(),tokenType:Q.tokenType}}s(f,"withSilentAuthentication");async function p(O,Y,V={}){n.logger.getToken.info("Attempting to acquire token using client secret"),n.msalConfig.auth.clientSecret=Y;let z=await c(V);try{let Q=await z.acquireTokenByClientCredential({scopes:O,authority:u(V),azureRegion:FK(),claims:V?.claims});return rR(O,Q,V),n.logger.getToken.info(Bl(O)),{token:Q.accessToken,expiresOnTimestamp:Q.expiresOn.getTime(),refreshAfterTimestamp:Q.refreshOn?.getTime(),tokenType:Q.tokenType}}catch(Q){throw nR(O,Q,V)}}s(p,"getTokenByClientSecret");async function m(O,Y,V={}){n.logger.getToken.info("Attempting to acquire token using client assertion"),n.msalConfig.auth.clientAssertion=Y;let z=await c(V);try{let Q=await z.acquireTokenByClientCredential({scopes:O,authority:u(V),azureRegion:FK(),claims:V?.claims,clientAssertion:Y});return rR(O,Q,V),n.logger.getToken.info(Bl(O)),{token:Q.accessToken,expiresOnTimestamp:Q.expiresOn.getTime(),refreshAfterTimestamp:Q.refreshOn?.getTime(),tokenType:Q.tokenType}}catch(Q){throw nR(O,Q,V)}}s(m,"getTokenByClientAssertion");async function h(O,Y,V={}){n.logger.getToken.info("Attempting to acquire token using client certificate"),n.msalConfig.auth.clientCertificate=Y;let z=await c(V);try{let Q=await z.acquireTokenByClientCredential({scopes:O,authority:u(V),azureRegion:FK(),claims:V?.claims});return rR(O,Q,V),n.logger.getToken.info(Bl(O)),{token:Q.accessToken,expiresOnTimestamp:Q.expiresOn.getTime(),refreshAfterTimestamp:Q.refreshOn?.getTime(),tokenType:Q.tokenType}}catch(Q){throw nR(O,Q,V)}}s(h,"getTokenByClientCertificate");async function g(O,Y,V={}){n.logger.getToken.info("Attempting to acquire token using device code");let z=await o(V);return f(z,O,V,()=>{let Q={scopes:O,cancel:V?.abortSignal?.aborted??!1,deviceCodeCallback:Y,authority:u(V),claims:V?.claims},U=z.acquireTokenByDeviceCode(Q);return V.abortSignal&&V.abortSignal.addEventListener("abort",()=>{Q.cancel=!0}),U})}s(g,"getTokenByDeviceCode");async function A(O,Y,V,z={}){n.logger.getToken.info("Attempting to acquire token using username and password");let Q=await o(z);return f(Q,O,z,()=>{let U={scopes:O,username:Y,password:V,authority:u(z),claims:z?.claims};return Q.acquireTokenByUsernamePassword(U)})}s(A,"getTokenByUsernamePassword");function y(){if(n.cachedAccount)return kqe(t,n.cachedAccount)}s(y,"getActiveAccount");async function E(O,Y,V,z,Q={}){n.logger.getToken.info("Attempting to acquire token using authorization code");let U;return z?(n.msalConfig.auth.clientSecret=z,U=await c(Q)):U=await o(Q),f(U,O,Q,()=>U.acquireTokenByCode({scopes:O,redirectUri:Y,code:V,authority:u(Q),claims:Q?.claims}))}s(E,"getTokenByAuthorizationCode");async function b(O,Y,V,z={}){bf.getToken.info("Attempting to acquire token on behalf of another user"),typeof V=="string"?(bf.getToken.info("Using client secret for on behalf of flow"),n.msalConfig.auth.clientSecret=V):typeof V=="function"?(bf.getToken.info("Using client assertion callback for on behalf of flow"),n.msalConfig.auth.clientAssertion=V):(bf.getToken.info("Using client certificate for on behalf of flow"),n.msalConfig.auth.clientCertificate=V);let Q=await c(z);try{let U=await Q.acquireTokenOnBehalfOf({scopes:O,authority:u(z),claims:z.claims,oboAssertion:Y});return rR(O,U,z),bf.getToken.info(Bl(O)),{token:U.accessToken,expiresOnTimestamp:U.expiresOn.getTime(),refreshAfterTimestamp:U.refreshOn?.getTime(),tokenType:U.tokenType}}catch(U){throw nR(O,U,z)}}s(b,"getTokenOnBehalfOf");function S(O,Y){return{openBrowser:s(async V=>{await(await Promise.resolve().then(()=>(HK(),H$e))).default(V,{newInstance:!0})},"openBrowser"),scopes:O,authority:u(Y),claims:Y?.claims,loginHint:Y?.loginHint,errorTemplate:Y?.browserCustomizationOptions?.errorMessage,successTemplate:Y?.browserCustomizationOptions?.successMessage,prompt:Y?.loginHint?"login":"select_account"}}s(S,"createBaseInteractiveRequest");async function R(O,Y,V={}){bf.verbose("Authentication will resume through the broker");let z=await o(V),Q=S(O,V);n.pluginConfiguration.broker.parentWindowHandle?Q.windowHandle=Buffer.from(n.pluginConfiguration.broker.parentWindowHandle):bf.warning("Parent window handle is not specified for the broker. This may cause unexpected behavior. Please provide the parentWindowHandle."),n.pluginConfiguration.broker.enableMsaPassthrough&&((Q.tokenQueryParameters??={}).msal_request_type="consumer_passthrough"),Y?(Q.prompt="none",bf.verbose("Attempting broker authentication using the default broker account")):bf.verbose("Attempting broker authentication without the default broker account"),V.proofOfPossessionOptions&&(Q.shrNonce=V.proofOfPossessionOptions.nonce,Q.authenticationScheme="pop",Q.resourceRequestMethod=V.proofOfPossessionOptions.resourceRequestMethod,Q.resourceRequestUri=V.proofOfPossessionOptions.resourceRequestUrl);try{return await z.acquireTokenInteractive(Q)}catch(U){if(bf.verbose(`Failed to authenticate through the broker: ${U.message}`),V.disableAutomaticAuthentication)throw new Zm({scopes:O,getTokenOptions:V,message:"Cannot silently authenticate with default broker account."});if(Y)return R(O,!1,V);throw U}}s(R,"getBrokeredTokenInternal");async function B(O,Y,V={}){bf.getToken.info(`Attempting to acquire token using brokered authentication with useDefaultBrokerAccount: ${Y}`);let z=await R(O,Y,V);return rR(O,z,V),n.cachedAccount=z?.account??null,n.logger.getToken.info(Bl(O)),{token:z.accessToken,expiresOnTimestamp:z.expiresOn.getTime(),refreshAfterTimestamp:z.refreshOn?.getTime(),tokenType:z.tokenType}}s(B,"getBrokeredToken");async function L(O,Y={}){bf.getToken.info("Attempting to acquire token interactively");let V=await o(Y);return f(V,O,Y,async()=>{let z=S(O,Y);return n.pluginConfiguration.broker.isEnabled?R(O,n.pluginConfiguration.broker.useDefaultBrokerAccount??!1,Y):(Y.proofOfPossessionOptions&&(z.shrNonce=Y.proofOfPossessionOptions.nonce,z.authenticationScheme="pop",z.resourceRequestMethod=Y.proofOfPossessionOptions.resourceRequestMethod,z.resourceRequestUri=Y.proofOfPossessionOptions.resourceRequestUrl),V.acquireTokenInteractive(z))})}return s(L,"getTokenByInteractiveRequest"),{getActiveAccount:y,getBrokeredToken:B,getTokenByClientSecret:p,getTokenByClientAssertion:m,getTokenByClientCertificate:h,getTokenByDeviceCode:g,getTokenByUsernamePassword:A,getTokenByAuthorizationCode:E,getTokenOnBehalfOf:b,getTokenByInteractiveRequest:L}}s(Od,"createMsalClient");var aO=require("node:crypto");var W$e=require("node:fs/promises");var sO="ClientCertificateCredential",$$e=ni(sO),cO=class{static{s(this,"ClientCertificateCredential")}tenantId;additionallyAllowedTenantIds;certificateConfiguration;sendCertificateChain;msalClient;constructor(e,r,n,i={}){if(!e||!r)throw new Error(`${sO}: tenantId and clientId are required parameters.`);this.tenantId=e,this.additionallyAllowedTenantIds=dc(i?.additionallyAllowedTenants),this.sendCertificateChain=i.sendCertificateChain,this.certificateConfiguration={...typeof n=="string"?{certificatePath:n}:n};let o=this.certificateConfiguration.certificate,a=this.certificateConfiguration.certificatePath;if(!this.certificateConfiguration||!(o||a))throw new Error(`${sO}: Provide either a PEM certificate in string form, or the path to that certificate in the filesystem. To troubleshoot, visit https://aka.ms/azsdk/js/identity/serviceprincipalauthentication/troubleshoot.`);if(o&&a)throw new Error(`${sO}: To avoid unexpected behaviors, providing both the contents of a PEM certificate and the path to a PEM certificate is forbidden. To troubleshoot, visit https://aka.ms/azsdk/js/identity/serviceprincipalauthentication/troubleshoot.`);this.msalClient=Od(r,e,{...i,logger:$$e,tokenCredentialOptions:i})}async getToken(e,r={}){return rs.withSpan(`${sO}.getToken`,r,async n=>{n.tenantId=Xa(this.tenantId,n,this.additionallyAllowedTenantIds,$$e);let i=Array.isArray(e)?e:[e],o=await this.buildClientCertificate();return this.msalClient.getTokenByClientCertificate(i,o,n)})}async buildClientCertificate(){let e=await UOt(this.certificateConfiguration,this.sendCertificateChain??!1),r;return this.certificateConfiguration.certificatePassword!==void 0?r=(0,aO.createPrivateKey)({key:e.certificateContents,passphrase:this.certificateConfiguration.certificatePassword,format:"pem"}).export({format:"pem",type:"pkcs8"}).toString():r=e.certificateContents,{thumbprint:e.thumbprint,thumbprintSha256:e.thumbprintSha256,privateKey:r,x5c:e.x5c}}};async function UOt(t,e){let r=t.certificate,n=t.certificatePath,i=r||await(0,W$e.readFile)(n,"utf8"),o=e?i:void 0,a=/(-+BEGIN CERTIFICATE-+)(\n\r?|\r\n?)([A-Za-z0-9+/\n\r]+=*)(\n\r?|\r\n?)(-+END CERTIFICATE-+)/g,c=[],l;do l=a.exec(i),l&&c.push(l[3]);while(l);if(c.length===0)throw new Error("The file at the specified path does not contain a PEM-encoded certificate.");let u=(0,aO.createHash)("sha1").update(Buffer.from(c[0],"base64")).digest("hex").toUpperCase(),f=(0,aO.createHash)("sha256").update(Buffer.from(c[0],"base64")).digest("hex").toUpperCase();return{certificateContents:i,thumbprintSha256:f,thumbprint:u,x5c:o}}s(UOt,"parseCertificate");d();d();function lh(t){return Array.isArray(t)?t:[t]}s(lh,"ensureScopes");function kB(t,e){if(!t.match(/^[0-9a-zA-Z-_.:/]+$/)){let r=new Error("Invalid scope was specified by the user or calling client");throw e.getToken.info(Eo(t,r)),r}}s(kB,"ensureValidScopeForDevTimeCreds");function $K(t){return t.replace(/\/.default$/,"")}s($K,"getScopeResource");var j$e=ni("ClientSecretCredential"),lO=class{static{s(this,"ClientSecretCredential")}tenantId;additionallyAllowedTenantIds;msalClient;clientSecret;constructor(e,r,n,i={}){if(!e)throw new Hr("ClientSecretCredential: tenantId is a required parameter. To troubleshoot, visit https://aka.ms/azsdk/js/identity/serviceprincipalauthentication/troubleshoot.");if(!r)throw new Hr("ClientSecretCredential: clientId is a required parameter. To troubleshoot, visit https://aka.ms/azsdk/js/identity/serviceprincipalauthentication/troubleshoot.");if(!n)throw new Hr("ClientSecretCredential: clientSecret is a required parameter. To troubleshoot, visit https://aka.ms/azsdk/js/identity/serviceprincipalauthentication/troubleshoot.");this.clientSecret=n,this.tenantId=e,this.additionallyAllowedTenantIds=dc(i?.additionallyAllowedTenants),this.msalClient=Od(r,e,{...i,logger:j$e,tokenCredentialOptions:i})}async getToken(e,r={}){return rs.withSpan(`${this.constructor.name}.getToken`,r,async n=>{n.tenantId=Xa(this.tenantId,n,this.additionallyAllowedTenantIds,j$e);let i=lh(e);return this.msalClient.getTokenByClientSecret(i,this.clientSecret,n)})}};d();var qOt=ni("UsernamePasswordCredential"),uO=class{static{s(this,"UsernamePasswordCredential")}tenantId;additionallyAllowedTenantIds;msalClient;username;password;constructor(e,r,n,i,o={}){if(!e)throw new Hr("UsernamePasswordCredential: tenantId is a required parameter. To troubleshoot, visit https://aka.ms/azsdk/js/identity/usernamepasswordcredential/troubleshoot.");if(!r)throw new Hr("UsernamePasswordCredential: clientId is a required parameter. To troubleshoot, visit https://aka.ms/azsdk/js/identity/usernamepasswordcredential/troubleshoot.");if(!n)throw new Hr("UsernamePasswordCredential: username is a required parameter. To troubleshoot, visit https://aka.ms/azsdk/js/identity/usernamepasswordcredential/troubleshoot.");if(!i)throw new Hr("UsernamePasswordCredential: password is a required parameter. To troubleshoot, visit https://aka.ms/azsdk/js/identity/usernamepasswordcredential/troubleshoot.");this.tenantId=e,this.additionallyAllowedTenantIds=dc(o?.additionallyAllowedTenants),this.username=n,this.password=i,this.msalClient=Od(r,this.tenantId,{...o,tokenCredentialOptions:o??{}})}async getToken(e,r={}){return rs.withSpan(`${this.constructor.name}.getToken`,r,async n=>{n.tenantId=Xa(this.tenantId,n,this.additionallyAllowedTenantIds,qOt);let i=lh(e);return this.msalClient.getTokenByUsernamePassword(i,this.username,this.password,n)})}};var HOt=["AZURE_TENANT_ID","AZURE_CLIENT_ID","AZURE_CLIENT_SECRET","AZURE_CLIENT_CERTIFICATE_PATH","AZURE_CLIENT_CERTIFICATE_PASSWORD","AZURE_USERNAME","AZURE_PASSWORD","AZURE_ADDITIONALLY_ALLOWED_TENANTS","AZURE_CLIENT_SEND_CERTIFICATE_CHAIN"];function $Ot(){return(process.env.AZURE_ADDITIONALLY_ALLOWED_TENANTS??"").split(";")}s($Ot,"getAdditionallyAllowedTenants");var WK="EnvironmentCredential",dx=ni(WK);function WOt(){let t=(process.env.AZURE_CLIENT_SEND_CERTIFICATE_CHAIN??"").toLowerCase(),e=t==="true"||t==="1";return dx.verbose(`AZURE_CLIENT_SEND_CERTIFICATE_CHAIN: ${process.env.AZURE_CLIENT_SEND_CERTIFICATE_CHAIN}; sendCertificateChain: ${e}`),e}s(WOt,"getSendCertificateChain");var dO=class{static{s(this,"EnvironmentCredential")}_credential=void 0;constructor(e){let r=yV(HOt).assigned.join(", ");dx.info(`Found the following environment variables: ${r}`);let n=process.env.AZURE_TENANT_ID,i=process.env.AZURE_CLIENT_ID,o=process.env.AZURE_CLIENT_SECRET,a=$Ot(),c=WOt(),l={...e,additionallyAllowedTenantIds:a,sendCertificateChain:c};if(n&&au(dx,n),n&&i&&o){dx.info(`Invoking ClientSecretCredential with tenant ID: ${n}, clientId: ${i} and clientSecret: [REDACTED]`),this._credential=new lO(n,i,o,l);return}let u=process.env.AZURE_CLIENT_CERTIFICATE_PATH,f=process.env.AZURE_CLIENT_CERTIFICATE_PASSWORD;if(n&&i&&u){dx.info(`Invoking ClientCertificateCredential with tenant ID: ${n}, clientId: ${i} and certificatePath: ${u}`),this._credential=new cO(n,i,{certificatePath:u,certificatePassword:f},l);return}let p=process.env.AZURE_USERNAME,m=process.env.AZURE_PASSWORD;n&&i&&p&&m&&(dx.info(`Invoking UsernamePasswordCredential with tenant ID: ${n}, clientId: ${i} and username: ${p}`),dx.warning("Environment is configured to use username and password authentication. This authentication method is deprecated, as it doesn't support multifactor authentication (MFA). Use a more secure credential. For more details, see https://aka.ms/azsdk/identity/mfa."),this._credential=new uO(n,i,p,m,l))}async getToken(e,r={}){return rs.withSpan(`${WK}.getToken`,r,async n=>{if(this._credential)try{let i=await this._credential.getToken(e,n);return dx.getToken.info(Bl(e)),i}catch(i){let o=new QI(400,{error:`${WK} authentication failed. To troubleshoot, visit https://aka.ms/azsdk/js/identity/environmentcredential/troubleshoot.`,error_description:i.message.toString().split("More details:").join("")});throw dx.getToken.info(Eo(e,o)),o}throw new Hr(`${WK} is unavailable. No underlying credential could be used. To troubleshoot, visit https://aka.ms/azsdk/js/identity/environmentcredential/troubleshoot.`)})}};d();d();var jOt=1e3*64,GOt=3e3;function G$e(t){return sye([{name:"imdsRetryPolicy",retry:s(({retryCount:e,response:r})=>{if(r?.status!==404&&r?.status!==410)return{skipStrategy:!0};let n=r?.status===410?Math.max(GOt,t.startDelayInMs):t.startDelayInMs;return wqe(e,{retryDelayInMs:n,maxRetryDelayInMs:jOt})},"retry")}],{maxRetries:t.maxRetries})}s(G$e,"imdsRetryPolicy");d();var fx="ManagedIdentityCredential - IMDS",oR=ni(fx),VOt="http://169.254.169.254",zOt="/metadata/identity/oauth2/token";function KOt(t){if(!tO(t))throw new Error(`${fx}: Multiple scopes are not supported.`);let r=new URL(zOt,process.env.AZURE_POD_IDENTITY_AUTHORITY_HOST??VOt),n={Accept:"application/json"};return{url:`${r}`,method:"GET",headers:fT(n)}}s(KOt,"prepareInvalidRequestOptions");var V$e={name:"imdsMsi",async isAvailable(t){let{scopes:e,identityClient:r,getTokenOptions:n}=t,i=tO(e);if(!i)return oR.info(`${fx}: Unavailable. Multiple scopes are not supported.`),!1;if(process.env.AZURE_POD_IDENTITY_AUTHORITY_HOST)return!0;if(!r)throw new Error("Missing IdentityClient");let o=KOt(i);return rs.withSpan("ManagedIdentityCredential-pingImdsEndpoint",n??{},async a=>{o.tracingOptions=a.tracingOptions;let c=CA(o);c.timeout=a.requestOptions?.timeout||1e3,c.allowInsecureConnection=!0;let l;try{oR.info(`${fx}: Pinging the Azure IMDS endpoint`),l=await r.sendRequest(c)}catch(u){return Yz(u)&&oR.verbose(`${fx}: Caught error ${u.name}: ${u.message}`),oR.info(`${fx}: The Azure IMDS endpoint is unavailable`),!1}return l.status===403&&l.bodyAsText?.includes("unreachable")?(oR.info(`${fx}: The Azure IMDS endpoint is unavailable`),oR.info(`${fx}: ${l.bodyAsText}`),!1):(oR.info(`${fx}: The Azure IMDS endpoint is available`),!0)})}};d();d();d();var z$e=ni("ClientAssertionCredential"),PB=class{static{s(this,"ClientAssertionCredential")}msalClient;tenantId;additionallyAllowedTenantIds;getAssertion;options;constructor(e,r,n,i={}){if(!e)throw new Hr("ClientAssertionCredential: tenantId is a required parameter.");if(!r)throw new Hr("ClientAssertionCredential: clientId is a required parameter.");if(!n)throw new Hr("ClientAssertionCredential: clientAssertion is a required parameter.");this.tenantId=e,this.additionallyAllowedTenantIds=dc(i?.additionallyAllowedTenants),this.options=i,this.getAssertion=n,this.msalClient=Od(r,e,{...i,logger:z$e,tokenCredentialOptions:this.options})}async getToken(e,r={}){return rs.withSpan(`${this.constructor.name}.getToken`,r,async n=>{n.tenantId=Xa(this.tenantId,n,this.additionallyAllowedTenantIds,z$e);let i=Array.isArray(e)?e:[e];return this.msalClient.getTokenByClientAssertion(i,this.getAssertion,n)})}};var K$e=require("node:fs/promises");var sR="WorkloadIdentityCredential",YOt=["AZURE_TENANT_ID","AZURE_CLIENT_ID","AZURE_FEDERATED_TOKEN_FILE"],fO=ni(sR),px=class{static{s(this,"WorkloadIdentityCredential")}client;azureFederatedTokenFileContent=void 0;cacheDate=void 0;federatedTokenFilePath;constructor(e){let r=yV(YOt).assigned.join(", ");fO.info(`Found the following environment variables: ${r}`);let n=e??{},i=n.tenantId||process.env.AZURE_TENANT_ID,o=n.clientId||process.env.AZURE_CLIENT_ID;if(this.federatedTokenFilePath=n.tokenFilePath||process.env.AZURE_FEDERATED_TOKEN_FILE,i&&au(fO,i),!o)throw new Hr(`${sR}: is unavailable. clientId is a required parameter. In DefaultAzureCredential and ManagedIdentityCredential, this can be provided as an environment variable - "AZURE_CLIENT_ID".
        See the troubleshooting guide for more information: https://aka.ms/azsdk/js/identity/workloadidentitycredential/troubleshoot`);if(!i)throw new Hr(`${sR}: is unavailable. tenantId is a required parameter. In DefaultAzureCredential and ManagedIdentityCredential, this can be provided as an environment variable - "AZURE_TENANT_ID".
        See the troubleshooting guide for more information: https://aka.ms/azsdk/js/identity/workloadidentitycredential/troubleshoot`);if(!this.federatedTokenFilePath)throw new Hr(`${sR}: is unavailable. federatedTokenFilePath is a required parameter. In DefaultAzureCredential and ManagedIdentityCredential, this can be provided as an environment variable - "AZURE_FEDERATED_TOKEN_FILE".
        See the troubleshooting guide for more information: https://aka.ms/azsdk/js/identity/workloadidentitycredential/troubleshoot`);fO.info(`Invoking ClientAssertionCredential with tenant ID: ${i}, clientId: ${n.clientId} and federated token path: [REDACTED]`),this.client=new PB(i,o,this.readFileContents.bind(this),e)}async getToken(e,r){if(!this.client){let n=`${sR}: is unavailable. tenantId, clientId, and federatedTokenFilePath are required parameters. 
      In DefaultAzureCredential and ManagedIdentityCredential, these can be provided as environment variables - 
      "AZURE_TENANT_ID",
      "AZURE_CLIENT_ID",
      "AZURE_FEDERATED_TOKEN_FILE". See the troubleshooting guide for more information: https://aka.ms/azsdk/js/identity/workloadidentitycredential/troubleshoot`;throw fO.info(n),new Hr(n)}return fO.info("Invoking getToken() of Client Assertion Credential"),this.client.getToken(e,r)}async readFileContents(){if(this.cacheDate!==void 0&&Date.now()-this.cacheDate>=1e3*60*5&&(this.azureFederatedTokenFileContent=void 0),!this.federatedTokenFilePath)throw new Hr(`${sR}: is unavailable. Invalid file path provided ${this.federatedTokenFilePath}.`);if(!this.azureFederatedTokenFileContent){let r=(await(0,K$e.readFile)(this.federatedTokenFilePath,"utf8")).trim();if(r)this.azureFederatedTokenFileContent=r,this.cacheDate=Date.now();else throw new Hr(`${sR}: is unavailable. No content on the file ${this.federatedTokenFilePath}.`)}return this.azureFederatedTokenFileContent}};var Y$e="ManagedIdentityCredential - Token Exchange",JOt=ni(Y$e),Nye={name:"tokenExchangeMsi",async isAvailable(t){let e=process.env,r=!!((t||e.AZURE_CLIENT_ID)&&e.AZURE_TENANT_ID&&process.env.AZURE_FEDERATED_TOKEN_FILE);return r||JOt.info(`${Y$e}: Unavailable. The environment variables needed are: AZURE_CLIENT_ID (or the client ID sent through the parameters), AZURE_TENANT_ID and AZURE_FEDERATED_TOKEN_FILE`),r},async getToken(t,e={}){let{scopes:r,clientId:n}=t,i={};return new px({clientId:n,tenantId:process.env.AZURE_TENANT_ID,tokenFilePath:process.env.AZURE_FEDERATED_TOKEN_FILE,...i,disableInstanceDiscovery:!0}).getToken(r,e)}};var O0=ni("ManagedIdentityCredential"),yT=class{static{s(this,"ManagedIdentityCredential")}managedIdentityApp;identityClient;clientId;resourceId;objectId;msiRetryConfig={maxRetries:5,startDelayInMs:800,intervalIncrement:2};isAvailableIdentityClient;constructor(e,r){let n;typeof e=="string"?(this.clientId=e,n=r??{}):(this.clientId=e?.clientId,n=e??{}),this.resourceId=n?.resourceId,this.objectId=n?.objectId;let i=[{key:"clientId",value:this.clientId},{key:"resourceId",value:this.resourceId},{key:"objectId",value:this.objectId}].filter(a=>a.value);if(i.length>1)throw new Error(`ManagedIdentityCredential: only one of 'clientId', 'resourceId', or 'objectId' can be provided. Received values: ${JSON.stringify({clientId:this.clientId,resourceId:this.resourceId,objectId:this.objectId})}`);n.allowInsecureConnection=!0,n.retryOptions?.maxRetries!==void 0&&(this.msiRetryConfig.maxRetries=n.retryOptions.maxRetries),this.identityClient=new mT({...n,additionalPolicies:[{policy:G$e(this.msiRetryConfig),position:"perCall"}]}),this.managedIdentityApp=new hB({managedIdentityIdParams:{userAssignedClientId:this.clientId,userAssignedResourceId:this.resourceId,userAssignedObjectId:this.objectId},system:{disableInternalRetries:!0,networkClient:this.identityClient,loggerOptions:{logLevel:Zz(AV()),piiLoggingEnabled:n.loggingOptions?.enableUnsafeSupportLogging,loggerCallback:Xz(O0)}}}),this.isAvailableIdentityClient=new mT({...n,retryOptions:{maxRetries:0}});let o=this.managedIdentityApp.getManagedIdentitySource();if(o==="CloudShell"&&(this.clientId||this.resourceId||this.objectId))throw O0.warning(`CloudShell MSI detected with user-provided IDs - throwing. Received values: ${JSON.stringify({clientId:this.clientId,resourceId:this.resourceId,objectId:this.objectId})}.`),new Hr("ManagedIdentityCredential: Specifying a user-assigned managed identity is not supported for CloudShell at runtime. When using Managed Identity in CloudShell, omit the clientId, resourceId, and objectId parameters.");if(o==="ServiceFabric"&&(this.clientId||this.resourceId||this.objectId))throw O0.warning(`Service Fabric detected with user-provided IDs - throwing. Received values: ${JSON.stringify({clientId:this.clientId,resourceId:this.resourceId,objectId:this.objectId})}.`),new Hr(`ManagedIdentityCredential: ${d$e}`);if(O0.info(`Using ${o} managed identity.`),i.length===1){let{key:a,value:c}=i[0];O0.info(`${o} with ${a}: ${c}`)}}async getToken(e,r={}){O0.getToken.info("Using the MSAL provider for Managed Identity.");let n=tO(e);if(!n)throw new Hr(`ManagedIdentityCredential: Multiple scopes are not supported. Scopes: ${JSON.stringify(e)}`);return rs.withSpan("ManagedIdentityCredential.getToken",r,async()=>{try{let i=await Nye.isAvailable(this.clientId),o=this.managedIdentityApp.getManagedIdentitySource(),a=o==="DefaultToImds"||o==="Imds";if(O0.getToken.info(`MSAL Identity source: ${o}`),i){O0.getToken.info("Using the token exchange managed identity.");let l=await Nye.getToken({scopes:e,clientId:this.clientId,identityClient:this.identityClient,retryConfig:this.msiRetryConfig,resourceId:this.resourceId});if(l===null)throw new Hr("Attempted to use the token exchange managed identity, but received a null response.");return l}else if(a&&(O0.getToken.info("Using the IMDS endpoint to probe for availability."),!await V$e.isAvailable({scopes:e,clientId:this.clientId,getTokenOptions:r,identityClient:this.isAvailableIdentityClient,resourceId:this.resourceId})))throw new Hr("Attempted to use the IMDS endpoint, but it is not available.");O0.getToken.info("Calling into MSAL for managed identity token.");let c=await this.managedIdentityApp.acquireToken({resource:n});return this.ensureValidMsalToken(e,c,r),O0.getToken.info(Bl(e)),{expiresOnTimestamp:c.expiresOn.getTime(),token:c.accessToken,refreshAfterTimestamp:c.refreshOn?.getTime(),tokenType:"Bearer"}}catch(i){throw O0.getToken.error(Eo(e,i)),i.name==="AuthenticationRequiredError"?i:XOt(i)?new Hr(`ManagedIdentityCredential: Network unreachable. Message: ${i.message}`,{cause:i}):new Hr(`ManagedIdentityCredential: Authentication failed. Message ${i.message}`,{cause:i})}})}ensureValidMsalToken(e,r,n){let i=s(o=>(O0.getToken.info(o),new Zm({scopes:Array.isArray(e)?e:[e],getTokenOptions:n,message:o})),"createError");if(!r)throw i("No response.");if(!r.expiresOn)throw i('Response had no "expiresOn" property.');if(!r.accessToken)throw i('Response had no "accessToken" property.')}};function XOt(t){return!!(t.errorCode==="network_error"||t.code==="ENETUNREACH"||t.code==="EHOSTUNREACH"||(t.statusCode===403||t.code===403)&&t.message.includes("unreachable"))}s(XOt,"isNetworkError");d();var J$e=Be(require("child_process"),1);var mx=ni("AzureDeveloperCliCredential"),X$e={getSafeWorkingDir(){if(process.platform==="win32"){let t=process.env.SystemRoot||process.env.SYSTEMROOT;return t||(mx.getToken.warning("The SystemRoot environment variable is not set. This may cause issues when using the Azure Developer CLI credential."),t="C:\\Windows"),t}else return"/bin"},async getAzdAccessToken(t,e,r){let n=[];return e&&(n=["--tenant-id",e]),new Promise((i,o)=>{try{let c=["azd",...["auth","token","--output","json",...t.reduce((l,u)=>l.concat("--scope",u),[]),...n]].join(" ");J$e.default.exec(c,{cwd:X$e.getSafeWorkingDir(),timeout:r},(l,u,f)=>{i({stdout:u,stderr:f,error:l})})}catch(a){o(a)}})}},pO=class{static{s(this,"AzureDeveloperCliCredential")}tenantId;additionallyAllowedTenantIds;timeout;constructor(e){e?.tenantId&&(au(mx,e?.tenantId),this.tenantId=e?.tenantId),this.additionallyAllowedTenantIds=dc(e?.additionallyAllowedTenants),this.timeout=e?.processTimeoutInMs}async getToken(e,r={}){let n=Xa(this.tenantId,r,this.additionallyAllowedTenantIds);n&&au(mx,n);let i;return typeof e=="string"?i=[e]:i=e,mx.getToken.info(`Using the scopes ${e}`),rs.withSpan(`${this.constructor.name}.getToken`,r,async()=>{try{i.forEach(l=>{kB(l,mx)});let o=await X$e.getAzdAccessToken(i,n,this.timeout),a=o.stderr?.match("not logged in, run `azd login` to login")||o.stderr?.match("not logged in, run `azd auth login` to login");if(o.stderr?.match("azd:(.*)not found")||o.stderr?.startsWith("'azd' is not recognized")||o.error&&o.error.code==="ENOENT"){let l=new Hr("Azure Developer CLI couldn't be found. To mitigate this issue, see the troubleshooting guidelines at https://aka.ms/azsdk/js/identity/azdevclicredential/troubleshoot.");throw mx.getToken.info(Eo(e,l)),l}if(a){let l=new Hr("Please run 'azd auth login' from a command prompt to authenticate before using this credential. For more information, see the troubleshooting guidelines at https://aka.ms/azsdk/js/identity/azdevclicredential/troubleshoot.");throw mx.getToken.info(Eo(e,l)),l}try{let l=JSON.parse(o.stdout);return mx.getToken.info(Bl(e)),{token:l.token,expiresOnTimestamp:new Date(l.expiresOn).getTime(),tokenType:"Bearer"}}catch(l){throw o.stderr?new Hr(o.stderr):l}}catch(o){let a=o.name==="CredentialUnavailableError"?o:new Hr(o.message||"Unknown error while trying to retrieve the access token");throw mx.getToken.info(Eo(e,a)),a}})}};d();var Z$e=Be(require("child_process"),1);d();function Mye(t,e){if(!e.match(/^[0-9a-zA-Z-._ ]+$/)){let r=new Error(`Subscription '${e}' contains invalid characters. If this is the name of a subscription, use its ID instead. You can locate your subscription by following the instructions listed here: https://learn.microsoft.com/azure/azure-portal/get-subscription-tenant-id`);throw t.info(Eo("",r)),r}}s(Mye,"checkSubscription");var uh=ni("AzureCliCredential"),eWe={getSafeWorkingDir(){if(process.platform==="win32"){let t=process.env.SystemRoot||process.env.SYSTEMROOT;return t||(uh.getToken.warning("The SystemRoot environment variable is not set. This may cause issues when using the Azure CLI credential."),t="C:\\Windows"),t}else return"/bin"},async getAzureCliAccessToken(t,e,r,n){let i=[],o=[];return e&&(i=["--tenant",e]),r&&(o=["--subscription",`"${r}"`]),new Promise((a,c)=>{try{let u=["az",...["account","get-access-token","--output","json","--resource",t,...i,...o]].join(" ");Z$e.default.exec(u,{cwd:eWe.getSafeWorkingDir(),timeout:n},(f,p,m)=>{a({stdout:p,stderr:m,error:f})})}catch(l){c(l)}})}},mO=class{static{s(this,"AzureCliCredential")}tenantId;additionallyAllowedTenantIds;timeout;subscription;constructor(e){e?.tenantId&&(au(uh,e?.tenantId),this.tenantId=e?.tenantId),e?.subscription&&(Mye(uh,e?.subscription),this.subscription=e?.subscription),this.additionallyAllowedTenantIds=dc(e?.additionallyAllowedTenants),this.timeout=e?.processTimeoutInMs}async getToken(e,r={}){let n=Xa(this.tenantId,r,this.additionallyAllowedTenantIds);n&&au(uh,n),this.subscription&&Mye(uh,this.subscription);let i=typeof e=="string"?e:e[0];return uh.getToken.info(`Using the scope ${i}`),rs.withSpan(`${this.constructor.name}.getToken`,r,async()=>{try{kB(i,uh);let o=$K(i),a=await eWe.getAzureCliAccessToken(o,n,this.subscription,this.timeout),c=a.stderr?.match("(.*)az login --scope(.*)"),l=a.stderr?.match("(.*)az login(.*)")&&!c;if(a.stderr?.match("az:(.*)not found")||a.stderr?.startsWith("'az' is not recognized")){let f=new Hr("Azure CLI could not be found. Please visit https://aka.ms/azure-cli for installation instructions and then, once installed, authenticate to your Azure account using 'az login'.");throw uh.getToken.info(Eo(e,f)),f}if(l){let f=new Hr("Please run 'az login' from a command prompt to authenticate before using this credential.");throw uh.getToken.info(Eo(e,f)),f}try{let f=a.stdout,p=this.parseRawResponse(f);return uh.getToken.info(Bl(e)),p}catch(f){throw a.stderr?new Hr(a.stderr):f}}catch(o){let a=o.name==="CredentialUnavailableError"?o:new Hr(o.message||"Unknown error while trying to retrieve the access token");throw uh.getToken.info(Eo(e,a)),a}})}parseRawResponse(e){let r=JSON.parse(e),n=r.accessToken,i=Number.parseInt(r.expires_on,10)*1e3;if(!isNaN(i))return uh.getToken.info("expires_on is available and is valid, using it"),{token:n,expiresOnTimestamp:i,tokenType:"Bearer"};if(i=new Date(r.expiresOn).getTime(),isNaN(i))throw new Hr(`Unexpected response from Azure CLI when getting token. Expected "expiresOn" to be a RFC3339 date string. Got: "${r.expiresOn}"`);return{token:n,expiresOnTimestamp:i,tokenType:"Bearer"}}};d();d();var tWe=Be(require("node:child_process"),1),rWe={execFile(t,e,r){return new Promise((n,i)=>{let o=[...e],a=[t,...o].join(" ");tWe.default.exec(a,r,(c,l,u)=>{Buffer.isBuffer(l)&&(l=l.toString("utf8")),Buffer.isBuffer(u)&&(u=u.toString("utf8")),u||c?i(u?new Error(u):c):n(l)})})}};var hx=ni("AzurePowerShellCredential"),iWe=process.platform==="win32";function oWe(t){return iWe?`${t}.exe`:t}s(oWe,"formatCommand");async function nWe(t,e){let r=[];for(let n of t){let[i,...o]=n,a=await rWe.execFile(i,o,{encoding:"utf8",timeout:e});r.push(a)}return r}s(nWe,"runCommands");var sWe={login:"Run Connect-AzAccount to login",installed:"The specified module 'Az.Accounts' with version '2.2.0' was not loaded because no valid module file was found in any module directory"},Lye={login:"Please run 'Connect-AzAccount' from PowerShell to authenticate before using this credential.",installed:`The 'Az.Account' module >= 2.2.0 is not installed. Install the Azure Az PowerShell module with: "Install-Module -Name Az -Scope CurrentUser -Repository PSGallery -Force".`,troubleshoot:"To troubleshoot, visit https://aka.ms/azsdk/js/identity/powershellcredential/troubleshoot."},ZOt=s(t=>t.message.match(`(.*)${sWe.login}(.*)`),"isLoginError"),e7t=s(t=>t.message.match(sWe.installed),"isNotInstalledError"),Fye=[oWe("pwsh")];iWe&&Fye.push(oWe("powershell"));var hO=class{static{s(this,"AzurePowerShellCredential")}tenantId;additionallyAllowedTenantIds;timeout;constructor(e){e?.tenantId&&(au(hx,e?.tenantId),this.tenantId=e?.tenantId),this.additionallyAllowedTenantIds=dc(e?.additionallyAllowedTenants),this.timeout=e?.processTimeoutInMs}async getAzurePowerShellAccessToken(e,r,n){for(let i of[...Fye]){try{await nWe([[i,"/?"]],n)}catch{Fye.shift();continue}let a=(await nWe([[i,"-NoProfile","-NonInteractive","-Command",`
          $tenantId = "${r??""}"
          $m = Import-Module Az.Accounts -MinimumVersion 2.2.0 -PassThru
          $useSecureString = $m.Version -ge [version]'2.17.0' -and $m.Version -lt [version]'5.0.0'

          $params = @{
            ResourceUrl = "${e}"
          }

          if ($tenantId.Length -gt 0) {
            $params["TenantId"] = $tenantId
          }

          if ($useSecureString) {
            $params["AsSecureString"] = $true
          }

          $token = Get-AzAccessToken @params

          $result = New-Object -TypeName PSObject
          $result | Add-Member -MemberType NoteProperty -Name ExpiresOn -Value $token.ExpiresOn

          if ($token.Token -is [System.Security.SecureString]) {
            if ($PSVersionTable.PSVersion.Major -lt 7) {
              $ssPtr = [System.Runtime.InteropServices.Marshal]::SecureStringToBSTR($token.Token)
              try {
                $result | Add-Member -MemberType NoteProperty -Name Token -Value ([System.Runtime.InteropServices.Marshal]::PtrToStringBSTR($ssPtr))
              }
              finally {
                [System.Runtime.InteropServices.Marshal]::ZeroFreeBSTR($ssPtr)
              }
            }
            else {
              $result | Add-Member -MemberType NoteProperty -Name Token -Value ($token.Token | ConvertFrom-SecureString -AsPlainText)
            }
          }
          else {
            $result | Add-Member -MemberType NoteProperty -Name Token -Value $token.Token
          }

          Write-Output (ConvertTo-Json $result)
          `]]))[0];return t7t(a)}throw new Error("Unable to execute PowerShell. Ensure that it is installed in your system")}async getToken(e,r={}){return rs.withSpan(`${this.constructor.name}.getToken`,r,async()=>{let n=Xa(this.tenantId,r,this.additionallyAllowedTenantIds),i=typeof e=="string"?e:e[0];n&&au(hx,n);try{kB(i,hx),hx.getToken.info(`Using the scope ${i}`);let o=$K(i),a=await this.getAzurePowerShellAccessToken(o,n,this.timeout);return hx.getToken.info(Bl(e)),{token:a.Token,expiresOnTimestamp:new Date(a.ExpiresOn).getTime(),tokenType:"Bearer"}}catch(o){if(e7t(o)){let c=new Hr(Lye.installed);throw hx.getToken.info(Eo(i,c)),c}else if(ZOt(o)){let c=new Hr(Lye.login);throw hx.getToken.info(Eo(i,c)),c}let a=new Hr(`${o}. ${Lye.troubleshoot}`);throw hx.getToken.info(Eo(i,a)),a}})}};async function t7t(t){let e=/{[^{}]*}/g,r=t.match(e),n=t;if(r)try{for(let i of r)try{let o=JSON.parse(i);if(o?.Token)return n=n.replace(i,""),n&&hx.getToken.warning(n),o}catch{continue}}catch{throw new Error(`Unable to parse the output of PowerShell. Received output: ${t}`)}throw new Error(`No access token found in the output. Received output: ${t}`)}s(t7t,"parseJsonToken");d();var aWe=require("node:fs/promises");var r7t="common",n7t="aebc6443-996d-45c2-90f0-388ff96faa56",Oye=ni("VisualStudioCodeCredential"),i7t={adfs:"The VisualStudioCodeCredential does not support authentication with ADFS tenants."};function o7t(t){let e=i7t[t];if(e)throw new Hr(e)}s(o7t,"checkUnsupportedTenant");var gO=class{static{s(this,"VisualStudioCodeCredential")}tenantId;additionallyAllowedTenantIds;msalClient;options;constructor(e){this.options=e||{},e&&e.tenantId?(au(Oye,e.tenantId),this.tenantId=e.tenantId):this.tenantId=r7t,this.additionallyAllowedTenantIds=dc(e?.additionallyAllowedTenants),o7t(this.tenantId)}async prepare(e){let r=Xa(this.tenantId,this.options,this.additionallyAllowedTenantIds,Oye)||this.tenantId;if(!w6e()||!dV)throw new Hr("Visual Studio Code Authentication is not available. Ensure you have have Azure Resources Extension installed in VS Code, signed into Azure via VS Code, installed the @azure/identity-vscode package, and properly configured the extension.");let n=await this.loadAuthRecord(dV,e);this.msalClient=Od(n7t,r,{...this.options,isVSCodeCredential:!0,brokerOptions:{enabled:!0,parentWindowHandle:new Uint8Array(0),useDefaultBrokerAccount:!0},authenticationRecord:n})}preparePromise;prepareOnce(e){return this.preparePromise||(this.preparePromise=this.prepare(e)),this.preparePromise}async getToken(e,r){let n=lh(e);if(await this.prepareOnce(n),!this.msalClient)throw new Hr("Visual Studio Code Authentication failed to initialize. Ensure you have have Azure Resources Extension installed in VS Code, signed into Azure via VS Code, installed the @azure/identity-vscode package, and properly configured the extension.");return this.msalClient.getTokenByInteractiveRequest(n,r||{})}async loadAuthRecord(e,r){try{let n=await(0,aWe.readFile)(e,{encoding:"utf8"});return hAe(n)}catch(n){throw Oye.getToken.info(Eo(r,n)),new Hr("Cannot load authentication record in Visual Studio Code. Ensure you have have Azure Resources Extension installed in VS Code, signed into Azure via VS Code, installed the @azure/identity-vscode package, and properly configured the extension.")}}};d();var jK=ni("BrokerCredential"),GK=class{static{s(this,"BrokerCredential")}brokerMsalClient;brokerTenantId;brokerAdditionallyAllowedTenantIds;constructor(e){this.brokerTenantId=SB(jK,e.tenantId),this.brokerAdditionallyAllowedTenantIds=dc(e?.additionallyAllowedTenants);let r={...e,tokenCredentialOptions:e,logger:jK,brokerOptions:{enabled:!0,parentWindowHandle:new Uint8Array(0),useDefaultBrokerAccount:!0}};this.brokerMsalClient=Od(c2,this.brokerTenantId,r)}async getToken(e,r={}){return rs.withSpan(`${this.constructor.name}.getToken`,r,async n=>{n.tenantId=Xa(this.brokerTenantId,n,this.brokerAdditionallyAllowedTenantIds,jK);let i=lh(e);try{return this.brokerMsalClient.getBrokeredToken(i,!0,{...n,disableAutomaticAuthentication:!0})}catch(o){throw jK.getToken.info(Eo(i,o)),new Hr("Failed to acquire token using broker authentication",{cause:o})}})}};function cWe(t={}){return new GK(t)}s(cWe,"createDefaultBrokerCredential");function Qye(t={}){return new gO(t)}s(Qye,"createDefaultVisualStudioCodeCredential");function Uye(t={}){t.retryOptions??={maxRetries:5,retryDelayInMs:800};let e=t?.managedIdentityClientId??process.env.AZURE_CLIENT_ID,r=t?.workloadIdentityClientId??e,n=t?.managedIdentityResourceId,i=process.env.AZURE_FEDERATED_TOKEN_FILE,o=t?.tenantId??process.env.AZURE_TENANT_ID;if(n){let a={...t,resourceId:n};return new yT(a)}if(i&&r){let a={...t,tenantId:o};return new yT(r,a)}if(e){let a={...t,clientId:e};return new yT(a)}return new yT(t)}s(Uye,"createDefaultManagedIdentityCredential");function qye(t){let e=t?.managedIdentityClientId??process.env.AZURE_CLIENT_ID,r=t?.workloadIdentityClientId??e,n=process.env.AZURE_FEDERATED_TOKEN_FILE,i=t?.tenantId??process.env.AZURE_TENANT_ID;if(n&&r){let o={...t,tenantId:i,clientId:r,tokenFilePath:n};return new px(o)}if(i){let o={...t,tenantId:i};return new px(o)}return new px(t)}s(qye,"createDefaultWorkloadIdentityCredential");function Hye(t={}){return new pO(t)}s(Hye,"createDefaultAzureDeveloperCliCredential");function $ye(t={}){return new mO(t)}s($ye,"createDefaultAzureCliCredential");function Wye(t={}){return new hO(t)}s(Wye,"createDefaultAzurePowershellCredential");function jye(t={}){return new dO(t)}s(jye,"createDefaultEnvironmentCredential");var Gye=ni("DefaultAzureCredential"),Vye=class{static{s(this,"UnavailableDefaultCredential")}credentialUnavailableErrorMessage;credentialName;constructor(e,r){this.credentialName=e,this.credentialUnavailableErrorMessage=r}getToken(){return Gye.getToken.info(`Skipping ${this.credentialName}, reason: ${this.credentialUnavailableErrorMessage}`),Promise.resolve(null)}},DB=class extends b9{static{s(this,"DefaultAzureCredential")}constructor(e){let r=process.env.AZURE_TOKEN_CREDENTIALS?process.env.AZURE_TOKEN_CREDENTIALS.trim().toLowerCase():void 0,n=[Qye,$ye,Wye,Hye,cWe],i=[jye,qye,Uye],o=[],a="EnvironmentCredential, WorkloadIdentityCredential, ManagedIdentityCredential, VisualStudioCodeCredential, AzureCliCredential, AzurePowerShellCredential, AzureDeveloperCliCredential";if(r)switch(r){case"dev":o=n;break;case"prod":o=i;break;case"environmentcredential":o=[jye];break;case"workloadidentitycredential":o=[qye];break;case"managedidentitycredential":o=[Uye];break;case"visualstudiocodecredential":o=[Qye];break;case"azureclicredential":o=[$ye];break;case"azurepowershellcredential":o=[Wye];break;case"azuredeveloperclicredential":o=[Hye];break;default:{let l=`Invalid value for AZURE_TOKEN_CREDENTIALS = ${process.env.AZURE_TOKEN_CREDENTIALS}. Valid values are 'prod' or 'dev' or any of these credentials - ${a}.`;throw Gye.warning(l),new Error(l)}}else o=[...i,...n];let c=o.map(l=>{try{return l(e)}catch(u){return Gye.warning(`Skipped ${l.name} because of an error creating the credential: ${u}`),new Vye(l.name,u.message)}});super(...c)}};d();var IRn=ni("InteractiveBrowserCredential");d();var NRn=ni("DeviceCodeCredential");d();var s7t="AzurePipelinesCredential",WRn=ni(s7t);d();var ekn=ni("AuthorizationCodeCredential");d();var a7t="OnBehalfOfCredential",ukn=ni(a7t);d();var yO=new dt("capiFetchUtilities");function c7t(t){let e=t.getCopilotIntegrationId();if(e)return e;switch(t.getEditorPluginInfo().name){case"copilot-intellij":return"jetbrains-chat";case"copilot":case"copilot-vs":return;default:return"jetbrains-chat"}}s(c7t,"getIntegrationId");function dh(t){let e={...p0(t),"X-GitHub-Api-Version":NB},r=c7t(t.get(cn));return r&&(e["Copilot-Integration-Id"]=r),e}s(dh,"getCapiHeaders");function zye(t,e){return yO.debug(t,"Using CES proxy mode for msbench"),{...e,"ces-proxy-target":$_.api,"Copilot-Integration-Id":"autodev-test"}}s(zye,"addMsBenchCesProxyHeaders");async function Kye(t,e){yO.debug(t,"Using HMAC authentication mode for msbench");let r=await y6e(process.env.HMAC_SECRET);return{...e,...r}}s(Kye,"addMsBenchHmacHeaders");function lWe(){return Pv()&&!!process.env.HMAC_SECRET}s(lWe,"isMsBenchHmacModeEnabled");function AO(){return Pv()&&!process.env.HMAC_SECRET}s(AO,"isMsBenchCesProxyModeEnabled");async function BB(t,e){return process.env.HMAC_SECRET?await Kye(t,e):zye(t,e)}s(BB,"addMsBenchHeaders");function VK(t,e,...r){if(AO()){yO.debug(t,"Using CES proxy endpoint for URL generation");let n=r.join("/");return n.startsWith("/")&&(n=n.slice(1)),`https://ces-dev1.azurewebsites.net/api/proxy/${n}`}return qm(t,e,"api",...r)}s(VK,"getCapiUrl");async function aR(t,e,r){r??=await t.get(ar).getToken();let n=VK(t,r,e),i=r.token;AO()&&(yO.debug(t,"Using CES proxy authentication token for fetchCapiUrl"),i=await dWe());let o={Authorization:`Bearer ${i}`,...dh(t)},a=lWe()?await Kye(t,o):AO()?zye(t,o):o;return await t.get(Or).fetch(new URL(n).href,{method:"GET",headers:a})}s(aR,"fetchCapiUrl");async function uWe(t,e,r){let n=await t.get(ar).getToken(),i=VK(t,n,e),o=n.token;AO()&&(yO.debug(t,"Using CES proxy authentication token for postCapiUrl"),o=await dWe());let a={Authorization:`Bearer ${o}`,...dh(t)},c=lWe()?await Kye(t,a):AO()?zye(t,a):a;return await t.get(Or).fetch(new URL(i).href,{method:"POST",headers:c,body:r})}s(uWe,"postCapiUrl");async function dWe(){let e=await new DB().getToken("api://17b0ad65-ed36-4194-bb27-059c567bc41f/.default");if(!e)throw new Error("Failed to retrieve access token");return e.token}s(dWe,"getMsBenchToken");d();var fWe=600*1e3,$r={Gpt35turbo:"gpt-3.5-turbo",Gpt4:"gpt-4",Gpt4turbo:"gpt-4-turbo",Gpt4o:"gpt-4o",Gpt4oMini:"gpt-4o-mini",O1Mini:"o1-mini",O1Ga:"o1-ga",Claude35Sonnet:"claude-3.5-sonnet",O3Mini:"o3-mini",Gemini20Flash:"gemini-2.0-flash",Gemini20Pro:"gemini-2.0-pro",Claude37Sonnet:"claude-3.7-sonnet",Claude37SonnetThought:"claude-3.7-sonnet-thought",Gpt45:"gpt-4.5",Gpt41:"gpt-4.1",Gpt5:"gpt-5",CopilotBase:"copilot-base",BYOK:"byok",Unknown:"unknown"},pWe=new Set([$r.O1Ga,$r.O3Mini,$r.O1Mini,$r.Gemini20Pro,$r.Gemini20Flash]);function Ep(t){switch(t){case"edits":case"user":case"inline":return[$r.Gpt4o,$r.Gpt4turbo,$r.Gpt4,$r.O1Mini,$r.O1Ga,$r.Claude35Sonnet,$r.O3Mini,$r.Gemini20Flash,$r.Claude37Sonnet,$r.Claude37SonnetThought,$r.Gpt45,$r.Gpt41,$r.CopilotBase];case"meta":case"suggestions":case"synonyms":return[$r.Gpt4oMini,$r.Gpt4o,$r.Gpt35turbo,$r.Gpt41,$r.CopilotBase];case"gitCommit":return[$r.Gpt4oMini,$r.Gpt4o,$r.Gpt4,$r.Gpt41,$r.CopilotBase];case"codeReview":return[$r.Gpt4,$r.Gpt4o,$r.Gpt41,$r.CopilotBase];case"nesStubs":return[$r.Gpt4oMini,$r.Gpt4o,$r.Gpt41,$r.CopilotBase]}}s(Ep,"getSupportedModelFamiliesForPrompt");var YK={textEmbedding3Small:"text-embedding-3-small"},l7t=x.Object({type:x.Union([x.Literal("chat"),x.Literal("embeddings"),x.Literal("completion")]),tokenizer:x.String(),family:x.String(),object:x.String(),supports:x.Optional(x.Object({tool_calls:x.Optional(x.Boolean()),parallel_tool_calls:x.Optional(x.Boolean()),streaming:x.Optional(x.Boolean()),vision:x.Optional(x.Boolean())})),limits:x.Optional(x.Object({max_inputs:x.Optional(x.Number()),max_prompt_tokens:x.Optional(x.Number()),max_output_tokens:x.Optional(x.Number()),max_context_window_tokens:x.Optional(x.Number())}))}),u7t=x.Object({id:x.String(),name:x.String(),version:x.String(),model_picker_enabled:x.Boolean(),is_chat_default:x.Optional(x.Boolean()),is_chat_fallback:x.Optional(x.Boolean()),capabilities:l7t,billing:x.Optional(x.Object({is_premium:x.Optional(x.Boolean()),multiplier:x.Optional(x.Number())})),object:x.String(),preview:x.Optional(x.Boolean()),isExperimental:x.Optional(x.Boolean()),policy:x.Optional(x.Object({state:x.String(),terms:x.String()}))}),mWe=x.Object({data:x.Array(u7t)}),If=class{static{s(this,"ModelMetadataProvider")}},zK=class extends If{constructor(r){super();this.ctx=r;this._metadata=[];this._lastFetchTime=0;this.allowTokenRefresh=s(()=>{this._lastFetchTime=0},"allowTokenRefresh");r.get(ar).onDidResetToken(this.allowTokenRefresh)}static{s(this,"CapiModelMetadataProvider")}async getMetadata(){return this.shouldRefreshModels()&&await this.fetchMetadata(),this._metadata.slice()}async getFallbackModel(){return(await this.getMetadata()).find(n=>n.is_chat_fallback)}async fetchMetadata(){let r=await aR(this.ctx,"/models");if(r.status<200||r.status>=300){if(r.status===429&&this._metadata.length>0){dn.error(this.ctx,"Rate limited while fetching models from CAPI",{status:r.status,statusText:r.statusText});return}throw dn.error(this.ctx,"Failed to fetch models from CAPI",{status:r.status,statusText:r.statusText}),new iC(r)}await this.processModels(r)}async fetchModel(r){let n=await aR(this.ctx,`/models/${r}`);if(!n.ok){dn.error(this.ctx,`Failed to fetch model ${r} from CAPI`,{status:n.status,statusText:n.statusText});return}return await n.json()}async acceptModelPolicy(r){return(await uWe(this.ctx,`/models/${r}/policy`,JSON.stringify({status:"enabled"}))).ok?(await this.fetchMetadata(),!0):!1}async processModels(r){try{let n=await r.json();this._metadata=n.data,this._lastFetchTime=Date.now()}catch(n){dn.error(this.ctx,"Failed to parse models from CAPI",{error:n})}}shouldRefreshModels(){return this._metadata.length===0||!this._lastFetchTime?!0:this.isLastFetchOlderTenMinutes()}isLastFetchOlderTenMinutes(){return Date.now()-this._lastFetchTime>fWe}},KK=class extends If{constructor(r,n){super();this.ctx=r;this.delegate=n;this._exp_models_cache=new Map}static{s(this,"ExpModelMetadataProvider")}async getMetadata(){let r=this.ctx.get(Mt),n=await r.fetchTokenAndUpdateExPValuesAndAssignments(),i=r.ideChatExpModelIds(n),o=[];if(i){let a=i?.split(",");for(let c of a){let l=await this.fetchModel(c.trim());l!==void 0&&(l.isExperimental=!0,o.push(l))}}return o.concat(await this.delegate.getMetadata())}async fetchModel(r){let n=this._exp_models_cache.get(r);if(n){let[o,a]=n;if(Date.now()-a<fWe)return o}let i=await this.delegate.fetchModel(r);if(i)return this._exp_models_cache.set(r,[i,Date.now()]),i}async acceptModelPolicy(r){return await this.delegate.acceptModelPolicy(r)}async getFallbackModel(){return await this.delegate.getFallbackModel()}};d();function hWe(t){let e=zi(t,Ht.UserSelectedCompletionModel);return typeof e=="string"&&e.length>0?e:null}s(hWe,"getUserSelectedModelConfiguration");d();d();d();var MB=class extends Error{constructor(r,n){super(r,{cause:n});this.code="CopilotPromptLoadFailure"}static{s(this,"CopilotPromptLoadFailure")}};d();var gWe=Be(require("node:fs/promises")),JK=Be(require("node:path"));async function XK(t){return await gWe.readFile(Yye(t))}s(XK,"readFile");function Yye(t){return JK.default.resolve(JK.default.extname(__filename)!==".ts"?__dirname:JK.default.resolve(__dirname,"../../dist"),t)}s(Yye,"locateFile");var LB=Be(kWe());var iY=new Map;function Li(t="o200k_base"){let e=iY.get(t);return e!==void 0||(e=iY.get("o200k_base"),e!==void 0)?e:new vT}s(Li,"getTokenizer");async function DWe(t="o200k_base"){return await cR,Li(t)}s(DWe,"getTokenizerAsync");async function w7t(t){if(!t.endsWith(".tiktoken.noindex"))throw new Error("File does not end with .tiktoken.noindex");let e=await XK(t),r=new Map,n=[];for(let i=0;i<e.length;i++){if(e[i]!==255||n.length===0){n.push(e[i]);continue}r.set(Uint8Array.from(n),r.size),n=[]}return r.set(Uint8Array.from(n),r.size),r}s(w7t,"parseTikTokenNoIndex");var aCe=class t{constructor(e){this._tokenizer=e}static{s(this,"TTokenizer")}static async create(e){try{let r=(0,LB.createTokenizer)(await w7t(`resources/${e}.tiktoken.noindex`),(0,LB.getSpecialTokensByEncoder)(e),(0,LB.getRegexByEncoder)(e),32768);return new t(r)}catch(r){throw r instanceof Error?new MB("Could not load tokenizer",r):r}}tokenize(e){return this._tokenizer.encode(e)}detokenize(e){return this._tokenizer.decode(e)}tokenLength(e){return this.tokenize(e).length}tokenizeStrings(e){return this.tokenize(e).map(n=>this.detokenize([n]))}takeLastTokens(e,r){if(r<=0)return{text:"",tokens:[]};let n=4,i=1,o=Math.min(e.length,r*n),a=e.slice(-o),c=this.tokenize(a);for(;c.length<r+2&&o<e.length;)o=Math.min(e.length,o+r*i),a=e.slice(-o),c=this.tokenize(a);return c.length<r?{text:e,tokens:c}:(c=c.slice(-r),{text:this.detokenize(c),tokens:c})}takeFirstTokens(e,r){if(r<=0)return{text:"",tokens:[]};let n=4,i=1,o=Math.min(e.length,r*n),a=e.slice(0,o),c=this.tokenize(a);for(;c.length<r+2&&o<e.length;)o=Math.min(e.length,o+r*i),a=e.slice(0,o),c=this.tokenize(a);return c.length<r?{text:e,tokens:c}:(c=c.slice(0,r),{text:this.detokenize(c),tokens:c})}takeLastLinesTokens(e,r){let{text:n}=this.takeLastTokens(e,r);if(n.length===e.length||e[e.length-n.length-1]===`
`)return n;let i=n.indexOf(`
`);return n.substring(i+1)}},cCe=class{constructor(){this.hash=s(e=>{let r=0;for(let n=0;n<e.length;n++){let i=e.charCodeAt(n);r=(r<<5)-r+i,r&=r&65535}return r},"hash")}static{s(this,"MockTokenizer")}tokenize(e){return this.tokenizeStrings(e).map(this.hash)}detokenize(e){return e.map(r=>r.toString()).join(" ")}tokenizeStrings(e){return e.split(/\b/)}tokenLength(e){return this.tokenizeStrings(e).length}takeLastTokens(e,r){let n=this.tokenizeStrings(e).slice(-r);return{text:n.join(""),tokens:n.map(this.hash)}}takeFirstTokens(e,r){let n=this.tokenizeStrings(e).slice(0,r);return{text:n.join(""),tokens:n.map(this.hash)}}takeLastLinesTokens(e,r){let{text:n}=this.takeLastTokens(e,r);if(n.length===e.length||e[e.length-n.length-1]===`
`)return n;let i=n.indexOf(`
`);return n.substring(i+1)}},S7t={cl100k_base:{python:3.99,typescript:4.54,typescriptreact:4.58,javascript:4.76,csharp:5.13,java:4.86,cpp:3.85,php:4.1,html:4.57,vue:4.22,go:3.93,dart:5.66,javascriptreact:4.81,css:3.37},o200k_base:{python:4.05,typescript:4.12,typescriptreact:5.01,javascript:4.47,csharp:5.47,java:4.86,cpp:3.8,php:4.35,html:4.86,vue:4.3,go:4.21,dart:5.7,javascriptreact:4.83,css:3.33}},sCe=4,vT=class{constructor(e="o200k_base",r){this.languageId=r;this.tokenizerName=e}static{s(this,"ApproximateTokenizer")}tokenize(e){return this.tokenizeStrings(e).map(r=>{let n=0;for(let i=0;i<r.length;i++)n=n*Math.pow(10,sCe)+r.charCodeAt(i);return n})}detokenize(e){return e.map(r=>{let n=[],i=r.toString();for(;i.length>0;){let o=i.slice(-sCe),a=String.fromCharCode(parseInt(o));n.unshift(a),i=i.slice(0,-sCe)}return n.join("")}).join("")}tokenizeStrings(e){return e.match(/.{1,4}/g)??[]}getEffectiveTokenLength(){return this.tokenizerName&&this.languageId?S7t[this.tokenizerName]?.[this.languageId]??4:4}tokenLength(e){return Math.ceil(e.length/this.getEffectiveTokenLength())}takeLastTokens(e,r){if(r<=0)return{text:"",tokens:[]};let n=e.slice(-Math.floor(r*this.getEffectiveTokenLength()));return{text:n,tokens:Array.from({length:this.tokenLength(n)},(i,o)=>o)}}takeFirstTokens(e,r){if(r<=0)return{text:"",tokens:[]};let n=e.slice(0,Math.floor(r*this.getEffectiveTokenLength()));return{text:n,tokens:Array.from({length:this.tokenLength(n)},(i,o)=>o)}}takeLastLinesTokens(e,r){let{text:n}=this.takeLastTokens(e,r);if(n.length===e.length||e[e.length-n.length-1]===`
`)return n;let i=n.indexOf(`
`);return n.substring(i+1)}};async function PWe(t){try{let e=await aCe.create(t);iY.set(t,e)}catch{}}s(PWe,"setTokenizer");var cR=(async()=>{iY.set("mock",new cCe),await Promise.all([PWe("cl100k_base"),PWe("o200k_base")])})();d();d();var _7t=function(t,e,r,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!i:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(t,r):i?i.value=r:e.set(t,r),r},NWe=function(t,e,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(t):n?n.value:e.get(t)},lCe,oY,MWe,uCe=class extends Bn{static{s(this,"AssertError")}constructor(e){let r=e.First();super(r===void 0?"Invalid Value":r.message),lCe.add(this),oY.set(this,void 0),_7t(this,oY,e,"f"),this.error=r}Errors(){return new RI(NWe(this,lCe,"m",MWe).call(this))}};oY=new WeakMap,lCe=new WeakSet,MWe=s(function*(){this.error&&(yield this.error),yield*NWe(this,oY,"f")},"_AssertError_Iterator");function BWe(t,e,r){if(!Di(t,e,r))throw new uCe(fC(t,e,r))}s(BWe,"AssertValue");function sY(...t){return t.length===3?BWe(t[0],t[1],t[2]):BWe(t[0],[],t[1])}s(sY,"Assert");d();d();d();function R7t(t){let e={};for(let r of Object.getOwnPropertyNames(t))e[r]=Ro(t[r]);for(let r of Object.getOwnPropertySymbols(t))e[r]=Ro(t[r]);return e}s(R7t,"FromObject");function k7t(t){return t.map(e=>Ro(e))}s(k7t,"FromArray");function P7t(t){return t.slice()}s(P7t,"FromTypedArray");function D7t(t){return new Map(Ro([...t.entries()]))}s(D7t,"FromMap");function B7t(t){return new Set(Ro([...t.entries()]))}s(B7t,"FromSet");function N7t(t){return new Date(t.toISOString())}s(N7t,"FromDate");function Ro(t){if(Dn(t))return k7t(t);if(ff(t))return N7t(t);if($m(t))return P7t(t);if(tNe(t))return D7t(t);if(rNe(t))return B7t(t);if(_i(t))return R7t(t);if(h0(t))return t;throw new Error("ValueClone: Unable to clone value")}s(Ro,"Clone");var Q0=class extends Bn{static{s(this,"ValueCreateError")}constructor(e,r){super(r),this.schema=e}};function ko(t){return vI(t)?t():Ro(t)}s(ko,"FromDefault");function M7t(t,e){return Pn(t,"default")?ko(t.default):{}}s(M7t,"FromAny");function L7t(t,e){return{}}s(L7t,"FromArgument");function F7t(t,e){if(t.uniqueItems===!0&&!Pn(t,"default"))throw new Q0(t,"Array with the uniqueItems constraint requires a default value");if("contains"in t&&!Pn(t,"default"))throw new Q0(t,"Array with the contains constraint requires a default value");return"default"in t?ko(t.default):t.minItems!==void 0?Array.from({length:t.minItems}).map(r=>bp(t.items,e)):[]}s(F7t,"FromArray");function O7t(t,e){return Pn(t,"default")?ko(t.default):async function*(){}()}s(O7t,"FromAsyncIterator");function Q7t(t,e){return Pn(t,"default")?ko(t.default):BigInt(0)}s(Q7t,"FromBigInt");function U7t(t,e){return Pn(t,"default")?ko(t.default):!1}s(U7t,"FromBoolean");function q7t(t,e){if(Pn(t,"default"))return ko(t.default);{let r=bp(t.returns,e);return typeof r=="object"&&!Array.isArray(r)?class{constructor(){for(let[n,i]of Object.entries(r)){let o=this;o[n]=i}}}:class{}}}s(q7t,"FromConstructor");function H7t(t,e){return Pn(t,"default")?ko(t.default):t.minimumTimestamp!==void 0?new Date(t.minimumTimestamp):new Date}s(H7t,"FromDate");function $7t(t,e){return Pn(t,"default")?ko(t.default):()=>bp(t.returns,e)}s($7t,"FromFunction");function W7t(t,e){let r=globalThis.Object.values(t.$defs),n=t.$defs[t.$ref];return bp(n,[...e,...r])}s(W7t,"FromImport");function j7t(t,e){return Pn(t,"default")?ko(t.default):t.minimum!==void 0?t.minimum:0}s(j7t,"FromInteger");function G7t(t,e){if(Pn(t,"default"))return ko(t.default);{let r=t.allOf.reduce((n,i)=>{let o=bp(i,e);return typeof o=="object"?{...n,...o}:o},{});if(!Di(t,e,r))throw new Q0(t,"Intersect produced invalid value. Consider using a default value.");return r}}s(G7t,"FromIntersect");function V7t(t,e){return Pn(t,"default")?ko(t.default):function*(){}()}s(V7t,"FromIterator");function z7t(t,e){return Pn(t,"default")?ko(t.default):t.const}s(z7t,"FromLiteral");function K7t(t,e){if(Pn(t,"default"))return ko(t.default);throw new Q0(t,"Never types cannot be created. Consider using a default value.")}s(K7t,"FromNever");function Y7t(t,e){if(Pn(t,"default"))return ko(t.default);throw new Q0(t,"Not types must have a default value")}s(Y7t,"FromNot");function J7t(t,e){return Pn(t,"default")?ko(t.default):null}s(J7t,"FromNull");function X7t(t,e){return Pn(t,"default")?ko(t.default):t.minimum!==void 0?t.minimum:0}s(X7t,"FromNumber");function Z7t(t,e){if(Pn(t,"default"))return ko(t.default);{let r=new Set(t.required),n={};for(let[i,o]of Object.entries(t.properties))r.has(i)&&(n[i]=bp(o,e));return n}}s(Z7t,"FromObject");function eQt(t,e){return Pn(t,"default")?ko(t.default):Promise.resolve(bp(t.item,e))}s(eQt,"FromPromise");function tQt(t,e){let[r,n]=Object.entries(t.patternProperties)[0];if(Pn(t,"default"))return ko(t.default);if(r===lC||r===cC)return{};{let i=r.slice(1,r.length-1).split("|"),o={};for(let a of i)o[a]=bp(n,e);return o}}s(tQt,"FromRecord");function rQt(t,e){return Pn(t,"default")?ko(t.default):bp(So(t,e),e)}s(rQt,"FromRef");function nQt(t,e){if(Pn(t,"default"))return ko(t.default);throw new Q0(t,"RegExp types cannot be created. Consider using a default value.")}s(nQt,"FromRegExp");function iQt(t,e){if(t.pattern!==void 0){if(Pn(t,"default"))return ko(t.default);throw new Q0(t,"String types with patterns must specify a default value")}else if(t.format!==void 0){if(Pn(t,"default"))return ko(t.default);throw new Q0(t,"String types with formats must specify a default value")}else return Pn(t,"default")?ko(t.default):t.minLength!==void 0?Array.from({length:t.minLength}).map(()=>" ").join(""):""}s(iQt,"FromString");function oQt(t,e){return Pn(t,"default")?ko(t.default):"value"in t?Symbol.for(t.value):Symbol()}s(oQt,"FromSymbol");function sQt(t,e){if(Pn(t,"default"))return ko(t.default);if(!$j(t))throw new Q0(t,"Can only create template literals that produce a finite variants. Consider using a default value.");return z4(t)[0]}s(sQt,"FromTemplateLiteral");function aQt(t,e){if(LWe++>hQt)throw new Q0(t,"Cannot create recursive type as it appears possibly infinite. Consider using a default.");return Pn(t,"default")?ko(t.default):bp(So(t,e),e)}s(aQt,"FromThis");function cQt(t,e){return Pn(t,"default")?ko(t.default):t.items===void 0?[]:Array.from({length:t.minItems}).map((r,n)=>bp(t.items[n],e))}s(cQt,"FromTuple");function lQt(t,e){if(Pn(t,"default"))return ko(t.default)}s(lQt,"FromUndefined");function uQt(t,e){if(Pn(t,"default"))return ko(t.default);if(t.anyOf.length===0)throw new Error("ValueCreate.Union: Cannot create Union with zero variants");return bp(t.anyOf[0],e)}s(uQt,"FromUnion");function dQt(t,e){return Pn(t,"default")?ko(t.default):t.minByteLength!==void 0?new Uint8Array(t.minByteLength):new Uint8Array(0)}s(dQt,"FromUint8Array");function fQt(t,e){return Pn(t,"default")?ko(t.default):{}}s(fQt,"FromUnknown");function pQt(t,e){if(Pn(t,"default"))return ko(t.default)}s(pQt,"FromVoid");function mQt(t,e){if(Pn(t,"default"))return ko(t.default);throw new Error("User defined types must specify a default value")}s(mQt,"FromKind");function bp(t,e){let r=Zl(t,e),n=t;switch(n[ot]){case"Any":return M7t(n,r);case"Argument":return L7t(n,r);case"Array":return F7t(n,r);case"AsyncIterator":return O7t(n,r);case"BigInt":return Q7t(n,r);case"Boolean":return U7t(n,r);case"Constructor":return q7t(n,r);case"Date":return H7t(n,r);case"Function":return $7t(n,r);case"Import":return W7t(n,r);case"Integer":return j7t(n,r);case"Intersect":return G7t(n,r);case"Iterator":return V7t(n,r);case"Literal":return z7t(n,r);case"Never":return K7t(n,r);case"Not":return Y7t(n,r);case"Null":return J7t(n,r);case"Number":return X7t(n,r);case"Object":return Z7t(n,r);case"Promise":return eQt(n,r);case"Record":return tQt(n,r);case"Ref":return rQt(n,r);case"RegExp":return nQt(n,r);case"String":return iQt(n,r);case"Symbol":return oQt(n,r);case"TemplateLiteral":return sQt(n,r);case"This":return aQt(n,r);case"Tuple":return cQt(n,r);case"Undefined":return lQt(n,r);case"Union":return uQt(n,r);case"Uint8Array":return dQt(n,r);case"Unknown":return fQt(n,r);case"Void":return pQt(n,r);default:if(!pf.Has(n[ot]))throw new Q0(n,"Unknown type");return mQt(n,r)}}s(bp,"Visit");var hQt=512,LWe=0;function fh(...t){return LWe=0,t.length===2?bp(t[0],t[1]):bp(t[0],[])}s(fh,"Create");var aY=class extends Bn{static{s(this,"ValueCastError")}constructor(e,r){super(r),this.schema=e}};function gQt(t,e,r){if(t[ot]==="Object"&&typeof r=="object"&&!Mv(r)){let n=t,i=Object.getOwnPropertyNames(r),o=Object.entries(n.properties),[a,c]=[1/o.length,o.length];return o.reduce((l,[u,f])=>{let p=f[ot]==="Literal"&&f.const===r[u]?c:0,m=Di(f,e,r[u])?a:0,h=i.includes(u)?a:0;return l+(p+m+h)},0)}else return Di(t,e,r)?1:0}s(gQt,"ScoreUnion");function AQt(t,e,r){let n=t.anyOf.map(a=>So(a,e)),[i,o]=[n[0],0];for(let a of n){let c=gQt(a,e,r);c>o&&(i=a,o=c)}return i}s(AQt,"SelectUnion");function yQt(t,e,r){if("default"in t)return typeof r=="function"?t.default:Ro(t.default);{let n=AQt(t,e,r);return vO(n,e,r)}}s(yQt,"CastUnion");function CQt(t,e,r){return Di(t,e,r)?Ro(r):fh(t,e)}s(CQt,"DefaultClone");function vQt(t,e,r){return Di(t,e,r)?r:fh(t,e)}s(vQt,"Default");function xQt(t,e,r){if(Di(t,e,r))return Ro(r);let n=Dn(r)?Ro(r):fh(t,e),i=ln(t.minItems)&&n.length<t.minItems?[...n,...Array.from({length:t.minItems-n.length},()=>null)]:n,a=(ln(t.maxItems)&&i.length>t.maxItems?i.slice(0,t.maxItems):i).map(l=>vA(t.items,e,l));if(t.uniqueItems!==!0)return a;let c=[...new Set(a)];if(!Di(t,e,c))throw new aY(t,"Array cast produced invalid data due to uniqueItems constraint");return c}s(xQt,"FromArray");function EQt(t,e,r){if(Di(t,e,r))return fh(t,e);let n=new Set(t.returns.required||[]),i=s(function(){},"result");for(let[o,a]of Object.entries(t.returns.properties))!n.has(o)&&r.prototype[o]===void 0||(i.prototype[o]=vA(a,e,r.prototype[o]));return i}s(EQt,"FromConstructor");function bQt(t,e,r){let n=globalThis.Object.values(t.$defs),i=t.$defs[t.$ref];return vA(i,[...e,...n],r)}s(bQt,"FromImport");function IQt(t,e,r){let n=fh(t,e),i=_i(n)&&_i(r)?{...n,...r}:r;return Di(t,e,i)?i:fh(t,e)}s(IQt,"FromIntersect");function TQt(t,e,r){throw new aY(t,"Never types cannot be cast")}s(TQt,"FromNever");function wQt(t,e,r){if(Di(t,e,r))return r;if(r===null||typeof r!="object")return fh(t,e);let n=new Set(t.required||[]),i={};for(let[o,a]of Object.entries(t.properties))!n.has(o)&&r[o]===void 0||(i[o]=vA(a,e,r[o]));if(typeof t.additionalProperties=="object"){let o=Object.getOwnPropertyNames(t.properties);for(let a of Object.getOwnPropertyNames(r))o.includes(a)||(i[a]=vA(t.additionalProperties,e,r[a]))}return i}s(wQt,"FromObject");function SQt(t,e,r){if(Di(t,e,r))return Ro(r);if(r===null||typeof r!="object"||Array.isArray(r)||r instanceof Date)return fh(t,e);let n=Object.getOwnPropertyNames(t.patternProperties)[0],i=t.patternProperties[n],o={};for(let[a,c]of Object.entries(r))o[a]=vA(i,e,c);return o}s(SQt,"FromRecord");function _Qt(t,e,r){return vA(So(t,e),e,r)}s(_Qt,"FromRef");function RQt(t,e,r){return vA(So(t,e),e,r)}s(RQt,"FromThis");function kQt(t,e,r){return Di(t,e,r)?Ro(r):Dn(r)?t.items===void 0?[]:t.items.map((n,i)=>vA(n,e,r[i])):fh(t,e)}s(kQt,"FromTuple");function PQt(t,e,r){return Di(t,e,r)?Ro(r):yQt(t,e,r)}s(PQt,"FromUnion");function vA(t,e,r){let n=Co(t.$id)?Zl(t,e):e,i=t;switch(t[ot]){case"Array":return xQt(i,n,r);case"Constructor":return EQt(i,n,r);case"Import":return bQt(i,n,r);case"Intersect":return IQt(i,n,r);case"Never":return TQt(i,n,r);case"Object":return wQt(i,n,r);case"Record":return SQt(i,n,r);case"Ref":return _Qt(i,n,r);case"This":return RQt(i,n,r);case"Tuple":return kQt(i,n,r);case"Union":return PQt(i,n,r);case"Date":case"Symbol":case"Uint8Array":return CQt(t,e,r);default:return vQt(i,n,r)}}s(vA,"Visit");function vO(...t){return t.length===3?vA(t[0],t[1],t[2]):vA(t[0],[],t[1])}s(vO,"Cast");d();function DQt(t){return EI(t)&&t[ot]!=="Unsafe"}s(DQt,"IsCheckable");function BQt(t,e,r){return Dn(r)?r.map(n=>Ip(t.items,e,n)):r}s(BQt,"FromArray");function NQt(t,e,r){let n=globalThis.Object.values(t.$defs),i=t.$defs[t.$ref];return Ip(i,[...e,...n],r)}s(NQt,"FromImport");function MQt(t,e,r){let n=t.unevaluatedProperties,o=t.allOf.map(c=>Ip(c,e,Ro(r))).reduce((c,l)=>_i(l)?{...c,...l}:l,{});if(!_i(r)||!_i(o)||!EI(n))return o;let a=sp(t);for(let c of Object.getOwnPropertyNames(r))a.includes(c)||Di(n,e,r[c])&&(o[c]=Ip(n,e,r[c]));return o}s(MQt,"FromIntersect");function LQt(t,e,r){if(!_i(r)||Dn(r))return r;let n=t.additionalProperties;for(let i of Object.getOwnPropertyNames(r)){if(Pn(t.properties,i)){r[i]=Ip(t.properties[i],e,r[i]);continue}if(EI(n)&&Di(n,e,r[i])){r[i]=Ip(n,e,r[i]);continue}delete r[i]}return r}s(LQt,"FromObject");function FQt(t,e,r){if(!_i(r))return r;let n=t.additionalProperties,i=Object.getOwnPropertyNames(r),[o,a]=Object.entries(t.patternProperties)[0],c=new RegExp(o);for(let l of i){if(c.test(l)){r[l]=Ip(a,e,r[l]);continue}if(EI(n)&&Di(n,e,r[l])){r[l]=Ip(n,e,r[l]);continue}delete r[l]}return r}s(FQt,"FromRecord");function OQt(t,e,r){return Ip(So(t,e),e,r)}s(OQt,"FromRef");function QQt(t,e,r){return Ip(So(t,e),e,r)}s(QQt,"FromThis");function UQt(t,e,r){if(!Dn(r))return r;if(Xs(t.items))return[];let n=Math.min(r.length,t.items.length);for(let i=0;i<n;i++)r[i]=Ip(t.items[i],e,r[i]);return r.length>n?r.slice(0,n):r}s(UQt,"FromTuple");function qQt(t,e,r){for(let n of t.anyOf)if(DQt(n)&&Di(n,e,r))return Ip(n,e,r);return r}s(qQt,"FromUnion");function Ip(t,e,r){let n=Co(t.$id)?Zl(t,e):e,i=t;switch(i[ot]){case"Array":return BQt(i,n,r);case"Import":return NQt(i,n,r);case"Intersect":return MQt(i,n,r);case"Object":return LQt(i,n,r);case"Record":return FQt(i,n,r);case"Ref":return OQt(i,n,r);case"This":return QQt(i,n,r);case"Tuple":return UQt(i,n,r);case"Union":return qQt(i,n,r);default:return r}}s(Ip,"Visit");function cY(...t){return t.length===3?Ip(t[0],t[1],t[2]):Ip(t[0],[],t[1])}s(cY,"Clean");d();function lY(t){return Co(t)&&!isNaN(t)&&!isNaN(parseFloat(t))}s(lY,"IsStringNumeric");function HQt(t){return Qu(t)||aC(t)||ln(t)}s(HQt,"IsValueToString");function xO(t){return t===!0||ln(t)&&t===1||Qu(t)&&t===BigInt("1")||Co(t)&&(t.toLowerCase()==="true"||t==="1")}s(xO,"IsValueTrue");function EO(t){return t===!1||ln(t)&&(t===0||Object.is(t,-0))||Qu(t)&&t===BigInt("0")||Co(t)&&(t.toLowerCase()==="false"||t==="0"||t==="-0")}s(EO,"IsValueFalse");function $Qt(t){return Co(t)&&/^(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)$/i.test(t)}s($Qt,"IsTimeStringWithTimeZone");function WQt(t){return Co(t)&&/^(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)?$/i.test(t)}s(WQt,"IsTimeStringWithoutTimeZone");function jQt(t){return Co(t)&&/^\d\d\d\d-[0-1]\d-[0-3]\dt(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)$/i.test(t)}s(jQt,"IsDateTimeStringWithTimeZone");function GQt(t){return Co(t)&&/^\d\d\d\d-[0-1]\d-[0-3]\dt(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)?$/i.test(t)}s(GQt,"IsDateTimeStringWithoutTimeZone");function VQt(t){return Co(t)&&/^\d\d\d\d-[0-1]\d-[0-3]\d$/i.test(t)}s(VQt,"IsDateString");function zQt(t,e){let r=OWe(t);return r===e?r:t}s(zQt,"TryConvertLiteralString");function KQt(t,e){let r=QWe(t);return r===e?r:t}s(KQt,"TryConvertLiteralNumber");function YQt(t,e){let r=FWe(t);return r===e?r:t}s(YQt,"TryConvertLiteralBoolean");function JQt(t,e){return Co(t.const)?zQt(e,t.const):ln(t.const)?KQt(e,t.const):aC(t.const)?YQt(e,t.const):e}s(JQt,"TryConvertLiteral");function FWe(t){return xO(t)?!0:EO(t)?!1:t}s(FWe,"TryConvertBoolean");function XQt(t){let e=s(r=>r.split(".")[0],"truncateInteger");return lY(t)?BigInt(e(t)):ln(t)?BigInt(Math.trunc(t)):EO(t)?BigInt(0):xO(t)?BigInt(1):t}s(XQt,"TryConvertBigInt");function OWe(t){return Lv(t)&&t.description!==void 0?t.description.toString():HQt(t)?t.toString():t}s(OWe,"TryConvertString");function QWe(t){return lY(t)?parseFloat(t):xO(t)?1:EO(t)?0:t}s(QWe,"TryConvertNumber");function ZQt(t){return lY(t)?parseInt(t):ln(t)?Math.trunc(t):xO(t)?1:EO(t)?0:t}s(ZQt,"TryConvertInteger");function eUt(t){return Co(t)&&t.toLowerCase()==="null"?null:t}s(eUt,"TryConvertNull");function tUt(t){return Co(t)&&t==="undefined"?void 0:t}s(tUt,"TryConvertUndefined");function rUt(t){return ff(t)?t:ln(t)?new Date(t):xO(t)?new Date(1):EO(t)?new Date(0):lY(t)?new Date(parseInt(t)):WQt(t)?new Date(`1970-01-01T${t}.000Z`):$Qt(t)?new Date(`1970-01-01T${t}`):GQt(t)?new Date(`${t}.000Z`):jQt(t)?new Date(t):VQt(t)?new Date(`${t}T00:00:00.000Z`):t}s(rUt,"TryConvertDate");function nUt(t,e,r){return(Dn(r)?r:[r]).map(i=>xA(t.items,e,i))}s(nUt,"FromArray");function iUt(t,e,r){return XQt(r)}s(iUt,"FromBigInt");function oUt(t,e,r){return FWe(r)}s(oUt,"FromBoolean");function sUt(t,e,r){return rUt(r)}s(sUt,"FromDate");function aUt(t,e,r){let n=globalThis.Object.values(t.$defs),i=t.$defs[t.$ref];return xA(i,[...e,...n],r)}s(aUt,"FromImport");function cUt(t,e,r){return ZQt(r)}s(cUt,"FromInteger");function lUt(t,e,r){return t.allOf.reduce((n,i)=>xA(i,e,n),r)}s(lUt,"FromIntersect");function uUt(t,e,r){return JQt(t,r)}s(uUt,"FromLiteral");function dUt(t,e,r){return eUt(r)}s(dUt,"FromNull");function fUt(t,e,r){return QWe(r)}s(fUt,"FromNumber");function pUt(t,e,r){if(!_i(r))return r;for(let n of Object.getOwnPropertyNames(t.properties))Pn(r,n)&&(r[n]=xA(t.properties[n],e,r[n]));return r}s(pUt,"FromObject");function mUt(t,e,r){if(!_i(r))return r;let i=Object.getOwnPropertyNames(t.patternProperties)[0],o=t.patternProperties[i];for(let[a,c]of Object.entries(r))r[a]=xA(o,e,c);return r}s(mUt,"FromRecord");function hUt(t,e,r){return xA(So(t,e),e,r)}s(hUt,"FromRef");function gUt(t,e,r){return OWe(r)}s(gUt,"FromString");function AUt(t,e,r){return Co(r)||ln(r)?Symbol(r):r}s(AUt,"FromSymbol");function yUt(t,e,r){return xA(So(t,e),e,r)}s(yUt,"FromThis");function CUt(t,e,r){return Dn(r)&&!Xs(t.items)?r.map((i,o)=>o<t.items.length?xA(t.items[o],e,i):i):r}s(CUt,"FromTuple");function vUt(t,e,r){return tUt(r)}s(vUt,"FromUndefined");function xUt(t,e,r){for(let n of t.anyOf){let i=xA(n,e,Ro(r));if(Di(n,e,i))return i}return r}s(xUt,"FromUnion");function xA(t,e,r){let n=Zl(t,e),i=t;switch(t[ot]){case"Array":return nUt(i,n,r);case"BigInt":return iUt(i,n,r);case"Boolean":return oUt(i,n,r);case"Date":return sUt(i,n,r);case"Import":return aUt(i,n,r);case"Integer":return cUt(i,n,r);case"Intersect":return lUt(i,n,r);case"Literal":return uUt(i,n,r);case"Null":return dUt(i,n,r);case"Number":return fUt(i,n,r);case"Object":return pUt(i,n,r);case"Record":return mUt(i,n,r);case"Ref":return hUt(i,n,r);case"String":return gUt(i,n,r);case"Symbol":return AUt(i,n,r);case"This":return yUt(i,n,r);case"Tuple":return CUt(i,n,r);case"Undefined":return vUt(i,n,r);case"Union":return xUt(i,n,r);default:return r}}s(xA,"Visit");function uY(...t){return t.length===3?xA(t[0],t[1],t[2]):xA(t[0],[],t[1])}s(uY,"Convert");d();function UWe(...t){let[e,r,n]=t.length===3?[t[0],t[1],t[2]]:[t[0],[],t[1]];if(!Di(e,r,n))throw new aD(e,n,fC(e,r,n).First());return jv(e,r)?cD(e,r,n):n}s(UWe,"Decode");d();function gx(t,e){let r=Pn(t,"default")?t.default:void 0,n=vI(r)?r():Ro(r);return Xs(e)?n:_i(e)&&_i(n)?Object.assign(n,e):e}s(gx,"ValueOrDefault");function dCe(t){return EI(t)&&"default"in t}s(dCe,"HasDefaultProperty");function EUt(t,e,r){if(Dn(r)){for(let i=0;i<r.length;i++)r[i]=wf(t.items,e,r[i]);return r}let n=gx(t,r);if(!Dn(n))return n;for(let i=0;i<n.length;i++)n[i]=wf(t.items,e,n[i]);return n}s(EUt,"FromArray");function bUt(t,e,r){return ff(r)?r:gx(t,r)}s(bUt,"FromDate");function IUt(t,e,r){let n=globalThis.Object.values(t.$defs),i=t.$defs[t.$ref];return wf(i,[...e,...n],r)}s(IUt,"FromImport");function TUt(t,e,r){let n=gx(t,r);return t.allOf.reduce((i,o)=>{let a=wf(o,e,n);return _i(a)?{...i,...a}:a},{})}s(TUt,"FromIntersect");function wUt(t,e,r){let n=gx(t,r);if(!_i(n))return n;let i=Object.getOwnPropertyNames(t.properties);for(let o of i){let a=wf(t.properties[o],e,n[o]);Xs(a)||(n[o]=wf(t.properties[o],e,n[o]))}if(!dCe(t.additionalProperties))return n;for(let o of Object.getOwnPropertyNames(n))i.includes(o)||(n[o]=wf(t.additionalProperties,e,n[o]));return n}s(wUt,"FromObject");function SUt(t,e,r){let n=gx(t,r);if(!_i(n))return n;let i=t.additionalProperties,[o,a]=Object.entries(t.patternProperties)[0],c=new RegExp(o);for(let l of Object.getOwnPropertyNames(n))c.test(l)&&dCe(a)&&(n[l]=wf(a,e,n[l]));if(!dCe(i))return n;for(let l of Object.getOwnPropertyNames(n))c.test(l)||(n[l]=wf(i,e,n[l]));return n}s(SUt,"FromRecord");function _Ut(t,e,r){return wf(So(t,e),e,gx(t,r))}s(_Ut,"FromRef");function RUt(t,e,r){return wf(So(t,e),e,r)}s(RUt,"FromThis");function kUt(t,e,r){let n=gx(t,r);if(!Dn(n)||Xs(t.items))return n;let[i,o]=[t.items,Math.max(t.items.length,n.length)];for(let a=0;a<o;a++)a<i.length&&(n[a]=wf(i[a],e,n[a]));return n}s(kUt,"FromTuple");function PUt(t,e,r){let n=gx(t,r);for(let i of t.anyOf){let o=wf(i,e,Ro(n));if(Di(i,e,o))return o}return n}s(PUt,"FromUnion");function wf(t,e,r){let n=Zl(t,e),i=t;switch(i[ot]){case"Array":return EUt(i,n,r);case"Date":return bUt(i,n,r);case"Import":return IUt(i,n,r);case"Intersect":return TUt(i,n,r);case"Object":return wUt(i,n,r);case"Record":return SUt(i,n,r);case"Ref":return _Ut(i,n,r);case"This":return RUt(i,n,r);case"Tuple":return kUt(i,n,r);case"Union":return PUt(i,n,r);default:return gx(i,r)}}s(wf,"Visit");function dY(...t){return t.length===3?wf(t[0],t[1],t[2]):wf(t[0],[],t[1])}s(dY,"Default");d();d();var EA={};Ia(EA,{Delete:()=>BUt,Format:()=>bO,Get:()=>MUt,Has:()=>NUt,Set:()=>DUt,ValuePointerRootDeleteError:()=>pY,ValuePointerRootSetError:()=>fY});d();var fY=class extends Bn{static{s(this,"ValuePointerRootSetError")}constructor(e,r,n){super("Cannot set root value"),this.value=e,this.path=r,this.update=n}},pY=class extends Bn{static{s(this,"ValuePointerRootDeleteError")}constructor(e,r){super("Cannot delete root value"),this.value=e,this.path=r}};function qWe(t){return t.indexOf("~")===-1?t:t.replace(/~1/g,"/").replace(/~0/g,"~")}s(qWe,"Escape");function*bO(t){if(t==="")return;let[e,r]=[0,0];for(let n=0;n<t.length;n++)t.charAt(n)==="/"?(n===0||(r=n,yield qWe(t.slice(e,r))),e=n+1):r=n;yield qWe(t.slice(e))}s(bO,"Format");function DUt(t,e,r){if(e==="")throw new fY(t,e,r);let[n,i,o]=[null,t,""];for(let a of bO(e))i[a]===void 0&&(i[a]={}),n=i,i=i[a],o=a;n[o]=r}s(DUt,"Set");function BUt(t,e){if(e==="")throw new pY(t,e);let[r,n,i]=[null,t,""];for(let o of bO(e)){if(n[o]===void 0||n[o]===null)return;r=n,n=n[o],i=o}if(Array.isArray(r)){let o=parseInt(i);r.splice(o,1)}else delete r[i]}s(BUt,"Delete");function NUt(t,e){if(e==="")return!0;let[r,n,i]=[null,t,""];for(let o of bO(e)){if(n[o]===void 0)return!1;r=n,n=n[o],i=o}return Object.getOwnPropertyNames(r).includes(i)}s(NUt,"Has");function MUt(t,e){if(e==="")return t;let r=t;for(let n of bO(e)){if(r[n]===void 0)return;r=r[n]}return r}s(MUt,"Get");d();function LUt(t,e){if(!_i(e))return!1;let r=[...Object.keys(t),...Object.getOwnPropertySymbols(t)],n=[...Object.keys(e),...Object.getOwnPropertySymbols(e)];return r.length!==n.length?!1:r.every(i=>lR(t[i],e[i]))}s(LUt,"ObjectType");function FUt(t,e){return ff(e)&&t.getTime()===e.getTime()}s(FUt,"DateType");function OUt(t,e){return!Dn(e)||t.length!==e.length?!1:t.every((r,n)=>lR(r,e[n]))}s(OUt,"ArrayType");function QUt(t,e){return!$m(e)||t.length!==e.length||Object.getPrototypeOf(t).constructor.name!==Object.getPrototypeOf(e).constructor.name?!1:t.every((r,n)=>lR(r,e[n]))}s(QUt,"TypedArrayType");function UUt(t,e){return t===e}s(UUt,"ValueType");function lR(t,e){if(ff(t))return FUt(t,e);if($m(t))return QUt(t,e);if(Dn(t))return OUt(t,e);if(_i(t))return LUt(t,e);if(h0(t))return UUt(t,e);throw new Error("ValueEquals: Unable to compare value")}s(lR,"Equal");var qUt=Uo({type:co("insert"),path:mf(),value:iA()}),HUt=Uo({type:co("update"),path:mf(),value:iA()}),$Ut=Uo({type:co("delete"),path:mf()}),$We=Qo([qUt,HUt,$Ut]),mY=class extends Bn{static{s(this,"ValueDiffError")}constructor(e,r){super(r),this.value=e}};function hY(t,e){return{type:"update",path:t,value:e}}s(hY,"CreateUpdate");function WWe(t,e){return{type:"insert",path:t,value:e}}s(WWe,"CreateInsert");function jWe(t){return{type:"delete",path:t}}s(jWe,"CreateDelete");function HWe(t){if(globalThis.Object.getOwnPropertySymbols(t).length>0)throw new mY(t,"Cannot diff objects with symbols")}s(HWe,"AssertDiffable");function*WUt(t,e,r){if(HWe(e),HWe(r),!lpe(r))return yield hY(t,r);let n=globalThis.Object.getOwnPropertyNames(e),i=globalThis.Object.getOwnPropertyNames(r);for(let o of i)Pn(e,o)||(yield WWe(`${t}/${o}`,r[o]));for(let o of n)Pn(r,o)&&(lR(e,r)||(yield*gY(`${t}/${o}`,e[o],r[o])));for(let o of n)Pn(r,o)||(yield jWe(`${t}/${o}`))}s(WUt,"ObjectType");function*jUt(t,e,r){if(!Dn(r))return yield hY(t,r);for(let n=0;n<Math.min(e.length,r.length);n++)yield*gY(`${t}/${n}`,e[n],r[n]);for(let n=0;n<r.length;n++)n<e.length||(yield WWe(`${t}/${n}`,r[n]));for(let n=e.length-1;n>=0;n--)n<r.length||(yield jWe(`${t}/${n}`))}s(jUt,"ArrayType");function*GUt(t,e,r){if(!$m(r)||e.length!==r.length||globalThis.Object.getPrototypeOf(e).constructor.name!==globalThis.Object.getPrototypeOf(r).constructor.name)return yield hY(t,r);for(let n=0;n<Math.min(e.length,r.length);n++)yield*gY(`${t}/${n}`,e[n],r[n])}s(GUt,"TypedArrayType");function*VUt(t,e,r){e!==r&&(yield hY(t,r))}s(VUt,"ValueType");function*gY(t,e,r){if(lpe(e))return yield*WUt(t,e,r);if(Dn(e))return yield*jUt(t,e,r);if($m(e))return yield*GUt(t,e,r);if(h0(e))return yield*VUt(t,e,r);throw new mY(e,"Unable to diff value")}s(gY,"Visit");function GWe(t,e){return[...gY("",t,e)]}s(GWe,"Diff");function zUt(t){return t.length>0&&t[0].path===""&&t[0].type==="update"}s(zUt,"IsRootUpdate");function KUt(t){return t.length===0}s(KUt,"IsIdentity");function VWe(t,e){if(zUt(e))return Ro(e[0].value);if(KUt(e))return Ro(t);let r=Ro(t);for(let n of e)switch(n.type){case"insert":{EA.Set(r,n.path,n.value);break}case"update":{EA.Set(r,n.path,n.value);break}case"delete":{EA.Delete(r,n.path);break}}return r}s(VWe,"Patch");d();function zWe(...t){let[e,r,n]=t.length===3?[t[0],t[1],t[2]]:[t[0],[],t[1]],i=jv(e,r)?uD(e,r,n):n;if(!Di(e,r,i))throw new lD(e,i,fC(e,r,i).First());return i}s(zWe,"Encode");d();function AY(t){return _i(t)&&!Dn(t)}s(AY,"IsStandardObject");var yY=class extends Bn{static{s(this,"ValueMutateError")}constructor(e){super(e)}};function YUt(t,e,r,n){if(!AY(r))EA.Set(t,e,Ro(n));else{let i=Object.getOwnPropertyNames(r),o=Object.getOwnPropertyNames(n);for(let a of i)o.includes(a)||delete r[a];for(let a of o)i.includes(a)||(r[a]=null);for(let a of o)fCe(t,`${e}/${a}`,r[a],n[a])}}s(YUt,"ObjectType");function JUt(t,e,r,n){if(!Dn(r))EA.Set(t,e,Ro(n));else{for(let i=0;i<n.length;i++)fCe(t,`${e}/${i}`,r[i],n[i]);r.splice(n.length)}}s(JUt,"ArrayType");function XUt(t,e,r,n){if($m(r)&&r.length===n.length)for(let i=0;i<r.length;i++)r[i]=n[i];else EA.Set(t,e,Ro(n))}s(XUt,"TypedArrayType");function ZUt(t,e,r,n){r!==n&&EA.Set(t,e,n)}s(ZUt,"ValueType");function fCe(t,e,r,n){if(Dn(n))return JUt(t,e,r,n);if($m(n))return XUt(t,e,r,n);if(AY(n))return YUt(t,e,r,n);if(h0(n))return ZUt(t,e,r,n)}s(fCe,"Visit");function KWe(t){return $m(t)||h0(t)}s(KWe,"IsNonMutableValue");function eqt(t,e){return AY(t)&&Dn(e)||Dn(t)&&AY(e)}s(eqt,"IsMismatchedValue");function YWe(t,e){if(KWe(t)||KWe(e))throw new yY("Only object and array types can be mutated at the root level");if(eqt(t,e))throw new yY("Cannot assign due type mismatch of assignable values");fCe(t,"",t,e)}s(YWe,"Mutate");d();var CY=class extends Bn{static{s(this,"ParseError")}constructor(e){super(e)}},pCe;(function(t){let e=new Map([["Assert",(o,a,c)=>(sY(o,a,c),c)],["Cast",(o,a,c)=>vO(o,a,c)],["Clean",(o,a,c)=>cY(o,a,c)],["Clone",(o,a,c)=>Ro(c)],["Convert",(o,a,c)=>uY(o,a,c)],["Decode",(o,a,c)=>jv(o,a)?cD(o,a,c):c],["Default",(o,a,c)=>dY(o,a,c)],["Encode",(o,a,c)=>jv(o,a)?uD(o,a,c):c]]);function r(o){e.delete(o)}s(r,"Delete"),t.Delete=r;function n(o,a){e.set(o,a)}s(n,"Set"),t.Set=n;function i(o){return e.get(o)}s(i,"Get"),t.Get=i})(pCe||(pCe={}));var JWe=["Clone","Clean","Default","Convert","Assert","Decode"];function tqt(t,e,r,n){return t.reduce((i,o)=>{let a=pCe.Get(o);if(Xs(a))throw new CY(`Unable to find Parse operation '${o}'`);return a(e,r,i)},n)}s(tqt,"ParseValue");function XWe(...t){let[e,r,n,i]=t.length===4?[t[0],t[1],t[2],t[3]]:t.length===3?Dn(t[0])?[t[0],t[1],[],t[2]]:[JWe,t[0],t[1],t[2]]:t.length===2?[JWe,t[0],[],t[1]]:(()=>{throw new CY("Invalid Arguments")})();return tqt(e,r,n,i)}s(XWe,"Parse");d();var FC={};Ia(FC,{Assert:()=>sY,Cast:()=>vO,Check:()=>Di,Clean:()=>cY,Clone:()=>Ro,Convert:()=>uY,Create:()=>fh,Decode:()=>UWe,Default:()=>dY,Diff:()=>GWe,Edit:()=>$We,Encode:()=>zWe,Equal:()=>lR,Errors:()=>fC,Hash:()=>_I,Mutate:()=>YWe,Parse:()=>XWe,Patch:()=>VWe,ValueErrorIterator:()=>RI});d();var rqt="gpt-4o-copilot",ph=class t{constructor(e,r=!0){this._ctx=e;this.onModelsFetchedCallbacks=[];this.fetchedModelData=[];this.customModels=[];this.editorPreviewFeaturesDisabled=!1;r&&_a(this._ctx,n=>this.refreshAvailableModels(n))}static{s(this,"AvailableModelsManager")}async refreshAvailableModels(e){await this.refreshModels(e);for(let r of this.onModelsFetchedCallbacks)r()}addHandler(e){this.onModelsFetchedCallbacks.push(e)}getDefaultModelId(){if(this.fetchedModelData){let e=t.filterCompletionModels(this.fetchedModelData,this.editorPreviewFeaturesDisabled)[0];if(e)return e.id}return rqt}parseModelsResponse(e){try{return FC.Parse(mWe,e)}catch(r){dn.exception(this._ctx,r,"Failed to parse /models response from CAPI");return}}async refreshModels(e){let r=await this.fetchModels(e);r&&(this.fetchedModelData=r)}async fetchModels(e){return this.customModels=e.getTokenValue("cml")?.split(",")??[],this.editorPreviewFeaturesDisabled=e.getTokenValue("editor_preview_features")=="0",await this.fetch(e)}async fetch(e){let r=await aR(this._ctx,"/models",e);return r.ok?this.parseModelsResponse(await r.json())?.data??[]:(dn.error(this._ctx,"Failed to fetch models from CAPI",{status:r.status,statusText:r.statusText}),null)}getGenericCompletionModels(){let e=t.filterCompletionModels(this.fetchedModelData,this.editorPreviewFeaturesDisabled);return t.mapCompletionModels(e)}getTokenizerForModel(e){let n=this.getGenericCompletionModels().find(i=>i.modelId===e);return n?n.tokenizer:"o200k_base"}static filterCompletionModels(e,r){return e.filter(n=>n.capabilities.type==="completion").filter(n=>!r||n.preview===!1||n.preview===void 0)}static filterModelsWithEditorPreviewFeatures(e,r){return e.filter(n=>!r||n.preview===!1||n.preview===void 0)}static mapCompletionModels(e){return e.map(r=>({modelId:r.id,label:r.name,preview:!!r.preview,tokenizer:r.capabilities.tokenizer}))}getCurrentModelRequestInfo(e=void 0){let r=this.getDefaultModelId(),n=hWe(this._ctx);if(n){let c=this.getGenericCompletionModels().map(l=>l.modelId);c.includes(n)||(c.length>0&&dn.error(this._ctx,`User selected model ${n} is not in the list of generic models: ${c.join(", ")}, falling back to default model.`),n=null),r===n&&(n=null)}let i=zi(this._ctx,Ht.DebugOverrideEngine)||zi(this._ctx,Ht.DebugOverrideEngineLegacy);if(i)return new xT(i,"override");let o=e?this._ctx.get(Mt).customEngine(e):"",a=e?this._ctx.get(Mt).customEngineTargetEngine(e):void 0;return n?o&&a&&n===a?new xT(o,"exp"):new xT(n,"modelpicker"):o?new xT(o,"exp"):this.customModels.length>0?new xT(this.customModels[0],"custommodel"):new xT(r,"default")}},xT=class{constructor(e,r){this.modelId=e;this.modelChoiceSource=r}static{s(this,"ModelRequestInfo")}get headers(){return{}}};function ET(t,e=void 0){let r=t.get(ph),n=r.getCurrentModelRequestInfo(e),i=r.getTokenizerForModel(n.modelId);return{headers:n.headers,modelId:n.modelId,engineChoiceSource:n.modelChoiceSource,tokenizer:i}}s(ET,"getEngineRequestInfo");d();d();var Fi=class{static{s(this,"FileSystem")}};var gje=Be(hje());function Aje(t){return t!==void 0&&t!==0}s(Aje,"isRepoInfo");function yje(t){if(t===void 0||t===0)return"";let e=Ax(t);if(e==="github/github")return e;let r=_qt(t)?.toLowerCase();return r!==void 0?r:""}s(yje,"getDogFood");function Ax(t){if(t!==void 0&&t!==0&&t.hostname==="github.com")return t.owner+"/"+t.repo}s(Ax,"tryGetGitHubNWO");function _qt(t){if(t!==void 0&&t!==0&&(t.hostname.endsWith("azure.com")||t.hostname.endsWith("visualstudio.com")))return t.owner+"/"+t.repo}s(_qt,"tryGetADONWO");function bT(t,e){let r=wd(e);return Rqt(t,r)}s(bT,"extractRepoInfoInBackground");var Rqt=Bqt(kqt,1e4);async function kqt(t,e){let r=U3e(e);if(!r)return;let n=await Pqt(t,r);if(!n)return;let i=t.get(Fi),o=Vi(n,".git","config"),a;try{a=await i.readFileString(o)}catch{return}let c=Dqt(a)??"",l=ACe(c),u={uri:n};return l===void 0?{baseFolder:u,url:c,hostname:"",owner:"",repo:"",pathname:""}:{baseFolder:u,url:c,...l}}s(kqt,"extractRepoInfo");function ACe(t){let e;try{if(e=(0,gje.default)(t),e.resource==""||e.owner==""||e.name==""||e.pathname=="")return}catch{return}return{hostname:e.resource,owner:e.owner,repo:e.name,pathname:e.pathname}}s(ACe,"parseRepoUrl");async function Pqt(t,e){let r=e+"_add_to_make_longer",n=t.get(Fi);for(;e!=="file:///"&&e.length<r.length;){let i=Vi(e,".git","config"),o=!1;try{await n.stat(i),o=!0}catch{o=!1}if(o)return e;r=e,e=wd(e)}}s(Pqt,"getRepoBaseUri");function Dqt(t){let e=/^\s*\[\s*remote\s+"((\\\\|\\"|[^\\"])+)"/,r=/^\s*\[remote.([^"\s]+)/,n=/^\s*url\s*=\s*([^\s#;]+)/,i=/^\s*\[/,o,a,c=!1;for(let l of t.split(`
`))if(c&&o!==void 0){if(o+=l,l.endsWith("\\"))o=o.substring(0,o.length-1);else if(c=!1,a==="origin")return o}else{let u=l.match(e)??l.match(r);if(u)a=u[1];else if(l.match(i))a=void 0;else{if(o&&a!=="origin")continue;{let f=l.match(n);if(f){if(o=f[1],o.endsWith("\\"))o=o.substring(0,o.length-1),c=!0;else if(a==="origin")return o}}}}return o}s(Dqt,"getRepoUrlFromConfigText");var gCe=class{static{s(this,"CompletedComputation")}constructor(e){this.result=e}};function Bqt(t,e){let r=new Sr(e),n=new Set;return(i,...o)=>{let a=JSON.stringify(o),c=r.get(a);if(c)return c.result;if(n.has(a))return 0;let l=t(i,...o);return n.add(a),l.then(u=>{r.set(a,new gCe(u)),n.delete(a)}),0}}s(Bqt,"computeInBackgroundAndMemoize");d();var IO=500,Cje=8192-IO,vje=4,vY=10,xje=1e3*5,xY={prefix:35,suffix:15,stableContext:35,volatileContext:15},Nqt={javascriptreact:"javascript",jsx:"javascript",typescriptreact:"typescript",jade:"pug",cshtml:"razor",c:"cpp"};function TO(t){return t=t.toLowerCase(),Nqt[t]??t}s(TO,"normalizeLanguageId");var yCe=class{constructor(e){this.ctx=e;this.cache=new Sr(200)}static{s(this,"FilterSettingsToExpConfigs")}async fetchExpConfig(e,r){let n=e.stringify()+`
`+JSON.stringify(r),i=this.cache.get(n);return i||(i=new CCe(()=>this.ctx.get(pA).fetchExperiments(this.ctx,r,e.toHeaders()),1e3*60*60),this.cache.set(n,i)),i.run()}getCachedExpConfig(e){return this.cache.get(e.stringify())?.value()}},CCe=class{constructor(e,r=1/0){this.producer=e;this.expirationMs=r}static{s(this,"Task")}async run(){return this.promise===void 0&&(this.promise=this.producer(),this.storeResult(this.promise).then(()=>{this.expirationMs<1/0&&this.promise!==void 0&&setTimeout(()=>this.promise=void 0,this.expirationMs)})),this.promise}async storeResult(e){try{this.result=await e}finally{this.result===void 0&&(this.promise=void 0)}}value(){return this.result}};function Lqt(t){return"uri"in t}s(Lqt,"isCompletionsFiltersInfo");var Mt=class t{constructor(e){this.ctx=e;this.staticFilters={};this.dynamicFilters={};this.dynamicFilterGroups=[];this.upcomingDynamicFilters={};this.assignments=new yCe(this.ctx)}static{s(this,"Features")}static{this.upcomingDynamicFilterCheckDelayMs=20}static{this.upcomingTimeBucketMinutes=5+Math.floor(Math.random()*11)}registerStaticFilters(e){Object.assign(this.staticFilters,e)}registerDynamicFilter(e,r){this.dynamicFilters[e]=r}registerDynamicFilterGroup(e){this.dynamicFilterGroups.push(e)}getDynamicFilterValues(){let e={};for(let r of this.dynamicFilterGroups)Object.assign(e,r());for(let[r,n]of Object.entries(this.dynamicFilters))e[r]=n();return e}registerUpcomingDynamicFilter(e,r){this.upcomingDynamicFilters[e]=r}async updateExPValuesAndAssignments(e,r,n=Vr.createAndMarkAsIssued()){if(n instanceof gC)throw new Error("updateExPValuesAndAssignments should not be called with TelemetryWithExp");let i=r&&Lqt(r)?bT(this.ctx,r.uri):void 0,o=Ax(i)??"",a=yje(i)??"",c=r?.languageId??"",l=ET(this.ctx).modelId,u=bBe(e),f=e.getTokenValue("ft")??"",p=e.getTokenValue("ol")??"",m=e.getTokenValue("cml")??"",h=e.getTokenValue("tid")??"",g=e.endpoints,A={"X-Copilot-Repository":o,"X-Copilot-FileType":c,"X-Copilot-UserKind":u,"X-Copilot-Dogfood":a,"X-Copilot-Engine":l,"X-Copilot-CustomModel":f,"X-Copilot-Orgs":p,"X-Copilot-CustomModelNames":m,"X-Copilot-CopilotTrackingId":h},y=this.getGranularityDirectory(),E=this.makeFilterSettings(A),b=y.extendFilters(E),S=await this.getExpConfig(b.newFilterSettings,g);y.update(E,+(S.variables.copilotbycallbuckets??NaN),+(S.variables.copilottimeperiodsizeinh??NaN));let R=y.extendFilters(E),B=R.newFilterSettings,L=await this.getExpConfig(B,g),O=new Promise(Y=>setTimeout(Y,t.upcomingDynamicFilterCheckDelayMs));for(let Y of R.otherFilterSettingsToPrefetch)O=O.then(async()=>{await new Promise(V=>setTimeout(V,t.upcomingDynamicFilterCheckDelayMs)),this.getExpConfig(Y,g)});return this.prepareForUpcomingFilters(B,g),new gC(n.properties,n.measurements,n.issuedTime,{filters:B,exp:L})}async fetchTokenAndUpdateExPValuesAndAssignments(e,r){let n=await this.ctx.get(ar).getToken();return await this.updateExPValuesAndAssignments(n,e,r)}getGranularityDirectory(){if(!this.granularityDirectory){let e=this.ctx.get(Ms).machineId;this.granularityDirectory=new cV(e,this.ctx.get(yC))}return this.granularityDirectory}makeFilterSettings(e){return new W_({...this.staticFilters,...this.getDynamicFilterValues(),...e})}async getExpConfig(e,r){try{return this.assignments.fetchExpConfig(e,r)}catch(n){return Hm.createFallbackConfig(this.ctx,`Error fetching ExP config: ${String(n)}`)}}async prepareForUpcomingFilters(e,r){if(!(new Date().getMinutes()<60-t.upcomingTimeBucketMinutes))for(let[n,i]of Object.entries(this.upcomingDynamicFilters))await new Promise(o=>setTimeout(o,t.upcomingDynamicFilterCheckDelayMs)),this.getExpConfig(e.withChange(n,i()),r)}stringify(){let e=this.assignments.getCachedExpConfig(new W_({}));return JSON.stringify(e?.variables??{})}async getFallbackExpAndFilters(){let e=this.makeFilterSettings({}),r=L4(this.ctx),n=await this.getExpConfig(e,r);return{filters:e,exp:n}}disableLogProb(e){return e.filtersAndExp.exp.variables.copilotdisablelogprob??!0}overrideBlockMode(e){return e.filtersAndExp.exp.variables.copilotoverrideblockmode||void 0}customEngine(e){return e.filtersAndExp.exp.variables.copilotcustomengine??""}customEngineTargetEngine(e){return e.filtersAndExp.exp.variables.copilotcustomenginetargetengine}suffixPercent(e){return e.filtersAndExp.exp.variables.CopilotSuffixPercent??xY.suffix}suffixMatchThreshold(e){return e.filtersAndExp.exp.variables.copilotsuffixmatchthreshold??vY}cppHeadersEnableSwitch(e){return e.filtersAndExp.exp.variables.copilotcppheadersenableswitch??!1}relatedFilesVSCodeCSharp(e){return e.filtersAndExp.exp.variables.copilotrelatedfilesvscodecsharp??!1}relatedFilesVSCodeTypeScript(e){return e.filtersAndExp.exp.variables.copilotrelatedfilesvscodetypescript??!1}relatedFilesVSCode(e){return e.filtersAndExp.exp.variables.copilotrelatedfilesvscode??!1}contextProviders(e){let r=e.filtersAndExp.exp.variables.copilotcontextproviders??"";return r?r.split(",").map(n=>n.trim()):[]}contextProviderTimeBudget(e){return e.filtersAndExp.exp.variables.copilotcontextprovidertimebudget??150}includeNeighboringFiles(e){return e.filtersAndExp.exp.variables.copilotincludeneighboringfiles??!1}excludeRelatedFiles(e){return e.filtersAndExp.exp.variables.copilotexcluderelatedfiles??!1}maxPromptCompletionTokens(e){return e.filtersAndExp.exp.variables.maxpromptcompletionTokens??Cje+IO}ideChatMaxRequestTokens(e){return e.filtersAndExp.exp.variables.idechatmaxrequesttokens??-1}ideChatExpModelIds(e){return e.filtersAndExp.exp.variables.idechatexpmodelids??""}ideChatEnableProjectMetadata(e){return e.filtersAndExp.exp.variables.idechatenableprojectmetadata??!1}workspaceContextCoordinator(e){return e.filtersAndExp.exp.variables.copilotworkspacecontextcoordinator??!1}workspaceContextCacheTime(e){return e.filtersAndExp.exp.variables.copilotworkspacecontextcachetime??xje}stableContextPercent(e){return e.filtersAndExp.exp.variables.copilotstablecontextpercent??xY.stableContext}volatileContextPercent(e){return e.filtersAndExp.exp.variables.copilotvolatilecontextpercent??xY.volatileContext}cppContextProviderParams(e){return e.filtersAndExp.exp.variables.copilotcppContextProviderParams}csharpContextProviderParams(e){return e.filtersAndExp.exp.variables.copilotcsharpcontextproviderparams}javaContextProviderParams(e){return e.filtersAndExp.exp.variables.copilotjavacontextproviderparams}multiLanguageContextProviderParams(e){return e.filtersAndExp.exp.variables.copilotmultilanguagecontextproviderparams}tsContextProviderParams(e){return e.filtersAndExp.exp.variables.copilottscontextproviderparams}completionsDebounce(e){return e.filtersAndExp.exp.variables.copilotcompletionsdebounce}enableElectronFetcher(e){return e.filtersAndExp.exp.variables.copilotelectronfetcher??!1}asyncCompletionsTimeout(e){return e.filtersAndExp.exp.variables.copilotasynccompletionstimeout??200}enablePromptContextProxyField(e){return e.filtersAndExp.exp.variables.copilotenablepromptcontextproxyfield??!1}enableProgressiveReveal(e){return e.filtersAndExp.exp.variables.copilotprogressivereveal??!1}modelAlwaysTerminatesSingleline(e){return e.filtersAndExp.exp.variables.copilotmodelterminatesingleline??!0}longLookaheadSize(e){return e.filtersAndExp.exp.variables.copilotprogressivereveallonglookaheadsize??9}shortLookaheadSize(e){return e.filtersAndExp.exp.variables.copilotprogressiverevealshortlookaheadsize??3}maxMultilineTokens(e){return e.filtersAndExp.exp.variables.copilotmaxmultilinetokens??200}multilineAfterAcceptLines(e){return e.filtersAndExp.exp.variables.copilotmultilineafteracceptlines??1}enableNESXTab(e){return e.filtersAndExp.exp.variables.copilotnesxtab??!1}getNESXTabModelID(e){return e.filtersAndExp.exp.variables.copilotnesxtabmodelid??"copilot-nes-xtab"}completionsDelay(e){return e.filtersAndExp.exp.variables.copilotcompletionsdelay??200}singleLineUnlessAccepted(e){return e.filtersAndExp.exp.variables.copilotsinglelineunlessaccepted??!1}};d();d();d();var EY=Be(Eje());var xCe={python:"python",javascript:"javascript",javascriptreact:"javascript",jsx:"javascript",typescript:"typescript",typescriptreact:"tsx",go:"go",ruby:"ruby",csharp:"c_sharp",java:"java",php:"php",c:"cpp",cpp:"cpp"};function U0(t){return t in xCe&&t!=="csharp"&&t!=="java"&&t!=="php"&&t!=="c"&&t!=="cpp"}s(U0,"isSupportedLanguageId");function bY(t){if(!(t in xCe))throw new Error(`Unrecognized language: ${t}`);return xCe[t]}s(bY,"languageIdToWasmLanguage");var vCe=new Map;async function Fqt(t){let e;try{e=await XK(`tree-sitter-${t}.wasm`)}catch(r){throw r instanceof Error&&"code"in r&&typeof r.code=="string"&&r.name==="Error"?new MB(`Could not load tree-sitter-${t}.wasm`,r):r}return EY.default.Language.load(e)}s(Fqt,"loadWasmLanguage");function Oqt(t){let e=bY(t);if(!vCe.has(e)){let r=Fqt(e);vCe.set(e,r)}return vCe.get(e)}s(Oqt,"getLanguage");var ECe=class extends Error{static{s(this,"WrappedError")}constructor(e,r){super(e,{cause:r})}};async function yx(t,e){await EY.default.init({locateFile:s(o=>Yye(o),"locateFile")});let r;try{r=new EY.default}catch(o){throw o&&typeof o=="object"&&"message"in o&&typeof o.message=="string"&&o.message.includes("table index is out of bounds")?new ECe(`Could not init Parse for language <${t}>`,o):o}let n=await Oqt(t);r.setLanguage(n);let i=r.parse(e);return r.delete(),i}s(yx,"parseTreeSitter");function bje(t){switch(bY(t)){case"python":return null;case"javascript":case"typescript":case"tsx":case"go":case"c_sharp":case"java":case"php":case"cpp":return"}";case"ruby":return"end"}}s(bje,"getBlockCloseToken");function Qqt(t,e){let r=[];for(let n of t){if(!n[1]){let i=e.tree.getLanguage();n[1]=i.query(n[0])}r.push(...n[1].matches(e))}return r}s(Qqt,"innerQuery");var Uqt=[`[
    (class_definition (block (expression_statement (string))))
    (function_definition (block (expression_statement (string))))
]`];function Ije(t){return Qqt([Uqt],t).length==1}s(Ije,"queryPythonIsDocstring");var QC=class{constructor(e){this.node=e;this.children=[];this.collapsed=!1}static{s(this,"StatementNode")}addChild(e){e.parent=this,e.nextSibling=void 0,this.children.length>0&&(this.children[this.children.length-1].nextSibling=e),this.children.push(e)}childrenFinished(){}containsStatement(e){return this.node.startIndex<=e.node.startIndex&&this.node.endIndex>=e.node.endIndex}statementAt(e){if(this.node.startIndex>e||this.node.endIndex<e)return;let r;return this.children.find(n=>(r=n.statementAt(e),r!==void 0)),r??this}collapse(){this.children.length=0,this.collapsed=!0}get description(){return`${this.node.type} ([${this.node.startPosition.row},${this.node.startPosition.column}]..[${this.node.endPosition.row},${this.node.endPosition.column}]): ${JSON.stringify(this.node.text.length>33?this.node.text.substring(0,15)+"..."+this.node.text.slice(-15):this.node.text)}`}dump(e="",r=""){let n=[`${e}${this.description}`];return this.children.forEach(i=>{n.push(i.dump(`${r}+- `,i.nextSibling===void 0?`${r}   `:`${r}|  `))}),n.join(`
`)}dumpPath(e="",r="",n=!1){if(this.parent){let i=this.parent.dumpPath(e,r,!0),o=i.length-i.lastIndexOf(`
`)-1-r.length,a=" ".repeat(o),c=n?`
${r}${a}+- `:"";return i+this.description+c}else{let i=n?`
${r}+- `:"";return e+this.description+i}}},Zu=class{constructor(e,r,n,i){this.languageId=e;this.text=r;this.startOffset=n;this.endOffset=i;this.statements=[]}static{s(this,"StatementTree")}static isSupported(e){return FB.languageIds.has(e)||wO.languageIds.has(e)||OB.languageIds.has(e)||SO.languageIds.has(e)||_O.languageIds.has(e)||RO.languageIds.has(e)||kO.languageIds.has(e)||PO.languageIds.has(e)}static isTrimmedByDefault(e){return FB.languageIds.has(e)||OB.languageIds.has(e)}static create(e,r,n,i){if(FB.languageIds.has(e))return new FB(e,r,n,i);if(wO.languageIds.has(e))return new wO(e,r,n,i);if(OB.languageIds.has(e))return new OB(e,r,n,i);if(RO.languageIds.has(e))return new RO(e,r,n,i);if(SO.languageIds.has(e))return new SO(e,r,n,i);if(_O.languageIds.has(e))return new _O(e,r,n,i);if(kO.languageIds.has(e))return new kO(e,r,n,i);if(PO.languageIds.has(e))return new PO(e,r,n,i);throw new Error(`Unsupported languageId: ${e}`)}[Symbol.dispose](){this.tree&&(this.tree.delete(),this.tree=void 0)}clear(){this.statements.length=0}statementAt(e){let r;return this.statements.find(n=>(r=n.statementAt(e),r!==void 0)),r}async build(){let e=[];this.clear();let r=await this.parse();this.getStatementQuery(r).captures(r.rootNode,this.offsetToPosition(this.startOffset),this.offsetToPosition(this.endOffset)).forEach(i=>{let o=this.createNode(i.node);for(;e.length>0&&!e[0].containsStatement(o);)e.shift()?.childrenFinished();e.length>0?e[0].addChild(o):this.addStatement(o),e.unshift(o)}),e.forEach(i=>i.childrenFinished())}addStatement(e){e.parent=void 0,e.nextSibling=void 0,this.statements.length>0&&(this.statements[this.statements.length-1].nextSibling=e),this.statements.push(e)}async parse(){return this.tree||(this.tree=await yx(this.languageId,this.text)),this.tree}getStatementQuery(e){return this.getQuery(e.getLanguage(),this.getStatementQueryText())}getQuery(e,r){return e.query(r)}offsetToPosition(e){let r=this.text.slice(0,e).split(`
`),n=r.length-1,i=r[r.length-1].length;return{row:n,column:i}}dump(e=""){let r=[];return this.statements.forEach((n,i)=>{let o=`[${i}]`,a=" ".repeat(o.length);r.push(n.dump(`${e} ${o} `,`${e} ${a} `))}),r.join(`
`)}},bCe=class t extends QC{static{s(this,"JSStatementNode")}static{this.compoundTypeNames=new Set(["function_declaration","generator_function_declaration","class_declaration","statement_block","if_statement","switch_statement","for_statement","for_in_statement","while_statement","do_statement","try_statement","with_statement","labeled_statement","method_definition","interface_declaration"])}get isCompoundStatementType(){return!this.collapsed&&t.compoundTypeNames.has(this.node.type)}childrenFinished(){this.isSingleLineIfStatement()&&this.collapse()}isSingleLineIfStatement(){return this.node.type!=="if_statement"||this.node.startPosition.row!==this.node.endPosition.row?!1:this.children.length===1&&this.children[0].node.type!=="statement_block"||this.children.length===2&&this.node.childForFieldName("else")!==null&&this.children[0].node.type!=="statement_block"&&this.children[1].node.type!=="statement_block"}},FB=class extends Zu{static{s(this,"JSStatementTree")}static{this.languageIds=new Set(["javascript","javascriptreact","jsx","typescript","typescriptreact"])}createNode(e){return new bCe(e)}getStatementQueryText(){return`[
            (export_statement)
            (import_statement)
            (debugger_statement)
            (expression_statement)
            (declaration)
            (statement_block)
            (if_statement)
            (switch_statement)
            (for_statement)
            (for_in_statement)
            (while_statement)
            (do_statement)
            (try_statement)
            (with_statement)
            (break_statement)
            (continue_statement)
            (return_statement)
            (throw_statement)
            (empty_statement)
            (labeled_statement)
            (method_definition)
            (public_field_definition)
        ] @statement`}},ICe=class t extends QC{static{s(this,"PyStatementNode")}static{this.compoundTypeNames=new Set(["if_statement","for_statement","while_statement","try_statement","with_statement","function_definition","class_definition","decorated_definition","match_statement","block"])}get isCompoundStatementType(){return!this.collapsed&&t.compoundTypeNames.has(this.node.type)}childrenFinished(){this.isSingleLineIfStatement()&&this.collapse()}isSingleLineIfStatement(){return this.node.type!=="if_statement"?!1:this.node.startPosition.row===this.node.endPosition.row}},wO=class extends Zu{static{s(this,"PyStatementTree")}static{this.languageIds=new Set(["python"])}createNode(e){return new ICe(e)}getStatementQueryText(){return`[
            (future_import_statement)
            (import_statement)
            (import_from_statement)
            (print_statement)
            (assert_statement)
            (expression_statement)
            (return_statement)
            (delete_statement)
            (raise_statement)
            (pass_statement)
            (break_statement)
            (continue_statement)
            (global_statement)
            (nonlocal_statement)
            (exec_statement)
            (if_statement)
            (for_statement)
            (while_statement)
            (try_statement)
            (with_statement)
            (function_definition)
            (class_definition)
            (decorated_definition)
            (match_statement)
            (block)
        ] @statement`}},TCe=class t extends QC{static{s(this,"GoStatementNode")}static{this.compoundTypeNames=new Set(["function_declaration","method_declaration","if_statement","for_statement","expression_switch_statement","type_switch_statement","select_statement","block"])}get isCompoundStatementType(){return!this.collapsed&&t.compoundTypeNames.has(this.node.type)}},OB=class extends Zu{static{s(this,"GoStatementTree")}static{this.languageIds=new Set(["go"])}createNode(e){return new TCe(e)}getStatementQueryText(){return`[
            (package_clause)
            (function_declaration)
            (method_declaration)
            (import_declaration)
            (_statement)
            (block)
        ] @statement`}},wCe=class t extends QC{static{s(this,"PhpStatementNode")}static{this.compoundTypeNames=new Set(["if_statement","else_clause","else_if_clause","for_statement","foreach_statement","while_statement","do_statement","switch_statement","try_statement","catch_clause","finally_clause","anonymous_function","compound_statement"])}get isCompoundStatementType(){return!this.collapsed&&t.compoundTypeNames.has(this.node.type)}},SO=class extends Zu{static{s(this,"PhpStatementTree")}static{this.languageIds=new Set(["php"])}createNode(e){return new wCe(e)}getStatementQueryText(){return`[
            (statement)
            (compound_statement)
            (method_declaration)
            (property_declaration)
            (const_declaration)
            (use_declaration)
        ] @statement`}},SCe=class t extends QC{static{s(this,"RubyStatementNode")}static{this.compoundTypeNames=new Set(["if","case","while","until","for","begin","module","class","method"])}get isCompoundStatementType(){return!this.collapsed&&t.compoundTypeNames.has(this.node.type)}},_O=class extends Zu{static{s(this,"RubyStatementTree")}static{this.languageIds=new Set(["ruby"])}createNode(e){return new SCe(e)}getStatementQueryText(){return`[
            (_statement)
            (when)
        ] @statement`}},_Ce=class t extends QC{static{s(this,"JavaStatementNode")}static{this.compoundTypeNames=new Set(["block","do_statement","enhanced_for_statement","for_statement","if_statement","labeled_statement","switch_expression","synchronized_statement","try_statement","try_with_resources_statement","while_statement","interface_declaration","method_declaration","constructor_declaration","compact_constructor_declaration","class_declaration","annotation_type_declaration","static_initializer"])}get isCompoundStatementType(){return!this.collapsed&&t.compoundTypeNames.has(this.node.type)}childrenFinished(){this.isSingleLineIfStatement()&&this.collapse()}isSingleLineIfStatement(){return this.node.type!=="if_statement"||this.node.startPosition.row!==this.node.endPosition.row?!1:this.children.length===1&&this.children[0].node.type!=="block"}},RO=class extends Zu{static{s(this,"JavaStatementTree")}static{this.languageIds=new Set(["java"])}createNode(e){return new _Ce(e)}getStatementQueryText(){return`[
            (statement)
            (field_declaration)
            (record_declaration)
            (method_declaration)
            (compact_constructor_declaration)
            (class_declaration)
            (interface_declaration)
            (annotation_type_declaration)
            (enum_declaration)
            (block)
            (static_initializer)
            (constructor_declaration)
            ] @statement`}},RCe=class t extends QC{static{s(this,"CSharpStatementNode")}static{this.compoundTypeNames=new Set(["block","checked_statement","class_declaration","constructor_declaration","destructor_declaration","do_statement","fixed_statement","for_statement","foreach_statement","if_statement","interface_declaration","lock_statement","method_declaration","struct_declaration","switch_statement","try_statement","unsafe_statement","while_statement"])}get isCompoundStatementType(){return!this.collapsed&&t.compoundTypeNames.has(this.node.type)}childrenFinished(){this.isSingleLineIfStatement()&&this.collapse()}isSingleLineIfStatement(){return this.node.type!=="if_statement"||this.node.startPosition.row!==this.node.endPosition.row?!1:this.children.length===1&&this.children[0].node.type!=="block"}},kO=class extends Zu{static{s(this,"CSharpStatementTree")}static{this.languageIds=new Set(["csharp"])}createNode(e){return new RCe(e)}getStatementQueryText(){return`[
            (extern_alias_directive)
            (using_directive)
            (global_attribute)
            (preproc_if)
            (namespace_declaration)
            (file_scoped_namespace_declaration)
            (statement)
            (type_declaration)
            (declaration)
            (accessor_declaration)
            (block)
        ] @statement`}},kCe=class t extends QC{static{s(this,"CStatementNode")}static{this.compoundTypeNames=new Set(["declaration","function_definition","enum_specifier","field_declaration_list","type_definition","compound_statement","if_statement","switch_statement","while_statement","for_statement","do_statement","preproc_if","preproc_ifdef","namespace_definition","class_specifier","field_declaration_list","concept_definition","template_declaration"])}get isCompoundStatementType(){return!this.collapsed&&t.compoundTypeNames.has(this.node.type)}childrenFinished(){(this.isSingleLineDeclarationStatement()||this.isSingleLineConceptDefinition())&&this.collapse()}isSingleLineDeclarationStatement(){return!(this.node.type!=="declaration"||this.node.startPosition.row!==this.node.endPosition.row)}isSingleLineConceptDefinition(){return!(this.node.type!=="concept_definition"||this.node.startPosition.row!==this.node.endPosition.row)}},PO=class extends Zu{static{s(this,"CStatementTree")}static{this.languageIds=new Set(["c","cpp"])}createNode(e){return new kCe(e)}getStatementQueryText(){return`[
            (declaration)
            (function_definition)
            (type_definition)
            (field_declaration)
            (enum_specifier)
            (return_statement)
            (compound_statement)
            (if_statement)
            (expression_statement)
            (switch_statement)
            (break_statement)
            (case_statement)
            (while_statement)
            (for_statement)
            (do_statement)
            (goto_statement)
            (labeled_statement)
            (preproc_if)
            (preproc_def)
            (preproc_ifdef)
            (preproc_include)
            (preproc_call)
            (preproc_function_def)
            (continue_statement)

            ;C++ specific:
            (namespace_definition)
            (class_specifier)
            (field_declaration_list)
            (field_declaration)
            (concept_definition)
            (compound_requirement)
            (template_declaration)
            (using_declaration)
            (alias_declaration)
            (static_assert_declaration)
        ] @statement`}};var UC=class{constructor(e,r,n){this.languageId=e;this.prefix=r;this.completion=n}static{s(this,"BlockTrimmer")}static isSupported(e){return Zu.isSupported(e)}static isTrimmedByDefault(e){return Zu.isTrimmedByDefault(e)}async withParsedStatementTree(e){var n=[];try{let r=xfe(n,Zu.create(this.languageId,this.prefix+this.completion,this.prefix.length,this.prefix.length+this.completion.length));await r.build();return await e(r)}catch(i){var o=i,a=!0}finally{Efe(n,o,a)}}trimmedCompletion(e){return e===void 0?this.completion:this.completion.substring(0,e)}getStatementAtCursor(e){return e.statementAt(Math.max(this.prefix.length-1,0))??e.statements[0]}getContainingBlockOffset(e){let r;if(e&&this.isCompoundStatement(e))r=e;else if(e){let n=e.parent;for(;n&&!this.isCompoundStatement(n);)n=n.parent;r=n}if(r){let n=this.asCompletionOffset(r.node.endIndex);if(n&&this.completion.substring(n).trim()!=="")return n}}hasNonStatementContentAfter(e){if(!e||!e.nextSibling)return!1;let r=this.asCompletionOffset(e.node.endIndex),n=this.asCompletionOffset(e.nextSibling.node.startIndex);return this.completion.substring(Math.max(0,r??0),Math.max(0,n??0)).trim()!==""}asCompletionOffset(e){return e===void 0?void 0:e-this.prefix.length}isCompoundStatement(e){return e.isCompoundStatementType||e.children.length>0}};var IY=class extends UC{constructor(r,n,i,o=3,a=7){super(r,n,i);this.lineLimit=o;this.lookAhead=a;let c=[...this.completion.matchAll(/\n/g)],l=this.lineLimit+this.lookAhead;c.length>=this.lineLimit&&this.lineLimit>0&&(this.limitOffset=c[this.lineLimit-1].index),c.length>=l&&l>0&&(this.lookAheadOffset=c[l-1].index)}static{s(this,"TerseBlockTrimmer")}async getCompletionTrimOffset(){return await this.withParsedStatementTree(r=>{let n=r.statementAt(this.stmtStartPos()),i=this.getContainingBlockOffset(n);return i=this.trimAtFirstBlankLine(i),n&&(i=this.trimAtStatementChange(n,i)),this.limitOffset&&this.lookAheadOffset&&(i===void 0||i>this.lookAheadOffset)?this.limitOffset:i})}stmtStartPos(){let r=this.completion.match(/\S/);return r&&r.index!==void 0?this.prefix.length+r.index:Math.max(this.prefix.length-1,0)}trimAtFirstBlankLine(r){let n=[...this.trimmedCompletion(r).matchAll(/\r?\n\s*\r?\n/g)];for(;n.length>0&&(r===void 0||r>n[0].index);){let i=n.shift();if(this.completion.substring(0,i.index).trim()!=="")return i.index}return r}trimAtStatementChange(r,n){let i=this.prefix.length,o=this.prefix.length+(n??this.completion.length);if(r.node.endIndex>i&&this.isCompoundStatement(r))return r.nextSibling&&r.node.endIndex<o?this.asCompletionOffset(r.node.endIndex):n;let a=r,c=r.nextSibling;for(;c&&c.node.endIndex<=o&&!this.hasNonStatementContentAfter(a)&&!this.isCompoundStatement(c);)a=c,c=c.nextSibling;return c&&a.node.endIndex>i&&a.node.endIndex<o?this.asCompletionOffset(a.node.endIndex):n}};async function Tje(t,e){var c=[];try{let r=t.getText();let n=t.offsetAt(e);let i=xfe(c,Zu.create(t.detectedLanguageId,r,0,r.length));await i.build();let o=i.statementAt(n);if(!o)return"non-block";if(!o.isCompoundStatementType&&o.children.length===0)return o.parent&&!o.nextSibling&&o.node.endPosition.row<=e.line?"block-end":o.parent?"mid-block":"non-block";if(o.children.length===0)return"empty-block";let a=o.children[o.children.length-1];if(n<a.node.startIndex)return"mid-block";return"block-end"}catch(l){var u=l,f=!0}finally{Efe(c,u,f)}}s(Tje,"getBlockPositionType");d();function qqt(t){return t.HTTPS_PROXY||t.https_proxy||t.HTTP_PROXY||t.http_proxy}s(qqt,"getProxyFromEnvironment");function Hqt(t){return t.NODE_TLS_REJECT_UNAUTHORIZED!=="0"}s(Hqt,"getRejectUnauthorizedFromEnvironment");var wje=x.Object({proxy:x.Optional(x.String()),proxyStrictSSL:x.Optional(x.Boolean()),proxyAuthorization:x.Optional(x.String()),proxyKerberosServicePrincipal:x.Optional(x.String())});function Sje(t){let e=qqt(t),r=DO({proxy:e,proxyStrictSSL:Hqt(t)}),n=t.GH_COPILOT_KERBEROS_SERVICE_PRINCIPAL??t.GITHUB_COPILOT_KERBEROS_SERVICE_PRINCIPAL??t.AGENT_KERBEROS_SERVICE_PRINCIPAL;return n&&(r.proxyKerberosServicePrincipal=n),r}s(Sje,"getHttpSettingsFromEnvironment");function DO(t){if(!t.proxy)return{...t,proxy:""};try{let{protocol:e,host:r,username:n,password:i,pathname:o,search:a,hash:c}=new URL(t.proxy);return{...t,proxy:`${e}//${r}${o}${a}${c}`,proxyAuthorization:t.proxyAuthorization||$qt(n,i)}}catch{return{...t,proxy:""}}}s(DO,"normalizeHttpSettings");function $qt(t,e){return!t||!e?"":`${decodeURIComponent(t)}:${decodeURIComponent(e)}`}s($qt,"getAuth");var PCe={};Ia(PCe,{activationEvents:()=>lHt,badges:()=>cHt,browser:()=>uHt,bugs:()=>eHt,build:()=>zqt,buildType:()=>Kqt,categories:()=>sHt,contributes:()=>DCe,default:()=>AHt,dependencies:()=>hHt,description:()=>Gqt,devDependencies:()=>mHt,displayName:()=>jqt,enabledApiProposals:()=>fHt,engines:()=>oHt,extensionPack:()=>iHt,homepage:()=>Xqt,icon:()=>rHt,keywords:()=>aHt,license:()=>Zqt,main:()=>dHt,name:()=>Wqt,overrides:()=>gHt,preview:()=>Jqt,pricing:()=>nHt,publisher:()=>Yqt,qna:()=>tHt,scripts:()=>pHt,version:()=>Vqt});var Wqt="copilot",jqt="GitHub Copilot",Gqt="Your AI pair programmer",Vqt="1.367.0",zqt="1776",Kqt="prod",Yqt="GitHub",Jqt=!1,Xqt="https://github.com/features/copilot?editor=vscode",Zqt="https://docs.github.com/en/site-policy/github-terms/github-terms-for-additional-products-and-features",eHt={url:"https://github.com/microsoft/vscode/issues"},tHt="https://github.com/github-community/community/discussions/categories/copilot",rHt="assets/Copilot-App-Icon.png",nHt="Trial",iHt=["GitHub.copilot-chat","GitHub.copilot"],oHt={vscode:"^1.98.0",node:">=20.0.0",npm:">=9.0.0"},sHt=["AI","Chat","Programming Languages","Machine Learning"],aHt=["ai","openai","codex","pilot","snippets","documentation","autocomplete","intellisense","refactor","javascript","python","typescript","php","go","golang","ruby","c++","c#","java","kotlin","co-pilot"],cHt=[{url:"https://img.shields.io/badge/GitHub%20Copilot-Subscription%20Required-orange",href:"https://github.com/github-copilot/signup?editor=vscode",description:"Sign up for GitHub Copilot"},{url:"https://img.shields.io/github/stars/github/copilot-docs?style=social",href:"https://github.com/github/copilot-docs",description:"Star Copilot on GitHub"},{url:"https://img.shields.io/youtube/channel/views/UC7c3Kb6jYCRj4JOHHZTxKsQ?style=social",href:"https://www.youtube.com/@GitHub/search?query=copilot",description:"Check out GitHub on Youtube"},{url:"https://img.shields.io/twitter/follow/github?style=social",href:"https://twitter.com/github",description:"Follow GitHub on Twitter"}],lHt=["onStartupFinished"],uHt="./dist/web",dHt="./dist/extension",fHt=["inlineCompletionsAdditions"],DCe={commands:[{command:"github.copilot.toggleStatusMenu",title:"Open Status Menu",category:"GitHub Copilot"},{command:"github.copilot.signIn",title:"Sign In",category:"GitHub Copilot",enablement:"!github.copilot.activated"},{command:"github.copilot.acceptCursorPanelSolution",title:"Accept Panel Suggestion at the Cursor",enablement:"github.copilot.panelVisible",category:"GitHub Copilot"},{command:"github.copilot.previousPanelSolution",title:"Navigate to the Previous Panel Suggestion",enablement:"github.copilot.panelVisible",category:"GitHub Copilot"},{command:"github.copilot.nextPanelSolution",title:"Navigate to the Next Panel Suggestion",enablement:"github.copilot.panelVisible",category:"GitHub Copilot"},{command:"github.copilot.generate",title:"Open Completions Panel",enablement:"github.copilot.activated && !isWeb",category:"GitHub Copilot"},{command:"github.copilot.generateComparison",title:"Open Comparison Panel",enablement:"github.copilot.activated && !isWeb && github.copilot.comparisonPanelEnabled",category:"GitHub Copilot"},{command:"github.copilot.acceptCursorComparisonPanelSolution",title:"Accept Comparison Panel Suggestion at the Cursor",enablement:"github.copilot.comparisonPanelVisible && github.copilot.comparisonPanelEnabled",category:"GitHub Copilot"},{command:"github.copilot.previousComparisonPanelSolution",title:"Navigate to the Previous Comparison Panel Suggestion",enablement:"github.copilot.comparisonPanelVisible && github.copilot.comparisonPanelEnabled",category:"GitHub Copilot"},{command:"github.copilot.nextComparisonPanelSolution",title:"Navigate to the Next Comparison Panel Suggestion",enablement:"github.copilot.comparisonPanelVisible && github.copilot.comparisonPanelEnabled",category:"GitHub Copilot"},{command:"github.copilot.completions.disable",title:"Disable Completions",enablement:"github.copilot.activated && config.editor.inlineSuggest.enabled && github.copilot.completions.enabled",category:"GitHub Copilot"},{command:"github.copilot.completions.enable",title:"Enable Completions",enablement:"github.copilot.activated && !(config.editor.inlineSuggest.enabled && github.copilot.completions.enabled)",category:"GitHub Copilot"},{command:"github.copilot.completions.toggle",title:"Toggle (Enable/Disable) Completions",enablement:"github.copilot.activated",category:"GitHub Copilot"},{command:"github.copilot.sendFeedback",title:"Send Feedback",category:"GitHub Copilot"},{command:"github.copilot.collectDiagnostics",title:"Collect Diagnostics",category:"GitHub Copilot",enablement:"!isWeb"},{command:"github.copilot.openLogs",title:"Open Logs",category:"GitHub Copilot"},{command:"github.copilot.openModelPicker",title:"Change Completions Model",category:"GitHub Copilot",enablement:"!isWeb"},{command:"github.copilot.sendCompletionFeedback",title:"Send Copilot Completion Feedback",category:"GitHub Copilot",enablement:"!isWeb"},{command:"github-copilot-completions-debugger-view.refresh",title:"Refresh",icon:"$(refresh)"}],keybindings:[{command:"github.copilot.acceptCursorPanelSolution",key:"ctrl+/",mac:"ctrl+/",when:"activeWebviewPanelId == 'GitHub Copilot Suggestions'"},{command:"github.copilot.previousPanelSolution",key:"alt+[",mac:"alt+[",when:"activeWebviewPanelId == 'GitHub Copilot Suggestions'"},{command:"github.copilot.nextPanelSolution",key:"alt+]",mac:"alt+]",when:"activeWebviewPanelId == 'GitHub Copilot Suggestions'"},{command:"github.copilot.acceptCursorComparisonPanelSolution",key:"ctrl+shift+/",mac:"ctrl+shift+/",when:"activeWebviewPanelId == 'GitHub Copilot Comparison' && github.copilot.comparisonPanelEnabled"},{command:"github.copilot.previousComparisonPanelSolution",key:"alt+shift+[",mac:"alt+shift+[",when:"activeWebviewPanelId == 'GitHub Copilot Comparison' && github.copilot.comparisonPanelEnabled"},{command:"github.copilot.nextComparisonPanelSolution",key:"alt+shift+]",mac:"alt+shift+]",when:"activeWebviewPanelId == 'GitHub Copilot Comparison' && github.copilot.comparisonPanelEnabled"},{command:"editor.action.inlineSuggest.trigger",key:"alt+\\",when:"editorTextFocus && !editorHasSelection && !inlineSuggestionsVisible"}],configuration:[{title:"GitHub Copilot",properties:{"github.copilot.selectedCompletionModel":{type:"string",default:"",markdownDescription:'The currently selected completion model ID. To select from a list of available models, use the __"Change Completions Model"__ command or open the model picker (from the Copilot menu in the VS Code title bar, select __"Configure Code Completions"__ then __"Change Completions Model"__. The value must be a valid model ID. An empty value indicates that the default model will be used.'},"github.copilot.advanced":{type:"object",title:"Advanced Settings",properties:{authProvider:{type:"string",enum:["github","github-enterprise"],enumDescriptions:["GitHub.com","GitHub Enterprise"],default:"github",description:"The GitHub identity to use for Copilot"},authPermissions:{type:"string",enum:["default","minimal"],markdownEnumDescriptions:["Default (recommended) - The default permissions enable the best that Copilot has to offer including, but not limited to, faster repo indexing and the power of the `@github` agent.","Minimal - The minimal permissions required for Copilot functionality."],default:"default",markdownDescription:"Controls what kind of permissions are asked for when signing in to Copilot. The options are\n* `default` - (strongly recommended) The default permissions enable the best that Copilot has to offer including, but not limited to, faster repo indexing and the power of the `@github` agent.\n* `minimal` - The minimal permissions are the least that Copilot needs to function. Some features may behave slower or not at all."},useLanguageServer:{type:"boolean",default:!1,description:"Experimental: Use language server"},"debug.overrideEngine":{type:"string",default:"",description:"Override engine name"},"debug.overrideProxyUrl":{type:"string",default:"",description:"Override GitHub authentication proxy full URL"},"debug.testOverrideProxyUrl":{type:"string",default:"",description:"Override GitHub authentication proxy URL when running tests"},"debug.overrideCapiUrl":{type:"string",default:"",description:"Override GitHub Copilot API full URL"},"debug.testOverrideCapiUrl":{type:"string",default:"",description:"Override GitHub Copilot API URL when running tests"},"debug.filterLogCategories":{type:"array",default:[],deprecationMessage:"Set overrideLogLevels.* to ERROR to filter out unwanted categories.",description:"Show only log categories listed in this setting. If an array is empty, show all loggers"}}},"github.copilot.enable":{type:"object",scope:"window",default:{"*":!0,plaintext:!1,markdown:!1,scminput:!1},additionalProperties:{type:"boolean"},markdownDescription:"Enable or disable auto triggering of Copilot completions for specified [languages](https://code.visualstudio.com/docs/languages/identifiers). You can still trigger suggestions manually using `Alt + \\`"}}}],configurationDefaults:{"editor.tokenColorCustomizations":{"[*Light*]":{textMateRules:[{scope:"ref.matchtext",settings:{foreground:"#000"}}]},"[*Dark*]":{textMateRules:[{scope:"ref.matchtext",settings:{foreground:"#fff"}}]}}},languages:[{id:"code-referencing"}],grammars:[{language:"code-referencing",scopeName:"text.ref",path:"./syntaxes/ref.tmGrammar.json"}],iconFonts:[{id:"copilot-font",src:[{path:"assets/copilot.woff",format:"woff"}]}],viewsContainers:{activitybar:[{id:"github-copilot-completions-debugger-panel",title:"Debugger",icon:"$(bug)",when:"config.github.copilot.internal.showWorkspaceContextDebugger && config.github.copilot.internal.useWorkspaceContextCoordinator"}]},views:{"github-copilot-completions-debugger-panel":[{id:"github-copilot-completions-debugger-view",name:"Debugger",when:"config.github.copilot.internal.showWorkspaceContextDebugger && config.github.copilot.internal.useWorkspaceContextCoordinator",icon:"$(bug)"}]},menus:{"view/title":[{command:"github-copilot-completions-debugger-view.refresh",when:"view == github-copilot-completions-debugger-view",group:"navigation"}]}},pHt={build:"tsx esbuild.ts",clean:"./script/build/clean.sh",compress:"tsx ./script/compressTokenizer.ts","forbid-sources-content:extension":"node script/forbid-sources-content.js --extension",generate_languages:"tsx script/generateLanguages.ts && prettier --write lib/src/language/generatedLanguages.ts",get_token:"tsx script/deviceFlow.ts --save-as-test-token",lint:'run-p --aggregate-output "lint:*"',"lint:deps":"depcruise -c .dependency-cruiser.js .","lint:eslint":"eslint -f visualstudio --quiet --cache .","lint:prettier":"prettier --check . 2>&1","lint:types":"tsc --noEmit && tsc --noEmit -p extension/src/copilotPanel/webview",prebuild:"npm install",pretest:"npm run build","pretest:headless":"npm run build","pretest:extension":"npm run build","pretest:lsp-client":"npm run build","pretest:lib-e2e":"npm run build",prewatch:"npm run build","prewatch:esbuild":"npm run build",start:"npm run watch",test:'npm-run-all "test:extension --ignore-scripts" "test:headless --ignore-scripts" lint',"test:headless":'npm-run-all test:lib test:agent "test:lib-e2e --ignore-scripts" test:prompt "test:lsp-client --ignore-scripts" lint',"test:agent":'mocha "agent/src/**/*.test.{ts,tsx}"',"test:extension":"tsx extension/test/runTest.ts","test:lib":'mocha "lib/src/**/*.test.{ts,tsx}"',"test:lib-e2e":'mocha "lib/e2e/src/**/*.test.{ts,tsx}" --exclude "lib/e2e/src/prompt/**/*.test.ts"',"test:lib-e2e-no-ci":'mocha "lib/e2e/no-ci/**/*.test.{ts,tsx}"',"test:lib-prompt-e2e":'mocha "lib/e2e/src/prompt/prompt.test.ts"',"test:lib-prompt-e2e-perf":"INCLUDE_PERFORMANCE=true npm run test:lib-prompt-e2e","test:lsp-client":'mocha "lsp-client/test/*.test.{ts,tsx}"',"test:prompt":'mocha "prompt/test/**/*.test.{ts,tsx}"',"test:prepare-msbench":"tsx script/setupMsbench.ts","test:run-msbench":"tsx lsp-client/test/msbench/agent/index.ts","vscode-dts":"vscode-dts dev && mv vscode.proposed.*.ts extension/src","vscode:prepublish":'run-s "build --ignore-scripts" forbid-sources-content:extension',"vscode:uninstall":"node dist/extensionUninstalled.js",vsix:"vsce package --allow-missing-repository",watch:'run-p "watch:esbuild --ignore-scripts" "watch:types -- --preserveWatchOutput"',"watch:esbuild":"tsx esbuild.ts --watch","watch:types":"tsc --noEmit --watch"},mHt={"@azure/identity":"^4.11.0","@azure/keyvault-secrets":"^4.10.0","@datadog/datadog-ci":"^3.17.0","@github/prettier-config":"0.0.6","@limegrass/eslint-plugin-import-alias":"^1.5.1","@parcel/watcher":"^2.5.1","@types/benchmark":"^2.1.5","@types/crypto-js":"^4.2.2","@types/diff":"^8.0.0","@types/git-url-parse":"^16.0.0","@types/js-yaml":"^4.0.6","@types/kerberos":"^1.1.2","@types/mocha":"^10.0.10","@types/node":"~20.16.0","@types/semver":"^7.7.0","@types/sinon":"^17.0.4","@types/uuid":"^10.0.0","@types/vscode":"1.98.0","@types/yargs":"^17.0.24","@vscode/test-electron":"^2.5.2","@vscode/vsce":"^3.6.0","@yao-pkg/pkg":"^6.6.0",benchmark:"^2.1.4",boxen:"^8.0.1",chalk:"^5.4.1","dependency-cruiser":"^17.0.1",electron:"^28.1.4",esbuild:"^0.25.8","esbuild-plugin-copy":"^2.1.1",eslint:"^9.32.0","eslint-formatter-visualstudio":"^8.40.0","eslint-plugin-mocha":"^10.5.0",glob:"^11.0.3",globals:"^16.3.0","js-yaml":"^4.1.0",mocha:"^11.2.2","mocha-junit-reporter":"^2.2.1","mocha-multi-reporters":"^1.5.1","npm-run-all":"^4.1.5",prettier:"^3.5.3","prettier-plugin-organize-imports":"^4.2.0",proxy:"^2.1.1","simple-git":"^3.28.0",sinon:"^20.0.0","ts-dedent":"^2.2.0",tsx:"^4.19.4",typescript:"^5.9.2","typescript-eslint":"^8.39.1","vscode-dts":"^0.3.3"},hHt={"@adobe/helix-fetch":"github:devm33/helix-fetch#2a08fa939591a0e14f34f611adcc3ed767579e9a","@anthropic-ai/sdk":"^0.56.0","@github/memoize":"1.1.5","@microsoft/1ds-post-js":"^4.3.9","@microsoft/applicationinsights-web-basic":"^3.3.6","@microsoft/tiktokenizer":"^1.0.10","@modelcontextprotocol/sdk":"^1.17.0","@sinclair/typebox":"^0.34.33","@types/vscode-webview":"^1.57.4","@vscode/codicons":"^0.0.39","@vscode/prompt-tsx":"0.4.0-alpha.1","@vscode/webview-ui-toolkit":"^1.3.1","await-lock":"^2.2.2","crypto-js":"^4.2.0",diff:"^8.0.2",dldr:"^0.0.10",events:"^3.3.0","get-stream":"^6.0.1","git-url-parse":"^16.0.3",kerberos:"^2.2.0","mac-ca":"^3.1.3",microjob:"^0.7.0",minimatch:"^9.0.3",open:"^10.2.0","os-browserify":"^0.3.0","path-browserify":"^1.0.1",semver:"^7.7.1",shiki:"~1.15.0","source-map-support":"^0.5.21",sqlite3:"^5.1.7",uuid:"^11.1.0","vscode-languageclient":"^9.0.0","vscode-languageserver":"^9.0.0","vscode-languageserver-protocol":"^3.17","vscode-languageserver-textdocument":"~1.0.11","vscode-uri":"^3.1.0","web-tree-sitter":"^0.20.8","windows-ca-certs":"^0.2.2",yargs:"^17.7.2"},gHt={fsevents:"<0",bindings:"npm:bundled-bindings@^1.5.0"},AHt={name:Wqt,displayName:jqt,description:Gqt,version:Vqt,build:zqt,buildType:Kqt,publisher:Yqt,preview:Jqt,homepage:Xqt,license:Zqt,bugs:eHt,qna:tHt,icon:rHt,pricing:nHt,extensionPack:iHt,engines:oHt,categories:sHt,keywords:aHt,badges:cHt,activationEvents:lHt,browser:uHt,main:dHt,enabledApiProposals:fHt,contributes:DCe,scripts:pHt,devDependencies:mHt,dependencies:hHt,overrides:gHt};var Ht={Enable:"enable",UserSelectedCompletionModel:"selectedCompletionModel",ShowEditorCompletions:"editor.showEditorCompletions",EnableAutoCompletions:"editor.enableAutoCompletions",DelayCompletions:"editor.delayCompletions",FilterCompletions:"editor.filterCompletions",FetchStrategy:"fetchStrategy",ToolConfirmAutoApprove:"agent.toolConfirmAutoApprove",MaxToolCallingLoop:"agent.maxToolCallingLoop",CompletionsDelay:"completionsDelay",CompletionsDebounce:"completionsDebounce",RelatedFilesVSCodeCSharp:"advanced.relatedFilesVSCodeCSharp",RelatedFilesVSCodeTypeScript:"advanced.relatedFilesVSCodeTypeScript",RelatedFilesVSCode:"advanced.relatedFilesVSCode",ContextProviders:"advanced.contextProviders",DebugOverrideLogLevels:"advanced.debug.overrideLogLevels",DebugFilterLogCategories:"advanced.debug.filterLogCategories",DebugSnippyOverrideUrl:"advanced.debug.codeRefOverrideUrl",DebugUseElectronFetcher:"advanced.debug.useElectronFetcher",DebugUseEditorFetcher:"advanced.debug.useEditorFetcher",UseSubsetMatching:"advanced.useSubsetMatching",ContextProviderTimeBudget:"advanced.contextProviderTimeBudget",DebugOverrideCapiUrl:"internal.capiUrl",DebugOverrideCapiUrlLegacy:"advanced.debug.overrideCapiUrl",DebugTestOverrideCapiUrl:"internal.capiTestUrl",DebugTestOverrideCapiUrlLegacy:"advanced.debug.testOverrideCapiUrl",DebugOverrideProxyUrl:"internal.completionsUrl",DebugOverrideProxyUrlLegacy:"advanced.debug.overrideProxyUrl",DebugTestOverrideProxyUrl:"internal.completionsTestUrl",DebugTestOverrideProxyUrlLegacy:"advanced.debug.testOverrideProxyUrl",DebugOverrideEngine:"internal.completionModel",DebugOverrideEngineLegacy:"advanced.debug.overrideEngine",AlwaysRequestMultiline:"internal.alwaysRequestMultiline",ModelAlwaysTerminatesSingleline:"internal.modelAlwaysTerminatesSingleline",TrimCompletionsAggressively:"internal.trimCompletionsAggressively",UseWorkspaceContextCoordinator:"internal.useWorkspaceContextCoordinator",ShowWorkspaceContextDebugger:"internal.showWorkspaceContextDebugger",IncludeNeighboringFiles:"internal.includeNeighboringFiles",ExcludeRelatedFiles:"internal.excludeRelatedFiles",DebugOverrideCppHeadersEnableSwitch:"internal.cppHeadersEnableSwitch",NESXTab:"internal.useXTab",UseSplitContextPrompt:"internal.useSplitContextPrompt",UseCompletionsComparisonPanel:"internal.useCompletionsComparisonPanel",ComparisonPanelModelIds:"internal.comparisonPanelModelIds",ComparisonPanelRandomizedMode:"internal.comparisonPanelRandomizedMode"};function _je(t){return["server","parsingandserver"].includes(t)}s(_je,"shouldDoServerTrimming");var bA=class{static{s(this,"BlockModeConfig")}},UB=class extends bA{static{s(this,"ConfigBlockModeConfig")}forLanguage(e,r,n){let i=e.get(Mt).overrideBlockMode(n);if(i)return BCe(i,r);let o=e.get(Mt).enableProgressiveReveal(n);return(zi(e,Ht.AlwaysRequestMultiline)??o)||UC.isTrimmedByDefault(r)?BCe("moremultiline",r):r=="ruby"?"parsing":U0(r)?"parsingandserver":"server"}};function yHt(t){return["parsing","parsingandserver","moremultiline"].includes(t)}s(yHt,"blockModeRequiresTreeSitter");function BCe(t,e){return t==="moremultiline"&&Zu.isSupported(e)?t:yHt(t)&&!U0(e)?"server":t}s(BCe,"toApplicableBlockMode");var Mc=class{static{s(this,"ConfigProvider")}requireReady(){return Promise.resolve()}},qB=class extends Mc{constructor(){super(...arguments);this.onDidChangeCopilotSettings=s(()=>({dispose:s(()=>{},"dispose")}),"onDidChangeCopilotSettings");this.onDidChangeHttpSettings=this.onDidChangeCopilotSettings}static{s(this,"DefaultsOnlyConfigProvider")}getConfig(r){return vHt(r)}getOptionalConfig(r){return xHt(r)}dumpForTelemetry(){return{}}getHttpSettings(){return{proxy:""}}},uR=class extends Mc{constructor(r,n){super();this.baseConfigProvider=r;this.overrides=n;this.copilotEmitter=new ys;this.onDidChangeCopilotSettings=this.copilotEmitter.event;this.didChangeHttpSettingsEmitter=new ys;this.onDidChangeHttpSettings=this.didChangeHttpSettingsEmitter.event;this.httpSettings=this.baseConfigProvider.getHttpSettings()}static{s(this,"InMemoryConfigProvider")}getOptionalOverride(r){return this.overrides.get(r)}getConfig(r){return this.getOptionalOverride(r)??this.baseConfigProvider.getConfig(r)}getOptionalConfig(r){return this.getOptionalOverride(r)??this.baseConfigProvider.getOptionalConfig(r)}setConfig(r,n){this.setCopilotSettings({[r]:n})}setCopilotSettings(r){for(let[n,i]of Object.entries(r))i!==void 0?this.overrides.set(n,i):this.overrides.delete(n);this.copilotEmitter.fire(this)}getHttpSettings(){return this.httpSettings}setHttpSettings(r){let n=DO(r);this.httpSettings=n,this.didChangeHttpSettingsEmitter.fire(this.getHttpSettings())}dumpForTelemetry(){let r=this.baseConfigProvider.dumpForTelemetry();for(let n of[Ht.ShowEditorCompletions,Ht.EnableAutoCompletions,Ht.DelayCompletions,Ht.FilterCompletions]){let i=this.overrides.get(n);i!==void 0&&(r[n]=JSON.stringify(i))}return r}};function CHt(t){return t?.type==="object"&&"properties"in t}s(CHt,"isContributesObject");function Rje(t,e){let r=t,n=[];for(let i of e.split(".")){let o=[...n,i].join(".");r&&typeof r=="object"&&o in r?(r=r[o],n.length=0):n.push(i)}if(!(r===void 0||n.length>0))return r}s(Rje,"getConfigKeyRecursively");function vHt(t){if(QB.has(t))return QB.get(t);throw new Error(`Missing config default value: ${LF}.${t}`)}s(vHt,"getConfigDefaultForKey");function xHt(t){return QB.get(t)}s(xHt,"getOptionalConfigDefaultForKey");var QB=new Map([[Ht.DebugOverrideCppHeadersEnableSwitch,!1],[Ht.RelatedFilesVSCodeCSharp,!1],[Ht.RelatedFilesVSCodeTypeScript,!1],[Ht.RelatedFilesVSCode,!1],[Ht.IncludeNeighboringFiles,!1],[Ht.ExcludeRelatedFiles,!1],[Ht.ContextProviders,[]],[Ht.DebugUseEditorFetcher,null],[Ht.DebugUseElectronFetcher,null],[Ht.DebugOverrideLogLevels,{}],[Ht.DebugSnippyOverrideUrl,""],[Ht.FetchStrategy,"auto"],[Ht.ToolConfirmAutoApprove,!1],[Ht.MaxToolCallingLoop,25],[Ht.UseSubsetMatching,null],[Ht.ContextProviderTimeBudget,void 0],[Ht.DebugOverrideCapiUrl,""],[Ht.DebugTestOverrideCapiUrl,""],[Ht.DebugOverrideProxyUrl,""],[Ht.DebugTestOverrideProxyUrl,""],[Ht.DebugOverrideEngine,""],[Ht.AlwaysRequestMultiline,void 0],[Ht.ModelAlwaysTerminatesSingleline,void 0],[Ht.TrimCompletionsAggressively,void 0],[Ht.CompletionsDebounce,void 0],[Ht.NESXTab,void 0],[Ht.UseWorkspaceContextCoordinator,void 0],[Ht.ShowWorkspaceContextDebugger,!1],[Ht.CompletionsDelay,void 0],[Ht.UseSplitContextPrompt,void 0],[Ht.UseCompletionsComparisonPanel,!1],[Ht.ComparisonPanelModelIds,["gpt-4o-copilot","chat-v6"]],[Ht.ComparisonPanelRandomizedMode,!1],[Ht.ShowEditorCompletions,void 0],[Ht.EnableAutoCompletions,void 0],[Ht.DelayCompletions,void 0],[Ht.FilterCompletions,void 0]]);for(let t of Object.values(Ht)){let e=DCe.configuration[0],r=[],n=`${LF}.${t}`.split(".");for(;n.length>0;){r.push(n.shift());let i=e.properties[r.join(".")];if(CHt(i))r.length=0,e=i;else if(n.length==0&&i?.default!==void 0){if(QB.has(t))throw new Error(`Duplicate config default value ${LF}.${t}`);QB.set(t,i.default)}}if(!QB.has(t))throw new Error(`Missing config default value ${LF}.${t}`)}function zi(t,e){return t.get(Mc).getConfig(e)}s(zi,"getConfig");function t6e(t){return t.get(Mc).dumpForTelemetry()}s(t6e,"dumpForTelemetry");var To=class{constructor(){this.packageJson=PCe}static{s(this,"BuildInfo")}isPreRelease(){return this.getBuildType()==="nightly"}isProduction(){return this.getBuildType()!=="dev"}getBuildType(){return this.packageJson.buildType}getVersion(){return this.packageJson.version}getDisplayVersion(){return this.getBuildType()==="dev"?`${this.getVersion()}-dev`:this.getVersion()}getBuild(){return this.packageJson.build}getName(){return this.packageJson.name}};function Xfe(t){return t.get(To).isProduction()}s(Xfe,"isProduction");function h6e(t){return t.get(To).getBuildType()==="dev"}s(h6e,"isDevBuild");function AC(t){return t.get(To).getBuildType()}s(AC,"getBuildType");function r6e(t){return t.get(To).getBuild()}s(r6e,"getBuild");function s2(t){return t.get(To).getVersion()}s(s2,"getVersion");var Ms=class{constructor(e,r,n="none",i="desktop"){this.sessionId=e;this.machineId=r;this.remoteName=n;this.uiKind=i}static{s(this,"EditorSession")}};function oC({name:t,version:e}){return`${t}/${e}`}s(oC,"formatNameAndVersion");var cn=class{static{s(this,"EditorAndPluginInfo")}getCopilotIntegrationId(){}getEditorPluginSpecificFilters(){return[]}},NB="2025-05-01";function p0(t){let e=t.get(cn);return{"Editor-Version":oC(e.getEditorInfo()),"Editor-Plugin-Version":oC(e.getEditorPluginInfo()),"Copilot-Language-Server-Version":s2(t)}}s(p0,"editorVersionHeaders");var w0="Iv1.b507a08c87ecfe98",kje="350ee525b5da0e4a54c6e8e043edc1b99cc02f19",iu=class{static{s(this,"GitHubAppInfo")}findAppIdToAuthenticate(){return this.githubAppId??w0}};var Or=class{static{s(this,"Fetcher")}getImplementation(){return this}};function Cx(t,e,r,n,i,o,a,c,l,u){let f={...c,Authorization:`Bearer ${r}`,...p0(t)};u===void 0&&(f["Openai-Organization"]="github-copilot",f["X-Request-Id"]=i,f["VScode-SessionId"]=t.get(Ms).sessionId,f["VScode-MachineId"]=t.get(Ms).machineId,f["X-GitHub-Api-Version"]=NB),n&&(f["OpenAI-Intent"]=n);let p={method:"POST",headers:f,json:o,timeout:l},m=t.get(Or);if(a){let g=new AbortController;a.onCancellationRequested(()=>{Bt(t,"networking.cancelRequest",Vr.createAndMarkAsIssued({headerRequestId:i})),g.abort()}),p.signal=g.signal}return m.fetch(e,p).catch(g=>{if(EHt(g))return Bt(t,"networking.disconnectAll"),m.disconnectAll().then(()=>m.fetch(e,p));throw g})}s(Cx,"postRequest");function EHt(t){return t instanceof Error?t.message=="ERR_HTTP2_GOAWAY_SESSION"?!0:"code"in t?t.code=="ECONNRESET"||t.code=="ETIMEDOUT"||t.code=="ERR_HTTP2_INVALID_SESSION":!1:!1}s(EHt,"isInterruptedNetworkError");var bHt=new Set(["ERR_WORKER_OUT_OF_MEMORY","ENOMEM"]);function IHt(t){return bHt.has(t.code??"")||t.name==="RangeError"&&t.message==="WebAssembly.Memory(): could not allocate memory"}s(IHt,"isOomError");function vx(t,e,r,n=dn){if(!Td(e)){if(e instanceof Error){let i=e;IHt(i)?t.get(qo).setWarning("Out of memory"):i.code==="EMFILE"||i.code==="ENFILE"?t.get(qo).setWarning("Too many open files"):i.code==="CopilotPromptLoadFailure"?t.get(qo).setWarning("Corrupted Copilot installation"):`${i.code}`.startsWith("CopilotPromptWorkerExit")?t.get(qo).setWarning("Worker unexpectedly exited"):i.syscall==="uv_cwd"&&i.code==="ENOENT"&&t.get(qo).setWarning("Current working directory does not exist")}n.exception(t,e,r)}}s(vx,"handleException");function Pje(t){process.addListener("uncaughtException",r=>{vx(t,r,"uncaughtException")});let e=!1;process.addListener("unhandledRejection",r=>{if(!e)try{e=!0,vx(t,r,"unhandledRejection")}finally{e=!1}})}s(Pje,"registerDefaultHandlers");async function Dje(t){try{await cR}catch(e){vx(t,e,"initializeTokenizers")}}s(Dje,"waitForTokenizers");d();var IT=require("fs"),Bje=require("os"),Nje=Be(require("path")),HB=require("process");var yi=class{static{s(this,"PersistenceManager")}},NCe=class extends yi{constructor(r){super();this.directory=r}static{s(this,"FilePersistenceManager")}async read(r,n){try{return(await this.readJsonObject(r))[n]}catch{return}}async update(r,n,i){await IT.promises.mkdir(this.directory,{recursive:!0,mode:448});let o=`${this.directory}/${r}.json`,a;try{a=await BO.acquire(o);let c=await this.readJsonObject(r);c[n]=i,await IT.promises.writeFile(o,JSON.stringify(c)+`
`,{encoding:"utf8"})}finally{a&&await a()}}async delete(r,n){let i=`${this.directory}/${r}.json`,o;try{o=await BO.acquire(i);let a=await this.readJsonObject(r);delete a[n];let c=JSON.stringify(a)+`
`;c===`{}
`?await IT.promises.rm(i):await IT.promises.writeFile(i,c,{encoding:"utf8"})}catch{}finally{o&&await o()}}async deleteSetting(r){let n=`${this.directory}/${r}.json`,i;try{i=await BO.acquire(n),await IT.promises.rm(n)}catch{}finally{i&&await i()}}async listSettings(){try{return(await IT.promises.readdir(this.directory)).filter(n=>n.endsWith(".json")).map(n=>n.slice(0,-5))}catch{return[]}}async listKeys(r){return Object.keys(await this.readJsonObject(r))}async readJsonObject(r){let n=`${this.directory}/${r}.json`;try{let i=await IT.promises.readFile(n,{encoding:"utf8"});return JSON.parse(i)}catch{return{}}}},BO=class{static{s(this,"LockManager")}static{this.locks=new Map}static{this.DEFAULT_TIMEOUT_MS=1e4}static async acquire(e){await this.getLock(e);let r,n=new Promise(i=>{r=i});return this.locks.set(e,n),()=>Promise.resolve().then(()=>{r&&(r(),r=void 0,this.locks.get(e)===n&&this.locks.delete(e))})}static async getLock(e){let r=Date.now();for(;Date.now()-r<this.DEFAULT_TIMEOUT_MS;){let n=this.locks.get(e);if(!n)return;let i=this.DEFAULT_TIMEOUT_MS-(Date.now()-r);if(i<=0)return;let o=new Promise((a,c)=>{setTimeout(()=>{c(new Error("timeout"))},i)});try{await Promise.race([n,o])}catch{return}}}};function MCe(){return HB.env.XDG_CONFIG_HOME&&Nje.isAbsolute(HB.env.XDG_CONFIG_HOME)?HB.env.XDG_CONFIG_HOME+"/github-copilot":(0,Bje.platform)()==="win32"?HB.env.USERPROFILE+"\\AppData\\Local\\github-copilot":HB.env.HOME+"/.config/github-copilot"}s(MCe,"getXdgConfigPath");function Mje(){return new NCe(MCe())}s(Mje,"makeXdgPersistenceManager");d();d();d();var xx={abap:{extensions:[".abap"]},aspdotnet:{extensions:[".asax",".ascx",".ashx",".asmx",".aspx",".axd"]},bat:{extensions:[".bat",".cmd"]},bibtex:{extensions:[".bib",".bibtex"]},blade:{extensions:[".blade",".blade.php"]},BluespecSystemVerilog:{extensions:[".bsv"]},c:{extensions:[".c",".cats",".h",".h.in",".idc"]},csharp:{extensions:[".cake",".cs",".cs.pp",".csx",".linq"]},cpp:{extensions:[".c++",".cc",".cp",".cpp",".cppm",".cxx",".h",".h++",".hh",".hpp",".hxx",".idl",".inc",".inl",".ino",".ipp",".ixx",".rc",".re",".tcc",".tpp",".txx",".i"]},cobol:{extensions:[".cbl",".ccp",".cob",".cobol",".cpy"]},css:{extensions:[".css",".wxss"]},clojure:{extensions:[".bb",".boot",".cl2",".clj",".cljc",".cljs",".cljs.hl",".cljscm",".cljx",".edn",".hic"],filenames:["riemann.config"]},ql:{extensions:[".ql",".qll"]},coffeescript:{extensions:["._coffee",".cake",".cjsx",".coffee",".iced"],filenames:["Cakefile"]},cuda:{extensions:[".cu",".cuh"]},dart:{extensions:[".dart"]},dockerfile:{extensions:[".containerfile",".dockerfile"],filenames:["Containerfile","Dockerfile"]},dotenv:{extensions:[".env"],filenames:[".env",".env.ci",".env.dev",".env.development",".env.development.local",".env.example",".env.local",".env.prod",".env.production",".env.sample",".env.staging",".env.test",".env.testing"]},html:{extensions:[".ect",".ejs",".ejs.t",".jst",".hta",".htm",".html",".html.hl",".html5",".inc",".jsp",".njk",".tpl",".twig",".wxml",".xht",".xhtml",".phtml",".liquid"]},elixir:{extensions:[".ex",".exs"],filenames:["mix.lock"]},erlang:{extensions:[".app",".app.src",".erl",".es",".escript",".hrl",".xrl",".yrl"],filenames:["Emakefile","rebar.config","rebar.config.lock","rebar.lock"]},fsharp:{extensions:[".fs",".fsi",".fsx"]},go:{extensions:[".go"]},groovy:{extensions:[".gradle",".groovy",".grt",".gtpl",".gvy",".jenkinsfile"],filenames:["Jenkinsfile","Jenkinsfile"]},graphql:{extensions:[".gql",".graphql",".graphqls"]},terraform:{extensions:[".hcl",".nomad",".tf",".tfvars",".workflow"]},hlsl:{extensions:[".cginc",".fx",".fxh",".hlsl",".hlsli"]},erb:{extensions:[".erb",".erb.deface",".rhtml"]},razor:{extensions:[".cshtml",".razor"]},haml:{extensions:[".haml",".haml.deface"]},handlebars:{extensions:[".handlebars",".hbs"]},haskell:{extensions:[".hs",".hs-boot",".hsc"]},ini:{extensions:[".cfg",".cnf",".dof",".ini",".lektorproject",".prefs",".pro",".properties",".url"],filenames:[".buckconfig",".coveragerc",".flake8",".pylintrc","HOSTS","buildozer.spec","hosts","pylintrc","vlcrc"]},json:{extensions:[".4DForm",".4DProject",".JSON-tmLanguage",".avsc",".geojson",".gltf",".har",".ice",".json",".json.example",".jsonl",".mcmeta",".sarif",".tact",".tfstate",".tfstate.backup",".topojson",".webapp",".webmanifest",".yy",".yyp"],filenames:[".all-contributorsrc",".arcconfig",".auto-changelog",".c8rc",".htmlhintrc",".imgbotconfig",".nycrc",".tern-config",".tern-project",".watchmanconfig","MODULE.bazel.lock","Package.resolved","Pipfile.lock","bun.lock","composer.lock","deno.lock","flake.lock","mcmod.info"]},jsonc:{extensions:[".code-snippets",".code-workspace",".jsonc",".sublime-build",".sublime-color-scheme",".sublime-commands",".sublime-completions",".sublime-keymap",".sublime-macro",".sublime-menu",".sublime-mousemap",".sublime-project",".sublime-settings",".sublime-theme",".sublime-workspace",".sublime_metrics",".sublime_session"],filenames:[".babelrc",".devcontainer.json",".eslintrc.json",".jscsrc",".jshintrc",".jslintrc",".swcrc","api-extractor.json","argv.json","devcontainer.json","extensions.json","jsconfig.json","keybindings.json","language-configuration.json","launch.json","profiles.json","settings.json","tasks.json","tsconfig.json","tslint.json"]},java:{extensions:[".jav",".java",".jsh"]},javascript:{extensions:["._js",".bones",".cjs",".es",".es6",".frag",".gs",".jake",".javascript",".js",".jsb",".jscad",".jsfl",".jslib",".jsm",".jspre",".jss",".mjs",".njs",".pac",".sjs",".ssjs",".xsjs",".xsjslib"],filenames:["Jakefile"]},julia:{extensions:[".jl"]},kotlin:{extensions:[".kt",".ktm",".kts"]},less:{extensions:[".less"]},lua:{extensions:[".fcgi",".lua",".luau",".nse",".p8",".pd_lua",".rbxs",".rockspec",".wlua"],filenames:[".luacheckrc"]},makefile:{extensions:[".d",".mak",".make",".makefile",".mk",".mkfile"],filenames:["BSDmakefile","GNUmakefile","Kbuild","Makefile","Makefile.am","Makefile.boot","Makefile.frag","Makefile.in","Makefile.inc","Makefile.wat","makefile","makefile.sco","mkfile"]},markdown:{extensions:[".livemd",".markdown",".md",".mdown",".mdwn",".mdx",".mkd",".mkdn",".mkdown",".ronn",".scd",".workbook"],filenames:["contents.lr"]},"objective-c":{extensions:[".h",".m"]},"objective-cpp":{extensions:[".mm"]},php:{extensions:[".aw",".ctp",".fcgi",".inc",".install",".module",".php",".php3",".php4",".php5",".phps",".phpt",".theme"],filenames:[".php",".php_cs",".php_cs.dist","Phakefile"]},perl:{extensions:[".al",".cgi",".fcgi",".perl",".ph",".pl",".plx",".pm",".psgi",".t"],filenames:[".latexmkrc","Makefile.PL","Rexfile","ack","cpanfile","latexmkrc"]},powershell:{extensions:[".ps1",".psd1",".psm1"]},pug:{extensions:[".jade",".pug"]},python:{extensions:[".cgi",".codon",".fcgi",".gyp",".gypi",".lmi",".py",".py3",".pyde",".pyi",".pyp",".pyt",".pyw",".rpy",".sage",".spec",".tac",".wsgi",".xpy"],filenames:[".gclient","DEPS","SConscript","SConstruct","wscript"]},r:{extensions:[".r",".rd",".rsx"],filenames:[".Rprofile","expr-dist"]},ruby:{extensions:[".builder",".eye",".fcgi",".gemspec",".god",".jbuilder",".mspec",".pluginspec",".podspec",".prawn",".rabl",".rake",".rb",".rbi",".rbuild",".rbw",".rbx",".ru",".ruby",".spec",".thor",".watchr"],filenames:[".irbrc",".pryrc",".simplecov","Appraisals","Berksfile","Brewfile","Buildfile","Capfile","Dangerfile","Deliverfile","Fastfile","Gemfile","Guardfile","Jarfile","Mavenfile","Podfile","Puppetfile","Rakefile","Snapfile","Steepfile","Thorfile","Vagrantfile","buildfile"]},rust:{extensions:[".rs",".rs.in"]},scss:{extensions:[".scss"]},sql:{extensions:[".cql",".ddl",".inc",".mysql",".prc",".sql",".tab",".udf",".viw"]},sass:{extensions:[".sass"]},scala:{extensions:[".kojo",".sbt",".sc",".scala"]},shellscript:{extensions:[".bash",".bats",".cgi",".command",".fcgi",".fish",".ksh",".sh",".sh.in",".tmux",".tool",".trigger",".zsh",".zsh-theme"],filenames:[".bash_aliases",".bash_functions",".bash_history",".bash_logout",".bash_profile",".bashrc",".cshrc",".envrc",".flaskenv",".kshrc",".login",".profile",".tmux.conf",".zlogin",".zlogout",".zprofile",".zshenv",".zshrc","9fs","PKGBUILD","bash_aliases","bash_logout","bash_profile","bashrc","cshrc","gradlew","kshrc","login","man","profile","tmux.conf","zlogin","zlogout","zprofile","zshenv","zshrc"]},slang:{extensions:[".fxc",".hlsl",".s",".slang",".slangh",".usf",".ush",".vfx"]},slim:{extensions:[".slim"]},solidity:{extensions:[".sol"]},stylus:{extensions:[".styl"]},svelte:{extensions:[".svelte"]},swift:{extensions:[".swift"]},systemverilog:{extensions:[".sv",".svh",".vh"]},typescriptreact:{extensions:[".tsx"]},latex:{extensions:[".aux",".bbx",".cbx",".cls",".dtx",".ins",".lbx",".ltx",".mkii",".mkiv",".mkvi",".sty",".tex",".toc"]},typescript:{extensions:[".cts",".mts",".ts"]},verilog:{extensions:[".v",".veo"]},vim:{extensions:[".vba",".vim",".vimrc",".vmb"],filenames:[".exrc",".gvimrc",".nvimrc",".vimrc","_vimrc","gvimrc","nvimrc","vimrc"]},vb:{extensions:[".vb",".vbhtml",".Dsr",".bas",".cls",".ctl",".frm",".vbs"]},vue:{extensions:[".nvue",".vue"]},xml:{extensions:[".adml",".admx",".ant",".axaml",".axml",".builds",".ccproj",".ccxml",".clixml",".cproject",".cscfg",".csdef",".csl",".csproj",".ct",".depproj",".dita",".ditamap",".ditaval",".dll.config",".dotsettings",".filters",".fsproj",".fxml",".glade",".gml",".gmx",".gpx",".grxml",".gst",".hzp",".iml",".ivy",".jelly",".jsproj",".kml",".launch",".mdpolicy",".mjml",".mod",".mojo",".mxml",".natvis",".ncl",".ndproj",".nproj",".nuspec",".odd",".osm",".pkgproj",".plist",".pluginspec",".proj",".props",".ps1xml",".psc1",".pt",".pubxml",".qhelp",".rdf",".res",".resx",".rss",".sch",".scxml",".sfproj",".shproj",".srdf",".storyboard",".sublime-snippet",".svg",".sw",".targets",".tml",".typ",".ui",".urdf",".ux",".vbproj",".vcxproj",".vsixmanifest",".vssettings",".vstemplate",".vxml",".wixproj",".workflow",".wsdl",".wsf",".wxi",".wxl",".wxs",".x3d",".xacro",".xaml",".xib",".xlf",".xliff",".xmi",".xml",".xml.dist",".xmp",".xproj",".xsd",".xspec",".xul",".zcml"],filenames:[".classpath",".cproject",".project","App.config","NuGet.config","Settings.StyleCop","Web.Debug.config","Web.Release.config","Web.config","packages.config"]},xsl:{extensions:[".xsl",".xslt"]},yaml:{extensions:[".mir",".reek",".rviz",".sublime-syntax",".syntax",".yaml",".yaml-tmlanguage",".yaml.sed",".yml",".yml.mysql"],filenames:[".clang-format",".clang-tidy",".clangd",".gemrc","CITATION.cff","glide.lock","pixi.lock","yarn.lock"]},javascriptreact:{extensions:[".jsx"]},legend:{extensions:[".pure"]}};d();d();var Lje=[".ejs",".erb",".haml",".hbs",".j2",".jinja",".jinja2",".liquid",".mustache",".njk",".php",".pug",".slim",".webc"],Fje={".php":[".blade"]},dR=Object.keys(xx).flatMap(t=>xx[t].extensions);var LCe=Be(require("node:path"));var WB=class{constructor(e,r,n){this.languageId=e;this.isGuess=r;this.fileExtension=n}static{s(this,"Language")}},NO=class{static{s(this,"LanguageDetection")}},FCe=new Map,$B=new Map;for(let[t,{extensions:e,filenames:r}]of Object.entries(xx)){for(let n of e)FCe.set(n,[...FCe.get(n)??[],t]);for(let n of r??[])$B.set(n,[...$B.get(n)??[],t])}var OCe=class extends NO{static{s(this,"FilenameAndExensionLanguageDetection")}detectLanguage(e){let r=Pi(e.uri),n=LCe.extname(r).toLowerCase(),i=this.extensionWithoutTemplateLanguage(r,n),o=this.detectLanguageId(r,i),a=this.computeFullyQualifiedExtension(n,i);return o?new WB(o.languageId,o.isGuess,a):new WB(e.languageId,!0,a)}extensionWithoutTemplateLanguage(e,r){if(Lje.includes(r)){let n=e.substring(0,e.lastIndexOf(".")),i=LCe.extname(n).toLowerCase();if(i.length>0&&dR.includes(i)&&this.isExtensionValidForTemplateLanguage(r,i))return i}return r}isExtensionValidForTemplateLanguage(e,r){let n=Fje[e];return!n||n.includes(r)}detectLanguageId(e,r){if($B.has(e))return{languageId:$B.get(e)[0],isGuess:!1};let n=FCe.get(r)??[];if(n.length>0)return{languageId:n[0],isGuess:n.length>1};for(;e.includes(".");)if(e=e.replace(/\.[^.]*$/,""),$B.has(e))return{languageId:$B.get(e)[0],isGuess:!1}}computeFullyQualifiedExtension(e,r){return e!==r?r+e:e}},QCe=class extends NO{constructor(r){super();this.delegate=r}static{s(this,"GroupingLanguageDetection")}detectLanguage(r){let n=this.delegate.detectLanguage(r),i=n.languageId;return i==="c"||i==="cpp"?new WB("cpp",n.isGuess,n.fileExtension):n}},UCe=class extends NO{constructor(r){super();this.delegate=r}static{s(this,"ClientProvidedLanguageDetection")}detectLanguage(r){return r.uri.startsWith("untitled:")||r.uri.startsWith("vscode-notebook-cell:")?new WB(r.languageId,!0,""):this.delegate.detectLanguage(r)}},THt=new QCe(new UCe(new OCe));function TT({uri:t,languageId:e}){let r=THt.detectLanguage({uri:t,languageId:"UNKNOWN"});return r.languageId==="UNKNOWN"?e:r.languageId}s(TT,"detectLanguage");d();d();d();d();function Ex(t){if(t.isCancellationRequested)throw new TY}s(Ex,"throwIfCancellationRequested");function SY(t){return t instanceof TY?!0:t instanceof Error&&t.name===qCe&&t.message===qCe}s(SY,"isCancellationError");var TY=class extends Error{static{s(this,"CancellationError")}constructor(){super(qCe),this.name=this.message}},qCe="Canceled",wY=class{constructor(){this.items=[]}static{s(this,"Stack")}push(e){this.items.push(e)}pop(){return this.items.pop()}peek(){return this.items[this.items.length-1]}tryPeek(){return this.items.length>0}toArray(){return this.items}};function fR(t){switch(t){case 0:case 2:case 7:case 8:case 11:case 12:case 13:case 14:return!0;default:return!1}}s(fR,"isTypeDefinition");var qs=class t{static{s(this,"TextRange")}static{this.empty=new t(0,0)}constructor(e,r){this.start=e,this.length=r}static fromBounds(e,r){return new t(e,r-e)}get end(){return this.start+this.length}contains(e){return this.start<=e&&this.end>=e}containsRange(e){return this.start<=e.start&&this.end>=e.end}equals(e){return this.start===e.start&&this.length===e.length}getText(e){return e.slice(this.start,this.end)}getTextWithIndentation(e,r){let n=[],i=this.start;for(i=Qje(e,e.length,i),Oje(n,r);i<this.end;)e[i]!=="\r"&&e[i]!==`
`?n.push(e[i++]):e[i]==="\r"&&i<e.length&&e[i+1]!==`
`||e[i]===`
`?(n.push(`
`),i=Qje(e,e.length,++i),Oje(n,r)):i++;return n.join("")}};function Oje(t,e){for(let r=0;r<e;r++)t.push(" ")}s(Oje,"appendIndent");function Qje(t,e,r){for(;r<e&&(t[r]===" "||t[r]==="	");)r++;return r}s(Qje,"consumeIndent");var mh=class{constructor(e,r,n,i,o,a,c,l,u){this.fileName=e;this.fullyQualifiedName=r;this.unqualifiedName=n;this.commentRange=i;this.nameRange=o;this.bodyRange=a;this.extentRange=c;this.kind=l;this.refKind=u;if(e.indexOf("\\")!==-1)throw new Error("fileName must be normalized to use forward slashes as path separators")}static{s(this,"SymbolRange")}equals(e){return this.fileName===e.fileName&&this.fullyQualifiedName===e.fullyQualifiedName&&this.unqualifiedName===e.unqualifiedName&&this.commentRange.equals(e.commentRange)&&this.nameRange.equals(e.nameRange)&&this.bodyRange.equals(e.bodyRange)&&this.extentRange.equals(e.extentRange)&&this.kind===e.kind&&this.refKind===e.refKind}},al=class t{constructor(){this.queriesCache=new Map}static{s(this,"SymbolExtractorBase")}async findMatches(e,r){let n=await yx(this.languageId,e),i=n.getLanguage(),a=this.getOrCreateQuery(i,r).matches(n.rootNode);return{tree:n,matches:a}}async executeQuery(e,r,n){let i;try{i=await this.findMatches(r,n);let o=new wY,a=[];for(let c of i.matches){let l=this.createSymbolRange(o,e,r,c.captures);l&&a.push(l)}return a}catch{return[]}finally{i?.tree.delete()}}getOrCreateQuery(e,r){let n=this.queriesCache.get(r);return n||(n=e.query(r),this.queriesCache.set(r,n)),n}createSymbolRange(e,r,n,i){let o=0,a=0,c=0,l=0,u=0,f=0,p=0,m=0,h=null,g=null;for(let E=0;E<i.length;E++){let b=i[E].name;b==="name"?(u=i[E].node.startIndex,f=i[E].node.endIndex):b==="reference"?(u=i[E].node.startIndex,f=i[E].node.endIndex,c=i[E].node.startIndex,l=i[E].node.endIndex,h=b):b==="body"?(p=i[E].node.startIndex,m=i[E].node.endIndex):b==="comment"?(o=o===0?i[E].node.startIndex:Math.min(o,i[E].node.startIndex),a=Math.max(a,i[E].node.endIndex)):b==="receiver"?g=qs.fromBounds(i[E].node.startIndex,i[E].node.endIndex).getText(n):(c=i[E].node.startIndex,l=i[E].node.endIndex,h=b)}h==="definition.module.filescoped"&&(m=n.length,l=m);let A=qs.fromBounds(c,l),y=c>0||l>0||u>0||f>0?new mh(r,"","",qs.fromBounds(o,a),qs.fromBounds(u,f),qs.fromBounds(p,m),A,t.kindFromString(h),0):null;if(y){t.updateScopesForSymbol(e,y);let E=y.nameRange.getText(n),b=this.createNameFromScopes(n,e.toArray());return b=g?`${g}.${b}`:b,new mh(r,b,E.substring(E.lastIndexOf(".")+1),y.commentRange,y.nameRange,y.bodyRange,y.extentRange,y.kind,0)}return null}static updateScopesForSymbol(e,r){for(;e.tryPeek()&&!e.peek()?.extentRange.containsRange(r.extentRange);)e.pop();e.push(r)}static kindFromString(e){switch(e){case"definition.class":return 0;case"definition.constant":return 1;case"definition.enum_variant":return 3;case"definition.enum":return 2;case"definition.field":return 4;case"definition.function":return 5;case"definition.implementation":return 6;case"definition.interface":return 7;case"definition.macro":return 8;case"definition.method":return 9;case"import.module":case"definition.module":case"definition.module.filescoped":return 10;case"definition.struct":return 11;case"definition.trait":return 12;case"definition.type":return 13;case"definition.union":return 14;case"reference":return 16;case"wildcard":return 18;case"alias":return 19;case"import":return 17;default:throw new Error("NotSupportedException")}}cleanQuotedString(e){return e.replace(/^(['"])(.*)\1$/,"$2")}};var _Y=class extends al{static{s(this,"GoSymbolExtractor")}get languageId(){return"go"}extractSymbols(e,r){return this.executeQuery(e,r,wHt)}createNameFromScopes(e,r){return r.map(n=>n.nameRange.getText(e)).join(".")}},RY=class extends al{static{s(this,"GoReferenceExtractor")}get languageId(){return"go"}createNameFromScopes(e,r){return r.length>0?r[r.length-1].nameRange.getText(e):""}extractReferences(e,r){return this.executeQuery(e,r,_Ht)}async extractLocalReferences(e,r,n){let i=await this.executeQuery(e,r,RHt),o=i.filter(l=>l.kind!==9),a=i.filter(l=>l.kind===9&&l.extentRange.containsRange(n)),c=[];for(let l of a)c.push(...o.filter(u=>l.extentRange.containsRange(u.extentRange)));return c}},kY=class extends al{static{s(this,"GoImportExtractor")}get languageId(){return"go"}createNameFromScopes(e,r){return r.length>0?r[r.length-1].nameRange.getText(e):""}async extractSymbols(e,r){let n=await this.findMatches(r,SHt),i=new Set;try{n.matches.forEach(o=>{let a,c,l;for(let u of o.captures)u.name==="import.name"?a=u:u.name==="alias"?c=u:u.name==="import"&&(l=u);if(a&&l){let u=this.cleanQuotedString(a.node.text),f=a.node.startIndex+1,p=a.node.endIndex-1,m=c?new qs(c.node.startIndex,c.node.endIndex-c.node.startIndex):new qs(f,p-f),h=new qs(l.node.startIndex,l.node.endIndex-l.node.startIndex),g=qs.empty,A=qs.empty,y=u.substring(u.lastIndexOf("/")+1);i.add(new mh(e,u,y,g,m,A,h,17,0))}})}finally{n.tree.delete()}return i.size>0?[...i]:[]}},wHt=`
(
    ((comment)* @comment)
    .
    (type_declaration (type_spec name: (_) @name type: (struct_type (field_declaration_list) @body))) @definition.struct
)

(
    ((comment)* @comment)
    .
    (type_declaration (type_spec name: (_) @name type: (interface_type (_)) @body)) @definition.interface
)

(
    ((comment)* @comment)
    .
    (method_declaration receiver: (parameter_list (parameter_declaration type: [(type_identifier) @receiver (pointer_type (type_identifier) @receiver)] )) name: (_) @name body: (_) @body) @definition.method
)

(
    ((comment)* @comment)
    .
    (method_elem name: (_) @name) @definition.method
)

(
    ((comment)* @comment)
    .
    (function_declaration name: (_) @name) @definition.method
)

(
    ((comment)* @comment)
    .
    (field_declaration name: (_) @name) @definition.field
)
`,SHt=`
(import_declaration
  (import_spec
    name: (package_identifier)? @alias
    path: (interpreted_string_literal) @import.name)+) @import
    
(import_declaration
  (import_spec_list
    (import_spec
      name: (package_identifier)? @alias
      path: (interpreted_string_literal) @import.name))+) @import
`,_Ht=`
(call_expression function: (_) @name) @reference

(type_identifier) @reference
`,RHt=`
(call_expression function: (_) @name) @reference

(type_identifier) @reference
`;d();var DY=class extends al{static{s(this,"JavaSymbolExtractor")}get languageId(){return"java"}extractSymbols(e,r){return this.executeQuery(e,r,kHt)}createNameFromScopes(e,r){return r.map(n=>n.nameRange.getText(e)).join(".")}},BY=class extends al{static{s(this,"JavaReferenceExtractor")}get languageId(){return"java"}createNameFromScopes(e,r){return r.length>0?r[r.length-1].nameRange.getText(e):""}extractReferences(e,r){return this.executeQuery(e,r,DHt)}async extractLocalReferences(e,r,n){let i=await this.executeQuery(e,r,BHt),o=i.filter(l=>l.kind!==9),a=i.filter(l=>l.kind===9&&l.extentRange.containsRange(n)),c=[];for(let l of a)c.push(...o.filter(u=>l.extentRange.containsRange(u.extentRange)));return c}},NY=class extends al{static{s(this,"JavaImportExtractor")}get languageId(){return"java"}createNameFromScopes(e,r){return r.length>0?r[r.length-1].nameRange.getText(e):""}async extractSymbols(e,r){return(await this.executeQuery(e,r,PHt)).filter(i=>i.kind===0)}},kHt=`
(
    [
        (block_comment) @comment
        (line_comment)* @comment
    ]
    .
    (class_declaration name: (identifier) @name body: (class_body) @body) @definition.class
)

(
    [
        (block_comment) @comment
        (line_comment)* @comment
    ]
    .
    (constructor_declaration name: (identifier) @name body: (constructor_body) @body) @definition.method
)

(
    [
        (block_comment) @comment
        (line_comment)* @comment
    ]
    .
    (method_declaration name: (identifier) @name body: (block)? @body) @definition.method
)

(
    [
        (block_comment) @comment
        (line_comment)* @comment
    ]
    .
    (interface_declaration name: (identifier) @name body: (interface_body) @body) @definition.interface
)

(
    [
        (block_comment) @comment
        (line_comment)* @comment
    ]
    .
    (field_declaration declarator: (variable_declarator name: (identifier) @name)) @definition.field
)

(
    [
        ((line_comment)* @comment)
        ((block_comment)* @comment)
    ]
    .
    (enum_declaration name: (_) @name body: (_) @body) @definition.enum
)

(
    [
        ((line_comment)* @comment)
        ((block_comment)* @comment)
    ]
    .
    (enum_constant name: (identifier) @name) @definition.enum_variant
)
`,PHt=`
(
    [
        ((line_comment)* @comment)
        ((block_comment)* @comment)
    ]
    .
    (import_declaration 
        (scoped_identifier) @name
        (asterisk)? @wildcard
    ) @definition.class 
)
`,DHt=`
(method_invocation 
  name: (identifier) @name
) @reference

(type_identifier) @reference
`,BHt=`
(method_invocation 
  name: (identifier) @name
) @reference

(type_identifier) @reference
`;d();var NHt=new Set(["null","undefined","void","object","symbol","bigint","Array","Promise","Date","RegExp","Map","Set"]),MY=class extends al{static{s(this,"JavaScriptSymbolExtractor")}get languageId(){return"javascript"}extractSymbols(e,r){return this.executeQuery(e,r,MHt)}createNameFromScopes(e,r){return r.map(n=>n.nameRange.getText(e)).join(".")}},LY=class extends al{static{s(this,"JavaScriptReferenceExtractor")}extractLocalReferences(e,r,n){throw new Error("Method not implemented.")}get languageId(){return"javascript"}createNameFromScopes(e,r){return r.length>0?r[r.length-1].nameRange.getText(e):""}async extractReferences(e,r){return(await this.executeQuery(e,r,LHt)).filter(i=>!NHt.has(i.unqualifiedName))}};var MHt=`
(
    ((comment)* @comment)
    .
    [
        (class_declaration name: (_) @name body: (_) @body) @definition.class
        (function_declaration name: (_) @name body: (_) @body) @definition.function
        (export_statement declaration: (lexical_declaration (variable_declarator name: (identifier) @name value: (_) @body))) @definition.function
    ]
)
`,LHt=`
(call_expression function: (_) @name) @reference
`;d();var FHt=new Set(["int","str","float","bool","list","dict","tuple","set"]),FY=class extends al{static{s(this,"PythonSymbolExtractor")}get languageId(){return"python"}extractSymbols(e,r){return this.executeQuery(e,r,OHt)}createNameFromScopes(e,r){return r.map(n=>n.nameRange.getText(e)).join(".")}},OY=class extends al{static{s(this,"PythonReferenceExtractor")}get languageId(){return"python"}createNameFromScopes(e,r){return r.length>0?r[r.length-1].nameRange.getText(e):""}async extractReferences(e,r){return(await this.executeQuery(e,r,QHt)).filter(i=>!FHt.has(i.unqualifiedName))}async extractLocalReferences(e,r,n){let i=await this.executeQuery(e,r,qHt),o=i.filter(l=>l.kind!==9),a=i.filter(l=>l.kind===9&&l.extentRange.containsRange(n)),c=[];for(let l of a)c.push(...o.filter(u=>l.extentRange.containsRange(u.extentRange)));return c}},QY=class extends al{static{s(this,"PythonImportExtractor")}get languageId(){return"python"}createNameFromScopes(e,r){return r.length>0?r[r.length-1].nameRange.getText(e):""}async extractSymbols(e,r){let n=await this.findMatches(r,UHt),i=new Set;try{n.matches.forEach(o=>{let a,c,l,u;for(let f of o.captures)f.name==="import.name"?a=f:f.name==="import.module"?l=f:f.name==="alias"?c=f:f.name==="import"&&(u=f);if(l&&u){let f=a||l,p=c?new qs(c.node.startIndex,c.node.endIndex-c.node.startIndex):new qs(f.node.startIndex,u.node.endIndex-f.node.endIndex),m=new qs(u.node.startIndex,u.node.endIndex-u.node.startIndex),h=qs.empty,g=qs.empty,A=f.node.text,y=A.split(".").pop()||A,E;a?E=`${l.node.text}.${a.node.text}`:E=l.node.text,i.add(new mh(e,E,y,h,p,g,m,17,0))}})}finally{n.tree.delete()}return i.size>0?[...i]:[]}},OHt=`
(
    ((comment)* @comment)
    .
    (class_definition name: (_) @name body: (_) @body) @definition.class
)

(
    ((comment)* @comment)
    .
    (function_definition name: (_) @name body: (_) @body) @definition.method
)
`,QHt=`
(call function: (_) @name) @reference

(type [  
    (identifier)* @name  
    (_ (identifier) @name)* 
]) @reference

(class_definition superclasses: (argument_list (identifier) @name)) @reference
`,UHt=`  
(import_statement name: (dotted_name) @import.module) @import

(import_from_statement
  module_name: (dotted_name) @import.module
  name: (dotted_name (identifier) @import.name)) @import

(import_statement name: (aliased_import name: (dotted_name) @import.module alias: (identifier)? @alias)) @import

(import_from_statement 
  module_name: (dotted_name) @import.module
    name: 
      (aliased_import 
        name: ((dotted_name) @import.name)
        alias: (identifier) @alias)) @import
`,qHt=`
(call function: (_) @name) @reference

(type [  
    (identifier)* @name  
    (_ (identifier) @name)* 
])  @reference

(class_definition superclasses: (argument_list (identifier) @name)) @reference
`;d();var HHt=new Set(["string","number","boolean","null","undefined","void","any","never","object","symbol","bigint","Array","Promise","Date","RegExp","Map","Set"]),jB=class extends al{static{s(this,"TypeScriptSymbolExtractor")}get languageId(){return"typescript"}extractSymbols(e,r){return this.executeQuery(e,r,$Ht)}createNameFromScopes(e,r){return r.map(n=>n.nameRange.getText(e)).join(".")}},GB=class extends al{static{s(this,"TypeScriptReferenceExtractor")}get languageId(){return"typescript"}createNameFromScopes(e,r){return r.length>0?r[r.length-1].nameRange.getText(e):""}async extractReferences(e,r){return(await this.executeQuery(e,r,WHt)).filter(i=>!HHt.has(i.unqualifiedName))}extractLocalReferences(){return Promise.reject(new Error("Method not implemented."))}};var $Ht=`
(
    ((comment)* @comment)
    .
    [
        (class_declaration name: (_) @name body: (_) @body) @definition.class
        (interface_declaration name: (_) @name body: (_) @body) @definition.interface
        (type_alias_declaration name: (type_identifier) @name) @definition.type
        (abstract_class_declaration name: (type_identifier) @name) @definition.class
        (enum_declaration name: (identifier) @name) @definition.type
    ]
)

(
    ((comment)* @comment)
    .
    [
        (method_definition name: (_) @name body: (_) @body) @definition.method
        (function_declaration name: (_) @name body: (_) @body) @definition.function
        (function_signature name: (identifier) @name) @definition.function
        (method_signature name: (property_identifier) @name) @definition.method
        (abstract_method_signature name: (property_identifier) @name) @definition.method
        (variable_declarator name: (identifier) @name type: (type_annotation (type_identifier)))
    ]
)
`,WHt=`
(call_expression function: (_) @name) @reference

(type_identifier) @name @reference

(new_expression constructor: (identifier) @name) @reference
`;d();var jHt=new Set(["string","number","boolean","null","undefined","void","any","never","object","symbol","bigint","Array","Promise","Date","RegExp","Map","Set"]),UY=class extends jB{static{s(this,"TypeScriptReactSymbolExtractor")}get languageId(){return"typescriptreact"}extractSymbols(e,r){return Promise.all([this.executeQuery(e,r,GHt),super.extractSymbols(e,r)]).then(([n,i])=>[...n,...i])}createNameFromScopes(e,r){return r.map(n=>n.nameRange.getText(e)).join(".")}},qY=class extends GB{static{s(this,"TypeScriptReactReferenceExtractor")}get languageId(){return"typescriptreact"}createNameFromScopes(e,r){return r.length>0?r[r.length-1].nameRange.getText(e):""}async extractReferences(e,r){let[n,i]=await Promise.all([this.executeQuery(e,r,VHt),super.extractReferences(e,r)]);return[...n.filter(o=>!jHt.has(o.unqualifiedName)),...i]}},GHt=`
(
    ((comment)* @comment)
    .
    [
        (lexical_declaration
            (variable_declarator
            name: (identifier) @name
            value: (arrow_function
                parameters: (_) 
                body: (_) @body))) @definition.function
    ]
)
`,VHt=`
    (jsx_element open_tag: (jsx_opening_element name: (_) @name) close_tag: (jsx_closing_element) ) @reference
    
    (jsx_self_closing_element name: (_) @name) @reference
    
    (import_specifier name:(identifier) @name) @reference
`;var MO=[{symbolExtractor:new DY,referenceExtractor:new BY,importExtractor:new NY,languageId:"java"},{symbolExtractor:new _Y,referenceExtractor:new RY,importExtractor:new kY,languageId:"go"},{symbolExtractor:new FY,referenceExtractor:new OY,importExtractor:new QY,languageId:"python"},{symbolExtractor:new jB,referenceExtractor:new GB,languageId:"typescript"},{symbolExtractor:new UY,referenceExtractor:new qY,languageId:"typescriptreact"},{symbolExtractor:new MY,referenceExtractor:new LY,languageId:"javascript"}];function Uje(t){let e=TT({uri:t});if(e&&MO.some(r=>e===r.languageId))return e}s(Uje,"getSupportedLanguageIdForMultiLanguageProvider");var qje=new Map(MO.map(t=>[t.languageId,t.referenceExtractor])),HY=new Map(MO.map(t=>[t.languageId,t.symbolExtractor])),Hje=new Map(MO.filter(t=>t.importExtractor!==void 0).map(t=>[t.languageId,t.importExtractor])),HCe=MO.map(t=>xx[t.languageId].extensions).flat();d();d();d();d();d();d();d();d();d();function $Ce(t,e,r){return{type:"virtual",indentation:t,subs:e,label:r}}s($Ce,"virtualNode");function $je(t,e,r,n,i){if(r==="")throw new Error("Cannot create a line node with an empty source line");return{type:"line",indentation:t,lineNumber:e,sourceLine:r,subs:n,label:i}}s($je,"lineNode");function WCe(t){return{type:"blank",lineNumber:t,subs:[]}}s(WCe,"blankNode");function $Y(t){return{type:"top",indentation:-1,subs:t??[]}}s($Y,"topNode");function ed(t){return t.type==="blank"}s(ed,"isBlank");function pR(t){return t.type==="line"}s(pR,"isLine");function mR(t){return t.type==="virtual"}s(mR,"isVirtual");d();function Wje(t,e){return Qd(t,r=>{r.label=r.label?e(r.label)?void 0:r.label:void 0},"bottomUp"),t}s(Wje,"clearLabelsIf");function hR(t,e){switch(t.type){case"line":case"virtual":{let r=t.subs.map(n=>hR(n,e));return{...t,subs:r,label:t.label?e(t.label):void 0}}case"blank":return{...t,label:t.label?e(t.label):void 0};case"top":return{...t,subs:t.subs.map(r=>hR(r,e)),label:t.label?e(t.label):void 0}}}s(hR,"mapLabels");function Qd(t,e,r){function n(i){r==="topDown"&&e(i),i.subs.forEach(o=>{n(o)}),r==="bottomUp"&&e(i)}s(n,"_visit"),n(t)}s(Qd,"visitTree");function jCe(t,e,r,n){let i=e;function o(a){i=r(a,i)}return s(o,"visitor"),Qd(t,o,n),i}s(jCe,"foldTree");function WY(t,e,r){let n=s(o=>{if(r!==void 0&&r(o))return o;{let a=o.subs.map(n).filter(c=>c!==void 0);return o.subs=a,e(o)}},"rebuild"),i=n(t);return i!==void 0?i:$Y()}s(WY,"rebuildTree");d();function KHt(t){let e=t.split(`
`),r=e.map(u=>u.match(/^\s*/)[0].length),n=e.map(u=>u.trimLeft());function i(u){let[f,p]=o(u+1,r[u]);return[$je(r[u],u,n[u],f),p]}s(i,"parseNode");function o(u,f){let p,m=[],h=u,g;for(;h<n.length&&(n[h]===""||r[h]>f);)if(n[h]==="")g===void 0&&(g=h),h+=1;else{if(g!==void 0){for(let A=g;A<h;A++)m.push(WCe(A));g=void 0}[p,h]=i(h),m.push(p)}return g!==void 0&&(h=g),[m,h]}s(o,"parseSubs");let[a,c]=o(0,-1),l=c;for(;l<n.length&&n[l]==="";)a.push(WCe(l)),l+=1;if(l<n.length)throw new Error(`Parsing did not go to end of file. Ended at ${l} out of ${n.length}`);return $Y(a)}s(KHt,"parseRaw");function LO(t,e){function r(n){if(pR(n)){let i=e.find(o=>o.matches(n.sourceLine));i&&(n.label=i.label)}}s(r,"visitor"),Qd(t,r,"bottomUp")}s(LO,"labelLines");function jY(t){function e(r){if(mR(r)&&r.label===void 0){let n=r.subs.filter(i=>!ed(i));n.length===1&&(r.label=n[0].label)}}s(e,"visitor"),Qd(t,e,"bottomUp")}s(jY,"labelVirtualInherited");function FO(t){return Object.keys(t).map(e=>{let r;return t[e].test?r=s(n=>t[e].test(n),"matches"):r=t[e],{matches:r,label:e}})}s(FO,"buildLabelRules");function GCe(t){let r=WY(t,s(function(n){if(n.subs.length===0||n.subs.findIndex(a=>a.label==="closer"||a.label==="opener")===-1)return n;let i=[],o;for(let a=0;a<n.subs.length;a++){let c=n.subs[a],l=n.subs[a-1];if(c.label==="opener"&&l!==void 0&&pR(l))l.subs.push(c),c.subs.forEach(u=>l.subs.push(u)),c.subs=[];else if(c.label==="closer"&&o!==void 0&&(pR(c)||mR(c))&&c.indentation>=o.indentation){let u=i.length-1;for(;u>0&&ed(i[u]);)u-=1;if(o.subs.push(...i.splice(u+1)),c.subs.length>0){let f=o.subs.findIndex(g=>g.label!=="newVirtual"),p=o.subs.slice(0,f),m=o.subs.slice(f),h=m.length>0?[$Ce(c.indentation,m,"newVirtual")]:[];o.subs=[...p,...h,c]}else o.subs.push(c)}else i.push(c),ed(c)||(o=c)}return n.subs=i,n},"rebuilder"));return Wje(t,n=>n==="newVirtual"),r}s(GCe,"combineClosersAndOpeners");function jje(t,e=ed,r){return WY(t,s(function(i){if(i.subs.length<=1)return i;let o=[],a=[],c,l=!1;function u(f=!1){if(c!==void 0&&(o.length>0||!f)){let p=$Ce(c,a,r);o.push(p)}else a.forEach(p=>o.push(p))}s(u,"flushBlockIntoNewSubs");for(let f=0;f<i.subs.length;f++){let p=i.subs[f],m=e(p);!m&&l&&(u(),a=[]),l=m,a.push(p),ed(p)||(c=c??p.indentation)}return u(!0),i.subs=o,i},"rebuilder"))}s(jje,"groupBlocks");function gR(t){return WY(t,s(function(r){return mR(r)&&r.label===void 0&&r.subs.length<=1?r.subs.length===0?void 0:r.subs[0]:(r.subs.length===1&&mR(r.subs[0])&&r.subs[0].label===void 0&&(r.subs=r.subs[0].subs),r)},"rebuilder"))}s(gR,"flattenVirtual");var YHt={opener:/^[[({]/,closer:/^[\])}]/},JHt=FO(YHt),Gje={};function VCe(t,e){Gje[t]=e}s(VCe,"registerLanguageSpecificParser");function AR(t,e){let r=KHt(t),n=Gje[e??""];return n?n(r):(LO(r,JHt),GCe(r))}s(AR,"parseTree");var XHt={package:/^package /,import:/^import /,class:/\bclass /,interface:/\binterface /,javadoc:/^\/\*\*/,comment_multi:/^\/\*[^*]/,comment_single:/^\/\//,annotation:/^@/,opener:/^[[({]/,closer:/^[\])}]/},ZHt=FO(XHt);function Vje(t){let e=t;return LO(e,ZHt),e=GCe(e),e=gR(e),jY(e),Qd(e,r=>{if(r.label==="class"||r.label==="interface")for(let n of r.subs)!ed(n)&&(n.label===void 0||n.label==="annotation")&&(n.label="member")},"bottomUp"),e}s(Vje,"processJava");d();var e$t={heading:/^# /,subheading:/^## /,subsubheading:/### /},t$t=FO(e$t);function zje(t){let e=t;if(LO(e,t$t),ed(e))return e;function r(o){if(o.label==="heading")return 1;if(o.label==="subheading")return 2;if(o.label==="subsubheading")return 3}s(r,"headingLevel");let n=[e],i=[...e.subs];e.subs=[];for(let o of i){let a=r(o);if(a===void 0||ed(o))n[n.length-1].subs.push(o);else{for(;n.length<a;)n.push(n[n.length-1]);for(n[a-1].subs.push(o),n[a]=o;n.length>a+1;)n.pop()}}return e=jje(e),e=gR(e),jY(e),e}s(zje,"processMarkdown");d();function Kje(t){return" ".repeat(t.indentation)+t.sourceLine+`
`}s(Kje,"deparseLine");VCe("markdown",zje);VCe("java",Vje);var r$t={worthUp:.9,worthSibling:.88,worthDown:.8};function zCe(t,e,r=Li(),n=r$t){let i=hR(t,o=>o?1:void 0);return Qd(i,o=>{if(ed(o))return;let a=o.subs.reduce((c,l)=>Math.max(c,l.label??0),0);o.label=Math.max(o.label??0,a*n.worthUp)},"bottomUp"),Qd(i,o=>{if(ed(o))return;let a=o.subs.map(u=>u.label??0),c=[...a];for(let u=0;u<a.length;u++)a[u]!==0&&(c=c.map((f,p)=>Math.max(f,Math.pow(n.worthSibling,Math.abs(u-p))*a[u])));let l=o.label;l!==void 0&&(c=c.map(u=>Math.max(u,n.worthDown*l))),o.subs.forEach((u,f)=>u.label=c[f])},"topDown"),n$t(i,e,r)}s(zCe,"fromTreeWithFocussedLines");function n$t(t,e,r=Li()){let n=jCe(t,[],(i,o)=>((i.type==="line"||i.type==="blank")&&o.push(i.type==="line"?[Kje(i).trimEnd(),i.label??0]:["",i.label??0]),o),"topDown");return new Ut(n,e,r)}s(n$t,"fromTreeWithValuedLines");function q0(t,e=!0,r=!0,n,i=Li()){let o=typeof t=="string"?AR(t):AR(t.source,t.languageId);gR(o);let a=hR(o,c=>e&&c!=="closer");return Qd(a,c=>{c.label===void 0&&(c.label=e&&c.label!==!1)},"topDown"),e&&Qd(a,c=>{if(c.label){let l=!1;for(let u of[...c.subs].reverse())u.label&&!l?l=!0:u.label=!1}else for(let l of c.subs)l.label=!1;c.subs.length>0&&(c.label=!1)},"topDown"),r&&Qd(a,c=>{c.label||=(pR(c)||ed(c))&&c.lineNumber==0},"topDown"),zCe(a,n,i)}s(q0,"elidableTextForSourceCode");d();var OO=class t{constructor(e,r,n,i="strict",o){this.text=e;this._value=r;this._cost=n;this.metadata=o;this.markedForRemoval=!1;if(e.includes(`
`)&&i!=="none")throw new Error("LineWithValueAndCost: text contains newline");if(r<0&&i!=="none")throw new Error("LineWithValueAndCost: value is negative");if(n<0&&i!=="none")throw new Error("LineWithValueAndCost: cost is negative");if(i=="strict"&&r>1)throw new Error("Value should normally be between 0 and 1 -- set validation to `loose` to ignore this error")}static{s(this,"LineWithValueAndCost")}get value(){return this._value}get cost(){return this._cost}adjustValue(e){return this._value*=e,this}setValue(e){return this._value=e,this}recost(e=r=>Li().tokenLength(r+`
`)){return this._cost=e(this.text),this}copy(){let e=new t(this.text,this.value,this.cost,"none",this.metadata);return e.markedForRemoval=this.markedForRemoval,e}};var Ut=class t{constructor(e,r,n=Li()){this.metadata=r;this.tokenizer=n;this.lines=[];let i=[];for(let o of e){let a=Array.isArray(o)?o[1]:1,c=Array.isArray(o)?o[0]:o;typeof c=="string"?c.split(`
`).forEach(l=>i.push(new OO(l,a,n.tokenLength(l+`
`),"strict",this.metadata))):c instanceof t?c.lines.forEach(l=>i.push(l.copy().adjustValue(a))):"source"in c&&"languageId"in c&&q0(c).lines.forEach(l=>i.push(l.copy().adjustValue(a)))}this.lines=i}static{s(this,"ElidableText")}adjust(e){this.lines.forEach(r=>r.adjustValue(e))}recost(e=r=>Li().tokenLength(r+`
`)){this.lines.forEach(r=>r.recost(e))}elide(e,r="[...]",n=!0,i="removeLeastDesirable",o=this.tokenizer,a="topToBottom"){if(o.tokenLength(r+`
`)>e)throw new Error("maxTokens must be larger than the ellipsis length");let{lines:c,totalCost:l,priorityQueue:u}=o$t(this.lines,i);if(l<=e)return KCe(c);s$t(u,a);let f=l;for(;f>e&&u.length>0;){let m=u.shift().originalIndex,h=c[m];if(h.markedForRemoval)continue;let g=n?a$t(c,m):"",A=Yje(g,r,o,h);c[m]=A,f-=h.cost,f+=A.cost;let y=m+1;if(y<c.length){let b=c[y];GY(b,r)&&(f-=b.cost,b.markedForRemoval=!0)}let E=m-1;if(E>=0){let b=c[E];GY(b,r)&&(f-=b.cost,b.markedForRemoval=!0)}}if(f>e)return KCe([Yje("",r,o)]);let p=c.filter(m=>!m.markedForRemoval);for(let m=p.length-1;m>0;m--)GY(p[m],r)&&GY(p[m-1],r)&&p.splice(m,1);return KCe(p)}};function i$t(t){return t?.text.match(/^\s*/)?.[0]??""}s(i$t,"getIndentation");function GY(t,e){return t?.text.trim()===e.trim()}s(GY,"isEllipsis");function KCe(t){return{getText:s(()=>t.map(e=>e.text).join(`
`),"getText"),getLines:s(()=>t,"getLines")}}s(KCe,"produceElidedText");function o$t(t,e){let r=0,n=[];return{lines:t.map((o,a)=>{let c=o.copy();return e==="removeLeastBangForBuck"&&c.adjustValue(1/c.cost),r+=c.cost,n.push({originalIndex:a,value:c.value}),c}),totalCost:r,priorityQueue:n}}s(o$t,"initializeElisionContext");function s$t(t,e){t.sort((r,n)=>r.value!==n.value?r.value-n.value:e==="bottomToTop"?n.originalIndex-r.originalIndex:r.originalIndex-n.originalIndex)}s(s$t,"sortPriorityQueue");function a$t(t,e){let r="";for(let n=e;n>=0;n--){let i=t[n];if(!i.markedForRemoval&&i.text.trim()!==""){r=i$t(i);break}}return r}s(a$t,"getClosestIndentation");function Yje(t,e,r,n){let i=t+e;return new OO(i,1/0,r.tokenLength(i+`
`),"loose",n?.metadata)}s(Yje,"getNewEllipsis");d();var Jje=require("fs");async function Xje(t,e,r,n,i){let o=new Map,a=0;for(let p of t){let m=p.node.fileName.toLowerCase(),h=o.get(m);h?h.symbols.push(p):o.set(m,{symbols:[p],topRank:a}),a++}if(o.delete(r.toLowerCase()),o.size===0)return[];let c=e,l=e/Math.min(4,o.size),u=[],f=Array.from(o.keys());f.sort((p,m)=>{let h=o.get(p).topRank,g=o.get(m).topRank;return h-g});for(let p of f){let m=o.get(p).symbols;if(m.length===0)continue;let h=m[0].node.fileName,g=m.reduce((A,y)=>A+y.node.extentRange.length,0);for(let A of m){if(c<=5)return u;Ex(i);let y=A.node.extentRange.length/g,E=Math.min(c,y*l),b=(await c$t([A])).elide(E).getText();c-=n.tokenLength(b),u.push({uri:h,value:b})}}return u}s(Xje,"symbolRangesToCodeSnippets");async function c$t(t){if(t.length===0)return new Ut([]);let e=t[0].node.fileName,r=[],n="";try{let i=ts(e);i&&(n=(await Jje.promises.readFile(i)).toString())}catch{}for(let i of t)Zje(i,n).forEach(o=>r.push(o));return new Ut(r)}s(c$t,"sameFileSymbolRangeToElidableText");function Zje(t,e){let n=[],i=t.node,o=e.substring(YCe(e,i.commentRange.start),i.commentRange.end);n.push([JCe(o),1-3e-4]);let a=YCe(e,i.bodyRange.start),c=YCe(e,i.extentRange.start),l=i.bodyRange.length===0?e.substring(c,i.extentRange.end):e.substring(i.commentRange.length===0?c:i.commentRange.end,a);if(fR(i.kind)&&(l="BEGIN "+l.trimStart()),n.push([JCe(l),1-1e-4]),t.children.length>0)for(let u of t.children)n.push(...Zje(u,e));else{let u=1-(fR(t.node.kind)?3e-4:4e-4),f=e.substring(a,i.bodyRange.end);n.push([JCe(f),u])}return fR(i.kind)&&n.push(["END "+l.substring(6),1-1e-4]),n.filter(u=>u[0].length>0)}s(Zje,"prepareForElidableText");function YCe(t,e){for(;e-1>=0&&(t[e-1]==="	"||t[e-1]===" ");)e--;return e}s(YCe,"shiftLeftToNearestLineEndingOrAlphanumeric");function JCe(t){let e=0;for(;e<t.length&&(t[e]==="\r"||t[e]===`
`);)e++;let r=t.length-1;for(;r>=0&&(t[r]==="\r"||t[r]===`
`||t[r]===" "||t[r]==="	");)r--;return t.substring(e,r+1)}s(JCe,"trimLineEndingsAndTrailingWhitespace");var XCe=class{constructor(e,r){this.referenceExtractors=new Map;this.index=e,this.referenceExtractors=r}static{s(this,"ContextRetrievalStrategy")}},wT=class extends XCe{static{s(this,"UnqualifiedNameRetrievalStrategy")}constructor(e,r,n,i){super(e,r),this.caseSensitive=n,this.typesOnly=i}async getContextAtPositionAsync(e,r,n,i,o,a){let c=this.referenceExtractors.get(i);if(!c)return[];Ex(a);let l=await c.extractReferences(e,r);Ex(a);let u=Array.from(l);u.sort((h,g)=>this.compareSymbolRangesByProximityToCaret(h,g,n));let f=[],p=new Set,m=await this.findDefinitionsViaUnqualifiedNames(u,o,a);this.typesOnly&&(m=m.filter(h=>fR(h.kind)));for(let h of m)p.has(JSON.stringify(h))||(p.add(JSON.stringify(h)),f.push(await this.makeSymbolRangeNodeFromDefinition(h,a)));return f}async findDefinitionsViaUnqualifiedNames(e,r,n){let i=Array.from(new Set(e.map(p=>p.unqualifiedName))),o=!this.caseSensitive,a=await this.index.findPotentialDefinitionsAsync(i,o,n),c=s(p=>o?p.toLowerCase():p,"lowercaseIfCaseInsensitive"),l=s(p=>c(p.unqualifiedName),"getSymbolKey"),u=new Map;for(let p of a){let m=l(p),h=u.get(m)??[];u.set(m,[...h,p])}let f=[];for(let p of i){let m=u.get(c(p));if(!(!m||m.length>r.mlcpMaxSymbolMatches)){if(f.length+m.length>r.mlcpMaxContextItems){f.push(...m.slice(0,r.mlcpMaxContextItems-f.length));break}f.push(...m)}}return f}async makeSymbolRangeNodeFromDefinition(e,r){if(Ex(r),fR(e.kind)){let n=await this.index.findSymbolsByFullyQualifiedNamePrefix(e.fileName,e.fullyQualifiedName+".",r),i=await Promise.all(n.map(o=>this.makeSymbolRangeNodeFromDefinition(o,r)));return{node:e,children:i}}else return{node:e,children:[]}}compareSymbolRangesByProximityToCaret(e,r,n){let i=e.extentRange.end<=n,o=r.extentRange.end<=n;if(i&&!o)return-1;if(!i&&o)return 1;let a=Math.abs(e.extentRange.start-n),c=Math.abs(r.extentRange.start-n);return a-c}},VY=class{constructor(e,r){this.strategies=new Map;this.strategies.set("go",new wT(e,r,!0,!0)),this.strategies.set("java",new wT(e,r,!0,!0)),this.strategies.set("python",new wT(e,r,!0,!1)),this.strategies.set("typescript",new wT(e,r,!0,!0)),this.strategies.set("typescriptreact",new wT(e,r,!0,!0)),this.strategies.set("javascript",new wT(e,r,!0,!1))}static{s(this,"SyntaxAwareContextRetrieval")}async getStringifiedContextAtPositionAsync(e,r,n,i,o,a,c){let l=await this.getContextAtPositionAsync(e,r,n,i,o,c);Ex(c);let u=Li();return Xje(l,a,e,u,c)}async getContextAtPositionAsync(e,r,n,i,o,a){return this.strategies.has(i)?this.strategies.get(i).getContextAtPositionAsync(e,r,n,i,o,a):[]}};d();d();d();d();var yR={Id:"id"},H0={FilePath:"filePath",LastWriteTimeUtc:"lastWriteTimeUtc"},fo={DocumentId:"documentId",FullyQualifiedName:"fullyQualifiedName",UnqualifiedName:"unqualifiedName",CommentStart:"commentStart",CommentLength:"commentLength",NameStart:"nameStart",NameLength:"nameLength",BodyStart:"bodyStart",BodyLength:"bodyLength",ExtentStart:"extentStart",ExtentLength:"extentLength",SymbolKind:"symbolKind",RefKind:"refKind"};d();d();var zY=class{constructor(e,r,n){this.tableName=e;this.createOptimizations=r;this.extraCreateDeclarations=n;this.primaryKey=new ZCe(yR.Id)}static{s(this,"SQLTableQueryGenerator")}createTableQueries(){return this.createTableString??=this.generateCreateTableString(),[this.createTableString,...this.createOptimizations]}generateCreateTableString(){let e=this.fields.map(r=>r.initColumnString());return this.extraCreateDeclarations&&e.push(this.extraCreateDeclarations),e.push(),[`CREATE TABLE IF NOT EXISTS ${this.tableName} (`,`    ${this.primaryKey.initColumnString()},`,`    ${e.join(`,
`)}`,")"].join(`
`)}insertQuery(e,r){this.cachedInsertQueryStrings??=this.generateInsertQueryStrings();let n=[this.cachedInsertQueryStrings.prefix,Array(r).fill(this.cachedInsertQueryStrings.valuesTemplate).join(`,
`)];return e&&n.push("ON CONFLICT DO NOTHING"),n.join(`
`)}generateInsertQueryStrings(){return{prefix:`INSERT INTO ${this.tableName} (${this.fields.map(e=>e.name).join(", ")})
VALUES`,valuesTemplate:`(${Array(this.fields.length).fill("?").join(", ")})`}}},QO=class t extends zY{constructor(){super(t.tableName,[`CREATE UNIQUE INDEX IF NOT EXISTS 'IX_Document_FilePath' ON '${t.tableName}' ('${H0.FilePath}');`]);this.fields=[new HO(H0.FilePath,{notNull:!0,collate:!0,noCase:!0,unique:!0}),new Tp(H0.LastWriteTimeUtc,{notNull:!0})]}static{s(this,"DocumentQueryGenerator")}static{this.tableName="Document"}},UO=class t extends zY{constructor(){super(t.tableName,[`CREATE INDEX IF NOT EXISTS 'IX_Symbol_DocumentId' ON '${t.tableName}' ('${fo.DocumentId}', '${fo.ExtentStart}', '${fo.ExtentLength}');`,`CREATE INDEX IF NOT EXISTS 'IX_Symbol_UnqualifiedName' ON '${t.tableName}' ('${fo.UnqualifiedName}');`],`FOREIGN KEY(${fo.DocumentId}) REFERENCES Document(${yR.Id}) ON DELETE CASCADE`);this.fields=[new Tp(fo.DocumentId),new HO(fo.FullyQualifiedName,{notNull:!0}),new HO(fo.UnqualifiedName,{notNull:!0}),new Tp(fo.CommentStart,{notNull:!0}),new Tp(fo.CommentLength,{notNull:!0}),new Tp(fo.NameStart,{notNull:!0}),new Tp(fo.NameLength,{notNull:!0}),new Tp(fo.BodyStart,{notNull:!0}),new Tp(fo.BodyLength,{notNull:!0}),new Tp(fo.ExtentStart,{notNull:!0}),new Tp(fo.ExtentLength,{notNull:!0}),new Tp(fo.SymbolKind,{notNull:!0}),new Tp(fo.RefKind,{notNull:!0})]}static{s(this,"SymbolQueryGenerator")}static{this.tableName="Symbol"}},qO=class{constructor(e,r){this.name=e;this.notNull=r?.notNull??!1}static{s(this,"SQLField")}},HO=class extends qO{static{s(this,"StringColumn")}constructor(e,r){super(e,{notNull:r?.notNull}),this.collate=r?.collate??!1,this.noCase=r?.noCase??!1,this.unique=r?.unique??!1}initColumnString(){let e=this.collate?"COLLATE":void 0,r=this.noCase?"NOCASE":void 0,n=this.notNull?"NOT NULL":void 0,i=this.unique?"UNIQUE":void 0,o=[e,r,n,i].filter(a=>a).join(" ");return`'${this.name}' VARCHAR(500) ${o}`}},Tp=class extends qO{static{s(this,"NumberColumn")}initColumnString(){return`'${this.name}' INTEGER${this.notNull?" NOT NULL":""}`}},ZCe=class extends qO{static{s(this,"NumberPrimaryKeyColumn")}initColumnString(){return`'${this.name}' INTEGER PRIMARY KEY AUTOINCREMENT${this.notNull?" NOT NULL":""}`}};var KY=class{static{s(this,"SQLTable")}constructor(e){this.queryGenerator=this.createQueryGenerator(),this.init=this.doInit(e)}async doInit(e){let r=await e;if(r)return await this.create(r),r}async create(e){let r=s(i=>new Promise((o,a)=>{e.run(i,c=>{c?a(c):o()})}),"runQuery"),n=this.queryGenerator.createTableQueries();for(let i of n)await r(i)}async insert(e,r){let n=await this.init;n&&await new Promise((i,o)=>{let a=this.queryGenerator.insertQuery(r,e.length);n.run(a,e.map(c=>Object.values(c)).flat(),function(c){c?o(c):i(this)})})}async getAllRows(){let e=await this.init;return e?hh(e,`SELECT * FROM ${this.queryGenerator.tableName}`,[]):[]}async deleteRow(e){let r=await this.init;if(r)return hh(r,`DELETE FROM ${this.queryGenerator.tableName} WHERE ${yR.Id} = ?`,[e])}},bx=class t extends KY{static{s(this,"DocumentTable")}static{this.tableName=QO.tableName}createQueryGenerator(){return new QO}async updateTimestamp(e,r){let n=await this.init;n&&await hh(n,`UPDATE ${t.tableName} SET ${H0.LastWriteTimeUtc} = ? WHERE ${H0.FilePath} = ?`,[r,e])}async deleteAllWithPath(e){let r=await this.init;r&&await hh(r,`DELETE FROM ${t.tableName} WHERE ${H0.FilePath} = ?`,[e])}async getDocumentByFilePath(e){let r=await this.init;return r?hh(r,`SELECT * FROM ${this.queryGenerator.tableName} WHERE ${H0.FilePath} = ?`,[e]):[]}},cl=class t extends KY{static{s(this,"SymbolTable")}static{this.tableName=UO.tableName}createQueryGenerator(){return new UO}async clearAllSymbolsFromDocument(e){let r=await this.init;if(r)return hh(r,`DELETE FROM ${t.tableName} WHERE ${fo.DocumentId} = ?`,[e])}};async function hh(t,e,r){return new Promise((n,i)=>t.all(e,r,(o,a)=>{o&&i(o),n(a)}))}s(hh,"runPromisifiedDBQuery");var XY=class{constructor(e){this.databaseFileName=e;this.innerJoinStatement=`INNER JOIN ${bx.tableName} ON ${cl.tableName}.${fo.DocumentId} = ${bx.tableName}.${yR.Id}`;this.db=this.initDb(e),this.documentTable=new bx(this.db),this.symbolTable=new cl(this.db)}static{s(this,"DocumentSymbolDatabase")}async initDb(e){let r;try{r=await Promise.resolve().then(()=>Be(dGe()))}catch(i){console.error("Error loading sqlite3 module:",i);return}let n;try{n=await new Promise((i,o)=>{let a=new r.default.Database(e,c=>{c?o(c):i(a)})})}catch(i){console.error("Error initializing database:",i);return}return await hh(n,"pragma journal_mode=wal",[]),await hh(n,"pragma synchronous=normal",[]),await hh(n,"pragma optimize=0x10002",[]),await hh(n,"pragma foreign_keys = ON",[]),n}async close(){let e=await this.db;if(e)return await this.documentTable.init,await this.symbolTable.init,new Promise((r,n)=>{e.close(i=>i?n(i):r())})}async querySymbolsFuzzilyUsingUnqualifiedName(e,r){return await this.query([`SELECT * FROM ${cl.tableName}`,this.innerJoinStatement,`WHERE ${fo.UnqualifiedName} BETWEEN ? AND (? || '~')`,`ORDER BY ${fo.UnqualifiedName}`,"LIMIT ?"].join(`
`),[e,e,r])}async querySymbolsUsingUnqualifiedNames(e,r){let n=e.map(()=>"?").join(", "),i=r?"COLLATE NOCASE ":"";return await this.query([`SELECT * FROM ${cl.tableName}`,this.innerJoinStatement,`WHERE ${fo.UnqualifiedName} ${i}IN (${n})`].join(`
`),e)}async querySymbolsUsingFullyQualifiedName(e){return this.query([`SELECT * FROM ${cl.tableName}`,this.innerJoinStatement,`WHERE ${fo.FullyQualifiedName} = ?`].join(`
`),[e])}async querySymbolsContainingPosition(e,r){return this.query([`SELECT * FROM ${cl.tableName}`,this.innerJoinStatement,`WHERE ${bx.tableName}.${H0.FilePath} = ? AND ${cl.tableName}.${fo.ExtentStart} <= ? AND (${cl.tableName}.${fo.ExtentStart} + ${cl.tableName}.${fo.ExtentLength}) >= ?`].join(`
`),[e,r,r])}async querySymbolsContainedByRange(e,r,n){return this.query([`SELECT * FROM ${cl.tableName}`,this.innerJoinStatement,`WHERE ${bx.tableName}.${H0.FilePath} = ? AND ${cl.tableName}.${fo.ExtentStart} >= ? AND (${cl.tableName}.${fo.ExtentStart} + ${cl.tableName}.${fo.ExtentLength}) <= ?`,`ORDER BY ${cl.tableName}.${fo.ExtentStart}`].join(`
`),[e,r,n])}async querySymbolsByQualifiedNamePrefix(e,r){return this.query([`SELECT * FROM ${cl.tableName}`,this.innerJoinStatement,`WHERE ${bx.tableName}.${H0.FilePath} = ? AND ${cl.tableName}.${fo.FullyQualifiedName} LIKE ?`,`ORDER BY ${cl.tableName}.${fo.ExtentStart}`].join(`
`),[e,`${r}%`])}async insertSymbols(e){return await this.symbolTable.insert(e,!1)}async insertDocument(e,r,n=!1){return await this.documentTable.insert([{filePath:e,lastWriteTimeUtc:r}],n)}async clearAllSymbolsFromDocument(e){return this.symbolTable.clearAllSymbolsFromDocument(e)}async updateDocumentTimestamp(e,r){return this.documentTable.updateTimestamp(e,r)}async deleteAllDocumentsWithPath(e){return this.documentTable.deleteAllWithPath(e)}async getAllDocuments(){return this.documentTable.getAllRows()}getDocument(e){return this.documentTable.getDocumentByFilePath(e)}async query(e,r){let n=await this.db;return n?(await this.documentTable.init,await this.symbolTable.init,hh(n,e,r)):[]}};var ZY=class{static{s(this,"SQLStorageReaderWriter")}constructor(e){this.database=new XY(e)}async close(){await this.database.close()}async insertOrReplaceDocumentSymbolsAsync(e,r,n){let i=await this.getOrCreateDocumentAsync(e,r);await this.database.clearAllSymbolsFromDocument(i.id),n.length>0&&await this.database.insertSymbols(n.map(o=>({documentId:i.id,fullyQualifiedName:o.fullyQualifiedName,unqualifiedName:o.unqualifiedName,commentStart:o.commentRange.start,commentLength:o.commentRange.length,nameStart:o.nameRange.start,nameLength:o.nameRange.length,bodyStart:o.bodyRange.start,bodyLength:o.bodyRange.length,extentStart:o.extentRange.start,extentLength:o.extentRange.length,symbolKind:o.kind,refKind:o.refKind}))),await this.database.updateDocumentTimestamp(e,r)}async addDocumentsAsync(e){for(let r of e)r=r.toLowerCase(),await this.database.insertDocument(r,Date.now(),!0)}async deleteDocumentAsync(e){return await this.database.deleteAllDocumentsWithPath(e.toLowerCase())}async updateDocumentTimestampAsync(e,r){return await this.database.updateDocumentTimestamp(e.toLowerCase(),r)}async fuzzyMatchSymbolsAsync(e,r){return KB(await this.database.querySymbolsFuzzilyUsingUnqualifiedName(e,r))}async findPotentialDefinitionsAsync(e,r,n){let i=[],a=0;for(;a<e.length;){let c=e.slice(a,a+500);a+=500;let l=await this.database.querySymbolsUsingUnqualifiedNames(c,r);i.push(...l),Ex(n)}return KB(i)}async getDefinitionsAsync(e){return KB(await this.database.querySymbolsUsingFullyQualifiedName(e))}async findSymbolsContainingPositionAsync(e,r){let n=await this.database.querySymbolsContainingPosition(e.toLowerCase(),r);return KB(n)}async findSymbolsContainedByRangeAsync(e,r,n){return KB(await this.database.querySymbolsContainedByRange(e.toLowerCase(),r,n))}async findSymbolsByFullyQualifiedNamePrefix(e,r){return KB(await this.database.querySymbolsByQualifiedNamePrefix(e.toLowerCase(),r))}async getDocumentsAsync(){return this.database.getAllDocuments()}async getDocumentAsync(e){let r=await this.database.getDocument(e);if(r?.at(0))return r[0]}async getOrCreateDocumentAsync(e,r){let n=await this.database.getDocument(e);if(n?.at(0))return n[0];await this.database.insertDocument(e,r,!0);let i=await this.database.getDocument(e);if(!i)throw Error("Unable to insert document");return i[0]}};function KB(t){return t.map(e=>new mh(e.filePath,e.fullyQualifiedName,e.unqualifiedName,new qs(e.commentStart,e.commentLength),new qs(e.nameStart,e.nameLength),new qs(e.bodyStart,e.bodyLength),new qs(e.extentStart,e.extentLength),e.symbolKind,e.refKind))}s(KB,"symbolsToSymbolRanges");var tJ=Be(require("fs/promises"));var eJ=class{static{s(this,"Index")}constructor(e,r,n,i){this.storage=new ZY(e),this.symbolExtractors=r,this.importExtractors=n,this.params=i}dispose(){return this.storage.close()}get reader(){return this.storage}async indexFile(e,r){let n=ts(e);if(!n)throw Error(`Cannot resolve a readable file path from ${e}`);let i;try{i=await tJ.stat(n)}catch{await this.storage.deleteDocumentAsync(e);return}let o=i.mtimeMs,a=await this.storage.getDocumentAsync(e);if(a&&a.lastWriteTimeUtc>=o)return;let c=this.symbolExtractors.get(r);if(!c)return;let l=(await tJ.readFile(n)).toString(),u=await c.extractSymbols(e,l),f=u;if(this.params?.mlcpEnableImports){let p=this.importExtractors.get(r);if(p){let m=await p.extractSymbols(e,l);f=[...u,...m]}}await this.storage.insertOrReplaceDocumentSymbolsAsync(e,o,f)}async getDocumentFilePaths(){return(await this.storage.getDocumentsAsync()).map(r=>r.filePath)}};d();function o1e(t){let e=t;return typeof e?.cwd=="string"&&Array.isArray(e?.indexWorkspaceRoots)&&e.indexWorkspaceRoots.every(r=>h$t(r))}s(o1e,"isIndexWorkerData");var WO=class{static{s(this,"IndexNotification")}constructor(e){this.operation=e}},ST=class extends WO{constructor(r,n){super(n);this.id=r;this.id=r}static{s(this,"IndexRequest")}},rJ=class extends WO{constructor(r){super(Ud.Cancel);this.messageIdToCancel=r}static{s(this,"CancellationNotification")}},Ud={CreateIndex:"createIndex",AddOrInvalidated:"addOrInvalidated",GetContext:"getContext",Exit:"exit",Response:"response",RemoveIndex:"removeIndex",Cancel:"cancel",GetAllDocumentsInWorkspace:"getAllDocumentsInWorkspace"},nJ=class extends ST{constructor(r,n,i){super(r,Ud.CreateIndex);this.baseWorkspaceFolderUri=n;this.databaseFilePath=i}static{s(this,"CreateIndexRequest")}},iJ=class extends ST{constructor(r,n){super(r,Ud.RemoveIndex);this.baseWorkspaceFolderUri=n}static{s(this,"RemoveIndexRequest")}},oJ=class extends ST{constructor(r,n,i){super(r,Ud.AddOrInvalidated);this.fileUri=n;this.languageId=i}static{s(this,"AddOrInvalidatedRequest")}},sJ=class extends ST{constructor(r,n){super(r,Ud.GetAllDocumentsInWorkspace);this.baseWorkspaceFolderUri=n}static{s(this,"GetAllDocumentsRequest")}},aJ=class extends ST{constructor(r,n,i,o,a,c){super(r,Ud.GetContext);this.fileUri=n;this.code=i;this.offset=o;this.languageId=a;this.params=c}static{s(this,"GetContextRequest")}},cJ=class extends ST{static{s(this,"ExitRequest")}constructor(e){super(e,Ud.Exit)}},IA=class extends WO{constructor(r,n,i){super(Ud.Response);this.id=r;this.error=n;this.data=i;n&&"code"in n&&typeof n.code=="string"&&(this.code=n.code)}static{s(this,"ResponseMessage")}};function h$t(t){return"databaseFilePath"in t&&"rootPath"in t}s(h$t,"isIndexableWorkspaceFolder");var fGe=Be(hi()),_T=require("worker_threads");var lJ=class{static{s(this,"IndexInfo")}constructor(e,r){this.index=new eJ(e,HY,Hje,r),this.contextRetreival=new VY(this.index.reader,qje)}},s1e=class t{constructor(e,r,n){this.indices=new Map;this.cancellationTokens=new Map;this.params=n;for(let i of r){let o=sc(i.rootPath);this.indices.set(o,new lJ(i.databaseFilePath,n))}this.port=e,this.port.on("message",i=>void this.dispatchMessage(i,this.indices,this.cancellationTokens))}static{s(this,"IndexWorker")}async dispatchMessage(e,r,n){try{let i=new fGe.CancellationTokenSource;n.set(e.id,i);let o;switch(e.operation){case Ud.AddOrInvalidated:o=await t.dispatchAddOrInvalidate(e,r,i.token);break;case Ud.GetContext:o=await t.dispatchGetContext(e,r,i.token);break;case Ud.Cancel:n.get(e.id)?.cancel(),o=new IA(e.id,void 0,void 0);break;case Ud.Exit:o=await this.dispatchExit(e,r,i.token);break;case Ud.CreateIndex:o=t.dispatchCreateIndex(e,r,i.token);break;case Ud.RemoveIndex:o=await t.dispatchRemoveIndex(e,r,i.token);break;case Ud.GetAllDocumentsInWorkspace:o=await t.GetAllDocumentsInWorkspaceRequest(e,r,i.token);break;default:this.port?.postMessage(new Error(`Unknown operation: ${e.operation}`))}o&&this.port?.postMessage(o),n.get(e.id)?.dispose(),n.delete(e.id)}catch(i){if(!(i instanceof Error))throw i;this.port?.postMessage(new IA(e.id,i,void 0))}}static async GetAllDocumentsInWorkspaceRequest(e,r,n){let i=sc(e.baseWorkspaceFolderUri),o,a;return r.has(i)?a=await r.get(i).index.getDocumentFilePaths():o=new Error(`Index not found for ${e.baseWorkspaceFolderUri}`),new IA(e.id,o,a)}static async dispatchAddOrInvalidate(e,r,n){let i=sc(e.fileUri),o=t.getIndexInfo(i,r)?.index,a;return o?await o.indexFile(e.fileUri,e.languageId):a=new Error(`Index not found for ${e.fileUri}`),new IA(e.id,a,void 0)}static async dispatchGetContext(e,r,n){let i=sc(e.fileUri),o=t.getIndexInfo(i,r)?.contextRetreival,a,c;return o?c=await o.getStringifiedContextAtPositionAsync(e.fileUri,e.code,e.offset,e.languageId,e.params,8e3,n):a=new Error(`ContextRetrieval not found for ${e.fileUri}`),new IA(e.id,a,c)}async dispatchExit(e,r,n){for(let i of r.values())await i.index.dispose();r.clear(),this.port?.postMessage(new IA(e.id,void 0,void 0)),this.port?.close()}static dispatchCreateIndex(e,r,n){let i=sc(e.baseWorkspaceFolderUri);return r.has(i)||r.set(i,new lJ(e.databaseFilePath)),new IA(e.id,void 0,void 0)}static async dispatchRemoveIndex(e,r,n){let i=sc(e.baseWorkspaceFolderUri);if(r.has(i)){let o=r.get(i);o&&await o.index.dispose(),r.delete(i)}return new IA(e.id,void 0,void 0)}static getIndexInfo(e,r){for(let[n,i]of r)if(e.startsWith(n))return i}};function pGe(){return o1e(_T.workerData)}s(pGe,"isIndexWorker");function mGe(){let t=_T.parentPort;if(!t)throw new Error("This must be run a worker thread.");if(!o1e(_T.workerData))throw new Error("Worker data must provide a valid database path.");let e=_T.workerData.cwd;process.cwd=()=>e,new s1e(t,_T.workerData.indexWorkspaceRoots,_T.workerData.params)}s(mGe,"runIndexWorker");d();var jO=Be(require("util"));function hGe(t){let e=new console.Console(process.stderr,process.stderr);function r(n,...i){if(AC(t)==="dev")return t.get(Xc).logIt(t,n,"console",...i)}return s(r,"logIt"),e.debug=(...n)=>r(4,...n),e.info=(...n)=>r(3,...n),e.warn=(...n)=>r(2,...n),e.error=(...n)=>r(1,...n),e.assert=(n,...i)=>{n||(i.length===0?r(2,"Assertion failed"):r(2,"Assertion failed:",jO.format(...i)))},e.dir=(n,i)=>r(4,jO.inspect(n,i)),e.log=e.debug.bind(e),e.trace=(...n)=>{let i=new Error(jO.format(...n));i.name="Trace",e.log(i)},e}s(hGe,"createConsole");var KE=Be(require("fs/promises")),Jbt=Be(require("os")),ZH=Be(require("path")),Ig=Be(wA()),Xbt=require("worker_threads");d();d();var VJ=require("assert");d();d();var _Wt={right:BWt,center:NWt},RWt=0,UJ=1,kWt=2,qJ=3,D1e=class{static{s(this,"UI")}constructor(e){var r;this.width=e.width,this.wrap=(r=e.wrap)!==null&&r!==void 0?r:!0,this.rows=[]}span(...e){let r=this.div(...e);r.span=!0}resetOutput(){this.rows=[]}div(...e){if(e.length===0&&this.div(""),this.wrap&&this.shouldApplyLayoutDSL(...e)&&typeof e[0]=="string")return this.applyLayoutDSL(e[0]);let r=e.map(n=>typeof n=="string"?this.colFromString(n):n);return this.rows.push(r),r}shouldApplyLayoutDSL(...e){return e.length===1&&typeof e[0]=="string"&&/[\t\n]/.test(e[0])}applyLayoutDSL(e){let r=e.split(`
`).map(i=>i.split("	")),n=0;return r.forEach(i=>{i.length>1&&$0.stringWidth(i[0])>n&&(n=Math.min(Math.floor(this.width*.5),$0.stringWidth(i[0])))}),r.forEach(i=>{this.div(...i.map((o,a)=>({text:o.trim(),padding:this.measurePadding(o),width:a===0&&i.length>1?n:void 0})))}),this.rows[this.rows.length-1]}colFromString(e){return{text:e,padding:this.measurePadding(e)}}measurePadding(e){let r=$0.stripAnsi(e);return[0,r.match(/\s*$/)[0].length,0,r.match(/^\s*/)[0].length]}toString(){let e=[];return this.rows.forEach(r=>{this.rowToString(r,e)}),e.filter(r=>!r.hidden).map(r=>r.text).join(`
`)}rowToString(e,r){return this.rasterize(e).forEach((n,i)=>{let o="";n.forEach((a,c)=>{let{width:l}=e[c],u=this.negatePadding(e[c]),f=a;if(u>$0.stringWidth(a)&&(f+=" ".repeat(u-$0.stringWidth(a))),e[c].align&&e[c].align!=="left"&&this.wrap){let m=_Wt[e[c].align];f=m(f,u),$0.stringWidth(f)<u&&(f+=" ".repeat((l||0)-$0.stringWidth(f)-1))}let p=e[c].padding||[0,0,0,0];p[qJ]&&(o+=" ".repeat(p[qJ])),o+=lVe(e[c],f,"| "),o+=f,o+=lVe(e[c],f," |"),p[UJ]&&(o+=" ".repeat(p[UJ])),i===0&&r.length>0&&(o=this.renderInline(o,r[r.length-1]))}),r.push({text:o.replace(/ +$/,""),span:e.span})}),r}renderInline(e,r){let n=e.match(/^ */),i=n?n[0].length:0,o=r.text,a=$0.stringWidth(o.trimRight());return r.span?this.wrap?i<a?e:(r.hidden=!0,o.trimRight()+" ".repeat(i-a)+e.trimLeft()):(r.hidden=!0,o+e):e}rasterize(e){let r=[],n=this.columnWidths(e),i;return e.forEach((o,a)=>{o.width=n[a],this.wrap?i=$0.wrap(o.text,this.negatePadding(o),{hard:!0}).split(`
`):i=o.text.split(`
`),o.border&&(i.unshift("."+"-".repeat(this.negatePadding(o)+2)+"."),i.push("'"+"-".repeat(this.negatePadding(o)+2)+"'")),o.padding&&(i.unshift(...new Array(o.padding[RWt]||0).fill("")),i.push(...new Array(o.padding[kWt]||0).fill(""))),i.forEach((c,l)=>{r[l]||r.push([]);let u=r[l];for(let f=0;f<a;f++)u[f]===void 0&&u.push("");u.push(c)})}),r}negatePadding(e){let r=e.width||0;return e.padding&&(r-=(e.padding[qJ]||0)+(e.padding[UJ]||0)),e.border&&(r-=4),r}columnWidths(e){if(!this.wrap)return e.map(a=>a.width||$0.stringWidth(a.text));let r=e.length,n=this.width,i=e.map(a=>{if(a.width)return r--,n-=a.width,a.width}),o=r?Math.floor(n/r):0;return i.map((a,c)=>a===void 0?Math.max(o,PWt(e[c])):a)}};function lVe(t,e,r){return t.border?/[.']-+[.']/.test(e)?"":e.trim().length!==0?r:"  ":""}s(lVe,"addBorder");function PWt(t){let e=t.padding||[],r=1+(e[qJ]||0)+(e[UJ]||0);return t.border?r+4:r}s(PWt,"_minWidth");function DWt(){return typeof process=="object"&&process.stdout&&process.stdout.columns?process.stdout.columns:80}s(DWt,"getWindowWidth");function BWt(t,e){t=t.trim();let r=$0.stringWidth(t);return r<e?" ".repeat(e-r)+t:t}s(BWt,"alignRight");function NWt(t,e){t=t.trim();let r=$0.stringWidth(t);return r>=e?t:" ".repeat(e-r>>1)+t}s(NWt,"alignCenter");var $0;function uVe(t,e){return $0=e,new D1e({width:t?.width||DWt(),wrap:t?.wrap})}s(uVe,"cliui");d();var dVe=new RegExp("\x1B(?:\\[(?:\\d+[ABCDEFGJKSTm]|\\d+;\\d+[Hfm]|\\d+;\\d+;\\d+m|6n|s|u|\\?25[lh])|\\w)","g");function B1e(t){return t.replace(dVe,"")}s(B1e,"stripAnsi");function fVe(t,e){let[r,n]=t.match(dVe)||["",""];t=B1e(t);let i="";for(let o=0;o<t.length;o++)o!==0&&o%e===0&&(i+=`
`),i+=t.charAt(o);return r&&n&&(i=`${r}${i}${n}`),i}s(fVe,"wrap");function N1e(t){return uVe(t,{stringWidth:s(e=>[...e].length,"stringWidth"),stripAnsi:B1e,wrap:fVe})}s(N1e,"ui");d();var ZB=require("path"),HJ=require("fs");function M1e(t,e){let r=(0,ZB.resolve)(".",t),n;for((0,HJ.statSync)(r).isDirectory()||(r=(0,ZB.dirname)(r));;){if(n=e(r,(0,HJ.readdirSync)(r)),n)return(0,ZB.resolve)(r,n);if(r=(0,ZB.dirname)(n=r),n===r)break}}s(M1e,"default");var _Ve=require("util"),RVe=require("fs"),kVe=require("url");d();var AVe=require("util"),GJ=require("path");d();function ER(t){if(t!==t.toLowerCase()&&t!==t.toUpperCase()||(t=t.toLowerCase()),t.indexOf("-")===-1&&t.indexOf("_")===-1)return t;{let r="",n=!1,i=t.match(/^-+/);for(let o=i?i[0].length:0;o<t.length;o++){let a=t.charAt(o);n&&(n=!1,a=a.toUpperCase()),o!==0&&(a==="-"||a==="_")?n=!0:a!=="-"&&a!=="_"&&(r+=a)}return r}}s(ER,"camelCase");function $J(t,e){let r=t.toLowerCase();e=e||"-";let n="";for(let i=0;i<t.length;i++){let o=r.charAt(i),a=t.charAt(i);o!==a&&i>0?n+=`${e}${r.charAt(i)}`:n+=a}return n}s($J,"decamelize");function WJ(t){return t==null?!1:typeof t=="number"||/^0x[0-9a-f]+$/i.test(t)?!0:/^0[^.]/.test(t)?!1:/^[-]?(?:\d+(?:\.\d*)?|\.\d+)(e[-+]?\d+)?$/.test(t)}s(WJ,"looksLikeNumber");d();d();function pVe(t){if(Array.isArray(t))return t.map(a=>typeof a!="string"?a+"":a);t=t.trim();let e=0,r=null,n=null,i=null,o=[];for(let a=0;a<t.length;a++){if(r=n,n=t.charAt(a),n===" "&&!i){r!==" "&&e++;continue}n===i?i=null:(n==="'"||n==='"')&&!i&&(i=n),o[e]||(o[e]=""),o[e]+=n}return o}s(pVe,"tokenizeArgString");d();var xh;(function(t){t.BOOLEAN="boolean",t.STRING="string",t.NUMBER="number",t.ARRAY="array"})(xh||(xh={}));var Ix,jJ=class{static{s(this,"YargsParser")}constructor(e){Ix=e}parse(e,r){let n=Object.assign({alias:void 0,array:void 0,boolean:void 0,config:void 0,configObjects:void 0,configuration:void 0,coerce:void 0,count:void 0,default:void 0,envPrefix:void 0,narg:void 0,normalize:void 0,string:void 0,number:void 0,__:void 0,key:void 0},r),i=pVe(e),o=typeof e=="string",a=MWt(Object.assign(Object.create(null),n.alias)),c=Object.assign({"boolean-negation":!0,"camel-case-expansion":!0,"combine-arrays":!1,"dot-notation":!0,"duplicate-arguments-array":!0,"flatten-duplicate-arrays":!0,"greedy-arrays":!0,"halt-at-non-option":!1,"nargs-eats-options":!1,"negation-prefix":"no-","parse-numbers":!0,"parse-positional-numbers":!0,"populate--":!1,"set-placeholder-key":!1,"short-option-groups":!0,"strip-aliased":!1,"strip-dashed":!1,"unknown-options-as-args":!1},n.configuration),l=Object.assign(Object.create(null),n.default),u=n.configObjects||[],f=n.envPrefix,p=c["populate--"],m=p?"--":"_",h=Object.create(null),g=Object.create(null),A=n.__||Ix.format,y={aliases:Object.create(null),arrays:Object.create(null),bools:Object.create(null),strings:Object.create(null),numbers:Object.create(null),counts:Object.create(null),normalize:Object.create(null),configs:Object.create(null),nargs:Object.create(null),coercions:Object.create(null),keys:[]},E=/^-([0-9]+(\.[0-9]+)?|\.[0-9]+)$/,b=new RegExp("^--"+c["negation-prefix"]+"(.+)");[].concat(n.array||[]).filter(Boolean).forEach(function(ae){let le=typeof ae=="object"?ae.key:ae,qe=Object.keys(ae).map(function(Ne){return{boolean:"bools",string:"strings",number:"numbers"}[Ne]}).filter(Boolean).pop();qe&&(y[qe][le]=!0),y.arrays[le]=!0,y.keys.push(le)}),[].concat(n.boolean||[]).filter(Boolean).forEach(function(ae){y.bools[ae]=!0,y.keys.push(ae)}),[].concat(n.string||[]).filter(Boolean).forEach(function(ae){y.strings[ae]=!0,y.keys.push(ae)}),[].concat(n.number||[]).filter(Boolean).forEach(function(ae){y.numbers[ae]=!0,y.keys.push(ae)}),[].concat(n.count||[]).filter(Boolean).forEach(function(ae){y.counts[ae]=!0,y.keys.push(ae)}),[].concat(n.normalize||[]).filter(Boolean).forEach(function(ae){y.normalize[ae]=!0,y.keys.push(ae)}),typeof n.narg=="object"&&Object.entries(n.narg).forEach(([ae,le])=>{typeof le=="number"&&(y.nargs[ae]=le,y.keys.push(ae))}),typeof n.coerce=="object"&&Object.entries(n.coerce).forEach(([ae,le])=>{typeof le=="function"&&(y.coercions[ae]=le,y.keys.push(ae))}),typeof n.config<"u"&&(Array.isArray(n.config)||typeof n.config=="string"?[].concat(n.config).filter(Boolean).forEach(function(ae){y.configs[ae]=!0}):typeof n.config=="object"&&Object.entries(n.config).forEach(([ae,le])=>{(typeof le=="boolean"||typeof le=="function")&&(y.configs[ae]=le)})),Oe(n.key,a,n.default,y.arrays),Object.keys(l).forEach(function(ae){(y.aliases[ae]||[]).forEach(function(le){l[le]=l[ae]})});let S=null;$e();let R=[],B=Object.assign(Object.create(null),{_:[]}),L={};for(let ae=0;ae<i.length;ae++){let le=i[ae],qe=le.replace(/^-{3,}/,"---"),Ne,Ee,je,tt,mt,Ft;if(le!=="--"&&/^-/.test(le)&&_t(le))O(le);else if(qe.match(/^---+(=|$)/)){O(le);continue}else if(le.match(/^--.+=/)||!c["short-option-groups"]&&le.match(/^-.+=/))tt=le.match(/^--?([^=]+)=([\s\S]*)$/),tt!==null&&Array.isArray(tt)&&tt.length>=3&&(Te(tt[1],y.arrays)?ae=V(ae,tt[1],i,tt[2]):Te(tt[1],y.nargs)!==!1?ae=Y(ae,tt[1],i,tt[2]):z(tt[1],tt[2],!0));else if(le.match(b)&&c["boolean-negation"])tt=le.match(b),tt!==null&&Array.isArray(tt)&&tt.length>=2&&(Ee=tt[1],z(Ee,Te(Ee,y.arrays)?[!1]:!1));else if(le.match(/^--.+/)||!c["short-option-groups"]&&le.match(/^-[^-]+/))tt=le.match(/^--?(.+)/),tt!==null&&Array.isArray(tt)&&tt.length>=2&&(Ee=tt[1],Te(Ee,y.arrays)?ae=V(ae,Ee,i):Te(Ee,y.nargs)!==!1?ae=Y(ae,Ee,i):(mt=i[ae+1],mt!==void 0&&(!mt.match(/^-/)||mt.match(E))&&!Te(Ee,y.bools)&&!Te(Ee,y.counts)||/^(true|false)$/.test(mt)?(z(Ee,mt),ae++):z(Ee,gt(Ee))));else if(le.match(/^-.\..+=/))tt=le.match(/^-([^=]+)=([\s\S]*)$/),tt!==null&&Array.isArray(tt)&&tt.length>=3&&z(tt[1],tt[2]);else if(le.match(/^-.\..+/)&&!le.match(E))mt=i[ae+1],tt=le.match(/^-(.\..+)/),tt!==null&&Array.isArray(tt)&&tt.length>=2&&(Ee=tt[1],mt!==void 0&&!mt.match(/^-/)&&!Te(Ee,y.bools)&&!Te(Ee,y.counts)?(z(Ee,mt),ae++):z(Ee,gt(Ee)));else if(le.match(/^-[^-]+/)&&!le.match(E)){je=le.slice(1,-1).split(""),Ne=!1;for(let Jt=0;Jt<je.length;Jt++){if(mt=le.slice(Jt+2),je[Jt+1]&&je[Jt+1]==="="){Ft=le.slice(Jt+3),Ee=je[Jt],Te(Ee,y.arrays)?ae=V(ae,Ee,i,Ft):Te(Ee,y.nargs)!==!1?ae=Y(ae,Ee,i,Ft):z(Ee,Ft),Ne=!0;break}if(mt==="-"){z(je[Jt],mt);continue}if(/[A-Za-z]/.test(je[Jt])&&/^-?\d+(\.\d*)?(e-?\d+)?$/.test(mt)&&Te(mt,y.bools)===!1){z(je[Jt],mt),Ne=!0;break}if(je[Jt+1]&&je[Jt+1].match(/\W/)){z(je[Jt],mt),Ne=!0;break}else z(je[Jt],gt(je[Jt]))}Ee=le.slice(-1)[0],!Ne&&Ee!=="-"&&(Te(Ee,y.arrays)?ae=V(ae,Ee,i):Te(Ee,y.nargs)!==!1?ae=Y(ae,Ee,i):(mt=i[ae+1],mt!==void 0&&(!/^(-|--)[^-]/.test(mt)||mt.match(E))&&!Te(Ee,y.bools)&&!Te(Ee,y.counts)||/^(true|false)$/.test(mt)?(z(Ee,mt),ae++):z(Ee,gt(Ee))))}else if(le.match(/^-[0-9]$/)&&le.match(E)&&Te(le.slice(1),y.bools))Ee=le.slice(1),z(Ee,gt(Ee));else if(le==="--"){R=i.slice(ae+1);break}else if(c["halt-at-non-option"]){R=i.slice(ae);break}else O(le)}X(B,!0),X(B,!1),J(B),W(),re(B,y.aliases,l,!0),oe(B),c["set-placeholder-key"]&&te(B),Object.keys(y.counts).forEach(function(ae){pe(B,ae.split("."))||z(ae,0)}),p&&R.length&&(B[m]=[]),R.forEach(function(ae){B[m].push(ae)}),c["camel-case-expansion"]&&c["strip-dashed"]&&Object.keys(B).filter(ae=>ae!=="--"&&ae.includes("-")).forEach(ae=>{delete B[ae]}),c["strip-aliased"]&&[].concat(...Object.keys(a).map(ae=>a[ae])).forEach(ae=>{c["camel-case-expansion"]&&ae.includes("-")&&delete B[ae.split(".").map(le=>ER(le)).join(".")],delete B[ae]});function O(ae){let le=Z("_",ae);(typeof le=="string"||typeof le=="number")&&B._.push(le)}s(O,"pushPositional");function Y(ae,le,qe,Ne){let Ee,je=Te(le,y.nargs);if(je=typeof je!="number"||isNaN(je)?1:je,je===0)return ye(Ne)||(S=Error(A("Argument unexpected for: %s",le))),z(le,gt(le)),ae;let tt=ye(Ne)?0:1;if(c["nargs-eats-options"])qe.length-(ae+1)+tt<je&&(S=Error(A("Not enough arguments following: %s",le))),tt=je;else{for(Ee=ae+1;Ee<qe.length&&(!qe[Ee].match(/^-[^0-9]/)||qe[Ee].match(E)||_t(qe[Ee]));Ee++)tt++;tt<je&&(S=Error(A("Not enough arguments following: %s",le)))}let mt=Math.min(tt,je);for(!ye(Ne)&&mt>0&&(z(le,Ne),mt--),Ee=ae+1;Ee<mt+ae+1;Ee++)z(le,qe[Ee]);return ae+mt}s(Y,"eatNargs");function V(ae,le,qe,Ne){let Ee=[],je=Ne||qe[ae+1],tt=Te(le,y.nargs);if(Te(le,y.bools)&&!/^(true|false)$/.test(je))Ee.push(!0);else if(ye(je)||ye(Ne)&&/^-/.test(je)&&!E.test(je)&&!_t(je)){if(l[le]!==void 0){let mt=l[le];Ee=Array.isArray(mt)?mt:[mt]}}else{ye(Ne)||Ee.push(U(le,Ne,!0));for(let mt=ae+1;mt<qe.length&&!(!c["greedy-arrays"]&&Ee.length>0||tt&&typeof tt=="number"&&Ee.length>=tt||(je=qe[mt],/^-/.test(je)&&!E.test(je)&&!_t(je)));mt++)ae=mt,Ee.push(U(le,je,o))}return typeof tt=="number"&&(tt&&Ee.length<tt||isNaN(tt)&&Ee.length===0)&&(S=Error(A("Not enough arguments following: %s",le))),z(le,Ee),ae}s(V,"eatArray");function z(ae,le,qe=o){if(/-/.test(ae)&&c["camel-case-expansion"]){let je=ae.split(".").map(function(tt){return ER(tt)}).join(".");Q(ae,je)}let Ne=U(ae,le,qe),Ee=ae.split(".");Ae(B,Ee,Ne),y.aliases[ae]&&y.aliases[ae].forEach(function(je){let tt=je.split(".");Ae(B,tt,Ne)}),Ee.length>1&&c["dot-notation"]&&(y.aliases[Ee[0]]||[]).forEach(function(je){let tt=je.split("."),mt=[].concat(Ee);mt.shift(),tt=tt.concat(mt),(y.aliases[ae]||[]).includes(tt.join("."))||Ae(B,tt,Ne)}),Te(ae,y.normalize)&&!Te(ae,y.arrays)&&[ae].concat(y.aliases[ae]||[]).forEach(function(tt){Object.defineProperty(L,tt,{enumerable:!0,get(){return le},set(mt){le=typeof mt=="string"?Ix.normalize(mt):mt}})})}s(z,"setArg");function Q(ae,le){y.aliases[ae]&&y.aliases[ae].length||(y.aliases[ae]=[le],h[le]=!0),y.aliases[le]&&y.aliases[le].length||Q(le,ae)}s(Q,"addNewAlias");function U(ae,le,qe){qe&&(le=LWt(le)),(Te(ae,y.bools)||Te(ae,y.counts))&&typeof le=="string"&&(le=le==="true");let Ne=Array.isArray(le)?le.map(function(Ee){return Z(ae,Ee)}):Z(ae,le);return Te(ae,y.counts)&&(ye(Ne)||typeof Ne=="boolean")&&(Ne=L1e()),Te(ae,y.normalize)&&Te(ae,y.arrays)&&(Array.isArray(le)?Ne=le.map(Ee=>Ix.normalize(Ee)):Ne=Ix.normalize(le)),Ne}s(U,"processValue");function Z(ae,le){return!c["parse-positional-numbers"]&&ae==="_"||!Te(ae,y.strings)&&!Te(ae,y.bools)&&!Array.isArray(le)&&(WJ(le)&&c["parse-numbers"]&&Number.isSafeInteger(Math.floor(parseFloat(`${le}`)))||!ye(le)&&Te(ae,y.numbers))&&(le=Number(le)),le}s(Z,"maybeCoerceNumber");function J(ae){let le=Object.create(null);re(le,y.aliases,l),Object.keys(y.configs).forEach(function(qe){let Ne=ae[qe]||le[qe];if(Ne)try{let Ee=null,je=Ix.resolve(Ix.cwd(),Ne),tt=y.configs[qe];if(typeof tt=="function"){try{Ee=tt(je)}catch(mt){Ee=mt}if(Ee instanceof Error){S=Ee;return}}else Ee=Ix.require(je);j(Ee)}catch(Ee){Ee.name==="PermissionDenied"?S=Ee:ae[qe]&&(S=Error(A("Invalid JSON config file: %s",Ne)))}})}s(J,"setConfig");function j(ae,le){Object.keys(ae).forEach(function(qe){let Ne=ae[qe],Ee=le?le+"."+qe:qe;typeof Ne=="object"&&Ne!==null&&!Array.isArray(Ne)&&c["dot-notation"]?j(Ne,Ee):(!pe(B,Ee.split("."))||Te(Ee,y.arrays)&&c["combine-arrays"])&&z(Ee,Ne)})}s(j,"setConfigObject");function W(){typeof u<"u"&&u.forEach(function(ae){j(ae)})}s(W,"setConfigObjects");function X(ae,le){if(typeof f>"u")return;let qe=typeof f=="string"?f:"",Ne=Ix.env();Object.keys(Ne).forEach(function(Ee){if(qe===""||Ee.lastIndexOf(qe,0)===0){let je=Ee.split("__").map(function(tt,mt){return mt===0&&(tt=tt.substring(qe.length)),ER(tt)});(le&&y.configs[je.join(".")]||!le)&&!pe(ae,je)&&z(je.join("."),Ne[Ee])}})}s(X,"applyEnvVars");function oe(ae){let le,qe=new Set;Object.keys(ae).forEach(function(Ne){if(!qe.has(Ne)&&(le=Te(Ne,y.coercions),typeof le=="function"))try{let Ee=Z(Ne,le(ae[Ne]));[].concat(y.aliases[Ne]||[],Ne).forEach(je=>{qe.add(je),ae[je]=Ee})}catch(Ee){S=Ee}})}s(oe,"applyCoercions");function te(ae){return y.keys.forEach(le=>{~le.indexOf(".")||typeof ae[le]>"u"&&(ae[le]=void 0)}),ae}s(te,"setPlaceholderKeys");function re(ae,le,qe,Ne=!1){Object.keys(qe).forEach(function(Ee){pe(ae,Ee.split("."))||(Ae(ae,Ee.split("."),qe[Ee]),Ne&&(g[Ee]=!0),(le[Ee]||[]).forEach(function(je){pe(ae,je.split("."))||Ae(ae,je.split("."),qe[Ee])}))})}s(re,"applyDefaultsAndAliases");function pe(ae,le){let qe=ae;c["dot-notation"]||(le=[le.join(".")]),le.slice(0,-1).forEach(function(Ee){qe=qe[Ee]||{}});let Ne=le[le.length-1];return typeof qe!="object"?!1:Ne in qe}s(pe,"hasKey");function Ae(ae,le,qe){let Ne=ae;c["dot-notation"]||(le=[le.join(".")]),le.slice(0,-1).forEach(function(Ft){Ft=mVe(Ft),typeof Ne=="object"&&Ne[Ft]===void 0&&(Ne[Ft]={}),typeof Ne[Ft]!="object"||Array.isArray(Ne[Ft])?(Array.isArray(Ne[Ft])?Ne[Ft].push({}):Ne[Ft]=[Ne[Ft],{}],Ne=Ne[Ft][Ne[Ft].length-1]):Ne=Ne[Ft]});let Ee=mVe(le[le.length-1]),je=Te(le.join("."),y.arrays),tt=Array.isArray(qe),mt=c["duplicate-arguments-array"];!mt&&Te(Ee,y.nargs)&&(mt=!0,(!ye(Ne[Ee])&&y.nargs[Ee]===1||Array.isArray(Ne[Ee])&&Ne[Ee].length===y.nargs[Ee])&&(Ne[Ee]=void 0)),qe===L1e()?Ne[Ee]=L1e(Ne[Ee]):Array.isArray(Ne[Ee])?mt&&je&&tt?Ne[Ee]=c["flatten-duplicate-arrays"]?Ne[Ee].concat(qe):(Array.isArray(Ne[Ee][0])?Ne[Ee]:[Ne[Ee]]).concat([qe]):!mt&&!!je==!!tt?Ne[Ee]=qe:Ne[Ee]=Ne[Ee].concat([qe]):Ne[Ee]===void 0&&je?Ne[Ee]=tt?qe:[qe]:mt&&!(Ne[Ee]===void 0||Te(Ee,y.counts)||Te(Ee,y.bools))?Ne[Ee]=[Ne[Ee],qe]:Ne[Ee]=qe}s(Ae,"setKey");function Oe(...ae){ae.forEach(function(le){Object.keys(le||{}).forEach(function(qe){y.aliases[qe]||(y.aliases[qe]=[].concat(a[qe]||[]),y.aliases[qe].concat(qe).forEach(function(Ne){if(/-/.test(Ne)&&c["camel-case-expansion"]){let Ee=ER(Ne);Ee!==qe&&y.aliases[qe].indexOf(Ee)===-1&&(y.aliases[qe].push(Ee),h[Ee]=!0)}}),y.aliases[qe].concat(qe).forEach(function(Ne){if(Ne.length>1&&/[A-Z]/.test(Ne)&&c["camel-case-expansion"]){let Ee=$J(Ne,"-");Ee!==qe&&y.aliases[qe].indexOf(Ee)===-1&&(y.aliases[qe].push(Ee),h[Ee]=!0)}}),y.aliases[qe].forEach(function(Ne){y.aliases[Ne]=[qe].concat(y.aliases[qe].filter(function(Ee){return Ne!==Ee}))}))})})}s(Oe,"extendAliases");function Te(ae,le){let qe=[].concat(y.aliases[ae]||[],ae),Ne=Object.keys(le),Ee=qe.find(je=>Ne.includes(je));return Ee?le[Ee]:!1}s(Te,"checkAllAliases");function Je(ae){let le=Object.keys(y);return[].concat(le.map(Ne=>y[Ne])).some(function(Ne){return Array.isArray(Ne)?Ne.includes(ae):Ne[ae]})}s(Je,"hasAnyFlag");function Fe(ae,...le){return[].concat(...le).some(function(Ne){let Ee=ae.match(Ne);return Ee&&Je(Ee[1])})}s(Fe,"hasFlagsMatching");function lt(ae){if(ae.match(E)||!ae.match(/^-[^-]+/))return!1;let le=!0,qe,Ne=ae.slice(1).split("");for(let Ee=0;Ee<Ne.length;Ee++){if(qe=ae.slice(Ee+2),!Je(Ne[Ee])){le=!1;break}if(Ne[Ee+1]&&Ne[Ee+1]==="="||qe==="-"||/[A-Za-z]/.test(Ne[Ee])&&/^-?\d+(\.\d*)?(e-?\d+)?$/.test(qe)||Ne[Ee+1]&&Ne[Ee+1].match(/\W/))break}return le}s(lt,"hasAllShortFlags");function _t(ae){return c["unknown-options-as-args"]&&xt(ae)}s(_t,"isUnknownOptionAsArg");function xt(ae){return ae=ae.replace(/^-{3,}/,"--"),ae.match(E)||lt(ae)?!1:!Fe(ae,/^-+([^=]+?)=[\s\S]*$/,b,/^-+([^=]+?)$/,/^-+([^=]+?)-$/,/^-+([^=]+?\d+)$/,/^-+([^=]+?)\W+.*$/)}s(xt,"isUnknownOption");function gt(ae){return!Te(ae,y.bools)&&!Te(ae,y.counts)&&`${ae}`in l?l[ae]:ue(Ue(ae))}s(gt,"defaultValue");function ue(ae){return{[xh.BOOLEAN]:!0,[xh.STRING]:"",[xh.NUMBER]:void 0,[xh.ARRAY]:[]}[ae]}s(ue,"defaultForType");function Ue(ae){let le=xh.BOOLEAN;return Te(ae,y.strings)?le=xh.STRING:Te(ae,y.numbers)?le=xh.NUMBER:Te(ae,y.bools)?le=xh.BOOLEAN:Te(ae,y.arrays)&&(le=xh.ARRAY),le}s(Ue,"guessType");function ye(ae){return ae===void 0}s(ye,"isUndefined");function $e(){Object.keys(y.counts).find(ae=>Te(ae,y.arrays)?(S=Error(A("Invalid configuration: %s, opts.count excludes opts.array.",ae)),!0):Te(ae,y.nargs)?(S=Error(A("Invalid configuration: %s, opts.count excludes opts.narg.",ae)),!0):!1)}return s($e,"checkConfiguration"),{aliases:Object.assign({},y.aliases),argv:Object.assign(L,B),configuration:c,defaulted:Object.assign({},g),error:S,newAliases:Object.assign({},h)}}};function MWt(t){let e=[],r=Object.create(null),n=!0;for(Object.keys(t).forEach(function(i){e.push([].concat(t[i],i))});n;){n=!1;for(let i=0;i<e.length;i++)for(let o=i+1;o<e.length;o++)if(e[i].filter(function(c){return e[o].indexOf(c)!==-1}).length){e[i]=e[i].concat(e[o]),e.splice(o,1),n=!0;break}}return e.forEach(function(i){i=i.filter(function(a,c,l){return l.indexOf(a)===c});let o=i.pop();o!==void 0&&typeof o=="string"&&(r[o]=i)}),r}s(MWt,"combineAliases");function L1e(t){return t!==void 0?t+1:1}s(L1e,"increment");function mVe(t){return t==="__proto__"?"___proto___":t}s(mVe,"sanitizeKey");function LWt(t){return typeof t=="string"&&(t[0]==="'"||t[0]==='"')&&t[t.length-1]===t[0]?t.substring(1,t.length-1):t}s(LWt,"stripQuotes");var yVe=require("fs");var F1e,O1e,Q1e,hVe=process&&process.env&&process.env.YARGS_MIN_NODE_VERSION?Number(process.env.YARGS_MIN_NODE_VERSION):12,gVe=(O1e=(F1e=process==null?void 0:process.versions)===null||F1e===void 0?void 0:F1e.node)!==null&&O1e!==void 0?O1e:(Q1e=process==null?void 0:process.version)===null||Q1e===void 0?void 0:Q1e.slice(1);if(gVe&&Number(gVe.match(/^([^.]+)/)[1])<hVe)throw Error(`yargs parser supports a minimum Node.js version of ${hVe}. Read our version support policy: https://github.com/yargs/yargs-parser#supported-nodejs-versions`);var FWt=process?process.env:{},CVe=new jJ({cwd:process.cwd,env:s(()=>FWt,"env"),format:AVe.format,normalize:GJ.normalize,resolve:GJ.resolve,require:s(t=>{if(typeof require<"u")return require(t);if(t.match(/\.json$/))return JSON.parse((0,yVe.readFileSync)(t,"utf8"));throw Error("only .json config files are supported in ESM")},"require")}),XO=s(function(e,r){return CVe.parse(e.slice(),r).argv},"Parser");XO.detailed=function(t,e){return CVe.parse(t.slice(),e)};XO.camelCase=ER;XO.decamelize=$J;XO.looksLikeNumber=WJ;var vVe=XO;var _A=require("path");d();function OWt(){return QWt()?0:1}s(OWt,"getProcessArgvBinIndex");function QWt(){return UWt()&&!process.defaultApp}s(QWt,"isBundledElectronApp");function UWt(){return!!process.versions.electron}s(UWt,"isElectronApp");function xVe(){return process.argv[OWt()]}s(xVe,"getProcessArgvBin");d();var sa=class t extends Error{static{s(this,"YError")}constructor(e){super(e||"yargs error"),this.name="YError",Error.captureStackTrace&&Error.captureStackTrace(this,t)}};d();d();var e3=require("fs"),EVe=require("util"),bVe=require("path");var IVe={fs:{readFileSync:e3.readFileSync,writeFile:e3.writeFile},format:EVe.format,resolve:bVe.resolve,exists:s(t=>{try{return(0,e3.statSync)(t).isFile()}catch{return!1}},"exists")};d();var SA,U1e=class{static{s(this,"Y18N")}constructor(e){e=e||{},this.directory=e.directory||"./locales",this.updateFiles=typeof e.updateFiles=="boolean"?e.updateFiles:!0,this.locale=e.locale||"en",this.fallbackToLanguage=typeof e.fallbackToLanguage=="boolean"?e.fallbackToLanguage:!0,this.cache=Object.create(null),this.writeQueue=[]}__(...e){if(typeof arguments[0]!="string")return this._taggedLiteral(arguments[0],...arguments);let r=e.shift(),n=s(function(){},"cb");return typeof e[e.length-1]=="function"&&(n=e.pop()),n=n||function(){},this.cache[this.locale]||this._readLocaleFile(),!this.cache[this.locale][r]&&this.updateFiles?(this.cache[this.locale][r]=r,this._enqueueWrite({directory:this.directory,locale:this.locale,cb:n})):n(),SA.format.apply(SA.format,[this.cache[this.locale][r]||r].concat(e))}__n(){let e=Array.prototype.slice.call(arguments),r=e.shift(),n=e.shift(),i=e.shift(),o=s(function(){},"cb");typeof e[e.length-1]=="function"&&(o=e.pop()),this.cache[this.locale]||this._readLocaleFile();let a=i===1?r:n;this.cache[this.locale][r]&&(a=this.cache[this.locale][r][i===1?"one":"other"]),!this.cache[this.locale][r]&&this.updateFiles?(this.cache[this.locale][r]={one:r,other:n},this._enqueueWrite({directory:this.directory,locale:this.locale,cb:o})):o();let c=[a];return~a.indexOf("%d")&&c.push(i),SA.format.apply(SA.format,c.concat(e))}setLocale(e){this.locale=e}getLocale(){return this.locale}updateLocale(e){this.cache[this.locale]||this._readLocaleFile();for(let r in e)Object.prototype.hasOwnProperty.call(e,r)&&(this.cache[this.locale][r]=e[r])}_taggedLiteral(e,...r){let n="";return e.forEach(function(i,o){let a=r[o+1];n+=i,typeof a<"u"&&(n+="%s")}),this.__.apply(this,[n].concat([].slice.call(r,1)))}_enqueueWrite(e){this.writeQueue.push(e),this.writeQueue.length===1&&this._processWriteQueue()}_processWriteQueue(){let e=this,r=this.writeQueue[0],n=r.directory,i=r.locale,o=r.cb,a=this._resolveLocaleFile(n,i),c=JSON.stringify(this.cache[i],null,2);SA.fs.writeFile(a,c,"utf-8",function(l){e.writeQueue.shift(),e.writeQueue.length>0&&e._processWriteQueue(),o(l)})}_readLocaleFile(){let e={},r=this._resolveLocaleFile(this.directory,this.locale);try{SA.fs.readFileSync&&(e=JSON.parse(SA.fs.readFileSync(r,"utf-8")))}catch(n){if(n instanceof SyntaxError&&(n.message="syntax error in "+r),n.code==="ENOENT")e={};else throw n}this.cache[this.locale]=e}_resolveLocaleFile(e,r){let n=SA.resolve(e,"./",r+".json");if(this.fallbackToLanguage&&!this._fileExistsSync(n)&&~r.lastIndexOf("_")){let i=SA.resolve(e,"./",r.split("_")[0]+".json");this._fileExistsSync(i)&&(n=i)}return n}_fileExistsSync(e){return SA.exists(e)}};function TVe(t,e){SA=e;let r=new U1e(t);return{__:r.__.bind(r),__n:r.__n.bind(r),setLocale:r.setLocale.bind(r),getLocale:r.getLocale.bind(r),updateLocale:r.updateLocale.bind(r),locale:r.locale}}s(TVe,"y18n");var qWt=s(t=>TVe(t,IVe),"y18n"),wVe=qWt;var HWt="require is not supported by ESM",SVe="loading a directory of commands is not supported yet for ESM",ZO;try{ZO=(0,kVe.fileURLToPath)(importMetaUrlShim)}catch{ZO=process.cwd()}var $Wt=ZO.substring(0,ZO.lastIndexOf("node_modules")),PVe={assert:{notStrictEqual:VJ.notStrictEqual,strictEqual:VJ.strictEqual},cliui:N1e,findUp:M1e,getEnv:s(t=>process.env[t],"getEnv"),inspect:_Ve.inspect,getCallerFile:s(()=>{throw new sa(SVe)},"getCallerFile"),getProcessArgvBin:xVe,mainFilename:$Wt||process.cwd(),Parser:vVe,path:{basename:_A.basename,dirname:_A.dirname,extname:_A.extname,relative:_A.relative,resolve:_A.resolve},process:{argv:s(()=>process.argv,"argv"),cwd:process.cwd,emitWarning:s((t,e)=>process.emitWarning(t,e),"emitWarning"),execPath:s(()=>process.execPath,"execPath"),exit:process.exit,nextTick:process.nextTick,stdColumns:typeof process.stdout.columns<"u"?process.stdout.columns:null},readFileSync:RVe.readFileSync,require:s(()=>{throw new sa(HWt)},"require"),requireDirectory:s(()=>{throw new sa(SVe)},"requireDirectory"),stringWidth:s(t=>[...t].length,"stringWidth"),y18n:wVe({directory:(0,_A.resolve)(ZO,"../../../locales"),updateFiles:!1})};d();d();d();function _f(t,e,r,n){r.assert.notStrictEqual(t,e,n)}s(_f,"assertNotStrictEqual");function q1e(t,e){e.assert.strictEqual(typeof t,"string")}s(q1e,"assertSingleKey");function t3(t){return Object.keys(t)}s(t3,"objectKeys");d();function aa(t){return!!t&&!!t.then&&typeof t.then=="function"}s(aa,"isPromise");d();d();d();function DT(t){let r=t.replace(/\s{2,}/g," ").split(/\s+(?![^[]*]|[^<]*>)/),n=/\.*[\][<>]/g,i=r.shift();if(!i)throw new Error(`No command found in: ${t}`);let o={cmd:i.replace(n,""),demanded:[],optional:[]};return r.forEach((a,c)=>{let l=!1;a=a.replace(/\s/g,""),/\.+[\]>]/.test(a)&&c===r.length-1&&(l=!0),/^\[/.test(a)?o.optional.push({cmd:a.replace(n,"").split("|"),variadic:l}):o.demanded.push({cmd:a.replace(n,"").split("|"),variadic:l})}),o}s(DT,"parseCommand");var WWt=["first","second","third","fourth","fifth","sixth"];function Lr(t,e,r){function n(){return typeof t=="object"?[{demanded:[],optional:[]},t,e]:[DT(`cmd ${t}`),e,r]}s(n,"parseArgs");try{let i=0,[o,a,c]=n(),l=[].slice.call(a);for(;l.length&&l[l.length-1]===void 0;)l.pop();let u=c||l.length;if(u<o.demanded.length)throw new sa(`Not enough arguments provided. Expected ${o.demanded.length} but received ${l.length}.`);let f=o.demanded.length+o.optional.length;if(u>f)throw new sa(`Too many arguments provided. Expected max ${f} but received ${u}.`);o.demanded.forEach(p=>{let m=l.shift(),h=DVe(m);p.cmd.filter(A=>A===h||A==="*").length===0&&BVe(h,p.cmd,i),i+=1}),o.optional.forEach(p=>{if(l.length===0)return;let m=l.shift(),h=DVe(m);p.cmd.filter(A=>A===h||A==="*").length===0&&BVe(h,p.cmd,i),i+=1})}catch(i){console.warn(i.stack)}}s(Lr,"argsert");function DVe(t){return Array.isArray(t)?"array":t===null?"null":typeof t}s(DVe,"guessType");function BVe(t,e,r){throw new sa(`Invalid ${WWt[r]||"manyith"} argument. Expected ${e.join(" or ")} but received ${t}.`)}s(BVe,"argumentTypeError");var zJ=class{static{s(this,"GlobalMiddleware")}constructor(e){this.globalMiddleware=[],this.frozens=[],this.yargs=e}addMiddleware(e,r,n=!0,i=!1){if(Lr("<array|function> [boolean] [boolean] [boolean]",[e,r,n],arguments.length),Array.isArray(e)){for(let o=0;o<e.length;o++){if(typeof e[o]!="function")throw Error("middleware must be a function");let a=e[o];a.applyBeforeValidation=r,a.global=n}Array.prototype.push.apply(this.globalMiddleware,e)}else if(typeof e=="function"){let o=e;o.applyBeforeValidation=r,o.global=n,o.mutates=i,this.globalMiddleware.push(e)}return this.yargs}addCoerceMiddleware(e,r){let n=this.yargs.getAliases();return this.globalMiddleware=this.globalMiddleware.filter(i=>{let o=[...n[r]||[],r];return i.option?!o.includes(i.option):!0}),e.option=r,this.addMiddleware(e,!0,!0,!0)}getMiddleware(){return this.globalMiddleware}freeze(){this.frozens.push([...this.globalMiddleware])}unfreeze(){let e=this.frozens.pop();e!==void 0&&(this.globalMiddleware=e)}reset(){this.globalMiddleware=this.globalMiddleware.filter(e=>e.global)}};function NVe(t){return t?t.map(e=>(e.applyBeforeValidation=!1,e)):[]}s(NVe,"commandMiddlewareFactory");function bR(t,e,r,n){return r.reduce((i,o)=>{if(o.applyBeforeValidation!==n)return i;if(o.mutates){if(o.applied)return i;o.applied=!0}if(aa(i))return i.then(a=>Promise.all([a,o(a,e)])).then(([a,c])=>Object.assign(a,c));{let a=o(i,e);return aa(a)?a.then(c=>Object.assign(i,c)):Object.assign(i,a)}},t)}s(bR,"applyMiddleware");d();function IR(t,e,r=n=>{throw n}){try{let n=jWt(t)?t():t;return aa(n)?n.then(i=>e(i)):e(n)}catch(n){return r(n)}}s(IR,"maybeAsyncResult");function jWt(t){return typeof t=="function"}s(jWt,"isFunction");d();function H1e(t){if(typeof require>"u")return null;for(let e=0,r=Object.keys(require.cache),n;e<r.length;e++)if(n=require.cache[r[e]],n.exports===t)return n;return null}s(H1e,"whichModule");var r3=/(^\*)|(^\$0)/,$1e=class{static{s(this,"CommandInstance")}constructor(e,r,n,i){this.requireCache=new Set,this.handlers={},this.aliasMap={},this.frozens=[],this.shim=i,this.usage=e,this.globalMiddleware=n,this.validation=r}addDirectory(e,r,n,i){i=i||{},typeof i.recurse!="boolean"&&(i.recurse=!1),Array.isArray(i.extensions)||(i.extensions=["js"]);let o=typeof i.visit=="function"?i.visit:a=>a;i.visit=(a,c,l)=>{let u=o(a,c,l);if(u){if(this.requireCache.has(c))return u;this.requireCache.add(c),this.addHandler(u)}return u},this.shim.requireDirectory({require:r,filename:n},e,i)}addHandler(e,r,n,i,o,a){let c=[],l=NVe(o);if(i=i||(()=>{}),Array.isArray(e))if(GWt(e))[e,...c]=e;else for(let u of e)this.addHandler(u);else if(zWt(e)){let u=Array.isArray(e.command)||typeof e.command=="string"?e.command:this.moduleName(e);e.aliases&&(u=[].concat(u).concat(e.aliases)),this.addHandler(u,this.extractDesc(e),e.builder,e.handler,e.middlewares,e.deprecated);return}else if(MVe(n)){this.addHandler([e].concat(c),r,n.builder,n.handler,n.middlewares,n.deprecated);return}if(typeof e=="string"){let u=DT(e);c=c.map(m=>DT(m).cmd);let f=!1,p=[u.cmd].concat(c).filter(m=>r3.test(m)?(f=!0,!1):!0);p.length===0&&f&&p.push("$0"),f&&(u.cmd=p[0],c=p.slice(1),e=e.replace(r3,u.cmd)),c.forEach(m=>{this.aliasMap[m]=u.cmd}),r!==!1&&this.usage.command(e,r,f,c,a),this.handlers[u.cmd]={original:e,description:r,handler:i,builder:n||{},middlewares:l,deprecated:a,demanded:u.demanded,optional:u.optional},f&&(this.defaultCommand=this.handlers[u.cmd])}}getCommandHandlers(){return this.handlers}getCommands(){return Object.keys(this.handlers).concat(Object.keys(this.aliasMap))}hasDefaultCommand(){return!!this.defaultCommand}runCommand(e,r,n,i,o,a){let c=this.handlers[e]||this.handlers[this.aliasMap[e]]||this.defaultCommand,l=r.getInternalMethods().getContext(),u=l.commands.slice(),f=!e;e&&(l.commands.push(e),l.fullCommands.push(c.original));let p=this.applyBuilderUpdateUsageAndParse(f,c,r,n.aliases,u,i,o,a);return aa(p)?p.then(m=>this.applyMiddlewareAndGetResult(f,c,m.innerArgv,l,o,m.aliases,r)):this.applyMiddlewareAndGetResult(f,c,p.innerArgv,l,o,p.aliases,r)}applyBuilderUpdateUsageAndParse(e,r,n,i,o,a,c,l){let u=r.builder,f=n;if(KJ(u)){n.getInternalMethods().getUsageInstance().freeze();let p=u(n.getInternalMethods().reset(i),l);if(aa(p))return p.then(m=>(f=FVe(m)?m:n,this.parseAndUpdateUsage(e,r,f,o,a,c)))}else VWt(u)&&(n.getInternalMethods().getUsageInstance().freeze(),f=n.getInternalMethods().reset(i),Object.keys(r.builder).forEach(p=>{f.option(p,u[p])}));return this.parseAndUpdateUsage(e,r,f,o,a,c)}parseAndUpdateUsage(e,r,n,i,o,a){e&&n.getInternalMethods().getUsageInstance().unfreeze(!0),this.shouldUpdateUsage(n)&&n.getInternalMethods().getUsageInstance().usage(this.usageFromParentCommandsCommandHandler(i,r),r.description);let c=n.getInternalMethods().runYargsParserAndExecuteCommands(null,void 0,!0,o,a);return aa(c)?c.then(l=>({aliases:n.parsed.aliases,innerArgv:l})):{aliases:n.parsed.aliases,innerArgv:c}}shouldUpdateUsage(e){return!e.getInternalMethods().getUsageInstance().getUsageDisabled()&&e.getInternalMethods().getUsageInstance().getUsage().length===0}usageFromParentCommandsCommandHandler(e,r){let n=r3.test(r.original)?r.original.replace(r3,"").trim():r.original,i=e.filter(o=>!r3.test(o));return i.push(n),`$0 ${i.join(" ")}`}handleValidationAndGetResult(e,r,n,i,o,a,c,l){if(!a.getInternalMethods().getHasOutput()){let u=a.getInternalMethods().runValidation(o,l,a.parsed.error,e);n=IR(n,f=>(u(f),f))}if(r.handler&&!a.getInternalMethods().getHasOutput()){a.getInternalMethods().setHasOutput();let u=!!a.getOptions().configuration["populate--"];a.getInternalMethods().postProcess(n,u,!1,!1),n=bR(n,a,c,!1),n=IR(n,f=>{let p=r.handler(f);return aa(p)?p.then(()=>f):f}),e||a.getInternalMethods().getUsageInstance().cacheHelpMessage(),aa(n)&&!a.getInternalMethods().hasParseCallback()&&n.catch(f=>{try{a.getInternalMethods().getUsageInstance().fail(null,f)}catch{}})}return e||(i.commands.pop(),i.fullCommands.pop()),n}applyMiddlewareAndGetResult(e,r,n,i,o,a,c){let l={};if(o)return n;c.getInternalMethods().getHasOutput()||(l=this.populatePositionals(r,n,i,c));let u=this.globalMiddleware.getMiddleware().slice(0).concat(r.middlewares),f=bR(n,c,u,!0);return aa(f)?f.then(p=>this.handleValidationAndGetResult(e,r,p,i,a,c,u,l)):this.handleValidationAndGetResult(e,r,f,i,a,c,u,l)}populatePositionals(e,r,n,i){r._=r._.slice(n.commands.length);let o=e.demanded.slice(0),a=e.optional.slice(0),c={};for(this.validation.positionalCount(o.length,r._.length);o.length;){let l=o.shift();this.populatePositional(l,r,c)}for(;a.length;){let l=a.shift();this.populatePositional(l,r,c)}return r._=n.commands.concat(r._.map(l=>""+l)),this.postProcessPositionals(r,c,this.cmdToParseOptions(e.original),i),c}populatePositional(e,r,n){let i=e.cmd[0];e.variadic?n[i]=r._.splice(0).map(String):r._.length&&(n[i]=[String(r._.shift())])}cmdToParseOptions(e){let r={array:[],default:{},alias:{},demand:{}},n=DT(e);return n.demanded.forEach(i=>{let[o,...a]=i.cmd;i.variadic&&(r.array.push(o),r.default[o]=[]),r.alias[o]=a,r.demand[o]=!0}),n.optional.forEach(i=>{let[o,...a]=i.cmd;i.variadic&&(r.array.push(o),r.default[o]=[]),r.alias[o]=a}),r}postProcessPositionals(e,r,n,i){let o=Object.assign({},i.getOptions());o.default=Object.assign(n.default,o.default);for(let u of Object.keys(n.alias))o.alias[u]=(o.alias[u]||[]).concat(n.alias[u]);o.array=o.array.concat(n.array),o.config={};let a=[];if(Object.keys(r).forEach(u=>{r[u].map(f=>{o.configuration["unknown-options-as-args"]&&(o.key[u]=!0),a.push(`--${u}`),a.push(f)})}),!a.length)return;let c=Object.assign({},o.configuration,{"populate--":!1}),l=this.shim.Parser.detailed(a,Object.assign({},o,{configuration:c}));if(l.error)i.getInternalMethods().getUsageInstance().fail(l.error.message,l.error);else{let u=Object.keys(r);Object.keys(r).forEach(f=>{u.push(...l.aliases[f])}),Object.keys(l.argv).forEach(f=>{u.includes(f)&&(r[f]||(r[f]=l.argv[f]),!this.isInConfigs(i,f)&&!this.isDefaulted(i,f)&&Object.prototype.hasOwnProperty.call(e,f)&&Object.prototype.hasOwnProperty.call(l.argv,f)&&(Array.isArray(e[f])||Array.isArray(l.argv[f]))?e[f]=[].concat(e[f],l.argv[f]):e[f]=l.argv[f])})}}isDefaulted(e,r){let{default:n}=e.getOptions();return Object.prototype.hasOwnProperty.call(n,r)||Object.prototype.hasOwnProperty.call(n,this.shim.Parser.camelCase(r))}isInConfigs(e,r){let{configObjects:n}=e.getOptions();return n.some(i=>Object.prototype.hasOwnProperty.call(i,r))||n.some(i=>Object.prototype.hasOwnProperty.call(i,this.shim.Parser.camelCase(r)))}runDefaultBuilderOn(e){if(!this.defaultCommand)return;if(this.shouldUpdateUsage(e)){let n=r3.test(this.defaultCommand.original)?this.defaultCommand.original:this.defaultCommand.original.replace(/^[^[\]<>]*/,"$0 ");e.getInternalMethods().getUsageInstance().usage(n,this.defaultCommand.description)}let r=this.defaultCommand.builder;if(KJ(r))return r(e,!0);MVe(r)||Object.keys(r).forEach(n=>{e.option(n,r[n])})}moduleName(e){let r=H1e(e);if(!r)throw new Error(`No command name given for module: ${this.shim.inspect(e)}`);return this.commandFromFilename(r.filename)}commandFromFilename(e){return this.shim.path.basename(e,this.shim.path.extname(e))}extractDesc({describe:e,description:r,desc:n}){for(let i of[e,r,n]){if(typeof i=="string"||i===!1)return i;_f(i,!0,this.shim)}return!1}freeze(){this.frozens.push({handlers:this.handlers,aliasMap:this.aliasMap,defaultCommand:this.defaultCommand})}unfreeze(){let e=this.frozens.pop();_f(e,void 0,this.shim),{handlers:this.handlers,aliasMap:this.aliasMap,defaultCommand:this.defaultCommand}=e}reset(){return this.handlers={},this.aliasMap={},this.defaultCommand=void 0,this.requireCache=new Set,this}};function LVe(t,e,r,n){return new $1e(t,e,r,n)}s(LVe,"command");function MVe(t){return typeof t=="object"&&!!t.builder&&typeof t.handler=="function"}s(MVe,"isCommandBuilderDefinition");function GWt(t){return t.every(e=>typeof e=="string")}s(GWt,"isCommandAndAliases");function KJ(t){return typeof t=="function"}s(KJ,"isCommandBuilderCallback");function VWt(t){return typeof t=="object"}s(VWt,"isCommandBuilderOptionDefinitions");function zWt(t){return typeof t=="object"&&!Array.isArray(t)}s(zWt,"isCommandHandlerDefinition");d();d();function BT(t={},e=()=>!0){let r={};return t3(t).forEach(n=>{e(n,t[n])&&(r[n]=t[n])}),r}s(BT,"objFilter");d();function NT(t){typeof process>"u"||[process.stdout,process.stderr].forEach(e=>{let r=e;r._handle&&r.isTTY&&typeof r._handle.setBlocking=="function"&&r._handle.setBlocking(t)})}s(NT,"setBlocking");function KWt(t){return typeof t=="boolean"}s(KWt,"isBoolean");function QVe(t,e){let r=e.y18n.__,n={},i=[];n.failFn=s(function(U){i.push(U)},"failFn");let o=null,a=null,c=!0;n.showHelpOnFail=s(function(U=!0,Z){let[J,j]=typeof U=="string"?[!0,U]:[U,Z];return t.getInternalMethods().isGlobalContext()&&(a=j),o=j,c=J,n},"showHelpOnFailFn");let l=!1;n.fail=s(function(U,Z){let J=t.getInternalMethods().getLoggerInstance();if(i.length)for(let j=i.length-1;j>=0;--j){let W=i[j];if(KWt(W)){if(Z)throw Z;if(U)throw Error(U)}else W(U,Z,n)}else{if(t.getExitProcess()&&NT(!0),!l){l=!0,c&&(t.showHelp("error"),J.error()),(U||Z)&&J.error(U||Z);let j=o||a;j&&((U||Z)&&J.error(""),J.error(j))}if(Z=Z||new sa(U),t.getExitProcess())return t.exit(1);if(t.getInternalMethods().hasParseCallback())return t.exit(1,Z);throw Z}},"fail");let u=[],f=!1;n.usage=(Q,U)=>Q===null?(f=!0,u=[],n):(f=!1,u.push([Q,U||""]),n),n.getUsage=()=>u,n.getUsageDisabled=()=>f,n.getPositionalGroupName=()=>r("Positionals:");let p=[];n.example=(Q,U)=>{p.push([Q,U||""])};let m=[];n.command=s(function(U,Z,J,j,W=!1){J&&(m=m.map(X=>(X[2]=!1,X))),m.push([U,Z||"",J,j,W])},"command"),n.getCommands=()=>m;let h={};n.describe=s(function(U,Z){Array.isArray(U)?U.forEach(J=>{n.describe(J,Z)}):typeof U=="object"?Object.keys(U).forEach(J=>{n.describe(J,U[J])}):h[U]=Z},"describe"),n.getDescriptions=()=>h;let g=[];n.epilog=Q=>{g.push(Q)};let A=!1,y;n.wrap=Q=>{A=!0,y=Q},n.getWrap=()=>e.getEnv("YARGS_DISABLE_WRAP")?null:(A||(y=Y(),A=!0),y);let E="__yargsString__:";n.deferY18nLookup=Q=>E+Q,n.help=s(function(){if(R)return R;S();let U=t.customScriptName?t.$0:e.path.basename(t.$0),Z=t.getDemandedOptions(),J=t.getDemandedCommands(),j=t.getDeprecatedOptions(),W=t.getGroups(),X=t.getOptions(),oe=[];oe=oe.concat(Object.keys(h)),oe=oe.concat(Object.keys(Z)),oe=oe.concat(Object.keys(J)),oe=oe.concat(Object.keys(X.default)),oe=oe.filter(L),oe=Object.keys(oe.reduce((Fe,lt)=>(lt!=="_"&&(Fe[lt]=!0),Fe),{}));let te=n.getWrap(),re=e.cliui({width:te,wrap:!!te});if(!f){if(u.length)u.forEach(Fe=>{re.div({text:`${Fe[0].replace(/\$0/g,U)}`}),Fe[1]&&re.div({text:`${Fe[1]}`,padding:[1,0,0,0]})}),re.div();else if(m.length){let Fe=null;J._?Fe=`${U} <${r("command")}>
`:Fe=`${U} [${r("command")}]
`,re.div(`${Fe}`)}}if(m.length>1||m.length===1&&!m[0][2]){re.div(r("Commands:"));let Fe=t.getInternalMethods().getContext(),lt=Fe.commands.length?`${Fe.commands.join(" ")} `:"";t.getInternalMethods().getParserConfiguration()["sort-commands"]===!0&&(m=m.sort((xt,gt)=>xt[0].localeCompare(gt[0])));let _t=U?`${U} `:"";m.forEach(xt=>{let gt=`${_t}${lt}${xt[0].replace(/^\$0 ?/,"")}`;re.span({text:gt,padding:[0,2,0,2],width:b(m,te,`${U}${lt}`)+4},{text:xt[1]});let ue=[];xt[2]&&ue.push(`[${r("default")}]`),xt[3]&&xt[3].length&&ue.push(`[${r("aliases:")} ${xt[3].join(", ")}]`),xt[4]&&(typeof xt[4]=="string"?ue.push(`[${r("deprecated: %s",xt[4])}]`):ue.push(`[${r("deprecated")}]`)),ue.length?re.div({text:ue.join(" "),padding:[0,0,0,2],align:"right"}):re.div()}),re.div()}let pe=(Object.keys(X.alias)||[]).concat(Object.keys(t.parsed.newAliases)||[]);oe=oe.filter(Fe=>!t.parsed.newAliases[Fe]&&pe.every(lt=>(X.alias[lt]||[]).indexOf(Fe)===-1));let Ae=r("Options:");W[Ae]||(W[Ae]=[]),B(oe,X.alias,W,Ae);let Oe=s(Fe=>/^--/.test(YJ(Fe)),"isLongSwitch"),Te=Object.keys(W).filter(Fe=>W[Fe].length>0).map(Fe=>{let lt=W[Fe].filter(L).map(_t=>{if(pe.includes(_t))return _t;for(let xt=0,gt;(gt=pe[xt])!==void 0;xt++)if((X.alias[gt]||[]).includes(_t))return gt;return _t});return{groupName:Fe,normalizedKeys:lt}}).filter(({normalizedKeys:Fe})=>Fe.length>0).map(({groupName:Fe,normalizedKeys:lt})=>{let _t=lt.reduce((xt,gt)=>(xt[gt]=[gt].concat(X.alias[gt]||[]).map(ue=>Fe===n.getPositionalGroupName()?ue:(/^[0-9]$/.test(ue)?X.boolean.includes(gt)?"-":"--":ue.length>1?"--":"-")+ue).sort((ue,Ue)=>Oe(ue)===Oe(Ue)?0:Oe(ue)?1:-1).join(", "),xt),{});return{groupName:Fe,normalizedKeys:lt,switches:_t}});if(Te.filter(({groupName:Fe})=>Fe!==n.getPositionalGroupName()).some(({normalizedKeys:Fe,switches:lt})=>!Fe.every(_t=>Oe(lt[_t])))&&Te.filter(({groupName:Fe})=>Fe!==n.getPositionalGroupName()).forEach(({normalizedKeys:Fe,switches:lt})=>{Fe.forEach(_t=>{Oe(lt[_t])&&(lt[_t]=YWt(lt[_t],4))})}),Te.forEach(({groupName:Fe,normalizedKeys:lt,switches:_t})=>{re.div(Fe),lt.forEach(xt=>{let gt=_t[xt],ue=h[xt]||"",Ue=null;ue.includes(E)&&(ue=r(ue.substring(E.length))),X.boolean.includes(xt)&&(Ue=`[${r("boolean")}]`),X.count.includes(xt)&&(Ue=`[${r("count")}]`),X.string.includes(xt)&&(Ue=`[${r("string")}]`),X.normalize.includes(xt)&&(Ue=`[${r("string")}]`),X.array.includes(xt)&&(Ue=`[${r("array")}]`),X.number.includes(xt)&&(Ue=`[${r("number")}]`);let ye=s(le=>typeof le=="string"?`[${r("deprecated: %s",le)}]`:`[${r("deprecated")}]`,"deprecatedExtra"),$e=[xt in j?ye(j[xt]):null,Ue,xt in Z?`[${r("required")}]`:null,X.choices&&X.choices[xt]?`[${r("choices:")} ${n.stringifiedValues(X.choices[xt])}]`:null,O(X.default[xt],X.defaultDescription[xt])].filter(Boolean).join(" ");re.span({text:YJ(gt),padding:[0,2,0,2+OVe(gt)],width:b(_t,te)+4},ue);let ae=t.getInternalMethods().getUsageConfiguration()["hide-types"]===!0;$e&&!ae?re.div({text:$e,padding:[0,0,0,2],align:"right"}):re.div()}),re.div()}),p.length&&(re.div(r("Examples:")),p.forEach(Fe=>{Fe[0]=Fe[0].replace(/\$0/g,U)}),p.forEach(Fe=>{Fe[1]===""?re.div({text:Fe[0],padding:[0,2,0,2]}):re.div({text:Fe[0],padding:[0,2,0,2],width:b(p,te)+4},{text:Fe[1]})}),re.div()),g.length>0){let Fe=g.map(lt=>lt.replace(/\$0/g,U)).join(`
`);re.div(`${Fe}
`)}return re.toString().replace(/\s*$/,"")},"help");function b(Q,U,Z){let J=0;return Array.isArray(Q)||(Q=Object.values(Q).map(j=>[j])),Q.forEach(j=>{J=Math.max(e.stringWidth(Z?`${Z} ${YJ(j[0])}`:YJ(j[0]))+OVe(j[0]),J)}),U&&(J=Math.min(J,parseInt((U*.5).toString(),10))),J}s(b,"maxWidth");function S(){let Q=t.getDemandedOptions(),U=t.getOptions();(Object.keys(U.alias)||[]).forEach(Z=>{U.alias[Z].forEach(J=>{h[J]&&n.describe(Z,h[J]),J in Q&&t.demandOption(Z,Q[J]),U.boolean.includes(J)&&t.boolean(Z),U.count.includes(J)&&t.count(Z),U.string.includes(J)&&t.string(Z),U.normalize.includes(J)&&t.normalize(Z),U.array.includes(J)&&t.array(Z),U.number.includes(J)&&t.number(Z)})})}s(S,"normalizeAliases");let R;n.cacheHelpMessage=function(){R=this.help()},n.clearCachedHelpMessage=function(){R=void 0},n.hasCachedHelpMessage=function(){return!!R};function B(Q,U,Z,J){let j=[],W=null;return Object.keys(Z).forEach(X=>{j=j.concat(Z[X])}),Q.forEach(X=>{W=[X].concat(U[X]),W.some(oe=>j.indexOf(oe)!==-1)||Z[J].push(X)}),j}s(B,"addUngroupedKeys");function L(Q){return t.getOptions().hiddenOptions.indexOf(Q)<0||t.parsed.argv[t.getOptions().showHiddenOpt]}s(L,"filterHiddenOptions"),n.showHelp=Q=>{let U=t.getInternalMethods().getLoggerInstance();Q||(Q="error"),(typeof Q=="function"?Q:U[Q])(n.help())},n.functionDescription=Q=>["(",Q.name?e.Parser.decamelize(Q.name,"-"):r("generated-value"),")"].join(""),n.stringifiedValues=s(function(U,Z){let J="",j=Z||", ",W=[].concat(U);return!U||!W.length||W.forEach(X=>{J.length&&(J+=j),J+=JSON.stringify(X)}),J},"stringifiedValues");function O(Q,U){let Z=`[${r("default:")} `;if(Q===void 0&&!U)return null;if(U)Z+=U;else switch(typeof Q){case"string":Z+=`"${Q}"`;break;case"object":Z+=JSON.stringify(Q);break;default:Z+=Q}return`${Z}]`}s(O,"defaultString");function Y(){return e.process.stdColumns?Math.min(80,e.process.stdColumns):80}s(Y,"windowWidth");let V=null;n.version=Q=>{V=Q},n.showVersion=Q=>{let U=t.getInternalMethods().getLoggerInstance();Q||(Q="error"),(typeof Q=="function"?Q:U[Q])(V)},n.reset=s(function(U){return o=null,l=!1,u=[],f=!1,g=[],p=[],m=[],h=BT(h,Z=>!U[Z]),n},"reset");let z=[];return n.freeze=s(function(){z.push({failMessage:o,failureOutput:l,usages:u,usageDisabled:f,epilogs:g,examples:p,commands:m,descriptions:h})},"freeze"),n.unfreeze=s(function(U=!1){let Z=z.pop();Z&&(U?(h={...Z.descriptions,...h},m=[...Z.commands,...m],u=[...Z.usages,...u],p=[...Z.examples,...p],g=[...Z.epilogs,...g]):{failMessage:o,failureOutput:l,usages:u,usageDisabled:f,epilogs:g,examples:p,commands:m,descriptions:h}=Z)},"unfreeze"),n}s(QVe,"usage");function W1e(t){return typeof t=="object"}s(W1e,"isIndentedText");function YWt(t,e){return W1e(t)?{text:t.text,indentation:t.indentation+e}:{text:t,indentation:e}}s(YWt,"addIndentation");function OVe(t){return W1e(t)?t.indentation:0}s(OVe,"getIndentation");function YJ(t){return W1e(t)?t.text:t}s(YJ,"getText");d();d();var UVe=`###-begin-{{app_name}}-completions-###
#
# yargs command completion script
#
# Installation: {{app_path}} {{completion_command}} >> ~/.bashrc
#    or {{app_path}} {{completion_command}} >> ~/.bash_profile on OSX.
#
_{{app_name}}_yargs_completions()
{
    local cur_word args type_list

    cur_word="\${COMP_WORDS[COMP_CWORD]}"
    args=("\${COMP_WORDS[@]}")

    # ask yargs to generate completions.
    type_list=$({{app_path}} --get-yargs-completions "\${args[@]}")

    COMPREPLY=( $(compgen -W "\${type_list}" -- \${cur_word}) )

    # if no match was found, fall back to filename completion
    if [ \${#COMPREPLY[@]} -eq 0 ]; then
      COMPREPLY=()
    fi

    return 0
}
complete -o bashdefault -o default -F _{{app_name}}_yargs_completions {{app_name}}
###-end-{{app_name}}-completions-###
`,qVe=`#compdef {{app_name}}
###-begin-{{app_name}}-completions-###
#
# yargs command completion script
#
# Installation: {{app_path}} {{completion_command}} >> ~/.zshrc
#    or {{app_path}} {{completion_command}} >> ~/.zprofile on OSX.
#
_{{app_name}}_yargs_completions()
{
  local reply
  local si=$IFS
  IFS=$'
' reply=($(COMP_CWORD="$((CURRENT-1))" COMP_LINE="$BUFFER" COMP_POINT="$CURSOR" {{app_path}} --get-yargs-completions "\${words[@]}"))
  IFS=$si
  _describe 'values' reply
}
compdef _{{app_name}}_yargs_completions {{app_name}}
###-end-{{app_name}}-completions-###
`;var j1e=class{static{s(this,"Completion")}constructor(e,r,n,i){var o,a,c;this.yargs=e,this.usage=r,this.command=n,this.shim=i,this.completionKey="get-yargs-completions",this.aliases=null,this.customCompletionFunction=null,this.indexAfterLastReset=0,this.zshShell=(c=((o=this.shim.getEnv("SHELL"))===null||o===void 0?void 0:o.includes("zsh"))||((a=this.shim.getEnv("ZSH_NAME"))===null||a===void 0?void 0:a.includes("zsh")))!==null&&c!==void 0?c:!1}defaultCompletion(e,r,n,i){let o=this.command.getCommandHandlers();for(let c=0,l=e.length;c<l;++c)if(o[e[c]]&&o[e[c]].builder){let u=o[e[c]].builder;if(KJ(u)){this.indexAfterLastReset=c+1;let f=this.yargs.getInternalMethods().reset();return u(f,!0),f.argv}}let a=[];this.commandCompletions(a,e,n),this.optionCompletions(a,e,r,n),this.choicesFromOptionsCompletions(a,e,r,n),this.choicesFromPositionalsCompletions(a,e,r,n),i(null,a)}commandCompletions(e,r,n){let i=this.yargs.getInternalMethods().getContext().commands;!n.match(/^-/)&&i[i.length-1]!==n&&!this.previousArgHasChoices(r)&&this.usage.getCommands().forEach(o=>{let a=DT(o[0]).cmd;if(r.indexOf(a)===-1)if(!this.zshShell)e.push(a);else{let c=o[1]||"";e.push(a.replace(/:/g,"\\:")+":"+c)}})}optionCompletions(e,r,n,i){if((i.match(/^-/)||i===""&&e.length===0)&&!this.previousArgHasChoices(r)){let o=this.yargs.getOptions(),a=this.yargs.getGroups()[this.usage.getPositionalGroupName()]||[];Object.keys(o.key).forEach(c=>{let l=!!o.configuration["boolean-negation"]&&o.boolean.includes(c);!a.includes(c)&&!o.hiddenOptions.includes(c)&&!this.argsContainKey(r,c,l)&&this.completeOptionKey(c,e,i,l&&!!o.default[c])})}}choicesFromOptionsCompletions(e,r,n,i){if(this.previousArgHasChoices(r)){let o=this.getPreviousArgChoices(r);o&&o.length>0&&e.push(...o.map(a=>a.replace(/:/g,"\\:")))}}choicesFromPositionalsCompletions(e,r,n,i){if(i===""&&e.length>0&&this.previousArgHasChoices(r))return;let o=this.yargs.getGroups()[this.usage.getPositionalGroupName()]||[],a=Math.max(this.indexAfterLastReset,this.yargs.getInternalMethods().getContext().commands.length+1),c=o[n._.length-a-1];if(!c)return;let l=this.yargs.getOptions().choices[c]||[];for(let u of l)u.startsWith(i)&&e.push(u.replace(/:/g,"\\:"))}getPreviousArgChoices(e){if(e.length<1)return;let r=e[e.length-1],n="";if(!r.startsWith("-")&&e.length>1&&(n=r,r=e[e.length-2]),!r.startsWith("-"))return;let i=r.replace(/^-+/,""),o=this.yargs.getOptions(),a=[i,...this.yargs.getAliases()[i]||[]],c;for(let l of a)if(Object.prototype.hasOwnProperty.call(o.key,l)&&Array.isArray(o.choices[l])){c=o.choices[l];break}if(c)return c.filter(l=>!n||l.startsWith(n))}previousArgHasChoices(e){let r=this.getPreviousArgChoices(e);return r!==void 0&&r.length>0}argsContainKey(e,r,n){let i=s(o=>e.indexOf((/^[^0-9]$/.test(o)?"-":"--")+o)!==-1,"argsContains");if(i(r)||n&&i(`no-${r}`))return!0;if(this.aliases){for(let o of this.aliases[r])if(i(o))return!0}return!1}completeOptionKey(e,r,n,i){var o,a,c,l;let u=e;if(this.zshShell){let h=this.usage.getDescriptions(),g=(a=(o=this===null||this===void 0?void 0:this.aliases)===null||o===void 0?void 0:o[e])===null||a===void 0?void 0:a.find(E=>{let b=h[E];return typeof b=="string"&&b.length>0}),A=g?h[g]:void 0,y=(l=(c=h[e])!==null&&c!==void 0?c:A)!==null&&l!==void 0?l:"";u=`${e.replace(/:/g,"\\:")}:${y.replace("__yargsString__:","").replace(/(\r\n|\n|\r)/gm," ")}`}let f=s(h=>/^--/.test(h),"startsByTwoDashes"),p=s(h=>/^[^0-9]$/.test(h),"isShortOption"),m=!f(n)&&p(e)?"-":"--";r.push(m+u),i&&r.push(m+"no-"+u)}customCompletion(e,r,n,i){if(_f(this.customCompletionFunction,null,this.shim),XWt(this.customCompletionFunction)){let o=this.customCompletionFunction(n,r);return aa(o)?o.then(a=>{this.shim.process.nextTick(()=>{i(null,a)})}).catch(a=>{this.shim.process.nextTick(()=>{i(a,void 0)})}):i(null,o)}else return ZWt(this.customCompletionFunction)?this.customCompletionFunction(n,r,(o=i)=>this.defaultCompletion(e,r,n,o),o=>{i(null,o)}):this.customCompletionFunction(n,r,o=>{i(null,o)})}getCompletion(e,r){let n=e.length?e[e.length-1]:"",i=this.yargs.parse(e,!0),o=this.customCompletionFunction?a=>this.customCompletion(e,a,n,r):a=>this.defaultCompletion(e,a,n,r);return aa(i)?i.then(o):o(i)}generateCompletionScript(e,r){let n=this.zshShell?qVe:UVe,i=this.shim.path.basename(e);return e.match(/\.js$/)&&(e=`./${e}`),n=n.replace(/{{app_name}}/g,i),n=n.replace(/{{completion_command}}/g,r),n.replace(/{{app_path}}/g,e)}registerFunction(e){this.customCompletionFunction=e}setParsed(e){this.aliases=e.aliases}};function HVe(t,e,r,n){return new j1e(t,e,r,n)}s(HVe,"completion");function XWt(t){return t.length<3}s(XWt,"isSyncCompletionFunction");function ZWt(t){return t.length>3}s(ZWt,"isFallbackCompletionFunction");d();d();function $Ve(t,e){if(t.length===0)return e.length;if(e.length===0)return t.length;let r=[],n;for(n=0;n<=e.length;n++)r[n]=[n];let i;for(i=0;i<=t.length;i++)r[0][i]=i;for(n=1;n<=e.length;n++)for(i=1;i<=t.length;i++)e.charAt(n-1)===t.charAt(i-1)?r[n][i]=r[n-1][i-1]:n>1&&i>1&&e.charAt(n-2)===t.charAt(i-1)&&e.charAt(n-1)===t.charAt(i-2)?r[n][i]=r[n-2][i-2]+1:r[n][i]=Math.min(r[n-1][i-1]+1,Math.min(r[n][i-1]+1,r[n-1][i]+1));return r[e.length][t.length]}s($Ve,"levenshtein");var WVe=["$0","--","_"];function jVe(t,e,r){let n=r.y18n.__,i=r.y18n.__n,o={};o.nonOptionCount=s(function(p){let m=t.getDemandedCommands(),g=p._.length+(p["--"]?p["--"].length:0)-t.getInternalMethods().getContext().commands.length;m._&&(g<m._.min||g>m._.max)&&(g<m._.min?m._.minMsg!==void 0?e.fail(m._.minMsg?m._.minMsg.replace(/\$0/g,g.toString()).replace(/\$1/,m._.min.toString()):null):e.fail(i("Not enough non-option arguments: got %s, need at least %s","Not enough non-option arguments: got %s, need at least %s",g,g.toString(),m._.min.toString())):g>m._.max&&(m._.maxMsg!==void 0?e.fail(m._.maxMsg?m._.maxMsg.replace(/\$0/g,g.toString()).replace(/\$1/,m._.max.toString()):null):e.fail(i("Too many non-option arguments: got %s, maximum of %s","Too many non-option arguments: got %s, maximum of %s",g,g.toString(),m._.max.toString()))))},"nonOptionCount"),o.positionalCount=s(function(p,m){m<p&&e.fail(i("Not enough non-option arguments: got %s, need at least %s","Not enough non-option arguments: got %s, need at least %s",m,m+"",p+""))},"positionalCount"),o.requiredArguments=s(function(p,m){let h=null;for(let g of Object.keys(m))(!Object.prototype.hasOwnProperty.call(p,g)||typeof p[g]>"u")&&(h=h||{},h[g]=m[g]);if(h){let g=[];for(let y of Object.keys(h)){let E=h[y];E&&g.indexOf(E)<0&&g.push(E)}let A=g.length?`
${g.join(`
`)}`:"";e.fail(i("Missing required argument: %s","Missing required arguments: %s",Object.keys(h).length,Object.keys(h).join(", ")+A))}},"requiredArguments"),o.unknownArguments=s(function(p,m,h,g,A=!0){var y;let E=t.getInternalMethods().getCommandInstance().getCommands(),b=[],S=t.getInternalMethods().getContext();if(Object.keys(p).forEach(R=>{!WVe.includes(R)&&!Object.prototype.hasOwnProperty.call(h,R)&&!Object.prototype.hasOwnProperty.call(t.getInternalMethods().getParseContext(),R)&&!o.isValidAndSomeAliasIsNotNew(R,m)&&b.push(R)}),A&&(S.commands.length>0||E.length>0||g)&&p._.slice(S.commands.length).forEach(R=>{E.includes(""+R)||b.push(""+R)}),A){let B=((y=t.getDemandedCommands()._)===null||y===void 0?void 0:y.max)||0,L=S.commands.length+B;L<p._.length&&p._.slice(L).forEach(O=>{O=String(O),!S.commands.includes(O)&&!b.includes(O)&&b.push(O)})}b.length&&e.fail(i("Unknown argument: %s","Unknown arguments: %s",b.length,b.map(R=>R.trim()?R:`"${R}"`).join(", ")))},"unknownArguments"),o.unknownCommands=s(function(p){let m=t.getInternalMethods().getCommandInstance().getCommands(),h=[],g=t.getInternalMethods().getContext();return(g.commands.length>0||m.length>0)&&p._.slice(g.commands.length).forEach(A=>{m.includes(""+A)||h.push(""+A)}),h.length>0?(e.fail(i("Unknown command: %s","Unknown commands: %s",h.length,h.join(", "))),!0):!1},"unknownCommands"),o.isValidAndSomeAliasIsNotNew=s(function(p,m){if(!Object.prototype.hasOwnProperty.call(m,p))return!1;let h=t.parsed.newAliases;return[p,...m[p]].some(g=>!Object.prototype.hasOwnProperty.call(h,g)||!h[p])},"isValidAndSomeAliasIsNotNew"),o.limitedChoices=s(function(p){let m=t.getOptions(),h={};if(!Object.keys(m.choices).length)return;Object.keys(p).forEach(y=>{WVe.indexOf(y)===-1&&Object.prototype.hasOwnProperty.call(m.choices,y)&&[].concat(p[y]).forEach(E=>{m.choices[y].indexOf(E)===-1&&E!==void 0&&(h[y]=(h[y]||[]).concat(E))})});let g=Object.keys(h);if(!g.length)return;let A=n("Invalid values:");g.forEach(y=>{A+=`
  ${n("Argument: %s, Given: %s, Choices: %s",y,e.stringifiedValues(h[y]),e.stringifiedValues(m.choices[y]))}`}),e.fail(A)},"limitedChoices");let a={};o.implies=s(function(p,m){Lr("<string|object> [array|number|string]",[p,m],arguments.length),typeof p=="object"?Object.keys(p).forEach(h=>{o.implies(h,p[h])}):(t.global(p),a[p]||(a[p]=[]),Array.isArray(m)?m.forEach(h=>o.implies(p,h)):(_f(m,void 0,r),a[p].push(m)))},"implies"),o.getImplied=s(function(){return a},"getImplied");function c(f,p){let m=Number(p);return p=isNaN(m)?p:m,typeof p=="number"?p=f._.length>=p:p.match(/^--no-.+/)?(p=p.match(/^--no-(.+)/)[1],p=!Object.prototype.hasOwnProperty.call(f,p)):p=Object.prototype.hasOwnProperty.call(f,p),p}s(c,"keyExists"),o.implications=s(function(p){let m=[];if(Object.keys(a).forEach(h=>{let g=h;(a[h]||[]).forEach(A=>{let y=g,E=A;y=c(p,y),A=c(p,A),y&&!A&&m.push(` ${g} -> ${E}`)})}),m.length){let h=`${n("Implications failed:")}
`;m.forEach(g=>{h+=g}),e.fail(h)}},"implications");let l={};o.conflicts=s(function(p,m){Lr("<string|object> [array|string]",[p,m],arguments.length),typeof p=="object"?Object.keys(p).forEach(h=>{o.conflicts(h,p[h])}):(t.global(p),l[p]||(l[p]=[]),Array.isArray(m)?m.forEach(h=>o.conflicts(p,h)):l[p].push(m))},"conflicts"),o.getConflicting=()=>l,o.conflicting=s(function(p){Object.keys(p).forEach(m=>{l[m]&&l[m].forEach(h=>{h&&p[m]!==void 0&&p[h]!==void 0&&e.fail(n("Arguments %s and %s are mutually exclusive",m,h))})}),t.getInternalMethods().getParserConfiguration()["strip-dashed"]&&Object.keys(l).forEach(m=>{l[m].forEach(h=>{h&&p[r.Parser.camelCase(m)]!==void 0&&p[r.Parser.camelCase(h)]!==void 0&&e.fail(n("Arguments %s and %s are mutually exclusive",m,h))})})},"conflictingFn"),o.recommendCommands=s(function(p,m){m=m.sort((y,E)=>E.length-y.length);let g=null,A=1/0;for(let y=0,E;(E=m[y])!==void 0;y++){let b=$Ve(p,E);b<=3&&b<A&&(A=b,g=E)}g&&e.fail(n("Did you mean %s?",g))},"recommendCommands"),o.reset=s(function(p){return a=BT(a,m=>!p[m]),l=BT(l,m=>!p[m]),o},"reset");let u=[];return o.freeze=s(function(){u.push({implied:a,conflicting:l})},"freeze"),o.unfreeze=s(function(){let p=u.pop();_f(p,void 0,r),{implied:a,conflicting:l}=p},"unfreeze"),o}s(jVe,"validation");d();var G1e=[],e7;function JJ(t,e,r,n){e7=n;let i={};if(Object.prototype.hasOwnProperty.call(t,"extends")){if(typeof t.extends!="string")return i;let o=/\.json|\..*rc$/.test(t.extends),a=null;if(o)a=tjt(e,t.extends);else try{a=require.resolve(t.extends)}catch{return t}ejt(a),G1e.push(a),i=o?JSON.parse(e7.readFileSync(a,"utf8")):require(t.extends),delete t.extends,i=JJ(i,e7.path.dirname(a),r,e7)}return G1e=[],r?GVe(i,t):Object.assign({},i,t)}s(JJ,"applyExtends");function ejt(t){if(G1e.indexOf(t)>-1)throw new sa(`Circular extended configurations: '${t}'.`)}s(ejt,"checkForCircularExtends");function tjt(t,e){return e7.path.resolve(t,e)}s(tjt,"getPathToDefaultConfig");function GVe(t,e){let r={};function n(i){return i&&typeof i=="object"&&!Array.isArray(i)}s(n,"isObject"),Object.assign(r,t);for(let i of Object.keys(e))n(e[i])&&n(r[i])?r[i]=GVe(t[i],e[i]):r[i]=e[i];return r}s(GVe,"mergeDeep");var Qr=function(t,e,r,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!i:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(t,r):i?i.value=r:e.set(t,r),r},he=function(t,e,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(t):n?n.value:e.get(t)},Oc,TR,t7,Eh,W0,XJ,MT,wR,ZJ,bh,eX,Ih,qC,j0,Th,tX,n3,cu,on,rX,nX,G0,SR,i3,_R,LT,iX,zn,RR,kR,PR,li,oX,HC,fc;function fze(t){return(e=[],r=t.process.cwd(),n)=>{let i=new nve(e,r,n,t);return Object.defineProperty(i,"argv",{get:s(()=>i.parse(),"get"),enumerable:!0}),i.help(),i.version(),i}}s(fze,"YargsFactory");var VVe=Symbol("copyDoubleDash"),zVe=Symbol("copyDoubleDash"),V1e=Symbol("deleteFromParserHintObject"),KVe=Symbol("emitWarning"),YVe=Symbol("freeze"),JVe=Symbol("getDollarZero"),DR=Symbol("getParserConfiguration"),XVe=Symbol("getUsageConfiguration"),z1e=Symbol("guessLocale"),ZVe=Symbol("guessVersion"),eze=Symbol("parsePositionalNumbers"),K1e=Symbol("pkgUp"),FT=Symbol("populateParserHintArray"),o3=Symbol("populateParserHintSingleValueDictionary"),Y1e=Symbol("populateParserHintArrayDictionary"),J1e=Symbol("populateParserHintDictionary"),X1e=Symbol("sanitizeKey"),Z1e=Symbol("setKey"),eve=Symbol("unfreeze"),tze=Symbol("validateAsync"),rze=Symbol("getCommandInstance"),nze=Symbol("getContext"),ize=Symbol("getHasOutput"),oze=Symbol("getLoggerInstance"),sze=Symbol("getParseContext"),aze=Symbol("getUsageInstance"),cze=Symbol("getValidationInstance"),sX=Symbol("hasParseCallback"),lze=Symbol("isGlobalContext"),BR=Symbol("postProcess"),uze=Symbol("rebase"),tve=Symbol("reset"),r7=Symbol("runYargsParserAndExecuteCommands"),rve=Symbol("runValidation"),dze=Symbol("setHasOutput"),NR=Symbol("kTrackManuallySetKeys"),nve=class{static{s(this,"YargsInstance")}constructor(e=[],r,n,i){this.customScriptName=!1,this.parsed=!1,Oc.set(this,void 0),TR.set(this,void 0),t7.set(this,{commands:[],fullCommands:[]}),Eh.set(this,null),W0.set(this,null),XJ.set(this,"show-hidden"),MT.set(this,null),wR.set(this,!0),ZJ.set(this,{}),bh.set(this,!0),eX.set(this,[]),Ih.set(this,void 0),qC.set(this,{}),j0.set(this,!1),Th.set(this,null),tX.set(this,!0),n3.set(this,void 0),cu.set(this,""),on.set(this,void 0),rX.set(this,void 0),nX.set(this,{}),G0.set(this,null),SR.set(this,null),i3.set(this,{}),_R.set(this,{}),LT.set(this,void 0),iX.set(this,!1),zn.set(this,void 0),RR.set(this,!1),kR.set(this,!1),PR.set(this,!1),li.set(this,void 0),oX.set(this,{}),HC.set(this,null),fc.set(this,void 0),Qr(this,zn,i,"f"),Qr(this,LT,e,"f"),Qr(this,TR,r,"f"),Qr(this,rX,n,"f"),Qr(this,Ih,new zJ(this),"f"),this.$0=this[JVe](),this[tve](),Qr(this,Oc,he(this,Oc,"f"),"f"),Qr(this,li,he(this,li,"f"),"f"),Qr(this,fc,he(this,fc,"f"),"f"),Qr(this,on,he(this,on,"f"),"f"),he(this,on,"f").showHiddenOpt=he(this,XJ,"f"),Qr(this,n3,this[zVe](),"f")}addHelpOpt(e,r){let n="help";return Lr("[string|boolean] [string]",[e,r],arguments.length),he(this,Th,"f")&&(this[V1e](he(this,Th,"f")),Qr(this,Th,null,"f")),e===!1&&r===void 0?this:(Qr(this,Th,typeof e=="string"?e:n,"f"),this.boolean(he(this,Th,"f")),this.describe(he(this,Th,"f"),r||he(this,li,"f").deferY18nLookup("Show help")),this)}help(e,r){return this.addHelpOpt(e,r)}addShowHiddenOpt(e,r){if(Lr("[string|boolean] [string]",[e,r],arguments.length),e===!1&&r===void 0)return this;let n=typeof e=="string"?e:he(this,XJ,"f");return this.boolean(n),this.describe(n,r||he(this,li,"f").deferY18nLookup("Show hidden options")),he(this,on,"f").showHiddenOpt=n,this}showHidden(e,r){return this.addShowHiddenOpt(e,r)}alias(e,r){return Lr("<object|string|array> [string|array]",[e,r],arguments.length),this[Y1e](this.alias.bind(this),"alias",e,r),this}array(e){return Lr("<array|string>",[e],arguments.length),this[FT]("array",e),this[NR](e),this}boolean(e){return Lr("<array|string>",[e],arguments.length),this[FT]("boolean",e),this[NR](e),this}check(e,r){return Lr("<function> [boolean]",[e,r],arguments.length),this.middleware((n,i)=>IR(()=>e(n,i.getOptions()),o=>(o?(typeof o=="string"||o instanceof Error)&&he(this,li,"f").fail(o.toString(),o):he(this,li,"f").fail(he(this,zn,"f").y18n.__("Argument check failed: %s",e.toString())),n),o=>(he(this,li,"f").fail(o.message?o.message:o.toString(),o),n)),!1,r),this}choices(e,r){return Lr("<object|string|array> [string|array]",[e,r],arguments.length),this[Y1e](this.choices.bind(this),"choices",e,r),this}coerce(e,r){if(Lr("<object|string|array> [function]",[e,r],arguments.length),Array.isArray(e)){if(!r)throw new sa("coerce callback must be provided");for(let n of e)this.coerce(n,r);return this}else if(typeof e=="object"){for(let n of Object.keys(e))this.coerce(n,e[n]);return this}if(!r)throw new sa("coerce callback must be provided");return he(this,on,"f").key[e]=!0,he(this,Ih,"f").addCoerceMiddleware((n,i)=>{let o;return Object.prototype.hasOwnProperty.call(n,e)?IR(()=>(o=i.getAliases(),r(n[e])),c=>{n[e]=c;let l=i.getInternalMethods().getParserConfiguration()["strip-aliased"];if(o[e]&&l!==!0)for(let u of o[e])n[u]=c;return n},c=>{throw new sa(c.message)}):n},e),this}conflicts(e,r){return Lr("<string|object> [string|array]",[e,r],arguments.length),he(this,fc,"f").conflicts(e,r),this}config(e="config",r,n){return Lr("[object|string] [string|function] [function]",[e,r,n],arguments.length),typeof e=="object"&&!Array.isArray(e)?(e=JJ(e,he(this,TR,"f"),this[DR]()["deep-merge-config"]||!1,he(this,zn,"f")),he(this,on,"f").configObjects=(he(this,on,"f").configObjects||[]).concat(e),this):(typeof r=="function"&&(n=r,r=void 0),this.describe(e,r||he(this,li,"f").deferY18nLookup("Path to JSON config file")),(Array.isArray(e)?e:[e]).forEach(i=>{he(this,on,"f").config[i]=n||!0}),this)}completion(e,r,n){return Lr("[string] [string|boolean|function] [function]",[e,r,n],arguments.length),typeof r=="function"&&(n=r,r=void 0),Qr(this,W0,e||he(this,W0,"f")||"completion","f"),!r&&r!==!1&&(r="generate completion script"),this.command(he(this,W0,"f"),r),n&&he(this,Eh,"f").registerFunction(n),this}command(e,r,n,i,o,a){return Lr("<string|array|object> [string|boolean] [function|object] [function] [array] [boolean|string]",[e,r,n,i,o,a],arguments.length),he(this,Oc,"f").addHandler(e,r,n,i,o,a),this}commands(e,r,n,i,o,a){return this.command(e,r,n,i,o,a)}commandDir(e,r){Lr("<string> [object]",[e,r],arguments.length);let n=he(this,rX,"f")||he(this,zn,"f").require;return he(this,Oc,"f").addDirectory(e,n,he(this,zn,"f").getCallerFile(),r),this}count(e){return Lr("<array|string>",[e],arguments.length),this[FT]("count",e),this[NR](e),this}default(e,r,n){return Lr("<object|string|array> [*] [string]",[e,r,n],arguments.length),n&&(q1e(e,he(this,zn,"f")),he(this,on,"f").defaultDescription[e]=n),typeof r=="function"&&(q1e(e,he(this,zn,"f")),he(this,on,"f").defaultDescription[e]||(he(this,on,"f").defaultDescription[e]=he(this,li,"f").functionDescription(r)),r=r.call()),this[o3](this.default.bind(this),"default",e,r),this}defaults(e,r,n){return this.default(e,r,n)}demandCommand(e=1,r,n,i){return Lr("[number] [number|string] [string|null|undefined] [string|null|undefined]",[e,r,n,i],arguments.length),typeof r!="number"&&(n=r,r=1/0),this.global("_",!1),he(this,on,"f").demandedCommands._={min:e,max:r,minMsg:n,maxMsg:i},this}demand(e,r,n){return Array.isArray(r)?(r.forEach(i=>{_f(n,!0,he(this,zn,"f")),this.demandOption(i,n)}),r=1/0):typeof r!="number"&&(n=r,r=1/0),typeof e=="number"?(_f(n,!0,he(this,zn,"f")),this.demandCommand(e,r,n,n)):Array.isArray(e)?e.forEach(i=>{_f(n,!0,he(this,zn,"f")),this.demandOption(i,n)}):typeof n=="string"?this.demandOption(e,n):(n===!0||typeof n>"u")&&this.demandOption(e),this}demandOption(e,r){return Lr("<object|string|array> [string]",[e,r],arguments.length),this[o3](this.demandOption.bind(this),"demandedOptions",e,r),this}deprecateOption(e,r){return Lr("<string> [string|boolean]",[e,r],arguments.length),he(this,on,"f").deprecatedOptions[e]=r,this}describe(e,r){return Lr("<object|string|array> [string]",[e,r],arguments.length),this[Z1e](e,!0),he(this,li,"f").describe(e,r),this}detectLocale(e){return Lr("<boolean>",[e],arguments.length),Qr(this,wR,e,"f"),this}env(e){return Lr("[string|boolean]",[e],arguments.length),e===!1?delete he(this,on,"f").envPrefix:he(this,on,"f").envPrefix=e||"",this}epilogue(e){return Lr("<string>",[e],arguments.length),he(this,li,"f").epilog(e),this}epilog(e){return this.epilogue(e)}example(e,r){return Lr("<string|array> [string]",[e,r],arguments.length),Array.isArray(e)?e.forEach(n=>this.example(...n)):he(this,li,"f").example(e,r),this}exit(e,r){Qr(this,j0,!0,"f"),Qr(this,MT,r,"f"),he(this,bh,"f")&&he(this,zn,"f").process.exit(e)}exitProcess(e=!0){return Lr("[boolean]",[e],arguments.length),Qr(this,bh,e,"f"),this}fail(e){if(Lr("<function|boolean>",[e],arguments.length),typeof e=="boolean"&&e!==!1)throw new sa("Invalid first argument. Expected function or boolean 'false'");return he(this,li,"f").failFn(e),this}getAliases(){return this.parsed?this.parsed.aliases:{}}async getCompletion(e,r){return Lr("<array> [function]",[e,r],arguments.length),r?he(this,Eh,"f").getCompletion(e,r):new Promise((n,i)=>{he(this,Eh,"f").getCompletion(e,(o,a)=>{o?i(o):n(a)})})}getDemandedOptions(){return Lr([],0),he(this,on,"f").demandedOptions}getDemandedCommands(){return Lr([],0),he(this,on,"f").demandedCommands}getDeprecatedOptions(){return Lr([],0),he(this,on,"f").deprecatedOptions}getDetectLocale(){return he(this,wR,"f")}getExitProcess(){return he(this,bh,"f")}getGroups(){return Object.assign({},he(this,qC,"f"),he(this,_R,"f"))}getHelp(){if(Qr(this,j0,!0,"f"),!he(this,li,"f").hasCachedHelpMessage()){if(!this.parsed){let r=this[r7](he(this,LT,"f"),void 0,void 0,0,!0);if(aa(r))return r.then(()=>he(this,li,"f").help())}let e=he(this,Oc,"f").runDefaultBuilderOn(this);if(aa(e))return e.then(()=>he(this,li,"f").help())}return Promise.resolve(he(this,li,"f").help())}getOptions(){return he(this,on,"f")}getStrict(){return he(this,RR,"f")}getStrictCommands(){return he(this,kR,"f")}getStrictOptions(){return he(this,PR,"f")}global(e,r){return Lr("<string|array> [boolean]",[e,r],arguments.length),e=[].concat(e),r!==!1?he(this,on,"f").local=he(this,on,"f").local.filter(n=>e.indexOf(n)===-1):e.forEach(n=>{he(this,on,"f").local.includes(n)||he(this,on,"f").local.push(n)}),this}group(e,r){Lr("<string|array> <string>",[e,r],arguments.length);let n=he(this,_R,"f")[r]||he(this,qC,"f")[r];he(this,_R,"f")[r]&&delete he(this,_R,"f")[r];let i={};return he(this,qC,"f")[r]=(n||[]).concat(e).filter(o=>i[o]?!1:i[o]=!0),this}hide(e){return Lr("<string>",[e],arguments.length),he(this,on,"f").hiddenOptions.push(e),this}implies(e,r){return Lr("<string|object> [number|string|array]",[e,r],arguments.length),he(this,fc,"f").implies(e,r),this}locale(e){return Lr("[string]",[e],arguments.length),e===void 0?(this[z1e](),he(this,zn,"f").y18n.getLocale()):(Qr(this,wR,!1,"f"),he(this,zn,"f").y18n.setLocale(e),this)}middleware(e,r,n){return he(this,Ih,"f").addMiddleware(e,!!r,n)}nargs(e,r){return Lr("<string|object|array> [number]",[e,r],arguments.length),this[o3](this.nargs.bind(this),"narg",e,r),this}normalize(e){return Lr("<array|string>",[e],arguments.length),this[FT]("normalize",e),this}number(e){return Lr("<array|string>",[e],arguments.length),this[FT]("number",e),this[NR](e),this}option(e,r){if(Lr("<string|object> [object]",[e,r],arguments.length),typeof e=="object")Object.keys(e).forEach(n=>{this.options(n,e[n])});else{typeof r!="object"&&(r={}),this[NR](e),he(this,HC,"f")&&(e==="version"||r?.alias==="version")&&this[KVe](['"version" is a reserved word.',"Please do one of the following:",'- Disable version with `yargs.version(false)` if using "version" as an option',"- Use the built-in `yargs.version` method instead (if applicable)","- Use a different option key","https://yargs.js.org/docs/#api-reference-version"].join(`
`),void 0,"versionWarning"),he(this,on,"f").key[e]=!0,r.alias&&this.alias(e,r.alias);let n=r.deprecate||r.deprecated;n&&this.deprecateOption(e,n);let i=r.demand||r.required||r.require;i&&this.demand(e,i),r.demandOption&&this.demandOption(e,typeof r.demandOption=="string"?r.demandOption:void 0),r.conflicts&&this.conflicts(e,r.conflicts),"default"in r&&this.default(e,r.default),r.implies!==void 0&&this.implies(e,r.implies),r.nargs!==void 0&&this.nargs(e,r.nargs),r.config&&this.config(e,r.configParser),r.normalize&&this.normalize(e),r.choices&&this.choices(e,r.choices),r.coerce&&this.coerce(e,r.coerce),r.group&&this.group(e,r.group),(r.boolean||r.type==="boolean")&&(this.boolean(e),r.alias&&this.boolean(r.alias)),(r.array||r.type==="array")&&(this.array(e),r.alias&&this.array(r.alias)),(r.number||r.type==="number")&&(this.number(e),r.alias&&this.number(r.alias)),(r.string||r.type==="string")&&(this.string(e),r.alias&&this.string(r.alias)),(r.count||r.type==="count")&&this.count(e),typeof r.global=="boolean"&&this.global(e,r.global),r.defaultDescription&&(he(this,on,"f").defaultDescription[e]=r.defaultDescription),r.skipValidation&&this.skipValidation(e);let o=r.describe||r.description||r.desc,a=he(this,li,"f").getDescriptions();(!Object.prototype.hasOwnProperty.call(a,e)||typeof o=="string")&&this.describe(e,o),r.hidden&&this.hide(e),r.requiresArg&&this.requiresArg(e)}return this}options(e,r){return this.option(e,r)}parse(e,r,n){Lr("[string|array] [function|boolean|object] [function]",[e,r,n],arguments.length),this[YVe](),typeof e>"u"&&(e=he(this,LT,"f")),typeof r=="object"&&(Qr(this,SR,r,"f"),r=n),typeof r=="function"&&(Qr(this,G0,r,"f"),r=!1),r||Qr(this,LT,e,"f"),he(this,G0,"f")&&Qr(this,bh,!1,"f");let i=this[r7](e,!!r),o=this.parsed;return he(this,Eh,"f").setParsed(this.parsed),aa(i)?i.then(a=>(he(this,G0,"f")&&he(this,G0,"f").call(this,he(this,MT,"f"),a,he(this,cu,"f")),a)).catch(a=>{throw he(this,G0,"f")&&he(this,G0,"f")(a,this.parsed.argv,he(this,cu,"f")),a}).finally(()=>{this[eve](),this.parsed=o}):(he(this,G0,"f")&&he(this,G0,"f").call(this,he(this,MT,"f"),i,he(this,cu,"f")),this[eve](),this.parsed=o,i)}parseAsync(e,r,n){let i=this.parse(e,r,n);return aa(i)?i:Promise.resolve(i)}parseSync(e,r,n){let i=this.parse(e,r,n);if(aa(i))throw new sa(".parseSync() must not be used with asynchronous builders, handlers, or middleware");return i}parserConfiguration(e){return Lr("<object>",[e],arguments.length),Qr(this,nX,e,"f"),this}pkgConf(e,r){Lr("<string> [string]",[e,r],arguments.length);let n=null,i=this[K1e](r||he(this,TR,"f"));return i[e]&&typeof i[e]=="object"&&(n=JJ(i[e],r||he(this,TR,"f"),this[DR]()["deep-merge-config"]||!1,he(this,zn,"f")),he(this,on,"f").configObjects=(he(this,on,"f").configObjects||[]).concat(n)),this}positional(e,r){Lr("<string> <object>",[e,r],arguments.length);let n=["default","defaultDescription","implies","normalize","choices","conflicts","coerce","type","describe","desc","description","alias"];r=BT(r,(a,c)=>a==="type"&&!["string","number","boolean"].includes(c)?!1:n.includes(a));let i=he(this,t7,"f").fullCommands[he(this,t7,"f").fullCommands.length-1],o=i?he(this,Oc,"f").cmdToParseOptions(i):{array:[],alias:{},default:{},demand:{}};return t3(o).forEach(a=>{let c=o[a];Array.isArray(c)?c.indexOf(e)!==-1&&(r[a]=!0):c[e]&&!(a in r)&&(r[a]=c[e])}),this.group(e,he(this,li,"f").getPositionalGroupName()),this.option(e,r)}recommendCommands(e=!0){return Lr("[boolean]",[e],arguments.length),Qr(this,iX,e,"f"),this}required(e,r,n){return this.demand(e,r,n)}require(e,r,n){return this.demand(e,r,n)}requiresArg(e){return Lr("<array|string|object> [number]",[e],arguments.length),typeof e=="string"&&he(this,on,"f").narg[e]?this:(this[o3](this.requiresArg.bind(this),"narg",e,NaN),this)}showCompletionScript(e,r){return Lr("[string] [string]",[e,r],arguments.length),e=e||this.$0,he(this,n3,"f").log(he(this,Eh,"f").generateCompletionScript(e,r||he(this,W0,"f")||"completion")),this}showHelp(e){if(Lr("[string|function]",[e],arguments.length),Qr(this,j0,!0,"f"),!he(this,li,"f").hasCachedHelpMessage()){if(!this.parsed){let n=this[r7](he(this,LT,"f"),void 0,void 0,0,!0);if(aa(n))return n.then(()=>{he(this,li,"f").showHelp(e)}),this}let r=he(this,Oc,"f").runDefaultBuilderOn(this);if(aa(r))return r.then(()=>{he(this,li,"f").showHelp(e)}),this}return he(this,li,"f").showHelp(e),this}scriptName(e){return this.customScriptName=!0,this.$0=e,this}showHelpOnFail(e,r){return Lr("[boolean|string] [string]",[e,r],arguments.length),he(this,li,"f").showHelpOnFail(e,r),this}showVersion(e){return Lr("[string|function]",[e],arguments.length),he(this,li,"f").showVersion(e),this}skipValidation(e){return Lr("<array|string>",[e],arguments.length),this[FT]("skipValidation",e),this}strict(e){return Lr("[boolean]",[e],arguments.length),Qr(this,RR,e!==!1,"f"),this}strictCommands(e){return Lr("[boolean]",[e],arguments.length),Qr(this,kR,e!==!1,"f"),this}strictOptions(e){return Lr("[boolean]",[e],arguments.length),Qr(this,PR,e!==!1,"f"),this}string(e){return Lr("<array|string>",[e],arguments.length),this[FT]("string",e),this[NR](e),this}terminalWidth(){return Lr([],0),he(this,zn,"f").process.stdColumns}updateLocale(e){return this.updateStrings(e)}updateStrings(e){return Lr("<object>",[e],arguments.length),Qr(this,wR,!1,"f"),he(this,zn,"f").y18n.updateLocale(e),this}usage(e,r,n,i){if(Lr("<string|null|undefined> [string|boolean] [function|object] [function]",[e,r,n,i],arguments.length),r!==void 0){if(_f(e,null,he(this,zn,"f")),(e||"").match(/^\$0( |$)/))return this.command(e,r,n,i);throw new sa(".usage() description must start with $0 if being used as alias for .command()")}else return he(this,li,"f").usage(e),this}usageConfiguration(e){return Lr("<object>",[e],arguments.length),Qr(this,oX,e,"f"),this}version(e,r,n){let i="version";if(Lr("[boolean|string] [string] [string]",[e,r,n],arguments.length),he(this,HC,"f")&&(this[V1e](he(this,HC,"f")),he(this,li,"f").version(void 0),Qr(this,HC,null,"f")),arguments.length===0)n=this[ZVe](),e=i;else if(arguments.length===1){if(e===!1)return this;n=e,e=i}else arguments.length===2&&(n=r,r=void 0);return Qr(this,HC,typeof e=="string"?e:i,"f"),r=r||he(this,li,"f").deferY18nLookup("Show version number"),he(this,li,"f").version(n||void 0),this.boolean(he(this,HC,"f")),this.describe(he(this,HC,"f"),r),this}wrap(e){return Lr("<number|null|undefined>",[e],arguments.length),he(this,li,"f").wrap(e),this}[(Oc=new WeakMap,TR=new WeakMap,t7=new WeakMap,Eh=new WeakMap,W0=new WeakMap,XJ=new WeakMap,MT=new WeakMap,wR=new WeakMap,ZJ=new WeakMap,bh=new WeakMap,eX=new WeakMap,Ih=new WeakMap,qC=new WeakMap,j0=new WeakMap,Th=new WeakMap,tX=new WeakMap,n3=new WeakMap,cu=new WeakMap,on=new WeakMap,rX=new WeakMap,nX=new WeakMap,G0=new WeakMap,SR=new WeakMap,i3=new WeakMap,_R=new WeakMap,LT=new WeakMap,iX=new WeakMap,zn=new WeakMap,RR=new WeakMap,kR=new WeakMap,PR=new WeakMap,li=new WeakMap,oX=new WeakMap,HC=new WeakMap,fc=new WeakMap,VVe)](e){if(!e._||!e["--"])return e;e._.push.apply(e._,e["--"]);try{delete e["--"]}catch{}return e}[zVe](){return{log:s((...e)=>{this[sX]()||console.log(...e),Qr(this,j0,!0,"f"),he(this,cu,"f").length&&Qr(this,cu,he(this,cu,"f")+`
`,"f"),Qr(this,cu,he(this,cu,"f")+e.join(" "),"f")},"log"),error:s((...e)=>{this[sX]()||console.error(...e),Qr(this,j0,!0,"f"),he(this,cu,"f").length&&Qr(this,cu,he(this,cu,"f")+`
`,"f"),Qr(this,cu,he(this,cu,"f")+e.join(" "),"f")},"error")}}[V1e](e){t3(he(this,on,"f")).forEach(r=>{if((i=>i==="configObjects")(r))return;let n=he(this,on,"f")[r];Array.isArray(n)?n.includes(e)&&n.splice(n.indexOf(e),1):typeof n=="object"&&delete n[e]}),delete he(this,li,"f").getDescriptions()[e]}[KVe](e,r,n){he(this,ZJ,"f")[n]||(he(this,zn,"f").process.emitWarning(e,r),he(this,ZJ,"f")[n]=!0)}[YVe](){he(this,eX,"f").push({options:he(this,on,"f"),configObjects:he(this,on,"f").configObjects.slice(0),exitProcess:he(this,bh,"f"),groups:he(this,qC,"f"),strict:he(this,RR,"f"),strictCommands:he(this,kR,"f"),strictOptions:he(this,PR,"f"),completionCommand:he(this,W0,"f"),output:he(this,cu,"f"),exitError:he(this,MT,"f"),hasOutput:he(this,j0,"f"),parsed:this.parsed,parseFn:he(this,G0,"f"),parseContext:he(this,SR,"f")}),he(this,li,"f").freeze(),he(this,fc,"f").freeze(),he(this,Oc,"f").freeze(),he(this,Ih,"f").freeze()}[JVe](){let e="",r;return/\b(node|iojs|electron)(\.exe)?$/.test(he(this,zn,"f").process.argv()[0])?r=he(this,zn,"f").process.argv().slice(1,2):r=he(this,zn,"f").process.argv().slice(0,1),e=r.map(n=>{let i=this[uze](he(this,TR,"f"),n);return n.match(/^(\/|([a-zA-Z]:)?\\)/)&&i.length<n.length?i:n}).join(" ").trim(),he(this,zn,"f").getEnv("_")&&he(this,zn,"f").getProcessArgvBin()===he(this,zn,"f").getEnv("_")&&(e=he(this,zn,"f").getEnv("_").replace(`${he(this,zn,"f").path.dirname(he(this,zn,"f").process.execPath())}/`,"")),e}[DR](){return he(this,nX,"f")}[XVe](){return he(this,oX,"f")}[z1e](){if(!he(this,wR,"f"))return;let e=he(this,zn,"f").getEnv("LC_ALL")||he(this,zn,"f").getEnv("LC_MESSAGES")||he(this,zn,"f").getEnv("LANG")||he(this,zn,"f").getEnv("LANGUAGE")||"en_US";this.locale(e.replace(/[.:].*/,""))}[ZVe](){return this[K1e]().version||"unknown"}[eze](e){let r=e["--"]?e["--"]:e._;for(let n=0,i;(i=r[n])!==void 0;n++)he(this,zn,"f").Parser.looksLikeNumber(i)&&Number.isSafeInteger(Math.floor(parseFloat(`${i}`)))&&(r[n]=Number(i));return e}[K1e](e){let r=e||"*";if(he(this,i3,"f")[r])return he(this,i3,"f")[r];let n={};try{let i=e||he(this,zn,"f").mainFilename;!e&&he(this,zn,"f").path.extname(i)&&(i=he(this,zn,"f").path.dirname(i));let o=he(this,zn,"f").findUp(i,(a,c)=>{if(c.includes("package.json"))return"package.json"});_f(o,void 0,he(this,zn,"f")),n=JSON.parse(he(this,zn,"f").readFileSync(o,"utf8"))}catch{}return he(this,i3,"f")[r]=n||{},he(this,i3,"f")[r]}[FT](e,r){r=[].concat(r),r.forEach(n=>{n=this[X1e](n),he(this,on,"f")[e].push(n)})}[o3](e,r,n,i){this[J1e](e,r,n,i,(o,a,c)=>{he(this,on,"f")[o][a]=c})}[Y1e](e,r,n,i){this[J1e](e,r,n,i,(o,a,c)=>{he(this,on,"f")[o][a]=(he(this,on,"f")[o][a]||[]).concat(c)})}[J1e](e,r,n,i,o){if(Array.isArray(n))n.forEach(a=>{e(a,i)});else if((a=>typeof a=="object")(n))for(let a of t3(n))e(a,n[a]);else o(r,this[X1e](n),i)}[X1e](e){return e==="__proto__"?"___proto___":e}[Z1e](e,r){return this[o3](this[Z1e].bind(this),"key",e,r),this}[eve](){var e,r,n,i,o,a,c,l,u,f,p,m;let h=he(this,eX,"f").pop();_f(h,void 0,he(this,zn,"f"));let g;e=this,r=this,n=this,i=this,o=this,a=this,c=this,l=this,u=this,f=this,p=this,m=this,{options:{set value(A){Qr(e,on,A,"f")}}.value,configObjects:g,exitProcess:{set value(A){Qr(r,bh,A,"f")}}.value,groups:{set value(A){Qr(n,qC,A,"f")}}.value,output:{set value(A){Qr(i,cu,A,"f")}}.value,exitError:{set value(A){Qr(o,MT,A,"f")}}.value,hasOutput:{set value(A){Qr(a,j0,A,"f")}}.value,parsed:this.parsed,strict:{set value(A){Qr(c,RR,A,"f")}}.value,strictCommands:{set value(A){Qr(l,kR,A,"f")}}.value,strictOptions:{set value(A){Qr(u,PR,A,"f")}}.value,completionCommand:{set value(A){Qr(f,W0,A,"f")}}.value,parseFn:{set value(A){Qr(p,G0,A,"f")}}.value,parseContext:{set value(A){Qr(m,SR,A,"f")}}.value}=h,he(this,on,"f").configObjects=g,he(this,li,"f").unfreeze(),he(this,fc,"f").unfreeze(),he(this,Oc,"f").unfreeze(),he(this,Ih,"f").unfreeze()}[tze](e,r){return IR(r,n=>(e(n),n))}getInternalMethods(){return{getCommandInstance:this[rze].bind(this),getContext:this[nze].bind(this),getHasOutput:this[ize].bind(this),getLoggerInstance:this[oze].bind(this),getParseContext:this[sze].bind(this),getParserConfiguration:this[DR].bind(this),getUsageConfiguration:this[XVe].bind(this),getUsageInstance:this[aze].bind(this),getValidationInstance:this[cze].bind(this),hasParseCallback:this[sX].bind(this),isGlobalContext:this[lze].bind(this),postProcess:this[BR].bind(this),reset:this[tve].bind(this),runValidation:this[rve].bind(this),runYargsParserAndExecuteCommands:this[r7].bind(this),setHasOutput:this[dze].bind(this)}}[rze](){return he(this,Oc,"f")}[nze](){return he(this,t7,"f")}[ize](){return he(this,j0,"f")}[oze](){return he(this,n3,"f")}[sze](){return he(this,SR,"f")||{}}[aze](){return he(this,li,"f")}[cze](){return he(this,fc,"f")}[sX](){return!!he(this,G0,"f")}[lze](){return he(this,tX,"f")}[BR](e,r,n,i){return n||aa(e)||(r||(e=this[VVe](e)),(this[DR]()["parse-positional-numbers"]||this[DR]()["parse-positional-numbers"]===void 0)&&(e=this[eze](e)),i&&(e=bR(e,this,he(this,Ih,"f").getMiddleware(),!1))),e}[tve](e={}){Qr(this,on,he(this,on,"f")||{},"f");let r={};r.local=he(this,on,"f").local||[],r.configObjects=he(this,on,"f").configObjects||[];let n={};r.local.forEach(a=>{n[a]=!0,(e[a]||[]).forEach(c=>{n[c]=!0})}),Object.assign(he(this,_R,"f"),Object.keys(he(this,qC,"f")).reduce((a,c)=>{let l=he(this,qC,"f")[c].filter(u=>!(u in n));return l.length>0&&(a[c]=l),a},{})),Qr(this,qC,{},"f");let i=["array","boolean","string","skipValidation","count","normalize","number","hiddenOptions"],o=["narg","key","alias","default","defaultDescription","config","choices","demandedOptions","demandedCommands","deprecatedOptions"];return i.forEach(a=>{r[a]=(he(this,on,"f")[a]||[]).filter(c=>!n[c])}),o.forEach(a=>{r[a]=BT(he(this,on,"f")[a],c=>!n[c])}),r.envPrefix=he(this,on,"f").envPrefix,Qr(this,on,r,"f"),Qr(this,li,he(this,li,"f")?he(this,li,"f").reset(n):QVe(this,he(this,zn,"f")),"f"),Qr(this,fc,he(this,fc,"f")?he(this,fc,"f").reset(n):jVe(this,he(this,li,"f"),he(this,zn,"f")),"f"),Qr(this,Oc,he(this,Oc,"f")?he(this,Oc,"f").reset():LVe(he(this,li,"f"),he(this,fc,"f"),he(this,Ih,"f"),he(this,zn,"f")),"f"),he(this,Eh,"f")||Qr(this,Eh,HVe(this,he(this,li,"f"),he(this,Oc,"f"),he(this,zn,"f")),"f"),he(this,Ih,"f").reset(),Qr(this,W0,null,"f"),Qr(this,cu,"","f"),Qr(this,MT,null,"f"),Qr(this,j0,!1,"f"),this.parsed=!1,this}[uze](e,r){return he(this,zn,"f").path.relative(e,r)}[r7](e,r,n,i=0,o=!1){let a=!!n||o;e=e||he(this,LT,"f"),he(this,on,"f").__=he(this,zn,"f").y18n.__,he(this,on,"f").configuration=this[DR]();let c=!!he(this,on,"f").configuration["populate--"],l=Object.assign({},he(this,on,"f").configuration,{"populate--":!0}),u=he(this,zn,"f").Parser.detailed(e,Object.assign({},he(this,on,"f"),{configuration:{"parse-positional-numbers":!1,...l}})),f=Object.assign(u.argv,he(this,SR,"f")),p,m=u.aliases,h=!1,g=!1;Object.keys(f).forEach(A=>{A===he(this,Th,"f")&&f[A]?h=!0:A===he(this,HC,"f")&&f[A]&&(g=!0)}),f.$0=this.$0,this.parsed=u,i===0&&he(this,li,"f").clearCachedHelpMessage();try{if(this[z1e](),r)return this[BR](f,c,!!n,!1);he(this,Th,"f")&&[he(this,Th,"f")].concat(m[he(this,Th,"f")]||[]).filter(S=>S.length>1).includes(""+f._[f._.length-1])&&(f._.pop(),h=!0),Qr(this,tX,!1,"f");let A=he(this,Oc,"f").getCommands(),y=he(this,Eh,"f").completionKey in f,E=h||y||o;if(f._.length){if(A.length){let b;for(let S=i||0,R;f._[S]!==void 0;S++)if(R=String(f._[S]),A.includes(R)&&R!==he(this,W0,"f")){let B=he(this,Oc,"f").runCommand(R,this,u,S+1,o,h||g||o);return this[BR](B,c,!!n,!1)}else if(!b&&R!==he(this,W0,"f")){b=R;break}!he(this,Oc,"f").hasDefaultCommand()&&he(this,iX,"f")&&b&&!E&&he(this,fc,"f").recommendCommands(b,A)}he(this,W0,"f")&&f._.includes(he(this,W0,"f"))&&!y&&(he(this,bh,"f")&&NT(!0),this.showCompletionScript(),this.exit(0))}if(he(this,Oc,"f").hasDefaultCommand()&&!E){let b=he(this,Oc,"f").runCommand(null,this,u,0,o,h||g||o);return this[BR](b,c,!!n,!1)}if(y){he(this,bh,"f")&&NT(!0),e=[].concat(e);let b=e.slice(e.indexOf(`--${he(this,Eh,"f").completionKey}`)+1);return he(this,Eh,"f").getCompletion(b,(S,R)=>{if(S)throw new sa(S.message);(R||[]).forEach(B=>{he(this,n3,"f").log(B)}),this.exit(0)}),this[BR](f,!c,!!n,!1)}if(he(this,j0,"f")||(h?(he(this,bh,"f")&&NT(!0),a=!0,this.showHelp("log"),this.exit(0)):g&&(he(this,bh,"f")&&NT(!0),a=!0,he(this,li,"f").showVersion("log"),this.exit(0))),!a&&he(this,on,"f").skipValidation.length>0&&(a=Object.keys(f).some(b=>he(this,on,"f").skipValidation.indexOf(b)>=0&&f[b]===!0)),!a){if(u.error)throw new sa(u.error.message);if(!y){let b=this[rve](m,{},u.error);n||(p=bR(f,this,he(this,Ih,"f").getMiddleware(),!0)),p=this[tze](b,p??f),aa(p)&&!n&&(p=p.then(()=>bR(f,this,he(this,Ih,"f").getMiddleware(),!1)))}}}catch(A){if(A instanceof sa)he(this,li,"f").fail(A.message,A);else throw A}return this[BR](p??f,c,!!n,!0)}[rve](e,r,n,i){let o={...this.getDemandedOptions()};return a=>{if(n)throw new sa(n.message);he(this,fc,"f").nonOptionCount(a),he(this,fc,"f").requiredArguments(a,o);let c=!1;he(this,kR,"f")&&(c=he(this,fc,"f").unknownCommands(a)),he(this,RR,"f")&&!c?he(this,fc,"f").unknownArguments(a,e,r,!!i):he(this,PR,"f")&&he(this,fc,"f").unknownArguments(a,e,{},!1,!1),he(this,fc,"f").limitedChoices(a),he(this,fc,"f").implications(a),he(this,fc,"f").conflicting(a)}}[dze](){Qr(this,j0,!0,"f")}[NR](e){if(typeof e=="string")he(this,on,"f").key[e]=!0;else for(let r of e)he(this,on,"f").key[r]=!0}};function FVe(t){return!!t&&typeof t.getInternalMethods=="function"}s(FVe,"isYargsInstance");var rjt=fze(PVe),pze=rjt;d();d();d();var mze={AuthNotifyShown:"auth.auth_notify_shown",AuthNotifyDismissed:"auth.auth_notify_dismissed",NewGitHubLogin:"auth.new_github_login",GitHubLoginSuccess:"auth.github_login_success"};function hze(t,e,r){let n=Vr.createAndMarkAsIssued({authSource:e,authType:r});return Bt(t,mze.NewGitHubLogin,n)}s(hze,"telemetryNewGitHubLogin");function gze(t,e){let r=Vr.createAndMarkAsIssued({authType:e});return Bt(t,mze.GitHubLoginSuccess,r)}s(gze,"telemetryGitHubLoginSuccess");var ive=class extends Sa{static{s(this,"DeviceFlowError")}constructor(e){super(e.error_description),this.code=e.error,this.uri=e.error_uri,this.name="DeviceFlowError"}};async function njt(t,e,{serverUrl:r}){let n={method:"POST",headers:{Accept:"application/json",...p0(t)},json:{client_id:e},timeout:3e4},i,o=new URL("login/device/code",r).href;try{i=await t.get(Or).fetch(o,n)}catch(a){throw a instanceof Error&&OF(a)?new Sa(`Could not log in with device flow on ${r}: ${a.message}`):a}if(!i.ok)throw new Sa(`Could not log in with device flow on ${r}: HTTP ${i.status}`);return await i.json()}s(njt,"requestDeviceFlowStage1");async function ijt(t,e,r,{serverUrl:n}){let i={method:"POST",headers:{Accept:"application/json",...p0(t)},json:{client_id:r,device_code:e,grant_type:"urn:ietf:params:oauth:grant-type:device_code"},timeout:3e4},o=await t.get(Or).fetch(new URL("login/oauth/access_token",n).href,i),a=await o.json();if(a.access_token||a.error==="authorization_pending"||a.error==="slow_down")return a;throw a.error&&a.error_description?new ive(a):new Sa(`Unexpected ${o.status} response from device flow: ${JSON.stringify(a)}`)}s(ijt,"requestDeviceFlowStage2");async function ojt(t,e){gze(t,"deviceFlow");let n=await(await Qm(t,e,"user",{headers:{Accept:"application/json"}})).json();if("errors"in n)throw new Sa(`Error retrieving user information: ${String(n.errors)}`);return n}s(ojt,"requestUserInfo");var Rf=class{constructor(e){this.ctx=e;this.pendingSignIn=void 0}static{s(this,"GitHubDeviceFlow")}get authManager(){return this.ctx.get(Bi)}get authPersistence(){return this.ctx.get(fA)}async save(e){let r=new URL(e.serverUrl).hostname;await this.authPersistence.saveAuthRecord({oauth_token:e.accessToken,user:e.login,githubAppId:e.githubAppId,authAuthority:r}),this.authPersistence.purgeLegacyAuthRecords().catch(()=>{});let n=!this.authManager.hasTransientSession();return await this.authManager.checkAndUpdateStatus({forceRefresh:n,freshSignIn:n})}async initiate(e,r){let n=e?.githubAppId??this.ctx.get(iu).findAppIdToAuthenticate();r??=this.authManager.getConfiguredUrls();try{let i=await this.getTokenUnguarded(n,r),o=i.waitForAuth.then(async a=>(this.ctx.get(iu).githubAppId=n,await this.save(a)));return o.catch(()=>{}),this.pendingSignIn={verificationUri:i.verification_uri,status:o},i}catch(i){throw this.ctx.get(fp).notifyUser(this.ctx,i),i}}async abandon(){let{serverUrl:e}=this.authManager.getConfiguredUrls(),r=new URL(e).hostname;await this.authPersistence.deleteAuthRecord({authAuthority:r}),this.authPersistence.purgeLegacyAuthRecords().catch(()=>{});let n=!this.authManager.hasTransientSession();return await this.authManager.checkAndUpdateStatus({forceRefresh:n})}async getTokenUnguarded(e,r){let n=this.ctx;hze(n,"unknown","deviceFlow");let i=await njt(n,e,r),o=(async()=>{let a=i.expires_in,c=i.interval,l;do{await new Promise(f=>setTimeout(f,1e3*c)),l=await ijt(n,i.device_code,e,r),a-=c;let u=l.access_token;if(u){let f=await ojt(n,{...r,accessToken:u});return{...r,githubAppId:e,login:f.login,accessToken:u}}c=l.interval??c}while(a>0);throw new Sa(`Timed out polling for access token. Last response was ${JSON.stringify(l)}`)})();return{...i,waitForAuth:o}}};d();var kf=class{static{s(this,"CitationManager")}},aX=class extends kf{static{s(this,"NoOpCitationManager")}async handleIPCodeCitation(e,r){}};d();d();d();var sjt={didChangeFeatureFlags:!1,fetch:!1,ipCodeCitation:!1,redirectedTelemetry:!1,related:!1,token:!1,watchedFiles:!1,showPanelMessage:!1},xs=class{constructor(){this.capabilities={...sjt};this.emitter=new ys;this.onDidSetCapabilities=this.emitter.event}static{s(this,"CopilotCapabilitiesProvider")}setCapabilities(e){let r;for(r in e){let n=e[r];n!==void 0&&(this.capabilities[r]=n)}this.emitter.fire(this.capabilities)}getCapabilities(){return this.capabilities}};d();d();d();d();function ove(t,e){let r=RA(t,e);return r===-1?void 0:t[r]}s(ove,"findLastMonotonous");function RA(t,e,r=0,n=t.length){let i=r,o=n;for(;i<o;){let a=Math.floor((i+o)/2);e(t[a])?i=a+1:o=a}return i-1}s(RA,"findLastIdxMonotonous");function s3(t,e,r=0,n=t.length){let i=r,o=n;for(;i<o;){let a=Math.floor((i+o)/2);e(t[a])?o=a:i=a+1}return i}s(s3,"findFirstIdxMonotonousOrArrLen");var Aze=class t{constructor(e){this._array=e;this._findLastMonotonousLastIdx=0}static{s(this,"MonotonousArray")}static{this.assertInvariants=!1}findLastMonotonous(e){if(t.assertInvariants){if(this._prevFindLastPredicate){for(let n of this._array)if(this._prevFindLastPredicate(n)&&!e(n))throw new Error("MonotonousArray: current predicate must be weaker than (or equal to) the previous predicate.")}this._prevFindLastPredicate=e}let r=RA(this._array,e,this._findLastMonotonousLastIdx);return this._findLastMonotonousLastIdx=r+1,r===-1?void 0:this._array[r]}};d();var sve=class{static{s(this,"ErrorHandler")}constructor(){this.listeners=[],this.unexpectedErrorHandler=function(e){setTimeout(()=>{throw e.stack?cX.isErrorNoTelemetry(e)?new cX(e.message+`

`+e.stack):new Error(e.message+`

`+e.stack):e},0)}}addListener(e){return this.listeners.push(e),()=>{this._removeListener(e)}}emit(e){this.listeners.forEach(r=>{r(e)})}_removeListener(e){this.listeners.splice(this.listeners.indexOf(e),1)}setUnexpectedErrorHandler(e){this.unexpectedErrorHandler=e}getUnexpectedErrorHandler(){return this.unexpectedErrorHandler}onUnexpectedError(e){this.unexpectedErrorHandler(e),this.emit(e)}onUnexpectedExternalError(e){this.unexpectedErrorHandler(e)}},yze=new sve;function MR(t){yze.onUnexpectedError(t)}s(MR,"onBugIndicatingError");function a3(t){ajt(t)||yze.onUnexpectedError(t)}s(a3,"onUnexpectedError");var ave="Canceled";function ajt(t){return t instanceof V0?!0:t instanceof Error&&t.name===ave&&t.message===ave}s(ajt,"isCancellationError");var V0=class extends Error{static{s(this,"CancellationError")}constructor(){super(ave),this.name=this.message}};function n7(t){return t?new Error(`Illegal argument: ${t}`):new Error("Illegal argument")}s(n7,"illegalArgument");function Cze(t){return t?new Error(`Illegal state: ${t}`):new Error("Illegal state")}s(Cze,"illegalState");var cX=class t extends Error{static{s(this,"ErrorNoTelemetry")}constructor(e){super(e),this.name="CodeExpectedError"}static fromError(e){if(e instanceof t)return e;let r=new t;return r.message=e.message,r.stack=e.stack,r}static isErrorNoTelemetry(e){return e.name==="CodeExpectedError"}},xn=class t extends Error{static{s(this,"BugIndicatingError")}constructor(e){super(e||"An unexpected bug occurred."),Object.setPrototypeOf(this,t.prototype)}};function c3(t,e,r=(n,i)=>n===i){if(t===e)return!0;if(!t||!e||t.length!==e.length)return!1;for(let n=0,i=t.length;n<i;n++)if(!r(t[n],e[n]))return!1;return!0}s(c3,"equals");function*LR(t,e){let r,n;for(let i of t)n!==void 0&&e(n,i)?r.push(i):(r&&(yield r),r=[i]),n=i;r&&(yield r)}s(LR,"groupAdjacentBy");function xze(t){return t.filter(e=>!!e)}s(xze,"coalesce");var Eze;(c=>{function t(l){return l<0}c.isLessThan=t,s(t,"isLessThan");function e(l){return l<=0}c.isLessThanOrEqual=e,s(e,"isLessThanOrEqual");function r(l){return l>0}c.isGreaterThan=r,s(r,"isGreaterThan");function n(l){return l===0}c.isNeitherLessOrGreaterThan=n,s(n,"isNeitherLessOrGreaterThan"),c.greaterThan=1,c.lessThan=-1,c.neitherLessOrGreaterThan=0})(Eze||={});function wh(t,e){return(r,n)=>e(t(r),t(n))}s(wh,"compareBy");var Sh=s((t,e)=>t-e,"numberComparator");var lX=class{constructor(e){this.items=e;this.firstIdx=0;this.lastIdx=this.items.length-1}static{s(this,"ArrayQueue")}get length(){return this.lastIdx-this.firstIdx+1}takeWhile(e){let r=this.firstIdx;for(;r<this.items.length&&e(this.items[r]);)r++;let n=r===this.firstIdx?null:this.items.slice(this.firstIdx,r);return this.firstIdx=r,n}takeFromEndWhile(e){let r=this.lastIdx;for(;r>=0&&e(this.items[r]);)r--;let n=r===this.lastIdx?null:this.items.slice(r+1,this.lastIdx+1);return this.lastIdx=r,n}peek(){if(this.length!==0)return this.items[this.firstIdx]}peekLast(){if(this.length!==0)return this.items[this.lastIdx]}dequeue(){let e=this.items[this.firstIdx];return this.firstIdx++,e}removeLast(){let e=this.items[this.lastIdx];return this.lastIdx--,e}takeCount(e){let r=this.items.slice(this.firstIdx,this.firstIdx+e);return this.firstIdx+=e,r}},vze=class t{constructor(e){this.iterate=e}static{s(this,"CallbackIterable")}static{this.empty=new t(e=>{})}forEach(e){this.iterate(r=>(e(r),!0))}toArray(){let e=[];return this.iterate(r=>(e.push(r),!0)),e}filter(e){return new t(r=>this.iterate(n=>e(n)?r(n):!0))}map(e){return new t(r=>this.iterate(n=>r(e(n))))}some(e){let r=!1;return this.iterate(n=>(r=e(n),!r)),r}findFirst(e){let r;return this.iterate(n=>e(n)?(r=n,!1):!0),r}findLast(e){let r;return this.iterate(n=>(e(n)&&(r=n),!0)),r}findLastMaxBy(e){let r,n=!0;return this.iterate(i=>((n||Eze.isGreaterThan(e(i,r)))&&(n=!1,r=i),!0)),r}};function i7(t,e){return t.reduce((r,n)=>r+e(n),0)}s(i7,"sumBy");d();function wze(t,e){let r=Object.create(null);for(let n of t){let i=e(n),o=r[i];o||(o=r[i]=[]),o.push(n)}return r}s(wze,"groupBy");var Ize,Tze,bze=class{constructor(e,r){this.toKey=r;this._map=new Map;this[Ize]="SetWithKey";for(let n of e)this.add(n)}static{s(this,"SetWithKey")}get size(){return this._map.size}add(e){let r=this.toKey(e);return this._map.set(r,e),this}delete(e){return this._map.delete(this.toKey(e))}has(e){return this._map.has(this.toKey(e))}*entries(){for(let e of this._map.values())yield[e,e]}keys(){return this.values()}*values(){for(let e of this._map.values())yield e}clear(){this._map.clear()}forEach(e,r){this._map.forEach(n=>e.call(r,n,n,this))}[(Tze=Symbol.iterator,Ize=Symbol.toStringTag,Tze)](){return this.values()}};d();function cve(t,e){let r=this,n=!1,i;return function(){if(n)return i;if(n=!0,e)try{i=t.apply(r,arguments)}finally{e()}else i=t.apply(r,arguments);return i}}s(cve,"createSingleCallFunction");d();var lve;(S=>{function t(R){return R&&typeof R=="object"&&typeof R[Symbol.iterator]=="function"}S.is=t,s(t,"is");let e=Object.freeze([]);function r(){return e}S.empty=r,s(r,"empty");function*n(R){yield R}S.single=n,s(n,"single");function i(R){return t(R)?R:n(R)}S.wrap=i,s(i,"wrap");function o(R){return R||e}S.from=o,s(o,"from");function*a(R){for(let B=R.length-1;B>=0;B--)yield R[B]}S.reverse=a,s(a,"reverse");function c(R){return!R||R[Symbol.iterator]().next().done===!0}S.isEmpty=c,s(c,"isEmpty");function l(R){return R[Symbol.iterator]().next().value}S.first=l,s(l,"first");function u(R,B){let L=0;for(let O of R)if(B(O,L++))return!0;return!1}S.some=u,s(u,"some");function f(R,B){for(let L of R)if(B(L))return L}S.find=f,s(f,"find");function*p(R,B){for(let L of R)B(L)&&(yield L)}S.filter=p,s(p,"filter");function*m(R,B){let L=0;for(let O of R)yield B(O,L++)}S.map=m,s(m,"map");function*h(R,B){let L=0;for(let O of R)yield*B(O,L++)}S.flatMap=h,s(h,"flatMap");function*g(...R){for(let B of R)yield*B}S.concat=g,s(g,"concat");function A(R,B,L){let O=L;for(let Y of R)O=B(O,Y);return O}S.reduce=A,s(A,"reduce");function*y(R,B,L=R.length){for(B<-R.length&&(B=0),B<0&&(B+=R.length),L<0?L+=R.length:L>R.length&&(L=R.length);B<L;B++)yield R[B]}S.slice=y,s(y,"slice");function E(R,B=Number.POSITIVE_INFINITY){let L=[];if(B===0)return[L,R];let O=R[Symbol.iterator]();for(let Y=0;Y<B;Y++){let V=O.next();if(V.done)return[L,S.empty()];L.push(V.value)}return[L,{[Symbol.iterator](){return O}}]}S.consume=E,s(E,"consume");async function b(R){let B=[];for await(let L of R)B.push(L);return Promise.resolve(B)}S.asyncToArray=b,s(b,"asyncToArray")})(lve||={});d();var uve=class{constructor(e,r){this.uri=e;this.value=r}static{s(this,"ResourceMapEntry")}};function ljt(t){return Array.isArray(t)}s(ljt,"isEntries");var _ze,uX=class t{constructor(e,r){this[_ze]="ResourceMap";if(e instanceof t)this.map=new Map(e.map),this.toKey=r??t.defaultToKey;else if(ljt(e)){this.map=new Map,this.toKey=r??t.defaultToKey;for(let[n,i]of e)this.set(n,i)}else this.map=new Map,this.toKey=e??t.defaultToKey}static{s(this,"ResourceMap")}static{this.defaultToKey=s(e=>e.toString(),"defaultToKey")}set(e,r){return this.map.set(this.toKey(e),new uve(e,r)),this}get(e){return this.map.get(this.toKey(e))?.value}has(e){return this.map.has(this.toKey(e))}get size(){return this.map.size}clear(){this.map.clear()}delete(e){return this.map.delete(this.toKey(e))}forEach(e,r){typeof r<"u"&&(e=e.bind(r));for(let[n,i]of this.map)e(i.value,i.uri,this)}*values(){for(let e of this.map.values())yield e.value}*keys(){for(let e of this.map.values())yield e.uri}*entries(){for(let e of this.map.values())yield[e.uri,e.value]}*[(_ze=Symbol.toStringTag,Symbol.iterator)](){for(let[,e]of this.map)yield[e.uri,e.value]}},Rze,Sze=class{constructor(e,r){this[Rze]="ResourceSet";!e||typeof e=="function"?this._map=new uX(e):(this._map=new uX(r),e.forEach(this.add,this))}static{s(this,"ResourceSet")}get size(){return this._map.size}add(e){return this._map.set(e,e),this}clear(){this._map.clear()}delete(e){return this._map.delete(e)}forEach(e,r){this._map.forEach((n,i)=>e.call(r,i,i,this))}has(e){return this._map.has(e)}entries(){return this._map.entries()}keys(){return this._map.keys()}values(){return this._map.keys()}[(Rze=Symbol.toStringTag,Symbol.iterator)](){return this.keys()}};var kze,dve=class{constructor(){this[kze]="LinkedMap";this._map=new Map,this._head=void 0,this._tail=void 0,this._size=0,this._state=0}static{s(this,"LinkedMap")}clear(){this._map.clear(),this._head=void 0,this._tail=void 0,this._size=0,this._state++}isEmpty(){return!this._head&&!this._tail}get size(){return this._size}get first(){return this._head?.value}get last(){return this._tail?.value}has(e){return this._map.has(e)}get(e,r=0){let n=this._map.get(e);if(n)return r!==0&&this.touch(n,r),n.value}set(e,r,n=0){let i=this._map.get(e);if(i)i.value=r,n!==0&&this.touch(i,n);else{switch(i={key:e,value:r,next:void 0,previous:void 0},n){case 0:this.addItemLast(i);break;case 1:this.addItemFirst(i);break;case 2:this.addItemLast(i);break;default:this.addItemLast(i);break}this._map.set(e,i),this._size++}return this}delete(e){return!!this.remove(e)}remove(e){let r=this._map.get(e);if(r)return this._map.delete(e),this.removeItem(r),this._size--,r.value}shift(){if(!this._head&&!this._tail)return;if(!this._head||!this._tail)throw new Error("Invalid list");let e=this._head;return this._map.delete(e.key),this.removeItem(e),this._size--,e.value}forEach(e,r){let n=this._state,i=this._head;for(;i;){if(r?e.bind(r)(i.value,i.key,this):e(i.value,i.key,this),this._state!==n)throw new Error("LinkedMap got modified during iteration.");i=i.next}}keys(){let e=this,r=this._state,n=this._head,i={[Symbol.iterator](){return i},next(){if(e._state!==r)throw new Error("LinkedMap got modified during iteration.");if(n){let o={value:n.key,done:!1};return n=n.next,o}else return{value:void 0,done:!0}}};return i}values(){let e=this,r=this._state,n=this._head,i={[Symbol.iterator](){return i},next(){if(e._state!==r)throw new Error("LinkedMap got modified during iteration.");if(n){let o={value:n.value,done:!1};return n=n.next,o}else return{value:void 0,done:!0}}};return i}entries(){let e=this,r=this._state,n=this._head,i={[Symbol.iterator](){return i},next(){if(e._state!==r)throw new Error("LinkedMap got modified during iteration.");if(n){let o={value:[n.key,n.value],done:!1};return n=n.next,o}else return{value:void 0,done:!0}}};return i}[(kze=Symbol.toStringTag,Symbol.iterator)](){return this.entries()}trimOld(e){if(e>=this.size)return;if(e===0){this.clear();return}let r=this._head,n=this.size;for(;r&&n>e;)this._map.delete(r.key),r=r.next,n--;this._head=r,this._size=n,r&&(r.previous=void 0),this._state++}trimNew(e){if(e>=this.size)return;if(e===0){this.clear();return}let r=this._tail,n=this.size;for(;r&&n>e;)this._map.delete(r.key),r=r.previous,n--;this._tail=r,this._size=n,r&&(r.next=void 0),this._state++}addItemFirst(e){if(!this._head&&!this._tail)this._tail=e;else if(this._head)e.next=this._head,this._head.previous=e;else throw new Error("Invalid list");this._head=e,this._state++}addItemLast(e){if(!this._head&&!this._tail)this._head=e;else if(this._tail)e.previous=this._tail,this._tail.next=e;else throw new Error("Invalid list");this._tail=e,this._state++}removeItem(e){if(e===this._head&&e===this._tail)this._head=void 0,this._tail=void 0;else if(e===this._head){if(!e.next)throw new Error("Invalid list");e.next.previous=void 0,this._head=e.next}else if(e===this._tail){if(!e.previous)throw new Error("Invalid list");e.previous.next=void 0,this._tail=e.previous}else{let r=e.next,n=e.previous;if(!r||!n)throw new Error("Invalid list");r.previous=n,n.next=r}e.next=void 0,e.previous=void 0,this._state++}touch(e,r){if(!this._head||!this._tail)throw new Error("Invalid list");if(!(r!==1&&r!==2)){if(r===1){if(e===this._head)return;let n=e.next,i=e.previous;e===this._tail?(i.next=void 0,this._tail=i):(n.previous=i,i.next=n),e.previous=void 0,e.next=this._head,this._head.previous=e,this._head=e,this._state++}else if(r===2){if(e===this._tail)return;let n=e.next,i=e.previous;e===this._head?(n.previous=void 0,this._head=n):(n.previous=i,i.next=n),e.next=void 0,e.previous=this._tail,this._tail.next=e,this._tail=e,this._state++}}}toJSON(){let e=[];return this.forEach((r,n)=>{e.push([n,r])}),e}fromJSON(e){this.clear();for(let[r,n]of e)this.set(r,n)}},fve=class extends dve{static{s(this,"Cache")}constructor(e,r=1){super(),this._limit=e,this._ratio=Math.min(Math.max(0,r),1)}get limit(){return this._limit}set limit(e){this._limit=e,this.checkTrim()}get ratio(){return this._ratio}set ratio(e){this._ratio=Math.min(Math.max(0,e),1),this.checkTrim()}get(e,r=2){return super.get(e,r)}peek(e){return super.get(e,0)}set(e,r){return super.set(e,r,2),this}checkTrim(){this.size>this._limit&&this.trim(Math.round(this._limit*this._ratio))}},l3=class extends fve{static{s(this,"LRUCache")}constructor(e,r=1){super(e,r)}trim(e){this.trimOld(e)}set(e,r){return super.set(e,r),this.checkTrim(),this}};var dX=class{constructor(){this.map=new Map}static{s(this,"SetMap")}add(e,r){let n=this.map.get(e);n||(n=new Set,this.map.set(e,n)),n.add(r)}delete(e,r){let n=this.map.get(e);n&&(n.delete(r),n.size===0&&this.map.delete(e))}forEach(e,r){let n=this.map.get(e);n&&n.forEach(r)}get(e){let r=this.map.get(e);return r||new Set}};var ujt=!1,u3=null;var Pze=class t{constructor(){this.livingDisposables=new Map}static{s(this,"DisposableTracker")}static{this.idx=0}getDisposableData(e){let r=this.livingDisposables.get(e);return r||(r={parent:null,source:null,isSingleton:!1,value:e,idx:t.idx++},this.livingDisposables.set(e,r)),r}trackDisposable(e){let r=this.getDisposableData(e);r.source||(r.source=new Error().stack)}setParent(e,r){let n=this.getDisposableData(e);n.parent=r}markAsDisposed(e){this.livingDisposables.delete(e)}markAsSingleton(e){this.getDisposableData(e).isSingleton=!0}getRootParent(e,r){let n=r.get(e);if(n)return n;let i=e.parent?this.getRootParent(this.getDisposableData(e.parent),r):e;return r.set(e,i),i}getTrackedDisposables(){let e=new Map;return[...this.livingDisposables.entries()].filter(([,n])=>n.source!==null&&!this.getRootParent(n,e).isSingleton).flatMap(([n])=>n)}computeLeakingDisposables(e=10,r){let n;if(r)n=r;else{let l=new Map,u=[...this.livingDisposables.values()].filter(p=>p.source!==null&&!this.getRootParent(p,l).isSingleton);if(u.length===0)return;let f=new Set(u.map(p=>p.value));if(n=u.filter(p=>!(p.parent&&f.has(p.parent))),n.length===0)throw new Error("There are cyclic diposable chains!")}if(!n)return;function i(l){function u(p,m){for(;p.length>0&&m.some(h=>typeof h=="string"?h===p[0]:p[0].match(h));)p.shift()}s(u,"removePrefix");let f=l.source.split(`
`).map(p=>p.trim().replace("at ","")).filter(p=>p!=="");return u(f,["Error",/^trackDisposable \(.*\)$/,/^DisposableTracker.trackDisposable \(.*\)$/]),f.reverse()}s(i,"getStackTracePath");let o=new dX;for(let l of n){let u=i(l);for(let f=0;f<=u.length;f++)o.add(u.slice(0,f).join(`
`),l)}n.sort(wh(l=>l.idx,Sh));let a="",c=0;for(let l of n.slice(0,e)){c++;let u=i(l),f=[];for(let p=0;p<u.length;p++){let m=u[p];m=`(shared with ${o.get(u.slice(0,p+1).join(`
`)).size}/${n.length} leaks) at ${m}`;let g=o.get(u.slice(0,p).join(`
`)),A=wze([...g].map(y=>i(y)[p]),y=>y);delete A[u[p]];for(let[y,E]of Object.entries(A))f.unshift(`    - stacktraces of ${E.length} other leaks continue with ${y}`);f.unshift(m)}a+=`


==================== Leaking disposable ${c}/${n.length}: ${l.value.constructor.name} ====================
${f.join(`
`)}
============================================================

`}return n.length>e&&(a+=`


... and ${n.length-e} more leaking disposables

`),{leaks:n,details:a}}};function djt(t){u3=t}s(djt,"setDisposableTracker");if(ujt){let t="__is_disposable_tracked__";djt(new class{trackDisposable(e){let r=new Error("Potentially leaked disposable").stack;setTimeout(()=>{e[t]||console.log(r)},3e3)}setParent(e,r){if(e&&e!==Rs.None)try{e[t]=!0}catch{}}markAsDisposed(e){if(e&&e!==Rs.None)try{e[t]=!0}catch{}}markAsSingleton(e){}})}function d3(t){return u3?.trackDisposable(t),t}s(d3,"trackDisposable");function f3(t){u3?.markAsDisposed(t)}s(f3,"markAsDisposed");function pve(t,e){u3?.setParent(t,e)}s(pve,"setParentOfDisposable");function fjt(t,e){if(u3)for(let r of t)u3.setParent(r,e)}s(fjt,"setParentOfDisposables");function Dze(t){return typeof t=="object"&&t!==null&&typeof t.dispose=="function"&&t.dispose.length===0}s(Dze,"isDisposable");function fX(t){if(lve.is(t)){let e=[];for(let r of t)if(r)try{r.dispose()}catch(n){e.push(n)}if(e.length===1)throw e[0];if(e.length>1)throw new AggregateError(e,"Encountered errors while disposing of store");return Array.isArray(t)?[]:t}else if(t)return t.dispose(),t}s(fX,"dispose");function Bze(...t){let e=Qc(()=>fX(t));return fjt(t,e),e}s(Bze,"combinedDisposable");function Qc(t){let e=d3({dispose:cve(()=>{f3(e),t()})});return e}s(Qc,"toDisposable");var td=class t{constructor(){this._toDispose=new Set;this._isDisposed=!1;d3(this)}static{s(this,"DisposableStore")}static{this.DISABLE_DISPOSED_WARNING=!1}dispose(){this._isDisposed||(f3(this),this._isDisposed=!0,this.clear())}get isDisposed(){return this._isDisposed}clear(){if(this._toDispose.size!==0)try{fX(this._toDispose)}finally{this._toDispose.clear()}}add(e){if(!e)return e;if(e===this)throw new Error("Cannot register a disposable on itself!");return pve(e,this),this._isDisposed?t.DISABLE_DISPOSED_WARNING||console.warn(new Error("Trying to add a disposable to a DisposableStore that has already been disposed of. The added object will be leaked!").stack):this._toDispose.add(e),e}delete(e){if(e){if(e===this)throw new Error("Cannot dispose a disposable on itself!");this._toDispose.delete(e),e.dispose()}}deleteAndLeak(e){e&&this._toDispose.has(e)&&(this._toDispose.delete(e),pve(e,null))}},Rs=class{constructor(){this._store=new td;d3(this),pve(this._store,this)}static{s(this,"Disposable")}static{this.None=Object.freeze({dispose(){}})}dispose(){f3(this),this._store.dispose()}_register(e){if(e===this)throw new Error("Cannot register a disposable on itself!");return this._store.add(e)}};var _h=class extends Rs{static{s(this,"ChatQuotaService")}constructor(e){super(),this._register(_a(e,r=>{this.processUserInfoQuotaSnapshot(r.userInfo?.raw)}))}get quotaExhausted(){return this._quotaInfo?this._quotaInfo.used>=this._quotaInfo.quota&&!this._quotaInfo.overageEnabled:!1}get overagesEnabled(){return this._quotaInfo?this._quotaInfo.overageEnabled:!1}clearQuota(){this._quotaInfo=void 0}processQuotaHeaders(e){let r=e.get("x-quota-snapshot-premium_models")||e.get("x-quota-snapshot-premium_interactions");if(r)try{let n=new URLSearchParams(r),i=parseInt(n.get("ent")||"0",10),o=parseFloat(n.get("ov")||"0.0"),a=n.get("ovPerm")==="true",c=parseFloat(n.get("rem")||"0.0"),l=n.get("rst"),u;l?u=new Date(l):(u=new Date,u.setMonth(u.getMonth()+1));let f=Math.max(0,i*(1-c/100));this._quotaInfo={quota:i,used:f,overageUsed:o,overageEnabled:a,resetDate:u}}catch(n){console.error("Failed to parse quota header",n)}}processUserInfoQuotaSnapshot(e){!e||!e.quota_snapshots||!e.quota_reset_date||(this._quotaInfo={overageEnabled:e.quota_snapshots.premium_interactions.overage_permitted,overageUsed:e.quota_snapshots.premium_interactions.overage_count,quota:e.quota_snapshots.premium_interactions.entitlement,resetDate:new Date(e.quota_reset_date),used:Math.max(0,e.quota_snapshots.premium_interactions.entitlement*(1-e.quota_snapshots.premium_interactions.percent_remaining/100))})}};d();d();d();var Nze=Be(hi()),Mze=x.Object({accessToken:x.Optional(x.String({minLength:1})),handle:x.Optional(x.String({minLength:1})),login:x.Optional(x.String({minLength:1})),githubAppId:x.Optional(x.String({minLength:1})),apiUrl:x.Optional(x.String({})),serverUrl:x.Optional(x.String({})),tokenEndpoint:x.Optional(x.String({}))}),mve;(r=>(r.method="github/didChangeAuth",r.type=new Nze.ProtocolNotificationType(r.method)))(mve||={});d();var Lze=Be(hi()),hve;(r=>(r.method="copilot/ipCodeCitation",r.type=new Lze.NotificationType(r.method)))(hve||={});d();var Fze=Be(hi()),pX;(r=>(r.method="context/update",r.type=new Fze.ProtocolRequestType(r.method)))(pX||={});d();d();var OT="Cancelled";d();var hn=Be(hi()),o7=x.String(),Sp=x.Object({uri:o7}),FR=x.Intersect([Sp,x.Object({version:x.Optional(x.Integer())})]),_Un=x.Required(FR),lu=x.Object({line:x.Integer({minimum:0}),character:x.Integer({minimum:0})}),Uc=x.Object({start:lu,end:lu}),gve=x.Union([x.Integer(),x.String()]),RUn=x.Object({isCancellationRequested:x.Boolean(),onCancellationRequested:x.Any()});d();var Oze=Be(hi()),Ave;(r=>(r.method="textDocument/didFocus",r.type=new Oze.ProtocolNotificationType(r.method)))(Ave||={});d();var pjt=x.Object({didChangeFeatureFlags:x.Boolean(),fetch:x.Boolean(),ipCodeCitation:x.Boolean(),redirectedTelemetry:x.Boolean(),related:x.Boolean(),token:x.Boolean(),watchedFiles:x.Boolean(),showPanelMessage:x.Boolean()}),mjt=x.Object({name:x.String(),version:x.String(),readableName:x.Optional(x.String())}),Qze=x.Object({name:x.String(),version:x.Optional(x.String()),readableName:x.Optional(x.String())}),Uze=x.Object({editorInfo:x.Optional(Qze),editorPluginInfo:x.Optional(Qze),relatedPluginInfo:x.Optional(x.Array(mjt)),copilotIntegrationId:x.Optional(x.String()),copilotCapabilities:x.Optional(x.Partial(pjt)),githubAppId:x.Optional(x.String())});d();var s7=Be(hi());var mX=(r=>(r[r.Invoked=1]="Invoked",r[r.Automatic=2]="Automatic",r))(mX||{}),hjt=x.Enum(mX),gjt=x.Object({triggerKind:hjt,selectedCompletionInfo:x.Optional(x.Object({text:x.String(),range:Uc,tooltipSignature:x.Optional(x.String())}))}),qze=x.Object({textDocument:FR,position:lu,formattingOptions:x.Optional(x.Object({tabSize:x.Optional(x.Union([x.Integer({minimum:1}),x.String()])),insertSpaces:x.Optional(x.Union([x.Boolean(),x.String()]))})),context:gjt,data:x.Optional(x.Unknown())}),yve;(r=>(r.method="textDocument/inlineCompletion",r.type=new s7.ProtocolRequestType(r.method)))(yve||={});var Hze=x.Object({command:x.Object({arguments:x.Tuple([x.String({minLength:1})])})}),$ze=x.Object({item:Hze}),Cve;(r=>(r.method="textDocument/didShowCompletion",r.type=new s7.ProtocolNotificationType(r.method)))(Cve||={});var Wze=x.Object({item:Hze,acceptedLength:x.Integer({minimum:1})}),vve;(r=>(r.method="textDocument/didPartiallyAcceptCompletion",r.type=new s7.ProtocolNotificationType(r.method)))(vve||={});d();var jze=Be(hi()),xve;(r=>(r.method="textDocument/inlineCompletionPrompt",r.type=new jze.ProtocolRequestType(r.method)))(xve||={});d();var Gze=Be(hi()),Vze=x.Object({textDocument:FR,position:lu}),Ajt=x.Object({command:x.Object({arguments:x.Tuple([x.String({minLength:1})])})}),zze=x.Object({item:Ajt}),Eve;(r=>(r.method="textDocument/didShowInlineEdit",r.type=new Gze.ProtocolNotificationType(r.method)))(Eve||={});d();var hX=Be(hi());var Kze=x.Object({textDocument:FR,position:lu,partialResultToken:x.Optional(gve),workDoneToken:x.Optional(gve)}),gX;(n=>(n.method="textDocument/copilotPanelCompletion",n.type=new hX.ProtocolRequestType(n.method),n.partialResult=new hX.ProgressType))(gX||={});d();var Yze=Be(hi()),bve;(r=>(r.method="copilot/related",r.type=new Yze.ProtocolRequestType(r.method)))(bve||={});d();var Jze=Be(hi()),Ive;(r=>(r.method="statusNotification",r.type=new Jze.ProtocolNotificationType(r.method)))(Ive||={});var Xze=Be(require("events"));var AX="CompletionRequested",$C=class{constructor(e){this.ctx=e}static{s(this,"CompletionNotifier")}#e=new Xze.default;notifyRequest(e,r,n,i,o){return this.#e.emit(AX,{completionId:r,completionState:e,telemetryData:n,cancellationToken:i,options:o})}onRequest(e){let r=Xl(this.ctx,e,`event.${AX}`);return this.#e.on(AX,r),hn.Disposable.create(()=>this.#e.off(AX,r))}};d();var Tve=class extends Error{constructor(r){super(`No instance of ${r.name} has been registered`);this.ctor=r;this.name="UnregisteredContextError",this.code=r.name}static{s(this,"UnregisteredContextError")}},p3=class{constructor(){this.instances=new Map}static{s(this,"Context")}get(e){let r=this.tryGet(e);if(r)return r;throw new Tve(e)}tryGet(e){let r=this.instances.get(e);if(r)return r}set(e,r){if(this.tryGet(e))throw new Error(`An instance of ${e.name} has already been registered. Use forceSet() if you're sure it's a good idea.`);this.assertIsInstance(e,r),this.instances.set(e,r)}forceSet(e,r){this.assertIsInstance(e,r),this.instances.set(e,r)}assertIsInstance(e,r){if(!(r instanceof e)){let n=JSON.stringify(r);throw new Error(`The instance you're trying to register for ${e.name} is not an instance of it (${n}).`)}}};d();d();d();var yX=class t{static{s(this,"FullTextDocument")}constructor(e,r,n,i){this._uri=e,this._languageId=r,this._version=n,this._content=i,this._lineOffsets=void 0}get uri(){return this._uri}get languageId(){return this._languageId}get version(){return this._version}getText(e){if(e){let r=this.offsetAt(e.start),n=this.offsetAt(e.end);return this._content.substring(r,n)}return this._content}update(e,r){for(let n of e)if(t.isIncremental(n)){let i=tKe(n.range),o=this.offsetAt(i.start),a=this.offsetAt(i.end);this._content=this._content.substring(0,o)+n.text+this._content.substring(a,this._content.length);let c=Math.max(i.start.line,0),l=Math.max(i.end.line,0),u=this._lineOffsets,f=Zze(n.text,!1,o);if(l-c===f.length)for(let m=0,h=f.length;m<h;m++)u[m+c+1]=f[m];else f.length<1e4?u.splice(c+1,l-c,...f):this._lineOffsets=u=u.slice(0,c+1).concat(f,u.slice(l+1));let p=n.text.length-(a-o);if(p!==0)for(let m=c+1+f.length,h=u.length;m<h;m++)u[m]=u[m]+p}else if(t.isFull(n))this._content=n.text,this._lineOffsets=void 0;else throw new Error("Unknown change event received");this._version=r}getLineOffsets(){return this._lineOffsets===void 0&&(this._lineOffsets=Zze(this._content,!0)),this._lineOffsets}positionAt(e){e=Math.max(Math.min(e,this._content.length),0);let r=this.getLineOffsets(),n=0,i=r.length;if(i===0)return{line:0,character:e};for(;n<i;){let a=Math.floor((n+i)/2);r[a]>e?i=a:n=a+1}let o=n-1;return e=this.ensureBeforeEOL(e,r[o]),{line:o,character:e-r[o]}}offsetAt(e){let r=this.getLineOffsets();if(e.line>=r.length)return this._content.length;if(e.line<0)return 0;let n=r[e.line];if(e.character<=0)return n;let i=e.line+1<r.length?r[e.line+1]:this._content.length,o=Math.min(n+e.character,i);return this.ensureBeforeEOL(o,n)}ensureBeforeEOL(e,r){for(;e>r&&eKe(this._content.charCodeAt(e-1));)e--;return e}get lineCount(){return this.getLineOffsets().length}static isIncremental(e){let r=e;return r!=null&&typeof r.text=="string"&&r.range!==void 0&&(r.rangeLength===void 0||typeof r.rangeLength=="number")}static isFull(e){let r=e;return r!=null&&typeof r.text=="string"&&r.range===void 0&&r.rangeLength===void 0}},QT;(function(t){function e(i,o,a,c){return new yX(i,o,a,c)}s(e,"create"),t.create=e;function r(i,o,a){if(i instanceof yX)return i.update(o,a),i;throw new Error("TextDocument.update: document must be created by TextDocument.create")}s(r,"update"),t.update=r;function n(i,o){let a=i.getText(),c=wve(o.map(yjt),(f,p)=>{let m=f.range.start.line-p.range.start.line;return m===0?f.range.start.character-p.range.start.character:m}),l=0,u=[];for(let f of c){let p=i.offsetAt(f.range.start);if(p<l)throw new Error("Overlapping edit");p>l&&u.push(a.substring(l,p)),f.newText.length&&u.push(f.newText),l=i.offsetAt(f.range.end)}return u.push(a.substr(l)),u.join("")}s(n,"applyEdits"),t.applyEdits=n})(QT||(QT={}));function wve(t,e){if(t.length<=1)return t;let r=t.length/2|0,n=t.slice(0,r),i=t.slice(r);wve(n,e),wve(i,e);let o=0,a=0,c=0;for(;o<n.length&&a<i.length;)e(n[o],i[a])<=0?t[c++]=n[o++]:t[c++]=i[a++];for(;o<n.length;)t[c++]=n[o++];for(;a<i.length;)t[c++]=i[a++];return t}s(wve,"mergeSort");function Zze(t,e,r=0){let n=e?[r]:[];for(let i=0;i<t.length;i++){let o=t.charCodeAt(i);eKe(o)&&(o===13&&i+1<t.length&&t.charCodeAt(i+1)===10&&i++,n.push(r+i+1))}return n}s(Zze,"computeLineOffsets");function eKe(t){return t===13||t===10}s(eKe,"isEOL");function tKe(t){let e=t.start,r=t.end;return e.line>r.line||e.line===r.line&&e.character>r.character?{start:r,end:e}:t}s(tKe,"getWellformedRange");function yjt(t){let e=tKe(t.range);return e!==t.range?{newText:t.newText,range:e}:t}s(yjt,"getWellformedEdit");d();var rKe;(function(t){function e(r){return typeof r=="string"}s(e,"is"),t.is=e})(rKe||(rKe={}));var Sve;(function(t){function e(r){return typeof r=="string"}s(e,"is"),t.is=e})(Sve||(Sve={}));var nKe;(function(t){t.MIN_VALUE=-2147483648,t.MAX_VALUE=2147483647;function e(r){return typeof r=="number"&&t.MIN_VALUE<=r&&r<=t.MAX_VALUE}s(e,"is"),t.is=e})(nKe||(nKe={}));var CX;(function(t){t.MIN_VALUE=0,t.MAX_VALUE=2147483647;function e(r){return typeof r=="number"&&t.MIN_VALUE<=r&&r<=t.MAX_VALUE}s(e,"is"),t.is=e})(CX||(CX={}));var Hd;(function(t){function e(n,i){return n===Number.MAX_VALUE&&(n=CX.MAX_VALUE),i===Number.MAX_VALUE&&(i=CX.MAX_VALUE),{line:n,character:i}}s(e,"create"),t.create=e;function r(n){let i=n;return Xe.objectLiteral(i)&&Xe.uinteger(i.line)&&Xe.uinteger(i.character)}s(r,"is"),t.is=r})(Hd||(Hd={}));var Hs;(function(t){function e(n,i,o,a){if(Xe.uinteger(n)&&Xe.uinteger(i)&&Xe.uinteger(o)&&Xe.uinteger(a))return{start:Hd.create(n,i),end:Hd.create(o,a)};if(Hd.is(n)&&Hd.is(i))return{start:n,end:i};throw new Error(`Range#create called with invalid arguments[${n}, ${i}, ${o}, ${a}]`)}s(e,"create"),t.create=e;function r(n){let i=n;return Xe.objectLiteral(i)&&Hd.is(i.start)&&Hd.is(i.end)}s(r,"is"),t.is=r})(Hs||(Hs={}));var vX;(function(t){function e(n,i){return{uri:n,range:i}}s(e,"create"),t.create=e;function r(n){let i=n;return Xe.objectLiteral(i)&&Hs.is(i.range)&&(Xe.string(i.uri)||Xe.undefined(i.uri))}s(r,"is"),t.is=r})(vX||(vX={}));var iKe;(function(t){function e(n,i,o,a){return{targetUri:n,targetRange:i,targetSelectionRange:o,originSelectionRange:a}}s(e,"create"),t.create=e;function r(n){let i=n;return Xe.objectLiteral(i)&&Hs.is(i.targetRange)&&Xe.string(i.targetUri)&&Hs.is(i.targetSelectionRange)&&(Hs.is(i.originSelectionRange)||Xe.undefined(i.originSelectionRange))}s(r,"is"),t.is=r})(iKe||(iKe={}));var _ve;(function(t){function e(n,i,o,a){return{red:n,green:i,blue:o,alpha:a}}s(e,"create"),t.create=e;function r(n){let i=n;return Xe.objectLiteral(i)&&Xe.numberRange(i.red,0,1)&&Xe.numberRange(i.green,0,1)&&Xe.numberRange(i.blue,0,1)&&Xe.numberRange(i.alpha,0,1)}s(r,"is"),t.is=r})(_ve||(_ve={}));var oKe;(function(t){function e(n,i){return{range:n,color:i}}s(e,"create"),t.create=e;function r(n){let i=n;return Xe.objectLiteral(i)&&Hs.is(i.range)&&_ve.is(i.color)}s(r,"is"),t.is=r})(oKe||(oKe={}));var sKe;(function(t){function e(n,i,o){return{label:n,textEdit:i,additionalTextEdits:o}}s(e,"create"),t.create=e;function r(n){let i=n;return Xe.objectLiteral(i)&&Xe.string(i.label)&&(Xe.undefined(i.textEdit)||h3.is(i))&&(Xe.undefined(i.additionalTextEdits)||Xe.typedArray(i.additionalTextEdits,h3.is))}s(r,"is"),t.is=r})(sKe||(sKe={}));var aKe;(function(t){t.Comment="comment",t.Imports="imports",t.Region="region"})(aKe||(aKe={}));var cKe;(function(t){function e(n,i,o,a,c,l){let u={startLine:n,endLine:i};return Xe.defined(o)&&(u.startCharacter=o),Xe.defined(a)&&(u.endCharacter=a),Xe.defined(c)&&(u.kind=c),Xe.defined(l)&&(u.collapsedText=l),u}s(e,"create"),t.create=e;function r(n){let i=n;return Xe.objectLiteral(i)&&Xe.uinteger(i.startLine)&&Xe.uinteger(i.startLine)&&(Xe.undefined(i.startCharacter)||Xe.uinteger(i.startCharacter))&&(Xe.undefined(i.endCharacter)||Xe.uinteger(i.endCharacter))&&(Xe.undefined(i.kind)||Xe.string(i.kind))}s(r,"is"),t.is=r})(cKe||(cKe={}));var Rve;(function(t){function e(n,i){return{location:n,message:i}}s(e,"create"),t.create=e;function r(n){let i=n;return Xe.defined(i)&&vX.is(i.location)&&Xe.string(i.message)}s(r,"is"),t.is=r})(Rve||(Rve={}));var lKe;(function(t){t.Error=1,t.Warning=2,t.Information=3,t.Hint=4})(lKe||(lKe={}));var uKe;(function(t){t.Unnecessary=1,t.Deprecated=2})(uKe||(uKe={}));var dKe;(function(t){function e(r){let n=r;return Xe.objectLiteral(n)&&Xe.string(n.href)}s(e,"is"),t.is=e})(dKe||(dKe={}));var xX;(function(t){function e(n,i,o,a,c,l){let u={range:n,message:i};return Xe.defined(o)&&(u.severity=o),Xe.defined(a)&&(u.code=a),Xe.defined(c)&&(u.source=c),Xe.defined(l)&&(u.relatedInformation=l),u}s(e,"create"),t.create=e;function r(n){var i;let o=n;return Xe.defined(o)&&Hs.is(o.range)&&Xe.string(o.message)&&(Xe.number(o.severity)||Xe.undefined(o.severity))&&(Xe.integer(o.code)||Xe.string(o.code)||Xe.undefined(o.code))&&(Xe.undefined(o.codeDescription)||Xe.string((i=o.codeDescription)===null||i===void 0?void 0:i.href))&&(Xe.string(o.source)||Xe.undefined(o.source))&&(Xe.undefined(o.relatedInformation)||Xe.typedArray(o.relatedInformation,Rve.is))}s(r,"is"),t.is=r})(xX||(xX={}));var m3;(function(t){function e(n,i,...o){let a={title:n,command:i};return Xe.defined(o)&&o.length>0&&(a.arguments=o),a}s(e,"create"),t.create=e;function r(n){let i=n;return Xe.defined(i)&&Xe.string(i.title)&&Xe.string(i.command)}s(r,"is"),t.is=r})(m3||(m3={}));var h3;(function(t){function e(o,a){return{range:o,newText:a}}s(e,"replace"),t.replace=e;function r(o,a){return{range:{start:o,end:o},newText:a}}s(r,"insert"),t.insert=r;function n(o){return{range:o,newText:""}}s(n,"del"),t.del=n;function i(o){let a=o;return Xe.objectLiteral(a)&&Xe.string(a.newText)&&Hs.is(a.range)}s(i,"is"),t.is=i})(h3||(h3={}));var kve;(function(t){function e(n,i,o){let a={label:n};return i!==void 0&&(a.needsConfirmation=i),o!==void 0&&(a.description=o),a}s(e,"create"),t.create=e;function r(n){let i=n;return Xe.objectLiteral(i)&&Xe.string(i.label)&&(Xe.boolean(i.needsConfirmation)||i.needsConfirmation===void 0)&&(Xe.string(i.description)||i.description===void 0)}s(r,"is"),t.is=r})(kve||(kve={}));var g3;(function(t){function e(r){let n=r;return Xe.string(n)}s(e,"is"),t.is=e})(g3||(g3={}));var fKe;(function(t){function e(o,a,c){return{range:o,newText:a,annotationId:c}}s(e,"replace"),t.replace=e;function r(o,a,c){return{range:{start:o,end:o},newText:a,annotationId:c}}s(r,"insert"),t.insert=r;function n(o,a){return{range:o,newText:"",annotationId:a}}s(n,"del"),t.del=n;function i(o){let a=o;return h3.is(a)&&(kve.is(a.annotationId)||g3.is(a.annotationId))}s(i,"is"),t.is=i})(fKe||(fKe={}));var Pve;(function(t){function e(n,i){return{textDocument:n,edits:i}}s(e,"create"),t.create=e;function r(n){let i=n;return Xe.defined(i)&&Lve.is(i.textDocument)&&Array.isArray(i.edits)}s(r,"is"),t.is=r})(Pve||(Pve={}));var Dve;(function(t){function e(n,i,o){let a={kind:"create",uri:n};return i!==void 0&&(i.overwrite!==void 0||i.ignoreIfExists!==void 0)&&(a.options=i),o!==void 0&&(a.annotationId=o),a}s(e,"create"),t.create=e;function r(n){let i=n;return i&&i.kind==="create"&&Xe.string(i.uri)&&(i.options===void 0||(i.options.overwrite===void 0||Xe.boolean(i.options.overwrite))&&(i.options.ignoreIfExists===void 0||Xe.boolean(i.options.ignoreIfExists)))&&(i.annotationId===void 0||g3.is(i.annotationId))}s(r,"is"),t.is=r})(Dve||(Dve={}));var Bve;(function(t){function e(n,i,o,a){let c={kind:"rename",oldUri:n,newUri:i};return o!==void 0&&(o.overwrite!==void 0||o.ignoreIfExists!==void 0)&&(c.options=o),a!==void 0&&(c.annotationId=a),c}s(e,"create"),t.create=e;function r(n){let i=n;return i&&i.kind==="rename"&&Xe.string(i.oldUri)&&Xe.string(i.newUri)&&(i.options===void 0||(i.options.overwrite===void 0||Xe.boolean(i.options.overwrite))&&(i.options.ignoreIfExists===void 0||Xe.boolean(i.options.ignoreIfExists)))&&(i.annotationId===void 0||g3.is(i.annotationId))}s(r,"is"),t.is=r})(Bve||(Bve={}));var Nve;(function(t){function e(n,i,o){let a={kind:"delete",uri:n};return i!==void 0&&(i.recursive!==void 0||i.ignoreIfNotExists!==void 0)&&(a.options=i),o!==void 0&&(a.annotationId=o),a}s(e,"create"),t.create=e;function r(n){let i=n;return i&&i.kind==="delete"&&Xe.string(i.uri)&&(i.options===void 0||(i.options.recursive===void 0||Xe.boolean(i.options.recursive))&&(i.options.ignoreIfNotExists===void 0||Xe.boolean(i.options.ignoreIfNotExists)))&&(i.annotationId===void 0||g3.is(i.annotationId))}s(r,"is"),t.is=r})(Nve||(Nve={}));var Mve;(function(t){function e(r){let n=r;return n&&(n.changes!==void 0||n.documentChanges!==void 0)&&(n.documentChanges===void 0||n.documentChanges.every(i=>Xe.string(i.kind)?Dve.is(i)||Bve.is(i)||Nve.is(i):Pve.is(i)))}s(e,"is"),t.is=e})(Mve||(Mve={}));var pKe;(function(t){function e(n){return{uri:n}}s(e,"create"),t.create=e;function r(n){let i=n;return Xe.defined(i)&&Xe.string(i.uri)}s(r,"is"),t.is=r})(pKe||(pKe={}));var mKe;(function(t){function e(n,i){return{uri:n,version:i}}s(e,"create"),t.create=e;function r(n){let i=n;return Xe.defined(i)&&Xe.string(i.uri)&&Xe.integer(i.version)}s(r,"is"),t.is=r})(mKe||(mKe={}));var Lve;(function(t){function e(n,i){return{uri:n,version:i}}s(e,"create"),t.create=e;function r(n){let i=n;return Xe.defined(i)&&Xe.string(i.uri)&&(i.version===null||Xe.integer(i.version))}s(r,"is"),t.is=r})(Lve||(Lve={}));var hKe;(function(t){function e(n,i,o,a){return{uri:n,languageId:i,version:o,text:a}}s(e,"create"),t.create=e;function r(n){let i=n;return Xe.defined(i)&&Xe.string(i.uri)&&Xe.string(i.languageId)&&Xe.integer(i.version)&&Xe.string(i.text)}s(r,"is"),t.is=r})(hKe||(hKe={}));var Fve;(function(t){t.PlainText="plaintext",t.Markdown="markdown";function e(r){let n=r;return n===t.PlainText||n===t.Markdown}s(e,"is"),t.is=e})(Fve||(Fve={}));var a7;(function(t){function e(r){let n=r;return Xe.objectLiteral(r)&&Fve.is(n.kind)&&Xe.string(n.value)}s(e,"is"),t.is=e})(a7||(a7={}));var gKe;(function(t){t.Text=1,t.Method=2,t.Function=3,t.Constructor=4,t.Field=5,t.Variable=6,t.Class=7,t.Interface=8,t.Module=9,t.Property=10,t.Unit=11,t.Value=12,t.Enum=13,t.Keyword=14,t.Snippet=15,t.Color=16,t.File=17,t.Reference=18,t.Folder=19,t.EnumMember=20,t.Constant=21,t.Struct=22,t.Event=23,t.Operator=24,t.TypeParameter=25})(gKe||(gKe={}));var AKe;(function(t){t.PlainText=1,t.Snippet=2})(AKe||(AKe={}));var yKe;(function(t){t.Deprecated=1})(yKe||(yKe={}));var CKe;(function(t){function e(n,i,o){return{newText:n,insert:i,replace:o}}s(e,"create"),t.create=e;function r(n){let i=n;return i&&Xe.string(i.newText)&&Hs.is(i.insert)&&Hs.is(i.replace)}s(r,"is"),t.is=r})(CKe||(CKe={}));var vKe;(function(t){t.asIs=1,t.adjustIndentation=2})(vKe||(vKe={}));var xKe;(function(t){function e(r){let n=r;return n&&(Xe.string(n.detail)||n.detail===void 0)&&(Xe.string(n.description)||n.description===void 0)}s(e,"is"),t.is=e})(xKe||(xKe={}));var EKe;(function(t){function e(r){return{label:r}}s(e,"create"),t.create=e})(EKe||(EKe={}));var bKe;(function(t){function e(r,n){return{items:r||[],isIncomplete:!!n}}s(e,"create"),t.create=e})(bKe||(bKe={}));var EX;(function(t){function e(n){return n.replace(/[\\`*_{}[\]()#+\-.!]/g,"\\$&")}s(e,"fromPlainText"),t.fromPlainText=e;function r(n){let i=n;return Xe.string(i)||Xe.objectLiteral(i)&&Xe.string(i.language)&&Xe.string(i.value)}s(r,"is"),t.is=r})(EX||(EX={}));var IKe;(function(t){function e(r){let n=r;return!!n&&Xe.objectLiteral(n)&&(a7.is(n.contents)||EX.is(n.contents)||Xe.typedArray(n.contents,EX.is))&&(r.range===void 0||Hs.is(r.range))}s(e,"is"),t.is=e})(IKe||(IKe={}));var TKe;(function(t){function e(r,n){return n?{label:r,documentation:n}:{label:r}}s(e,"create"),t.create=e})(TKe||(TKe={}));var wKe;(function(t){function e(r,n,...i){let o={label:r};return Xe.defined(n)&&(o.documentation=n),Xe.defined(i)?o.parameters=i:o.parameters=[],o}s(e,"create"),t.create=e})(wKe||(wKe={}));var SKe;(function(t){t.Text=1,t.Read=2,t.Write=3})(SKe||(SKe={}));var _Ke;(function(t){function e(r,n){let i={range:r};return Xe.number(n)&&(i.kind=n),i}s(e,"create"),t.create=e})(_Ke||(_Ke={}));var RKe;(function(t){t.File=1,t.Module=2,t.Namespace=3,t.Package=4,t.Class=5,t.Method=6,t.Property=7,t.Field=8,t.Constructor=9,t.Enum=10,t.Interface=11,t.Function=12,t.Variable=13,t.Constant=14,t.String=15,t.Number=16,t.Boolean=17,t.Array=18,t.Object=19,t.Key=20,t.Null=21,t.EnumMember=22,t.Struct=23,t.Event=24,t.Operator=25,t.TypeParameter=26})(RKe||(RKe={}));var kKe;(function(t){t.Deprecated=1})(kKe||(kKe={}));var PKe;(function(t){function e(r,n,i,o,a){let c={name:r,kind:n,location:{uri:o,range:i}};return a&&(c.containerName=a),c}s(e,"create"),t.create=e})(PKe||(PKe={}));var DKe;(function(t){function e(r,n,i,o){return o!==void 0?{name:r,kind:n,location:{uri:i,range:o}}:{name:r,kind:n,location:{uri:i}}}s(e,"create"),t.create=e})(DKe||(DKe={}));var BKe;(function(t){function e(n,i,o,a,c,l){let u={name:n,detail:i,kind:o,range:a,selectionRange:c};return l!==void 0&&(u.children=l),u}s(e,"create"),t.create=e;function r(n){let i=n;return i&&Xe.string(i.name)&&Xe.number(i.kind)&&Hs.is(i.range)&&Hs.is(i.selectionRange)&&(i.detail===void 0||Xe.string(i.detail))&&(i.deprecated===void 0||Xe.boolean(i.deprecated))&&(i.children===void 0||Array.isArray(i.children))&&(i.tags===void 0||Array.isArray(i.tags))}s(r,"is"),t.is=r})(BKe||(BKe={}));var NKe;(function(t){t.Empty="",t.QuickFix="quickfix",t.Refactor="refactor",t.RefactorExtract="refactor.extract",t.RefactorInline="refactor.inline",t.RefactorRewrite="refactor.rewrite",t.Source="source",t.SourceOrganizeImports="source.organizeImports",t.SourceFixAll="source.fixAll"})(NKe||(NKe={}));var bX;(function(t){t.Invoked=1,t.Automatic=2})(bX||(bX={}));var MKe;(function(t){function e(n,i,o){let a={diagnostics:n};return i!=null&&(a.only=i),o!=null&&(a.triggerKind=o),a}s(e,"create"),t.create=e;function r(n){let i=n;return Xe.defined(i)&&Xe.typedArray(i.diagnostics,xX.is)&&(i.only===void 0||Xe.typedArray(i.only,Xe.string))&&(i.triggerKind===void 0||i.triggerKind===bX.Invoked||i.triggerKind===bX.Automatic)}s(r,"is"),t.is=r})(MKe||(MKe={}));var LKe;(function(t){function e(n,i,o){let a={title:n},c=!0;return typeof i=="string"?(c=!1,a.kind=i):m3.is(i)?a.command=i:a.edit=i,c&&o!==void 0&&(a.kind=o),a}s(e,"create"),t.create=e;function r(n){let i=n;return i&&Xe.string(i.title)&&(i.diagnostics===void 0||Xe.typedArray(i.diagnostics,xX.is))&&(i.kind===void 0||Xe.string(i.kind))&&(i.edit!==void 0||i.command!==void 0)&&(i.command===void 0||m3.is(i.command))&&(i.isPreferred===void 0||Xe.boolean(i.isPreferred))&&(i.edit===void 0||Mve.is(i.edit))}s(r,"is"),t.is=r})(LKe||(LKe={}));var FKe;(function(t){function e(n,i){let o={range:n};return Xe.defined(i)&&(o.data=i),o}s(e,"create"),t.create=e;function r(n){let i=n;return Xe.defined(i)&&Hs.is(i.range)&&(Xe.undefined(i.command)||m3.is(i.command))}s(r,"is"),t.is=r})(FKe||(FKe={}));var OKe;(function(t){function e(n,i){return{tabSize:n,insertSpaces:i}}s(e,"create"),t.create=e;function r(n){let i=n;return Xe.defined(i)&&Xe.uinteger(i.tabSize)&&Xe.boolean(i.insertSpaces)}s(r,"is"),t.is=r})(OKe||(OKe={}));var QKe;(function(t){function e(n,i,o){return{range:n,target:i,data:o}}s(e,"create"),t.create=e;function r(n){let i=n;return Xe.defined(i)&&Hs.is(i.range)&&(Xe.undefined(i.target)||Xe.string(i.target))}s(r,"is"),t.is=r})(QKe||(QKe={}));var UKe;(function(t){function e(n,i){return{range:n,parent:i}}s(e,"create"),t.create=e;function r(n){let i=n;return Xe.objectLiteral(i)&&Hs.is(i.range)&&(i.parent===void 0||t.is(i.parent))}s(r,"is"),t.is=r})(UKe||(UKe={}));var qKe;(function(t){t.namespace="namespace",t.type="type",t.class="class",t.enum="enum",t.interface="interface",t.struct="struct",t.typeParameter="typeParameter",t.parameter="parameter",t.variable="variable",t.property="property",t.enumMember="enumMember",t.event="event",t.function="function",t.method="method",t.macro="macro",t.keyword="keyword",t.modifier="modifier",t.comment="comment",t.string="string",t.number="number",t.regexp="regexp",t.operator="operator",t.decorator="decorator"})(qKe||(qKe={}));var HKe;(function(t){t.declaration="declaration",t.definition="definition",t.readonly="readonly",t.static="static",t.deprecated="deprecated",t.abstract="abstract",t.async="async",t.modification="modification",t.documentation="documentation",t.defaultLibrary="defaultLibrary"})(HKe||(HKe={}));var $Ke;(function(t){function e(r){let n=r;return Xe.objectLiteral(n)&&(n.resultId===void 0||typeof n.resultId=="string")&&Array.isArray(n.data)&&(n.data.length===0||typeof n.data[0]=="number")}s(e,"is"),t.is=e})($Ke||($Ke={}));var WKe;(function(t){function e(n,i){return{range:n,text:i}}s(e,"create"),t.create=e;function r(n){let i=n;return i!=null&&Hs.is(i.range)&&Xe.string(i.text)}s(r,"is"),t.is=r})(WKe||(WKe={}));var jKe;(function(t){function e(n,i,o){return{range:n,variableName:i,caseSensitiveLookup:o}}s(e,"create"),t.create=e;function r(n){let i=n;return i!=null&&Hs.is(i.range)&&Xe.boolean(i.caseSensitiveLookup)&&(Xe.string(i.variableName)||i.variableName===void 0)}s(r,"is"),t.is=r})(jKe||(jKe={}));var GKe;(function(t){function e(n,i){return{range:n,expression:i}}s(e,"create"),t.create=e;function r(n){let i=n;return i!=null&&Hs.is(i.range)&&(Xe.string(i.expression)||i.expression===void 0)}s(r,"is"),t.is=r})(GKe||(GKe={}));var VKe;(function(t){function e(n,i){return{frameId:n,stoppedLocation:i}}s(e,"create"),t.create=e;function r(n){let i=n;return Xe.defined(i)&&Hs.is(n.stoppedLocation)}s(r,"is"),t.is=r})(VKe||(VKe={}));var Ove;(function(t){t.Type=1,t.Parameter=2;function e(r){return r===1||r===2}s(e,"is"),t.is=e})(Ove||(Ove={}));var Qve;(function(t){function e(n){return{value:n}}s(e,"create"),t.create=e;function r(n){let i=n;return Xe.objectLiteral(i)&&(i.tooltip===void 0||Xe.string(i.tooltip)||a7.is(i.tooltip))&&(i.location===void 0||vX.is(i.location))&&(i.command===void 0||m3.is(i.command))}s(r,"is"),t.is=r})(Qve||(Qve={}));var zKe;(function(t){function e(n,i,o){let a={position:n,label:i};return o!==void 0&&(a.kind=o),a}s(e,"create"),t.create=e;function r(n){let i=n;return Xe.objectLiteral(i)&&Hd.is(i.position)&&(Xe.string(i.label)||Xe.typedArray(i.label,Qve.is))&&(i.kind===void 0||Ove.is(i.kind))&&i.textEdits===void 0||Xe.typedArray(i.textEdits,h3.is)&&(i.tooltip===void 0||Xe.string(i.tooltip)||a7.is(i.tooltip))&&(i.paddingLeft===void 0||Xe.boolean(i.paddingLeft))&&(i.paddingRight===void 0||Xe.boolean(i.paddingRight))}s(r,"is"),t.is=r})(zKe||(zKe={}));var KKe;(function(t){function e(r){return{kind:"snippet",value:r}}s(e,"createSnippet"),t.createSnippet=e})(KKe||(KKe={}));var YKe;(function(t){function e(r,n,i,o){return{insertText:r,filterText:n,range:i,command:o}}s(e,"create"),t.create=e})(YKe||(YKe={}));var JKe;(function(t){function e(r){return{items:r}}s(e,"create"),t.create=e})(JKe||(JKe={}));var XKe;(function(t){t.Invoked=0,t.Automatic=1})(XKe||(XKe={}));var ZKe;(function(t){function e(r,n){return{range:r,text:n}}s(e,"create"),t.create=e})(ZKe||(ZKe={}));var eYe;(function(t){function e(r,n){return{triggerKind:r,selectedCompletionInfo:n}}s(e,"create"),t.create=e})(eYe||(eYe={}));var tYe;(function(t){function e(r){let n=r;return Xe.objectLiteral(n)&&Sve.is(n.uri)&&Xe.string(n.name)}s(e,"is"),t.is=e})(tYe||(tYe={}));var rYe;(function(t){function e(o,a,c,l){return new Uve(o,a,c,l)}s(e,"create"),t.create=e;function r(o){let a=o;return!!(Xe.defined(a)&&Xe.string(a.uri)&&(Xe.undefined(a.languageId)||Xe.string(a.languageId))&&Xe.uinteger(a.lineCount)&&Xe.func(a.getText)&&Xe.func(a.positionAt)&&Xe.func(a.offsetAt))}s(r,"is"),t.is=r;function n(o,a){let c=o.getText(),l=i(a,(f,p)=>{let m=f.range.start.line-p.range.start.line;return m===0?f.range.start.character-p.range.start.character:m}),u=c.length;for(let f=l.length-1;f>=0;f--){let p=l[f],m=o.offsetAt(p.range.start),h=o.offsetAt(p.range.end);if(h<=u)c=c.substring(0,m)+p.newText+c.substring(h,c.length);else throw new Error("Overlapping edit");u=m}return c}s(n,"applyEdits"),t.applyEdits=n;function i(o,a){if(o.length<=1)return o;let c=o.length/2|0,l=o.slice(0,c),u=o.slice(c);i(l,a),i(u,a);let f=0,p=0,m=0;for(;f<l.length&&p<u.length;)a(l[f],u[p])<=0?o[m++]=l[f++]:o[m++]=u[p++];for(;f<l.length;)o[m++]=l[f++];for(;p<u.length;)o[m++]=u[p++];return o}s(i,"mergeSort")})(rYe||(rYe={}));var Uve=class{static{s(this,"FullTextDocument")}constructor(e,r,n,i){this._uri=e,this._languageId=r,this._version=n,this._content=i,this._lineOffsets=void 0}get uri(){return this._uri}get languageId(){return this._languageId}get version(){return this._version}getText(e){if(e){let r=this.offsetAt(e.start),n=this.offsetAt(e.end);return this._content.substring(r,n)}return this._content}update(e,r){this._content=e.text,this._version=r,this._lineOffsets=void 0}getLineOffsets(){if(this._lineOffsets===void 0){let e=[],r=this._content,n=!0;for(let i=0;i<r.length;i++){n&&(e.push(i),n=!1);let o=r.charAt(i);n=o==="\r"||o===`
`,o==="\r"&&i+1<r.length&&r.charAt(i+1)===`
`&&i++}n&&r.length>0&&e.push(r.length),this._lineOffsets=e}return this._lineOffsets}positionAt(e){e=Math.max(Math.min(e,this._content.length),0);let r=this.getLineOffsets(),n=0,i=r.length;if(i===0)return Hd.create(0,e);for(;n<i;){let a=Math.floor((n+i)/2);r[a]>e?i=a:n=a+1}let o=n-1;return Hd.create(o,e-r[o])}offsetAt(e){let r=this.getLineOffsets();if(e.line>=r.length)return this._content.length;if(e.line<0)return 0;let n=r[e.line],i=e.line+1<r.length?r[e.line+1]:this._content.length;return Math.max(Math.min(n+e.character,i),n)}get lineCount(){return this.getLineOffsets().length}},Xe;(function(t){let e=Object.prototype.toString;function r(h){return typeof h<"u"}s(r,"defined"),t.defined=r;function n(h){return typeof h>"u"}s(n,"undefined"),t.undefined=n;function i(h){return h===!0||h===!1}s(i,"boolean"),t.boolean=i;function o(h){return e.call(h)==="[object String]"}s(o,"string"),t.string=o;function a(h){return e.call(h)==="[object Number]"}s(a,"number"),t.number=a;function c(h,g,A){return e.call(h)==="[object Number]"&&g<=h&&h<=A}s(c,"numberRange"),t.numberRange=c;function l(h){return e.call(h)==="[object Number]"&&-2147483648<=h&&h<=2147483647}s(l,"integer"),t.integer=l;function u(h){return e.call(h)==="[object Number]"&&0<=h&&h<=2147483647}s(u,"uinteger"),t.uinteger=u;function f(h){return e.call(h)==="[object Function]"}s(f,"func"),t.func=f;function p(h){return h!==null&&typeof h=="object"}s(p,"objectLiteral"),t.objectLiteral=p;function m(h,g){return Array.isArray(h)&&h.every(g)}s(m,"typedArray"),t.typedArray=m})(Xe||(Xe={}));var Es=class{static{s(this,"LocationFactory")}static{this.range=Hs.create.bind(Hs)}static{this.position=Hd.create.bind(Hd)}},Tx=class t{constructor(e,r,n){this.uri=e;this._textDocument=r;this.detectedLanguageId=n}static{s(this,"CopilotTextDocument")}static withChanges(e,r,n){let i=QT.create(e.clientUri,e.clientLanguageId,n,e.getText());return QT.update(i,r,n),new t(e.uri,i,e.detectedLanguageId)}applyEdits(e){let r=QT.create(this.clientUri,this.clientLanguageId,this.version,this.getText());return QT.update(r,e.map(n=>({text:n.newText,range:n.range})),this.version),new t(this.uri,r,this.detectedLanguageId)}static create(e,r,n,i,o=TT({uri:e,languageId:r})){return new t(Pl(e),QT.create(e,r,n,i),o)}get clientUri(){return this._textDocument.uri}get clientLanguageId(){return this._textDocument.languageId}get languageId(){return this._textDocument.languageId}get version(){return this._textDocument.version}get lineCount(){return this._textDocument.lineCount}getText(e){return this._textDocument.getText(e)}positionAt(e){return this._textDocument.positionAt(e)}offsetAt(e){return this._textDocument.offsetAt(e)}lineAt(e){let r=typeof e=="number"?e:e.line;if(r<0||r>=this.lineCount)throw new RangeError("Illegal value for lineNumber");let n=Hs.create(r,0,r+1,0),i=this.getText(n).replace(/\r\n$|\r$|\n$/g,""),o=Hs.create(Hd.create(r,0),Hd.create(r,i.length)),a=i.trim().length===0;return{text:i,range:o,isEmptyOrWhitespace:a}}};d();d();d();d();var c7={isBlocked:!1,reason:"VALID_FILE"},IX={isBlocked:!1,reason:"NO_MATCHING_POLICY"},nYe={isBlocked:!0,reason:"POLICY_ERROR",message:"Copilot is disabled because we could not fetch the repository policy"},OR={all:"all",repo:"repo"},UT=new dt("contentExclusion");d();d();var TX=class{static{s(this,"PolicyEvaluator")}};d();d();d();var iYe=new dt("repository"),QR=class t{constructor(){this.data={}}static{s(this,"GitConfigData")}getKeys(){return Object.keys(this.data)}getEntries(){return Object.entries(this.data)}get(e){let r=this.getAll(e);return r?r[r.length-1]:void 0}getAll(e){return this.data[this.normalizeKey(e)]}add(e,r){e in this.data||(this.data[e]=[]),this.data[e].push(r)}getSectionValues(e,r){let n=`${e}.`.toLowerCase(),i=`.${r}`.toLowerCase();return Object.keys(this.data).filter(o=>o.startsWith(n)&&o.endsWith(i)).map(o=>o.slice(n.length,-i.length))}concat(e){return this.getEntries().concat(e.getEntries()).reduce((r,[n,i])=>(i.forEach(o=>r.add(n,o)),r),new t)}normalizeKey(e){let r=e.split(".");return r[0]=r[0].toLowerCase(),r[r.length-1]=r[r.length-1].toLowerCase(),r.join(".")}},kA=class{static{s(this,"GitConfigLoader")}},wX=class extends kA{constructor(r){super();this.loaders=r}static{s(this,"GitFallbackConfigLoader")}async getConfig(r,n){for(let i of this.loaders){let o=await i.getConfig(r,n);if(o)return o}}};d();var oYe=require("os");var SX=class{constructor(e){this.url=e;this.isUrl()?this.parseUrl():this.tryParseSSHString()||(this._scheme="file")}static{s(this,"GitRemoteUrl")}get scheme(){return this._scheme}get authority(){return this._authority}get hostname(){return this._hostname}get path(){return this._path}isInvalid(){return this._error!==void 0}isRemote(){return this.scheme!=="file"&&this.hostname!==void 0}isGitHub(){return this.isRemote()&&/(?:^|\.)(?:github\.com|ghe\.com)$/i.test(this.hostname??"")}isADO(){return this.isRemote()&&/(?:^|\.)(?:visualstudio\.com|azure\.com)$/i.test(this.hostname??"")}getUrlForApi(){if(!this.isRemote())return null;if(this.isUrl()&&!this.isInvalid())return CI.from({scheme:this.scheme,authority:this.authority.replace(/^[^@]+@/,""),path:this.path}).toString();if(this.scheme=="ssh"&&this.isADO()){let e=this.url.indexOf(":");return this.url.substring(0,e+1)+this.path}return this.url}isUrl(){return/[A-Za-z0-9][A-Za-z0-9]+:\/\//.test(this.url)}parseUrl(){let e;try{e=CI.parse(this.url)}catch(r){this._error=r;return}this._scheme=e.scheme,this.setAuthority(e.authority),this.setPath(e.path)}setAuthority(e){this._authority=e;let r=e.replace(/^[^@]+@/,"").replace(/:\d*$/,"");r&&(this._hostname=r)}tryParseSSHString(){let e=/^(?<host>[^:/\\[]*(?:\[[^/\\\]]*\])?):/.exec(this.url);if(e&&((0,oYe.platform)()!=="win32"||(e.groups?.host?.length??0)>1)){let r=e.groups?.host??"";return this._scheme="ssh",this.setAuthority(r),this.setPath(this.url.substring(r.length+1)),!0}return!1}setPath(e){if(this.isADO())try{this._path=decodeURIComponent(e);return}catch{}this._path=e}};var _X=class{static{s(this,"GitRemoteResolver")}async resolveRemote(e,r){let n=await e.get(kA).getConfig(e,r);if(!n)return;let i=this.getRemotes(n),o=i.filter(a=>a.url.isGitHub());if(o.length)return o.find(a=>a.name==="origin")?.url??o[0].url;if(i.length)return i.find(a=>a.name==="origin")?.url??i[0].url}getRemotes(e){let r=this.getInsteadOfRules(e);return e.getSectionValues("remote","url").map(n=>({name:n,url:new SX(this.applyInsteadOfRules(r,e.get(`remote.${n}.url`)??""))})).filter(n=>n.url.isRemote())}applyInsteadOfRules(e,r){for(let n of e)if(r.startsWith(n.insteadOf))return n.base+r.slice(n.insteadOf.length);return r}getInsteadOfRules(e){return e.getSectionValues("url","insteadof").map(r=>({base:r,insteadOf:e.get(`url.${r}.insteadof`)})).sort((r,n)=>n.base.length-r.base.length)}};var Cjt=100,qve=class{constructor(e,r){this.baseFolder=e;this.remote=r;this.setNWO()}static{s(this,"GitRepository")}get tenant(){return this._tenant}get owner(){return this._owner}get name(){return this._name}get adoOrganization(){return this._adoOrganization}isGitHub(){return this.remote?.isGitHub()??!1}isADO(){return this.remote?.isADO()??!1}setNWO(){let e=this.remote?.path?.replace(/^\//,"").split("/");if(this.isGitHub()){this._owner=e?.[0],this._name=e?.[1]?.replace(/\.git$/,"");let r=/^(?<tenant>[^.]+)\.ghe\.com$/.exec(this.remote?.hostname??"");r&&(this._tenant=r.groups?.tenant)}else if(this.isADO()&&e?.length===4){if(this.remote?.scheme==="ssh"){this._adoOrganization=e?.[1],this._owner=e?.[2],this._name=e?.[3];return}let r=/(?:(?<org>[^.]+)\.)?visualstudio\.com$/.exec(this.remote?.hostname??"");r?(this._adoOrganization=r.groups?.org,this._owner=e?.[1],this._name=e?.[3]):(this._adoOrganization=e?.[0],this._owner=e?.[1],this._name=e?.[3])}}},PA=class t{constructor(e){this.ctx=e;this.remoteResolver=new _X;this.cache=new Sr(Cjt)}static{s(this,"RepositoryManager")}async getRepo({uri:e}){let r,n=[];do{if(this.cache.has(e.toString())){let o=this.cache.get(e);return this.updateCache(n,o),o}n.push(e.toString());let i=await this.tryGetRepoForFolder(e);if(i)return this.updateCache(n,i),i;r=e,e=wd(e)}while(e!==r);this.updateCache(n,void 0)}updateCache(e,r){e.forEach(n=>this.cache.set(n,r))}async tryGetRepoForFolder(e){return await this.isBaseRepoFolder(e)?new qve(typeof e=="string"?{uri:e}:e,await this.repoUrl(e)):void 0}async isBaseRepoFolder(e){return await t.getRepoConfigLocation(this.ctx,e)!==void 0}async repoUrl(e){return await this.remoteResolver.resolveRemote(this.ctx,e)}static async getRepoConfigLocation(e,r){try{let n=e.get(Fi),i=Vi(r,".git");if((await n.stat(i)).type&1)return await this.getConfigLocationForGitfile(n,r,i);let a=Vi(i,"config");return await n.stat(a),a}catch{return}}static async getConfigLocationForGitfile(e,r,n){let o=(await e.readFileString(n)).match(/^gitdir:\s+(.+)$/m);if(!o)return;let a=H_(r,o[1]),c=Vi(a,"config");if(await this.tryStat(e,c)!==void 0)return c;let l=Vi(a,"config.worktree");if(await this.tryStat(e,l)!==void 0)return l;let u=Vi(a,"commondir");a=H_(a,(await e.readFileString(u)).trimEnd());let f=Vi(a,"config");return await e.stat(f),f}static async tryStat(e,r){try{return await e.stat(r)}catch{return}}};d();var UR=s((t,e)=>{if(FC.Check(t,e))return e;let r=`Typebox schema validation failed:
${[...FC.Errors(t,e)].map(n=>`${n.path} ${n.message}`).join(`
`)}`;throw new Error(r)},"assertShape");d();d();d();var RX=new WeakMap;function kX(t,e){if(t==null||typeof t!="object")return String(t);let r,n="",i=0,o=Object.prototype.toString.call(t);if(o!=="[object RegExp]"&&o!=="[object Date]"&&RX.has(t))return RX.get(t);switch(RX.set(t,"~"+ ++e),o){case"[object Set]":r=Array.from(t);case"[object Array]":for(r||(r=t),n+="a";i<r.length;n+=kX(r[i++],e));break;case"[object Object]":for(n+="o",r=Object.keys(t).sort();i<r.length;n+=r[i]+kX(t[r[i++]],e));break;case"[object Map]":for(n+="o",r=Array.from(t.keys()).sort();i<r.length;n+=r[i]+kX(t.get(r[i++]),e));break;case"[object Date]":return"d"+ +t;case"[object RegExp]":return"r"+t.source+t.flags;default:throw new Error(`Unsupported value ${t}`)}return RX.set(t,n),n}s(kX,"t");function PX(t){return kX(t,0)}s(PX,"r");var Hve=new WeakMap;function sYe(t,e,r=PX(e)){let n,i,o=Hve.get(t);o||(Hve.set(t,o=[[],i=[],n=[]]),queueMicrotask(function(){let u,f=0;function p(m){for(;u=n[f++];u.r(m));}s(p,"o"),Hve.delete(t),t(i).then(function(m){if(m.length!==n.length)return p(new Error("loader value length mismatch"));for(;u=m[f++],f<=m.length;u instanceof Error?n[f-1].r(u):n[f-1].s(u));},p)}));let a=o[0].indexOf(r);if(~a)return o[2][a].p;let c=o[0].push(r)-1,l=o[2][c]={};return o[1][c]=e,l.p=new Promise(function(u,f){l.s=u,l.r=f})}s(sYe,"n");var aYe=new WeakMap;function vjt(t,e,r,n=PX(r)){if(e||(e=aYe.get(t)),e||aYe.set(t,e=new Map),e.has(n))return Promise.resolve(e.get(n));let i=sYe(t,r,n);return e.set(n,i),i.catch(()=>e.delete(n)),i}s(vjt,"n");function cYe(t,e){return function(r,n){return vjt(t,e,r,n)}}s(cYe,"o");d();var RYe=Be(xYe(),1);d();var d7=s(t=>{if(typeof t!="string")throw new TypeError("invalid pattern");if(t.length>65536)throw new TypeError("pattern is too long")},"assertValidPattern");d();d();var _jt={"[:alnum:]":["\\p{L}\\p{Nl}\\p{Nd}",!0],"[:alpha:]":["\\p{L}\\p{Nl}",!0],"[:ascii:]":["\\x00-\\x7f",!1],"[:blank:]":["\\p{Zs}\\t",!0],"[:cntrl:]":["\\p{Cc}",!0],"[:digit:]":["\\p{Nd}",!0],"[:graph:]":["\\p{Z}\\p{C}",!0,!0],"[:lower:]":["\\p{Ll}",!0],"[:print:]":["\\p{C}",!0],"[:punct:]":["\\p{P}",!0],"[:space:]":["\\p{Z}\\t\\r\\n\\v\\f",!0],"[:upper:]":["\\p{Lu}",!0],"[:word:]":["\\p{L}\\p{Nl}\\p{Nd}\\p{Pc}",!0],"[:xdigit:]":["A-Fa-f0-9",!1]},f7=s(t=>t.replace(/[[\]\\-]/g,"\\$&"),"braceEscape"),Rjt=s(t=>t.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),"regexpEscape"),EYe=s(t=>t.join(""),"rangesToString"),bYe=s((t,e)=>{let r=e;if(t.charAt(r)!=="[")throw new Error("not in a brace expression");let n=[],i=[],o=r+1,a=!1,c=!1,l=!1,u=!1,f=r,p="";e:for(;o<t.length;){let A=t.charAt(o);if((A==="!"||A==="^")&&o===r+1){u=!0,o++;continue}if(A==="]"&&a&&!l){f=o+1;break}if(a=!0,A==="\\"&&!l){l=!0,o++;continue}if(A==="["&&!l){for(let[y,[E,b,S]]of Object.entries(_jt))if(t.startsWith(y,o)){if(p)return["$.",!1,t.length-r,!0];o+=y.length,S?i.push(E):n.push(E),c=c||b;continue e}}if(l=!1,p){A>p?n.push(f7(p)+"-"+f7(A)):A===p&&n.push(f7(A)),p="",o++;continue}if(t.startsWith("-]",o+1)){n.push(f7(A+"-")),o+=2;continue}if(t.startsWith("-",o+1)){p=A,o+=2;continue}n.push(f7(A)),o++}if(f<o)return["",!1,0,!1];if(!n.length&&!i.length)return["$.",!1,t.length-r,!0];if(i.length===0&&n.length===1&&/^\\?.$/.test(n[0])&&!u){let A=n[0].length===2?n[0].slice(-1):n[0];return[Rjt(A),!1,f-r,!1]}let m="["+(u?"^":"")+EYe(n)+"]",h="["+(u?"":"^")+EYe(i)+"]";return[n.length&&i.length?"("+m+"|"+h+")":n.length?m:h,c,f-r,!0]},"parseClass");d();var qT=s((t,{windowsPathsNoEscape:e=!1}={})=>e?t.replace(/\[([^\/\\])\]/g,"$1"):t.replace(/((?!\\).|^)\[([^\/\\])\]/g,"$1$2").replace(/\\([^\/])/g,"$1"),"unescape");var kjt=new Set(["!","?","+","*","@"]),IYe=s(t=>kjt.has(t),"isExtglobType"),Pjt="(?!(?:^|/)\\.\\.?(?:$|/))",DX="(?!\\.)",Djt=new Set(["[","."]),Bjt=new Set(["..","."]),Njt=new Set("().*{}+?[]^$\\!"),Mjt=s(t=>t.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),"regExpEscape"),jve="[^/]",TYe=jve+"*?",wYe=jve+"+?",A3=class t{static{s(this,"AST")}type;#e;#t;#i=!1;#n=[];#r;#o;#s;#a=!1;#c;#l;#d=!1;constructor(e,r,n={}){this.type=e,e&&(this.#t=!0),this.#r=r,this.#e=this.#r?this.#r.#e:this,this.#c=this.#e===this?n:this.#e.#c,this.#s=this.#e===this?[]:this.#e.#s,e==="!"&&!this.#e.#a&&this.#s.push(this),this.#o=this.#r?this.#r.#n.length:0}get hasMagic(){if(this.#t!==void 0)return this.#t;for(let e of this.#n)if(typeof e!="string"&&(e.type||e.hasMagic))return this.#t=!0;return this.#t}toString(){return this.#l!==void 0?this.#l:this.type?this.#l=this.type+"("+this.#n.map(e=>String(e)).join("|")+")":this.#l=this.#n.map(e=>String(e)).join("")}#p(){if(this!==this.#e)throw new Error("should only call on root");if(this.#a)return this;this.toString(),this.#a=!0;let e;for(;e=this.#s.pop();){if(e.type!=="!")continue;let r=e,n=r.#r;for(;n;){for(let i=r.#o+1;!n.type&&i<n.#n.length;i++)for(let o of e.#n){if(typeof o=="string")throw new Error("string part in extglob AST??");o.copyIn(n.#n[i])}r=n,n=r.#r}}return this}push(...e){for(let r of e)if(r!==""){if(typeof r!="string"&&!(r instanceof t&&r.#r===this))throw new Error("invalid part: "+r);this.#n.push(r)}}toJSON(){let e=this.type===null?this.#n.slice().map(r=>typeof r=="string"?r:r.toJSON()):[this.type,...this.#n.map(r=>r.toJSON())];return this.isStart()&&!this.type&&e.unshift([]),this.isEnd()&&(this===this.#e||this.#e.#a&&this.#r?.type==="!")&&e.push({}),e}isStart(){if(this.#e===this)return!0;if(!this.#r?.isStart())return!1;if(this.#o===0)return!0;let e=this.#r;for(let r=0;r<this.#o;r++){let n=e.#n[r];if(!(n instanceof t&&n.type==="!"))return!1}return!0}isEnd(){if(this.#e===this||this.#r?.type==="!")return!0;if(!this.#r?.isEnd())return!1;if(!this.type)return this.#r?.isEnd();let e=this.#r?this.#r.#n.length:0;return this.#o===e-1}copyIn(e){typeof e=="string"?this.push(e):this.push(e.clone(this))}clone(e){let r=new t(this.type,e);for(let n of this.#n)r.copyIn(n);return r}static#u(e,r,n,i){let o=!1,a=!1,c=-1,l=!1;if(r.type===null){let h=n,g="";for(;h<e.length;){let A=e.charAt(h++);if(o||A==="\\"){o=!o,g+=A;continue}if(a){h===c+1?(A==="^"||A==="!")&&(l=!0):A==="]"&&!(h===c+2&&l)&&(a=!1),g+=A;continue}else if(A==="["){a=!0,c=h,l=!1,g+=A;continue}if(!i.noext&&IYe(A)&&e.charAt(h)==="("){r.push(g),g="";let y=new t(A,r);h=t.#u(e,y,h,i),r.push(y);continue}g+=A}return r.push(g),h}let u=n+1,f=new t(null,r),p=[],m="";for(;u<e.length;){let h=e.charAt(u++);if(o||h==="\\"){o=!o,m+=h;continue}if(a){u===c+1?(h==="^"||h==="!")&&(l=!0):h==="]"&&!(u===c+2&&l)&&(a=!1),m+=h;continue}else if(h==="["){a=!0,c=u,l=!1,m+=h;continue}if(IYe(h)&&e.charAt(u)==="("){f.push(m),m="";let g=new t(h,f);f.push(g),u=t.#u(e,g,u,i);continue}if(h==="|"){f.push(m),m="",p.push(f),f=new t(null,r);continue}if(h===")")return m===""&&r.#n.length===0&&(r.#d=!0),f.push(m),m="",r.push(...p,f),u;m+=h}return r.type=null,r.#t=void 0,r.#n=[e.substring(n-1)],u}static fromGlob(e,r={}){let n=new t(null,void 0,r);return t.#u(e,n,0,r),n}toMMPattern(){if(this!==this.#e)return this.#e.toMMPattern();let e=this.toString(),[r,n,i,o]=this.toRegExpSource();if(!(i||this.#t||this.#c.nocase&&!this.#c.nocaseMagicOnly&&e.toUpperCase()!==e.toLowerCase()))return n;let c=(this.#c.nocase?"i":"")+(o?"u":"");return Object.assign(new RegExp(`^${r}$`,c),{_src:r,_glob:e})}get options(){return this.#c}toRegExpSource(e){let r=e??!!this.#c.dot;if(this.#e===this&&this.#p(),!this.type){let l=this.isStart()&&this.isEnd(),u=this.#n.map(h=>{let[g,A,y,E]=typeof h=="string"?t.#m(h,this.#t,l):h.toRegExpSource(e);return this.#t=this.#t||y,this.#i=this.#i||E,g}).join(""),f="";if(this.isStart()&&typeof this.#n[0]=="string"&&!(this.#n.length===1&&Bjt.has(this.#n[0]))){let g=Djt,A=r&&g.has(u.charAt(0))||u.startsWith("\\.")&&g.has(u.charAt(2))||u.startsWith("\\.\\.")&&g.has(u.charAt(4)),y=!r&&!e&&g.has(u.charAt(0));f=A?Pjt:y?DX:""}let p="";return this.isEnd()&&this.#e.#a&&this.#r?.type==="!"&&(p="(?:$|\\/)"),[f+u+p,qT(u),this.#t=!!this.#t,this.#i]}let n=this.type==="*"||this.type==="+",i=this.type==="!"?"(?:(?!(?:":"(?:",o=this.#f(r);if(this.isStart()&&this.isEnd()&&!o&&this.type!=="!"){let l=this.toString();return this.#n=[l],this.type=null,this.#t=void 0,[l,qT(this.toString()),!1,!1]}let a=!n||e||r||!DX?"":this.#f(!0);a===o&&(a=""),a&&(o=`(?:${o})(?:${a})*?`);let c="";if(this.type==="!"&&this.#d)c=(this.isStart()&&!r?DX:"")+wYe;else{let l=this.type==="!"?"))"+(this.isStart()&&!r&&!e?DX:"")+TYe+")":this.type==="@"?")":this.type==="?"?")?":this.type==="+"&&a?")":this.type==="*"&&a?")?":`)${this.type}`;c=i+o+l}return[c,qT(o),this.#t=!!this.#t,this.#i]}#f(e){return this.#n.map(r=>{if(typeof r=="string")throw new Error("string type in extglob ast??");let[n,i,o,a]=r.toRegExpSource(e);return this.#i=this.#i||a,n}).filter(r=>!(this.isStart()&&this.isEnd())||!!r).join("|")}static#m(e,r,n=!1){let i=!1,o="",a=!1;for(let c=0;c<e.length;c++){let l=e.charAt(c);if(i){i=!1,o+=(Njt.has(l)?"\\":"")+l;continue}if(l==="\\"){c===e.length-1?o+="\\\\":i=!0;continue}if(l==="["){let[u,f,p,m]=bYe(e,c);if(p){o+=u,a=a||f,c+=p-1,r=r||m;continue}}if(l==="*"){n&&e==="*"?o+=wYe:o+=TYe,r=!0;continue}if(l==="?"){o+=jve,r=!0;continue}o+=Mjt(l)}return[o,qT(e),!!r,a]}};d();var Gve=s((t,{windowsPathsNoEscape:e=!1}={})=>e?t.replace(/[?*()[\]]/g,"[$&]"):t.replace(/[?*()[\]\\]/g,"\\$&"),"escape");var qc=s((t,e,r={})=>(d7(e),!r.nocomment&&e.charAt(0)==="#"?!1:new y3(e,r).match(t)),"minimatch"),Ljt=/^\*+([^+@!?\*\[\(]*)$/,Fjt=s(t=>e=>!e.startsWith(".")&&e.endsWith(t),"starDotExtTest"),Ojt=s(t=>e=>e.endsWith(t),"starDotExtTestDot"),Qjt=s(t=>(t=t.toLowerCase(),e=>!e.startsWith(".")&&e.toLowerCase().endsWith(t)),"starDotExtTestNocase"),Ujt=s(t=>(t=t.toLowerCase(),e=>e.toLowerCase().endsWith(t)),"starDotExtTestNocaseDot"),qjt=/^\*+\.\*+$/,Hjt=s(t=>!t.startsWith(".")&&t.includes("."),"starDotStarTest"),$jt=s(t=>t!=="."&&t!==".."&&t.includes("."),"starDotStarTestDot"),Wjt=/^\.\*+$/,jjt=s(t=>t!=="."&&t!==".."&&t.startsWith("."),"dotStarTest"),Gjt=/^\*+$/,Vjt=s(t=>t.length!==0&&!t.startsWith("."),"starTest"),zjt=s(t=>t.length!==0&&t!=="."&&t!=="..","starTestDot"),Kjt=/^\?+([^+@!?\*\[\(]*)?$/,Yjt=s(([t,e=""])=>{let r=kYe([t]);return e?(e=e.toLowerCase(),n=>r(n)&&n.toLowerCase().endsWith(e)):r},"qmarksTestNocase"),Jjt=s(([t,e=""])=>{let r=PYe([t]);return e?(e=e.toLowerCase(),n=>r(n)&&n.toLowerCase().endsWith(e)):r},"qmarksTestNocaseDot"),Xjt=s(([t,e=""])=>{let r=PYe([t]);return e?n=>r(n)&&n.endsWith(e):r},"qmarksTestDot"),Zjt=s(([t,e=""])=>{let r=kYe([t]);return e?n=>r(n)&&n.endsWith(e):r},"qmarksTest"),kYe=s(([t])=>{let e=t.length;return r=>r.length===e&&!r.startsWith(".")},"qmarksTestNoExt"),PYe=s(([t])=>{let e=t.length;return r=>r.length===e&&r!=="."&&r!==".."},"qmarksTestNoExtDot"),DYe=typeof process=="object"&&process?typeof process.env=="object"&&process.env&&process.env.__MINIMATCH_TESTING_PLATFORM__||process.platform:"posix",SYe={win32:{sep:"\\"},posix:{sep:"/"}},eGt=DYe==="win32"?SYe.win32.sep:SYe.posix.sep;qc.sep=eGt;var kh=Symbol("globstar **");qc.GLOBSTAR=kh;var tGt="[^/]",rGt=tGt+"*?",nGt="(?:(?!(?:\\/|^)(?:\\.{1,2})($|\\/)).)*?",iGt="(?:(?!(?:\\/|^)\\.).)*?",oGt=s((t,e={})=>r=>qc(r,t,e),"filter");qc.filter=oGt;var Rh=s((t,e={})=>Object.assign({},t,e),"ext"),sGt=s(t=>{if(!t||typeof t!="object"||!Object.keys(t).length)return qc;let e=qc;return Object.assign(s((n,i,o={})=>e(n,i,Rh(t,o)),"m"),{Minimatch:class extends e.Minimatch{static{s(this,"Minimatch")}constructor(i,o={}){super(i,Rh(t,o))}static defaults(i){return e.defaults(Rh(t,i)).Minimatch}},AST:class extends e.AST{static{s(this,"AST")}constructor(i,o,a={}){super(i,o,Rh(t,a))}static fromGlob(i,o={}){return e.AST.fromGlob(i,Rh(t,o))}},unescape:s((n,i={})=>e.unescape(n,Rh(t,i)),"unescape"),escape:s((n,i={})=>e.escape(n,Rh(t,i)),"escape"),filter:s((n,i={})=>e.filter(n,Rh(t,i)),"filter"),defaults:s(n=>e.defaults(Rh(t,n)),"defaults"),makeRe:s((n,i={})=>e.makeRe(n,Rh(t,i)),"makeRe"),braceExpand:s((n,i={})=>e.braceExpand(n,Rh(t,i)),"braceExpand"),match:s((n,i,o={})=>e.match(n,i,Rh(t,o)),"match"),sep:e.sep,GLOBSTAR:kh})},"defaults");qc.defaults=sGt;var BYe=s((t,e={})=>(d7(t),e.nobrace||!/\{(?:(?!\{).)*\}/.test(t)?[t]:(0,RYe.default)(t)),"braceExpand");qc.braceExpand=BYe;var aGt=s((t,e={})=>new y3(t,e).makeRe(),"makeRe");qc.makeRe=aGt;var cGt=s((t,e,r={})=>{let n=new y3(e,r);return t=t.filter(i=>n.match(i)),n.options.nonull&&!t.length&&t.push(e),t},"match");qc.match=cGt;var _Ye=/[?*]|[+@!]\(.*?\)|\[|\]/,lGt=s(t=>t.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),"regExpEscape"),y3=class{static{s(this,"Minimatch")}options;set;pattern;windowsPathsNoEscape;nonegate;negate;comment;empty;preserveMultipleSlashes;partial;globSet;globParts;nocase;isWindows;platform;windowsNoMagicRoot;regexp;constructor(e,r={}){d7(e),r=r||{},this.options=r,this.pattern=e,this.platform=r.platform||DYe,this.isWindows=this.platform==="win32",this.windowsPathsNoEscape=!!r.windowsPathsNoEscape||r.allowWindowsEscape===!1,this.windowsPathsNoEscape&&(this.pattern=this.pattern.replace(/\\/g,"/")),this.preserveMultipleSlashes=!!r.preserveMultipleSlashes,this.regexp=null,this.negate=!1,this.nonegate=!!r.nonegate,this.comment=!1,this.empty=!1,this.partial=!!r.partial,this.nocase=!!this.options.nocase,this.windowsNoMagicRoot=r.windowsNoMagicRoot!==void 0?r.windowsNoMagicRoot:!!(this.isWindows&&this.nocase),this.globSet=[],this.globParts=[],this.set=[],this.make()}hasMagic(){if(this.options.magicalBraces&&this.set.length>1)return!0;for(let e of this.set)for(let r of e)if(typeof r!="string")return!0;return!1}debug(...e){}make(){let e=this.pattern,r=this.options;if(!r.nocomment&&e.charAt(0)==="#"){this.comment=!0;return}if(!e){this.empty=!0;return}this.parseNegate(),this.globSet=[...new Set(this.braceExpand())],r.debug&&(this.debug=(...o)=>console.error(...o)),this.debug(this.pattern,this.globSet);let n=this.globSet.map(o=>this.slashSplit(o));this.globParts=this.preprocess(n),this.debug(this.pattern,this.globParts);let i=this.globParts.map((o,a,c)=>{if(this.isWindows&&this.windowsNoMagicRoot){let l=o[0]===""&&o[1]===""&&(o[2]==="?"||!_Ye.test(o[2]))&&!_Ye.test(o[3]),u=/^[a-z]:/i.test(o[0]);if(l)return[...o.slice(0,4),...o.slice(4).map(f=>this.parse(f))];if(u)return[o[0],...o.slice(1).map(f=>this.parse(f))]}return o.map(l=>this.parse(l))});if(this.debug(this.pattern,i),this.set=i.filter(o=>o.indexOf(!1)===-1),this.isWindows)for(let o=0;o<this.set.length;o++){let a=this.set[o];a[0]===""&&a[1]===""&&this.globParts[o][2]==="?"&&typeof a[3]=="string"&&/^[a-z]:$/i.test(a[3])&&(a[2]="?")}this.debug(this.pattern,this.set)}preprocess(e){if(this.options.noglobstar)for(let n=0;n<e.length;n++)for(let i=0;i<e[n].length;i++)e[n][i]==="**"&&(e[n][i]="*");let{optimizationLevel:r=1}=this.options;return r>=2?(e=this.firstPhasePreProcess(e),e=this.secondPhasePreProcess(e)):r>=1?e=this.levelOneOptimize(e):e=this.adjascentGlobstarOptimize(e),e}adjascentGlobstarOptimize(e){return e.map(r=>{let n=-1;for(;(n=r.indexOf("**",n+1))!==-1;){let i=n;for(;r[i+1]==="**";)i++;i!==n&&r.splice(n,i-n)}return r})}levelOneOptimize(e){return e.map(r=>(r=r.reduce((n,i)=>{let o=n[n.length-1];return i==="**"&&o==="**"?n:i===".."&&o&&o!==".."&&o!=="."&&o!=="**"?(n.pop(),n):(n.push(i),n)},[]),r.length===0?[""]:r))}levelTwoFileOptimize(e){Array.isArray(e)||(e=this.slashSplit(e));let r=!1;do{if(r=!1,!this.preserveMultipleSlashes){for(let i=1;i<e.length-1;i++){let o=e[i];i===1&&o===""&&e[0]===""||(o==="."||o==="")&&(r=!0,e.splice(i,1),i--)}e[0]==="."&&e.length===2&&(e[1]==="."||e[1]==="")&&(r=!0,e.pop())}let n=0;for(;(n=e.indexOf("..",n+1))!==-1;){let i=e[n-1];i&&i!=="."&&i!==".."&&i!=="**"&&(r=!0,e.splice(n-1,2),n-=2)}}while(r);return e.length===0?[""]:e}firstPhasePreProcess(e){let r=!1;do{r=!1;for(let n of e){let i=-1;for(;(i=n.indexOf("**",i+1))!==-1;){let a=i;for(;n[a+1]==="**";)a++;a>i&&n.splice(i+1,a-i);let c=n[i+1],l=n[i+2],u=n[i+3];if(c!==".."||!l||l==="."||l===".."||!u||u==="."||u==="..")continue;r=!0,n.splice(i,1);let f=n.slice(0);f[i]="**",e.push(f),i--}if(!this.preserveMultipleSlashes){for(let a=1;a<n.length-1;a++){let c=n[a];a===1&&c===""&&n[0]===""||(c==="."||c==="")&&(r=!0,n.splice(a,1),a--)}n[0]==="."&&n.length===2&&(n[1]==="."||n[1]==="")&&(r=!0,n.pop())}let o=0;for(;(o=n.indexOf("..",o+1))!==-1;){let a=n[o-1];if(a&&a!=="."&&a!==".."&&a!=="**"){r=!0;let l=o===1&&n[o+1]==="**"?["."]:[];n.splice(o-1,2,...l),n.length===0&&n.push(""),o-=2}}}}while(r);return e}secondPhasePreProcess(e){for(let r=0;r<e.length-1;r++)for(let n=r+1;n<e.length;n++){let i=this.partsMatch(e[r],e[n],!this.preserveMultipleSlashes);if(i){e[r]=[],e[n]=i;break}}return e.filter(r=>r.length)}partsMatch(e,r,n=!1){let i=0,o=0,a=[],c="";for(;i<e.length&&o<r.length;)if(e[i]===r[o])a.push(c==="b"?r[o]:e[i]),i++,o++;else if(n&&e[i]==="**"&&r[o]===e[i+1])a.push(e[i]),i++;else if(n&&r[o]==="**"&&e[i]===r[o+1])a.push(r[o]),o++;else if(e[i]==="*"&&r[o]&&(this.options.dot||!r[o].startsWith("."))&&r[o]!=="**"){if(c==="b")return!1;c="a",a.push(e[i]),i++,o++}else if(r[o]==="*"&&e[i]&&(this.options.dot||!e[i].startsWith("."))&&e[i]!=="**"){if(c==="a")return!1;c="b",a.push(r[o]),i++,o++}else return!1;return e.length===r.length&&a}parseNegate(){if(this.nonegate)return;let e=this.pattern,r=!1,n=0;for(let i=0;i<e.length&&e.charAt(i)==="!";i++)r=!r,n++;n&&(this.pattern=e.slice(n)),this.negate=r}matchOne(e,r,n=!1){let i=this.options;if(this.isWindows){let A=typeof e[0]=="string"&&/^[a-z]:$/i.test(e[0]),y=!A&&e[0]===""&&e[1]===""&&e[2]==="?"&&/^[a-z]:$/i.test(e[3]),E=typeof r[0]=="string"&&/^[a-z]:$/i.test(r[0]),b=!E&&r[0]===""&&r[1]===""&&r[2]==="?"&&typeof r[3]=="string"&&/^[a-z]:$/i.test(r[3]),S=y?3:A?0:void 0,R=b?3:E?0:void 0;if(typeof S=="number"&&typeof R=="number"){let[B,L]=[e[S],r[R]];B.toLowerCase()===L.toLowerCase()&&(r[R]=B,R>S?r=r.slice(R):S>R&&(e=e.slice(S)))}}let{optimizationLevel:o=1}=this.options;o>=2&&(e=this.levelTwoFileOptimize(e)),this.debug("matchOne",this,{file:e,pattern:r}),this.debug("matchOne",e.length,r.length);for(var a=0,c=0,l=e.length,u=r.length;a<l&&c<u;a++,c++){this.debug("matchOne loop");var f=r[c],p=e[a];if(this.debug(r,f,p),f===!1)return!1;if(f===kh){this.debug("GLOBSTAR",[r,f,p]);var m=a,h=c+1;if(h===u){for(this.debug("** at the end");a<l;a++)if(e[a]==="."||e[a]===".."||!i.dot&&e[a].charAt(0)===".")return!1;return!0}for(;m<l;){var g=e[m];if(this.debug(`
globstar while`,e,m,r,h,g),this.matchOne(e.slice(m),r.slice(h),n))return this.debug("globstar found match!",m,l,g),!0;if(g==="."||g===".."||!i.dot&&g.charAt(0)==="."){this.debug("dot detected!",e,m,r,h);break}this.debug("globstar swallow a segment, and continue"),m++}return!!(n&&(this.debug(`
>>> no match, partial?`,e,m,r,h),m===l))}let A;if(typeof f=="string"?(A=p===f,this.debug("string match",f,p,A)):(A=f.test(p),this.debug("pattern match",f,p,A)),!A)return!1}if(a===l&&c===u)return!0;if(a===l)return n;if(c===u)return a===l-1&&e[a]==="";throw new Error("wtf?")}braceExpand(){return BYe(this.pattern,this.options)}parse(e){d7(e);let r=this.options;if(e==="**")return kh;if(e==="")return"";let n,i=null;(n=e.match(Gjt))?i=r.dot?zjt:Vjt:(n=e.match(Ljt))?i=(r.nocase?r.dot?Ujt:Qjt:r.dot?Ojt:Fjt)(n[1]):(n=e.match(Kjt))?i=(r.nocase?r.dot?Jjt:Yjt:r.dot?Xjt:Zjt)(n):(n=e.match(qjt))?i=r.dot?$jt:Hjt:(n=e.match(Wjt))&&(i=jjt);let o=A3.fromGlob(e,this.options).toMMPattern();return i&&typeof o=="object"&&Reflect.defineProperty(o,"test",{value:i}),o}makeRe(){if(this.regexp||this.regexp===!1)return this.regexp;let e=this.set;if(!e.length)return this.regexp=!1,this.regexp;let r=this.options,n=r.noglobstar?rGt:r.dot?nGt:iGt,i=new Set(r.nocase?["i"]:[]),o=e.map(l=>{let u=l.map(f=>{if(f instanceof RegExp)for(let p of f.flags.split(""))i.add(p);return typeof f=="string"?lGt(f):f===kh?kh:f._src});return u.forEach((f,p)=>{let m=u[p+1],h=u[p-1];f!==kh||h===kh||(h===void 0?m!==void 0&&m!==kh?u[p+1]="(?:\\/|"+n+"\\/)?"+m:u[p]=n:m===void 0?u[p-1]=h+"(?:\\/|"+n+")?":m!==kh&&(u[p-1]=h+"(?:\\/|\\/"+n+"\\/)"+m,u[p+1]=kh))}),u.filter(f=>f!==kh).join("/")}).join("|"),[a,c]=e.length>1?["(?:",")"]:["",""];o="^"+a+o+c+"$",this.negate&&(o="^(?!"+o+").+$");try{this.regexp=new RegExp(o,[...i].join(""))}catch{this.regexp=!1}return this.regexp}slashSplit(e){return this.preserveMultipleSlashes?e.split("/"):this.isWindows&&/^\/\/[^\/]+/.test(e)?["",...e.split(/\/+/)]:e.split(/\/+/)}match(e,r=this.partial){if(this.debug("match",e,this.pattern),this.comment)return!1;if(this.empty)return e==="";if(e==="/"&&r)return!0;let n=this.options;this.isWindows&&(e=e.split("\\").join("/"));let i=this.slashSplit(e);this.debug(this.pattern,"split",i);let o=this.set;this.debug(this.pattern,"set",o);let a=i[i.length-1];if(!a)for(let c=i.length-2;!a&&c>=0;c--)a=i[c];for(let c=0;c<o.length;c++){let l=o[c],u=i;if(n.matchBase&&l.length===1&&(u=[a]),this.matchOne(u,l,r))return n.flipNegate?!0:!this.negate}return n.flipNegate?!1:this.negate}static defaults(e){return qc.defaults(e).Minimatch}};qc.AST=A3;qc.Minimatch=y3;qc.escape=Gve;qc.unescape=qT;var Vve="contentExclusion",BX=class extends TX{static{s(this,"CopilotContentExclusion")}#e;#t=new Sr(1e4);#i=new Sr(200);constructor(e){super(),this.#e=e}async evaluate(e,r){try{e=H_(e).toString();let n=await this.getGitRepo({uri:e}),i=await this.#n(n?.url??OR.all);if(!i)return IX;let o=n?.baseFolder?.uri??"file://",a=this.evaluateFilePathRules(e,o,i);if(a.isBlocked)return a;let c=this.evaluateTextBasedRules(e,i,r);if(c.isBlocked)return c}catch(n){return UT.exception(this.#e,n,`${Vve}.evaluate`),nYe}return c7}evaluateFilePathRules(e,r,n){let i=e;if(this.#t.has(i))return this.#t.get(i);let o=c7,a,c=Yfe(e.replace(r,""));e:for(let l of n)for(let u of l.paths)if(qc(c,u,{nocase:!0,matchBase:!0,nonegate:!0,dot:!0})){o=zve(l,"FILE_BLOCKED_PATH"),a=u;break e}return UT.debug(this.#e,`Evaluated path-based exclusion rules for <${e}>`,{result:o,baseUri:r,fileName:c,matchingPattern:a}),this.#t.set(i,o),o}evaluateTextBasedRules(e,r,n){let i=r.filter(c=>c.ifAnyMatch),o=r.filter(c=>c.ifNoneMatch);if(!n||i.length===0&&o.length===0)return c7;let a=this.evaluateFileContent(i,o,n);return UT.debug(this.#e,`Evaluated text-based exclusion rules for <${e}>`,{result:a}),a}evaluateFileContent(e,r,n){for(let i of e)if(i.ifAnyMatch&&i.ifAnyMatch.length>0&&i.ifAnyMatch.map(a=>NYe(a)).some(a=>a.test(n)))return zve(i,"FILE_BLOCKED_TEXT_BASED");for(let i of r)if(i.ifNoneMatch&&i.ifNoneMatch.length>0&&!i.ifNoneMatch.map(a=>NYe(a)).some(a=>a.test(n)))return zve(i,"FILE_BLOCKED_TEXT_BASED");return c7}async refresh(){try{let e=[...this.#i.keys()];this.reset(),await Promise.all(e.map(r=>this.#o(r)))}catch(e){Ka(this.#e,e,`${Vve}.refresh`)}}reset(){this.#i.clear(),this.#t.clear()}async#n(e){if(this.#r?.length)return this.#r;let r=await this.#o(e.toLowerCase());if(r.length!==0)return r}#r;setTestingRules(e){this.#r=e}#o=cYe(async e=>{let r=await this.#e.get(ar).getGitHubSession();if(!r)throw new Sa("No token found");let n=r.devOverride?.contentRestrictionsUrl??"copilot_internal/content_exclusion",i=new URL(n,r.apiUrl),o=e.includes(OR.all);e.filter(u=>u!==OR.all).length>0&&i.searchParams.set("repos",e.filter(u=>u!==OR.all).join(",")),i.searchParams.set("scope",o?OR.all:OR.repo);let c=await Qm(this.#e,r,i.href),l=await c.json();if(!c.ok){if(c.status===404)return Array.from(e,()=>[]);throw this.#s("fetch.error",{message:l.message}),new iC(c)}return this.#s("fetch.success"),UR(pGt,l).map(u=>u.rules)},this.#i);async getGitRepo(e){let n=await this.#e.get(PA).getRepo(wd(e));if(!n||!n?.remote)return;let i=n.remote.getUrlForApi();if(i)return{baseFolder:n.baseFolder,url:i}}#s(e,r,n){Bt(this.#e,`${Vve}.${e}`,Vr.createAndMarkAsIssued(r,n))}};function NYe(t){if(!t.startsWith("/")&&!t.endsWith("/"))return new RegExp(t);let e=t.slice(1,t.lastIndexOf("/")),r=t.slice(t.lastIndexOf("/")+1);return new RegExp(e,r)}s(NYe,"stringToRegex");function zve(t,e){return{isBlocked:!0,message:`Your ${t.source.type.toLowerCase()} '${t.source.name}' has disabled Copilot for this file`,reason:e}}s(zve,"fileBlockedEvaluationResult");var uGt=x.Object({name:x.String(),type:x.String()}),dGt=x.Object({paths:x.Array(x.String()),ifNoneMatch:x.Optional(x.Array(x.String())),ifAnyMatch:x.Optional(x.Array(x.String())),source:uGt}),Kve=x.Array(dGt),fGt=x.Object({rules:Kve,last_updated_at:x.String(),scope:x.String()}),pGt=x.Array(fGt);var dl=class{constructor(e){this.ctx=e;this.#e=!1;this.#t=new BX(this.ctx);this.evaluateResultCache=new Map;this.onDidChangeActiveTextEditor=s(async e=>{if(!this.#e)return;if(!e.document){this.updateStatusIcon(!1);return}let r=await this.ctx.get(dr).getTextDocumentValidation(e.document),n=r.status==="invalid",i=r.status==="invalid"?r.reason:void 0;this.updateStatusIcon(n,i)},"onDidChangeActiveTextEditor");let r=Xl(this.ctx,this.onDidChangeActiveTextEditor,"Content exclusions focus change");this.ctx.get(dr).onDidFocusTextDocument(r),_a(this.ctx,n=>{this.#e=n.envelope.copilotignore_enabled??!1,this.evaluateResultCache.clear(),this.#t.refresh()})}static{s(this,"CopilotContentExclusionManager")}#e;#t;get enabled(){return this.#e}async evaluate(e,r,n){if(!this.#e)return{isBlocked:!1};let i=[],o=s(async(l,u)=>{let f=performance.now(),p=await u.evaluate(e,r),m=performance.now();return i.push({key:l,result:p,elapsedMs:Math.round(m-f)}),p},"track"),c=(await Promise.all([o("contentExclusion.evaluate",this.#t)])).find(l=>l?.isBlocked)??{isBlocked:!1};try{for(let l of i)this.#i(l.key,e,l.result,l.elapsedMs)}catch(l){UT.error(this.ctx,"Error tracking telemetry",l)}return n==="UPDATE"&&this.updateStatusIcon(c.isBlocked,c.message),c}updateStatusIcon(e,r){this.#e&&(e?this.ctx.get(qo).setInactive(r??"Copilot is disabled"):this.ctx.get(qo).clearInactive())}#i(e,r,n,i){let o=r+e;if(this.evaluateResultCache.get(o)===n.reason)return!1;if(this.evaluateResultCache.set(o,n.reason??"UNKNOWN"),n.reason===IX.reason)return UT.debug(this.ctx,`[${e}] No matching policy for this repository. uri: ${r}`),!1;let c={isBlocked:n.isBlocked?"true":"false",reason:n.reason??"UNKNOWN"},l={contentExclusionEvalMs:i};return Bt(this.ctx,e,Vr.createAndMarkAsIssued(c,l)),Bt(this.ctx,e,Vr.createAndMarkAsIssued({...c,path:r},l),1),UT.debug(this.ctx,`[${e}] ${r}`,n),!0}setTestingRules(e){this.#t.setTestingRules(e)}set __contentExclusions(e){this.#t=e}get __contentExclusions(){return this.#t}};async function wx(t,e,r){let n=await t.get(dl).evaluate(e.uri,r);return n.isBlocked?{status:"invalid",reason:n.message??"Document is blocked by repository policy"}:{status:"valid"}}s(wx,"isDocumentValid");var dr=class{constructor(e){this.ctx=e}static{s(this,"TextDocumentManager")}async textDocuments(){let e=this.getTextDocumentsUnsafe(),r=[];for(let n of e)(await wx(this.ctx,n,n.getText())).status==="valid"&&r.push(n);return r}getTextDocumentUnsafe(e){let r=Pl(e.uri);return this.getTextDocumentsUnsafe().find(n=>n.uri===r)}async getTextDocument(e){return this.getTextDocumentWithValidation(e).then(r=>{if(r.status==="valid")return r.document})}validateTextDocument(e,r){return wx(this.ctx,e,r)}async getTextDocumentValidation(e){try{let r=this.getTextDocumentUnsafe(e)?.getText()??await this.readTextDocumentFromDisk(e.uri);return r===void 0?this.notFoundResult(e):this.validateTextDocument(e,r)}catch{return this.notFoundResult(e)}}async getTextDocumentWithValidation(e){let r=this.getTextDocumentUnsafe(e);if(!r)return this.notFoundResult(e);let n=await this.validateTextDocument(e,r.getText());return n.status==="valid"?{status:"valid",document:r}:n}notFoundResult({uri:e}){return{status:"notfound",message:`Document for URI could not be found: ${e}`}}async readTextDocumentFromDisk(e){try{if((await this.ctx.get(Fi).stat(e)).size>5*1024*1024)return}catch{return}return await this.ctx.get(Fi).readFileString(e)}getWorkspaceFolder(e){let r=Pl(e.uri);return this.getWorkspaceFolders().find(n=>r.startsWith(Pl(n.uri)))}getRelativePath(e){if(e.uri.startsWith("untitled:"))return;let r=Pl(e.uri);for(let n of this.getWorkspaceFolders()){let i=Pl(n.uri).replace(/[#?].*/,"").replace(/\/?$/,"/");if(r.startsWith(i))return r.slice(i.length)}return Pi(r)}};function ca(t){switch(t.status){case"valid":return t.document.getText().trim().length===0?"empty":"included";case"invalid":return"blocked";case"notfound":return"notfound"}}s(ca,"statusFromTextDocumentResult");var En=class{constructor(e){this.ctx=e}static{s(this,"FileReader")}getRelativePath(e){return this.ctx.get(dr).getRelativePath(e)??Pi(e.uri)}getOrReadTextDocument(e){return this.readFile(e.uri)}getOrReadTextDocumentWithFakeClientProperties(e){return this.readFile(e.uri)}async readFile(e){let n=await this.ctx.get(dr).getTextDocumentWithValidation({uri:e});if(n.status!=="notfound")return n;try{if(await this.getFileSizeMB(e)>1)return{status:"notfound",message:"File too large"};let o=await this.doReadFile(e),a=await wx(this.ctx,{uri:e},o);return a.status==="valid"?{status:"valid",document:Tx.create(e,"UNKNOWN",-1,o)}:a}catch{return{status:"notfound",message:"File not found"}}}async doReadFile(e){return await this.ctx.get(Fi).readFileString(e)}async getFileSizeMB(e){return(await this.ctx.get(Fi).stat(e)).size/1024/1024}};d();d();var Ph=class{constructor(){this.resolve=s(()=>{},"resolve");this.reject=s(()=>{},"reject");this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}static{s(this,"Deferred")}};function WC(t,e=void 0){return new Promise(r=>setTimeout(()=>r(e),t))}s(WC,"delay");d();var Yve=class{constructor(){this.observers=new Set}static{s(this,"Subject")}subscribe(e){return this.observers.add(e),()=>this.observers.delete(e)}next(e){for(let r of this.observers)r.next(e)}error(e){for(let r of this.observers)r.error?.(e)}complete(){for(let e of this.observers)e.complete?.()}},NX=class extends Yve{static{s(this,"ReplaySubject")}subscribe(e){let r=super.subscribe(e);return this._value!==void 0&&e.next(this._value),r}next(e){this._value=e,super.next(e)}};var _p=class{constructor(e){this.ctx=e;this.#e=new dt("AsyncCompletionManager");this.requests=new Sr(100);this.mostRecentRequestId=""}static{s(this,"AsyncCompletionManager")}#e;clear(){this.requests.clear()}shouldWaitForAsyncCompletions(e,r){for(let[n,i]of this.requests)if(Jve(e,r,i))return!0;return!1}updateCompletion(e,r){let n=this.requests.get(e);n!==void 0&&(n.partialCompletionText=r,n.subject.next(n))}queueCompletionRequest(e,r,n,i,o){this.#e.debug(this.ctx,`[${e}] Queueing async completion request:`,r.substring(r.lastIndexOf(`
`)+1));let a=new NX;return this.requests.set(e,{state:2,cancellationTokenSource:i,headerRequestId:e,prefix:r,prompt:n,subject:a}),o.then(c=>{if(this.requests.delete(e),c.type!=="success"){this.#e.debug(this.ctx,`[${e}] Request failed with`,c.reason),a.error(c.reason);return}let l={cancellationTokenSource:i,headerRequestId:e,prefix:r,prompt:n,subject:a,choice:c.value[0],result:c,state:0,allChoicesPromise:c.value[1]};this.requests.set(e,l),a.next(l),a.complete()}).catch(c=>{this.#e.error(this.ctx,`[${e}] Request errored with`,c),this.requests.delete(e),a.error(c)})}getFirstMatchingRequestWithTimeout(e,r,n,i,o){let a=this.ctx.get(Mt).asyncCompletionsTimeout(o);return a<0?(this.#e.debug(this.ctx,`[${e}] Waiting for completions without timeout`),this.getFirstMatchingRequest(e,r,n,i)):(this.#e.debug(this.ctx,`[${e}] Waiting for completions with timeout of ${a}ms`),Promise.race([this.getFirstMatchingRequest(e,r,n,i),new Promise(c=>setTimeout(()=>c(null),a))]).then(c=>{if(c===null){this.#e.debug(this.ctx,`[${e}] Timed out waiting for completion`);return}return c}))}async getFirstMatchingRequest(e,r,n,i){i||(this.mostRecentRequestId=e);let o=!1,a=new Ph,c=new Map,l=s(f=>()=>{let p=c.get(f);p!==void 0&&(p(),c.delete(f),!o&&c.size===0&&(o=!0,this.#e.debug(this.ctx,`[${e}] No matching completions found`),a.resolve(void 0)))},"finishRequest"),u=s(f=>{if(Jve(r,n,f)){if(f.state===0){let p=r.substring(f.prefix.length),{completionText:m}=f.choice;if(!m.startsWith(p)||m.length<=p.length){l(f.headerRequestId)();return}m=m.substring(p.length),f.choice.telemetryData.measurements.foundOffset=p.length,this.#e.debug(this.ctx,`[${e}] Found completion at offset ${p.length}: ${JSON.stringify(m)}`),a.resolve([{...f.choice,completionText:m},f.allChoicesPromise]),o=!0}}else this.cancelRequest(e,f),l(f.headerRequestId)()},"next");for(let[f,p]of this.requests)Jve(r,n,p)?c.set(f,p.subject.subscribe({next:u,error:l(f),complete:l(f)})):this.cancelRequest(e,p);return a.promise.finally(()=>{for(let f of c.values())f()})}cancelRequest(e,r){e===this.mostRecentRequestId&&r.state!==0&&(this.#e.debug(this.ctx,`[${e}] Cancelling request: ${r.headerRequestId}`),r.cancellationTokenSource.cancel(),this.requests.delete(r.headerRequestId))}};function Jve(t,e,r){if(r.prompt.suffix!==e.suffix||!t.startsWith(r.prefix))return!1;let n=t.substring(r.prefix.length);return r.state===0?r.choice.completionText.startsWith(n)&&r.choice.completionText.trimEnd().length>n.length:r.partialCompletionText===void 0?!0:r.partialCompletionText.startsWith(n)}s(Jve,"isCandidate");d();d();var m7=class{constructor(e){this.maxSize=e;this.root=new p7;this.leafNodes=new Set}static{s(this,"LRURadixTrie")}set(e,r){let{node:n,remainingKey:i}=this.findClosestNode(e);if(i.length>0){for(let[o,a]of n.children)if(o.startsWith(i)){let c=o.slice(0,i.length),l=new p7;n.removeChild(o),n.addChild(c,l),l.addChild(o.slice(c.length),a),n=l,i=i.slice(c.length);break}if(i.length>0){let o=new p7;n.addChild(i,o),n=o}}n.value=r,this.leafNodes.add(n),this.leafNodes.size>this.maxSize&&this.evictLeastRecentlyUsed()}findAll(e){return this.findClosestNode(e).stack.map(({node:r,remainingKey:n})=>r.value!==void 0?{remainingKey:n,value:r.value}:void 0).filter(r=>r!==void 0)}delete(e){let{node:r,remainingKey:n}=this.findClosestNode(e);n.length>0||this.deleteNode(r)}findClosestNode(e){let r=!0,n=this.root,i=[{node:n,remainingKey:e}];for(;e.length>0&&r;){r=!1;for(let[o,a]of n.children)if(e.startsWith(o)){e=e.slice(o.length),i.unshift({node:a,remainingKey:e}),n=a,r=!0;break}}return{node:n,remainingKey:e,stack:i}}deleteNode(e){if(e.value=void 0,this.leafNodes.delete(e),e.parent===void 0||e.childCount>1)return;let{node:r,edge:n}=e.parent;if(e.childCount===1){let[o,a]=Array.from(e.children)[0];e.removeChild(o),r.removeChild(n),r.addChild(n+o,a);return}if(r.removeChild(n),r.parent===void 0)return;let i=r.parent;if(r.value===void 0&&r.childCount===1){let[o,a]=Array.from(r.children)[0],c=i.edge+o;r.removeChild(o),i.node.removeChild(i.edge),i.node.addChild(c,a)}}evictLeastRecentlyUsed(){let e=this.findLeastRecentlyUsed();e&&this.deleteNode(e)}findLeastRecentlyUsed(){let e;for(let r of this.leafNodes)(e===void 0||r.touched<e.touched)&&(e=r);return e}},p7=class{constructor(){this._children=new Map;this._touched=performance.now()}static{s(this,"LRURadixNode")}get children(){return this._children.entries()}get childCount(){return this._children.size}addChild(e,r){this._children.set(e,r),r.parent={node:this,edge:e}}removeChild(e){let r=this._children.get(e);r&&(r.parent=void 0),this._children.delete(e)}get value(){return this.touch(),this._value}set value(e){this.touch(),this._value=e}get touched(){return this._touched}touch(){this._touched=performance.now()}};var DA=class{constructor(){this.cache=new m7(100)}static{s(this,"CompletionsCache")}findAll(e,r){return this.cache.findAll(e).flatMap(({remainingKey:n,value:i})=>i.content.filter(o=>o.suffix===r&&o.choice.completionText.startsWith(n)&&o.choice.completionText.length>n.length).map(o=>({...o.choice,completionText:o.choice.completionText.slice(n.length),telemetryData:o.choice.telemetryData.extendedBy({},{foundOffset:n.length})})))}append(e,r,n){let i=this.cache.findAll(e);if(i.length>0&&i[0].remainingKey===""){let o=i[0].value.content;this.cache.set(e,{content:[...o,{suffix:r,choice:n}]})}else this.cache.set(e,{content:[{suffix:r,choice:n}]})}clear(){this.cache=new m7(100)}};d();d();d();d();var Sx={" ":1,"!":2,'"':3,"#":4,$:5,"%":6,"&":7,"'":8,"(":9,")":10,"*":11,"+":12,",":13,"-":14,".":15,"/":16,0:17,1:18,2:19,3:20,4:21,5:22,6:23,7:24,8:25,9:26,":":27,";":28,"<":29,"=":30,">":31,"?":32,"@":33,A:34,B:35,C:36,D:37,E:38,F:39,G:40,H:41,I:42,J:43,K:44,L:45,M:46,N:47,O:48,P:49,Q:50,R:51,S:52,T:53,U:54,V:55,W:56,X:57,Y:58,Z:59,"[":60,"\\":61,"]":62,"^":63,_:64,"`":65,a:66,b:67,c:68,d:69,e:70,f:71,g:72,h:73,i:74,j:75,k:76,l:77,m:78,n:79,o:80,p:81,q:82,r:83,s:84,t:85,u:86,v:87,w:88,x:89,y:90,z:91,"{":92,"|":93,"}":94,"~":95};d();function MYe(t){let e;t[13]>1e-35?t[3]>1.5000000000000002?t[8]>427.50000000000006?t[9]>13.500000000000002?t[121]>1e-35?e=-.3793786744885956:t[149]>1e-35?e=-.34717430705356905:e=-.26126834451035963:e=-.2431318366096852:t[5]>888.5000000000001?e=-.20600463586387135:e=-.2568037008471491:t[308]>1e-35?e=-.2363064824497454:t[8]>370.50000000000006?e=-.37470755210284723:e=-.321978453730494:t[3]>24.500000000000004?t[23]>1e-35?t[131]>1e-35?e=-.26259136509758885:e=-.3096719634039438:t[4]>30.500000000000004?t[9]>18.500000000000004?e=-.34254903852890883:t[2]>98.50000000000001?e=-.41585250791146294:e=-.3673574858887241:t[9]>6.500000000000001?e=-.31688079287876225:t[31]>1e-35?e=-.29110977864003823:t[308]>1e-35?e=-.3201411739040839:e=-.36874023066055506:t[8]>691.5000000000001?t[82]>1e-35?e=-.41318393149040566:t[133]>1e-35?e=-.3741272613525161:t[32]>1e-35?e=-.4112378041027121:t[227]>1e-35?e=-.37726615155719356:t[10]>3.5000000000000004?e=-.3164502293560397:e=-.2930071546509045:t[9]>13.500000000000002?e=-.277366858539218:t[308]>1e-35?t[4]>10.500000000000002?e=-.30975610686807187:t[4]>1.5000000000000002?e=-.2549142136728043:e=-.3271325650785176:t[127]>1e-35?t[0]>1937.5000000000002?e=-.2533046188098832:e=-.325520883579:e=-.331628896481776;let r;t[13]>1e-35?t[3]>1.5000000000000002?t[8]>546.5000000000001?t[9]>13.500000000000002?r=.031231253521808708:r=.05380836288014532:t[5]>423.00000000000006?t[8]>114.50000000000001?r=.06751619128429062:r=.09625089153176467:r=.027268163053989804:t[308]>1e-35?r=.060174483556283756:r=-.049062854038919135:t[3]>24.500000000000004?t[23]>1e-35?t[4]>63.50000000000001?r=-.03969241799174589:r=.01086816842550381:t[31]>1e-35?r=-.003284694817583201:t[9]>6.500000000000001?t[4]>30.500000000000004?r=-.04224490699947552:r=-.011834162944360616:t[308]>1e-35?t[32]>1e-35?r=-.13448447971850278:r=-.019569456707046823:t[19]>1e-35?t[9]>1.5000000000000002?r=-.07256260662659254:t[4]>60.50000000000001?r=-.08227503453609311:r=-.020596416747563847:r=-.07396549241564149:t[8]>691.5000000000001?t[82]>1e-35?r=-.10046536995362734:t[133]>1e-35?r=-.06407649822752297:t[225]>1e-35?r=.08035785003303324:t[92]>1e-35?r=.018901360933204676:t[20]>1e-35?r=.05252546973665552:t[8]>2592.5000000000005?r=-.040543705016462955:r=-.011236043818320725:t[9]>17.500000000000004?r=.025560632674895334:t[308]>1e-35?t[0]>1847.5000000000002?r=.03527165701669741:r=-.0071847350825815035:t[127]>1e-35?r=.024373016379595405:t[9]>2.5000000000000004?r=-.0035090719709448288:r=-.03514829488063766;let n;t[13]>1e-35?t[3]>1.5000000000000002?t[8]>546.5000000000001?n=.03848674861536988:t[5]>423.00000000000006?t[8]>114.50000000000001?t[9]>56.50000000000001?n=-.003764520033319488:n=.06570817919969299:t[4]>61.50000000000001?n=.028346156293069538:n=.0908154644362606:n=.02445594243234816:t[308]>1e-35?t[8]>65.50000000000001?n=.0019305229020073053:n=.09279357295883772:n=-.04458984161917124:t[3]>24.500000000000004?t[23]>1e-35?n=.0027405390271277013:t[4]>29.500000000000004?t[52]>1e-35?n=.044727478132905285:t[115]>1e-35?n=.10245804828855934:t[9]>17.500000000000004?n=-.03353173647469207:t[2]>98.50000000000001?n=-.10048106638102179:n=-.05484231104348874:t[31]>1e-35?n=.016807537467116516:t[9]>6.500000000000001?n=-.012113620535295137:t[4]>8.500000000000002?t[308]>1e-35?n=-.01882594250504289:n=-.05585658862796076:n=.04279591277938338:t[8]>691.5000000000001?t[82]>1e-35?n=-.09262278043707878:t[133]>1e-35?n=-.058454257768893625:t[32]>1e-35?n=-.09769348447126434:t[25]>1e-35?n=-.0725430043727677:t[122]>1e-35?n=-.10047841601578077:n=-.00580671054458958:t[9]>13.500000000000002?n=.021399199032818294:t[308]>1e-35?t[4]>10.500000000000002?n=-.0076376731757173515:n=.03394923033036848:t[127]>1e-35?n=.02070489091204209:n=-.02290162726126496;let i;t[13]>1e-35?t[3]>1.5000000000000002?t[8]>892.5000000000001?t[9]>21.500000000000004?i=.010230295672324606:i=.038540509248742805:t[8]>125.50000000000001?t[1]>49.50000000000001?i=.03086356292895467:i=.057128750867458604:t[5]>888.5000000000001?i=.07861602941396924:i=.030523262699070908:t[308]>1e-35?i=.048236117667577356:t[8]>370.50000000000006?i=-.05642125069212264:i=-.007232836777168195:t[3]>24.500000000000004?t[23]>1e-35?t[131]>1e-35?i=.03640661467213915:i=-.005889820723907028:t[31]>1e-35?i=-.0009007166998276938:t[9]>6.500000000000001?i=-.022590340093882378:t[308]>1e-35?t[32]>1e-35?i=-.1215445089091064:i=-.01435612266219722:t[19]>1e-35?t[9]>1.5000000000000002?i=-.061555513040777825:t[4]>60.50000000000001?i=-.07053475504569347:i=-.013733369453963092:i=-.06302097189114152:t[227]>1e-35?i=-.05820440333190048:t[8]>683.5000000000001?t[82]>1e-35?i=-.08466979526809346:t[10]>24.500000000000004?i=-.017092159721119944:t[92]>1e-35?i=.03592901452463749:i=-.00359310519524756:t[5]>1809.5000000000002?t[243]>1e-35?i=-.03963116207386097:t[118]>1e-35?i=-.09483996283536394:t[217]>1e-35?i=-.03394542089519989:t[242]>1e-35?i=-.07985899422287938:i=.019706602160656964:t[9]>12.500000000000002?i=.014072998937735146:i=-.021156294523894684;let o;t[13]>1e-35?t[3]>1.5000000000000002?t[8]>892.5000000000001?t[9]>21.500000000000004?o=.009197756540516563:o=.03458896869535166:t[5]>5082.500000000001?o=.08265545468131008:t[131]>1e-35?o=.0740738432473315:o=.045159136632942756:t[8]>319.50000000000006?o=-.04653401534465376:t[7]>3.5000000000000004?t[0]>1230.5000000000002?t[0]>2579.5000000000005?o=-.011400839766681709:o=.11149800187510031:o=-.08683250977599462:o=.08355310136724753:t[4]>23.500000000000004?t[23]>1e-35?t[131]>1e-35?o=.040389083779932555:o=-.009887614274108602:t[52]>1e-35?o=.03705353499757327:t[9]>6.500000000000001?o=-.025401260429257562:t[2]>98.50000000000001?o=-.09237673187534504:o=-.04298556869281803:t[222]>1e-35?o=-.045221965895986184:t[8]>691.5000000000001?t[133]>1e-35?o=-.05435318330148897:t[128]>1e-35?o=-.08672907303184191:t[227]>1e-35?o=-.05568304584186561:t[122]>1e-35?o=-.09623059693538563:t[225]>1e-35?o=.07558331642202279:t[82]>1e-35?o=-.07360566227233566:o=-.005646164647395919:t[242]>1e-35?o=-.08203758341228108:t[9]>13.500000000000002?o=.018726123829696042:t[308]>1e-35?t[4]>10.500000000000002?o=-.011153942154062704:o=.03132858912391067:t[127]>1e-35?o=.021455228822345174:t[23]>1e-35?o=.01959966745346997:o=-.021764790177579325;let a;t[13]>1e-35?t[3]>1.5000000000000002?t[8]>284.50000000000006?t[121]>1e-35?t[18]>1e-35?a=.07547602514276922:a=-.08529678832140396:a=.030314822344598043:t[5]>888.5000000000001?t[4]>61.50000000000001?a=.011143589009415464:a=.0654700456802118:a=.021794712646632755:t[308]>1e-35?a=.04231872551095028:a=-.034381999950549455:t[4]>23.500000000000004?t[23]>1e-35?t[4]>63.50000000000001?a=-.03678981254332261:a=.010518160384496255:t[8]>825.5000000000001?a=-.04506534842082387:t[9]>38.50000000000001?a=.01004983052203438:a=-.030580958620701027:t[39]>1e-35?a=-.12802435021505382:t[8]>691.5000000000001?t[23]>1e-35?t[203]>1e-35?t[4]>6.500000000000001?a=.030426957004611704:a=-.0726407693060581:a=.017395521646964375:t[4]>7.500000000000001?t[0]>93.50000000000001?t[9]>7.500000000000001?a=-.008024349629981291:t[31]>1e-35?a=.01296539930850471:t[308]>1e-35?a=-.012855016509024084:a=-.04564527976851505:a=-.15681420504058596:t[10]>4.500000000000001?t[243]>1e-35?a=-.1012064426380198:a=-.0062808850924854194:a=.030706323726162416:t[9]>13.500000000000002?a=.017081636133736405:t[308]>1e-35?t[4]>10.500000000000002?a=-.009306613091760644:t[4]>1.5000000000000002?a=.03655523200850989:a=-.02671654212893341:t[127]>1e-35?a=.019261510468604387:a=-.017627818570628936;let c;t[13]>1e-35?t[3]>1.5000000000000002?t[8]>892.5000000000001?t[308]>1e-35?c=.036100405995889276:c=.011709313297015793:t[0]>119.50000000000001?t[8]>125.50000000000001?c=.03622542297472574:c=.05595579157301536:c=-.02234751038146796:t[8]>319.50000000000006?c=-.040132029478400735:t[7]>3.5000000000000004?t[0]>1230.5000000000002?t[0]>2579.5000000000005?c=-.009306153573847916:c=.10058509567064988:c=-.0785668890966017:t[9]>28.500000000000004?c=-.04781977604130416:c=.09753292614937459:t[4]>23.500000000000004?t[131]>1e-35?c=.02372493254975127:t[148]>1e-35?c=.028103095989516644:t[4]>58.50000000000001?t[10]>1e-35?c=-.05000852203469597:c=.02922366846119705:t[23]>1e-35?c=-.0026335076988151292:c=-.03073993752935585:t[222]>1e-35?c=-.03867374428185713:t[32]>1e-35?c=-.07220729365053084:t[39]>1e-35?c=-.11624524614351733:t[8]>691.5000000000001?t[133]>1e-35?c=-.04836360271198036:t[8]>4968.500000000001?c=-.10873681915578029:t[149]>1e-35?c=-.11847484033769298:t[122]>1e-35?c=-.08916172460307559:t[82]>1e-35?c=-.06774726602152634:c=-.0033469147714351327:t[126]>1e-35?c=-.09474445392080015:t[8]>131.50000000000003?t[118]>1e-35?c=-.09002547031023511:c=.015475385187009489:t[25]>1e-35?c=-.08175501232759151:c=-.000429679055394914;let l;t[13]>1e-35?t[3]>1.5000000000000002?t[8]>546.5000000000001?l=.021942996005324917:l=.042349138084484074:t[308]>1e-35?l=.036507270845732874:l=-.028981850556764995:t[3]>24.500000000000004?t[23]>1e-35?l=.00210930790963475:t[31]>1e-35?l=.006825358293027163:t[9]>6.500000000000001?l=-.013772084269062394:t[308]>1e-35?l=-.008307929099892574:t[19]>1e-35?l=-.027706313312904487:l=-.04891108984170914:t[134]>1e-35?l=-.0605730733844732:t[25]>1e-35?l=-.05347926493253117:t[227]>1e-35?l=-.049415829249003666:t[32]>1e-35?l=-.06807799662179595:t[308]>1e-35?t[4]>10.500000000000002?t[2]>13.500000000000002?l=-.00016302718260794637:l=-.10247095758122947:t[210]>1e-35?l=-.022149002072787024:t[95]>1e-35?l=.15222631630626304:l=.027393884520465712:t[9]>7.500000000000001?t[225]>1e-35?l=.13483346577752245:t[3]>9.500000000000002?t[243]>1e-35?l=-.045352728133789516:t[8]>683.5000000000001?l=.00474372227519902:l=.02635476098707525:t[92]>1e-35?l=.05659380819933452:t[105]>1e-35?l=.07431443210341222:t[186]>1e-35?l=.0915821133384904:l=-.016414750130401053:t[127]>1e-35?l=.011824693641866162:t[23]>1e-35?l=.0228468674288774:t[284]>1e-35?l=.06606936863302432:l=-.02872463273902358;let u;t[13]>1e-35?t[3]>1.5000000000000002?t[8]>125.50000000000001?t[288]>1e-35?u=-.019844363904157558:t[1]>50.50000000000001?t[131]>1e-35?u=.044961338592245194:u=.003659599513761676:t[121]>1e-35?u=-.04057103630479994:u=.03158560697078578:t[0]>421.50000000000006?t[4]>61.50000000000001?u=-.0003708603406529278:u=.05331312264472391:u=.0006575958601218936:t[8]>319.50000000000006?u=-.034654694051901545:t[7]>3.5000000000000004?t[0]>1230.5000000000002?t[0]>2579.5000000000005?u=-.0076053515916517005:u=.09116695486305336:u=-.07137458699162028:u=.06633130654035282:t[4]>29.500000000000004?t[23]>1e-35?t[4]>63.50000000000001?u=-.0308520802187302:u=.013156423968295541:t[115]>1e-35?u=.11581171687488252:t[52]>1e-35?t[10]>22.500000000000004?u=.12264179915175587:u=-.021905727233873535:t[8]>799.5000000000001?u=-.04181869575935412:u=-.023695901673350575:t[222]>1e-35?u=-.034612899265371776:t[8]>691.5000000000001?t[9]>98.50000000000001?u=-.06892116536821917:t[149]>1e-35?u=-.11194586444154514:t[133]>1e-35?u=-.04269583234000504:t[128]>1e-35?u=-.0644631966969502:t[8]>4968.500000000001?u=-.09650726096330133:u=-.004219129180139438:t[126]>1e-35?u=-.08038306745347751:t[5]>1809.5000000000002?u=.009265335288169993:t[9]>2.5000000000000004?u=.006447645462117438:u=-.021047132609551503;let f;t[13]>1e-35?t[3]>1.5000000000000002?t[9]>21.500000000000004?t[121]>1e-35?f=-.08436540015142402:t[8]>1861.5000000000002?f=-.01621425699342421:f=.01878613821895428:f=.031052879158242532:t[8]>319.50000000000006?f=-.031536619360997865:t[7]>3.5000000000000004?f=-.004510586962343298:f=.0596524941011746:t[4]>18.500000000000004?t[23]>1e-35?f=.004757490541310808:t[9]>6.500000000000001?f=-.008842393772207996:t[31]>1e-35?f=.0010536183837006993:t[308]>1e-35?f=-.008145882815435419:t[2]>98.50000000000001?f=-.08404937622173021:t[276]>1e-35?f=.0020072791321856663:t[19]>1e-35?f=-.023031820639490178:f=-.04553314326377875:t[8]>2134.5000000000005?f=-.02244583113572251:t[134]>1e-35?f=-.05592137394753121:t[308]>1e-35?t[49]>1e-35?f=.09989109704064947:t[4]>10.500000000000002?t[2]>13.500000000000002?f=-.00447733056482096:f=-.10191061664873849:f=.021765308380331864:t[9]>7.500000000000001?t[118]>1e-35?f=-.07570059131536411:t[243]>1e-35?f=-.040983393346598646:t[3]>9.500000000000002?f=.014763759061483812:t[92]>1e-35?f=.05136368898963024:f=-.008162398981149495:t[127]>1e-35?f=.013999119696708346:t[23]>1e-35?t[20]>1e-35?f=.14138985500120907:f=.008668274102844162:t[284]>1e-35?f=.06356484011042893:f=-.024781304572706303;let p;t[13]>1e-35?t[3]>8.500000000000002?t[8]>892.5000000000001?t[0]>384.50000000000006?p=.014387526569215037:t[8]>2266.5000000000005?p=-.1397298649743087:p=.007953931014097788:t[0]>119.50000000000001?t[4]>61.50000000000001?p=.0029819092211896296:t[218]>1e-35?p=.08450459375645737:p=.031646488019280654:p=-.03544960151460596:t[9]>9.500000000000002?p=-.026002317735915183:t[7]>1.5000000000000002?p=.005074258810794793:p=.0745247650477651:t[4]>29.500000000000004?t[131]>1e-35?p=.023269218675640847:t[148]>1e-35?p=.03812942399144545:t[115]>1e-35?p=.10512283476967227:p=-.02607307479736138:t[227]>1e-35?p=-.036576708299046294:t[101]>1e-35?p=.027948683650881864:t[149]>1e-35?p=-.08195628451594297:t[50]>1e-35?p=-.16997544922278504:t[8]>691.5000000000001?t[9]>101.50000000000001?p=-.06860333850762075:t[225]>1e-35?p=.06066641950951723:t[10]>22.500000000000004?t[1]>29.500000000000004?t[127]>1e-35?p=.028599705845427533:p=-.010746719511640914:t[0]>4877.500000000001?p=-.07251187886096228:p=-.021299712241446785:t[118]>1e-35?p=-.11902023760964736:p=15874469526809387e-21:t[8]>267.50000000000006?p=.01317292185402293:t[148]>1e-35?t[9]>20.500000000000004?p=.09614842415142123:p=.006049073167176467:t[189]>1e-35?p=.05562696451900713:p=-.006257541923837303;let m;t[13]>1e-35?t[9]>14.500000000000002?t[2]>11.500000000000002?t[1]>71.50000000000001?t[8]>1252.5000000000002?m=-.10069846585436666:m=-.010577995535809317:t[146]>1e-35?m=-.008877238274428668:t[280]>1e-35?m=.10076055897012692:t[6]>70.50000000000001?m=-.020603523042565547:t[7]>1.5000000000000002?m=.02819095420813202:m=-.1223354167911277:m=-.025073583348334844:t[8]>416.50000000000006?m=.01718560189149466:t[230]>1e-35?m=.12281803224342265:m=.03281276971308565:t[4]>14.500000000000002?t[23]>1e-35?t[21]>1e-35?m=-.13070568109867683:t[4]>63.50000000000001?m=-.027221825262496814:m=.01530862490082352:t[9]>6.500000000000001?t[5]>4320.500000000001?t[2]>31.500000000000004?m=-.00605574271293711:m=.04739407327741249:m=-.012537528620315956:t[31]>1e-35?t[20]>1e-35?m=.1252215087035768:m=.003905888677601057:t[52]>1e-35?m=.045466299731038815:t[2]>100.50000000000001?m=-.07815624550168065:t[308]>1e-35?m=-.007715815250508057:t[276]>1e-35?t[9]>1.5000000000000002?m=-.03538265083203445:t[18]>1e-35?m=.1591211669800727:m=.015151475408241136:t[8]>557.5000000000001?m=-.04225569725456342:m=-.022455546324243267:t[308]>1e-35?m=.01325441736085826:t[197]>1e-35?m=.03752194600682512:t[225]>1e-35?m=.06583712394533976:m=-.005205289866839043;let h;t[13]>1e-35?t[9]>21.500000000000004?t[2]>12.500000000000002?h=.010264022580774884:h=-.02335958814489217:t[8]>416.50000000000006?t[3]>4.500000000000001?t[295]>1e-35?h=-.0936747137352166:t[0]>384.50000000000006?h=.019846244507320695:h=-.0751102554077272:h=-.026885329334203723:t[0]>966.5000000000001?t[10]>48.50000000000001?h=.11654906890054273:h=.0346250587613322:t[4]>39.50000000000001?h=-.08568002378645614:t[9]>16.500000000000004?h=-.12010535752923689:h=.021321923389033808:t[4]>14.500000000000002?t[23]>1e-35?t[21]>1e-35?h=-.12056431231412057:t[131]>1e-35?h=.03652965550568472:h=.002563006128791669:t[9]>6.500000000000001?t[30]>1e-35?h=-.10141481732178981:h=-.003936457893178248:t[31]>1e-35?h=.008215898756249477:t[52]>1e-35?t[0]>4188.500000000001?h=.12972828769588213:h=-.003137412232297087:t[2]>100.50000000000001?h=-.0730872929087944:t[308]>1e-35?h=-.006958622747243333:t[35]>1e-35?t[0]>3707.5000000000005?h=.07934620723812878:h=-.018598568353702116:h=-.030635505446410763:t[128]>1e-35?h=-.06962290453843294:t[84]>1e-35?h=-.15290337844960322:t[308]>1e-35?t[8]>2543.5000000000005?h=-.034938657503885584:h=.016339322898966915:t[197]>1e-35?h=.03358907965870046:t[18]>1e-35?h=-.01754013791515288:h=-.0004944586067698557;let g;t[13]>1e-35?t[308]>1e-35?t[210]>1e-35?g=.005888790687820524:g=.0429676533834978:t[2]>7.500000000000001?t[0]>119.50000000000001?t[6]>79.50000000000001?g=-.0224319889201976:t[212]>1e-35?g=.06249587051783863:t[8]>963.5000000000001?t[8]>1156.5000000000002?g=.010357273289123324:g=-.029749145161304082:t[218]>1e-35?g=.06449336340743606:g=.018047654539345502:g=-.07350502390293116:g=-.019594829995832414:t[4]>39.50000000000001?g=-.019338083179859314:t[39]>1e-35?g=-.10427066919173111:t[222]>1e-35?t[0]>612.5000000000001?g=-.019197415255018464:g=-.0836562507048181:t[149]>1e-35?g=-.07679624472577429:t[32]>1e-35?g=-.05097506748590604:t[191]>1e-35?g=.04670476485250936:t[30]>1e-35?g=-.05313073892148652:t[8]>691.5000000000001?t[23]>1e-35?t[203]>1e-35?t[4]>8.500000000000002?g=.03930363008271334:g=-.06029171685615689:g=.016203086182431294:t[4]>7.500000000000001?g=-.013824248237085224:t[10]>4.500000000000001?t[94]>1e-35?g=-.09817668643367765:t[10]>40.50000000000001?g=-.023558078753593125:g=.0065113494780482326:t[8]>809.5000000000001?t[297]>1e-35?g=-.1352063548573715:g=.058203900441270634:g=-.035243959159285736:t[10]>59.50000000000001?t[1]>43.50000000000001?g=-.012552876807800442:g=.05991247777734298:g=.0035893102109330177;let A;t[13]>1e-35?t[9]>21.500000000000004?t[145]>1e-35?A=.03507251990078782:t[2]>14.500000000000002?A=.004905698363309292:t[8]>2421.5000000000005?A=-.10306119951984316:A=-.018951037816654928:t[8]>416.50000000000006?t[3]>4.500000000000001?t[295]>1e-35?A=-.08503171085833393:A=.015130974593044409:A=-.024425267075198206:A=.02624054905103126:t[4]>19.500000000000004?t[131]>1e-35?A=.02100191580704534:t[32]>1e-35?t[8]>2302.5000000000005?A=.09908783187786288:A=-.06920877329925636:t[8]>241.50000000000003?A=-.016756131804203496:t[9]>33.50000000000001?A=.04903179955263626:t[217]>1e-35?A=-.047416847619291644:A=-.0017200891991431119:t[39]>1e-35?A=-.10389927604977028:t[134]>1e-35?A=-.050480365434872866:t[178]>1e-35?A=-.05167855791556937:t[8]>2134.5000000000005?A=-.01663197335585307:t[242]>1e-35?A=-.05361323756615453:t[118]>1e-35?A=-.05299780866211368:t[10]>24.500000000000004?t[10]>55.50000000000001?t[8]>764.5000000000001?A=-.0016544848369620534:A=.04494144460483587:A=-.009283616456736156:t[121]>1e-35?t[0]>4463.500000000001?A=.051166688553608355:A=-.06623908820705383:t[84]>1e-35?A=-.12990936092409747:t[306]>1e-35?A=-.07020596855118943:t[49]>1e-35?A=.06272964802556856:t[192]>1e-35?A=.06540204627162581:A=.008277910531592885;let y;t[13]>1e-35?t[308]>1e-35?t[210]>1e-35?y=.003325460510319164:y=.037153108286272905:t[2]>12.500000000000002?t[1]>124.50000000000001?y=-.09880713344892134:t[7]>60.50000000000001?t[10]>71.50000000000001?y=.0697359767152808:t[230]>1e-35?y=.06513506845651572:y=-.02826625276613455:t[5]>246.50000000000003?t[8]>95.50000000000001?y=.013616385013146277:y=.04171540100223404:y=-.04360396575094823:t[212]>1e-35?y=.025945477945627522:y=-.019793208261535442:t[4]>39.50000000000001?t[25]>1e-35?y=-.07856453318384411:y=-.014803893522351739:t[39]>1e-35?y=-.09185452630751932:t[149]>1e-35?y=-.07122426086157027:t[134]>1e-35?y=-.04231052091434186:t[227]>1e-35?y=-.029815824273994197:t[50]>1e-35?y=-.15736496271211153:t[222]>1e-35?y=-.02360285356956629:t[128]>1e-35?y=-.03922080193836443:t[136]>1e-35?y=-.07219685327698587:t[10]>24.500000000000004?t[1]>8.500000000000002?y=-.0029736170756835783:y=-.06482902102259112:t[84]>1e-35?y=-.11340924635708383:t[94]>1e-35?y=-.03635703457792193:t[118]>1e-35?y=-.058181913914186034:t[126]>1e-35?y=-.062030576241517366:t[116]>1e-35?y=-.045086301850604006:t[25]>1e-35?y=-.031665223656767286:t[203]>1e-35?y=-.009444685731407691:y=.0112265153772187;let E;t[13]>1e-35?t[1]>64.50000000000001?t[9]>14.500000000000002?t[9]>54.50000000000001?E=.022717227245241684:E=-.049700413274686266:E=.007175776918589741:t[5]>50.50000000000001?t[8]>61.50000000000001?t[21]>1e-35?E=-.07927556792063156:t[3]>8.500000000000002?t[4]>23.500000000000004?t[281]>1e-35?E=-.12263724050601095:E=.0070743478891288035:t[288]>1e-35?E=-.050439138582109:E=.0255701593657891:E=-.005812703740580558:t[6]>49.50000000000001?E=-.008542694147899113:E=.035147383686665:E=-.0960461939274094:t[32]>1e-35?E=-.04555453745517765:t[222]>1e-35?t[0]>612.5000000000001?E=-.01800870272656664:E=-.07817304234604389:t[30]>1e-35?E=-.05227061750368981:t[25]>1e-35?t[0]>4449.500000000001?t[217]>1e-35?E=.08778416018479411:E=-.026563982720830256:E=-.05296139548112329:t[50]>1e-35?E=-.14926464875852247:t[8]>779.5000000000001?t[133]>1e-35?E=-.036572140520852024:t[183]>1e-35?E=-.10766853736801459:E=-.003966794968701808:t[217]>1e-35?t[5]>5237.500000000001?E=.09513215942486053:E=-.03641865277445567:t[10]>59.50000000000001?E=.03177172388687933:t[39]>1e-35?E=-.10234241303898953:t[243]>1e-35?E=-.02966738115984321:t[190]>1e-35?E=-.04312785336449181:t[118]>1e-35?E=-.05808521194081524:E=.006720381600740378;let b;t[308]>1e-35?t[5]>423.00000000000006?t[133]>1e-35?b=-.046284053681928526:t[210]>1e-35?b=49778070699847876e-21:t[13]>1e-35?b=.03328070054739309:t[128]>1e-35?b=-.054790214922938896:t[126]>1e-35?b=-.08524792218532945:b=.014414055975542446:t[1]>38.50000000000001?b=-.07287851335872973:b=.005263371501687163:t[9]>7.500000000000001?t[21]>1e-35?t[10]>4.500000000000001?b=-.12459748864088374:b=-.004626323021331593:t[298]>1e-35?t[4]>64.50000000000001?b=.13044981041138526:t[9]>71.50000000000001?b=-.056068402282406865:t[9]>12.500000000000002?b=.038957722962512764:b=-.04598815982492169:t[8]>691.5000000000001?t[126]>1e-35?b=-.0852126122372075:t[225]>1e-35?b=.10082066771689505:t[1]>161.50000000000003?b=-.11609832500613824:t[3]>8.500000000000002?t[8]>1685.5000000000002?b=-.010835400874777133:b=.004607419973807752:b=-.016989075258564062:b=.009205417251698097:t[23]>1e-35?t[20]>1e-35?b=.10184317139657878:t[0]>5724.500000000001?b=-.1163666496650542:t[1]>106.50000000000001?b=.1303850608190687:t[129]>1e-35?b=.10745031509534769:b=.006166901738036226:t[31]>1e-35?b=.010177092833155127:t[13]>1e-35?t[0]>213.50000000000003?b=.005004582564506611:b=-.10481581731668346:t[19]>1e-35?b=-.009850706427306281:b=-.02608226348051303;let S;t[13]>1e-35?t[1]>64.50000000000001?t[2]>4.500000000000001?S=-.0024117174588695603:S=-.058339700513831916:t[212]>1e-35?t[0]>2215.5000000000005?t[8]>847.5000000000001?t[10]>21.500000000000004?t[1]>39.50000000000001?S=.04575380761203418:S=-.10025595041353463:t[15]>1e-35?S=.17705790384964004:S=.0073813837628615014:S=.07676373681392407:S=-.027167992693885996:t[3]>11.500000000000002?t[280]>1e-35?S=.07078572910026419:t[4]>23.500000000000004?S=.005513918674164821:S=.0206586476926392:t[0]>5269.500000000001?S=.07706773525822633:S=-.010233826953776122:t[148]>1e-35?t[8]>1622.5000000000002?S=-.03204783603215824:S=.027405418223981973:t[4]>14.500000000000002?t[131]>1e-35?t[9]>1.5000000000000002?t[0]>5026.500000000001?S=-.0930246911392012:S=.011173087289703683:t[3]>24.500000000000004?S=.03281421918878597:S=.12449335091369843:t[204]>1e-35?S=.06634531187326123:S=-.011522999669353388:t[92]>1e-35?t[10]>42.50000000000001?S=-.041196758517013515:t[4]>7.500000000000001?S=-2942718111029724e-20:t[4]>6.500000000000001?S=.11953909558532852:S=.03188615019450534:t[122]>1e-35?S=-.0616037324662157:t[101]>1e-35?S=.027230889593349412:t[8]>4968.500000000001?S=-.1113986516540856:t[3]>2.5000000000000004?S=-.002045140426885727:t[129]>1e-35?S=.12641163374304432:S=.014909826232873194;let R;t[308]>1e-35?t[0]>7277.500000000001?R=-.09337446795435:t[5]>423.00000000000006?t[133]>1e-35?R=-.040884836258675006:t[210]>1e-35?R=-.0003719413278428804:t[13]>1e-35?R=.030287610160818174:R=.011174130013595384:t[1]>38.50000000000001?R=-.0662442170185784:R=.004332185707008564:t[9]>7.500000000000001?t[145]>1e-35?t[285]>1e-35?R=-.08092286307197555:R=.029866363328584986:t[21]>1e-35?t[10]>4.500000000000001?R=-.1155211149523894:R=-.0032903546638958538:t[149]>1e-35?R=-.03632198993199768:t[3]>9.500000000000002?t[8]>999.5000000000001?R=-.003507023626534306:t[128]>1e-35?t[4]>13.500000000000002?t[0]>3459.5000000000005?R=-.025416927789760076:R=.02777568919793122:R=-.10310351509769732:R=.013549608903688785:t[186]>1e-35?R=.08513865847420551:R=-.009306721292510369:t[31]>1e-35?R=.009780833952582307:t[23]>1e-35?R=.011143773934157629:t[210]>1e-35?R=.025354797285173356:t[17]>1e-35?t[10]>3.5000000000000004?R=-.04846287537743046:R=-.014647271080376757:t[2]>5.500000000000001?t[7]>57.50000000000001?R=-.034224938681445764:t[8]>1641.5000000000002?R=-.027298372075800673:t[191]>1e-35?t[10]>18.500000000000004?R=-.027950103994861836:R=.14575930827829034:R=-.007124740389354946:t[10]>22.500000000000004?R=.013173304107866726:R=-.11119620042551365;let B;t[131]>1e-35?B=.01892225243240137:t[308]>1e-35?t[5]>691.5000000000001?t[133]>1e-35?B=-.037118314390013646:t[1]>51.50000000000001?t[5]>3749.5000000000005?t[8]>58.50000000000001?B=-.022305242912035072:B=.024792895826340516:B=.013666137278072166:t[88]>1e-35?t[10]>27.500000000000004?B=.2080083584805785:B=.04247197078083379:t[10]>40.50000000000001?t[18]>1e-35?t[1]>27.500000000000004?B=.060783227455868206:B=-.056904865557409035:B=-.03278952553107572:t[192]>1e-35?B=.13117402617043625:B=.01647119888257836:B=-.01825870445636398:t[9]>6.500000000000001?t[298]>1e-35?B=.026536210945939682:t[8]>691.5000000000001?t[126]>1e-35?B=-.07927319604548912:t[10]>3.5000000000000004?t[21]>1e-35?B=-.11083976837572328:t[146]>1e-35?B=-.03359294484446772:B=-.0042815953591236475:t[190]>1e-35?B=-.09264239592903775:t[10]>1e-35?B=.022282638485105657:B=-.0205994057928458:t[5]>4918.500000000001?B=.03430715695199153:t[243]>1e-35?t[2]>57.50000000000001?B=.08935072241972036:B=-.03781647876237494:B=.0062655753179671515:t[31]>1e-35?B=.008603500300349887:t[230]>1e-35?B=.03350056932774173:t[23]>1e-35?t[241]>1e-35?B=.10277555508503314:B=.0017901817172993888:t[2]>98.50000000000001?B=-.05920081229672715:B=-.015722173275739208;let L;t[13]>1e-35?t[118]>1e-35?L=.07957905150112207:t[1]>125.50000000000001?L=-.0662620579858685:t[145]>1e-35?L=.029682040828779843:t[19]>1e-35?t[6]>15.500000000000002?L=-.0009597832580977798:L=-.081474760755753:t[212]>1e-35?L=.03637001492325179:L=.006912305498963309:t[32]>1e-35?L=-.03919900630910754:t[134]>1e-35?L=-.036225295529777886:t[4]>4.500000000000001?t[5]>384.50000000000006?t[204]>1e-35?L=.06671440854602108:t[136]>1e-35?L=-.07577364230133474:t[148]>1e-35?t[4]>7.500000000000001?L=.026430947016830915:L=-.04075501264495112:t[9]>93.50000000000001?L=-.04353169430417609:t[50]>1e-35?L=-.1411224537622882:t[17]>1e-35?t[49]>1e-35?L=.068392679163672:t[10]>1.5000000000000002?L=-.0209659792007492:L=-.0004393235559249831:t[133]>1e-35?t[9]>64.50000000000001?L=.07254524592323175:L=-.0319087835282534:L=.00037444813327793425:L=-.025138768151370408:t[243]>1e-35?L=-.050010891710502096:t[94]>1e-35?L=-.0817513550778599:t[122]>1e-35?L=-.061038875809822285:t[19]>1e-35?t[8]>1085.5000000000002?L=-.008408408775061623:t[2]>5.500000000000001?t[218]>1e-35?L=.1454877641381946:L=.053787998331240316:t[9]>33.50000000000001?L=.08602629796680285:L=-.03895127455803038:L=.008830878042315722;let O;t[131]>1e-35?O=.01687979707990516:t[8]>2915.5000000000005?t[297]>1e-35?O=.07473600489975568:t[0]>93.50000000000001?O=-.021596848506011502:O=-.13840802327735696:t[230]>1e-35?t[4]>6.500000000000001?t[0]>4977.500000000001?O=.10264284346448256:O=.031042487183181262:O=-.016653982936827776:t[4]>60.50000000000001?t[10]>75.50000000000001?O=.04226403420647408:t[10]>1e-35?t[0]>4733.500000000001?O=.006271403149804702:O=-.030013637555715046:t[0]>4449.500000000001?O=-.06556876058654929:O=.06437994816903034:t[32]>1e-35?O=-.043814577251655815:t[308]>1e-35?t[0]>7277.500000000001?O=-.09349726304052086:t[210]>1e-35?O=-.0035960132209098003:t[5]>691.5000000000001?t[133]>1e-35?O=-.029188394315052574:O=.017219308333820193:O=-.017378928852189585:t[9]>6.500000000000001?t[0]>2653.5000000000005?t[149]>1e-35?O=-.04428555753857688:O=.0001456106867817353:t[5]>213.50000000000003?O=.01740292726636365:O=-.011361718115556464:t[7]>4.500000000000001?t[0]>316.50000000000006?t[19]>1e-35?t[10]>54.50000000000001?O=.03410288911259329:t[121]>1e-35?O=-.06056527462120627:t[8]>2592.5000000000005?O=.12166808844363577:t[191]>1e-35?O=.11669879218998758:O=-.001664858391716235:O=-.01262927450503166:O=-.04506589951879664:t[227]>1e-35?O=-.08548904959752329:O=.02156080776537726;let Y;t[306]>1e-35?t[149]>1e-35?Y=-.1389218965136736:Y=-.032218642644416894:t[13]>1e-35?Y=.006465035217331847:t[50]>1e-35?Y=-.1381687930130022:t[179]>1e-35?Y=-.13112784985951215:t[148]>1e-35?t[8]>1726.5000000000002?Y=-.03262719498763048:Y=.023342916702125613:t[191]>1e-35?Y=.030005484947580197:t[4]>4.500000000000001?t[204]>1e-35?Y=.047767773119269434:t[136]>1e-35?t[0]>1937.5000000000002?Y=-.09989343595668776:Y=.06533942033334243:t[15]>1e-35?t[9]>86.50000000000001?Y=-.10577989354150097:t[8]>668.5000000000001?t[126]>1e-35?Y=-.09165257825246746:t[9]>32.50000000000001?Y=.02484870392366004:Y=-.008499493096971395:t[8]>24.500000000000004?Y=.02459679192828244:Y=-.010527978013140512:t[25]>1e-35?t[217]>1e-35?Y=.0015644546318714849:Y=-.06579524865022705:Y=-.0060233890975120614:t[122]>1e-35?t[1]>36.50000000000001?Y=.03331853632960164:Y=-.09482264761126993:t[19]>1e-35?t[8]>1430.5000000000002?Y=-.019091477207111116:Y=.037878468575478504:t[94]>1e-35?Y=-.08013082284576584:t[4]>2.5000000000000004?t[186]>1e-35?Y=.16919658785098224:t[243]>1e-35?Y=-.06580584936754524:Y=.01567555159935563:t[129]>1e-35?Y=.06721746994993226:t[10]>32.50000000000001?Y=-.046394462507797975:Y=-.006436180519584767;let V;t[131]>1e-35?V=.015039096856208693:t[8]>779.5000000000001?t[145]>1e-35?V=.019122095523977856:t[298]>1e-35?V=.023828936462317443:t[1]>23.500000000000004?t[5]>384.50000000000006?t[7]>59.50000000000001?V=-.026094309429557913:t[204]>1e-35?V=.09163404305658318:t[1]>27.500000000000004?t[149]>1e-35?t[6]>34.50000000000001?V=.012643810980689466:V=-.07884161741497837:V=-.0025267379810891104:t[2]>43.50000000000001?t[0]>2860.5000000000005?V=.04493082949897325:V=.18046359750455776:t[7]>18.500000000000004?V=-.018667348656891496:V=.02584325784698236:V=-.045696524897545915:t[0]>3321.5000000000005?t[201]>1e-35?V=.04749240016989375:V=-.0333334578246718:t[5]>3276.5000000000005?V=.11330554740098908:t[7]>94.50000000000001?V=.1296600395033268:V=-.003576436308940934:t[15]>1e-35?t[183]>1e-35?V=-.13787130789142835:t[0]>1847.5000000000002?V=.017915229729920556:t[10]>23.500000000000004?t[10]>31.500000000000004?t[6]>7.500000000000001?V=.028856848462727104:V=-.11197632885851168:V=.08169801342016791:t[1]>22.500000000000004?V=-.021052888644970163:V=.019048604298876753:t[7]>4.500000000000001?V=-.002603328695276418:t[7]>1.5000000000000002?t[2]>5.500000000000001?V=.03432638833359197:V=-.0036767863082454973:t[1]>48.50000000000001?V=.03087375270128195:t[2]>3.5000000000000004?V=-.04219917149740248:V=.018818493993207935;let z;t[306]>1e-35?z=-.04076858123502297:t[13]>1e-35?t[1]>67.50000000000001?t[9]>14.500000000000002?t[9]>53.50000000000001?t[8]>1971.5000000000002?z=-.09091897542577475:z=.04042943082645558:t[218]>1e-35?z=.056254985867151:z=-.053848117950183044:z=.003881630017086845:t[5]>5152.500000000001?t[8]>857.5000000000001?t[6]>28.500000000000004?z=.021581808008986944:z=-.05639286496176611:z=.052838875036198954:t[5]>50.50000000000001?t[5]>4082.5000000000005?t[17]>1e-35?z=.023061479860228728:t[145]>1e-35?t[9]>10.500000000000002?z=.023885302967553288:z=.1617794086125622:t[212]>1e-35?z=.04504545345658806:t[3]>17.500000000000004?t[4]>45.50000000000001?z=-.03948072448245435:t[1]>47.50000000000001?t[9]>18.500000000000004?z=.01894935813286188:z=-.06449356357429188:z=.012297239104320094:t[1]>26.500000000000004?t[8]>33.50000000000001?z=-.034718828212885515:z=.0898976288814321:t[1]>17.500000000000004?z=-.15440137451988326:z=-.03864183216821465:z=.009988507307006308:z=-.08540311947043305:t[50]>1e-35?z=-.13323659732101975:t[134]>1e-35?z=-.031820386486894385:t[32]>1e-35?t[8]>2302.5000000000005?z=.08082476177379844:z=-.041665761903645876:t[179]>1e-35?z=-.12405023987936657:t[39]>1e-35?z=-.06247416524997478:t[138]>1e-35?z=-.10724031753676487:z=-.0005423122305122404;let Q;t[308]>1e-35?Q=.006160742906729798:t[190]>1e-35?t[0]>2461.5000000000005?t[10]>22.500000000000004?Q=.023223358334607133:Q=-.04383410185346742:Q=-.08542395045055405:t[297]>1e-35?t[8]>51.50000000000001?t[1]>13.500000000000002?Q=.023406489302867494:Q=-.085521220804058:Q=-.02921899554854833:t[298]>1e-35?t[9]>12.500000000000002?Q=.028120059780969632:Q=-.04211009474298743:t[294]>1e-35?Q=-.05040415676618239:t[86]>1e-35?t[1]>36.50000000000001?Q=-.0993035220737934:Q=-.0005384930611060366:t[230]>1e-35?t[4]>6.500000000000001?Q=.029770210551187937:Q=-.016272917551655715:t[4]>60.50000000000001?t[280]>1e-35?Q=.06421359317599738:Q=-.01963732469244167:t[218]>1e-35?t[3]>3.5000000000000004?Q=.024368404612215164:Q=-.04045232374803373:t[131]>1e-35?Q=.017372701982485795:t[120]>1e-35?Q=.08812710275150198:t[18]>1e-35?t[90]>1e-35?Q=.18451364351180236:t[7]>33.50000000000001?Q=-.03850813130183531:t[195]>1e-35?Q=.06966114053446336:t[3]>16.500000000000004?Q=-.0012869181693341211:t[0]>4242.500000000001?Q=-.054625548611291035:Q=-.014431095117473881:t[5]>4558.500000000001?t[8]>1.5000000000000002?Q=.006302103427145562:Q=.13967622319898698:t[121]>1e-35?Q=-.038798585213145644:t[5]>4544.500000000001?Q=-.08050498033009466:Q=-.002986974112681435;let U;t[0]>384.50000000000006?t[2]>101.50000000000001?t[1]>16.500000000000004?U=-.03461119351456781:U=.05659026566680352:t[306]>1e-35?t[2]>14.500000000000002?t[149]>1e-35?U=-.12404435523286539:U=-.0034376913880382956:U=-.09821622245095822:t[131]>1e-35?t[9]>1.5000000000000002?U=.0037507103585310234:U=.03610387965829944:t[8]>999.5000000000001?t[9]>137.50000000000003?U=-.11985021663179699:t[0]>1847.5000000000002?t[126]>1e-35?U=-.04832024079663151:t[37]>1e-35?U=-.037103393468366934:U=-.004248086592531705:t[8]>3084.0000000000005?t[9]>43.50000000000001?U=.032539071163832034:t[5]>1643.5000000000002?U=.036408625378035665:t[0]>1500.5000000000002?U=-.1346358322854993:U=-.027586559522081014:t[3]>1e-35?t[190]>1e-35?U=-.1133991164577881:t[9]>52.50000000000001?U=-.024478640359723122:U=.03673777861098756:U=-.1037451237591819:t[230]>1e-35?t[9]>48.50000000000001?t[10]>20.500000000000004?U=.002583438691776944:U=.10773520810108106:t[9]>12.500000000000002?t[1]>16.500000000000004?U=-.02141222346712401:U=.06392462314316179:t[4]>12.500000000000002?U=.08700122294434816:t[8]>267.50000000000006?U=.056923170082743224:U=-.07716309825583327:t[32]>1e-35?U=-.03961343943752142:U=.002674914122888783:t[1]>42.50000000000001?U=-.05217539654421676:t[145]>1e-35?U=.09553630282946368:U=-.009424791262477729;let Z;t[183]>1e-35?Z=-.05753337139158443:t[308]>1e-35?Z=.00562436671450989:t[9]>7.500000000000001?t[21]>1e-35?t[10]>8.500000000000002?Z=-.10477869875380448:Z=-.0070301869937306055:t[3]>9.500000000000002?t[8]>1765.5000000000002?t[0]>4571.500000000001?Z=-.12526505173232894:t[10]>1e-35?t[9]>71.50000000000001?Z=-.04442302951713574:Z=.00012409888451734224:Z=-.092199119633697:t[225]>1e-35?Z=.13773072450201831:t[0]>2882.5000000000005?Z=.0028540012229920533:t[298]>1e-35?Z=.07134486044361629:Z=.014297412329837425:t[145]>1e-35?Z=.05608385321902638:t[92]>1e-35?Z=.038298413603926135:t[107]>1e-35?t[2]>6.500000000000001?Z=-.0039957800609801315:Z=.0776927564241081:t[203]>1e-35?Z=-.05502900859432093:t[105]>1e-35?Z=.06062892720841595:Z=-.009574839629252128:t[31]>1e-35?Z=.009488858841144216:t[23]>1e-35?t[20]>1e-35?Z=.08818126313644752:t[8]>161.50000000000003?Z=.014353968957885408:Z=-.022240738532827903:t[210]>1e-35?Z=.024648862719806694:t[2]>5.500000000000001?t[4]>4.500000000000001?t[17]>1e-35?t[10]>16.500000000000004?Z=-.043902062079383485:Z=-.014741559220396223:Z=-.00934935734853194:t[6]>32.50000000000001?Z=.1514593126307404:Z=.010771222510801532:t[10]>22.500000000000004?Z=.01412495209334078:Z=-.08576940379502533;let J;t[0]>384.50000000000006?t[84]>1e-35?J=-.06647690967306838:t[2]>101.50000000000001?J=-.024451334501552457:t[306]>1e-35?J=-.034517188927733505:t[131]>1e-35?t[9]>1.5000000000000002?J=.0031858381443673127:J=.032574927024450646:t[204]>1e-35?t[1]>62.50000000000001?J=-.08601340441214533:t[1]>29.500000000000004?J=.10487598629539963:t[8]>597.5000000000001?J=-.0786529133673238:J=.08689436600511559:t[8]>779.5000000000001?t[10]>2.5000000000000004?t[9]>100.50000000000001?J=-.04883600353740688:t[126]>1e-35?J=-.03794042763348827:J=-.003358871967539988:t[210]>1e-35?J=.054991356498447566:t[6]>19.500000000000004?J=-.007418396981635549:J=.018032606049498613:t[18]>1e-35?t[7]>35.50000000000001?t[2]>44.50000000000001?J=-.02143003429501711:J=-.09016000554055564:t[1]>19.500000000000004?t[1]>42.50000000000001?t[8]>17.500000000000004?J=-.006636355416244082:J=-.06483095743431454:t[4]>21.500000000000004?J=-.028975965946833545:J=.022012264796522657:J=-.06653648243193663:t[5]>4593.500000000001?J=.01753551428088607:t[217]>1e-35?J=-.028864824937700297:t[94]>1e-35?J=-.04885192273020658:t[279]>1e-35?J=.08105715462329498:t[121]>1e-35?J=-.04576676034750651:J=.004795141324949362:t[1]>42.50000000000001?J=-.047446619702809195:t[145]>1e-35?J=.08400495571952321:J=-.00854528836489364;let j;t[294]>1e-35?j=-.042529778074638265:t[266]>1e-35?j=-.1180276669679798:t[134]>1e-35?j=-.026818144353279623:t[183]>1e-35?j=-.05120747503479363:t[227]>1e-35?t[8]>1641.5000000000002?j=-.07265906898294434:t[4]>12.500000000000002?t[17]>1e-35?j=-.027516137530797014:t[0]>4331.500000000001?t[1]>64.50000000000001?j=-.03049646619610203:t[1]>50.50000000000001?j=.20634590755061122:j=.06956378103625731:t[0]>3770.5000000000005?j=-.07946414366134913:t[19]>1e-35?j=.17083312065604694:t[2]>21.500000000000004?j=-.02327981978127724:j=.129717297518715:t[145]>1e-35?j=.006891245076133524:j=-.0789123467863741:t[3]>99.50000000000001?j=-.02022281202803071:t[302]>1e-35?t[10]>47.50000000000001?j=.06447639919732716:j=-.05457561977645972:t[306]>1e-35?j=-.029995903305383882:t[191]>1e-35?j=.030596508110850414:t[242]>1e-35?j=-.024085578702020216:t[8]>3198.5000000000005?t[297]>1e-35?j=.09518584795377832:j=-.018197744600833596:t[13]>1e-35?j=.006751790086127549:t[148]>1e-35?j=.01904174573618417:t[99]>1e-35?j=.025287735102561926:t[4]>14.500000000000002?j=-.004364337681643273:t[1]>15.500000000000002?t[35]>1e-35?j=-.09467943982430241:t[243]>1e-35?j=-.02521824751996268:j=.005437570718352172:j=-.022476214821960674;let W;t[0]>384.50000000000006?t[84]>1e-35?W=-.06088131453064195:t[147]>1e-35?W=-.05332792965930566:t[135]>1e-35?t[9]>32.50000000000001?W=.04219361472548491:W=-.07227529211725771:t[10]>4.500000000000001?t[21]>1e-35?W=-.0787279848043689:t[17]>1e-35?t[3]>18.500000000000004?t[188]>1e-35?W=-.054347604504400286:t[0]>3544.5000000000005?t[0]>5850.500000000001?W=-.11431764534511478:W=.013549717238356157:W=-.020987333767091276:t[6]>2.5000000000000004?W=-.02914877855133127:W=.08483464900160231:t[8]>58.50000000000001?t[183]>1e-35?W=-.10087072787978416:t[37]>1e-35?W=-.030467397753331196:t[229]>1e-35?W=-.1017559811057469:t[4]>20.500000000000004?W=-.00413177742240167:t[20]>1e-35?W=.05213315982685969:W=.0037921635866823133:t[8]>51.50000000000001?W=.07327913092421544:t[6]>49.50000000000001?W=-.03457694284156811:t[6]>18.500000000000004?t[7]>17.500000000000004?W=.02744420891894289:W=.11288946357194463:W=.003482908820966248:t[18]>1e-35?t[1]>20.500000000000004?t[7]>4.500000000000001?W=-.012329314369909049:W=.026816658655600168:W=-.0872405354618811:W=.007872673500247845:t[1]>42.50000000000001?W=-.04309044198258254:t[145]>1e-35?W=.07572529147860785:t[7]>5.500000000000001?W=-.013837187093264945:t[1]>17.500000000000004?W=.04208698439539668:W=-.06284346769019863;let X;t[294]>1e-35?X=-.0384794324818203:t[266]>1e-35?X=-.1087205883821061:t[32]>1e-35?t[8]>2302.5000000000005?X=.07432960094940501:X=-.035248735855751855:t[134]>1e-35?X=-.02456191365284949:t[121]>1e-35?t[0]>4720.500000000001?t[1]>39.50000000000001?X=-.01706896375068821:X=.08212247914968074:t[2]>59.50000000000001?X=-.09546478958824225:t[6]>53.50000000000001?X=.12317082897575611:t[1]>56.50000000000001?t[4]>7.500000000000001?t[0]>3560.5000000000005?X=.02816463285971267:X=.15449139016588445:X=-.10199787406123524:X=-.038068684323297096:t[223]>1e-35?t[8]>668.5000000000001?X=-.13924786681478077:X=-.0072772442570213335:t[39]>1e-35?X=-.05392786531177836:t[0]>93.50000000000001?t[40]>1e-35?X=-.054059371343144036:t[306]>1e-35?t[2]>14.500000000000002?t[149]>1e-35?X=-.11174465335620831:X=.00013144040097180107:X=-.08493919336681105:t[42]>1e-35?X=-.11078582572836196:t[84]>1e-35?t[4]>17.500000000000004?X=-.015540659878839153:X=-.14442609417300142:t[21]>1e-35?X=-.025251979447574083:X=.0023698372645272847:t[18]>1e-35?X=.07269739695712212:t[8]>2592.5000000000005?X=-.1460388776448558:t[9]>30.500000000000004?t[1]>23.500000000000004?X=-.01835130329646532:t[9]>45.50000000000001?X=.02023047454629885:X=.16469378262221102:X=-.042975030085836426;let oe;t[8]>2915.5000000000005?t[297]>1e-35?oe=.06257393915394144:t[0]>93.50000000000001?t[4]>1.5000000000000002?oe=-.01034964686484714:oe=-.07357437440667927:oe=-.11987794734779106:t[298]>1e-35?t[8]>81.50000000000001?t[0]>3370.5000000000005?t[8]>155.50000000000003?t[8]>660.5000000000001?t[8]>2134.5000000000005?oe=-.09476398869062203:t[9]>72.50000000000001?oe=-.0757383854264379:oe=.02806542779508718:oe=-.05147742568418084:oe=.10212721564444344:oe=.0518263760642861:oe=-.08743405377022222:t[189]>1e-35?t[0]>5269.500000000001?oe=-.10669213185972036:oe=.027050434286384796:t[302]>1e-35?oe=-.0407832394672723:t[116]>1e-35?t[10]>38.50000000000001?oe=.06354599160071946:t[1]>67.50000000000001?oe=.05317447949011187:oe=-.059138165935307165:t[212]>1e-35?t[19]>1e-35?oe=-.09369289448773599:t[0]>2215.5000000000005?oe=.04077965380363924:t[0]>807.5000000000001?oe=-.0591771776458298:oe=.057315736906679376:t[308]>1e-35?t[1]>52.50000000000001?t[5]>3749.5000000000005?oe=-.016323380219241672:oe=.007291062979527741:t[210]>1e-35?t[8]>1641.5000000000002?oe=.03720704290087811:oe=-.008730548158766654:t[4]>80.50000000000001?oe=-.05346644687473197:oe=.014596824736762107:t[218]>1e-35?t[3]>3.5000000000000004?oe=.019984510398089086:oe=-.03917825025861855:t[9]>170.50000000000003?oe=-.09759719821334525:oe=-.0023586682752856298;let te;t[183]>1e-35?t[17]>1e-35?te=.030100940443356424:t[10]>1.5000000000000002?te=-.10861112216742408:te=.017680668976453255:t[227]>1e-35?t[17]>1e-35?t[2]>16.500000000000004?te=-.032062878390325456:te=-.10808232631806887:t[8]>1641.5000000000002?te=-.06147013392655731:t[4]>12.500000000000002?te=.03324767551088266:t[145]>1e-35?te=.028851633810612017:te=-.054871239091792784:t[134]>1e-35?te=-.023813968121342108:t[266]>1e-35?te=-.10037039667146351:t[222]>1e-35?t[0]>612.5000000000001?t[10]>1e-35?t[8]>1939.5000000000002?te=-.055566877553100726:t[2]>24.500000000000004?t[8]>182.50000000000003?t[10]>43.50000000000001?t[10]>55.50000000000001?te=-.025350325484720576:te=.1579024598549572:t[9]>2.5000000000000004?t[0]>3746.5000000000005?te=.056817276537534815:te=-.07674158463557636:te=-.06335553143454145:t[1]>56.50000000000001?te=.16390494217299284:te=-.0027330160430847177:t[10]>36.50000000000001?t[8]>1067.5000000000002?te=.041717597065890205:te=-.10357913492269129:t[10]>29.500000000000004?te=.1365512866715726:te=.020600048310575665:te=.09708785634773187:te=-.060427658852305666:t[126]>1e-35?t[10]>32.50000000000001?t[6]>24.500000000000004?t[8]>1146.5000000000002?te=-.03146213719547347:te=.11784024316238083:te=-.050940520532045355:te=-.047988344143075616:t[191]>1e-35?te=.028764654731460032:te=.0011911575567860023;let re;t[294]>1e-35?t[10]>50.50000000000001?re=-.11630092297244568:t[0]>2432.5000000000005?t[0]>4199.500000000001?re=-.05103908560370243:re=.05002066201169583:re=-.09976646725732496:t[32]>1e-35?t[0]>4242.500000000001?re=-.0648838712201258:t[5]>3721.5000000000005?t[9]>4.500000000000001?re=.127983140816313:re=-.05436534163636867:re=-.024514536544596455:t[121]>1e-35?t[0]>4449.500000000001?t[4]>9.500000000000002?re=-.009504203657088933:t[8]>819.5000000000001?re=.18689664822602375:re=.03635576744011826:re=-.029862411809998525:t[223]>1e-35?re=-.06474496692999487:t[86]>1e-35?t[8]>65.50000000000001?t[1]>46.50000000000001?re=-.09405026597863717:t[0]>4153.500000000001?re=.053577663326799765:re=-.05062127873995668:re=.06512222894425874:t[39]>1e-35?re=-.04985311717827547:t[51]>1e-35?re=-.04541229517934797:t[178]>1e-35?t[2]>25.500000000000004?t[2]>30.500000000000004?t[0]>2151.5000000000005?re=-.02860634573675884:re=.08863753005590103:re=.11158892111063744:t[0]>655.5000000000001?re=-.031005736641654926:re=-.1439827004505974:t[222]>1e-35?t[1]>11.500000000000002?t[0]>612.5000000000001?re=-.00843386136334982:re=-.05273594615999777:re=.1060183822015004:t[126]>1e-35?t[10]>32.50000000000001?t[8]>719.5000000000001?re=-.015774115523598486:re=.10147367091236065:re=-.048307000563071016:re=.002118376117677254;let pe;t[8]>1014.5000000000001?t[9]>137.50000000000003?pe=-.10279096288817871:t[0]>93.50000000000001?t[8]>1067.5000000000002?t[227]>1e-35?pe=-.03544332389470493:t[285]>1e-35?t[9]>64.50000000000001?pe=.07211107542565391:pe=-.041556776020476104:t[145]>1e-35?t[1]>66.50000000000001?pe=-.0751486415451188:t[1]>59.50000000000001?pe=.13459005084554104:pe=.024184371850147466:t[0]>3072.5000000000005?t[95]>1e-35?pe=.06715575425741895:pe=-.005895690393702183:t[8]>2915.5000000000005?pe=-.010205039411753762:t[9]>33.50000000000001?t[9]>47.50000000000001?pe=-.00029068886245881074:pe=.0613467393188786:t[148]>1e-35?pe=-.06074463294936236:t[3]>1.5000000000000002?t[5]>1849.5000000000002?t[1]>15.500000000000002?pe=.003887223773199377:pe=-.08553893131979015:pe=.025654192706396767:pe=-.05651733979610658:pe=-.02039913645229667:t[2]>7.500000000000001?pe=-.1058450646728524:pe=.02267192191610376:t[1]>120.50000000000001?t[2]>60.50000000000001?pe=-.12304707569000428:t[1]>132.50000000000003?t[6]>41.50000000000001?pe=.1283258201586378:pe=-.01718135372229775:pe=-.07702452408491414:t[125]>1e-35?pe=-.0804612900572707:t[178]>1e-35?t[0]>4533.500000000001?pe=.04273051857848212:pe=-.04533122948101463:t[2]>196.50000000000003?pe=-.10543331044088727:t[94]>1e-35?t[5]>4532.500000000001?pe=.0231032972703664:pe=-.04807386814498683:pe=.002729435991332102;let Ae;t[179]>1e-35?Ae=-.08065315471211375:t[183]>1e-35?t[17]>1e-35?Ae=.026484626664041125:t[10]>1.5000000000000002?Ae=-.10187000872941615:Ae=.015274190652133752:t[84]>1e-35?t[9]>6.500000000000001?t[2]>43.50000000000001?Ae=.09574540795390041:Ae=-.06454986703691233:Ae=-.11411849349353141:t[266]>1e-35?Ae=-.09281838517322076:t[32]>1e-35?t[8]>2302.5000000000005?Ae=.06685250330182936:t[4]>67.50000000000001?t[2]>97.50000000000001?Ae=-.04403391373512386:Ae=.1132928075412222:t[2]>47.50000000000001?Ae=-.09700191391838056:Ae=-.02147184357182825:t[10]>4.500000000000001?t[21]>1e-35?Ae=-.0735617817957859:t[17]>1e-35?t[3]>18.500000000000004?Ae=-.001668912999010927:Ae=-.02363511102970245:t[8]>58.50000000000001?Ae=-.00035213368294640616:t[3]>17.500000000000004?t[2]>28.500000000000004?t[10]>23.500000000000004?t[1]>38.50000000000001?Ae=.0911011436534449:t[1]>28.500000000000004?Ae=-.07192390493729035:Ae=.06913818091291246:Ae=-.012312625373699222:Ae=.06784496312307986:Ae=-167756936027735e-19:t[18]>1e-35?t[8]>302.50000000000006?Ae=.0026564453057705273:Ae=-.025425772389361445:t[122]>1e-35?Ae=-.12046786388602149:t[0]>3183.5000000000005?Ae=.01162092842804907:t[91]>1e-35?Ae=.07000265526928563:t[1]>22.500000000000004?t[0]>576.5000000000001?Ae=-.0001647792543020228:Ae=-.023664538532907665:Ae=.01609078206180752;let Oe;t[294]>1e-35?t[1]>26.500000000000004?t[0]>4141.500000000001?Oe=-.051473645433684705:t[0]>3030.5000000000005?t[1]>51.50000000000001?Oe=-.017696526862422682:Oe=.1450050954613223:Oe=-.05406930069823832:Oe=-.08308700260259043:t[120]>1e-35?Oe=.058316269489189415:t[297]>1e-35?t[94]>1e-35?Oe=-.07425512495167255:t[8]>51.50000000000001?t[1]>13.500000000000002?t[1]>33.50000000000001?t[19]>1e-35?t[0]>4498.500000000001?Oe=.038431826961746934:Oe=-.05937462906539856:t[9]>65.50000000000001?Oe=.10814845712507865:t[4]>9.500000000000002?t[2]>22.500000000000004?t[1]>39.50000000000001?t[1]>44.50000000000001?t[10]>44.50000000000001?Oe=.12297945639231944:t[0]>3796.5000000000005?t[4]>26.500000000000004?Oe=-.09579030954062734:Oe=.025064711572811746:Oe=.02579440518821548:Oe=.1044440128091862:Oe=-.058348633139536844:Oe=.07766788227934436:Oe=-.01021229539092708:t[2]>2.5000000000000004?t[10]>29.500000000000004?t[0]>3770.5000000000005?t[0]>4438.500000000001?Oe=.07463684068207214:Oe=.18244269035484484:t[6]>39.50000000000001?Oe=-.06050050067471004:Oe=.05787759066913493:Oe=.010783225857972171:Oe=.1674891243602606:t[4]>9.500000000000002?Oe=-.004814132027475892:Oe=-.14543299413454813:Oe=-.02935093398687923:t[116]>1e-35?t[9]>2.5000000000000004?t[8]>1218.5000000000002?Oe=-.07634466313617769:Oe=.0287825335169114:Oe=-.06894721943300268:Oe=-.00023988459059521937;let Te;t[131]>1e-35?t[1]>93.50000000000001?Te=-.05706887458825395:t[2]>1.5000000000000002?Te=.011446637886629108:Te=-.10616119878749211:t[230]>1e-35?t[4]>6.500000000000001?t[0]>4977.500000000001?Te=.08424281276381033:t[3]>17.500000000000004?t[20]>1e-35?Te=.11146885439601915:t[8]>61.50000000000001?t[0]>3530.5000000000005?t[9]>48.50000000000001?t[9]>61.50000000000001?Te=.026278724448495064:Te=.17053138400480508:t[0]>4463.500000000001?Te=-.06482289890096041:Te=.03026516489536295:Te=-.031785170717683144:Te=.1312690622980455:t[13]>1e-35?Te=.14336922540461444:Te=.03523850945454039:Te=-.015407465968975714:t[39]>1e-35?Te=-.054809635385158186:t[32]>1e-35?t[0]>4242.500000000001?Te=-.0659975068798723:Te=-.008386582621403979:t[4]>60.50000000000001?t[10]>75.50000000000001?t[3]>107.50000000000001?Te=-.04225314193574262:t[3]>70.50000000000001?t[1]>29.500000000000004?Te=.057409156184759516:Te=.2024322059866388:Te=-.030670938454461245:t[10]>1e-35?t[0]>4733.500000000001?Te=.010648654146284154:t[308]>1e-35?Te=.008728141696325391:t[4]>64.50000000000001?t[298]>1e-35?Te=.12364025998551711:Te=-.02247495081065243:t[1]>22.500000000000004?Te=-.0726295464624251:Te=.03481895086048152:t[0]>4331.500000000001?Te=-.04775443357020673:Te=.07172377425057568:t[2]>89.50000000000001?Te=-.11782645274716962:Te=.00010092665257989378;let Je;t[147]>1e-35?Je=-.041560228567115574:t[302]>1e-35?t[10]>47.50000000000001?Je=.062292114082780084:t[10]>5.500000000000001?t[7]>22.500000000000004?Je=-.016101990375700172:t[0]>2579.5000000000005?Je=-.13045089661551845:Je=-.02874367814784938:Je=.025835149631944995:t[167]>1e-35?t[0]>3928.5000000000005?Je=.17084176915326055:Je=-.019195947948312853:t[222]>1e-35?t[30]>1e-35?t[1]>36.50000000000001?t[8]>45.50000000000001?t[8]>578.5000000000001?t[1]>67.50000000000001?Je=.10591712319944074:Je=-.024082167264285:Je=.16497698867036126:Je=-.04985066326861431:t[0]>1937.5000000000002?t[2]>16.500000000000004?Je=-.021012910475524206:Je=-.13058422554298485:t[0]>1102.5000000000002?Je=.10955864175201457:Je=-.03566689354348996:t[1]>11.500000000000002?Je=-.02093884208606101:Je=.09107244766183857:t[126]>1e-35?t[10]>32.50000000000001?t[8]>719.5000000000001?Je=-.013861861436128482:Je=.09756849802202777:t[224]>1e-35?t[1]>51.50000000000001?Je=.10163873449625677:Je=-.02779270277623805:t[1]>26.500000000000004?Je=-.08035058228527389:Je=.0005719695099064484:t[191]>1e-35?t[9]>9.500000000000002?Je=-.007028075523033826:Je=.0489470913925288:t[1]>61.50000000000001?t[132]>1e-35?Je=.11230846723576784:t[0]>350.50000000000006?t[2]>1.5000000000000002?Je=-.0032075580718124892:Je=-.04442829143298883:Je=-.06597073245775804:Je=.0015594090939337751;let Fe;t[223]>1e-35?t[8]>668.5000000000001?Fe=-.12803889879260094:Fe=.002171373740016862:t[121]>1e-35?t[0]>4720.500000000001?t[217]>1e-35?Fe=.08967966612917375:t[1]>39.50000000000001?Fe=-.059791671514498074:Fe=.05648934961902822:t[2]>59.50000000000001?Fe=-.08633234097449628:t[6]>53.50000000000001?Fe=.11140345067444689:t[1]>56.50000000000001?t[4]>7.500000000000001?t[0]>3560.5000000000005?Fe=.025606129643140924:Fe=.13835395886271978:Fe=-.09361630641448024:t[4]>7.500000000000001?t[1]>26.500000000000004?t[1]>49.50000000000001?Fe=-.09975506556937946:t[10]>36.50000000000001?Fe=-.09427724661655643:t[10]>24.500000000000004?Fe=.07329330653410447:Fe=-.02271182965807972:Fe=-.09767874967639482:t[6]>13.500000000000002?t[10]>23.500000000000004?Fe=-.05082091374050816:Fe=.1687114435254966:t[0]>2314.5000000000005?Fe=-.06422664016383926:Fe=.0636688376664789:t[298]>1e-35?t[9]>12.500000000000002?t[133]>1e-35?Fe=-.06857762517406195:t[9]>71.50000000000001?t[0]>4188.500000000001?Fe=-.1274167728754332:Fe=.01308079126447365:t[4]>73.50000000000001?Fe=.13854015371106546:t[4]>48.50000000000001?Fe=-.03684255740123261:t[6]>45.50000000000001?Fe=.10329912215813097:t[10]>77.50000000000001?Fe=-.08630788656925215:Fe=.031022006843800853:t[1]>25.500000000000004?Fe=-.08278381528048026:Fe=.06664374548141594:t[84]>1e-35?Fe=-.05624227409079396:Fe=.00012184182357340415;let lt;t[179]>1e-35?lt=-.07443348719246982:t[40]>1e-35?t[0]>1937.5000000000002?lt=-.07595415373151816:lt=.054065040429292326:t[134]>1e-35?t[11]>1e-35?t[2]>13.500000000000002?t[0]>1187.5000000000002?lt=.022822510448266862:lt=.17491569312933697:lt=-.058362287133533565:t[2]>2.5000000000000004?lt=-.03633895806364428:lt=.06397808186120692:t[8]>4968.500000000001?t[1]>31.500000000000004?lt=-.07294848747514579:lt=.025053613105805606:t[230]>1e-35?t[4]>6.500000000000001?t[107]>1e-35?lt=-.07009535282685533:t[8]>2640.0000000000005?lt=-.051761240111316276:t[131]>1e-35?lt=-.06245774419231631:lt=.03495606662854905:lt=-.013863522184803188:t[131]>1e-35?t[1]>93.50000000000001?t[1]>105.50000000000001?lt=.0015036626973581122:lt=-.12505706794835883:t[1]>48.50000000000001?t[276]>1e-35?lt=.10435171369790015:t[0]>5026.500000000001?t[0]>5308.500000000001?lt=.022343994371919224:lt=-.14087991797693533:t[8]>1323.5000000000002?t[10]>49.50000000000001?lt=.07724450228328664:t[0]>3853.5000000000005?lt=-.15671707454435677:t[10]>28.500000000000004?lt=-.10179090671841723:lt=.014878216919760927:lt=.03967665658164865:t[8]>2696.5000000000005?t[15]>1e-35?lt=.14054154485273487:lt=.01821247272493051:t[2]>5.500000000000001?t[2]>100.50000000000001?lt=-.08632985141410315:lt=.005524157938954954:lt=-.08802502622523681:lt=-.0004649168897260341;let _t;t[86]>1e-35?t[8]>65.50000000000001?t[1]>32.50000000000001?t[4]>16.500000000000004?_t=-.007458687464321174:_t=-.09444966249102484:t[1]>23.500000000000004?_t=.08564129697360716:_t=-.07105002902845851:_t=.05688756955238231:t[294]>1e-35?t[10]>50.50000000000001?_t=-.10326216566705966:t[1]>26.500000000000004?_t=.0050539832484585365:_t=-.07080395606126953:t[306]>1e-35?t[149]>1e-35?_t=-.10399433201474328:t[2]>14.500000000000002?t[9]>6.500000000000001?_t=.05783632021087773:t[10]>17.500000000000004?_t=-.06720598671764105:t[1]>47.50000000000001?_t=.097495825172558:_t=-.013372242800584872:_t=-.06463226787713715:t[42]>1e-35?_t=-.0885725817597767:t[204]>1e-35?t[1]>62.50000000000001?_t=-.07496598696848249:t[1]>29.500000000000004?t[8]>446.50000000000006?_t=.11051270080118503:_t=.027719462817590454:t[8]>597.5000000000001?_t=-.08441503592016869:_t=.05534229430302502:t[223]>1e-35?t[8]>668.5000000000001?_t=-.12190088985091102:_t=-.0067442838156576345:t[148]>1e-35?t[9]>79.50000000000001?_t=.09225972475904022:t[2]>10.500000000000002?t[1]>102.50000000000001?_t=.11805676536334647:t[8]>1726.5000000000002?t[9]>10.500000000000002?_t=.016585157185448045:_t=-.11032043771149425:_t=.01586986028570486:t[8]>388.50000000000006?_t=-.10592413013261853:_t=.04930703248769364:t[13]>1e-35?_t=.003621937787920821:_t=-.0013786331198611841;let xt;t[145]>1e-35?t[1]>32.50000000000001?t[1]>38.50000000000001?t[10]>55.50000000000001?t[1]>54.50000000000001?xt=.009769895322846493:xt=-.10620052926943656:t[9]>19.500000000000004?xt=.03781202525403449:t[9]>14.500000000000002?xt=-.11485785321365344:t[9]>6.500000000000001?xt=.07677177833073881:t[0]>4342.500000000001?xt=-.07079285609687631:t[49]>1e-35?xt=.06156814809246001:xt=-.014788509042554625:xt=-.032659201618470655:t[5]>5207.500000000001?xt=-.09013500825185713:t[3]>10.500000000000002?t[8]>1787.5000000000002?xt=-.03094160322187924:t[1]>29.500000000000004?xt=.09474646043921069:xt=.023445783928231618:xt=.09342846694174194:t[0]>533.5000000000001?t[204]>1e-35?t[1]>62.50000000000001?xt=-.07164443768784848:t[1]>29.500000000000004?xt=.089473622509272:t[8]>597.5000000000001?xt=-.08155349903101317:xt=.07098423265024251:t[8]>691.5000000000001?t[5]>2252.5000000000005?xt=-.004003900679358653:t[190]>1e-35?xt=-.09236113461485262:t[8]>3198.5000000000005?xt=-.0124130160451179:xt=.018453070064009328:t[15]>1e-35?xt=.012013209112857824:t[7]>4.500000000000001?t[7]>5.500000000000001?xt=-.0009580759587680961:xt=-.03227283036698222:xt=.01369287669536875:t[1]>50.50000000000001?xt=-.04213060332500437:t[35]>1e-35?xt=-.11508095777767471:t[190]>1e-35?xt=-.08611884672400155:t[297]>1e-35?xt=.05723551879433584:xt=-.004829340082311461;let gt;t[183]>1e-35?gt=-.037994150023203555:t[227]>1e-35?t[17]>1e-35?t[3]>20.500000000000004?t[10]>36.50000000000001?gt=-.11753465135886734:gt=-.007515490299047085:gt=-.08576941990777916:t[8]>1641.5000000000002?t[10]>37.50000000000001?gt=-.12371142493530439:t[1]>36.50000000000001?gt=.032189417575190435:gt=-.10339125953022954:t[3]>32.50000000000001?t[4]>27.500000000000004?t[1]>59.50000000000001?gt=-.0784518658439288:t[2]>54.50000000000001?gt=.12477882322370665:gt=.000313468482399738:gt=.12261955132611434:t[8]>81.50000000000001?t[23]>1e-35?gt=.04969252946760318:t[8]>511.50000000000006?t[8]>1146.5000000000002?gt=.0353146070135579:gt=-.06327619611098285:gt=.02813577701641991:gt=-.12354390728506215:t[34]>1e-35?gt=-.07664408516055397:t[3]>99.50000000000001?t[1]>16.500000000000004?t[1]>26.500000000000004?gt=-.01245803535276381:gt=-.07169472553475001:t[1]>11.500000000000002?gt=.12989984824561698:gt=-.01201544398886606:t[6]>91.50000000000001?t[1]>22.500000000000004?gt=.010390226893521422:t[10]>14.500000000000002?gt=.16790888126487719:gt=.010614982228955577:t[4]>79.50000000000001?t[9]>44.50000000000001?t[0]>3853.5000000000005?gt=-.043398307129729134:gt=.09963544907820426:t[9]>30.500000000000004?gt=-.13540713124984502:t[9]>17.500000000000004?gt=.0509435850590757:gt=-.04761897852404613:t[4]>78.50000000000001?gt=.09197086656470652:gt=.0006771050176682337;let ue;t[122]>1e-35?t[6]>36.50000000000001?ue=.05686884451670743:ue=-.05334759543084309:t[266]>1e-35?ue=-.08603579519816038:t[157]>1e-35?ue=-.06736746113382097:t[302]>1e-35?t[0]>2579.5000000000005?ue=-.0499592651503952:t[0]>725.5000000000001?ue=.11780353905132664:ue=-.05232097173108943:t[147]>1e-35?t[1]>53.50000000000001?ue=-.11398297342629615:t[0]>2604.5000000000005?t[0]>3629.5000000000005?ue=-.03190157229022304:ue=.07985197845805492:ue=-.0763078988943886:t[4]>41.50000000000001?t[280]>1e-35?ue=.05162933940904835:t[11]>1e-35?t[0]>460.50000000000006?ue=-.027174047777029083:ue=.057117284879796476:t[3]>43.50000000000001?ue=-.0016147040913107311:ue=-.05856597304613519:t[2]>45.50000000000001?t[0]>4663.500000000001?t[18]>1e-35?ue=-.04779247091640426:t[10]>25.500000000000004?t[9]>22.500000000000004?t[22]>1e-35?ue=-.01466076988151239:ue=.13375695925484857:ue=-.04885873081899647:t[0]>5566.500000000001?ue=.11086813028591343:t[8]>992.5000000000001?ue=-.07622304217072383:ue=.04316019272026325:t[10]>12.500000000000002?t[9]>36.50000000000001?t[9]>45.50000000000001?ue=.03285858361708423:ue=-.12354858211764992:ue=.0672788301823281:t[15]>1e-35?ue=.08658836986585006:ue=-.02741484278509758:t[290]>1e-35?ue=-.08161310335133287:t[135]>1e-35?ue=-.04824156054814152:ue=.0009156904299554183;let Ue;t[3]>7.500000000000001?Ue=.0006791852818377787:t[129]>1e-35?t[0]>2904.5000000000005?t[0]>4004.5000000000005?Ue=.03642374718166293:Ue=.16379973756366603:Ue=-.03946685266127979:t[186]>1e-35?Ue=.07618896623420895:t[96]>1e-35?Ue=.0680272261319657:t[107]>1e-35?t[1]>48.50000000000001?Ue=-.022822371600847505:Ue=.0501405836324949:t[203]>1e-35?t[1]>77.50000000000001?Ue=.044416424920571296:Ue=-.0648450593196238:t[5]>3921.5000000000005?t[1]>110.50000000000001?Ue=-.11110466767595227:t[9]>5.500000000000001?t[9]>52.50000000000001?t[1]>50.50000000000001?Ue=.1061937286809567:t[7]>54.50000000000001?Ue=.11487507743121311:t[8]>819.5000000000001?Ue=-.07181278009001418:t[10]>25.500000000000004?Ue=.13499019430369633:t[1]>31.500000000000004?Ue=.09032979489780704:Ue=-.12754166393372374:t[9]>37.50000000000001?Ue=-.05093963635361407:Ue=-.005026651151683848:t[9]>2.5000000000000004?Ue=.07619735785573735:Ue=.012363301341532136:t[26]>1e-35?Ue=-.10685800454968203:t[8]>125.50000000000001?t[8]>446.50000000000006?t[0]>3842.5000000000005?Ue=-.08783796894105043:t[282]>1e-35?t[1]>47.50000000000001?t[9]>40.50000000000001?Ue=-.10764172927882483:Ue=.01890760098464703:Ue=.06573095405846417:t[8]>634.5000000000001?Ue=-.00783575973273707:Ue=-.050612689680229306:t[1]>22.500000000000004?Ue=-.0016842490401359626:Ue=.0738227088444087:Ue=-.02663970950432175;let ye;t[31]>1e-35?t[8]>17.500000000000004?ye=.013678038624884814:t[1]>35.50000000000001?t[1]>51.50000000000001?ye=.007191286124908192:ye=-.09347881647636902:t[10]>1.5000000000000002?ye=.07938758708008091:ye=-.008702935600305113:t[224]>1e-35?t[149]>1e-35?t[13]>1e-35?ye=.12321804057595996:ye=-.018281109320672437:t[23]>1e-35?t[4]>62.50000000000001?ye=-.04644244754790671:ye=.024546310702263208:t[8]>862.5000000000001?t[0]>3429.5000000000005?t[4]>9.500000000000002?t[52]>1e-35?ye=.0706108609273337:t[2]>40.50000000000001?ye=-.028046629962303716:ye=-.06497613993109329:ye=.01076489668586676:t[1]>33.50000000000001?t[0]>966.5000000000001?t[2]>14.500000000000002?t[1]>38.50000000000001?ye=-.03056331974267756:ye=-.11886389712497057:ye=.053364962175658184:t[8]>2233.5000000000005?ye=-.0448152521157682:ye=.1508651602190868:t[2]>33.50000000000001?t[0]>2882.5000000000005?t[0]>3183.5000000000005?ye=.03818796510453344:ye=.23673992112982362:ye=.02858814226507374:t[10]>44.50000000000001?ye=-.1125863771551199:ye=.009129996952394916:t[1]>7.500000000000001?ye=-.004374525302461639:ye=-.07858519434925451:t[149]>1e-35?t[6]>23.500000000000004?ye=.0005231594491642136:t[0]>4053.5000000000005?t[8]>660.5000000000001?ye=-.13677189943034931:t[10]>2.5000000000000004?ye=.039591891437078086:ye=-.09312596849507347:ye=-.02423172142089822:ye=.0009836986075266283;let $e;t[189]>1e-35?t[0]>5269.500000000001?$e=-.103183298350443:t[2]>51.50000000000001?$e=.09784373530929913:t[10]>26.500000000000004?t[8]>764.5000000000001?$e=-.05186168947388339:$e=.0496996365539082:t[10]>23.500000000000004?$e=.1404445738719:t[93]>1e-35?$e=.0027146310074558505:t[5]>3821.5000000000005?$e=.002153033152069652:t[4]>2.5000000000000004?$e=.007663539551317215:$e=.13902616832015402:t[298]>1e-35?t[8]>81.50000000000001?t[4]>64.50000000000001?$e=.11498405722487515:t[2]>23.500000000000004?t[0]>2815.5000000000005?t[2]>44.50000000000001?t[4]>42.50000000000001?$e=-.021479467709980358:$e=.09336868994327292:t[1]>22.500000000000004?t[15]>1e-35?$e=.021660293256233334:$e=-.0927396152303864:$e=.0665074081601698:t[0]>1550.5000000000002?$e=.08972407105958534:$e=-.0380796411182682:t[6]>13.500000000000002?t[10]>2.5000000000000004?$e=.06761927942466854:$e=-.015762168112653286:t[17]>1e-35?$e=.10311304131145381:$e=-.017672785252336027:$e=-.08629805732772755:t[1]>24.500000000000004?t[138]>1e-35?$e=-.10638321435298535:$e=.0007073011744385905:t[18]>1e-35?$e=-.027056185501334325:t[145]>1e-35?$e=.023191199677450886:t[9]>33.50000000000001?t[201]>1e-35?$e=.09762140519655171:t[9]>110.50000000000001?$e=-.06581942957595835:t[6]>54.50000000000001?$e=.04959634035251596:$e=.0022616298654554207:$e=-.007437620924990854;let ae;t[179]>1e-35?ae=-.06961998209988884:t[167]>1e-35?t[0]>3928.5000000000005?ae=.1470294450403005:ae=-.01671476793947083:t[187]>1e-35?t[6]>13.500000000000002?t[4]>30.500000000000004?t[13]>1e-35?ae=.07448480853603114:t[0]>1012.5000000000001?t[5]>2883.5000000000005?t[0]>3682.5000000000005?t[5]>4031.5000000000005?t[23]>1e-35?ae=.07965955447707423:t[10]>10.500000000000002?ae=-.09236156404262426:ae=.03396273196231458:ae=-.13246465021467432:ae=.07092822261735353:ae=-.08753829085942:ae=.09409024840640956:t[1]>40.50000000000001?t[8]>984.5000000000001?t[8]>1514.5000000000002?t[8]>2134.5000000000005?ae=.004705878789890202:ae=.13775378964952867:ae=-.04770928980587811:t[10]>29.500000000000004?ae=.011221519891071544:t[0]>3853.5000000000005?ae=.06365381191628273:ae=.15506252245336827:t[1]>37.50000000000001?ae=-.07254777021042061:ae=.026514587757252385:t[308]>1e-35?ae=.04115804816617256:t[10]>26.500000000000004?ae=.02077721353011946:t[5]>3548.5000000000005?ae=-.1280907116663952:ae=-.021974774274438:t[306]>1e-35?ae=-.02700446558079895:t[297]>1e-35?t[212]>1e-35?ae=.07794139136748461:t[7]>5.500000000000001?t[19]>1e-35?ae=-.005710865560475598:t[94]>1e-35?ae=-.06751507982853555:ae=.027250040757588703:t[9]>52.50000000000001?ae=.07060357924595577:ae=-.030297760713011795:ae=-.0006005400085266517;let le;t[113]>1e-35?le=-.07311041707507712:t[40]>1e-35?t[0]>1937.5000000000002?le=-.06996356565314456:le=.04780211300352931:t[10]>52.50000000000001?t[49]>1e-35?le=-.08317707559926495:t[21]>1e-35?le=-.0817284654645976:t[15]>1e-35?t[2]>3.5000000000000004?le=-.010538203005984922:le=.08454819465349446:t[9]>124.50000000000001?le=.09015659250299132:t[7]>15.500000000000002?t[5]>5732.500000000001?le=-.08542251249346582:t[9]>50.50000000000001?le=-.023428882537657472:le=.010042500833979073:le=.020697210754240154:t[10]>28.500000000000004?t[5]>423.00000000000006?t[148]>1e-35?le=.03006025206979096:t[9]>108.50000000000001?le=-.09153851322499747:t[145]>1e-35?t[5]>4814.500000000001?t[2]>38.50000000000001?le=.04222035773042132:le=-.09078149053947535:t[8]>568.5000000000001?t[1]>64.50000000000001?le=-.07209095448054853:le=.028065954981903313:le=.08714651929917122:le=-.006678820669279169:t[10]>40.50000000000001?le=.006982396294941626:le=-.07889649792011418:t[94]>1e-35?t[4]>30.500000000000004?le=-.09351114982645548:t[4]>3.5000000000000004?le=-.004837550129223451:le=-.08324141237464677:t[303]>1e-35?le=.10703037493990825:t[9]>156.50000000000003?le=-.10803018621648303:t[116]>1e-35?le=-.03208302566598311:t[212]>1e-35?t[243]>1e-35?le=.10261721665006701:le=.018994509090668264:le=.0011244262442038839;let qe;t[86]>1e-35?t[8]>65.50000000000001?t[1]>46.50000000000001?qe=-.08404263465005328:t[0]>3682.5000000000005?qe=.041259223920298876:t[1]>29.500000000000004?qe=-.09541257493441671:qe=.001482192721625409:qe=.051541427372951004:t[3]>7.500000000000001?t[157]>1e-35?qe=-.08268996098437432:t[230]>1e-35?qe=.015749498159959817:t[4]>7.500000000000001?t[3]>11.500000000000002?qe=-913218977737457e-19:t[4]>10.500000000000002?qe=-.056334165674005156:t[127]>1e-35?qe=-.0784634021824036:t[2]>9.500000000000002?t[1]>62.50000000000001?qe=-.04231200150318989:t[10]>42.50000000000001?qe=.10182973257894812:qe=.015934763950068445:qe=-.03130938805859397:t[92]>1e-35?t[4]>6.500000000000001?t[1]>51.50000000000001?t[9]>19.500000000000004?qe=-.041117068322885315:qe=.1167767830037126:qe=.13611206992387337:t[10]>41.50000000000001?qe=-.07120286010564107:qe=.022032788063345417:t[8]>1.5000000000000002?t[1]>51.50000000000001?t[9]>72.50000000000001?qe=-.07702290997669524:t[198]>1e-35?qe=.08776558554437136:qe=-.008290740324975692:t[2]>32.50000000000001?qe=.07198457624219955:qe=.005463113714361629:qe=.09414099512900526:t[129]>1e-35?t[0]>2904.5000000000005?t[0]>4004.5000000000005?qe=.03295785445437507:qe=.15140250150674536:qe=-.035613213948910254:t[186]>1e-35?qe=.06849425535860769:t[96]>1e-35?qe=.06028225812727254:qe=-.007582543288662308;let Ne;t[84]>1e-35?t[9]>6.500000000000001?t[2]>43.50000000000001?Ne=.08396556264106572:Ne=-.0562516995099192:Ne=-.10593011018789432:t[183]>1e-35?t[15]>1e-35?Ne=-.09705176473553752:t[7]>18.500000000000004?t[2]>37.50000000000001?Ne=.0052017514017035915:Ne=-.11194119432743639:Ne=.03724337696163019:t[227]>1e-35?t[17]>1e-35?t[2]>16.500000000000004?Ne=-.025692451287403446:Ne=-.09511862672123193:t[8]>1661.5000000000002?t[10]>37.50000000000001?Ne=-.11892250746801664:t[10]>22.500000000000004?Ne=.07548493166973796:Ne=-.05973048107712209:t[4]>12.500000000000002?t[0]>4319.500000000001?t[10]>4.500000000000001?t[10]>37.50000000000001?Ne=.13750699058082427:t[18]>1e-35?Ne=.06535408879552801:Ne=-.054118179035040674:Ne=.1344282838979622:t[0]>3982.5000000000005?Ne=-.10409582202467015:t[19]>1e-35?Ne=.12672850705810795:t[8]>587.5000000000001?t[1]>35.50000000000001?Ne=.012705935670766466:Ne=.14149359442527545:Ne=-.047977876173706004:t[20]>1e-35?Ne=.057945228080337946:t[0]>3642.5000000000005?Ne=-.008726535792122467:Ne=-.08424769891378858:t[34]>1e-35?Ne=-.0699329538228602:t[134]>1e-35?t[11]>1e-35?t[4]>15.500000000000002?t[0]>1187.5000000000002?Ne=.01196849566739346:Ne=.1614642278429876:Ne=-.043022338150701625:t[3]>5.500000000000001?Ne=-.03907848255033881:Ne=.018280601026175593:Ne=.0006654540402589085;let Ee;t[31]>1e-35?t[2]>58.50000000000001?t[9]>1.5000000000000002?Ee=-.01386103677247845:Ee=.11386694333005128:t[4]>27.500000000000004?Ee=-.021862617610091336:t[2]>31.500000000000004?Ee=.0828858469030438:Ee=.006483353475830127:t[224]>1e-35?t[149]>1e-35?t[13]>1e-35?Ee=.11303635767048735:Ee=-.01645525128352694:t[23]>1e-35?t[4]>62.50000000000001?Ee=-.04238798044549342:Ee=.022091190130494303:t[5]>5082.500000000001?Ee=-.04287166152163786:t[8]>862.5000000000001?t[19]>1e-35?Ee=.000660344696244351:t[4]>9.500000000000002?t[0]>1277.5000000000002?Ee=-.04291104140431434:t[17]>1e-35?Ee=.11256797532342613:Ee=-.017206916368289193:Ee=.026482035265709743:t[1]>8.500000000000002?t[11]>1e-35?Ee=.04060606971664621:t[0]>4733.500000000001?t[8]>214.50000000000003?t[5]>4814.500000000001?Ee=.03581712466863222:Ee=.14770264307668884:t[8]>73.50000000000001?Ee=-.13093289429740068:Ee=.042461737442702936:t[52]>1e-35?Ee=.0501831919044939:Ee=-.010450249720465756:Ee=-.0753365425372656:t[149]>1e-35?t[6]>23.500000000000004?Ee=.0005381332165438493:Ee=-.04549431717503909:t[133]>1e-35?t[2]>5.500000000000001?t[8]>698.5000000000001?t[282]>1e-35?Ee=.04849637311285226:Ee=-.036671377119808564:t[0]>421.50000000000006?Ee=.00020968499911058945:Ee=.11636422423182405:Ee=-.12687837788222575:Ee=.0012774367867215346;let je;t[120]>1e-35?je=.04776057572434719:t[229]>1e-35?t[0]>2952.5000000000005?t[0]>3904.5000000000005?je=-.042799574885345304:je=.07412430171193245:je=-.11248270469336048:t[193]>1e-35?je=-.060694220820603384:t[121]>1e-35?t[217]>1e-35?t[0]>4449.500000000001?t[4]>8.500000000000002?je=.028911612178122104:je=.12326369727728437:t[0]>4091.5000000000005?je=-.09370267064141052:t[0]>3519.5000000000005?t[8]>668.5000000000001?je=.1159839898100149:je=-.01924880886585737:t[8]>501.50000000000006?t[10]>16.500000000000004?je=-.0216343737351583:je=-.1220272260878369:t[2]>18.500000000000004?je=.09152924475072398:t[8]>55.50000000000001?je=.039508716651005665:je=-.11714436880423203:t[18]>1e-35?t[9]>2.5000000000000004?je=.06793009902674053:je=-.024060578029812988:t[4]>2.5000000000000004?t[2]>16.500000000000004?t[4]>11.500000000000002?je=-.04391068849624096:je=.04009967593394672:t[8]>1085.5000000000002?je=-.024773826356034825:je=-.13919707884246582:je=.06659278075192335:t[223]>1e-35?t[8]>668.5000000000001?je=-.11567917501901476:je=-.006813640337684114:t[3]>7.500000000000001?je=.0010671269682548076:t[7]>3.5000000000000004?t[1]>33.50000000000001?t[0]>1597.5000000000002?t[10]>1.5000000000000002?je=-.001754586408351048:je=-.055422422450722056:je=-.06090032532532226:t[0]>5269.500000000001?je=.11787981735983527:je=-.00198119768540783:je=.00210412924303036;let tt;t[294]>1e-35?t[10]>50.50000000000001?tt=-.09738558653332406:t[0]>2432.5000000000005?t[0]>4533.500000000001?tt=-.06063239096209816:tt=.03317022411417386:tt=-.08607562321324262:t[120]>1e-35?t[4]>18.500000000000004?tt=-.013608609329298802:tt=.09078000157330264:t[99]>1e-35?tt=.014828708581964632:t[10]>52.50000000000001?t[49]>1e-35?tt=-.07536137260189814:tt=.006253266595455118:t[10]>28.500000000000004?tt=-.006106041147592768:t[9]>156.50000000000003?tt=-.11828932797811101:t[94]>1e-35?tt=-.02566078479505714:t[303]>1e-35?tt=.09544850289775349:t[15]>1e-35?t[224]>1e-35?t[4]>56.50000000000001?tt=-.08401252789168523:t[5]>4244.500000000001?tt=.026372887658499107:t[1]>16.500000000000004?tt=-.027836756345634026:tt=.09205362097909099:tt=.00934612788718244:t[203]>1e-35?tt=-.016371658366767253:t[7]>26.500000000000004?t[0]>966.5000000000001?t[1]>38.50000000000001?t[146]>1e-35?t[9]>21.500000000000004?tt=-.09580979052540028:t[1]>50.50000000000001?tt=-.06402211827281554:tt=.08342858760095972:t[2]>36.50000000000001?tt=.008114897658204584:t[92]>1e-35?tt=.09541587072672864:tt=-.022342147210555434:tt=-.01660492519175128:tt=.014721622240945446:t[4]>25.500000000000004?t[11]>1e-35?tt=.15846731118501817:tt=.039498507912023195:t[245]>1e-35?tt=.07008718676813333:tt=.0019806389728814727;let mt;t[32]>1e-35?t[8]>90.50000000000001?t[4]>67.50000000000001?t[0]>4188.500000000001?mt=-.01192072916082109:mt=.13888590840802637:t[1]>16.500000000000004?t[8]>2302.5000000000005?mt=.06874032717466054:t[4]>40.50000000000001?mt=-.07752510020707537:t[1]>76.50000000000001?mt=-.09944032260703917:t[8]>1381.5000000000002?mt=-.054466635810800745:t[1]>32.50000000000001?mt=.05974084520839573:mt=-.0384718740755954:mt=-.11374190719134032:t[0]>2151.5000000000005?mt=-.13703645155803298:mt=.004833344758654556:t[297]>1e-35?t[212]>1e-35?mt=.06954747264544993:t[7]>9.500000000000002?t[19]>1e-35?t[1]>30.500000000000004?t[0]>4242.500000000001?mt=.013539805885738608:mt=-.0692740641801559:t[0]>2653.5000000000005?t[10]>57.50000000000001?mt=.09941880179344399:mt=-.01608127391210995:mt=.08025226531247417:t[9]>67.50000000000001?mt=.13525448212444113:t[6]>61.50000000000001?mt=-.05511099182158894:t[94]>1e-35?mt=-.06821509831783572:t[128]>1e-35?mt=.11361314817714643:mt=.030160785008575566:t[1]>13.500000000000002?t[8]>17.500000000000004?t[16]>1e-35?mt=-.09954181329804547:t[197]>1e-35?mt=.10102833149755386:t[188]>1e-35?mt=.05584490988313965:t[9]>49.50000000000001?t[4]>5.500000000000001?mt=-.03781554214742005:mt=.09927933385592314:mt=-.020006000056720083:mt=-.10520473615957895:mt=-.12006990846253787:mt=-.00026111570975317574;let Ft;t[8]>2830.5000000000005?t[1]>31.500000000000004?t[9]>32.50000000000001?t[5]>1234.5000000000002?t[0]>1725.5000000000002?t[7]>14.500000000000002?t[2]>38.50000000000001?Ft=-.019188245509744628:Ft=-.13354864350075848:t[0]>2461.5000000000005?Ft=.051885477468354396:Ft=-.0833581968852119:Ft=.08233441701532287:Ft=-.10865584951212362:t[8]>2992.5000000000005?t[10]>49.50000000000001?t[10]>56.50000000000001?t[1]>45.50000000000001?t[0]>2041.5000000000002?Ft=.09926337893072812:Ft=-.027753610497327715:t[0]>1972.5000000000002?Ft=-.09780045823152517:Ft=.032380915168504935:Ft=.11502632261226381:t[17]>1e-35?Ft=-.06094965899579662:t[10]>40.50000000000001?Ft=-.07500475582440802:Ft=.006499832113084677:t[10]>4.500000000000001?t[4]>10.500000000000002?Ft=-.09584538995220808:Ft=-.00908705814304442:Ft=.03203281520813893:t[10]>49.50000000000001?Ft=-.03146271513986384:t[2]>63.50000000000001?Ft=.13172001315536286:t[224]>1e-35?Ft=.08945777550527927:t[0]>2282.5000000000005?t[4]>4.500000000000001?Ft=.09521549382082259:Ft=-.04414925613522197:t[0]>1847.5000000000002?Ft=-.09118580379557353:Ft=.009206744918282364:t[178]>1e-35?t[2]>25.500000000000004?t[1]>31.500000000000004?Ft=.03525144509943896:Ft=-.053340750721609057:t[0]>1057.5000000000002?t[10]>2.5000000000000004?Ft=-.04766112322938157:t[2]>10.500000000000002?Ft=.0728516504357201:Ft=-.05049625965272536:Ft=-.10868663055825774:Ft=.0005382613419948969;let Jt;t[147]>1e-35?t[1]>53.50000000000001?Jt=-.10615739288764095:t[0]>2604.5000000000005?t[0]>3629.5000000000005?Jt=-.030504020655417463:Jt=.07102458639110094:Jt=-.07058131985243714:t[302]>1e-35?t[10]>47.50000000000001?Jt=.055304563442710876:t[1]>53.50000000000001?Jt=.033723409577443623:t[8]>175.50000000000003?t[0]>2628.5000000000005?t[9]>40.50000000000001?Jt=-.1568835288372895:Jt=-.0279829124400056:Jt=.04493843959601833:Jt=-.11637042729644327:t[191]>1e-35?t[282]>1e-35?Jt=-.054133834303687026:t[9]>48.50000000000001?Jt=.11263810289007213:t[9]>9.500000000000002?Jt=-.02202034562838259:t[4]>45.50000000000001?Jt=-.03410927569045158:Jt=.04381615166534081:t[242]>1e-35?t[0]>3615.5000000000005?t[3]>19.500000000000004?t[1]>56.50000000000001?t[4]>28.500000000000004?Jt=-.029687297407295893:Jt=.10673602850001934:t[4]>42.50000000000001?Jt=.0036275562945108117:Jt=-.0760789221330622:Jt=-.10385623431741903:t[2]>34.50000000000001?t[2]>44.50000000000001?t[4]>51.50000000000001?Jt=.08274426793676076:Jt=-.07076234425516396:Jt=.13890177606150175:Jt=-.019863286503635686:t[53]>1e-35?t[18]>1e-35?Jt=-.09250637750836187:Jt=-.0031531727902009026:t[2]>107.50000000000001?t[4]>91.50000000000001?t[1]>16.500000000000004?Jt=-.01897867921812603:Jt=.04890781705365262:Jt=-.11569892307597907:t[2]>106.50000000000001?Jt=.09032697440623969:Jt=.00047935919155035045;let Qt;t[115]>1e-35?Qt=.05338335681275557:t[242]>1e-35?t[0]>3615.5000000000005?t[4]>42.50000000000001?t[4]>75.50000000000001?Qt=-.10131179514695865:t[8]>938.5000000000001?Qt=.10203729808015481:Qt=-.015357944186835289:t[1]>56.50000000000001?t[2]>22.500000000000004?Qt=.03574015165562999:Qt=-.07763042506449493:Qt=-.0813323116215548:t[2]>34.50000000000001?t[2]>44.50000000000001?t[4]>51.50000000000001?Qt=.0665706259130275:Qt=-.06586817559309924:Qt=.11925564412287476:Qt=-.014170019267143326:t[1]>124.50000000000001?t[2]>30.500000000000004?t[8]>533.5000000000001?t[4]>41.50000000000001?t[8]>977.5000000000001?Qt=.046017146627455346:Qt=-.08623321630086885:t[8]>1765.5000000000002?Qt=-.017990564319859934:t[10]>25.500000000000004?t[10]>48.50000000000001?Qt=.11143827902215087:Qt=-.01817808730473413:Qt=.16980985030210127:Qt=-.09357806298740017:t[10]>7.500000000000001?t[10]>54.50000000000001?Qt=.010168994879727824:Qt=-.09099594488792513:t[9]>1.5000000000000002?Qt=.0533459678147928:Qt=-.06886854808370108:t[99]>1e-35?t[17]>1e-35?t[9]>22.500000000000004?Qt=-.062346959148773695:t[1]>47.50000000000001?Qt=-.0021578343835599316:t[2]>27.500000000000004?Qt=.19567373210166172:Qt=.07851555379116423:t[18]>1e-35?Qt=.03711549097804649:t[8]>359.50000000000006?Qt=.012492346746905587:t[4]>20.500000000000004?Qt=.047511695735697544:Qt=-.07999269063948773:Qt=6802045404471004e-20;let zr;t[222]>1e-35?t[0]>612.5000000000001?t[10]>1e-35?t[8]>2167.5000000000005?t[4]>25.500000000000004?zr=.0011484728213539738:zr=-.0936582904650763:t[2]>25.500000000000004?t[8]>182.50000000000003?t[10]>22.500000000000004?t[0]>5026.500000000001?zr=-.09828874964938798:t[8]>1586.5000000000002?zr=.13726397438080162:t[4]>48.50000000000001?t[2]>63.50000000000001?zr=.011938269926919522:zr=.17541983715953954:t[19]>1e-35?zr=.023002786011088672:zr=-.06221461272461431:t[9]>2.5000000000000004?t[0]>3818.5000000000005?zr=.06508934844183291:zr=-.10168553534835639:zr=-.07755626499024171:t[2]>51.50000000000001?t[4]>65.50000000000001?zr=.021140806225203937:zr=-.1167833342453639:t[2]>33.50000000000001?zr=.13163585734056618:zr=-.00203273890889717:t[10]>36.50000000000001?t[8]>1067.5000000000002?zr=.06314479201263888:zr=-.09639088327091713:t[10]>29.500000000000004?zr=.09225469303582386:t[0]>3129.5000000000005?t[0]>4091.5000000000005?t[0]>4354.500000000001?zr=40577156464836036e-21:zr=.12322387121810757:zr=-.03697224045046014:t[1]>22.500000000000004?zr=.016474835887320276:zr=.16919298733903063:zr=.07633203630214054:zr=-.047438037934250644:t[30]>1e-35?t[224]>1e-35?t[1]>52.50000000000001?zr=.14150493354700563:zr=-.01831155354975749:t[1]>28.500000000000004?zr=-.07952557178685365:t[10]>28.500000000000004?zr=.0665695554984927:zr=-.053640139319277094:zr=.0004754840665898665;let Br;t[76]>1e-35?Br=-.06814884255939921:t[179]>1e-35?Br=-.06325743795510681:t[122]>1e-35?t[6]>36.50000000000001?Br=.05052338063261613:t[8]>626.5000000000001?t[1]>38.50000000000001?Br=.004193658608848433:Br=-.1066968975983452:t[8]>302.50000000000006?Br=.05476730110440451:Br=-.06382970920394895:t[218]>1e-35?t[2]>3.5000000000000004?t[6]>13.500000000000002?t[2]>19.500000000000004?t[0]>3200.5000000000005?t[4]>91.50000000000001?Br=-.12156071809840739:t[9]>21.500000000000004?t[5]>3883.5000000000005?t[8]>919.5000000000001?t[8]>1085.5000000000002?Br=.013555772109446666:Br=-.09856116699770784:Br=.0284329611813383:t[2]>52.50000000000001?Br=.04008708444763762:t[9]>29.500000000000004?Br=-.1289599546008197:Br=-.018566534248335896:t[8]>747.5000000000001?Br=.02236484980076122:Br=.1148871655157582:t[8]>3084.0000000000005?Br=-.05573875952902531:t[10]>17.500000000000004?t[2]>51.50000000000001?Br=.03164751204281298:Br=.11752140436184891:t[9]>42.50000000000001?Br=-.07180559595410106:t[22]>1e-35?Br=.09325040416256854:Br=-.016041122807939914:Br=-.02765708954618808:t[1]>30.500000000000004?t[1]>66.50000000000001?Br=-.010718250133458515:Br=.09818827994853763:Br=.010180038981174032:Br=-.039472162599295535:t[9]>170.50000000000003?Br=-.08536729235976731:t[189]>1e-35?t[0]>5269.500000000001?Br=-.08674788057474031:Br=.02077653508548371:Br=-.0003536561382007414;let un;t[86]>1e-35?t[10]>6.500000000000001?t[0]>4376.500000000001?un=.018337297491457794:un=-.05926206443180149:un=.024026520855881126:t[288]>1e-35?t[184]>1e-35?un=.10747078482128616:t[126]>1e-35?un=-.10550625192391357:t[7]>71.50000000000001?un=-.07698346027863572:t[8]>302.50000000000006?t[6]>49.50000000000001?t[4]>47.50000000000001?t[1]>38.50000000000001?t[15]>1e-35?un=.1317396472229434:un=-.025035791351328947:un=-.0728334305864372:t[8]>963.5000000000001?un=.023642201723096064:un=.183010326734258:t[128]>1e-35?un=.04228920135648387:t[2]>34.50000000000001?t[15]>1e-35?un=.002801782941492993:t[3]>40.50000000000001?t[4]>39.50000000000001?un=-.1088876900335281:un=.02758317023002635:un=-.11886771300807207:t[9]>59.50000000000001?t[1]>33.50000000000001?un=-.01928020117446408:un=.10193718474139135:t[1]>48.50000000000001?t[4]>9.500000000000002?t[8]>932.5000000000001?un=.07893723375925096:un=-.009878929627026153:t[10]>2.5000000000000004?t[9]>20.500000000000004?un=-.10301657587280551:un=.005787463140224318:un=.07421364314695046:t[0]>2840.5000000000005?t[10]>29.500000000000004?un=-.019296977889522397:un=-.07274529751752634:t[1]>30.500000000000004?un=-.050368901143148286:un=.029630869489466655:t[2]>6.500000000000001?t[4]>9.500000000000002?un=.0015332402792773946:un=.09930153676749967:un=-.06370844564357069:un=.00042272155209927616;let ve;t[71]>1e-35?t[4]>17.500000000000004?ve=.12586844370423247:ve=-.006791999603126354:t[222]>1e-35?t[1]>10.500000000000002?t[30]>1e-35?t[1]>36.50000000000001?t[9]>1.5000000000000002?t[10]>25.500000000000004?ve=-.08474891624263797:t[8]>125.50000000000001?ve=.08125086980439704:ve=-.04082085238068532:t[0]>3863.5000000000005?ve=.020481535807469208:ve=.14810819386202126:t[0]>1937.5000000000002?t[2]>16.500000000000004?ve=-.019110200161573936:ve=-.12387719685855114:t[0]>1102.5000000000002?ve=.08376595701957407:ve=-.031821919580524834:t[9]>4.500000000000001?ve=-.08116383486497568:t[7]>8.500000000000002?t[2]>24.500000000000004?ve=-.02154820850475448:t[0]>3863.5000000000005?t[8]>902.5000000000001?ve=.1349841206807871:ve=.011864053595560297:t[1]>41.50000000000001?ve=-.08203662486612544:t[2]>18.500000000000004?ve=-.009541865642346947:ve=.08345043168501759:t[2]>10.500000000000002?ve=-.09585031818030947:ve=.019432330487099865:ve=.08399259524715129:t[30]>1e-35?t[224]>1e-35?t[1]>52.50000000000001?ve=.11951517733981365:ve=-.016651014735738538:t[1]>28.500000000000004?ve=-.07410922545030711:t[10]>28.500000000000004?ve=.05886430683844788:ve=-.04929626605117184:t[191]>1e-35?t[9]>9.500000000000002?t[9]>48.50000000000001?ve=.04802269879144705:ve=-.026208212831796737:t[4]>45.50000000000001?ve=-.03227476944664786:ve=.05124575625622705:ve=.00020506696916003137;let Ge;t[116]>1e-35?t[9]>2.5000000000000004?t[9]>17.500000000000004?Ge=-.03042091758483443:t[10]>14.500000000000002?Ge=.09816619204768777:Ge=.01332124067720947:t[8]>8.500000000000002?t[4]>15.500000000000002?Ge=-.02381165060401718:Ge=-.10950361804974783:Ge=.03538211665111128:t[212]>1e-35?t[19]>1e-35?Ge=-.09940014650006174:t[0]>2215.5000000000005?t[5]>5056.500000000001?t[3]>5.500000000000001?t[10]>25.500000000000004?Ge=-.06371052144380579:Ge=.0835500621252692:Ge=-.10408255929333915:t[1]>74.50000000000001?Ge=.13208968122712403:t[1]>64.50000000000001?Ge=-.04778844603644965:t[8]>51.50000000000001?t[8]>201.50000000000003?t[8]>660.5000000000001?t[6]>4.500000000000001?t[9]>5.500000000000001?t[1]>29.500000000000004?t[0]>3830.5000000000005?Ge=.09922816902423433:Ge=.016366955328796718:Ge=.1592412560903584:t[1]>39.50000000000001?Ge=.05409467990258923:Ge=-.08260633210459611:Ge=-.06307205775247567:t[9]>36.50000000000001?Ge=.040253940015648144:Ge=.14202568969471283:Ge=-.028761848341594044:Ge=.08994073058773508:t[0]>807.5000000000001?Ge=-.043427848826323195:Ge=.04573516446846493:t[20]>1e-35?t[188]>1e-35?Ge=-.0758877731600639:t[23]>1e-35?Ge=.05913923322043199:t[8]>155.50000000000003?t[128]>1e-35?Ge=.08124700978741987:Ge=.013296063087086852:t[7]>5.500000000000001?Ge=-.01640196088612987:Ge=-.12685498840146067:Ge=-.0004940792382459551;let pt;t[1]>24.500000000000004?t[103]>1e-35?t[8]>61.50000000000001?t[17]>1e-35?pt=-.05584993681929434:t[9]>27.500000000000004?t[0]>3916.5000000000005?pt=.08513773825688947:pt=-.1184664832315282:pt=.05676963535893477:pt=.14263843210340613:pt=.0005795003292924202:t[18]>1e-35?t[0]>5453.500000000001?t[1]>11.500000000000002?pt=-.10669720555606924:pt=.029016613003137307:t[2]>46.50000000000001?t[10]>9.500000000000002?pt=.0664744575868955:pt=-.08469256188890871:pt=-.026746678040592144:t[281]>1e-35?pt=-.07408427239006925:t[145]>1e-35?t[4]>6.500000000000001?t[9]>16.500000000000004?t[4]>18.500000000000004?pt=.012131807587207655:pt=-.12776015795398743:pt=.04320472481083551:pt=.08390980661550446:t[10]>227.50000000000003?pt=-.09771783809101153:t[10]>130.50000000000003?pt=.11175201938704937:t[8]>779.5000000000001?t[5]>3325.5000000000005?t[128]>1e-35?pt=-.07610698254064358:t[8]>902.5000000000001?pt=-.03136381213599649:t[131]>1e-35?pt=.0704821739127936:t[224]>1e-35?pt=-.056961477774953785:t[10]>30.500000000000004?t[9]>43.50000000000001?pt=.10431473040024908:t[8]>841.5000000000001?pt=.07304745320500514:pt=-.038011541882439825:pt=-.01679746695007364:t[0]>3129.5000000000005?pt=.05589952587431965:t[210]>1e-35?pt=.06227198085800842:pt=-.0011341890997947812:t[8]>740.5000000000001?pt=.04817300084412584:pt=-.000577001010789238;let Tt;t[187]>1e-35?t[6]>12.500000000000002?t[10]>8.500000000000002?t[10]>16.500000000000004?t[8]>234.50000000000003?t[4]>43.50000000000001?t[0]>4476.500000000001?Tt=-.10504730480402079:t[5]>3341.5000000000005?Tt=.11087894671081754:Tt=-.0406668834674614:Tt=.03308382165616109:t[8]>104.50000000000001?Tt=-.10431436764549162:Tt=.0073928337244891455:t[4]>34.50000000000001?Tt=-.10571751512748416:Tt=-.006081128814142983:t[13]>1e-35?Tt=.1299673566095023:t[4]>60.50000000000001?Tt=-.06587492443829139:t[0]>2604.5000000000005?t[3]>19.500000000000004?Tt=.04857126072645073:Tt=-.03431365358104773:t[4]>16.500000000000004?Tt=.04101865986596709:Tt=.16480274980378218:t[10]>26.500000000000004?Tt=.03673978504199255:t[10]>9.500000000000002?Tt=-.10996402743800027:t[308]>1e-35?Tt=.0553693735082498:Tt=-.041600136235644125:t[306]>1e-35?t[8]>1156.5000000000002?t[4]>14.500000000000002?t[10]>21.500000000000004?Tt=.010902983761213922:Tt=.1325118659895645:Tt=-.064362945508595:t[1]>66.50000000000001?Tt=.033416767779331176:Tt=-.054080316225040496:t[42]>1e-35?Tt=-.07762364337810815:t[10]>1089.5000000000002?Tt=-.08465599849125216:t[31]>1e-35?t[8]>30.500000000000004?Tt=.012788520036013586:t[1]>32.50000000000001?t[1]>51.50000000000001?Tt=.0220102041325908:Tt=-.06516708740003069:Tt=.012833498905748267:t[224]>1e-35?Tt=-.007038418272997865:Tt=.00037666304316290967;let or;t[84]>1e-35?t[9]>6.500000000000001?t[2]>43.50000000000001?or=.07554189644995735:or=-.052089349455904946:or=-.10148206848169845:t[113]>1e-35?or=-.06666678653225779:t[39]>1e-35?t[9]>3.5000000000000004?t[0]>3670.5000000000005?or=.07172653627995676:or=-.07602959317610998:or=-.08790686271287523:t[229]>1e-35?t[0]>2952.5000000000005?t[0]>3904.5000000000005?or=-.0399322883690891:or=.06523495517476098:or=-.10358715295743802:t[193]>1e-35?or=-.05551414334329124:t[134]>1e-35?t[11]>1e-35?t[2]>13.500000000000002?t[10]>1.5000000000000002?or=.015928764772252406:or=.1341513061552287:or=-.04975001987586173:t[10]>2.5000000000000004?t[3]>5.500000000000001?t[9]>2.5000000000000004?t[8]>310.50000000000006?or=-.033592997607280156:or=-.12432458028446665:t[1]>32.50000000000001?t[217]>1e-35?or=-.08402551858097379:or=.017401984506038796:t[1]>25.500000000000004?or=.13337205393591278:or=-.01160208350090984:or=.06708317942315471:t[8]>227.50000000000003?or=-.08486943882418681:or=-.013970104864235007:t[8]>4968.500000000001?t[1]>31.500000000000004?t[9]>4.500000000000001?or=-.10496268177586783:or=-.020921489532370493:or=.02629915927247642:t[7]>20.500000000000004?t[8]>251.50000000000003?t[115]>1e-35?or=.11639296062157028:or=-.004275784356569115:t[32]>1e-35?or=-.07297384970166025:or=.006026841626381599:or=.002034611134960428;let Zt;t[248]>1e-35?Zt=.06091438745093315:t[0]>384.50000000000006?t[204]>1e-35?t[1]>62.50000000000001?Zt=-.06455513326540585:t[1]>29.500000000000004?Zt=.07718474591552532:t[4]>7.500000000000001?Zt=.040139336931404826:Zt=-.09685734690563386:Zt=.00015327283570347363:t[9]>88.50000000000001?Zt=.10079017954199324:t[1]>47.50000000000001?t[2]>20.500000000000004?t[2]>27.500000000000004?Zt=-.04077257804338707:Zt=.0739963982640615:t[9]>1.5000000000000002?t[17]>1e-35?Zt=.03778141591008941:Zt=-.06459919920634845:Zt=-.11193190957880604:t[7]>6.500000000000001?t[11]>1e-35?t[18]>1e-35?Zt=.14063930759326346:t[0]>179.50000000000003?Zt=.07287482250668585:t[8]>1180.5000000000002?Zt=-.14419393112726253:t[10]>28.500000000000004?Zt=-.07993142770099469:t[17]>1e-35?Zt=-.04702595410391655:t[7]>21.500000000000004?t[2]>26.500000000000004?Zt=.05527969663610186:Zt=-.10824385941441346:t[3]>11.500000000000002?Zt=.12358502961047915:Zt=-.017509147119622873:t[0]>74.50000000000001?Zt=-.014907705458730486:t[8]>95.50000000000001?Zt=-.02225118168342062:Zt=-.1222374623708485:t[8]>1.5000000000000002?t[8]>950.5000000000001?Zt=.06946188930925638:t[3]>6.500000000000001?t[10]>2.5000000000000004?t[19]>1e-35?Zt=.04962819555610421:Zt=-.07213577821855309:Zt=.09139529824708481:t[19]>1e-35?Zt=.013439401088345224:Zt=-.049274647207292056:Zt=.10531673719686951;let Tr;t[40]>1e-35?t[0]>1937.5000000000002?Tr=-.06421671152073961:Tr=.04235421241226177:t[294]>1e-35?t[10]>50.50000000000001?Tr=-.09100102290316286:t[0]>3030.5000000000005?t[0]>4177.500000000001?Tr=-.03520420769287065:t[8]>1085.5000000000002?Tr=-.019817352506127633:Tr=.11444439424520964:Tr=-.06854631664538167:t[120]>1e-35?t[4]>18.500000000000004?Tr=-.010490117519863269:Tr=.08104430117757461:t[121]>1e-35?t[243]>1e-35?Tr=.16408304891242204:t[217]>1e-35?t[0]>4449.500000000001?Tr=.06619344145920268:t[0]>4091.5000000000005?Tr=-.08813353450871053:t[0]>3519.5000000000005?t[8]>668.5000000000001?Tr=.10016091391222309:Tr=-.017407607199427293:t[8]>501.50000000000006?t[10]>16.500000000000004?Tr=-.019511460451434884:Tr=-.11643672465055221:t[2]>18.500000000000004?Tr=.07848228087333317:t[8]>55.50000000000001?Tr=.032583027899956235:Tr=-.11209832692153521:t[11]>1e-35?Tr=.027482174104412567:t[10]>1.5000000000000002?t[6]>26.500000000000004?t[4]>19.500000000000004?t[9]>31.500000000000004?Tr=-.09996887746328006:t[9]>2.5000000000000004?Tr=.02157682011863397:Tr=-.05247727848991843:Tr=.07409150201483244:t[1]>38.50000000000001?Tr=-.11378466075449625:t[224]>1e-35?Tr=-.10741749127732923:t[1]>26.500000000000004?Tr=.07343136534146562:Tr=-.07013573628594773:t[25]>1e-35?Tr=-.04626669734164317:Tr=.05518333197956482:Tr=.00032434010867555516;let fr;t[183]>1e-35?t[10]>1.5000000000000002?t[17]>1e-35?fr=.026313251010808853:fr=-.08997339150292381:fr=.025062509535227952:t[227]>1e-35?t[1]>6.500000000000001?t[2]>9.500000000000002?t[210]>1e-35?fr=.08071107515789745:t[23]>1e-35?t[1]>75.50000000000001?fr=.0905155504503746:t[8]>1049.5000000000002?fr=-.062312558183394054:t[8]>719.5000000000001?fr=.09583836191410239:t[0]>3719.5000000000005?fr=-.0778097309430818:fr=.04012012419054895:t[4]>12.500000000000002?t[8]>1496.5000000000002?t[10]>42.50000000000001?fr=-.12920865648544927:t[0]>2699.5000000000005?fr=-.07086587879041864:fr=.022614182502461846:t[4]>15.500000000000002?t[8]>55.50000000000001?t[1]>60.50000000000001?t[8]>652.5000000000001?fr=-.11377786322600797:fr=-.009486325820117998:t[1]>55.50000000000001?fr=.12430248795958142:t[0]>2952.5000000000005?t[0]>4331.500000000001?t[1]>38.50000000000001?fr=-.07938291201004219:t[2]>36.50000000000001?fr=.01520046732530246:fr=.13649854049662832:fr=-.07145015938528873:t[8]>407.50000000000006?fr=-.00350257360822279:fr=.11332047082193297:fr=-.10060624458629897:fr=.05429496612497562:t[8]>1446.5000000000002?fr=.006073419197482838:fr=-.08718676350883998:fr=-.11532497988252638:fr=.10766270463068293:t[34]>1e-35?fr=-.06345912440611544:t[131]>1e-35?t[9]>1.5000000000000002?fr=-.0004109812623829506:fr=.021601073497455662:fr=-7343540098965853e-20;let rr;t[298]>1e-35?t[9]>12.500000000000002?t[133]>1e-35?rr=-.06107663265515864:t[9]>70.50000000000001?t[10]>37.50000000000001?rr=.05995640200798119:t[0]>3443.5000000000005?rr=-.14698883458733583:rr=-.030039164579240187:t[189]>1e-35?rr=-.06086763220538141:t[1]>86.50000000000001?rr=-.05096727866142538:t[4]>64.50000000000001?rr=.11240554253834577:t[4]>45.50000000000001?rr=-.030279760168394117:t[6]>45.50000000000001?rr=.10161088917815142:t[10]>77.50000000000001?rr=-.0792333078055653:t[7]>23.500000000000004?t[0]>2882.5000000000005?rr=-.06672020005240323:rr=.08831457502630258:t[8]>2592.5000000000005?rr=-.052617701047376654:t[10]>29.500000000000004?rr=.08499327690298047:t[2]>12.500000000000002?t[9]>41.50000000000001?rr=.12880460816709416:t[9]>25.500000000000004?t[4]>11.500000000000002?rr=-.064099222705728:rr=.044332487521538365:t[0]>2882.5000000000005?rr=.031099546885005065:rr=.12938467051623853:t[0]>4221.500000000001?rr=-.0928676413498701:t[9]>30.500000000000004?rr=-.05781824812803708:rr=.07561268901778094:t[8]>711.5000000000001?t[2]>22.500000000000004?rr=-.06648105454098469:rr=.05985487552383097:rr=-.13070190291919334:t[116]>1e-35?t[10]>38.50000000000001?rr=.05282385499619401:t[1]>66.50000000000001?rr=.048802929108006314:t[2]>4.500000000000001?t[0]>4593.500000000001?rr=.027885690791379255:rr=-.08407126408362446:rr=.014432924125571093:rr=-9903435845205118e-20;let ur;t[76]>1e-35?ur=-.06307875292162934:t[21]>1e-35?t[7]>10.500000000000002?t[10]>4.500000000000001?t[8]>944.5000000000001?t[0]>3655.5000000000005?ur=.013633653464240465:ur=-.10164319411983509:ur=-.1228424374328996:t[1]>26.500000000000004?t[2]>28.500000000000004?ur=.00632864847804078:ur=-.08393000368134668:ur=.07870508617440916:t[284]>1e-35?ur=.1092302727710421:ur=-.0025505047582483234:t[248]>1e-35?ur=.07101822393621864:t[274]>1e-35?ur=-.06621099406425579:t[1]>26.500000000000004?t[1]>28.500000000000004?ur=.0003077044909372931:t[10]>2.5000000000000004?t[0]>3770.5000000000005?ur=.025081789181021243:ur=-.014813325803582618:t[9]>33.50000000000001?ur=-.033466921233840194:t[3]>12.500000000000002?t[23]>1e-35?ur=.11926990418060353:ur=.01852125513565268:ur=.0975367595927343:t[5]>3325.5000000000005?t[8]>892.5000000000001?t[133]>1e-35?ur=-.1178464984373743:t[283]>1e-35?ur=.043370859226927405:t[5]>4320.500000000001?ur=-.01103141226366587:t[8]>1104.5000000000002?ur=-.023053423988095886:ur=-.0734238953804657:t[6]>18.500000000000004?t[8]>85.50000000000001?ur=.000579145585864887:ur=.03389152834202143:t[128]>1e-35?ur=-.14527722052568462:t[210]>1e-35?ur=-.08915971541902741:t[7]>9.500000000000002?ur=-.03307314577076116:t[18]>1e-35?ur=-.05521712302023565:ur=.009315605032770029:ur=.0036332551852289933;let nr;t[0]>689.5000000000001?t[5]>768.5000000000001?t[20]>1e-35?t[5]>4368.500000000001?nr=-.07583539600416284:t[188]>1e-35?nr=-.07042659515500142:t[23]>1e-35?t[0]>3807.5000000000005?nr=-.011038193049597113:nr=.08154028164397753:t[1]>85.50000000000001?nr=.10259361975201933:nr=.011640408330521594:nr=-.00023319159023748508:t[92]>1e-35?nr=.13771692859530546:nr=.022860029819654806:t[1]>22.500000000000004?t[1]>24.500000000000004?t[2]>96.50000000000001?nr=.09967230141007705:t[30]>1e-35?nr=-.08888529037551285:nr=-.008615931385397808:t[10]>5.500000000000001?t[4]>36.50000000000001?nr=.08284665960761373:nr=-.029292565021289504:t[7]>7.500000000000001?nr=-.09945093355204493:nr=-.008381393701708593:t[20]>1e-35?nr=-.04218678460370465:t[10]>6.500000000000001?t[9]>2.5000000000000004?t[1]>13.500000000000002?t[8]>143.50000000000003?t[4]>7.500000000000001?t[2]>36.50000000000001?nr=.07585582641438211:t[8]>284.50000000000006?nr=-.029387993239886723:nr=.07716738177321587:t[1]>18.500000000000004?nr=.026745348497993746:nr=.1427429617069753:t[9]>16.500000000000004?t[9]>33.50000000000001?nr=.02337306890530338:nr=-.10390355904767366:nr=.07390521199638532:nr=-.06788247515155237:nr=-.04201446383470994:t[2]>25.500000000000004?t[2]>29.500000000000004?t[8]>227.50000000000003?nr=-.06360325615644084:nr=.04342192339836601:nr=-.10598779152030145:nr=.05253384605768211;let Mr;t[3]>7.500000000000001?t[157]>1e-35?Mr=-.07514182877923786:Mr=.000636205502279271:t[129]>1e-35?t[0]>2904.5000000000005?t[0]>4004.5000000000005?Mr=.028692053800951845:Mr=.14081686716133598:Mr=-.03316566526940354:t[186]>1e-35?t[0]>2653.5000000000005?Mr=.0037139292567243084:Mr=.12662311031652707:t[107]>1e-35?t[0]>612.5000000000001?Mr=.01202688580305612:Mr=.0993509141454483:t[203]>1e-35?t[1]>77.50000000000001?Mr=.043935495082738626:Mr=-.05639305759669704:t[247]>1e-35?Mr=-.06770766046891649:t[105]>1e-35?t[19]>1e-35?Mr=.10331836202616368:Mr=.0006926658459781341:t[96]>1e-35?Mr=.05361846065599475:t[127]>1e-35?t[0]>2723.5000000000005?t[1]>54.50000000000001?Mr=-.0741403257305367:Mr=.022900127535540854:t[7]>3.5000000000000004?Mr=.038110741403836294:Mr=.14618649985842758:t[5]>3921.5000000000005?t[1]>110.50000000000001?Mr=-.09552842289807008:t[1]>27.500000000000004?Mr=.012505935885798007:Mr=-.020509603428689526:t[282]>1e-35?t[9]>45.50000000000001?t[6]>5.500000000000001?Mr=-.1046104767723845:Mr=.031388606992301074:t[8]>114.50000000000001?t[9]>17.500000000000004?t[9]>22.500000000000004?t[1]>32.50000000000001?Mr=.023466328488582572:Mr=.11730925774586994:Mr=-.04771965631104874:Mr=.17059689880751394:Mr=-.08181850955999449:t[26]>1e-35?Mr=-.12727482696678769:Mr=-.014343123272734182;let Kr;t[147]>1e-35?t[1]>53.50000000000001?Kr=-.0993064321015924:t[0]>2604.5000000000005?t[0]>3629.5000000000005?Kr=-.02763546051134888:Kr=.06423344777499343:Kr=-.064606430904295:t[302]>1e-35?t[10]>2.5000000000000004?t[10]>47.50000000000001?Kr=.049825139823021586:t[7]>22.500000000000004?Kr=-.01131680751379858:t[0]>2579.5000000000005?Kr=-.10673674485369694:Kr=-.015387212937189957:Kr=.04347325151148724:t[179]>1e-35?Kr=-.05788885608624092:t[84]>1e-35?t[9]>6.500000000000001?t[2]>43.50000000000001?Kr=.0650355590939066:Kr=-.0473332870892226:Kr=-.09699315983340703:t[288]>1e-35?t[88]>1e-35?Kr=.11139543329789044:t[126]>1e-35?Kr=-.09726928633696198:t[8]>149.50000000000003?t[9]>46.50000000000001?t[4]>1.5000000000000002?t[8]>1861.5000000000002?Kr=.06370903833231022:t[10]>29.500000000000004?Kr=.03415223859607161:t[10]>3.5000000000000004?Kr=-.07415518117873297:Kr=-.0014119203473324082:Kr=.12617652343819508:t[9]>41.50000000000001?Kr=-.10311145857176976:t[8]>2757.5000000000005?Kr=-.08106484219011428:t[7]>71.50000000000001?Kr=-.09783384432091176:t[1]>88.50000000000001?Kr=.06249739709782831:t[3]>9.500000000000002?t[5]>1601.5000000000002?Kr=-.008884084501608536:Kr=.061339437777743616:Kr=-.042490992675121846:t[2]>6.500000000000001?t[3]>10.500000000000002?Kr=.01526664064166223:Kr=.13534828515415498:Kr=-.06985484465894776:Kr=.0005758961943178744;let sn;t[86]>1e-35?t[1]>23.500000000000004?t[1]>29.500000000000004?t[4]>16.500000000000004?t[2]>31.500000000000004?sn=-.029152732370514342:sn=.07173628916139178:t[1]>36.50000000000001?sn=-.08859111297255318:sn=.0018030071815630785:sn=.13652461563759322:sn=-.07550137680349367:t[10]>52.50000000000001?t[49]>1e-35?sn=-.07145140450454163:t[21]>1e-35?sn=-.07422841663493233:sn=.006289319702780104:t[10]>40.50000000000001?t[9]>59.50000000000001?t[19]>1e-35?t[13]>1e-35?sn=.11864240653986852:t[3]>33.50000000000001?sn=-.08821209591953476:sn=.05706392280054726:sn=-.03600088051578915:t[18]>1e-35?t[1]>24.500000000000004?sn=.01953613016837112:sn=-.059781039130025006:t[148]>1e-35?sn=.052668447861325476:t[3]>30.500000000000004?t[9]>49.50000000000001?sn=.07207826841738371:t[202]>1e-35?sn=.08163917539410503:sn=-.01319846363832958:t[9]>35.50000000000001?t[5]>4134.500000000001?t[10]>44.50000000000001?sn=-.06858280496900336:sn=-.1781828899516648:sn=-.04024620133969553:t[9]>10.500000000000002?t[1]>22.500000000000004?t[1]>37.50000000000001?sn=.018232649414147116:sn=-.04419781124222661:sn=.05145485182416554:t[1]>23.500000000000004?t[0]>655.5000000000001?t[5]>4901.500000000001?t[10]>45.50000000000001?sn=.11452368095776105:sn=-.036496437259924026:sn=-.040445338739465486:sn=.0816572651001145:sn=-.08968914517368663:sn=.0002826343082585516;let Cn;t[189]>1e-35?t[0]>5269.500000000001?Cn=-.08839493050459957:t[10]>85.50000000000001?Cn=.10046908365702462:t[8]>2592.5000000000005?Cn=-.09632233975926387:t[8]>2000.5000000000002?Cn=.10282992953871627:t[8]>1266.5000000000002?t[9]>34.50000000000001?Cn=.035504970430426296:t[1]>31.500000000000004?Cn=-.1133764813142531:Cn=-.01138280942244812:t[8]>1125.5000000000002?Cn=.09800530246229806:Cn=.016170419267589393:t[218]>1e-35?t[9]>99.50000000000001?t[9]>101.50000000000001?t[9]>124.50000000000001?Cn=.07316772160107896:Cn=-.059095014819051765:Cn=.17859437315769733:t[2]>1.5000000000000002?t[9]>86.50000000000001?Cn=-.09150209066166894:t[8]>3084.0000000000005?Cn=-.05443972593168094:t[1]>65.50000000000001?t[10]>11.500000000000002?t[9]>33.50000000000001?Cn=-.04449234460408263:Cn=.05568837973347338:Cn=-.12362324875024472:t[1]>41.50000000000001?t[10]>12.500000000000002?t[8]>1336.5000000000002?Cn=.12741077850267066:Cn=.007372371864985329:t[2]>39.50000000000001?Cn=.02295917234617787:Cn=.14966532083907075:t[1]>39.50000000000001?Cn=-.06685557815340279:t[10]>22.500000000000004?t[2]>52.50000000000001?Cn=-.02511861881285652:t[1]>27.500000000000004?Cn=.08683660011672288:Cn=.02956214835267301:t[9]>15.500000000000002?Cn=-.016538805462996232:Cn=.04352738094981517:Cn=-.05561856645643868:t[9]>170.50000000000003?Cn=-.07996752635874248:t[179]>1e-35?Cn=-.09065975936933919:Cn=-.00042817975060427177;let ii;t[39]>1e-35?t[4]>25.500000000000004?ii=.03443173196222934:ii=-.06554248341270724:t[32]>1e-35?t[8]>90.50000000000001?t[4]>67.50000000000001?t[4]>86.50000000000001?ii=-.0013415395759330318:ii=.12950978489563347:t[1]>22.500000000000004?t[10]>19.500000000000004?t[4]>30.500000000000004?t[9]>41.50000000000001?ii=.002297618040307216:ii=-.12522800128774994:t[4]>8.500000000000002?t[8]>1075.5000000000002?ii=-.015297257305397608:ii=.09651828834062742:ii=-.06636003334371929:t[10]>11.500000000000002?ii=.17631616138309397:t[0]>1639.5000000000002?ii=3804386478092585e-20:ii=-.09099296398683193:ii=-.06874415876172972:t[0]>2151.5000000000005?ii=-.1311264883406766:ii=.00809052010141122:t[253]>1e-35?ii=-.06338558211939296:t[178]>1e-35?t[2]>25.500000000000004?t[2]>30.500000000000004?t[0]>2151.5000000000005?t[10]>10.500000000000002?t[0]>3615.5000000000005?ii=.045038497754638605:ii=-.07770167665661752:ii=-.08596294280650517:ii=.08538655727027213:ii=.09829076418590559:t[1]>39.50000000000001?t[9]>1.5000000000000002?ii=.054627956617973275:t[1]>61.50000000000001?ii=-.11994465088415499:t[4]>8.500000000000002?ii=.06676200239406452:ii=-.027503148069376867:t[8]>676.5000000000001?ii=-.10363964928357075:t[4]>8.500000000000002?ii=-.07589816227175682:ii=.034664436544646814:t[1]>159.50000000000003?t[6]>25.500000000000004?ii=.009093153189012338:ii=-.06119765876605404:ii=.0004668642103528348;let Rn;t[223]>1e-35?t[1]>31.500000000000004?t[8]>711.5000000000001?Rn=-.10100794502567233:Rn=.08000205636470442:Rn=-.11945419826856896:t[113]>1e-35?Rn=-.06105445938688056:t[167]>1e-35?t[0]>3928.5000000000005?Rn=.1224302423880318:Rn=-.01875566982911468:t[222]>1e-35?t[1]>8.500000000000002?t[1]>24.500000000000004?t[4]>3.5000000000000004?t[0]>725.5000000000001?t[0]>1682.5000000000002?t[0]>2860.5000000000005?Rn=.0019277012166729114:t[1]>28.500000000000004?Rn=-.054445821715687494:Rn=.045645722976713245:t[30]>1e-35?Rn=.13402660155331655:Rn=.008921176001777645:Rn=-.058547426505451076:Rn=.08841202222426625:t[1]>22.500000000000004?t[10]>9.500000000000002?Rn=-.13526418192218206:Rn=-.03266013432583145:t[1]>20.500000000000004?t[4]>27.500000000000004?Rn=.0007263224246135398:Rn=.12450043268647056:t[1]>17.500000000000004?t[9]>1.5000000000000002?Rn=-.11575657261278308:Rn=-.01530376565862095:t[4]>13.500000000000002?t[4]>22.500000000000004?Rn=-.01995960178292952:Rn=.11216586049153021:Rn=-.10050961087149474:Rn=.08848063368485726:t[30]>1e-35?t[224]>1e-35?t[1]>52.50000000000001?Rn=.10303451081526649:Rn=-.01375730267020699:t[1]>28.500000000000004?t[2]>20.500000000000004?Rn=-.043799548968209395:Rn=-.12451444314954115:t[4]>12.500000000000002?Rn=-.03838117361958468:Rn=.06504990789767144:t[57]>1e-35?Rn=.06890006938293915:Rn=.0003914274695562949;let ti;t[53]>1e-35?t[4]>11.500000000000002?t[8]>617.5000000000001?t[2]>41.50000000000001?ti=.004271749009686975:ti=-.10523878297127605:ti=.04633982158107851:ti=-.10349713975483057:t[183]>1e-35?t[15]>1e-35?ti=-.08655730561951676:t[8]>919.5000000000001?ti=-.0676453705610183:t[7]>18.500000000000004?ti=-.027787974193650575:ti=.08012784576991301:t[227]>1e-35?t[1]>6.500000000000001?t[3]>8.500000000000002?t[210]>1e-35?ti=.07185850683316512:t[8]>201.50000000000003?t[8]>348.50000000000006?t[23]>1e-35?t[8]>1049.5000000000002?ti=-.03473877164537313:t[8]>719.5000000000001?ti=.10471053866934404:ti=.008236107678382981:t[4]>57.50000000000001?ti=.09412219478825269:t[10]>66.50000000000001?ti=-.13884338641811986:t[10]>19.500000000000004?t[10]>22.500000000000004?t[0]>2490.5000000000005?ti=-.040681323751002293:ti=.06374650297561021:ti=.12884615227401788:t[10]>5.500000000000001?ti=-.0887517295786972:t[8]>597.5000000000001?t[18]>1e-35?ti=-.05474068967150784:ti=.03744700650806603:ti=-.07846396348680855:t[1]>42.50000000000001?ti=.018972315810821302:ti=.10953621007604744:t[5]>4439.500000000001?ti=.010999776705494586:t[1]>40.50000000000001?ti=-.12394200059775967:t[10]>2.5000000000000004?ti=.013528093962849453:ti=-.09222088417048682:ti=-.12662967149701485:ti=.09327296405849603:t[3]>99.50000000000001?ti=-.013581954439986752:ti=.0005526498251862075;let an;t[187]>1e-35?t[243]>1e-35?an=-.08392792551692502:t[10]>68.50000000000001?an=.07871769409454053:t[10]>8.500000000000002?t[10]>16.500000000000004?t[2]>17.500000000000004?t[3]>31.500000000000004?t[91]>1e-35?t[10]>21.500000000000004?t[10]>33.50000000000001?t[10]>48.50000000000001?an=-.0825306209711224:an=.049559996084532945:an=-.1064938580886302:an=.03353240732240275:an=.045985370399163464:t[1]>42.50000000000001?t[4]>20.500000000000004?an=.16966001471529374:t[1]>57.50000000000001?an=-.005772777673676247:an=.09383677041525058:t[8]>747.5000000000001?an=.054068175469351235:an=-.049968216310277036:t[8]>753.5000000000001?an=-.0679383555784074:t[4]>8.500000000000002?an=-.059757341189735386:an=.05701083682780414:an=-.052497281448921164:t[6]>12.500000000000002?t[8]>969.5000000000001?t[4]>23.500000000000004?an=.05820296128730006:an=-.1063042385102475:t[1]>49.50000000000001?t[8]>302.50000000000006?an=.15340611616954566:an=.04385036188666874:t[0]>4449.500000000001?an=-.02110897605541555:t[1]>24.500000000000004?t[2]>17.500000000000004?an=.004840354641006495:an=.09967827580276283:an=.11605363537391578:t[9]>19.500000000000004?an=-.0735831692725717:an=.019973331823355176:t[306]>1e-35?t[149]>1e-35?an=-.08968948874343531:t[8]>1094.5000000000002?t[10]>15.500000000000002?an=-.02442182361342386:an=.10334853004243093:an=-.030431948680167104:an=-956078595250818e-19;let Jn;t[294]>1e-35?t[1]>26.500000000000004?t[0]>4078.5000000000005?Jn=-.040232505718244854:t[0]>3030.5000000000005?Jn=.0634109586813073:Jn=-.04043617034245621:Jn=-.06385323610738443:t[120]>1e-35?t[4]>18.500000000000004?Jn=-.007859096946435131:Jn=.07282728486115758:t[229]>1e-35?t[0]>2952.5000000000005?t[17]>1e-35?Jn=.05515771679628051:Jn=-.04214471312668263:Jn=-.09589322222261765:t[193]>1e-35?Jn=-.05056345906812831:t[121]>1e-35?t[243]>1e-35?Jn=.14857706653119385:t[4]>9.500000000000002?t[1]>26.500000000000004?t[2]>59.50000000000001?Jn=-.08152604001147906:t[11]>1e-35?Jn=.09132936522356462:t[15]>1e-35?t[4]>23.500000000000004?Jn=.13100930780107503:t[10]>25.500000000000004?Jn=.05921074710011526:Jn=-.07226005736695183:t[0]>3304.5000000000005?t[0]>3707.5000000000005?t[0]>4053.5000000000005?Jn=.0009447118243153454:Jn=-.09820565036865991:Jn=.057146909749745546:t[0]>2115.5000000000005?Jn=-.12331216726611678:Jn=.007281983677694285:t[2]>56.50000000000001?Jn=.012310154675612615:Jn=-.08873665774670461:t[6]>25.500000000000004?Jn=.134708740821879:t[9]>5.500000000000001?Jn=-.0805901581148979:t[224]>1e-35?Jn=-.063684477784257:t[7]>2.5000000000000004?t[19]>1e-35?Jn=.10842593386554122:t[2]>13.500000000000002?Jn=.06466798320378395:Jn=-.08578130788886655:Jn=-.03590892078300114:Jn=.0003499894043880708;let Pe;t[134]>1e-35?t[6]>50.50000000000001?t[0]>3601.5000000000005?Pe=.10839808814624702:Pe=-.028043875308180352:t[7]>30.500000000000004?t[8]>932.5000000000001?Pe=-.007478368069393829:Pe=-.09066751344326617:t[0]>3588.5000000000005?t[5]>4748.500000000001?Pe=.04035247751736232:t[0]>4255.500000000001?Pe=-.1310865624507367:t[0]>4004.5000000000005?Pe=.06647367311982634:Pe=-.08339693352955757:t[4]>10.500000000000002?t[1]>34.50000000000001?Pe=-.011618902907510411:Pe=.1114646660406691:t[10]>2.5000000000000004?t[0]>3072.5000000000005?Pe=.09356028223727986:Pe=-.03811765057032162:Pe=-.09456215497345526:t[280]>1e-35?t[7]>70.50000000000001?Pe=.10322956436499003:t[2]>22.500000000000004?t[1]>83.50000000000001?Pe=.1146142460964847:t[1]>62.50000000000001?Pe=-.09679869865322362:t[9]>71.50000000000001?Pe=-.07377580769927583:t[4]>19.500000000000004?t[0]>4571.500000000001?Pe=-.039046426387852974:Pe=.04558778688367152:Pe=.11220830937352602:t[7]>5.500000000000001?t[9]>17.500000000000004?t[8]>1067.5000000000002?Pe=.03261697816211156:t[15]>1e-35?Pe=.02586252542264368:t[2]>14.500000000000002?Pe=-.016420452667484604:Pe=-.1011799626006976:Pe=-.13787471318963773:t[6]>4.500000000000001?t[8]>427.50000000000006?t[10]>36.50000000000001?Pe=.010193588102560583:Pe=.11748729525930773:Pe=-.04468162226743652:Pe=-.028365274393617957:t[71]>1e-35?Pe=.05115139346588793:Pe=-.0001510425316936658;let K;t[298]>1e-35?t[8]>81.50000000000001?t[8]>119.50000000000001?t[4]>64.50000000000001?K=.09072192054181037:t[9]>72.50000000000001?t[8]>1094.5000000000002?K=.020637047900190317:K=-.1017300802134141:t[1]>23.500000000000004?t[9]>12.500000000000002?t[0]>2815.5000000000005?t[0]>3183.5000000000005?t[3]>23.500000000000004?t[3]>45.50000000000001?t[4]>48.50000000000001?K=-.04632587527094407:K=.08603684785510396:K=-.05101401015448496:K=.025466432054358498:K=-.07897811963329214:t[6]>13.500000000000002?t[10]>26.500000000000004?K=.020385355430046367:K=.12032592051335252:K=-.012387370292173013:t[2]>23.500000000000004?K=-.12568545484492677:K=-.022261190943521976:t[8]>634.5000000000001?t[8]>857.5000000000001?K=.043528764484784536:K=.14352071657196003:K=-.009332833816977268:K=.11186782227735846:K=-.0737365712425554:t[136]>1e-35?t[0]>1937.5000000000002?K=-.05649104643152564:K=.03884200719305747:t[42]>1e-35?K=-.07191700385792335:t[116]>1e-35?t[9]>2.5000000000000004?t[9]>17.500000000000004?K=-.04103416502526736:K=.04881823954656287:t[4]>15.500000000000002?K=.009342724662897898:t[0]>3969.5000000000005?K=-.025637309961309498:K=-.12574492012987865:t[212]>1e-35?t[19]>1e-35?K=-.08185697075265091:t[0]>2215.5000000000005?K=.030063975892297354:t[0]>807.5000000000001?K=-.03924325550733229:K=.0415330999189793:K=-.00024374664461674863;let Ce;t[3]>7.500000000000001?Ce=.0005117490419655908:t[129]>1e-35?t[0]>2904.5000000000005?t[0]>4004.5000000000005?Ce=.025798416259686565:Ce=.13251610353146012:Ce=-.029900559552677654:t[1]>81.50000000000001?t[1]>110.50000000000001?t[0]>4242.500000000001?Ce=-.11098564237775424:Ce=25960925309712775e-21:t[0]>4177.500000000001?t[9]>35.50000000000001?Ce=.15347826616466054:t[3]>4.500000000000001?Ce=.10379320730958941:Ce=-.008896303020010654:t[0]>3415.5000000000005?t[0]>3830.5000000000005?Ce=.03159791088468647:Ce=-.10612873364104258:Ce=.05059856107348746:t[133]>1e-35?t[2]>5.500000000000001?Ce=-.02335760775001469:Ce=-.1379386577903324:t[1]>62.50000000000001?t[3]>2.5000000000000004?Ce=-.011164334474672973:Ce=-.06594044410501655:t[207]>1e-35?Ce=-.1014214372326535:t[8]>3.5000000000000004?t[107]>1e-35?t[2]>6.500000000000001?Ce=-.01725821503981916:Ce=.05594086838700241:t[203]>1e-35?t[1]>44.50000000000001?t[1]>51.50000000000001?Ce=-.04226531631656534:Ce=-.14409800530171432:Ce=-.03245576341206398:t[8]>4214.500000000001?Ce=.0895409165534886:t[247]>1e-35?Ce=-.06506383629143335:t[118]>1e-35?Ce=-.07214270121257443:t[8]>546.5000000000001?Ce=-.004385020865473831:Ce=.009321812545248529:t[0]>1639.5000000000002?t[13]>1e-35?Ce=.046278501133958524:Ce=-.030835570926968044:t[0]>493.50000000000006?Ce=-.12794504651610425:Ce=.009415039807550776;let Ie;t[304]>1e-35?Ie=-.04717777269217453:t[76]>1e-35?Ie=-.05813439142128324:t[1]>59.50000000000001?t[0]>350.50000000000006?t[53]>1e-35?Ie=-.09648224457374217:t[132]>1e-35?Ie=.07089308107910267:t[0]>2248.5000000000005?t[5]>2525.5000000000005?t[9]>1.5000000000000002?t[114]>1e-35?Ie=-.08595213071749083:t[9]>14.500000000000002?t[9]>33.50000000000001?t[285]>1e-35?Ie=.10838431695638147:t[230]>1e-35?Ie=.06458713915750626:t[0]>3219.5000000000005?t[3]>23.500000000000004?t[9]>69.50000000000001?Ie=.050071316251979:Ie=-.006356941111525215:t[6]>8.500000000000002?Ie=-.0384814076434817:t[1]>73.50000000000001?t[0]>3746.5000000000005?Ie=.10217402850540398:Ie=-.048840949025349197:Ie=-.03668313197909846:t[7]>39.50000000000001?Ie=-.0562642841496003:t[10]>2.5000000000000004?Ie=.09749777369987417:Ie=-.04848223121417616:t[0]>5453.500000000001?Ie=.08316648226133942:Ie=-.0261979698267618:t[212]>1e-35?Ie=.09565573198318654:t[5]>4814.500000000001?t[8]>963.5000000000001?t[8]>1514.5000000000002?Ie=.04837009746506856:Ie=-.09184360565631328:Ie=.0032411047845613606:t[0]>4733.500000000001?Ie=.0977378556864798:Ie=.010776545559325588:Ie=-.012483310473120218:Ie=-.049284121449103935:Ie=.011962641341789565:t[1]>67.50000000000001?t[1]>77.50000000000001?Ie=-.08380361910948711:Ie=.07375088778585813:Ie=-.1084864186071348:Ie=.0007819503469605476;let F;t[7]>17.500000000000004?t[115]>1e-35?F=.08741852531696623:t[167]>1e-35?F=.10078975495600809:F=-.0018324767784017562:t[290]>1e-35?F=-.0850089851255888:t[74]>1e-35?t[10]>16.500000000000004?F=.1379733311640402:F=-.0038500648529631075:t[6]>29.500000000000004?t[8]>876.5000000000001?t[0]>3129.5000000000005?t[9]>5.500000000000001?t[8]>1765.5000000000002?F=-.09360083033774169:F=.061471353193188374:t[10]>11.500000000000002?t[10]>31.500000000000004?F=-.015599362579530679:t[0]>4593.500000000001?F=-.12029549262691491:F=-.018917032256501397:F=.04632831686576592:F=.06892347785444271:t[4]>8.500000000000002?t[10]>33.50000000000001?F=-.05894883236412263:F=.05213944998315824:F=.12621779223564986:t[243]>1e-35?t[6]>16.500000000000004?t[0]>4141.500000000001?t[0]>5850.500000000001?F=.07577412405680808:F=-.053144737214742235:t[1]>29.500000000000004?t[9]>16.500000000000004?F=-.0277076900736147:t[1]>65.50000000000001?F=-.023587471585763506:F=.10184896592433082:F=-.057699270527916825:F=-.041191811945739454:t[114]>1e-35?t[2]>23.500000000000004?F=.06566902102799584:t[10]>25.500000000000004?F=-.07033633753181047:F=-.01599120398351932:t[242]>1e-35?t[0]>2402.5000000000005?F=-.08108035861059537:F=.04184690010531078:t[35]>1e-35?t[0]>2904.5000000000005?F=-.12431182772561139:F=.01886235886984271:F=.0025579594894418116;let D;t[8]>2915.5000000000005?t[101]>1e-35?D=.08648323956719083:t[0]>93.50000000000001?t[196]>1e-35?D=-.09509320772734361:t[4]>1.5000000000000002?t[5]>1106.5000000000002?t[5]>1191.5000000000002?t[283]>1e-35?D=-.11268313808648661:t[10]>12.500000000000002?t[131]>1e-35?D=.0687641681341721:t[10]>102.50000000000001?D=-.09667920080214842:t[4]>15.500000000000002?t[8]>2992.5000000000005?t[1]>24.500000000000004?t[1]>71.50000000000001?D=-.06762578396473291:t[10]>65.50000000000001?D=-.05226727783610509:t[282]>1e-35?D=.09911438410640917:t[19]>1e-35?D=.06915156336429933:D=-.006565637886508241:D=-.08344300251849307:D=-.0928863907927501:t[1]>60.50000000000001?t[2]>17.500000000000004?D=.19428463865406298:D=.016073883020956765:t[13]>1e-35?D=.06864077097923665:D=-.01388867527034731:t[0]>1847.5000000000002?D=.004655280608161356:t[1]>40.50000000000001?D=.031406054057765996:D=.12798062439212832:D=.09859670536264255:t[10]>2.5000000000000004?t[9]>68.50000000000001?D=.08821759640665892:t[9]>32.50000000000001?t[8]>3960.0000000000005?t[1]>31.500000000000004?D=-.0706095614785733:D=.04227164041372561:D=-.1056906923176064:t[2]>8.500000000000002?t[19]>1e-35?D=-.07139533369873902:D=.008952586782921625:D=.06086212582180936:D=-.0816938490403437:D=-.051224901945956025:D=-.10525399124186095:D=.000270924147208224;let ee;t[122]>1e-35?t[0]>2461.5000000000005?t[2]>36.50000000000001?ee=.029186512383291244:t[7]>1.5000000000000002?ee=-.14984127276725573:t[1]>40.50000000000001?ee=.032757060730648144:ee=-.07675575422749602:t[6]>8.500000000000002?ee=.10599766037117893:ee=-.0541423394552156:t[1]>24.500000000000004?t[103]>1e-35?t[8]>61.50000000000001?t[17]>1e-35?ee=-.051394622947855385:ee=.03237141302699347:ee=.12526173027943244:ee=.000579473126472788:t[18]>1e-35?t[3]>4.500000000000001?t[3]>6.500000000000001?t[0]>5453.500000000001?ee=-.07383912482657777:t[0]>5147.500000000001?ee=.07008813937042091:t[10]>38.50000000000001?ee=-.06779203808365307:ee=-.013782769999524498:ee=.0880038869117715:ee=-.12846294176070952:t[281]>1e-35?ee=-.06810806903850834:t[10]>227.50000000000003?ee=-.08937977001661111:t[10]>130.50000000000003?ee=.10538920632708033:t[145]>1e-35?t[4]>6.500000000000001?t[9]>16.500000000000004?t[4]>18.500000000000004?ee=.011036530162093841:ee=-.11500797478569702:ee=.03702229366129399:ee=.07242026683784307:t[189]>1e-35?ee=.03331407112090286:t[9]>33.50000000000001?t[201]>1e-35?ee=.08979610115743614:t[7]>57.50000000000001?t[1]>20.500000000000004?ee=-.02608892716555304:ee=.09609599320761308:t[9]>105.50000000000001?ee=-.06848127135991534:ee=.0023675721254089715:t[86]>1e-35?ee=-.11049635625500497:ee=-.004847764219432233;let ge;t[125]>1e-35?t[0]>3969.5000000000005?ge=-.09462233499115416:ge=.05235324508465096:t[17]>1e-35?t[49]>1e-35?t[10]>19.500000000000004?ge=-.030700661288166148:ge=.0870883677166864:t[10]>3.5000000000000004?t[3]>18.500000000000004?t[0]>3544.5000000000005?t[188]>1e-35?t[9]>7.500000000000001?ge=.03149547314036763:ge=-.08166208257451366:t[0]>5850.500000000001?ge=-.10228136324773157:t[102]>1e-35?ge=-.10572585290676295:t[8]>726.5000000000001?t[5]>3657.5000000000005?ge=.01782894842128785:t[13]>1e-35?ge=.002680190260979968:ge=.1773965720476949:t[2]>72.50000000000001?ge=.09090831938627947:t[1]>59.50000000000001?ge=-.12297206702816128:t[0]>4977.500000000001?ge=.09899015653118268:ge=-.022207141540838887:t[4]>32.50000000000001?t[1]>34.50000000000001?ge=-.0675900954187773:ge=.012336403425364092:ge=-.0017002325391924573:t[6]>7.500000000000001?t[1]>17.500000000000004?ge=-.02671721777458802:ge=-.09242452991958029:t[284]>1e-35?ge=-.08585691288582491:ge=.013332890564324447:t[4]>14.500000000000002?ge=-.005245022074799553:t[23]>1e-35?ge=-.020036720167235768:t[1]>29.500000000000004?t[114]>1e-35?ge=-.09289852307936758:t[116]>1e-35?ge=-.09686573010015055:t[8]>804.5000000000001?ge=.03812547148215318:ge=.005162744968176633:t[9]>43.50000000000001?ge=-.059246106396159376:ge=.050370113808135275:ge=.000794041852811028;let _e;t[3]>7.500000000000001?_e=.0004981426543104341:t[9]>114.50000000000001?_e=.05666010099424601:t[129]>1e-35?t[6]>3.5000000000000004?_e=-.019061766497948867:_e=.07193491146561211:t[186]>1e-35?t[0]>2653.5000000000005?_e=-.006044199577160493:_e=.1147136801028133:t[6]>85.50000000000001?t[8]>847.5000000000001?_e=.11486607015912494:t[9]>16.500000000000004?_e=-.08686820858087294:_e=.06119632492911875:t[127]>1e-35?t[0]>2723.5000000000005?t[0]>3682.5000000000005?t[1]>38.50000000000001?_e=-.022230207980026437:_e=.1056683690528792:_e=-.05859530800943035:_e=.06970608927597141:t[7]>3.5000000000000004?t[105]>1e-35?_e=.08073568184886762:t[107]>1e-35?t[2]>6.500000000000001?_e=-.05177544573528314:_e=.05370469772149028:t[1]>35.50000000000001?t[0]>4106.500000000001?t[9]>46.50000000000001?t[0]>4633.500000000001?_e=.15159657923771555:_e=-.0060542654587671055:t[9]>5.500000000000001?_e=-.042808028205051786:t[1]>48.50000000000001?_e=-.010449538258110742:_e=.10026907521968294:_e=-.04249349329714756:t[9]>42.50000000000001?t[1]>19.500000000000004?t[8]>852.5000000000001?_e=-.02272452389409874:_e=-.11202691218244319:t[5]>1809.5000000000002?_e=-.04460413584255906:_e=.08196329474205256:t[10]>69.50000000000001?_e=.10221481166238167:_e=.0004063052701699382:t[243]>1e-35?_e=-.07563941678849846:t[18]>1e-35?_e=.02563513231103432:_e=-.004740081147303786;let ut;t[84]>1e-35?t[9]>6.500000000000001?t[2]>43.50000000000001?ut=.057446442918106:ut=-.04404018270156349:ut=-.09282976714550464:t[0]>384.50000000000006?t[204]>1e-35?t[1]>62.50000000000001?ut=-.05930486238817954:t[1]>29.500000000000004?ut=.06955866121256543:t[8]>597.5000000000001?ut=-.06538593556505168:ut=.06212512595497445:ut=.00021102929959182257:t[9]>90.50000000000001?ut=.0958061289119631:t[102]>1e-35?ut=.07172059675638813:t[1]>47.50000000000001?ut=-.03879798603977766:t[297]>1e-35?ut=.054948234271956144:t[282]>1e-35?t[2]>6.500000000000001?ut=.003805910996312012:ut=.09304295674749524:t[11]>1e-35?t[18]>1e-35?ut=.11252376801858695:t[288]>1e-35?ut=-.10293901912180432:ut=.014669268837893872:t[1]>42.50000000000001?ut=-.05988274123836837:t[145]>1e-35?ut=.06142784665288495:t[3]>1.5000000000000002?t[4]>4.500000000000001?t[1]>21.500000000000004?t[1]>27.500000000000004?t[9]>24.500000000000004?ut=.038791154988529926:t[10]>22.500000000000004?t[2]>19.500000000000004?ut=-.03366718308159971:ut=.11936550608549797:t[1]>31.500000000000004?ut=-.07454716789539667:ut=.027859650621164217:t[10]>10.500000000000002?ut=-.11806374092321247:ut=-.03506042229223101:ut=-.0007080765837654515:t[10]>6.500000000000001?ut=-.028077713664996503:t[2]>7.500000000000001?ut=.15803724124216814:ut=.0351381284833169:ut=-.07877953381054767;let St;t[131]>1e-35?t[282]>1e-35?t[4]>23.500000000000004?St=.14144941521975005:St=.0007727806714190652:t[9]>1.5000000000000002?t[8]>2134.5000000000005?t[2]>34.50000000000001?St=.10514088112381886:t[7]>18.500000000000004?St=-.10370643555956745:St=.04093594315421388:t[6]>15.500000000000002?t[4]>9.500000000000002?t[10]>27.500000000000004?t[10]>71.50000000000001?St=-.0508129468802936:t[224]>1e-35?St=-.037816066368733595:t[10]>43.50000000000001?St=.07793408602607932:St=.017646166646099453:t[9]>3.5000000000000004?t[9]>29.500000000000004?t[17]>1e-35?St=.036972453794202324:St=-.08727431092411866:t[8]>427.50000000000006?t[8]>1278.5000000000002?St=.09475302525132188:St=-.03580104945898193:St=.08349488283861875:t[10]>3.5000000000000004?t[0]>1847.5000000000002?t[0]>4280.500000000001?t[2]>27.500000000000004?St=-.1282448778804823:St=-.014395808269207212:St=-.008940927190750592:St=-.1459118815453748:t[0]>4897.500000000001?St=-.09733068457286576:t[1]>57.50000000000001?St=.06575271409540207:St=-.019556422817450115:St=-.10623959222984136:t[18]>1e-35?St=.11280940901275241:t[8]>319.50000000000006?t[2]>6.500000000000001?St=.008125645893104896:St=-.11084368630465868:St=.0584398731508786:t[0]>350.50000000000006?t[3]>83.50000000000001?St=-.05854904579626861:t[4]>5.500000000000001?St=.02985784951394175:St=-.03247600140149334:St=-.11152899295304973:St=-.00035424577714215764;let Kt;t[32]>1e-35?t[17]>1e-35?t[8]>359.50000000000006?t[8]>804.5000000000001?Kt=-.06563670567578264:Kt=.067656954313663:Kt=-.10388217548685377:t[8]>2302.5000000000005?Kt=.07190621943790435:t[4]>67.50000000000001?Kt=.060020507643618604:t[4]>38.50000000000001?Kt=-.08707253184321638:t[2]>11.500000000000002?t[2]>16.500000000000004?t[1]>31.500000000000004?t[1]>59.50000000000001?Kt=-.06568134366461277:t[8]>1075.5000000000002?Kt=-.004768057709758692:Kt=.11785959165999467:Kt=-.05080221682879267:Kt=.14814206127494542:Kt=-.07241946332311736:t[253]>1e-35?Kt=-.058893562861261274:t[4]>61.50000000000001?t[283]>1e-35?t[10]>23.500000000000004?Kt=-.02471195342450034:Kt=.11866056464409412:t[10]>44.50000000000001?t[1]>16.500000000000004?t[8]>2640.0000000000005?Kt=-.10741850739482771:Kt=.010051635824944:Kt=.12502069436017124:t[8]>1971.5000000000002?t[1]>23.500000000000004?t[308]>1e-35?Kt=.10511236013756364:t[10]>10.500000000000002?t[1]>53.50000000000001?Kt=-.08992396138178163:Kt=.010944365997007212:Kt=.06221307021813793:Kt=.1286024087559141:t[127]>1e-35?Kt=.06568148624531012:t[10]>40.50000000000001?Kt=-.07567979134643352:t[5]>5647.500000000001?Kt=.07594672895572069:Kt=-.018158016446439187:t[6]>55.50000000000001?Kt=.009293422430111872:t[4]>45.50000000000001?Kt=-.017749818406964022:t[2]>46.50000000000001?Kt=.01714136511113982:Kt=-724762291423549e-19;let er;t[1]>24.500000000000004?t[103]>1e-35?t[8]>48.50000000000001?t[17]>1e-35?er=-.048689215588703864:t[9]>27.500000000000004?t[0]>3916.5000000000005?er=.07084726276890757:er=-.11232323677722932:er=.04812773089510436:er=.11757502216780046:t[5]>1464.5000000000002?t[5]>1505.5000000000002?t[167]>1e-35?er=.07470606002425358:t[1]>53.50000000000001?t[132]>1e-35?er=.0879462816013881:er=-.002966662093626573:t[306]>1e-35?er=-.04588085188342676:er=.0031910005157084823:t[3]>10.500000000000002?t[10]>20.500000000000004?er=-.006600332774461143:er=.1272481351557754:er=-.09030973597154808:t[284]>1e-35?t[1]>38.50000000000001?t[10]>2.5000000000000004?er=.011884312066620044:er=.11678751052403374:t[4]>8.500000000000002?er=.03627129613273813:er=-.12132783497902287:er=-.006784372643244717:t[18]>1e-35?t[3]>4.500000000000001?t[3]>6.500000000000001?t[0]>5453.500000000001?er=-.06830131718398992:t[0]>5147.500000000001?er=.062360406249609306:t[4]>4.500000000000001?er=-.013162203864592055:er=-.07153029184927609:er=.07628618062271557:er=-.12085065687320373:t[190]>1e-35?er=-.045816889524231186:t[137]>1e-35?er=-.07956001795911584:t[199]>1e-35?t[0]>3853.5000000000005?er=.025895337822752502:er=-.06503949350616421:t[10]>227.50000000000003?er=-.09989456525790491:t[10]>130.50000000000003?er=.08616651057030683:er=.0001234981796706021;let Yt;t[8]>1014.5000000000001?t[9]>137.50000000000003?Yt=-.08778879924617534:t[8]>1022.5000000000001?t[285]>1e-35?t[9]>64.50000000000001?Yt=.04955806187281689:t[0]>3670.5000000000005?t[10]>32.50000000000001?Yt=-.141732381961068:Yt=-.0317152307496497:Yt=-.02074638849097191:t[0]>93.50000000000001?t[0]>3072.5000000000005?t[10]>100.50000000000001?t[4]>24.500000000000004?t[8]>1336.5000000000002?Yt=.12191801556691254:Yt=-.0003444689085397977:Yt=.005739668504631604:t[146]>1e-35?t[308]>1e-35?Yt=.015237524791728777:t[6]>61.50000000000001?t[4]>63.50000000000001?Yt=-.05676033995381961:Yt=.10933961076803381:t[4]>26.500000000000004?Yt=-.11667582544549814:t[8]>1765.5000000000002?Yt=.032174455312047705:Yt=-.0755016390126608:t[293]>1e-35?Yt=-.08234885407658332:t[9]>41.50000000000001?t[0]>3830.5000000000005?Yt=.026571311956824436:t[15]>1e-35?Yt=.06175459479851121:Yt=-.018778084411148754:t[9]>40.50000000000001?Yt=-.09420232889965811:Yt=-.004578248021263184:t[2]>1.5000000000000002?Yt=.005453714644971445:Yt=-.03907138175699279:Yt=-.055296364182154736:t[23]>1e-35?Yt=.036555134842143476:t[0]>4188.500000000001?t[6]>29.500000000000004?Yt=-.09358146510580179:Yt=.060524657996178094:Yt=-.11245101144669545:t[125]>1e-35?t[9]>1.5000000000000002?Yt=-.12698331085931538:Yt=.006059605604079918:t[2]>196.50000000000003?Yt=-.09451315810804783:Yt=.0011390147031687425;let bt;t[8]>2830.5000000000005?t[1]>31.500000000000004?t[9]>32.50000000000001?t[5]>1234.5000000000002?t[8]>3794.5000000000005?bt=.05517359070460923:bt=-.04758751221404857:bt=-.09482078194138792:t[8]>2992.5000000000005?t[1]>101.50000000000001?bt=.1040436595565776:t[9]>21.500000000000004?bt=.04032250517675179:t[107]>1e-35?bt=.05978752253058374:t[210]>1e-35?t[4]>37.50000000000001?bt=.1192453009230486:t[1]>51.50000000000001?bt=.0443376336292195:bt=-.07967674833321865:t[5]>2117.5000000000005?t[9]>10.500000000000002?bt=-.10025078607591283:t[0]>2882.5000000000005?t[18]>1e-35?bt=-.08999822408398037:bt=.017533219253893447:t[9]>1.5000000000000002?t[4]>12.500000000000002?bt=-.061850439226075:bt=.08849196353361093:bt=.10536348167793089:t[92]>1e-35?bt=.04894947712119185:t[9]>16.500000000000004?bt=.05900227903883853:t[9]>5.500000000000001?bt=-.11946594348916476:bt=-.03652096348071964:t[1]>41.50000000000001?bt=-.07411603110840567:bt=-.00021033247574340914:t[10]>22.500000000000004?t[9]>68.50000000000001?bt=.08493634342741495:t[11]>1e-35?bt=-.10899097825564363:bt=-.006156708838964173:t[8]>3198.5000000000005?t[2]>41.50000000000001?bt=.08356655906359918:t[7]>25.500000000000004?bt=-.09475076526194888:t[10]>5.500000000000001?bt=-.01999406228763778:bt=.06696212545889428:t[6]>20.500000000000004?bt=.14713592661393468:bt=.0459917279002218:bt=.00027445928493734093;let vr;t[223]>1e-35?t[1]>31.500000000000004?t[8]>634.5000000000001?vr=-.06904501553217077:vr=.05696231672035904:vr=-.1124703178077813:t[99]>1e-35?t[1]>89.50000000000001?vr=-.05074261170009721:t[1]>57.50000000000001?t[8]>969.5000000000001?vr=-.011419256378538392:t[0]>3830.5000000000005?vr=.140315841503076:vr=.02403434913963024:t[1]>31.500000000000004?t[8]>65.50000000000001?t[2]>10.500000000000002?vr=-.04027822909411164:vr=.03176085103667189:vr=.06779515865838849:t[4]>15.500000000000002?vr=.0762878389015175:t[8]>175.50000000000003?t[0]>3030.5000000000005?t[8]>1041.5000000000002?vr=.06124039747298539:vr=-.04312732764434027:vr=.09161522761808062:vr=-.09663512235460074:t[280]>1e-35?t[6]>45.50000000000001?t[1]>46.50000000000001?vr=.11211681010488772:t[13]>1e-35?vr=.06725735814960367:vr=-.046744031455827846:t[10]>44.50000000000001?t[0]>3400.5000000000005?t[0]>4004.5000000000005?t[2]>22.500000000000004?vr=.11743605068905603:vr=-.011309033539148687:vr=-.07896094707523052:vr=.12862714793172117:t[10]>1.5000000000000002?t[8]>455.50000000000006?t[0]>4706.500000000001?vr=-.09218756798869711:t[10]>19.500000000000004?t[0]>1894.5000000000002?t[0]>3719.5000000000005?vr=.02836295848998302:vr=.12210680366745175:vr=-.058302317470509096:t[5]>4144.500000000001?vr=.06123341960495106:vr=-.03840046906926525:vr=-.05221474543453495:vr=.03988215485860711:vr=-.00033074684693083496;let di=mGt(e+r+n+i+o+a+c+l+u+f+p+m+h+g+A+y+E+b+S+R+B+L+O+Y+V+z+Q+U+Z+J+j+W+X+oe+te+re+pe+Ae+Oe+Te+Je+Fe+lt+_t+xt+gt+ue+Ue+ye+$e+ae+le+qe+Ne+Ee+je+tt+mt+Ft+Jt+Qt+zr+Br+un+ve+Ge+pt+Tt+or+Zt+Tr+fr+rr+ur+nr+Mr+Kr+sn+Cn+ii+Rn+ti+an+Jn+Pe+K+Ce+Ie+F+D+ee+ge+_e+ut+St+Kt+er+Yt+bt+vr);return[1-di,di]}s(MYe,"multilineModelPredict");function mGt(t){if(t<0){let e=Math.exp(t);return e/(1+e)}return 1/(1+Math.exp(-t))}s(mGt,"sigmoid");var hGt={javascript:["//"],typescript:["//"],typescriptreact:["//"],javascriptreact:["//"],vue:["//","-->"],php:["//","#"],dart:["//"],go:["//"],cpp:["//"],scss:["//"],csharp:["//"],java:["//"],c:["//"],rust:["//"],python:["#"],markdown:["#","-->"],css:["*/"]},LYe={javascript:1,javascriptreact:2,typescript:3,typescriptreact:4,python:5,go:6,ruby:7};function FYe(t,e,r,n=!0){let i=t.split(`
`);if(n&&(i=i.filter(c=>c.trim().length>0)),Math.abs(e)>i.length||e>=i.length)return!1;e<0&&(e=i.length+e);let o=i[e];return(hGt[r]??[]).some(c=>o.includes(c))}s(FYe,"hasComment");var MX=class{static{s(this,"PromptFeatures")}constructor(e,r){let[n,i]=this.firstAndLast(e),o=this.firstAndLast(e.trimEnd());this.language=r,this.length=e.length,this.firstLineLength=n.length,this.lastLineLength=i.length,this.lastLineRstripLength=i.trimEnd().length,this.lastLineStripLength=i.trim().length,this.rstripLength=e.trimEnd().length,this.stripLength=e.trim().length,this.rstripLastLineLength=o[1].length,this.rstripLastLineStripLength=o[1].trim().length,this.secondToLastLineHasComment=FYe(e,-2,r),this.rstripSecondToLastLineHasComment=FYe(e.trimEnd(),-2,r),this.prefixEndsWithNewline=e.endsWith(`
`),this.lastChar=e.slice(-1),this.rstripLastChar=e.trimEnd().slice(-1),this.firstChar=e[0],this.lstripFirstChar=e.trimStart().slice(0,1)}firstAndLast(e){let r=e.split(`
`),n=r.length,i=r[0],o=r[n-1];return o==""&&n>1&&(o=r[n-2]),[i,o]}},Xve=class{static{s(this,"MultilineModelFeatures")}constructor(e,r,n){this.language=n,this.prefixFeatures=new MX(e,n),this.suffixFeatures=new MX(r,n)}constructFeatures(){let e=new Array(14).fill(0);e[0]=this.prefixFeatures.length,e[1]=this.prefixFeatures.firstLineLength,e[2]=this.prefixFeatures.lastLineLength,e[3]=this.prefixFeatures.lastLineRstripLength,e[4]=this.prefixFeatures.lastLineStripLength,e[5]=this.prefixFeatures.rstripLength,e[6]=this.prefixFeatures.rstripLastLineLength,e[7]=this.prefixFeatures.rstripLastLineStripLength,e[8]=this.suffixFeatures.length,e[9]=this.suffixFeatures.firstLineLength,e[10]=this.suffixFeatures.lastLineLength,e[11]=this.prefixFeatures.secondToLastLineHasComment?1:0,e[12]=this.prefixFeatures.rstripSecondToLastLineHasComment?1:0,e[13]=this.prefixFeatures.prefixEndsWithNewline?1:0;let r=new Array(Object.keys(LYe).length+1).fill(0);r[LYe[this.language]??0]=1;let n=new Array(Object.keys(Sx).length+1).fill(0);n[Sx[this.prefixFeatures.lastChar]??0]=1;let i=new Array(Object.keys(Sx).length+1).fill(0);i[Sx[this.prefixFeatures.rstripLastChar]??0]=1;let o=new Array(Object.keys(Sx).length+1).fill(0);o[Sx[this.suffixFeatures.firstChar]??0]=1;let a=new Array(Object.keys(Sx).length+1).fill(0);return a[Sx[this.suffixFeatures.lstripFirstChar]??0]=1,e.concat(r,n,i,o,a)}};function gGt(t,e){return new Xve(t.prefix,t.suffix,e)}s(gGt,"constructMultilineFeatures");function OYe(t,e){let r=gGt(t,e).constructFeatures();return MYe(r)[1]}s(OYe,"requestMultilineScore");d();d();d();d();async function*_x(t,e){for await(let r of t)yield e(r)}s(_x,"asyncIterableMap");async function*QYe(t,e){for await(let r of t)await e(r)&&(yield r)}s(QYe,"asyncIterableFilter");async function*h7(t,e){for await(let r of t){let n=await e(r);n!==void 0&&(yield n)}}s(h7,"asyncIterableMapFilter");async function*UYe(...t){for(let e of t)yield*e}s(UYe,"asyncIterableConcat");d();async function qR(t,e,r,n){let i=Vr.createAndMarkAsIssued({messageId:e,conversationId:r});return await t.get(Mt).fetchTokenAndUpdateExPValuesAndAssignments(n,i)}s(qR,"createTelemetryWithExpWithId");function Za(t,{turn:e,conversation:r}={},n){return qR(t,e?.telemetryId??"",r?.telemetryId??"",n)}s(Za,"createTelemetryWithExpWithTurn");function g7(t,e,r,n,i,o,a,c){let l=t.turns[t.turns.length-1].skills.map(p=>p.skillId).sort(),u={source:"user",turnIndex:(t.turns.length-1).toString(),uiKind:e,skillIds:l.join(",")},f={promptTokenLen:n,messageCharLen:r};return i&&(u.suggestion=i),o&&(u.suggestionId=o),c.length>0&&(u.skillResolutionsJson=JSON.stringify(AGt(c))),a=a.extendedBy(u,f),a}s(g7,"extendUserMessageTelemetryData");function AGt(t){return t.map(e=>({skillId:e.skillId,resolution:e.resolution,fileStatus:e.files?.map(r=>r.status),tokensPreEliding:e.tokensPreEliding??0,resolutionTimeMs:e.resolutionTimeMs??0,processingTimeMs:e.processingTimeMs??0}))}s(AGt,"mapSkillResolutionsForTelemetry");function qYe(t,e,r,n,i,o,a){return n!=null&&(a=a.extendedBy({offTopic:n.toString()})),LX(t,o,e,r,{uiKind:e,headerRequestId:i},{},a).properties.messageId}s(qYe,"createUserMessageTelemetryData");function HYe(t,e,r,n,i,o,a){let c=CGt(r);return LX(t.ctx,o,e,r,{source:"model",turnIndex:(t.conversation.turns.length-1).toString(),headerRequestId:i,uiKind:e,codeBlockLanguages:JSON.stringify(c),mode:(t.turn.getChatModeWithDefault()??"unknown").toLowerCase(),modelId:t.turn.getResolvedModelId()??"unknown"},{messageCharLen:r.length,numCodeBlocks:c.length,numTokens:n},a).properties.messageId}s(HYe,"createModelMessageTelemetryData");function $Ye(t,e,r,n,i,o,a){LX(t,o,r,n,{source:"offTopic",turnIndex:e.turns.length.toString(),userMessageId:i,uiKind:r},{messageCharLen:n.length},a)}s($Ye,"createOffTopicMessageTelemetryData");function WYe(t,e,r,n,i,o,a,c,l){let u=LX(t,c,r,n,{source:"suggestion",suggestion:o,turnIndex:(e.turns.length-1).toString(),uiKind:r,suggestionId:a},{promptTokenLen:i,messageCharLen:n.length},l);return yGt(t,r,o,u.properties.messageId,u.properties.conversationId,a,l,c),u.properties.messageId}s(WYe,"createSuggestionMessageTelemetryData");var jYe={synonymTimeMs:0,rankingTimeMs:0,chunkCount:0,localSnippetCount:0,embeddingsTimeMs:0,rerankingTimeMs:0};async function GYe(t,e,r){let n=await Za(t.ctx,t),i=t.conversation.source==="inline"?"conversationInline":"conversationPanel";Pf(t.ctx,void 0,{conversationId:t.conversation.telemetryId,turnIndex:(t.conversation.turns.length-1).toString(),userMessageId:t.turn.telemetryId,provider:e,uiKind:i},r,"index.codesearch",n)}s(GYe,"telemetryIndexCodesearch");function LX(t,e,r,n,i,o,a){let c=a??Vr.createAndMarkAsIssued();if(!("messageId"in i)&&!("messageId"in c.properties)){let m=br();i.messageId=m}e&&(i.languageId=e.detectedLanguageId,o.documentLength=e.getText().length,o.documentLineCount=e.lineCount);let l={messageText:n,...i},u=c.extendedBy(i,o),f=c.extendedBy(l),p=uu(r);return Bt(t,`${p}.message`,u),Bt(t,`${p}.messageText`,f,1),u}s(LX,"telemetryMessage");function VYe(t,e,r,n){Pf(t,n,{uiKind:e},{},"conversation.suggestionShown",r)}s(VYe,"createSuggestionShownTelemetryData");function yGt(t,e,r,n,i,o,a,c){Pf(t,c,{suggestion:r,messageId:n,conversationId:i,suggestionId:o,uiKind:e},{},"conversation.suggestionSelected",a)}s(yGt,"createSuggestionSelectedTelemetryData");function Pf(t,e,r,n,i,o){let a=o??Vr.createAndMarkAsIssued();e&&(r.languageId=e.detectedLanguageId,n.documentLength=e.getText().length,n.documentLineCount=e.lineCount);let c=a.extendedBy(r,n);return Bt(t,i,c),c}s(Pf,"telemetryUserAction");function v3(t,e,r){let n=r.extendedBy({messagesJson:JSON.stringify(e)});return Bt(t,"engine.messages",n,1)}s(v3,"logEngineMessages");function uu(t){switch(t){case"conversationInline":return"inlineConversation";case"conversationPanel":case"agentPanel":case"editsPanel":default:return"conversation"}}s(uu,"telemetryPrefixForUiKind");function CGt(t){let e=t.split(`
`),r=[],n;for(let i=0;i<e.length;i++){let o=e[i];if(n)new RegExp(`^\\s*${n.delimiter}\\s*$`).test(o)?(r.push({languageId:n.languageId,totalLines:n.totalLines}),n=void 0):n.totalLines++;else{let a=o.match(/^(\s*)(`{3,}|~{3,})([a-zA-Z0-9_+]*)/);a&&(n={delimiter:a[2],languageId:a[3],totalLines:0})}}return r}s(CGt,"getCodeBlocks");function zYe(t){return t=="conversationInline"?"conversation-inline":"conversation-panel"}s(zYe,"uiKindToIntent");function HT(t){return t==="inline"?"conversationInline":"conversationPanel"}s(HT,"conversationSourceToUiKind");function KYe(t,e,r,n,i){let o={conversationId:e.conversation.telemetryId,turnIndex:(e.conversation.turns.length-1).toString(),roundId:r.toString(),uiKind:"agentPanel"},a={totalTimeMs:n};JYe(t,"round",i.extendedBy(o,a))}s(KYe,"createAgentRoundTelemetryData");function YYe(t,e,r,n,i,o,a,c){let l={conversationId:e.conversation.telemetryId,turnIndex:(e.conversation.turns.length-1).toString(),roundId:i.toString(),toolName:r.name,toolType:r.type,toolProviderId:r.toolProvider.id,toolCallId:n,toolCallStatus:a,uiKind:"agentPanel"},u={totalTimeMs:o};JYe(t,"toolCall",c.extendedBy(l,u))}s(YYe,"createToolInvocationTelemetryData");function JYe(t,e,r){return Bt(t,`${uu("agentPanel")}.${e}`,r)}s(JYe,"logAgenticEvent");function vGt(t,e=5e4){if(t.length<=e)return t;let r=t.substring(0,e),n=[`
`,`[Original content length: ${t.length}]`,"[TRUNCATED: File content exceeded maximum length limit]"].join(`
`);return r+n}s(vGt,"truncateContentIfNeeded");function FX(t,e,r,n,i,o,a){let c=`${uu(e)}.${a}`,l=o.extendedBy(r,n);Bt(t,c,l);let u={...r};i.currentFileContent!==void 0&&(u.completionTextJson=vGt(i.currentFileContent));let f=o.extendedBy(u,n);Bt(t,`${c}.restricted`,f,1)}s(FX,"telemetryEditSurvivalTracking");d();d();function Rx(t){if(t instanceof Error)return t.stack?t.stack:t.message;if(typeof t=="string")return t;try{return JSON.stringify(t)}catch{return String(t)}}s(Rx,"toString");var z0=new dt("streamChoices"),Zve=class{constructor(){this.logprobs=[];this.top_logprobs=[];this.text=[];this.tokens=[];this.text_offset=[];this.copilot_annotations=new nxe;this.tool_calls=new txe;this.function_call=new rxe;this.copilot_references=[];this.yielded=!1}static{s(this,"APIJsonDataStreaming")}append(e){e.text&&this.text.push(e.text),e.delta?.content&&e.delta.role!=="function"&&this.text.push(e.delta.content),e.logprobs&&(this.tokens.push(e.logprobs.tokens??[]),this.text_offset.push(e.logprobs.text_offset??[]),this.logprobs.push(e.logprobs.token_logprobs??[]),this.top_logprobs.push(e.logprobs.top_logprobs??[])),e.copilot_annotations&&this.copilot_annotations.update(e.copilot_annotations),e.delta?.copilot_annotations&&this.copilot_annotations.update(e.delta.copilot_annotations),e.delta?.tool_calls&&e.delta.tool_calls.length>0&&this.tool_calls.update(e.delta.tool_calls),e.delta?.function_call&&this.function_call.update(e.delta.function_call),e?.finish_reason&&(this.finish_reason=e.finish_reason)}};function xGt(t){let e=t.split(`
`),r=e.pop();return[e.filter(n=>n!=""),r]}s(xGt,"splitChunk");var exe=class{constructor(){this.arguments=[]}static{s(this,"StreamingToolCall")}update(e){e.id&&(this.id=e.id),e.function.name&&(this.name=e.function.name),this.arguments.push(e.function.arguments)}},txe=class{constructor(){this.toolCalls=[]}static{s(this,"StreamingToolCalls")}update(e){e.forEach(r=>{let n=this.toolCalls.length>0?this.toolCalls[this.toolCalls.length-1]:void 0;(!n||r.id&&n.id!==r.id)&&(n=new exe,this.toolCalls.push(n)),n.update(r)})}getToolCalls(){return this.toolCalls}},rxe=class{constructor(){this.arguments=[]}static{s(this,"StreamingFunctionCall")}update(e){e.name&&(this.name=e.name),this.arguments.push(e.arguments)}},nxe=class{constructor(){this.current={}}static{s(this,"StreamCopilotAnnotations")}update(e){Object.entries(e).forEach(([r,n])=>{n.forEach(i=>this.update_namespace(r,i))})}update_namespace(e,r){this.current[e]||(this.current[e]=[]);let n=this.current[e],i=n.findIndex(o=>o.id===r.id);i>=0?n[i]=r:n.push(r)}for(e){return this.current[e]??[]}},$T=class t{constructor(e,r,n,i,o,a,c){this.ctx=e;this.expectedNumChoices=r;this.response=n;this.body=i;this.telemetryData=o;this.dropCompletionReasons=a;this.cancellationToken=c;this.requestId=HR(this.response);this.stats=new ixe;this.solutions={}}static{s(this,"SSEProcessor")}static create(e,r,n,i,o,a){let c=n.body();if(c===null)throw new Error("No response body available");return typeof c.setEncoding=="function"?c.setEncoding("utf8"):c=c.pipeThrough(new TextDecoderStream),new t(e,r,n,c,i,o??[],a)}async*processSSE(e=()=>{}){try{yield*this.processSSEInner(e)}finally{this.cancel(),z0.debug(this.ctx,`request done: headerRequestId: [${this.requestId.headerRequestId}] model deployment ID: [${this.requestId.deploymentId}]`),z0.debug(this.ctx,"request stats:",this.stats)}}async*processSSEInner(e){let r="",n=null,i,o;e:for await(let a of this.body){if(this.maybeCancel("after awaiting body chunk"))return;z0.debug(this.ctx,"chunk",a.toString());let[c,l]=xGt(r+a.toString());r=l;for(let u of c){let f=u.slice(5).trim();if(f=="[DONE]"){yield*this.finishSolutions(n,i,o,e);return}n=null;let p;try{p=JSON.parse(f)}catch{z0.error(this.ctx,"Error parsing JSON stream data",u);continue}if(p.copilot_confirmation&&EGt(p.copilot_confirmation)&&await e("",{text:"",requestId:this.requestId,copilotConfirmation:p.copilot_confirmation}),p.copilot_references&&await e("",{text:"",requestId:this.requestId,copilotReferences:p.copilot_references}),p.choices===void 0){!p.copilot_references&&!p.copilot_confirmation&&(p.error!==void 0?z0.error(this.ctx,"Error in response:",p.error.message):z0.error(this.ctx,"Unexpected response with no choices or error: "+f)),p.copilot_errors&&await e("",{text:"",requestId:this.requestId,copilotErrors:p.copilot_errors});continue}if(i===void 0&&p.model&&(i=p.model),o===void 0&&p.usage&&(o=p.usage),this.allSolutionsDone()){r="";break e}for(let m=0;m<p.choices?.length;m++){let h=p.choices[m];z0.debug(this.ctx,"choice",h),this.stats.add(h.index),h.index in this.solutions||(this.solutions[h.index]=new Zve);let g=this.solutions[h.index];if(g==null)continue;g.append(h);let A=this.asSolutionDecision(),y=h.text?.indexOf(`
`)>-1||h.delta?.content?.indexOf(`
`)>-1;if(h.finish_reason||y){let b=g.text.join("");if(A=this.asSolutionDecision(await e(b,{text:b,index:h.index,requestId:this.requestId,annotations:g.copilot_annotations,copilotReferences:g.copilot_references,getAPIJsonData:s(()=>A7(g),"getAPIJsonData"),finished:!!h.finish_reason,telemetryData:this.telemetryData})),this.maybeCancel("after awaiting finishedCb"))return}if(h.finish_reason&&g.function_call.name!==void 0){n=h.finish_reason;continue}if(h.finish_reason&&(A.yieldSolution=!0,A.continueStreaming=!1),!A.yieldSolution)continue;let E=h.finish_reason??"client-trimmed";if(Bt(this.ctx,"completion.finishReason",this.telemetryData.extendedBy({completionChoiceFinishReason:E,engineName:i??"",engineChoiceSource:ET(this.ctx,this.telemetryData).engineChoiceSource})),this.dropCompletionReasons.includes(h.finish_reason)?this.solutions[h.index]=null:g.yielded||(this.stats.markYielded(h.index),yield{solution:g,finishOffset:A.finishOffset,reason:h.finish_reason,requestId:this.requestId,index:h.index,model:i,usage:o},g.yielded=!0),this.maybeCancel("after yielding finished choice"))return;A.continueStreaming||(this.solutions[h.index]=null)}}}for(let[a,c]of Object.entries(this.solutions)){let l=Number(a);if(c!=null&&(Bt(this.ctx,"completion.finishReason",this.telemetryData.extendedBy({completionChoiceFinishReason:"Iteration Done",engineName:i??""})),this.stats.markYielded(l),yield{solution:c,finishOffset:void 0,reason:"Iteration Done",requestId:this.requestId,index:l,model:i,usage:o},this.maybeCancel("after yielding after iteration done")))return}if(r.length>0)try{let a=JSON.parse(r);a.error!==void 0&&z0.error(this.ctx,`Error in response: ${a.error.message}`,a.error)}catch{z0.error(this.ctx,`Error parsing extraData: ${r}`)}}asSolutionDecision(e){return e===void 0?{yieldSolution:!1,continueStreaming:!0}:typeof e=="number"?{yieldSolution:!0,continueStreaming:!1,finishOffset:e}:e}async*finishSolutions(e,r,n,i){for(let[o,a]of Object.entries(this.solutions)){let c=Number(o);if(a==null)continue;let l=a.text.join("");if(await i(l,{text:l,index:c,requestId:this.requestId,annotations:a.copilot_annotations,copilotReferences:a.copilot_references,getAPIJsonData:s(()=>A7(a),"getAPIJsonData"),finished:!0,telemetryData:this.telemetryData}),!a.yielded&&(this.stats.markYielded(c),Bt(this.ctx,"completion.finishReason",this.telemetryData.extendedBy({completionChoiceFinishReason:e??"DONE",engineName:r??""})),yield{solution:a,finishOffset:void 0,reason:e??"DONE",requestId:this.requestId,index:c,model:r,usage:n},this.maybeCancel("after yielding on DONE")))return}}maybeCancel(e){return this.cancellationToken?.isCancellationRequested?(z0.debug(this.ctx,"Cancelled: "+e),this.cancel(),!0):!1}cancel(){this.body&&"destroy"in this.body&&typeof this.body.destroy=="function"?this.body.destroy():this.body instanceof ReadableStream&&this.body.cancel()}allSolutionsDone(){let e=Object.values(this.solutions);return e.length==this.expectedNumChoices&&e.every(r=>r==null)}};function OX(t,e,r){let n=e.solution.text.join(""),i=!1;e.finishOffset!==void 0&&(z0.debug(t,`solution ${e.index}: early finish at offset ${e.finishOffset}`),n=n.substring(0,e.finishOffset),i=!0),z0.info(t,`solution ${e.index} returned. finish reason: [${e.reason}]`),z0.debug(t,`solution ${e.index} details: finishOffset: [${e.finishOffset}]`);let o=A7(e.solution);return QX(t,n,o,e.index,e.requestId,i,r)}s(OX,"prepareSolutionForReturn");function A7(t){let e=t.text.join(""),r=bGt(t),n=IGt(t),i=t.copilot_annotations.current,o={text:e,tokens:t.text,tool_calls:r,function_call:n,copilot_annotations:i,finish_reason:t.finish_reason??"stop"};if(t.logprobs.length===0)return o;let a=t.logprobs.reduce((f,p)=>f.concat(p),[]),c=t.top_logprobs.reduce((f,p)=>f.concat(p),[]),l=t.text_offset.reduce((f,p)=>f.concat(p),[]),u=t.tokens.reduce((f,p)=>f.concat(p),[]);return{...o,logprobs:{token_logprobs:a,top_logprobs:c,text_offset:l,tokens:u}}}s(A7,"convertToAPIJsonData");function EGt(t){return typeof t.title=="string"&&typeof t.message=="string"&&!!t.confirmation}s(EGt,"isCopilotConfirmation");function XYe(t,e,r){if(!t)return{};try{return JSON.parse(t)}catch(n){throw new Error(`Failed to parse JSON for ${e} '${r}': ${Rx(n)}. Input: '${t}'`)}}s(XYe,"parseCallArguments");function bGt(t){let e=[],r=t.tool_calls.getToolCalls();for(let n of r)if(n.name){let i=n.arguments.join("").trim(),o=XYe(i,"tool call",n.name);e.push({type:"function",function:{name:n.name,arguments:o},approxNumTokens:n.arguments.length+1,id:n.id})}return e}s(bGt,"extractToolCalls");function IGt(t){if(t.function_call.name){let e=t.function_call.arguments.join("").trim(),r=XYe(e,"function call",t.function_call.name);return{name:t.function_call.name,arguments:r}}}s(IGt,"extractFunctionCall");var ixe=class{constructor(){this.choices=new Map}static{s(this,"ChunkStats")}getChoiceStats(e){let r=this.choices.get(e);return r||(r=new oxe,this.choices.set(e,r)),r}add(e){this.getChoiceStats(e).increment()}markYielded(e){this.getChoiceStats(e).markYielded()}toString(){return Array.from(this.choices.entries()).map(([e,r])=>`${e}: ${r.yieldedTokens} -> ${r.seenTokens}`).join(", ")}},oxe=class{constructor(){this.yieldedTokens=-1;this.seenTokens=0}static{s(this,"ChoiceStats")}increment(){this.seenTokens++}markYielded(){this.yieldedTokens=this.seenTokens}};d();function UX(t,e){return t!==null&&typeof t=="object"&&e in t}s(UX,"hasKey");function Df(t,e){return UX(t,e)?t[e]:void 0}s(Df,"getKey");var eJe=Be(hi());var ec=new dt("fetchCompletions");function HR(t){return{headerRequestId:t.headers.get("x-request-id")||"",serverExperiments:t.headers.get("X-Copilot-Experiment")||"",deploymentId:t.headers.get("azureml-model-deployment")||""}}s(HR,"getRequestId");function x3(t){let e=t.headers.get("openai-processing-ms");return e?parseInt(e,10):0}s(x3,"getProcessingTime");function tJe(t){switch(t){case"ghostText":return"copilot-ghost";case"synthesize":return"copilot-panel"}}s(tJe,"uiKindToIntent");var Rp=class{static{s(this,"OpenAIFetcher")}};function TGt(t,e,r,n){return qm(t,e,"proxy","v1/engines",r,n)}s(TGt,"getProxyEngineUrl");function qX(t,e,r,n){for(let[i,o]of Object.entries(t)){if(r.includes(i))continue;let a=o;if(i==="extra"&&n){let c={...a};for(let l of n)delete c[l];a=c}e.properties[`request.option.${i}`]=JSON.stringify(a)??"undefined"}}s(qX,"sanitizeRequestOptionTelemetry");async function ZYe(t,e,r,n,i,o,a,c,l,u,f){let p=t.get(qo),m=TGt(t,a,r,n),h=l.extendedBy({endpoint:n,engineName:r,uiKind:c},PD(e));qX(o,h,["prompt","suffix"],["context"]),h.properties.headerRequestId=i,Bt(t,"request.sent",h);let g=Ba(),A=tJe(c);return Cx(t,m,a.token,A,i,o,u,f).then(y=>{let E=HR(y);h.extendWithRequestId(E);let b=Ba()-g;return h.measurements.totalTimeMs=b,ec.info(t,`Request ${i} at <${m}> finished with ${y.status} status after ${b}ms`),h.properties.status=String(y.status),ec.debug(t,"request.response properties",h.properties),ec.debug(t,"request.response measurements",h.measurements),ec.debug(t,"prompt:",e),Bt(t,"request.response",h),y}).catch(y=>{if(Td(y))throw Bt(t,"request.cancel",h),y;p.setWarning(Df(y,"message")??"");let E=h.extendedBy({error:"Network exception"});Bt(t,"request.shownWarning",E),h.properties.message=String(Df(y,"name")??""),h.properties.code=String(Df(y,"code")??""),h.properties.errno=String(Df(y,"errno")??""),h.properties.type=String(Df(y,"type")??"");let b=Ba()-g;throw h.measurements.totalTimeMs=b,ec.info(t,`Request ${i} at <${m}> rejected with ${String(y)} after ${b}ms`),ec.debug(t,"request.error properties",h.properties),ec.debug(t,"request.error measurements",h.measurements),Bt(t,"request.error",h),y}).finally(()=>{e6e(t,e,h)})}s(ZYe,"fetchWithInstrumentation");async function wGt(t,e,r,n,i,o,a,c,l,u){let f=l.extendedBy({endpoint:"chat/completions",engineModelId:r,uiKind:c});qX(o,f,["messages"]),f.properties.headerRequestId=i,Bt(t,"request.sent",f);let p=Ba(),m=tJe(c),h=dh(t);Pv()&&(h=await BB(t,h));try{let g=await Cx(t,n,a.token,m,i,o,u,h),A=HR(g);f.extendWithRequestId(A);let y=Ba()-p;return f.measurements.totalTimeMs=y,ec.info(t,`Request ${i} at <${n}> finished with ${g.status} status after ${y}ms`),ec.debug(t,"request.response properties",f.properties),ec.debug(t,"request.response measurements",f.measurements),ec.debug(t,"messages:",JSON.stringify(e)),Bt(t,"request.response",f),g}catch(g){if(Td(g))throw Bt(t,"request.cancel",f),g;let A=f.extendedBy({error:"Network exception"});Bt(t,"request.shownWarning",A),f.properties.message=String(Df(g,"name")??""),f.properties.code=String(Df(g,"code")??""),f.properties.errno=String(Df(g,"errno")??""),f.properties.type=String(Df(g,"type")??"");let y=Ba()-p;throw f.measurements.totalTimeMs=y,ec.info(t,`Request ${i} at <${n}> rejected with ${String(g)} after ${y}ms`),ec.debug(t,"request.error properties",f.properties),ec.debug(t,"request.error measurements",f.measurements),Bt(t,"request.error",f),g}finally{v3(t,e,f)}}s(wGt,"fetchChatWithInstrumentation");function sxe(t){return QYe(t,e=>e.completionText.trim().length>0)}s(sxe,"postProcessChoices");var SGt="github.copilot.completions.quotaExceeded",y7=class extends Rp{static{s(this,"LiveOpenAIFetcher")}#e;async fetchAndStreamCompletions(e,r,n,i,o){if(this.#e)return{type:"canceled",reason:this.#e};let a=e.get(qo),c="completions",l=await e.get(ar).getToken(),u=await this.fetchWithParameters(e,c,r,l,n,o);if(u==="not-sent")return{type:"canceled",reason:"before fetch request"};if(o?.isCancellationRequested){let h=u.body();try{h&&"destroy"in h&&typeof h.destroy=="function"?h.destroy():h instanceof ReadableStream&&h.cancel()}catch(g){ec.exception(e,g,"Error destroying stream")}return{type:"canceled",reason:"after fetch request"}}if(u.status!==200){let h=this.createTelemetryData(c,e,r);return this.handleError(e,a,h,u,l)}let p=$T.create(e,r.count,u,n,[],o).processSSE(i),m=_x(p,h=>OX(e,h,n));return{type:"success",choices:sxe(m),getProcessingTime:s(()=>x3(u),"getProcessingTime")}}async fetchAndStreamChat(e,r,n,i,o,a,c,l={},u){if(this.#e)return{type:"canceled",reason:this.#e};let f="https://copilot-proxy.githubusercontent.com/chat/completions",p={messages:r,model:c.id,stream:!0,...l},m=n.extendedBy({endpoint:f,model:c.name}),h=e.get(qo),g=await e.get(ar).getToken(),A=await wGt(e,r,c.id,f,o,p,g,i,m,u);if(u?.isCancellationRequested){let S=A.body();try{S&&"destroy"in S&&typeof S.destroy=="function"?S.destroy():S instanceof ReadableStream&&S.cancel()}catch(R){ec.exception(e,R,"Error destroying stream")}return{type:"canceled",reason:"after fetch request"}}if(A.status!==200){let S=Vr.createAndMarkAsIssued({endpoint:f,engineName:c.name,uiKind:i,headerRequestId:o});return this.handleError(e,h,S,A,g)}let E=$T.create(e,1,A,m,[],eJe.CancellationToken.None).processSSE(),b=_x(E,S=>OX(e,S,n));return{type:"success",choices:sxe(b),getProcessingTime:s(()=>x3(A),"getProcessingTime")}}async fetchAndStreamSpeculation(e,r,n,i,o){if(this.#e)return{type:"canceled",reason:this.#e};let a=e.get(qo),c="speculation",l=await e.get(ar).getToken(),u={prompt:{prefix:r.prompt,suffix:"",isFimEnabled:!1},speculation:r.speculation,ourRequestId:br(),engineModelId:r.engineModelId,uiKind:r.uiKind,headers:r.headers,stops:r.stops},f=await this.fetchSpeculationWithParameters(e,c,u,l,n,o);if(f==="not-sent")return{type:"canceled",reason:"before fetch request"};if(o?.isCancellationRequested){let g=f.body();try{g&&"destroy"in g&&typeof g.destroy=="function"?g.destroy():g instanceof ReadableStream&&g.cancel()}catch(A){ec.exception(e,A,"Error destroying stream")}return{type:"canceled",reason:"after fetch request"}}if(f.status!==200){let g=this.createTelemetryData(c,e,u);return this.handleError(e,a,g,f,l)}let m=$T.create(e,1,f,n,[],o).processSSE(i),h=_x(m,g=>OX(e,g,n));return{type:"success",choices:sxe(h),getProcessingTime:s(()=>x3(f),"getProcessingTime")}}createTelemetryData(e,r,n){return Vr.createAndMarkAsIssued({endpoint:e,engineName:n.engineModelId,uiKind:n.uiKind,headerRequestId:n.ourRequestId})}async fetchSpeculationWithParameters(e,r,n,i,o,a){let c={prompt:n.prompt.prefix,speculation:n.speculation,temperature:0,stream:!0,stop:n.stops??[]};return await WC(0),a?.isCancellationRequested?"not-sent":await ZYe(e,n.prompt,n.engineModelId,r,n.ourRequestId,c,i,n.uiKind,o,a,n.headers)}async fetchWithParameters(e,r,n,i,o,a){let c=e.get(Mt).disableLogProb(o),l={prompt:n.prompt.prefix,suffix:n.prompt.suffix,max_tokens:$X(e),temperature:E3(e,n.count),top_p:HX(e),n:n.count,stop:rJe(e,n.languageId),stream:!0,extra:n.extra};(n.requestLogProbs||!c)&&(l.logprobs=2);let u=Ax(n.repoInfo);return u!==void 0&&(l.nwo=u),n.postOptions&&Object.assign(l,n.postOptions),n.prompt.context&&(l.extra.context=n.prompt.context),await WC(0),a?.isCancellationRequested?"not-sent":await ZYe(e,n.prompt,n.engineModelId,r,n.ourRequestId,l,i,n.uiKind,o,a,n.headers)}async handleError(e,r,n,i,o){let a=await i.text();if(i.status===402){this.#e="monthly free code completions exhausted",r.setError("Completions limit reached",{command:SGt,title:"Learn More"});let l=_a(e,u=>{this.#e=void 0,(u.envelope.limited_user_quotas?.completions??1)>0&&(r.forceNormal(),l.dispose())});return{type:"failed",reason:this.#e}}if(i.status===466)return r.setError(a),ec.info(e,a),{type:"failed",reason:`client not supported: ${a}`};if(i.clientError&&!i.headers.get("x-github-request-id")){let c=`Last response was a ${i.status} error and does not appear to originate from GitHub. Is a proxy or firewall intercepting this request? https://gh.io/copilot-firewall`;ec.error(e,c),r.setWarning(c),n.properties.error=`Response status was ${i.status} with no x-github-request-id header`}else i.clientError?(ec.warn(e,`Response status was ${i.status}:`,a),r.setWarning(`Last response was a ${i.status} error: ${a}`),n.properties.error=`Response status was ${i.status}: ${a}`):(r.setWarning(`Last response was a ${i.status} error`),n.properties.error=`Response status was ${i.status}`);return n.properties.status=String(i.status),Bt(e,"request.shownWarning",n),i.status===401||i.status===403?(e.get(ar).resetToken(i.status),{type:"failed",reason:`token expired or invalid: ${i.status}`}):i.status===429?(setTimeout(()=>{this.#e=void 0},10*1e3),this.#e="rate limited",ec.warn(e,"Rate limited by server. Denying completions for the next 10 seconds."),{type:"failed",reason:this.#e}):i.status===499?(ec.info(e,"Cancelled by server"),{type:"failed",reason:"canceled by server"}):(ec.error(e,"Unhandled status from server:",i.status,a),{type:"failed",reason:`unhandled status from server: ${i.status} ${a}`})}};function QX(t,e,r,n,i,o,a){return Z9e(t,e,r,i,n),{completionText:e,meanLogProb:_Gt(t,r),meanAlternativeLogProb:RGt(t,r),choiceIndex:n,requestId:i,blockFinished:o,tokens:r.tokens,numTokens:r.tokens.length,telemetryData:a,copilotAnnotations:r.copilot_annotations,clientCompletionId:br(),finishReason:r.finish_reason}}s(QX,"convertToAPIChoice");function _Gt(t,e){if(e?.logprobs?.token_logprobs)try{let r=0,n=0,i=50;for(let o=0;o<e.logprobs.token_logprobs.length-1&&i>0;o++,i--)r+=e.logprobs.token_logprobs[o],n+=1;return n>0?r/n:void 0}catch(r){dn.exception(t,r,"Error calculating mean prob")}}s(_Gt,"calculateMeanLogProb");function RGt(t,e){if(e?.logprobs?.top_logprobs)try{let r=0,n=0,i=50;for(let o=0;o<e.logprobs.token_logprobs.length-1&&i>0;o++,i--){let a={...e.logprobs.top_logprobs[o]};delete a[e.logprobs.tokens[o]],r+=Math.max(...Object.values(a)),n+=1}return n>0?r/n:void 0}catch(r){dn.exception(t,r,"Error calculating mean prob")}}s(RGt,"calculateMeanAlternativeLogProb");function E3(t,e){return Kg(t)||e<=1?0:e<10?.2:e<20?.4:.8}s(E3,"getTemperatureForSamples");var kGt={markdown:[`


`],python:[`
def `,`
class `,`
if `,`

#`]};function rJe(t,e){return kGt[e??""]??[`


`,"\n```"]}s(rJe,"getStops");function HX(t){return 1}s(HX,"getTopP");function $X(t){return IO}s($X,"getMaxSolutionTokens");var axe=class t{constructor(e,r){this.index=e;this.documentPrefix=r;this.startOffset=0;this.text="";this.trimCount=0}static{s(this,"StreamingCompletion")}updateText(e){this.text=e}get addedToPrefix(){return this.text.substring(0,this.startOffset)}get effectivePrefix(){return this.documentPrefix+this.addedToPrefix}get effectiveText(){return this.text.substring(this.startOffset)}get isFirstCompletion(){return this.trimCount===0}get firstNewlineOffset(){let e=[...this.text.matchAll(/\r?\n/g)];return e.length>0&&e[0].index===0&&e.shift(),e.length>0?e[0].index:-1}trimAt(e){let r=new t(this.index,this.documentPrefix);return r.startOffset=this.startOffset,r.text=this.text.substring(0,this.startOffset+e),r.trimCount=this.trimCount,this.startOffset+=e,this.trimCount++,r}},WX=class{constructor(e,r,n,i,o,a){this.ctx=e;this.prefix=r;this.languageId=n;this.initialSingleLine=i;this.trimmerLookahead=o;this.cacheFunction=a;this.lineLimit=3;this.completions=new Map}static{s(this,"StreamedCompletionSplitter")}getFinishedCallback(){return async(e,r)=>{let n=r.index??0,i=this.getCompletion(n,e);if(i.isFirstCompletion&&this.initialSingleLine&&i.firstNewlineOffset>=0){let o={yieldSolution:!0,continueStreaming:!0,finishOffset:i.firstNewlineOffset};return i.trimAt(o.finishOffset),r.finished&&await this.trimAll(r,i),o}return r.finished?await this.trimAll(r,i):await this.trimOnce(r,i)}}getCompletion(e,r){let n=this.completions.get(e);return n||(n=new axe(e,this.prefix),this.completions.set(e,n)),n.updateText(r),n}async trimOnce(e,r){let n=await this.trim(r);return n===void 0?{yieldSolution:!1,continueStreaming:!0}:r.isFirstCompletion?(r.trimAt(n),{yieldSolution:!0,continueStreaming:!0,finishOffset:n}):(this.cacheCompletion(e,r,n),{yieldSolution:!1,continueStreaming:!0})}async trimAll(e,r){let n,i;do n=await this.trim(r),r.isFirstCompletion?(i=n,r.trimAt(n??r.effectiveText.length)):this.cacheCompletion(e,r,n);while(n!==void 0);return i!==void 0?{yieldSolution:!0,continueStreaming:!0,finishOffset:i}:{yieldSolution:!1,continueStreaming:!0}}async trim(e){return await new IY(this.languageId,e.effectivePrefix,e.effectiveText,this.lineLimit,this.trimmerLookahead).getCompletionTrimOffset()}cacheCompletion(e,r,n){let i=r.trimAt(n??r.effectiveText.length);if(i.effectiveText.trim()==="")return;let o=QX(this.ctx,i.effectiveText.trimEnd(),e.getAPIJsonData(),i.index,e.requestId,n!==void 0,e.telemetryData);o.copilotAnnotations=this.adjustedAnnotations(o,r,i),o.generatedChoiceIndex=i.trimCount,this.cacheFunction(i.addedToPrefix,o)}adjustedAnnotations(e,r,n){if(e.copilotAnnotations===void 0)return;let i=n.addedToPrefix.length,a=i+e.completionText.length>=r.text.length,c={};for(let[l,u]of Object.entries(e.copilotAnnotations)){let f=u.filter(p=>p.start_offset-i<e.completionText.length&&p.stop_offset-i>0).map(p=>{let m={...p};return m.start_offset-=i,m.stop_offset-=i,a||(m.stop_offset=Math.min(m.stop_offset,e.completionText.length)),m});f.length>0&&(c[l]=f)}return Object.keys(c).length>0?c:void 0}};d();d();var Dh=class{constructor(){this.cache=new Sr(100)}static{s(this,"SpeculativeRequestCache")}set(e,r){this.cache.set(e,r)}async request(e){let r=this.cache.get(e);r!==void 0&&(this.cache.delete(e),await r())}};var jX=new dt("getCompletions");function GX(t,e,r){t.get(Dh).request(r.clientCompletionId),r.telemetry.markAsDisplayed(),r.telemetry.properties.reason=b3(r.resultType),Bt(t,`${e}.shown`,r.telemetry)}s(GX,"telemetryShown");function nJe(t,e,r){let n=e+".accepted";Bt(t,n,r)}s(nJe,"telemetryAccepted");function iJe(t,e,r){let n=e+".rejected";Bt(t,n,r)}s(iJe,"telemetryRejected");function WT(t,e={}){return{...e,telemetryBlob:t}}s(WT,"mkCanceledResultTelemetry");function pc(t){let e={headerRequestId:t.properties.headerRequestId,copilot_trackingId:t.properties.copilot_trackingId};return t.properties.sku!==void 0&&(e.sku=t.properties.sku),t.properties.opportunityId!==void 0&&(e.opportunityId=t.properties.opportunityId),t.properties.organizations_list!==void 0&&(e.organizations_list=t.properties.organizations_list),t.properties.enterprise_list!==void 0&&(e.enterprise_list=t.properties.enterprise_list),t.properties.clientCompletionId!==void 0&&(e.clientCompletionId=t.properties.clientCompletionId),e["abexp.assignmentcontext"]=t.filtersAndExp.exp.assignmentContext,e}s(pc,"mkBasicResultTelemetry");function oJe(t,e){if(e.type!=="promptOnly"){if(e.type==="success"){let r=Ba()-e.telemetryBlob.issuedTime,n=b3(e.resultType),i=JSON.stringify(e.performanceMetrics),o={...e.telemetryData,reason:n,performanceMetrics:i},{foundOffset:a}=e.telemetryBlob.measurements,c=e.performanceMetrics?.map(([l,u])=>`
${u.toFixed(2)}	${l}`).join("")??"";return jX.debug(t,`ghostText produced from ${n} in ${Math.round(r)}ms with foundOffset ${a}${c}`),_me(t,"ghostText.produced",o,{timeToProduceMs:r,foundOffset:a}),e.value}if(jX.debug(t,"No ghostText produced -- "+e.type+": "+e.reason),e.type==="canceled"){Bt(t,"ghostText.canceled",e.telemetryData.telemetryBlob.extendedBy({reason:e.reason,cancelledNetworkRequest:e.telemetryData.cancelledNetworkRequest?"true":"false"}));return}_me(t,`ghostText.${e.type}`,{...e.telemetryData,reason:e.reason},{})}}s(oJe,"handleGhostTextResultTelemetry");function b3(t){switch(t){case 0:return"network";case 1:return"cache";case 3:return"cycling";case 2:return"typingAsSuggested";case 4:return"async"}}s(b3,"resultTypeToString");d();d();d();async function PGt(t){if(t.isCancellationRequested)return;let e=new Ph,r=t.onCancellationRequested(()=>{e.resolve(),r.dispose()});await e.promise}s(PGt,"cancellationTokenToPromise");async function sJe(t,e){if(e){let r=PGt(e);await Promise.race([t,r])}else await t}s(sJe,"raceCancellation");function cxe(t){return Array.isArray(t)}s(cxe,"isArrayOfT");async function aJe(t,e){let r=new Map,n=[];for(let[i,o]of t.entries()){let a=(async()=>{let c=await cJe(o,e);r.set(i,c)})();n.push(a)}return await Promise.allSettled(n.values()),r}s(aJe,"resolveAll");async function cJe(t,e){let r;return t instanceof Promise?r=await DGt(t,e):r=await BGt(t,e),r}s(cJe,"resolve");async function DGt(t,e){let r=performance.now(),n={status:"none",resolutionTime:0,value:null},i=(async()=>{try{let o=await t;if(e?.isCancellationRequested)return;n={status:"full",resolutionTime:0,value:cxe(o)?[...o]:[o]}}catch(o){if(e?.isCancellationRequested)return;n={status:"error",resolutionTime:0,reason:o}}})();return await sJe(i,e),n.resolutionTime=performance.now()-r,n}s(DGt,"resolvePromise");async function BGt(t,e){let r=performance.now(),n={status:"none",resolutionTime:0,value:null},i=(async()=>{try{for await(let o of t){if(e?.isCancellationRequested)return;n.status!="partial"&&(n={status:"partial",resolutionTime:0,value:[]}),n.value.push(o)}e?.isCancellationRequested||(n.status!=="partial"?n={status:"full",resolutionTime:0,value:[]}:n.status="full")}catch(o){if(e?.isCancellationRequested)return;n={status:"error",resolutionTime:0,reason:o}}})();return await sJe(i,e),n.resolutionTime=performance.now()-r,n}s(BGt,"resolveIterable");d();var NGt={maxSnippetLength:3e3,maxSnippetCount:7,enabledFeatures:"Deferred",timeBudgetMs:7,doAggregateSnippets:!0},MGt="ms-vscode.cpptools",LGt="CppCompletionContextProvider";function lJe(t,e,r,n){(e.includes(LGt)||e.length===1&&e[0]==="*")&&dJe(t,r,n)}s(lJe,"fillInCppVSActiveExperiments");function uJe(t,e,r,n){(e.length===1&&e[0]==="*"||e.includes(MGt))&&dJe(t,r,n)}s(uJe,"fillInCppVSCodeActiveExperiments");function dJe(t,e,r){try{let n=NGt,i=t.get(Mt).cppContextProviderParams(r);if(i)try{n=JSON.parse(i)}catch(o){dn.error(t,"Failed to parse cppContextProviderParams",o)}for(let[o,a]of Object.entries(n))e.set(o,a)}catch(n){dn.exception(t,n,"fillInCppActiveExperiments")}}s(dJe,"addActiveExperiments");d();function VX(t,e,r){try{let n=t.get(Mt).csharpContextProviderParams(r);if(n){let i=JSON.parse(n);for(let[o,a]of Object.entries(i))e.set(o,a)}}catch(n){return dn.debug(t,"Failed to get the active C# experiments for the Context Provider API",n),!1}return!0}s(VX,"fillInCSharpActiveExperiments");d();var jT="fallbackContextProvider",zX={mlcpMaxContextItems:20,mlcpMaxSymbolMatches:20,mlcpEnableImports:!1};function fJe(t,e,r,n){(e.length===1&&e[0]==="*"||e.includes(jT))&&FGt(t,r,n)}s(fJe,"fillInMultiLanguageActiveExperiments");function FGt(t,e,r){try{let n=OGt(t,r);for(let[i,o]of Object.entries(n))e.set(i,o)}catch(n){dn.exception(t,n,"fillInMultiLanguageActiveExperiments")}}s(FGt,"addActiveExperiments");function OGt(t,e){let r=zX,n=t.get(Mt).multiLanguageContextProviderParams(e);if(n)try{r=JSON.parse(n)}catch(i){dn.error(t,"Failed to parse multiLanguageContextProviderParams",i)}return r}s(OGt,"getMultiLanguageContextProviderParamsFromExp");function pJe(t){let e={...zX};return t.has("mlcpMaxContextItems")&&(e.mlcpMaxContextItems=Number(t.get("mlcpMaxContextItems"))),t.has("mlcpMaxSymbolMatches")&&(e.mlcpMaxSymbolMatches=Number(t.get("mlcpMaxSymbolMatches"))),t.has("mlcpEnableImports")&&(e.mlcpEnableImports=String(t.get("mlcpEnableImports"))==="true"),e}s(pJe,"getMultiLanguageContextProviderParamsFromActiveExperiments");d();var QGt="typescript-ai-context-provider";function mJe(t,e,r,n){if(!(e.length===1&&e[0]==="*"||e.includes(QGt)))return!1;try{let i=t.get(Mt).tsContextProviderParams(n);if(i){let o=JSON.parse(i);for(let[a,c]of Object.entries(o))r.set(a,c)}}catch(i){return dn.debug(t,"Failed to get the active TypeScript experiments for the Context Provider API",i),!1}return!0}s(mJe,"fillInTsActiveExperiments");d();var hJe=x.Object({importance:x.Optional(x.Integer({minimum:0,maximum:100})),id:x.Optional(x.String()),origin:x.Optional(x.Union([x.Literal("request"),x.Literal("update")]))}),gJe=x.Intersect([x.Object({name:x.String(),value:x.String()}),hJe]),AJe=x.Intersect([x.Object({uri:x.String(),value:x.String(),additionalUris:x.Optional(x.Array(x.String()))}),hJe]),UGt=[gJe,AJe],qGt=x.Union(UGt),HGt=new Map([["Trait",ta.Compile(gJe)],["CodeSnippet",ta.Compile(AJe)]]),$Gt=s(t=>t,"ensureTypesAreEqual");$Gt(!0);var WGt=x.Object({contextItems:x.Array(qGt)}),jGt=x.Object({selector:x.Array(x.Union([x.String(),x.Object({language:x.Optional(x.String()),scheme:x.Optional(x.String()),pattern:x.Optional(x.String())})]))}),lxe=x.Object({id:x.String()}),GGt=x.Intersect([lxe,jGt]),VGt=x.Intersect([lxe,WGt]),yJe=x.Object({providers:x.Array(GGt)}),CJe=x.Object({providers:x.Array(lxe)}),uxe=x.Object({providers:x.Array(VGt),updating:x.Optional(x.Array(x.String()))}),KX=x.Intersect([qze,x.Object({contextItems:x.Optional(uxe)})]);function YX(t,e){return t.map(r=>{let n=r.data.filter(i=>i.type===e);return n.length>0?{...r,data:n}:void 0}).filter(r=>r!==void 0)}s(YX,"filterContextItemsByType");function vJe(t){let e=[],r=0;return t.forEach(n=>{let i=!1;for(let[o,a]of HGt.entries())if(a.Check(n)){e.push({...n,type:o}),i=!0;break}i||r++}),[e,r]}s(vJe,"filterSupportedContextItems");function zGt(t){return t.length>0&&t.replaceAll(/[^a-zA-Z0-9-]/g,"").length===t.length}s(zGt,"validateContextItemId");function xJe(t,e){let r=new Set,n=[];for(let i of e){let o=i.id??br();if(!zGt(o)){let a=br();dn.error(t,`Invalid context item ID ${o}, replacing with ${a}`),o=a}if(r.has(o)){let a=br();dn.error(t,`Duplicate context item ID ${o}, replacing with ${a}`),o=a}r.add(o),n.push({...i,id:o})}return n}s(xJe,"addOrValidateContextItemsIDs");d();var fl=class{constructor(e=()=>new dxe){this.createStatistics=e;this.statistics=new Sr(25)}static{s(this,"ContextProviderStatistics")}getStatisticsForCompletion(e){let r=this.statistics.get(e);if(r)return r;let n=this.createStatistics();return this.statistics.set(e,n),n}getPreviousStatisticsForCompletion(e){let r=Array.from(this.statistics.keys());for(let n=r.length-1;n>=0;n--){let i=r[n];if(i!==e)return this.statistics.peek(i)}}},dxe=class{constructor(){this._expectations=new Map;this._lastResolution=new Map;this._statistics=new Map}static{s(this,"PerCompletionContextProviderStatistics")}addExpectations(e,r){let n=this._expectations.get(e)??[];this._expectations.set(e,[...n,...r])}clearExpectations(){this._expectations.clear()}setLastResolution(e,r){this._lastResolution.set(e,r)}get(e){return this._statistics.get(e)}computeMatch(e){try{for(let[r,n]of this._expectations){if(n.length===0)continue;let i=this._lastResolution.get(r)??"none";if(i==="none"||i==="error"){this._statistics.set(r,{usage:"none",resolution:i});continue}let o=[];for(let[u,f]of n){let p={id:u.id,type:u.type};if(u.origin&&(p.origin=u.origin),f==="content_excluded"){o.push({...p,usage:"none_content_excluded"});continue}let m=e.find(h=>h.source===u);m===void 0?o.push({...p,usage:"error"}):o.push({...p,usage:m.expectedTokens>0&&m.expectedTokens===m.actualTokens?"full":m.actualTokens>0?"partial":"none",expectedTokens:m.expectedTokens,actualTokens:m.actualTokens})}let c=o.reduce((u,f)=>f.usage==="full"?u+1:f.usage==="partial"?u+.5:u,0)/n.length,l=c===1?"full":c===0?"none":"partial";this._statistics.set(r,{resolution:i,usage:l,usageDetails:o})}}finally{this.clearExpectations(),this._lastResolution.clear()}}};function JX(t){return t.map(e=>{if(!(e.source===void 0||e.expectedTokens===void 0||e.actualTokens===void 0))return{source:e.source,expectedTokens:e.expectedTokens,actualTokens:e.actualTokens}}).filter(e=>e!==void 0)}s(JX,"componentStatisticsToPromptMatcher");var EJe=Be(hi());var Hc=class{static{s(this,"ContextProviderRegistry")}},jC=class{static{s(this,"DefaultContextProviders")}},T3=class extends jC{constructor(){super();this.ids=[]}static{s(this,"DefaultContextProvidersContainer")}add(r){this.ids.push(r)}getIds(){return this.ids}},fxe=class extends Hc{constructor(r,n){super();this.ctx=r;this.match=n;this._providers=[]}static{s(this,"CoreContextProviderRegistry")}registerContextProvider(r){if(r.id.includes(",")||r.id.includes("*"))throw new Error(`A context provider id cannot contain a comma or an asterisk. The id ${r.id} is invalid.`);if(this._providers.find(n=>n.id===r.id))throw new Error(`A context provider with id ${r.id} has already been registered`);this._providers.push(r)}unregisterContextProvider(r){this._providers=this._providers.filter(n=>n.id!==r)}get providers(){return this._providers.slice()}async resolveAllProviders(r,n,i,o,a,c){if(a?.isCancellationRequested)return dn.debug(this.ctx,"Resolving context providers cancelled"),[];let l=new Map;VX(this.ctx,l,o);let u=[];if(this._providers.length===0)return u;let f=await this.matchProviders(i,o),p=f.filter(R=>R[1]>0);if(f.filter(R=>R[1]<=0).forEach(([R,B])=>{let L={providerId:R.id,matchScore:B,resolution:"none",resolutionTimeMs:0,data:[]};u.push(L)}),p.length===0)return u;if(a?.isCancellationRequested)return dn.debug(this.ctx,"Resolving context providers cancelled"),[];uJe(this.ctx,p.map(R=>R[0].id),l,o),fJe(this.ctx,p.map(R=>R[0].id),l,o),mJe(this.ctx,p.map(R=>R[0].id),l,o);let h=new EJe.CancellationTokenSource;if(a){let R=a.onCancellationRequested(B=>{h.cancel(),R.dispose()})}let g=UF(this.ctx)&&!Ij(this.ctx)?0:KGt(this.ctx,o),A=g>0?Date.now()+g:Number.MAX_SAFE_INTEGER,y;g>0&&(y=setTimeout(()=>{h.cancel(),h.dispose()},g));let E=new Map,b={completionId:r,opportunityId:n,documentContext:i,activeExperiments:l,timeBudget:g,timeoutEnd:A,data:c};for(let[R]of p){let B=this.ctx.get(fl).getPreviousStatisticsForCompletion(r)?.get(R.id);B&&(b.previousUsageStatistics=B);let L=R.resolver.resolve(b,h.token);E.set(R.id,L)}let S=await aJe(E,h.token);y&&clearTimeout(y);for(let[R,B]of p){let L=S.get(R.id);if(L){if(L.status==="error")SY(L.reason)||dn.error(this.ctx,`Error resolving context from ${R.id}: `,L.reason),u.push({providerId:R.id,matchScore:B,resolution:L.status,resolutionTimeMs:L.resolutionTime,data:[]});else{let O=[...L.value??[]];if((L.status==="none"||L.status==="partial")&&(dn.info(this.ctx,`Context provider ${R.id} exceeded time budget of ${g}ms`),R.resolver.resolveOnTimeout))try{let U=R.resolver.resolveOnTimeout(b);cxe(U)?O.push(...U):U&&O.push(U),O.length>0&&(L.status="partial")}catch(U){dn.error(this.ctx,`Error in fallback logic for context provider ${R.id}: `,U)}let[Y,V]=vJe(O);V&&dn.error(this.ctx,`Dropped ${V} context items from ${R.id} due to invalid schema`);let z=xJe(this.ctx,Y),Q={providerId:R.id,matchScore:B,resolution:L.status,resolutionTimeMs:L.resolutionTime,data:z};u.push(Q)}this.ctx.get(fl).getStatisticsForCompletion(r).setLastResolution(R.id,L.status)}else dn.error(this.ctx,`Context provider ${R.id} not found in results`)}return u.sort((R,B)=>B.matchScore-R.matchScore)}async matchProviders(r,n){let i=tZ(this.ctx,n),o=i.length===1&&i[0]==="*";return await Promise.all(this._providers.map(async c=>{if(!o&&!i.includes(c.id))return[c,0];let l=await this.match(this.ctx,c.selector,r);return[c,l]}))}},pxe=class extends Hc{constructor(r){super();this.delegate=r;this._cachedContextItems=new Sr(5)}static{s(this,"CachedContextProviderRegistry")}registerContextProvider(r){this.delegate.registerContextProvider(r)}unregisterContextProvider(r){this.delegate.unregisterContextProvider(r)}get providers(){return this.delegate.providers}async resolveAllProviders(r,n,i,o,a,c){let l=this._cachedContextItems.get(r);if(r&&l&&l.length>0)return l;let u=await this.delegate.resolveAllProviders(r,n,i,o,a,c);return u.length>0&&r&&this._cachedContextItems.set(r,u),u}};function XX(t,e){return new pxe(new fxe(t,e))}s(XX,"getContextProviderRegistry");function ZX(t,e,r){let n=t.get(fl).getStatisticsForCompletion(e);return r.map(o=>{let{providerId:a,resolution:c,resolutionTimeMs:l,matchScore:u,data:f}=o,p=n.get(a),m=p?.usage??"none";(u<=0||c==="none"||c==="error")&&(m="none");let h={providerId:a,resolution:c,resolutionTimeMs:l,usage:m,usageDetails:p?.usageDetails,matched:u>0,numResolvedItems:f.length},g=p?.usageDetails!==void 0?p?.usageDetails.filter(y=>y.usage==="full"||y.usage==="partial"||y.usage==="partial_content_excluded").length:void 0,A=p?.usageDetails!==void 0?p?.usageDetails.filter(y=>y.usage==="partial"||y.usage==="partial_content_excluded").length:void 0;return g!==void 0&&(h.numUsedItems=g),A!==void 0&&(h.numPartiallyUsedItems=A),h})}s(ZX,"telemetrizeContextItems");function eZ(t){return t.matchScore>0&&t.resolution!=="error"}s(eZ,"matchContextItems");function tZ(t,e){let r=mxe(t,e),n=zi(t,Ht.ContextProviders)??[];if(r.length===1&&r[0]==="*"||n.length===1&&n[0]==="*")return["*"];let i=t.get(jC).getIds();return Array.from(new Set([...i,...r,...n]))}s(tZ,"getActiveContextProviders");function mxe(t,e){return UF(t)?["*"]:t.get(Mt).contextProviders(e)}s(mxe,"getExpContextProviders");function w3(t,e){return tZ(t,e).length>0}s(w3,"useContextProviderAPI");function KGt(t,e){let r=zi(t,Ht.ContextProviderTimeBudget);return r!==void 0&&typeof r=="number"?r:t.get(Mt).contextProviderTimeBudget(e)}s(KGt,"getContextProviderTimeBudget");var kp=class{constructor(e){this.ctx=e;this.scheduledResolutions=new Sr(25)}static{s(this,"ContextProviderBridge")}schedule(e,r,n,i,o,a){let c=this.ctx.get(Hc),{textDocument:l,originalPosition:u,originalOffset:f,originalVersion:p,editsWithPosition:m}=e,h=c.resolveAllProviders(r,n,{uri:l.uri,languageId:l.detectedLanguageId,version:p,offset:f,position:u,proposedEdits:m.length>0?m:void 0},i,o,a?.data);this.scheduledResolutions.set(r,h)}async resolution(e){let r=this.scheduledResolutions.get(e);return r?await r:[]}};d();d();var rZ=class{constructor(e,r,n){this.languageId=e;this.nodeMatch=r;this.nodeTypesWithBlockOrStmtChild=n}static{s(this,"BaseBlockParser")}async getNodeMatchAtPosition(e,r,n){let i=await yx(this.languageId,e);try{let a=i.rootNode.descendantForIndex(r);for(;a;){let c=this.nodeMatch[a.type];if(c){if(!this.nodeTypesWithBlockOrStmtChild.has(a.type))break;let l=this.nodeTypesWithBlockOrStmtChild.get(a.type);if((l==""?a.namedChildren[0]:a.childForFieldName(l))?.type==c)break}a=a.parent}return a?n(a):void 0}finally{i.delete()}}getNextBlockAtPosition(e,r,n){return this.getNodeMatchAtPosition(e,r,i=>{let o=i.children.reverse().find(a=>a.type==this.nodeMatch[i.type]);if(o){if(this.languageId=="python"&&o.parent){let a=o.parent.type==":"?o.parent.parent:o.parent,c=a?.nextSibling;for(;c&&c.type=="comment";){let l=c.startPosition.row==o.endPosition.row&&c.startPosition.column>=o.endPosition.column,u=c.startPosition.row>a.endPosition.row&&c.startPosition.column>a.startPosition.column;if(l||u)o=c,c=c.nextSibling;else break}}if(!(o.endIndex>=o.tree.rootNode.endIndex-1&&(o.hasError()||o.parent.hasError())))return n(o)}})}async isBlockBodyFinished(e,r,n){let i=(e+r).trimEnd(),o=await this.getNextBlockAtPosition(i,n,a=>a.endIndex);if(o!==void 0&&o<i.length){let a=o-e.length;return a>0?a:void 0}}getNodeStart(e,r){let n=e.trimEnd();return this.getNodeMatchAtPosition(n,r,i=>i.startIndex)}},nZ=class extends rZ{constructor(r,n,i,o,a){super(r,o,a);this.blockEmptyMatch=n;this.lineMatch=i}static{s(this,"RegexBasedBlockParser")}isBlockStart(r){return this.lineMatch.test(r.trimStart())}async isBlockBodyEmpty(r,n){let i=await this.getNextBlockAtPosition(r,n,o=>{o.startIndex<n&&(n=o.startIndex);let a=r.substring(n,o.endIndex).trim();return a==""||a.replace(/\s/g,"")==this.blockEmptyMatch});return i===void 0||i}async isEmptyBlockStart(r,n){return n=IJe(r,n),this.isBlockStart(YGt(r,n))&&this.isBlockBodyEmpty(r,n)}};function YGt(t,e){let r=t.lastIndexOf(`
`,e-1),n=t.indexOf(`
`,e);return n<0&&(n=t.length),t.slice(r+1,n)}s(YGt,"getLineAtOffset");function IJe(t,e){let r=e;for(;r>0&&/\s/.test(t.charAt(r-1));)r--;return r}s(IJe,"rewindToNearestNonWs");function bJe(t,e){let r=t.startIndex,n=t.startIndex-t.startPosition.column,i=e.substring(n,r);if(/^\s*$/.test(i))return i}s(bJe,"indent");function JGt(t,e,r){if(e.startPosition.row<=t.startPosition.row)return!1;let n=bJe(t,r),i=bJe(e,r);return n!==void 0&&i!==void 0&&n.startsWith(i)}s(JGt,"outdented");var GC=class extends rZ{constructor(r,n,i,o,a,c,l){super(r,n,i);this.startKeywords=o;this.blockNodeType=a;this.emptyStatementType=c;this.curlyBraceLanguage=l}static{s(this,"TreeSitterBasedBlockParser")}isBlockEmpty(r,n){let i=r.text.trim();return this.curlyBraceLanguage&&(i.startsWith("{")&&(i=i.slice(1)),i.endsWith("}")&&(i=i.slice(0,-1)),i=i.trim()),!!(i.length==0||this.languageId=="python"&&(r.parent?.type=="class_definition"||r.parent?.type=="function_definition")&&r.children.length==1&&Ije(r.parent))}async isEmptyBlockStart(r,n){if(n>r.length)throw new RangeError("Invalid offset");for(let o=n;o<r.length&&r.charAt(o)!=`
`;o++)if(/\S/.test(r.charAt(o)))return!1;n=IJe(r,n);let i=await yx(this.languageId,r);try{let o=i.rootNode.descendantForIndex(n-1);if(o==null||this.curlyBraceLanguage&&o.type=="}")return!1;if((this.languageId=="javascript"||this.languageId=="typescript")&&o.parent&&o.parent.type=="object"&&o.parent.text.trim()=="{")return!0;if(this.languageId=="typescript"){let f=o;for(;f.parent;){if(f.type=="function_signature"||f.type=="method_signature"){let p=o.nextSibling;return p&&f.hasError()&&JGt(f,p,r)?!0:!f.children.find(h=>h.type==";")&&f.endIndex<=n}f=f.parent}}let a=null,c=null,l=null,u=o;for(;u!=null;){if(u.type==this.blockNodeType){c=u;break}if(this.nodeMatch[u.type]){l=u;break}if(u.type=="ERROR"){a=u;break}u=u.parent}if(c!=null){if(!c.parent||!this.nodeMatch[c.parent.type])return!1;if(this.languageId=="python"){let f=c.previousSibling;if(f!=null&&f.hasError()&&(f.text.startsWith('"""')||f.text.startsWith("'''")))return!0}return this.isBlockEmpty(c,n)}if(a!=null){if(a.previousSibling?.type=="module"||a.previousSibling?.type=="internal_module"||a.previousSibling?.type=="def")return!0;let f=[...a.children].reverse(),p=f.find(h=>this.startKeywords.includes(h.type)),m=f.find(h=>h.type==this.blockNodeType);if(p){switch(this.languageId){case"python":{p.type=="try"&&o.type=="identifier"&&o.text.length>4&&(m=f.find(A=>A.hasError())?.children.find(A=>A.type=="block"));let h,g=0;for(let A of a.children){if(A.type==":"&&g==0){h=A;break}A.type=="("&&(g+=1),A.type==")"&&(g-=1)}if(h&&p.endIndex<=h.startIndex&&h.nextSibling){if(p.type=="def"){let A=h.nextSibling;if(A.type=='"'||A.type=="'"||A.type=="ERROR"&&(A.text=='"""'||A.text=="'''"))return!0}return!1}break}case"javascript":{let h=f.find(y=>y.type=="formal_parameters");if(p.type=="class"&&h)return!0;let g=f.find(y=>y.type=="{");if(g&&g.startIndex>p.endIndex&&g.nextSibling!=null||f.find(y=>y.type=="do")&&p.type=="while"||p.type=="=>"&&p.nextSibling&&p.nextSibling.type!="{")return!1;break}case"typescript":{let h=f.find(A=>A.type=="{");if(h&&h.startIndex>p.endIndex&&h.nextSibling!=null||f.find(A=>A.type=="do")&&p.type=="while"||p.type=="=>"&&p.nextSibling&&p.nextSibling.type!="{")return!1;break}}return m&&m.startIndex>p.endIndex?this.isBlockEmpty(m,n):!0}}if(l!=null){let f=this.nodeMatch[l.type],p=l.children.slice().reverse().find(m=>m.type==f);if(p)return this.isBlockEmpty(p,n);if(this.nodeTypesWithBlockOrStmtChild.has(l.type)){let m=this.nodeTypesWithBlockOrStmtChild.get(l.type),h=m==""?l.children[0]:l.childForFieldName(m);if(h&&h.type!=this.blockNodeType&&h.type!=this.emptyStatementType)return!1}return!0}return!1}finally{i.delete()}}},XGt={python:new GC("python",{class_definition:"block",elif_clause:"block",else_clause:"block",except_clause:"block",finally_clause:"block",for_statement:"block",function_definition:"block",if_statement:"block",try_statement:"block",while_statement:"block",with_statement:"block"},new Map,["def","class","if","elif","else","for","while","try","except","finally","with"],"block",null,!1),javascript:new GC("javascript",{arrow_function:"statement_block",catch_clause:"statement_block",do_statement:"statement_block",else_clause:"statement_block",finally_clause:"statement_block",for_in_statement:"statement_block",for_statement:"statement_block",function:"statement_block",function_declaration:"statement_block",generator_function:"statement_block",generator_function_declaration:"statement_block",if_statement:"statement_block",method_definition:"statement_block",try_statement:"statement_block",while_statement:"statement_block",with_statement:"statement_block",class:"class_body",class_declaration:"class_body"},new Map([["arrow_function","body"],["do_statement","body"],["else_clause",""],["for_in_statement","body"],["for_statement","body"],["if_statement","consequence"],["while_statement","body"],["with_statement","body"]]),["=>","try","catch","finally","do","for","if","else","while","with","function","function*","class"],"statement_block","empty_statement",!0),typescript:new GC("typescript",{ambient_declaration:"statement_block",arrow_function:"statement_block",catch_clause:"statement_block",do_statement:"statement_block",else_clause:"statement_block",finally_clause:"statement_block",for_in_statement:"statement_block",for_statement:"statement_block",function:"statement_block",function_declaration:"statement_block",generator_function:"statement_block",generator_function_declaration:"statement_block",if_statement:"statement_block",internal_module:"statement_block",method_definition:"statement_block",module:"statement_block",try_statement:"statement_block",while_statement:"statement_block",abstract_class_declaration:"class_body",class:"class_body",class_declaration:"class_body"},new Map([["arrow_function","body"],["do_statement","body"],["else_clause",""],["for_in_statement","body"],["for_statement","body"],["if_statement","consequence"],["while_statement","body"],["with_statement","body"]]),["declare","=>","try","catch","finally","do","for","if","else","while","with","function","function*","class"],"statement_block","empty_statement",!0),tsx:new GC("typescriptreact",{ambient_declaration:"statement_block",arrow_function:"statement_block",catch_clause:"statement_block",do_statement:"statement_block",else_clause:"statement_block",finally_clause:"statement_block",for_in_statement:"statement_block",for_statement:"statement_block",function:"statement_block",function_declaration:"statement_block",generator_function:"statement_block",generator_function_declaration:"statement_block",if_statement:"statement_block",internal_module:"statement_block",method_definition:"statement_block",module:"statement_block",try_statement:"statement_block",while_statement:"statement_block",abstract_class_declaration:"class_body",class:"class_body",class_declaration:"class_body"},new Map([["arrow_function","body"],["do_statement","body"],["else_clause",""],["for_in_statement","body"],["for_statement","body"],["if_statement","consequence"],["while_statement","body"],["with_statement","body"]]),["declare","=>","try","catch","finally","do","for","if","else","while","with","function","function*","class"],"statement_block","empty_statement",!0),go:new nZ("go","{}",/\b(func|if|else|for)\b/,{communication_case:"block",default_case:"block",expression_case:"block",for_statement:"block",func_literal:"block",function_declaration:"block",if_statement:"block",labeled_statement:"block",method_declaration:"block",type_case:"block"},new Map),ruby:new nZ("ruby","end",/\b(BEGIN|END|case|class|def|do|else|elsif|for|if|module|unless|until|while)\b|->/,{begin_block:"}",block:"}",end_block:"}",lambda:"block",for:"do",until:"do",while:"do",case:"end",do:"end",if:"end",method:"end",module:"end",unless:"end",do_block:"end"},new Map),c_sharp:new GC("csharp",{},new Map([]),[],"block",null,!0),java:new GC("java",{},new Map([]),[],"block",null,!0),php:new GC("php",{},new Map([]),[],"block",null,!0),cpp:new GC("cpp",{},new Map([]),[],"block",null,!0)};function hxe(t){if(!U0(t))throw new Error(`Language ${t} is not supported`);return XGt[bY(t)]}s(hxe,"getBlockParser");async function TJe(t,e,r){return U0(t)?hxe(t).isEmptyBlockStart(e,r):!1}s(TJe,"isEmptyBlockStart");async function wJe(t,e,r,n){if(U0(t))return hxe(t).isBlockBodyFinished(e,r,n)}s(wJe,"isBlockBodyFinished");async function SJe(t,e,r){if(U0(t))return hxe(t).getNodeStart(e,r)}s(SJe,"getNodeStart");var XVn=new dt("parseBlock");function C7(t,e,r){let n=e.getText(Es.range(Es.position(0,0),r)),i=e.offsetAt(r),o=e.detectedLanguageId;return a=>wJe(o,n,a,i)}s(C7,"parsingBlockFinished");function oZ(t,e){return TJe(t.detectedLanguageId,t.getText(),t.offsetAt(e))}s(oZ,"isEmptyBlockStartUtil");async function _Je(t,e,r,n){let o=e.getText(Es.range(Es.position(0,0),r))+n,a=await SJe(e.detectedLanguageId,o,e.offsetAt(r));if(a)return e.positionAt(a)}s(_Je,"getNodeStartUtil");var ZGt=["\\{","\\}","\\[","\\]","\\(","\\)"].concat(["then","else","elseif","elif","catch","finally","fi","done","end","loop","until","where","when"].map(t=>t+"\\b")),eVt=new RegExp(`^(${ZGt.join("|")})`);function tVt(t){return eVt.test(t.trimLeft().toLowerCase())}s(tVt,"isContinuationLine");function iZ(t){let e=/^(\s*)([^]*)$/.exec(t);if(e&&e[2]&&e[2].length>0)return e[1].length}s(iZ,"indentationOfLine");function sZ(t,e){let r=t.getText(),n=t.offsetAt(e);return gxe(r,n,t.detectedLanguageId)}s(sZ,"contextIndentation");function gxe(t,e,r){let n=t.slice(0,e).split(`
`),i=t.slice(e).split(`
`);function o(f,p,m){let h=p,g,A;for(;g===void 0&&h>=0&&h<f.length;)g=iZ(f[h]),A=h,h+=m;if(r==="python"&&m===-1){h++;let y=f[h].trim();if(y.endsWith('"""')){if(!(y.startsWith('"""')&&y!=='"""'))for(h--;h>=0&&!f[h].trim().startsWith('"""');)h--;if(h>=0)for(g=void 0,h--;g===void 0&&h>=0;)g=iZ(f[h]),A=h,h--}}return[g,A]}s(o,"seekNonBlank");let[a,c]=o(n,n.length-1,-1),l=(()=>{if(!(a===void 0||c===void 0))for(let f=c-1;f>=0;f--){let p=iZ(n[f]);if(p!==void 0&&p<a)return p}})(),[u]=o(i,1,1);return{prev:l,current:a??0,next:u}}s(gxe,"contextIndentationFromText");var rVt=!1;function nVt(t,e,r){let n=t.split(`
`),i=r!==void 0,o=r?.split(`
`).pop(),a=0;if(i&&o?.trim()!=""&&n[0].trim()!==""&&a++,!i&&rVt&&n[0].trim()===""&&a++,i||a++,n.length===a)return"continue";let c=Math.max(e.current,e.next??0);for(let l=a;l<n.length;l++){let u=n[l];l==0&&o!==void 0&&(u=o+u);let f=iZ(u);if(f!==void 0&&(f<c||f===c&&!tVt(u)))return n.slice(0,l).join(`
`).length}return"continue"}s(nVt,"completionCutOrContinue");function RJe(t,e){return r=>{let n=nVt(r,t,e);return n==="continue"?void 0:n}}s(RJe,"indentationBlockFinished");d();d();d();d();d();d();var iVt={tokenizerName:"o200k_base"};function oVt(t){return{...iVt,...t}}s(oVt,"cursorContextOptions");function v7(t,e={}){let r=oVt(e),n=Li(r.tokenizerName);if(r.maxLineCount!==void 0&&r.maxLineCount<0)throw new Error("maxLineCount must be non-negative if defined");if(r.maxTokenLength!==void 0&&r.maxTokenLength<0)throw new Error("maxTokenLength must be non-negative if defined");if(r.maxLineCount===0||r.maxTokenLength===0)return{context:"",lineCount:0,tokenLength:0,tokenizerName:r.tokenizerName};let i=t.source.slice(0,t.offset);return r.maxLineCount!==void 0&&(i=i.split(`
`).slice(-r.maxLineCount).join(`
`)),r.maxTokenLength!==void 0&&(i=n.takeLastLinesTokens(i,r.maxTokenLength)),{context:i,lineCount:i.split(`
`).length,tokenLength:n.tokenLength(i),tokenizerName:r.tokenizerName}}s(v7,"getCursorContext");d();d();var sVt={function:"function",snippet:"snippet",snippets:"snippets",variable:"variable",parameter:"parameter",method:"method",class:"class",module:"module",alias:"alias","enum member":"enum member",interface:"interface"};function kJe(t){let e=sVt[t.semantics],r=["snippets"].includes(t.semantics)?"these":"this";return{headline:t.relativePath?`Compare ${r} ${e} from ${t.relativePath}:`:`Compare ${r} ${e}:`,snippet:t.snippet}}s(kJe,"announceSnippet");var Axe=class{constructor(e){this.keys=[];this.cache={};this.size=e}static{s(this,"FifoCache")}put(e,r){if(this.cache[e]=r,this.keys.length>this.size){this.keys.push(e);let n=this.keys.shift()??"";delete this.cache[n]}}get(e){return this.cache[e]}};var yxe=class{static{s(this,"Tokenizer")}constructor(e){this.stopsForLanguage=uVt.get(e.languageId)??lVt}tokenize(e){return new Set(aVt(e).filter(r=>!this.stopsForLanguage.has(r)))}},PJe=new Axe(20),S3=class{static{s(this,"WindowedMatcher")}constructor(e){this.referenceDoc=e,this.tokenizer=new yxe(e)}get referenceTokens(){return Promise.resolve(this.createReferenceTokens())}createReferenceTokens(){return this.referenceTokensCache??=this.tokenizer.tokenize(this._getCursorContextInfo(this.referenceDoc).context)}sortScoredSnippets(e,r="descending"){return r=="ascending"?e.sort((n,i)=>n.score>i.score?1:-1):r=="descending"?e.sort((n,i)=>n.score>i.score?-1:1):e}async retrieveAllSnippets(e,r="descending"){let n=[];if(e.source.length===0||(await this.referenceTokens).size===0)return n;let i=e.source.split(`
`),o=this.id()+":"+e.source,a=PJe.get(o)??[],c=a.length==0,l=c?i.map(u=>this.tokenizer.tokenize(u),this.tokenizer):[];for(let[u,[f,p]]of this.getWindowsDelineations(i).entries()){if(c){let g=new Set;l.slice(f,p).forEach(A=>A.forEach(y=>g.add(y),g)),a.push(g)}let m=a[u],h=this.similarityScore(m,await this.referenceTokens);if(n.length&&f>0&&n[n.length-1].endLine>f){n[n.length-1].score<h&&(n[n.length-1].score=h,n[n.length-1].startLine=f,n[n.length-1].endLine=p);continue}n.push({score:h,startLine:f,endLine:p})}return c&&PJe.put(o,a),this.sortScoredSnippets(n,r)}findMatches(e,r){return this.findBestMatch(e,r)}async findBestMatch(e,r){if(e.source.length===0||(await this.referenceTokens).size===0)return[];let n=e.source.split(`
`),i=await this.retrieveAllSnippets(e,"descending");if(i.length===0)return[];let o=[];for(let a=0;a<i.length&&a<r;a++)if(i[a].score!==0){let c=n.slice(i[a].startLine,i[a].endLine).join(`
`);o.push({snippet:c,semantics:"snippet",provider:"similar-files",...i[a]})}return o}};function aVt(t){return t.split(/[^a-zA-Z0-9]/).filter(e=>e.length>0)}s(aVt,"splitIntoWords");var cVt=new Set(["we","our","you","it","its","they","them","their","this","that","these","those","is","are","was","were","be","been","being","have","has","had","having","do","does","did","doing","can","don","t","s","will","would","should","what","which","who","when","where","why","how","a","an","the","and","or","not","no","but","because","as","until","again","further","then","once","here","there","all","any","both","each","few","more","most","other","some","such","above","below","to","during","before","after","of","at","by","about","between","into","through","from","up","down","in","out","on","off","over","under","only","own","same","so","than","too","very","just","now"]),lVt=new Set(["if","then","else","for","while","with","def","function","return","TODO","import","try","catch","raise","finally","repeat","switch","case","match","assert","continue","break","const","class","enum","struct","static","new","super","this","var",...cVt]),uVt=new Map([]);d();function aZ(t,e){let r=[],n=e.length;if(n==0)return[];if(n<t)return[[0,n]];for(let i=0;i<n-t+1;i++)r.push([i,i+t]);return r}s(aZ,"getBasicWindowDelineations");var cZ=class t extends S3{static{s(this,"FixedWindowSizeJaccardMatcher")}constructor(e,r){super(e),this.windowLength=r}static{this.FACTORY=s(e=>({to:s(r=>new t(r,e),"to")}),"FACTORY")}id(){return"fixed:"+this.windowLength}getWindowsDelineations(e){return aZ(this.windowLength,e)}_getCursorContextInfo(e){return v7(e,{maxLineCount:this.windowLength})}similarityScore(e,r){return dVt(e,r)}};function dVt(t,e){let r=new Set;return t.forEach(n=>{e.has(n)&&r.add(n)}),r.size/(t.size+e.size-r.size)}s(dVt,"computeScore");d();var lZ=class t extends S3{static{s(this,"BlockTokenSubsetMatcher")}constructor(e,r){super(e),this.windowLength=r}static{this.FACTORY=s(e=>({to:s(r=>new t(r,e),"to")}),"FACTORY")}id(){return"fixed:"+this.windowLength}getWindowsDelineations(e){return aZ(this.windowLength,e)}_getCursorContextInfo(e){return v7(e,{maxLineCount:this.windowLength})}get referenceTokens(){return this.createReferenceTokensForLanguage()}async createReferenceTokensForLanguage(){return this.referenceTokensCache?this.referenceTokensCache:(this.referenceTokensCache=t.syntaxAwareSupportsLanguage(this.referenceDoc.languageId)?await this.syntaxAwareReferenceTokens():await super.referenceTokens,this.referenceTokensCache)}async syntaxAwareReferenceTokens(){let e=(await this.getEnclosingMemberStart(this.referenceDoc.source,this.referenceDoc.offset))?.startIndex,r=this.referenceDoc.offset,n=e?this.referenceDoc.source.slice(e,r):v7(this.referenceDoc,{maxLineCount:this.windowLength}).context;return this.tokenizer.tokenize(n)}static syntaxAwareSupportsLanguage(e){switch(e){case"csharp":return!0;default:return!1}}similarityScore(e,r){return fVt(e,r)}async getEnclosingMemberStart(e,r){let n;try{n=await yx(this.referenceDoc.languageId,e);let i=n.rootNode.namedDescendantForIndex(r);for(;i&&!(t.isMember(i)||t.isBlock(i));)i=i.parent??void 0;return i}finally{n?.delete()}}static isMember(e){switch(e?.type){case"method_declaration":case"property_declaration":case"field_declaration":case"constructor_declaration":return!0;default:return!1}}static isBlock(e){switch(e?.type){case"class_declaration":case"struct_declaration":case"record_declaration":case"enum_declaration":case"interface_declaration":return!0;default:return!1}}};function fVt(t,e){let r=new Set;return e.forEach(n=>{t.has(n)&&r.add(n)}),r.size}s(fVt,"computeScore");var pVt=0,mVt=60,hVt=4,gVt=1,AVt=20,yVt=1e4,DJe={snippetLength:mVt,threshold:pVt,maxTopSnippets:hVt,maxCharPerFile:yVt,maxNumberOfFiles:AVt,maxSnippetsPerFile:gVt,useSubsetMatching:!1};var Cxe={snippetLength:60,threshold:0,maxTopSnippets:16,maxCharPerFile:1e5,maxNumberOfFiles:200,maxSnippetsPerFile:4};function CVt(t,e){return(e.useSubsetMatching?lZ.FACTORY(e.snippetLength):cZ.FACTORY(e.snippetLength)).to(t)}s(CVt,"getMatcher");async function BJe(t,e,r){let n=CVt(t,r);return r.maxTopSnippets===0?[]:(await e.filter(o=>o.source.length<r.maxCharPerFile&&o.source.length>0).slice(0,r.maxNumberOfFiles).reduce(async(o,a)=>(await o).concat((await n.findMatches(a,r.maxSnippetsPerFile)).map(c=>({relativePath:a.relativePath,...c}))),Promise.resolve([]))).filter(o=>o.score&&o.snippet&&o.score>r.threshold).sort((o,a)=>o.score-a.score).slice(-r.maxTopSnippets)}s(BJe,"getSimilarSnippets");function NJe(t,e){return{...Cxe,useSubsetMatching:vxe(t,e)}}s(NJe,"getCppSimilarFilesOptions");function MJe(t){return Cxe.maxTopSnippets}s(MJe,"getCppNumberOfSnippets");var vVt=new Map([["cpp",NJe]]);function uZ(t,e,r){let n=vVt.get(r);return n?n(t,e):{...DJe,useSubsetMatching:vxe(t,e)}}s(uZ,"getSimilarFilesOptions");var xVt=new Map([["cpp",MJe]]);function LJe(t,e){let r=xVt.get(e);return r?r(t):vje}s(LJe,"getNumberOfSnippets");function vxe(t,e){return(e.filtersAndExp.exp.variables.copilotsubsetmatching||zi(t,Ht.UseSubsetMatching))??!1}s(vxe,"useSubsetMatching");d();d();d();d();var EVt="content_excluded";async function dZ(t,e,r,n){let i=YX(r,"CodeSnippet");if(i.length===0)return[];let o=new Set,a=i.flatMap(f=>f.data.map(p=>(o.add(p.uri),p.additionalUris?.forEach(m=>o.add(m)),{providerId:f.providerId,data:p}))),c=t.get(dr),l=new Map;await Promise.all(Array.from(o).map(async f=>{l.set(f,await c.getTextDocumentValidation({uri:f}))}));let u=t.get(fl).getStatisticsForCompletion(e);return a.filter(f=>{let m=[f.data.uri,...f.data.additionalUris??[]].every(h=>l.get(h)?.status==="valid");return m?u.addExpectations(f.providerId,[[f.data,"included"]]):u.addExpectations(f.providerId,[[f.data,EVt]]),m}).map(f=>f.data)}s(dZ,"getCodeSnippetsFromContextItems");function FJe(t,e){let r=t.get(dr);return e.map(n=>({snippet:n,relativePath:r.getRelativePath(n)}))}s(FJe,"addRelativePathToCodeSnippets");d();function mc(t){if(t.children)return Array.isArray(t.children)?t.children.join(""):t.children}s(mc,"Text");function GT(t){return t.children}s(GT,"Chunk");d();function Zr(t,e,r){let n=[];Array.isArray(e.children)?n=e.children:e.children&&(n=[e.children]);let i={...e,children:n};return r&&(i.key=r),{type:t,props:i}}s(Zr,"functionComponentFunction");function BA(t){return{type:"f",children:t}}s(BA,"fragmentFunction");BA.isFragmentFunction=!0;var fZ=s((t,e)=>{let[r,n]=e.useState(),[i,o]=e.useState();if(e.useData(Pp,u=>{u.codeSnippets!==r&&n(u.codeSnippets),u.document.uri!==i?.uri&&o(u.document)}),!r||r.length===0||!i)return;let a=FJe(t.ctx,r),c=new Map;for(let u of a){let f=u.relativePath??u.snippet.uri,p=c.get(f);p===void 0&&(p=[],c.set(f,p)),p.push(u)}let l=[];for(let[u,f]of c.entries()){let p=f.filter(m=>m.snippet.value.length>0);p.length>0&&l.push({chunkElements:p.map(m=>m.snippet),importance:Math.max(...p.map(m=>m.snippet.importance??0)),uri:u})}if(l.length!==0)return l.sort((u,f)=>f.importance-u.importance),l.reverse(),l.map(u=>{let f=[];return f.push(Zr(mc,{children:`Compare ${u.chunkElements.length>1?"these snippets":"this snippet"} from ${u.uri}:`})),u.chunkElements.forEach((p,m)=>{f.push(Zr(mc,{source:p,children:p.value},p.id)),u.chunkElements.length>1&&m<u.chunkElements.length-1&&f.push(Zr(mc,{children:"---"}))}),Zr(GT,{children:f})})},"CodeSnippets");d();function xxe(t){return t.children}s(xxe,"CompletionsContext");function Exe(t){return t.children}s(Exe,"StableCompletionsContext");function bxe(t){return t.children}s(bxe,"AdditionalCompletionsContext");function pZ(t){return t.name===xxe.name||t.name===Exe.name||t.name===bxe.name}s(pZ,"isContextNode");d();d();d();function mZ(t,e){if(t.length===0||e.length===0)return{score:t.length+e.length};let r=Array.from({length:t.length}).map(()=>Array.from({length:e.length}).map(()=>0));for(let n=0;n<t.length;n++)r[n][0]=n;for(let n=0;n<e.length;n++)r[0][n]=n;for(let n=0;n<e.length;n++)for(let i=0;i<t.length;i++)r[i][n]=Math.min((i==0?n:r[i-1][n])+1,(n==0?i:r[i][n-1])+1,(i==0||n==0?Math.max(i,n):r[i-1][n-1])+(t[i]==e[n]?0:1));return{score:r[t.length-1][e.length-1]}}s(mZ,"findEditDistanceScore");var x7=50;function Ixe(t){let e=t*4,r=t*.1;return Math.floor(e+r)}s(Ixe,"approximateMaxCharacters");function E7(t,e){let[r,n]=e.useState(),[i,o]=e.useState(),[a,c]=e.useState(0),[l,u]=e.useState(),[f,p]=e.useState();e.useData(Pp,h=>{let g=h.document;(h.document.uri!==r?.uri||g.getText()!==r?.getText())&&n(g),h.position!==i&&o(h.position),h.suffixMatchThreshold!==l&&u(h.suffixMatchThreshold),h.maxPromptTokens!==a&&c(h.maxPromptTokens),h.tokenizer!==f&&p(h.tokenizer)});let m=Ixe(a);return Zr(BA,{children:[Zr($R,{document:r,position:i,maxCharacters:m}),Zr(hZ,{document:r,position:i,suffixMatchThreshold:l,maxCharacters:m,tokenizer:f})]})}s(E7,"CurrentFile");function $R(t){if(t.document===void 0||t.position===void 0)return Zr(mc,{});let e=t.document.getText({start:{line:0,character:0},end:t.position});return e.length>t.maxCharacters&&(e=e.slice(-t.maxCharacters)),Zr(mc,{children:e})}s($R,"BeforeCursor");function hZ(t,e){let[r,n]=e.useState("");if(t.document===void 0||t.position===void 0)return Zr(mc,{});let i=t.document.getText({start:t.position,end:{line:Number.MAX_VALUE,character:Number.MAX_VALUE}});i.length>t.maxCharacters&&(i=i.slice(0,t.maxCharacters));let o=i.replace(/^.*/,"").trimStart();if(o==="")return Zr(mc,{});if(r===o)return Zr(mc,{children:r});let a=o;if(r!==""){let c=Li(t.tokenizer),l=c.takeFirstTokens(o,x7);l.tokens.length>0&&100*mZ(l.tokens,c.takeFirstTokens(r,x7).tokens)?.score<(t.suffixMatchThreshold??vY)*l.tokens.length&&(a=r)}return a!==r&&n(a),Zr(mc,{children:a})}s(hZ,"AfterCursor");function OJe(t,e){let[r,n]=e.useState(),[i,o]=e.useState(),[a,c]=e.useState(0);e.useData(Pp,u=>{let f=u.document;(u.document.uri!==r?.uri||f.getText()!==r?.getText())&&n(f),u.position!==i&&o(u.position),u.maxPromptTokens!==a&&c(u.maxPromptTokens)});let l=Ixe(a);return Zr($R,{document:r,position:i,maxCharacters:l})}s(OJe,"DocumentPrefix");function QJe(t,e){let[r,n]=e.useState(),[i,o]=e.useState(),[a,c]=e.useState(0),[l,u]=e.useState(),[f,p]=e.useState();e.useData(Pp,h=>{let g=h.document;(h.document.uri!==r?.uri||g.getText()!==r?.getText())&&n(g),h.position!==i&&o(h.position),h.suffixMatchThreshold!==l&&u(h.suffixMatchThreshold),h.maxPromptTokens!==a&&c(h.maxPromptTokens),h.tokenizer!==f&&p(h.tokenizer)});let m=Ixe(a);return Zr(hZ,{document:r,position:i,suffixMatchThreshold:l,maxCharacters:m,tokenizer:f})}s(QJe,"DocumentSuffix");d();var gZ=class{static{s(this,"WishlistElision")}elide(e,r,n,i,o){if(r<=0)throw new Error("Prefix limit must be greater than 0");let[a,c]=this.preparePrefixBlocks(e,o),{elidedSuffix:l,adjustedPrefixTokenLimit:u}=this.elideSuffix(n,i,r,c,o),f=this.elidePrefix(a,u,c,o);return{blocks:[l,...f],cycles:1}}preparePrefixBlocks(e,r){let n=0,i=new Set;return[e.map((a,c)=>{let l=0,f=a.value.split(/([^\n]*\n+)/).filter(m=>m!=="").map(m=>{let h=r.tokenLength(m);return l+=h,n+=h,{line:m,componentPath:a.componentPath,tokens:h}}),p=a.componentPath;if(i.has(p))throw new Error(`Duplicate component path in prefix blocks: ${p}`);return i.add(p),{...a,tokens:l,markedForRemoval:!1,originalIndex:c,lines:f}}),n]}elideSuffix(e,r,n,i,o){let a=e.value;if(a.length===0||r<=0)return{elidedSuffix:{...e,tokens:0,elidedValue:"",elidedTokens:0},adjustedPrefixTokenLimit:n+Math.max(0,r)};i<n&&(r=r+(n-i),n=i);let c=o.takeFirstTokens(a,r);return{elidedSuffix:{...e,value:a,tokens:o.tokenLength(a),elidedValue:c.text,elidedTokens:c.tokens.length},adjustedPrefixTokenLimit:n+Math.max(0,r-c.tokens.length)}}elidePrefix(e,r,n,i){let o=this.removeLowWeightPrefixBlocks(e,r,n),a=o.filter(f=>!f.markedForRemoval).flatMap(f=>f.lines);if(a.length===0)return[];let[c,l]=this.trimPrefixLinesToFit(a,r,i),u=l;return o.map(f=>{if(f.markedForRemoval)return u+f.tokens<=r&&!f.chunks?(u+=f.tokens,{...f,elidedValue:f.value,elidedTokens:f.tokens}):{...f,elidedValue:"",elidedTokens:0};let p=c.filter(h=>h.componentPath===f.componentPath&&h.line!=="").map(h=>h.line).join(""),m=f.tokens;return p!==f.value&&(m=p!==""?i.tokenLength(p):0),{...f,elidedValue:p,elidedTokens:m}})}removeLowWeightPrefixBlocks(e,r,n){let i=n;e.sort((o,a)=>o.weight-a.weight);for(let o of e){if(i<=r)break;if(o.weight!==1&&!(o.chunks&&o.markedForRemoval))if(o.chunks&&o.chunks.size>0)for(let a of e)!a.markedForRemoval&&a.chunks&&[...o.chunks].every(c=>a.chunks?.has(c))&&(a.markedForRemoval=!0,i-=a.tokens);else o.markedForRemoval=!0,i-=o.tokens}return e.sort((o,a)=>o.originalIndex-a.originalIndex)}trimPrefixLinesToFit(e,r,n){let i=0,o=[];for(let a=e.length-1;a>=0;a--){let c=e[a],l=c.tokens;if(i+l<=r)o.unshift(c),i+=l;else break}if(o.length===0){let a=e[e.length-1];if(a&&a.line.length>0){let l=n.takeLastTokens(a.line,r);return o.push({line:l.text,componentPath:a.componentPath,tokens:l.tokens.length}),[o,l.tokens.length]}let c=`Cannot fit prefix within limit of ${r} tokens`;throw new Error(c)}return[o,i]}};function UJe(t){return t.map(e=>e.elidedValue).join("")}s(UJe,"makePrompt");function qJe(t){return t.filter(e=>e.type==="prefix").map(e=>e.elidedValue).join("")}s(qJe,"makePrefixPrompt");function HJe(t){if(t.length===0)return[];let e=new Map;for(let i of t)if(i.type==="context"&&i.index!==void 0){e.has(i.index)||e.set(i.index,[]);let o=i.elidedValue.trim();o.length>0&&e.get(i.index).push(o)}let r=Math.max(...Array.from(e.keys()),-1),n=[];for(let i=0;i<=r;i++){let o=e.get(i);if(o&&o.length>0){let a=o.join(`
`).trim();n.push(a)}else n.push("")}return n}s(HJe,"makeContextPrompt");d();var _3=class{constructor(e,r=Txe()){this.snapshot=e;this.transformers=r}static{s(this,"SnapshotWalker")}walkSnapshot(e){this.walkSnapshotNode(this.snapshot,void 0,e,{})}walkSnapshotNode(e,r,n,i){let o=this.transformers.reduce((c,l)=>l(e,r,c),{...i});if(n(e,r,o))for(let c of e.children??[])this.walkSnapshotNode(c,e,n,o)}};function Txe(){return[(t,e,r)=>{r.weight===void 0&&(r.weight=1);let n=t.props?.weight??1,i=typeof n=="number"?Math.max(0,Math.min(1,n)):1;return{...r,weight:i*r.weight}},(t,e,r)=>{if(t.name===GT.name){let n=r.chunks?new Set(r.chunks):new Set;return n.add(t.path),{...r,chunks:n}}return r},(t,e,r)=>t.props?.source!==void 0?{...r,source:t.props.source}:r]}s(Txe,"defaultTransformers");d();var b7={abap:{lineComment:{start:'"',end:""},markdownLanguageIds:["abap","sap-abap"]},aspdotnet:{lineComment:{start:"<%--",end:"--%>"}},bat:{lineComment:{start:"REM",end:""}},bibtex:{lineComment:{start:"%",end:""},markdownLanguageIds:["bibtex"]},blade:{lineComment:{start:"#",end:""}},BluespecSystemVerilog:{lineComment:{start:"//",end:""}},c:{lineComment:{start:"//",end:""},markdownLanguageIds:["c","h"]},clojure:{lineComment:{start:";",end:""},markdownLanguageIds:["clojure","clj"]},coffeescript:{lineComment:{start:"//",end:""},markdownLanguageIds:["coffeescript","coffee","cson","iced"]},cpp:{lineComment:{start:"//",end:""},markdownLanguageIds:["cpp","hpp","cc","hh","c++","h++","cxx","hxx"]},csharp:{lineComment:{start:"//",end:""},markdownLanguageIds:["csharp","cs"]},css:{lineComment:{start:"/*",end:"*/"}},cuda:{lineComment:{start:"//",end:""}},dart:{lineComment:{start:"//",end:""}},dockerfile:{lineComment:{start:"#",end:""},markdownLanguageIds:["dockerfile","docker"]},dotenv:{lineComment:{start:"#",end:""}},elixir:{lineComment:{start:"#",end:""}},erb:{lineComment:{start:"<%#",end:"%>"}},erlang:{lineComment:{start:"%",end:""},markdownLanguageIds:["erlang","erl"]},fsharp:{lineComment:{start:"//",end:""},markdownLanguageIds:["fsharp","fs","fsx","fsi","fsscript"]},go:{lineComment:{start:"//",end:""},markdownLanguageIds:["go","golang"]},graphql:{lineComment:{start:"#",end:""}},groovy:{lineComment:{start:"//",end:""}},haml:{lineComment:{start:"-#",end:""}},handlebars:{lineComment:{start:"{{!",end:"}}"},markdownLanguageIds:["handlebars","hbs","html.hbs","html.handlebars"]},haskell:{lineComment:{start:"--",end:""},markdownLanguageIds:["haskell","hs"]},hlsl:{lineComment:{start:"//",end:""}},html:{lineComment:{start:"<!--",end:"-->"},markdownLanguageIds:["html","xhtml"]},ini:{lineComment:{start:";",end:""}},java:{lineComment:{start:"//",end:""},markdownLanguageIds:["java","jsp"]},javascript:{lineComment:{start:"//",end:""},markdownLanguageIds:["javascript","js"]},javascriptreact:{lineComment:{start:"//",end:""},markdownLanguageIds:["jsx"]},jsonc:{lineComment:{start:"//",end:""}},jsx:{lineComment:{start:"//",end:""},markdownLanguageIds:["jsx"]},julia:{lineComment:{start:"#",end:""},markdownLanguageIds:["julia","jl"]},kotlin:{lineComment:{start:"//",end:""},markdownLanguageIds:["kotlin","kt"]},latex:{lineComment:{start:"%",end:""},markdownLanguageIds:["tex"]},legend:{lineComment:{start:"//",end:""}},less:{lineComment:{start:"//",end:""}},lua:{lineComment:{start:"--",end:""},markdownLanguageIds:["lua","pluto"]},makefile:{lineComment:{start:"#",end:""},markdownLanguageIds:["makefile","mk","mak","make"]},markdown:{lineComment:{start:"[]: #",end:""},markdownLanguageIds:["markdown","md","mkdown","mkd"]},"objective-c":{lineComment:{start:"//",end:""},markdownLanguageIds:["objectivec","mm","objc","obj-c"]},"objective-cpp":{lineComment:{start:"//",end:""},markdownLanguageIds:["objectivec++","objc+"]},perl:{lineComment:{start:"#",end:""},markdownLanguageIds:["perl","pl","pm"]},php:{lineComment:{start:"//",end:""}},powershell:{lineComment:{start:"#",end:""},markdownLanguageIds:["powershell","ps","ps1"]},pug:{lineComment:{start:"//",end:""}},python:{lineComment:{start:"#",end:""},markdownLanguageIds:["python","py","gyp"]},ql:{lineComment:{start:"//",end:""}},r:{lineComment:{start:"#",end:""}},razor:{lineComment:{start:"<!--",end:"-->"},markdownLanguageIds:["cshtml","razor","razor-cshtml"]},ruby:{lineComment:{start:"#",end:""},markdownLanguageIds:["ruby","rb","gemspec","podspec","thor","irb"]},rust:{lineComment:{start:"//",end:""},markdownLanguageIds:["rust","rs"]},sass:{lineComment:{start:"//",end:""}},scala:{lineComment:{start:"//",end:""}},scss:{lineComment:{start:"//",end:""}},shellscript:{lineComment:{start:"#",end:""},markdownLanguageIds:["bash","sh","zsh"]},slang:{lineComment:{start:"//",end:""}},slim:{lineComment:{start:"/",end:""}},solidity:{lineComment:{start:"//",end:""},markdownLanguageIds:["solidity","sol"]},sql:{lineComment:{start:"--",end:""}},stylus:{lineComment:{start:"//",end:""}},svelte:{lineComment:{start:"<!--",end:"-->"}},swift:{lineComment:{start:"//",end:""}},systemverilog:{lineComment:{start:"//",end:""}},terraform:{lineComment:{start:"#",end:""}},tex:{lineComment:{start:"%",end:""}},typescript:{lineComment:{start:"//",end:""},markdownLanguageIds:["typescript","ts"]},typescriptreact:{lineComment:{start:"//",end:""},markdownLanguageIds:["tsx"]},vb:{lineComment:{start:"'",end:""},markdownLanguageIds:["vb","vbscript"]},verilog:{lineComment:{start:"//",end:""}},"vue-html":{lineComment:{start:"<!--",end:"-->"}},vue:{lineComment:{start:"//",end:""}},xml:{lineComment:{start:"<!--",end:"-->"}},xsl:{lineComment:{start:"<!--",end:"-->"}},yaml:{lineComment:{start:"#",end:""},markdownLanguageIds:["yaml","yml"]}},wxe={};for(let[t,e]of Object.entries(b7))if(e.markdownLanguageIds)for(let r of e.markdownLanguageIds)wxe[r]=t;else wxe[t]=t;function WJe(t){return wxe[t]}s(WJe,"mdCodeBlockLangToLanguageId");var bVt={start:"//",end:""},IVt=["php","plaintext"],Sxe={html:"<!DOCTYPE html>",python:"#!/usr/bin/env python3",ruby:"#!/usr/bin/env ruby",shellscript:"#!/bin/sh",yaml:"# YAML data"};function jJe(t){return Object.values(Sxe).includes(t.trim())}s(jJe,"isShebangLine");function TVt({source:t}){return t.startsWith("#!")||t.startsWith("<!DOCTYPE")}s(TVt,"hasLanguageMarker");function wVt(t,e){let r=b7[e]?b7[e].lineComment:bVt;if(r){let n=r.end==""?"":" "+r.end;return`${r.start} ${t}${n}`}return""}s(wVt,"comment");function VC(t,e){if(t==="")return"";let r=t.endsWith(`
`),i=(r?t.slice(0,-1):t).split(`
`).map(o=>wVt(o,e)).join(`
`);return r?i+`
`:i}s(VC,"commentBlockAsSingles");function AZ(t){let{languageId:e}=t;return IVt.indexOf(e)===-1&&!TVt(t)?e in Sxe?Sxe[e]:`Language: ${e}`:""}s(AZ,"getLanguageMarker");function yZ(t){return t.relativePath?`Path: ${t.relativePath}`:""}s(yZ,"getPathMarker");function I7(t){return t===""||t.endsWith(`
`)?t:t+`
`}s(I7,"newLineEnded");function GJe(t){return $Je(typeof t=="string"?t:"plaintext")}s(GJe,"getLanguage");function $Je(t){return b7[t]!==void 0?{languageId:t,...b7[t]}:{languageId:t,lineComment:{start:"//",end:""}}}s($Je,"_getLanguage");var SVt=5,R3=class{constructor(){this.renderId=0;this.formatPrefix=UJe}static{s(this,"CompletionsPromptRenderer")}render(e,r,n){let i=this.renderId++,o=performance.now();try{if(n?.isCancellationRequested)return{status:"cancelled"};let a=r.delimiter??"",c=r.tokenizer??"o200k_base",{prefixBlocks:l,suffixBlock:u,componentStatistics:f}=this.processSnapshot(e,a,r.languageId),{prefixTokenLimit:p,suffixTokenLimit:m}=this.getPromptLimits(u,r),h=performance.now(),g=new gZ,{blocks:[A,...y]}=g.elide(l,p,u,m,Li(c)),E=performance.now(),b=this.formatPrefix(y),S=this.formatContext?this.formatContext(y):void 0,R=A.elidedValue,B=y.reduce((L,O)=>L+O.elidedTokens,0);return f.push(..._Vt([...y,A])),{prefix:b,prefixTokens:B,suffix:R,suffixTokens:A.elidedTokens,context:S,status:"ok",metadata:{renderId:i,rendererName:"c",tokenizer:c,elisionTimeMs:E-h,renderTimeMs:performance.now()-o,componentStatistics:f,updateDataTimeMs:f.reduce((L,O)=>L+(O.updateDataTimeMs??0),0)}}}catch(a){return{status:"error",error:a}}}getPromptLimits(e,r){let n=e?.value??"",i=r.promptTokenLimit,o=r.suffixPercent;if(n.length==0||o==0)return{prefixTokenLimit:i,suffixTokenLimit:0};i=n.length>0?i-SVt:i;let a=Math.ceil(i*(o/100));return{prefixTokenLimit:i-a,suffixTokenLimit:a}}processSnapshot(e,r,n){let i=[],o=[],a=[],c=!1;if(new _3(e,_xe).walkSnapshot((f,p,m)=>{if(f===e||(f.name===E7.name&&(c=!0),f.statistics.updateDataTimeMs&&f.statistics.updateDataTimeMs>0&&a.push({componentPath:f.path,updateDataTimeMs:f.statistics.updateDataTimeMs}),f.value===void 0||f.value===""))return!0;let h=m.chunks;if(m.type==="suffix")o.push({value:T7(f.value),type:"suffix",weight:m.weight,componentPath:f.path,nodeStatistics:f.statistics,chunks:h,source:m.source});else{let g=f.value.endsWith(r)?f.value:f.value+r,A=g;m.type==="prefix"?A=f.value:jJe(f.value)?A=g:A=VC(g,n),i.push({type:m.type==="prefix"?"prefix":"context",value:T7(A),weight:m.weight,componentPath:f.path,nodeStatistics:f.statistics,chunks:h,source:m.source})}return!0}),!c)throw new Error(`Node of type ${E7.name} not found`);if(o.length>1)throw new Error("Only one suffix is allowed");let u=o.length===1?o[0]:{componentPath:"",value:"",weight:1,nodeStatistics:{},type:"suffix"};return{prefixBlocks:i,suffixBlock:u,componentStatistics:a}}},_xe=[...Txe(),(t,e,r)=>pZ(t)?{...r,type:"context"}:r,(t,e,r)=>t.name===$R.name?{...r,type:"prefix"}:r,(t,e,r)=>t.name===hZ.name?{...r,type:"suffix"}:r];function _Vt(t){return t.map(e=>{let r={componentPath:e.componentPath};return e.tokens!==0&&(r.expectedTokens=e.tokens,r.actualTokens=e.elidedTokens),e.nodeStatistics.updateDataTimeMs!==void 0&&(r.updateDataTimeMs=e.nodeStatistics.updateDataTimeMs),e.source&&(r.source=e.source),r})}s(_Vt,"computeComponentStatistics");function T7(t){return t.replace(/\r\n?/g,`
`)}s(T7,"normalizeLineEndings");d();var CZ=s((t,e)=>{let[r,n]=e.useState();if(e.useData(Pp,i=>{i.document.uri!==r?.uri&&n(i.document)}),r){let i=t.ctx.get(dr),o=i.getRelativePath(r),a={uri:r.uri,source:r.getText(),relativePath:o,languageId:r.detectedLanguageId},c=i.findNotebook(r);return a.relativePath&&!c?Zr(RVt,{docInfo:a}):Zr(kVt,{docInfo:a})}},"DocumentMarker"),RVt=s(t=>Zr(mc,{children:yZ(t.docInfo)}),"PathMarker"),kVt=s(t=>Zr(mc,{children:AZ(t.docInfo)}),"LanguageMarker");d();d();d();d();function w7(t,e="Unreachable"){throw new Error(e)}s(w7,"assertNever");function Fl(t,e="unexpected state"){if(!t)throw new xn(`Assertion Failed: ${e}`)}s(Fl,"assert");function NA(t){if(!t()){debugger;t(),a3(new xn("Assertion Failed"))}}s(NA,"assertFn");function kx(t,e){let r=0;for(;r<t.length-1;){let n=t[r],i=t[r+1];if(!e(n,i))return!1;r++}return!0}s(kx,"checkAdjacentItems");d();d();d();d();d();var Px=s((t,e)=>t===e,"strictEquals");d();d();var la=class t{static{s(this,"Node")}static{this.Undefined=new t(void 0)}constructor(e){this.element=e,this.next=t.Undefined,this.prev=t.Undefined}},S7=class{constructor(){this._first=la.Undefined;this._last=la.Undefined;this._size=0}static{s(this,"LinkedList")}get size(){return this._size}isEmpty(){return this._first===la.Undefined}clear(){let e=this._first;for(;e!==la.Undefined;){let r=e.next;e.prev=la.Undefined,e.next=la.Undefined,e=r}this._first=la.Undefined,this._last=la.Undefined,this._size=0}unshift(e){return this._insert(e,!1)}push(e){return this._insert(e,!0)}_insert(e,r){let n=new la(e);if(this._first===la.Undefined)this._first=n,this._last=n;else if(r){let o=this._last;this._last=n,n.prev=o,o.next=n}else{let o=this._first;this._first=n,n.next=o,o.prev=n}this._size+=1;let i=!1;return()=>{i||(i=!0,this._remove(n))}}shift(){if(this._first!==la.Undefined){let e=this._first.element;return this._remove(this._first),e}}pop(){if(this._last!==la.Undefined){let e=this._last.element;return this._remove(this._last),e}}_remove(e){if(e.prev!==la.Undefined&&e.next!==la.Undefined){let r=e.prev;r.next=e.next,e.next.prev=r}else e.prev===la.Undefined&&e.next===la.Undefined?(this._first=la.Undefined,this._last=la.Undefined):e.next===la.Undefined?(this._last=this._last.prev,this._last.next=la.Undefined):e.prev===la.Undefined&&(this._first=this._first.next,this._first.prev=la.Undefined);this._size-=1}*[Symbol.iterator](){let e=this._first;for(;e!==la.Undefined;)yield e.element,e=e.next}};d();var PVt=globalThis.performance&&typeof globalThis.performance.now=="function",k3=class t{static{s(this,"StopWatch")}static create(e){return new t(e)}constructor(e){this._now=PVt&&e===!1?Date.now:globalThis.performance.now.bind(globalThis.performance),this._startTime=this._now(),this._stopTime=-1}stop(){this._stopTime=this._now()}reset(){this._startTime=this._now(),this._stopTime=-1}elapsed(){return this._stopTime!==-1?this._stopTime-this._startTime:this._now()-this._startTime}};var VJe=!1,DVt=!1,WR;(J=>{J.None=s(()=>Rs.None,"None");function e(j){if(DVt){let{onDidAddListener:W}=j,X=_7.create(),oe=0;j.onDidAddListener=()=>{++oe===2&&(console.warn("snapshotted emitter LIKELY used public and SHOULD HAVE BEEN created with DisposableStore. snapshotted here"),X.print()),W?.()}}}s(e,"_addLeakageTraceLogic");function r(j,W){return h(j,()=>{},0,void 0,!0,void 0,W)}J.defer=r,s(r,"defer");function n(j){return(W,X=null,oe)=>{let te=!1,re;return re=j(pe=>{if(!te)return re?re.dispose():te=!0,W.call(X,pe)},null,oe),te&&re.dispose(),re}}J.once=n,s(n,"once");function i(j,W){return J.once(J.filter(j,W))}J.onceIf=i,s(i,"onceIf");function o(j,W,X){return p((oe,te=null,re)=>j(pe=>oe.call(te,W(pe)),null,re),X)}J.map=o,s(o,"map");function a(j,W,X){return p((oe,te=null,re)=>j(pe=>{W(pe),oe.call(te,pe)},null,re),X)}J.forEach=a,s(a,"forEach");function c(j,W,X){return p((oe,te=null,re)=>j(pe=>W(pe)&&oe.call(te,pe),null,re),X)}J.filter=c,s(c,"filter");function l(j){return j}J.signal=l,s(l,"signal");function u(...j){return(W,X=null,oe)=>{let te=Bze(...j.map(re=>re(pe=>W.call(X,pe))));return m(te,oe)}}J.any=u,s(u,"any");function f(j,W,X,oe){let te=X;return o(j,re=>(te=W(te,re),te),oe)}J.reduce=f,s(f,"reduce");function p(j,W){let X,oe={onWillAddFirstListener(){X=j(te.fire,te)},onDidRemoveLastListener(){X?.dispose()}};W||e(oe);let te=new K0(oe);return W?.add(te),te.event}s(p,"snapshot");function m(j,W){return W instanceof Array?W.push(j):W&&W.add(j),j}s(m,"addAndReturnDisposable");function h(j,W,X=100,oe=!1,te=!1,re,pe){let Ae,Oe,Te,Je=0,Fe,lt={leakWarningThreshold:re,onWillAddFirstListener(){Ae=j(xt=>{Je++,Oe=W(Oe,xt),oe&&!Te&&(_t.fire(Oe),Oe=void 0),Fe=s(()=>{let gt=Oe;Oe=void 0,Te=void 0,(!oe||Je>1)&&_t.fire(gt),Je=0},"doFire"),typeof X=="number"?(clearTimeout(Te),Te=setTimeout(Fe,X)):Te===void 0&&(Te=0,queueMicrotask(Fe))})},onWillRemoveListener(){te&&Je>0&&Fe?.()},onDidRemoveLastListener(){Fe=void 0,Ae.dispose()}};pe||e(lt);let _t=new K0(lt);return pe?.add(_t),_t.event}J.debounce=h,s(h,"debounce");function g(j,W=0,X){return J.debounce(j,(oe,te)=>oe?(oe.push(te),oe):[te],W,void 0,!0,void 0,X)}J.accumulate=g,s(g,"accumulate");function A(j,W=(oe,te)=>oe===te,X){let oe=!0,te;return c(j,re=>{let pe=oe||!W(re,te);return oe=!1,te=re,pe},X)}J.latch=A,s(A,"latch");function y(j,W,X){return[J.filter(j,W,X),J.filter(j,oe=>!W(oe),X)]}J.split=y,s(y,"split");function E(j,W=!1,X=[],oe){let te=X.slice(),re=j(Oe=>{te?te.push(Oe):Ae.fire(Oe)});oe&&oe.add(re);let pe=s(()=>{te?.forEach(Oe=>Ae.fire(Oe)),te=null},"flush"),Ae=new K0({onWillAddFirstListener(){re||(re=j(Oe=>Ae.fire(Oe)),oe&&oe.add(re))},onDidAddFirstListener(){te&&(W?setTimeout(pe):pe())},onDidRemoveLastListener(){re&&re.dispose(),re=null}});return oe&&oe.add(Ae),Ae.event}J.buffer=E,s(E,"buffer");function b(j,W){return s((oe,te,re)=>{let pe=W(new R);return j(function(Ae){let Oe=pe.evaluate(Ae);Oe!==S&&oe.call(te,Oe)},void 0,re)},"fn")}J.chain=b,s(b,"chain");let S=Symbol("HaltChainable");class R{constructor(){this.steps=[]}static{s(this,"ChainableSynthesis")}map(W){return this.steps.push(W),this}forEach(W){return this.steps.push(X=>(W(X),X)),this}filter(W){return this.steps.push(X=>W(X)?X:S),this}reduce(W,X){let oe=X;return this.steps.push(te=>(oe=W(oe,te),oe)),this}latch(W=(X,oe)=>X===oe){let X=!0,oe;return this.steps.push(te=>{let re=X||!W(te,oe);return X=!1,oe=te,re?te:S}),this}evaluate(W){for(let X of this.steps)if(W=X(W),W===S)break;return W}}function B(j,W,X=oe=>oe){let oe=s((...Ae)=>pe.fire(X(...Ae)),"fn"),te=s(()=>j.on(W,oe),"onFirstListenerAdd"),re=s(()=>j.removeListener(W,oe),"onLastListenerRemove"),pe=new K0({onWillAddFirstListener:te,onDidRemoveLastListener:re});return pe.event}J.fromNodeEventEmitter=B,s(B,"fromNodeEventEmitter");function L(j,W,X=oe=>oe){let oe=s((...Ae)=>pe.fire(X(...Ae)),"fn"),te=s(()=>j.addEventListener(W,oe),"onFirstListenerAdd"),re=s(()=>j.removeEventListener(W,oe),"onLastListenerRemove"),pe=new K0({onWillAddFirstListener:te,onDidRemoveLastListener:re});return pe.event}J.fromDOMEventEmitter=L,s(L,"fromDOMEventEmitter");function O(j,W){return new Promise(X=>n(j)(X,null,W))}J.toPromise=O,s(O,"toPromise");function Y(j){let W=new K0;return j.then(X=>{W.fire(X)},()=>{W.fire(void 0)}).finally(()=>{W.dispose()}),W.event}J.fromPromise=Y,s(Y,"fromPromise");function V(j,W){return j(X=>W.fire(X))}J.forward=V,s(V,"forward");function z(j,W,X){return W(X),j(oe=>W(oe))}J.runAndSubscribe=z,s(z,"runAndSubscribe");class Q{constructor(W,X){this._observable=W;this._counter=0;this._hasChanged=!1;let oe={onWillAddFirstListener:s(()=>{W.addObserver(this),this._observable.reportChanges()},"onWillAddFirstListener"),onDidRemoveLastListener:s(()=>{W.removeObserver(this)},"onDidRemoveLastListener")};X||e(oe),this.emitter=new K0(oe),X&&X.add(this.emitter)}static{s(this,"EmitterObserver")}beginUpdate(W){this._counter++}handlePossibleChange(W){}handleChange(W,X){this._hasChanged=!0}endUpdate(W){this._counter--,this._counter===0&&(this._observable.reportChanges(),this._hasChanged&&(this._hasChanged=!1,this.emitter.fire(this._observable.get())))}}function U(j,W){return new Q(j,W).emitter.event}J.fromObservable=U,s(U,"fromObservable");function Z(j){return(W,X,oe)=>{let te=0,re=!1,pe={beginUpdate(){te++},endUpdate(){te--,te===0&&(j.reportChanges(),re&&(re=!1,W.call(X)))},handlePossibleChange(){},handleChange(){re=!0}};j.addObserver(pe),j.reportChanges();let Ae={dispose(){j.removeObserver(pe)}};return oe instanceof td?oe.add(Ae):Array.isArray(oe)&&oe.push(Ae),Ae}}J.fromObservableLight=Z,s(Z,"fromObservableLight")})(WR||={});var Rxe=class t{constructor(e){this.listenerCount=0;this.invocationCount=0;this.elapsedOverall=0;this.durations=[];this.name=`${e}_${t._idPool++}`,t.all.add(this)}static{s(this,"EventProfiling")}static{this.all=new Set}static{this._idPool=0}start(e){this._stopWatch=new k3,this.listenerCount=e}stop(){if(this._stopWatch){let e=this._stopWatch.elapsed();this.durations.push(e),this.elapsedOverall+=e,this.invocationCount+=1,this._stopWatch=void 0}}},zJe=-1;var kxe=class t{constructor(e,r,n=(t._idPool++).toString(16).padStart(3,"0")){this._errorHandler=e;this.threshold=r;this.name=n;this._warnCountdown=0}static{s(this,"LeakageMonitor")}static{this._idPool=1}dispose(){this._stacks?.clear()}check(e,r){let n=this.threshold;if(n<=0||r<n)return;this._stacks||(this._stacks=new Map);let i=this._stacks.get(e.value)||0;if(this._stacks.set(e.value,i+1),this._warnCountdown-=1,this._warnCountdown<=0){this._warnCountdown=n*.5;let[o,a]=this.getMostFrequentStack(),c=`[${this.name}] potential listener LEAK detected, having ${r} listeners already. MOST frequent listener (${a}):`;console.warn(c),console.warn(o);let l=new Pxe(c,o);this._errorHandler(l)}return()=>{let o=this._stacks.get(e.value)||0;this._stacks.set(e.value,o-1)}}getMostFrequentStack(){if(!this._stacks)return;let e,r=0;for(let[n,i]of this._stacks)(!e||r<i)&&(e=[n,i],r=i);return e}},_7=class t{constructor(e){this.value=e}static{s(this,"Stacktrace")}static create(){let e=new Error;return new t(e.stack??"")}print(){console.warn(this.value.split(`
`).slice(2).join(`
`))}},Pxe=class extends Error{static{s(this,"ListenerLeakError")}constructor(e,r){super(e),this.name="ListenerLeakError",this.stack=r}},Dxe=class extends Error{static{s(this,"ListenerRefusalError")}constructor(e,r){super(e),this.name="ListenerRefusalError",this.stack=r}},BVt=0,P3=class{constructor(e){this.value=e;this.id=BVt++}static{s(this,"UniqueContainer")}},NVt=2,MVt=s((t,e)=>{if(t instanceof P3)e(t);else for(let r=0;r<t.length;r++){let n=t[r];n&&e(n)}},"forEachListener"),K0=class{constructor(e){this._size=0;this._options=e,this._leakageMon=zJe>0||this._options?.leakWarningThreshold?new kxe(e?.onListenerError??a3,this._options?.leakWarningThreshold??zJe):void 0,this._perfMon=this._options?._profName?new Rxe(this._options._profName):void 0,this._deliveryQueue=this._options?.deliveryQueue}static{s(this,"Emitter")}dispose(){if(!this._disposed){if(this._disposed=!0,this._deliveryQueue?.current===this&&this._deliveryQueue.reset(),this._listeners){if(VJe){let e=this._listeners;queueMicrotask(()=>{MVt(e,r=>r.stack?.print())})}this._listeners=void 0,this._size=0}this._options?.onDidRemoveLastListener?.(),this._leakageMon?.dispose()}}get event(){return this._event??=(e,r,n)=>{if(this._leakageMon&&this._size>this._leakageMon.threshold**2){let l=`[${this._leakageMon.name}] REFUSES to accept new listeners because it exceeded its threshold by far (${this._size} vs ${this._leakageMon.threshold})`;console.warn(l);let u=this._leakageMon.getMostFrequentStack()??["UNKNOWN stack",-1],f=new Dxe(`${l}. HINT: Stack shows most frequent listener (${u[1]}-times)`,u[0]);return(this._options?.onListenerError||a3)(f),Rs.None}if(this._disposed)return Rs.None;r&&(e=e.bind(r));let i=new P3(e),o,a;this._leakageMon&&this._size>=Math.ceil(this._leakageMon.threshold*.2)&&(i.stack=_7.create(),o=this._leakageMon.check(i.stack,this._size+1)),VJe&&(i.stack=a??_7.create()),this._listeners?this._listeners instanceof P3?(this._deliveryQueue??=new Bxe,this._listeners=[this._listeners,i]):this._listeners.push(i):(this._options?.onWillAddFirstListener?.(this),this._listeners=i,this._options?.onDidAddFirstListener?.(this)),this._options?.onDidAddListener?.(this),this._size++;let c=Qc(()=>{o?.(),this._removeListener(i)});return n instanceof td?n.add(c):Array.isArray(n)&&n.push(c),c},this._event}_removeListener(e){if(this._options?.onWillRemoveListener?.(this),!this._listeners)return;if(this._size===1){this._listeners=void 0,this._options?.onDidRemoveLastListener?.(this),this._size=0;return}let r=this._listeners,n=r.indexOf(e);if(n===-1)throw console.log("disposed?",this._disposed),console.log("size?",this._size),console.log("arr?",JSON.stringify(this._listeners)),new Error("Attempted to dispose unknown listener");this._size--,r[n]=void 0;let i=this._deliveryQueue.current===this;if(this._size*NVt<=r.length){let o=0;for(let a=0;a<r.length;a++)r[a]?r[o++]=r[a]:i&&o<this._deliveryQueue.end&&(this._deliveryQueue.end--,o<this._deliveryQueue.i&&this._deliveryQueue.i--);r.length=o}}_deliver(e,r){if(!e)return;let n=this._options?.onListenerError||a3;if(!n){e.value(r);return}try{e.value(r)}catch(i){n(i)}}_deliverQueue(e){let r=e.current._listeners;for(;e.i<e.end;)this._deliver(r[e.i++],e.value);e.reset()}fire(e){if(this._deliveryQueue?.current&&(this._deliverQueue(this._deliveryQueue),this._perfMon?.stop()),this._perfMon?.start(this._size),this._listeners)if(this._listeners instanceof P3)this._deliver(this._listeners,e);else{let r=this._deliveryQueue;r.enqueue(this,e,this._listeners.length),this._deliverQueue(r)}this._perfMon?.stop()}hasListeners(){return this._size>0}};var Bxe=class{constructor(){this.i=-1;this.end=0}static{s(this,"EventDeliveryQueuePrivate")}enqueue(e,r,n){this.i=0,this.end=n,this.current=e,this.value=r}reset(){this.i=this.end,this.current=void 0,this.value=void 0}};d();var Bf=class{constructor(e,r,n){this.owner=e;this.debugNameSource=r;this.referenceFn=n}static{s(this,"DebugNameData")}getDebugName(e){return XJe(e,this)}},KJe=new Map,Nxe=new WeakMap;function XJe(t,e){let r=Nxe.get(t);if(r)return r;let n=LVt(t,e);if(n){let i=KJe.get(n)??0;i++,KJe.set(n,i);let o=i===1?n:`${n}#${i}`;return Nxe.set(t,o),o}}s(XJe,"getDebugName");function LVt(t,e){let r=Nxe.get(t);if(r)return r;let n=e.owner?OVt(e.owner)+".":"",i,o=e.debugNameSource;if(o!==void 0)if(typeof o=="function"){if(i=o(),i!==void 0)return n+i}else return n+o;let a=e.referenceFn;if(a!==void 0&&(i=vZ(a),i!==void 0))return n+i;if(e.owner!==void 0){let c=FVt(e.owner,t);if(c!==void 0)return n+c}}s(LVt,"computeDebugName");function FVt(t,e){for(let r in t)if(t[r]===e)return r}s(FVt,"findKey");var YJe=new Map,JJe=new WeakMap;function OVt(t){let e=JJe.get(t);if(e)return e;let r=QVt(t),n=YJe.get(r)??0;n++,YJe.set(r,n);let i=n===1?r:`${r}#${n}`;return JJe.set(t,i),i}s(OVt,"formatOwner");function QVt(t){let e=t.constructor;return e?e.name:"Object"}s(QVt,"getClassName");function vZ(t){let e=t.toString(),n=/\/\*\*\s*@description\s*([^*]*)\*\//.exec(e);return(n?n[1]:void 0)?.trim()}s(vZ,"getFunctionName");d();var jR;function EZ(t){jR?jR instanceof xZ?jR.loggers.push(t):jR=new xZ([jR,t]):jR=t}s(EZ,"addLogger");function Ma(){return jR}s(Ma,"getLogger");var Mxe;function ZJe(t){Mxe=t}s(ZJe,"setLogObservableFn");function eXe(t){Mxe&&Mxe(t)}s(eXe,"logObservable");var xZ=class{constructor(e){this.loggers=e}static{s(this,"ComposedLogger")}handleObservableCreated(e){for(let r of this.loggers)r.handleObservableCreated(e)}handleOnListenerCountChanged(e,r){for(let n of this.loggers)n.handleOnListenerCountChanged(e,r)}handleObservableUpdated(e,r){for(let n of this.loggers)n.handleObservableUpdated(e,r)}handleAutorunCreated(e){for(let r of this.loggers)r.handleAutorunCreated(e)}handleAutorunDisposed(e){for(let r of this.loggers)r.handleAutorunDisposed(e)}handleAutorunDependencyChanged(e,r,n){for(let i of this.loggers)i.handleAutorunDependencyChanged(e,r,n)}handleAutorunStarted(e){for(let r of this.loggers)r.handleAutorunStarted(e)}handleAutorunFinished(e){for(let r of this.loggers)r.handleAutorunFinished(e)}handleDerivedDependencyChanged(e,r,n){for(let i of this.loggers)i.handleDerivedDependencyChanged(e,r,n)}handleDerivedCleared(e){for(let r of this.loggers)r.handleDerivedCleared(e)}handleBeginTransaction(e){for(let r of this.loggers)r.handleBeginTransaction(e)}handleEndTransaction(e){for(let r of this.loggers)r.handleEndTransaction(e)}};var tXe;function rXe(t){tXe=t}s(rXe,"_setRecomputeInitiallyAndOnChange");var nXe;function iXe(t){nXe=t}s(iXe,"_setKeepObserved");var Lxe;function oXe(t){Lxe=t}s(oXe,"_setDerivedOpts");var bZ=class{static{s(this,"ConvenientObservable")}get TChange(){return null}reportChanges(){this.get()}read(e){return e?e.readObservable(this):this.get()}map(e,r){let n=r===void 0?void 0:e,i=r===void 0?e:r;return Lxe({owner:n,debugName:s(()=>{let o=vZ(i);if(o!==void 0)return o;let c=/^\s*\(?\s*([a-zA-Z_$][a-zA-Z_$0-9]*)\s*\)?\s*=>\s*\1(?:\??)\.([a-zA-Z_$][a-zA-Z_$0-9]*)\s*$/.exec(i.toString());if(c)return`${this.debugName}.${c[2]}`;if(!n)return`${this.debugName} (mapped)`},"debugName"),debugReferenceFn:i},o=>i(this.read(o),o))}flatten(){return Lxe({owner:void 0,debugName:s(()=>`${this.debugName} (flattened)`,"debugName")},e=>this.read(e).read(e))}recomputeInitiallyAndOnChange(e,r){return e.add(tXe(this,r)),this}keepObserved(e){return e.add(nXe(this)),this}get debugValue(){return this.get()}},VT=class extends bZ{constructor(){super();this.observers=new Set;Ma()?.handleObservableCreated(this)}static{s(this,"BaseObservable")}addObserver(r){let n=this.observers.size;this.observers.add(r),n===0&&this.onFirstObserverAdded(),n!==this.observers.size&&Ma()?.handleOnListenerCountChanged(this,this.observers.size)}removeObserver(r){let n=this.observers.delete(r);n&&this.observers.size===0&&this.onLastObserverRemoved(),n&&Ma()?.handleOnListenerCountChanged(this,this.observers.size)}onFirstObserverAdded(){}onLastObserverRemoved(){}log(){let r=!!Ma();return eXe(this),r||Ma()?.handleObservableCreated(this),this}};function TZ(t,e){let r=new D3(t,e);try{t(r)}finally{r.finish()}}s(TZ,"transaction");function Fxe(t,e,r){t?e(t):TZ(e,r)}s(Fxe,"subtransaction");var D3=class{constructor(e,r){this._fn=e;this._getDebugName=r;this.updatingObservers=[];Ma()?.handleBeginTransaction(this)}static{s(this,"TransactionImpl")}getDebugName(){return this._getDebugName?this._getDebugName():vZ(this._fn)}updateObserver(e,r){this.updatingObservers.push({observer:e,observable:r}),e.beginUpdate(r)}finish(){let e=this.updatingObservers;for(let r=0;r<e.length;r++){let{observer:n,observable:i}=e[r];n.endUpdate(i)}this.updatingObservers=null,Ma()?.handleEndTransaction(this)}};function MA(t,e){let r;return typeof t=="string"?r=new Bf(void 0,t,void 0):r=new Bf(t,void 0,void 0),new IZ(r,e,Px)}s(MA,"observableValue");var IZ=class extends VT{constructor(r,n,i){super();this._debugNameData=r;this._equalityComparator=i;this._value=n,Ma()?.handleObservableUpdated(this,{hadValue:!1,newValue:n,change:void 0,didChange:!0,oldValue:void 0})}static{s(this,"ObservableValue")}get debugName(){return this._debugNameData.getDebugName(this)??"ObservableValue"}get(){return this._value}set(r,n,i){if(i===void 0&&this._equalityComparator(this._value,r))return;let o;n||(n=o=new D3(()=>{},()=>`Setting ${this.debugName}`));try{let a=this._value;this._setValue(r),Ma()?.handleObservableUpdated(this,{oldValue:a,newValue:r,change:i,didChange:!0,hadValue:!0});for(let c of this.observers)n.updateObserver(c,this),c.handleChange(this,i)}finally{o&&o.finish()}}toString(){return`${this.debugName}: ${this._value}`}_setValue(r){this._value=r}};d();d();function GR(t){return new B3(new Bf(void 0,void 0,t),t,void 0,void 0)}s(GR,"autorun");function Oxe(t,e){return new B3(new Bf(t.owner,t.debugName,t.debugReferenceFn??e),e,void 0,void 0)}s(Oxe,"autorunOpts");function wZ(t,e){return new B3(new Bf(t.owner,t.debugName,t.debugReferenceFn??e),e,t.createEmptyChangeSummary,t.handleChange)}s(wZ,"autorunHandleChanges");function Qxe(t,e){let r=new td,n=wZ({owner:t.owner,debugName:t.debugName,debugReferenceFn:t.debugReferenceFn??e,createEmptyChangeSummary:t.createEmptyChangeSummary,handleChange:t.handleChange},(i,o)=>{r.clear(),e(i,o,r)});return Qc(()=>{n.dispose(),r.dispose()})}s(Qxe,"autorunWithStoreHandleChanges");function Uxe(t){let e=new td,r=Oxe({owner:void 0,debugName:void 0,debugReferenceFn:t},n=>{e.clear(),t(n,e)});return Qc(()=>{r.dispose(),e.dispose()})}s(Uxe,"autorunWithStore");var B3=class{constructor(e,r,n,i){this._debugNameData=e;this._runFn=r;this.createChangeSummary=n;this._handleChange=i;this.state=2;this.updateCount=0;this.disposed=!1;this.dependencies=new Set;this.dependenciesToBeRemoved=new Set;this._isRunning=!1;this.changeSummary=this.createChangeSummary?.(),Ma()?.handleAutorunCreated(this),this._runIfNeeded(),d3(this)}static{s(this,"AutorunObserver")}get debugName(){return this._debugNameData.getDebugName(this)??"(anonymous)"}dispose(){this.disposed=!0;for(let e of this.dependencies)e.removeObserver(this);this.dependencies.clear(),Ma()?.handleAutorunDisposed(this),f3(this)}_runIfNeeded(){if(this.state===3)return;let e=this.dependenciesToBeRemoved;this.dependenciesToBeRemoved=this.dependencies,this.dependencies=e,this.state=3;try{if(!this.disposed){Ma()?.handleAutorunStarted(this);let r=this.changeSummary;try{this.changeSummary=this.createChangeSummary?.(),this._isRunning=!0,this._runFn(this,r)}catch(n){MR(n)}finally{this._isRunning=!1}}}finally{this.disposed||Ma()?.handleAutorunFinished(this);for(let r of this.dependenciesToBeRemoved)r.removeObserver(this);this.dependenciesToBeRemoved.clear()}}toString(){return`Autorun<${this.debugName}>`}beginUpdate(e){this.state===3&&(this.state=1),this.updateCount++}endUpdate(e){try{if(this.updateCount===1)do{if(this.state===1){this.state=3;for(let r of this.dependencies)if(r.reportChanges(),this.state===2)break}this._runIfNeeded()}while(this.state!==3)}finally{this.updateCount--}NA(()=>this.updateCount>=0)}handlePossibleChange(e){this.state===3&&this._isDependency(e)&&(this.state=1)}handleChange(e,r){if(this._isDependency(e)){Ma()?.handleAutorunDependencyChanged(this,e,r);try{(this._handleChange?this._handleChange({changedObservable:e,change:r,didChange:s(i=>i===e,"didChange")},this.changeSummary):!0)&&(this.state=2)}catch(n){MR(n)}}}_isDependency(e){return this.dependencies.has(e)&&!this.dependenciesToBeRemoved.has(e)}readObservable(e){if(!this._isRunning)throw new xn("The reader object cannot be used outside its compute function!");if(this.disposed)return e.get();e.addObserver(this);let r=e.get();return this.dependencies.add(e),this.dependenciesToBeRemoved.delete(e),r}};(e=>e.Observer=B3)(GR||={});d();function SZ(t,e){return new VR(new Bf(t.owner,t.debugName,t.debugReferenceFn),e,void 0,void 0,t.onLastObserverRemoved,t.equalsFn??Px)}s(SZ,"derivedOpts");oXe(SZ);var VR=class extends VT{constructor(r,n,i,o,a=void 0,c){super();this._debugNameData=r;this._computeFn=n;this.createChangeSummary=i;this._handleChange=o;this._handleLastObserverRemoved=a;this._equalityComparator=c;this.state=0;this.value=void 0;this.updateCount=0;this.dependencies=new Set;this.dependenciesToBeRemoved=new Set;this.changeSummary=void 0;this._isUpdating=!1;this._isComputing=!1;this._removedObserverToCallEndUpdateOn=null;this._isReaderValid=!1;this.changeSummary=this.createChangeSummary?.()}static{s(this,"Derived")}get debugName(){return this._debugNameData.getDebugName(this)??"(anonymous)"}onLastObserverRemoved(){this.state=0,this.value=void 0,Ma()?.handleDerivedCleared(this);for(let r of this.dependencies)r.removeObserver(this);this.dependencies.clear(),this._handleLastObserverRemoved?.()}get(){if(this._isComputing,this.observers.size===0){let n;try{this._isReaderValid=!0,n=this._computeFn(this,this.createChangeSummary?.())}finally{this._isReaderValid=!1}return this.onLastObserverRemoved(),n}else{do{if(this.state===1){for(let n of this.dependencies)if(n.reportChanges(),this.state===2)break}this.state===1&&(this.state=3),this._recomputeIfNeeded()}while(this.state!==3);return this.value}}_recomputeIfNeeded(){if(this.state===3)return;let r=this.dependenciesToBeRemoved;this.dependenciesToBeRemoved=this.dependencies,this.dependencies=r;let n=this.state!==0,i=this.value;this.state=3;let o=!1;this._isComputing=!0;try{let a=this.changeSummary;this.changeSummary=this.createChangeSummary?.();try{this._isReaderValid=!0,this.value=this._computeFn(this,a)}finally{this._isReaderValid=!1;for(let c of this.dependenciesToBeRemoved)c.removeObserver(this);this.dependenciesToBeRemoved.clear()}o=n&&!this._equalityComparator(i,this.value),Ma()?.handleObservableUpdated(this,{oldValue:i,newValue:this.value,change:void 0,didChange:o,hadValue:n})}catch(a){MR(a)}if(this._isComputing=!1,o)for(let a of this.observers)a.handleChange(this,void 0)}toString(){return`LazyDerived<${this.debugName}>`}beginUpdate(r){if(this._isUpdating)throw new xn("Cyclic deriveds are not supported yet!");this.updateCount++,this._isUpdating=!0;try{let n=this.updateCount===1;if(this.state===3&&(this.state=1,!n))for(let i of this.observers)i.handlePossibleChange(this);if(n)for(let i of this.observers)i.beginUpdate(this)}finally{this._isUpdating=!1}}endUpdate(r){if(this.updateCount--,this.updateCount===0){let n=[...this.observers];for(let i of n)i.endUpdate(this);if(this._removedObserverToCallEndUpdateOn){let i=[...this._removedObserverToCallEndUpdateOn];this._removedObserverToCallEndUpdateOn=null;for(let o of i)o.endUpdate(this)}}NA(()=>this.updateCount>=0)}handlePossibleChange(r){if(this.state===3&&this.dependencies.has(r)&&!this.dependenciesToBeRemoved.has(r)){this.state=1;for(let n of this.observers)n.handlePossibleChange(this)}}handleChange(r,n){if(this.dependencies.has(r)&&!this.dependenciesToBeRemoved.has(r)){Ma()?.handleDerivedDependencyChanged(this,r,n);let i=!1;try{i=this._handleChange?this._handleChange({changedObservable:r,change:n,didChange:s(a=>a===r,"didChange")},this.changeSummary):!0}catch(a){MR(a)}let o=this.state===3;if(i&&(this.state===1||o)&&(this.state=2,o))for(let a of this.observers)a.handlePossibleChange(this)}}readObservable(r){if(!this._isReaderValid)throw new xn("The reader object cannot be used outside its compute function!");r.addObserver(this);let n=r.get();return this.dependencies.add(r),this.dependenciesToBeRemoved.delete(r),n}addObserver(r){let n=!this.observers.has(r)&&this.updateCount>0;super.addObserver(r),n&&(this._removedObserverToCallEndUpdateOn&&this._removedObserverToCallEndUpdateOn.has(r)?this._removedObserverToCallEndUpdateOn.delete(r):r.beginUpdate(this))}removeObserver(r){this.observers.has(r)&&this.updateCount>0&&(this._removedObserverToCallEndUpdateOn||(this._removedObserverToCallEndUpdateOn=new Set),this._removedObserverToCallEndUpdateOn.add(r)),super.removeObserver(r)}};d();d();function qxe(...t){let e,r,n;return t.length===3?[e,r,n]=t:[r,n]=t,new zT(new Bf(e,void 0,n),r,n,()=>zT.globalTransaction,Px)}s(qxe,"observableFromEvent");var zT=class extends VT{constructor(r,n,i,o,a){super();this._debugNameData=r;this.event=n;this._getValue=i;this._getTransaction=o;this._equalityComparator=a;this.hasValue=!1;this.handleEvent=s(r=>{let n=this._getValue(r),i=this.value,o=!this.hasValue||!this._equalityComparator(i,n),a=!1;o&&(this.value=n,this.hasValue&&(a=!0,Fxe(this._getTransaction(),c=>{Ma()?.handleObservableUpdated(this,{oldValue:i,newValue:n,change:void 0,didChange:o,hadValue:this.hasValue});for(let l of this.observers)c.updateObserver(l,this),l.handleChange(this,void 0)},()=>{let c=this.getDebugName();return"Event fired"+(c?`: ${c}`:"")})),this.hasValue=!0),a||Ma()?.handleObservableUpdated(this,{oldValue:i,newValue:n,change:void 0,didChange:o,hadValue:this.hasValue})},"handleEvent")}static{s(this,"FromEventObservable")}getDebugName(){return this._debugNameData.getDebugName(this)}get debugName(){let r=this.getDebugName();return"From Event"+(r?`: ${r}`:"")}onFirstObserverAdded(){this.subscription=this.event(this.handleEvent)}onLastObserverRemoved(){this.subscription.dispose(),this.subscription=void 0,this.hasValue=!1,this.value=void 0}get(){return this.subscription?(this.hasValue||this.handleEvent(void 0),this.value):this._getValue(void 0)}};(r=>{r.Observer=zT;function e(n,i){let o=!1;zT.globalTransaction===void 0&&(zT.globalTransaction=n,o=!0);try{i()}finally{o&&(zT.globalTransaction=void 0)}}r.batchEventsGlobally=e,s(e,"batchEventsGlobally")})(qxe||={});function aXe(t){let e=new _Z(!1,void 0);return t.addObserver(e),Qc(()=>{t.removeObserver(e)})}s(aXe,"keepObserved");iXe(aXe);function cXe(t,e){let r=new _Z(!0,e);return t.addObserver(r),e?e(t.get()):t.reportChanges(),Qc(()=>{t.removeObserver(r)})}s(cXe,"recomputeInitiallyAndOnChange");rXe(cXe);var _Z=class{constructor(e,r){this._forceRecompute=e;this._handleValue=r;this._counter=0}static{s(this,"KeepAliveObserver")}beginUpdate(e){this._counter++}endUpdate(e){this._counter--,this._counter===0&&this._forceRecompute&&(this._handleValue?this._handleValue(e.get()):e.reportChanges())}handlePossibleChange(e){}handleChange(e,r){}};function Bh(t,e,r,n){let i=new RZ(r,n);return SZ({debugReferenceFn:r,owner:t,onLastObserverRemoved:s(()=>{i.dispose(),i=new RZ(r)},"onLastObserverRemoved")},a=>(i.setItems(e.read(a)),i.getItems()))}s(Bh,"mapObservableArrayCached");var RZ=class{constructor(e,r){this._map=e;this._keySelector=r;this._cache=new Map;this._items=[]}static{s(this,"ArrayMap")}dispose(){this._cache.forEach(e=>e.store.dispose()),this._cache.clear()}setItems(e){let r=[],n=new Set(this._cache.keys());for(let i of e){let o=this._keySelector?this._keySelector(i):i,a=this._cache.get(o);if(a)n.delete(o);else{let c=new td;a={out:this._map(i,c),store:c},this._cache.set(o,a)}r.push(a.out)}for(let i of n)this._cache.get(i).store.dispose(),this._cache.delete(i);this._items=r}getItems(){return this._items}};function Hxe(t,e){let r;return Qxe({createEmptyChangeSummary:s(()=>({deltas:[],didChange:!1}),"createEmptyChangeSummary"),handleChange:s((n,i)=>{if(n.didChange(t)){let o=n.change;o!==void 0&&i.deltas.push(o),i.didChange=!0}return!0},"handleChange")},(n,i)=>{let o=t.read(n),a=r;i.didChange&&(r=o,e(o,a,i.deltas))})}s(Hxe,"runOnChange");d();d();d();var lXe=Object.freeze(function(t,e){let r=setTimeout(t.bind(e),0);return{dispose(){clearTimeout(r)}}}),kZ;(n=>{function t(i){return i===n.None||i===n.Cancelled||i instanceof N3?!0:!i||typeof i!="object"?!1:typeof i.isCancellationRequested=="boolean"&&typeof i.onCancellationRequested=="function"}n.isCancellationToken=t,s(t,"isCancellationToken"),n.None=Object.freeze({isCancellationRequested:!1,onCancellationRequested:WR.None}),n.Cancelled=Object.freeze({isCancellationRequested:!0,onCancellationRequested:lXe})})(kZ||={});var N3=class{constructor(){this._isCancelled=!1;this._emitter=null}static{s(this,"MutableToken")}cancel(){this._isCancelled||(this._isCancelled=!0,this._emitter&&(this._emitter.fire(void 0),this.dispose()))}get isCancellationRequested(){return this._isCancelled}get onCancellationRequested(){return this._isCancelled?lXe:(this._emitter||(this._emitter=new K0),this._emitter.event)}dispose(){this._emitter&&(this._emitter.dispose(),this._emitter=null)}},Dx=class{constructor(e){this._token=void 0;this._parentListener=void 0;this._parentListener=e&&e.onCancellationRequested(this.cancel,this)}static{s(this,"CancellationTokenSource")}get token(){return this._token||(this._token=new N3),this._token}cancel(){this._token?this._token instanceof N3&&this._token.cancel():this._token=kZ.Cancelled}dispose(e=!1){e&&this.cancel(),this._parentListener?.dispose(),this._token?this._token instanceof N3&&this._token.dispose():this._token=kZ.None}};d();var PZ;function uXe(t){PZ||(PZ=new k7,EZ(PZ)),PZ.addFilteredObj(t)}s(uXe,"logObservableToConsole");var k7=class{constructor(){this.indentation=0;this.changedObservablesSets=new WeakMap}static{s(this,"ConsoleObservableLogger")}addFilteredObj(e){this._filteredObjects||(this._filteredObjects=new Set),this._filteredObjects.add(e)}_isIncluded(e){return this._filteredObjects?.has(e)??!0}textToConsoleArgs(e){return UVt([M3($Vt("|  ",this.indentation)),e])}formatInfo(e){return e.hadValue?e.didChange?[M3(" "),Nh(R7(e.oldValue,70),{color:"red",strikeThrough:!0}),M3(" "),Nh(R7(e.newValue,60),{color:"green"})]:[M3(" (unchanged)")]:[M3(" "),Nh(R7(e.newValue,60),{color:"green"}),M3(" (initial)")]}handleObservableCreated(e){if(e instanceof VR){let r=e;if(this.changedObservablesSets.set(r,new Set),!1){let i=[];r.__debugUpdating=i;let o=r.beginUpdate;r.beginUpdate=c=>(i.push(c),o.apply(r,[c]));let a=r.endUpdate;r.endUpdate=c=>{let l=i.indexOf(c);return l===-1&&console.error("endUpdate called without beginUpdate",r.debugName,c.debugName),i.splice(l,1),a.apply(r,[c])}}}}handleOnListenerCountChanged(e,r){}handleObservableUpdated(e,r){if(this._isIncluded(e)){if(e instanceof VR){this._handleDerivedRecomputed(e,r);return}console.log(...this.textToConsoleArgs([L3("observable value changed"),Nh(e.debugName,{color:"BlueViolet"}),...this.formatInfo(r)]))}}formatChanges(e){if(e.size!==0)return Nh(" (changed deps: "+[...e].map(r=>r.debugName).join(", ")+")",{color:"gray"})}handleDerivedDependencyChanged(e,r,n){this._isIncluded(e)&&this.changedObservablesSets.get(e)?.add(r)}_handleDerivedRecomputed(e,r){if(!this._isIncluded(e))return;let n=this.changedObservablesSets.get(e);n&&(console.log(...this.textToConsoleArgs([L3("derived recomputed"),Nh(e.debugName,{color:"BlueViolet"}),...this.formatInfo(r),this.formatChanges(n),{data:[{fn:e._debugNameData.referenceFn??e._computeFn}]}])),n.clear())}handleDerivedCleared(e){this._isIncluded(e)&&console.log(...this.textToConsoleArgs([L3("derived cleared"),Nh(e.debugName,{color:"BlueViolet"})]))}handleFromEventObservableTriggered(e,r){this._isIncluded(e)&&console.log(...this.textToConsoleArgs([L3("observable from event triggered"),Nh(e.debugName,{color:"BlueViolet"}),...this.formatInfo(r),{data:[{fn:e._getValue}]}]))}handleAutorunCreated(e){this._isIncluded(e)&&this.changedObservablesSets.set(e,new Set)}handleAutorunDisposed(e){}handleAutorunDependencyChanged(e,r,n){this._isIncluded(e)&&this.changedObservablesSets.get(e).add(r)}handleAutorunStarted(e){let r=this.changedObservablesSets.get(e);r&&(this._isIncluded(e)&&console.log(...this.textToConsoleArgs([L3("autorun"),Nh(e.debugName,{color:"BlueViolet"}),this.formatChanges(r),{data:[{fn:e._debugNameData.referenceFn??e._runFn}]}])),r.clear(),this.indentation++)}handleAutorunFinished(e){this.indentation--}handleBeginTransaction(e){let r=e.getDebugName();r===void 0&&(r=""),this._isIncluded(e)&&console.log(...this.textToConsoleArgs([L3("transaction"),Nh(r,{color:"BlueViolet"}),{data:[{fn:e._fn}]}])),this.indentation++}handleEndTransaction(){this.indentation--}};function UVt(t){let e=new Array,r=[],n="";function i(a){if("length"in a)for(let c of a)c&&i(c);else"text"in a?(n+=`%c${a.text}`,e.push(a.style),a.data&&r.push(...a.data)):"data"in a&&r.push(...a.data)}s(i,"process"),i(t);let o=[n,...e];return o.push(...r),o}s(UVt,"consoleTextToArgs");function M3(t){return Nh(t,{color:"black"})}s(M3,"normalText");function L3(t){return Nh(WVt(`${t}: `,10),{color:"black",bold:!0})}s(L3,"formatKind");function Nh(t,e={color:"black"}){function r(i){return Object.entries(i).reduce((o,[a,c])=>`${o}${a}:${c};`,"")}s(r,"objToCss");let n={color:e.color};return e.strikeThrough&&(n["text-decoration"]="line-through"),e.bold&&(n["font-weight"]="bold"),{text:t,style:r(n)}}s(Nh,"styled");function R7(t,e){switch(typeof t){case"number":return""+t;case"string":return t.length+2<=e?`"${t}"`:`"${t.substr(0,e-7)}"+...`;case"boolean":return t?"true":"false";case"undefined":return"undefined";case"object":return t===null?"null":Array.isArray(t)?qVt(t,e):HVt(t,e);case"symbol":return t.toString();case"function":return`[[Function${t.name?" "+t.name:""}]]`;default:return""+t}}s(R7,"formatValue");function qVt(t,e){let r="[ ",n=!0;for(let i of t){if(n||(r+=", "),r.length-5>e){r+="...";break}n=!1,r+=`${R7(i,e-r.length)}`}return r+=" ]",r}s(qVt,"formatArray");function HVt(t,e){if(typeof t.toString=="function"&&t.toString!==Object.prototype.toString){let i=t.toString();return i.length<=e?i:i.substring(0,e-3)+"..."}let r="{ ",n=!0;for(let[i,o]of Object.entries(t)){if(n||(r+=", "),r.length-5>e){r+="...";break}n=!1,r+=`${i}: ${R7(o,e-r.length)}`}return r+=" }",r}s(HVt,"formatObject");function $Vt(t,e){let r="";for(let n=1;n<=e;n++)r+=t;return r}s($Vt,"repeat");function WVt(t,e){for(;t.length<e;)t+=" ";return t}s(WVt,"padStr");ZJe(uXe);var jVt=!1;jVt&&EZ(new k7);d();var zR;(r=>{r.PlainText="plaintext";function e(n){return n}r.create=e,s(e,"create")})(zR||={});d();d();d();function dXe(t){return t}s(dXe,"identity");var DZ=class{constructor(e,r){this.lastCache=void 0;this.lastArgKey=void 0;typeof e=="function"?(this._fn=e,this._computeKey=dXe):(this._fn=r,this._computeKey=e.getCacheKey)}static{s(this,"LRUCachedFunction")}get(e){let r=this._computeKey(e);return this.lastArgKey!==r&&(this.lastArgKey=r,this.lastCache=this._fn(e)),this.lastCache}},Bx=class{constructor(e,r){this._map=new Map;this._map2=new Map;typeof e=="function"?(this._fn=e,this._computeKey=dXe):(this._fn=r,this._computeKey=e.getCacheKey)}static{s(this,"CachedFunction")}get cachedValues(){return this._map}get(e){let r=this._computeKey(e);if(this._map2.has(r))return this._map2.get(r);let n=this._fn(e);return this._map.set(e,n),this._map2.set(r,n),n}};d();d();var Mh=class{constructor(e){this.executor=e;this._didRun=!1}static{s(this,"Lazy")}get hasValue(){return this._didRun}get value(){if(!this._didRun)try{this._value=this.executor()}catch(e){this._error=e}finally{this._didRun=!0}if(this._error)throw this._error;return this._value}get rawValue(){return this._value}};d();function KR(t){return t<0?0:t>4294967295?4294967295:t|0}s(KR,"toUint32");function O3(t){return t.replace(/[\\\{\}\*\+\?\|\^\$\.\[\]\(\)]/g,"\\$&")}s(O3,"escapeRegExpCharacters");function gXe(t,e){if(!t||!e)return t;let r=e.length;if(r===0||t.length===0)return t;let n=0;for(;t.indexOf(e,n)===n;)n=n+r;return t.substring(n)}s(gXe,"ltrim");function Lh(t){return t.split(/\r\n|\r|\n/)}s(Lh,"splitLines");function VVt(t,e,r=0,n=t.length,i=0,o=e.length){for(;r<n&&i<o;r++,i++){let l=t.charCodeAt(r),u=e.charCodeAt(i);if(l<u)return-1;if(l>u)return 1}let a=n-r,c=o-i;return a<c?-1:a>c?1:0}s(VVt,"compareSubstring");function zVt(t,e,r=0,n=t.length,i=0,o=e.length){for(;r<n&&i<o;r++,i++){let l=t.charCodeAt(r),u=e.charCodeAt(i);if(l===u)continue;if(l>=128||u>=128)return VVt(t.toLowerCase(),e.toLowerCase(),r,n,i,o);fXe(l)&&(l-=32),fXe(u)&&(u-=32);let f=l-u;if(f!==0)return f}let a=n-r,c=o-i;return a<c?-1:a>c?1:0}s(zVt,"compareSubstringIgnoreCase");function fXe(t){return t>=97&&t<=122}s(fXe,"isLowerAsciiLetter");function AXe(t,e){let r=e.length;return e.length>t.length?!1:zVt(t,e,0,r)===0}s(AXe,"startsWithIgnoreCase");function KT(t,e){let r=Math.min(t.length,e.length),n;for(n=0;n<r;n++)if(t.charCodeAt(n)!==e.charCodeAt(n))return n;return r}s(KT,"commonPrefixLength");function Nx(t,e){let r=Math.min(t.length,e.length),n,i=t.length-1,o=e.length-1;for(n=0;n<r;n++)if(t.charCodeAt(i-n)!==e.charCodeAt(o-n))return n;return r}s(Nx,"commonSuffixLength");var KVt=/^[\t\n\r\x20-\x7E]*$/;function $xe(t){return KVt.test(t)}s($xe,"isBasicASCII");var Aei=String.fromCharCode(65279);var pXe=class t{static{s(this,"GraphemeBreakTree")}static{this._INSTANCE=null}static getInstance(){return t._INSTANCE||(t._INSTANCE=new t),t._INSTANCE}constructor(){this._data=YVt()}getGraphemeBreakType(e){if(e<32)return e===10?3:e===13?2:4;if(e<127)return 0;let r=this._data,n=r.length/3,i=1;for(;i<=n;)if(e<r[3*i])i=2*i;else if(e>r[3*i+1])i=2*i+1;else return r[3*i+2];return 0}};function YVt(){return JSON.parse("[0,0,0,51229,51255,12,44061,44087,12,127462,127487,6,7083,7085,5,47645,47671,12,54813,54839,12,128678,128678,14,3270,3270,5,9919,9923,14,45853,45879,12,49437,49463,12,53021,53047,12,71216,71218,7,128398,128399,14,129360,129374,14,2519,2519,5,4448,4519,9,9742,9742,14,12336,12336,14,44957,44983,12,46749,46775,12,48541,48567,12,50333,50359,12,52125,52151,12,53917,53943,12,69888,69890,5,73018,73018,5,127990,127990,14,128558,128559,14,128759,128760,14,129653,129655,14,2027,2035,5,2891,2892,7,3761,3761,5,6683,6683,5,8293,8293,4,9825,9826,14,9999,9999,14,43452,43453,5,44509,44535,12,45405,45431,12,46301,46327,12,47197,47223,12,48093,48119,12,48989,49015,12,49885,49911,12,50781,50807,12,51677,51703,12,52573,52599,12,53469,53495,12,54365,54391,12,65279,65279,4,70471,70472,7,72145,72147,7,119173,119179,5,127799,127818,14,128240,128244,14,128512,128512,14,128652,128652,14,128721,128722,14,129292,129292,14,129445,129450,14,129734,129743,14,1476,1477,5,2366,2368,7,2750,2752,7,3076,3076,5,3415,3415,5,4141,4144,5,6109,6109,5,6964,6964,5,7394,7400,5,9197,9198,14,9770,9770,14,9877,9877,14,9968,9969,14,10084,10084,14,43052,43052,5,43713,43713,5,44285,44311,12,44733,44759,12,45181,45207,12,45629,45655,12,46077,46103,12,46525,46551,12,46973,46999,12,47421,47447,12,47869,47895,12,48317,48343,12,48765,48791,12,49213,49239,12,49661,49687,12,50109,50135,12,50557,50583,12,51005,51031,12,51453,51479,12,51901,51927,12,52349,52375,12,52797,52823,12,53245,53271,12,53693,53719,12,54141,54167,12,54589,54615,12,55037,55063,12,69506,69509,5,70191,70193,5,70841,70841,7,71463,71467,5,72330,72342,5,94031,94031,5,123628,123631,5,127763,127765,14,127941,127941,14,128043,128062,14,128302,128317,14,128465,128467,14,128539,128539,14,128640,128640,14,128662,128662,14,128703,128703,14,128745,128745,14,129004,129007,14,129329,129330,14,129402,129402,14,129483,129483,14,129686,129704,14,130048,131069,14,173,173,4,1757,1757,1,2200,2207,5,2434,2435,7,2631,2632,5,2817,2817,5,3008,3008,5,3201,3201,5,3387,3388,5,3542,3542,5,3902,3903,7,4190,4192,5,6002,6003,5,6439,6440,5,6765,6770,7,7019,7027,5,7154,7155,7,8205,8205,13,8505,8505,14,9654,9654,14,9757,9757,14,9792,9792,14,9852,9853,14,9890,9894,14,9937,9937,14,9981,9981,14,10035,10036,14,11035,11036,14,42654,42655,5,43346,43347,7,43587,43587,5,44006,44007,7,44173,44199,12,44397,44423,12,44621,44647,12,44845,44871,12,45069,45095,12,45293,45319,12,45517,45543,12,45741,45767,12,45965,45991,12,46189,46215,12,46413,46439,12,46637,46663,12,46861,46887,12,47085,47111,12,47309,47335,12,47533,47559,12,47757,47783,12,47981,48007,12,48205,48231,12,48429,48455,12,48653,48679,12,48877,48903,12,49101,49127,12,49325,49351,12,49549,49575,12,49773,49799,12,49997,50023,12,50221,50247,12,50445,50471,12,50669,50695,12,50893,50919,12,51117,51143,12,51341,51367,12,51565,51591,12,51789,51815,12,52013,52039,12,52237,52263,12,52461,52487,12,52685,52711,12,52909,52935,12,53133,53159,12,53357,53383,12,53581,53607,12,53805,53831,12,54029,54055,12,54253,54279,12,54477,54503,12,54701,54727,12,54925,54951,12,55149,55175,12,68101,68102,5,69762,69762,7,70067,70069,7,70371,70378,5,70720,70721,7,71087,71087,5,71341,71341,5,71995,71996,5,72249,72249,7,72850,72871,5,73109,73109,5,118576,118598,5,121505,121519,5,127245,127247,14,127568,127569,14,127777,127777,14,127872,127891,14,127956,127967,14,128015,128016,14,128110,128172,14,128259,128259,14,128367,128368,14,128424,128424,14,128488,128488,14,128530,128532,14,128550,128551,14,128566,128566,14,128647,128647,14,128656,128656,14,128667,128673,14,128691,128693,14,128715,128715,14,128728,128732,14,128752,128752,14,128765,128767,14,129096,129103,14,129311,129311,14,129344,129349,14,129394,129394,14,129413,129425,14,129466,129471,14,129511,129535,14,129664,129666,14,129719,129722,14,129760,129767,14,917536,917631,5,13,13,2,1160,1161,5,1564,1564,4,1807,1807,1,2085,2087,5,2307,2307,7,2382,2383,7,2497,2500,5,2563,2563,7,2677,2677,5,2763,2764,7,2879,2879,5,2914,2915,5,3021,3021,5,3142,3144,5,3263,3263,5,3285,3286,5,3398,3400,7,3530,3530,5,3633,3633,5,3864,3865,5,3974,3975,5,4155,4156,7,4229,4230,5,5909,5909,7,6078,6085,7,6277,6278,5,6451,6456,7,6744,6750,5,6846,6846,5,6972,6972,5,7074,7077,5,7146,7148,7,7222,7223,5,7416,7417,5,8234,8238,4,8417,8417,5,9000,9000,14,9203,9203,14,9730,9731,14,9748,9749,14,9762,9763,14,9776,9783,14,9800,9811,14,9831,9831,14,9872,9873,14,9882,9882,14,9900,9903,14,9929,9933,14,9941,9960,14,9974,9974,14,9989,9989,14,10006,10006,14,10062,10062,14,10160,10160,14,11647,11647,5,12953,12953,14,43019,43019,5,43232,43249,5,43443,43443,5,43567,43568,7,43696,43696,5,43765,43765,7,44013,44013,5,44117,44143,12,44229,44255,12,44341,44367,12,44453,44479,12,44565,44591,12,44677,44703,12,44789,44815,12,44901,44927,12,45013,45039,12,45125,45151,12,45237,45263,12,45349,45375,12,45461,45487,12,45573,45599,12,45685,45711,12,45797,45823,12,45909,45935,12,46021,46047,12,46133,46159,12,46245,46271,12,46357,46383,12,46469,46495,12,46581,46607,12,46693,46719,12,46805,46831,12,46917,46943,12,47029,47055,12,47141,47167,12,47253,47279,12,47365,47391,12,47477,47503,12,47589,47615,12,47701,47727,12,47813,47839,12,47925,47951,12,48037,48063,12,48149,48175,12,48261,48287,12,48373,48399,12,48485,48511,12,48597,48623,12,48709,48735,12,48821,48847,12,48933,48959,12,49045,49071,12,49157,49183,12,49269,49295,12,49381,49407,12,49493,49519,12,49605,49631,12,49717,49743,12,49829,49855,12,49941,49967,12,50053,50079,12,50165,50191,12,50277,50303,12,50389,50415,12,50501,50527,12,50613,50639,12,50725,50751,12,50837,50863,12,50949,50975,12,51061,51087,12,51173,51199,12,51285,51311,12,51397,51423,12,51509,51535,12,51621,51647,12,51733,51759,12,51845,51871,12,51957,51983,12,52069,52095,12,52181,52207,12,52293,52319,12,52405,52431,12,52517,52543,12,52629,52655,12,52741,52767,12,52853,52879,12,52965,52991,12,53077,53103,12,53189,53215,12,53301,53327,12,53413,53439,12,53525,53551,12,53637,53663,12,53749,53775,12,53861,53887,12,53973,53999,12,54085,54111,12,54197,54223,12,54309,54335,12,54421,54447,12,54533,54559,12,54645,54671,12,54757,54783,12,54869,54895,12,54981,55007,12,55093,55119,12,55243,55291,10,66045,66045,5,68325,68326,5,69688,69702,5,69817,69818,5,69957,69958,7,70089,70092,5,70198,70199,5,70462,70462,5,70502,70508,5,70750,70750,5,70846,70846,7,71100,71101,5,71230,71230,7,71351,71351,5,71737,71738,5,72000,72000,7,72160,72160,5,72273,72278,5,72752,72758,5,72882,72883,5,73031,73031,5,73461,73462,7,94192,94193,7,119149,119149,7,121403,121452,5,122915,122916,5,126980,126980,14,127358,127359,14,127535,127535,14,127759,127759,14,127771,127771,14,127792,127793,14,127825,127867,14,127897,127899,14,127945,127945,14,127985,127986,14,128000,128007,14,128021,128021,14,128066,128100,14,128184,128235,14,128249,128252,14,128266,128276,14,128335,128335,14,128379,128390,14,128407,128419,14,128444,128444,14,128481,128481,14,128499,128499,14,128526,128526,14,128536,128536,14,128543,128543,14,128556,128556,14,128564,128564,14,128577,128580,14,128643,128645,14,128649,128649,14,128654,128654,14,128660,128660,14,128664,128664,14,128675,128675,14,128686,128689,14,128695,128696,14,128705,128709,14,128717,128719,14,128725,128725,14,128736,128741,14,128747,128748,14,128755,128755,14,128762,128762,14,128981,128991,14,129009,129023,14,129160,129167,14,129296,129304,14,129320,129327,14,129340,129342,14,129356,129356,14,129388,129392,14,129399,129400,14,129404,129407,14,129432,129442,14,129454,129455,14,129473,129474,14,129485,129487,14,129648,129651,14,129659,129660,14,129671,129679,14,129709,129711,14,129728,129730,14,129751,129753,14,129776,129782,14,917505,917505,4,917760,917999,5,10,10,3,127,159,4,768,879,5,1471,1471,5,1536,1541,1,1648,1648,5,1767,1768,5,1840,1866,5,2070,2073,5,2137,2139,5,2274,2274,1,2363,2363,7,2377,2380,7,2402,2403,5,2494,2494,5,2507,2508,7,2558,2558,5,2622,2624,7,2641,2641,5,2691,2691,7,2759,2760,5,2786,2787,5,2876,2876,5,2881,2884,5,2901,2902,5,3006,3006,5,3014,3016,7,3072,3072,5,3134,3136,5,3157,3158,5,3260,3260,5,3266,3266,5,3274,3275,7,3328,3329,5,3391,3392,7,3405,3405,5,3457,3457,5,3536,3537,7,3551,3551,5,3636,3642,5,3764,3772,5,3895,3895,5,3967,3967,7,3993,4028,5,4146,4151,5,4182,4183,7,4226,4226,5,4253,4253,5,4957,4959,5,5940,5940,7,6070,6070,7,6087,6088,7,6158,6158,4,6432,6434,5,6448,6449,7,6679,6680,5,6742,6742,5,6754,6754,5,6783,6783,5,6912,6915,5,6966,6970,5,6978,6978,5,7042,7042,7,7080,7081,5,7143,7143,7,7150,7150,7,7212,7219,5,7380,7392,5,7412,7412,5,8203,8203,4,8232,8232,4,8265,8265,14,8400,8412,5,8421,8432,5,8617,8618,14,9167,9167,14,9200,9200,14,9410,9410,14,9723,9726,14,9733,9733,14,9745,9745,14,9752,9752,14,9760,9760,14,9766,9766,14,9774,9774,14,9786,9786,14,9794,9794,14,9823,9823,14,9828,9828,14,9833,9850,14,9855,9855,14,9875,9875,14,9880,9880,14,9885,9887,14,9896,9897,14,9906,9916,14,9926,9927,14,9935,9935,14,9939,9939,14,9962,9962,14,9972,9972,14,9978,9978,14,9986,9986,14,9997,9997,14,10002,10002,14,10017,10017,14,10055,10055,14,10071,10071,14,10133,10135,14,10548,10549,14,11093,11093,14,12330,12333,5,12441,12442,5,42608,42610,5,43010,43010,5,43045,43046,5,43188,43203,7,43302,43309,5,43392,43394,5,43446,43449,5,43493,43493,5,43571,43572,7,43597,43597,7,43703,43704,5,43756,43757,5,44003,44004,7,44009,44010,7,44033,44059,12,44089,44115,12,44145,44171,12,44201,44227,12,44257,44283,12,44313,44339,12,44369,44395,12,44425,44451,12,44481,44507,12,44537,44563,12,44593,44619,12,44649,44675,12,44705,44731,12,44761,44787,12,44817,44843,12,44873,44899,12,44929,44955,12,44985,45011,12,45041,45067,12,45097,45123,12,45153,45179,12,45209,45235,12,45265,45291,12,45321,45347,12,45377,45403,12,45433,45459,12,45489,45515,12,45545,45571,12,45601,45627,12,45657,45683,12,45713,45739,12,45769,45795,12,45825,45851,12,45881,45907,12,45937,45963,12,45993,46019,12,46049,46075,12,46105,46131,12,46161,46187,12,46217,46243,12,46273,46299,12,46329,46355,12,46385,46411,12,46441,46467,12,46497,46523,12,46553,46579,12,46609,46635,12,46665,46691,12,46721,46747,12,46777,46803,12,46833,46859,12,46889,46915,12,46945,46971,12,47001,47027,12,47057,47083,12,47113,47139,12,47169,47195,12,47225,47251,12,47281,47307,12,47337,47363,12,47393,47419,12,47449,47475,12,47505,47531,12,47561,47587,12,47617,47643,12,47673,47699,12,47729,47755,12,47785,47811,12,47841,47867,12,47897,47923,12,47953,47979,12,48009,48035,12,48065,48091,12,48121,48147,12,48177,48203,12,48233,48259,12,48289,48315,12,48345,48371,12,48401,48427,12,48457,48483,12,48513,48539,12,48569,48595,12,48625,48651,12,48681,48707,12,48737,48763,12,48793,48819,12,48849,48875,12,48905,48931,12,48961,48987,12,49017,49043,12,49073,49099,12,49129,49155,12,49185,49211,12,49241,49267,12,49297,49323,12,49353,49379,12,49409,49435,12,49465,49491,12,49521,49547,12,49577,49603,12,49633,49659,12,49689,49715,12,49745,49771,12,49801,49827,12,49857,49883,12,49913,49939,12,49969,49995,12,50025,50051,12,50081,50107,12,50137,50163,12,50193,50219,12,50249,50275,12,50305,50331,12,50361,50387,12,50417,50443,12,50473,50499,12,50529,50555,12,50585,50611,12,50641,50667,12,50697,50723,12,50753,50779,12,50809,50835,12,50865,50891,12,50921,50947,12,50977,51003,12,51033,51059,12,51089,51115,12,51145,51171,12,51201,51227,12,51257,51283,12,51313,51339,12,51369,51395,12,51425,51451,12,51481,51507,12,51537,51563,12,51593,51619,12,51649,51675,12,51705,51731,12,51761,51787,12,51817,51843,12,51873,51899,12,51929,51955,12,51985,52011,12,52041,52067,12,52097,52123,12,52153,52179,12,52209,52235,12,52265,52291,12,52321,52347,12,52377,52403,12,52433,52459,12,52489,52515,12,52545,52571,12,52601,52627,12,52657,52683,12,52713,52739,12,52769,52795,12,52825,52851,12,52881,52907,12,52937,52963,12,52993,53019,12,53049,53075,12,53105,53131,12,53161,53187,12,53217,53243,12,53273,53299,12,53329,53355,12,53385,53411,12,53441,53467,12,53497,53523,12,53553,53579,12,53609,53635,12,53665,53691,12,53721,53747,12,53777,53803,12,53833,53859,12,53889,53915,12,53945,53971,12,54001,54027,12,54057,54083,12,54113,54139,12,54169,54195,12,54225,54251,12,54281,54307,12,54337,54363,12,54393,54419,12,54449,54475,12,54505,54531,12,54561,54587,12,54617,54643,12,54673,54699,12,54729,54755,12,54785,54811,12,54841,54867,12,54897,54923,12,54953,54979,12,55009,55035,12,55065,55091,12,55121,55147,12,55177,55203,12,65024,65039,5,65520,65528,4,66422,66426,5,68152,68154,5,69291,69292,5,69633,69633,5,69747,69748,5,69811,69814,5,69826,69826,5,69932,69932,7,70016,70017,5,70079,70080,7,70095,70095,5,70196,70196,5,70367,70367,5,70402,70403,7,70464,70464,5,70487,70487,5,70709,70711,7,70725,70725,7,70833,70834,7,70843,70844,7,70849,70849,7,71090,71093,5,71103,71104,5,71227,71228,7,71339,71339,5,71344,71349,5,71458,71461,5,71727,71735,5,71985,71989,7,71998,71998,5,72002,72002,7,72154,72155,5,72193,72202,5,72251,72254,5,72281,72283,5,72344,72345,5,72766,72766,7,72874,72880,5,72885,72886,5,73023,73029,5,73104,73105,5,73111,73111,5,92912,92916,5,94095,94098,5,113824,113827,4,119142,119142,7,119155,119162,4,119362,119364,5,121476,121476,5,122888,122904,5,123184,123190,5,125252,125258,5,127183,127183,14,127340,127343,14,127377,127386,14,127491,127503,14,127548,127551,14,127744,127756,14,127761,127761,14,127769,127769,14,127773,127774,14,127780,127788,14,127796,127797,14,127820,127823,14,127869,127869,14,127894,127895,14,127902,127903,14,127943,127943,14,127947,127950,14,127972,127972,14,127988,127988,14,127992,127994,14,128009,128011,14,128019,128019,14,128023,128041,14,128064,128064,14,128102,128107,14,128174,128181,14,128238,128238,14,128246,128247,14,128254,128254,14,128264,128264,14,128278,128299,14,128329,128330,14,128348,128359,14,128371,128377,14,128392,128393,14,128401,128404,14,128421,128421,14,128433,128434,14,128450,128452,14,128476,128478,14,128483,128483,14,128495,128495,14,128506,128506,14,128519,128520,14,128528,128528,14,128534,128534,14,128538,128538,14,128540,128542,14,128544,128549,14,128552,128555,14,128557,128557,14,128560,128563,14,128565,128565,14,128567,128576,14,128581,128591,14,128641,128642,14,128646,128646,14,128648,128648,14,128650,128651,14,128653,128653,14,128655,128655,14,128657,128659,14,128661,128661,14,128663,128663,14,128665,128666,14,128674,128674,14,128676,128677,14,128679,128685,14,128690,128690,14,128694,128694,14,128697,128702,14,128704,128704,14,128710,128714,14,128716,128716,14,128720,128720,14,128723,128724,14,128726,128727,14,128733,128735,14,128742,128744,14,128746,128746,14,128749,128751,14,128753,128754,14,128756,128758,14,128761,128761,14,128763,128764,14,128884,128895,14,128992,129003,14,129008,129008,14,129036,129039,14,129114,129119,14,129198,129279,14,129293,129295,14,129305,129310,14,129312,129319,14,129328,129328,14,129331,129338,14,129343,129343,14,129351,129355,14,129357,129359,14,129375,129387,14,129393,129393,14,129395,129398,14,129401,129401,14,129403,129403,14,129408,129412,14,129426,129431,14,129443,129444,14,129451,129453,14,129456,129465,14,129472,129472,14,129475,129482,14,129484,129484,14,129488,129510,14,129536,129647,14,129652,129652,14,129656,129658,14,129661,129663,14,129667,129670,14,129680,129685,14,129705,129708,14,129712,129718,14,129723,129727,14,129731,129733,14,129744,129750,14,129754,129759,14,129768,129775,14,129783,129791,14,917504,917504,4,917506,917535,4,917632,917759,4,918000,921599,4,0,9,4,11,12,4,14,31,4,169,169,14,174,174,14,1155,1159,5,1425,1469,5,1473,1474,5,1479,1479,5,1552,1562,5,1611,1631,5,1750,1756,5,1759,1764,5,1770,1773,5,1809,1809,5,1958,1968,5,2045,2045,5,2075,2083,5,2089,2093,5,2192,2193,1,2250,2273,5,2275,2306,5,2362,2362,5,2364,2364,5,2369,2376,5,2381,2381,5,2385,2391,5,2433,2433,5,2492,2492,5,2495,2496,7,2503,2504,7,2509,2509,5,2530,2531,5,2561,2562,5,2620,2620,5,2625,2626,5,2635,2637,5,2672,2673,5,2689,2690,5,2748,2748,5,2753,2757,5,2761,2761,7,2765,2765,5,2810,2815,5,2818,2819,7,2878,2878,5,2880,2880,7,2887,2888,7,2893,2893,5,2903,2903,5,2946,2946,5,3007,3007,7,3009,3010,7,3018,3020,7,3031,3031,5,3073,3075,7,3132,3132,5,3137,3140,7,3146,3149,5,3170,3171,5,3202,3203,7,3262,3262,7,3264,3265,7,3267,3268,7,3271,3272,7,3276,3277,5,3298,3299,5,3330,3331,7,3390,3390,5,3393,3396,5,3402,3404,7,3406,3406,1,3426,3427,5,3458,3459,7,3535,3535,5,3538,3540,5,3544,3550,7,3570,3571,7,3635,3635,7,3655,3662,5,3763,3763,7,3784,3789,5,3893,3893,5,3897,3897,5,3953,3966,5,3968,3972,5,3981,3991,5,4038,4038,5,4145,4145,7,4153,4154,5,4157,4158,5,4184,4185,5,4209,4212,5,4228,4228,7,4237,4237,5,4352,4447,8,4520,4607,10,5906,5908,5,5938,5939,5,5970,5971,5,6068,6069,5,6071,6077,5,6086,6086,5,6089,6099,5,6155,6157,5,6159,6159,5,6313,6313,5,6435,6438,7,6441,6443,7,6450,6450,5,6457,6459,5,6681,6682,7,6741,6741,7,6743,6743,7,6752,6752,5,6757,6764,5,6771,6780,5,6832,6845,5,6847,6862,5,6916,6916,7,6965,6965,5,6971,6971,7,6973,6977,7,6979,6980,7,7040,7041,5,7073,7073,7,7078,7079,7,7082,7082,7,7142,7142,5,7144,7145,5,7149,7149,5,7151,7153,5,7204,7211,7,7220,7221,7,7376,7378,5,7393,7393,7,7405,7405,5,7415,7415,7,7616,7679,5,8204,8204,5,8206,8207,4,8233,8233,4,8252,8252,14,8288,8292,4,8294,8303,4,8413,8416,5,8418,8420,5,8482,8482,14,8596,8601,14,8986,8987,14,9096,9096,14,9193,9196,14,9199,9199,14,9201,9202,14,9208,9210,14,9642,9643,14,9664,9664,14,9728,9729,14,9732,9732,14,9735,9741,14,9743,9744,14,9746,9746,14,9750,9751,14,9753,9756,14,9758,9759,14,9761,9761,14,9764,9765,14,9767,9769,14,9771,9773,14,9775,9775,14,9784,9785,14,9787,9791,14,9793,9793,14,9795,9799,14,9812,9822,14,9824,9824,14,9827,9827,14,9829,9830,14,9832,9832,14,9851,9851,14,9854,9854,14,9856,9861,14,9874,9874,14,9876,9876,14,9878,9879,14,9881,9881,14,9883,9884,14,9888,9889,14,9895,9895,14,9898,9899,14,9904,9905,14,9917,9918,14,9924,9925,14,9928,9928,14,9934,9934,14,9936,9936,14,9938,9938,14,9940,9940,14,9961,9961,14,9963,9967,14,9970,9971,14,9973,9973,14,9975,9977,14,9979,9980,14,9982,9985,14,9987,9988,14,9992,9996,14,9998,9998,14,10000,10001,14,10004,10004,14,10013,10013,14,10024,10024,14,10052,10052,14,10060,10060,14,10067,10069,14,10083,10083,14,10085,10087,14,10145,10145,14,10175,10175,14,11013,11015,14,11088,11088,14,11503,11505,5,11744,11775,5,12334,12335,5,12349,12349,14,12951,12951,14,42607,42607,5,42612,42621,5,42736,42737,5,43014,43014,5,43043,43044,7,43047,43047,7,43136,43137,7,43204,43205,5,43263,43263,5,43335,43345,5,43360,43388,8,43395,43395,7,43444,43445,7,43450,43451,7,43454,43456,7,43561,43566,5,43569,43570,5,43573,43574,5,43596,43596,5,43644,43644,5,43698,43700,5,43710,43711,5,43755,43755,7,43758,43759,7,43766,43766,5,44005,44005,5,44008,44008,5,44012,44012,7,44032,44032,11,44060,44060,11,44088,44088,11,44116,44116,11,44144,44144,11,44172,44172,11,44200,44200,11,44228,44228,11,44256,44256,11,44284,44284,11,44312,44312,11,44340,44340,11,44368,44368,11,44396,44396,11,44424,44424,11,44452,44452,11,44480,44480,11,44508,44508,11,44536,44536,11,44564,44564,11,44592,44592,11,44620,44620,11,44648,44648,11,44676,44676,11,44704,44704,11,44732,44732,11,44760,44760,11,44788,44788,11,44816,44816,11,44844,44844,11,44872,44872,11,44900,44900,11,44928,44928,11,44956,44956,11,44984,44984,11,45012,45012,11,45040,45040,11,45068,45068,11,45096,45096,11,45124,45124,11,45152,45152,11,45180,45180,11,45208,45208,11,45236,45236,11,45264,45264,11,45292,45292,11,45320,45320,11,45348,45348,11,45376,45376,11,45404,45404,11,45432,45432,11,45460,45460,11,45488,45488,11,45516,45516,11,45544,45544,11,45572,45572,11,45600,45600,11,45628,45628,11,45656,45656,11,45684,45684,11,45712,45712,11,45740,45740,11,45768,45768,11,45796,45796,11,45824,45824,11,45852,45852,11,45880,45880,11,45908,45908,11,45936,45936,11,45964,45964,11,45992,45992,11,46020,46020,11,46048,46048,11,46076,46076,11,46104,46104,11,46132,46132,11,46160,46160,11,46188,46188,11,46216,46216,11,46244,46244,11,46272,46272,11,46300,46300,11,46328,46328,11,46356,46356,11,46384,46384,11,46412,46412,11,46440,46440,11,46468,46468,11,46496,46496,11,46524,46524,11,46552,46552,11,46580,46580,11,46608,46608,11,46636,46636,11,46664,46664,11,46692,46692,11,46720,46720,11,46748,46748,11,46776,46776,11,46804,46804,11,46832,46832,11,46860,46860,11,46888,46888,11,46916,46916,11,46944,46944,11,46972,46972,11,47000,47000,11,47028,47028,11,47056,47056,11,47084,47084,11,47112,47112,11,47140,47140,11,47168,47168,11,47196,47196,11,47224,47224,11,47252,47252,11,47280,47280,11,47308,47308,11,47336,47336,11,47364,47364,11,47392,47392,11,47420,47420,11,47448,47448,11,47476,47476,11,47504,47504,11,47532,47532,11,47560,47560,11,47588,47588,11,47616,47616,11,47644,47644,11,47672,47672,11,47700,47700,11,47728,47728,11,47756,47756,11,47784,47784,11,47812,47812,11,47840,47840,11,47868,47868,11,47896,47896,11,47924,47924,11,47952,47952,11,47980,47980,11,48008,48008,11,48036,48036,11,48064,48064,11,48092,48092,11,48120,48120,11,48148,48148,11,48176,48176,11,48204,48204,11,48232,48232,11,48260,48260,11,48288,48288,11,48316,48316,11,48344,48344,11,48372,48372,11,48400,48400,11,48428,48428,11,48456,48456,11,48484,48484,11,48512,48512,11,48540,48540,11,48568,48568,11,48596,48596,11,48624,48624,11,48652,48652,11,48680,48680,11,48708,48708,11,48736,48736,11,48764,48764,11,48792,48792,11,48820,48820,11,48848,48848,11,48876,48876,11,48904,48904,11,48932,48932,11,48960,48960,11,48988,48988,11,49016,49016,11,49044,49044,11,49072,49072,11,49100,49100,11,49128,49128,11,49156,49156,11,49184,49184,11,49212,49212,11,49240,49240,11,49268,49268,11,49296,49296,11,49324,49324,11,49352,49352,11,49380,49380,11,49408,49408,11,49436,49436,11,49464,49464,11,49492,49492,11,49520,49520,11,49548,49548,11,49576,49576,11,49604,49604,11,49632,49632,11,49660,49660,11,49688,49688,11,49716,49716,11,49744,49744,11,49772,49772,11,49800,49800,11,49828,49828,11,49856,49856,11,49884,49884,11,49912,49912,11,49940,49940,11,49968,49968,11,49996,49996,11,50024,50024,11,50052,50052,11,50080,50080,11,50108,50108,11,50136,50136,11,50164,50164,11,50192,50192,11,50220,50220,11,50248,50248,11,50276,50276,11,50304,50304,11,50332,50332,11,50360,50360,11,50388,50388,11,50416,50416,11,50444,50444,11,50472,50472,11,50500,50500,11,50528,50528,11,50556,50556,11,50584,50584,11,50612,50612,11,50640,50640,11,50668,50668,11,50696,50696,11,50724,50724,11,50752,50752,11,50780,50780,11,50808,50808,11,50836,50836,11,50864,50864,11,50892,50892,11,50920,50920,11,50948,50948,11,50976,50976,11,51004,51004,11,51032,51032,11,51060,51060,11,51088,51088,11,51116,51116,11,51144,51144,11,51172,51172,11,51200,51200,11,51228,51228,11,51256,51256,11,51284,51284,11,51312,51312,11,51340,51340,11,51368,51368,11,51396,51396,11,51424,51424,11,51452,51452,11,51480,51480,11,51508,51508,11,51536,51536,11,51564,51564,11,51592,51592,11,51620,51620,11,51648,51648,11,51676,51676,11,51704,51704,11,51732,51732,11,51760,51760,11,51788,51788,11,51816,51816,11,51844,51844,11,51872,51872,11,51900,51900,11,51928,51928,11,51956,51956,11,51984,51984,11,52012,52012,11,52040,52040,11,52068,52068,11,52096,52096,11,52124,52124,11,52152,52152,11,52180,52180,11,52208,52208,11,52236,52236,11,52264,52264,11,52292,52292,11,52320,52320,11,52348,52348,11,52376,52376,11,52404,52404,11,52432,52432,11,52460,52460,11,52488,52488,11,52516,52516,11,52544,52544,11,52572,52572,11,52600,52600,11,52628,52628,11,52656,52656,11,52684,52684,11,52712,52712,11,52740,52740,11,52768,52768,11,52796,52796,11,52824,52824,11,52852,52852,11,52880,52880,11,52908,52908,11,52936,52936,11,52964,52964,11,52992,52992,11,53020,53020,11,53048,53048,11,53076,53076,11,53104,53104,11,53132,53132,11,53160,53160,11,53188,53188,11,53216,53216,11,53244,53244,11,53272,53272,11,53300,53300,11,53328,53328,11,53356,53356,11,53384,53384,11,53412,53412,11,53440,53440,11,53468,53468,11,53496,53496,11,53524,53524,11,53552,53552,11,53580,53580,11,53608,53608,11,53636,53636,11,53664,53664,11,53692,53692,11,53720,53720,11,53748,53748,11,53776,53776,11,53804,53804,11,53832,53832,11,53860,53860,11,53888,53888,11,53916,53916,11,53944,53944,11,53972,53972,11,54000,54000,11,54028,54028,11,54056,54056,11,54084,54084,11,54112,54112,11,54140,54140,11,54168,54168,11,54196,54196,11,54224,54224,11,54252,54252,11,54280,54280,11,54308,54308,11,54336,54336,11,54364,54364,11,54392,54392,11,54420,54420,11,54448,54448,11,54476,54476,11,54504,54504,11,54532,54532,11,54560,54560,11,54588,54588,11,54616,54616,11,54644,54644,11,54672,54672,11,54700,54700,11,54728,54728,11,54756,54756,11,54784,54784,11,54812,54812,11,54840,54840,11,54868,54868,11,54896,54896,11,54924,54924,11,54952,54952,11,54980,54980,11,55008,55008,11,55036,55036,11,55064,55064,11,55092,55092,11,55120,55120,11,55148,55148,11,55176,55176,11,55216,55238,9,64286,64286,5,65056,65071,5,65438,65439,5,65529,65531,4,66272,66272,5,68097,68099,5,68108,68111,5,68159,68159,5,68900,68903,5,69446,69456,5,69632,69632,7,69634,69634,7,69744,69744,5,69759,69761,5,69808,69810,7,69815,69816,7,69821,69821,1,69837,69837,1,69927,69931,5,69933,69940,5,70003,70003,5,70018,70018,7,70070,70078,5,70082,70083,1,70094,70094,7,70188,70190,7,70194,70195,7,70197,70197,7,70206,70206,5,70368,70370,7,70400,70401,5,70459,70460,5,70463,70463,7,70465,70468,7,70475,70477,7,70498,70499,7,70512,70516,5,70712,70719,5,70722,70724,5,70726,70726,5,70832,70832,5,70835,70840,5,70842,70842,5,70845,70845,5,70847,70848,5,70850,70851,5,71088,71089,7,71096,71099,7,71102,71102,7,71132,71133,5,71219,71226,5,71229,71229,5,71231,71232,5,71340,71340,7,71342,71343,7,71350,71350,7,71453,71455,5,71462,71462,7,71724,71726,7,71736,71736,7,71984,71984,5,71991,71992,7,71997,71997,7,71999,71999,1,72001,72001,1,72003,72003,5,72148,72151,5,72156,72159,7,72164,72164,7,72243,72248,5,72250,72250,1,72263,72263,5,72279,72280,7,72324,72329,1,72343,72343,7,72751,72751,7,72760,72765,5,72767,72767,5,72873,72873,7,72881,72881,7,72884,72884,7,73009,73014,5,73020,73021,5,73030,73030,1,73098,73102,7,73107,73108,7,73110,73110,7,73459,73460,5,78896,78904,4,92976,92982,5,94033,94087,7,94180,94180,5,113821,113822,5,118528,118573,5,119141,119141,5,119143,119145,5,119150,119154,5,119163,119170,5,119210,119213,5,121344,121398,5,121461,121461,5,121499,121503,5,122880,122886,5,122907,122913,5,122918,122922,5,123566,123566,5,125136,125142,5,126976,126979,14,126981,127182,14,127184,127231,14,127279,127279,14,127344,127345,14,127374,127374,14,127405,127461,14,127489,127490,14,127514,127514,14,127538,127546,14,127561,127567,14,127570,127743,14,127757,127758,14,127760,127760,14,127762,127762,14,127766,127768,14,127770,127770,14,127772,127772,14,127775,127776,14,127778,127779,14,127789,127791,14,127794,127795,14,127798,127798,14,127819,127819,14,127824,127824,14,127868,127868,14,127870,127871,14,127892,127893,14,127896,127896,14,127900,127901,14,127904,127940,14,127942,127942,14,127944,127944,14,127946,127946,14,127951,127955,14,127968,127971,14,127973,127984,14,127987,127987,14,127989,127989,14,127991,127991,14,127995,127999,5,128008,128008,14,128012,128014,14,128017,128018,14,128020,128020,14,128022,128022,14,128042,128042,14,128063,128063,14,128065,128065,14,128101,128101,14,128108,128109,14,128173,128173,14,128182,128183,14,128236,128237,14,128239,128239,14,128245,128245,14,128248,128248,14,128253,128253,14,128255,128258,14,128260,128263,14,128265,128265,14,128277,128277,14,128300,128301,14,128326,128328,14,128331,128334,14,128336,128347,14,128360,128366,14,128369,128370,14,128378,128378,14,128391,128391,14,128394,128397,14,128400,128400,14,128405,128406,14,128420,128420,14,128422,128423,14,128425,128432,14,128435,128443,14,128445,128449,14,128453,128464,14,128468,128475,14,128479,128480,14,128482,128482,14,128484,128487,14,128489,128494,14,128496,128498,14,128500,128505,14,128507,128511,14,128513,128518,14,128521,128525,14,128527,128527,14,128529,128529,14,128533,128533,14,128535,128535,14,128537,128537,14]")}s(YVt,"getGraphemeBreakRawData");var mXe=class t{constructor(e){this.confusableDictionary=e}static{s(this,"AmbiguousCharacters")}static{this.ambiguousCharacterData=new Mh(()=>JSON.parse('{"_common":[8232,32,8233,32,5760,32,8192,32,8193,32,8194,32,8195,32,8196,32,8197,32,8198,32,8200,32,8201,32,8202,32,8287,32,8199,32,8239,32,2042,95,65101,95,65102,95,65103,95,8208,45,8209,45,8210,45,65112,45,1748,45,8259,45,727,45,8722,45,10134,45,11450,45,1549,44,1643,44,8218,44,184,44,42233,44,894,59,2307,58,2691,58,1417,58,1795,58,1796,58,5868,58,65072,58,6147,58,6153,58,8282,58,1475,58,760,58,42889,58,8758,58,720,58,42237,58,451,33,11601,33,660,63,577,63,2429,63,5038,63,42731,63,119149,46,8228,46,1793,46,1794,46,42510,46,68176,46,1632,46,1776,46,42232,46,1373,96,65287,96,8219,96,8242,96,1370,96,1523,96,8175,96,65344,96,900,96,8189,96,8125,96,8127,96,8190,96,697,96,884,96,712,96,714,96,715,96,756,96,699,96,701,96,700,96,702,96,42892,96,1497,96,2036,96,2037,96,5194,96,5836,96,94033,96,94034,96,65339,91,10088,40,10098,40,12308,40,64830,40,65341,93,10089,41,10099,41,12309,41,64831,41,10100,123,119060,123,10101,125,65342,94,8270,42,1645,42,8727,42,66335,42,5941,47,8257,47,8725,47,8260,47,9585,47,10187,47,10744,47,119354,47,12755,47,12339,47,11462,47,20031,47,12035,47,65340,92,65128,92,8726,92,10189,92,10741,92,10745,92,119311,92,119355,92,12756,92,20022,92,12034,92,42872,38,708,94,710,94,5869,43,10133,43,66203,43,8249,60,10094,60,706,60,119350,60,5176,60,5810,60,5120,61,11840,61,12448,61,42239,61,8250,62,10095,62,707,62,119351,62,5171,62,94015,62,8275,126,732,126,8128,126,8764,126,65372,124,65293,45,120784,50,120794,50,120804,50,120814,50,120824,50,130034,50,42842,50,423,50,1000,50,42564,50,5311,50,42735,50,119302,51,120785,51,120795,51,120805,51,120815,51,120825,51,130035,51,42923,51,540,51,439,51,42858,51,11468,51,1248,51,94011,51,71882,51,120786,52,120796,52,120806,52,120816,52,120826,52,130036,52,5070,52,71855,52,120787,53,120797,53,120807,53,120817,53,120827,53,130037,53,444,53,71867,53,120788,54,120798,54,120808,54,120818,54,120828,54,130038,54,11474,54,5102,54,71893,54,119314,55,120789,55,120799,55,120809,55,120819,55,120829,55,130039,55,66770,55,71878,55,2819,56,2538,56,2666,56,125131,56,120790,56,120800,56,120810,56,120820,56,120830,56,130040,56,547,56,546,56,66330,56,2663,57,2920,57,2541,57,3437,57,120791,57,120801,57,120811,57,120821,57,120831,57,130041,57,42862,57,11466,57,71884,57,71852,57,71894,57,9082,97,65345,97,119834,97,119886,97,119938,97,119990,97,120042,97,120094,97,120146,97,120198,97,120250,97,120302,97,120354,97,120406,97,120458,97,593,97,945,97,120514,97,120572,97,120630,97,120688,97,120746,97,65313,65,119808,65,119860,65,119912,65,119964,65,120016,65,120068,65,120120,65,120172,65,120224,65,120276,65,120328,65,120380,65,120432,65,913,65,120488,65,120546,65,120604,65,120662,65,120720,65,5034,65,5573,65,42222,65,94016,65,66208,65,119835,98,119887,98,119939,98,119991,98,120043,98,120095,98,120147,98,120199,98,120251,98,120303,98,120355,98,120407,98,120459,98,388,98,5071,98,5234,98,5551,98,65314,66,8492,66,119809,66,119861,66,119913,66,120017,66,120069,66,120121,66,120173,66,120225,66,120277,66,120329,66,120381,66,120433,66,42932,66,914,66,120489,66,120547,66,120605,66,120663,66,120721,66,5108,66,5623,66,42192,66,66178,66,66209,66,66305,66,65347,99,8573,99,119836,99,119888,99,119940,99,119992,99,120044,99,120096,99,120148,99,120200,99,120252,99,120304,99,120356,99,120408,99,120460,99,7428,99,1010,99,11429,99,43951,99,66621,99,128844,67,71922,67,71913,67,65315,67,8557,67,8450,67,8493,67,119810,67,119862,67,119914,67,119966,67,120018,67,120174,67,120226,67,120278,67,120330,67,120382,67,120434,67,1017,67,11428,67,5087,67,42202,67,66210,67,66306,67,66581,67,66844,67,8574,100,8518,100,119837,100,119889,100,119941,100,119993,100,120045,100,120097,100,120149,100,120201,100,120253,100,120305,100,120357,100,120409,100,120461,100,1281,100,5095,100,5231,100,42194,100,8558,68,8517,68,119811,68,119863,68,119915,68,119967,68,120019,68,120071,68,120123,68,120175,68,120227,68,120279,68,120331,68,120383,68,120435,68,5024,68,5598,68,5610,68,42195,68,8494,101,65349,101,8495,101,8519,101,119838,101,119890,101,119942,101,120046,101,120098,101,120150,101,120202,101,120254,101,120306,101,120358,101,120410,101,120462,101,43826,101,1213,101,8959,69,65317,69,8496,69,119812,69,119864,69,119916,69,120020,69,120072,69,120124,69,120176,69,120228,69,120280,69,120332,69,120384,69,120436,69,917,69,120492,69,120550,69,120608,69,120666,69,120724,69,11577,69,5036,69,42224,69,71846,69,71854,69,66182,69,119839,102,119891,102,119943,102,119995,102,120047,102,120099,102,120151,102,120203,102,120255,102,120307,102,120359,102,120411,102,120463,102,43829,102,42905,102,383,102,7837,102,1412,102,119315,70,8497,70,119813,70,119865,70,119917,70,120021,70,120073,70,120125,70,120177,70,120229,70,120281,70,120333,70,120385,70,120437,70,42904,70,988,70,120778,70,5556,70,42205,70,71874,70,71842,70,66183,70,66213,70,66853,70,65351,103,8458,103,119840,103,119892,103,119944,103,120048,103,120100,103,120152,103,120204,103,120256,103,120308,103,120360,103,120412,103,120464,103,609,103,7555,103,397,103,1409,103,119814,71,119866,71,119918,71,119970,71,120022,71,120074,71,120126,71,120178,71,120230,71,120282,71,120334,71,120386,71,120438,71,1292,71,5056,71,5107,71,42198,71,65352,104,8462,104,119841,104,119945,104,119997,104,120049,104,120101,104,120153,104,120205,104,120257,104,120309,104,120361,104,120413,104,120465,104,1211,104,1392,104,5058,104,65320,72,8459,72,8460,72,8461,72,119815,72,119867,72,119919,72,120023,72,120179,72,120231,72,120283,72,120335,72,120387,72,120439,72,919,72,120494,72,120552,72,120610,72,120668,72,120726,72,11406,72,5051,72,5500,72,42215,72,66255,72,731,105,9075,105,65353,105,8560,105,8505,105,8520,105,119842,105,119894,105,119946,105,119998,105,120050,105,120102,105,120154,105,120206,105,120258,105,120310,105,120362,105,120414,105,120466,105,120484,105,618,105,617,105,953,105,8126,105,890,105,120522,105,120580,105,120638,105,120696,105,120754,105,1110,105,42567,105,1231,105,43893,105,5029,105,71875,105,65354,106,8521,106,119843,106,119895,106,119947,106,119999,106,120051,106,120103,106,120155,106,120207,106,120259,106,120311,106,120363,106,120415,106,120467,106,1011,106,1112,106,65322,74,119817,74,119869,74,119921,74,119973,74,120025,74,120077,74,120129,74,120181,74,120233,74,120285,74,120337,74,120389,74,120441,74,42930,74,895,74,1032,74,5035,74,5261,74,42201,74,119844,107,119896,107,119948,107,120000,107,120052,107,120104,107,120156,107,120208,107,120260,107,120312,107,120364,107,120416,107,120468,107,8490,75,65323,75,119818,75,119870,75,119922,75,119974,75,120026,75,120078,75,120130,75,120182,75,120234,75,120286,75,120338,75,120390,75,120442,75,922,75,120497,75,120555,75,120613,75,120671,75,120729,75,11412,75,5094,75,5845,75,42199,75,66840,75,1472,108,8739,73,9213,73,65512,73,1633,108,1777,73,66336,108,125127,108,120783,73,120793,73,120803,73,120813,73,120823,73,130033,73,65321,73,8544,73,8464,73,8465,73,119816,73,119868,73,119920,73,120024,73,120128,73,120180,73,120232,73,120284,73,120336,73,120388,73,120440,73,65356,108,8572,73,8467,108,119845,108,119897,108,119949,108,120001,108,120053,108,120105,73,120157,73,120209,73,120261,73,120313,73,120365,73,120417,73,120469,73,448,73,120496,73,120554,73,120612,73,120670,73,120728,73,11410,73,1030,73,1216,73,1493,108,1503,108,1575,108,126464,108,126592,108,65166,108,65165,108,1994,108,11599,73,5825,73,42226,73,93992,73,66186,124,66313,124,119338,76,8556,76,8466,76,119819,76,119871,76,119923,76,120027,76,120079,76,120131,76,120183,76,120235,76,120287,76,120339,76,120391,76,120443,76,11472,76,5086,76,5290,76,42209,76,93974,76,71843,76,71858,76,66587,76,66854,76,65325,77,8559,77,8499,77,119820,77,119872,77,119924,77,120028,77,120080,77,120132,77,120184,77,120236,77,120288,77,120340,77,120392,77,120444,77,924,77,120499,77,120557,77,120615,77,120673,77,120731,77,1018,77,11416,77,5047,77,5616,77,5846,77,42207,77,66224,77,66321,77,119847,110,119899,110,119951,110,120003,110,120055,110,120107,110,120159,110,120211,110,120263,110,120315,110,120367,110,120419,110,120471,110,1400,110,1404,110,65326,78,8469,78,119821,78,119873,78,119925,78,119977,78,120029,78,120081,78,120185,78,120237,78,120289,78,120341,78,120393,78,120445,78,925,78,120500,78,120558,78,120616,78,120674,78,120732,78,11418,78,42208,78,66835,78,3074,111,3202,111,3330,111,3458,111,2406,111,2662,111,2790,111,3046,111,3174,111,3302,111,3430,111,3664,111,3792,111,4160,111,1637,111,1781,111,65359,111,8500,111,119848,111,119900,111,119952,111,120056,111,120108,111,120160,111,120212,111,120264,111,120316,111,120368,111,120420,111,120472,111,7439,111,7441,111,43837,111,959,111,120528,111,120586,111,120644,111,120702,111,120760,111,963,111,120532,111,120590,111,120648,111,120706,111,120764,111,11423,111,4351,111,1413,111,1505,111,1607,111,126500,111,126564,111,126596,111,65259,111,65260,111,65258,111,65257,111,1726,111,64428,111,64429,111,64427,111,64426,111,1729,111,64424,111,64425,111,64423,111,64422,111,1749,111,3360,111,4125,111,66794,111,71880,111,71895,111,66604,111,1984,79,2534,79,2918,79,12295,79,70864,79,71904,79,120782,79,120792,79,120802,79,120812,79,120822,79,130032,79,65327,79,119822,79,119874,79,119926,79,119978,79,120030,79,120082,79,120134,79,120186,79,120238,79,120290,79,120342,79,120394,79,120446,79,927,79,120502,79,120560,79,120618,79,120676,79,120734,79,11422,79,1365,79,11604,79,4816,79,2848,79,66754,79,42227,79,71861,79,66194,79,66219,79,66564,79,66838,79,9076,112,65360,112,119849,112,119901,112,119953,112,120005,112,120057,112,120109,112,120161,112,120213,112,120265,112,120317,112,120369,112,120421,112,120473,112,961,112,120530,112,120544,112,120588,112,120602,112,120646,112,120660,112,120704,112,120718,112,120762,112,120776,112,11427,112,65328,80,8473,80,119823,80,119875,80,119927,80,119979,80,120031,80,120083,80,120187,80,120239,80,120291,80,120343,80,120395,80,120447,80,929,80,120504,80,120562,80,120620,80,120678,80,120736,80,11426,80,5090,80,5229,80,42193,80,66197,80,119850,113,119902,113,119954,113,120006,113,120058,113,120110,113,120162,113,120214,113,120266,113,120318,113,120370,113,120422,113,120474,113,1307,113,1379,113,1382,113,8474,81,119824,81,119876,81,119928,81,119980,81,120032,81,120084,81,120188,81,120240,81,120292,81,120344,81,120396,81,120448,81,11605,81,119851,114,119903,114,119955,114,120007,114,120059,114,120111,114,120163,114,120215,114,120267,114,120319,114,120371,114,120423,114,120475,114,43847,114,43848,114,7462,114,11397,114,43905,114,119318,82,8475,82,8476,82,8477,82,119825,82,119877,82,119929,82,120033,82,120189,82,120241,82,120293,82,120345,82,120397,82,120449,82,422,82,5025,82,5074,82,66740,82,5511,82,42211,82,94005,82,65363,115,119852,115,119904,115,119956,115,120008,115,120060,115,120112,115,120164,115,120216,115,120268,115,120320,115,120372,115,120424,115,120476,115,42801,115,445,115,1109,115,43946,115,71873,115,66632,115,65331,83,119826,83,119878,83,119930,83,119982,83,120034,83,120086,83,120138,83,120190,83,120242,83,120294,83,120346,83,120398,83,120450,83,1029,83,1359,83,5077,83,5082,83,42210,83,94010,83,66198,83,66592,83,119853,116,119905,116,119957,116,120009,116,120061,116,120113,116,120165,116,120217,116,120269,116,120321,116,120373,116,120425,116,120477,116,8868,84,10201,84,128872,84,65332,84,119827,84,119879,84,119931,84,119983,84,120035,84,120087,84,120139,84,120191,84,120243,84,120295,84,120347,84,120399,84,120451,84,932,84,120507,84,120565,84,120623,84,120681,84,120739,84,11430,84,5026,84,42196,84,93962,84,71868,84,66199,84,66225,84,66325,84,119854,117,119906,117,119958,117,120010,117,120062,117,120114,117,120166,117,120218,117,120270,117,120322,117,120374,117,120426,117,120478,117,42911,117,7452,117,43854,117,43858,117,651,117,965,117,120534,117,120592,117,120650,117,120708,117,120766,117,1405,117,66806,117,71896,117,8746,85,8899,85,119828,85,119880,85,119932,85,119984,85,120036,85,120088,85,120140,85,120192,85,120244,85,120296,85,120348,85,120400,85,120452,85,1357,85,4608,85,66766,85,5196,85,42228,85,94018,85,71864,85,8744,118,8897,118,65366,118,8564,118,119855,118,119907,118,119959,118,120011,118,120063,118,120115,118,120167,118,120219,118,120271,118,120323,118,120375,118,120427,118,120479,118,7456,118,957,118,120526,118,120584,118,120642,118,120700,118,120758,118,1141,118,1496,118,71430,118,43945,118,71872,118,119309,86,1639,86,1783,86,8548,86,119829,86,119881,86,119933,86,119985,86,120037,86,120089,86,120141,86,120193,86,120245,86,120297,86,120349,86,120401,86,120453,86,1140,86,11576,86,5081,86,5167,86,42719,86,42214,86,93960,86,71840,86,66845,86,623,119,119856,119,119908,119,119960,119,120012,119,120064,119,120116,119,120168,119,120220,119,120272,119,120324,119,120376,119,120428,119,120480,119,7457,119,1121,119,1309,119,1377,119,71434,119,71438,119,71439,119,43907,119,71919,87,71910,87,119830,87,119882,87,119934,87,119986,87,120038,87,120090,87,120142,87,120194,87,120246,87,120298,87,120350,87,120402,87,120454,87,1308,87,5043,87,5076,87,42218,87,5742,120,10539,120,10540,120,10799,120,65368,120,8569,120,119857,120,119909,120,119961,120,120013,120,120065,120,120117,120,120169,120,120221,120,120273,120,120325,120,120377,120,120429,120,120481,120,5441,120,5501,120,5741,88,9587,88,66338,88,71916,88,65336,88,8553,88,119831,88,119883,88,119935,88,119987,88,120039,88,120091,88,120143,88,120195,88,120247,88,120299,88,120351,88,120403,88,120455,88,42931,88,935,88,120510,88,120568,88,120626,88,120684,88,120742,88,11436,88,11613,88,5815,88,42219,88,66192,88,66228,88,66327,88,66855,88,611,121,7564,121,65369,121,119858,121,119910,121,119962,121,120014,121,120066,121,120118,121,120170,121,120222,121,120274,121,120326,121,120378,121,120430,121,120482,121,655,121,7935,121,43866,121,947,121,8509,121,120516,121,120574,121,120632,121,120690,121,120748,121,1199,121,4327,121,71900,121,65337,89,119832,89,119884,89,119936,89,119988,89,120040,89,120092,89,120144,89,120196,89,120248,89,120300,89,120352,89,120404,89,120456,89,933,89,978,89,120508,89,120566,89,120624,89,120682,89,120740,89,11432,89,1198,89,5033,89,5053,89,42220,89,94019,89,71844,89,66226,89,119859,122,119911,122,119963,122,120015,122,120067,122,120119,122,120171,122,120223,122,120275,122,120327,122,120379,122,120431,122,120483,122,7458,122,43923,122,71876,122,66293,90,71909,90,65338,90,8484,90,8488,90,119833,90,119885,90,119937,90,119989,90,120041,90,120197,90,120249,90,120301,90,120353,90,120405,90,120457,90,918,90,120493,90,120551,90,120609,90,120667,90,120725,90,5059,90,42204,90,71849,90,65282,34,65284,36,65285,37,65286,38,65290,42,65291,43,65294,46,65295,47,65296,48,65297,49,65298,50,65299,51,65300,52,65301,53,65302,54,65303,55,65304,56,65305,57,65308,60,65309,61,65310,62,65312,64,65316,68,65318,70,65319,71,65324,76,65329,81,65330,82,65333,85,65334,86,65335,87,65343,95,65346,98,65348,100,65350,102,65355,107,65357,109,65358,110,65361,113,65362,114,65364,116,65365,117,65367,119,65370,122,65371,123,65373,125,119846,109],"_default":[160,32,8211,45,65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"cs":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"de":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"es":[8211,45,65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"fr":[65374,126,65306,58,65281,33,8216,96,8245,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"it":[160,32,8211,45,65374,126,65306,58,65281,33,8216,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"ja":[8211,45,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65292,44,65307,59],"ko":[8211,45,65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"pl":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"pt-BR":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"qps-ploc":[160,32,8211,45,65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"ru":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,305,105,921,73,1009,112,215,120,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"tr":[160,32,8211,45,65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"zh-hans":[65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41],"zh-hant":[8211,45,65374,126,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65307,59]}'))}static{this.cache=new DZ({getCacheKey:JSON.stringify},e=>{function r(f){let p=new Map;for(let m=0;m<f.length;m+=2)p.set(f[m],f[m+1]);return p}s(r,"arrayToMap");function n(f,p){let m=new Map(f);for(let[h,g]of p)m.set(h,g);return m}s(n,"mergeMaps");function i(f,p){if(!f)return p;let m=new Map;for(let[h,g]of f)p.has(h)&&m.set(h,g);return m}s(i,"intersectMaps");let o=this.ambiguousCharacterData.value,a=e.filter(f=>!f.startsWith("_")&&f in o);a.length===0&&(a=["_default"]);let c;for(let f of a){let p=r(o[f]);c=i(c,p)}let l=r(o._common),u=n(l,c);return new t(u)})}static getInstance(e){return t.cache.get(Array.from(e))}static{this._locales=new Mh(()=>Object.keys(t.ambiguousCharacterData.value).filter(e=>!e.startsWith("_")))}static getLocales(){return t._locales.value}isAmbiguous(e){return this.confusableDictionary.has(e)}containsAmbiguousCharacter(e){for(let r=0;r<e.length;r++){let n=e.codePointAt(r);if(typeof n=="number"&&this.isAmbiguous(n))return!0}return!1}getPrimaryConfusable(e){return this.confusableDictionary.get(e)}getConfusableCodePoints(){return new Set(this.confusableDictionary.keys())}},hXe=class t{static{s(this,"InvisibleCharacters")}static getRawData(){return JSON.parse("[9,10,11,12,13,32,127,160,173,847,1564,4447,4448,6068,6069,6155,6156,6157,6158,7355,7356,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8203,8204,8205,8206,8207,8234,8235,8236,8237,8238,8239,8287,8288,8289,8290,8291,8292,8293,8294,8295,8296,8297,8298,8299,8300,8301,8302,8303,10240,12288,12644,65024,65025,65026,65027,65028,65029,65030,65031,65032,65033,65034,65035,65036,65037,65038,65039,65279,65440,65520,65521,65522,65523,65524,65525,65526,65527,65528,65532,78844,119155,119156,119157,119158,119159,119160,119161,119162,917504,917505,917506,917507,917508,917509,917510,917511,917512,917513,917514,917515,917516,917517,917518,917519,917520,917521,917522,917523,917524,917525,917526,917527,917528,917529,917530,917531,917532,917533,917534,917535,917536,917537,917538,917539,917540,917541,917542,917543,917544,917545,917546,917547,917548,917549,917550,917551,917552,917553,917554,917555,917556,917557,917558,917559,917560,917561,917562,917563,917564,917565,917566,917567,917568,917569,917570,917571,917572,917573,917574,917575,917576,917577,917578,917579,917580,917581,917582,917583,917584,917585,917586,917587,917588,917589,917590,917591,917592,917593,917594,917595,917596,917597,917598,917599,917600,917601,917602,917603,917604,917605,917606,917607,917608,917609,917610,917611,917612,917613,917614,917615,917616,917617,917618,917619,917620,917621,917622,917623,917624,917625,917626,917627,917628,917629,917630,917631,917760,917761,917762,917763,917764,917765,917766,917767,917768,917769,917770,917771,917772,917773,917774,917775,917776,917777,917778,917779,917780,917781,917782,917783,917784,917785,917786,917787,917788,917789,917790,917791,917792,917793,917794,917795,917796,917797,917798,917799,917800,917801,917802,917803,917804,917805,917806,917807,917808,917809,917810,917811,917812,917813,917814,917815,917816,917817,917818,917819,917820,917821,917822,917823,917824,917825,917826,917827,917828,917829,917830,917831,917832,917833,917834,917835,917836,917837,917838,917839,917840,917841,917842,917843,917844,917845,917846,917847,917848,917849,917850,917851,917852,917853,917854,917855,917856,917857,917858,917859,917860,917861,917862,917863,917864,917865,917866,917867,917868,917869,917870,917871,917872,917873,917874,917875,917876,917877,917878,917879,917880,917881,917882,917883,917884,917885,917886,917887,917888,917889,917890,917891,917892,917893,917894,917895,917896,917897,917898,917899,917900,917901,917902,917903,917904,917905,917906,917907,917908,917909,917910,917911,917912,917913,917914,917915,917916,917917,917918,917919,917920,917921,917922,917923,917924,917925,917926,917927,917928,917929,917930,917931,917932,917933,917934,917935,917936,917937,917938,917939,917940,917941,917942,917943,917944,917945,917946,917947,917948,917949,917950,917951,917952,917953,917954,917955,917956,917957,917958,917959,917960,917961,917962,917963,917964,917965,917966,917967,917968,917969,917970,917971,917972,917973,917974,917975,917976,917977,917978,917979,917980,917981,917982,917983,917984,917985,917986,917987,917988,917989,917990,917991,917992,917993,917994,917995,917996,917997,917998,917999]")}static{this._data=void 0}static getData(){return this._data||(this._data=new Set(t.getRawData())),this._data}static isInvisibleCharacter(e){return t.getData().has(e)}static containsInvisibleCharacter(e){for(let r=0;r<e.length;r++){let n=e.codePointAt(r);if(typeof n=="number"&&t.isInvisibleCharacter(n))return!0}return!1}static get codePoints(){return t.getData()}};d();var Vt=class t{constructor(e,r){this.start=e;this.endExclusive=r;if(e>r)throw new xn(`Invalid range: ${this.toString()}`)}static{s(this,"OffsetRange")}static fromTo(e,r){return new t(e,r)}static addRange(e,r){let n=0;for(;n<r.length&&r[n].endExclusive<e.start;)n++;let i=n;for(;i<r.length&&r[i].start<=e.endExclusive;)i++;if(n===i)r.splice(n,0,e);else{let o=Math.min(e.start,r[n].start),a=Math.max(e.endExclusive,r[i-1].endExclusive);r.splice(n,i-n,new t(o,a))}}static tryCreate(e,r){if(!(e>r))return new t(e,r)}static ofLength(e){return new t(0,e)}static ofStartAndLength(e,r){return new t(e,e+r)}static emptyAt(e){return new t(e,e)}get isEmpty(){return this.start===this.endExclusive}delta(e){return new t(this.start+e,this.endExclusive+e)}deltaStart(e){return new t(this.start+e,this.endExclusive)}deltaEnd(e){return new t(this.start,this.endExclusive+e)}get length(){return this.endExclusive-this.start}toString(){return`[${this.start}, ${this.endExclusive})`}equals(e){return this.start===e.start&&this.endExclusive===e.endExclusive}containsRange(e){return this.start<=e.start&&e.endExclusive<=this.endExclusive}contains(e){return this.start<=e&&e<this.endExclusive}join(e){return new t(Math.min(this.start,e.start),Math.max(this.endExclusive,e.endExclusive))}intersect(e){let r=Math.max(this.start,e.start),n=Math.min(this.endExclusive,e.endExclusive);if(r<=n)return new t(r,n)}intersectionLength(e){let r=Math.max(this.start,e.start),n=Math.min(this.endExclusive,e.endExclusive);return Math.max(0,n-r)}intersects(e){let r=Math.max(this.start,e.start),n=Math.min(this.endExclusive,e.endExclusive);return r<n}intersectsOrTouches(e){let r=Math.max(this.start,e.start),n=Math.min(this.endExclusive,e.endExclusive);return r<=n}isBefore(e){return this.endExclusive<=e.start}isAfter(e){return this.start>=e.endExclusive}slice(e){return e.slice(this.start,this.endExclusive)}substring(e){return e.substring(this.start,this.endExclusive)}clip(e){if(this.isEmpty)throw new xn(`Invalid clipping range: ${this.toString()}`);return Math.max(this.start,Math.min(this.endExclusive-1,e))}clipCyclic(e){if(this.isEmpty)throw new xn(`Invalid clipping range: ${this.toString()}`);return e<this.start?this.endExclusive-(this.start-e)%this.length:e>=this.endExclusive?this.start+(e-this.start)%this.length:e}map(e){let r=[];for(let n=this.start;n<this.endExclusive;n++)r.push(e(n));return r}forEach(e){for(let r=this.start;r<this.endExclusive;r++)e(r)}joinRightTouching(e){if(this.endExclusive!==e.start)throw new xn(`Invalid join: ${this.toString()} and ${e.toString()}`);return new t(this.start,e.endExclusive)}};d();var Wr=class t{static{s(this,"Position")}constructor(e,r){this.lineNumber=e,this.column=r}with(e=this.lineNumber,r=this.column){return e===this.lineNumber&&r===this.column?this:new t(e,r)}delta(e=0,r=0){return this.with(this.lineNumber+e,this.column+r)}equals(e){return t.equals(this,e)}static equals(e,r){return!e&&!r?!0:!!e&&!!r&&e.lineNumber===r.lineNumber&&e.column===r.column}isBefore(e){return t.isBefore(this,e)}static isBefore(e,r){return e.lineNumber<r.lineNumber?!0:r.lineNumber<e.lineNumber?!1:e.column<r.column}isBeforeOrEqual(e){return t.isBeforeOrEqual(this,e)}static isBeforeOrEqual(e,r){return e.lineNumber<r.lineNumber?!0:r.lineNumber<e.lineNumber?!1:e.column<=r.column}static compare(e,r){let n=e.lineNumber|0,i=r.lineNumber|0;if(n===i){let o=e.column|0,a=r.column|0;return o-a}return n-i}clone(){return new t(this.lineNumber,this.column)}toString(){return"("+this.lineNumber+","+this.column+")"}static lift(e){return new t(e.lineNumber,e.column)}static isIPosition(e){return e&&typeof e.lineNumber=="number"&&typeof e.column=="number"}toJSON(){return{lineNumber:this.lineNumber,column:this.column}}};d();var ir=class t{static{s(this,"Range")}constructor(e,r,n,i){e>n||e===n&&r>i?(this.startLineNumber=n,this.startColumn=i,this.endLineNumber=e,this.endColumn=r):(this.startLineNumber=e,this.startColumn=r,this.endLineNumber=n,this.endColumn=i)}isEmpty(){return t.isEmpty(this)}static isEmpty(e){return e.startLineNumber===e.endLineNumber&&e.startColumn===e.endColumn}containsPosition(e){return t.containsPosition(this,e)}static containsPosition(e,r){return!(r.lineNumber<e.startLineNumber||r.lineNumber>e.endLineNumber||r.lineNumber===e.startLineNumber&&r.column<e.startColumn||r.lineNumber===e.endLineNumber&&r.column>e.endColumn)}static strictContainsPosition(e,r){return!(r.lineNumber<e.startLineNumber||r.lineNumber>e.endLineNumber||r.lineNumber===e.startLineNumber&&r.column<=e.startColumn||r.lineNumber===e.endLineNumber&&r.column>=e.endColumn)}containsRange(e){return t.containsRange(this,e)}static containsRange(e,r){return!(r.startLineNumber<e.startLineNumber||r.endLineNumber<e.startLineNumber||r.startLineNumber>e.endLineNumber||r.endLineNumber>e.endLineNumber||r.startLineNumber===e.startLineNumber&&r.startColumn<e.startColumn||r.endLineNumber===e.endLineNumber&&r.endColumn>e.endColumn)}strictContainsRange(e){return t.strictContainsRange(this,e)}static strictContainsRange(e,r){return!(r.startLineNumber<e.startLineNumber||r.endLineNumber<e.startLineNumber||r.startLineNumber>e.endLineNumber||r.endLineNumber>e.endLineNumber||r.startLineNumber===e.startLineNumber&&r.startColumn<=e.startColumn||r.endLineNumber===e.endLineNumber&&r.endColumn>=e.endColumn)}plusRange(e){return t.plusRange(this,e)}static plusRange(e,r){let n,i,o,a;return r.startLineNumber<e.startLineNumber?(n=r.startLineNumber,i=r.startColumn):r.startLineNumber===e.startLineNumber?(n=r.startLineNumber,i=Math.min(r.startColumn,e.startColumn)):(n=e.startLineNumber,i=e.startColumn),r.endLineNumber>e.endLineNumber?(o=r.endLineNumber,a=r.endColumn):r.endLineNumber===e.endLineNumber?(o=r.endLineNumber,a=Math.max(r.endColumn,e.endColumn)):(o=e.endLineNumber,a=e.endColumn),new t(n,i,o,a)}intersectRanges(e){return t.intersectRanges(this,e)}static intersectRanges(e,r){let n=e.startLineNumber,i=e.startColumn,o=e.endLineNumber,a=e.endColumn,c=r.startLineNumber,l=r.startColumn,u=r.endLineNumber,f=r.endColumn;return n<c?(n=c,i=l):n===c&&(i=Math.max(i,l)),o>u?(o=u,a=f):o===u&&(a=Math.min(a,f)),n>o||n===o&&i>a?null:new t(n,i,o,a)}equalsRange(e){return t.equalsRange(this,e)}static equalsRange(e,r){return!e&&!r?!0:!!e&&!!r&&e.startLineNumber===r.startLineNumber&&e.startColumn===r.startColumn&&e.endLineNumber===r.endLineNumber&&e.endColumn===r.endColumn}getEndPosition(){return t.getEndPosition(this)}static getEndPosition(e){return new Wr(e.endLineNumber,e.endColumn)}getStartPosition(){return t.getStartPosition(this)}static getStartPosition(e){return new Wr(e.startLineNumber,e.startColumn)}toString(){return"["+this.startLineNumber+","+this.startColumn+" -> "+this.endLineNumber+","+this.endColumn+"]"}setEndPosition(e,r){return new t(this.startLineNumber,this.startColumn,e,r)}setStartPosition(e,r){return new t(e,r,this.endLineNumber,this.endColumn)}collapseToStart(){return t.collapseToStart(this)}static collapseToStart(e){return new t(e.startLineNumber,e.startColumn,e.startLineNumber,e.startColumn)}collapseToEnd(){return t.collapseToEnd(this)}static collapseToEnd(e){return new t(e.endLineNumber,e.endColumn,e.endLineNumber,e.endColumn)}delta(e){return new t(this.startLineNumber+e,this.startColumn,this.endLineNumber+e,this.endColumn)}isSingleLine(){return this.startLineNumber===this.endLineNumber}static fromPositions(e,r=e){return new t(e.lineNumber,e.column,r.lineNumber,r.column)}static lift(e){return e?new t(e.startLineNumber,e.startColumn,e.endLineNumber,e.endColumn):null}static isIRange(e){return e&&typeof e.startLineNumber=="number"&&typeof e.startColumn=="number"&&typeof e.endLineNumber=="number"&&typeof e.endColumn=="number"}static areIntersectingOrTouching(e,r){return!(e.endLineNumber<r.startLineNumber||e.endLineNumber===r.startLineNumber&&e.endColumn<r.startColumn||r.endLineNumber<e.startLineNumber||r.endLineNumber===e.startLineNumber&&r.endColumn<e.startColumn)}static areIntersecting(e,r){return!(e.endLineNumber<r.startLineNumber||e.endLineNumber===r.startLineNumber&&e.endColumn<=r.startColumn||r.endLineNumber<e.startLineNumber||r.endLineNumber===e.startLineNumber&&r.endColumn<=e.startColumn)}static compareRangesUsingStarts(e,r){if(e&&r){let o=e.startLineNumber|0,a=r.startLineNumber|0;if(o===a){let c=e.startColumn|0,l=r.startColumn|0;if(c===l){let u=e.endLineNumber|0,f=r.endLineNumber|0;if(u===f){let p=e.endColumn|0,m=r.endColumn|0;return p-m}return u-f}return c-l}return o-a}return(e?1:0)-(r?1:0)}static compareRangesUsingEnds(e,r){return e.endLineNumber===r.endLineNumber?e.endColumn===r.endColumn?e.startLineNumber===r.startLineNumber?e.startColumn-r.startColumn:e.startLineNumber-r.startLineNumber:e.endColumn-r.endColumn:e.endLineNumber-r.endLineNumber}static spansMultipleLines(e){return e.endLineNumber>e.startLineNumber}toJSON(){return this}};d();d();var jr=class t{static{s(this,"LineRange")}static ofLength(e,r){return new t(e,e+r)}static fromRange(e){return new t(e.startLineNumber,e.endLineNumber)}static fromRangeInclusive(e){return new t(e.startLineNumber,e.endLineNumber+1)}static{this.compareByStart=wh(e=>e.startLineNumber,Sh)}static subtract(e,r){return r?e.startLineNumber<r.startLineNumber&&r.endLineNumberExclusive<e.endLineNumberExclusive?[new t(e.startLineNumber,r.startLineNumber),new t(r.endLineNumberExclusive,e.endLineNumberExclusive)]:r.startLineNumber<=e.startLineNumber&&e.endLineNumberExclusive<=r.endLineNumberExclusive?[]:r.endLineNumberExclusive<e.endLineNumberExclusive?[new t(Math.max(r.endLineNumberExclusive,e.startLineNumber),e.endLineNumberExclusive)]:[new t(e.startLineNumber,Math.min(r.startLineNumber,e.endLineNumberExclusive))]:[e]}static joinMany(e){if(e.length===0)return[];let r=new BZ(e[0].slice());for(let n=1;n<e.length;n++)r=r.getUnion(new BZ(e[n].slice()));return r.ranges}static join(e){if(e.length===0)throw new xn("lineRanges cannot be empty");let r=e[0].startLineNumber,n=e[0].endLineNumberExclusive;for(let i=1;i<e.length;i++)r=Math.min(r,e[i].startLineNumber),n=Math.max(n,e[i].endLineNumberExclusive);return new t(r,n)}static deserialize(e){return new t(e[0],e[1])}constructor(e,r){if(e>r)throw new xn(`startLineNumber ${e} cannot be after endLineNumberExclusive ${r}`);this.startLineNumber=e,this.endLineNumberExclusive=r}contains(e){return this.startLineNumber<=e&&e<this.endLineNumberExclusive}containsRange(e){return this.startLineNumber<=e.startLineNumber&&e.endLineNumberExclusive<=this.endLineNumberExclusive}get isEmpty(){return this.startLineNumber===this.endLineNumberExclusive}delta(e){return new t(this.startLineNumber+e,this.endLineNumberExclusive+e)}deltaLength(e){return new t(this.startLineNumber,this.endLineNumberExclusive+e)}get length(){return this.endLineNumberExclusive-this.startLineNumber}join(e){return new t(Math.min(this.startLineNumber,e.startLineNumber),Math.max(this.endLineNumberExclusive,e.endLineNumberExclusive))}toString(){return`[${this.startLineNumber},${this.endLineNumberExclusive})`}intersect(e){let r=Math.max(this.startLineNumber,e.startLineNumber),n=Math.min(this.endLineNumberExclusive,e.endLineNumberExclusive);if(r<=n)return new t(r,n)}intersectsStrict(e){return this.startLineNumber<e.endLineNumberExclusive&&e.startLineNumber<this.endLineNumberExclusive}intersectsOrTouches(e){return this.startLineNumber<=e.endLineNumberExclusive&&e.startLineNumber<=this.endLineNumberExclusive}equals(e){return this.startLineNumber===e.startLineNumber&&this.endLineNumberExclusive===e.endLineNumberExclusive}toInclusiveRange(){return this.isEmpty?null:new ir(this.startLineNumber,1,this.endLineNumberExclusive-1,Number.MAX_SAFE_INTEGER)}toExclusiveRange(){return new ir(this.startLineNumber,1,this.endLineNumberExclusive,1)}mapToLineArray(e){let r=[];for(let n=this.startLineNumber;n<this.endLineNumberExclusive;n++)r.push(e(n));return r}forEach(e){for(let r=this.startLineNumber;r<this.endLineNumberExclusive;r++)e(r)}serialize(){return[this.startLineNumber,this.endLineNumberExclusive]}toOffsetRange(){return new Vt(this.startLineNumber-1,this.endLineNumberExclusive-1)}distanceToRange(e){return this.endLineNumberExclusive<=e.startLineNumber?e.startLineNumber-this.endLineNumberExclusive:e.endLineNumberExclusive<=this.startLineNumber?this.startLineNumber-e.endLineNumberExclusive:0}distanceToLine(e){return this.contains(e)?0:e<this.startLineNumber?this.startLineNumber-e:e-this.endLineNumberExclusive}addMargin(e,r){return new t(this.startLineNumber-e,this.endLineNumberExclusive+r)}},BZ=class t{constructor(e=[]){this._normalizedRanges=e}static{s(this,"LineRangeSet")}get ranges(){return this._normalizedRanges}addRange(e){if(e.length===0)return;let r=s3(this._normalizedRanges,i=>i.endLineNumberExclusive>=e.startLineNumber),n=RA(this._normalizedRanges,i=>i.startLineNumber<=e.endLineNumberExclusive)+1;if(r===n)this._normalizedRanges.splice(r,0,e);else if(r===n-1){let i=this._normalizedRanges[r];this._normalizedRanges[r]=i.join(e)}else{let i=this._normalizedRanges[r].join(this._normalizedRanges[n-1]).join(e);this._normalizedRanges.splice(r,n-r,i)}}contains(e){let r=ove(this._normalizedRanges,n=>n.startLineNumber<=e);return!!r&&r.endLineNumberExclusive>e}intersects(e){let r=ove(this._normalizedRanges,n=>n.startLineNumber<e.endLineNumberExclusive);return!!r&&r.endLineNumberExclusive>e.startLineNumber}getUnion(e){if(this._normalizedRanges.length===0)return e;if(e._normalizedRanges.length===0)return this;let r=[],n=0,i=0,o=null;for(;n<this._normalizedRanges.length||i<e._normalizedRanges.length;){let a=null;if(n<this._normalizedRanges.length&&i<e._normalizedRanges.length){let c=this._normalizedRanges[n],l=e._normalizedRanges[i];c.startLineNumber<l.startLineNumber?(a=c,n++):(a=l,i++)}else n<this._normalizedRanges.length?(a=this._normalizedRanges[n],n++):(a=e._normalizedRanges[i],i++);o===null?o=a:o.endLineNumberExclusive>=a.startLineNumber?o=new jr(o.startLineNumber,Math.max(o.endLineNumberExclusive,a.endLineNumberExclusive)):(r.push(o),o=a)}return o!==null&&r.push(o),new t(r)}subtractFrom(e){let r=s3(this._normalizedRanges,a=>a.endLineNumberExclusive>=e.startLineNumber),n=RA(this._normalizedRanges,a=>a.startLineNumber<=e.endLineNumberExclusive)+1;if(r===n)return new t([e]);let i=[],o=e.startLineNumber;for(let a=r;a<n;a++){let c=this._normalizedRanges[a];c.startLineNumber>o&&i.push(new jr(o,c.startLineNumber)),o=c.endLineNumberExclusive}return o<e.endLineNumberExclusive&&i.push(new jr(o,e.endLineNumberExclusive)),new t(i)}toString(){return this._normalizedRanges.map(e=>e.toString()).join(", ")}getIntersection(e){let r=[],n=0,i=0;for(;n<this._normalizedRanges.length&&i<e._normalizedRanges.length;){let o=this._normalizedRanges[n],a=e._normalizedRanges[i],c=o.intersect(a);c&&!c.isEmpty&&r.push(c),o.endLineNumberExclusive<a.endLineNumberExclusive?n++:i++}return new t(r)}getWithDelta(e){return new t(this._normalizedRanges.map(r=>r.delta(e)))}};var fu=class t{constructor(e,r){this.lineCount=e;this.columnCount=r}static{s(this,"TextLength")}static{this.zero=new t(0,0)}static lengthDiffNonNegative(e,r){return r.isLessThan(e)?t.zero:e.lineCount===r.lineCount?new t(0,r.columnCount-e.columnCount):new t(r.lineCount-e.lineCount,r.columnCount)}static betweenPositions(e,r){return e.lineNumber===r.lineNumber?new t(0,r.column-e.column):new t(r.lineNumber-e.lineNumber,r.column-1)}static fromPosition(e){return new t(e.lineNumber-1,e.column-1)}static ofRange(e){return t.betweenPositions(e.getStartPosition(),e.getEndPosition())}static ofText(e){let r=0,n=0;for(let i of e)i===`
`?(r++,n=0):n++;return new t(r,n)}isZero(){return this.lineCount===0&&this.columnCount===0}isLessThan(e){return this.lineCount!==e.lineCount?this.lineCount<e.lineCount:this.columnCount<e.columnCount}isGreaterThan(e){return this.lineCount!==e.lineCount?this.lineCount>e.lineCount:this.columnCount>e.columnCount}isGreaterThanOrEqualTo(e){return this.lineCount!==e.lineCount?this.lineCount>e.lineCount:this.columnCount>=e.columnCount}equals(e){return this.lineCount===e.lineCount&&this.columnCount===e.columnCount}compare(e){return this.lineCount!==e.lineCount?this.lineCount-e.lineCount:this.columnCount-e.columnCount}add(e){return e.lineCount===0?new t(this.lineCount,this.columnCount+e.columnCount):new t(this.lineCount+e.lineCount,e.columnCount)}createRange(e){return this.lineCount===0?new ir(e.lineNumber,e.column,e.lineNumber,e.column+this.columnCount):new ir(e.lineNumber,e.column,e.lineNumber+this.lineCount,this.columnCount+1)}toRange(){return new ir(1,1,this.lineCount+1,this.columnCount+1)}toLineRange(){return jr.ofLength(1,this.lineCount)}addToPosition(e){return this.lineCount===0?new Wr(e.lineNumber,e.column+this.columnCount):new Wr(e.lineNumber+this.lineCount,this.columnCount+1)}addToRange(e){return ir.fromPositions(this.addToPosition(e.getStartPosition()),this.addToPosition(e.getEndPosition()))}toString(){return`${this.lineCount},${this.columnCount}`}};var pu=class t{constructor(e){this.value=e}static{s(this,"StringValue")}apply(e){return new t(e.apply(this.value))}equals(e){return this.value===e.value}getTransformer(){return this._transformer||(this._transformer=new Wxe(this.value)),this._transformer}getValueOfRange(e){return this.getTransformer().getOffsetRange(e).substring(this.value)}getLines(){return Lh(this.value)}getLineAt(e){return this.getLines()[e-1]}toString(){return this.value}getTextLength(){return this.getTransformer().textLength}},Wxe=class{constructor(e){this.text=e;this.lineStartOffsetByLineIdx=[],this.lineEndOffsetByLineIdx=[],this.lineStartOffsetByLineIdx.push(0);for(let r=0;r<e.length;r++)e.charAt(r)===`
`&&(this.lineStartOffsetByLineIdx.push(r+1),r>0&&e.charAt(r-1)==="\r"?this.lineEndOffsetByLineIdx.push(r-1):this.lineEndOffsetByLineIdx.push(r));this.lineEndOffsetByLineIdx.push(e.length)}static{s(this,"PositionOffsetTransformer")}getOffset(e){return this.lineStartOffsetByLineIdx[e.lineNumber-1]+e.column-1}getOffsetRange(e){return new Vt(this.getOffset(e.getStartPosition()),this.getOffset(e.getEndPosition()))}getPosition(e){let r=RA(this.lineStartOffsetByLineIdx,o=>o<=e),n=r+1,i=e-this.lineStartOffsetByLineIdx[r]+1;return new Wr(n,i)}getRange(e){return ir.fromPositions(this.getPosition(e.start),this.getPosition(e.endExclusive))}getTextLength(e){return fu.ofRange(this.getRange(e))}get textLength(){let e=this.lineStartOffsetByLineIdx.length-1;return new fu(e,this.text.length-this.lineStartOffsetByLineIdx[e])}getLineLength(e){return this.lineEndOffsetByLineIdx[e-1]-this.lineStartOffsetByLineIdx[e-1]}};var LA=class{static{s(this,"ObservableWorkspace")}getDocument(e){return Promise.resolve(this.openDocuments.get().find(r=>r.id===e))}};var NZ=class extends Rs{constructor(r,n,i,o,a,c){super();this.id=r;this.workspaceRoot=c;this.value=MA(this,n),this.selection=MA(this,i),this.languageId=MA(this,o),this._register(Qc(a))}static{s(this,"MutableObservableDocument")}applyEdit(r,n=void 0){let i=this.value.get().apply(r);this.value.set(i,n,r)}updateSelection(r,n=void 0){this.selection.set(r,n)}};d();d();function Mx(t,e,r){let n=new Map(Object.entries(e).map(([o,a])=>[a,o])),i=new Map(Object.keys(e).map(o=>[o,void 0]));return wZ({owner:t,createEmptyChangeSummary:s(()=>({}),"createEmptyChangeSummary"),handleChange:s((o,a)=>{let c=n.get(o.changedObservable);return a[c]===void 0&&(a[c]={value:void 0,changes:[]}),a[c].changes.push(o.change),!0},"handleChange")},(o,a)=>{for(let[c,l]of Object.entries(e)){let u=l.read(o);a[c]===void 0&&(a[c]={value:u,changes:[],previous:i.get(c)}),a[c].value=u,a[c].previous=i.get(c)===void 0?void 0:i.get(c),i.set(c,u)}r(a)})}s(Mx,"autorunWithChanges");d();var zC=class extends Rs{static{s(this,"RecentEditsProvider")}};function JVt(t,e=!1,r=void 0,n){if(e&&(r===void 0||n===void 0))throw new Error("cursorLine and activeDocDistanceLimitFromCursor are required when filterByCursorLine is true");let i=t.startLine-1,o=t.endLine-1;return!!(e&&(Math.abs(i-r)<=n||Math.abs(o-r)<=n))}s(JVt,"editIsTooCloseToCursor");var MZ=s((t,e)=>{let[r,n]=e.useState();return e.useData(Pp,async i=>{if(!i.document)return;let o=t.ctx.get(zC);if(o.isEnabled())o.start();else return;let a=o.config,c=o.getRecentEdits(),l=new Set,u=t.ctx.get(dr),f=[];for(let m=c.length-1;m>=0&&!(f.length>=a.maxEdits);m--){let h=c[m];if(!await u.getTextDocument({uri:h.file}))continue;let g=!l.has(h.file);if(l.size+(g?1:0)>a.maxFiles)break;let y=h.file===i.document?.uri,E=y?i.position.line:void 0;if(JVt(h,y,E,a.activeDocDistanceLimitFromCursor))continue;let S=o.getEditSummary(h);if(S){l.add(h.file);let R=u.getRelativePath({uri:h.file});f.unshift(I7(`File: ${R}`)+I7(S))}}if(f.length===0){n(void 0);return}let p=I7("These are recently edited files. Do not suggest code that has been deleted.")+f.join("")+I7("End of recent edits");n(p)}),r?Zr(GT,{children:Zr(mc,{children:r})}):void 0},"RecentEdits");d();d();d();d();var jxe=new Sr;function yXe(t){return[...t].sort((e,r)=>{let n=jxe.get(e.uri)??0;return(jxe.get(r.uri)??0)-n})}s(yXe,"sortByAccessTimes");var CXe=s(t=>t.get(dr).onDidFocusTextDocument(e=>{e.document&&jxe.set(e.document.uri.toString(),Date.now())}),"registerDocumentTracker");var LZ=class{constructor(e){this.docManager=e}static{s(this,"OpenTabFiles")}truncateDocs(e,r,n,i){let o=new Map,a=0;for(let c of e)if(!(a+c.getText().length>YR.MAX_NEIGHBOR_AGGREGATE_LENGTH)&&(c.uri.startsWith("file:")&&r.startsWith("file:")&&c.uri!==r&&FZ(n,c.detectedLanguageId)&&(o.set(c.uri.toString(),{uri:c.uri.toString(),relativePath:this.docManager.getRelativePath(c),source:c.getText()}),a+=c.getText().length),o.size>=i))break;return o}async getNeighborFiles(e,r,n){let i=new Map,o=new Map;return i=this.truncateDocs(yXe(await this.docManager.textDocuments()),e,r,n),o.set("opentabs",Array.from(i.keys()).map(a=>a.toString())),{docs:i,neighborSource:o}}};d();d();function vXe(t,e,r){return async function(...n){return await Promise.race([t.apply(this,n),new Promise(i=>{setTimeout(i,e,r)})])}}s(vXe,"shortCircuit");d();function ZVt(...t){return JSON.stringify(t,(e,r)=>typeof r=="object"?r:String(r))}s(ZVt,"defaultHash");function Gxe(t,e={}){let{hash:r=ZVt,cache:n=new Map}=e;return function(...i){let o=r.apply(this,i);if(n.has(o))return n.get(o);let a=t.apply(this,i);return a instanceof Promise&&(a=a.catch(c=>{throw n.delete(o),c})),n.set(o,a),a}}s(Gxe,"memoize");var xXe={entries:[],traits:[]},OZ={entries:new Map,traits:[]},Vxe=class extends Sr{constructor(r,n=120*1e3){super(r);this.defaultEvictionTimeMs=n;this._cacheTimestamps=new Map}static{s(this,"PromiseExpirationCacheMap")}bumpRetryCount(r){let n=this._cacheTimestamps.get(r);return n?++n.retryCount:(this._cacheTimestamps.set(r,{timestamp:Date.now(),retryCount:0}),0)}has(r){return this.isValid(r)?super.has(r):(this.deleteExpiredEntry(r),!1)}get(r){let n=super.get(r);if(this.isValid(r))return n;this.deleteExpiredEntry(r)}set(r,n){let i=super.set(r,n);return this.isValid(r)||this._cacheTimestamps.set(r,{timestamp:Date.now(),retryCount:0}),i}clear(){super.clear(),this._cacheTimestamps.clear()}isValid(r){let n=this._cacheTimestamps.get(r);return n!==void 0&&Date.now()-n.timestamp<this.defaultEvictionTimeMs}deleteExpiredEntry(r){this._cacheTimestamps.has(r)&&this._cacheTimestamps.delete(r),super.delete(r)}},Ol=new dt("relatedFiles"),ezt=1e3,QZ=class extends Error{static{s(this,"RelatedFilesProviderFailure")}constructor(){super("The provider failed providing the list of relatedFiles")}},JR=class t{constructor(e){this.context=e}static{s(this,"RelatedFilesProvider")}async getRelatedFiles(e,r,n){let i=await this.getRelatedFilesResponse(e,r,n);if(i===void 0)return;let o={entries:new Map,traits:i.traits??[]};for(let a of i.entries){let c=o.entries.get(a.type);c||(c=new Map,o.entries.set(a.type,c));for(let l of a.uris)try{Ol.debug(this.context,`Processing ${l}`);let u=await this.getFileContent(l);if(!u||u.length==0){Ol.debug(this.context,`Skip ${l} due to empty content or loading issue.`);continue}if(await this.isContentExcluded(l,u)){Ol.debug(this.context,`Skip ${l} due content exclusion.`);continue}u=t.dropBOM(u),c.set(l,u)}catch(u){Ol.warn(this.context,u)}}return o}async getFileContent(e){try{return this.context.get(Fi).readFileString(e)}catch(r){Ol.debug(this.context,r)}}async isContentExcluded(e,r){try{return(await this.context.get(dl).evaluate(e,r)).isBlocked}catch(n){Ol.exception(this.context,n,"isContentExcluded")}return!0}static dropBOM(e){return e.charCodeAt(0)===65279?e.slice(1):e}},tzt=3,EXe=new Vxe(ezt);async function bXe(t,e,r,n,i){let o=performance.now(),a;try{a=await i.getRelatedFiles(e,r,n)}catch(l){Ol.exception(t,l,".getRelatedFiles"),a=void 0}a===void 0&&(EXe.bumpRetryCount(e.uri)>=tzt?a=OZ:a=void 0);let c=performance.now()-o;if(Ol.debug(t,a!==void 0?`Fetched ${[...a.entries.values()].map(l=>l.size).reduce((l,u)=>l+u,0)} related files for '${e.uri}' in ${c}ms.`:`Failing fetching files for '${e.uri}' in ${c}ms.`),a===void 0)throw new QZ;return a}s(bXe,"getRelatedFiles");var zxe=Gxe(bXe,{cache:EXe,hash:s((t,e,r,n,i)=>`${e.uri}`,"hash")});zxe=vXe(zxe,200,OZ);async function UZ(t,e,r,n,i,o=!1){let a=t.get(JR),c=OZ;try{let l={uri:e.uri,clientLanguageId:e.clientLanguageId,data:i};c=o?await bXe(t,l,r,n,a):await zxe(t,l,r,n,a)}catch(l){c=OZ,l instanceof QZ&&Bt(t,"getRelatedFilesList",r)}return Ol.debug(t,c!=null?`Fetched following traits ${c.traits.map(l=>`{${l.name} : ${l.value}}`).join("")} for '${e.uri}'`:`Failing fecthing traits for '${e.uri}'.`),c}s(UZ,"getRelatedFilesAndTraits");function FZ(t,e){return TO(t)===TO(e)}s(FZ,"considerNeighborFile");var YR=class t{static{s(this,"NeighborSource")}static{this.MAX_NEIGHBOR_AGGREGATE_LENGTH=2e5}static{this.MAX_NEIGHBOR_FILES=20}static{this.EXCLUDED_NEIGHBORS=["node_modules","dist","site-packages"]}static defaultEmptyResult(){return{docs:new Map,neighborSource:new Map,traits:[]}}static reset(){t.instance=void 0}static async getNeighborFilesAndTraits(e,r,n,i,o,a,c){let l=e.get(dr);t.instance===void 0&&(t.instance=new LZ(l));let u={...await t.instance.getNeighborFiles(r,n,t.MAX_NEIGHBOR_FILES),traits:[]};if(rzt(e,i))return u;let f=await l.getTextDocument({uri:r});if(!f)return Ol.debug(e,"neighborFiles.getNeighborFilesAndTraits",`Failed to get the related files: failed to get the document ${r}`),u;let p=l.getWorkspaceFolder(f);if(!p)return Ol.debug(e,"neighborFiles.getNeighborFilesAndTraits",`Failed to get the related files: ${r} is not under the workspace folder`),u;let m=await UZ(e,f,i,o,a,c);return m.entries.size===0?(Ol.debug(e,"neighborFiles.getNeighborFilesAndTraits",`0 related files found for ${r}`),u.traits.push(...m.traits),u):(m.entries.forEach((h,g)=>{let A=[];h.forEach((y,E)=>{let b=t.getRelativePath(E,p.uri);if(!b||u.docs.has(E))return;let S={relativePath:b,uri:E,source:y};A.unshift(S),u.docs.set(E,S)}),A.length>0&&u.neighborSource.set(g,A.map(y=>y.uri.toString()))}),u.traits.push(...m.traits),u)}static basename(e){return decodeURIComponent(e.replace(/[#?].*$/,"").replace(/^.*[/:]/,""))}static getRelativePath(e,r){let n=r.toString().replace(/[#?].*/,"").replace(/\/?$/,"/");return e.toString().startsWith(n)?e.toString().slice(n.length):t.basename(e)}};function rzt(t,e){return t.get(Mt).excludeRelatedFiles(e)||zi(t,Ht.ExcludeRelatedFiles)}s(rzt,"isExcludeRelatedFilesActive");function IXe(t,e){return t.get(Mt).includeNeighboringFiles(e)||zi(t,Ht.IncludeNeighboringFiles)}s(IXe,"isIncludeNeighborFilesActive");var qZ=s((t,e)=>{let[r,n]=e.useState(),[i,o]=e.useState([]);e.useData(Pp,async l=>{l.document.uri!==r?.uri&&o([]),n(l.document);let u=YR.defaultEmptyResult();l.turnOffSimilarFiles||(u=await YR.getNeighborFilesAndTraits(t.ctx,l.document.uri,l.document.detectedLanguageId,l.telemetryData,l.cancellationToken,l.data));let f=await a(l.telemetryData,l.document,l,u);o(f)});async function a(l,u,f,p){let m=Q3(t.ctx,l,u.detectedLanguageId);return(await c(m,l,u,f,p)).filter(g=>g.snippet.length>0).sort((g,A)=>g.score-A.score).map(g=>({...kJe(g),score:g.score}))}s(a,"produceSimilarFiles");async function c(l,u,f,p,m){let h=l.similarFilesOptions||uZ(t.ctx,u,f.detectedLanguageId),A=t.ctx.get(dr).getRelativePath(f),y={uri:f.uri,source:f.getText(),offset:f.offsetAt(p.position),relativePath:A,languageId:f.detectedLanguageId};return await BJe(y,Array.from(m.docs.values()),h)}return s(c,"findSimilarSnippets"),Zr(BA,{children:[...i.map((l,u)=>Zr(nzt,{snippet:l}))]})},"SimilarFiles"),nzt=s((t,e)=>Zr(GT,{children:[Zr(mc,{children:t.snippet.headline}),Zr(mc,{children:t.snippet.snippet})]}),"SimilarFile");d();d();var HZ=s((t,e)=>{let[r,n]=e.useState(),[i,o]=e.useState();if(e.useData(Pp,a=>{a.traits!==r&&n(a.traits);let c=TO(a.document.detectedLanguageId);c!==i&&o(c)}),!(!r||r.length===0||!i))return Zr(BA,{children:[Zr(mc,{children:`Consider this related information:
`}),...r.map(a=>Zr(mc,{source:a,children:`${a.name}: ${a.value}`},a.id))]})},"Traits");function TXe(t,e){return zi(t,Ht.UseSplitContextPrompt)??t.get(Mt).enablePromptContextProxyField(e)}s(TXe,"shouldUseSplitContextPrompt");function wXe(t){return Zr(BA,{children:[Zr(Exe,{children:[Zr(CZ,{ctx:t,weight:.7}),Zr(HZ,{weight:.6}),Zr(fZ,{ctx:t,weight:.9}),Zr(qZ,{ctx:t,weight:.8})]}),Zr(QJe,{weight:1}),Zr(bxe,{children:Zr(MZ,{ctx:t,weight:.99})}),Zr(OJe,{weight:1})]})}s(wXe,"splitContextCompletionsPrompt");d();var SXe=0;function izt(){SXe=0}s(izt,"resetContextIndex");function ozt(){return SXe++}s(ozt,"getNextContextIndex");var $Z=class extends R3{constructor(){super(...arguments);this.formatPrefix=qJe;this.formatContext=HJe}static{s(this,"SplitContextPromptRenderer")}processSnapshot(r,n){let i=[],o=[],a=[],c=!1;if(izt(),new _3(r,szt).walkSnapshot((f,p,m)=>{if(f===r||(f.statistics.updateDataTimeMs&&f.statistics.updateDataTimeMs>0&&a.push({componentPath:f.path,updateDataTimeMs:f.statistics.updateDataTimeMs}),f.name===$R.name&&(c=!0),f.value===void 0||f.value===""))return!0;let h=m.chunks,g=m.type;if(g==="suffix")o.push({value:T7(f.value),type:"suffix",weight:m.weight,componentPath:f.path,nodeStatistics:f.statistics,chunks:h,source:m.source});else{let A=g==="prefix",y=A||f.value.endsWith(n)?f.value:f.value+n;i.push({type:A?"prefix":"context",value:T7(y),weight:m.weight,componentPath:f.path,nodeStatistics:f.statistics,chunks:h,source:m.source,index:A?void 0:m.index})}return!0}),!c)throw new Error(`Node of type ${$R.name} not found`);if(o.length>1)throw new Error("Only one suffix is allowed");let u=o.length===1?o[0]:{componentPath:"",value:"",weight:1,nodeStatistics:{},type:"suffix"};return{prefixBlocks:i,suffixBlock:u,componentStatistics:a}}},szt=[..._xe,(t,e,r)=>pZ(t)?{...r,index:ozt()}:r];d();function WZ(t,e,r){let n=YX(r,"Trait");for(let o of n)azt(t,e,o.data,o.providerId);return n.flatMap(o=>o.data).sort((o,a)=>(o.importance??0)-(a.importance??0))}s(WZ,"getTraitsFromContextItems");function azt(t,e,r,n){let i=t.get(fl).getStatisticsForCompletion(e);r.forEach(o=>{i.addExpectations(n,[[o,"included"]])})}s(azt,"setupExpectationsForTraits");var czt=new Map([["TargetFrameworks","targetFrameworks"],["LanguageVersion","languageVersion"]]);function jZ(t,e,r,n,i,o){if(r.length>0){let a={};a.detectedLanguageId=n,a.languageId=i;for(let l of r){let u=czt.get(l.name);u&&(a[u]=l.value)}let c=o.extendedBy(a,{});return Bt(e,t,c)}}s(jZ,"ReportTraitsTelemetry");d();d();d();var GZ=class{constructor(e){this.states=e;this.currentIndex=0;this.stateChanged=!1}static{s(this,"UseState")}useState(e){let r=this.currentIndex;if(this.states[r]===void 0){let i=typeof e=="function"?e():e;this.states[r]=i}let n=s(i=>{let o=typeof i=="function"?i(this.states[r]):i;this.states[r]=o,this.stateChanged=!0},"setState");return this.currentIndex++,[this.states[r],n]}hasChanged(){return this.stateChanged}},VZ=class{constructor(e){this.measureUpdateTime=e;this.consumers=[]}static{s(this,"UseData")}useData(e,r){this.consumers.push(n=>{if(e(n))return r(n)})}async updateData(e){if(this.consumers.length>0){let r=performance.now();for(let n of this.consumers)await n(e);this.measureUpdateTime(performance.now()-r)}}};var zZ=class{constructor(e){this.lifecycleData=new Map;this.vTree=this.virtualizeElement(e,"$",0)}static{s(this,"VirtualPromptReconciler")}reconcile(e){if(!this.vTree)throw new Error("No tree to reconcile, make sure to pass a valid prompt");return e?.isCancellationRequested?this.vTree:(this.vTree=this.reconcileNode(this.vTree,"$",0,e),this.vTree)}reconcileNode(e,r,n,i){if(!e.children&&!e.lifecycle)return e;let o=e;if(e.lifecycle?.isRemountRequired()){let c=this.collectChildPaths(e);o=this.virtualizeElement(e.component,r,n);let l=this.collectChildPaths(o);this.cleanupState(c,l)}else if(e.children){let c=[];for(let l=0;l<e.children.length;l++){let u=e.children[l];if(u){let f=this.reconcileNode(u,e.path,l,i);f!==void 0&&c.push(f)}}o.children=c}return o}virtualizeElement(e,r,n){if(!(typeof e>"u")){if(typeof e=="string"||typeof e=="number")return{name:typeof e,path:`${r}[${n}]`,props:{value:e},component:e};if(lzt(e.type)){let i=e.type(e.props.children),o=r!=="$"?`[${n}]`:"",a=`${r}${o}.${i.type}`,c=i.children.map((l,u)=>this.virtualizeElement(l,a,u));return this.ensureUniqueKeys(c),{name:i.type,path:a,children:c.flat().filter(l=>l!==void 0),component:e}}return this.virtualizeFunctionComponent(r,n,e,e.type)}}virtualizeFunctionComponent(e,r,n,i){let o=n.props.key?`["${n.props.key}"]`:`[${r}]`,a=`${e}${o}.${i.name}`,c=new Yxe(this.getOrCreateLifecycleData(a)),l=i(n.props,c),p=(Array.isArray(l)?l:[l]).map((m,h)=>this.virtualizeElement(m,a,h)).flat().filter(m=>m!==void 0);return this.ensureUniqueKeys(p),{name:i.name,path:a,props:n.props,children:p,component:n,lifecycle:c}}ensureUniqueKeys(e){let r=new Map;for(let i of e){if(!i)continue;let o=i.props?.key;o&&r.set(o,(r.get(o)||0)+1)}let n=Array.from(r.entries()).filter(([i,o])=>o>1).map(([i])=>i);if(n.length>0)throw new Error(`Duplicate keys found: ${n.join(", ")}`)}collectChildPaths(e){let r=[];if(e?.children)for(let n of e.children)n&&(r.push(n.path),r.push(...this.collectChildPaths(n)));return r}cleanupState(e,r){for(let n of e)r.includes(n)||this.lifecycleData.delete(n)}getOrCreateLifecycleData(e){return this.lifecycleData.has(e)||this.lifecycleData.set(e,new Kxe([])),this.lifecycleData.get(e)}createPipe(){return{pump:s(async e=>{await this.pumpData(e)},"pump")}}async pumpData(e){if(!this.vTree)throw new Error("No tree to pump data into. Pumping data before initializing?");await this.recursivelyPumpData(e,this.vTree)}async recursivelyPumpData(e,r){if(!r)throw new Error("Can't pump data into undefined node.");await r.lifecycle?.dataHook.updateData(e);for(let n of r.children||[])await this.recursivelyPumpData(e,n)}},Kxe=class{static{s(this,"PromptElementLifecycleData")}constructor(e){this.state=e,this._updateTimeMs=0}getUpdateTimeMsAndReset(){let e=this._updateTimeMs;return this._updateTimeMs=0,e}},Yxe=class{constructor(e){this.lifecycleData=e;this.stateHook=new GZ(e.state),this.dataHook=new VZ(r=>{e._updateTimeMs=r})}static{s(this,"PromptElementLifecycle")}useState(e){return this.stateHook.useState(e)}useData(e,r){this.dataHook.useData(e,r)}isRemountRequired(){return this.stateHook.hasChanged()}};function lzt(t){return typeof t=="function"&&"isFragmentFunction"in t}s(lzt,"isFragmentFunction");var P7=class{static{s(this,"VirtualPrompt")}constructor(e){this.reconciler=new zZ(e)}snapshotNode(e,r){if(!e)return;if(r?.isCancellationRequested)return"cancelled";let n=[];for(let i of e.children??[]){let o=this.snapshotNode(i,r);if(o==="cancelled")return"cancelled";o!==void 0&&n.push(o)}return{value:e.props?.value?.toString(),name:e.name,path:e.path,props:e.props,children:n,statistics:{updateDataTimeMs:e.lifecycle?.lifecycleData.getUpdateTimeMsAndReset()}}}snapshot(e){try{let r=this.reconciler.reconcile(e);if(e?.isCancellationRequested)return{snapshot:void 0,status:"cancelled"};if(!r)throw new Error("Invalid virtual prompt tree");let n=this.snapshotNode(r,e);return n==="cancelled"||e?.isCancellationRequested?{snapshot:void 0,status:"cancelled"}:{snapshot:n,status:"ok"}}catch(r){return{snapshot:void 0,status:"error",error:r}}}createPipe(){return this.reconciler.createPipe()}};function Pp(t){if(!t||typeof t!="object")return!1;let e=t;return!(!e.document||!e.position||e.position.line===void 0||e.position.character===void 0||!e.telemetryData)}s(Pp,"isCompletionRequestData");var Jxe={default:{promptFunction:_Xe,renderer:R3},splitContext:{promptFunction:wXe,renderer:$Z}};function _Xe(t){return Zr(BA,{children:[Zr(xxe,{children:[Zr(CZ,{ctx:t,weight:.7}),Zr(HZ,{weight:.6}),Zr(fZ,{ctx:t,weight:.9}),Zr(qZ,{ctx:t,weight:.8}),Zr(MZ,{ctx:t,weight:.99})]}),Zr(E7,{weight:1})]})}s(_Xe,"defaultCompletionsPrompt");var KZ=class{constructor(e,r,n){this.ctx=e;this.promptOrdering=n??"default",this.virtualPrompt=r??new P7(this.completionsPrompt()),this.pipe=this.virtualPrompt.createPipe(),this.renderer=this.getRenderer()}static{s(this,"ComponentsCompletionsPromptFactory")}async prompt(e,r){try{return await this.createPromptUnsafe(e,r)}catch(n){return this.errorPrompt(n)}}async createPromptUnsafe({completionId:e,completionState:r,telemetryData:n,promptOpts:i},o){let{maxPromptLength:a,suffixPercent:c,suffixMatchThreshold:l}=Q3(this.ctx,n,r.textDocument.detectedLanguageId),u=await this.failFastPrompt(r.textDocument,r.position,c,o);if(u)return u;let f=i?.separateContext?"splitContext":"default";this.setPromptOrdering(f);let p=performance.now(),{traits:m,codeSnippets:h,turnOffSimilarFiles:g,resolvedContextItems:A}=await this.resolveContext(e,r,n,o,i);if(await this.updateComponentData(r.textDocument,r.position,m,h,n,g,a,o,i,l,i?.tokenizer),o?.isCancellationRequested)return Lx;let y=this.virtualPrompt.snapshot(o),E=y.status;if(E==="cancelled")return Lx;if(E==="error")return this.errorPrompt(y.error);let b=this.renderer.render(y.snapshot,{delimiter:`
`,tokenizer:i?.tokenizer,promptTokenLimit:a,suffixPercent:c,languageId:r.textDocument.detectedLanguageId},o);if(b.status==="cancelled")return Lx;if(b.status==="error")return this.errorPrompt(b.error);let[S,R]=YT(b.prefix),B={...b,prefix:S},L;if(w3(this.ctx,n)){let Y=JX(b.metadata.componentStatistics);this.ctx.get(fl).getStatisticsForCompletion(e).computeMatch(Y),L=ZX(this.ctx,e,A),dn.debug(this.ctx,`Context providers telemetry: '${JSON.stringify(L)}'`)}let O=performance.now();return this.resetIfEmpty(b),this.successPrompt(B,O,p,R,L)}async updateComponentData(e,r,n,i,o,a,c,l,u={},f,p){let m=this.createRequestData(e,r,o,l,u,c,n,i,a,f,p);await this.pipe.pump(m)}async resolveContext(e,r,n,i,o={}){let a=[],c,l,u=!1;if(w3(this.ctx,n)){a=await this.ctx.get(kp).resolution(e);let{textDocument:f}=r,p=a.filter(eZ);dzt(this.ctx,f.detectedLanguageId,p,n)||(u=!0),c=WZ(this.ctx,e,p),jZ("contextProvider.traits",this.ctx,c,f.detectedLanguageId,f.detectedLanguageId,n),l=await dZ(this.ctx,e,p,f.detectedLanguageId)}return{traits:c,codeSnippets:l,turnOffSimilarFiles:u,resolvedContextItems:a}}async failFastPrompt(e,r,n,i){if(i?.isCancellationRequested)return Lx;if((await this.ctx.get(dl).evaluate(e.uri,e.getText(),"UPDATE")).isBlocked)return XZ;if((n>0?e.getText().length:e.offsetAt(r))<YZ)return JZ}createRequestData(e,r,n,i,o,a,c,l,u,f,p){return{document:e,position:r,telemetryData:n,cancellationToken:i,data:o.data,traits:c,codeSnippets:l,turnOffSimilarFiles:u,suffixMatchThreshold:f,maxPromptTokens:a,tokenizer:p}}resetIfEmpty(e){e.prefix.length===0&&e.suffix.length===0&&this.reset()}successPrompt(e,r,n,i,o){return{type:"prompt",prompt:{prefix:e.prefix,prefixTokens:e.prefixTokens,suffix:e.suffix,suffixTokens:e.suffixTokens,context:e.context,isFimEnabled:e.suffix.length>0},computeTimeMs:r-n,trailingWs:i,neighborSource:new Map,metadata:e.metadata,contextProvidersTelemetry:o}}errorPrompt(e){return Ka(this.ctx,e,"PromptComponents.CompletionsPromptFactory"),this.reset(),U3}reset(){this.renderer=this.getRenderer(),this.virtualPrompt=new P7(this.completionsPrompt()),this.pipe=this.virtualPrompt.createPipe()}setPromptOrdering(e){this.promptOrdering!==e&&(this.promptOrdering=e,this.reset())}completionsPrompt(){return(Jxe[this.promptOrdering]?.promptFunction??_Xe)(this.ctx)}getRenderer(){let e=Jxe[this.promptOrdering]??Jxe.default;return new e.renderer}};function dzt(t,e,r,n){let i=["cpp","c"];return IXe(t,n)||i.includes(e)||!r.some(a=>a.data.some(c=>c.type==="CodeSnippet"))}s(dzt,"similarFilesEnabled");d();d();d();d();d();var ZZ="[...]",fzt=0,KC=-1;function hc(){return fzt++}s(hc,"getAvailableNodeId");function pzt(t,e){let r=t.children.map(n=>n.elisionMarker??e);return[...t.text.entries()].map(([n,i])=>n===0?i:r[n-1]+i).join("")}s(pzt,"elideChildren");function Xxe(t,e=ZZ){return r=>t.tokenLength(pzt(r,e))}s(Xxe,"getTokenizerCostFunction");d();var q3=class{static{s(this,"PriorityQueue")}constructor(e){if(this.heap=e?[...e]:[],this.heap.length>0)for(let r=Math.floor(this.heap.length/2)-1;r>=0;r--)this.siftDown(r)}get size(){return this.heap.length}insert(e,r){let n={item:e,priority:r};this.heap.push(n);let i=this.heap.length-1;this.siftUp(i)}peek(){return this.heap.length===0?null:this.heap[0]}pop(){if(this.heap.length===0)return null;let e=this.heap[0],r=this.heap.pop();return this.heap.length>0&&(this.heap[0]=r,this.siftDown(0)),e}clear(){let e=this.heap;return this.heap=[],e}siftUp(e){let r=this.heap[e];for(;e>0;){let n=Math.floor((e-1)/2);if(this.heap[n].priority>=r.priority)break;this.heap[e]=this.heap[n],e=n}this.heap[e]=r}siftDown(e){for(;e<this.size-1;){let r=e,n=2*e+1,i=n+1;if(n<this.size&&this.heap[n].priority>this.heap[r].priority&&(r=n),i<this.size&&this.heap[i].priority>this.heap[r].priority&&(r=i),r===e)break;let o=this.heap[e];this.heap[e]=this.heap[r],this.heap[r]=o,e=r}}};var Dp=class{constructor(e,r,n,i,o=0,a=!1,c=ZZ,l=!1){this.id=e;this.text=r;this.children=n;this.cost=i;this.weight=o;this.canMerge=a;this.elisionMarker=c;this.requireRenderedChild=l;this.weightFromChild=!1;if(r.length!==n.length+1)throw new Error(`Text fragments length (${r.length}) must be equal to children length (${n.length}) + 1`);this.weight=Math.max(o,0)}static{s(this,"RenderNode")}get value(){return this.weight/Math.max(this.cost,1)}get isRenderedChildRequired(){return this.requireRenderedChild||this.weightFromChild}updateWeights(e){let r=this.recursivelyRectifyWeights(e);for(let{item:n,priority:i}of r.clear())for(let o of n.nodes)o.weight=i*o.cost}recursivelyRectifyWeights(e){let r=this.children.map(a=>a.recursivelyRectifyWeights(e)),n=Math.max(0,e?e(this):this.weight);if(n===0&&r.reduce((a,c)=>a+c.size,0)===0)return this.weight=0,new q3([]);let i=new q3(r.flatMap(a=>a.clear())),o={nodes:[this],totalCost:this.cost,totalWeight:n};for(this.weightFromChild=!1;(i.peek()?.priority??0)>o.totalWeight/o.totalCost;){let{item:a}=i.pop();o.nodes.push(...a.nodes),o.totalCost+=a.totalCost,o.totalWeight+=a.totalWeight,this.weightFromChild=!0}return i.insert(o,o.totalWeight/o.totalCost),i}};function RXe(t,e={}){let{budget:r,mask:n,costFunction:i}=e,o=n??[],a=new Set(Array.isArray(o)?o:[o]);if((r??t.cost)<t.cost||a.has(t.id))return{text:t.elisionMarker,cost:i?i(t.elisionMarker):t.elisionMarker.length,renderedNodes:new Map};if(r===void 0){let p=s(y=>a.has(y.id),"elider"),m=[],h=new Map;if(eEe(t,m,p,h),m.length===0)return Zxe(t,i);let g=m.join(""),A=i?i(g):[...h.values()].reduce((y,E)=>y+E.cost,0);return{text:g,cost:A,renderedNodes:h}}let c=new Map,l=[],u=new q3([{item:t,priority:t.value}]),f=r;for(;f>0&&u.size>0;){let{item:p}=u.pop();if(!a.has(p.id)&&p.cost<=f){f-=p.cost,c.set(p.id,p),l.push(p);for(let m of p.children)u.insert(m,m.value)}}for(;c.size>0;){let p=[],m=s(y=>!c.has(y.id),"elider"),h=new Map;if(eEe(t,p,m,h),p.length===0)return Zxe(t,i);let g=p.join("");if(i===void 0){let y=[...h.values()].reduce((E,b)=>E+b.cost,0);return{text:g,cost:y,renderedNodes:h}}let A=i(g);if(A<=r)return{text:g,cost:A,renderedNodes:h};for(c=h;l.length>0&&A>r;){let y=l.pop();c.has(y.id)&&(A-=y.cost,c.delete(y.id))}if(l.length===0)break}return Zxe(t,i)}s(RXe,"render");function Zxe(t,e){return{text:t.elisionMarker,cost:e?e(t.elisionMarker):t.elisionMarker.length,renderedNodes:new Map}}s(Zxe,"renderEmpty");function eEe(t,e,r,n,i=!1){let o=e.length;if(r(t))return o>=2&&(i||e[o-2]===t.elisionMarker&&e[o-1].trim().length===0)?(e.pop(),!1):(e.push(t.elisionMarker),!1);let a=t.isRenderedChildRequired,c=!0;for(let[l,u]of t.children.entries())e.push(t.text[l]??""),c=eEe(u,e,r,n,u.canMerge&&!c),a&&=!c;if(a){for(;e.length>o;)e.pop();return!1}return e.push(t.text[t.text.length-1]??""),n.set(t.id,t),!0}s(eEe,"recursivelyRender");function D7(t,e,r=ZZ){let n=t.children.map(a=>D7(a,e,r));r=t.elisionMarker??r;let i=e(t);return new Dp(t.id,t.text,n,i,0,t.canMerge,r)}s(D7,"snapshot");var JT=new Dp(hc(),[""],[],0);d();function Fh(t,e,r){let n=t.get(e);return n===void 0&&(n=r(e),t.set(e,n)),n}s(Fh,"setDefault");var BXe=2e4,kXe=0,PXe=new Sr;function NXe(t,e,r,n){kXe++;let i=r.promptOpts?.tokenizer??"o200k_base",o=performance.now(),{root:a,mask:c,statistics:l}=t.snapshot(r,n),u=performance.now(),f=new Set(c),p=PXe?.get(a.id),m;if(p&&p.budget>=e&&p.render.cost<=e&&p.tokenizer===i&&f.size===p.mask.size&&[...f].every(b=>p.mask.has(b)))m=p.render;else{let b=Li(i);m=RXe(a,{budget:e,mask:c,costFunction:s(R=>b.tokenLength(R),"costFunction")}),PXe.set(a.id,{budget:e,mask:f,tokenizer:i,render:m})}let{text:h,cost:g,renderedNodes:A}=m,y=performance.now();for(let[b,S]of l?.entries()??[])S.actualTokens=A.get(b)?.cost??0;let E={renderId:kXe,rendererName:"renderNode",tokenizer:i,elisionTimeMs:y-u,renderTimeMs:u-o,updateDataTimeMs:0,componentStatistics:[{componentPath:t.name,actualTokens:g}]};return{root:a,renderedNodes:A,text:h,cost:g,metadata:E}}s(NXe,"renderWithMetadata");function MXe(t,e){return r=>{let n=r.text.join("")+`
`;return Fh(e,n,()=>t.tokenLength(n)+1)}}s(MXe,"cachedLineCostFunction");function LXe(t,e,r){let i=t.split(`
`).map(f=>({id:hc(),text:[f],children:[],canMerge:!0})),o=[""];i.length>=1&&o.push(...Array(i.length-1).fill(`
`),"");let a={id:hc(),text:o,children:i,canMerge:!0},l=D7(a,s(f=>f.id===a.id?0:e(f),"nodeCostFunction")),u=r?i.length:1;for(let f of l.children)f.weight=u*Math.max(1,f.cost),u+=r?-1:1;return l}s(LXe,"getLinewiseNode");var eee=class{constructor(){this.name="basicPrefix";this.costCache=new Sr(BXe)}static{s(this,"BasicPrefixComponent")}snapshot(e){let{completionState:r,promptOpts:n}=e,i=r.textDocument.getText({start:{line:0,character:0},end:r.position}),o=Li(n?.tokenizer),a=MXe(o,this.costCache);return{root:LXe(i,a,!1)}}},DXe={root:JT,text:"",cost:0},tee=class{constructor(e){this.ctx=e;this.name="cachedSuffix";this.cache=new Sr(5);this.costCache=new Sr(BXe)}static{s(this,"CachedSuffixComponent")}snapshot(e){return{root:this.getCachedSuffix(e).root}}estimatedCost(e,r){return this.getCachedSuffix(e).cost}getCachedSuffix(e){let{completionState:r,telemetryData:n,promptOpts:i}=e,a=r.textDocument.getText({start:r.position,end:{line:Number.MAX_VALUE,character:Number.MAX_VALUE}}).replace(/^.*/,"").trimStart();if(a==="")return DXe;let c=this.cache.get(r.textDocument.uri)||DXe;if(c.text===a)return c;let l=this.ctx.get(Mt).suffixMatchThreshold(n);if(c.text!==""){let h=new vT,g=h.takeFirstTokens(a,x7);if(g.tokens.length>0&&100*mZ(g.tokens,h.takeFirstTokens(c.text,x7).tokens)?.score<l*g.tokens.length)return c}let u=Li(i?.tokenizer),f=MXe(u,this.costCache),p=LXe(a,f,!0),m=p.children.reduce((h,g)=>h+g.cost+1,0);return{root:p,cost:m,text:a}}},ree=class{constructor(){this.name="traitProvider"}static{s(this,"TraitComponent")}snapshot(e,r){let{promptOpts:n}=e,i=Li(n?.tokenizer);if(!r||r.traits.length===0)return{root:JT};let o=new Map,a=0,c=[],l=new Map;for(let m of r.traits){let h=hc(),g=`${m.name}: ${m.value}`,A=new Dp(h,[g],[],i.tokenLength(g));c.push(A),l.set(h,{componentPath:m.id,source:m,expectedTokens:A.cost}),o.set(h,m.importance??0),a+=m.importance??0}let f=[`Related context:
`,...new Array(c.length).fill(`
`)],p=new Dp(hc(),f,c,0,0,!0,"");return p.updateWeights(m=>(o.get(m.id)??0)/(a||1)),{root:p,statistics:l}}},nee=class{constructor(e){this.ctx=e;this.name="contextProvider"}static{s(this,"CodeSnippetComponent")}snapshot(e,r){let{promptOpts:n}=e,i=Li(n?.tokenizer);if(!r||r.codeSnippets.length===0)return{root:JT};let o=new Map;for(let h of r.codeSnippets){let g=h.uri;Fh(o,g,()=>[]).push(h)}let a=new Map,c=[],l=new Map,u=0,f=this.ctx.get(dr);for(let[h,g]of o.entries()){let A=f.getRelativePath({uri:h})??h,E=[`Compare ${g.length>1?"these snippets":"this snippet"} from ${A}:
`,...new Array(g.length).fill(`
`)],b=[];for(let S of g){let R=hc();l.set(R,S.importance??0);let B=new Dp(R,[S.value],[],i.tokenLength(S.value));b.push(B),u+=S.importance??0,a.set(R,{componentPath:S.id,source:S,expectedTokens:B.cost})}c.push(new Dp(hc(),E,b,i.tokenLength(E.join("")),0,!0,""))}let p=new Array(c.length+1).fill(""),m=new Dp(hc(),p,c,0,0,!0,"");return m.updateWeights(h=>(l.get(h.id)??0)/(u||1)),{root:m,statistics:a}}},iee=class{constructor(e,r){this.name=e;this.components=r}static{s(this,"ConcatenatedContextComponent")}snapshot(e,r){let n=this.components.map(u=>u.snapshot(e,r)),i=n.map(u=>u.root).filter(u=>u.id!==JT.id);if(i.length===0)return{root:JT};let o=["",...Array(i.length-1).fill(`
`),""],a=new Dp(hc(),o,i,0,0,!0,"",!0),c=[],l=new Map;for(let u of n){for(let[f,p]of u.statistics?.entries()??[])l.set(f,p);u.mask&&c.push(...u.mask)}return{root:a,mask:c,statistics:l}}};var mzt=.8,oee=class{constructor(e,r){this.ctx=e;this.components=r;this.renderId=0}static{s(this,"CascadingPromptFactory")}async prompt(e,r){try{return await this.createPromptUnsafe(e,r)}catch(n){return this.errorPrompt(n)}}getComponentAllocation(e){let r=this.ctx.get(Mt).suffixPercent(e),n=this.ctx.get(Mt).stableContextPercent(e),i=this.ctx.get(Mt).volatileContextPercent(e);if(r<0||r>100)throw new Error(`suffixPercent must be between 0 and 100, but was ${r}`);if(n<0||n>100)throw new Error(`stableContextPercent must be between 0 and 100, but was ${n}`);if(i<0||i>100)throw new Error(`volatileContextPercent must be between 0 and 100, but was ${i}`);let o=100-r-n-i;if(o<=1||o>100)throw new Error(`prefixPercent must be between 1 and 100, but was ${o}`);return{prefix:o/100,suffix:r/100,stableContext:n/100,volatileContext:i/100}}async createPromptUnsafe(e,r){this.renderId++;let{completionId:n,completionState:i,telemetryData:o,promptOpts:a}=e,c=await this.failFastPrompt(i.textDocument,r);if(c)return c;let l=performance.now(),u;w3(this.ctx,o)&&(u=await this.resolveContext(n,i,o,r));let f=performance.now()-l,p={},m={renderId:this.renderId,rendererName:"w",tokenizer:a?.tokenizer??"o200k_base",elisionTimeMs:0,renderTimeMs:0,updateDataTimeMs:f,componentStatistics:[]},h=i.textDocument.detectedLanguageId,{maxPromptLength:g}=Q3(this.ctx,o,h),A=this.getComponentAllocation(o),y=A.suffix*g,E=this.components.suffix.estimatedCost?.(e,u),b=["stableContext","volatileContext","prefix","suffix"];y>mzt*(E??0)&&(b=["stableContext","volatileContext","suffix","prefix"]);let S=0;for(let z of b){let Q=S+g*A[z],U=NXe(this.components[z],Q,e,u);S=Q-U.cost,p[z]=U,hzt(m,U.metadata)}let[R,B]=YT(p.prefix.text),L=performance.now(),O=w3(this.ctx,o)?this.telemetrizeContext(n,m.componentStatistics,u?.resolvedContextItems??[]):[],Y=[p.stableContext.text.trim(),p.volatileContext.text.trim()];return{type:"prompt",prompt:{prefix:a?.separateContext?R:VC(Y.join(`
`),h)+`

`+R,prefixTokens:p.prefix.cost+p.stableContext.cost+p.volatileContext.cost,suffix:p.suffix.text,suffixTokens:p.suffix.cost,context:a?.separateContext?Y:void 0,isFimEnabled:p.suffix.text.length>0},computeTimeMs:L-l,trailingWs:B,neighborSource:new Map,metadata:m,contextProvidersTelemetry:O}}async resolveContext(e,r,n,i){let o=await this.ctx.get(kp).resolution(e),{textDocument:a}=r,c=o.filter(eZ),l=WZ(this.ctx,e,c);jZ("contextProvider.traits",this.ctx,l,a.detectedLanguageId,a.detectedLanguageId,n);let u=await dZ(this.ctx,e,c,a.detectedLanguageId);return{traits:l,codeSnippets:u,resolvedContextItems:o}}telemetrizeContext(e,r,n){let i=JX(r);this.ctx.get(fl).getStatisticsForCompletion(e).computeMatch(i);let o=ZX(this.ctx,e,n);return dn.debug(this.ctx,`Context providers telemetry: '${JSON.stringify(o)}'`),o}async failFastPrompt(e,r){if(r?.isCancellationRequested)return Lx;if((await this.ctx.get(dl).evaluate(e.uri,e.getText(),"UPDATE")).isBlocked)return XZ;if(e.getText().length<YZ)return JZ}errorPrompt(e){return Ka(this.ctx,e,"WorkspaceContextPromptFactory"),U3}};function hzt(t,e){t.elisionTimeMs+=e.elisionTimeMs,t.renderTimeMs+=e.renderTimeMs,t.updateDataTimeMs+=e.updateDataTimeMs,t.componentStatistics.push(...e.componentStatistics)}s(hzt,"aggregateMetadata");d();d();function gzt(t){return t.id!==void 0}s(gzt,"isNodeItem");function Azt(t){return!("uri"in t)&&!("id"in t)}s(Azt,"isNullItem");var yzt={"RecentDocumentProvider.RecentlyOpen":.1,"RecentDocumentProvider.RecentlyFocused":.1,"RecentDocumentProvider.RecentlyEdited":.1,RecentCompletionsRequestProvider:1,"ExtensionActivityProvider.CurrentSelection":5,"ExtensionActivityProvider.PrimarySelection":2,"ExtensionActivityProvider.Selection":.2,"ExtensionActivityProvider.VisibleRange":1,FileDirectoryDocumentProvider:.05,"SymbolContextProvider.Identifiers":.2,"SymbolContextProvider.Text":.2,"IndexingSymbolContextProvider.Text":1,"TreeProximityProvider.Parent":.3,"TreeProximityProvider.Children":.3,"TreeProximityProvider.Siblings":.3,"ExtensionReferenceProvider.References":.2,"ExtensionReferenceProvider.Definitions":1},XT="64f5ff7d-e507-4558-81cf-3bdacc3c5c00",H3=class{static{s(this,"WorkspaceContextWeights")}constructor(e){let r=new Map;for(let{uri:n,weight:i}of e)r.set(n,(r.get(n)??0)+i);this.documents=[...r.entries()].map(([n,i])=>({uri:n,weight:i})).sort((n,i)=>i.weight-n.weight),this.docWeights=r,this.nodes=e.filter(({id:n})=>n!==KC),this.nodeWeights=new Map(e.map(({id:n,weight:i})=>[n,i]))}getNodeWeight(e){return this.nodeWeights.get(e)??0}getDocumentWeight(e){return this.docWeights.get(e)??0}},see=class{constructor(e,r){this.activeContext=e;this.config=r;this.sourceWeights=yzt;this.sourceContext=new Map;this.prevUpdateTime=void 0;this.prevItems=[];this.weights=new H3([])}static{s(this,"WorkspaceContextCoordinator")}getWeights(e){if(e){let r=this.sourceContext.get(e);return r?new H3(r.items):new H3([])}return this.weights}updateWeights(){let e=new Map,r=0,n=this.config.StaleWeightHalflife;for(let[i,{items:o,updateTime:a}]of this.sourceContext.entries()){let c=this.sourceWeights[i]??0;if(c<=0||o.length===0)continue;let l=.5**(-Math.max(0,(this.prevUpdateTime??a)-a)/n);c*=l,r+=c,this.aggregateWeights(o,e,c,!0)}if(r>0){if(this.weights.nodes.length>0){let i=r*this.config.Laziness,o=this.prevItems;this.aggregateWeights(o,e,i,!0)}for(let[i,o]of e.entries()){let a=this.activeContext.getDocument(i)?.document;if(a===void 0)continue;let c=o.get(KC);if(c!==void 0&&c>0){o.delete(KC);let l=0;for(let u of o.values())l+=u;if(l<=0){let u=a.getAllIds(),f=c/Math.max(u.length,1);for(let p of u)o.set(p,f)}else for(let[u,f]of[...o.entries()])o.set(u,f+c*(f/l))}}this.prevItems=this.truncateAndNormalize(e),this.weights=new H3(this.prevItems)}return this.prevUpdateTime=performance.now(),this.weights}pushWorkspaceContext(e,r){let n=performance.now(),i=this.addUriAndId(r),o=new Map;this.aggregateWeights(i,o);let a=this.truncateAndNormalize(o);this.sourceContext.set(e,{items:a,updateTime:n})}addUriAndId(e){return e.filter(r=>r.weight>0).map(r=>{if(Azt(r))return{weight:r.weight,uri:XT,id:KC};let n=gzt(r)?r.id:KC,i=r.uri??this.activeContext.getUri(n)??XT;return i===XT&&(n=KC),{weight:r.weight,uri:i,id:n}})}aggregateWeights(e,r,n=1,i=!1){for(let{uri:o,id:a,weight:c}of e){if(c<=0||isNaN(c))continue;let l=Fh(r,o,()=>new Map),u=KC;(!i||this.activeContext.getUri(a)!==void 0)&&(u=a),l.set(u,(l.get(u)??0)+c*n)}}truncateAndNormalize(e){let r=[],n=new Map,i=0;for(let[l,u]of e.entries()){let f=l!==XT?this.activeContext.normalizeUri(l)??XT:XT;for(let[p,m]of u.entries())l===XT||p===KC?n.set(f,(n.get(f)??0)+m):r.push({uri:f,id:p,weight:m}),i+=m}if(i<=0)return[];n.delete(XT),r.sort((l,u)=>u.weight-l.weight);for(let{uri:l,weight:u}of r.slice(this.config.MaxActiveNodes,r.length))n.set(l,(n.get(l)??0)+u);let o=[...n.entries()].sort((l,u)=>u[1]-l[1]).slice(0,this.config.MaxActiveFiles).map(([l,u])=>({uri:l,id:KC,weight:u}));return r.slice(0,this.config.MaxActiveNodes).concat(o).sort((l,u)=>u.weight-l.weight).map(l=>({...l,weight:l.weight/i}))}};d();d();d();var Y0=class{static{s(this,"FileSearch")}};d();d();var aee=class{constructor(e,r,n,i=!1){this.id=e;this.parts=r;this.text=n;this.canMerge=i}static{s(this,"ContextNode")}get startOffset(){return this.parts[0].root.startOffset}get endOffset(){return this.parts[this.parts.length-1].root.endOffset}get syntaxRoots(){return this.parts.map(e=>e.root)}get children(){return this.parts.flatMap(e=>e.children)}get syntaxLimits(){return this.children.flatMap(e=>e.syntaxRoots)}*syntaxNodes(){let e=new Set(this.syntaxLimits.map(r=>r.id));for(let r of this.syntaxRoots)yield*OXe(r,e)}findChild(e,r){if(e<this.startOffset||r>this.endOffset||r<e)return;let n=0,i=this.parts.length-1,o;for(;n<=i;){let c=Math.floor((n+i)/2);if(o=this.parts[c],o.root.startOffset<=e&&o.root.endOffset>=r)break;o.root.endOffset<e?n=c+1:i=c-1}if(o===void 0||i<n)return;n=0,i=o.children.length-1;let a;for(;n<=i;){let c=Math.floor((n+i)/2);if(a=o.children[c],a.startOffset<=e&&a.endOffset>=r)break;a.endOffset<e?n=c+1:i=c-1}if(!(a===void 0||i<n))return a}},Czt=6,cee=class{constructor(e,r,n,i){this.textDocument=e;this.parser=r;this.minSize=n;this.updateId=hc();this.syntaxToAbstract=new Map;this.nodeById=new Map;this.minSize=Math.max(n,1),this.maxSize=Math.max(i??2*this.minSize,this.minSize+1),this._syntaxRoot=this.parser.parse(e,!0),this._root=this.buildTree()}static{s(this,"ContextDocument")}get uri(){return this.textDocument.uri}get version(){return this.updateId}get document(){return this.textDocument}get rootId(){return this._root.id}get root(){return this._root}get syntaxRoot(){return this._syntaxRoot}getNode(e){return this.nodeById.get(e)}getAllIds(){return Array.from(this.nodeById.keys())}findNode(e,r){let n=this._root,i=n;for(;i;)n=i,i=n.findChild(e,r??e);return n}update(e){if(this.uri!==e.uri)throw new Error("Can't update ContextDocument using mismatched URI");this.textDocument=e,this._syntaxRoot=this.parser.parse(e,!0),this.recursivelyRemapNodes(this.root,()=>{}),this._root=this.buildTree(),this.updateId=hc()}recursivelyRemapNodes(e,r){let n=!0;for(let u of e.children)n=n&&this.recursivelyRemapNodes(u,r);if(!n)return this.invalidateNode(e),!1;let i=[];for(let{root:u,children:f}of e.parts){let p=r(u);if(p===void 0||p.type!==u.type)return this.invalidateNode(e),!1;i.push({root:p,children:f})}let o=i[0].root.parent,a=e.parts[0].root.parent;if((o&&this.canMergeChildren(o))!==(a&&this.canMergeChildren(a)))return this.invalidateNode(e),!1;let c=FXe(i,this.document);for(let[u,f]of c.entries())if(e.text[u]!==f)return this.invalidateNode(e),!1;let l=new aee(e.id,i,e.text,e.canMerge);for(let{root:u}of e.parts)this.syntaxToAbstract.delete(u.id);for(let{root:u}of l.parts)this.syntaxToAbstract.set(u.id,l);return this.nodeById.set(e.id,l),!0}invalidateNode(e){for(let r of e.syntaxRoots)this.syntaxToAbstract.delete(r.id);this.nodeById.delete(e.id)}createNode(e,r=!1){e.sort((o,a)=>o.root.startOffset-a.root.startOffset);let n=FXe(e,this.document),i=new aee(hc(),e,n,r);for(let{root:o}of e)this.syntaxToAbstract.set(o.id,i);return this.nodeById.set(i.id,i),i}buildTree(){let e=this.buildRecursively(this._syntaxRoot);return this.createNode([{root:this._syntaxRoot,children:e}])}buildRecursively(e){if(e.endOffset-e.startOffset<this.minSize)return[];let r=e.children;if(this.canMergeChildren(e)){let i=r.map(a=>this.syntaxToAbstract.get(a.id));for(let a=0;a<r.length;a++)if(i[a]===void 0){if(a>0&&i[a-1]!==void 0){let c=i[a-1];for(let l=a-1;l>=0&&i[l]?.id===c.id;l--)i[l]=void 0;this.invalidateNode(c)}if(a<r.length-1&&i[a+1]!==void 0){let c=i[a+1];for(;a<r.length&&i[a+1]?.id===c.id;)a++,i[a]=void 0;this.invalidateNode(c)}}let o=[];for(let a=0;a<r.length;void 0)if(i[a]!==void 0)for(o.push(i[a]);a<r.length&&i[a+1]?.id===i[a].id;)a++;else{let c=[];for(;a<r.length&&i[a]===void 0;){let l=r[a];c.push({root:l,children:this.buildRecursively(l)}),a++}o.push(...this.mergeChildren(c))}return o}let n=[];for(let i=0;i<r.length;i++){let o=r[i];if(this.syntaxToAbstract.has(o.id)){let l=this.syntaxToAbstract.get(o.id);n.push(l),i+=l.parts.length-1;continue}let a=this.buildRecursively(o),c=o.endOffset-o.startOffset-a.reduce((l,u)=>l+(u.endOffset-u.startOffset),0);this.canBeNode(o)&&c>=this.minSize?n.push(this.createNode([{root:o,children:a}])):n.push(...a)}return n}mergeChildren(e){if(e.length===0)return[];e.sort((m,h)=>m.root.startOffset-h.root.startOffset);let r=e[e.length-1].root.endOffset-e[0].root.startOffset,n=[];for(let m of e){let h=m.root.endOffset-m.root.startOffset;for(let g of m.children){let A=g.endOffset-g.startOffset;h-=A,r-=A}n.push(h)}if(r<this.minSize)return e.flatMap(m=>m.children);let i=[0],o=0,a=null,c={line:-1,size:-1},l=e[0].root.startOffset,u=e[0].root.range.start.line;for(let m=0;m<e.length;m++){let h=e[m];if(o+=n[m]+h.root.startOffset-l,o>this.minSize&&o<this.maxSize){let g={line:h.root.range.start.line-u,size:h.root.startOffset-l};(g.line>c.line||g.line==c.line&&g.size>c.size)&&(c=g,a=m)}l=h.root.endOffset,u=h.root.range.end.line,o>=this.maxSize&&(a=a??m,i.push(a+1),m=a,o=0,a=null,c={line:-1,size:-1},l=e[m+1]?.root.startOffset,u=e[m+1]?.root.range.start.line)}i.length==1?i.push(e.length):i[i.length-1]!==e.length&&(i[i.length-1]=e.length);let f=[],p=!1;for(let m=0;m<i.length-1;m++){let h=e.slice(i[m],i[m+1]);f.push(this.createNode(h,p)),p=!0}return f}canMergeChildren(e){return this.parser.labeler.canMergeChildren?.(e)??e.children.length>Czt}canBeNode(e){return this.parser.labeler.canBeNode?.(e)??!0}};function FXe(t,e){if(t.length===0)return[""];let r=[],n=e.positionAt(t[0].root.startOffset);for(let o of t.flatMap(a=>a.children).sort((a,c)=>a.startOffset-c.startOffset)){let a=e.positionAt(o.startOffset);r.push(e.getText({start:n,end:a})),n=e.positionAt(o.endOffset)}let i=e.positionAt(t[t.length-1].root.endOffset);return r.push(e.getText({start:n,end:i})),r}s(FXe,"buildText");function*OXe(t,e){yield t;for(let r of t.children)e.has(r.id)||(yield*OXe(r,e))}s(OXe,"walk");d();d();d();var lee=class{constructor(e,r,n,i,o,a){this.id=e;this.raw=r;this.children=n;this.source="indentation";this.parent=null;let c={start:{line:i,character:0},end:{line:o,character:a.lineAt(o).text.length}},l=a.getText(c),u=l.search(/\S/);if(u===-1){let m={line:o,character:0};this.startOffset=a.offsetAt(m),this.endOffset=this.startOffset,this.range={start:m,end:m};return}let f=l.search(/\S(?!.*\S)/s),p=a.offsetAt(c.start);this.startOffset=p+u,this.endOffset=p+f+1,this.range={start:a.positionAt(this.startOffset),end:a.positionAt(this.endOffset)}}static{s(this,"IndentationNode")}get type(){return this.raw.type}};function tEe(t,e,r){let n=t.subs.map(l=>({subtree:l,node:tEe(l,e,r)})).filter(l=>l.node!==null).sort((l,u)=>l.node.startOffset-u.node.startOffset),i=[],o=e;for(let l=n.length-1;l>=0;l--){let{subtree:u,node:f}=n[l];if(f.range.end.line>=o){let p=tEe(u,o,r);p!==null&&(i.push(p),o=Math.min(p.range.start.line,o))}else i.push(f),o=Math.min(f.range.start.line,o)}i.sort((l,u)=>l.startOffset-u.startOffset);let a=e,c=0;if(i.length>0&&(a=Math.min(a,i[0].range.start.line),c=Math.max(c,i[i.length-1].range.end.line)),(t.type==="blank"||t.type==="line")&&(a=Math.min(a,t.lineNumber),c=Math.max(c,t.lineNumber),t.type==="blank"&&a===c))return null;if(c=Math.min(c,e-1),a<=c){let l=new lee(hc(),t,i,a,c,r);for(let u of i)u.parent=l;return l}return null}s(tEe,"recursivelyBuildNode");function QXe(t){let e=AR(t.getText(),t.detectedLanguageId);return tEe(e,t.lineCount,t)??new lee(hc(),e,[],0,t.lineCount-1,t)}s(QXe,"parse");var UXe={source:"indentation",parse:QXe,update(t,e){return{root:QXe(e),remapper:s(()=>{},"remapper")}},dispose:s(()=>{},"dispose"),labeler:{isIdentifier:s(t=>!1,"isIdentifier"),isText:s(t=>!0,"isText")}};async function qXe(t){return Promise.resolve(UXe)}s(qXe,"getParser");var vzt=new dt("WorkspaceContextManager"),uee=class{constructor(e,r){this.created=e;this.invalidated=r;this.updatedDocuments=Array.from(new Set([...e.entries(),...r.entries()].filter(([n,i])=>i.size>0).map(([n,i])=>n)))}static{s(this,"WorkspaceContextChanges")}getInvalidatedNodes(e){return this.getNodes(this.invalidated,e)}getCreatedNodes(e){return this.getNodes(this.created,e)}getNodes(e,r){return r===void 0?Array.from(e.entries()).flatMap(([n,i])=>[...i].map(o=>({uri:n,id:o}))):Array.from(e.get(r)??[]).map(n=>({uri:r,id:n}))}},dee=class{constructor(e,r){this.item=e;this.disposalCallback=r}static{s(this,"CachedItem")}dispose(){this.disposalCallback(this.item)}},HXe=5e3,fee=class{constructor(e,r){this.ctx=e;this.config=r;this.listenerDisposable=void 0;this.targetSet=new Set;this.activeDocuments=new Map;this.nodeToDoc=new Map;this.createdNodes=new Map;this.invalidatedNodes=new Map;this.parsers=new Map;this.staleDocuments=new Set;this.pendingUpdates=new Map;this.uriCache=new Sr(HXe);this.allowedExtensions=new Set(dR);this.invalidDocumentCache=new U_(HXe,this.config.InvalidCacheTime),this.cachedDocuments=new bj(this.config.MaxActiveFiles)}static{s(this,"WorkspaceContextManager")}isStarted(){return this.listenerDisposable!==void 0}start(){this.isStarted()||(this.listenerDisposable=this.ctx.get(dr).onDidChangeTextDocument(e=>this.handleDocumentChange(e)))}setAllowedLanguages(e){this.allowedExtensions=new Set(e.flatMap(r=>xx[r]?.extensions??[]))}getActiveDocuments(){return Array.from(this.activeDocuments.values())}getNode(e){let r=this.nodeToDoc.get(e);if(r===void 0)return;let n=this.getDocument(r);if(n===void 0)return;let i=n.document.getNode(e);if(i!==void 0)return{...n,node:i}}getDocument(e){let r=this.activeDocuments.get(e);if(r!==void 0)return{document:r,isActive:!0};let n=this.cachedDocuments.get(e);if(n!==void 0)return{document:n.item,isActive:!1}}getUri(e){return this.nodeToDoc.get(e)}normalizeUri(e){let r,n=this.uriCache.get(e);if(n!==null){if(n!==void 0)r=n;else try{if(wj(e),r=Pl(e),!(this.ctx.get(dr).getWorkspaceFolder({uri:r})!==void 0)){this.uriCache.set(e,null);return}this.uriCache.set(e,r)}catch{this.uriCache.set(e,null);return}if(!(!this.allowedExtensions.has(H3e(r))||this.invalidDocumentCache.has(r)))return r}}dispose(){if(this.isStarted()){this.listenerDisposable?.dispose(),this.listenerDisposable=void 0;for(let e of this.parsers.values())e.dispose();this.parsers.clear(),this.activeDocuments.clear(),this.cachedDocuments.clear()}}trySetActiveDocuments(e){if(this.isStarted()){this.targetSet.clear();for(let r of e){let n=this.normalizeUri(r);n!==void 0&&(this.targetSet.add(n),this.updateDocument(n))}for(let r of[...this.activeDocuments.keys()])this.targetSet.has(r)||this.deactivateDocument(r)}}popChanges(){let e=new uee(this.createdNodes,this.invalidatedNodes);return this.createdNodes=new Map,this.invalidatedNodes=new Map,e}async flushUpdates(e){if(e!==void 0){let r=this.pendingUpdates.get(e);r!==void 0&&await r}else await Promise.all([...this.pendingUpdates.values()])}isKnownDocument(e){return this.activeDocuments.has(e)||this.cachedDocuments.has(e)||this.pendingUpdates.has(e)}deactivateDocument(e){let r=this.activeDocuments.get(e);r!==void 0&&(this.activeDocuments.delete(e),this.pendingUpdates.has(e)||this.cachedDocuments.set(e,new dee(r,n=>this.disposeDocument(n))))}async updateDocument(e){if(this.pendingUpdates.has(e))return;let r=new Ph;this.pendingUpdates.set(e,r.promise);let n;this.activeDocuments.has(e)?n=this.activeDocuments.get(e):this.cachedDocuments.has(e)&&(n=this.cachedDocuments.get(e).item,this.cachedDocuments.uncache(e)),(n===void 0||this.staleDocuments.has(e))&&(this.staleDocuments.delete(e),n=await this.createUpdatedDocument(e,n)),n!==void 0&&this.isStarted()&&(this.targetSet.has(e)?this.activeDocuments.set(e,n):(this.activeDocuments.delete(e),this.cachedDocuments.set(e,new dee(n,i=>this.disposeDocument(i))))),this.pendingUpdates.delete(e),r.resolve()}async createUpdatedDocument(e,r){let n=await this.readTextDocument(e);if(n===void 0){r!==void 0&&this.disposeDocument(r);return}let i;try{i=await this.getParser(n.detectedLanguageId)}catch{this.invalidDocumentCache.set(e,!0),r!==void 0&&this.disposeDocument(r);return}if(r!==void 0)if(n.detectedLanguageId!==r.document.detectedLanguageId)this.disposeDocument(r);else{let a=new Set(r.getAllIds());r.update(n);let c=new Set(r.getAllIds()),l=[...c].filter(f=>!a.has(f)),u=[...a].filter(f=>!c.has(f));return this.recordDocumentChanges(e,{created:l,invalidated:u}),r}let o=new cee(n,i,this.config.MinNodeSize);return this.recordDocumentChanges(e,{created:o.getAllIds(),invalidated:[]}),o}disposeDocument(e){this.recordDocumentChanges(e.uri,{created:[],invalidated:e.getAllIds()})}recordDocumentChanges(e,r){let n=Fh(this.createdNodes,e,()=>new Set),i=Fh(this.invalidatedNodes,e,()=>new Set);for(let o of r.created)n.add(o),this.nodeToDoc.set(o,e);for(let o of r.invalidated)n.has(o)?n.delete(o):i.add(o),this.nodeToDoc.delete(o)}async getParser(e){let r=this.parsers.get(e);return r===void 0&&(r=await qXe(e),this.parsers.set(e,r)),r}async readTextDocument(e){if(this.invalidDocumentCache.has(e)||this.normalizeUri(e)===void 0)return;let r=this.ctx.get(dr),n=r.getWorkspaceFolder({uri:e}),i=!0;if(n!==void 0){let a=r.getRelativePath({uri:e});a!==void 0&&(await this.ctx.get(Y0).findFiles(a,{uri:n.uri},{excludeGitignoredFiles:!0,excludeIDEIgnoredFiles:!0,excludeIDESearchIgnoredFiles:!0})).includes(e)&&(i=!1)}if(i){vzt.debug(this.ctx,`${e} is excluded from workspace context`),this.invalidDocumentCache.set(e,!0,3600*1e3);return}let o=await this.ctx.get(En).getOrReadTextDocument({uri:e});if(o.status!=="valid"||o.document.uri!==e){this.invalidDocumentCache.set(e,!0);return}return o.document}handleDocumentChange(e){let r=e.document.uri;this.isKnownDocument(r)&&this.staleDocuments.add(r)}};var $Xe=Be(require("events"));var xzt={UpdateInterval:500,InvalidCacheTime:1e3*60*10,StaleWeightHalflife:1e3*10,MinNodeSize:100,Laziness:.5,MaxActiveFiles:20,MaxActiveNodes:2e3},FA=class t{constructor(e){this.ctx=e;this.didStart=!1;this.didDispose=!1;this.deferredStart=new Ph;this.config=xzt;this.emitter=new $Xe.default;this.flushUpdatesPromise=void 0;this.emitter.setMaxListeners(27),this.contextManager=new fee(e,this.config),this.coordinator=new see(this.contextManager,this.config),this.tokenEventDisposable=_a(e,r=>{this.maybeStart(r)})}static{s(this,"WorkspaceContextFeature")}static{this.UpdateEventName="WorkspaceContextUpdate"}static{this.DisposeEventName="WorkspaceContextDispose"}async maybeStart(e){if(this.didStart||this.didDispose)return;let r=zi(this.ctx,Ht.UseWorkspaceContextCoordinator);if(r===void 0&&e){let n=await this.ctx.get(Mt).updateExPValuesAndAssignments(e);r=this.isEnabled(n)}r&&(this.start(),this.tokenEventDisposable.dispose())}isActive(){return this.didStart&&!this.didDispose}get activation(){return this.deferredStart.promise}isEnabled(e){return zi(this.ctx,Ht.UseWorkspaceContextCoordinator)??this.ctx.get(Mt).workspaceContextCoordinator(e)}start(){this.didStart||(this.didStart=!0,this.contextManager.start(),this.deferredStart.resolve(),this.loop())}dispose(){this.isActive()?(this.emitter.emit(t.DisposeEventName),this.contextManager.dispose()):!this.didDispose&&!this.didStart&&this.tokenEventDisposable.dispose(),this.didDispose=!0}pushWorkspaceContext(e,r){this.isActive()&&this.coordinator.pushWorkspaceContext(e,r)}getWorkspaceContext(){return this.contextManager}getWorkspaceContextWeights(){return this.coordinator.getWeights()}onUpdate(e){return this.emitter.on(t.UpdateEventName,e),hn.Disposable.create(()=>this.emitter.off(t.UpdateEventName,e))}onDisposal(e){return this.emitter.on(t.DisposeEventName,e),hn.Disposable.create(()=>this.emitter.off(t.DisposeEventName,e))}setContextLanguages(e){this.contextManager.setAllowedLanguages(e)}async loop(){try{for(;this.isActive();){let e=this.coordinator.updateWeights(),r=e.documents.slice(0,this.config.MaxActiveFiles).map(({uri:n})=>n);if(this.contextManager.trySetActiveDocuments(r),this.flushUpdatesPromise=this.contextManager.flushUpdates(),await this.flushUpdatesPromise,this.isActive()){let n=this.config.UpdateInterval,i={weights:e,context:this.contextManager,changes:this.contextManager.popChanges(),responseInterval:n};this.emitter.emit(t.UpdateEventName,i),await WC(n)}}}catch(e){vx(this.ctx,e,"WorkspaceContextFeature.loop"),this.dispose()}}};function rEe(t,e){let r=Xl(t,e,"event.WorkspaceContextUpdate");return t.get(FA).onUpdate(r)}s(rEe,"onWorkspaceContextUpdate");d();var Ezt=2e4,pee=class{constructor(e){this.ctx=e;this.name="workspaceContext";this.documents=new Map;this.root=JT;this.costFunction=Xxe(new vT);this.disposables=[];this.costCache=new Sr(Ezt);this.rootWithPathCache=new Sr;this.disposables.push(rEe(e,r=>{(this.nextUpdateTime===void 0||performance.now()>=this.nextUpdateTime)&&setTimeout(()=>{this.update(r.weights,r.context)},0)}))}static{s(this,"WorkspaceContextPromptComponent")}snapshot(e){let{completionState:r,telemetryData:n}=e;this.nextUpdateTime=this.lastUpdateTime!==void 0?this.lastUpdateTime+this.ctx.get(Mt).workspaceContextCacheTime(n):performance.now();let i=Fh(this.rootWithPathCache,r.textDocument.uri,()=>{let a=Xxe(Li(e.promptOpts?.tokenizer));this.costFunction=l=>Fh(this.costCache,l.id,()=>a(l));let c=this.getPathMarker(r);return new Dp(hc(),[`${c}
`,""],[this.root],1,0,!0,"")}),o=this.getMask(r.textDocument.uri);return{root:i,mask:o}}getRoot(){return this.root}getMask(e){let r=this.documents.get(e);return r===void 0?[]:[r.id]}getPathMarker(e){let r=e.textDocument,n=this.ctx.get(dr),i=n.getRelativePath(e.textDocument),o={uri:r.uri,source:"",relativePath:i,languageId:r.detectedLanguageId},a=n.findNotebook(r);return o.relativePath&&!a?VC(yZ(o),o.languageId):VC(AZ(o),o.languageId)}update(e,r){this.rootWithPathCache.clear(),this.documents.clear();for(let{uri:n}of e.documents){let i=r.getDocument(n);if(i?.isActive!==!0)continue;let o=this.createAnnotatedDocumentRoot(i.document),a=D7(o,this.costFunction);this.documents.set(n,a),a.updateWeights(l=>e.getNodeWeight(l.id)??0),a.requireRenderedChild=!0;let c=a.children[0];c.requireRenderedChild=c.children.length>0}this.root=this.createRootNode(),this.lastUpdateTime=performance.now()}createRootNode(){let e=new Array(this.documents.size+1).fill(""),r=[...this.documents.values()];return new Dp(hc(),e,r,1,0,!0,"")}createAnnotatedDocumentRoot(e){return{text:[this.getDocumentAnnotation(e.uri,e.document.detectedLanguageId),`

`],children:[e.root],id:hc(),elisionMarker:"",canMerge:!0}}getDocumentAnnotation(e,r){let i=this.ctx.get(dr).getRelativePath({uri:e});return VC(`Related portions of ${i??e}:
`,r)}dispose(){for(let e of this.disposables)e.dispose();this.disposables=[]}};d();d();var mee=class extends oee{static{s(this,"WorkspaceContextPromptFactory")}constructor(e){let r={stableContext:new pee(e),prefix:new eee,suffix:new tee(e),volatileContext:new iee("volatileContext",[new ree,new nee(e)])};super(e,r)}};var WXe=Be(hi());var Fx=class{static{s(this,"CompletionsPromptFactory")}};function hee(t,e,r){return new nEe(new iEe(new oEe(t,new KZ(t,e,r),new mee(t),Izt)))}s(hee,"createCompletionsPromptFactory");var nEe=class extends Fx{constructor(r){super();this.delegate=r}static{s(this,"SequentialCompletionsPromptFactory")}async prompt(r,n){return this.lastPromise=this.promptAsync(r,n),this.lastPromise}async promptAsync(r,n){if(await this.lastPromise,n?.isCancellationRequested)return Lx;try{return await this.delegate.prompt(r,n)}catch{return U3}}},bzt=1200,iEe=class{constructor(e){this.delegate=e}static{s(this,"TimeoutHandlingCompletionsPromptFactory")}async prompt(e,r){let n=new WXe.CancellationTokenSource,i=n.token;return r?.onCancellationRequested(()=>{n.cancel()}),await Promise.race([this.delegate.prompt(e,i),new Promise(o=>{setTimeout(()=>{n.cancel(),o(jXe)},bzt)})])}},oEe=class{constructor(e,r,n,i){this.ctx=e;this.defaultDelegate=r;this.experimentalDelegate=n;this.fn=i}static{s(this,"ExperimentalCompletionsPromptFactory")}async prompt(e,r){return this.fn(this.ctx,e.telemetryData)?this.experimentalDelegate.prompt(e,r):this.defaultDelegate.prompt(e,r)}};function Izt(t,e){let r=t.get(FA);return r.isEnabled(e)&&r.isActive()}s(Izt,"workspaceContextEnabledAndActive");var YZ=10,JZ={type:"contextTooShort"},XZ={type:"copilotContentExclusion"},U3={type:"promptError"},Lx={type:"promptCancelled"},jXe={type:"promptTimeout"};function YT(t){let e=t.split(`
`),r=e[e.length-1],n=r.length-r.trimEnd().length,i=t.slice(0,t.length-n),o=t.slice(i.length);return[r.length==n?i:t,o]}s(YT,"trimLastLine");function $3(t,e,r,n,i,o={}){let c=t.get(dr).findNotebook(r.textDocument),l=c?.getCellFor(r.textDocument);c&&l&&(r=wzt(r,c,l)),n.extendWithConfigProperties(t),n.sanitizeKeys();let u=TXe(t,n);return t.get(Fx).prompt({completionId:e,completionState:r,telemetryData:n,promptOpts:{...o,separateContext:u}},i)}s($3,"extractPrompt");function Tzt(t,e){let r=t.document.detectedLanguageId,n=t.document.getText();return r===e?n:VC(n,e)}s(Tzt,"addNeighboringCellsToPrompt");function wzt(t,e,r){let i=e.getCells().filter(c=>c.index<r.index&&FZ(r.document.detectedLanguageId,c.document.detectedLanguageId)),o=i.length>0?i.map(c=>Tzt(c,r.document.detectedLanguageId)).join(`

`)+`

`:"",a={line:0,character:0};return t.applyEdits([{newText:o,range:{start:a,end:a}}])}s(wzt,"applyEditsForNotebook");function Q3(t,e,r){let i=t.get(Mt).maxPromptCompletionTokens(e)-$X(t),o=LJe(e,r),a=uZ(t,e,r),c=t.get(Mt).suffixPercent(e),l=t.get(Mt).suffixMatchThreshold(e);if(c<0||c>100)throw new Error(`suffixPercent must be between 0 and 100, but was ${c}`);if(l<0||l>100)throw new Error(`suffixMatchThreshold must be between 0 and 100, but was ${l}`);return{maxPromptLength:i,similarFilesOptions:a,numberOfSnippets:o,suffixPercent:c,suffixMatchThreshold:l}}s(Q3,"getPromptOptions");d();d();var GXe=2.98410452738298,VXe=-.838732736843507,zXe=1.50314646255716,KXe=-.237798634012662,gee={python:.314368072478742},YXe={"0.01":.225800751784931,"0.02":.290204307767402,"0.03":.333153496466045,"0.05":.404516749849559,"0.1":.513216040545626,"0.2":.626904979128674,"0.3":.694880719658273,"0.4":.743100684947291,"0.5":.782524520571946,"0.6":.816856186092243,"0.7":.84922977716585,"0.8":.883694877241999,"0.9":.921859050950077,"0.95":.944571268106974,"0.99":.969535563141733};var Szt={link:s(t=>Math.exp(t)/(1+Math.exp(t)),"link"),unlink:s(t=>Math.log(t/(1-t)),"unlink")};function _zt(t,e){let r=Math.min(...Array.from(e.keys()).filter(a=>a>=t)),n=Math.max(...Array.from(e.keys()).filter(a=>a<t)),i=e.get(r),o=e.get(n);return o+(i-o)*(t-n)/(r-n)}s(_zt,"linearInterpolation");var W3=class{static{s(this,"Regressor")}constructor(e,r,n){this.name=e,this.coefficient=r,this.transformation=n||(i=>i)}contribution(e){return this.coefficient*this.transformation(e)}},sEe=class{constructor(e,r,n){this.link=Szt;if(this.intercept=e,this.coefficients=r,this.logitsToQuantiles=new Map,this.logitsToQuantiles.set(0,0),this.logitsToQuantiles.set(1,1),n)for(let i in n)this.logitsToQuantiles.set(n[i],Number(i))}static{s(this,"LogisticRegression")}predict(e,r){let n=this.intercept;for(let i of this.coefficients){let o=r[i.name];if(o===void 0)return NaN;n+=i.contribution(o)}return this.link.link(n)}quantile(e,r){let n=this.predict(e,r);return _zt(n,this.logitsToQuantiles)}},JXe=new sEe(GXe,[new W3("compCharLen",VXe,t=>Math.log(1+t)),new W3("meanLogProb",zXe),new W3("meanAlternativeLogProb",KXe)].concat(Object.entries(gee).map(t=>new W3(t[0],t[1]))),YXe);function XXe(t,e){let r={...e.measurements};return Object.keys(gee).forEach(n=>{r[n]=e.properties["customDimensions.languageId"]==n?1:0}),JXe.predict(t,r)}s(XXe,"ghostTextScoreConfidence");function ZXe(t,e){let r={...e.measurements};return Object.keys(gee).forEach(n=>{r[n]=e.properties["customDimensions.languageId"]==n?1:0}),JXe.quantile(t,r)}s(ZXe,"ghostTextScoreQuantile");d();d();var Rzt=[{max_token_sequence_length:1,last_tokens_to_consider:10},{max_token_sequence_length:10,last_tokens_to_consider:30},{max_token_sequence_length:20,last_tokens_to_consider:45},{max_token_sequence_length:30,last_tokens_to_consider:60}];function Aee(t){let e=t.slice();return e.reverse(),eZe(e)||eZe(e.filter(r=>r.trim().length>0))}s(Aee,"isRepetitive");function eZe(t){let e=kzt(t);for(let r of Rzt){if(t.length<r.last_tokens_to_consider)continue;if(r.last_tokens_to_consider-1-e[r.last_tokens_to_consider-1]<=r.max_token_sequence_length)return!0}return!1}s(eZe,"isRepeatedPattern");function kzt(t){let e=Array(t.length).fill(0);e[0]=-1;let r=-1;for(let n=1;n<t.length;n++){for(;r>=0&&t[r+1]!==t[n];)r=e[r];t[r+1]===t[n]&&r++,e[n]=r}return e}s(kzt,"kmp_prefix_function");function Pzt(t,e,r,n){let i="}";try{i=bje(e.detectedLanguageId)??"}"}catch{}return Dzt({getLineText:s(o=>e.lineAt(o).text,"getLineText"),getLineCount:s(()=>e.lineCount,"getLineCount")},r,n,i)}s(Pzt,"maybeSnipCompletion");function Dzt(t,e,r,n){let i=Bzt(r),o=i.lines;if(o.length===1)return r;for(let a=1;a<o.length;a++){let c=!0,l=0,u=0;for(let f=0;f+a+u<o.length;f++){let p;for(;;){let A=e.line+1+f+l;if(p=A>=t.getLineCount()?void 0:t.getLineText(A),p!==void 0&&p.trim()==="")l++;else break}let m,h;for(;m=a+f+u,h=m>=o.length?void 0:o[m],h!==void 0&&h.trim()==="";)u++;let g=m===o.length-1;if(!h||!(p&&(g?p.startsWith(h)||h.startsWith(p):p===h&&h.trim()===n))){c=!1;break}}if(c)return o.slice(0,a).join(i.newLineCharacter)}return r}s(Dzt,"maybeSnipCompletionImpl");function Bzt(t){let e=t.includes(`\r
`)?`\r
`:`
`;return{lines:t.split(e),newLineCharacter:e}}s(Bzt,"splitByNewLine");function Nzt(t,e,r,n){let i="",o=e.line+1,a=n?r.trim():r;for(;i===""&&o<t.lineCount;){if(i=t.lineAt(o).text,n&&(i=i.trim()),i===a)return!0;o++}return!1}s(Nzt,"matchesNextLine");function B7(t,e,r,n,i,o){if(Aee(n.tokens)){let c=Vr.createAndMarkAsIssued();c.extendWithRequestId(n.requestId),Bt(t,"repetition.detected",c,1),o.info(t,"Filtered out repetitive solution");return}let a={...n};if(Nzt(e,r,a.completionText,!i)){let c=Vr.createAndMarkAsIssued();c.extendWithRequestId(n.requestId),Bt(t,"completion.alreadyInDocument",c),Bt(t,"completion.alreadyInDocument",c.extendedBy({completionTextJson:JSON.stringify(a.completionText)}),1),o.info(t,"Filtered out solution matching next line");return}return a.completionText=Pzt(t,e,r,a.completionText),a.completionText?a:void 0}s(B7,"postProcessChoiceInContext");function tZe(t,e,r){let i=t.lineAt(e.line).text.substring(e.character);if(i.length>0){if(r.completionText.indexOf(i)!==-1)return i.length;{let o=-1,a=0;for(let c of i){let l=r.completionText.indexOf(c,o+1);if(l>o)a++,o=l;else break}return a}}return 0}s(tZe,"checkSuffix");var oZe=Be(yI());var ps=new dt("ghostText");var rZe=20;async function sZe(t,e,r,n,i,o,a){ps.debug(t,`Getting ${o} from network`),r=r.extendedBy();let c=e.isCycling?3:1,l=E3(t,c),u={language:e.languageId,next_indent:e.indentation.next??0,trim_by_indentation:_je(e.blockMode),prompt_tokens:e.prompt.prefixTokens??0,suffix_tokens:e.prompt.suffixTokens??0},f={n:c,temperature:l,code_annotations:!1},p=zi(t,Ht.ModelAlwaysTerminatesSingleline)??t.get(Mt).modelAlwaysTerminatesSingleline(r),m=e.blockMode==="moremultiline"&&UC.isSupported(e.languageId)&&!p;!e.multiline&&!m?f.stop=[`
`]:e.stop&&(f.stop=e.stop),e.maxTokens!==void 0&&(f.max_tokens=e.maxTokens);let h=Date.now(),g={endpoint:"completions",uiKind:"ghostText",temperature:JSON.stringify(l),n:JSON.stringify(c),stop:JSON.stringify(f.stop)??"unset",logit_bias:JSON.stringify(null)};Object.assign(r.properties,g);try{let A={prompt:e.prompt,languageId:e.languageId,repoInfo:e.repoInfo,ourRequestId:e.ourRequestId,engineModelId:e.engineModelId,count:c,uiKind:"ghostText",postOptions:f,headers:e.headers,extra:u},y=await t.get(Rp).fetchAndStreamCompletions(t,A,r,i,n);return y.type==="failed"?{type:"failed",reason:y.reason,telemetryData:pc(r)}:y.type==="canceled"?(ps.debug(t,"Cancelled after awaiting fetchCompletions"),{type:"canceled",reason:y.reason,telemetryData:WT(r)}):a(h,y.getProcessingTime(),y.choices)}catch(A){if(Td(A))return{type:"canceled",reason:"network request aborted",telemetryData:WT(r,{cancelledNetworkRequest:!0})};if(ps.exception(t,A,"Error on ghost text request"),t.get(fp).notifyUser(t,A),M4(t))throw A;return{type:"failed",reason:"non-abort error on ghost text request",telemetryData:pc(r)}}}s(sZe,"genericGetCompletionsFromNetwork");function aEe(t,e,r){if(r||(r=[]),t.completionText=t.completionText.trimEnd(),!!t.completionText&&r.findIndex(n=>n.completionText.trim()===t.completionText.trim())===-1)return t}s(aEe,"postProcessChoices");async function Lzt(t,e,r,n,i){return sZe(t,e,r,n,i,"completions",async(o,a,c)=>{let u=await c[Symbol.asyncIterator]().next();if(u.done)return ps.debug(t,"All choices redacted"),{type:"empty",reason:"all choices redacted",telemetryData:pc(r)};if(n?.isCancellationRequested)return ps.debug(t,"Cancelled after awaiting redactedChoices iterator"),{type:"canceled",reason:"after awaiting redactedChoices iterator",telemetryData:WT(r)};let f=u.value;if(f===void 0)return ps.debug(t,"Got undefined choice from redactedChoices iterator"),{type:"empty",reason:"got undefined choice from redactedChoices iterator",telemetryData:pc(r)};cZe(t,"performance",f,o,a),ps.debug(t,`Awaited first result, id:  ${f.choiceIndex}`);let p=aEe(f,e);p&&(yee(t,e,p),ps.debug(t,`GhostText first completion (index ${p?.choiceIndex}): ${JSON.stringify(p?.completionText)}`));let m=(async()=>{let h=p!==void 0?[p]:[];for await(let g of c){if(g===void 0)continue;ps.debug(t,`GhostText later completion (index ${g?.choiceIndex}): ${JSON.stringify(g.completionText)}`);let A=aEe(g,e,h);A&&(h.push(A),yee(t,e,A))}})();return Kg(t)&&await m,p?{type:"success",value:[cEe(p,{forceSingleLine:!1}),m],telemetryData:pc(r),telemetryBlob:r,resultType:0}:{type:"empty",reason:"got undefined processedFirstChoice",telemetryData:pc(r)}})}s(Lzt,"getCompletionsFromNetwork");async function Fzt(t,e,r,n,i){return sZe(t,e,r,n,i,"all completions",async(o,a,c)=>{let l=[];for await(let u of c){if(n?.isCancellationRequested)return ps.debug(t,"Cancelled after awaiting choices iterator"),{type:"canceled",reason:"after awaiting choices iterator",telemetryData:WT(r)};let f=aEe(u,e,l);f&&l.push(f)}if(l.length>0){for(let u of l)yee(t,e,u);cZe(t,"cyclingPerformance",l[0],o,a)}return{type:"success",value:[l,Promise.resolve()],telemetryData:pc(r),telemetryBlob:r,resultType:3}})}s(Fzt,"getAllCompletionsFromNetwork");function cEe(t,e){let r={...t};if(e.forceSingleLine){let{completionText:n}=r,i=n.match(/^\r?\n/);i?r.completionText=i[0]+n.split(`
`)[1]:r.completionText=n.split(`
`)[0]}return r}s(cEe,"makeGhostAPIChoice");function nZe(t){return e=>{let r=e?.split(`
`)??[];if(r.length>t+1)return r.slice(0,t+1).join(`
`).length}}s(nZe,"takeNLines");async function Ozt(t,e,r,n,i,o,a,c){let l=t.get(Mt).multilineAfterAcceptLines(c),u=t.get(bA).forLanguage(t,e.textDocument.detectedLanguageId,c);switch(u){case"server":return a?{blockMode:"parsing",requestMultiline:!0,finishedCb:nZe(l),stop:[`

`],maxTokens:rZe*l}:{blockMode:"server",requestMultiline:!0,finishedCb:s(f=>{},"finishedCb")};case"parsing":case"parsingandserver":case"moremultiline":default:{let f;try{f=await Vzt(t,u,e.textDocument,e.position,o,a,n)}catch{f={requestMultiline:!1}}if(!a&&f.requestMultiline&&t.get(Mt).singleLineUnlessAccepted(c)&&(f.requestMultiline=!1),f.requestMultiline){let p;return n.trailingWs.length>0&&!n.prompt.prefix.endsWith(n.trailingWs)?p=Es.position(e.position.line,Math.max(e.position.character-n.trailingWs.length,0)):p=e.position,{blockMode:u,requestMultiline:!0,...iZe(t,u,e.textDocument,p,f.blockPosition,r,!0,n.prompt,c)}}if(a){let p={blockMode:"parsing",requestMultiline:!0,finishedCb:nZe(l),stop:[`

`],maxTokens:rZe*l};return u==="moremultiline"&&(p.blockMode="moremultiline"),p}return{blockMode:u,requestMultiline:!1,...iZe(t,u,e.textDocument,e.position,f.blockPosition,r,!1,n.prompt,c)}}}}s(Ozt,"getGhostTextStrategy");function iZe(t,e,r,n,i,o,a,c,l){if(a&&e==="moremultiline"&&UC.isSupported(r.detectedLanguageId)){let u=i==="empty-block"||i==="block-end"?t.get(Mt).longLookaheadSize(l):t.get(Mt).shortLookaheadSize(l);return{finishedCb:new WX(t,o,r.detectedLanguageId,!1,u,(p,m)=>{let h={prefix:o+p,prompt:{...c,prefix:c.prefix+p}};yee(t,h,m)}).getFinishedCallback(),maxTokens:t.get(Mt).maxMultilineTokens(l)}}return{finishedCb:a?C7(t,r,n):u=>{}}}s(iZe,"buildFinishedCallback");var Qzt={isCycling:!1,promptOnly:!1,isSpeculative:!1};function Uzt(t,e,r){let n=zi(t,Ht.CompletionsDebounce)??t.get(Mt).completionsDebounce(r)??e.debounceMs;if(n===void 0)return 0;let i=Ba()-r.issuedTime;return Math.max(0,n-i)}s(Uzt,"getRemainingDebounceMs");function N7(t,e,r){return r?.isCancellationRequested||e!==t.get(Bp).currentRequestId}s(N7,"inlineCompletionRequestCancelled");async function qzt(t,e,r,n,i,o){let a=n.issuedTime,c=[];function l(y){let E=Ba();c.push([y,E-a]),a=E}s(l,"recordPerformance"),l("telemetry");let u=t.get(Mt);if(N7(t,r,i))return{type:"abortedBeforeIssued",reason:"cancelled before extractPrompt",telemetryData:pc(n)};let f=$zt(e.textDocument,e.position);if(f===void 0)return ps.debug(t,"Breaking, invalid middle of the line"),{type:"abortedBeforeIssued",reason:"Invalid middle of the line",telemetryData:pc(n)};let p=ET(t,n),m={...Qzt,...o,tokenizer:p.tokenizer},h=await $3(t,r,e,n,void 0,m);if(l("prompt"),h.type==="copilotContentExclusion")return ps.debug(t,"Copilot not available, due to content exclusion"),{type:"abortedBeforeIssued",reason:"Copilot not available due to content exclusion",telemetryData:pc(n)};if(h.type==="contextTooShort")return ps.debug(t,"Breaking, not enough context"),{type:"abortedBeforeIssued",reason:"Not enough context",telemetryData:pc(n)};if(h.type==="promptError")return ps.debug(t,"Error while building the prompt"),{type:"abortedBeforeIssued",reason:"Error while building the prompt",telemetryData:pc(n)};if(m.promptOnly)return{type:"promptOnly",reason:"Breaking, promptOnly set to true",prompt:h};if(h.type==="promptCancelled")return ps.debug(t,"Cancelled during extractPrompt"),{type:"abortedBeforeIssued",reason:"Cancelled during extractPrompt",telemetryData:pc(n)};if(h.type==="promptTimeout")return ps.debug(t,"Timeout during extractPrompt"),{type:"abortedBeforeIssued",reason:"Timeout",telemetryData:pc(n)};if(h.prompt.prefix.length===0&&h.prompt.suffix.length===0)return ps.debug(t,"Error empty prompt"),{type:"abortedBeforeIssued",reason:"Empty prompt",telemetryData:pc(n)};let g=Uzt(t,m,n);return g>0&&(ps.debug(t,`Debouncing ghost text request for ${g}ms`),await WC(g),N7(t,r,i))?{type:"abortedBeforeIssued",reason:"cancelled after debounce",telemetryData:pc(n)}:t.get(qo).withProgress(async()=>{let[y]=YT(e.textDocument.getText(Es.range(Es.position(0,0),e.position))),E=t.get(Bp).hasAcceptedCurrentCompletion(y,h.prompt.suffix),b=h.prompt,S=await Ozt(t,e,y,h,m.isCycling,f,E,n);l("strategy");let R=Hzt(t,y,b,S.requestMultiline);l("cache");let B=bT(t,e.textDocument.uri),L={blockMode:S.blockMode,languageId:e.textDocument.detectedLanguageId,repoInfo:B,engineModelId:p.modelId,ourRequestId:r,prefix:y,prompt:h.prompt,multiline:S.requestMultiline,indentation:sZ(e.textDocument,e.position),isCycling:m.isCycling,headers:p.headers,stop:S.stop,maxTokens:S.maxTokens,afterAccept:E};L.headers={...L.headers,"X-Copilot-Async":"true","X-Copilot-Speculative":m.isSpeculative?"true":"false"};let O=Xzt(t,e.textDocument,L,e.position,h,n,p,m);if(R===void 0&&!m.isCycling&&t.get(_p).shouldWaitForAsyncCompletions(y,h.prompt)){let W=await t.get(_p).getFirstMatchingRequestWithTimeout(r,y,h.prompt,m.isSpeculative,O);if(l("asyncWait"),W){let X=!S.requestMultiline;R=[[cEe(W[0],{forceSingleLine:X})],4]}if(N7(t,r,i))return ps.debug(t,"Cancelled before requesting a new completion"),{type:"abortedBeforeIssued",reason:"Cancelled after waiting for async completion",telemetryData:pc(O)}}let Y=S.blockMode==="moremultiline"&&UC.isSupported(e.textDocument.detectedLanguageId);if(R!==void 0&&(R[0]=R[0].map(W=>B7(t,e.textDocument,e.position,W,Y,ps)).filter(W=>W!==void 0)),R!==void 0&&R[0].length===0)return ps.debug(t,`Found empty inline suggestions locally via ${b3(R[1])}`),{type:"empty",reason:"cached results empty after post-processing",telemetryData:pc(O)};if(R!==void 0&&R[0].length>0&&(!m.isCycling||R[0].length>1))ps.debug(t,`Found inline suggestions locally via ${b3(R[1])}`);else{if(m.isCycling){let W=await Fzt(t,L,O,i,S.finishedCb);if(W.type==="success"){let X=R?.[0]??[];W.value[0].forEach(oe=>{X.findIndex(te=>te.completionText.trim()===oe.completionText.trim())===-1&&X.push(oe)}),R=[X,3]}else if(R===void 0)return W}else{let W=s((re,pe)=>(t.get(_p).updateCompletion(r,re),S.finishedCb(re,pe)),"finishedCb"),X=new hn.CancellationTokenSource,oe=Lzt(t,L,O,X.token,W);t.get(_p).queueCompletionRequest(r,y,h.prompt,X,oe);let te=await t.get(_p).getFirstMatchingRequest(r,y,h.prompt,m.isSpeculative);if(te===void 0)return{type:"empty",reason:"received no results from async completions",telemetryData:pc(O)};R=[[te[0]],4]}l("network")}if(R===void 0)return{type:"failed",reason:"internal error: choices should be defined after network call",telemetryData:pc(O)};let[V,z]=R,Q=V.map(W=>B7(t,e.textDocument,e.position,W,Y,ps)).filter(W=>W!==void 0),U=zi(t,Ht.CompletionsDelay)??u.completionsDelay(n),Z=Ba()-n.issuedTime,J=Math.max(U-Z,0);if(z!==2&&!m.isCycling&&J>0&&(ps.debug(t,`Waiting ${J}ms before returning completion`),await WC(J),N7(t,r,i)))return ps.debug(t,"Cancelled after completions delay"),{type:"canceled",reason:"after completions delay",telemetryData:WT(O)};let j=[];for(let W of Q){let X=Jzt(t,e.textDocument,L,W,O),oe=f?tZe(e.textDocument,e.position,W):0,re={completion:zzt(W.choiceIndex,W.completionText,h.trailingWs),telemetry:X,isMiddleOfTheLine:f,suffixCoverage:oe,copilotAnnotations:W.copilotAnnotations,clientCompletionId:W.clientCompletionId};j.push(re)}return O.properties.clientCompletionId=j[0]?.clientCompletionId,O.measurements.foundOffset=j?.[0]?.telemetry?.measurements?.foundOffset??-1,ps.debug(t,`Produced ${j.length} results from ${b3(z)} at ${O.measurements.foundOffset} offset`),N7(t,r,i)?{type:"canceled",reason:"after post processing completions",telemetryData:WT(O)}:(m.isSpeculative||t.get(Bp).setGhostText(y,h.prompt.suffix,Q,z),l("complete"),{type:"success",value:[j,z],telemetryData:pc(O),telemetryBlob:O,resultType:z,performanceMetrics:c})})}s(qzt,"getGhostTextWithoutAbortHandling");async function lEe(t,e,r,n){let i=br();t.get(Bp).currentRequestId=i;let o=await Yzt(t,e.textDocument,i,n);await cR.catch(()=>{});try{return t.get(kp).schedule(e,i,n?.opportunityId??"",o,r,n),t.get($C).notifyRequest(e,i,o,r,n),await qzt(t,e,i,o,r,n)}catch(a){if(Td(a))return{type:"canceled",reason:"aborted at unknown location",telemetryData:WT(o,{cancelledNetworkRequest:!0})};throw a}}s(lEe,"getGhostText");function Hzt(t,e,r,n){let i=t.get(Bp).getCompletionsForUserTyping(e,r.suffix),o=Kzt(t,e,r.suffix,n);if(i&&i.length>0){let a=(o??[]).filter(c=>!i.some(l=>l.completionText===c.completionText));return[i.concat(a),2]}if(o&&o.length>0)return[o,1]}s(Hzt,"getLocalInlineSuggestion");function $zt(t,e){let r=Wzt(e,t),n=jzt(e,t);return r&&!n?void 0:r&&n}s($zt,"isInlineSuggestion");function Wzt(t,e){return e.lineAt(t).text.substr(t.character).trim().length!=0}s(Wzt,"isMiddleOfTheLine");function jzt(t,e){let n=e.lineAt(t).text.substr(t.character).trim();return/^\s*[)>}\]"'`]*\s*[:{;,]?\s*$/.test(n)}s(jzt,"isValidMiddleOfTheLinePosition");function Gzt(t,e){return e.lineAt(t).text.trim().length===0}s(Gzt,"isNewLine");var Ox=class t{constructor(e=!1){this.requestMultilineOverride=e}static{s(this,"ForceMultiLine")}static{this.default=new t}};async function Vzt(t,e,r,n,i,o,a){if(t.get(Ox).requestMultilineOverride)return{requestMultiline:!0};if(r.lineCount>=8e3)Bt(t,"ghostText.longFileMultilineSkip",Vr.createAndMarkAsIssued({languageId:r.detectedLanguageId,lineCount:String(r.lineCount),currentLine:String(n.line)}));else{if(e=="moremultiline"&&UC.isSupported(r.detectedLanguageId))return o?{requestMultiline:!0,blockPosition:await Tje(r,n)}:{requestMultiline:!1};if(["typescript","typescriptreact"].includes(r.detectedLanguageId)&&Gzt(n,r))return{requestMultiline:!0};let l=!1;return!i&&U0(r.detectedLanguageId)?l=await oZ(r,n):i&&U0(r.detectedLanguageId)&&(l=await oZ(r,n)||await oZ(r,r.lineAt(n).range.end)),l||["javascript","javascriptreact","python"].includes(r.detectedLanguageId)&&(l=OYe(a.prompt,r.detectedLanguageId)>.5),{requestMultiline:l}}return{requestMultiline:!1}}s(Vzt,"shouldRequestMultiline");function yee(t,e,r){t.get(DA).append(e.prefix,e.prompt.suffix,r)}s(yee,"appendToCache");function zzt(t,e,r){if(r.length>0){if(e.startsWith(r))return{completionIndex:t,completionText:e,displayText:e.substring(r.length),displayNeedsWsOffset:!1};{let n=e.substring(0,e.length-e.trimStart().length);return r.startsWith(n)?{completionIndex:t,completionText:e,displayText:e.trimStart(),displayNeedsWsOffset:!0}:{completionIndex:t,completionText:e,displayText:e,displayNeedsWsOffset:!1}}}else return{completionIndex:t,completionText:e,displayText:e,displayNeedsWsOffset:!1}}s(zzt,"adjustLeadingWhitespace");function Kzt(t,e,r,n){let i=t.get(DA).findAll(e,r);return i.length===0?(ps.debug(t,"Found no completions in cache"),[]):(ps.debug(t,`Found ${i.length} completions in cache`),i.map(o=>cEe(o,{forceSingleLine:!n})))}s(Kzt,"getCompletionsFromCache");async function Yzt(t,e,r,n){let i={headerRequestId:r};n?.opportunityId&&(i.opportunityId=n.opportunityId),n?.selectedCompletionInfo?.text&&(i.completionsActive="true"),n?.isSpeculative&&(i.reason="speculative");let o=Vr.createAndMarkAsIssued(i);return await t.get(Mt).fetchTokenAndUpdateExPValuesAndAssignments({uri:e.uri,languageId:e.detectedLanguageId},o)}s(Yzt,"createTelemetryWithExp");function Jzt(t,e,r,n,i){let o=n.requestId,a={choiceIndex:n.choiceIndex.toString(),clientCompletionId:n.clientCompletionId};n.generatedChoiceIndex!==void 0&&(a.originalChoiceIndex=a.choiceIndex,a.choiceIndex=(1e4*(n.generatedChoiceIndex+1)+n.choiceIndex).toString());let c={compCharLen:n.completionText.length,numLines:n.completionText.trim().split(`
`).length};n.meanLogProb&&(c.meanLogProb=n.meanLogProb),n.meanAlternativeLogProb&&(c.meanAlternativeLogProb=n.meanAlternativeLogProb);let l=n.telemetryData.extendedBy(a,c);return l.issuedTime=i.issuedTime,l.measurements.timeToProduceMs=performance.now()-i.issuedTime,aZe(l,e),l.extendWithRequestId(o),l.measurements.confidence=XXe(t,l),l.measurements.quantile=ZXe(t,l),ps.debug(t,`Extended telemetry for ${n.telemetryData.properties.headerRequestId} with retention confidence ${l.measurements.confidence} (expected as good or better than about ${l.measurements.quantile} of all suggestions)`),l}s(Jzt,"telemetryWithAddData");function Xzt(t,e,r,n,i,o,a,c){let l={languageId:e.detectedLanguageId};l.afterAccept=r.afterAccept.toString(),l.isSpeculative=c.isSpeculative.toString();let u=o.extendedBy(l);aZe(u,e);let f=r.repoInfo;u.properties.gitRepoInformation=f===void 0?"unavailable":f===0?"pending":"available",f!==void 0&&f!==0&&(u.properties.gitRepoUrl=f.url,u.properties.gitRepoHost=f.hostname,u.properties.gitRepoOwner=f.owner,u.properties.gitRepoName=f.repo,u.properties.gitRepoPath=f.pathname),u.properties.engineName=a.modelId,u.properties.engineChoiceSource=a.engineChoiceSource,u.properties.isMultiline=JSON.stringify(r.multiline),u.properties.isCycling=JSON.stringify(r.isCycling);let p=e.lineAt(n.line),m=e.getText(Es.range(p.range.start,n)),h=e.getText(Es.range(n,p.range.end)),g=Array.from(i.neighborSource.entries()).map(b=>[b[0],b[1].map(S=>(0,oZe.SHA256)(S).toString())]),A={beforeCursorWhitespace:JSON.stringify(m.trim()===""),afterCursorWhitespace:JSON.stringify(h.trim()===""),neighborSource:JSON.stringify(g),blockMode:r.blockMode},y={...PD(i.prompt),promptEndPos:e.offsetAt(n),promptComputeTimeMs:i.computeTimeMs};i.metadata&&(A.promptMetadata=JSON.stringify(i.metadata)),i.contextProvidersTelemetry&&(A.contextProviders=JSON.stringify(i.contextProvidersTelemetry));let E=u.extendedBy(A,y);return Bt(t,"ghostText.issued",E),u}s(Xzt,"telemetryIssued");function aZe(t,e){t.measurements.documentLength=e.getText().length,t.measurements.documentLineCount=e.lineCount}s(aZe,"addDocumentTelemetry");function cZe(t,e,r,n,i){let o=Date.now()-n,a=o-i,c=r.telemetryData.extendedBy({},{completionCharLen:r.completionText.length,requestTimeMs:o,processingTimeMs:i,deltaMs:a,meanLogProb:r.meanLogProb||NaN,meanAlternativeLogProb:r.meanAlternativeLogProb||NaN});c.extendWithRequestId(r.requestId),Bt(t,`ghostText.${e}`,c)}s(cZe,"telemetryPerformance");var Bp=class{constructor(){this.choices=[]}static{s(this,"CurrentGhostText")}get clientCompletionId(){return this.choices[0]?.clientCompletionId}setGhostText(e,r,n,i){i!==2&&(this.prefix=e,this.suffix=r,this.choices=n)}getCompletionsForUserTyping(e,r){let n=this.getRemainingPrefix(e,r);if(n!==void 0&&lZe(this.choices[0].completionText,n))return Zzt(this.choices,n)}hasAcceptedCurrentCompletion(e,r){let n=this.getRemainingPrefix(e,r);if(n===void 0)return!1;let i=n===this.choices?.[0].completionText,o=this.choices?.[0].finishReason;return i&&o==="stop"}getRemainingPrefix(e,r){if(!(this.prefix===void 0||this.suffix===void 0||this.choices.length===0)&&this.suffix===r&&e.startsWith(this.prefix))return e.substring(this.prefix.length)}};function Zzt(t,e){return t.filter(r=>lZe(r.completionText,e)).map(r=>({...r,completionText:r.completionText.substring(e.length)}))}s(Zzt,"adjustChoicesStart");function lZe(t,e){return t.startsWith(e)&&t.length>e.length}s(lZe,"startsWithAndExceeds");d();d();d();var XR=class{constructor(e,r,n){this._referenceCount=0;this._isDisposed=!1;this._offset=n;let i=e.get(dr);this._tracker=i.onDidChangeTextDocument(o=>{if(o.document.uri===r){for(let a of o.contentChanges)if(a.rangeOffset+a.rangeLength<=this.offset){let c=a.text.length-a.rangeLength;this._offset=this._offset+c}}})}static{s(this,"ChangeTracker")}get offset(){return this._offset}push(e,r){if(this._isDisposed)throw new Error("Unable to push new actions to a disposed ChangeTracker");this._referenceCount++,setTimeout(()=>{e(),this._referenceCount--,this._referenceCount===0&&(this._tracker.dispose(),this._isDisposed=!0)},r)}};d();var uEe=class t{constructor(e,r,n=[],i,o,a){this._textDocument=e;this._position=r;this.originalPosition=i??hn.Position.create(r.line,r.character),this.originalVersion=o??e.version,this.originalOffset=a??e.offsetAt(this.originalPosition),this._editsWithPosition=[...n]}static{s(this,"CompletionState")}get textDocument(){return this._textDocument}get position(){return this._position}get editsWithPosition(){return[...this._editsWithPosition]}updateState(e,r,n){return new t(e,r,n??this.editsWithPosition,this.originalPosition,this.originalVersion,this.originalOffset)}updatePosition(e){return this.updateState(this._textDocument,e)}addSelectedCompletionInfo(e){if(this.editsWithPosition.find(n=>n.source==="selectedCompletionInfo"))throw new Error("Selected completion info already applied");let r={range:e.range,newText:e.text};return this.applyEdits([r],!0)}applyEdits(e,r=!1){if(r&&e.length>1)throw new Error("Selected completion info should be a single edit");let n=this._textDocument,i=this._position,o=n.offsetAt(i),a=this.editsWithPosition;for(let{range:c,newText:l}of e){let u=n.getText(c),f=n.offsetAt(c.end);if(n=n.applyEdits([{range:c,newText:l}]),o<n.offsetAt(c.start)){let m={range:c,newText:l,positionAfterEdit:hn.Position.create(i.line,i.character)};r&&(m.source="selectedCompletionInfo"),a.push(m);continue}o<f&&(o=f),o+=l.length-u.length,i=n.positionAt(o);let p={range:c,newText:l,positionAfterEdit:hn.Position.create(i.line,i.character)};r&&(p.source="selectedCompletionInfo"),a.push(p)}return this.updateState(n,i,a)}};function YC(t,e){return new uEe(t,e)}s(YC,"createCompletionState");d();d();d();d();d();d();var uZe="code-referencing";var Np=new dt(uZe);var eKt=3e3,dEe=2,dZe=256,fZe=Math.log(dZe)/Math.log(dEe)/dEe,OA={connection:"disabled",maxAttempts:fZe,retryAttempts:0,initialWait:!1},Cee,vee=[];function tKt(){if(Cee)return Cee;function t(E){return vee.push(E),()=>{let b=vee.indexOf(E);b!==-1&&vee.splice(b,1)}}s(t,"subscribe");function e(){for(let E of vee)E()}s(e,"afterUpdateConnection");function r(E){OA.connection!==E&&(OA.connection=E,e())}s(r,"updateConnection");function n(){return OA.connection==="connected"}s(n,"isConnected");function i(){return OA.connection==="disconnected"}s(i,"isDisconnected");function o(){return OA.connection==="retry"}s(o,"isRetrying");function a(){return OA.connection==="disabled"}s(a,"isDisabled");function c(){r("connected"),p(!1)}s(c,"setConnected");function l(){r("disconnected")}s(l,"setDisconnected");function u(){r("retry")}s(u,"setRetrying");function f(){r("disabled")}s(f,"setDisabled");function p(E){OA.initialWait!==E&&(OA.initialWait=E)}s(p,"setInitialWait");function m(E,b=eKt){o()||(u(),p(!0),g(E,b))}s(m,"enableRetry");function h(){return OA.initialWait}s(h,"isInitialWait");async function g(E,b){Np.info(E,`Attempting to reconnect in ${b}ms.`),await A(b),p(!1);let S=E.get(Or);function R(B,L){if(B>dZe){Np.info(L,"Max retry time reached, disabling."),f();return}let O=s(async()=>{OA.retryAttempts=Math.min(OA.retryAttempts+1,fZe);try{Np.info(L,`Pinging service after ${B} second(s)`);let Y=await S.fetch(new URL("_ping",L4(L)["origin-tracker"]).href,{method:"GET",headers:{"content-type":"application/json"}});if(Y.status!==200||!Y.ok)R(B**2,L);else{Np.info(L,"Successfully reconnected."),c();return}}catch{R(B**2,L)}},"tryAgain");setTimeout(()=>void O(),B*1e3)}s(R,"succeedOrRetry"),Np.info(E,"Attempting to reconnect."),R(dEe,E)}s(g,"attemptToPing");let A=s(E=>new Promise(b=>setTimeout(b,E)),"timeout");function y(E){return{dispose:t(E)}}return s(y,"listen"),Cee={setConnected:c,setDisconnected:l,setRetrying:u,setDisabled:f,enableRetry:m,listen:y,isConnected:n,isDisconnected:i,isRetrying:o,isDisabled:a,isInitialWait:h},Cee}s(tKt,"registerConnectionState");var ZR=tKt();d();var mu={BadArguments:"BadArgumentsError",Unauthorized:"NotAuthorized",NotFound:"NotFoundError",RateLimit:"RateLimitError",InternalError:"InternalError",ConnectionError:"ConnectionError",Unknown:"UnknownError"},M7={[mu.Unauthorized]:"Invalid GitHub token. Please sign out from your GitHub account using VSCode UI and try again",[mu.InternalError]:"Internal error: matches to public code will not be detected. It is advised to disable Copilot completions until the service is reconnected.",[mu.RateLimit]:"You've reached your quota and limit, code matching will be unavailable until the limit resets"};function fEe(t){return t===401?mu.Unauthorized:t===400?mu.BadArguments:t===404?mu.NotFound:t===429?mu.RateLimit:t>=500&&t<600?mu.InternalError:t>=600?mu.ConnectionError:mu.Unknown}s(fEe,"getErrorType");function JC(t,e,r={}){return{kind:"failure",reason:fEe(Number(t)),code:Number(t),msg:e,meta:r}}s(JC,"createErrorResponse");d();var rKt=/^[1-6][0-9][0-9]$/,nKt=/([A-Z][a-z]+)/,iKt="code_referencing",L7=class{constructor(e){this.baseKey=e}static{s(this,"CodeQuoteTelemetry")}buildKey(...e){return[iKt,this.baseKey,...e].join(".")}},pEe=class extends L7{static{s(this,"CopilotOutputLogTelemetry")}constructor(){super("github_copilot_log")}handleOpen({context:e}){let r=this.buildKey("open","count"),n=Vr.createAndMarkAsIssued();Bt(e,r,n)}handleFocus({context:e}){let r=Vr.createAndMarkAsIssued(),n=this.buildKey("focus","count");Bt(e,n,r)}handleWrite({context:e}){let r=Vr.createAndMarkAsIssued(),n=this.buildKey("write","count");Bt(e,n,r)}},Oli=new pEe,mEe=class extends L7{static{s(this,"MatchNotificationTelemetry")}constructor(){super("match_notification")}handleDoAction({context:e,actor:r}){let n=Vr.createAndMarkAsIssued({actor:r}),i=this.buildKey("acknowledge","count");Bt(e,i,n)}handleDismiss({context:e,actor:r}){let n=Vr.createAndMarkAsIssued({actor:r}),i=this.buildKey("ignore","count");Bt(e,i,n)}},Qli=new mEe,hEe=class extends L7{static{s(this,"SnippyTelemetry")}constructor(){super("snippy")}handleUnexpectedError({context:e,origin:r,reason:n}){let i=Vr.createAndMarkAsIssued({origin:r,reason:n});dA(e,this.buildKey("unexpectedError"),i)}handleCompletionMissing({context:e,origin:r,reason:n}){let i=Vr.createAndMarkAsIssued({origin:r,reason:n});dA(e,this.buildKey("completionMissing"),i)}handleSnippyNetworkError({context:e,origin:r,reason:n,message:i}){if(!r.match(rKt)){Np.debug(e,"Invalid status code, not sending telemetry",{origin:r});return}let o=n.split(nKt).filter(c=>!!c).join("_").toLowerCase(),a=Vr.createAndMarkAsIssued({message:i});dA(e,this.buildKey(o,r),a)}},xee=new hEe;var oKt="twirp/github.snippy.v1.SnippyAPI";async function gEe(t,e,r,n){let i;try{i=await t.get(ar).getToken()}catch{return ZR.setDisconnected(),JC(401,M7[mu.Unauthorized])}if(Np.info(t,`Calling ${e}`),ZR.isRetrying())return JC(600,"Attempting to reconnect to the public code matching service.");if(ZR.isDisconnected())return JC(601,"The public code matching service is offline.");let o;try{o=await t.get(Or).fetch(qm(t,i,"origin-tracker",`${oKt}/${e}`),{method:r.method,body:r.method==="POST"?JSON.stringify(r.body):void 0,headers:{"content-type":"application/json",authorization:`Bearer ${i.token}`,...p0(t)},signal:n})}catch{return ZR.enableRetry(t),JC(602,"Network error detected. Check your internet connection.")}let a;try{a=await o.json()}catch(g){let A=g.message;throw xee.handleUnexpectedError({context:t,origin:"snippyNetwork",reason:A}),g}if(o.ok)return{kind:"success",...a};let c={...a,code:Number(o.status)},{code:l,msg:u,meta:f}=c,p=Number(l),m=fEe(p),h=u||"unknown error";switch(m){case mu.Unauthorized:return JC(l,M7[mu.Unauthorized],f);case mu.BadArguments:return JC(l,h,f);case mu.RateLimit:return ZR.enableRetry(t,60*1e3),JC(l,M7.RateLimitError,f);case mu.InternalError:return ZR.enableRetry(t),JC(l,M7[mu.InternalError],f);default:return JC(l,h,f)}}s(gEe,"call");d();var Eee=x.Object({kind:x.Literal("failure"),reason:x.String(),code:x.Number(),msg:x.String(),meta:x.Optional(x.Any())}),aKt=x.Object({matched_source:x.String(),occurrences:x.String(),capped:x.Boolean(),cursor:x.String(),github_url:x.String()}),pZe=x.Object({source:x.String()}),cKt=x.Object({snippets:x.Array(aKt)}),mZe=x.Union([cKt,Eee]),hZe=x.Object({cursor:x.String()}),lKt=x.Object({commit_id:x.String(),license:x.String(),nwo:x.String(),path:x.String(),url:x.String()}),uKt=x.Object({has_next_page:x.Boolean(),cursor:x.String()}),dKt=x.Object({count:x.Record(x.String(),x.String())}),fKt=x.Object({file_matches:x.Array(lKt),page_info:uKt,license_stats:dKt}),gZe=x.Union([fKt,Eee]);async function AZe(t,e,r){let n=await gEe(t,"Match",{method:"POST",body:UR(pZe,{source:e})},r);return UR(mZe,n)}s(AZe,"Match");async function yZe(t,{cursor:e},r){let n=await gEe(t,"FilesForMatch",{method:"POST",body:UR(hZe,{cursor:e})},r);return UR(gZe,n)}s(yZe,"FilesForMatch");d();var F7=new RegExp("[_\\p{L}\\p{Nd}]+|====+|----+|####+|////+|\\*\\*\\*\\*+|[\\p{P}\\p{S}]","gu"),bee=65;function hKt(t){let e=0,r;F7.lastIndex=0;do if(r=F7.exec(t),r&&(e+=1),e>=bee)break;while(r);return e}s(hKt,"lexemeLength");function gKt(t,e){let r=0,n;F7.lastIndex=0;do if(n=F7.exec(t),n&&(r+=1,r>=e))return F7.lastIndex;while(n);return t.length}s(gKt,"offsetFirstLexemes");function CZe(t,e){let r=t.split("").reverse().join(""),n=gKt(r,e);return r.length-n}s(CZe,"offsetLastLexemes");function O7(t){return hKt(t)>=bee}s(O7,"hasMinLexemeLength");function yKt(t){return FC.Check(Eee,t)}s(yKt,"isError");async function vZe(t,e){let r=await e();if(yKt(r)){xee.handleSnippyNetworkError({context:t,origin:String(r.code),reason:r.reason,message:r.msg});return}return r}s(vZe,"snippyRequest");function xZe(t){return"kind"in t&&t.kind==="failure"}s(xZe,"isMatchError");async function EZe(t,e,r,n){let o=await t.get(dr).getTextDocument({uri:e});if(!o){Np.debug(t,`Expected document matching ${e}, got nothing.`);return}let a=o.getText();if(!O7(a)||!O7(a))return;let c=r;if(!O7(r)){let h=a.slice(0,n),g=CZe(h,bee);c=a.slice(g,n+r.length)}if(!O7(c))return;let l=await vZe(t,()=>AZe(t,c));if(!l||xZe(l)||!l.snippets.length){Np.info(t,"No match found");return}Np.info(t,"Match found");let{snippets:u}=l,f=u.map(async h=>{let g=await vZe(t,()=>yZe(t,{cursor:h.cursor}));if(!g||xZe(g))return;let A=g.file_matches,y=g.license_stats;return{match:h,files:A,licenseStats:y}}),m=(await Promise.all(f)).filter(h=>h!==void 0);if(m.length)for(let h of m){let g=new Set(Object.keys(h.licenseStats?.count??{}));g.has("NOASSERTION")&&(g.delete("NOASSERTION"),g.add("unknown"));let A=Array.from(g).sort(),y=n,E=n+h.match.matched_source.length,b=o.positionAt(y),S=o.positionAt(E);await t.get(kf).handleIPCodeCitation(t,{inDocumentUri:e,offsetStart:y,offsetEnd:E,version:o.version,location:{start:b,end:S},matchingText:c,details:A.map(R=>({license:R,url:h.match.github_url}))})}}s(EZe,"fetchCitations");d();function AEe(t,e,r=(n,i)=>n===i?0:1){if(e.length===0||t.length===0)return{distance:e.length,startOffset:0,endOffset:0};let n=new Array(e.length+1).fill(0),i=new Array(e.length+1).fill(0),o=new Array(t.length+1).fill(0),a=new Array(t.length+1).fill(0),c=e[0];for(let u=0;u<t.length+1;u++)u===0?n[u]=1:n[u]=r(t[u-1],c,u-1,0),i[u]=u>0?u-1:0;for(let u=1;u<e.length;u++){let f=o;o=n,n=f,f=a,a=i,i=f,c=e[u],n[0]=u+1;for(let p=1;p<t.length+1;p++){let m=1+o[p],h=1+n[p-1],g=r(t[p-1],c,p-1,u)+o[p-1];n[p]=Math.min(h,m,g),n[p]===g?i[p]=a[p-1]:n[p]===m?i[p]=a[p]:i[p]=i[p-1]}}let l=0;for(let u=0;u<t.length+1;u++)n[u]<n[l]&&(l=u);return{distance:n[l],startOffset:i[l],endOffset:l}}s(AEe,"editDistance");function CKt(){return new Map}s(CKt,"emptyLexDictionary");function vKt(t){let e=new Array(t.size);for(let[r,n]of t)e[n]=r;return e}s(vKt,"reverseLexDictionary");function*xKt(t){let e="",r;(c=>(c[c.Word=0]="Word",c[c.Space=1]="Space",c[c.Other=2]="Other"))(r||={});let n=0;for(let i of t){let o;new RegExp("(\\p{L}|\\p{Nd}|_)","u").test(i)?o=0:i===" "?o=1:o=2,o===n&&o!==2?e+=i:(e.length>0&&(yield e),e=i,n=o)}e.length>0&&(yield e)}s(xKt,"lexGeneratorWords");function bZe(t,e,r,n){let i=[],o=0;for(let a of r(t))n(a)&&(e.has(a)||e.set(a,e.size),i.push([e.get(a),o])),o+=a.length;return[i,e]}s(bZe,"lexicalAnalyzer");function IZe(t){return t!==" "}s(IZe,"notSingleSpace");function TZe(t,e,r=xKt){let[n,i]=bZe(t,CKt(),r,IZe),[o,a]=bZe(e,i,r,IZe);if(o.length===0||n.length===0)return{lexDistance:o.length,startOffset:0,endOffset:0,haystackLexLength:n.length,needleLexLength:o.length};let c=vKt(a),l=o.length,u=c[o[0][0]],f=c[o[l-1][0]];function p(A,y,E,b){if(b===0||b===l-1){let S=c[n[E][0]];return b==0&&S.endsWith(u)||b==l-1&&S.startsWith(f)?0:1}else return A===y?0:1}s(p,"compare");let m=AEe(n.map(A=>A[0]),o.map(A=>A[0]),p),h=n[m.startOffset][1],g=m.endOffset<n.length?n[m.endOffset][1]:t.length;return g>0&&t[g-1]===" "&&--g,{lexDistance:m.distance,startOffset:h,endOffset:g,haystackLexLength:n.length,needleLexLength:o.length}}s(TZe,"lexEditDistance");d();function ek(t){if(t.length===0)return[];let e=[],r=/\r\n|\r|\n/g,n;for(;(n=r.exec(t))!==null;)e.push({start:n.index,end:n.index+n[0].length,newline:n[0]});return e}s(ek,"countLines");function wZe(t,e){return e.compType==="partial"?t.substring(0,e.acceptedLength):t}s(wZe,"computeCompletionText");var ZT=new dt("postInsertion"),SZe=[{seconds:15,captureCode:!1,captureRejection:!1},{seconds:30,captureCode:!0,captureRejection:!0},{seconds:120,captureCode:!1,captureRejection:!1},{seconds:300,captureCode:!1,captureRejection:!1},{seconds:600,captureCode:!1,captureRejection:!1}],_Ze=50,EKt=1500,bKt=.5,IKt=500,yEe={triggerPostInsertionSynchroneously:!1,captureCode:!1,captureRejection:!1};async function RZe(t,e,r,n,i){let o=await t.get(En).getOrReadTextDocumentWithFakeClientProperties({uri:e});if(o.status!=="valid")return ZT.info(t,`Could not get document for ${e}. Maybe it was closed by the editor.`),{prompt:{prefix:"",suffix:"",isFimEnabled:!1},capturedCode:"",terminationOffset:0};let a=o.document,c=a.getText(),l=c.substring(0,n),u=a.positionAt(n),f=await $3(t,r.properties.headerRequestId,YC(a,u),r),p=f.type==="prompt"?f.prompt:{prefix:l,suffix:"",isFimEnabled:!1};if(p.isFimEnabled&&i!==void 0){let m=c.substring(n,i);return p.suffix=c.substring(i),{prompt:p,capturedCode:m,terminationOffset:0}}else{let m=c.substring(n),h=gxe(l,n,a.detectedLanguageId),A=RJe(h,void 0)(m),y=Math.min(c.length,n+(A?A*2:IKt)),E=c.substring(n,y);return{prompt:p,capturedCode:E,terminationOffset:A??-1}}}s(RZe,"captureCode");function Iee(t,e,r,n,i){i.forEach(({completionText:l,completionTelemetryData:u})=>{ZT.debug(t,`${e}.rejected choiceIndex: ${u.properties.choiceIndex}`),iJe(t,e,u)});let o=new XR(t,n,r-1),a=new XR(t,n,r),c=s(async l=>{ZT.debug(t,`Original offset: ${r}, Tracked offset: ${o.offset}`);let{completionTelemetryData:u}=i[0],{prompt:f,capturedCode:p,terminationOffset:m}=await RZe(t,n,u,o.offset+1,a.offset),h={hypotheticalPromptJson:JSON.stringify({prefix:f.prefix,context:f.context}),hypotheticalPromptSuffixJson:JSON.stringify(f.suffix)},g=u.extendedBy({...h,capturedCodeJson:JSON.stringify(p)},{timeout:l.seconds,insertionOffset:r,trackedOffset:o.offset,terminationOffsetInCapturedCode:m});ZT.debug(t,`${e}.capturedAfterRejected choiceIndex: ${u.properties.choiceIndex}`,g),Bt(t,e+".capturedAfterRejected",g,1)},"checkInCode");SZe.filter(l=>l.captureRejection).map(l=>o.push(Xl(t,()=>c(l),"postRejectionTasks"),l.seconds*1e3))}s(Iee,"postRejectionTasks");function Q7(t,e,r,n,i,o,a,c){let l=o.extendedBy({compType:a.compType},{compCharLen:a.acceptedLength,numLines:a.acceptedLines});ZT.debug(t,`${e}.accepted choiceIndex: ${l.properties.choiceIndex}`),nJe(t,e,l);let u=r;r=wZe(r,a);let f=r.trim(),p=new XR(t,i,n),m=new XR(t,i,n+r.length),h=s(async g=>{await _Kt(t,e,f,n,i,g,l,p,m)},"stillInCodeCheck");if(yEe.triggerPostInsertionSynchroneously&&Kg(t)){let g=h({seconds:0,captureCode:yEe.captureCode,captureRejection:yEe.captureRejection});t.get(Zc).register(g)}else SZe.map(g=>p.push(Xl(t,()=>h(g),"postInsertionTasks"),g.seconds*1e3));Xl(t,TKt,"post insertion citation check")(t,i,u,r,n,c)}s(Q7,"postInsertionTasks");async function TKt(t,e,r,n,i,o){if(!o||(o.ip_code_citations?.length??0)<1){if(_j(t)?.getTokenValue("sn")==="1")return;await EZe(t,e,n,i);return}let a=await t.get(dr).getTextDocument({uri:e});if(a){let c=CEe(a.getText(),n,_Ze,i);c.stillInCodeHeuristic&&(i=c.foundOffset)}for(let c of o.ip_code_citations){let l=wKt(r.length,n.length,c.start_offset);if(l===void 0){ZT.info(t,`Full completion for ${e} contains a reference matching public code, but the partially inserted text did not include the match.`);continue}let u=i+l,f=a?.positionAt(u),p=i+SKt(r.length,n.length,c.stop_offset),m=a?.positionAt(p),h=f&&m?a?.getText({start:f,end:m}):"<unknown>";await t.get(kf).handleIPCodeCitation(t,{inDocumentUri:e,offsetStart:u,offsetEnd:p,version:a?.version,location:f&&m?{start:f,end:m}:void 0,matchingText:h,details:c.details.citations})}}s(TKt,"citationCheck");function wKt(t,e,r){if(!(e<t&&r>e))return r}s(wKt,"computeCitationStart");function SKt(t,e,r){return e<t?Math.min(r,e):r}s(SKt,"computeCitationEnd");function CEe(t,e,r,n){let i=t.substring(Math.max(0,n-r),Math.min(t.length,n+e.length+r)),o=TZe(i,e),a=o.lexDistance/o.needleLexLength,{distance:c}=AEe(i.substring(o.startOffset,o.endOffset),e);return{relativeLexEditDistance:a,charEditDistance:c,completionLexLength:o.needleLexLength,foundOffset:o.startOffset+Math.max(0,n-r),lexEditDistance:o.lexDistance,stillInCodeHeuristic:a<=bKt?1:0}}s(CEe,"find");async function _Kt(t,e,r,n,i,o,a,c,l){let u=await t.get(En).getOrReadTextDocument({uri:i});if(u.status==="valid"){let p=u.document.getText(),m=CEe(p,r,_Ze,c.offset);m.stillInCodeHeuristic||(m=CEe(p,r,EKt,c.offset)),ZT.debug(t,`stillInCode: ${m.stillInCodeHeuristic?"Found":"Not found"}! Completion '${r}' in file ${i}. lexEditDistance fraction was ${m.relativeLexEditDistance}. Char edit distance was ${m.charEditDistance}. Inserted at ${n}, tracked at ${c.offset}, found at ${m.foundOffset}. choiceIndex: ${a.properties.choiceIndex}`);let h=a.extendedBy({},{timeout:o.seconds,insertionOffset:n,trackedOffset:c.offset}).extendedBy({},m);if(Bt(t,e+".stillInCode",h),o.captureCode){let{prompt:g,capturedCode:A,terminationOffset:y}=await RZe(t,i,h,c.offset,l.offset),E={hypotheticalPromptJson:JSON.stringify({prefix:g.prefix,context:g.context}),hypotheticalPromptSuffixJson:JSON.stringify(g.suffix)},b=a.extendedBy({...E,capturedCodeJson:JSON.stringify(A)},{timeout:o.seconds,insertionOffset:n,trackedOffset:c.offset,terminationOffsetInCapturedCode:y});ZT.debug(t,`${e}.capturedAfterAccepted choiceIndex: ${a.properties.choiceIndex}`,h),Bt(t,e+".capturedAfterAccepted",b,1)}}}s(_Kt,"checkStillInCode");var kKt=new dt("ghostText"),rd=class{constructor(){this.#i=[];this.linesAccepted=0}static{s(this,"LastGhostText")}#e;#t;#i;get position(){return this.#e}get shownCompletions(){return this.#i||[]}get uri(){return this.#t}resetState(){this.#t=void 0,this.#e=void 0,this.#i=[],this.resetPartialAcceptanceState()}setState({uri:e},r){this.#t=e,this.#e=r,this.#i=[]}resetPartialAcceptanceState(){this.partiallyAcceptedLength=0,this.totalLength=void 0,this.linesLeft=void 0,this.linesAccepted=0}};function PKt(t){let e=[];return t.shownCompletions.forEach(r=>{if(r.displayText&&r.telemetry){let n,i;t.partiallyAcceptedLength?(n=r.displayText.substring(t.partiallyAcceptedLength-1),i=r.telemetry.extendedBy({compType:"partial"},{compCharLen:n.length})):(n=r.displayText,i=r.telemetry);let o={completionText:n,completionTelemetryData:i,offset:r.offset};e.push(o)}}),e}s(PKt,"computeRejectedCompletions");function vEe(t,e){let r=t.get(rd);if(!r.position||!r.uri)return;let n=PKt(r);n.length>0&&Iee(t,"ghostText",e??n[0].offset,r.uri,n),r.resetState(),r.resetPartialAcceptanceState()}s(vEe,"rejectLastShown");function kZe(t,e,r,n){let i=t.get(rd);return i.position&&i.uri&&!(i.position.line===r.line&&i.position.character===r.character&&i.uri.toString()===e.uri.toString())&&n!==2&&vEe(t,e.offsetAt(i.position)),i.setState(e,r),i.index}s(kZe,"setLastShown");function PZe(t,e){let r=t.get(rd);if(r.index=e.index,!r.shownCompletions.find(n=>n.index===e.index)&&(e.uri===r.uri&&r.position?.line===e.position.line&&r.position?.character==e.position.character&&r.shownCompletions.push(e),e.displayText)){let n=e.resultType!==0;kKt.debug(t,`[${e.telemetry.properties.headerRequestId}] shown choiceIndex: ${e.telemetry.properties.choiceIndex}, fromCache ${n}`),e.telemetry.measurements.compCharLen=e.displayText.length,GX(t,"ghostText",e)}}s(PZe,"handleGhostTextShown");function DKt(t,e,r){let n=t.get(rd);n.linesLeft===void 0&&(n.linesLeft=ek(e.displayText));let i=ek(e.displayText);n.linesLeft.length>i.length&&(n.linesAccepted+=n.linesLeft.length-i.length,n.lastLineAcceptedLength=n.partiallyAcceptedLength,n.linesLeft=i),n.partiallyAcceptedLength=(n.lastLineAcceptedLength||0)+r}s(DKt,"handleLineAcceptance");function j3(t,e,r="ghostText"){let n=t.get(rd),i;return n.partiallyAcceptedLength?i={compType:"full",acceptedLength:(n.partiallyAcceptedLength||0)+e.displayText.length,acceptedLines:n.linesAccepted+(n.linesLeft?.length??0)}:i={compType:"full",acceptedLength:e.displayText.length,acceptedLines:ek(e.displayText).length},n.resetState(),Q7(t,r,e.displayText,e.offset,e.uri,e.telemetry,i,e.copilotAnnotations)}s(j3,"handleGhostTextPostInsert");function Tee(t,e,r,n=0,i="ghostText",o="line"){let a=t.get(rd),c;return o==="cumulative"?(BKt(t,e,r),c={compType:a.totalLength!=null?"full":"partial",acceptedLength:a.totalLength??(a.partiallyAcceptedLength||0),acceptedLines:a.linesAccepted},c.compType==="full"&&a.resetState()):(DKt(t,e,r),c={compType:"partial",acceptedLength:a.partiallyAcceptedLength||0,acceptedLines:a.linesAccepted}),Q7(t,i,e.displayText,e.offset,e.uri,e.telemetry,c,e.copilotAnnotations)}s(Tee,"handlePartialGhostTextPostInsert");function BKt(t,e,r){let n=t.get(rd);n.partiallyAcceptedLength=(n.partiallyAcceptedLength||0)+r,n.linesAccepted=ek(e.insertText.substring(0,n.partiallyAcceptedLength)).length,n.partiallyAcceptedLength>=e.insertText.length&&(n.totalLength=n.partiallyAcceptedLength)}s(BKt,"handleCumulativeAcceptance");function DZe(t){let e=new p3;return e.set(Mc,t),e.set(yC,new yC),e.set(To,new To),e.set(DA,new DA),e.set(ar,new ar(e)),e.set(Mt,new Mt(e)),e.set(sC,new sC),e.set(Ou,new Ou(e)),e.set(Wu,new Wu),e.set(fp,new fp),e.set(Rp,new y7),e.set(bA,new UB),e.set(pA,new y9),e.set(Zc,new Zc),e.set($C,new $C(e)),e.set(En,new En(e)),e.set(FA,new FA(e)),e.set(Fx,hee(e)),e.set(rd,new rd),e.set(Bp,new Bp),e.set(Ox,Ox.default),e.set(PA,new PA(e)),e.set(ph,new ph(e)),e.set(iu,new iu),e.set(_p,new _p(e)),e.set(xs,new xs),e.set(_h,new _h(e)),e.set(Dh,new Dh),e}s(DZe,"createCommonContext");d();d();var wee=class extends Error{static{s(this,"FetchSpeculationCanceledException")}constructor(e){super(e),this.name="FetchSpeculationCanceledException"}};d();var G3=class extends Error{static{s(this,"FetchSpeculationFailedException")}constructor(e){super(e),this.name="FetchSpeculationFailedException"}};var zdi=x.Object({prompt:x.String(),speculation:x.String(),languageId:x.String(),stops:x.Array(x.String())}),U7=class{static{s(this,"SpeculationFetcher")}constructor(e){this.ctx=e}async fetchSpeculation(e,r){let i={prompt:e.prompt,speculation:e.speculation,engineModelId:"copilot-centralus-h100",uiKind:"editsPanel",stops:e.stops},o=await this.ctx.get(ar).getToken(),a=await this.ctx.get(Mt).updateExPValuesAndAssignments(o),c=await this.ctx.get(Rp).fetchAndStreamSpeculation(this.ctx,i,a,(l,u)=>{},r);switch(c.type){case"success":return c;case"canceled":throw new wee(c.reason);case"failed":throw new G3(c.reason)}}};d();d();var BZe=Be(require("node:util"));function NZe(t,...e){return`[${t}] ${NKt(e)}`}s(NZe,"formatLogMessage");function NKt(t){return BZe.default.formatWithOptions({maxStringLength:1/0},...t)}s(NKt,"format");function See(t){return B3e(t)}s(See,"verboseLogging");var _ee=class extends Xc{constructor(r){super();this.console=r}static{s(this,"ConsoleLog")}logIt(r,n,i,...o){n==1?this.console.error(`[${i}]`,...o):(n==2||See(r))&&this.console.warn(`[${i}]`,...o)}};d();var MZe=require("node:util");var V3=class extends nC{static{s(this,"TelemetryLogSenderImpl")}sendError(e,r,...n){dA(e,"log",Vr.createAndMarkAsIssued({context:r,level:Q_[1],message:MKt(...n)}),1)}sendException(e,r,n){Ka(e,r,n)}};function MKt(...t){return t.map(e=>(0,MZe.inspect)(e)).join(" ")}s(MKt,"telemetryMessage");d();var Jlt=Be(require("crypto")),Xlt=Be(require("fs")),sne=Be(Klt()),Zlt=require("tls"),eut=Be(Ylt());var r8=new dt("certificates"),gl=class{static{s(this,"RootCertificateReader")}};function ane(t,e=process.platform){return new jwe(t,[new Gwe,new Vwe,Qfr(t,e)])}s(ane,"getRootCertificateReader");function Qfr(t,e){switch(e){case"linux":return new zwe(t);case"darwin":return new Kwe(t);case"win32":return new Ywe(t);default:return new Jwe}}s(Qfr,"createPlatformReader");var Wwe=class extends gl{constructor(r,n){super();this.ctx=r;this.delegate=n}static{s(this,"ErrorHandlingCertificateReader")}async getAllRootCAs(){try{return await this.delegate.getAllRootCAs()}catch(r){return r8.warn(this.ctx,"Failed to read root certificates:",r),[]}}},jwe=class extends gl{constructor(r,n){super();this.ctx=r;this.delegates=n.map(i=>new Wwe(r,i))}static{s(this,"CachingRootCertificateReader")}async getAllRootCAs(){return this.certificates||(this.certificates=this.removeExpiredCertificates((await Promise.all(this.delegates.map(r=>r.getAllRootCAs()))).flat())),this.certificates}removeExpiredCertificates(r){let n=Date.now(),i=r.filter(o=>{try{let a=new Jlt.X509Certificate(o),c=Date.parse(a.validTo);return isNaN(c)||c>n}catch(a){return r8.warn(this.ctx,"Failed to parse certificate",o,a),!1}});return r.length!==i.length&&r8.info(this.ctx,`Removed ${r.length-i.length} expired certificates`),i}},Gwe=class extends gl{static{s(this,"NodeTlsRootCertificateReader")}getAllRootCAs(){return Zlt.rootCertificates}},Vwe=class extends gl{static{s(this,"EnvironmentVariableRootCertificateReader")}async getAllRootCAs(){let e=process.env.NODE_EXTRA_CA_CERTS;return e?await tut(e):[]}},zwe=class extends gl{constructor(r){super();this.ctx=r}static{s(this,"LinuxRootCertificateReader")}async getAllRootCAs(){let r=[];for(let n of["/etc/ssl/certs/ca-certificates.crt","/etc/ssl/certs/ca-bundle.crt"]){let i=await tut(n);r8.debug(this.ctx,`Read ${i.length} certificates from ${n}`),r=r.concat(i)}return r}},Kwe=class extends gl{constructor(r){super();this.ctx=r}static{s(this,"MacRootCertificateReader")}getAllRootCAs(){let r=sne.get({excludeBundled:!1,format:sne.Format.pem});return r8.debug(this.ctx,`Read ${r.length} certificates from Mac keychain`),r}},Ywe=class extends gl{constructor(r){super();this.ctx=r}static{s(this,"WindowsRootCertificateReader")}getAllRootCAs(){let r=eut.all();return r8.debug(this.ctx,`Read ${r.length} certificates from Windows store`),r}},Jwe=class extends gl{static{s(this,"UnsupportedPlatformRootCertificateReader")}getAllRootCAs(){return Promise.reject(new Error("No certificate reader available for unsupported platform"))}};async function tut(t){let e;try{e=await Xlt.promises.readFile(t,{encoding:"utf8"})}catch{return[]}let r=e.match(/-----BEGIN CERTIFICATE-----[\s\S]*?-----END CERTIFICATE-----/g);if(!r)return[];let n=r.filter(o=>o.length>0),i=new Set(n);return Array.from(i)}s(tut,"readCertsFromFile");d();var mut=Be(require("http"));var upr=407,ad=new dt("proxySocketFactory"),C1=class{static{s(this,"ProxySocketFactory")}},Bk=class extends Error{static{s(this,"ProxySocketError")}constructor(e,r,n){super(e),this.code=r?.code,this.syscall=r?.syscall,this.errno=r?.errno,/^Failed to establish a socket connection to proxies:/.test(r?.message??"")?this.code="ProxyFailedToEstablishSocketConnection":/^InitializeSecurityContext:/.test(r?.message??"")?this.code="ProxyInitializeSecurityContext":r?.message==="Miscellaneous failure (see text): Server not found in Kerberos database"?this.code="ProxyKerberosServerNotFound":/^Unspecified GSS failure. {2}Minor code may provide more information: No Kerberos credentials available/.test(r?.message??"")&&(this.code="ProxyGSSFailureNoKerberosCredentialsAvailable"),n!==void 0&&(this.code=n)}};function cne(t){return new eSe(t,new tSe(t))}s(cne,"getProxySocketFactory");var eSe=class extends C1{constructor(r,n,i=new oU,o=process.platform){super();this.ctx=r;this.delegate=n;this.kerberosLoader=i;this.platform=o;this.successfullyAuthorized=new Sr(20)}static{s(this,"KerberosProxySocketFactory")}async createSocket(r,n){this.successfullyAuthorized.get(this.getProxyCacheKey(n))&&(ad.debug(this.ctx,"Proxy authorization already successful once, skipping 407 round trip"),await this.reauthorize(r,n));try{return await this.delegate.createSocket(r,n)}catch(i){if(i instanceof Bk&&i.code===`ProxyStatusCode${upr}`){ad.debug(this.ctx,"Proxy authorization required, trying to authorize first time");let o=await this.authorizeAndCreateSocket(r,n);if(o)return ad.debug(this.ctx,"Proxy authorization successful, caching result"),Bt(this.ctx,"proxy.kerberosAuthorized"),this.successfullyAuthorized.set(this.getProxyCacheKey(n),!0),o}throw i}}async reauthorize(r,n){let i=await this.authorize(n);i&&(ad.debug(this.ctx,"Proxy re-authorization successful, received token"),r.headers["Proxy-Authorization"]="Negotiate "+i)}async authorizeAndCreateSocket(r,n){let i=await this.authorize(n);if(ad.debug(this.ctx,"Proxy authorization successful, received token"),i)return ad.debug(this.ctx,"Trying to create socket with proxy authorization"),r.headers["Proxy-Authorization"]="Negotiate "+i,await this.delegate.createSocket(r,n)}async authorize(r){ad.debug(this.ctx,"Loading kerberos module");let n=await this.kerberosLoader.load(),i=this.computeSpn(r);ad.debug(this.ctx,"Initializing kerberos client using spn",i);let o=await n.initializeClient(i);ad.debug(this.ctx,"Perform client side kerberos step");let a=await o.step("");return ad.debug(this.ctx,"Received kerberos server response"),a}computeSpn(r){let n=r.kerberosServicePrincipal;if(n)return ad.debug(this.ctx,"Using configured kerberos spn",n),n;let i=this.platform==="win32"?`HTTP/${r.hostname}`:`HTTP@${r.hostname}`;return ad.debug(this.ctx,"Using default kerberos spn",i),i}getProxyCacheKey(r){return`${r.hostname}:${r.port}`}},tSe=class extends C1{constructor(r){super();this.ctx=r;this.userAgent=`GithubCopilot/${this.ctx.get(To).getVersion()}`}static{s(this,"TunnelingProxySocketFactory")}async createSocket(r,n){let i=this.createConnectRequestOptions(r,n);return new Promise((o,a)=>{ad.debug(this.ctx,"Attempting to establish connection to proxy");let c=mut.request(i);c.useChunkedEncodingByDefault=!1,c.once("connect",(l,u,f)=>{ad.debug(this.ctx,"Socket Connect returned status code",l.statusCode),c.removeAllListeners(),u.removeAllListeners(),l.statusCode!==200?(u.destroy(),a(new Bk(`tunneling socket could not be established, statusCode=${l.statusCode}`,void 0,`ProxyStatusCode${l.statusCode}`))):f.length>0?(u.destroy(),a(new Bk(`got non-empty response body from proxy, length=${f.length}`,void 0,"ProxyNonEmptyResponseBody"))):(ad.debug(this.ctx,"Successfully established tunneling connection to proxy"),o(u))}),c.once("error",l=>{ad.debug(this.ctx,"Proxy socket connection error",l.message),c.removeAllListeners(),a(new Bk(`tunneling socket could not be established, cause=${l.message}`,l))}),c.on("timeout",()=>{ad.debug(this.ctx,"Proxy socket connection timeout"),a(new Bk(`tunneling socket could not be established, proxy socket connection timeout while connecting to ${i.hostname}:${i.port}`,void 0,"ProxyTimeout"))}),c.end()})}createConnectRequestOptions(r,n){let i=`${r.hostname}:${r.port}`,o={hostname:n.hostname,port:n.port,method:"CONNECT",path:i,agent:!1,headers:{host:i,"Proxy-Connection":"keep-alive","User-Agent":this.userAgent},timeout:r.timeout};return r.localAddress&&(o.localAddress=r.localAddress),this.configureProxyAuthorization(o,r,n.authorization),o}configureProxyAuthorization(r,n,i){r.headers["Proxy-Authorization"]=[],i&&r.headers["Proxy-Authorization"].push("Basic "+Buffer.from(i).toString("base64")),typeof n.headers?.["Proxy-Authorization"]=="string"&&r.headers["Proxy-Authorization"].push(n.headers["Proxy-Authorization"])}},oU=class{static{s(this,"KerberosLoader")}load(){return Promise.resolve().then(()=>Be(put()))}};d();var yut=require("node:os");var dpr=new dt("repository"),Nk="\\\\",Cut="(?:[#;].*)",o8=`(?:[^"${Nk}]|${Nk}.)`,fpr="[0-9A-Za-z-]",hut=`[A-Za-z]${fpr}*`,vut=`\\s*${Cut}?$`,xut=`(?:[^"${Nk};#]|${Nk}.)`,ppr=`(?:"${o8}*"|"${o8}*(?<strCont>${Nk})$)`,mpr=`(?:${xut}|${ppr})+`,hpr=`(?:(?<cont>${Nk})$)`,Eut=`(?<value>${mpr})${hpr}?${vut}`,gut=new RegExp(`^${Eut}`),gpr=new RegExp(`^(?<value>${o8}*(?:(?<strCont>${Nk})$|(?<quote>")))`),Apr=new RegExp(`^\\s*(?:(?<key>${hut})\\s*=\\s*${Eut}|(?<soloKey>${hut})${vut})`),ypr=new RegExp(`(?<value>${xut}+)|"(?<string>${o8}*)"`,"g"),Aut="[-.0-9A-Za-z]+",Cpr=`\\s+"(?<ext>${o8}*)"`,vpr=`\\s+"(?<extOnly>${o8}*)"`,xpr=new RegExp(`^\\s*\\[(?:(?<simple>${Aut})${Cpr}|${vpr}|(?<simpleOnly>${Aut}))\\]`),Epr=new RegExp(`^\\s*${Cut}$`),rSe=class{constructor(e){this.content=e;this.stopped=!1;this.section="";this.line="";this.lineNum=0;this.lines=[];this.linesWithErrors=[]}static{s(this,"GitConfigParser")}parse(e){for(this.stopped=!1,this.section="",this.line="",this.linesWithErrors=[],this.configValueHandler=e,this.lines=this.content.split(/\r?\n/),this.lineNum=0;!this.stopped&&this.lineNum<this.lines.length;this.lineNum++)this.line=this.lines[this.lineNum],this.parseSectionStart(),this.parseConfigPair(),this.parseComment(),/^\s*$/.test(this.line)||this.errorAt(this.lineNum+1)}stop(){this.stopped=!0}hasErrors(){return this.linesWithErrors.length>0}errorAt(e){this.linesWithErrors.push(e)}parseSectionStart(){let e=this.line.match(xpr);e&&(e.groups?.simple?this.section=e.groups.simple.toLowerCase()+"."+this.unescapeBaseValue(e.groups.ext):e.groups?.extOnly?this.section="."+this.unescapeBaseValue(e.groups.extOnly):this.section=e.groups.simpleOnly.toLowerCase(),this.line=this.line.slice(e[0].length))}unescapeBaseValue(e){return e.replace(/\\(.)/g,"$1")}parseConfigPair(){let e=this.line.match(Apr);if(e){if(e.groups?.key){let r=this.handleContinued(e);this.configValueHandler?.(this.nameWithSection(e.groups.key.toLowerCase()),r)}else e.groups?.soloKey&&this.configValueHandler?.(this.nameWithSection(e.groups.soloKey.toLowerCase()),"");this.line=""}}handleContinued(e){let r=e,n=[this.matchedValue(r)];for(;r?.groups?.cont||r?.groups?.strCont;){if(this.line=this.lines[++this.lineNum],this.lineNum>=this.lines.length){this.errorAt(this.lineNum);break}r.groups.strCont?(r=this.line.match(gpr),r?(n.push(this.matchedValue(r)),r.groups?.quote&&(r=this.line.slice(r[0].length).match(gut),r?n.push(this.matchedValue(r)):this.errorAt(this.lineNum+1))):this.errorAt(this.lineNum+1)):(r=this.line.match(gut),r?n.push(this.matchedValue(r)):this.errorAt(this.lineNum+1))}return this.normalizeValue(n.join(""))}matchedValue(e){return e.groups.strCont?e.groups.value.slice(0,-1):e.groups.value}normalizeValue(e){let r=!1,n=[...e.matchAll(ypr)].map(i=>i.groups?.value?(r=!0,this.unescapeValue(i.groups.value.replace(/\s/g," "))):(r=!1,this.unescapeValue(i.groups.string))).join("");return r?n.trimEnd():n}unescapeValue(e){let r={n:`
`,t:"	",b:"\b"};return e.replace(/\\(.)/g,(n,i)=>r[i]||i)}nameWithSection(e){return this.section?this.section+"."+e:e}parseComment(){Epr.test(this.line)&&(this.line="")}},lne=class extends kA{static{s(this,"GitParsingConfigLoader")}async getConfig(e,r){let n=await PA.getRepoConfigLocation(e,r);if(!n)return;let i=await this.getParsedConfig(e,n);if(i)return this.mergeConfig(await this.baseConfig(e,n),i)}mergeConfig(...e){return e.filter(r=>r!==void 0).reduce((r,n)=>r.concat(n),new QR)}async getParsedConfig(e,r,n=!0){let i=await this.tryLoadConfig(e,r,n);if(!i)return;let o=new rSe(i),a=new QR;return o.parse((c,l)=>a.add(c,l)),a}async tryLoadConfig(e,r,n){try{return await e.get(Fi).readFileString(r)}catch(i){(n||!(i instanceof Error)||i.code!=="ENOENT")&&dpr.warn(e,`Failed to load git config from ${JSON.stringify(r)}:`,i);return}}async baseConfig(e,r){let n=await this.commondirConfigUri(e,r),i=Vi(this.xdgConfigUri(),"git","config"),o=Vi(this.homeUri(),".gitconfig");return this.mergeConfig(await this.getParsedConfig(e,i,!1),await this.getParsedConfig(e,o,!1),n?await this.getParsedConfig(e,n,!1):void 0)}async commondirConfigUri(e,r){if(Pi(r).toLowerCase()!=="config.worktree")return;let n=wd(r),i=Vi(n,"commondir");try{let o=(await e.get(Fi).readFileString(i)).trimEnd();return Vi(H_(n,o),"config")}catch{return}}xdgConfigUri(){return typeof process<"u"&&process.env.XDG_CONFIG_HOME?kl(process.env.XDG_CONFIG_HOME):Vi(this.homeUri(),".config")}homeUri(){return kl((0,yut.homedir)())}};d();var but=require("child_process");var une=class extends kA{static{s(this,"GitCLIConfigLoader")}runCommand(e,r,n){return new Promise((i,o)=>{(0,but.execFile)(r,n,{cwd:e},(a,c)=>{a?o(a):i(c)})})}async tryRunCommand(e,r,n,i){try{return await this.runCommand(r,n,i)}catch(o){iYe.info(e,`Failed to run command '${n}' in ${r}:`,o);return}}async getConfig(e,r){let n=ts(r);if(n===void 0)return;let i=await this.tryRunCommand(e,n,"git",["-c","safe.directory=*","config","--list","--null",...this.extraArgs()]);return i?this.extractConfig(i):void 0}extractConfig(e){let r=new QR;for(let n of e.split("\0").filter(i=>i)){let i=n.split(`
`,1)[0],o=n.slice(i.length+1);r.add(i,o)}return r}extraArgs(){return[]}};function Iut(t){let e=DZe(t);return bpr(e),e.set(gl,ane(e)),e.set(C1,cne(e)),e.set(kA,new wX([new une,new lne])),e.set(U7,new U7(e)),e}s(Iut,"createProductionContext");function bpr(t){t.set(Um,Um.fromEnvironment(!1)),t.set(nC,new V3),t.set(Xc,new _ee(console))}s(bpr,"setupRudimentaryLogging");var RCi=new dt("context");d();d();d();var v1="byok",nc=class{constructor(e){this.persistenceManager=e}static{s(this,"BYOKPersistence")}async getAPIKey(e,r){if(r){let i=await this.persistenceManager.read(v1,`${e}-${r}-api-key`);if(i)return i}return await this.persistenceManager.read(v1,`${e}-api-key`)}async storeAPIKey(e,r,n,i){n!==2&&(n===0?await this.persistenceManager.update(v1,`${e}-api-key`,r):n===1&&i&&await this.persistenceManager.update(v1,`${e}-${i}-api-key`,r))}async deleteAPIKey(e,r,n){r!==2&&(r===0?await this.persistenceManager.delete(v1,`${e}-api-key`):r===1&&n&&await this.persistenceManager.delete(v1,`${e}-${n}-api-key`))}async getStoredModelConfigs(e){return await this.persistenceManager.read(v1,`${e}-models-config`)||{}}async saveModelConfig(e,r,n,i,o){let a=await this.getStoredModelConfigs(e);a[r]=n,await this.persistenceManager.update(v1,`${e}-models-config`,a),i&&o&&await this.storeAPIKey(e,i,o,r)}async removeModelConfig(e,r){let n=await this.getStoredModelConfigs(e),i=n[r];i&&(delete n[r],await this.persistenceManager.update(v1,`${e}-models-config`,n),i.deploymentUrl&&await this.deleteAPIKey(e,1,r))}async removeAllModelConfigs(e){await this.persistenceManager.delete(v1,`${e}-models-config`)}};var Go={Azure:"Azure",OpenAI:"OpenAI",Gemini:"Gemini",Groq:"Groq",OpenRouter:"OpenRouter",Anthropic:"Anthropic"};function Pw(t){switch(t){case Go.Azure:return 1;default:return 0}}s(Pw,"getAuthTypeForProvider");function fne(t){return t===Go.OpenAI||t===Go.Gemini||t===Go.Groq||t===Go.OpenRouter||t===Go.Anthropic}s(fne,"isOpenAICompatible");async function Dw(t,e,r){let i=await new nc(t.get(yi)).getStoredModelConfigs(e),o=i?Object.values(i).find(f=>f.isRegistered!==!1):void 0,a=o?.modelCapabilities,c=a?.name||r,l=a?.maxInputTokens||1e5,u=a?.maxOutputTokens||8192;return{modelId:r,uiName:c,modelFamily:$r.BYOK,providerName:e,deploymentUrl:o?.deploymentUrl,maxRequestTokens:l,maxResponseTokens:u,baseTokensPerCompletion:3,baseTokensPerMessage:3,baseTokensPerName:1,tokenizer:"o200k_base",isExperimental:!1,stream:!0,toolCalls:!!a?.toolCalling}}s(Dw,"resolveModelConfiguration");async function Tut(t,e,r){return await new nc(t.get(yi)).getAPIKey(e,r)}s(Tut,"resolveModelKey");function wut(t,e){let{protocol:r,hostname:n,pathname:i}=new URL(e);if(i.endsWith("/chat/completions"))return e;if(n.endsWith(".models.ai.azure.com")||n.endsWith(".inference.ml.azure.com"))return`${r}//${n}/v1/chat/completions`;if(n.endsWith(".openai.azure.com"))return`${r}//${n}/openai/deployments/${t}/chat/completions?api-version=2025-01-01-preview`;throw new Error(`Unrecognized Azure deployment URL: ${e}`)}s(wut,"resolveAzureUrl");d();var sU=new dt("openAICompatibleLMProvider"),nSe={[Go.OpenAI]:"https://api.openai.com/v1",[Go.Gemini]:"https://generativelanguage.googleapis.com/v1beta/openai",[Go.Groq]:"https://api.groq.com/openai/v1",[Go.OpenRouter]:"https://openrouter.ai/api/v1",[Go.Anthropic]:"https://api.anthropic.com/v1"},Xh=class{constructor(e,r){this._lastFetchTime=0;this.providerName=e,this.ctx=r}static{s(this,"BaseOpenAICompatibleLMProvider")}async getAllModels(){await this.ensureKnownModelsCache();try{let e=this.getFetchModelUrl(),r={"Content-Type":"application/json"},n=await new nc(this.ctx.get(yi)).getAPIKey(this.providerName);n&&(r.Authorization=`Bearer ${n}`);let i=await fetch(e,{method:"GET",headers:r});if(!i.ok)throw new Error(`Failed to fetch models: ${i.status} ${i.statusText}`);let o=await i.json();if(o.error)throw new Error(`API Error: ${JSON.stringify(o.error)}`);let a=[];for(let c of o.data){let l=this._knownModels?.[c.id];l&&a.push({providerName:this.providerName,modelId:c.id,isRegistered:!1,isCustomModel:!1,modelCapabilities:l})}return a}catch(e){throw sU.error(this.ctx,`Error fetching models from ${this.providerName} provider:`,e),e}}getBaseUrl(){let e=nSe[this.providerName];if(!e)throw new Error(`Unsupported provider: ${this.providerName}`);return e}getFetchModelUrl(){return`${this.getBaseUrl()}/models`}async ensureKnownModelsCache(){let e=Date.now();!this._knownModels&&(this._knownModels=await this.fetchKnownModelList(),this._lastFetchTime=e)}async fetchKnownModelList(){let e=await(await this.ctx.get(Or).fetch("https://main.vscode-cdn.net/extensions/copilotChat.json",{method:"GET"})).json(),r;return e.version!==1?r={}:r=e.modelInfo[this.providerName]||{},r}};d();var _r=new dt("chat");d();d();var pa=(o=>(o.System="system",o.User="user",o.Assistant="assistant",o.Function="function",o.Tool="tool",o))(pa||{});function en(t){return t?(t=am(t),typeof t=="string"?t:t.map(e=>"text"in e?e.text:"").join("")):""}s(en,"getTextPart");var Sut=s((t,e)=>x.Unsafe({type:"string",enum:t,description:e?.description}),"StringEnum"),_ut=x.Optional(x.Object({agentSlug:x.String(),state:x.Union([x.Literal("accepted"),x.Literal("dismissed")]),confirmation:x.Any()}));function Bw(t){if(typeof t.function.arguments=="string")try{return JSON.parse(t.function.arguments)}catch{return{}}return t.function.arguments}s(Bw,"parseToolCallArguments");function Rut(t){return typeof t.function.arguments=="object"&&(t.function.arguments=JSON.stringify(t.function.arguments)),t}s(Rut,"toOpenAIToolCall");function kut(t,e,r,n,i,o,a,c,l){let u=JSON.parse(JSON.stringify(e));return r.tool_calls&&(u.tool_calls=r.tool_calls),v3(t,[u],c),{message:e,choiceIndex:n,requestId:i,blockFinished:o,finishReason:a,tokens:r.tokens,numTokens:r.tokens.length,tool_calls:r.tool_calls,function_call:r.function_call,telemetryData:c,copilotEditsSessionHeader:l}}s(kut,"convertToChatCompletion");function aU(t){return Array.isArray(t)&&t.every(e=>"type"in e&&!("role"in e))}s(aU,"isChatCompletionContentPartArray");function pne(t){return Array.isArray(t)&&t.every(e=>"role"in e)}s(pne,"isChatMessageArray");function am(t){if(typeof t=="string")return t;if(aU(t))return t;if(pne(t)){let e=t.filter(n=>n.role==="assistant"),r=[];for(let n of e)Array.isArray(n.content)?r.push(...n.content):r.push({type:"text",text:n.content});return r}return""}s(am,"resolveAsChatMessageContent");function Mk(t,e){return(typeof t=="string"||aU(t))&&(t=[{role:"assistant",content:t}]),t.push(e),t}s(Mk,"appendChatMessageContent");function mne(t,e){if(t){if(typeof t=="string"||aU(t))return[{role:"assistant",content:t}];if(pne(t))return e?t:t.filter(r=>r.role!=="tool").map(r=>r.tool_calls?{...r,tool_calls:void 0,tool_call_id:void 0}:r)}else return[];return[]}s(mne,"resolveResponseAsChatMessages");d();var iSe=new dt("streamMessages");function Put(t,e,r,n){let i=e.solution.text.join(""),o=!1;e.finishOffset!==void 0&&(iSe.debug(t,`message ${e.index}: early finish at offset ${e.finishOffset}`),i=i.substring(0,e.finishOffset),o=!0),iSe.info(t,`message ${e.index} returned. finish reason: [${e.reason}]`),iSe.debug(t,`message ${e.index} details: finishOffset: [${e.finishOffset}]`);let a=A7(e.solution),c={role:"assistant",content:i};return kut(t,c,a,e.index,e.requestId,o,e.reason??"",r,n)}s(Put,"prepareChatCompletionForReturn");var Zh=new dt("fetchChat"),hne=class{static{s(this,"OpenAIChatMLFetcher")}async fetchAndStreamChat(e,r,n,i,o){let a=await this.fetchWithParameters(e,r.endpoint,r,n,o);if(a==="not-sent")return{type:"canceled",reason:"before fetch request"};if(o?.isCancellationRequested){let l=a.body();try{l.destroy()}catch(u){Zh.exception(e,u,"Error destroying stream")}return{type:"canceled",reason:"after fetch request"}}if(a.status!==200){let l=this.createTelemetryData(r.endpoint,e,r);return this.handleError(e,l,a)}e.get(_h).processQuotaHeaders(a.headers);let c=a.headers.get("copilot-edits-session")||void 0;if(r.postOptions?.stream===!1){let l=await a.text(),u=JSON.parse(l),f=u.choices!=null?u.choices[0].message:{role:"assistant",content:""},p=a.headers.get("X-Request-ID")??br(),m={blockFinished:!1,choiceIndex:0,finishReason:"stop",message:f,tokens:en(f.content).split(" "),requestId:{headerRequestId:p,deploymentId:"",serverExperiments:""},telemetryData:n,numTokens:0,copilotEditsSessionHeader:c},h=en(f.content);return await i(h,{text:h,copilotReferences:u.copilot_references}),{type:"success",chatCompletions:async function*(){yield Promise.resolve(m)}(),getProcessingTime:s(()=>x3(a),"getProcessingTime")}}else{let u=$T.create(e,r.count,a,n,[],o).processSSE(i);return{type:"success",chatCompletions:_x(u,p=>Put(e,p,n,c)),getProcessingTime:s(()=>x3(a),"getProcessingTime")}}}createTelemetryData(e,r,n){return Vr.createAndMarkAsIssued({endpoint:e,engineName:n.engineName,uiKind:n.uiKind,headerRequestId:n.ourRequestId})}async fetchWithParameters(e,r,n,i,o){let a={messages:n.messages,tools:n.tools,tool_choice:n.tool_choice,model:n.model,temperature:E3(e,n.count),top_p:HX(e),n:n.count,stop:[`


`],copilot_thread_id:n.copilot_thread_id},c=Ax(n.repoInfo);return c!==void 0&&(a.nwo=c),n.postOptions&&Object.assign(a,n.postOptions),n.intent&&(a.intent=n.intent,n.intent_model&&(a.intent_model=n.intent_model),n.intent_tokenizer&&(a.intent_tokenizer=n.intent_tokenizer),n.intent_threshold&&(a.intent_threshold=n.intent_threshold),n.intent_content&&(a.intent_content=n.intent_content)),o?.isCancellationRequested?"not-sent":await Ipr(e,n.messages,n.copilotApiBaseUrl,n.engineName,r,n.ourRequestId,a,n.authToken,n.uiKind,i,n.llmInteraction,n.apiKey,n.modelProviderName,n.copilotEditsSessionHeader,o)}async handleError(e,r,n){if(n.clientError&&!n.headers.get("x-github-request-id")){let a=`Last response was a ${n.status} error and does not appear to originate from GitHub. Is a proxy or firewall intercepting this request? https://gh.io/copilot-firewall`;Zh.error(e,a),r.properties.error=`Response status was ${n.status} with no x-github-request-id header`}else r.properties.error=`Response status was ${n.status}`;if(r.properties.status=String(n.status),Bt(e,"request.shownWarning",r),n.status===401)try{let a=await n.text(),c=JSON.parse(a);if(c.authorize_url)return{type:"authRequired",reason:"not authorized",authUrl:c.authorize_url}}catch{}if(n.status===401||n.status===403)return e.get(ar).resetToken(n.status),{type:"failed",reason:`token expired or invalid: ${n.status}`,code:n.status};if(n.status===499)return Zh.info(e,"Cancelled by server"),{type:"failed",reason:"canceled by server",code:n.status};let i=await n.text();if(n.status===466)return Zh.info(e,i),{type:"failed",reason:`client not supported: ${i}`,code:n.status};if(n.status===400&&i.includes("off_topic"))return{type:"failed",reason:"filtered as off_topic by intent classifier: message was not programming related",code:n.status};if(n.status===400&&i.includes("model_not_supported"))return{type:"failed",reason:"model is not supported.",code:n.status};if(n.status==400&&i.includes("model_max_prompt_tokens_exceeded"))return{type:"failed",reason:"model max prompt tokens exceeded.",code:n.status};if(n.status===424)return{type:"failedDependency",reason:i};let o=await e.get(ar).getToken();if(n.status===402){if(i.includes("free_quota_exceeded")){let l=n.headers.get("retry-after");return{type:"failed",reason:l?`You've reached your monthly chat messages limit. Upgrade to Copilot Pro (30-day free trial) or wait until ${new Date(l).toLocaleString()} for your limit to reset.`:"You've reached your monthly chat messages limit. Upgrade to Copilot Pro (30-day free trial) or wait for your limit to reset.",code:n.status}}else{if(i.includes("overage_limit_reached"))return{type:"failed",reason:"You cannot accrue additional overages at this time. Please contact [GitHub Support](https://support.github.com/contact) to continue using Copilot.",code:n.status};if(i.includes("quota_exceeded"))switch(o.userInfo?.copilotPlan){case"free":return{type:"failed",reason:"You've reached your monthly chat messages quota. Upgrade to Copilot Pro (30-day free trial) or wait for your allowance to renew.",code:n.status};case"individual":return{type:"failed",reason:"You've reached your monthly chat messages quota. Please enable additional paid premium requests, upgrade to Copilot Pro+, or wait for your allowance to renew.",code:n.status};case"individual_pro":return{type:"failed",reason:"You've reached your monthly chat messages quota. Please enable additional paid premium requests or wait for your allowance to renew.",code:n.status};case"business":case"enterprise":return{type:"failed",reason:"You've reached your monthly chat messages quota. Please reach out to your organization's Copilot admin to enable additional paid premium requests or wait for your allowance to renew.",code:n.status};default:return{type:"failed",reason:"You've reached your monthly chat messages quota.",code:n.status}}}return{type:"failed",reason:"Quota Exceeded.",code:n.status}}return n.status===503?{type:"failed",reason:i,code:n.status}:(Zh.error(e,"Unhandled status from server:",n.status,i),{type:"failed",reason:`unhandled status from server: ${n.status} ${i}`,code:n.status})}};async function Ipr(t,e,r,n,i,o,a,c,l,u,f,p,m,h,g){let A=n===""&&i===""?r:Vi(r,n,i),y=u.extendedBy({endpoint:i,engineName:n,uiKind:l});qX(a,y,["messages"]),y.properties.headerRequestId=o,Bt(t,"request.sent",y);let E=Ba(),b=zYe(l),S={...dh(t),...f.toCapiHeaders()};return Pv()&&(S=await BB(t,S)),a.messages?.some(R=>Array.isArray(R.content)?R.content.some(B=>"image_url"in B):!1)&&(S["Copilot-Vision-Request"]="true"),p&&(S["api-key"]=p),h&&(S["copilot-edits-session"]=h),a.messages&&a.messages.forEach(R=>{Tpr(R)&&R.tool_calls&&(R.tool_calls=R.tool_calls.map(B=>Rut(B)))}),Cx(t,A,c,b,o,a,g,S,void 0,m).then(R=>{let B=HR(R);y.extendWithRequestId(B);let L=Ba()-E;return y.measurements.totalTimeMs=L,Zh.info(t,`Request ${o} at <${A}> finished with ${R.status} status after ${L}ms`),Zh.debug(t,"request.response properties",y.properties),Zh.debug(t,"request.response measurements",y.measurements),Zh.debug(t,"messages:",JSON.stringify(e)),Bt(t,"request.response",y),R}).catch(R=>{if(Td(R))throw R;let B=y.extendedBy({error:"Network exception"});Bt(t,"request.shownWarning",B),y.properties.message=String(Df(R,"name")??""),y.properties.code=String(Df(R,"code")??""),y.properties.errno=String(Df(R,"errno")??""),y.properties.type=String(Df(R,"type")??"");let L=Ba()-E;throw y.measurements.totalTimeMs=L,Zh.info(t,`Request ${o} at <${A}> rejected with ${String(R)} after ${L}ms`),Zh.debug(t,"request.error properties",y.properties),Zh.debug(t,"request.error measurements",y.measurements),Bt(t,"request.error",y),R}).finally(()=>{v3(t,e,y)})}s(Ipr,"fetchWithInstrumentation");function Tpr(t){return"tool_calls"in t}s(Tpr,"isChatMessageWithToolCalls");var Ps=class{constructor(e){this.ctx=e;this.fetcher=new hne}static{s(this,"ChatMLFetcher")}async fetchResponse(e,r,n,i){let o=br(),a={n:e.num_suggestions??1,temperature:e.temperature??0,stop:e.stop,top_p:e.topP??1,copilot_thread_id:e.copilot_thread_id,prediction:e.prediction},c=e.modelConfiguration;c&&(e.prediction?.content||delete a.prediction,e.prediction||e.modelConfiguration?.providerName===void 0&&c.maxResponseTokens!==void 0&&(a.max_tokens=c.maxResponseTokens),a.stream=!!c.stream),e.logitBias&&(a.logit_bias=e.logitBias);let l=await this.ctx.get(ar).getToken(),u,f,p,m;if(e.modelConfiguration?.providerName)if(p=await Tut(this.ctx,e.modelConfiguration?.providerName,e.modelConfiguration.modelId),m=e.modelConfiguration.providerName,e.intentParams=void 0,e.modelConfiguration?.providerName===Go.Azure)if(e.modelConfiguration.deploymentUrl)u=wut(e.modelConfiguration.modelId,e.modelConfiguration.deploymentUrl),f="",e.engineName="";else throw new Error(`No deployment URL found for Azure model: ${e.modelConfiguration.modelId}`);else if(fne(e.modelConfiguration?.providerName))u=nSe[e.modelConfiguration?.providerName],f=e.endpoint??"completions",e.authToken=p;else throw new Error(`Unsupported BYOK provider: ${e.modelConfiguration?.providerName}`);else u=qm(this.ctx,l,e.copilotApiProvider??"api"),f=e.endpoint??"completions";let h=e.authToken??l.token,g={messages:e.messages,repoInfo:void 0,ourRequestId:o,copilotApiBaseUrl:u,engineName:e.engineName??"chat",endpoint:f,count:e.num_suggestions??1,uiKind:e.uiKind,postOptions:a,authToken:h,apiKey:p,modelProviderName:m,...e.intentParams,llmInteraction:e.llmInteraction,prediction:e.prediction,copilotEditsSessionHeader:e.copilotEditsSessionHeader};return c&&(g.model=c.modelId),e.tools&&e.tools?.length>0&&(c===void 0||c.toolCalls)&&(g.tools=e.tools,g.tool_choice=e.tool_choice??"auto"),await this.fetch(g,i,r,n)}async fetch(e,r,n,i){try{let o=await this.fetcher.fetchAndStreamChat(this.ctx,e,i.extendedBy({uiKind:e.uiKind}),r||(()=>{}),n);switch(o.type){case"success":return await this.processSuccessfulResponse(e,o,e.ourRequestId,i);case"canceled":return this.processCanceledResponse(o,e.ourRequestId);case"failed":case"failedDependency":return this.processFailedResponse(o,e.ourRequestId);case"authRequired":return{type:"agentAuthRequired",reason:"Agent authentication required.",authUrl:o.authUrl,requestId:e.ourRequestId}}}catch(o){return this.processError(o,e.ourRequestId)}}async processSuccessfulResponse(e,r,n,i){let o=[],a=h7(r.chatCompletions,l=>this.postProcess(l,i));_r.debug(this.ctx,`Process success response for request ${e.ourRequestId} with chatParams: ${JSON.stringify(e,null,2)}`);let c=0;for await(let l of a)_r.debug(this.ctx,`Received choice #${c} for request ${e.ourRequestId}: ${JSON.stringify(l,null,2)}`),o.push(l),c++;if(o.length==1){let l=o[0];switch(l.finishReason){case"stop":return{type:"success",value:en(l.message?.content)??"",toolCalls:l.tool_calls,requestId:n,numTokens:l.numTokens,copilotEditsSessionHeader:l.copilotEditsSessionHeader};case"tool_calls":return{type:"tool_calls",toolCalls:l.tool_calls,requestId:n,copilotEditsSessionHeader:l.copilotEditsSessionHeader};case"content_filter":return{type:"filtered",reason:"Response got filtered.",requestId:n};case"length":return{type:"length",reason:"Response too long.",requestId:n,truncatedValue:en(l.message?.content)??""};case"DONE":return{type:"no_finish_reason",reason:"No finish reason received.",requestId:n};default:return{type:"unknown",reason:"Unknown finish reason received.",requestId:n}}}else if(o.length>1){let l=o.filter(u=>u.finishReason=="stop"||u.finishReason=="tool_calls");if(l.length>0)return{type:"successMultiple",value:l.map(u=>en(u.message.content)),toolCalls:l.map(u=>u.tool_calls).filter(u=>u),requestId:n,copilotEditsSessionHeader:l[0].copilotEditsSessionHeader}}return{type:"no_choices",reason:"Response contained no choices.",requestId:n}}postProcess(e,r){return Aee(e.tokens)?(r.extendWithRequestId(e.requestId),Bt(this.ctx,"conversation.repetition.detected",r,0),e.finishReason!==""?e:void 0):e.message?e:void 0}processCanceledResponse(e,r){return _r.debug(this.ctx,"Cancelled after awaiting fetchConversation"),{type:"canceled",reason:e.reason,requestId:r}}processFailedResponse(e,r){return e?.reason.includes("filtered as off_topic by intent classifier")?{type:"offTopic",reason:e.reason,requestId:r}:e?.reason.includes("model is not supported")?{type:"model_not_supported",reason:e.reason,requestId:r}:e?.reason.includes("model max prompt tokens exceeded")?{type:"model_max_prompt_tokens_exceeded",reason:e.reason,requestId:r}:{type:"failed",reason:e.reason,requestId:r,code:e.type==="failed"?e.code:void 0}}processError(e,r){return Td(e)?{type:"canceled",reason:"network request aborted",requestId:r}:(_r.exception(this.ctx,e,"Error on conversation request"),{type:"failed",reason:"Error on conversation request. Check the log for more details.",requestId:r})}};d();var x1=class{constructor(e){this.ctx=e}static{s(this,"AbstractClientToolConfirmationInvoker")}};d();var Nw=class{constructor(e){this.ctx=e}static{s(this,"AbstractClientToolInvoker")}};d();var Dut=new dt("CommandLineAutoApprover"),nE=class{constructor(e){this.ctx=e;this._denyListRules=[];this._allowListRules=[]}static{s(this,"CommandLineAutoApprover")}updateConfiguration(e){let{denyListRules:r,allowListRules:n}=this._mapAutoApproveConfigToRules(e);this._allowListRules=n,this._denyListRules=r}isCommandAutoApproved(e){for(let r of this._denyListRules)if(this._commandMatchesRegex(r.regex,e))return{result:"denied",reason:`Command '${e}' is denied by deny list rule: ${r.sourceText}`};for(let r of this._allowListRules)if(this._commandMatchesRegex(r.regex,e))return{result:"approved",reason:`Command '${e}' is approved by allow list rule: ${r.sourceText}`};return{result:"noMatch",reason:`Command '${e}' has no matching auto approve entries`}}_commandMatchesRegex(e,r){return!!e.test(r)}_mapAutoApproveConfigToRules(e){if(!e||typeof e!="object")return{denyListRules:[],allowListRules:[]};let r=[],n=[];return Object.entries(e).forEach(([i,o])=>{if(typeof o=="boolean"){let a=this._convertAutoApproveEntryToRegex(i);o===!0?n.push({regex:a,sourceText:i}):o===!1&&r.push({regex:a,sourceText:i})}else if(typeof o=="object"&&o!==null){let a=o;if(typeof a.approve=="boolean"){let c=this._convertAutoApproveEntryToRegex(i);a.approve===!0?n.push({regex:c,sourceText:i}):a.approve===!1&&r.push({regex:c,sourceText:i})}}}),Dut.debug(this.ctx,"Update CommandLineAutoApprover denyListRules",r),Dut.debug(this.ctx,"Update CommandLineAutoApprover allowListRules",n),{denyListRules:r,allowListRules:n}}_convertAutoApproveEntryToRegex(e){let r=e.match(/^\/(?<pattern>.+)\/(?<flags>[dgimsuvy]*)$/),n=r?.groups?.pattern;if(n){let o=r.groups?.flags;o&&(o=o.replaceAll("g",""));try{let a=new RegExp(n,o||void 0);return this._regExpLeadsToEndlessLoop(a)?/(?!.*)/:a}catch{return/(?!.*)/}}let i=e.replace(/[\\^$.*+?()[\]{}|]/g,"\\$&");return new RegExp(`^${i}\\b`)}_regExpLeadsToEndlessLoop(e){return e.source==="^"||e.source==="^$"||e.source==="$"||e.source==="^\\s*$"?!1:!!(e.exec("")&&e.lastIndex===0)}};d();var wpr=".github/copilot-instructions.md",Spr=".github/git-commit-instructions.md",_pr="global-copilot-instructions",Rpr="global-git-commit-instructions",E1=class{static{s(this,"CustomInstructionsService")}constructor(){this.globalCopilotInstructions=void 0,this.globalGitCommitInstructions=void 0}setGlobalCopilotInstructions(e,r){e&&e.trim()?this.globalCopilotInstructions={instruction:e.trim(),languageId:r}:this.globalCopilotInstructions=void 0}setGlobalGitCommitInstructions(e,r){e&&e.trim()?this.globalGitCommitInstructions={instruction:e.trim(),languageId:r}:this.globalGitCommitInstructions=void 0}getGlobalCopilotInstructions(){return this.globalCopilotInstructions}getGlobalGitCommitInstructions(){return this.globalGitCommitInstructions}getGlobalInstructions(e={}){let r=[];return e.includeCodeGenerationInstructions&&this.globalCopilotInstructions&&r.push({kind:1,content:[this.globalCopilotInstructions],reference:_pr}),e.includeCommitMessageGenerationInstructions&&this.globalGitCommitInstructions&&r.push({kind:1,content:[this.globalGitCommitInstructions],reference:Rpr}),r}async _collectInstructionsFromFile(e,r,n,i,o,a){try{let c=Vi(r.uri,n),l=(await e.get(Fi).readFileString(c)).trim();if(!l)return;(await wx(e,{uri:c},l)).status==="valid"&&o.push({kind:a,content:[{instruction:l,languageId:i}],reference:c})}catch{}}async readFromWorkspaces(e,r,n={}){let i=[];if(!r.length)return i;let o=r.flatMap(a=>{let c=[];return n.includeCodeGenerationInstructions!==!1&&c.push(this._collectInstructionsFromFile(e,a,wpr,n.languageId,i,0)),n.includeCommitMessageGenerationInstructions&&c.push(this._collectInstructionsFromFile(e,a,Spr,void 0,i,0)),c});return await Promise.all(o),i}};d();d();d();d();d();d();d();var kpr=Symbol("MicrotaskDelay");function Ane(t){return!!t&&typeof t.then=="function"}s(Ane,"isThenable");function Ppr(t){let e=new Dx,r=t(e.token),n=new Promise((i,o)=>{let a=e.token.onCancellationRequested(()=>{a.dispose(),o(new V0)});Promise.resolve(r).then(c=>{a.dispose(),e.dispose(),i(c)},c=>{a.dispose(),e.dispose(),o(c)})});return new class{cancel(){e.cancel(),e.dispose()}then(i,o){return n.then(i,o)}catch(i){return this.then(void 0,i)}finally(i){return n.finally(i)}}}s(Ppr,"createCancelablePromise");function iE(t,e){return e?new Promise((r,n)=>{let i=setTimeout(()=>{o.dispose(),r()},t),o=e.onCancellationRequested(()=>{clearTimeout(i),o.dispose(),n(new V0)})}):Ppr(r=>iE(t,r))}s(iE,"timeout");var s8=class{constructor(e,r){this._isDisposed=!1;this._token=-1,typeof e=="function"&&typeof r=="number"&&this.setIfNotSet(e,r)}static{s(this,"TimeoutTimer")}dispose(){this.cancel(),this._isDisposed=!0}cancel(){this._token!==-1&&(clearTimeout(this._token),this._token=-1)}cancelAndSet(e,r){if(this._isDisposed)throw new xn("Calling 'cancelAndSet' on a disposed TimeoutTimer");this.cancel(),this._token=setTimeout(()=>{this._token=-1,e()},r)}setIfNotSet(e,r){if(this._isDisposed)throw new xn("Calling 'setIfNotSet' on a disposed TimeoutTimer");this._token===-1&&(this._token=setTimeout(()=>{this._token=-1,e()},r))}};var cU=class{static{s(this,"DeferredPromise")}get isRejected(){return this.outcome?.outcome===1}get isResolved(){return this.outcome?.outcome===0}get isSettled(){return!!this.outcome}get value(){return this.outcome?.outcome===0?this.outcome?.value:void 0}constructor(){this.p=new Promise((e,r)=>{this.completeCallback=e,this.errorCallback=r})}complete(e){return new Promise(r=>{this.completeCallback(e),this.outcome={outcome:0,value:e},r()})}error(e){return new Promise(r=>{this.errorCallback(e),this.outcome={outcome:1,value:e},r()})}cancel(){return this.error(new V0)}},Dpr;(r=>{async function t(n){let i,o=await Promise.all(n.map(a=>a.then(c=>c,c=>{i||(i=c)})));if(typeof i<"u")throw i;return o}r.settled=t,s(t,"settled");function e(n){return new Promise(async(i,o)=>{try{await n(i,o)}catch(a){o(a)}})}r.withAsyncBody=e,s(e,"withAsyncBody")})(Dpr||={});var lU=class t{static{s(this,"AsyncIterableObject")}static fromArray(e){return new t(r=>{r.emitMany(e)})}static fromPromise(e){return new t(async r=>{r.emitMany(await e)})}static fromPromisesResolveOrder(e){return new t(async r=>{await Promise.all(e.map(async n=>r.emitOne(await n)))})}static merge(e){return new t(async r=>{await Promise.all(e.map(async n=>{for await(let i of n)r.emitOne(i)}))})}static{this.EMPTY=t.fromArray([])}constructor(e,r){this._state=0,this._results=[],this._error=null,this._onReturn=r,this._onStateChanged=new K0,queueMicrotask(async()=>{let n={emitOne:s(i=>this.emitOne(i),"emitOne"),emitMany:s(i=>this.emitMany(i),"emitMany"),reject:s(i=>this.reject(i),"reject")};try{await Promise.resolve(e(n)),this.resolve()}catch(i){this.reject(i)}finally{n.emitOne=void 0,n.emitMany=void 0,n.reject=void 0}})}[Symbol.asyncIterator](){let e=0;return{next:s(async()=>{do{if(this._state===2)throw this._error;if(e<this._results.length)return{done:!1,value:this._results[e++]};if(this._state===1)return{done:!0,value:void 0};await WR.toPromise(this._onStateChanged.event)}while(!0)},"next"),return:s(async()=>(this._onReturn?.(),{done:!0,value:void 0}),"return")}}static map(e,r){return new t(async n=>{for await(let i of e)n.emitOne(r(i))})}map(e){return t.map(this,e)}static filter(e,r){return new t(async n=>{for await(let i of e)r(i)&&n.emitOne(i)})}filter(e){return t.filter(this,e)}static coalesce(e){return t.filter(e,r=>!!r)}coalesce(){return t.coalesce(this)}static async toPromise(e){let r=[];for await(let n of e)r.push(n);return r}toPromise(){return t.toPromise(this)}emitOne(e){this._state===0&&(this._results.push(e),this._onStateChanged.fire())}emitMany(e){this._state===0&&(this._results=this._results.concat(e),this._onStateChanged.fire())}resolve(){this._state===0&&(this._state=1,this._onStateChanged.fire())}reject(e){this._state===0&&(this._state=2,this._error=e,this._onStateChanged.fire())}};var gne=class{constructor(e){this._deferred=new cU;this._asyncIterable=new lU(i=>{if(r){i.reject(r);return}return n&&i.emitMany(n),this._errorFn=o=>i.reject(o),this._emitFn=o=>i.emitOne(o),this._deferred.p},e);let r,n;this._emitFn=i=>{n||(n=[]),n.push(i)},this._errorFn=i=>{r||(r=i)}}static{s(this,"AsyncIterableSource")}get asyncIterable(){return this._asyncIterable}resolve(){this._deferred.complete()}reject(e){this._errorFn(e),this._deferred.complete()}emitOne(e){this._emitFn(e)}};d();d();d();d();var yne=!1,Cne=!1,uU=!1,Bpr=!1,Npr=!1,But=!1,Mpr=!1,Lpr=!1,Fpr=!1,Opr=!1;var oE,sE=globalThis,eg;typeof sE.vscode<"u"&&typeof sE.vscode.process<"u"?eg=sE.vscode.process:typeof process<"u"&&typeof process?.versions?.node=="string"&&(eg=process);var Nut=typeof eg?.versions?.electron=="string",Qpr=Nut&&eg?.type==="renderer";typeof eg=="object"?(yne=eg.platform==="win32",Cne=eg.platform==="darwin",uU=eg.platform==="linux",Bpr=uU&&!!eg.env.SNAP&&!!eg.env.SNAP_REVISION,Mpr=Nut,Fpr=!!eg.env.CI||!!eg.env.BUILD_ARTIFACTSTAGINGDIRECTORY,Npr=!0):typeof navigator=="object"&&!Qpr?(oE=navigator.userAgent,yne=oE.indexOf("Windows")>=0,Cne=oE.indexOf("Macintosh")>=0,Lpr=(oE.indexOf("Macintosh")>=0||oE.indexOf("iPad")>=0||oE.indexOf("iPhone")>=0)&&!!navigator.maxTouchPoints&&navigator.maxTouchPoints>0,uU=oE.indexOf("Linux")>=0,Opr=oE?.indexOf("Mobi")>=0,But=!0):console.error("Unable to resolve platform.");var oSe=0;Cne?oSe=1:yne?oSe=3:uU&&(oSe=2);var Mw=yne,Mut=Cne,Lut=uU;var Upr=But&&typeof sE.importScripts=="function",ixi=Upr?sE.origin:void 0;var b1=oE;var qpr=typeof sE.postMessage=="function"&&!sE.importScripts,oxi=(()=>{if(qpr){let t=[];sE.addEventListener("message",r=>{if(r.data&&r.data.vscodeScheduleAsyncWork)for(let n=0,i=t.length;n<i;n++){let o=t[n];if(o.id===r.data.vscodeScheduleAsyncWork){t.splice(n,1),o.callback();return}}});let e=0;return r=>{let n=++e;t.push({id:n,callback:r}),sE.postMessage({vscodeScheduleAsyncWork:n},"*")}}return t=>setTimeout(t)})();var Hpr=!!(b1&&b1.indexOf("Chrome")>=0),sxi=!!(b1&&b1.indexOf("Firefox")>=0),axi=!!(!Hpr&&b1&&b1.indexOf("Safari")>=0),cxi=!!(b1&&b1.indexOf("Edg/")>=0),lxi=!!(b1&&b1.indexOf("Android")>=0);var Lk,sSe=globalThis.vscode;if(typeof sSe<"u"&&typeof sSe.process<"u"){let t=sSe.process;Lk={get platform(){return t.platform},get arch(){return t.arch},get env(){return t.env},cwd(){return t.cwd()}}}else typeof process<"u"&&typeof process?.versions?.node=="string"?Lk={get platform(){return process.platform},get arch(){return process.arch},get env(){return process.env},cwd(){return process.env.VSCODE_CWD||process.cwd()}}:Lk={get platform(){return Mw?"win32":Mut?"darwin":"linux"},get arch(){},get env(){return{}},cwd(){return"/"}};var dU=Lk.cwd,Fut=Lk.env,Out=Lk.platform,hxi=Lk.arch;var Wpr=65,jpr=97,Gpr=90,Vpr=122,Ow=46,xu=47,Wp=92,Lw=58,zpr=63,vne=class extends Error{static{s(this,"ErrorInvalidArgType")}constructor(e,r,n){let i;typeof r=="string"&&r.indexOf("not ")===0?(i="must not be",r=r.replace(/^not /,"")):i="must be";let o=e.indexOf(".")!==-1?"property":"argument",a=`The "${e}" ${o} ${i} of type ${r}`;a+=`. Received type ${typeof n}`,super(a),this.code="ERR_INVALID_ARG_TYPE"}};function Kpr(t,e){if(t===null||typeof t!="object")throw new vne(e,"Object",t)}s(Kpr,"validateObject");function Cc(t,e){if(typeof t!="string")throw new vne(e,"string",t)}s(Cc,"validateString");var jp=Out==="win32";function Ti(t){return t===xu||t===Wp}s(Ti,"isPathSeparator");function aSe(t){return t===xu}s(aSe,"isPosixPathSeparator");function Fw(t){return t>=Wpr&&t<=Gpr||t>=jpr&&t<=Vpr}s(Fw,"isWindowsDeviceRoot");function xne(t,e,r,n){let i="",o=0,a=-1,c=0,l=0;for(let u=0;u<=t.length;++u){if(u<t.length)l=t.charCodeAt(u);else{if(n(l))break;l=xu}if(n(l)){if(!(a===u-1||c===1))if(c===2){if(i.length<2||o!==2||i.charCodeAt(i.length-1)!==Ow||i.charCodeAt(i.length-2)!==Ow){if(i.length>2){let f=i.lastIndexOf(r);f===-1?(i="",o=0):(i=i.slice(0,f),o=i.length-1-i.lastIndexOf(r)),a=u,c=0;continue}else if(i.length!==0){i="",o=0,a=u,c=0;continue}}e&&(i+=i.length>0?`${r}..`:"..",o=2)}else i.length>0?i+=`${r}${t.slice(a+1,u)}`:i=t.slice(a+1,u),o=u-a-1;a=u,c=0}else l===Ow&&c!==-1?++c:c=-1}return i}s(xne,"normalizeString");function Ypr(t){return t?`${t[0]==="."?"":"."}${t}`:""}s(Ypr,"formatExt");function Qut(t,e){Kpr(e,"pathObject");let r=e.dir||e.root,n=e.base||`${e.name||""}${Ypr(e.ext)}`;return r?r===e.root?`${r}${n}`:`${r}${t}${n}`:n}s(Qut,"_format");var vc={resolve(...t){let e="",r="",n=!1;for(let i=t.length-1;i>=-1;i--){let o;if(i>=0){if(o=t[i],Cc(o,`paths[${i}]`),o.length===0)continue}else e.length===0?o=dU():(o=Fut[`=${e}`]||dU(),(o===void 0||o.slice(0,2).toLowerCase()!==e.toLowerCase()&&o.charCodeAt(2)===Wp)&&(o=`${e}\\`));let a=o.length,c=0,l="",u=!1,f=o.charCodeAt(0);if(a===1)Ti(f)&&(c=1,u=!0);else if(Ti(f))if(u=!0,Ti(o.charCodeAt(1))){let p=2,m=p;for(;p<a&&!Ti(o.charCodeAt(p));)p++;if(p<a&&p!==m){let h=o.slice(m,p);for(m=p;p<a&&Ti(o.charCodeAt(p));)p++;if(p<a&&p!==m){for(m=p;p<a&&!Ti(o.charCodeAt(p));)p++;(p===a||p!==m)&&(l=`\\\\${h}\\${o.slice(m,p)}`,c=p)}}}else c=1;else Fw(f)&&o.charCodeAt(1)===Lw&&(l=o.slice(0,2),c=2,a>2&&Ti(o.charCodeAt(2))&&(u=!0,c=3));if(l.length>0)if(e.length>0){if(l.toLowerCase()!==e.toLowerCase())continue}else e=l;if(n){if(e.length>0)break}else if(r=`${o.slice(c)}\\${r}`,n=u,u&&e.length>0)break}return r=xne(r,!n,"\\",Ti),n?`${e}\\${r}`:`${e}${r}`||"."},normalize(t){Cc(t,"path");let e=t.length;if(e===0)return".";let r=0,n,i=!1,o=t.charCodeAt(0);if(e===1)return aSe(o)?"\\":t;if(Ti(o))if(i=!0,Ti(t.charCodeAt(1))){let c=2,l=c;for(;c<e&&!Ti(t.charCodeAt(c));)c++;if(c<e&&c!==l){let u=t.slice(l,c);for(l=c;c<e&&Ti(t.charCodeAt(c));)c++;if(c<e&&c!==l){for(l=c;c<e&&!Ti(t.charCodeAt(c));)c++;if(c===e)return`\\\\${u}\\${t.slice(l)}\\`;c!==l&&(n=`\\\\${u}\\${t.slice(l,c)}`,r=c)}}}else r=1;else Fw(o)&&t.charCodeAt(1)===Lw&&(n=t.slice(0,2),r=2,e>2&&Ti(t.charCodeAt(2))&&(i=!0,r=3));let a=r<e?xne(t.slice(r),!i,"\\",Ti):"";return a.length===0&&!i&&(a="."),a.length>0&&Ti(t.charCodeAt(e-1))&&(a+="\\"),n===void 0?i?`\\${a}`:a:i?`${n}\\${a}`:`${n}${a}`},isAbsolute(t){Cc(t,"path");let e=t.length;if(e===0)return!1;let r=t.charCodeAt(0);return Ti(r)||e>2&&Fw(r)&&t.charCodeAt(1)===Lw&&Ti(t.charCodeAt(2))},join(...t){if(t.length===0)return".";let e,r;for(let o=0;o<t.length;++o){let a=t[o];Cc(a,"path"),a.length>0&&(e===void 0?e=r=a:e+=`\\${a}`)}if(e===void 0)return".";let n=!0,i=0;if(typeof r=="string"&&Ti(r.charCodeAt(0))){++i;let o=r.length;o>1&&Ti(r.charCodeAt(1))&&(++i,o>2&&(Ti(r.charCodeAt(2))?++i:n=!1))}if(n){for(;i<e.length&&Ti(e.charCodeAt(i));)i++;i>=2&&(e=`\\${e.slice(i)}`)}return vc.normalize(e)},relative(t,e){if(Cc(t,"from"),Cc(e,"to"),t===e)return"";let r=vc.resolve(t),n=vc.resolve(e);if(r===n||(t=r.toLowerCase(),e=n.toLowerCase(),t===e))return"";let i=0;for(;i<t.length&&t.charCodeAt(i)===Wp;)i++;let o=t.length;for(;o-1>i&&t.charCodeAt(o-1)===Wp;)o--;let a=o-i,c=0;for(;c<e.length&&e.charCodeAt(c)===Wp;)c++;let l=e.length;for(;l-1>c&&e.charCodeAt(l-1)===Wp;)l--;let u=l-c,f=a<u?a:u,p=-1,m=0;for(;m<f;m++){let g=t.charCodeAt(i+m);if(g!==e.charCodeAt(c+m))break;g===Wp&&(p=m)}if(m!==f){if(p===-1)return n}else{if(u>f){if(e.charCodeAt(c+m)===Wp)return n.slice(c+m+1);if(m===2)return n.slice(c+m)}a>f&&(t.charCodeAt(i+m)===Wp?p=m:m===2&&(p=3)),p===-1&&(p=0)}let h="";for(m=i+p+1;m<=o;++m)(m===o||t.charCodeAt(m)===Wp)&&(h+=h.length===0?"..":"\\..");return c+=p,h.length>0?`${h}${n.slice(c,l)}`:(n.charCodeAt(c)===Wp&&++c,n.slice(c,l))},toNamespacedPath(t){if(typeof t!="string"||t.length===0)return t;let e=vc.resolve(t);if(e.length<=2)return t;if(e.charCodeAt(0)===Wp){if(e.charCodeAt(1)===Wp){let r=e.charCodeAt(2);if(r!==zpr&&r!==Ow)return`\\\\?\\UNC\\${e.slice(2)}`}}else if(Fw(e.charCodeAt(0))&&e.charCodeAt(1)===Lw&&e.charCodeAt(2)===Wp)return`\\\\?\\${e}`;return t},dirname(t){Cc(t,"path");let e=t.length;if(e===0)return".";let r=-1,n=0,i=t.charCodeAt(0);if(e===1)return Ti(i)?t:".";if(Ti(i)){if(r=n=1,Ti(t.charCodeAt(1))){let c=2,l=c;for(;c<e&&!Ti(t.charCodeAt(c));)c++;if(c<e&&c!==l){for(l=c;c<e&&Ti(t.charCodeAt(c));)c++;if(c<e&&c!==l){for(l=c;c<e&&!Ti(t.charCodeAt(c));)c++;if(c===e)return t;c!==l&&(r=n=c+1)}}}}else Fw(i)&&t.charCodeAt(1)===Lw&&(r=e>2&&Ti(t.charCodeAt(2))?3:2,n=r);let o=-1,a=!0;for(let c=e-1;c>=n;--c)if(Ti(t.charCodeAt(c))){if(!a){o=c;break}}else a=!1;if(o===-1){if(r===-1)return".";o=r}return t.slice(0,o)},basename(t,e){e!==void 0&&Cc(e,"suffix"),Cc(t,"path");let r=0,n=-1,i=!0,o;if(t.length>=2&&Fw(t.charCodeAt(0))&&t.charCodeAt(1)===Lw&&(r=2),e!==void 0&&e.length>0&&e.length<=t.length){if(e===t)return"";let a=e.length-1,c=-1;for(o=t.length-1;o>=r;--o){let l=t.charCodeAt(o);if(Ti(l)){if(!i){r=o+1;break}}else c===-1&&(i=!1,c=o+1),a>=0&&(l===e.charCodeAt(a)?--a===-1&&(n=o):(a=-1,n=c))}return r===n?n=c:n===-1&&(n=t.length),t.slice(r,n)}for(o=t.length-1;o>=r;--o)if(Ti(t.charCodeAt(o))){if(!i){r=o+1;break}}else n===-1&&(i=!1,n=o+1);return n===-1?"":t.slice(r,n)},extname(t){Cc(t,"path");let e=0,r=-1,n=0,i=-1,o=!0,a=0;t.length>=2&&t.charCodeAt(1)===Lw&&Fw(t.charCodeAt(0))&&(e=n=2);for(let c=t.length-1;c>=e;--c){let l=t.charCodeAt(c);if(Ti(l)){if(!o){n=c+1;break}continue}i===-1&&(o=!1,i=c+1),l===Ow?r===-1?r=c:a!==1&&(a=1):r!==-1&&(a=-1)}return r===-1||i===-1||a===0||a===1&&r===i-1&&r===n+1?"":t.slice(r,i)},format:Qut.bind(null,"\\"),parse(t){Cc(t,"path");let e={root:"",dir:"",base:"",ext:"",name:""};if(t.length===0)return e;let r=t.length,n=0,i=t.charCodeAt(0);if(r===1)return Ti(i)?(e.root=e.dir=t,e):(e.base=e.name=t,e);if(Ti(i)){if(n=1,Ti(t.charCodeAt(1))){let p=2,m=p;for(;p<r&&!Ti(t.charCodeAt(p));)p++;if(p<r&&p!==m){for(m=p;p<r&&Ti(t.charCodeAt(p));)p++;if(p<r&&p!==m){for(m=p;p<r&&!Ti(t.charCodeAt(p));)p++;p===r?n=p:p!==m&&(n=p+1)}}}}else if(Fw(i)&&t.charCodeAt(1)===Lw){if(r<=2)return e.root=e.dir=t,e;if(n=2,Ti(t.charCodeAt(2))){if(r===3)return e.root=e.dir=t,e;n=3}}n>0&&(e.root=t.slice(0,n));let o=-1,a=n,c=-1,l=!0,u=t.length-1,f=0;for(;u>=n;--u){if(i=t.charCodeAt(u),Ti(i)){if(!l){a=u+1;break}continue}c===-1&&(l=!1,c=u+1),i===Ow?o===-1?o=u:f!==1&&(f=1):o!==-1&&(f=-1)}return c!==-1&&(o===-1||f===0||f===1&&o===c-1&&o===a+1?e.base=e.name=t.slice(a,c):(e.name=t.slice(a,o),e.base=t.slice(a,c),e.ext=t.slice(o,c))),a>0&&a!==n?e.dir=t.slice(0,a-1):e.dir=e.root,e},sep:"\\",delimiter:";",win32:null,posix:null},Jpr=(()=>{if(jp){let t=/\\/g;return()=>{let e=dU().replace(t,"/");return e.slice(e.indexOf("/"))}}return()=>dU()})(),ma={resolve(...t){let e="",r=!1;for(let n=t.length-1;n>=-1&&!r;n--){let i=n>=0?t[n]:Jpr();Cc(i,`paths[${n}]`),i.length!==0&&(e=`${i}/${e}`,r=i.charCodeAt(0)===xu)}return e=xne(e,!r,"/",aSe),r?`/${e}`:e.length>0?e:"."},normalize(t){if(Cc(t,"path"),t.length===0)return".";let e=t.charCodeAt(0)===xu,r=t.charCodeAt(t.length-1)===xu;return t=xne(t,!e,"/",aSe),t.length===0?e?"/":r?"./":".":(r&&(t+="/"),e?`/${t}`:t)},isAbsolute(t){return Cc(t,"path"),t.length>0&&t.charCodeAt(0)===xu},join(...t){if(t.length===0)return".";let e;for(let r=0;r<t.length;++r){let n=t[r];Cc(n,"path"),n.length>0&&(e===void 0?e=n:e+=`/${n}`)}return e===void 0?".":ma.normalize(e)},relative(t,e){if(Cc(t,"from"),Cc(e,"to"),t===e||(t=ma.resolve(t),e=ma.resolve(e),t===e))return"";let r=1,n=t.length,i=n-r,o=1,a=e.length-o,c=i<a?i:a,l=-1,u=0;for(;u<c;u++){let p=t.charCodeAt(r+u);if(p!==e.charCodeAt(o+u))break;p===xu&&(l=u)}if(u===c)if(a>c){if(e.charCodeAt(o+u)===xu)return e.slice(o+u+1);if(u===0)return e.slice(o+u)}else i>c&&(t.charCodeAt(r+u)===xu?l=u:u===0&&(l=0));let f="";for(u=r+l+1;u<=n;++u)(u===n||t.charCodeAt(u)===xu)&&(f+=f.length===0?"..":"/..");return`${f}${e.slice(o+l)}`},toNamespacedPath(t){return t},dirname(t){if(Cc(t,"path"),t.length===0)return".";let e=t.charCodeAt(0)===xu,r=-1,n=!0;for(let i=t.length-1;i>=1;--i)if(t.charCodeAt(i)===xu){if(!n){r=i;break}}else n=!1;return r===-1?e?"/":".":e&&r===1?"//":t.slice(0,r)},basename(t,e){e!==void 0&&Cc(e,"ext"),Cc(t,"path");let r=0,n=-1,i=!0,o;if(e!==void 0&&e.length>0&&e.length<=t.length){if(e===t)return"";let a=e.length-1,c=-1;for(o=t.length-1;o>=0;--o){let l=t.charCodeAt(o);if(l===xu){if(!i){r=o+1;break}}else c===-1&&(i=!1,c=o+1),a>=0&&(l===e.charCodeAt(a)?--a===-1&&(n=o):(a=-1,n=c))}return r===n?n=c:n===-1&&(n=t.length),t.slice(r,n)}for(o=t.length-1;o>=0;--o)if(t.charCodeAt(o)===xu){if(!i){r=o+1;break}}else n===-1&&(i=!1,n=o+1);return n===-1?"":t.slice(r,n)},extname(t){Cc(t,"path");let e=-1,r=0,n=-1,i=!0,o=0;for(let a=t.length-1;a>=0;--a){let c=t.charCodeAt(a);if(c===xu){if(!i){r=a+1;break}continue}n===-1&&(i=!1,n=a+1),c===Ow?e===-1?e=a:o!==1&&(o=1):e!==-1&&(o=-1)}return e===-1||n===-1||o===0||o===1&&e===n-1&&e===r+1?"":t.slice(e,n)},format:Qut.bind(null,"/"),parse(t){Cc(t,"path");let e={root:"",dir:"",base:"",ext:"",name:""};if(t.length===0)return e;let r=t.charCodeAt(0)===xu,n;r?(e.root="/",n=1):n=0;let i=-1,o=0,a=-1,c=!0,l=t.length-1,u=0;for(;l>=n;--l){let f=t.charCodeAt(l);if(f===xu){if(!c){o=l+1;break}continue}a===-1&&(c=!1,a=l+1),f===Ow?i===-1?i=l:u!==1&&(u=1):i!==-1&&(u=-1)}if(a!==-1){let f=o===0&&r?1:o;i===-1||u===0||u===1&&i===a-1&&i===o+1?e.base=e.name=t.slice(f,a):(e.name=t.slice(f,i),e.base=t.slice(f,a),e.ext=t.slice(i,a))}return o>0?e.dir=t.slice(0,o-1):r&&(e.dir="/"),e},sep:"/",delimiter:":",win32:null,posix:null};ma.win32=vc.win32=vc;ma.posix=vc.posix=ma;var Xpr=jp?vc.normalize:ma.normalize,Zpr=jp?vc.isAbsolute:ma.isAbsolute,Ene=jp?vc.join:ma.join,Axi=jp?vc.resolve:ma.resolve,yxi=jp?vc.relative:ma.relative,Cxi=jp?vc.dirname:ma.dirname,bne=jp?vc.basename:ma.basename,Ine=jp?vc.extname:ma.extname,vxi=jp?vc.format:ma.format,xxi=jp?vc.parse:ma.parse,Exi=jp?vc.toNamespacedPath:ma.toNamespacedPath,Fk=jp?vc.sep:ma.sep,bxi=jp?vc.delimiter:ma.delimiter;d();function qut(t){return typeof t=="object"&&t!==null&&!Array.isArray(t)&&!(t instanceof RegExp)&&!(t instanceof Date)}s(qut,"isObject");function Tne(t,e){if(!t)throw new Error(e?`Unexpected type, expected '${e}'`:"Unexpected type")}s(Tne,"assertType");function Hut(t,e,r,n=Fk){if(t===e)return!0;if(!t||!e||e.length>t.length)return!1;if(r){if(!AXe(t,e))return!1;if(e.length===t.length)return!0;let o=e.length;return e.charAt(e.length-1)===n&&o--,t.charAt(o)===n}return e.charAt(e.length-1)!==n&&(e+=n),t.indexOf(e)===0}s(Hut,"isEqualOrParent");var wne="**",$ut="/",Sne="[/\\\\]",_ne="[^/\\\\]",e0r=/\//g;function Wut(t,e){switch(t){case 0:return"";case 1:return`${_ne}*?`;default:return`(?:${Sne}|${_ne}+${Sne}${e?`|${Sne}${_ne}+`:""})*?`}}s(Wut,"starsToRegExp");function fU(t,e){if(!t)return[];let r=[],n=!1,i=!1,o="";for(let a of t){switch(a){case e:if(!n&&!i){r.push(o),o="";continue}break;case"{":n=!0;break;case"}":n=!1;break;case"[":i=!0;break;case"]":i=!1;break}o+=a}return o&&r.push(o),r}s(fU,"splitGlobAware");function zut(t){if(!t)return"";let e="",r=fU(t,$ut);if(r.every(n=>n===wne))e=".*";else{let n=!1;r.forEach((i,o)=>{if(i===wne){if(n)return;e+=Wut(2,o===r.length-1)}else{let a=!1,c="",l=!1,u="";for(let f of i){if(f!=="}"&&a){c+=f;continue}if(l&&(f!=="]"||!u)){let p;f==="-"?p=f:(f==="^"||f==="!")&&!u?p="^":f===$ut?p="":p=O3(f),u+=p;continue}switch(f){case"{":a=!0;continue;case"[":l=!0;continue;case"}":{let m=`(?:${fU(c,",").map(h=>zut(h)).join("|")})`;e+=m,a=!1,c="";break}case"]":{e+="["+u+"]",l=!1,u="";break}case"?":e+=_ne;continue;case"*":e+=Wut(1);continue;default:e+=O3(f)}}o<r.length-1&&(r[o+1]!==wne||o+2<r.length)&&(e+=Sne)}n=i===wne})}return e}s(zut,"parseRegExp");var t0r=/^\*\*\/\*\.[\w\.-]+$/,r0r=/^\*\*\/([\w\.-]+)\/?$/,n0r=/^{\*\*\/\*?[\w\.-]+\/?(,\*\*\/\*?[\w\.-]+\/?)*}$/,i0r=/^{\*\*\/\*?[\w\.-]+(\/(\*\*)?)?(,\*\*\/\*?[\w\.-]+(\/(\*\*)?)?)*}$/,o0r=/^\*\*((\/[\w\.-]+)+)\/?$/,s0r=/^([\w\.-]+(\/[\w\.-]+)*)\/?$/,jut=new l3(1e4),lSe=s(function(){return!1},"FALSE"),XA=s(function(){return null},"NULL");function Kut(t){return t===lSe||t===XA}s(Kut,"isEmptyPattern");function uSe(t,e){if(!t)return XA;let r;typeof t!="string"?r=t.pattern:r=t,r=r.trim();let n=`${r}_${!!e.trimForExclusions}`,i=jut.get(n);if(i)return Gut(i,t);let o;return t0r.test(r)?i=a0r(r.substr(4),r):(o=r0r.exec(cSe(r,e)))?i=c0r(o[1],r):(e.trimForExclusions?i0r:n0r).test(r)?i=l0r(r,e):(o=o0r.exec(cSe(r,e)))?i=Vut(o[1].substr(1),r,!0):(o=s0r.exec(cSe(r,e)))?i=Vut(o[1],r,!1):i=u0r(r),jut.set(n,i),Gut(i,t)}s(uSe,"parsePattern");function Gut(t,e){if(typeof e=="string")return t;let r=s(function(n,i){return Hut(n,e.base,!Lut)?t(gXe(n.substr(e.base.length),Fk),i):null},"wrappedPattern");return r.allBasenames=t.allBasenames,r.allPaths=t.allPaths,r.basenames=t.basenames,r.patterns=t.patterns,r}s(Gut,"wrapRelativePattern");function cSe(t,e){return e.trimForExclusions&&t.endsWith("/**")?t.substr(0,t.length-2):t}s(cSe,"trimForExclusions");function a0r(t,e){return function(r,n){return typeof r=="string"&&r.endsWith(t)?e:null}}s(a0r,"trivia1");function c0r(t,e){let r=`/${t}`,n=`\\${t}`,i=s(function(a,c){return typeof a!="string"?null:c?c===t?e:null:a===t||a.endsWith(r)||a.endsWith(n)?e:null},"parsedPattern"),o=[t];return i.basenames=o,i.patterns=[e],i.allBasenames=o,i}s(c0r,"trivia2");function l0r(t,e){let r=Jut(t.slice(1,-1).split(",").map(c=>uSe(c,e)).filter(c=>c!==XA),t),n=r.length;if(!n)return XA;if(n===1)return r[0];let i=s(function(c,l){for(let u=0,f=r.length;u<f;u++)if(r[u](c,l))return t;return null},"parsedPattern"),o=r.find(c=>!!c.allBasenames);o&&(i.allBasenames=o.allBasenames);let a=r.reduce((c,l)=>l.allPaths?c.concat(l.allPaths):c,[]);return a.length&&(i.allPaths=a),i}s(l0r,"trivia3");function Vut(t,e,r){let n=Fk===ma.sep,i=n?t:t.replace(e0r,Fk),o=Fk+i,a=ma.sep+t,c;return r?c=s(function(l,u){return typeof l=="string"&&(l===i||l.endsWith(o)||!n&&(l===t||l.endsWith(a)))?e:null},"parsedPattern"):c=s(function(l,u){return typeof l=="string"&&(l===i||!n&&l===t)?e:null},"parsedPattern"),c.allPaths=[(r?"*/":"./")+t],c}s(Vut,"trivia4and5");function u0r(t){try{let e=new RegExp(`^${zut(t)}$`);return function(r){return e.lastIndex=0,typeof r=="string"&&e.test(r)?t:null}}catch{return XA}}s(u0r,"toRegExp");function Yut(t,e,r){return!t||typeof e!="string"?!1:dSe(t)(e,void 0,r)}s(Yut,"match");function dSe(t,e={}){if(!t)return lSe;if(typeof t=="string"||d0r(t)){let r=uSe(t,e);if(r===XA)return lSe;let n=s(function(i,o){return!!r(i,o)},"resultPattern");return r.allBasenames&&(n.allBasenames=r.allBasenames),r.allPaths&&(n.allPaths=r.allPaths),n}return f0r(t,e)}s(dSe,"parse");function d0r(t){let e=t;return e?typeof e.base=="string"&&typeof e.pattern=="string":!1}s(d0r,"isRelativePattern");function f0r(t,e){let r=Jut(Object.getOwnPropertyNames(t).map(c=>p0r(c,t[c],e)).filter(c=>c!==XA)),n=r.length;if(!n)return XA;if(!r.some(c=>!!c.requiresSiblings)){if(n===1)return r[0];let c=s(function(f,p){let m;for(let h=0,g=r.length;h<g;h++){let A=r[h](f,p);if(typeof A=="string")return A;Ane(A)&&(m||(m=[]),m.push(A))}return m?(async()=>{for(let h of m){let g=await h;if(typeof g=="string")return g}return null})():null},"resultExpression"),l=r.find(f=>!!f.allBasenames);l&&(c.allBasenames=l.allBasenames);let u=r.reduce((f,p)=>p.allPaths?f.concat(p.allPaths):f,[]);return u.length&&(c.allPaths=u),c}let i=s(function(c,l,u){let f,p;for(let m=0,h=r.length;m<h;m++){let g=r[m];g.requiresSiblings&&u&&(l||(l=bne(c)),f||(f=l.substr(0,l.length-Ine(c).length)));let A=g(c,l,f,u);if(typeof A=="string")return A;Ane(A)&&(p||(p=[]),p.push(A))}return p?(async()=>{for(let m of p){let h=await m;if(typeof h=="string")return h}return null})():null},"resultExpression"),o=r.find(c=>!!c.allBasenames);o&&(i.allBasenames=o.allBasenames);let a=r.reduce((c,l)=>l.allPaths?c.concat(l.allPaths):c,[]);return a.length&&(i.allPaths=a),i}s(f0r,"parsedExpression");function p0r(t,e,r){if(e===!1)return XA;let n=uSe(t,r);if(n===XA)return XA;if(typeof e=="boolean")return n;if(e){let i=e.when;if(typeof i=="string"){let o=s((a,c,l,u)=>{if(!u||!n(a,c))return null;let f=i.replace("$(basename)",()=>l),p=u(f);return Ane(p)?p.then(m=>m?t:null):p?t:null},"result");return o.requiresSiblings=!0,o}}return n}s(p0r,"parseExpressionPattern");function Jut(t,e){let r=t.filter(c=>!!c.basenames);if(r.length<2)return t;let n=r.reduce((c,l)=>{let u=l.basenames;return u?c.concat(u):c},[]),i;if(e){i=[];for(let c=0,l=n.length;c<l;c++)i.push(e)}else i=r.reduce((c,l)=>{let u=l.patterns;return u?c.concat(u):c},[]);let o=s(function(c,l){if(typeof c!="string")return null;if(!l){let f;for(f=c.length;f>0;f--){let p=c.charCodeAt(f-1);if(p===47||p===92)break}l=c.substr(f)}let u=n.indexOf(l);return u!==-1?i[u]:null},"aggregate");o.basenames=n,o.patterns=i,o.allBasenames=n;let a=t.filter(c=>!c.basenames);return a.push(o),a}s(Jut,"aggregateBasenameMatches");function Xut(t){let e=t.match(/^---\s*\r?\n([\s\S]*?)\r?\n---\s*\r?\n/);return e?e[1]:null}s(Xut,"extractFrontMatter");function Zut(t){let e=Xut(t);if(!e)return{};let r=e.match(/^applyTo:\s*["']?(.*?)["']?\s*$/m),n=e.match(/^description:\s*["']?(.*?)["']?\s*$/m);return{applyTo:r?r[1].trim():void 0,description:n?n[1].trim():void 0}}s(Zut,"extractMetadataFromContent");function edt(t){let e=Xut(t);if(!e)return{};let r=e.match(/^description:\s*["']?(.*?)["']?\s*$/m);return{description:r?r[1].trim():void 0}}s(edt,"extractPromptMetadataFromContent");function tdt(t){if(!t||t.trim()==="")return{pattern:t,isValid:!1,error:"Pattern cannot be empty"};let e=t.trim();return m0r(e)?{pattern:e,isValid:!0}:{pattern:e,isValid:!1,error:"Invalid glob pattern"}}s(tdt,"validate");function rdt(t,e){let r=fU(e,","),n=s(i=>{if(i=i.trim(),i.length!==0){if(i==="**"||i==="**/*"||i==="*")return{pattern:i};!i.startsWith("/")&&!i.startsWith("**/")&&(i="**/"+i);for(let o of t)if(Yut(i,o))return{pattern:i,file:o}}},"patternMatches");for(let i of r){let o=n(i);if(o)return o}}s(rdt,"matches");function m0r(t){try{let e=fU(t,",");if(e.length===0)return!1;for(let r of e){let n=dSe(r);if(Kut(n))return!1}return!0}catch{return!1}}s(m0r,"isValidGlob");d();d();var h0r=".prompt.md",g0r=".instructions.md",A0r=".chatmode.md";function ndt(t){if(t.endsWith(h0r))return"prompt";if(t.endsWith(g0r))return"instructions";if(t.endsWith(A0r))return"mode"}s(ndt,"getPromptFileType");var C0r=".github/instructions",v0r=".github/prompts",Ok=class{static{s(this,"PromptFilesLocator")}async listFiles(e,r,n){if(!r.length)return[];let i=r.map(a=>{let c="";return n==="instructions"?c=Vi(a.uri,C0r):n==="prompt"&&(c=Vi(a.uri,v0r)),this.getFilesByUri(e,c,n)});return(await Promise.all(i)).flat()}async getFilesByUri(e,r,n){let i,o=[];try{i=await e.get(Fi).readDirectory(r)}catch{return[]}for(let[a,c]of i)c===1&&ndt(a)===n&&o.push(Vi(r,a));return o}};var ZA=class{constructor(){this.logger=new dt("PromptService");this.promptTemplatesCache=null;this.fileLocator=new Ok}static{s(this,"PromptService")}async collect(e,r,n){let i=await this.fileLocator.listFiles(e,r,"instructions").then(idt("instructions")),o=[];for(let a of i)try{let c=await this.parseInstructionFile(e,a.uri);c&&rdt(n,c.applyTo)&&o.push(c)}catch(c){this.logger.warn(e,`Failed to parse instruction file ${a.uri}:`,c)}return o}async collectPromptFiles(e,r){let n=await this.fileLocator.listFiles(e,r,"prompt").then(idt("prompt")),i=[];for(let o of n)try{let a=await this.parsePromptFile(e,o.uri);a&&i.push(a)}catch(a){this.logger.warn(e,`Failed to parse prompt file ${o.uri}:`,a)}this.promptTemplatesCache?this.promptTemplatesCache.clear():this.promptTemplatesCache=new Map;for(let o of i)this.promptTemplatesCache.set(o.name,o);return i}async parseInstructionFile(e,r){try{let n=await e.get(Fi).readFileString(r),i=Zut(n);if(!i.applyTo)return null;let o=tdt(i.applyTo);return o.isValid?{uri:r,applyTo:o.pattern,description:i.description,content:n}:(this.logger.warn(e,`Invalid applyTo pattern in ${r}: ${o.error}`),null)}catch{return null}}async parsePromptFile(e,r){try{let n=await e.get(Fi).readFileString(r),i=edt(n),a=Pi(r).replace(/\.prompt\.md$/,"");return{uri:r,name:a,description:i.description,content:n}}catch{return null}}getPromptTemplates(){return this.promptTemplatesCache?Array.from(this.promptTemplatesCache.values()):[]}getPromptTemplate(e){return this.promptTemplatesCache?.get(e)}};function idt(t){return e=>e.map(r=>({uri:r,type:t}))}s(idt,"withType");var ey=class t{static{s(this,"CustomInstruction")}static async getInstructions(e,r,n={},i){try{let o=e.get(E1),a=o.getGlobalInstructions(n),c=await o.readFromWorkspaces(e,r,n),u=await e.get(ZA).collect(e,r,i||[]),f=u.map(h=>({content:[{instruction:h.content}],kind:2,reference:h.uri})),p=n;if(!n.customIntroduction&&u.length>0){let g=["Here is a list of instruction files that contain rules for modifying or creating new code.","These files are important for ensuring that the code is modified or created correctly.","Please make sure to follow the rules specified in these files when working with the codebase.","If the file is not already available as attachment, use the `read_file` tool to acquire it.","Make sure to acquire the instructions before making any changes to the code.","| Pattern | File Path | Description |","| ------- | --------- | ----------- |"],A=u.map(y=>{let E=y.applyTo||"*",b=y.uri,S=y.description||"";return`| \`${E}\` | \`${b}\` | ${S} |`});p={...n,customIntroduction:g.concat(A).join(`
`)}}let m=[...a,...c,...f];return this.processInstructions(m,p)}catch{return}}static processInstructions(e,r={}){if(!e||e.length===0)return;let n=[];for(let o of e){let a=this.createInstructionElement(o,r);a&&n.push(a)}return n.length===0?void 0:`${r.customIntroduction||"When generating code, please follow these user provided coding instructions. You can ignore an instruction if it contradicts a system message."}

<instructions>
${n.join(`

`)}
</instructions>`}static createInstructionElement(e,r={}){let n=[];for(let o of e.content)o.languageId?r.languageId&&o.languageId===r.languageId&&n.push(`For ${o.languageId} code: ${o.instruction}`):n.push(o.instruction);if(n.length===0)return;let i=n.join(`
`);return`<attachment filePath="${e.reference}">
${i}
</attachment>`}static async appendToUserMessage(e,r,n="",i={},o){if(!r||r.length===0)return n;let a=await t.getInstructions(e,r,i,o);return a?a+`

`+n:n}};d();var x0r="X-Initiator",E0r="X-Interaction-ID",b0r="X-Interaction-Type";var Rne=class{static{s(this,"LlmInteractionInitiator")}static id(){throw new Error("Must be implemented by subclass")}},fSe=class extends Rne{static{s(this,"User")}static id(){return"user"}},pSe=class extends Rne{static{s(this,"Agent")}static id(){return"agent"}},mSe=class{static{s(this,"GenericLlmInteraction")}constructor(e,r,n){this.initiator=e.id(),this.interactionType=r,this.interactionId=n}toCapiHeaders(){return{[x0r]:this.initiator,[E0r]:this.interactionId,[b0r]:this.interactionType.toString()}}},Gd=class t extends mSe{static{s(this,"LlmInteraction")}static user(e,r){return new t(fSe,e,r)}static agent(e,r){return new t(pSe,e,r)}};d();d();var ha=class{static{s(this,"ModelConfigurationProvider")}},kne=class extends ha{constructor(r){super();this.ctx=r}static{s(this,"DefaultModelConfigurationProvider")}async getBestChatModelConfig(r,n){let i=[];for(let o of r){let a=await this.getFirstMatchingChatModelConfiguration(o,n);a&&i.push(a)}if(i.length>0){let o=i.find(a=>a.isExperimental);return o||i[0]}throw _r.error(this.ctx,`No model configuration found for families: ${r.join(", ")}. Available models: ${JSON.stringify(await this.ctx.get(If).getMetadata())}`),new Error("No model configuration found")}async getFirstMatchingModelMetadata(r){let n=await this.ctx.get(If).getMetadata(),i=T0r(n,r);if(i.length>0)return i[0]}async getFirstMatchingChatModelConfiguration(r,n){let i=await this.getFirstMatchingModelMetadata({family:r,type:"chat",supports:n});if(i!==void 0)return r===$r.Gpt35turbo||r===$r.Gpt4oMini?{modelId:i.id,uiName:i.name,modelFamily:r,maxRequestTokens:gSe(6144,i),maxResponseTokens:hSe(2048,i),baseTokensPerMessage:3,baseTokensPerName:1,baseTokensPerCompletion:3,tokenizer:i.capabilities.tokenizer,isExperimental:i.isExperimental??!1,stream:i.capabilities.supports?.streaming??!1,toolCalls:i.capabilities.supports?.tool_calls??!1}:r===$r.Gpt4||r===$r.Gpt4turbo?{modelId:i.id,uiName:i.name,modelFamily:r,maxRequestTokens:gSe(10240,i),maxResponseTokens:hSe(4096,i),baseTokensPerMessage:3,baseTokensPerName:1,baseTokensPerCompletion:3,tokenizer:i.capabilities.tokenizer,isExperimental:i.isExperimental??!1,stream:i.capabilities.supports?.streaming??!1,toolCalls:i.capabilities.supports?.tool_calls??!1}:r===$r.Gpt4o?{modelId:i.id,uiName:i.name,modelFamily:r,maxRequestTokens:await I0r(this.ctx,i),maxResponseTokens:hSe(4096,i),baseTokensPerMessage:3,baseTokensPerName:1,baseTokensPerCompletion:3,tokenizer:i.capabilities.tokenizer,isExperimental:i.isExperimental??!1,stream:i.capabilities.supports?.streaming??!1,toolCalls:i.capabilities.supports?.tool_calls??!1}:{modelId:i.id,uiName:i.name,modelFamily:r,maxRequestTokens:i.capabilities.limits?.max_prompt_tokens??8192,maxResponseTokens:i.capabilities.limits?.max_output_tokens??4096,baseTokensPerMessage:3,baseTokensPerName:1,baseTokensPerCompletion:3,tokenizer:i.capabilities.tokenizer,isExperimental:i.isExperimental??!1,stream:i.capabilities.supports?.streaming??!1,toolCalls:i.capabilities.supports?.tool_calls??!1}}async getFirstMatchingEmbeddingModelConfiguration(r){let n=await this.getFirstMatchingModelMetadata({family:r,type:"embeddings"});if(n!==void 0)switch(r){case YK.textEmbedding3Small:return{modelId:n.id,modelFamily:r,maxBatchSize:n.capabilities.limits?.max_inputs??16,maxTokens:8191,tokenizer:"cl100k_base"}}}};async function I0r(t,e){let r=t.get(Mt),n=await r.fetchTokenAndUpdateExPValuesAndAssignments(),i=r.ideChatMaxRequestTokens(n);return i===-1&&(i=16384),gSe(i,e)}s(I0r,"getExpRequestTokens");function gSe(t,e){return e.capabilities.limits?.max_prompt_tokens?Math.min(t,e.capabilities.limits.max_prompt_tokens):t}s(gSe,"getRequestTokens");function hSe(t,e){return e.capabilities.limits?.max_output_tokens?Math.min(t,e.capabilities.limits.max_output_tokens):t}s(hSe,"getResponseTokens");function T0r(t,e){return t.filter(r=>r.capabilities.type!==e.type||r.capabilities.family!==e.family&&!(r.is_chat_fallback===!0&&r.id===e.family)||r.capabilities.family===e.family&&r.id!==e.family&&r.is_chat_fallback===!0?!1:r.capabilities.supports===void 0||e.supports===void 0?!0:Object.keys(e.supports).every(n=>e.supports?.[n]===r.capabilities.supports?.[n]))}s(T0r,"filterModelsByCapabilities");var Wo=class{static{s(this,"ModelPickerUtils")}static async getModelConfiguration(e,r,n,i){if(n)return e.get(ha).getBestChatModelConfig([n]);if(e.get(_h).quotaExhausted&&!(await e.get(ar).getToken()).userInfo?.isFreeUser){let o=await e.get(If).getFallbackModel();if(o)return e.get(ha).getBestChatModelConfig([o?.id])}return e.get(ha).getBestChatModelConfig(Ep(r),i)}static transformMessages(e,r){return r===$r.O1Ga||r===$r.O1Mini?e.map(n=>n.role!=="user"?{role:"user",content:n.content}:n):e}};var Qk=class{constructor(){this.lastChanges=[];this.attemptCount=0;this.DEFAULT_TEMPERATURE=.1}static{s(this,"GitCommitGenerateService")}buildSystemMessage(e,r){let n=["You are an AI programming assistant, helping a software developer to come up with the best git commit message for their code changes.","You excel in interpreting the purpose behind code changes to craft succinct, clear commit messages that adhere to the repository's guidelines.","","# First, think step-by-step:","1. Analyze the CODE CHANGES thoroughly to understand what's been modified.","2. Identify the purpose of the changes to answer the *why* for the commit messages, also considering the optionally provided RECENT USER COMMITS.","3. Review the provided RECENT REPOSITORY COMMITS to identify established commit message conventions. Focus on the format and style, ignoring commit-specific details like refs, tags, and authors.","4. Generate a thoughtful and succinct commit message for the given CODE CHANGES. It MUST follow the established writing conventions.","5. Remove any meta information like issue references, tags, or author names from the commit message. The developer will add them.","6. Now only show your message, wrapped with a single markdown ```text codeblock! Do not provide any explanations or details"];return r&&n.push(`
Current git branch name: ${r}`),e&&n.push(`
Respond in the following locale: ${e}`),n.join(`
`)}buildUserMessage(e,r){let n=[];return e.userCommits.length>0&&n.push("# RECENT USER COMMITS (For reference only, do not copy!):",e.userCommits.map(i=>`- ${i}`).join(`
`),""),e.recentCommits.length>0&&n.push("# RECENT REPOSITORY COMMITS (For reference only, do not copy!):",e.recentCommits.map(i=>`- ${i}`).join(`
`),""),n.push("# CODE CHANGES:",e.changes.join(`
`),"","<reminder>","Now generate a commit message that describes the CODE CHANGES.","DO NOT COPY commits from RECENT COMMITS, but use them as reference for the commit style.","ONLY return a single markdown code block, NO OTHER PROSE!","```text","commit message goes here","```","</reminder>"),r&&n.push("<custom-instructions>",r,"</custom-instructions>"),n.join(`
`)}updateAttemptCount(e){if(e.length!==this.lastChanges.length){this.attemptCount=0;return}for(let r=0;r<e.length;r++)if(this.lastChanges[r]!==e[r]){this.attemptCount=0;return}this.attemptCount++}async generateCommitMessage(e,r,n,i){let o=new Ps(e),a=await Wo.getModelConfiguration(e,"gitCommit"),c=[{uri:n.workspaceFolder?n.workspaceFolder:kl(process.cwd())}],l=await ey.getInstructions(e,c,{includeCodeGenerationInstructions:!1,includeCommitMessageGenerationInstructions:!0,customIntroduction:"When generating the commit message, please use the following custom instructions provided by the user."}),u=[{role:"system",content:this.buildSystemMessage(n.userLanguage,i)},{role:"user",content:this.buildUserMessage(n,l)}];this.updateAttemptCount(n.changes);let f=await e.get(ar).getToken(),p=await e.get(Mt).updateExPValuesAndAssignments(f),m=Math.min(this.DEFAULT_TEMPERATURE*(1+this.attemptCount),2),h=await o.fetchResponse({modelConfiguration:a,messages:u,uiKind:"conversationPanel",intentParams:{intent:!0},llmInteraction:Gd.user("git-commit",br()),temperature:m},r,p);if(this.lastChanges=n.changes,h.type!=="success")return;let g=h.value.match(/```text\n([\s\S]*?)\n```/);return g?g[1].trim():h.value.trim()}};d();var cd=class{constructor(e){this.ctx=e}static{s(this,"EditProgressReporter")}},Pne=class extends cd{constructor(){super(...arguments);this.items=[]}static{s(this,"LibTestEditProgressReporter")}reset(){this.items=[]}reportTurn(r,n){return this.items.push({editConversationId:r.editConversationId,editTurnId:r.editTurnId,...n}),Promise.resolve()}};d();d();d();function ty(){return br()}s(ty,"uuidV4");d();var Qw=class extends Error{static{s(this,"CopilotEditsCancelledByUserException")}constructor(){super("Operation cancelled by user"),this.name="CopilotEditsCancelledByUserException"}};d();var I1=class extends Error{static{s(this,"CopilotEditsProcessCodeBlockException")}constructor(e){super(e),this.name="CopilotEditsProcessCodeBlockException"}};d();d();d();var mU="filepath:",Al="...existing code...",ASe="copilot-edited-file";d();function a8(t){let e=t.matchAll(/^\s*(```+)/gm),r=Math.max(3,...Array.from(e,n=>n[1].length+1));return"`".repeat(r)}s(a8,"getFenceForCodeBlock");var cm=class{constructor(e){this.params=e;this.params.noFilePath===void 0&&(this.params.noFilePath=!1)}static{s(this,"CodeBlock")}renderAsArray(){let e=a8(this.params.code),r=[`${e}${this.params.languageId}`];return!this.params.noFilePath&&this.params.uri&&r.push(`// ${mU} ${sc(this.params.uri)}`),r.push(this.params.shouldTrim?this.params.code.trim():this.params.code,e),r}renderAsString(e=`
`){return this.renderAsArray().join(e)}};var ySe=class{constructor(e){this.props=e}static{s(this,"CodeBlockChangeDescription")}render(){if(this.props.markdownBeforeBlock)return["This is the description of what the code block changes:","<changeDescription>",this.props.markdownBeforeBlock,"","</changeDescription>",""].join(`
`)}},hU=class{constructor(e){this.props=e;this.shouldTrim=!0}static{s(this,"CodeMapperPrompt")}async render(){let e=await this.props.textDocumentProvider.getByUri(this.props.uri.toString()),r=[{role:"system",content:this.buildSystemMessage(e)},{role:"user",content:this.buildUserMessage(e)}];return this.props.inProgressRewriteContent&&(r.push({role:"assistant",content:this.props.inProgressRewriteContent}),r.push({role:"user",content:"Please continue providing the next part of the response."})),r}transformToFastApplyMessage(e){return[{role:"user",content:e.reduce((r,n)=>{let i=en(n.content);return n.role==="system"?`${r}<SYSTEM>
${i}
</SYSTEM>


`:r+i},"")}]}transformToSpeculationPrompt(e,r,n){return e.reduce((o,a)=>{if(a.role==="system"){let c=en(a.content).endsWith(`
`)?en(a.content):`${en(a.content)}
`;return`${o}<SYSTEM>
${c}
End your response with </${ASe}>.
</SYSTEM>


`}return o+en(a.content)},"")+`


The resulting document:
<${ASe}>
${n}${r}
`}buildSystemMessage(e){if(e.status!=="valid")return"";let r=[];return r.push("You are an AI programming assistant that is specialized in applying code changes to an existing document.","Follow Microsoft content policies.","Avoid content that violates copyrights.",`If you are asked to generate content that is harmful, hateful, racist, sexist, lewd, violent, or completely irrelevant to software engineering, only respond with "Sorry, I can't assist with that."`,"Keep your answers short and impersonal.",`The user has a code block that represents a suggestion for a code change and a ${e.document.detectedLanguageId} file opened in a code editor.`,"Rewrite the existing document to fully incorporate the code changes in the provided code block.","For the response, always follow these instructions:","1. Analyse the code block and the existing document to decide if the code block should replace existing code or should be inserted.","2. If necessary, break up the code block into multiple parts and insert each part at the appropriate location.","3. Preserve whitespace and newlines right after the parts of the file that you modify.",`4. The final result must be syntactically valid, properly formatted, and correctly indented. It should not contain any \`${Al}\` comments.`,"5. Finally, provide the fully rewritten file. You must output the complete file."),r.join(`
`)}buildUserMessage(e){let r=[];if(e.status!=="valid")return"";if(e.document.getText().length>0){let a=new cm({code:e.document.getText(),languageId:e.document.detectedLanguageId,noFilePath:!0,shouldTrim:this.shouldTrim});r.push(`I have the following code open in the editor, starting from line 1 to line ${e.document.lineCount}.`,...a.renderAsArray())}else r.push("I am in an empty editor.");let i=new ySe({markdownBeforeBlock:this.props.markdownBeforeBlock}).render();i&&r.push(i);let o=new cm({code:this.props.codeBlock,languageId:e.document.detectedLanguageId,noFilePath:!0,shouldTrim:this.shouldTrim});return r.push("This is the code block that represents the suggested code change:",...o.renderAsArray(),"<userPrompt>","Provide the fully rewritten file, incorporating the suggested code change. You must produce the complete file.","</userPrompt>"),r.join(`
`)}};d();var aE=class{constructor(e){this.ctx=e}static{s(this,"DefaultTextDocumentProvider")}async getByUri(e){return await this.ctx.get(En).getOrReadTextDocument({uri:e})}};d();d();d();d();d();d();var tg=class t{constructor(e){this.edits=e;let r=-1;for(let n of e){if(!(n.replaceRange.start>=r))throw new xn(`Edits must be disjoint and sorted. Found ${n} after ${r}`);r=n.replaceRange.endExclusive}}static{s(this,"OffsetEdit")}static{this.empty=new t([])}static fromJson(e){return new t(e.map(yl.fromJson))}static from(e){let r=e.map(i=>new yl(Vt.ofStartAndLength(i.rangeOffset,i.rangeLength),i.text));return r.reverse(),new t(r)}static single(e,r){return new t([new yl(e,r)])}normalize(){let e=[],r;for(let n of this.edits)n.newText.length===0&&n.replaceRange.length===0||(r&&r.replaceRange.endExclusive===n.replaceRange.start?r=new yl(r.replaceRange.join(n.replaceRange),r.newText+n.newText):(r&&e.push(r),r=n));return r&&e.push(r),new t(e)}normalizeEOL(e){return new t(this.edits.map(r=>r.normalizeEOL(e)))}isNoop(e){return this.edits.every(r=>r.isNoop(e))}toString(){return`[${this.edits.map(r=>r.toString()).join(", ")}]`}apply(e){let r=[],n=0;for(let i of this.edits)r.push(e.substring(n,i.replaceRange.start)),r.push(i.newText),n=i.replaceRange.endExclusive;return r.push(e.substring(n)),r.join("")}compose(e){return w0r(this,e)}inverse(e){let r=[],n=0;for(let i of this.edits)r.push(new yl(Vt.ofStartAndLength(i.replaceRange.start+n,i.newText.length),e.substring(i.replaceRange.start,i.replaceRange.endExclusive))),n+=i.newText.length-i.replaceRange.length;return new t(r)}getNewTextRanges(){let e=[],r=0;for(let n of this.edits)e.push(Vt.ofStartAndLength(n.replaceRange.start+r,n.newText.length)),r+=n.newText.length-n.replaceRange.length;return e}get isEmpty(){return this.edits.length===0}tryRebase(e){let r=[],n=0,i=0,o=0;for(;i<this.edits.length||n<e.edits.length;){let a=e.edits[n],c=this.edits[i];if(c)a?c.replaceRange.intersects(a.replaceRange)?i++:c.replaceRange.start<a.replaceRange.start?(r.push(new yl(c.replaceRange.delta(o),c.newText)),i++):(n++,o+=a.newText.length-a.replaceRange.length):(r.push(new yl(c.replaceRange.delta(o),c.newText)),i++);else break}return new t(r)}removeCommonSuffixPrefix(e){let r=[];for(let n of this.edits){let i=n.removeCommonSuffixPrefix(e);i.isEmpty||r.push(i)}return new t(r)}applyToOffset(e){let r=0;for(let n of this.edits)if(n.replaceRange.start<=e){if(e<n.replaceRange.endExclusive)return n.replaceRange.start+r;r+=n.newText.length-n.replaceRange.length}else break;return e+r}applyToOffsetRange(e){return new Vt(this.applyToOffset(e.start),this.applyToOffset(e.endExclusive))}applyToOffsetOrUndefined(e){let r=0;for(let n of this.edits)if(n.replaceRange.start<=e){if(e<n.replaceRange.endExclusive)return;r+=n.newText.length-n.replaceRange.length}else break;return e+r}applyToOffsetRangeOrUndefined(e){let r=this.applyToOffsetOrUndefined(e.start);if(r===void 0)return;let n=this.applyToOffsetOrUndefined(e.endExclusive);if(n!==void 0)return new Vt(r,n)}applyInverseToOffset(e){let r=0;for(let n of this.edits){let i=n.newText.length;if(n.replaceRange.start<=e-r){if(e-r<n.replaceRange.start+i)return n.replaceRange.start;r+=i-n.replaceRange.length}else break}return e-r}},yl=class t{constructor(e,r){this.replaceRange=e;this.newText=r}static{s(this,"SingleOffsetEdit")}static delete(e){return new t(e,"")}static fromJson(e){return new t(Vt.ofStartAndLength(e.pos,e.len),e.txt)}toString(){return`${this.replaceRange} -> "${this.newText}"`}removeCommonSuffixPrefix(e){let r=e.substring(this.replaceRange.start,this.replaceRange.endExclusive),n=KT(r,this.newText),i=Math.min(r.length-n,this.newText.length-n,Nx(r,this.newText)),o=new Vt(this.replaceRange.start+n,this.replaceRange.endExclusive-i),a=this.newText.substring(n,this.newText.length-i);return new t(o,a)}normalizeEOL(e){let r=this.newText.replace(/\r\n|\n/g,e);return new t(this.replaceRange,r)}isNoop(e){return this.newText===e.substring(this.replaceRange.start,this.replaceRange.endExclusive)}get isEmpty(){return this.newText.length===0&&this.replaceRange.length===0}};function w0r(t,e){if(t=t.normalize(),e=e.normalize(),t.isEmpty)return e;if(e.isEmpty)return t;let r=[...t.edits],n=[],i=0;for(let o of e.edits){for(;;){let u=r[0];if(!u||u.replaceRange.start+i+u.newText.length>=o.replaceRange.start)break;r.shift(),n.push(u),i+=u.newText.length-u.replaceRange.length}let a=i,c,l;for(;;){let u=r[0];if(!u||u.replaceRange.start+i>o.replaceRange.endExclusive)break;c||(c=u),l=u,r.shift(),i+=u.newText.length-u.replaceRange.length}if(!c)n.push(new yl(o.replaceRange.delta(-i),o.newText));else{let u="",f=o.replaceRange.start-(c.replaceRange.start+a);f>0&&(u=c.newText.slice(0,f));let p=l.replaceRange.endExclusive+i-o.replaceRange.endExclusive;if(p>0){let g=new yl(Vt.ofStartAndLength(l.replaceRange.endExclusive,0),l.newText.slice(-p));r.unshift(g),i-=g.newText.length-g.replaceRange.length}let m=u+o.newText,h=new Vt(Math.min(c.replaceRange.start,o.replaceRange.start-a),o.replaceRange.endExclusive-i);n.push(new yl(h,m))}}for(;;){let o=r.shift();if(!o)break;n.push(o)}return new tg(n).normalize()}s(w0r,"joinEdits");d();d();var odt=-1;function c8(){return odt!==-1?odt:Date.now()}s(c8,"now");function sdt(t,e){return t.endLineNumberExclusive<=e.startLineNumber?e.startLineNumber-t.endLineNumberExclusive:e.endLineNumberExclusive<=t.startLineNumber?t.startLineNumber-e.endLineNumberExclusive:0}s(sdt,"lineRangeDistance");d();var l8=class t{constructor(e){this.edits=e}static{s(this,"TextEdit")}static fromEdit(e,r){let n=e.edits.map(i=>new cE(r.getTransformer().getRange(i.range),i.newText));return new t(n)}toEdit(e){let r=this.edits.map(n=>Oa.replace(e.getTransformer().getOffsetRange(n.range),n.newText));return ga.create(r)}mapEdits(e){return new t(this.edits.map(e))}},cE=class t{constructor(e,r){this.range=e;this.newText=r}static{s(this,"SingleTextEdit")}static joinEdits(e,r){if(e.length===0)throw new xn;if(e.length===1)return e[0];let n=e[0].range.getStartPosition(),i=e[e.length-1].range.getEndPosition(),o="";for(let a=0;a<e.length;a++){let c=e[a];if(o+=c.newText,a<e.length-1){let l=e[a+1],u=ir.fromPositions(c.range.getEndPosition(),l.range.getStartPosition()),f=r.getValueOfRange(u);o+=f}}return new t(ir.fromPositions(n,i),o)}static fromSingleEdit(e,r){return new t(r.getTransformer().getRange(e.range),e.newText)}extendToCoverRange(e,r){if(this.range.containsRange(e))return this;let n=this.range.plusRange(e),i=r.getValueOfRange(ir.fromPositions(n.getStartPosition(),this.range.getStartPosition())),o=r.getValueOfRange(ir.fromPositions(this.range.getEndPosition(),n.getEndPosition())),a=i+this.newText+o;return new t(n,a)}extendToFullLine(e){let r=new ir(this.range.startLineNumber,1,this.range.endLineNumber,e.getTransformer().getLineLength(this.range.endLineNumber)+1);return this.extendToCoverRange(r,e)}toSingleEdit(e){let n=e.getTransformer().getOffsetRange(this.range);return Oa.replace(n,this.newText)}};var hs=class t{constructor(e){this.edits=e;Fl(kx(e,(r,n)=>r.lineRange.endLineNumberExclusive<=n.lineRange.startLineNumber))}static{s(this,"LineEdit")}static{this.empty=new t([])}static deserialize(e){return new t(e.map(r=>ry.deserialize(r)))}static fromEdit(e){let r=l8.fromEdit(e.edit,e.base);return t.fromTextEdit(r,e.base)}static fromTextEdit(e,r){let n=e.edits,i=[],o=[];for(let a=0;a<n.length;a++){let c=n[a],l=a+1<n.length?n[a+1]:void 0;if(o.push(c),l&&l.range.startLineNumber===c.range.endLineNumber)continue;let u=cE.joinEdits(o,r);o.length=0;let f=ry.fromSingleTextEdit(u,r);i.push(f)}return new t(i)}static createFromUnsorted(e){let r=e.slice();return r.sort(wh(n=>n.lineRange.startLineNumber,Sh)),new t(r)}isEmpty(){return this.edits.length===0}toEdit(e){let r=[];for(let n of this.edits){let i=n.toSingleEdit(e);r.push(i)}return ga.create(r)}toString(){return this.edits.map(e=>e.toString()).join(",")}serialize(){return this.edits.map(e=>e.serialize())}getNewLineRanges(){let e=[],r=0;for(let n of this.edits)e.push(jr.ofLength(n.lineRange.startLineNumber+r,n.newLines.length)),r+=n.newLines.length-n.lineRange.length;return e}mapLineNumber(e){let r=0;for(let n of this.edits){if(n.lineRange.endLineNumberExclusive>e)break;r+=n.newLines.length-n.lineRange.length}return e+r}mapLineRange(e){return new jr(this.mapLineNumber(e.startLineNumber),this.mapLineNumber(e.endLineNumberExclusive))}mapBackLineRange(e,r){return this.inverse(r).mapLineRange(e)}touches(e){return this.edits.some(r=>e.edits.some(n=>r.lineRange.intersect(n.lineRange)))}rebase(e){return new t(this.edits.map(r=>new ry(e.mapLineRange(r.lineRange),r.newLines)))}humanReadablePatch(e){let r=[];function n(c,l,u,f){let p=u==="unmodified"?" ":u==="deleted"?"-":"+";f===void 0&&(f="[[[[[ WARNING: LINE DOES NOT EXIST ]]]]]");let m=c===-1?"   ":c.toString().padStart(3," "),h=l===-1?"   ":l.toString().padStart(3," ");r.push(`${p} ${m} ${h} ${f}`)}s(n,"pushLine");function i(){r.push("---")}s(i,"pushSeperator");let o=0,a=!0;for(let c of LR(this.edits,(l,u)=>sdt(l.lineRange,u.lineRange)<=5)){a?a=!1:i();let l=c[0].lineRange.startLineNumber-2;for(let u of c){for(let m=Math.max(1,l);m<u.lineRange.startLineNumber;m++)n(m,m+o,"unmodified",e[m-1]);let f=u.lineRange,p=u.newLines;for(let m of f.mapToLineArray(h=>h)){let h=e[m-1];n(m,-1,"deleted",h)}for(let m=0;m<p.length;m++){let h=p[m];n(-1,f.startLineNumber+o+m,"added",h)}l=f.endLineNumberExclusive,o+=u.newLines.length-u.lineRange.length}for(let u=l;u<=Math.min(l+2,e.length);u++)n(u,u+o,"unmodified",e[u-1])}return r.join(`
`)}apply(e){let r=[],n=0;for(let i of this.edits){for(;n<i.lineRange.startLineNumber-1;)r.push(e[n]),n++;for(let o of i.newLines)r.push(o);n=i.lineRange.endLineNumberExclusive-1}for(;n<e.length;)r.push(e[n]),n++;return r}inverse(e){let r=this.getNewLineRanges();return new t(this.edits.map((n,i)=>new ry(r[i],e.slice(n.lineRange.startLineNumber-1,n.lineRange.endLineNumberExclusive-1))))}},ry=class t{constructor(e,r){this.lineRange=e;this.newLines=r}static{s(this,"SingleLineEdit")}static deserialize(e){return new t(jr.ofLength(e[0],e[1]-e[0]),e[2])}static fromSingleTextEdit(e,r){let n=Lh(e.newText),i=e.range.startLineNumber,o=r.getValueOfRange(ir.fromPositions(new Wr(e.range.startLineNumber,1),e.range.getStartPosition()));n[0]=o+n[0];let a=e.range.endLineNumber+1,c=r.getTransformer().getLineLength(e.range.endLineNumber)+1,l=r.getValueOfRange(ir.fromPositions(e.range.getEndPosition(),new Wr(e.range.endLineNumber,c)));n[n.length-1]=n[n.length-1]+l;let u=e.range.startColumn===r.getTransformer().getLineLength(e.range.startLineNumber)+1,f=e.range.endColumn===1;return u&&n[0].length===o.length&&(i++,n.shift()),n.length>0&&i<a&&f&&n[n.length-1].length===l.length&&(a--,n.pop()),new t(new jr(i,a),n)}toLineEdit(){return new hs([this])}toSingleTextEdit(e){if(this.newLines.length===0){let r=e.getTransformer().textLength;if(this.lineRange.endLineNumberExclusive===r.lineCount+2){let n;if(this.lineRange.startLineNumber>1){let o=this.lineRange.startLineNumber-1,a=e.getTransformer().getLineLength(o)+1;n=new Wr(o,a)}else n=new Wr(1,1);let i=r.addToPosition(new Wr(1,1));return new cE(ir.fromPositions(n,i),"")}else return new cE(new ir(this.lineRange.startLineNumber,1,this.lineRange.endLineNumberExclusive,1),"")}else if(this.lineRange.isEmpty){let r,n,i,o=this.lineRange.startLineNumber;return o===e.getTransformer().textLength.lineCount+2?(r=o-1,n=e.getTransformer().getLineLength(r)+1,i=this.newLines.map(a=>`
`+a).join("")):(r=o,n=1,i=this.newLines.map(a=>a+`
`).join("")),new cE(ir.fromPositions(new Wr(r,n)),i)}else{let r=this.lineRange.endLineNumberExclusive-1,n=e.getTransformer().getLineLength(r)+1,i=new ir(this.lineRange.startLineNumber,1,r,n),o=this.newLines.join(`
`);return new cE(i,o)}}toSingleEdit(e){let r=this.toSingleTextEdit(e),n=e.getTransformer().getOffsetRange(r.range);return Oa.replace(n,r.newText)}toString(){return`${this.lineRange}->${JSON.stringify(this.newLines)}`}serialize(){return[this.lineRange.startLineNumber,this.lineRange.endLineNumberExclusive,this.newLines]}removeCommonSuffixPrefixLines(e){let r=this.lineRange.startLineNumber,n=this.lineRange.endLineNumberExclusive,i=0;for(;r<n&&i<this.newLines.length&&this.newLines[i]===e.getLineAt(r);)r++,i++;let o=0;for(;r<n&&o+i<this.newLines.length&&this.newLines[this.newLines.length-1-o]===e.getLineAt(n-1);)n--,o++;return i===0&&o===0?this:new t(new jr(r,n),this.newLines.slice(i,this.newLines.length-o))}},S0r;(e=>{function t(r){return Array.isArray(r)&&r.length===3&&typeof r[0]=="number"&&typeof r[1]=="number"&&Array.isArray(r[2])&&r[2].every(n=>typeof n=="string")}e.is=t,s(t,"is")})(S0r||={});var T1=class t{constructor(e,r){this.base=e;this.edit=r}static{s(this,"RootedLineEdit")}static fromEdit(e){let r=hs.fromEdit(e);return new t(e.base,r)}toString(){return this.edit.humanReadablePatch(this.base.getLines())}toEdit(){return this.edit.toEdit(this.base)}toRootedEdit(){return new Vd(this.base,this.toEdit())}getEditedState(){let e=this.base.getLines();return this.edit.apply(e)}removeCommonSuffixPrefixLines(){let e=s(n=>!n.lineRange.isEmpty||n.newLines.length>0,"isNotEmptyEdit"),r=this.edit.edits.map(n=>n.removeCommonSuffixPrefixLines(this.base)).filter(n=>e(n));return new t(this.base,new hs(r))}};var ga=class t{constructor(e){this.edits=e;Fl(kx(e,(r,n)=>r.range.endExclusive<=n.range.start))}static{s(this,"Edit")}static deserialize(e){return new t(e.map(r=>Oa.deserialize(r)))}static{this.empty=new t([])}static create(e){return new t(e)}static single(e){return new t([e])}static replace(e,r){return new t([Oa.replace(e,r)])}static insert(e,r){return new t([Oa.insert(e,r)])}static fromOffsetEdit(e){return new t(e.edits.map(r=>Oa.replace(r.replaceRange,r.newText)))}static compose(e){let r;for(let n of e)r===void 0?r=n:r=r.compose(n);return r??t.empty}static trySwap(e,r){let n=e.inverse((a,c)=>" ".repeat(c-a)),i=r.tryRebase(n);if(!i)return;let o=e.tryRebase(i);if(o)return{e1:i,e2:o}}toOffsetEdit(){return new tg(this.edits.map(e=>new yl(e.range,e.newText)))}compose(e){return _0r(this,e)}getNewRanges(){return this.toOffsetEdit().getNewTextRanges()}apply(e){let r="",n=0;for(let i of this.edits)r+=e.substring(n,i.range.start),r+=i.newText,n=i.range.endExclusive;return r+=e.substring(n),r}normalize(){let e=[],r;for(let n of this.edits)if(!(n.newText.length===0&&n.range.length===0))if(r&&r.range.endExclusive===n.range.start){let i=r.data?.merge(n.data)??void 0;r=Oa.replaceWithData(r.range.join(n.range),r.newText+n.newText,i)}else r&&e.push(r),r=n;return r&&e.push(r),new t(e)}normalizeOnSource(e){let r=this.apply(e),i=Oa.replace(Vt.ofLength(e.length),r).removeCommonSuffixAndPrefix(e);return i.isNeutral()?t.empty:i.toEdit()}toString(){return this.edits.map(e=>e.toString()).join("")}decompose(e){if(e===void 0){let i=[],o=0;for(let a of this.edits)i.push(Oa.replaceWithData(Vt.ofStartAndLength(a.range.start+o,a.range.length),a.newText,a.data)),o+=a.newText.length-a.range.length;return new Dne(i)}if(this.edits.length!==e.arrayLength)throw n7(`Number of edits ${this.edits.length} does not match ${e.arrayLength}`);let r=[],n=this.edits.slice();for(let i=0;i<this.edits.length;++i){let o=e.mapIndexBack(i),a=n[o];r.push(a);for(let c=o;c<n.length;++c){let l=a.newText.length-a.range.length,u=n[c];n[c]=Oa.replaceWithData(Vt.ofStartAndLength(u.range.start+l,u.range.length),u.newText,u.data)}}return new Dne(r)}getRange(){if(this.edits.length!==0)return this.edits[0].range.join(this.edits[this.edits.length-1].range)}isEmpty(){return this.edits.length===0}applyInverseToOffsetRange(e){let r=this.toOffsetEdit(),n=r.applyInverseToOffset(e.start),i=r.applyInverseToOffset(e.endExclusive);return new Vt(n,i)}serialize(){return this.edits.map(e=>e.serialize())}equals(e){if(this.edits.length!==e.edits.length)return!1;for(let r=0;r<this.edits.length;++r)if(!this.edits[r].equals(e.edits[r]))return!1;return!0}inverse(e){let r=[],n=0;for(let i of this.edits)r.push(Oa.replace(Vt.ofStartAndLength(i.range.start+n,i.newText.length),e(i.range.start,i.range.endExclusive))),n+=i.newText.length-i.range.length;return new t(r)}inverseOnString(e){return this.inverse((r,n)=>e.substring(r,n))}mapData(e){return t.create(this.edits.map(r=>r.mapData(e)))}tryRebase(e){let r=[],n=0,i=0,o=0;for(;i<this.edits.length||n<e.edits.length;){let a=e.edits[n],c=this.edits[i];if(c)if(!a)r.push(Oa.replace(c.range.delta(o),c.newText)),i++;else{if(c.range.intersectsOrTouches(a.range))return;c.range.start<a.range.start?(r.push(Oa.replace(c.range.delta(o),c.newText)),i++):(n++,o+=a.newText.length-a.range.length)}else break}return new t(r)}};function _0r(t,e){if(t=t.normalize(),e=e.normalize(),t.isEmpty())return e;if(e.isEmpty())return t;let r=[...t.edits],n=[],i=0;for(let o of e.edits){for(;;){let u=r[0];if(!u||u.range.start+i+u.newText.length>=o.range.start)break;r.shift(),n.push(u),i+=u.newText.length-u.range.length}let a=i,c,l;for(;;){let u=r[0];if(!u||u.range.start+i>o.range.endExclusive)break;c||(c=u),l=u,r.shift(),i+=u.newText.length-u.range.length}if(!c)n.push(Oa.replaceWithData(o.range.delta(-i),o.newText,o.data));else{let u=o.range.start-a-c.range.start;u>0&&n.push(Oa.replaceWithData(Vt.emptyAt(c.range.start),c.newText.slice(0,u),c.data));let f=l.range.endExclusive+i-o.range.endExclusive;if(f>0){let m=Oa.replaceWithData(Vt.emptyAt(l.range.endExclusive),l.newText.slice(-f),l.data);r.unshift(m),i-=m.newText.length-m.range.length}let p=new Vt(Math.min(c.range.start,o.range.start-a),o.range.endExclusive-i);n.push(Oa.replaceWithData(p,o.newText,o.data))}}for(;;){let o=r.shift();if(!o)break;n.push(o)}return ga.create(n).normalize()}s(_0r,"joinEdits");var Oa=class t{constructor(e,r,n){this.range=e;this.newText=r;this.data=n}static{s(this,"SingleEdit")}static deserialize(e){return new t(new Vt(e[0],e[1]),e[2],void 0)}static replace(e,r){return new t(e,r,void 0)}static insert(e,r){return new t(new Vt(e,e),r,void 0)}static delete(e){return new t(e,"",void 0)}static replaceWithData(e,r,n){return new t(e,r,n)}static insertWithData(e,r,n){return new t(new Vt(e,e),r,n)}static deleteWithData(e,r){return new t(e,"",r)}static fromSingleOffsetEdit(e){return new t(e.replaceRange,e.newText,void 0)}toString(){return`${this.range}->${JSON.stringify(this.newText)}`}serialize(){return[this.range.start,this.range.endExclusive,this.newText]}toEdit(){return ga.create([this])}equals(e){return this.range.equals(e.range)&&this.newText===e.newText}removeCommonSuffixAndPrefix(e){return this.removeCommonSuffix(e).removeCommonPrefix(e)}removeCommonPrefix(e){let r=this.range.substring(e),n=R0r(r,this.newText);return n===0?this:t.replaceWithData(this.range.deltaStart(n),this.newText.substring(n),this.data)}removeCommonSuffix(e){let r=this.range.substring(e),n=k0r(r,this.newText);return n===0?this:t.replaceWithData(this.range.deltaEnd(-n),this.newText.substring(0,this.newText.length-n),this.data)}isNeutral(){return this.newText.length===0&&this.range.length===0}mapData(e){return new t(this.range,this.newText,e(this.data))}};function R0r(t,e){let r=0;for(;r<t.length&&r<e.length&&t[r]===e[r];)r++;return r}s(R0r,"commonPrefixLength");function k0r(t,e){let r=0;for(;r<t.length&&r<e.length&&t[t.length-1-r]===e[e.length-1-r];)r++;return r}s(k0r,"commonSuffixLength");var Vd=class t{constructor(e,r){this.base=e;this.edit=r}static{s(this,"RootedEdit")}getEditedState(){return this.base.apply(this.edit)}rebase(e){return NA(()=>null.base.equals(this.base.apply(e))),NA(()=>null.base.apply(null.edit).equals(this.base.apply(e).apply(this.edit))),null}toString(){return T1.fromEdit(this).toString()}normalize(){return new t(this.base,this.edit.normalizeOnSource(this.base.value))}equals(e){return this.base.equals(e.base)&&this.edit.equals(e.edit)}},Dne=class t{constructor(e){this.edits=e}static{s(this,"SingleEdits")}static{this.empty=new t([])}compose(){return ga.compose(this.edits.map(e=>e.toEdit()))}apply(e){return this.compose().apply(e)}isEmpty(){return this.edits.length===0}toEdits(){return new w1(this.edits.map(e=>e.toEdit()))}},w1=class t{constructor(e){this.edits=e}static{s(this,"Edits")}static{this.empty=new t([])}static single(e){return new t([e])}compose(){return ga.compose(this.edits)}add(e){return new t([...this.edits,e])}apply(e){return this.compose().apply(e)}isEmpty(){return this.edits.length===0}swap(e){let r=e,n=[];for(let i of this.edits){let o=ga.trySwap(r,i);if(!o)return;n.push(o.e1),r=o.e2}return{edits:new t(n),editLast:r}}mapData(e){return new t(this.edits.map(r=>r.mapData(e)))}serialize(){return this.edits.map(e=>e.serialize())}static deserialize(e){return new t(e.map(r=>ga.deserialize(r)))}toHumanReadablePatch(e){let r=e,n=[];for(let i of this.edits){let o=hs.fromEdit(new Vd(r,i));n.push(o.humanReadablePatch(r.getLines())),r=r.apply(i)}return n.join(`
---
`)}};d();d();d();var Uk=0;function Bne(t){return t===0}s(Bne,"lengthIsZero");var lm=2**26;function u8(t,e){return t*lm+e}s(u8,"toLength");function lE(t){let e=t,r=Math.floor(e/lm),n=e-r*lm;return new fu(r,n)}s(lE,"lengthToObj");function gU(t,e){let r=t+e;return e>=lm&&(r=r-t%lm),r}s(gU,"lengthAdd");function adt(t,e){return t.reduce((r,n)=>gU(r,e(n)),Uk)}s(adt,"sumLengths");function CSe(t,e){return t===e}s(CSe,"lengthEquals");function AU(t,e){let r=t,n=e;if(n-r<=0)return Uk;let o=Math.floor(r/lm),a=Math.floor(n/lm),c=n-a*lm;if(o===a){let l=r-o*lm;return u8(0,c-l)}else return u8(a-o,c)}s(AU,"lengthDiffNonNegative");function cdt(t,e){let r=t,n=Math.floor(r/lm),i=r-n*lm,o=e,a=Math.floor(o/lm),c=o-a*lm;return new ir(n+1,i+1,a+1,c+1)}s(cdt,"lengthsToRange");d();var d8=class{constructor(e,r,n){this.startOffset=e;this.endOffset=r;this.newLength=n}static{s(this,"TextEditInfo")}toString(){return`[${lE(this.startOffset)}...${lE(this.endOffset)}) -> ${lE(this.newLength)}`}};function udt(t,e){if(t.length===0)return e;if(e.length===0)return t;let r=new lX(ldt(t)),n=ldt(e);n.push({modified:!1,lengthBefore:void 0,lengthAfter:void 0});let i=r.dequeue();function o(u){if(u===void 0){let p=r.takeWhile(m=>!0)||[];return i&&p.unshift(i),p}let f=[];for(;i&&!Bne(u);){let[p,m]=i.splitAt(u);f.push(p),u=AU(p.lengthAfter,u),i=m??r.dequeue()}return Bne(u)||f.push(new yU(!1,u,u)),f}s(o,"nextS0ToS1MapWithS1LengthOf");let a=[];function c(u,f,p){if(a.length>0&&CSe(a[a.length-1].endOffset,u)){let m=a[a.length-1];a[a.length-1]=new d8(m.startOffset,f,gU(m.newLength,p))}else a.push({startOffset:u,endOffset:f,newLength:p})}s(c,"pushEdit");let l=Uk;for(let u of n){let f=o(u.lengthBefore);if(u.modified){let p=adt(f,h=>h.lengthBefore),m=gU(l,p);c(l,m,u.lengthAfter),l=m}else for(let p of f){let m=l;l=gU(l,p.lengthBefore),p.modified&&c(m,l,p.lengthAfter)}}return a}s(udt,"combineTextEditInfos");var yU=class t{constructor(e,r,n){this.modified=e;this.lengthBefore=r;this.lengthAfter=n}static{s(this,"LengthMapping")}splitAt(e){let r=AU(e,this.lengthAfter);return CSe(r,Uk)?[this,void 0]:this.modified?[new t(this.modified,this.lengthBefore,e),new t(this.modified,Uk,r)]:[new t(this.modified,e,e),new t(this.modified,r,r)]}toString(){return`${this.modified?"M":"U"}:${lE(this.lengthBefore)} -> ${lE(this.lengthAfter)}`}};function ldt(t){let e=[],r=Uk;for(let n of t){let i=AU(r,n.startOffset);Bne(i)||e.push(new yU(!1,i,i));let o=AU(n.startOffset,n.endOffset);e.push(new yU(!0,o,n.newLength)),r=n.endOffset}return e}s(ldt,"toLengthMapping");var CU=class t{constructor(e){this.edits=e}static{s(this,"TextLengthEdit")}static{this.empty=new t([])}static fromTextEdit(e){let r=e.edits.map(n=>new Nne(n.range,fu.ofText(n.newText)));return new t(r)}static _fromTextEditInfo(e){let r=e.map(n=>{let i=lE(n.newLength);return new Nne(cdt(n.startOffset,n.endOffset),new fu(i.lineCount,i.columnCount))});return new t(r)}_toTextEditInfo(){return this.edits.map(e=>new d8(u8(e.range.startLineNumber-1,e.range.startColumn-1),u8(e.range.endLineNumber-1,e.range.endColumn-1),u8(e.newLength.lineCount,e.newLength.columnCount)))}compose(e){let r=this._toTextEditInfo(),n=e._toTextEditInfo(),i=udt(r,n);return t._fromTextEditInfo(i)}getRange(){if(this.edits.length!==0)return ir.fromPositions(this.edits[0].range.getStartPosition(),this.edits.at(-1).range.getEndPosition())}toString(){return`[${this.edits.join(", ")}]`}},Nne=class{constructor(e,r){this.range=e;this.newLength=r}static{s(this,"SingleTextEditLength")}toString(){return`{ range: ${this.range}, newLength: ${this.newLength} }`}};d();var Mne=class{constructor(e){this.documents=e;Fl(e.length>0)}static{s(this,"HistoryContext")}getMostRecentDocument(){return this.documents.at(-1)}getDocument(e){return this.documents.find(r=>r.docId===e)}getDocumentAndIdx(e){let r=this.documents.findIndex(n=>n.docId.uri===e.uri);if(r!==-1)return{doc:this.documents[r],idx:r}}},Lne=class{constructor(e,r,n,i,o){this.docId=e;this.languageId=r;this.base=n;this.lastEdits=i;this.lastSelection=o;this.lastEdit=new Vd(this.base,this.lastEdits.compose())}static{s(this,"DocumentHistory")}};d();var Fne=class extends Rs{constructor(){super();this.branch=MA("branchName",void 0);this._register(Uxe((r,n)=>{this.init(n)}))}static{s(this,"ObservableGitStub")}async init(r){}};var One=class extends Rs{constructor(r,n=!1){super();this._documentState=new Map;this._lastDocuments=new xSe(50);this.workspace=r,this._lastGitCheckout=void 0,this._started=!1,n||this.start()}static{s(this,"NesHistoryContextProvider")}start(){if(this._started)return;this._started=!0;let r=new Fne;this._register(GR(n=>{n.readObservable(r.branch)!==void 0&&(this._lastGitCheckout=c8(),this._documentState.forEach(o=>o.applyAllEdits()))})),Bh(this,this.workspace.openDocuments,(n,i)=>{let o=n.selection.get().at(0),a=new vSe(n.id,n.value.get().value,n.languageId.get(),o);this._documentState.set(a.docId,a),o&&this._lastDocuments.push(a),i.add(Mx(this,{value:n.value,selection:n.selection,languageId:n.languageId},c=>{c.languageId.changes.length>0&&(a.languageId=c.languageId.value);let l=this._isAwaitingGitCheckoutCooldown();for(let u of c.value.changes)this._lastDocuments.push(a),a.handleEdit(u,l);c.selection.changes.length>0&&(a.handleSelection(c.selection.value.at(0)),this._lastDocuments.push(a))})),i.add(Qc(()=>{let c=this._documentState.get(n.id);c&&this._lastDocuments.remove(c),this._documentState.delete(n.id)}))},n=>n.id).recomputeInitiallyAndOnChange(this._store)}async getHistoryContext(r,n=5,i=100){let o=this._documentState.get(r);if(!o||!this._lastDocuments.has(o)||!await this.workspace.getDocument(r))return;let a=[],c=!1;for(let l of this._lastDocuments.getItemsReversed()){let u=l.getRecentEdit(n,i);if(u!==void 0){if(u.editCount===0&&c)break;if(await this.workspace.getDocument(l.docId)&&(l.docId===r&&(c=!0),a.push(u.history),n-=u.editCount,n<=0))break}}if(a.reverse(),!!a.some(l=>l.docId===r))return new Mne(a)}_isAwaitingGitCheckoutCooldown(){if(!this._lastGitCheckout)return!1;let r=c8()-this._lastGitCheckout<2*1e3;return r||(this._lastGitCheckout=void 0),r}getRecentDocumentUris(){return this._lastDocuments.getItems().map(r=>r.docId.uri)}},vSe=class t{constructor(e,r,n,i){this.docId=e;this.languageId=n;this._edits=[];this._isUserDocument=!1;this._baseValue=new pu(r),this._currentValue=this._baseValue,this.handleSelection(i)}static{s(this,"DocumentState")}static{this.MAX_EDITED_LINES_PER_EDIT=10}static{this.MAX_EDITED_CHARS_PER_EDIT=5e3}getSelection(){return this._selection}handleSelection(e){e&&(this._isUserDocument=!0),this._selection=e}handleEdit(e,r){if(e.isEmpty())return;this._currentValue=this._currentValue.apply(e);let n=l8.fromEdit(e,this._currentValue),i=CU.fromTextEdit(n);if(r){this._baseValue=this._currentValue,this._edits=[];return}function o(c){return qk(c.edits,l=>l.newText.length)}s(o,"editInsertSize");let a=this._edits.at(-1);a&&o(a.edit)<200&&P0r(e,a.edit)?(a.edit=a.edit.compose(e),a.textLengthEdit=a.textLengthEdit.compose(i),a.instant=c8(),a.edit.isEmpty()&&this._edits.pop()):this._edits.push({edit:e,textLengthEdit:i,instant:c8()})}getRecentEdit(e,r){if(!this._isUserDocument)return;let{editCount:n}=this._applyStaleEdits(e,r),i=new w1(this._edits.map(o=>o.edit));return{history:new Lne(this.docId,this.languageId,this._baseValue,i,this._selection),editCount:n}}applyAllEdits(){this._baseValue=this._currentValue,this._edits=[]}_applyStaleEdits(e,r){let n=this._currentValue,i=ga.empty,o=CU.empty,a,c=0,l=ga.empty;for(a=this._edits.length-1;a>=0;a--){let u=this._edits[a];if(c8()-u.instant>600*1e3)break;let f=u.textLengthEdit.compose(o),p=f.getRange();Tne(p,"we only compose non-empty Edits");let m=p.endLineNumber-p.startLineNumber;if(r>0&&m>r)break;let h=qk(u.textLengthEdit.edits,B=>B.range.endLineNumber-B.range.startLineNumber+B.newLength.lineCount);if(h>t.MAX_EDITED_LINES_PER_EDIT||qk(u.edit.edits,B=>B.newText.length)>t.MAX_EDITED_CHARS_PER_EDIT||qk(u.edit.edits,B=>B.range.length)>t.MAX_EDITED_CHARS_PER_EDIT)break;if(a===this._edits.length-1)l=u.edit;else{let B=ga.trySwap(u.edit,l);if(B)l=B.e1;else{if(h>=2)break;l=u.edit.compose(l)}}let y=u.edit.inverseOnString(n.value);n=n.apply(y);let E=u.edit.compose(i),b=hs.fromEdit(new Vd(n,E)),R=new T1(n,b).removeCommonSuffixPrefixLines().edit.edits.length;if(R>e)break;c=R,i=E,o=f}for(let u=0;u<=a;u++){let f=this._edits[u];this._baseValue=this._baseValue.apply(f.edit)}return this._edits=this._edits.slice(a+1),{editCount:c}}toString(){return new w1(this._edits.map(e=>e.edit)).toHumanReadablePatch(this._baseValue)}};function qk(t,e){let r=0;for(let n of t)r+=e(n);return r}s(qk,"sum");function P0r(t,e){let r=e.getNewRanges();return t.edits.every(n=>D0r(n.range,r))}s(P0r,"editExtends");function D0r(t,e){return e.some(r=>t.start===r.endExclusive||t.endExclusive===r.start)}s(D0r,"doesTouch");var xSe=class{constructor(e){this.maxSize=e;this._arr=[]}static{s(this,"FifoSet")}push(e){let r=this._arr.indexOf(e);r!==-1?this._arr.splice(r,1):this._arr.length>=this.maxSize&&this._arr.shift(),this._arr.push(e)}remove(e){let r=this._arr.indexOf(e);r!==-1&&this._arr.splice(r,1)}getItems(){return this._arr}getItemsReversed(){let e=[...this._arr];return e.reverse(),e}has(e){return this._arr.indexOf(e)!==-1}};d();d();var Hk=class{constructor(e){this.text=e;this.lineStartOffsetByLineIdx=[],this.lineEndOffsetByLineIdx=[],this.lineStartOffsetByLineIdx.push(0);for(let r=0;r<e.length;r++)e.charAt(r)===`
`&&(this.lineStartOffsetByLineIdx.push(r+1),r>0&&e.charAt(r-1)==="\r"?this.lineEndOffsetByLineIdx.push(r-1):this.lineEndOffsetByLineIdx.push(r));this.lineEndOffsetByLineIdx.push(e.length)}static{s(this,"PositionOffsetTransformer")}getOffset(e){return this.lineStartOffsetByLineIdx[e.lineNumber-1]+e.column-1}getOffsetRange(e){return new Vt(this.getOffset(e.getStartPosition()),this.getOffset(e.getEndPosition()))}getPosition(e){let r=RA(this.lineStartOffsetByLineIdx,o=>o<=e),n=r+1,i=e-this.lineStartOffsetByLineIdx[r]+1;return new Wr(n,i)}getRange(e){return ir.fromPositions(this.getPosition(e.start),this.getPosition(e.endExclusive))}getTextLength(e){return fu.ofRange(this.getRange(e))}get textLength(){let e=this.lineStartOffsetByLineIdx.length-1;return new fu(e,this.text.length-this.lineStartOffsetByLineIdx[e])}getLineLength(e){return this.lineEndOffsetByLineIdx[e-1]-this.lineStartOffsetByLineIdx[e-1]}};var ESe=class{constructor(){this._transformer=void 0}static{s(this,"AbstractText")}get endPositionExclusive(){return this.length.addToPosition(new Wr(1,1))}get lineRange(){return this.length.toLineRange()}getValue(){return this.getValueOfRange(this.length.toRange())}getLineLength(e){return this.getValueOfRange(new ir(e,1,e,Number.MAX_SAFE_INTEGER)).length}getTransformer(){return this._transformer||(this._transformer=new Hk(this.getValue())),this._transformer}getLineAt(e){return this.getValueOfRange(new ir(e,1,e,Number.MAX_SAFE_INTEGER))}getLines(){let e=this.getValue();return Lh(e)}equals(e){return this===e?!0:this.getValue()===e.getValue()}};var uE=class extends ESe{constructor(r){super();this.value=r;this._t=new Hk(this.value)}static{s(this,"StringText")}getValueOfRange(r){return this._t.getOffsetRange(r).substring(this.value)}get length(){return this._t.textLength}};d();d();d();var vU=class{constructor(e){this.replacements=e;let r=-1;for(let n of e){if(!(n.replaceRange.start>=r))throw new xn(`Edits must be disjoint and sorted. Found ${n} after ${r}`);r=n.replaceRange.endExclusive}}static{s(this,"BaseEdit")}equals(e){if(this.replacements.length!==e.replacements.length)return!1;for(let r=0;r<this.replacements.length;r++)if(!this.replacements[r].equals(e.replacements[r]))return!1;return!0}toString(){return`[${this.replacements.map(r=>r.toString()).join(", ")}]`}normalize(){let e=[],r;for(let n of this.replacements)if(!(n.getNewLength()===0&&n.replaceRange.length===0)){if(r&&r.replaceRange.endExclusive===n.replaceRange.start){let i=r.tryJoinTouching(n);if(i){r=i;continue}}r&&e.push(r),r=n}return r&&e.push(r),this._createNew(e)}compose(e){let r=this.normalize(),n=e.normalize();if(r.isEmpty())return n;if(n.isEmpty())return r;let i=[...r.replacements],o=[],a=0;for(let c of n.replacements){for(;;){let p=i[0];if(!p||p.replaceRange.start+a+p.getNewLength()>=c.replaceRange.start)break;i.shift(),o.push(p),a+=p.getNewLength()-p.replaceRange.length}let l=a,u,f;for(;;){let p=i[0];if(!p||p.replaceRange.start+a>c.replaceRange.endExclusive)break;u||(u=p),f=p,i.shift(),a+=p.getNewLength()-p.replaceRange.length}if(!u)o.push(c.delta(-a));else{let p=Math.min(u.replaceRange.start,c.replaceRange.start-l),m=c.replaceRange.start-(u.replaceRange.start+l);if(m>0){let y=u.slice(Vt.emptyAt(p),new Vt(0,m));o.push(y)}if(!f)throw new xn("Invariant violation: lastIntersecting is undefined");let h=f.replaceRange.endExclusive+a-c.replaceRange.endExclusive;if(h>0){let y=f.slice(Vt.ofStartAndLength(f.replaceRange.endExclusive,0),new Vt(f.getNewLength()-h,f.getNewLength()));i.unshift(y),a-=y.getNewLength()-y.replaceRange.length}let g=new Vt(p,c.replaceRange.endExclusive-a),A=c.slice(g,new Vt(0,c.getNewLength()));o.push(A)}}for(;;){let c=i.shift();if(!c)break;o.push(c)}return this._createNew(o).normalize()}decomposeSplit(e){let r=[],n=[],i=0;for(let o of this.replacements)e(o)?(r.push(o),i+=o.getNewLength()-o.replaceRange.length):n.push(o.slice(o.replaceRange.delta(i),new Vt(0,o.getNewLength())));return{e1:this._createNew(r),e2:this._createNew(n)}}getNewRanges(){let e=[],r=0;for(let n of this.replacements)e.push(Vt.ofStartAndLength(n.replaceRange.start+r,n.getNewLength())),r+=n.getLengthDelta();return e}getJoinedReplaceRange(){if(this.replacements.length!==0)return this.replacements[0].replaceRange.join(this.replacements.at(-1).replaceRange)}isEmpty(){return this.replacements.length===0}getLengthDelta(){return i7(this.replacements,e=>e.getLengthDelta())}getNewDataLength(e){return e+this.getLengthDelta()}applyToOffset(e){let r=0;for(let n of this.replacements)if(n.replaceRange.start<=e){if(e<n.replaceRange.endExclusive)return n.replaceRange.start+r;r+=n.getNewLength()-n.replaceRange.length}else break;return e+r}applyToOffsetRange(e){return new Vt(this.applyToOffset(e.start),this.applyToOffset(e.endExclusive))}applyInverseToOffset(e){let r=0;for(let n of this.replacements){let i=n.getNewLength();if(n.replaceRange.start<=e-r){if(e-r<n.replaceRange.start+i)return n.replaceRange.start;r+=i-n.replaceRange.length}else break}return e-r}applyToOffsetOrUndefined(e){let r=0;for(let n of this.replacements)if(n.replaceRange.start<=e){if(e<n.replaceRange.endExclusive)return;r+=n.getNewLength()-n.replaceRange.length}else break;return e+r}applyToOffsetRangeOrUndefined(e){let r=this.applyToOffsetOrUndefined(e.start);if(r===void 0)return;let n=this.applyToOffsetOrUndefined(e.endExclusive);if(n!==void 0)return new Vt(r,n)}},Qne=class{constructor(e){this.replaceRange=e}static{s(this,"BaseReplacement")}delta(e){return this.slice(this.replaceRange.delta(e),new Vt(0,this.getNewLength()))}getLengthDelta(){return this.getNewLength()-this.replaceRange.length}toString(){return`{ ${this.replaceRange.toString()} -> ${this.getNewLength()} }`}get isEmpty(){return this.getNewLength()===0&&this.replaceRange.length===0}getRangeAfterReplace(){return new Vt(this.replaceRange.start,this.replaceRange.start+this.getNewLength())}},ddt=class t extends vU{static{s(this,"Edit")}static{this.empty=new t([])}static create(e){return new t(e)}static single(e){return new t([e])}_createNew(e){return new t(e)}};var Une=class extends vU{static{s(this,"BaseStringEdit")}get TReplacement(){throw new Error("TReplacement is not defined for BaseStringEdit")}static composeOrUndefined(e){if(e.length===0)return;let r=e[0];for(let n=1;n<e.length;n++)r=r.compose(e[n]);return r}static trySwap(e,r){let n=e.inverseOnSlice((a,c)=>" ".repeat(c-a)),i=r.tryRebase(n);if(!i)return;let o=e.tryRebase(i);if(o)return{e1:i,e2:o}}apply(e){let r=[],n=0;for(let i of this.replacements)r.push(e.substring(n,i.replaceRange.start)),r.push(i.newText),n=i.replaceRange.endExclusive;return r.push(e.substring(n)),r.join("")}inverseOnSlice(e){let r=[],n=0;for(let i of this.replacements)r.push(ld.replace(Vt.ofStartAndLength(i.replaceRange.start+n,i.newText.length),e(i.replaceRange.start,i.replaceRange.endExclusive))),n+=i.newText.length-i.replaceRange.length;return new Uf(r)}inverse(e){return this.inverseOnSlice((r,n)=>e.substring(r,n))}tryRebase(e,r=!0){let n=[],i=0,o=0,a=0;for(;o<this.replacements.length||i<e.replacements.length;){let c=e.replacements[i],l=this.replacements[o];if(l)if(!c)n.push(new ld(l.replaceRange.delta(a),l.newText)),o++;else if(l.replaceRange.intersectsOrTouches(c.replaceRange)){if(o++,r)return}else l.replaceRange.start<c.replaceRange.start?(n.push(new ld(l.replaceRange.delta(a),l.newText)),o++):(i++,a+=c.newText.length-c.replaceRange.length);else break}return new Uf(n)}toJson(){return this.replacements.map(e=>({txt:e.newText,pos:e.replaceRange.start,len:e.replaceRange.length}))}isNeutralOn(e){return this.replacements.every(r=>r.isNeutralOn(e))}removeCommonSuffixPrefix(e){let r=[];for(let n of this.replacements){let i=n.removeCommonSuffixPrefix(e);i.isEmpty||r.push(i)}return new Uf(r)}normalizeEOL(e){return new Uf(this.replacements.map(r=>r.normalizeEOL(e)))}normalizeOnSource(e){let r=this.apply(e),i=ld.replace(Vt.ofLength(e.length),r).removeCommonSuffixAndPrefix(e);return i.isEmpty?Uf.empty:i.toEdit()}removeCommonSuffixAndPrefix(e){return this._createNew(this.replacements.map(r=>r.removeCommonSuffixAndPrefix(e))).normalize()}applyOnText(e){return new uE(this.apply(e.value))}mapData(e){return new bSe(this.replacements.map(r=>new f8(r.replaceRange,r.newText,e(r))))}},qne=class extends Qne{constructor(r,n){super(r);this.newText=n}static{s(this,"BaseStringReplacement")}getNewLength(){return this.newText.length}toString(){return`${this.replaceRange} -> ${JSON.stringify(this.newText)}`}replace(r){return r.substring(0,this.replaceRange.start)+this.newText+r.substring(this.replaceRange.endExclusive)}isNeutralOn(r){return this.newText===r.substring(this.replaceRange.start,this.replaceRange.endExclusive)}removeCommonSuffixPrefix(r){let n=r.substring(this.replaceRange.start,this.replaceRange.endExclusive),i=KT(n,this.newText),o=Math.min(n.length-i,this.newText.length-i,Nx(n,this.newText)),a=new Vt(this.replaceRange.start+i,this.replaceRange.endExclusive-o),c=this.newText.substring(i,this.newText.length-o);return new ld(a,c)}normalizeEOL(r){let n=this.newText.replace(/\r\n|\n/g,r);return new ld(this.replaceRange,n)}removeCommonSuffixAndPrefix(r){return this.removeCommonSuffix(r).removeCommonPrefix(r)}removeCommonPrefix(r){let n=this.replaceRange.substring(r),i=KT(n,this.newText);return i===0?this:this.slice(this.replaceRange.deltaStart(i),new Vt(i,this.newText.length))}removeCommonSuffix(r){let n=this.replaceRange.substring(r),i=Nx(n,this.newText);return i===0?this:this.slice(this.replaceRange.deltaEnd(-i),new Vt(0,this.newText.length-i))}toEdit(){return new Uf([this])}},Uf=class t extends Une{static{s(this,"StringEdit")}static{this.empty=new t([])}static create(e){return new t(e)}static single(e){return new t([e])}static replace(e,r){return new t([new ld(e,r)])}static insert(e,r){return new t([new ld(Vt.emptyAt(e),r)])}static delete(e){return new t([new ld(e,"")])}static fromJson(e){return new t(e.map(ld.fromJson))}static compose(e){if(e.length===0)return t.empty;let r=e[0];for(let n=1;n<e.length;n++)r=r.compose(e[n]);return r}static composeSequentialReplacements(e){let r=t.empty,n=[];for(let i of e){let o=n.at(-1);!o||i.replaceRange.isBefore(o.replaceRange)?n.push(i):(r=r.compose(t.create(n.reverse())),n=[i])}return r=r.compose(t.create(n.reverse())),r}constructor(e){super(e)}_createNew(e){return new t(e)}},ld=class t extends qne{static{s(this,"StringReplacement")}static insert(e,r){return new t(Vt.emptyAt(e),r)}static replace(e,r){return new t(e,r)}static delete(e){return new t(e,"")}static fromJson(e){return new t(Vt.ofStartAndLength(e.pos,e.len),e.txt)}equals(e){return this.replaceRange.equals(e.replaceRange)&&this.newText===e.newText}tryJoinTouching(e){return new t(this.replaceRange.joinRightTouching(e.replaceRange),this.newText+e.newText)}slice(e,r){return new t(e,r?r.substring(this.newText):this.newText)}};var bSe=class t extends Une{static{s(this,"AnnotatedStringEdit")}static{this.empty=new t([])}static create(e){return new t(e)}static single(e){return new t([e])}static replace(e,r,n){return new t([new f8(e,r,n)])}static insert(e,r,n){return new t([new f8(Vt.emptyAt(e),r,n)])}static delete(e,r){return new t([new f8(e,"",r)])}static compose(e){if(e.length===0)return t.empty;let r=e[0];for(let n=1;n<e.length;n++)r=r.compose(e[n]);return r}constructor(e){super(e)}_createNew(e){return new t(e)}toStringEdit(){return new Uf(this.replacements.map(e=>new ld(e.replaceRange,e.newText)))}},f8=class t extends qne{constructor(r,n,i){super(r,n);this.data=i}static{s(this,"AnnotatedStringReplacement")}static insert(r,n,i){return new t(Vt.emptyAt(r),n,i)}static replace(r,n,i){return new t(r,n,i)}static delete(r,n){return new t(r,"",n)}equals(r){return this.replaceRange.equals(r.replaceRange)&&this.newText===r.newText&&this.data===r.data}tryJoinTouching(r){let n=this.data.join(r.data);if(n!==void 0)return new t(this.replaceRange.joinRightTouching(r.replaceRange),this.newText+r.newText,n)}slice(r,n){return new t(r,n?n.substring(this.newText):this.newText,this.data)}};d();var xU=class t{constructor(e){this.replacements=e;NA(()=>kx(e,(r,n)=>r.range.getEndPosition().isBeforeOrEqual(n.range.getStartPosition())))}static{s(this,"TextEdit")}static fromStringEdit(e,r){let n=e.replacements.map(i=>zd.fromStringReplacement(i,r));return new t(n)}static replace(e,r){return new t([new zd(e,r)])}static insert(e,r){return new t([new zd(ir.fromPositions(e,e),r)])}normalize(){let e=[];for(let r of this.replacements)if(e.length>0&&e[e.length-1].range.getEndPosition().equals(r.range.getStartPosition())){let n=e[e.length-1];e[e.length-1]=new zd(n.range.plusRange(r.range),n.text+r.text)}else r.isEmpty||e.push(r);return new t(e)}mapPosition(e){let r=0,n=0,i=0;for(let o of this.replacements){let a=o.range.getStartPosition();if(e.isBeforeOrEqual(a))break;let c=o.range.getEndPosition(),l=fu.ofText(o.text);if(e.isBefore(c)){let u=new Wr(a.lineNumber+r,a.column+(a.lineNumber+r===n?i:0)),f=l.addToPosition(u);return Hne(u,f)}a.lineNumber+r!==n&&(i=0),r+=l.lineCount-(o.range.endLineNumber-o.range.startLineNumber),l.lineCount===0?c.lineNumber!==a.lineNumber?i+=l.columnCount-(c.column-1):i+=l.columnCount-(c.column-a.column):i=l.columnCount,n=c.lineNumber+r}return new Wr(e.lineNumber+r,e.column+(e.lineNumber+r===n?i:0))}mapRange(e){function r(a){return a instanceof Wr?a:a.getStartPosition()}s(r,"getStart");function n(a){return a instanceof Wr?a:a.getEndPosition()}s(n,"getEnd");let i=r(this.mapPosition(e.getStartPosition())),o=n(this.mapPosition(e.getEndPosition()));return Hne(i,o)}inverseMapPosition(e,r){return this.inverse(r).mapPosition(e)}inverseMapRange(e,r){return this.inverse(r).mapRange(e)}apply(e){let r="",n=new Wr(1,1);for(let o of this.replacements){let a=o.range,c=a.getStartPosition(),l=a.getEndPosition(),u=Hne(n,c);u.isEmpty()||(r+=e.getValueOfRange(u)),r+=o.text,n=l}let i=Hne(n,e.endPositionExclusive);return i.isEmpty()||(r+=e.getValueOfRange(i)),r}applyToString(e){let r=new uE(e);return this.apply(r)}inverse(e){let r=this.getNewRanges();return new t(this.replacements.map((n,i)=>new zd(r[i],e.getValueOfRange(n.range))))}getNewRanges(){let e=[],r=0,n=0,i=0;for(let o of this.replacements){let a=fu.ofText(o.text),c=Wr.lift({lineNumber:o.range.startLineNumber+n,column:o.range.startColumn+(o.range.startLineNumber===r?i:0)}),l=a.createRange(c);e.push(l),n=l.endLineNumber-o.range.endLineNumber,i=l.endColumn-o.range.endColumn,r=o.range.endLineNumber}return e}toReplacement(e){if(this.replacements.length===0)throw new xn;if(this.replacements.length===1)return this.replacements[0];let r=this.replacements[0].range.getStartPosition(),n=this.replacements[this.replacements.length-1].range.getEndPosition(),i="";for(let o=0;o<this.replacements.length;o++){let a=this.replacements[o];if(i+=a.text,o<this.replacements.length-1){let c=this.replacements[o+1],l=ir.fromPositions(a.range.getEndPosition(),c.range.getStartPosition()),u=e.getValueOfRange(l);i+=u}}return new zd(ir.fromPositions(r,n),i)}equals(e){return c3(this.replacements,e.replacements,(r,n)=>r.equals(n))}toString(e){return e===void 0?this.replacements.map(r=>r.toString()).join(`
`):typeof e=="string"?this.toString(new uE(e)):this.replacements.length===0?"":this.replacements.map(r=>{let i=e.getValueOfRange(r.range),o=ir.fromPositions(new Wr(Math.max(1,r.range.startLineNumber-1),1),r.range.getStartPosition()),a=e.getValueOfRange(o);a.length>10&&(a="..."+a.substring(a.length-10));let c=ir.fromPositions(r.range.getEndPosition(),new Wr(r.range.endLineNumber+1,1)),l=e.getValueOfRange(c);l.length>10&&(l=l.substring(0,10)+"...");let u=i;if(u.length>10){let p=Math.floor(5);u=u.substring(0,p)+"..."+u.substring(u.length-p)}let f=r.text;if(f.length>10){let p=Math.floor(5);f=f.substring(0,p)+"..."+f.substring(f.length-p)}return u.length===0?`${a}\u2770${f}\u2771${l}`:`${a}\u2770${u}\u21A6${f}\u2771${l}`}).join(`
`)}},zd=class t{constructor(e,r){this.range=e;this.text=r}static{s(this,"TextReplacement")}static joinReplacements(e,r){if(e.length===0)throw new xn;if(e.length===1)return e[0];let n=e[0].range.getStartPosition(),i=e[e.length-1].range.getEndPosition(),o="";for(let a=0;a<e.length;a++){let c=e[a];if(o+=c.text,a<e.length-1){let l=e[a+1],u=ir.fromPositions(c.range.getEndPosition(),l.range.getStartPosition()),f=r.getValueOfRange(u);o+=f}}return new t(ir.fromPositions(n,i),o)}static fromStringReplacement(e,r){return new t(r.getTransformer().getRange(e.replaceRange),e.newText)}get isEmpty(){return this.range.isEmpty()&&this.text.length===0}static equals(e,r){return e.range.equalsRange(r.range)&&e.text===r.text}toSingleEditOperation(){return{range:this.range,text:this.text}}toEdit(){return new xU([this])}equals(e){return t.equals(this,e)}extendToCoverRange(e,r){if(this.range.containsRange(e))return this;let n=this.range.plusRange(e),i=r.getValueOfRange(ir.fromPositions(n.getStartPosition(),this.range.getStartPosition())),o=r.getValueOfRange(ir.fromPositions(this.range.getEndPosition(),n.getEndPosition())),a=i+this.text+o;return new t(n,a)}extendToFullLine(e){let r=new ir(this.range.startLineNumber,1,this.range.endLineNumber,e.getTransformer().getLineLength(this.range.endLineNumber)+1);return this.extendToCoverRange(r,e)}removeCommonPrefix(e){let r=e.getValueOfRange(this.range).replaceAll(`\r
`,`
`),n=this.text.replaceAll(`\r
`,`
`),i=KT(r,n),o=fu.ofText(r.substring(0,i)).addToPosition(this.range.getStartPosition()),a=n.substring(i),c=ir.fromPositions(o,this.range.getEndPosition());return new t(c,a)}isEffectiveDeletion(e){let r=this.text.replaceAll(`\r
`,`
`),n=e.getValueOfRange(this.range).replaceAll(`\r
`,`
`),i=KT(r,n);r=r.substring(i),n=n.substring(i);let o=Nx(r,n);return r=r.substring(0,r.length-o),n=n.substring(0,n.length-o),r===""}};function Hne(t,e){if(t.lineNumber===e.lineNumber&&t.column===Number.MAX_SAFE_INTEGER)return ir.fromPositions(e,e);if(!t.isBeforeOrEqual(e))throw new xn("start must be before end");return new ir(t.lineNumber,t.column,e.lineNumber,e.column)}s(Hne,"rangeFromPositions");var EU=class t{constructor(e){this.replacements=e;Fl(kx(e,(r,n)=>r.lineRange.endLineNumberExclusive<=n.lineRange.startLineNumber))}static{s(this,"LineEdit")}static{this.empty=new t([])}static deserialize(e){return new t(e.map(r=>p8.deserialize(r)))}static fromEdit(e,r){let n=xU.fromStringEdit(e,r);return t.fromTextEdit(n,r)}static fromTextEdit(e,r){let n=e.replacements,i=[],o=[];for(let a=0;a<n.length;a++){let c=n[a],l=a+1<n.length?n[a+1]:void 0;if(o.push(c),l&&l.range.startLineNumber===c.range.endLineNumber)continue;let u=zd.joinReplacements(o,r);o.length=0;let f=p8.fromSingleTextEdit(u,r);i.push(f)}return new t(i)}static createFromUnsorted(e){let r=e.slice();return r.sort(wh(n=>n.lineRange.startLineNumber,Sh)),new t(r)}isEmpty(){return this.replacements.length===0}toEdit(e){let r=[];for(let n of this.replacements){let i=n.toSingleEdit(e);r.push(i)}return new Uf(r)}toString(){return this.replacements.map(e=>e.toString()).join(",")}serialize(){return this.replacements.map(e=>e.serialize())}getNewLineRanges(){let e=[],r=0;for(let n of this.replacements)e.push(jr.ofLength(n.lineRange.startLineNumber+r,n.newLines.length)),r+=n.newLines.length-n.lineRange.length;return e}mapLineNumber(e){let r=0;for(let n of this.replacements){if(n.lineRange.endLineNumberExclusive>e)break;r+=n.newLines.length-n.lineRange.length}return e+r}mapLineRange(e){return new jr(this.mapLineNumber(e.startLineNumber),this.mapLineNumber(e.endLineNumberExclusive))}mapBackLineRange(e,r){return this.inverse(r).mapLineRange(e)}touches(e){return this.replacements.some(r=>e.replacements.some(n=>r.lineRange.intersect(n.lineRange)))}rebase(e){return new t(this.replacements.map(r=>new p8(e.mapLineRange(r.lineRange),r.newLines)))}humanReadablePatch(e){let r=[];function n(c,l,u,f){let p=u==="unmodified"?" ":u==="deleted"?"-":"+";f===void 0&&(f="[[[[[ WARNING: LINE DOES NOT EXIST ]]]]]");let m=c===-1?"   ":c.toString().padStart(3," "),h=l===-1?"   ":l.toString().padStart(3," ");r.push(`${p} ${m} ${h} ${f}`)}s(n,"pushLine");function i(){r.push("---")}s(i,"pushSeperator");let o=0,a=!0;for(let c of LR(this.replacements,(l,u)=>l.lineRange.distanceToRange(u.lineRange)<=5)){a?a=!1:i();let l=c[0].lineRange.startLineNumber-2;for(let u of c){for(let m=Math.max(1,l);m<u.lineRange.startLineNumber;m++)n(m,m+o,"unmodified",e[m-1]);let f=u.lineRange,p=u.newLines;for(let m of f.mapToLineArray(h=>h)){let h=e[m-1];n(m,-1,"deleted",h)}for(let m=0;m<p.length;m++){let h=p[m];n(-1,f.startLineNumber+o+m,"added",h)}l=f.endLineNumberExclusive,o+=u.newLines.length-u.lineRange.length}for(let u=l;u<=Math.min(l+2,e.length);u++)n(u,u+o,"unmodified",e[u-1])}return r.join(`
`)}apply(e){let r=[],n=0;for(let i of this.replacements){for(;n<i.lineRange.startLineNumber-1;)r.push(e[n]),n++;for(let o of i.newLines)r.push(o);n=i.lineRange.endLineNumberExclusive-1}for(;n<e.length;)r.push(e[n]),n++;return r}inverse(e){let r=this.getNewLineRanges();return new t(this.replacements.map((n,i)=>new p8(r[i],e.slice(n.lineRange.startLineNumber-1,n.lineRange.endLineNumberExclusive-1))))}},p8=class t{constructor(e,r){this.lineRange=e;this.newLines=r}static{s(this,"LineReplacement")}static deserialize(e){return new t(jr.ofLength(e[0],e[1]-e[0]),e[2])}static fromSingleTextEdit(e,r){let n=Lh(e.text),i=e.range.startLineNumber,o=r.getValueOfRange(ir.fromPositions(new Wr(e.range.startLineNumber,1),e.range.getStartPosition()));n[0]=o+n[0];let a=e.range.endLineNumber+1,c=r.getTransformer().getLineLength(e.range.endLineNumber)+1,l=r.getValueOfRange(ir.fromPositions(e.range.getEndPosition(),new Wr(e.range.endLineNumber,c)));n[n.length-1]=n[n.length-1]+l;let u=e.range.startColumn===r.getTransformer().getLineLength(e.range.startLineNumber)+1,f=e.range.endColumn===1;return u&&n[0].length===o.length&&(i++,n.shift()),n.length>0&&i<a&&f&&n[n.length-1].length===l.length&&(a--,n.pop()),new t(new jr(i,a),n)}toSingleTextEdit(e){if(this.newLines.length===0){let r=e.getTransformer().textLength;if(this.lineRange.endLineNumberExclusive===r.lineCount+2){let n;if(this.lineRange.startLineNumber>1){let o=this.lineRange.startLineNumber-1,a=e.getTransformer().getLineLength(o)+1;n=new Wr(o,a)}else n=new Wr(1,1);let i=r.addToPosition(new Wr(1,1));return new zd(ir.fromPositions(n,i),"")}else return new zd(new ir(this.lineRange.startLineNumber,1,this.lineRange.endLineNumberExclusive,1),"")}else if(this.lineRange.isEmpty){let r,n,i,o=this.lineRange.startLineNumber;return o===e.getTransformer().textLength.lineCount+2?(r=o-1,n=e.getTransformer().getLineLength(r)+1,i=this.newLines.map(a=>`
`+a).join("")):(r=o,n=1,i=this.newLines.map(a=>a+`
`).join("")),new zd(ir.fromPositions(new Wr(r,n)),i)}else{let r=this.lineRange.endLineNumberExclusive-1,n=e.getTransformer().getLineLength(r)+1,i=new ir(this.lineRange.startLineNumber,1,r,n),o=this.newLines.join(`
`);return new zd(i,o)}}toSingleEdit(e){let r=this.toSingleTextEdit(e),n=e.getTransformer().getOffsetRange(r.range);return new ld(n,r.text)}toString(){return`${this.lineRange}->${JSON.stringify(this.newLines)}`}serialize(){return[this.lineRange.startLineNumber,this.lineRange.endLineNumberExclusive,this.newLines]}removeCommonSuffixPrefixLines(e){let r=this.lineRange.startLineNumber,n=this.lineRange.endLineNumberExclusive,i=0;for(;r<n&&i<this.newLines.length&&this.newLines[i]===e.getLineAt(r);)r++,i++;let o=0;for(;r<n&&o+i<this.newLines.length&&this.newLines[this.newLines.length-1-o]===e.getLineAt(n-1);)n--,o++;return i===0&&o===0?this:new t(new jr(r,n),this.newLines.slice(i,this.newLines.length-o))}toLineEdit(){return new EU([this])}},B0r;(e=>{function t(r){return Array.isArray(r)&&r.length===3&&typeof r[0]=="number"&&typeof r[1]=="number"&&Array.isArray(r[2])&&r[2].every(n=>typeof n=="string")}e.is=t,s(t,"is")})(B0r||={});var m8=class{constructor(e,r){this.originalText=e;this._trackedEdit=r;let n=r.removeCommonSuffixPrefix(e);this._updatedTrackedEdit=n.mapData(()=>new $ne(!0))}static{s(this,"ArcTracker")}handleEdits(e){let r=e.mapData(o=>new $ne(!1)),i=this._updatedTrackedEdit.compose(r).decomposeSplit(o=>!o.data.isTrackedEdit).e2;this._updatedTrackedEdit=i}getTrackedEdit(){return this._updatedTrackedEdit.toStringEdit()}getAcceptedRetainedCharactersCount(){return qk(this._updatedTrackedEdit.replacements,r=>r.getNewLength())}getOriginalCharacterCount(){return qk(this._trackedEdit.replacements,e=>e.getNewLength())}getTrackedEditLineMetrics(){let e=this.getTrackedEdit();if(!e)return{deletedLineCounts:0,insertedLineCounts:0};let r=EU.fromEdit(e,new uE(this.originalText)),n=i7(r.replacements,o=>o.lineRange.length),i=i7(r.getNewLineRanges(),o=>o.length);return{deletedLineCounts:n,insertedLineCounts:i}}getDebugState(){return{edits:this._updatedTrackedEdit.replacements.map(e=>({range:e.replaceRange.toString(),newText:e.newText,isTrackedEdit:e.data.isTrackedEdit}))}}},$ne=class{constructor(e){this.isTrackedEdit=e}static{s(this,"IsTrackedEditData")}join(e){if(this.isTrackedEdit===e.isTrackedEdit)return this}};d();var h8=class{constructor(e,r){this.originalText=e;this._combinedEditsSinceStart=Uf.empty;this._debugLog=[];this._text=r.apply(this.originalText),this._textAfterTrackedEdits=this._text,this._originalEdits=r,this._debugLog.push(`[INIT] Original: "${this.originalText}"`),this._debugLog.push(`[INIT] TrackedEdits(${r.replacements.length}): ${this._formatEditsCompact(r,this.originalText)}`),this._debugLog.push(`[INIT] Result: "${this._text}"`),this._debugLog.push("")}static{s(this,"EditSurvivalTracker")}_formatEditsCompact(e,r){return e.replacements.length===0?"[]":e.replacements.map(n=>{let i=r.substring(n.replaceRange.start,n.replaceRange.endExclusive);return`[${n.replaceRange.start}:${n.replaceRange.endExclusive}]"${i}"->"${n.newText}"`}).join(", ")}handleEdits(e){let r=this._text,n=e.apply(this._text),i=this._combinedEditsSinceStart.compose(e);i=i.removeCommonSuffixPrefix(this._textAfterTrackedEdits),this._combinedEditsSinceStart=i,this._text=n,this._debugLog.push(`[EDIT] Input(${e.replacements.length}): ${this._formatEditsCompact(e,r)} -> "${n}"`),this._debugLog.push(`[EDIT] Accumulated(${this._combinedEditsSinceStart.replacements.length}): ${this._formatEditsCompact(this._combinedEditsSinceStart,this._textAfterTrackedEdits)}`)}getCurrentText(){return this._text}getTextAfterMarkedEdits(){return this._textAfterTrackedEdits}getOriginalText(){return this.originalText}getDebugLog(){return this._debugLog.join(`
`)}computeTrackedEditsSurvivalScore(){this._debugLog.push(`[CALC] Current: "${this._text}" | Original: "${this.originalText}"`);let e=0,r=0,n=0,i=0,o=this._originalEdits.getNewRanges(),a=N0r(o,this._combinedEditsSinceStart);this._debugLog.push(`[CALC] Processing ${o.length} edits:`);for(let u=0;u<o.length;u++){let f=this._originalEdits.replacements[u],p=this.originalText.substring(f.replaceRange.start,f.replaceRange.endExclusive),m=f.newText,h=a[u],g=this._text.substring(h.start,h.endExclusive),A=ISe(g,m),y=ISe(m,p),E=ISe(g,p);if(this._debugLog.push(`  #${u+1}: "${p}"->"${m}"->"${g}" | 4gram:${A.toFixed(2)} noRevert:(${y.toFixed(2)},${E.toFixed(2)})`),y!==1){let b=1-Math.max(E-y,0)/(1-y);n+=f.replaceRange.length*b,i+=f.replaceRange.length}e+=f.newText.length*A,r+=f.newText.length}let c=r===0?1:e/r,l=i===0?1:n/i;return this._debugLog.push(`[RESULT] fourGram: ${c.toFixed(3)} (${e.toFixed(1)}/${r.toFixed(1)}) | noRevert: ${l.toFixed(3)} (${n.toFixed(1)}/${i.toFixed(1)})`),{fourGram:c,noRevert:l}}};function ISe(t,e){if(t.length<4||e.length<4)return t===e?1:0;let n=new Map;for(let c=0;c<=t.length-4;c++){let l=t.substring(c,c+4),u=n.get(l)||0;n.set(l,u+1)}for(let c=0;c<=e.length-4;c++){let l=e.substring(c,c+4),u=n.get(l)||0;n.set(l,u-1)}let i=t.length-4+1+e.length-4+1,o=0;for(let c of n.values())o+=Math.abs(c);return(i-o)/i}s(ISe,"compute4GramTextSimilarity");function N0r(t,e){t=t.slice();let r=[],n=0;for(let i of e.replacements){for(;;){let a=t[0];if(!a||a.endExclusive>=i.replaceRange.start)break;t.shift(),r.push(a.delta(n))}let o=[];for(;;){let a=t[0];if(!a||!a.intersectsOrTouches(i.replaceRange))break;t.shift(),o.push(a)}for(let a=o.length-1;a>=0;a--){let c=o[a],l=c.intersect(i.replaceRange).length;c=c.deltaEnd(-l+(a===0?i.newText.length:0));let u=c.start-i.replaceRange.start;u>0&&(c=c.delta(-u)),a!==0&&(c=c.delta(i.newText.length)),c=c.delta(-(i.newText.length-i.replaceRange.length)),t.unshift(c)}n+=i.newText.length-i.replaceRange.length}for(;;){let i=t[0];if(!i)break;t.shift(),r.push(i.delta(n))}return r}s(N0r,"applyEditsToRanges");d();d();var bU=class{static{s(this,"OffsetLineColumnConverter")}get lines(){return this._lineStartOffsets.length}constructor(e){this._lineStartOffsets=[0];let r=0;for(;r<e.length;){let n=e.charCodeAt(r);r++,(n===13||n===10)&&(n===13&&r<e.length&&e.charCodeAt(r)===10&&r++,this._lineStartOffsets.push(r))}}lineOffset(e){return this._lineStartOffsets[e-1]}offsetToPosition(e){let r=1;for(;r<this._lineStartOffsets.length&&!(this._lineStartOffsets[r]>e);r++);let n=e-this._lineStartOffsets[r-1];return new Wr(r,n+1)}startOffsetOfLineContaining(e){let r=1;for(;r<this._lineStartOffsets.length&&!(this._lineStartOffsets[r]>e);r++);return this._lineStartOffsets[r-1]}positionToOffset(e){return e.lineNumber>=this._lineStartOffsets.length?this._lineStartOffsets[this._lineStartOffsets.length-1]+e.column-1:this._lineStartOffsets[e.lineNumber-1]+e.column-1}};async function Wne(t,e,r,n=5e3){let i=await r.computeDiff(t,e,{maxComputationTimeMs:n,computeMoves:!1,ignoreTrimWhitespace:!1}),o=new bU(t),a=new bU(e),c=[];for(let l of i.changes)for(let u of l.innerChanges??[]){let f=a.positionToOffset(u.modifiedRange.getStartPosition()),p=a.positionToOffset(u.modifiedRange.getEndPosition()),m=e.substring(f,p),h=o.positionToOffset(u.originalRange.getStartPosition()),g=o.positionToOffset(u.originalRange.getEndPosition()),A=new Vt(h,g);c.push(new ld(A,m))}return new Uf(c)}s(Wne,"stringEditFromDiff");d();d();var fdt=require("worker_threads");var TSe=class{constructor(){this.nextId=1;this.handlers=new Map}static{s(this,"RpcResponseHandler")}createHandler(){let e=this.nextId++,r,n,i=new Promise((o,a)=>{r=o,n=a});return this.handlers.set(e,{resolve:r,reject:n}),{id:e,result:i}}handleResponse(e){let r=this.handlers.get(e.id);r&&(this.handlers.delete(e.id),e.err?r.reject(e.err):r.resolve(e.res))}handleError(e){for(let r of this.handlers.values())r.reject(e);this.handlers.clear()}clear(){this.handlers.clear()}};function M0r(t){let e={get:s((r,n)=>(typeof n=="string"&&!r[n]&&(r[n]=(...i)=>t(n,i)),r[n]),"get")};return new Proxy(Object.create(null),e)}s(M0r,"createRpcProxy");var jne=class{constructor(e,r,n){this.responseHandler=new TSe;this.worker=new fdt.Worker(e,r),this.worker.on("message",async i=>{if("fn"in i)try{let o=await n?.[i.fn].apply(n,i.args);this.worker.postMessage({id:i.id,res:o})}catch(o){let a=o instanceof Error?o:new Error(String(o));this.worker.postMessage({id:i.id,err:a})}else this.responseHandler.handleResponse(i)}),this.worker.on("error",i=>this.handleError(i)),this.worker.on("exit",i=>{i!==0&&this.handleError(new Error(`Worker thread exited with code ${i}.`))}),this.proxy=M0r((i,o)=>{if(!this.worker)throw new Error("Worker was terminated!");let{id:a,result:c}=this.responseHandler.createHandler();return this.worker.postMessage({id:a,fn:i,args:o}),c})}static{s(this,"WorkerWithRpcProxy")}async terminate(){this.worker.removeAllListeners(),await this.worker.terminate(),this.responseHandler.clear()}handleError(e){this.responseHandler.handleError(e)}};d();var Gne=class t{static{s(this,"MovedText")}constructor(e,r){this.lineRangeMapping=e,this.changes=r}flip(){return new t(this.lineRangeMapping.flip(),this.changes.map(e=>e.flip()))}};d();var IU=class t{static{s(this,"LineRangeMapping")}static inverse(e,r,n){let i=[],o=1,a=1;for(let l of e){let u=new t(new jr(o,l.original.startLineNumber),new jr(a,l.modified.startLineNumber));u.modified.isEmpty||i.push(u),o=l.original.endLineNumberExclusive,a=l.modified.endLineNumberExclusive}let c=new t(new jr(o,r+1),new jr(a,n+1));return c.modified.isEmpty||i.push(c),i}static clip(e,r,n){let i=[];for(let o of e){let a=o.original.intersect(r),c=o.modified.intersect(n);a&&!a.isEmpty&&c&&!c.isEmpty&&i.push(new t(a,c))}return i}constructor(e,r){this.original=e,this.modified=r}toString(){return`{${this.original.toString()}->${this.modified.toString()}}`}flip(){return new t(this.modified,this.original)}join(e){return new t(this.original.join(e.original),this.modified.join(e.modified))}get changedLineCount(){return Math.max(this.original.length,this.modified.length)}toRangeMapping(){let e=this.original.toInclusiveRange(),r=this.modified.toInclusiveRange();if(e&&r)return new S1(e,r);if(this.original.startLineNumber===1||this.modified.startLineNumber===1){if(!(this.modified.startLineNumber===1&&this.original.startLineNumber===1))throw new xn("not a valid diff");return new S1(new ir(this.original.startLineNumber,1,this.original.endLineNumberExclusive,1),new ir(this.modified.startLineNumber,1,this.modified.endLineNumberExclusive,1))}else return new S1(new ir(this.original.startLineNumber-1,Number.MAX_SAFE_INTEGER,this.original.endLineNumberExclusive-1,Number.MAX_SAFE_INTEGER),new ir(this.modified.startLineNumber-1,Number.MAX_SAFE_INTEGER,this.modified.endLineNumberExclusive-1,Number.MAX_SAFE_INTEGER))}toRangeMapping2(e,r){if(pdt(this.original.endLineNumberExclusive,e)&&pdt(this.modified.endLineNumberExclusive,r))return new S1(new ir(this.original.startLineNumber,1,this.original.endLineNumberExclusive,1),new ir(this.modified.startLineNumber,1,this.modified.endLineNumberExclusive,1));if(!this.original.isEmpty&&!this.modified.isEmpty)return new S1(ir.fromPositions(new Wr(this.original.startLineNumber,1),g8(new Wr(this.original.endLineNumberExclusive-1,Number.MAX_SAFE_INTEGER),e)),ir.fromPositions(new Wr(this.modified.startLineNumber,1),g8(new Wr(this.modified.endLineNumberExclusive-1,Number.MAX_SAFE_INTEGER),r)));if(this.original.startLineNumber>1&&this.modified.startLineNumber>1)return new S1(ir.fromPositions(g8(new Wr(this.original.startLineNumber-1,Number.MAX_SAFE_INTEGER),e),g8(new Wr(this.original.endLineNumberExclusive-1,Number.MAX_SAFE_INTEGER),e)),ir.fromPositions(g8(new Wr(this.modified.startLineNumber-1,Number.MAX_SAFE_INTEGER),r),g8(new Wr(this.modified.endLineNumberExclusive-1,Number.MAX_SAFE_INTEGER),r)));throw new xn}};function g8(t,e){if(t.lineNumber<1)return new Wr(1,1);if(t.lineNumber>e.length)return new Wr(e.length,e[e.length-1].length+1);let r=e[t.lineNumber-1];return t.column>r.length+1?new Wr(t.lineNumber,r.length+1):t}s(g8,"normalizePosition");function pdt(t,e){return t>=1&&t<=e.length}s(pdt,"isValidLineNumber");var Vne=class t extends IU{static{s(this,"DetailedLineRangeMapping")}static fromRangeMappings(e){let r=jr.join(e.map(i=>jr.fromRangeInclusive(i.originalRange))),n=jr.join(e.map(i=>jr.fromRangeInclusive(i.modifiedRange)));return new t(r,n,e)}constructor(e,r,n){super(e,r),this.innerChanges=n}flip(){return new t(this.modified,this.original,this.innerChanges?.map(e=>e.flip()))}withInnerChangesFromLineRanges(){return new t(this.original,this.modified,[this.toRangeMapping()])}},S1=class t{static{s(this,"RangeMapping")}static fromEdit(e){let r=e.getNewRanges();return e.replacements.map((i,o)=>new t(i.range,r[o]))}static fromEditJoin(e){let r=e.getNewRanges(),n=e.replacements.map((i,o)=>new t(i.range,r[o]));return t.join(n)}static join(e){if(e.length===0)throw new xn("Cannot join an empty list of range mappings");let r=e[0];for(let n=1;n<e.length;n++)r=r.join(e[n]);return r}static assertSorted(e){for(let r=1;r<e.length;r++){let n=e[r-1],i=e[r];if(!(n.originalRange.getEndPosition().isBeforeOrEqual(i.originalRange.getStartPosition())&&n.modifiedRange.getEndPosition().isBeforeOrEqual(i.modifiedRange.getStartPosition())))throw new xn("Range mappings must be sorted")}}constructor(e,r){this.originalRange=e,this.modifiedRange=r}toString(){return`{${this.originalRange.toString()}->${this.modifiedRange.toString()}}`}flip(){return new t(this.modifiedRange,this.originalRange)}toTextEdit(e){let r=e.getValueOfRange(this.modifiedRange);return new zd(this.originalRange,r)}join(e){return new t(this.originalRange.plusRange(e.originalRange),this.modifiedRange.plusRange(e.modifiedRange))}};var hdt=require("fs");var Gp=class{static{s(this,"DiffServiceImpl")}constructor(){this._worker=new Mh(()=>{let e=L0r([Ene(__dirname,"diffWorker.js"),Ene(__dirname,"../../../../../../../../dist/diffWorker.js")]);if(e===void 0)throw new Error("DiffServiceImpl: worker file not found");return new jne(e,{name:"Diff worker"})})}dispose(){this._worker.rawValue?.terminate()}async computeDiff(e,r,n){let i=await this._worker.value.proxy.computeDiff(e,r,n);return{identical:i.identical,quitEarly:i.quitEarly,changes:mdt(i.changes),moves:i.moves.map(a=>new Gne(new IU(new jr(a[0],a[1]),new jr(a[2],a[3])),mdt(a[4])))}}};function mdt(t){return t.map(e=>new Vne(new jr(e[0],e[1]),new jr(e[2],e[3]),e[4]?.map(r=>new S1(new ir(r[0],r[1],r[2],r[3]),new ir(r[4],r[5],r[6],r[7])))))}s(mdt,"toLineRangeMappings");function L0r(t){for(let e of t)if((0,hdt.existsSync)(e))return e}s(L0r,"firstExistingPath");d();var Kne=new dt("repository"),dE=class t{static{s(this,"GitBranchData")}constructor(e,r=!1){this.currentBranch=e,this.isDetachedHead=r}static detachedHead(){return new t(void 0,!0)}static branch(e){return new t(e,!1)}},rg=class{static{s(this,"GitBranchLoader")}},zne=class extends rg{constructor(r){super();this.loaders=r}static{s(this,"GitFallbackBranchLoader")}async getBranchInfo(r,n){for(let i of this.loaders){let o=await i.getBranchInfo(r,n);if(o)return o}}};var Yne=new dt("editSurvivalReporter"),wSe=class{constructor(e,r,n,i,o,a,c){this.ctx=e;this._document=r;this._documentTextBeforeMarkedEdits=n;this._documentTextAfterMarkedEdits=i;this._markedEdits=o;this._sendTelemetryEvent=a;this._customTimeouts=c;this._store=new td;this._editSurvivalTracker=new h8(this._documentTextBeforeMarkedEdits,this._markedEdits),this.captureInitialBranchInfo().then(()=>{this.setupTimeouts()}).catch(()=>{this.setupTimeouts()})}static{s(this,"BaseEditSurvivalReporter")}setupTimeouts(){if(this._store.isDisposed)return;let e=this._customTimeouts||[30*1e3,120*1e3,300*1e3,600*1e3];for(let r=0;r<e.length;r++){let n=r===e.length-1;this.scheduleReport(e[r],n?()=>this._store.dispose():void 0,r===0)}}async report(e){let r=await this.createEditSurvivalResult(this._editSurvivalTracker,e,this._readDocumentTimeMs,this._diffComputationTimeMs,this._arcTracker);this._sendTelemetryEvent(r)}_getLineCountInfo(){if(this._arcTracker)return this._arcTracker.getTrackedEditLineMetrics()}async triggerReport(e){await this.report(e)}get editSurvivalTracker(){return this._editSurvivalTracker}getInitializationTimings(){return{readDocumentTimeMs:this._readDocumentTimeMs,diffComputationTimeMs:this._diffComputationTimeMs}}async readCurrentDocument(){let e=await this.readCurrentDocumentWithTiming(this.ctx,this._document);return this._readDocumentTimeMs=e.readDocumentTimeMs,e.text}async captureInitialBranchInfo(){try{let e=wd(this._document.uri),r=this.ctx.get(rg);this._initialBranchInfo=await r.getBranchInfo(this.ctx,e)}catch(e){Yne.warn(this.ctx,"Failed to capture initial branch info",e),this._initialBranchInfo=void 0}}async checkBranchChange(){try{let e=wd(this._document.uri),n=await this.ctx.get(rg).getBranchInfo(this.ctx,e);if(!this._initialBranchInfo||!n)return 0;let i=this._initialBranchInfo.currentBranch,o=n.currentBranch,a=this._initialBranchInfo.isDetachedHead,c=n.isDetachedHead;return i!==o||a!==c?1:0}catch(e){return Yne.warn(this.ctx,"Failed to check branch change",e),0}}async createEditSurvivalResult(e,r,n,i,o){let a=e.computeTrackedEditsSurvivalScore(),c=await this.checkBranchChange(),l=this._getLineCountInfo(),u={fourGram:a.fourGram,noRevert:a.noRevert,timeDelayMs:r,didBranchChange:c,arc:o?.getAcceptedRetainedCharactersCount(),originalCharCount:o?.getOriginalCharacterCount(),currentLineCount:l?.insertedLineCounts,currentDeletedLineCount:l?.deletedLineCounts,originalLineCount:this._initialLineCounts?.insertedLineCounts,originalDeletedLineCount:this._initialLineCounts?.deletedLineCounts,currentFileContent:e.getCurrentText(),originalFileText:e.getOriginalText(),textAfterMarkedEdits:e.getTextAfterMarkedEdits(),debugLog:e.getDebugLog(),readDocumentTimeMs:n,diffComputationTimeMs:i};return{...u,currentLineCount:u.currentLineCount&&u.originalLineCount&&u.currentLineCount>u.originalLineCount?u.originalLineCount:u.currentLineCount,currentDeletedLineCount:u.currentDeletedLineCount&&u.originalDeletedLineCount&&u.currentDeletedLineCount>u.originalDeletedLineCount?u.originalDeletedLineCount:u.currentDeletedLineCount}}async readCurrentDocumentWithTiming(e,r){let n=performance.now(),i=await e.get(En).getOrReadTextDocument({uri:r.uri}),o=performance.now()-n;if(i.status!=="valid")throw new xn(`Document ${r.uri} is not valid, details ${JSON.stringify(i)}`);return{text:i.document.getText(),readDocumentTimeMs:o}}async computeDiffWithTiming(e,r,n){let i=performance.now(),o=await Wne(r,n,e.get(Gp)),a=performance.now()-i;return{edits:o,diffComputationTimeMs:a}}};var Jne=class extends wSe{static{s(this,"DiffBasedEditSurvivalReporter")}constructor(e,r,n,i,o,a,c){super(e,r,n,i,o,a,c),this._arcTracker=new m8(this._documentTextBeforeMarkedEdits,this._markedEdits),this._initialLineCounts=this._getLineCountInfo()}scheduleReport(e,r){let n=new s8(()=>{this.updateAndReport(e).then(()=>{n.dispose(),r&&r()}).catch(i=>{Yne.error(this.ctx,`DiffBasedEditSurvivalReporter: Failed to update and report at ${e}ms`,i),n.dispose(),r&&r()})},e);this._store.add(n)}cancel(){this._store.dispose()}async updateAndReport(e){try{let r=await this.readCurrentDocument();if(r!==this._documentTextAfterMarkedEdits){let n=await this.computeDiffWithTiming(this.ctx,this._documentTextAfterMarkedEdits,r);this._diffComputationTimeMs=n.diffComputationTimeMs,this._editSurvivalTracker=new h8(this._documentTextBeforeMarkedEdits,this._markedEdits),this._editSurvivalTracker.handleEdits(n.edits),this._arcTracker=new m8(this._documentTextBeforeMarkedEdits,this._markedEdits),this._arcTracker.handleEdits(n.edits)}else this._diffComputationTimeMs=void 0,this._editSurvivalTracker=new h8(this._documentTextBeforeMarkedEdits,this._markedEdits),this._arcTracker=new m8(this._documentTextBeforeMarkedEdits,this._markedEdits);await this.report(e)}catch(r){throw Yne.error(this.ctx,`Failed to update and report at ${e}ms for document ${this._document.uri}`,r),r}}};var gdt=new dt("editSurvivalTrackerService"),_1=class{constructor(e){this.ctx=e}static{s(this,"EditSurvivalTrackerService")}initialize(e,r,n){gdt.debug(this.ctx,`Initializing edit survival tracking for document uri: ${e.uri}`);let i;return{startReporter:s(o=>{(async()=>{try{let a=await Wne(r,n,this.ctx.get(Gp));i=new Jne(this.ctx,e,r,n,a,o,[0,30*1e3,120*1e3,300*1e3,600*1e3])}catch(a){gdt.error(this.ctx,`Failed to initialize EditSurvivalReporter: ${Rx(a)}`,a)}})()},"startReporter"),cancel:s(()=>{i?.cancel()},"cancel")}}};d();var ic=class extends Error{static{s(this,"CanceledError")}constructor(){super("Canceled"),this.name="Canceled"}};var F0r=1e3,O0r={modelId:"gpt-4o-instant-apply-full-ft-v66",uiName:"gpt-4o-instant-apply-full-ft-v66",modelFamily:$r.Gpt4oMini,maxRequestTokens:128e3,maxResponseTokens:16e3,baseTokensPerCompletion:3,baseTokensPerMessage:3,baseTokensPerName:1,tokenizer:"o200k_base",isExperimental:!1,stream:!0,toolCalls:!1},A8=class{static{s(this,"CodeMapper")}constructor(e){this.ctx=e,this.logger=new dt("codeMapper")}async mapCode(e,r,n,i,o,a=!1,c){if(!e.resource)throw new I1("No uri found in code block");if(i.isCancellationRequested)throw new Qw;e.code.includes(Al)||this.logger.debug(this.ctx,`Code block for uri ${e.resource} does not contain existing code marker`);let l=await this.ctx.get(En).getOrReadTextDocument({uri:e.resource});if(l.status==="notfound")return o&&await this.reportCodeBlock(e,o),{code:e.code};if(l.status==="invalid"){let R=`Failed to find file ${e.resource} with status ${l.status} and reason ${l.reason}`,B=new I1(R);throw this.logger.error(this.ctx,R,B),B}let u=l.document.getText();if(u.length===0&&!e.code.includes(Al))return o&&await this.reportCodeBlock(e,o),{code:e.code};let f=new hU({documentContext:{document:l},codeBlock:e.code,uri:e.resource,markdownBeforeBlock:e.markdownBeforeBlock,textDocumentProvider:new aE(this.ctx)}),p=this.ctx.get(_1),m=await f.render();m=f.transformToFastApplyMessage(m),o&&await o({fileGenerationStatus:"edit-plan-generated",uri:e.resource,basename:Pi(e.resource),editDescription:e.markdownBeforeBlock});let h=await this.ctx.get(ar).getToken(),g=await this.ctx.get(Mt).updateExPValuesAndAssignments(h),A=ty(),y=[],E=0,b=0,S=u.length+e.code.length+F0r;for(;;){let R={copilotApiProvider:"proxy",modelConfiguration:O0r,messages:m,uiKind:a?"agentPanel":"editsPanel",temperature:0,llmInteraction:r,prediction:{type:"content",content:u},copilotEditsSessionHeader:c};this.logger.debug(this.ctx,`Send map code request ${A} in iteration ${b} with params: ${JSON.stringify(R,null,2)}`);let L=await this.ctx.get(Ps).fetchResponse(R,i,g);if(this.logger.debug(this.ctx,`Received map code response ${A} in iteration ${b} with result: ${JSON.stringify(L,null,2)}`),E=this.calculateResponseLength(L,y,E),L.type==="length"){if(E>S)throw new I1(`Code mapper might be in a loop: Rewritten length: ${E}, Document length: ${u.length}, Code block length ${e.code.length}`);m=await new hU({documentContext:{document:l},codeBlock:e.code,uri:e.resource,markdownBeforeBlock:e.markdownBeforeBlock,textDocumentProvider:new aE(this.ctx),inProgressRewriteContent:L.truncatedValue}).render()}else if(L.type==="success"){let O=y.join("");if(O){o&&await o({fileGenerationStatus:"updated-code-generated",uri:e.resource,basename:Pi(e.resource),partialText:O,languageId:l.document.detectedLanguageId,markdownCodeFence:a8(O)});let Y=p.initialize(l.document,u,O);return{code:O,editSurvivalTrackingSession:Y,telemetry:{requestSource:n.chatRequestSource,chatRequestModel:n.chatRequestModel,mapper:"gpt-4o-instant-apply-full-ft-v66",headerRequestId:L.requestId}}}else{let Y=`No valid completion found for uri ${e.resource}`;throw new I1(Y)}}else{if(L.type==="canceled")throw new ic;{let O=`Failed to map code for uri ${e.resource} with result type ${L.type}`;throw this.logger.error(this.ctx,O,L),new I1(O)}}b+=1}}calculateResponseLength(e,r,n){return e.type==="success"?(r.push(e.value),n+=e.value.length):e.type==="length"&&(r.push(e.truncatedValue),n+=e.truncatedValue.length),n}async reportCodeBlock(e,r){await r({fileGenerationStatus:"edit-plan-generated",uri:e.resource,basename:Pi(e.resource),editDescription:e.markdownBeforeBlock}),await r({fileGenerationStatus:"updated-code-generated",partialText:e.code,uri:e.resource,basename:Pi(e.resource)})}};d();var Kd=class extends Error{constructor(r){super(r.message);this.editConversationError=r;this.name="EditConversationException"}static{s(this,"EditConversationException")}};d();d();var Uw=class{static{s(this,"CapiErrorTranslator")}static translateErrorMessage(e,r){switch(e){case 466:return"Oops, your plugin is out of date. Please update it.";case 401:return"Oops, you are not authorized. Please sign in. If you are using a custom model, please check if the API key is still valid.";case 402:return r||"Oops, you need to upgrade your plan.";case 413:return"Oops, your request is too large. Please try again with a smaller input.";case 429:return"Oops, you reached the rate limit. Please try again later.";case 503:return r||"Oops, the service is currently unavailable. Please try again later.";default:return"Sorry, an error occurred while generating a response."}}};d();d();var Xne=class extends Error{static{s(this,"EditTurnNotFoundException")}constructor(e){super(e),this.name="EditTurnNotFoundException"}};var qw=class{constructor(e,r){this.request=e;this.id=br();this.timestamp=Date.now();this.status="in-progress";this.workingSet=[];r&&r.length>0&&(this.workingSet=r)}static{s(this,"EditTurn")}},SSe=class{constructor(e=[]){this.turns=[];this.turns=e}static{s(this,"EditTurnManager")}addTurn(e){this.turns.push(e)}deleteTurn(e){this.turns=this.turns.filter(r=>r.id!==e)}getLastTurn(){if(this.turns.length!==0)return this.turns[this.turns.length-1]}hasTurn(e){return this.turns.some(r=>r.id===e)}getTurns(){return[...this.turns]}},Zne=class{constructor(e=[],r="panel",n="en"){this._id=br();this._timestamp=Date.now();this.source="panel";this.userLanguage="en";this.source=r,this.userLanguage=n,this.turnsManager=new SSe(e)}static{s(this,"EditConversation")}get id(){return this._id}get timestamp(){return this._timestamp}getUserLanguage(){return this.userLanguage}getTurns(){return this.turnsManager.getTurns()}getSource(){return this.source}addTurn(e){this.turnsManager.addTurn(e)}deleteTurn(e){this.turnsManager.deleteTurn(e)}getLastTurn(){let e=this.turnsManager.getLastTurn();if(e===void 0)throw new Xne(`No turns in the conversation ${this._id}`);return e}hasTurn(e){return this.turnsManager.hasTurn(e)}};var eie=class{static{s(this,"EditCodeResultProcessor")}static processResult(e,r){switch(r.type){case"success":return r.value;case"offTopic":{e.currentTurn.status="off-topic";let n="Sorry, but I can only assist with programming related questions.";throw e.currentTurn.response={message:n,type:"offtopic-detection"},new Kd({message:n,responseIsFiltered:!0})}case"canceled":throw e.currentTurn.status="cancelled",e.currentTurn.response={message:OT,type:"user"},new Kd({message:OT});case"failed":throw e.currentTurn.status="error",e.currentTurn.response={message:r.reason,type:"server"},new Kd({message:Uw.translateErrorMessage(r.code,r.reason),code:r.code});case"filtered":throw e.currentTurn.status="filtered",new Kd({message:"Oops, your response got filtered.",responseIsFiltered:!0});case"length":throw e.currentTurn.status="error",new Kd({message:"Oops, the response got too long. Try to reformulate your question.",responseIsIncomplete:!0});case"agentAuthRequired":throw e.currentTurn.status="error",e.currentTurn.response={message:"Authorization required",type:"server"},new Kd({message:"Authorization required",responseIsFiltered:!1});case"no_choices":throw e.currentTurn.status="error",e.currentTurn.response={message:"No choices returned",type:"server"},new Kd({message:"Oops, no choices received from the server. Please try again.",responseIsFiltered:!1,responseIsIncomplete:!0});case"no_finish_reason":throw e.currentTurn.status="error",e.currentTurn.response={message:"No finish reason",type:"server"},new Kd({message:"Oops, unexpected end of stream. Please try again.",responseIsFiltered:!1,responseIsIncomplete:!0});case"model_not_supported":throw e.currentTurn.status="error",e.currentTurn.response={message:"Model not supported",type:"server"},new Kd({message:"Oops, the model is not supported. Please try again.",code:400,reason:"model_not_supported",responseIsFiltered:!1});case"model_max_prompt_tokens_exceeded":throw e.currentTurn.status="error",e.currentTurn.response={message:"Model max prompt tokens exceeded",type:"server"},new Kd({message:"Oops, the token limit exceeded. Try to shorten your prompt or start a new conversation.",code:400,reason:"model_max_prompt_tokens_exceeded",responseIsFiltered:!1});case"successMultiple":case"tool_calls":case"unknown":throw e.currentTurn.status="error",new Kd({message:"Unknown server side error occurred. Please try again.",responseIsFiltered:!1})}}};d();async function*ydt(t){yield Promise.resolve(t)}s(ydt,"stringToAsyncIterable");d();d();var fE=class{static{s(this,"CopilotEditsPromptUriUtils")}static pathToUri(e,r){let n=e.mapToUriInWorkingSet(r);return n||kl(r)}static uriToPath(e){let r=ts(e);if(r)return r;throw new Error(`Unsupported URI scheme: ${e.split(":")[0]}`)}static posixFilePathToUri(e){return process.platform==="win32"?`file:///c:${e}`:`file://${e}`}};var tie=class{constructor(e){this.props=e;this.exampleFilePath=this.getExampleFilePath("/path/to/file"),this.tsExampleFilePath=this.getExampleFilePath("/Users/someone/proj01/example.ts")}static{s(this,"EditCodePrompt")}async render(){let e=await this.getValidFilesInWorkingSet(),r=[{role:"system",content:this.buildSystemMessage(e)}];if(this.props.history&&this.props.history.length>0)for(let i of this.props.history)r.push({role:"user",content:i.request.message}),i.response&&i.response.type==="model"&&r.push({role:"assistant",content:i.response.message});let n=await ey.appendToUserMessage(this.props.ctx,this.props.workspaceFolder?[{uri:this.props.workspaceFolder}]:[],this.buildUserMessage(e),{includeCodeGenerationInstructions:!0,includeCommitMessageGenerationInstructions:!1},[]);return r.push({role:"user",content:n}),r}getExampleFilePath(e){return this.getFilePath(fE.posixFilePathToUri(e))}getFilePath(e){return fE.uriToPath(e)}async getValidFilesInWorkingSet(){let e=new Map;if(this.props.workingSet===void 0||this.props.workingSet===null||this.props.workingSet.length===0)return e;for(let r of this.props.workingSet){let n=await this.props.textDocumentProvider.getByUri(r.uri);n.status==="valid"&&e.set(r.uri,n.document)}return e}buildSystemMessage(e){let r=[];return r.push("You are an AI programming assistant.",'When asked for your name, you must respond with "GitHub Copilot".',"Follow the user's requirements carefully & to the letter.","Follow Microsoft content policies.","Avoid content that violates copyrights.",`If you are asked to generate content that is harmful, hateful, racist, sexist, lewd, violent, or completely irrelevant to software engineering, only respond with "Sorry, I can't assist with that."`,"Keep your answers short and impersonal.",e.size>0?"The user has a request for modifying one or more files.":["If the user asks a question, then answer it.",`If you need to change existing files and it's not clear which files should be changed, then refuse and answer with "Please add the files to be modified to the working set"`].join(`
`),"1. Please come up with a solution that you first describe step-by-step.","2. Group your changes by file. Use the file path as the header.","3. For each file, give a short summary of what needs to be changed followed by a code block that contains the code changes.","4. Each file's code block must start with a comment containing the filepath.","5. Use a single code block per file that needs to be modified, even if there are multiple changes for a file.","6. The user is very smart and can understand how to merge your code blocks into their files, you just need to provide minimal hints.","7. Avoid repeating existing code, instead use comments to represent regions of unchanged code. The user prefers that you are as concise as possible. For example: ",["<file>","````languageId",`// ${mU} ${this.exampleFilePath}`,`// ${Al}`,"{ changed code }",`// ${Al}`,"{ changed code }",`// ${Al}`,"````","</file>"].join(`
`),"8. If you generate edits for a Markdown file, use four backticks for the outer code block.",""),this.props.userLanguage&&r.push(`Respond in the following locale: ${this.props.userLanguage}`),this.props.modelName&&r.push(`You use the ${this.props.modelName} large language model.`),r.push("Here is an example of how you should format a code block belonging to the file example.ts in your response:","<example>",[`### ${this.tsExampleFilePath}`,"","Add a new property 'age' and a new method 'getAge' to the class Person.","","<file>","```typescript",`// ${mU} ${this.tsExampleFilePath}`,"class Person {",`   // ${Al}`,"   age: number;",`   // ${Al}`,"   getAge() {","      return this.age;","   }","}","```","</file>"].join(`
`),"</example>"),r.join(`
`)}buildUserMessage(e){let r=[];if(e.size>0){r.push("The user has provided the following files as input. Always make changes to these files unless the user asks to create a new file.","Untitled files are files that are not yet named. Make changes to them like regular files.");for(let[n,i]of e){let o=new cm({code:i.getText(),languageId:i.detectedLanguageId,uri:n});r.push("<file>",...o.renderAsArray(),"</file>")}}return r.push("<reminder>",`Avoid repeating existing code, instead use a line comment with \`${Al}\` to represent regions of unchanged code.`,"Each file's code block must start with a line comment containing the filepath. This includes Markdown files.","For existing files, make sure the filepath exactly matches the filepath of the original file."),this.props.workspaceFolder&&r.push(`When suggesting to create new files, pick a location inside \`${this.getFilePath(this.props.workspaceFolder)}\``),r.push("</reminder>"),r.push("<prompt>",`${this.props.userMessage}`,"</prompt>"),r.join(`
`)}};d();d();var rie=class{constructor(e){this._source=e;this._buffer="";this._atEnd=!1}static{s(this,"PartialAsyncTextReader")}get endOfStream(){return this._buffer.length===0&&this._atEnd}async extendBuffer(){if(this._atEnd)return;let{value:e,done:r}=await this._source.next();r?this._atEnd=!0:this._buffer+=e}async waitForLength(e){for(;this._buffer.length<e&&!this._atEnd;)await this.extendBuffer()}async peek(e){return await this.waitForLength(e),this._buffer.substring(0,e)}async read(e){await this.waitForLength(e);let r=this._buffer.substring(0,e);return this._buffer=this._buffer.substring(e),r}async readUntil(e){let r="";for(;!this.endOfStream;){let n=this.readImmediateExcept(e);if(r+=n,await this.peek(1)===e)break}return r}async readLineIncludingLF(){let e=await this.readUntil(`
`);return e+=await this.read(1),e}async readLine(){let e=await this.readUntil(`
`);return await this.read(1),e}readImmediateExcept(e){let r=this._buffer.indexOf(e);return this.readImmediate(r===-1?this._buffer.length:r)}readImmediate(e){let r=this._buffer.substring(0,e);return this._buffer=this._buffer.substring(e),r}};var _Se="<file>",TU="```",SU="###",U0r=/^(`+)([^ \n]*)/,wU="filepath:";async function*vdt(t,e){let r=new rie(t[Symbol.asyncIterator]()),n=[];for(;!r.endOfStream;){for(;!r.endOfStream;){let A=await r.peek(Math.max(TU.length,_Se.length,SU.length));if(A.startsWith(_Se)||A.startsWith(TU))break;if(A.startsWith(SU)){let y=await r.readLineIncludingLF(),E=y.substring(SU.length).trim();e(E)?n.length=0:n.push(y)}else await Cdt(r,n)}if(r.endOfStream)break;let i=await r.readLineIncludingLF(),o=i.startsWith(_Se);for(;!r.endOfStream&&!i.startsWith(TU);)i=await r.readLineIncludingLF();if(r.endOfStream)break;let a=i.match(U0r),c=a?a[2]:void 0,l=GJe(c?WJe(c):void 0),u=[`${l.lineComment.start} ${wU}`,`:: ${wU}`,`<!-- ${wU}`,`// ${wU}`,`# ${wU}`],f=Math.max(...u.map(A=>A.length)),p=l.lineComment.end??"",m="</file>",h,g=[];for(;!r.endOfStream;){let A=await r.peek(Math.max(TU.length,f));if(A.startsWith(TU)){let y=await r.readLineIncludingLF();if(!o)break;if(await r.peek(m.length)===m){await r.readLineIncludingLF();break}else{g.push(y);continue}}if(!h&&u.some(y=>A.startsWith(y))){let y=await r.readLineIncludingLF(),E=u.reduce((b,S)=>A.startsWith(S)?y.substring(S.length):b,y);E=E.split("-->")[0].trim(),E.endsWith(p)&&(E=E.substring(0,E.length-p.length)),E=E.trim(),h=e(E);continue}await Cdt(r,g)}yield{resource:h,language:c,code:g.join(""),markdownBeforeBlock:n.join("")},n.length=0}}s(vdt,"getCodeBlocksFromResponse");async function Cdt(t,e){for(;!t.endOfStream;){let r=t.readImmediateExcept(`
`);if(r.length>0&&e?.push(r),await t.peek(1)===`
`){t.readImmediate(1),e?.push(`
`);break}}}s(Cdt,"pipeOneLine");function xdt(t){if(t.startsWith(`${SU} `))return"";let e=t.indexOf(`
${SU} `);return e===-1?"":t.substring(0,e)+`
`}s(xdt,"parseOverallDescription");d();d();var nie=class extends Error{static{s(this,"EditConversationNotFoundException")}constructor(e){super(e),this.name="EditConversationNotFoundException"}};var q0r=new dt("CopilotEditsConversations"),Cl=class{constructor(e){this.editConversations=new Sr(50);this.ctx=e}static{s(this,"EditConversations")}create(e="panel",r){let n=new Zne([],e,r);return this.editConversations.set(n.id,n),n}destroy(e){this.editConversations.delete(e)!==!0&&q0r.warn(this.ctx,`Edit code conversation ${e} does not exist`)}addTurn(e,r){return this.get(e).addTurn(r),r}deleteTurn(e,r){this.get(e).deleteTurn(r)}get(e){return this.getEditConversation(e)}getEditConversation(e){let r=this.editConversations.get(e);if(!r)throw new nie(`Conversation with id ${e} does not exist`);return r}getAll(){return Array.from(this.editConversations.values())}findByTurnId(e){let r=this.getAll();for(let n of r)if(n.hasTurn(e))return n}};var H0r=new dt("copilotEditsService"),pE=class{constructor(e,r){this.chatFetcher=r;this.ctx=e,this.chatFetcher=this.chatFetcher??new Ps(e)}static{s(this,"CopilotEditsService")}async createOrContinueEditConversation(e,r){try{await this.reportBegin(e);let n=await this.getEditCodeResult(e,r),i=eie.processResult(e,n);await this.parseAndSendProgressBack(e,i,r),e.currentTurn.response={message:i,type:"model"},e.currentTurn.status="success",await this.reportEnd(e)}catch(n){if(n instanceof Qw)await this.reportEnd(e,{message:OT});else if(n instanceof Kd)await this.reportEnd(e,n.editConversationError);else{let i=n instanceof Error?n.message:String(n);e.currentTurn.status="error",e.currentTurn.response={message:i,type:"meta"},await this.reportEnd(e,{message:i})}}return[]}async getEditCodeResult(e,r){this.abortIfCancelled(e,r);let n=await this.buildEditCodePromptMessages(e),i=await this.ctx.get(ar).getToken(),o=await this.ctx.get(Mt).updateExPValuesAndAssignments(i);this.abortIfCancelled(e,r);let a=e.userSelectedModelProviderName&&e.userSelectedModel?await Dw(this.ctx,e.userSelectedModelProviderName,e.userSelectedModel):await Wo.getModelConfiguration(this.ctx,"edits",e.userSelectedModel),c=Wo.transformMessages(n,a.modelFamily);return this.abortIfCancelled(e,r),await this.chatFetcher.fetchResponse({modelConfiguration:a,messages:c,uiKind:"editsPanel",intentParams:{intent:!0},temperature:.1,llmInteraction:e.toLlmInteraction()},r,o)}async buildEditCodePromptMessages(e){let r=e.currentTurn,n=e.userSelectedModelProviderName&&e.userSelectedModel?"customized":(await Wo.getModelConfiguration(this.ctx,"edits",e.userSelectedModel)).uiName,i=e.editConversation.getTurns(),o=i.length>1?i.slice(0,-1):[];return await new tie({userMessage:r.request.message,workspaceFolder:r.workspaceFolder,workingSet:r.workingSet,userLanguage:e.editConversation.getUserLanguage(),textDocumentProvider:new aE(this.ctx),modelName:n,history:o,ctx:this.ctx}).render()}abortIfCancelled(e,r){if(r.isCancellationRequested)throw e.currentTurn.status="cancelled",e.currentTurn.response={message:OT,type:"user"},new Qw;this.ctx.get(Cl).get(e.editConversationId)}async parseAndSendProgressBack(e,r,n){try{let i=ydt(r),o=new A8(this.ctx),a=s(u=>fE.pathToUri(e,u),"createUri"),c=[],l=xdt(r);l&&await this.ctx.get(cd).reportTurn(e,{fileGenerationStatus:"overall-description-generated",editDescription:l}),this.abortIfCancelled(e,n);for await(let u of vdt(i,a)){let f=o.mapCode(u,e.toLlmInteraction(),{chatRequestSource:e.editConversation.getSource()},n,async p=>{await this.ctx.get(cd).reportTurn(e,p)}).then(async p=>(p.editSurvivalTrackingSession&&u.resource&&await this.startEditSurvivalTrackingWithSession(e,u.resource,p.editSurvivalTrackingSession,p.telemetry),p));c.push(f)}await Promise.all(c),c.length===0&&await this.reportNoCodeBlocks(e,r)}catch(i){if(i instanceof I1||i instanceof G3)e.currentTurn.status="error",e.currentTurn.response={message:i.message,type:"meta"},await this.reportEnd(e,{message:i.message});else if(i instanceof Qw)e.currentTurn.status="cancelled",e.currentTurn.response={message:OT,type:"user"},await this.reportEnd(e,{message:OT});else throw i}}async reportNoCodeBlocks(e,r){await this.ctx.get(cd).reportTurn(e,{fileGenerationStatus:"no-code-blocks-found",rawResponse:r})}async reportBegin(e){await this.ctx.get(cd).reportTurn(e,{fileGenerationStatus:"edit-conversation-begin"})}async reportEnd(e,r){await this.ctx.get(cd).reportTurn(e,{fileGenerationStatus:"edit-conversation-end",error:r})}async startEditSurvivalTrackingWithSession(e,r,n,i){try{let o=TT({uri:r,languageId:"UNKNOWN"}),a=await this.ctx.get(ar).getToken(),c=await this.ctx.get(Mt).updateExPValuesAndAssignments(a);n.startReporter(l=>{this.handleEditSurvivalTelemetry(e,l,c,o,i)})}catch(o){let a=e?.editConversationId||"unknown",c=e?.currentTurn?.id||"unknown",l=r||"unknown";H0r.warn(this.ctx,`Failed to start edit survival tracking for file '${l}' in conversation '${a}', turn '${c}'.`,o)}}handleEditSurvivalTelemetry(e,r,n,i,o){FX(this.ctx,"editsPanel",{requestSource:o?.requestSource??e.editConversation.getSource(),chatRequestModel:o?.chatRequestModel??"",mapper:o?.mapper??"",headerRequestId:o?.headerRequestId??"",mode:"edit",modelId:e.userSelectedModel??"unknown",languageId:i},{survivalRateFourGram:r.fourGram,survivalRateNoRevert:r.noRevert,timeDelayMs:r.timeDelayMs,didBranchChange:r.didBranchChange,readDocumentTimeMs:r.readDocumentTimeMs??-1,diffComputationTimeMs:r.diffComputationTimeMs??-1,arc:r.arc??-1,originalCharCount:r.originalCharCount??-1,currentLineCount:r.currentLineCount??-1,currentDeletedLineCount:r.currentDeletedLineCount??-1,originalLineCount:r.originalLineCount??-1,originalDeletedLineCount:r.originalDeletedLineCount??-1},{currentFileContent:r.currentFileContent},n,"codeMapper.trackEditSurvival")}};d();var y8=class extends df{constructor(r,n={}){super();this.env=n;this.recalculateUrlDefaults(r,this.getDefaultUrls())}static{s(this,"DefaultNetworkConfiguration")}getAuthAuthority(){return this.baseUrlObject.hostname}getConfiguredUrls(){return{serverUrl:this.baseUrlObject.href,apiUrl:this.apiUrl}}setConfiguredUrls(r,n){let i=this.getConfiguredUrls();this.recalculateUrlDefaults(r,n);let o=this.getConfiguredUrls();(i.apiUrl!==o.apiUrl||i.serverUrl!==o.serverUrl)&&r.get(ar).resetToken(),r.get(Md).updateSessionConfig(o)}recalculateUrlDefaults(r,n){let{serverUrl:i,apiUrl:o}=T0({serverUrl:Sj(r,n.serverUrl),apiUrl:Sj(r,n.apiUrl)});this.baseUrlObject=new URL(i),this.apiUrl=o}getDefaultUrls(){return this.env.CODESPACES==="true"&&this.env.GITHUB_TOKEN&&this.env.GITHUB_SERVER_URL&&this.env.GITHUB_API_URL&&!this.env.GITHUB_COPILOT_TOKEN&&!this.env.GH_COPILOT_TOKEN?{apiUrl:this.env.GITHUB_API_URL,serverUrl:this.env.GITHUB_SERVER_URL}:{}}};d();var SRi=new dt("exp");function bdt(t){let e=t.get(Mt);e.registerStaticFilters(j0r(t)),e.registerDynamicFilter("X-Copilot-OverrideEngine",()=>zi(t,Ht.DebugOverrideEngine)||zi(t,Ht.DebugOverrideEngineLegacy)),e.registerDynamicFilter("X-VSCode-ExtensionName",()=>OW()?"copilot-web":t.get(cn).getEditorPluginInfo().name),e.registerDynamicFilter("X-VSCode-ExtensionVersion",()=>Edt(t)),e.registerDynamicFilter(F4.CopilotRelatedPluginVersionGithubCopilot,()=>Edt(t)),e.registerDynamicFilter("X-VSCode-ExtensionRelease",()=>$0r(t)),e.registerDynamicFilter("X-VSCode-Build",()=>t.get(cn).getEditorInfo().name),e.registerDynamicFilter("X-VSCode-AppVersion",()=>iie(t.get(cn).getEditorInfo().version)),e.registerDynamicFilter("X-VSCode-TargetPopulation",()=>W0r(t)),e.registerDynamicFilterGroup(()=>{let r={};for(let n of t.get(cn).getRelatedPluginInfo()){let i=rp+n.name.replace(/[^A-Za-z]/g,"").toLowerCase();if(!Object.values(F4).includes(i)){Rj(t,{reason:`A filter could not be registered for the unrecognized related plugin "${n.name}".`});continue}r[i]=iie(n.version)}return r}),e.registerDynamicFilterGroup(()=>{let r={};for(let n of t.get(cn).getEditorPluginSpecificFilters()){let i=n.isVersion?iie(n.value):n.value;r[n.filter]=i}return r})}s(bdt,"setupExperimentationService");function Edt(t){return iie(!t.get(To).isProduction()&&t.get(cn).getEditorPluginInfo().name==="copilot"?"1.999.0":t.get(cn).getEditorPluginInfo().version)}s(Edt,"getEditorPluginVersion");function $0r(t){let e=t.get(cn).getEditorPluginInfo();return e.name==="copilot"&&AC(t)==="nightly"||e.name==="copilot-intellij"&&e.version.endsWith("nightly")?"nightly":"stable"}s($0r,"getPluginRelease");function W0r(t){let e=t.get(cn).getEditorInfo();return e.name==="vscode"&&e.version.endsWith("-insider")?"insider":"public"}s(W0r,"getTargetPopulation");function j0r(t){return G0r(t)}s(j0r,"createAllFilters");function G0r(t){let e=t.get(Ms);return{"X-MSEdge-ClientId":e.machineId,"X-Copilot-ClientVersion":t.get(To).isProduction()?s2(t):"1.999.0"}}s(G0r,"createDefaultFilters");function iie(t){return t.split("-")[0]}s(iie,"trimVersionSuffix");d();var _U=(r=>(r.enabled="enabled",r.disabled="disabled",r))(_U||{}),$k=Symbol("onMCPToolsListChanged"),ng=class{static{s(this,"McpManager")}};d();var ny=class{static{s(this,"McpRuntimeNotifier")}},oie=class extends ny{static{s(this,"NoOpMcpRuntimeNotifier")}async notifyLog(e){}};d();var C8=class{static{s(this,"AbstractCopilotMessageSender")}};d();d();d();var RSe=class{constructor(e,r){this.baseDebounceTime=e;this.expectedTotalTime=r;this.providerInvocationTime=Date.now()}static{s(this,"DelaySession")}getDebounceTime(){let e=this.expectedTotalTime===void 0?this.baseDebounceTime:Math.min(this.baseDebounceTime,this.expectedTotalTime),r=Date.now()-this.providerInvocationTime;return Math.max(0,e-r)}getArtificalDelay(){if(this.expectedTotalTime===void 0)return 0;let e=Date.now()-this.providerInvocationTime;return Math.max(0,this.expectedTotalTime-e)}},sie=class{constructor(){this._recentUserActions=[]}static{s(this,"Delayer")}createDelaySession(){let n=this._getExpectedTotalTime(200);return new RSe(200,n)}handleAcceptance(){this._recordUserAction("accepted")}handleRejection(){this._recordUserAction("rejected")}_recordUserAction(e){this._recentUserActions.push({time:Date.now(),kind:e}),this._recentUserActions=this._recentUserActions.slice(-10)}_getExpectedTotalTime(e){let c=Date.now(),l=1;for(let f of this._recentUserActions){let p=c-f.time;if(p>6e5)continue;let m=Math.exp(-p/6e5),h=f.kind==="rejected"?1.5:.8;l*=1+(h-1)*m}let u=e*l;return u=Math.min(3e3,Math.max(50,u)),u}};d();d();d();var gs;(n=>{function t(i){return new kSe(i)}n.ok=t,s(t,"ok");function e(i){return new PSe(i)}n.error=e,s(e,"error");function r(i){return n.error(new Error(i))}n.fromString=r,s(r,"fromString")})(gs||={});var kSe=class t{constructor(e){this.val=e}static{s(this,"ResultOk")}map(e){return new t(e(this.val))}flatMap(e){return e(this.val)}isOk(){return!0}isError(){return!1}},PSe=class{constructor(e){this.err=e}static{s(this,"ResultError")}map(e){return this}flatMap(e){return this}isOk(){return!1}isError(){return!0}};d();var aie=class t{constructor(e){this._indexMap=e}static{s(this,"Permutation")}get arrayLength(){return this._indexMap.length}static createSortPermutation(e,r){let n=Array.from(e.keys()).sort((i,o)=>r(e[i],e[o]));return new t(n)}apply(e){if(e.length!==this.arrayLength)throw n7(`Permutation must be applied on an array of same length. Received length: ${e.length}. Expected length: ${this.arrayLength}`);return e.map((r,n)=>e[this._indexMap[n]])}mapIndexBack(e){let r=this._indexMap.at(e);if(r===void 0)throw n7(`Given index must be within original array length. Received: ${e}. Expected: 0 <= x < ${this.arrayLength}`);return r}inverse(){let e=this._indexMap.slice();for(let r=0;r<this._indexMap.length;r++)e[this._indexMap[r]]=r;return new t(e)}};d();d();var $U=Be(Aa());function Qft(t){return t.map(Kmr).join(`
`)}s(Qft,"stringifyChatMessages");function Kmr({role:t,content:e}){if(t!==$U.Raw.ChatRole.User&&t!==$U.Raw.ChatRole.System)return"omitted because of non-user and non-system role";let r=t===$U.Raw.ChatRole.User?"User":"System",n=e.at(0);return n?.type!==$U.Raw.ChatCompletionContentPartKind.Text?"omitted because of non-text content":`${r}
------
${n.text}
==================`}s(Kmr,"stringifyMessage");d();d();var Ymr=/^\w[\w\d+.-]*$/,Jmr=/^\//,Xmr=/^\/\//;function Zmr(t,e){if(!t.scheme&&e)throw new Error(`[UriError]: Scheme is missing: {scheme: "", authority: "${t.authority}", path: "${t.path}", query: "${t.query}", fragment: "${t.fragment}"}`);if(t.scheme&&!Ymr.test(t.scheme))throw new Error("[UriError]: Scheme contains illegal characters.");if(t.path){if(t.authority){if(!Jmr.test(t.path))throw new Error('[UriError]: If a URI contains an authority component, then the path component must either be empty or begin with a slash ("/") character')}else if(Xmr.test(t.path))throw new Error('[UriError]: If a URI does not contain an authority component, then the path cannot begin with two slash characters ("//")')}}s(Zmr,"_validateUri");function ehr(t,e){return!t&&!e?"file":t}s(ehr,"_schemeFix");function thr(t,e){switch(t){case"https":case"http":case"file":e?e[0]!==cy&&(e=cy+e):e=cy;break}return e}s(thr,"_referenceResolution");var Bs="",cy="/",rhr=/^(([^:/?#]+?):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?/,Xw=class t{static{s(this,"URI")}static isUri(e){return e instanceof t?!0:e?typeof e.authority=="string"&&typeof e.fragment=="string"&&typeof e.path=="string"&&typeof e.query=="string"&&typeof e.scheme=="string"&&typeof e.fsPath=="string"&&typeof e.with=="function"&&typeof e.toString=="function":!1}constructor(e,r,n,i,o,a=!1){typeof e=="object"?(this.scheme=e.scheme||Bs,this.authority=e.authority||Bs,this.path=e.path||Bs,this.query=e.query||Bs,this.fragment=e.fragment||Bs):(this.scheme=ehr(e,a),this.authority=r||Bs,this.path=thr(this.scheme,n||Bs),this.query=i||Bs,this.fragment=o||Bs,Zmr(this,a))}get fsPath(){return I_e(this,!1)}with(e){if(!e)return this;let{scheme:r,authority:n,path:i,query:o,fragment:a}=e;return r===void 0?r=this.scheme:r===null&&(r=Bs),n===void 0?n=this.authority:n===null&&(n=Bs),i===void 0?i=this.path:i===null&&(i=Bs),o===void 0?o=this.query:o===null&&(o=Bs),a===void 0?a=this.fragment:a===null&&(a=Bs),r===this.scheme&&n===this.authority&&i===this.path&&o===this.query&&a===this.fragment?this:new Jw(r,n,i,o,a)}static parse(e,r=!1){let n=rhr.exec(e);return n?new Jw(n[2]||Bs,Mie(n[4]||Bs),Mie(n[5]||Bs),Mie(n[7]||Bs),Mie(n[9]||Bs),r):new Jw(Bs,Bs,Bs,Bs,Bs)}static file(e){let r=Bs;if(Mw&&(e=e.replace(/\\/g,cy)),e[0]===cy&&e[1]===cy){let n=e.indexOf(cy,2);n===-1?(r=e.substring(2),e=cy):(r=e.substring(2,n),e=e.substring(n)||cy)}return new Jw("file",r,e,Bs,Bs)}static from(e,r){return new Jw(e.scheme,e.authority,e.path,e.query,e.fragment,r)}static joinPath(e,...r){if(!e.path)throw new Error("[UriError]: cannot call joinPath on URI without path");let n;return Mw&&e.scheme==="file"?n=t.file(vc.join(I_e(e,!0),...r)).path:n=ma.join(e.path,...r),e.with({path:n})}toString(e=!1){return T_e(this,e)}toJSON(){return this}static revive(e){if(e){if(e instanceof t)return e;{let r=new Jw(e);return r._formatted=e.external??null,r._fsPath=e._sep===Hft?e.fsPath??null:null,r}}else return e}[Symbol.for("debug.description")](){return`URI(${this.toString()})`}};var Hft=Mw?1:void 0,Jw=class extends Xw{constructor(){super(...arguments);this._formatted=null;this._fsPath=null}static{s(this,"Uri")}get fsPath(){return this._fsPath||(this._fsPath=I_e(this,!1)),this._fsPath}toString(r=!1){return r?T_e(this,!0):(this._formatted||(this._formatted=T_e(this,!1)),this._formatted)}toJSON(){let r={$mid:1};return this._fsPath&&(r.fsPath=this._fsPath,r._sep=Hft),this._formatted&&(r.external=this._formatted),this.path&&(r.path=this.path),this.scheme&&(r.scheme=this.scheme),this.authority&&(r.authority=this.authority),this.query&&(r.query=this.query),this.fragment&&(r.fragment=this.fragment),r}},$ft={58:"%3A",47:"%2F",63:"%3F",35:"%23",91:"%5B",93:"%5D",64:"%40",33:"%21",36:"%24",38:"%26",39:"%27",40:"%28",41:"%29",42:"%2A",43:"%2B",44:"%2C",59:"%3B",61:"%3D",32:"%20"};function Uft(t,e,r){let n,i=-1;for(let o=0;o<t.length;o++){let a=t.charCodeAt(o);if(a>=97&&a<=122||a>=65&&a<=90||a>=48&&a<=57||a===45||a===46||a===95||a===126||e&&a===47||r&&a===91||r&&a===93||r&&a===58)i!==-1&&(n+=encodeURIComponent(t.substring(i,o)),i=-1),n!==void 0&&(n+=t.charAt(o));else{n===void 0&&(n=t.substr(0,o));let c=$ft[a];c!==void 0?(i!==-1&&(n+=encodeURIComponent(t.substring(i,o)),i=-1),n+=c):i===-1&&(i=o)}}return i!==-1&&(n+=encodeURIComponent(t.substring(i))),n!==void 0?n:t}s(Uft,"encodeURIComponentFast");function nhr(t){let e;for(let r=0;r<t.length;r++){let n=t.charCodeAt(r);n===35||n===63?(e===void 0&&(e=t.substr(0,r)),e+=$ft[n]):e!==void 0&&(e+=t[r])}return e!==void 0?e:t}s(nhr,"encodeURIComponentMinimal");function I_e(t,e){let r;return t.authority&&t.path.length>1&&t.scheme==="file"?r=`//${t.authority}${t.path}`:t.path.charCodeAt(0)===47&&(t.path.charCodeAt(1)>=65&&t.path.charCodeAt(1)<=90||t.path.charCodeAt(1)>=97&&t.path.charCodeAt(1)<=122)&&t.path.charCodeAt(2)===58?e?r=t.path.substr(1):r=t.path[1].toLowerCase()+t.path.substr(2):r=t.path,Mw&&(r=r.replace(/\//g,"\\")),r}s(I_e,"uriToFsPath");function T_e(t,e){let r=e?nhr:Uft,n="",{scheme:i,authority:o,path:a,query:c,fragment:l}=t;if(i&&(n+=i,n+=":"),(o||i==="file")&&(n+=cy,n+=cy),o){let u=o.indexOf("@");if(u!==-1){let f=o.substr(0,u);o=o.substr(u+1),u=f.lastIndexOf(":"),u===-1?n+=r(f,!1,!1):(n+=r(f.substr(0,u),!1,!1),n+=":",n+=r(f.substr(u+1),!1,!0)),n+="@"}o=o.toLowerCase(),u=o.lastIndexOf(":"),u===-1?n+=r(o,!1,!0):(n+=r(o.substr(0,u),!1,!0),n+=o.substr(u))}if(a){if(a.length>=3&&a.charCodeAt(0)===47&&a.charCodeAt(2)===58){let u=a.charCodeAt(1);u>=65&&u<=90&&(a=`/${String.fromCharCode(u+32)}:${a.substr(3)}`)}else if(a.length>=2&&a.charCodeAt(1)===58){let u=a.charCodeAt(0);u>=65&&u<=90&&(a=`${String.fromCharCode(u+32)}:${a.substr(2)}`)}n+=r(a,!0,!1)}return c&&(n+="?",n+=r(c,!1,!1)),l&&(n+="#",n+=e?l:Uft(l,!1,!1)),n}s(T_e,"_asFormatted");function Wft(t){try{return decodeURIComponent(t)}catch{return t.length>3?t.substr(0,3)+Wft(t.substr(3)):t}}s(Wft,"decodeURIComponentGraceful");var qft=/(%[0-9A-Za-z][0-9A-Za-z])+/g;function Mie(t){return t.match(qft)?t.replace(qft,e=>Wft(e)):t}s(Mie,"percentDecode");d();var ly=class t{constructor(e){this.uri=e;this._uri=Xw.parse(Pl(this.uri))}static{s(this,"DocumentId")}static{this._cache=new Bx({getCacheKey:JSON.stringify},e=>new t(e.uri))}static create(e){return t._cache.get({uri:e})}get path(){return this._uri.path}get fragment(){return this._uri.fragment}toString(){return this.uri}get baseName(){return bne(this.uri)}get extension(){return Ine(this.uri)}toUri(){return this._uri}};var WU=class t{constructor(e,r){this.firstEditStrategy=e;this.maxLinesPerEdit=r}static{s(this,"StatelessNextEditOptions")}doesFitMaxLinesPerEdit(e){return this.maxLinesPerEdit===void 0||e.lineRange.length<=this.maxLinesPerEdit&&e.newLines.length<=this.maxLinesPerEdit}serialize(){return{firstEditStrategy:this.firstEditStrategy,maxLinesPerEdit:this.maxLinesPerEdit}}static deserialize(e){return new t(e.firstEditStrategy,e.maxLinesPerEdit)}},Lie=class t{constructor(e,r,n,i,o){this.id=e;this.documents=r;this.activeDocumentIdx=n;this.xtabEditHistory=i;this.options=o;this.seqid=String(++t.ID);this.cancellationTokenSource=new Dx;this.liveDependentants=0;this.fetchIssued=!1;this._result=new cU;Fl(r.length>0),Fl(n>=0&&n<r.length)}static{s(this,"StatelessNextEditRequest")}static{this.ID=0}get result(){return this._result.p}setResult(e){this._result.complete(e)}setResultError(e){this._result.error(e)}hasDocument(e){return this.documents.find(r=>r.id===e)!==void 0}static deserialize(e){return new t(e.id,e.documents.map(r=>jU.deserialize(r)),e.activeDocumentIdx,[],WU.deserialize(e.options))}getActiveDocument(){return this.documents[this.activeDocumentIdx]}serialize(){return{id:this.id,documents:this.documents.map(e=>e.serialize()),activeDocumentIdx:this.activeDocumentIdx,options:this.options.serialize()}}toString(){return this.toMarkdown()}toMarkdown(){return`### StatelessNextEditRequest

${this.documents.map((r,n)=>` * [${n+1}/${this.documents.length}] ${n===this.activeDocumentIdx?"(active document) ":""}`+r.toMarkdown()).join(`

`)}`}},jU=class t{constructor(e,r,n,i,o,a,c,l,u,f,p,m,h=i.length,g=new jr(1,i.length+1),A=void 0){this.id=e;this.workspaceRoot=r;this.languageId=n;this.documentLinesBeforeEdit=i;this.recentEdit=o;this.recentlyEditedInLinesAfterEditRange=a;this.documentBeforeEdits=c;this.recentEdits=l;this.documentAfterEditsNoShortening=u;this.toEditOnDocumentAfterEditsNoShortening=f;this.toOffsetOnDocumentAfterEditsNoShortening=p;this.toProjectedOffset=m;this.lineCountBeforeClipping=h;this.clippingRange=g;this.lastSelectionInAfterEdit=A;this.recentlyEditedInLinesAfterEdit=this.recentlyEditedInLinesAfterEditRange===void 0?void 0:jr.fromRangeInclusive(this.recentlyEditedInLinesAfterEditRange);this.documentAfterEdits=new pu(this.recentEdits.apply(this.documentBeforeEdits.value));this.documentAfterEditsLines=this.documentAfterEdits.getLines()}static{s(this,"StatelessNextEditDocument")}static deserialize(e){return new t(ly.create(e.id),e.workspaceRoot?Xw.parse(e.workspaceRoot):void 0,zR.create(e.languageId),e.documentLinesBeforeEdit,hs.deserialize(e.recentEdit),e.recentlyEditedInLinesAfterEditRange?ir.lift(e.recentlyEditedInLinesAfterEditRange):void 0,new pu(e.documentBeforeEdits),w1.deserialize(e.recentEdits),new pu(e.documentAfterEditsNoShortening),r=>{throw new Error("Deserializing serialized document does not implement translation of line edit to edit")},r=>{throw new Error("Deserializing serialized document does not implement translation of offsets")},r=>{throw new Error("Deserializing serialized document does not implement translation of offsets")},e.lineCountBeforeClipping,jr.deserialize(e.clippingRange))}serialize(){return{id:this.id.uri,workspaceRoot:this.workspaceRoot?.toString(),languageId:this.languageId,documentLinesBeforeEdit:this.documentLinesBeforeEdit,recentEdit:this.recentEdit.serialize(),recentlyEditedInLinesAfterEditRange:this.recentlyEditedInLinesAfterEditRange?.toJSON(),documentBeforeEdits:this.documentBeforeEdits.value,recentEdits:this.recentEdits.serialize(),documentAfterEditsNoShortening:this.documentAfterEditsNoShortening.value,lineCountBeforeClipping:this.lineCountBeforeClipping,clippingRange:this.clippingRange.serialize()}}getDisplayPath(){return this.id.uri}toString(){return this.toMarkdown()}toMarkdown(){let e=[];return e.push(`StatelessNextEditDocument: **${this.id.uri}**
`),e.push("```patch"),e.push(this.recentEdit.humanReadablePatch(this.documentLinesBeforeEdit)),e.push("```"),e.push(""),e.join(`
`)}};var eo=class t{constructor(e,r){this.nextEdit=e;this.telemetry=r}static{s(this,"StatelessNextEditResult")}static noEdit(e,r){let n=gs.error(e),i=r.build(n);return new t(n,i)}static edit(e,r){let n=gs.ok(e),i=r.build(n);return new t(n,i)}},Zw=class{constructor(e){this._request=e;this.startTime=Date.now(),this.requestUuid=e.id}static{s(this,"StatelessNextEditTelemetryBuilder")}build(e){let n=Date.now()-this.startTime,i=this._prompt?Qft(this._prompt):void 0,o=i?.split(`
`).length,a=i?.length,c=e.isOk(),l=e.isOk()?void 0:e.err.kind,u;if(!e.isOk())switch(e.err.kind){case"activeDocumentHasNoEdits":case"noSuggestions":case"quotaExceeded":break;case"gotCancelled":case"filteredOut":u=e.err.message;break;case"fetchFailure":case"uncategorized":case"unexpected":u=e.err.error.stack?e.err.error.stack:e.err.error.message;break;default:w7(e.err)}return{hadStatelessNextEditProviderCall:!0,firstEditStrategy:this._request.options.firstEditStrategy,maxLinesPerEdit:this._request.options.maxLinesPerEdit,hasNextEdit:c,noNextEditReasonKind:l,noNextEditReasonMessage:u,statelessNextEditProviderDuration:n,logProbThreshold:this._logProbThreshold,promptLineCount:o,promptCharCount:a,isDefaultEndpoint:this._isDefaultEndpoint,debounceTime:this._debounceTime,fetchStartedAt:this._fetchStartedAt,ttft:this._ttft,fetchTime:this._fetchTime,fetchResult:this._fetchResult,fetchError:this._fetchError,hadLowLogProbSuggestion:this._hadLowLogProbSuggestion,response:this._response,nonTerminatingError:this._nonTerminatingError,nEditsSuggested:this._nEditsSuggested,nextEditLogprob:this._nextEditLogProb,kthEditPicked:this._kthEditPicked,lineDistanceToMostRecentEdit:this._lineDistanceToMostRecentEdit,firstPickStrategyOverride:this._firstPickStrategyOverride}}setLogProbThreshold(e){return this._logProbThreshold=e,this}setHadLowLogProbSuggestion(e){return this._hadLowLogProbSuggestion=e,this}setPrompt(e){return this._prompt=e,this}setIsDefaultEndpoint(e){return this._isDefaultEndpoint=e,this}setDebounceTime(e){return this._debounceTime=e,this}setFetchStartedAt(){return this._fetchStartedAt=Date.now(),this}get fetchStartedAt(){return this._fetchStartedAt}setTtft(e){return this._ttft=e,this}setFetchResultIfNotSet(e,r){return this._fetchResult===void 0&&(this._fetchResult=e,this._fetchError=r,Fl(this._fetchStartedAt!==void 0,"fetchStartedAt must be set before setting fetchTime"),this._fetchTime=Date.now()-this._fetchStartedAt),this}get fetchResult(){return this._fetchResult}get fetchError(){return this._fetchError}get fetchTime(){return this._fetchTime}setResponse(e){return this._response=e,this}setNonTerminatingError(e){return this._nonTerminatingError=e,this}setNextEditLogProb(e){return this._nextEditLogProb=e,this}setNEditsSuggested(e){return this._nEditsSuggested=e,this}setKthEditPicked(e){return this._kthEditPicked=e,this}setLineDistanceToMostRecentEdit(e){return this._lineDistanceToMostRecentEdit=e,this}setFirstPickStrategyOverride(e){return this._firstPickStrategyOverride=e,this}};function ihr(t,...e){let r=t;for(let n of e)r=n(r);return r}s(ihr,"chainStatelessNextEditProviders");var w8=class{constructor(e,r){this.ID=e;this._providers=r;let n={ID:this.ID,provideNextEdit:s((i,o)=>this.provideNextEditBase(i,o),"provideNextEdit")};this._impl=ihr(n,...this._providers)}static{s(this,"ChainedStatelessNextEditProvider")}provideNextEdit(e,r){return this._impl.provideNextEdit(e,r)}},S8=class{constructor(e){this._baseProvider=e}static{s(this,"EditFilterAspect")}get ID(){return this._baseProvider.ID}async provideNextEdit(e,r){let n=await this._baseProvider.provideNextEdit(e,r);if(n.nextEdit.isError())return n;let i=n.nextEdit.val,o=i.permutation===void 0?i.edit.edits:i.permutation.apply(i.edit.edits),a=this.filterEdit(e.getActiveDocument(),o);if(a.length===o.length)return n;if(a.length===0)return new eo(gs.error({kind:"filteredOut",message:"uncategorized"}),n.telemetry);let c=aie.createSortPermutation(a,wh(u=>u.lineRange.startLineNumber,Sh)),l=new hs(c.apply(a));return new eo(gs.ok({edit:l,permutation:c.inverse()}),n.telemetry)}},_8=class extends S8{static{s(this,"IgnoreTriviaWhitespaceChangesAspect")}filterEdit(e,r){return r.filter(i=>!this._isWhitespaceOnlyChange(i,e.documentAfterEditsLines))}_isWhitespaceOnlyChange(e,r){let n=e.lineRange.toOffsetRange().slice(r),i=e.newLines,o=i.length===0;if(o&&n.every(a=>a.trim()==="")||!o&&i.every(a=>a.trim()===""))return!0;if(n.length!==i.length)return!1;for(let a=0;a<n.length;a++){let c=n[a],l=i[a];if(c.trim()!==l.trim())return!1}return!0}},R8=class extends S8{static{s(this,"IgnoreEditsAtClippingBorderAspect")}filterEdit(e,r){return r.filter(i=>!this._isAtClippingBorder(i,e.clippingRange,e.lineCountBeforeClipping))}_isAtClippingBorder(e,r,n){return r.startLineNumber>1&&e.lineRange.startLineNumber===1||r.endLineNumberExclusive<n&&e.lineRange.endLineNumberExclusive===r.length}};d();d();var ohr=Object.freeze({abap:{lineComment:{start:"'"},markdownLanguageIds:["abap","sap-abap"]},bat:{lineComment:{start:"REM"},alternativeLineComments:[{start:"::"}],aliases:["Batch","bat"],extensions:[".bat",".cmd"]},bibtex:{lineComment:{start:"%"},aliases:["BibTeX","bibtex"],extensions:[".bib"]},blade:{lineComment:{start:"#"}},c:{lineComment:{start:"//"},aliases:["C","c"],extensions:[".c",".i"],markdownLanguageIds:["c","h"]},clojure:{lineComment:{start:";"},aliases:["Clojure","clojure"],extensions:[".clj",".cljs",".cljc",".cljx",".clojure",".edn"],markdownLanguageIds:["clojure","clj"]},coffeescript:{lineComment:{start:"//"},aliases:["CoffeeScript","coffeescript","coffee"],extensions:[".coffee",".cson",".iced"],markdownLanguageIds:["coffeescript","coffee","cson","iced"],blockComment:["###","###"]},cpp:{lineComment:{start:"//"},aliases:["C++","Cpp","cpp"],extensions:[".cpp",".cc",".cxx",".c++",".hpp",".hh",".hxx",".h++",".h",".ii",".ino",".inl",".ipp",".ixx",".tpp",".txx",".hpp.in",".h.in"],markdownLanguageIds:["cpp","hpp","cc","hh","c++","h++","cxx","hxx"],blockComment:["/*","*/"]},csharp:{lineComment:{start:"//"},aliases:["C#","csharp"],extensions:[".cs",".csx",".cake"],markdownLanguageIds:["csharp","cs"],blockComment:["/*","*/"]},css:{lineComment:{start:"/*",end:"*/"},aliases:["CSS","css"],extensions:[".css"],blockComment:["/*","*/"]},dart:{lineComment:{start:"//"},aliases:["Dart"],extensions:[".dart"],blockComment:["/*","*/"]},dockerfile:{lineComment:{start:"#"},aliases:["Docker","Dockerfile","Containerfile"],extensions:[".dockerfile",".containerfile"],markdownLanguageIds:["dockerfile","docker"]},elixir:{lineComment:{start:"#"}},erb:{lineComment:{start:"<%#",end:"%>"}},erlang:{lineComment:{start:"%"},markdownLanguageIds:["erlang","erl"]},fsharp:{lineComment:{start:"//"},aliases:["F#","FSharp","fsharp"],extensions:[".fs",".fsi",".fsx",".fsscript"],markdownLanguageIds:["fsharp","fs","fsx","fsi","fsscript"],blockComment:["(*","*)"]},go:{lineComment:{start:"//"},aliases:["Go"],extensions:[".go"],markdownLanguageIds:["go","golang"],blockComment:["/*","*/"]},groovy:{lineComment:{start:"//"},aliases:["Groovy","groovy"],extensions:[".groovy",".gvy",".gradle",".jenkinsfile",".nf"],blockComment:["/*","*/"]},haml:{lineComment:{start:"-#"}},handlebars:{lineComment:{start:"{{!",end:"}}"},extensions:[".hbs",".handlebars"],markdownLanguageIds:["handlebars","hbs","html.hbs","html.handlebars"],blockComment:["{{!--","--}}"]},haskell:{lineComment:{start:"--"},markdownLanguageIds:["haskell","hs"]},html:{lineComment:{start:"<!--",end:"-->"},aliases:["HTML","htm","html","xhtml"],extensions:[".html",".htm",".shtml",".xhtml",".xht",".mdoc",".jsp",".asp",".aspx",".jshtm",".volt",".ejs",".rhtml"],markdownLanguageIds:["html","xhtml"],blockComment:["<!--","-->"]},ini:{lineComment:{start:";"},blockComment:[";"," "]},java:{lineComment:{start:"//"},extensions:[".java",".class"],markdownLanguageIds:["java","jsp"],blockComment:["/*","*/"]},javascript:{lineComment:{start:"//"},aliases:["JavaScript","javascript","js"],extensions:[".js",".es6",".mjs",".cjs",".pac"],markdownLanguageIds:["javascript","js"],blockComment:["/*","*/"]},javascriptreact:{lineComment:{start:"//"},aliases:["JavaScript JSX","JavaScript React","jsx"],extensions:[".jsx"],markdownLanguageIds:["jsx"]},json:{extensions:[".json"],lineComment:{start:"//"},blockComment:["/*","*/"]},jsonc:{lineComment:{start:"//"}},jsx:{lineComment:{start:"//"},markdownLanguageIds:["jsx"]},julia:{lineComment:{start:"#"},aliases:["Julia","julia"],extensions:[".jl"],markdownLanguageIds:["julia","jl"],blockComment:["#=","=#"]},kotlin:{lineComment:{start:"//"},markdownLanguageIds:["kotlin","kt"]},latex:{lineComment:{start:"%"},aliases:["LaTeX","latex"],extensions:[".tex",".ltx",".ctx"],markdownLanguageIds:["tex"]},less:{lineComment:{start:"//"},aliases:["Less","less"],extensions:[".less"],blockComment:["/*","*/"]},lua:{lineComment:{start:"--"},aliases:["Lua","lua"],extensions:[".lua"],markdownLanguageIds:["lua","pluto"],blockComment:["--[[","]]"]},makefile:{lineComment:{start:"#"},aliases:["Makefile","makefile"],extensions:[".mak",".mk"],markdownLanguageIds:["makefile","mk","mak","make"]},markdown:{lineComment:{start:"//"},aliases:["Markdown","markdown"],extensions:[".md",".mkd",".mdwn",".mdown",".markdown",".markdn",".mdtxt",".mdtext",".workbook"],markdownLanguageIds:["markdown","md","mkdown","mkd"]},"objective-c":{lineComment:{start:"//"},aliases:["Objective-C"],extensions:[".m"],markdownLanguageIds:["objectivec","mm","objc","obj-c"],blockComment:["/*","*/"]},"objective-cpp":{lineComment:{start:"//"},aliases:["Objective-C++"],extensions:[".mm"],markdownLanguageIds:["objectivec++","objc+"]},perl:{lineComment:{start:"#"},aliases:["Perl","perl"],extensions:[".pl",".pm",".pod",".t",".PL",".psgi"],markdownLanguageIds:["perl","pl","pm"]},php:{lineComment:{start:"//"},aliases:["PHP","php"],extensions:[".php",".php4",".php5",".phtml",".ctp"],blockComment:["/*","*/"]},powershell:{lineComment:{start:"#"},aliases:["PowerShell","powershell","ps","ps1"],extensions:[".ps1",".psm1",".psd1",".pssc",".psrc"],markdownLanguageIds:["powershell","ps","ps1"],blockComment:["<#","#>"]},pug:{lineComment:{start:"//"}},python:{lineComment:{start:"#"},aliases:["Python","py"],extensions:[".py",".rpy",".pyw",".cpy",".gyp",".gypi",".pyi",".ipy",".pyt"],markdownLanguageIds:["python","py","gyp"],blockComment:['"""','"""']},ql:{lineComment:{start:"//"}},r:{lineComment:{start:"#"},aliases:["R","r"],extensions:[".r",".rhistory",".rprofile",".rt"]},razor:{lineComment:{start:"<!--",end:"-->"},aliases:["Razor","razor"],extensions:[".cshtml",".razor"],markdownLanguageIds:["cshtml","razor","razor-cshtml"],blockComment:["<!--","-->"]},ruby:{lineComment:{start:"#"},aliases:["Ruby","rb"],extensions:[".rb",".rbx",".rjs",".gemspec",".rake",".ru",".erb",".podspec",".rbi"],markdownLanguageIds:["ruby","rb","gemspec","podspec","thor","irb"],blockComment:["=begin","=end"]},rust:{lineComment:{start:"//"},aliases:["Rust","rust"],extensions:[".rs"],markdownLanguageIds:["rust","rs"],blockComment:["/*","*/"]},sass:{lineComment:{start:"//"}},scala:{lineComment:{start:"//"}},scss:{lineComment:{start:"//"},aliases:["SCSS","scss"],extensions:[".scss"],blockComment:["/*","*/"]},shellscript:{lineComment:{start:"#"},aliases:["Shell Script","shellscript","bash","fish","sh","zsh","ksh","csh"],extensions:[".sh",".bash",".bashrc",".bash_aliases",".bash_profile",".bash_login",".ebuild",".profile",".bash_logout",".xprofile",".xsession",".xsessionrc",".Xsession",".zsh",".zshrc",".zprofile",".zlogin",".zlogout",".zshenv",".zsh-theme",".fish",".ksh",".csh",".cshrc",".tcshrc",".yashrc",".yash_profile"],markdownLanguageIds:["bash","sh","zsh"]},slim:{lineComment:{start:"/"}},solidity:{lineComment:{start:"//"},markdownLanguageIds:["solidity","sol"]},sql:{lineComment:{start:"--"},aliases:["SQL"],extensions:[".sql",".dsql"],blockComment:["/*","*/"]},stylus:{lineComment:{start:"//"}},svelte:{lineComment:{start:"<!--",end:"-->"}},swift:{lineComment:{start:"//"},aliases:["Swift","swift"],extensions:[".swift"],blockComment:["/*","*/"]},terraform:{lineComment:{start:"#"}},tex:{lineComment:{start:"%"},aliases:["TeX","tex"],extensions:[".sty",".cls",".bbx",".cbx"]},typescript:{lineComment:{start:"//"},aliases:["TypeScript","ts","typescript"],extensions:[".ts",".cts",".mts"],markdownLanguageIds:["typescript","ts"],blockComment:["/*","*/"]},typescriptreact:{lineComment:{start:"//"},aliases:["TypeScript JSX","TypeScript React","tsx"],extensions:[".tsx"],markdownLanguageIds:["tsx"],blockComment:["/*","*/"]},vb:{lineComment:{start:"'"},aliases:["Visual Basic","vb"],extensions:[".vb",".brs",".vbs",".bas",".vba"],markdownLanguageIds:["vb","vbscript"]},verilog:{lineComment:{start:"//"}},"vue-html":{lineComment:{start:"<!--",end:"-->"}},vue:{lineComment:{start:"//"},extensions:[".vue"]},xml:{lineComment:{start:"<!--",end:"-->"},aliases:["XML","xml"],extensions:[".xml",".xsd",".ascx",".atom",".axml",".axaml",".bpmn",".cpt",".csl",".csproj",".csproj.user",".dita",".ditamap",".dtd",".ent",".mod",".dtml",".fsproj",".fxml",".iml",".isml",".jmx",".launch",".menu",".mxml",".nuspec",".opml",".owl",".proj",".props",".pt",".publishsettings",".pubxml",".pubxml.user",".rbxlx",".rbxmx",".rdf",".rng",".rss",".shproj",".storyboard",".svg",".targets",".tld",".tmx",".vbproj",".vbproj.user",".vcxproj",".vcxproj.filters",".wsdl",".wxi",".wxl",".wxs",".xaml",".xbl",".xib",".xlf",".xliff",".xpdl",".xul",".xoml"],blockComment:["<!--","-->"]},xsl:{lineComment:{start:"<!--",end:"-->"},aliases:["XSL","xsl"],extensions:[".xsl",".xslt"]},yaml:{lineComment:{start:"#"},markdownLanguageIds:["yaml","yml"]}}),shr=new Map(Object.entries(ohr).map(([t,e])=>[t,{languageId:t,...e}]));function Gft(t){return w_e(typeof t=="string"?t:typeof t>"u"?"plaintext":t.languageId)}s(Gft,"getLanguage");function w_e(t){return shr.get(t.toLowerCase())??{languageId:t,lineComment:{start:"//"}}}s(w_e,"_getLanguage");d();var k8=class t{static{s(this,"TextEdit")}static isTextEdit(e){return e instanceof t?!0:e?Kp.isRange(e)&&typeof e.newText=="string":!1}static replace(e,r){return new t(e,r)}static insert(e,r){return t.replace(new Kp(e,e),r)}static delete(e){return t.replace(e,"")}static setEndOfLine(e){let r=new t(new Kp(new os(0,0),new os(0,0)),"");return r.newEol=e,r}get range(){return this._range}set range(e){if(e&&!Kp.isRange(e))throw eS("range");this._range=e}get newText(){return this._newText||""}set newText(e){if(e&&typeof e!="string")throw eS("newText");this._newText=e}get newEol(){return this._newEol}set newEol(e){if(e&&typeof e!="number")throw eS("newEol");this._newEol=e}constructor(e,r){this._range=e,this._newText=r}toJSON(){return{range:this.range,newText:this.newText,newEol:this._newEol}}};var os=class t{static{s(this,"Position")}static Min(...e){if(e.length===0)throw new TypeError;let r=e[0];for(let n=1;n<e.length;n++){let i=e[n];i.isBefore(r)&&(r=i)}return r}static Max(...e){if(e.length===0)throw new TypeError;let r=e[0];for(let n=1;n<e.length;n++){let i=e[n];i.isAfter(r)&&(r=i)}return r}static isPosition(e){if(!e)return!1;if(e instanceof t)return!0;let{line:r,character:n}=e;return typeof r=="number"&&typeof n=="number"}get line(){return this._line}get character(){return this._character}constructor(e,r){if(e<0)throw eS("line must be non-negative");if(r<0)throw eS("character must be non-negative");this._line=e,this._character=r}isBefore(e){return this._line<e._line?!0:e._line<this._line?!1:this._character<e._character}isBeforeOrEqual(e){return this._line<e._line?!0:e._line<this._line?!1:this._character<=e._character}isAfter(e){return!this.isBeforeOrEqual(e)}isAfterOrEqual(e){return!this.isBefore(e)}isEqual(e){return this._line===e._line&&this._character===e._character}compareTo(e){return this._line<e._line?-1:this._line>e.line?1:this._character<e._character?-1:this._character>e._character?1:0}translate(e,r=0){if(e===null||r===null)throw eS();let n;return typeof e>"u"?n=0:typeof e=="number"?n=e:(n=typeof e.lineDelta=="number"?e.lineDelta:0,r=typeof e.characterDelta=="number"?e.characterDelta:0),n===0&&r===0?this:new t(this.line+n,this.character+r)}with(e,r=this.character){if(e===null||r===null)throw eS();let n;return typeof e>"u"?n=this.line:typeof e=="number"?n=e:(n=typeof e.line=="number"?e.line:this.line,r=typeof e.character=="number"?e.character:this.character),n===this.line&&r===this.character?this:new t(n,r)}toJSON(){return{line:this.line,character:this.character}}[Symbol.for("debug.description")](){return`(${this.line}:${this.character})`}},Kp=class t{static{s(this,"Range")}static isRange(e){return e instanceof t?!0:e?os.isPosition(e.start)&&os.isPosition(e.end):!1}get start(){return this._start}get end(){return this._end}constructor(e,r,n,i){let o,a;if(typeof e=="number"&&typeof r=="number"&&typeof n=="number"&&typeof i=="number"?(o=new os(e,r),a=new os(n,i)):os.isPosition(e)&&os.isPosition(r)&&(o=e,a=r),!o||!a)throw new Error("Invalid arguments");o.isBefore(a)?(this._start=o,this._end=a):(this._start=a,this._end=o)}contains(e){return t.isRange(e)?this.contains(e.start)&&this.contains(e.end):os.isPosition(e)?!(e.isBefore(this._start)||this._end.isBefore(e)):!1}isEqual(e){return this._start.isEqual(e._start)&&this._end.isEqual(e._end)}intersection(e){let r=os.Max(e.start,this._start),n=os.Min(e.end,this._end);if(!r.isAfter(n))return new t(r,n)}union(e){if(this.contains(e))return this;if(e.contains(this))return e;let r=os.Min(e.start,this._start),n=os.Max(e.end,this.end);return new t(r,n)}get isEmpty(){return this._start.isEqual(this._end)}get isSingleLine(){return this._start.line===this._end.line}with(e,r=this.end){if(e===null||r===null)throw eS();let n;return e?os.isPosition(e)?n=e:(n=e.start||this.start,r=e.end||this.end):n=this.start,n.isEqual(this._start)&&r.isEqual(this.end)?this:new t(n,r)}toJSON(){return[this.start,this.end]}[Symbol.for("debug.description")](){return ahr(this)}};function eS(t){return t?new Error(`Illegal argument: ${t}`):new Error("Illegal argument")}s(eS,"illegalArgument");function ahr(t){return t.isEmpty?`[${t.start.line}:${t.start.character})`:`[${t.start.line}:${t.start.character} -> ${t.end.line}:${t.end.character})`}s(ahr,"getDebugDescriptionOfRange");d();function Vft(t){let r=t.split(/\r?\n/).map(chr),n=r.filter(o=>o===1).length,i=r.filter(o=>o===2).length;return n>i}s(Vft,"looksLikeCode");function chr(t){if(t.length===0)return 0;let e=0,r=0;if(["==","!=","===","!==",">=","<=","&&","||",">>",">>>","<<","<<<","+=","-=","*=","/=","%=","<<=","<<<=",">>=",">>>=","++","--","=>","->","...","??","??="].some(i=>t.includes(i))||t.match(/^\s/)||t.match(/^[;{}()\[\]`~?]/))return 1;t.charAt(0).match(/[A-Z]/)&&(e+=1),t[t.length-1]==="."&&(e+=1),$xe(t)||(e+=1);{$xe(t.charAt(0))&&!t.charAt(0).match(/[A-Z]/)&&(r+=1),t.match(/^\s/)&&(r+=1);let o=[";","{","}","(",")","[","]","`","~","#","$","%","^","&","*","_","=","+","\\","|","<",">"].map(a=>t.includes(a)?1:0).filter(a=>a).length;r+=o}return e>r?2:r>e?1:0}s(chr,"guessLineType");var P8;(r=>{function t(n){return n.length===0?[]:n.split(/\r\n|\r|\n/g)}r.fromString=t,s(t,"fromString");function e(n){if(n.lineCount===0)return[];let i=[];for(let o=0;o<n.lineCount;o++)i.push(n.lineAt(o).text);return i}r.fromDocument=e,s(e,"fromDocument")})(P8||={});function lhr(t){return t.replace(/^\s+/g,"")}s(lhr,"trimLeadingWhitespace");function S_e(t,e){switch(e){case"java":return!!t.match(/^\s*import\s/);case"typescript":case"typescriptreact":case"javascript":case"javascriptreact":return!!t.match(/^\s*import[\s{*]|^\s*[var|const|let].*=\s*require\(/);case"php":return!!t.match(/^\s*use/);case"rust":return!!t.match(/^\s*use\s+[\w:{}, ]+\s*(as\s+\w+)?;/);case"python":return!!t.match(/^\s*from\s+[\w.]+\s+import\s+[\w, *]+$/)||!!t.match(/^\s*import\s+[\w, ]+$/);default:return!1}}s(S_e,"isImportStatement");var uhr=new Bx(t=>{let e=Gft(t),{start:r,end:n}=e.lineComment,i=`(?:${O3(r)})`,o=n?`(?:${O3(n)})?`:"";return new RegExp(`${i}(.*)${o}$`)});function __e(t,e){let r=t.match(uhr.get(e));if(!r)return;let n=r.index;if(typeof n>"u")return;let i=t.substring(0,n),o=r[0],a=lhr(r[1]||"");return{content:i,commentWithTokens:o,commentWithoutTokens:a}}s(__e,"extractEndLineComment");function Oie(t,e){let r=__e(t,e);if(!(r&&r.content.trim().length>0&&Vft(r.commentWithoutTokens)))return r}s(Oie,"extractExplicativeEndLineComment");var D8=class t extends S8{static{s(this,"IgnoreImportChangesAspect")}static isImportChange(e,r,n){return e.newLines.some(i=>S_e(i,r))||dhr(e,n).some(i=>S_e(i,r))}filterEdit(e,r){let n=e.languageId;return r.filter(o=>!t.isImportChange(o,n,e.documentLinesBeforeEdit))}};function dhr(t,e){return xze(t.lineRange.mapToLineArray(r=>e[r-1]))}s(dhr,"getOldLines");d();var k_e=Be(Aa());d();d();d();var uy;(i=>{i.serviceIds=new Map,i.DI_TARGET="$di$target",i.DI_DEPENDENCIES="$di$dependencies";function n(o){return o[i.DI_DEPENDENCIES]||[]}i.getServiceDependencies=n,s(n,"getServiceDependencies")})(uy||={});var D1=Yp("instantiationService");function fhr(t,e,r){e[uy.DI_TARGET]===e?e[uy.DI_DEPENDENCIES].push({id:t,index:r}):(e[uy.DI_DEPENDENCIES]=[{id:t,index:r}],e[uy.DI_TARGET]=e)}s(fhr,"storeServiceDependency");function Yp(t){if(uy.serviceIds.has(t))return uy.serviceIds.get(t);let e=s(function(r,n,i){if(arguments.length!==3)throw new Error("@IServiceName-decorator can only be used to decorate a parameter");fhr(e,r,i)},"id");return e.toString=()=>t,uy.serviceIds.set(t,e),e}s(Yp,"createDecorator");d();d();var fm=class{static{s(this,"SyncDescriptor")}constructor(e,r=[],n=!1){this.ctor=e,this.staticArguments=r,this.supportsDelayedInstantiation=n}};d();var R_e=class{constructor(e,r){this.key=e;this.data=r;this.incoming=new Map;this.outgoing=new Map}static{s(this,"Node")}},GU=class{constructor(e){this._hashFn=e;this._nodes=new Map}static{s(this,"Graph")}roots(){let e=[];for(let r of this._nodes.values())r.outgoing.size===0&&e.push(r);return e}insertEdge(e,r){let n=this.lookupOrInsertNode(e),i=this.lookupOrInsertNode(r);n.outgoing.set(i.key,i),i.incoming.set(n.key,n)}removeNode(e){let r=this._hashFn(e);this._nodes.delete(r);for(let n of this._nodes.values())n.outgoing.delete(r),n.incoming.delete(r)}lookupOrInsertNode(e){let r=this._hashFn(e),n=this._nodes.get(r);return n||(n=new R_e(r,e),this._nodes.set(r,n)),n}lookup(e){return this._nodes.get(this._hashFn(e))}isEmpty(){return this._nodes.size===0}toString(){let e=[];for(let[r,n]of this._nodes)e.push(`${r}
	(-> incoming)[${[...n.incoming.keys()].join(", ")}]
	(outgoing ->)[${[...n.outgoing.keys()].join(",")}]
`);return e.join(`
`)}findCycleSlow(){for(let[e,r]of this._nodes){let n=new Set([e]),i=this._findCycle(r,n);if(i)return i}}_findCycle(e,r){for(let[n,i]of e.outgoing){if(r.has(n))return[...r,n].join(" -> ");r.add(n);let o=this._findCycle(i,r);if(o)return o;r.delete(n)}}};d();var Jk=class{constructor(...e){this._entries=new Map;for(let[r,n]of e)this.set(r,n)}static{s(this,"ServiceCollection")}set(e,r){let n=this._entries.get(e);return this._entries.set(e,r),n}has(e){return this._entries.has(e)}get(e){return this._entries.get(e)}};var phr=!1,Qie=class extends Error{static{s(this,"CyclicDependencyError")}constructor(e){super("cyclic dependency between services"),this.message=e.findCycleSlow()??`UNABLE to detect cycle, dumping graph: 
${e.toString()}`}},Uie=class t{constructor(e=new Jk,r=!1,n,i=phr){this._services=e;this._strict=r;this._parent=n;this._enableTracing=i;this._isDisposed=!1;this._servicesToMaybeDispose=new Set;this._children=new Set;this._activeInstantiations=new Set;this._services.set(D1,this),this._globalGraph=i?n?._globalGraph??new GU(o=>o):void 0}static{s(this,"InstantiationService")}dispose(){if(!this._isDisposed){this._isDisposed=!0,fX(this._children),this._children.clear();for(let e of this._servicesToMaybeDispose)Dze(e)&&e.dispose();this._servicesToMaybeDispose.clear()}}_throwIfDisposed(){if(this._isDisposed)throw new Error("InstantiationService has been disposed")}createChild(e,r){this._throwIfDisposed();let n=this,i=new class extends t{dispose(){n._children.delete(i),super.dispose()}}(e,this._strict,this,this._enableTracing);return this._children.add(i),r?.add(i),i}invokeFunction(e,...r){this._throwIfDisposed();let n=VU.traceInvocation(this._enableTracing,e),i=!1;try{return e({get:s(a=>{if(i)throw Cze("service accessor is only valid during the invocation of its target method");let c=this._getOrCreateServiceInstance(a,n);if(!c)throw new Error(`[invokeFunction] unknown service '${a}'`);return c},"get")},...r)}finally{i=!0,n.stop()}}createInstance(e,...r){this._throwIfDisposed();let n,i;return e instanceof fm?(n=VU.traceCreation(this._enableTracing,e.ctor),i=this._createInstance(e.ctor,e.staticArguments.concat(r),n)):(n=VU.traceCreation(this._enableTracing,e),i=this._createInstance(e,r,n)),n.stop(),i}_createInstance(e,r=[],n){let i=uy.getServiceDependencies(e).sort((c,l)=>c.index-l.index),o=[];for(let c of i){let l=this._getOrCreateServiceInstance(c.id,n);l||this._throwIfStrict(`[createInstance] ${e.name} depends on UNKNOWN service ${c.id}.`,!1),o.push(l)}let a=i.length>0?i[0].index:r.length;if(r.length!==a){console.trace(`[createInstance] First service dependency of ${e.name} at position ${a+1} conflicts with ${r.length} static arguments`);let c=a-r.length;c>0?r=r.concat(new Array(c)):r=r.slice(0,a)}return Reflect.construct(e,r.concat(o))}_setCreatedServiceInstance(e,r){if(this._services.get(e)instanceof fm)this._services.set(e,r);else if(this._parent)this._parent._setCreatedServiceInstance(e,r);else throw new Error("illegalState - setting UNKNOWN service instance")}_getServiceInstanceOrDescriptor(e){let r=this._services.get(e);return!r&&this._parent?this._parent._getServiceInstanceOrDescriptor(e):r}_getOrCreateServiceInstance(e,r){this._globalGraph&&this._globalGraphImplicitDependency&&this._globalGraph.insertEdge(this._globalGraphImplicitDependency,String(e));let n=this._getServiceInstanceOrDescriptor(e);return n instanceof fm?this._safeCreateAndCacheServiceInstance(e,n,r.branch(e,!0)):(r.branch(e,!1),n)}_safeCreateAndCacheServiceInstance(e,r,n){if(this._activeInstantiations.has(e))throw new Error(`illegal state - RECURSIVELY instantiating service '${e}'`);this._activeInstantiations.add(e);try{return this._createAndCacheServiceInstance(e,r,n)}finally{this._activeInstantiations.delete(e)}}_createAndCacheServiceInstance(e,r,n){let i=new GU(l=>l.id.toString()),o=0,a=[{id:e,desc:r,_trace:n}],c=new Set;for(;a.length;){let l=a.pop();if(!c.has(String(l.id))){if(c.add(String(l.id)),i.lookupOrInsertNode(l),o++>1e3)throw new Qie(i);for(let u of uy.getServiceDependencies(l.desc.ctor)){let f=this._getServiceInstanceOrDescriptor(u.id);if(f||this._throwIfStrict(`[createInstance] ${e} depends on ${u.id} which is NOT registered.`,!0),this._globalGraph?.insertEdge(String(l.id),String(u.id)),f instanceof fm){let p={id:u.id,desc:f,_trace:l._trace.branch(u.id,!0)};i.insertEdge(l,p),a.push(p)}}}}for(;;){let l=i.roots();if(l.length===0){if(!i.isEmpty())throw new Qie(i);break}for(let{data:u}of l){if(this._getServiceInstanceOrDescriptor(u.id)instanceof fm){let p=this._createServiceInstanceWithOwner(u.id,u.desc.ctor,u.desc.staticArguments,u.desc.supportsDelayedInstantiation,u._trace);this._setCreatedServiceInstance(u.id,p)}i.removeNode(u)}}return this._getServiceInstanceOrDescriptor(e)}_createServiceInstanceWithOwner(e,r,n=[],i,o){if(this._services.get(e)instanceof fm)return this._createServiceInstance(e,r,n,i,o,this._servicesToMaybeDispose);if(this._parent)return this._parent._createServiceInstanceWithOwner(e,r,n,i,o);throw new Error(`illegalState - creating UNKNOWN service instance ${r.name}`)}_createServiceInstance(e,r,n=[],i,o,a){if(i)throw new Error("Delayed instantiation not supported");{let c=this._createInstance(r,n,o);return a.add(c),c}}_throwIfStrict(e,r){if(r&&console.warn(e),this._strict)throw new Error(e)}};var VU=class t{constructor(e,r){this.type=e;this.name=r;this._start=Date.now();this._dep=[]}static{s(this,"Trace")}static{this.all=new Set}static{this._None=new class extends t{constructor(){super(0,null)}stop(){}branch(){return this}}}static traceInvocation(e,r){return e?new t(2,r.name||new Error().stack.split(`
`).slice(3,4).join(`
`)):t._None}static traceCreation(e,r){return e?new t(1,r.name):t._None}static{this._totals=0}branch(e,r){let n=new t(3,e.toString());return this._dep.push([e,r,n]),n}stop(){let e=Date.now()-this._start;t._totals+=e;let r=!1;function n(o,a){let c=[],l=new Array(o+1).join("	");for(let[u,f,p]of a._dep)if(f&&p){r=!0,c.push(`${l}CREATES -> ${u}`);let m=n(o+1,p);m&&c.push(m)}else c.push(`${l}uses -> ${u}`);return c.join(`
`)}s(n,"printChild");let i=[`${this.type===1?"CREATE":"CALL"} ${this.name}`,`${n(1,this)}`,`DONE, took ${e.toFixed(2)}ms (grand total ${t._totals.toFixed(2)}ms)`];(e>2||r)&&t.all.add(i.join(`
`))}};var qie=class{constructor(e){this._isSealed=!1;this._collection=Array.isArray(e)?new Jk(...e):e??new Jk}static{s(this,"InstantiationServiceBuilder")}define(e,r){if(this._isSealed)throw new Error("This accessor is sealed and cannot be modified anymore.");this._collection.set(e,r)}seal(){if(this._isSealed)throw new Error("This accessor is sealed and cannot be seal again anymore.");return this._isSealed=!0,new Uie(this._collection,!0)}};var $ie=Yp("ITelemetrySender"),dy=Yp("IChatMLFetcher");var Hie=class{constructor(){this._stream=new gne;this._seenAnnotationTypes=new Set}static{s(this,"FetchStreamSource")}get stream(){return this._stream.asyncIterable}update(e,r){r.codeVulnAnnotations&&(!((e.match(/(^|\n)```/g)?.length??0)%2===1)||e.match(/(^|\n)```\w*\s*$/))&&(r.codeVulnAnnotations=void 0),r.codeVulnAnnotations&&(r.codeVulnAnnotations=r.codeVulnAnnotations.filter(n=>!this._seenAnnotationTypes.has(n.details.type)),r.codeVulnAnnotations.forEach(n=>this._seenAnnotationTypes.add(n.details.type))),this._stream.emitOne({text:e,delta:r})}resolve(){this._stream.resolve()}},Wie=Yp("IEndpointProvider");d();var CE=Yp("IParserService");d();var B8=class{static{s(this,"DiffChange")}constructor(e,r,n,i){this.originalStart=e,this.originalLength=r,this.modifiedStart=n,this.modifiedLength=i}getOriginalEnd(){return this.originalStart+this.originalLength}getModifiedEnd(){return this.modifiedStart+this.modifiedLength}},zU=class{constructor(e,r=!0){this.lines=e;this.trimWhitespace=r}static{s(this,"LineSequence")}getElements(){let e=[];for(let r=0,n=this.lines.length;r<n;r++)e[r]=this.trimWhitespace?this.lines[r].trim():this.lines[r];return e}getCharCount(){let e=0;for(let r of this.lines)e+=r.length;return e}},KU=class{static{s(this,"CharSequence")}constructor(e){this._chars=e.split("")}getElements(){return this._chars}},tS=class{static{s(this,"Debug")}static Assert(e,r){if(!e)throw new Error(r)}},rS=class{static{s(this,"MyArray")}static Copy(e,r,n,i,o){for(let a=0;a<o;a++)n[i+a]=e[r+a]}static Copy2(e,r,n,i,o){for(let a=0;a<o;a++)n[i+a]=e[r+a]}};var jie=class{static{s(this,"DiffChangeHelper")}constructor(){this.m_changes=[],this.m_originalStart=1073741824,this.m_modifiedStart=1073741824,this.m_originalCount=0,this.m_modifiedCount=0}MarkNextChange(){(this.m_originalCount>0||this.m_modifiedCount>0)&&this.m_changes.push(new B8(this.m_originalStart,this.m_originalCount,this.m_modifiedStart,this.m_modifiedCount)),this.m_originalCount=0,this.m_modifiedCount=0,this.m_originalStart=1073741824,this.m_modifiedStart=1073741824}AddOriginalElement(e,r){this.m_originalStart=Math.min(this.m_originalStart,e),this.m_modifiedStart=Math.min(this.m_modifiedStart,r),this.m_originalCount++}AddModifiedElement(e,r){this.m_originalStart=Math.min(this.m_originalStart,e),this.m_modifiedStart=Math.min(this.m_modifiedStart,r),this.m_modifiedCount++}getChanges(){return(this.m_originalCount>0||this.m_modifiedCount>0)&&this.MarkNextChange(),this.m_changes}getReverseChanges(){return(this.m_originalCount>0||this.m_modifiedCount>0)&&this.MarkNextChange(),this.m_changes.reverse(),this.m_changes}},YU=class t{static{s(this,"LcsDiff")}constructor(e,r){let[n,i]=t._getElements(e),[o,a]=t._getElements(r);this._originalStringElements=n,this._originalElementsOrHash=i,this._modifiedStringElements=o,this._modifiedElementsOrHash=a,this.m_forwardHistory=[],this.m_reverseHistory=[]}static _getElements(e){let r=e.getElements(),n=new Int32Array(r.length);for(let i=0,o=r.length;i<o;i++)n[i]=this._stringHash(r[i],0);return[r,n]}static _numberHash(e,r){return(r<<5)-r+e|0}static _stringHash(e,r){r=this._numberHash(149417,r);for(let n=0,i=e.length;n<i;n++)r=this._numberHash(e.charCodeAt(n),r);return r}ElementsAreEqual(e,r){return this._originalElementsOrHash[e]!==this._modifiedElementsOrHash[r]?!1:this._originalStringElements[e]===this._modifiedStringElements[r]}ComputeDiff(){return this._ComputeDiff(0,this._originalElementsOrHash.length-1,0,this._modifiedElementsOrHash.length-1)}_ComputeDiff(e,r,n,i){return this.ComputeDiffRecursive(e,r,n,i)}ComputeDiffRecursive(e,r,n,i){for(;e<=r&&n<=i&&this.ElementsAreEqual(e,n);)e++,n++;for(;r>=e&&i>=n&&this.ElementsAreEqual(r,i);)r--,i--;if(e>r||n>i){let f;return n<=i?(tS.Assert(e===r+1,"originalStart should only be one more than originalEnd"),f=[new B8(e,0,n,i-n+1)]):e<=r?(tS.Assert(n===i+1,"modifiedStart should only be one more than modifiedEnd"),f=[new B8(e,r-e+1,n,0)]):(tS.Assert(e===r+1,"originalStart should only be one more than originalEnd"),tS.Assert(n===i+1,"modifiedStart should only be one more than modifiedEnd"),f=[]),f}let o=[0],a=[0],c=this.ComputeRecursionPoint(e,r,n,i,o,a),l=o[0],u=a[0];if(c!==null)return c;{let f=this.ComputeDiffRecursive(e,l,n,u),p=this.ComputeDiffRecursive(l+1,r,u+1,i);return this.ConcatenateChanges(f,p)}}WALKTRACE(e,r,n,i,o,a,c,l,u,f,p,m,h,g,A,y,E){let b=null,S=null,R=new jie,B=r,L=n,O=h[0]-y[0]-i,Y=-1073741824,V=this.m_forwardHistory.length-1;do{let z=O+e;z===B||z<L&&u[z-1]<u[z+1]?(p=u[z+1],g=p-O-i,p<Y&&R.MarkNextChange(),Y=p,R.AddModifiedElement(p+1,g),O=z+1-e):(p=u[z-1]+1,g=p-O-i,p<Y&&R.MarkNextChange(),Y=p-1,R.AddOriginalElement(p,g+1),O=z-1-e),V>=0&&(u=this.m_forwardHistory[V],e=u[0],B=1,L=u.length-1)}while(--V>=-1);b=R.getReverseChanges(),R=new jie,B=a,L=c,O=h[0]-y[0]-l,Y=1073741824,V=E?this.m_reverseHistory.length-1:this.m_reverseHistory.length-2;do{let z=O+o;z===B||z<L&&f[z-1]>=f[z+1]?(p=f[z+1]-1,g=p-O-l,p>Y&&R.MarkNextChange(),Y=p+1,R.AddOriginalElement(p+1,g+1),O=z+1-o):(p=f[z-1],g=p-O-l,p>Y&&R.MarkNextChange(),Y=p,R.AddModifiedElement(p+1,g+1),O=z-1-o),V>=0&&(f=this.m_reverseHistory[V],o=f[0],B=1,L=f.length-1)}while(--V>=-1);return S=R.getChanges(),this.ConcatenateChanges(b,S)}ComputeRecursionPoint(e,r,n,i,o,a){let c=0,l=0,u=0,f=0,p=0,m=0;e--,n--,o[0]=0,a[0]=0,this.m_forwardHistory=[],this.m_reverseHistory=[];let h=r-e+(i-n),g=h+1,A=new Int32Array(g),y=new Int32Array(g),E=i-n,b=r-e,S=e-n,R=r-i,L=(b-E)%2===0;A[E]=e,y[b]=r;for(let O=1;O<=h/2+1;O++){let Y=0,V=0;u=this.ClipDiagonalBound(E-O,O,E,g),f=this.ClipDiagonalBound(E+O,O,E,g);for(let z=u;z<=f;z+=2){z===u||z<f&&A[z-1]<A[z+1]?c=A[z+1]:c=A[z-1]+1,l=c-(z-E)-S;let Q=c;for(;c<r&&l<i&&this.ElementsAreEqual(c+1,l+1);)c++,l++;if(A[z]=c,c+l>Y+V&&(Y=c,V=l),!L&&Math.abs(z-b)<=O-1&&c>=y[z])return o[0]=c,a[0]=l,Q<=y[z]&&O<=1448?this.WALKTRACE(E,u,f,S,b,p,m,R,A,y,c,r,o,l,i,a,L):null}p=this.ClipDiagonalBound(b-O,O,b,g),m=this.ClipDiagonalBound(b+O,O,b,g);for(let z=p;z<=m;z+=2){z===p||z<m&&y[z-1]>=y[z+1]?c=y[z+1]-1:c=y[z-1],l=c-(z-b)-R;let Q=c;for(;c>e&&l>n&&this.ElementsAreEqual(c,l);)c--,l--;if(y[z]=c,L&&Math.abs(z-E)<=O&&c<=A[z])return o[0]=c,a[0]=l,Q>=A[z]&&O<=1448?this.WALKTRACE(E,u,f,S,b,p,m,R,A,y,c,r,o,l,i,a,L):null}if(O<=1447){let z=new Int32Array(f-u+2);z[0]=E-u+1,rS.Copy2(A,u,z,1,f-u+1),this.m_forwardHistory.push(z),z=new Int32Array(m-p+2),z[0]=b-p+1,rS.Copy2(y,p,z,1,m-p+1),this.m_reverseHistory.push(z)}}return this.WALKTRACE(E,u,f,S,b,p,m,R,A,y,c,r,o,l,i,a,L)}ConcatenateChanges(e,r){let n=[];if(e.length===0||r.length===0)return r.length>0?r:e;if(this.ChangesOverlap(e[e.length-1],r[0],n)){let i=new Array(e.length+r.length-1);return rS.Copy(e,0,i,0,e.length-1),i[e.length-1]=n[0],rS.Copy(r,1,i,e.length,r.length-1),i}else{let i=new Array(e.length+r.length);return rS.Copy(e,0,i,0,e.length),rS.Copy(r,0,i,e.length,r.length),i}}ChangesOverlap(e,r,n){if(tS.Assert(e.originalStart<=r.originalStart,"Left change is not less than or equal to right change"),tS.Assert(e.modifiedStart<=r.modifiedStart,"Left change is not less than or equal to right change"),e.originalStart+e.originalLength>=r.originalStart||e.modifiedStart+e.modifiedLength>=r.modifiedStart){let i=e.originalStart,o=e.originalLength,a=e.modifiedStart,c=e.modifiedLength;return e.originalStart+e.originalLength>=r.originalStart&&(o=r.originalStart+r.originalLength-e.originalStart),e.modifiedStart+e.modifiedLength>=r.modifiedStart&&(c=r.modifiedStart+r.modifiedLength-e.modifiedStart),n[0]=new B8(i,o,a,c),!0}else return n[0]=null,!1}ClipDiagonalBound(e,r,n,i){if(e>=0&&e<i)return e;let o=n,a=i-n-1,c=r%2===0;if(e<0){let l=o%2===0;return c===l?0:1}else{let l=a%2===0;return c===l?i-1:i-2}}};d();function zft(t){let e=new Set;return JSON.stringify(t,(r,n)=>{if(qut(n)||Array.isArray(n)){if(e.has(n))return"[Circular]";e.add(n)}return typeof n=="bigint"?`[BigInt ${n.toString()}]`:n})}s(zft,"safeStringify");var Gie=!1,B_e=!0,mhr=200,JU=class{constructor(e,r){this.ID=e;this._parserService=r;this.dependsOnSelection=!0}static{s(this,"AbstractNearbyCursorInlineEditProvider")}async provideNextEdit(e,r){let n=new Zw(e),i=e.getActiveDocument(),o=Xk(i);if(!o||!o.isEmpty())return eo.noEdit({kind:"uncategorized",error:new Error("Selection is not empty")},n);let a=i.documentLinesBeforeEdit,c=i.recentEdit.apply(a),l=[];for(let S of e.documents)S.id!==i.id&&(l.push(`RELATED DOC: ${S.getDisplayPath()}`),l.push("```patch"),l.push(...Chr(S)),l.push("```"),l.push(""));l.push(`ORIGINAL VERSION: ${i.getDisplayPath()}`),l.push("```"),l.push(...a),l.push("```"),l.push("");let u="// ...rest of the lines omitted...",f=new jr(1,Math.max(1,o.startLineNumber-1)),p=i.recentEdit.edits.length>0?i.recentEdit.edits[i.recentEdit.edits.length-1].lineRange.endLineNumberExclusive-1:0,m;if(p>0&&p>=f.endLineNumberExclusive){let S=p<c.length;l.push(`IN PROGRESS VERSION ${S?" PREFIX":""}: ${i.getDisplayPath()}`),l.push("```"),l.push(...c.slice(0,p)),S&&(l.push(u),m={editRange:new jr(f.endLineNumberExclusive,p+1),omittedMessage:u}),l.push("```"),l.push("")}l.push(`NEXT VERSION: ${i.getDisplayPath()}`),l.push("```"),l.push(...c.slice(0,f.endLineNumberExclusive-1)),l.push("");let h=c.slice(f.endLineNumberExclusive-1).join(`
`),g=await this.fetchUntilConvergence(l.join(`
`),h,r);if(r.isCancellationRequested)return eo.noEdit({kind:"gotCancelled",message:"afterFetchCall"},n);if(g.isError())return g.err.kind==="cancel"?eo.noEdit({kind:"gotCancelled",message:"afterFetchCall"},n):eo.noEdit({kind:"fetchFailure",error:new Error(zft(g.err))},n);let{result:A,ttft:y}=g.val;if(y!==void 0&&n.setTtft(y),A.trim().length===0)return eo.noEdit({kind:"noSuggestions"},n);let E=Vie(i.languageId,c,f,void 0,A,m),b=await L_e(this._parserService,E,i,{requireEditWithinNLines:5});if(b){let S=new hs([b]);return eo.edit({edit:S},n)}else return eo.noEdit({kind:"filteredOut",message:"uncategorized"},n)}};JU=uf([Ta(1,CE)],JU);var N8=class extends JU{constructor(r,n){super(N8.ID,r);this._chatMLFetcher=n}static{s(this,"MiniNearbyCursorInlineEditProvider")}static{this.ID="MiniNearbyCursorInlineEditProvider"}async fetchUntilConvergence(r,n,i){if(i.isCancellationRequested)return gs.error({kind:"cancel"});let o=await N_e(this.ID,this._chatMLFetcher,[{role:k_e.OpenAI.ChatRole.System,content:`
Please no talking.
You must only provide code.
Simply provide the code that follows most logically.
You don't change code if not necessary.
You see the same file multiple times, but only the last one is the final version.
`.trim()},{role:k_e.OpenAI.ChatRole.User,content:r}],{convergence:n},i);if(o.isError())return o;let{ignored:a,result:c,ttft:l}=o.val;return c=c.replace(/^```[^\n]*\n/,""),gs.ok({ignored:a,result:c,ttft:l})}};N8=uf([Ta(0,CE),Ta(1,dy)],N8);async function N_e(t,e,r,n,i){let o=new Hie,a=!1,c,l=o.stream.map(A=>({choices:[{index:0,finish_reason:null,logprobs:null,text:A.delta.text}]})),u=ghr(l,n),f=e.fetchOne(r,async(A,y,E)=>(typeof c>"u"&&(c=Date.now()),o.update(A,E),a?A.length:void 0),{id:"copilot-nes-v",name:"proxy-4o-mini"},{},i);(async()=>{try{await f}finally{o.resolve()}})();let{ignored:p,result:m,shouldCancelRequest:h}=await u;h&&(a=!0);let g=await f;return g.type!=="success"?gs.error({kind:"failure",err:new Error(`Fetch failed (${g.type}, ${g.reason})`)}):gs.ok({ttft:c,ignored:p,result:m})}s(N_e,"fetchUntilConvergence");function Xk(t){let e=new Vt(0,0);return t.lastSelectionInAfterEdit&&!t.lastSelectionInAfterEdit.equals(e)?t.documentAfterEdits.getTransformer().getRange(t.lastSelectionInAfterEdit):t.recentEdit.edits.length===0?null:hhr(t)}s(Xk,"getOrDeduceSelectionFromLastEdit");function hhr(t){let e=t.recentEdit.edits[t.recentEdit.edits.length-1],r=e.lineRange,i=t.recentEdit.getNewLineRanges()[t.recentEdit.edits.length-1].endLineNumberExclusive-1,o=e.newLines[e.newLines.length-1]??"";if(r.length===0)return new ir(i,o.length+1,i,o.length+1);let a=t.documentLinesBeforeEdit[r.endLineNumberExclusive-2],c=Nx(a,o),l=o.length-c+1;return new ir(i,l,i,l)}s(hhr,"deduceSelectionFromLastEdit");async function ghr(t,e){let r=Ahr(t,e.ignoreReplyTextBefore),n=e.convergence,i=e.maxCompletionLineCount??20,o=e.convergenceNonWhitespaceCharOverlap??40,a=n.replace(/\s/g,""),c=[],l=[],u=[],f=[],p=s(m=>{let h=l[0];return{ignored:c[0]??"",result:h.substring(0,h.lastIndexOf(`
`)+1),shouldCancelRequest:!0}},"returnEarly");for await(let m of r){if(m.kind==="ignore"){c[m.index]=(c[m.index]??"")+m.text;continue}let h=m.text;if(l[m.index]=l[m.index]??"",l[m.index]+=h,f[m.index]=f[m.index]??"",f[m.index]+=h.replace(/\s/g,""),u[m.index]=u[m.index]??0,u[m.index]+=h.split(`
`).length-1,h.indexOf(`
`)===-1||m.index!==0)continue;if(u[m.index]>i)return p(`too many lines: ${u[m.index]}`);let g=l[m.index];if(n.startsWith(g))continue;let A=g.split(`
`).slice(-4,-1);if(A.length<3||n.indexOf(A.join(`
`)+`
`)<=0)continue;let E=f[m.index].substring(f[m.index].length-o);if(a.indexOf(E)>0)return p("convergence!")}return{ignored:c[0]??"",result:l[0]??"",shouldCancelRequest:!1}}s(ghr,"fetchCompletionUntilConvergence");function Ahr(t,e){let r=[],n=[];return new lU(async i=>{for await(let o of t)for(let a of o.choices){let c=a.index,l=a.text??"";if(!e||r[c]){i.emitOne({kind:"completion",index:c,text:l});continue}n[c]=(n[c]??"")+l;let u=n[c].match(e);!u||typeof u.index>"u"||(r[c]=!0,i.emitOne({kind:"ignore",index:c,text:n[c].substring(0,u.index+u[0].length)}),i.emitOne({kind:"completion",index:a.index,text:n[c].substring(u.index+u[0].length)}),n[c]=void 0)}for(let o=0;o<n.length;o++)typeof n[o]<"u"&&i.emitOne({kind:"ignore",index:o,text:n[o]})})}s(Ahr,"getTextAfterFirstPattern");function yhr(t,e,r){let n=e.startLineNumber,i=e.endLineNumberExclusive,o=r.slice(0);for(;n+1<i&&o.length>0;){let a=t[i-2],c=o[o.length-1];if(a!==c)break;i--,o.pop()}for(;n+1<i&&o.length>0;){let a=t[n-1],c=o[0];if(a!==c)break;n++,o.shift()}return new ry(new jr(n,i),o)}s(yhr,"createReducedLineEdit");var M8=class{constructor(e,r,n,i){this.languageId=e;this.oldLines=r;this.oldLines=r,this.edit=yhr(r,n,i);let o=new hs([this.edit]);this.newLines=o.apply(r)}static{s(this,"PossibleEdit")}hasEditWithinFirstLines(e){let r=this.oldLines.slice(this.edit.lineRange.startLineNumber-1,this.edit.lineRange.endLineNumberExclusive-1),n=this.edit.newLines;return o(r,n)<e;function o(a,c){for(let l=0;l<Math.min(a.length,c.length);l++)if(a[l]!==c[l])return l;return Math.min(a.length,c.length)}}resolveDiff(){let e=s((p,m,h)=>p.map(g=>{let A=m.lines.slice(g.originalStart,g.originalStart+g.originalLength),y=h.lines.slice(g.modifiedStart,g.modifiedStart+g.modifiedLength),E=A.join(`
`),b=y.join(`
`),{editDistance:S}=f(E,b);return new P_e(g.originalStart,g.originalLength,g.modifiedStart,g.modifiedLength,S)}),"computeEditDistances"),r=s(p=>{let m=0;for(let h of p)m+=h.editDistance;return{editDistance:m}},"computeDiffMetrics"),n=!1,i=new zU(this.oldLines,n),o=new zU(this.newLines,n),a=new YU(i,o),c=e(a.ComputeDiff(),i,o),l=r(c),u=[];{let p=0;for(let m of c)u=u.concat(this.oldLines.slice(p,m.originalStart)),u=u.concat(this.newLines.slice(m.modifiedStart,m.modifiedStart+m.modifiedLength)),p=m.originalStart+m.originalLength;u=u.concat(this.oldLines.slice(p))}if(c3(this.newLines,u))return new D_e(this.languageId,this.oldLines,this.edit,this.newLines,c,l);return Yft(this.languageId,this.oldLines,u);function f(p,m){let h=new KU(p),g=new KU(m),y=new YU(h,g).ComputeDiff(),E=0,b=0;for(let L of y)E+=L.originalLength,b+=L.modifiedLength;let S=p.length,R=m.length,B=E+b;return{aChanged:E,bChanged:b,aLength:S,bLength:R,editDistance:B}}}},P_e=class{constructor(e,r,n,i,o){this.originalStart=e;this.originalLength=r;this.modifiedStart=n;this.modifiedLength=i;this.editDistance=o}static{s(this,"DiffChangeWithEditDistance")}},D_e=class{constructor(e,r,n,i,o,a){this.languageId=e;this.oldLines=r;this.edit=n;this.newLines=i;this.diff=o;this.diffMetrics=a;this.parseErrorCount="unknown"}static{s(this,"PossibleEditWithDiff")}toLineEdit(e){if(e==="single")return new hs([this.edit]);{let r=this.groupInHunks();return new hs(r.map(n=>{let i=n[0],o=n[n.length-1];return new ry(new jr(i.originalStart+1,o.originalStart+o.originalLength+1),this.newLines.slice(i.modifiedStart,o.modifiedStart+o.modifiedLength))}))}}eliminateLargeChangeHunks(){if(!B_e)return this;let e=this.groupInHunks(),r=[];for(let n of e)n.every(o=>o.originalLength===0)||n.reduce((a,c)=>a+c.editDistance,0)>mhr&&(r=r.concat(n));if(r.length===this.diff.length)return null;if(r.length>0){let n=this._recreateNewLinesWithoutDiffs(r);return this._createPossibleEditFromLines(n)}return this}containWithinLines(e){let r=this.groupInHunks(),n=[];for(let i of r)for(let o of i){let a=o.originalStart+1,c=o.originalStart+o.originalLength+1;if(!M_e(new jr(a,c),e)){n=n.concat(i);break}}if(n.length===this.diff.length)return null;if(n.length>0){let i=this._recreateNewLinesWithoutDiffs(n);return this._createPossibleEditFromLines(i).containWithinLines(e)}return this}groupInHunks(){let e=[];for(let r of this.diff){let n=e.length>0?e[e.length-1]:null;if(!n){e.push([r]);continue}let i=n[n.length-1],o=this.oldLines.slice(i.originalStart+i.originalLength,r.originalStart);if(o.length>1){e.push([r]);continue}if(o[0].trim().length>10){e.push([r]);continue}if(n.reduce((l,u)=>l+u.originalLength,0)>1){e.push([r]);continue}n.push(r)}return e}_recreateNewLinesWithoutDiffs(e){let r=[],n=0;for(let i of e)r=r.concat(this.newLines.slice(n,i.modifiedStart)),r=r.concat(this.oldLines.slice(i.originalStart,i.originalStart+i.originalLength)),n=i.modifiedStart+i.modifiedLength;return r=r.concat(this.newLines.slice(n)),r}async resolveParseErrorCountIfPossible(e,r){let n=new hs([this.edit]),i=r(n);this.parseErrorCount=await XU(e,this.languageId,i)}eliminateEmptyLineChanges(){let e=s(r=>this._createPossibleEditFromLines(r).eliminateEmptyLineChanges(),"recurseWithNewLines");for(let r of this.diff){let n=this.oldLines.slice(r.originalStart,r.originalStart+r.originalLength),i=this.newLines.slice(r.modifiedStart,r.modifiedStart+r.modifiedLength);if(r.modifiedLength===0){if(n.every(a=>a.trim().length===0)){let a=this.newLines.slice(0);return a.splice(r.modifiedStart,0,...n),e(a)}continue}if(r.originalLength===0){if(i.every(a=>a.trim().length===0)){let a=this.newLines.slice(0);return a.splice(r.modifiedStart,r.modifiedLength),e(a)}continue}for(let o=0;o<n.length&&o<i.length;o++){let a=n[o],c=i[o],l=a.trim().length===0,u=c.trim().length===0;if(!(l&&u)){if(!l&&!u)break;if(l){let f=this.newLines.slice(0);return f.splice(r.modifiedStart+o,0,a),e(f)}if(u){let f=this.newLines.slice(0);return f.splice(r.modifiedStart+o,1),e(f)}}}for(let o=1;o<=n.length&&o<=i.length;o++){let a=n[n.length-o],c=i[i.length-o],l=a.trim().length===0,u=c.trim().length===0;if(!(l&&u)){if(!l&&!u)break;if(l){let f=this.newLines.slice(0);return f.splice(r.modifiedStart+r.modifiedLength-o+1,0,a),e(f)}if(u){let f=this.newLines.slice(0);return f.splice(r.modifiedStart+r.modifiedLength-o,1),e(f)}}}}return this}eliminateInsertedOrDeletedComments(){let e=[],r=0,n=!1;for(let i of this.diff){e=e.concat(this.newLines.slice(r,i.modifiedStart));let o=this.oldLines.slice(i.originalStart,i.originalStart+i.originalLength),a=this.newLines.slice(i.modifiedStart,i.modifiedStart+i.modifiedLength),{hasChanges:c,newDiffModifiedLines:l}=this._eliminateCommentsDiff(o,a);n=n||c,e=e.concat(l),r=i.modifiedStart+i.modifiedLength}return e=e.concat(this.newLines.slice(r)),n?this._createPossibleEditFromLines(e):this}_eliminateCommentsDiff(e,r){if(r.length===0){let l=!1,u=!1;for(let f of e){if(f.trim().length===0)continue;let p=Oie(f,this.languageId);p&&p.content.trim().length===0?l=!0:u=!0}if(l&&!u)return{hasChanges:!0,newDiffModifiedLines:e}}let n=e.map(l=>Oie(l,this.languageId)),i=r.map(l=>Oie(l,this.languageId)),o=n.filter(l=>!!l).length,a=i.filter(l=>!!l).length;if(o===0&&a===0)return{hasChanges:!1,newDiffModifiedLines:r};if(o>0)return{hasChanges:!1,newDiffModifiedLines:r};let c=!1;for(let l=0;l<r.length;l++){let u=r[l],f=i[l];if(!f)continue;let{content:p}=f;r[l]=u.substring(0,p.length).trimEnd(),c=!0}return{hasChanges:c,newDiffModifiedLines:r}}_createPossibleEditFromLines(e){return Yft(this.languageId,this.oldLines,e)}};function M_e(t,e){return e.startLineNumber<t.startLineNumber&&t.startLineNumber<e.endLineNumberExclusive&&t.endLineNumberExclusive<=e.endLineNumberExclusive}s(M_e,"editIsInsideEditWindow");function Yft(t,e,r){let i=e.length+1,o=r.slice(0);return new M8(t,e,new jr(1,i),o).resolveDiff()}s(Yft,"createPossibleEditFromLines");function Vie(t,e,r,n,i,o){if(i.trim().length===0)return[];let a=P8.fromString(i.trimEnd()),c=o?a.some(y=>y.indexOf(o.omittedMessage)>=0):!1,l=[],u=s((y,E)=>{l.push(new M8(t,e,y,E))},"generateEdit");function f(){n&&u(n,a)}s(f,"generateEditCompletionRange");function p(){if(c)return;let E=new jr(r.endLineNumberExclusive,e.length+1);E.length>a.length+5||u(E,a)}s(p,"generateEditAllDoc");function m(){for(let y=1;y<a.length;y++){let b=a.slice(a.length-y).join(`
`);for(let S=r.endLineNumberExclusive-1;S<e.length;S++){let B=e.slice(S,S+y).join(`
`);b===B&&u(new jr(r.endLineNumberExclusive,S+1),a.slice(0,a.length-y))}}}s(m,"generateEditsUsingOverlappingLines");function h(){if(!o||!c)return;let y=[];for(let E of a){if(E.indexOf(o.omittedMessage)>=0){u(o.editRange,y.map(b=>b));return}y.push(E)}}if(s(h,"generateEditWhenReplyContainsOmittedMessage"),f(),h(),p(),m(),!i.endsWith(`
`)){let y=i.substring(0,i.lastIndexOf(`
`)+1);l.push(...Vie(t,e,r,n,y,o))}return g(l);function g(y){return A(y,s(b=>b.edit.lineRange.startLineNumber+","+b.edit.lineRange.endLineNumberExclusive+","+b.edit.newLines.join("|"),"keyfn"))}function A(y,E){let b=new Set,S=[];for(let R of y){let B=E(R);b.has(B)||(b.add(B),S.push(R))}return S}}s(Vie,"generatePossibleEdits");async function L_e(t,e,r,n){let a=e.filter(p=>p.hasEditWithinFirstLines(n.requireEditWithinNLines)).map(p=>p.resolveDiff()).map(p=>p.eliminateEmptyLineChanges()),c=Gie?await XU(t,r.languageId,r.documentAfterEditsNoShortening.value):"unknown";if(Gie){let p=s(m=>{let h=r.documentAfterEditsNoShortening;return r.toEditOnDocumentAfterEditsNoShortening(m).apply(h.value)},"applyToDocumentNoShortening");await Promise.all(a.map(m=>m.resolveParseErrorCountIfPossible(t,p)))}let l=a.filter(p=>c==="unknown"?p.parseErrorCount===0:p.parseErrorCount!=="unknown"&&p.parseErrorCount<=c),u=l.length>0?l:a;u.sort((p,m)=>p.parseErrorCount===m.parseErrorCount?0:p.parseErrorCount==="unknown"?1:m.parseErrorCount==="unknown"?-1:p.parseErrorCount-m.parseErrorCount);let f=s(p=>p.diffMetrics.editDistance,"score");return u.sort((p,m)=>f(p)-f(m)),u.length>0?u[0].edit:null}s(L_e,"selectBestEdit");function Chr(t){let r=[],n=t.documentLinesBeforeEdit,i=0,o=0,a=-1,c=s((l,u)=>{l>a+1&&r.push("[...]"),u?r.push(`-${n[l]}`):r.push(`${n[l]}`),a=l},"addOldLineIndex");for(let l of t.recentEdit.edits){for(;i<l.lineRange.startLineNumber-1;)Math.min(l.lineRange.startLineNumber-i-1,o>0?i-o-2:1073741824)<=2&&c(i,!1),i++;for(;i<l.lineRange.endLineNumberExclusive-1;)c(i,!0),i++;r.push(l.newLines.map(u=>`+${u}`).join(`
`)),o=l.lineRange.endLineNumberExclusive}for(;i<n.length;)i-o+2<=2&&c(i,!1),i++;return r.push("[...]"),r}s(Chr,"summariseDocDiff");function Jft(t){let e=[];for(let r of t.recentEdit.edits){let n=t.documentLinesBeforeEdit.slice(r.lineRange.startLineNumber-1,r.lineRange.endLineNumberExclusive-1),i=r.newLines;if(n.filter(a=>a.trim().length>0).length===0&&i.filter(a=>a.trim().length>0).length===0)continue;let o=r.lineRange.startLineNumber+t.clippingRange.startLineNumber-1;e.push(`@@ -${o},${n.length} +${o},${i.length} @@`),e.push(...n.map(a=>`-${a}`)),e.push(...i.map(a=>`+${a}`))}return e}s(Jft,"summarizeEditsAsUnifiedDiff");async function XU(t,e,r){return await t.getTreeSitterAST({languageId:e,getText:s(()=>r,"getText")})?.getParseErrorCount()??"unknown"}s(XU,"getParseErrorCount");d();var vE=Be(Aa());d();var ZU=Yp("ITokenizerProvider");var nS=class extends vE.PromptRenderer{constructor(r,n,i={validate:!0},o,a,c){let l=o.acquireTokenizer({tokenizer:c.tokenizerName}),u={modelMaxPromptTokens:c.tokenBudget};super(u,r,n,l);this.options=i;this._instantiationService=a}static{s(this,"PromptRenderer")}static create(r,n,i,o={validate:!0}){return r.invokeFunction(a=>{let c=a.get(ZU);return new nS(n,i,o,c,r,a.get(dy))})}createElement(r,...n){return this._instantiationService.createInstance(r.ctor,r.props,...n)}async render(r,n,i){let o=await super.render(r,n);i={...{trace:!0},...i};for(let l=1;l<o.messages.length;l++){let u=o.messages[l],f=o.messages[l-1];if(u.role===vE.Raw.ChatRole.System&&f.role===vE.Raw.ChatRole.System){let p=f.content.at(-1),m=u.content.at(0);p&&m&&p.type===vE.Raw.ChatCompletionContentPartKind.Text&&m.type===vE.Raw.ChatCompletionContentPartKind.Text?(p.text=p.text.trimEnd()+`
`+m.text,f.content=f.content.concat(u.content.slice(1))):(f.content.push({type:vE.Raw.ChatCompletionContentPartKind.Text,text:`
`}),f.content=f.content.concat(u.content)),o.messages.splice(l,1),l--}}let c=o.messages[o.messages.length-1];if(this.options.validate&&c&&c.role!==vE.Raw.ChatRole.User)throw new Error("Sorry, this message is too long. Please try a shorter question.");return{...o,references:[]}}async countTokens(r){return(await super.render(void 0,r)).tokenCount}};nS=uf([Ta(3,ZU),Ta(4,D1),Ta(5,dy)],nS);d();var Xft=Be(Aa());var zie=class extends Xft.PromptElement{static{s(this,"SafetyRules")}render(){return vscpp(vscppf,null,"Follow Microsoft content policies.",vscpp("br",null),"Avoid content that violates copyrights.",vscpp("br",null),`If you are asked to generate content that is harmful, hateful, racist, sexist, lewd, violent, or completely irrelevant to software engineering, only respond with "Sorry, I can't assist with that."`,vscpp("br",null),"Keep your answers short and impersonal.",vscpp("br",null))}};d();var F_e=class{static{s(this,"AbstractDocument")}rangeToOffsetRange(e){return new Vt(this.getOffsetAtPosition(e.start),this.getOffsetAtPosition(e.end))}offsetRangeToRange(e){return new Kp(this.getPositionAtOffset(e.start),this.getPositionAtOffset(e.endExclusive))}},fy=class extends F_e{constructor(r){super();this.value=r;this._transformer=new Hk(this.value)}static{s(this,"StringTextDocument")}getText(){return this.value}getLineText(r){let n=this._transformer.getOffset(new Wr(r+1,1)),i=n+this.getLineLength(r);return this.value.substring(n,i)}getLineLength(r){return this._transformer.getLineLength(r+1)}getLineCount(){return this._transformer.textLength.lineCount+1}getTextInOffsetRange(r){return r.substring(this.value)}getPositionAtOffset(r){return vhr(this._transformer.getPosition(r))}getOffsetAtPosition(r){return r=this._validatePosition(r),this._transformer.getOffset(xhr(r))}_validatePosition(r){if(r.line<0)return new os(0,0);let n=this._transformer.textLength.lineCount+1;if(r.line>=n){let o=this._transformer.getLineLength(n);return new os(n-1,o)}if(r.character<0)return new os(r.line,0);let i=this._transformer.getLineLength(r.line+1);return r.character>i?new os(r.line,i):r}};function vhr(t){return new os(t.lineNumber-1,t.column-1)}s(vhr,"corePositionToVSCodePosition");function xhr(t){return new Wr(t.line+1,t.character+1)}s(xhr,"vsCodePositionToCorePosition");d();d();function Zft(t){if(t.length===0)return 1/0;let e=t[0];for(let r=1;r<t.length;r++)e=Math.min(e,t[r]);return e}s(Zft,"min");d();function O_e(t,e){let r=e(t);return{...r,range:[r.range.start,r.range.endExclusive],children:r.children?.map(n=>O_e(n,e))}}s(O_e,"toAstNode");function ept(t,e){let r=s3(e,a=>a.endExclusive>=t.start),n=RA(e,a=>a.start<=t.endExclusive)+1;if(r===n)return[t];let i=[],o=t.start;for(let a=r;a<n;a++){let c=e[a];c.start>o&&i.push(new Vt(o,c.start)),o=c.endExclusive}return o<t.endExclusive&&i.push(new Vt(o,t.endExclusive)),i}s(ept,"subtractRange");d();d();d();var Kie=class{static{s(this,"PrefixSumComputer")}constructor(e){this.values=e,this.prefixSum=new Uint32Array(e.length),this.prefixSumValidIndex=new Int32Array(1),this.prefixSumValidIndex[0]=-1}getCount(){return this.values.length}insertValues(e,r){e=KR(e);let n=this.values,i=this.prefixSum,o=r.length;return o===0?!1:(this.values=new Uint32Array(n.length+o),this.values.set(n.subarray(0,e),0),this.values.set(n.subarray(e),e+o),this.values.set(r,e),e-1<this.prefixSumValidIndex[0]&&(this.prefixSumValidIndex[0]=e-1),this.prefixSum=new Uint32Array(this.values.length),this.prefixSumValidIndex[0]>=0&&this.prefixSum.set(i.subarray(0,this.prefixSumValidIndex[0]+1)),!0)}setValue(e,r){return e=KR(e),r=KR(r),this.values[e]===r?!1:(this.values[e]=r,e-1<this.prefixSumValidIndex[0]&&(this.prefixSumValidIndex[0]=e-1),!0)}removeValues(e,r){e=KR(e),r=KR(r);let n=this.values,i=this.prefixSum;if(e>=n.length)return!1;let o=n.length-e;return r>=o&&(r=o),r===0?!1:(this.values=new Uint32Array(n.length-r),this.values.set(n.subarray(0,e),0),this.values.set(n.subarray(e+r),e),this.prefixSum=new Uint32Array(this.values.length),e-1<this.prefixSumValidIndex[0]&&(this.prefixSumValidIndex[0]=e-1),this.prefixSumValidIndex[0]>=0&&this.prefixSum.set(i.subarray(0,this.prefixSumValidIndex[0]+1)),!0)}getTotalSum(){return this.values.length===0?0:this._getPrefixSum(this.values.length-1)}getPrefixSum(e){return e<0?0:(e=KR(e),this._getPrefixSum(e))}_getPrefixSum(e){if(e<=this.prefixSumValidIndex[0])return this.prefixSum[e];let r=this.prefixSumValidIndex[0]+1;r===0&&(this.prefixSum[0]=this.values[0],r++),e>=this.values.length&&(e=this.values.length-1);for(let n=r;n<=e;n++)this.prefixSum[n]=this.prefixSum[n-1]+this.values[n];return this.prefixSumValidIndex[0]=Math.max(this.prefixSumValidIndex[0],e),this.prefixSum[e]}getIndexOf(e){e=Math.floor(e),this.getTotalSum();let r=0,n=this.values.length-1,i=0,o=0,a=0;for(;r<=n;)if(i=r+(n-r)/2|0,o=this.prefixSum[i],a=o-this.values[i],e<a)n=i-1;else if(e>=o)r=i+1;else break;return new Q_e(i,e-a)}};var Q_e=class{constructor(e,r){this.index=e;this.remainder=r;this._prefixSumIndexOfResultBrand=void 0;this.index=e,this.remainder=r}static{s(this,"PrefixSumIndexOfResult")}};var eq=class{static{s(this,"PositionOffsetTransformer")}constructor(e){this._lines=Lh(e),this._eol=e.charAt(this._lines[0].length)==="\r"?`\r
`:`
`;let r=new Uint32Array(this._lines.length);for(let n=0;n<this._lines.length;n++)r[n]=this._lines[n].length+this._eol.length;this._lineStarts=new Kie(r)}_getText(){return this._lines.join(this._eol)}applyOffsetEdits(e){let{edits:r}=e;for(let n=r.length-1;n>=0;n--){let i=r[n],o=this.toRange(i.replaceRange);this._acceptDeleteRange(o),this._acceptInsertText(o.start,i.newText)}}_acceptDeleteRange(e){if(e.start.line===e.end.line){if(e.start.character===e.end.character)return;this._setLineText(e.start.line,this._lines[e.start.line].substring(0,e.start.character)+this._lines[e.start.line].substring(e.end.character));return}this._setLineText(e.start.line,this._lines[e.start.line].substring(0,e.start.character)+this._lines[e.end.line].substring(e.end.character)),this._lines.splice(e.start.line+1,e.end.line-e.start.line),this._lineStarts.removeValues(e.start.line+1,e.end.line-e.start.line)}_acceptInsertText(e,r){if(r.length===0)return;let n=Lh(r);if(n.length===1){this._setLineText(e.line,this._lines[e.line].substring(0,e.character)+n[0]+this._lines[e.line].substring(e.character));return}n[n.length-1]+=this._lines[e.line].substring(e.character),this._setLineText(e.line,this._lines[e.line].substring(0,e.character)+n[0]);let i=new Uint32Array(n.length-1);for(let o=1;o<n.length;o++)this._lines.splice(e.line+1+o-1,0,n[o]),i[o-1]=n[o].length+this._eol.length;this._lineStarts.insertValues(e.line+1,i)}_setLineText(e,r){this._lines[e]=r,this._lineStarts.setValue(e,this._lines[e].length+this._eol.length)}getLineCount(){return this._lines.length}getOffset(e){return e=this.validatePosition(e),this._lineStarts.getPrefixSum(e.line-1)+e.character}getPosition(e){e=Math.floor(e),e=Math.max(0,e);let r=this._lineStarts.getIndexOf(e),n=this._lines[r.index].length;return new os(r.index,Math.min(r.remainder,n))}toRange(e){return new Kp(this.getPosition(e.start),this.getPosition(e.endExclusive))}toOffsetRange(e){return new Vt(this.getOffset(e.start),this.getOffset(e.end))}toOffsetEdit(e){let r=e.map(n=>new k8(this.validateRange(n.range),n.newText));return new tg(r.map(n=>new yl(this.toOffsetRange(n.range),n.newText)))}toTextEdits(e){return e.edits.map(r=>new k8(this.toRange(r.replaceRange),r.newText))}validatePosition(e){if(!(e instanceof os))throw new Error("Invalid argument");if(this._lines.length===0)return e.with(0,0);let{line:r,character:n}=e,i=!1;if(r<0)r=0,n=0,i=!0;else if(r>=this._lines.length)r=this._lines.length-1,n=this._lines[r].length,i=!0;else{let o=this._lines[r].length;n<0?(n=0,i=!0):n>o&&(n=o,i=!0)}return i?new os(r,n):e}validateRange(e){return new Kp(this.validatePosition(e.start),this.validatePosition(e.end))}};var Yie=class{constructor(e,r){this.originalText=e;this.edits=r;this._positionOffsetTransformer=new Mh(()=>new eq(this.text));this._originalPositionOffsetTransformer=new Mh(()=>new eq(this.originalText));this._text=new Mh(()=>this.edits.apply(this.originalText))}static{s(this,"ProjectedText")}get positionOffsetTransformer(){return this._positionOffsetTransformer.value}get originalPositionOffsetTransformer(){return this._originalPositionOffsetTransformer.value}get text(){return this._text.value}get lineCount(){return this.positionOffsetTransformer.getLineCount()}get isOriginal(){return this.edits.isEmpty||this.edits.isNoop(this.originalText)}project(e){return this.edits.applyToOffset(e)}projectOffsetRange(e){return this.edits.applyToOffsetRange(e)}projectRange(e){let r=this.originalPositionOffsetTransformer.toOffsetRange(e),n=this.projectOffsetRange(r);return this.positionOffsetTransformer.toRange(n)}projectOffsetEdit(e){return e.tryRebase(this.edits)}projectBack(e){return this.edits.applyInverseToOffset(e)}projectBackOffsetEdit(e){return e.tryRebase(this.edits.inverse(this.originalText))}projectBackTextEdit(e){let r=this.positionOffsetTransformer.toOffsetEdit(e),n=this.projectBackOffsetEdit(r);return this.originalPositionOffsetTransformer.toTextEdits(n)}};var U_e=class{constructor(e,r,n,i,o){this.parent=e;this.overlayNode=r;this.range=n;this.children=i;this._document=o}static{s(this,"RemovableNode")}get kind(){return this.overlayNode.kind}get text(){return this._document.getTextInOffsetRange(this.range)}},eP=class extends Yie{constructor(r,n){super(r.getText(),n);this.baseDocument=r}static{s(this,"ProjectedDocument")}getLanguageId(){return this.baseDocument.languageId}};function Xie(t,e,r){let n=[],i=[],o=[];for(let c=0;c<r.length;c++){let{document:l,overlayNodeRoot:u,selection:f}=r[c],p=l.getText(),m=f?l.rangeToOffsetRange(f):void 0,h=tpt(u,l),g=q_e.fromRootNode(h,p),A=H_e.fromNode(g,!!e.tryPreserveTypeChecking,!!e.alwaysUseEllipsisForElisions);m&&A.visitAll(O=>O.node.range.intersectsOrTouches(m)?(O.node.children.length===0&&O.markAsSurviving(),!0):!1),n.push(A),i.push(A.getTextFragment());let y=s(O=>m?O.range.endExclusive<m.start?m.start-O.range.endExclusive:O.range.start>m.endExclusive?3*(O.range.start-m.endExclusive):0:0,"distanceScoreToSelection"),E=new Bx(O=>m?O.children.length===0?O.range.intersectsOrTouches(m)?0:Number.MAX_SAFE_INTEGER:Zft(O.children.map(Y=>E.get(Y)))+1:0),b=new Bx(O=>{let Y=O.parent?b.get(O.parent):Number.MAX_SAFE_INTEGER,V=E.get(O);return Math.min(Y,V)}),S=!!e.tryPreserveTypeChecking,R=s(O=>S&&O.node?.kind==="import_statement"?0:100*b.get(O)+O.depth+10*(y(O)/p.length),"costFn"),B=typeof e.costFnOverride=="object"?e.costFnOverride.createCostFn(l):e.costFnOverride;if(B!==void 0){let O=R;R=s(Y=>{let V=O(Y);return V===!1?!1:Y.node?B(Y.node,V,l):V},"costFn")}let L=A.getDescendantsAndSelf();for(let O of L){if(!O.node.node)continue;let Y=R(O.node);Y!==!1&&o.push({idx:c,node:O,cost:Y})}}o.sort(wh(c=>c.cost,Sh));for(let{node:c,idx:l}of o){if(c.markAsSurviving(),n.reduce((f,p)=>f+p.getTextFragment().length,0)>t)break;i[l]=n[l].getTextFragment()}let a=[];for(let c=0;c<i.length;c++){let l=i[c],{document:u}=r[c],f=new eP(u,l.toTextEditFromOriginal(u.getText().length)),p=f,m=n[c];p.getVisualization=()=>({$fileExtension:"ast.w",source:{value:f.originalText,decorations:ept(Vt.ofLength(f.originalText.length),f.edits.edits.map(h=>h.replaceRange)).map(h=>({range:[h.start,h.endExclusive],color:"lime"}))},root:O_e(m,h=>({label:(h.node.node?.kind||"unknown")+` (${o.find(g=>g.node===h)?.cost})`,range:h.node.range,children:h.childNodes,isMarked:h._surviving}))}),a.push(f)}return a}s(Xie,"summarizeDocumentsSyncImpl");function tpt(t,e,r=void 0){let n=new Vt(t.startIndex,t.endIndex),i=[],o=new U_e(r,t,n,i,e);for(let a of t.children)i.push(tpt(a,e,o));return o}s(tpt,"createRemovableNodeFromOverlayNode");var q_e=class t{constructor(e,r,n,i,o,a){this.node=e;this.range=r;this.children=n;this.depth=i;this.parent=o;this.document=a}static{s(this,"TextNode")}static fromRootNode(e,r){let n=new Vt(0,r.length);if(e.range.equals(n))return t.fromNode(e,r);let i=new Vt(0,e.range.start),o=new Vt(e.range.endExclusive,r.length),a=[],c=new t(void 0,n,a,0,null,r);return i.isEmpty||a.push(new t(void 0,i,[],0,c,r)),a.push(t.fromNode(e,r,1,null)),o.isEmpty||a.push(new t(void 0,o,[],0,c,r)),c}static fromNode(e,r,n=0,i=null){let o=[],a=new t(e,e.range,o,n,i,r);if(e.children.length>0){let c=e.range.start;for(let u of e.children){let f=new Vt(c,u.range.start);f.isEmpty||o.push(new t(void 0,f,[],n,a,r)),o.push(t.fromNode(u,r,n+1,a)),c=u.range.endExclusive}let l=new Vt(c,e.range.endExclusive);l.isEmpty||o.push(new t(void 0,l,[],n,a,r))}return a}getLeadingWs(){return Ehr(this.document,this.range)}getTrailingWs(){return bhr(this.document,this.range)}};function Ehr(t,e){let r=e.substring(t),n=r.length-r.trimStart().length;return r.substring(0,n)}s(Ehr,"getLeadingWs");function bhr(t,e){let r=e.substring(t),n=r.length-r.trimEnd().length;return r.substring(r.length-n)}s(bhr,"getTrailingWs");var H_e=class t{constructor(e,r,n,i,o){this.node=e;this.parent=r;this.childNodes=n;this._tryPreserveTypeChecking=i;this._alwaysUseEllipsisForElisions=o;this._surviving=!1;this._textFragment=null}static{s(this,"SurvivingTextNode")}static fromNode(e,r,n){return t.fromNodeParent(e,null,r,n)}static fromNodeParent(e,r,n,i){let o=[],a=new t(e,r,o,n,i);for(let c of e.children){let l=t.fromNodeParent(c,a,n,i);o.push(l)}return a}visitAll(e){if(e(this))for(let r of this.childNodes)r.visitAll(e)}markAsSurviving(){this._surviving||(this._surviving=!0,this.parent&&this.parent.markAsSurviving(),this.invalidate())}invalidate(){this._textFragment&&(this._textFragment=null,this.parent&&this.parent.invalidate())}getTextFragment(){return this._textFragment||(this._textFragment=this._computeSummarization()),this._textFragment}_computeSummarization(){if(this.childNodes.length===0&&(this._surviving||!this.node.node))return new iS(this.node.range,this.node.document);if(!this._surviving)return new Zk("");let e=Array.from(LR(this.childNodes.map(n=>({node:n,fragment:n.getTextFragment()})),(n,i)=>n.fragment.length===0==(i.fragment.length===0)));for(let n=0;n<e.length;n++){let i=e[n],o=i[0].fragment.length===0;if(o&&n>0&&n<e.length-1){let a=e[n-1].at(-1),c=e[n+1].at(0);if(a.fragment instanceof iS&&c.fragment instanceof iS){let l=a.fragment.trimEnd(),u=c.fragment.trimStart();if(l.endsWith("{")&&u.startsWith("}")){e[n-1][e[n-1].length-1].fragment=l,i.length=1,i[0].fragment=new Zk(this._tryPreserveTypeChecking?"/ * ... * /":"\u2026"),e[n+1][0].fragment=u;continue}}}if(this._alwaysUseEllipsisForElisions&&o&&(n>0||n<e.length-1)){i.length=1;let a=i.at(0).node.node.getLeadingWs(),c=a.lastIndexOf(`
`);c!==-1&&(a=a.substring(c+1));let l=i.at(-1).node.node.getTrailingWs();i[0].fragment=new Zk(a+(this._tryPreserveTypeChecking?"/ * ... * /":"\u2026")+l)}}let r=[];for(let n of e)for(let i of n)Ihr(r,i.fragment);return Jie.from(r)}getDescendantsAndSelf(){let e=[];return this._getDescendantsAndSelf(e),e}_getDescendantsAndSelf(e){e.push(this);for(let r of this.childNodes)r._getDescendantsAndSelf(e)}},tq=class{static{s(this,"TextFragment")}toString(){return this.text}toTextEditFromOriginal(e){let r=[],n=0,i="";function o(c){(n!==c||i.length>0)&&(r.push(new yl(new Vt(n,c),i)),i="")}s(o,"emit");function a(c){if(c instanceof Jie)for(let l of c.fragments)a(l);else c instanceof Zk?i+=c.text:c instanceof iS&&(o(c.range.start),n=c.range.endExclusive)}return s(a,"process"),a(this),o(e),new tg(r)}},Zk=class extends tq{constructor(r){super();this.text=r}static{s(this,"LiteralTextFragment")}get length(){return this.text.length}},iS=class t extends tq{constructor(r,n){super();this.range=r;this.originalText=n}static{s(this,"OriginalTextFragment")}get length(){return this.range.length}get text(){return this.range.substring(this.originalText)}trimStart(){let r=this.text.trimStart();return r.length===this.length?this:new t(new Vt(this.range.endExclusive-r.length,this.range.endExclusive),this.originalText)}trimEnd(){let r=this.text.trimEnd();return r.length===this.length?this:new t(new Vt(this.range.start,this.range.start+r.length),this.originalText)}startsWith(r){return this.text.startsWith(r)}endsWith(r){return this.text.endsWith(r)}tryJoin(r){return this.range.endExclusive===r.range.start?new t(new Vt(this.range.start,r.range.endExclusive),this.originalText):null}},Jie=class t extends tq{constructor(r){super();this.fragments=r;this.length=this.fragments.reduce((r,n)=>r+n.length,0)}static{s(this,"ConcatenatedTextFragment")}static from(r){return r.length===0?new Zk(""):r.length===1?r[0]:new t(r)}get text(){return this.fragments.map(r=>r.text).join("")}};function Ihr(t,e){if(e.length===0)return;let r=t[t.length-1];if(r&&r instanceof iS&&e instanceof iS){let n=r.tryJoin(e);if(n){t[t.length-1]=n;return}}t.push(e)}s(Ihr,"pushFragment");d();var Zie=Be(Aa());function rq(t){if(Array.isArray(t))return t.map(r=>rq(r));let e=(0,Zie.toMode)(Zie.OutputMode.OpenAI,t);if("copilot_references"in t&&(e.copilot_references=t.copilot_references),"copilot_confirmations"in t&&(e.copilot_confirmations=t.copilot_confirmations),typeof e.content=="string")e.content=e.content.trimEnd();else for(let r of e.content)r.type==="text"&&(r.text=r.text.trimEnd());return e}s(rq,"rawMessageToCAPI");d();d();var eoe=class{constructor(e,r,n,i){this.startIndex=e;this.endIndex=r;this.kind=n;this.children=i;if(e>r)throw new xn("startIndex must be less than endIndex");let o=e;for(let a of i){if(a.startIndex<o)throw new xn("Invalid child startIndex");if(a.endIndex>r)throw new xn("Invalid child endIndex");o=Math.max(a.endIndex,o)}}static{s(this,"OverlayNode")}toString(){let e=[];function r(n,i=""){e.push(`${i}${n.kind} [${n.startIndex}, ${n.endIndex}]`),n.children.forEach(o=>r(o,i+"    "))}return s(r,"toString"),r(this),e.join(`
`)}};function npt(t,e,r){let n=t.getText().split(/\r\n|\r|\n/g),i=r||{tabSize:4},o={getLineCount:s(()=>n.length,"getLineCount"),getLineContent:s(a=>n[a-1],"getLineContent"),getOptions:s(()=>i,"getOptions")};try{let a=Thr(o,e),[c]=ipt(t,a,void 0);return c.adjust(t,opt(e)),c.toOverlayNode(t,!0)}catch{return new toe(1,t.getLineCount(),[]).toOverlayNode(t,!0)}}s(npt,"getStructureUsingIndentation");function ipt(t,e,r){if(typeof r<"u"&&r>=e.length)throw new Error(`Invalid region index ${r}`);let n=typeof r>"u"?1:e.getStartLineNumber(r),i=typeof r>"u"?t.getLineCount():e.getEndLineNumber(r),o=[],a=null;for(r=typeof r>"u"?0:r+1;r<e.length;){let c=e.getStartLineNumber(r),l=e.getEndLineNumber(r);if(c>i||l>i)break;let u=a;if([a,r]=ipt(t,e,r),u&&a.startLineNumber<=u.endLineNumber)throw new xn("Invalid Folding Ranges: overlapping children");if(a.startLineNumber<n)throw new xn("Invalid Folding Ranges: child starts before parent");o.push(a)}return[new toe(n,i,o),r]}s(ipt,"createFoldingRangeTree");var toe=class{constructor(e,r,n){this.startLineNumber=e;this.endLineNumber=r;this.children=n;if(e>r)throw new xn("Invalid Folding Ranges: startLineNumber > endLineNumber")}static{s(this,"FoldingRangeNode")}adjust(e,r){r?this._adjustOffside():this._adjustRegular(e,e.getLineCount())}_adjustOffside(){this.startLineNumber++;for(let e of this.children)e._adjustOffside()}_adjustRegular(e,r){if(this.endLineNumber<r){let n=e.getLineText(this.endLineNumber).trim(),i=/^[\}\]\)];?$/.test(n),o=/^<\/\w/.test(n);(i||o)&&this.endLineNumber++}for(let n=this.children.length-1;n>=0;n--){let i=this.children[n],o=n+1<this.children.length?this.children[n+1].startLineNumber-1:r;i._adjustRegular(e,o)}}toOverlayNode(e,r){let n=[],i=r&&this.startLineNumber===1?1:this.startLineNumber+1;for(let o of this.children){for(let a=i;a<o.startLineNumber;a++){let c=$_e(e,a,a,"LINE",[]);c&&n.push(c)}n.push(o.toOverlayNode(e,!1)),i=o.endLineNumber+1}for(let o=i;o<this.endLineNumber;o++){let a=$_e(e,o,o,"LINE",[]);a&&n.push(a)}return $_e(e,this.startLineNumber,this.endLineNumber,"FOLD",n)}};function $_e(t,e,r,n,i){let o=t.getOffsetAtPosition(new os(e-1,0)),a=r<t.getLineCount()?new os(r,0):new os(r-1,t.getLineLength(r-1)),c=t.getOffsetAtPosition(a);return new eoe(o,c,n,i)}s($_e,"createOverlayNode");function Thr(t,e){return whr(t,opt(e))}s(Thr,"generateFoldingRegions");function opt(t){return["clojure","coffeescript","fsharp","latex","markdown","pug","python","sql","yaml"].includes(t)}s(opt,"isOffSide");function whr(t,e){let r=t.getOptions().tabSize,n=new W_e,i=[],o=t.getLineCount()+1;i.push({indent:-1,endAbove:o,line:o});for(let a=t.getLineCount();a>0;a--){let c=t.getLineContent(a),l=_hr(c,r),u=i[i.length-1];if(l===-1){e&&(u.endAbove=a);continue}if(u.indent>l){do i.pop(),u=i[i.length-1];while(u.indent>l);let f=u.endAbove-1;f-a>=1&&n.insertFirst(a,f,l)}u.indent===l?u.endAbove=a:i.push({indent:l,endAbove:a,line:a})}return n.toIndentRanges()}s(whr,"_computeRanges");var Shr=65535,tP=16777215,rpt=4278190080,W_e=class{static{s(this,"RangesCollector")}constructor(){this._startIndexes=[],this._endIndexes=[],this._indentOccurrences=[],this._length=0}insertFirst(e,r,n){if(e>tP||r>tP)return;let i=this._length;this._startIndexes[i]=e,this._endIndexes[i]=r,this._length++,n<1e3&&(this._indentOccurrences[n]=(this._indentOccurrences[n]||0)+1)}toIndentRanges(){let e=new Uint32Array(this._length),r=new Uint32Array(this._length);for(let n=this._length-1,i=0;n>=0;n--,i++)e[i]=this._startIndexes[n],r[i]=this._endIndexes[n];return new j_e(e,r)}};function _hr(t,e){let r=0,n=0,i=t.length;for(;n<i;){let o=t.charCodeAt(n);if(o===32)r++;else if(o===9)r=r-r%e+e;else break;n++}return n===i?-1:r}s(_hr,"computeIndentLevel");var j_e=class{static{s(this,"FoldingRegions")}constructor(e,r){this._startIndexes=e,this._endIndexes=r,this._parentsComputed=!1}ensureParentIndices(){if(!this._parentsComputed){this._parentsComputed=!0;let e=[],r=s((n,i)=>{let o=e[e.length-1];return this.getStartLineNumber(o)<=n&&this.getEndLineNumber(o)>=i},"isInsideLast");for(let n=0,i=this._startIndexes.length;n<i;n++){let o=this._startIndexes[n],a=this._endIndexes[n];if(o>tP||a>tP)throw new Error("startLineNumber or endLineNumber must not exceed "+tP);for(;e.length>0&&!r(o,a);)e.pop();let c=e.length>0?e[e.length-1]:-1;e.push(n),this._startIndexes[n]=o+((c&255)<<24),this._endIndexes[n]=a+((c&65280)<<16)}}}get length(){return this._startIndexes.length}getStartLineNumber(e){return this._startIndexes[e]&tP}getEndLineNumber(e){return this._endIndexes[e]&tP}getParentIndex(e){this.ensureParentIndices();let r=((this._startIndexes[e]&rpt)>>>24)+((this._endIndexes[e]&rpt)>>>16);return r===Shr?-1:r}contains(e,r){return this.getStartLineNumber(e)<=r&&this.getEndLineNumber(e)>=r}findIndex(e){let r=0,n=this._startIndexes.length;if(n===0)return-1;for(;r<n;){let i=Math.floor((r+n)/2);e<this.getStartLineNumber(i)?n=i:r=i+1}return r-1}findRange(e){let r=this.findIndex(e);if(r>=0){if(this.getEndLineNumber(r)>=e)return r;for(r=this.getParentIndex(r);r!==-1;){if(this.contains(r,e))return r;r=this.getParentIndex(r)}}return-1}};d();function rP(t){return t instanceof Error?t:typeof t=="string"?new Error(t):new Error(`An unexpected error occurred: ${t}`)}s(rP,"fromUnknown");var Ul=Be(Aa());var roe="current-version",nP="next-version",apt=2,cpt=10,lpt=.7,Rhr=/```[^\n]*\n/,oS=class extends w8{constructor(r,n,i){super(oS.ID,[o=>new D8(o),o=>new _8(o),o=>new R8(o)]);this.fetcher=r;this._parserService=n;this._instantiationService=i;this.dependsOnSelection=!0;this.showNextEditPreference="always";this._delayer=new sie}static{s(this,"GhNearbyNesProvider")}static{this.ID="GhNearbyNesProvider"}canReuseResult(r,n){if(r.getActiveDocument().id!==n.getActiveDocument().id||r.documents.length!==n.documents.length)return!1;let i=new Map(r.documents.map(a=>[a.id,a]));for(let a of n.documents){let c=i.get(a.id);if(!c||!o(c,a))return!1}return!0;function o(a,c){if(a.documentAfterEditsNoShortening.value!==c.documentAfterEditsNoShortening.value)return!1;let l=Xk(a),u=l?G_e(a,l):null,f=Xk(c),p=f?G_e(c,f):null;return!u||!p?!0:Math.abs(u.line-p.line)<Math.min(apt,cpt)}}handleAcceptance(){this._delayer.handleAcceptance()}handleRejection(){this._delayer.handleRejection()}async provideNextEditBase(r,n){let i=new Zw(r),o=this._delayer.createDelaySession(),a;try{a=await this.doGetNextEdit(r,i,o,n)}catch(l){return eo.noEdit({kind:"unexpected",error:rP(l)},i)}let c=o.getArtificalDelay();return c>0&&await iE(c),a}async doGetNextEdit(r,n,i,o){return r.documents.some(l=>{if(l.recentEdit.edits.length===0)return!1;for(let u of l.recentEdit.edits)if(!u.lineRange.isEmpty||u.newLines.length>0)return!0;return!1})?await this.sendRequestAndProcessResult(r,i,o,n):eo.noEdit({kind:"activeDocumentHasNoEdits"},n)}async sendRequestAndProcessResult(r,n,i,o){let a=await this.createPrompt(r,i);if(!a)return eo.noEdit({kind:"noSuggestions"},o);if(!a.editWindowIsInPrompt)return eo.noEdit({kind:"filteredOut",message:"promptTooLarge"},o);if(await this.debounce(n,o),i.isCancellationRequested){let R={kind:"gotCancelled",message:"afterDebounce"};return eo.noEdit(R,o)}let{summarizedEditWindow:c,editWindowAllowedEditLineRange:l,allowedEditLineRange:u,maxCompletionLineCount:f,messages:p,completionPrefixRange:m,completionRange:h,convergence:g,activeDocument:A,activeDocumentLines:y}=a;o.setFetchStartedAt(),r.fetchIssued=!0;let E=await N_e(this.ID,this.fetcher,rq(p),{convergence:g,ignoreReplyTextBefore:Rhr,maxCompletionLineCount:f,convergenceNonWhitespaceCharOverlap:1e3},i);if(o.setFetchResultIfNotSet(E.isOk()?"success":E.err.kind==="cancel"||i.isCancellationRequested?"cancelled":"failure"),E.isOk()&&typeof E.val.ttft=="number"&&o.setTtft(E.val.ttft),i.isCancellationRequested)return eo.noEdit({kind:"gotCancelled",message:"afterFetchCall"},o);if(E.isError())return E.err.kind==="cancel"?eo.noEdit({kind:"gotCancelled",message:"afterFetchCall"},o):eo.noEdit({kind:"fetchFailure",error:rP(E.err.err)},o);let b=E.val.result;if(b.length===0){let R=`<${nP}>
`,B=E.val.ignored.indexOf(R);B>=0&&(b=E.val.ignored.substring(B+R.length))}if(b=khr(b),b.trim().length===0)return eo.noEdit({kind:"noSuggestions"},o);let S;if(c&&l&&u){let R=Phr(A,c,l,b);if(!R||R.edits.length===0)return eo.noEdit({kind:"filteredOut",message:"Content is identical or cannot get clean diff within edit window"},o);let B=Dhr(c,R);if(B.edits.length===0)return eo.noEdit({kind:"filteredOut",message:"No-op edit or could not map back to original document"},o);if(Gie){let Y=await XU(this._parserService,A.languageId,A.documentAfterEditsNoShortening.value),V=B.apply(A.documentAfterEditsNoShortening.value);if(await XU(this._parserService,A.languageId,V)>Y)return eo.noEdit({kind:"filteredOut",message:"More parse errors after edit"},o)}S=Bhr(A,B);let L=S.edits[0].lineRange.startLineNumber,O=S.edits[S.edits.length-1].lineRange.endLineNumberExclusive;if(!M_e(new jr(L,O),u))return eo.noEdit({kind:"filteredOut",message:"Outside edit window after projection"},o)}else{let R=Vie(A.languageId,y,m,h,b,void 0),B=await L_e(this._parserService,R,A,{requireEditWithinNLines:100});if(!B)return eo.noEdit({kind:"filteredOut",message:"Could not identify best edit"},o);S=new hs([B])}return Nhr(A,S)?eo.noEdit({kind:"filteredOut",message:"Undo of recent edit"},o):Mhr(A,S)?eo.noEdit({kind:"filteredOut",message:"Deletion of recent insertion"},o):Lhr(A,S)?eo.noEdit({kind:"filteredOut",message:"uncategorized"},o):Fhr(A,S)?eo.noEdit({kind:"filteredOut",message:"uncategorized"},o):eo.edit({edit:S},o)}async debounce(r,n){let i=r.getDebounceTime();n.setDebounceTime(i),await iE(i)}async createPrompt(r,n){let i=r.getActiveDocument(),a=i.documentAfterEdits.value.includes(`\r
`)?`\r
`:`
`,c=i.documentAfterEdits.value.split(a),l=Xk(i);if(l===null)return;let u=G_e(i,l),f=new fy(i.documentAfterEditsNoShortening.value),p=await Uhr(this._parserService,{getText:s(()=>f.getText(),"getText"),languageId:i.languageId}),{firstEditableLineInShortenedDocument:m,lastEditableLineInShortenedDocument:h,editWindow:g}=function(){let V=Ohr(i.documentAfterEditsLines,l.startLineNumber),z=Math.max(1,Math.min(V,l.startLineNumber-apt)),Q=l.startLineNumber-z,U=Math.min(c.length,l.endLineNumber+cpt),Z=U-l.endLineNumber,J=u.line-Q,j=u.line+Z,W=new Kp(J,0,j,f.getLineLength(j));return{firstEditableLineInShortenedDocument:z,lastEditableLineInShortenedDocument:U,editWindow:W}}(),A=Xie(0,{alwaysUseEllipsisForElisions:!0},[{overlayNodeRoot:p,document:f,selection:g}])[0],y=new jr(1,m),E=new jr(m,h+1),b=A.text,{messages:S,prediction:R,editWindowIsInPrompt:B}=await this._renderPrompt({request:r,activeDocumentSlice:b,languageId:i.languageId},n),L=b.split(/\r\n|\r|\n/).length,O=A.projectRange(g),Y=A.positionOffsetTransformer.toOffsetRange(O);return{summarizedEditWindow:A,editWindowAllowedEditLineRange:new jr(O.start.line+1,O.end.line+2),allowedEditLineRange:new jr(m,h+1),messages:S,prediction:R,editWindowIsInPrompt:B,activeDocument:i,activeDocumentLines:c,completionPrefixRange:y,completionRange:E,convergence:b,expectedConvergencePrefix:Y.start,maxCompletionLineCount:L+20}}async _renderPrompt(r,n){let o=await nS.create(this._instantiationService,z_e,r).render(void 0,n,{trace:!1}),a=o.metadata.get(aoe)?.prediction,c=!!o.metadata.get(ioe);return{messages:o.messages,prediction:a,editWindowIsInPrompt:c}}};oS=uf([Ta(0,dy),Ta(1,CE),Ta(2,D1)],oS);function khr(t){function e(r,n,i){let o=r.lastIndexOf(n);if(o===-1)return r;let a=r.slice(0,o);return a.trim().length>0?a+i:a}return s(e,"getStringBeforeLastPattern"),t=e(t,"\n```",`
`),t=e(t,`\`\`\`</${nP}>`,`
`),t=e(t,`\`\`\`
</${nP}>`,`
`),t=e(t,`</${nP}>`,`
`),t}s(khr,"removeSuffixFromReply");function G_e(t,e){let r=t.documentAfterEdits.getTransformer().getOffset(e.getEndPosition()),n=t.toOffsetOnDocumentAfterEditsNoShortening(r);return new fy(t.documentAfterEditsNoShortening.value).getPositionAtOffset(n)}s(G_e,"getCursorPositionInOuterDocument");function Phr(t,e,r,n){let i=P8.fromString(e.text),o=P8.fromString(n.trimEnd()),c=new M8(t.languageId,i,new jr(1,i.length+1),o).resolveDiff().eliminateEmptyLineChanges().eliminateInsertedOrDeletedComments().eliminateEmptyLineChanges(),l=e.isOriginal?c:c.containWithinLines(r);if(!l)return null;let u=B_e?l.eliminateLargeChangeHunks():l;return u?u.toLineEdit("multiple-hunks"):null}s(Phr,"generateSummarizedEditWindowEdit");function Dhr(t,e){let r=e.toEdit(new pu(t.text));return t.projectBackOffsetEdit(r.toOffsetEdit())}s(Dhr,"convertSummarizedEditWindowEditToOuterDocumentEdit");function Bhr(t,e){let r=e.edits.map(i=>{let o=i.replaceRange.start,a=t.toProjectedOffset(o);return Oa.replace(new Vt(a,a+i.replaceRange.length),i.newText)}),n=new Vd(t.documentAfterEdits,ga.create(r));return hs.fromEdit(n)}s(Bhr,"convertOuterDocumentEditToProjectedEdit");function Nhr(t,e){let r=e.toEdit(t.documentAfterEdits),n=upt(t.documentAfterEdits.value,r),i=new noe,o=t.documentBeforeEdits.value;for(let a of t.recentEdits.edits)i=i.combine(upt(o,a)),o=a.apply(o);return!!i.isUndoneBy(n)}s(Nhr,"editWouldUndo");function Mhr(t,e){let r=e.toEdit(t.documentAfterEdits);if(r=r.normalizeOnSource(t.documentAfterEdits.value),!hpt(r))return!1;for(let n=t.recentEdits.edits.length-1;n>=0;n--){let i=t.recentEdits.edits[n],o=r.tryRebase(i);if(!o)return!0;r=o}return!1}s(Mhr,"editWouldDeleteWhatWasJustInserted");function Lhr(t,e){let r=e.toEdit(t.documentAfterEdits);if(r=r.normalizeOnSource(t.documentAfterEdits.value),!hpt(r))return!1;for(let n of r.edits){let i=t.documentAfterEdits.value.substring(n.range.start,n.range.endExclusive);if(__e(i,t.languageId))return!0}return!1}s(Lhr,"editWouldDeleteAComment");function Fhr(t,e){if(e.edits.length!==1)return!1;let r=e.edits[0];if(!r.lineRange.isEmpty)return!1;let n=s(c=>c.trim().length>5,"isSignificantLine"),i=new Set(r.newLines.filter(n));if(i.size<=1)return!1;let o=new Set(t.documentAfterEditsLines.filter(n));return V_e(o,i)/i.size>.8}s(Fhr,"editWouldDuplicateExistingLines");function hpt(t){let e=t.edits.reduce((n,i)=>n+i.range.length,0);return t.edits.reduce((n,i)=>n+i.newText.length,0)===0&&e>0}s(hpt,"editIsDeletion");function Ohr(t,e){for(;e>0;){if(t[e-1].trim().length>0)return e;e--}return 1}s(Ohr,"findLineNumberAboveWithContent");var noe=class t{constructor(e=new Set,r=new Set){this.inserted=e;this.deleted=r}static{s(this,"InformationDelta")}combine(e){return new t(fpt(this.inserted,e.inserted),fpt(this.deleted,e.deleted))}isUndoneBy(e){let r=ppt(e.inserted,e.deleted),n=ppt(e.deleted,e.inserted),i=V_e(n,this.inserted),o=V_e(r,this.deleted);return n.size>6&&i/n.size>lpt||r.size>6&&o/r.size>lpt}};function upt(t,e){let r=new Set,n=new Set,i=s(a=>{if(!a)return;let c=t.substring(a.start,a.endExclusive);for(let l of c.split(/\r\n|\r|\n/)){l=l.trim();for(let u of dpt(l))n.add(u)}},"tryAddDeleted"),o=s(a=>{for(let c of a.split(/\r\n|\r|\n/)){c=c.trim();for(let l of dpt(c))r.add(l)}},"tryAddInserted");for(let a of e.edits){let c=a.removeCommonPrefix(t).removeCommonSuffix(t),l=a.removeCommonSuffix(t).removeCommonPrefix(t);c.isNeutral()||(i(c.range),i(l.range),i(c.range.intersect(l.range)),o(Qhr(c.newText,l.newText)))}return new noe(r,n)}s(upt,"getInformationDelta");function Qhr(t,e){let r=Math.min(t.length,e.length);for(let n=0;n<r;n++){let i=t.slice(0,t.length-n),o=e.slice(n);if(i===o)return i}return""}s(Qhr,"trimOverlap");function dpt(t){let e=[];for(let r=4;r<t.length;r++){let n=t.slice(r-4,r);e.push(n)}return e}s(dpt,"to4grams");function fpt(t,e){let r=new Set;for(let n of t)r.add(n);for(let n of e)r.add(n);return r}s(fpt,"setUnion");function ppt(t,e){let r=new Set;for(let n of t)e.has(n)||r.add(n);return r}s(ppt,"setMinus");function V_e(t,e){let r=0;for(let n of t)e.has(n)&&r++;return r}s(V_e,"setIntersectionCount");async function Uhr(t,e){let n=await t.getTreeSitterAST(e)?.getStructure();return n||npt(new fy(e.getText()),e.languageId,void 0)}s(Uhr,"getStructure");var z_e=class extends Ul.PromptElement{static{s(this,"GHNearbyPrompt")}async render(e,r){let{request:n,activeDocumentSlice:i,languageId:o}=this.props,a=[`<${nP}>`,`\`\`\`${o}`,`${i}`,"```",`</${nP}>`].join(`
`),c=(0,Ul.useKeepWith)();return vscpp(vscppf,null,vscpp("meta",{value:new aoe(a)}),vscpp(Ul.SystemMessage,{priority:1e3},vscpp(zie,null),this._getInstructions()),vscpp(Ul.UserMessage,{priority:900},"These are the files I'm working on, before I started making changes to them:",vscpp("br",null),"<original_code>",vscpp("br",null),n.documents.map((l,u)=>l.id===n.getActiveDocument().id?vscpp(c,{priority:300},vscpp(Ul.Chunk,{priority:300},vscpp(ooe,{doc:l}))):vscpp(Ul.Chunk,{priority:100+u},vscpp(ooe,{doc:l}))),vscpp("br",null),"</original_code>",vscpp("br",null),vscpp("br",null),"This is a sequence of edits that I made on these files, starting from the oldest to the newest:",vscpp("br",null),"<edits_to_original_code>",vscpp("br",null),n.documents.map((l,u)=>l.id===n.getActiveDocument().id?vscpp(c,{priority:300},vscpp(Ul.Chunk,{priority:300},vscpp(soe,{doc:l}))):vscpp(Ul.Chunk,{priority:200+u},vscpp(soe,{doc:l}))),vscpp("br",null),"</edits_to_original_code>",vscpp("br",null),vscpp("br",null),vscpp(c,{priority:300},vscpp(Ul.Chunk,{priority:300},vscpp("meta",{local:!0,value:new ioe}),"Here is the piece of code I am currently editing in"," ",n.getActiveDocument().getDisplayPath(),":",vscpp("br",null),vscpp("br",null),"<",roe,">",vscpp("br",null),"```",o,vscpp("br",null),i,vscpp("br",null),"```",vscpp("br",null),"</",roe,">",vscpp("br",null),vscpp("br",null),"Based on my most recent edits, what will I do next? Rewrite the code between <",roe,"> and </",roe,"> based on what I will do next. Do not skip any lines. Do not be lazy.",vscpp("br",null)))))}_getInstructions(){return vscpp(vscppf,null,"The programmer will provide you with a set of recently viewed files, their recent edits, and a snippet of code that is being actively edited.",vscpp("br",null),vscpp("br",null),"When helping the programmer, your goals are:",vscpp("br",null),"- Make only the necessary changes as indicated by the context.",vscpp("br",null),"- Avoid unnecessary rewrites and make only the necessary changes, using ellipses to indicate partial code where appropriate.",vscpp("br",null),"- Ensure all specified additions, modifications, and new elements (e.g., methods, parameters, function calls) are included in the response.",vscpp("br",null),"- Adhere strictly to the provided pattern, structure, and content, including matching the exact structure and formatting of the expected response.",vscpp("br",null),"- Maintain the integrity of the existing code while making necessary updates.",vscpp("br",null),"- Provide complete and detailed code snippets without omissions, ensuring all necessary parts such as additional classes, methods, or specific steps are included.",vscpp("br",null),"- Keep the programmer on the pattern that you think they are on.",vscpp("br",null),"- Consider what edits need to be made next, if any.",vscpp("br",null),vscpp("br",null),"When responding to the programmer, you must follow these rules:",vscpp("br",null),"- Only answer with the updated code. The programmer will copy and paste your code as is in place of the programmer's provided snippet.",vscpp("br",null),"- Match the expected response exactly, even if it includes errors or corruptions, to ensure consistency.",vscpp("br",null),"- Do not alter method signatures, add or remove return values, or modify existing logic unless explicitly instructed.",vscpp("br",null),"- You must ONLY reply using the tag: <",nP,">.")}},ioe=class extends Ul.PromptMetadata{static{s(this,"EditWindowMarkerMetadata")}},ooe=class extends Ul.PromptElement{static{s(this,"OriginalDocument")}async render(e,r){let{doc:n}=this.props,i=[];for(let o=0;o<n.documentLinesBeforeEdit.length;o++){let a=n.documentLinesBeforeEdit[o];i.push(`${n.clippingRange.startLineNumber+o}\u2502${a}`)}return vscpp(vscppf,null,n.getDisplayPath(),":",vscpp("br",null),i.join(`
`))}},soe=class extends Ul.PromptElement{static{s(this,"DocumentDiffs")}async render(e,r){let{doc:n}=this.props,i=[];return i.push("```"),i.push(`---${n.getDisplayPath()}:`),i.push(`+++${n.getDisplayPath()}:`),i.push(...Jft(n)),i.push("```"),vscpp(vscppf,null,i.join(`
`))}},aoe=class extends Ul.PromptMetadata{constructor(r){super();this.prediction=r}static{s(this,"PredictionMetadata")}};d();d();function gpt(t,e){let r=[];for(let[n,i]of t.entries())i===e&&r.push(n);return r}s(gpt,"findIndexes");function qhr(t,e,r,n=10){if(e.length===0)return e;let i=[...e],o=e.length-1;for(;o>=0&&e[o].trim()==="";)o--;if(o<0)return e;let a=gpt(r,e[o]).slice(0,n);for(let p of a){let m=!1,h=o;for(;h>=0&&p>=0;){let g=e[h],A=r[p];if(g===A)h--,p--;else if(A.trim()==="")p--;else{m=!0;break}}if(!m&&p===-1&&h!==e.length-1){e=e.slice(0,h+1);break}else e=[...i]}if(!e.length)return e;let c=0;for(;e.length&&e[c].trim()==="";)c++;let l=[...e],f=gpt(t,e[c]).slice(-n).reverse();for(let p of f){let m=!1,h=c;for(;h<e.length&&p<t.length;){let g=e[h],A=t[p];if(g===A)h++,p++;else if(A.trim()==="")p++;else{m=!0;break}}if(!m&&p===t.length&&h!==0){e=e.slice(h);break}else e=[...l]}return e}s(qhr,"deduplicateEditRegion");function Apt(t,e,r){let n=t.getLines(),i=n.slice(0,e[0]),o=n.slice(e[1]+1);return{updatedEditWindow:qhr(i,r.split(/\r?\n/),o).join(`
`)}}s(Apt,"postProcessUpdatedEditWindow");d();var coe=Be(Aa());function ypt(t){return t?typeof t=="string"?t:Array.isArray(t)?t.map(e=>e.type===coe.Raw.ChatCompletionContentPartKind.Text?e.text:"").join(""):t.type===coe.Raw.ChatCompletionContentPartKind.Text?t.text:"":""}s(ypt,"getTextPart");function Hhr(t){return{type:coe.Raw.ChatCompletionContentPartKind.Text,text:t}}s(Hhr,"toTextPart");function K_e(t){return[Hhr(t)]}s(K_e,"toTextParts");d();var loe=Yp("IDiffService");var e2e=Be(Aa());d();var uoe="<|cursor|>",iP="<|code_to_edit|>",L8="<|/code_to_edit|>",vpt="<|area_around_code_to_edit|>",xpt="<|/area_around_code_to_edit|>",$hr="<|current_file_content|>",Whr="<|/current_file_content|>",jhr="<|edit_diff_history|>",Ghr="<|/edit_diff_history|>",Vhr="<|recently_viewed_code_snippets|>",zhr="<|/recently_viewed_code_snippets|>",Khr="<|recently_viewed_code_snippet|>",Yhr="<|/recently_viewed_code_snippet|>",Ept=`Your role as an AI assistant is to help developers complete their code tasks by assisting in editing specific sections of code marked by the ${iP} and ${L8} tags, while adhering to Microsoft's content policies and avoiding the creation of content that violates copyrights.

You have access to the following information to help you make informed suggestions:

- recently_viewed_code_snippets: These are code snippets that the developer has recently looked at, which might provide context or examples relevant to the current task. They are listed from oldest to newest, with line numbers in the form #| to help you understand the edit diff history. It's possible these are entirely irrelevant to the developer's change.
- current_file_content: The content of the file the developer is currently working on, providing the broader context of the code. Line numbers in the form #| are included to help you understand the edit diff history.
- edit_diff_history: A record of changes made to the code, helping you understand the evolution of the code and the developer's intentions. These changes are listed from oldest to latest. It's possible a lot of old edit diff history is entirely irrelevant to the developer's change.
- area_around_code_to_edit: The context showing the code surrounding the section to be edited.
- cursor position marked as ${uoe}: Indicates where the developer's cursor is currently located, which can be crucial for understanding what part of the code they are focusing on.

Your task is to predict and complete the changes the developer would have made next in the ${iP} section. The developer may have stopped in the middle of typing. Your goal is to keep the developer on the path that you think they're following. Some examples include further implementing a class, method, or variable, or improving the quality of the code. Make sure the developer doesn't get distracted and ensure your suggestion is relevant. Consider what changes need to be made next, if any. If you think changes should be made, ask yourself if this is truly what needs to happen. If you are confident about it, then proceed with the changes.

# Steps

1. **Review Context**: Analyze the context from the resources provided, such as recently viewed snippets, edit history, surrounding code, and cursor location.
2. **Evaluate Current Code**: Determine if the current code within the tags requires any corrections or enhancements.
3. **Suggest Edits**: If changes are required, ensure they align with the developer's patterns and improve code quality.
4. **Maintain Consistency**: Ensure indentation and formatting follow the existing code style.

# Output Format

- Provide only the revised code within the tags. If no changes are necessary, simply return the original code from within the ${iP} and ${L8} tags.
- There are line numbers in the form #| in the code displayed to you above, but these are just for your reference. Please do not include the numbers of the form #| in your response.
- Ensure that you do not output duplicate code that exists outside of these tags. The output should be the revised code that was between these tags and should not include the ${iP} or ${L8} tags.

\`\`\`
// Your revised code goes here
\`\`\`

# Notes

- Apologize with "Sorry, I can't assist with that." for requests that may breach Microsoft content guidelines.
- Avoid undoing or reverting the developer's last change unless there are obvious typos or errors.
- Don't include the line numbers of the form #| in your response.`;function bpt(t,e,r,n){let i=t.getActiveDocument(),o=Zhr(t,n),a=Jhr(t,n,2e3),c=i.workspaceRoot===void 0?i.id.path:i.id.path.startsWith(i.workspaceRoot.path)?i.id.path.substring(i.workspaceRoot.path.length+1):i.id.path;return`
\`\`\`
${Vhr}
${o}
${zhr}

${$hr}
current_file_path: ${c}
${e}
${Whr}

${jhr}
${a}
${Ghr}

${r}
\`\`\`

The developer was working on a section of code within the tags \`code_to_edit\` in the file located at \`${c}\`. Using the given \`recently_viewed_code_snippets\`, \`current_file_content\`, \`edit_diff_history\`, \`area_around_code_to_edit\`, and the cursor position marked as \`${uoe}\`, please continue the developer's work. Update the \`code_to_edit\` section by predicting and completing the changes they would have made next. Provide the revised code that was between the \`${iP}\` and \`${L8}\` tags with the following format, but do not include the tags themselves.
\`\`\`
// Your revised code goes here
\`\`\`
`.trim()}s(bpt,"getUserPrompt");function Jhr(t,e,r){let n=[];for(let a of t.xtabEditHistory.reverse()){let c=Xhr(a);if(c===null)continue;let l=e(c);if(r-=l,r<0)break;n.push(c)}let i=n.reverse(),o=i.join(`

`);return i.length>0&&(o+=`
`),o}s(Jhr,"getEditDiffHistory");function Xhr(t){let e=[],r=hs.fromEdit(t.edit);for(let i of r.edits){let o=t.edit.base.getLines().slice(i.lineRange.startLineNumber-1,i.lineRange.endLineNumberExclusive-1),a=i.newLines;if(o.filter(l=>l.trim().length>0).length===0&&a.filter(l=>l.trim().length>0).length===0)continue;let c=i.lineRange.startLineNumber-1;e.push(`@@ -${c},${o.length} +${c},${a.length} @@`),e.push(...o.map(l=>`-${l}`)),e.push(...a.map(l=>`+${l}`))}return e.length===0?null:[`--- ${t.docId.path}`,`+++ ${t.docId.path}`,...e].join(`
`)}s(Xhr,"generateDocDiff");function Cpt(t,e,r=!1){let n=r?`code_snippet_file_path: ${t} (truncated)`:`code_snippet_file_path: ${t}`;return[Khr,n,e,Yhr].join(`
`)}s(Cpt,"formatCodeSnippet");function Zhr(t,e,r=2e3,n=!1){r=r||Number.POSITIVE_INFINITY;let i=t.getActiveDocument(),a=t.documents.filter(u=>u.id!==i.id).map(u=>({path:u.id.path,content:u.documentAfterEdits.value})),c=[],l=0;for(let u=a.length-1;u>=0;u--){let f=a[u],p=f.content.split(/\r?\n/);n&&(p=p.map((y,E)=>`${E+1}|${y}`));let m=p.map(y=>e(y)+1),h=e(Cpt(f.path,"",!0)),g=m.reduce((y,E)=>y+E,0)+h,A=!1;for(;p.length>0&&l+g>r;)p.pop(),g-=m.pop()||0,A=!0;p.length>0&&(l+=g,c.push(Cpt(f.path,p.join(`
`),A)))}return c.join(`

`)}s(Zhr,"getRecentCodeSnippets");function Y_e(t,e,r){if(!t.length)return[0,0];let n=r*4,i=0,o=e?t.length-1:0;for(;i<n;)if(i+=t[o].length+1,e){if(o--,o<0)break}else if(o++,o>=t.length)break;return e?[o+1,t.length]:[0,o]}s(Y_e,"truncateCode");var Ipt=2,Tpt=10,J_e=15,X_e=1e3,Z_e=2e3;var og=class extends w8{constructor(r,n,i){super(og.ID,[o=>new D8(o),o=>new _8(o),o=>new R8(o)]);this.diffService=r;this._chatMLFetcher=n;this._endpointProvider=i;this.documentShorteningStrategy="noShortening";this.dependsOnSelection=!0;this.showNextEditPreference="always"}static{s(this,"XtabProvider")}static{this.ID="XtabProvider"}static{this.DEBOUNCE_MS=200}async provideNextEditBase(r,n){let i=new Zw(r);try{if(r.xtabEditHistory.length===0)return eo.noEdit({kind:"activeDocumentHasNoEdits"},i);let o=await this.doGetNextEdit(r,n,i);return new eo(o,i.build(o))}catch(o){return eo.noEdit({kind:"unexpected",error:rP(o)},i)}}async doGetNextEdit(r,n,i){let o=r.getActiveDocument(),a=Xk(o);if(a===null)return gs.error({kind:"uncategorized",error:rP(new Error("NoSelection"))});let c=s(te=>Math.floor(te.length/4),"computeTokens"),l=new Wr(a.endLineNumber,a.endColumn),u=o.documentAfterEdits.getTransformer().getOffset(l),f=o.documentAfterEdits.value,p=f.substring(0,u)+uoe+f.substring(u),m=l.lineNumber-1,h=p.split(/\r?\n/),g=Math.max(0,m-J_e),A=Math.min(h.length,m+J_e+1),y=Ipt,E=Tpt,b=Math.max(0,m-y),S=Math.min(h.length,m+E+1),R=o.documentAfterEdits.getTransformer().getOffsetRange(new ir(b,0,S,0)),B;B=f.split(/\r?\n/).slice(b,S);let L=[b,S],O=h.slice(b,S),Y=[vpt,...h.slice(g,b),iP,...O,L8,...h.slice(S,A),xpt].join(`
`),V=Y,z;{let te=c(Y),re=0;if(te>=Z_e)z=Y,re=g;else{let pe=Math.floor((Z_e-te)/2),[Ae]=Y_e(h.slice(0,g),!0,pe),[,Oe]=Y_e(h.slice(A),!1,pe);re=Math.max(Ae,m-X_e);let Te=Math.min(Oe+A,m+X_e+1);z=[...h.slice(re,g),Y,...h.slice(A,Te)].join(`
`)}}let Q=bpt(r,z,V,c),U=[{role:e2e.Raw.ChatRole.System,content:K_e(Ept)},{role:e2e.Raw.ChatRole.User,content:K_e(Q)}];if(i.setPrompt(U),await this.debounce(i),n.isCancellationRequested)return gs.error({kind:"gotCancelled",message:"afterDebounce"});r.fetchIssued=!0;let Z=new k3;i.setFetchStartedAt();let J,j=await this._endpointProvider.getEndpointInfo(this.ID),W=await this._chatMLFetcher.fetchOne(rq(U),async(te,re,pe)=>{J===void 0&&(J=Z.elapsed())},{id:j.id,name:j.name},{temperature:0},n);if(W.type==="canceled")return i.setFetchResultIfNotSet("cancelled"),gs.error({kind:"gotCancelled",message:"afterFetchCall"});if(W.type==="quotaExceeded")return i.setFetchResultIfNotSet("failure"),gs.error({kind:"quotaExceeded"});if(W.type!=="success")return i.setFetchResultIfNotSet("failure"),gs.error({kind:"fetchFailure",error:rP(W)});i.setFetchResultIfNotSet("success"),J&&i.setTtft(J),i.setResponse(W.value);let X=og.getBacktickSection(W.value);return await this.generateReturnEditFormat(o,R,B.join(`
`),X,L,i)}async generateReturnEditFormat(r,n,i,o,a,c){let{updatedEditWindow:l}=Apt(r.documentAfterEdits,a,o),u=await this.diffService.computeDiff(i,l,{ignoreTrimWhitespace:!1,maxComputationTimeMs:0,computeMoves:!1}),f=l.split(/\r?\n/),p=u.changes.map(m=>new ry(new jr(a[0]+m.original.startLineNumber,a[0]+m.original.endLineNumberExclusive),f.slice(m.modified.startLineNumber-1,m.modified.endLineNumberExclusive-1)));return p.length<1?gs.error({kind:"noSuggestions"}):gs.ok({editWindow:n,edit:new hs(p)})}static getBacktickSection(r){return r.replace(/^\`\`\`[a-zA-Z]*\r?\n/,"").replace(/(\r?\n)\`\`\`$/,"")}async debounce(r){let n=Date.now()-r.startTime,i=Math.max(0,og.DEBOUNCE_MS-n);r.setDebounceTime(i),await iE(i)}};og=uf([Ta(0,loe),Ta(1,dy),Ta(2,Wie)],og);d();var doe=class t extends Rs{constructor(r,n=t.MAX_HISTORY_SIZE){super();this.maxHistorySize=n;this.idToEntry=new Map,this.history=new S7,Bh(this,r.openDocuments,(i,o)=>{o.add(Mx(this,{rootedEdits:i.value},a=>{if(a.rootedEdits.changes.length<1||a.rootedEdits.previous===void 0)return;Fl(a.rootedEdits.changes.length===1,`Expected 1 edit change but got ${a.rootedEdits.changes.length}`);let c=a.rootedEdits.changes[0];if(c.edits.length===0)return;let l=this.idToEntry.get(i.id),u=a.rootedEdits.previous,f=new Vd(u,c);if(l===void 0){this.pushToHistory(i.id,f);return}let p=l.entry.edit,m=hs.fromEdit(p),h=hs.fromEdit(f);if(!h.isEmpty()&&!m.isEmpty()&&m.edits[0].lineRange.startLineNumber===h.edits[0].lineRange.startLineNumber){l.removeFromHistory();let g=p.edit.compose(c),A=new Vd(p.base,g);this.pushToHistory(i.id,A)}else this.pushToHistory(i.id,f)}))},i=>i.id).recomputeInitiallyAndOnChange(this._store)}static{s(this,"NesXtabHistoryTracker")}static{this.MAX_HISTORY_SIZE=50}getHistory(){return[...this.history]}pushToHistory(r,n){let i={docId:r,edit:n},o=this.history.push(i);if(this.idToEntry.set(r,{entry:i,removeFromHistory:o}),this.history.size>this.maxHistorySize){let a=this.history.shift();if(a!==void 0){let c=this.idToEntry.get(a.docId);c!==void 0&&a===c.entry&&this.idToEntry.delete(a.docId)}}}};d();d();var t2e=Be(require("crypto"));var nq=t2e.randomUUID.bind(t2e);var Npt=Be(Aa()),s2e=Be(RU());d();var foe=Yp("ISnippyService");d();d();var iq=new RegExp("[_\\p{L}\\p{Nd}]+|====+|----+|####+|////+|\\*\\*\\*\\*+|[\\p{P}\\p{S}]","gu"),poe=65;function tgr(t){let e=0,r;iq.lastIndex=0;do if(r=iq.exec(t),r&&(e+=1),e>=poe)break;while(r);return e}s(tgr,"lexemeLength");function rgr(t,e){let r=0,n;iq.lastIndex=0;do if(n=iq.exec(t),n&&(r+=1,r>=e))return iq.lastIndex;while(n);return t.length}s(rgr,"offsetFirstLexemes");function wpt(t,e){let r=t.split("").reverse().join(""),n=rgr(r,e);return r.length-n}s(wpt,"offsetLastLexemes");function r2e(t){return tgr(t)>=poe}s(r2e,"hasMinLexemeLength");d();d();var Spt;(e=>{function t(r){return typeof r=="object"&&r!==null&&typeof r.matched_source=="string"&&typeof r.occurrences=="string"&&typeof r.capped=="boolean"&&typeof r.cursor=="string"&&typeof r.github_url=="string"}e.is=t,s(t,"is")})(Spt||={});var n2e;(e=>{function t(r){return typeof r=="object"&&r!==null&&typeof r.kind=="string"&&typeof r.reason=="string"&&typeof r.code=="number"&&typeof r.msg=="string"}e.is=t,s(t,"is")})(n2e||={});var _pt;(e=>{function t(r){return typeof r=="object"&&r!==null&&"snippets"in r&&Array.isArray(r.snippets)&&r.snippets.every(Spt.is)}e.is=t,s(t,"is")})(_pt||={});var i2e;(e=>{function t(r){if(n2e.is(r))return gs.error(r);if(_pt.is(r))return gs.ok(r)}e.to=t,s(t,"to")})(i2e||={});var Rpt;(e=>{function t(r){return typeof r=="object"&&r!==null&&typeof r.commit_id=="string"&&typeof r.license=="string"&&typeof r.nwo=="string"&&typeof r.path=="string"&&typeof r.url=="string"}e.is=t,s(t,"is")})(Rpt||={});var kpt;(e=>{function t(r){return typeof r=="object"&&r!==null&&typeof r.has_next_page=="boolean"&&typeof r.cursor=="string"}e.is=t,s(t,"is")})(kpt||={});var Ppt;(e=>{function t(r){return typeof r=="object"&&r!==null&&typeof r.count=="object"&&Object.values(r.count).every(n=>typeof n=="string")}e.is=t,s(t,"is")})(Ppt||={});var Dpt;(e=>{function t(r){return typeof r=="object"&&r!==null&&"file_matches"in r&&Array.isArray(r.file_matches)&&r.file_matches.every(Rpt.is)&&"page_info"in r&&kpt.is(r.page_info)&&"license_stats"in r&&Ppt.is(r.license_stats)}e.is=t,s(t,"is")})(Dpt||={});var o2e;(e=>{function t(r){if(n2e.is(r))return gs.error(r);if(Dpt.is(r))return gs.ok(r)}e.to=t,s(t,"to")})(o2e||={});var moe=class t{static{s(this,"SnippyFetchService")}static{this.TWIRP_URL="twirp/github.snippy.v1.SnippyAPI"}constructor(e){this.ctx=e}async fetchMatch(e){let r={source:e};return this.fetch("Match",r,i2e.to)}async fetchFilesForMatch(e){let r={cursor:e};return this.fetch("FilesForMatch",r,o2e.to)}async fetch(e,r,n){let i=this.ctx.get(Or),o=await this.ctx.get(ar).getToken(),a=qm(this.ctx,o,"origin-tracker",`${t.TWIRP_URL}/${e}`),c={Authorization:`Bearer ${o.token}`,...p0(this.ctx),"X-GitHub-Api-Version":NB},l=new AbortController,u=await i.fetch(a,{method:"POST",headers:c,json:r,signal:l.signal});if(!u.ok)throw new Error(`Failed with status ${u.status} and body: ${await u.text()}`);let f=await u.json();return n(f)}};var Bpt=new dt("[CODE REFERENCING]"),F8=class{constructor(e,r){this.instantiationService=r;this.ctx=e,this.fetcher=this.instantiationService.createInstance(moe,this.ctx)}static{s(this,"SnippyService")}async handlePostInsertion(e,r,n){let i=this.computeSourceToCheck(r,n);if(!i)return;let a=await this.ctx.get(dr).getTextDocument({uri:e.toString()});if(!a){Bpt.error(this.ctx,"Unable to raise IP code citation notification: could not determine document version.");return}let c=a.version,l;try{l=await this.fetcher.fetchMatch(i.source)}catch(h){throw h}if(!l)throw new Error(`Failed to parse match response: ${l}`);if(l.isError())throw new Error(`Failed to match: ${l.err}`);if(l.val.snippets.length===0)return;let{snippets:u}=l.val,f=u.map(async h=>{let g=await this.fetcher.fetchFilesForMatch(h.cursor);if(!g||g.isError())return;let{file_matches:A,license_stats:y}=g.val;return{match:h,files:A,licenseStats:y}}),m=(await Promise.all(f)).filter(h=>!!h);if(m.length===0){Bpt.error(this.ctx,"Should never happen as per https://github.com/github/copilot-client/blob/34cae5c581d662525eb3305d58f0762e952f866d/extension/src/codeReferencing/handlePostInsertion.ts#L138");return}for(let h of m){let g=new Set(Object.keys(h.licenseStats?.count??{}));g.delete("NOASSERTION")&&g.add("unknown");let A=Array.from(g).sort(),y=`${h.match.matched_source.slice(0,100).replace(/[\r\n\t]+|^[ \t]+/gm," ").trim()}...`,E={inDocumentUri:e.toString(),offsetStart:i.startOffset,offsetEnd:i.endOffset,matchingText:y,location:{start:{line:i.startPosition.lineNumber,character:i.startPosition.column},end:{line:i.endPosition.lineNumber,character:i.endPosition.column}},version:c,details:A.map(b=>({license:b,url:`${h.match.github_url}`}))};await this.ctx.get(kf).handleIPCodeCitation(this.ctx,E)}}computeSourceToCheck(e,r){if(r.newText==="")return;let n=ga.single(r),o=n.getNewRanges().reduce((m,h)=>m.join(h)),a=e.apply(n),c=o.start,l=a.value.substring(o.start,o.endExclusive);if(!r2e(l)){let m=a.value.slice(0,o.start),h=wpt(m,poe);c=h,l=a.value.slice(h,o.start+r.newText.length)}if(!r2e(l))return;let u=a.getTransformer(),f=u.getPosition(c),p=u.getPosition(o.endExclusive);return{source:l,startOffset:c,endOffset:o.endExclusive,startPosition:f,endPosition:p}}};F8=uf([Ta(1,D1)],F8);async function Mpt(t){let e=new qie;return e.define($ie,new a2e(t)),e.define(loe,new Gp),e.define(CE,new fm(c2e,[!0])),e.define(foe,new fm(F8,[t])),e.define(dy,await u2e.Create(t)),e.define(ZU,new fm(d2e)),e.define(Wie,new l2e(t)),e.seal()}s(Mpt,"createInstantiationService");var a2e=class{constructor(e){this.ctx=e;this.ctx=e}static{s(this,"TelemetrySender")}sendTelemetryEvent(e,r,n){let i=Object.fromEntries(Object.entries(r??{}).filter(([c,l])=>l!==void 0)),o=Object.fromEntries(Object.entries(n??{}).filter(([c,l])=>l!==void 0)),a=Vr.createAndMarkAsIssued(i,o);Bt(this.ctx,e,a)}},c2e=class{static{s(this,"ParserServiceImpl")}getTreeSitterAST(e){}},l2e=class{constructor(e){this.ctx=e}static{s(this,"EndpointProvider")}async getEndpointInfo(e){if(e!==og.ID)throw new Error(`Unsupported provider ID: ${e}`);let r=await this.ctx.get(Mt).fetchTokenAndUpdateExPValuesAndAssignments();return{id:this.ctx.get(Mt).getNESXTabModelID(r),name:"xtab-4o-mini-finetuned"}}},u2e=class t{constructor(e,r){this.ctx=e;this.modelConfiguration=r}static{s(this,"CLSChatMLFetcher")}static async Create(e){let r=await Wo.getModelConfiguration(e,"nesStubs");return new t(e,r)}get tokenBudget(){return this.modelConfiguration.maxRequestTokens}get tokenizerName(){return this.modelConfiguration.tokenizer}async fetchOne(e,r,n,i,o){let a=e.map(u=>t.chatMessageToClsChatMessage(u)),c=nq(),l=await this.ctx.get(Rp).fetchAndStreamChat(this.ctx,a,gC.createEmptyConfigForTesting(),"nextEditSuggestion",c,async(u,f)=>{if(r)return await r(u,0,{text:f.text})},n,i,o);if(l.type==="success"){let u=[];if(r)for await(let p of l.choices)if(p.finishReason!=="snippy")await r(p.completionText,0,{text:p.completionText}),u.push(p.completionText);else return{type:"filtered",reason:"snippy",category:"snippy",requestId:c,serverRequestId:p.requestId.headerRequestId};let f=u.join("");return{type:"success",value:f}}else return l.type==="failed"&&l.reason==="monthly free code completions exhausted"?{type:"quotaExceeded",reason:l.reason}:{type:t.clsResponseTypeToResponseType(l.type),reason:l.type}}static chatMessageToClsChatMessage(e){switch(e.role){case"system":return{role:"system",content:ypt(e.content)};case"user":if(typeof e.content!="string"&&e.content.some(r=>r.type!=="text"))throw new Error("CLS only supports text content in user messages");return{role:"user",content:e.content};default:throw new Error(`Unsupported chat role: ${e.role}`)}}static clsResponseTypeToResponseType(e){switch(e){case"success":return"success";case"successMultiple":return"success";case"offTopic":return"offTopic";case"canceled":return"canceled";case"filtered":return"filtered";case"length":return"length";case"failed":return"failed";case"agentAuthRequired":return"agent_unauthorized";default:return"unknown"}}},d2e=class t{constructor(){this.tokenizers=new Map;this.cl100kTokenizer=new hoe("cl100k_base")}static{s(this,"CLSTokenizerProvider")}acquireTokenizer(e){let r=this.tokenizers.get(e.tokenizer);return r||(r=new hoe(t.typeToName(e.tokenizer)),this.tokenizers.set(e.tokenizer,r)),r}static typeToName(e){switch(e){case"cl100k_base":return"cl100k_base";case"o200k_base":return"o200k_base";case"llama3":throw new Error("Llama3 tokenizer is not supported");default:throw new Error(`Unknown tokenizer type: ${e}`)}}},hoe=class{constructor(e){this.mode=Npt.OutputMode.Raw;this.tokenizer=Li(e)}static{s(this,"CLSTokenizer")}tokenLength(e){if(typeof e=="string")return this.tokenizer.tokenLength(e);if(e.type===s2e.ChatCompletionContentPartKind.Text)return this.tokenizer.tokenLength(e.text);throw new Error(`Unsupported content part type: ${e.type}`)}countMessageTokens(e){let r=0;if(typeof e.content=="string")return this.tokenLength(e.content);if(Array.isArray(e.content))for(let n of e.content)if(n.type===s2e.ChatCompletionContentPartKind.Text)r+=this.tokenLength(n.text);else throw new Error(`Unsupported message content part type: ${n.type}`);else throw new Error("Unsupported message content type");return r}countMessagesTokens(e){let r=0;for(let n of e)r+=this.countMessageTokens(n);return r}countToolTokens(e){throw new Error("Method not implemented.")}};d();d();var goe=class extends Rs{constructor(r){super();this.workspace=r;this._garbageCollector=new m2e(20);this._documentCaches=new Map;Bh(this,r.openDocuments,(n,i)=>{let o=new f2e(n.id,n.value.get(),this._garbageCollector);this._documentCaches.set(o.docId,o),i.add(Mx(this,{value:n.value,selection:n.selection,languageId:n.languageId},a=>{for(let c of a.value.changes)o.handleEdit(c)})),i.add(Qc(()=>{this._documentCaches.delete(n.id)}))}).recomputeInitiallyAndOnChange(this._store)}static{s(this,"RejectionCollector")}reject(r,n){let i=this._documentCaches.get(r);i&&i.reject(n)}isRejected(r,n){let i=this._documentCaches.get(r);return i?i.isRejected(n):!1}},f2e=class{constructor(e,r,n){this.docId=e;this._garbageCollector=n;this._rejectedEdits=new Set}static{s(this,"DocumentRejectionTracker")}handleEdit(e){for(let r of[...this._rejectedEdits])r.handleEdit(e)}reject(e){if(this.isRejected(e))return;let r=new p2e(e.toEdit(),()=>{this._rejectedEdits.delete(r)});this._rejectedEdits.add(r),this._garbageCollector.put(r)}isRejected(e){for(let r of this._rejectedEdits)if(r.isRejected(e))return!0;return!1}},p2e=class{constructor(e,r){this._edit=e;this._onDispose=r}static{s(this,"RejectedEdit")}handleEdit(e){let r=this._edit.tryRebase(e);r?this._edit=r:this.dispose()}isRejected(e){return this._edit.equals(e.toEdit())}dispose(){this._onDispose()}},m2e=class{constructor(e){this._maxSize=e;this._disposables=[]}static{s(this,"LRUGarbageCollector")}put(e){this._disposables.push(e),this._disposables.length>this._maxSize&&this._disposables.shift().dispose()}dispose(){for(let e of this._disposables)e.dispose();this._disposables=[]}};d();d();d();var oq=class{constructor(e,r){this.prev=null;this.next=null;this.key=e,this.value=r}static{s(this,"Node")}},Aoe=class{static{s(this,"LRUCache")}constructor(e=10){if(e<1)throw new Error("Cache size must be at least 1");this._capacity=e,this._cache=new Map,this._head=new oq("",null),this._tail=new oq("",null),this._head.next=this._tail,this._tail.prev=this._head}_addNode(e){e.prev=this._head,e.next=this._head.next,this._head.next.prev=e,this._head.next=e}_removeNode(e){let r=e.prev,n=e.next;r.next=n,n.prev=r}_moveToHead(e){this._removeNode(e),this._addNode(e)}_popTail(){let e=this._tail.prev;return this._removeNode(e),e}clear(){this._cache.clear(),this._head.next=this._tail,this._tail.prev=this._head}deleteKey(e){let r=this._cache.get(e);if(r)return this._removeNode(r),this._cache.delete(e),r.value}get(e){let r=this._cache.get(e);if(r)return this._moveToHead(r),r.value}keys(){let e=[],r=this._head.next;for(;r!==this._tail;)e.push(r.key),r=r.next;return e}getValues(){let e=[],r=this._head.next;for(;r!==this._tail;)e.push(r.value),r=r.next;return e}put(e,r){let n=this._cache.get(e);if(n)n.value=r,this._moveToHead(n);else if(n=new oq(e,r),this._cache.set(e,n),this._addNode(n),this._cache.size>this._capacity){let i=this._popTail();return this._cache.delete(i.key),[i.key,i.value]}}};var yoe=class extends Rs{constructor(r){super();this.workspace=r;this._documentCaches=new Map;this._sharedCache=new Aoe(50);Bh(this,r.openDocuments,(n,i)=>{let o=new h2e(n.id,n.value.get(),this._sharedCache);this._documentCaches.set(o.docId,o),i.add(Mx(this,{value:n.value,selection:n.selection,languageId:n.languageId},a=>{for(let c of a.value.changes)o.handleEdit(c)})),i.add(Qc(()=>{this._documentCaches.delete(n.id)}))}).recomputeInitiallyAndOnChange(this._store)}static{s(this,"NextEditCache")}setNextEdits(r,n,i){let o=this._documentCaches.get(r);o&&o.setNextEdits(n,i)}lookupNextEdit(r){let n=this._documentCaches.get(r);if(n)return n.lookupNextEdit()}},h2e=class{constructor(e,r,n){this.docId=e;this._sharedCache=n;this._value=r}static{s(this,"DocumentEditCache")}handleEdit(e){this._value=this._value.apply(e)}setNextEdits(e,r){let n=this._value;for(let i=0;i<e.edits.length;i++){let o=e.edits[i],a=this._getKey(n.value);this._sharedCache.put(a,{edit:o,subsequentN:i,source:r,documentBeforeEdit:n}),n=n.apply(o.toEdit())}}lookupNextEdit(){let e=this._getKey(this._value.value),r=this._sharedCache.get(e);if(r)return r}_getKey(e){return JSON.stringify([this.docId.uri,e])}};d();var Coe=class t{constructor(e){this._providerId=e;this._isFromCache=!1;this._wasPreviouslyRejected=!1;this._isShown=!1;this._acceptance="notAccepted";this._startTime=Date.now(),this._requestN=++t.requestN}static{s(this,"NextEditProviderTelemetryBuilder")}static{this.requestN=0}build(){let e,r,n,i,o,a;if(this._request){let l=this._request.getActiveDocument();e=this._request.documents.length,r=this._request.documents.reduce((u,f)=>u+f.recentEdits.edits.length,0),n=l.recentEdits.edits.length,i=l.languageId,o=l.lineCountBeforeClipping,a=l.clippingRange.length}let c=this._statelessNextEditTelemetry?.fetchStartedAt===void 0?void 0:this._statelessNextEditTelemetry.fetchStartedAt-this._startTime;return{opportunityId:this._opportunityId||"",headerRequestId:this._headerRequestId||"",requestN:this._requestN,providerId:this._providerId,nextEditProviderDuration:this._duration||0,isFromCache:this._isFromCache,subsequentEditOrder:this._subsequentEditOrder,documentShorteningStrategy:this._documentShorteningStrategy,documentsCount:e,editsCount:r,activeDocumentEditsCount:n,activeDocumentLanguageId:i,activeDocumentOriginalLineCount:o,activeDocumentShortenedLineCount:a,fetchStartedAfterMs:c,wasPreviouslyRejected:this._wasPreviouslyRejected,isShown:this._isShown,acceptance:this._acceptance,...this._statelessNextEditTelemetry}}setOpportunityId(e){return this._opportunityId=e,this}setHeaderRequestId(e){return this._headerRequestId=e,this}setIsFromCache(){return this._isFromCache=!0,this}setSubsequentEditOrder(e){return this._subsequentEditOrder=e,this}setDocumentShorteningStrategy(e){return this._documentShorteningStrategy=e,this}setRequest(e){return this._request=e,this}setStatelessNextEditTelemetry(e){return this._statelessNextEditTelemetry=e,this}setWasPreviouslyRejected(){return this._wasPreviouslyRejected=!0,this}markEndTime(){return this._duration=Date.now()-this._startTime,this}setAsShown(){return this._isShown=!0,this}setAcceptance(e){return this._acceptance=e,this}},O8=class{constructor(e){this.telemetrySender=e;this._map=new Map}static{s(this,"TelemetrySender")}markNextEditResultAsShown(e){let r=this._map.get(e);r&&r.builder.setAsShown()}scheduleSendingTelemetry(e,r){let n=setTimeout(()=>{this._doSendTelemetry(r),this._map.delete(e)},12e4);this._map.set(e,{builder:r,timeout:n})}sendTelemetryFor(e,r){let n=this._map.get(e);if(!n)return;this._map.delete(e),clearTimeout(n.timeout);let i=n.builder;i.setAcceptance(r),this._doSendTelemetry(i)}sendTelemetry(e){this._doSendTelemetry(e)}_doSendTelemetry(e){let r=e.build(),{opportunityId:n,headerRequestId:i,requestN:o,providerId:a,hadStatelessNextEditProviderCall:c,statelessNextEditProviderDuration:l,nextEditProviderDuration:u,isFromCache:f,subsequentEditOrder:p,documentShorteningStrategy:m,activeDocumentLanguageId:h,activeDocumentOriginalLineCount:g,activeDocumentShortenedLineCount:A,wasPreviouslyRejected:y,isShown:E,acceptance:b,logProbThreshold:S,documentsCount:R,editsCount:B,activeDocumentEditsCount:L,promptLineCount:O,promptCharCount:Y,isDefaultEndpoint:V,hadLowLogProbSuggestion:z,nonTerminatingError:Q,nEditsSuggested:U,kthEditPicked:Z,lineDistanceToMostRecentEdit:J,debounceTime:j,hasNextEdit:W,nextEditLogprob:X,maxLinesPerEdit:oe,noNextEditReasonKind:te,noNextEditReasonMessage:re,firstEditStrategy:pe,firstPickStrategyOverride:Ae,fetchTime:Oe,fetchResult:Te,fetchError:Je,fetchStartedAfterMs:Fe}=r;this._sendTelemetryToBoth({opportunityId:n,headerRequestId:i,providerId:a,documentShorteningStrategy:m,activeDocumentLanguageId:h,acceptance:b,nonTerminatingError:Q,noNextEditReasonKind:te,noNextEditReasonMessage:re,firstEditStrategy:pe,firstPickStrategyOverride:Ae,fetchResult:Te,fetchError:Je},{requestN:o,hadStatelessNextEditProviderCall:this._boolToNum(c),statelessNextEditProviderDuration:l,nextEditProviderDuration:u,isFromCache:this._boolToNum(f),subsequentEditOrder:p,isDefaultEndpoint:this._boolToNum(V),activeDocumentOriginalLineCount:g,activeDocumentShortenedLineCount:A,wasPreviouslyRejected:this._boolToNum(y),isShown:this._boolToNum(E),logProbThreshold:S,documentsCount:R,editsCount:B,activeDocumentEditsCount:L,promptLineCount:O,promptCharCount:Y,hadLowLogProbSuggestion:this._boolToNum(z),nEditsSuggested:U,kthEditPicked:Z,lineDistanceToMostRecentEdit:J,debounceTime:j,fetchStartedAfterMs:Fe,fetchTime:Oe,hasNextEdit:this._boolToNum(W),nextEditLogprob:X,maxLinesPerEdit:oe})}_sendTelemetryToBoth(e,r){this.telemetrySender.sendTelemetryEvent("copilot-nes/provideInlineEdit",e,r)}_boolToNum(e){return e===void 0?void 0:e?1:0}};O8=uf([Ta(0,$ie)],O8);d();var Q8=class{constructor(e){this.result=e}static{s(this,"NextEditResult")}};var oP=!1,Lpt=300,U8=class extends Rs{constructor(r,n,i,o,a,c,l){super();this._workspace=r;this._statelessNextEditProvider=n;this._historyContextProvider=i;this._xtabHistoryTracker=o;this._parseService=a;this._instantiationService=c;this._snippyService=l;this._rejectionCollector=new goe(this._workspace);this._nextEditCache=new yoe(this._workspace);this._recentlyShownCache=new y2e;this._pendingStatelessNextEditRequest=null;this._lastShownTime=0;this._lastRejectionTime=0;this._lastTriggerTime=0;Bh(this,this._workspace.openDocuments,(u,f)=>{f.add(Hxe(u.value,p=>{this._cancelPendingRequestDueToDocChange(u.id,p)}))}).recomputeInitiallyAndOnChange(this._store),this._telemetrySender=this._instantiationService.createInstance(O8)}static{s(this,"NextEditProvider")}get lastRejectionTime(){return this._lastRejectionTime}get lastTriggerTime(){return this._lastTriggerTime}_cancelPendingRequestDueToDocChange(r,n){if(this._pendingStatelessNextEditRequest===null)return;let i=this._pendingStatelessNextEditRequest.getActiveDocument();i.id===r&&i.documentAfterEditsNoShortening.value!==n.value&&this._pendingStatelessNextEditRequest.cancellationTokenSource.cancel()}async getNextEdit(r,n,i){this._lastTriggerTime=Date.now();let o=await this._workspace.getDocument(r);if(!o)return{result:void 0};let a=o.value.get(),c=new Coe(this._statelessNextEditProvider.ID);c.setOpportunityId(n.requestUuid??nq());let l=this._recentlyShownCache.get(r,a),u=this._nextEditCache.lookupNextEdit(r),f,p,m,h;if(l)f=l[0],h=l[1],p=a,c.setHeaderRequestId(h.headerRequestId),c.setIsFromCache(),await iE(Lpt);else if(u)f=u.edit,h=u.source,p=u.documentBeforeEdit,c.setHeaderRequestId(h.headerRequestId),c.setIsFromCache(),c.setSubsequentEditOrder(u.subsequentN),await iE(Lpt);else{h=new A2e,c.setHeaderRequestId(h.headerRequestId);let y=o.value.get();p=y;let E=await this.fetchNextEdit(h,r,c,i),b=y.value!==o.value.get().value;if(E.isError())switch(E.err.kind){case"activeDocumentHasNoEdits":case"noSuggestions":case"gotCancelled":case"filteredOut":case"uncategorized":case"quotaExceeded":break;case"fetchFailure":case"unexpected":m=E.err.error;break;default:w7(E.err)}else if(!b){let S=E.val;S.isEmpty()||(f=S.edits[0],(!this._statelessNextEditProvider.dependsOnSelection||S.edits.length>1)&&this._nextEditCache.setNextEdits(r,S,h))}}if(c.markEndTime(),m)throw this._telemetrySender.sendTelemetry(c),m;if(!f)return this._telemetrySender.sendTelemetry(c),new Q8(void 0);if(this._rejectionCollector.isRejected(r,f))return c.setWasPreviouslyRejected(),this._telemetrySender.sendTelemetry(c),new Q8(void 0);Fl(p!==void 0,"should be defined if edit is defined");let g=this._statelessNextEditProvider.showNextEditPreference??"aroundEdit",A=new Q8({edit:f,showRangePreference:g,documentBeforeEdits:p});return this._telemetrySender.scheduleSendingTelemetry(A,c),f.isNeutral()||this._recentlyShownCache.add(r,a,[f,h]),A}async _shortenDocument(r,n){let i=r.lastEdit.getEditedState(),{document:o,clippedRange:a}=n==="noShortening"?this.getProjectedDocumentNoShortening(r.lastEdit):n==="clipping"?this.getProjectedDocumentClipping(r.lastEdit):await this.getProjectedDocumentSummarizedDocument(r.languageId,r.lastEdit),c=ga.fromOffsetEdit(o.edits).inverseOnString(o.originalText),{edits:l,editLast:u}=g2e(r.lastEdits.swap(c)),f=l.compose(),p=new eP(new fy(r.lastEdits.apply(o.originalText)),u.toOffsetEdit().inverse(l.apply(o.text))),m=new pu(o.text),g=T1.fromEdit(new Vd(m,f)).removeCommonSuffixPrefixLines(),A=l.edits.at(-1)?.getNewRanges().at(0),y;A&&(y=new pu(p.text).getTransformer().getRange(A));let E=r.lastSelection?p.projectOffsetRange(r.lastSelection):void 0,b=this._workspace.getWorkspaceRoot(r.docId),S=s(O=>{let V=new T1(new pu(p.text),O).toEdit();return Fpt(V,p)},"toEditOnDocumentAfterEditsNoShortening"),R=s(O=>p.projectBack(O),"toOffsetOnDocumentAfterEditsNoShortening"),B=s(O=>p.project(O),"toProjectedOffset"),L=new jU(r.docId,b,r.languageId,g.base.getLines(),g.edit,y,m,l,i,S,R,B,r.lastEdit.base.getTextLength().lineCount,a,E);return{recentEdit:r.lastEdit,nextEditDoc:L,projectedDocument:p}}async fetchNextEdit(r,n,i,o){let a=await this._historyContextProvider.getHistoryContext(n);if(!a)return gs.error({kind:"unexpected",error:new Error("DocumentMissingInHistoryContext")});let c=g2e(a.getDocumentAndIdx(n)),l=this.getDocumentShorteningStrategy();i.setDocumentShorteningStrategy(l);let u=await Promise.all(a.documents.map(O=>this._shortenDocument(O,l))),f=u[c.idx],p=this._xtabHistoryTracker.getHistory(),m=new Lie(r.headerRequestId,u.map(O=>O.nextEditDoc),c.idx,p,this.nextEditOptions),h=this._findExistingPendingRequest(m),g,A;if(h){g=h,oP&&console.log(`=> reusing an existing request ${g.seqid}`),i.setHeaderRequestId(h.id),i.setIsFromCache(),i.setRequest(g);let O=this._hookupCancellation(g,o);try{A=await g.result}finally{O.dispose()}}else{g=m,this._pendingStatelessNextEditRequest&&(this._pendingStatelessNextEditRequest.cancellationTokenSource.cancel(),this._pendingStatelessNextEditRequest=null),this._pendingStatelessNextEditRequest=g;let O=s(()=>{this._pendingStatelessNextEditRequest===g&&(this._pendingStatelessNextEditRequest=null)},"removeFromPending");i.setRequest(g);let Y=this._hookupCancellation(g,o);try{A=await this._statelessNextEditProvider.provideNextEdit(g,g.cancellationTokenSource.token),g.setResult(A)}catch(V){throw g.setResultError(V),V}finally{Y.dispose(),O()}}i.setStatelessNextEditTelemetry(A.telemetry);let y=A.nextEdit;if(y.isError())return y;let E=y.val.edit;if(E.edits.length===0)return gs.error({kind:"noSuggestions"});let S=new T1(new pu(f.projectedDocument.text),E).toEdit(),R=Fpt(S,f.projectedDocument),B=S.edits.length===R.edits.length?y.val.permutation:void 0,L=R.decompose(B);return gs.ok(L)}_hookupCancellation(r,n){let i=new td,o=!1,a=s(()=>{o||(o=!0,r.liveDependentants--)},"removeDependant"),c=i.add(new s8);return i.add(n.onCancellationRequested(()=>{if(a(),r.liveDependentants>0){oP&&console.log(`=> ignoring UI cancellation signal for ${r.seqid} because others depend on this request`);return}if(!r.fetchIssued){oP&&console.log(`=> canceling ${r.seqid} due to UI cancellation signal`),r.cancellationTokenSource.cancel();return}c.setIfNotSet(()=>{if(r.liveDependentants>0){oP&&console.log(`=> ignoring timer cancellation signal for ${r.seqid} because others depend on this request`);return}oP&&console.log(`=> canceling ${r.seqid} due to timer after UI cancellation signal`),r.cancellationTokenSource.cancel()},500)})),i.add(Qc(()=>{a()})),r.liveDependentants++,i}_findExistingPendingRequest(r){if(this._statelessNextEditProvider.canReuseResult&&this._pendingStatelessNextEditRequest&&!this._pendingStatelessNextEditRequest.cancellationTokenSource.token.isCancellationRequested&&this._statelessNextEditProvider.canReuseResult(this._pendingStatelessNextEditRequest,r))return this._pendingStatelessNextEditRequest}handleShown(r){this._lastShownTime=Date.now(),this._telemetrySender.markNextEditResultAsShown(r)}handleAcceptance(r,n){this._telemetrySender.sendTelemetryFor(n,"accepted"),this.runSnippy(r,n),this._statelessNextEditProvider.handleAcceptance?.()}handleRejection(r,n){Tne(n.result,"@ulugbekna: undefined edit cannot be rejected?"),Date.now()-this._lastShownTime>1e3&&n.result&&(this._recentlyShownCache.remove(n.result.edit),this._rejectionCollector.reject(r,n.result.edit)),this._lastRejectionTime=Date.now(),this._telemetrySender.sendTelemetryFor(n,"rejected")}getProjectedDocumentNoShortening(r){return{document:new eP(new fy(r.base.value),new tg([])),clippedRange:new jr(1,r.base.getTextLength().lineCount+1)}}getProjectedDocumentClipping(r){let n=r.base.getTransformer(),i=n.getRange(r.edit.getRange()??new Vt(0,0)),o=jr.fromRange(i);function a(p,m){return new jr(p.startLineNumber-m,p.endLineNumberExclusive+m)}s(a,"extendRange");let c=new jr(1,n.textLength.lineCount+1),l=g2e(c.intersect(a(o,100))),u=jr.subtract(c,l);return{document:new eP(new fy(r.base.value),new tg(u.map(p=>yl.delete(n.getOffsetRange(new ir(p.startLineNumber,1,p.endLineNumberExclusive,1)))))),clippedRange:l}}getDocumentShorteningStrategy(){return this._statelessNextEditProvider.documentShorteningStrategy??"clipping"}get nextEditOptions(){return new WU("firstByLineNumber",8)}async getProjectedDocumentSummarizedDocument(r,n){let i=await sgr(this._parseService,{getText:s(()=>n.base.value,"getText"),languageId:r});if(!i)return this.getProjectedDocumentClipping(n);let o=new fy(n.base.value),a=n.edit.edits.at(0)?.range??new Vt(0,0),c;if(n.edit.edits.length!==0){let h=n.edit.edits.at(0),g=n.edit.edits.at(-1);c=o.offsetRangeToRange(new Vt(h.range.start,g.range.endExclusive))}let l=Opt(o.offsetRangeToRange(a)),u=Xie(1e4,{costFnOverride:s((h,g,A)=>{let y=Opt(A.offsetRangeToRange(h.range)),E=ogr(l,y);return E>100?!1:E},"costFnOverride")},[{overlayNodeRoot:i,document:o,selection:c}])[0],f=u.projectBack(1)-1,p=n.base.getTransformer().getPosition(f).lineNumber,m=new jr(p,p+u.lineCount);return{document:u,clippedRange:m}}async runSnippy(r,n){n.result!==void 0&&this._snippyService.handlePostInsertion(r.toUri(),n.result.documentBeforeEdits,n.result.edit)}};U8=uf([Ta(4,CE),Ta(5,D1),Ta(6,foe)],U8);function Fpt(t,e){let r=e.projectBackOffsetEdit(t.toOffsetEdit());return ga.fromOffsetEdit(r)}s(Fpt,"projectBackEdit");function Opt(t){return new jr(t.start.line+1,t.end.line+1)}s(Opt,"lineRangeFromVSCodeRange");function ogr(t,e){return t.endLineNumberExclusive<=e.startLineNumber?e.startLineNumber-t.endLineNumberExclusive:e.endLineNumberExclusive<=t.startLineNumber?t.startLineNumber-e.endLineNumberExclusive:0}s(ogr,"lineRangeDist");async function sgr(t,e){return await t.getTreeSitterAST(e)?.getStructure()}s(sgr,"getStructure");function g2e(t){if(!t)throw new xn("expected value to be defined, but it was not");return t}s(g2e,"assertDefined");var A2e=class{constructor(){this.headerRequestId=nq()}static{s(this,"NextEditFetchRequest")}},y2e=class{constructor(){this._cache=new l3(10)}static{s(this,"RecentlyShownCache")}add(e,r,n){let i=this._key(e,r);this._cache.set(i,n)}get(e,r){let n=this._key(e,r);return this._cache.get(n)}remove(e){for(let r of this._cache)if(r[1][0]===e){this._cache.delete(r[0]);break}}_key(e,r){return e.uri+";"+r.value}};var Qpt=10,py=class{constructor(e){this.lastResultsById=new Sr(Qpt);this.lastResultsByUri=new Sr(Qpt);this.ctx=e}static{s(this,"NextEditSuggestionsManager")}async handleNextEditRequest(e,r,n){let i=await(this.nextEditProvider??=this.createNextEditProvider()),o=this.lastResultsByUri.get(e);o&&(this.lastResultsByUri.delete(e),this.lastResultsById.delete(o.resultId),o.isShown&&i.handleRejection(o.documentId,o.nextEditResult));let a=ly.create(e),c=await i.getNextEdit(a,{triggerKind:1},n);if(c.result==null)return;let l=await this.ctx.get(dr).getTextDocument({uri:e});if(!l)return;let u=l.positionAt(c.result.edit.range.start),f=l.positionAt(c.result.edit.range.endExclusive),p=br(),m={resultId:p,nextEditResult:c,documentId:a,isShown:!1};return this.lastResultsById.set(p,m),this.lastResultsByUri.set(e,m),[{edit:{text:c.result?.edit.newText??"",range:{start:u,end:f},textDocument:{uri:e,version:r}},id:p}]}async handleAcceptance(e){let r=await this.nextEditProvider,n=this.lastResultsById.get(e);!r||!n||n.resultId===e&&(this.lastResultsByUri.delete(n.documentId.uri),this.lastResultsById.delete(n.resultId),await r.handleAcceptance(n.documentId,n.nextEditResult))}async handleShown(e){let r=await this.nextEditProvider,n=this.lastResultsById.get(e);!r||!n||n.resultId===e&&(n.isShown=!0,r.handleShown(n.nextEditResult))}async createNextEditProvider(){let e=await Mpt(this.ctx),r=!1;try{let a=await this.ctx.get(Mt).fetchTokenAndUpdateExPValuesAndAssignments();r=agr(this.ctx,a)}catch(a){console.error("Error updating ExP values and assignments:",a)}let n=e.createInstance(r?og:oS),i=this.ctx.get(LA),o=new One(i);return await cR.catch(()=>{}),e.createInstance(U8,i,n,o,new doe(i))}};function agr(t,e){let r=zi(t,Ht.NESXTab);return r!==void 0?r:t.get(Mt).enableNESXTab(e)}s(agr,"shouldUseXTab");d();var Upt=Be(hi());var voe=class extends LA{constructor(r){super();this._openDocuments=MA(this,[]);this.openDocuments=this._openDocuments;this._documents=new Map;this.ctx=r,this._started=!1,this.start()}static{s(this,"ObservableLspWorkspace")}start(){if(this._started)return;this._started=!0;let r=this.ctx.get(dr);for(let n of r.getTextDocumentsUnsafe())n&&this.addLspDocument(n.uri,n.clientLanguageId,n.getText());r.onDidOpenTextDocument(async n=>{this.addLspDocument(n.document.uri,n.document.languageId,n.document.text)}),r.onDidCloseTextDocument(async n=>{this.removeClosedLspDocument(n.document.uri)}),r.onDidChangeTextDocument(async n=>{this.onDidChangeLspDocument(n.document.uri,n.contentChanges)})}addLspDocument(r,n,i){let o=ly.create(r);return this.addDocument({id:o,initialValue:i,languageId:zR.create(n)},void 0)}onDidChangeLspDocument(r,n){let i=ly.create(r),o=this._documents.get(i);o&&o.applyLspContentChanges(n)}onUserPositionChange(r,n){let i=ly.create(r),o=this._documents.get(i);o&&o.updateSelectionFromLspPosition(n)}removeClosedLspDocument(r){let n=ly.create(r);this._documents.get(n)?.dispose()}addDocument(r,n=void 0){let i=this._documents.get(r.id);if(i)return i;let o=new C2e(r.id,new pu(r.initialValue??""),[],r.languageId??zR.PlainText,()=>{this._documents.delete(r.id);let a=this._openDocuments.get(),c=a.filter(l=>l.id!==o.id);c.length!==a.length&&this._openDocuments.set(c,n,{added:[],removed:[o]})},r.workspaceRoot);return this._documents.set(r.id,o),this._openDocuments.set([...this._openDocuments.get(),o],n,{added:[o],removed:[]}),o}async getDocument(r){if(await this.ctx.get(dr).getTextDocument(r))return this._documents.get(r)}clear(){this._openDocuments.set([],void 0,{added:[],removed:this._openDocuments.get()});for(let r of this._documents.values())r.dispose();this._documents.clear()}getWorkspaceRoot(r){return this._documents.get(r)?.workspaceRoot}},C2e=class extends NZ{static{s(this,"MutableObservableLspDocument")}constructor(e,r,n,i,o,a){super(e,r,n,i,o,a)}applyLspContentChanges(e){let r=this.editFromLspContentChanges(e);this.applyEdit(r.compose(),void 0)}updateSelectionFromLspPosition(e){let r=this.value.get().getTransformer().getOffset(new Wr(e.lineNumber+1,e.column+1));this.updateSelection([new Vt(r,r)])}editFromLspContentChanges(e){return new w1(e.map(n=>this.editFromLspContentChange(n)))}editFromLspContentChange(e){if(Upt.TextDocumentContentChangeEvent.isIncremental(e)){let r=this.value.get().getTransformer(),n=r.getOffset(new Wr(e.range.start.line+1,e.range.start.character+1)),i=r.getOffset(new Wr(e.range.end.line+1,e.range.end.character+1));if(n>i){let o=this.value.get().value,a=o.split(/\r\n|\n/).length,c=o.split(/\r\n|\r|\n/).length,l=new xn(`Invalid range: [${n}, ${i}) from ${JSON.stringify(e.range)}. Line counts: nes=${a}, lsp=${c}`);throw a<c?l.code="ObservableWorkspace_TooFewLines":a>c?l.code="ObservableWorkspace_TooManyLines":l.code="ObservableWorkspace_InvalidRange",l}return ga.replace(new Vt(n,i),e.text)}throw new Error("Full replacement edits are not supported")}};d();var my=class{static{s(this,"AuthenticationService")}};d();var qpt=require("crypto"),B1=Be(require("fs/promises")),Hpt=require("os"),xE=Be(require("path"));var EE=class{constructor(e){this.ctx=e;this.logger=new dt("ripgrep")}static{s(this,"RipgrepPathResolver")}async resolvePath(){if(this.rgPath)return this.rgPath;let e=process.platform,r=process.arch;return this.rgPath=await this.resolvePathByOs(e,r),this.rgPath}async resolvePathByOs(e,r){if(this.logger.debug(this.ctx,`Start resolving ripgrep path for platform: ${e} and architecture: ${r}`),r!=="arm64"&&r!=="x64")throw new Error(`Unsupported architecture: ${r}`);let n=e==="win32"?"rg.exe":"rg";this.logger.debug(this.ctx,`__filename is ${__filename}, __dirname is ${__dirname}`);let i=xE.extname(__filename)===".ts"?xE.resolve(__dirname,"../../../packages/ripgrep/bin"):xE.resolve(__dirname,"./bin"),o=xE.resolve(i,e,r,n);if("pkg"in process){this.logger.debug(this.ctx,"Running inside pkg binary, start to copy ripgrep to a temporary location");let a=await B1.readFile(o),c=(0,qpt.createHash)("sha256").update(a).digest("hex"),l=xE.join((0,Hpt.homedir)(),".cache/pkg",c);await B1.mkdir(l,{recursive:!0});let u=Pi(kl(o)),f=xE.join(l,u);try{await B1.stat(f)}catch{await B1.copyFile(o,f),this.logger.debug(this.ctx,`Copied ripgrep to ${f}`)}o=f,e!=="win32"&&await B1.chmod(o,493).catch(p=>{this.logger.error(this.ctx,`Failed to set executable permission for ${o}: ${p}`)})}return o}};d();var $pt=require("child_process"),v2e=require("perf_hooks");var bE=new dt("ripgrepProcessManager"),hy=class{constructor(e,r,n){this.ctx=e;this.defaultTimeoutInMs=30*1e3;this.maxProcesses=4;this.maxPendingTasks=20;this.taskQueue=[];this.activeProcesses=new Set;this.maxProcesses=r??this.maxProcesses,this.maxPendingTasks=n??this.maxPendingTasks,bE.debug(this.ctx,`initialized with maxProcesses: ${this.maxProcesses} and maxPendingTasks: ${this.maxPendingTasks}`)}static{s(this,"RipgrepProcessManager")}dispose(){bE.debug(this.ctx,`Disposing ripgrep process manager with ${this.activeProcesses.size} active processes`),this.activeProcesses.forEach(e=>{if(!e.killed)try{e.kill()}catch(r){bE.error(this.ctx,"Failed to kill process. ",r)}}),this.activeProcesses.clear()}execute(e,r,n,i,o){return new Promise((a,c)=>{if(this.taskQueue.length>=this.maxPendingTasks){bE.error(this.ctx,`Task queue limit reached: ${this.maxPendingTasks}`),c(new Error(`Task queue limit of ${this.maxPendingTasks} reached`));return}if(o!==void 0&&o<=0){bE.error(this.ctx,`Invalid timeout value: ${o}`),c(new Error(`Invalid timeout value: ${o}`));return}bE.debug(this.ctx,`Adding task to queue: ${e} ${r.join(" ")}`),this.taskQueue.push({id:ty(),command:e,args:r,options:i,resolve:a,reject:c,timeoutInMs:o??this.defaultTimeoutInMs,token:n});let l=this.taskQueue.map(u=>this.getTaskSimpleInfo(u)).join(`
`);bE.debug(this.ctx,`Current task queue length: ${this.taskQueue.length}, task list: ${l}`),this.runNextTask()})}runNextTask(){if(this.taskQueue.length===0||this.activeProcesses.size>=this.maxProcesses)return;let e=this.taskQueue.shift(),r=v2e.performance.now();bE.debug(this.ctx,`Starting task: ${this.getTaskSimpleInfo(e)}`);try{let n=(0,$pt.spawn)(e.command,e.args,e.options);this.activeProcesses.add(n);let i="",o="",a,c=s(()=>{a&&clearTimeout(a),this.activeProcesses.delete(n),n.stdout?.removeAllListeners(),n.stderr?.removeAllListeners(),n.removeAllListeners()},"cleanup");e.timeoutInMs&&(a=setTimeout(()=>{n.killed||(n.kill(),e.reject(new Error(`Process timed out after ${e.timeoutInMs} ms. Partial output: ${i}`))),c(),this.runNextTask()},e.timeoutInMs)),e.token&&e.token.onCancellationRequested(()=>{n.killed||(n.kill(),e.reject(new Error("Process was cancelled. Partial output: "+i))),c(),this.runNextTask()}),n.stdout?.on("data",l=>{i+=l.toString()}),n.stderr?.on("data",l=>{o+=l.toString()}),n.on("close",l=>{let f=v2e.performance.now()-r;bE.debug(this.ctx,`Task ${e.id} completed in ${f} ms`),c(),l===0?e.resolve(i):l===1?e.resolve(""):e.reject(new Error(`Process exited with code ${l}: ${o}`)),this.runNextTask()}),n.on("error",l=>{c(),e.reject(new Error(`Failed to start process: ${l.message}`)),this.runNextTask()})}catch(n){e.reject(new Error(`Error spawning process: ${n.message}`)),this.runNextTask()}}getTaskSimpleInfo(e){return`${e.id} - ${e.command} ${e.args.join(" ")}`}};d();var q8=class extends zC{static{s(this,"EmptyRecentEditsProvider")}isEnabled(){return!1}start(){}getRecentEdits(){return[]}getEditSummary(e){return null}};d();var Wpt=100,jpt=1e3*60*5;function Gpt(t){let e=new x2e(t);t.get(Hc).registerContextProvider(e),t.get(jC).add(e.id)}s(Gpt,"registerRelatedFilesShim");var x2e=class{constructor(e){this.ctx=e;this.id="relatedFilesShim";this.selector=["*"];this.traitCache=new U_(Wpt,jpt);this.relatedFilesCache=new U_(Wpt,jpt);this.resolver={resolve:s(async(r,n)=>{let i=r.documentContext.uri,o=r.documentContext.languageId;return await this.getTraits(i,o,n)},"resolve")}}static{s(this,"RelatedFilesShim")}async getTraits(e,r,n){return this.traitCache.has(e)||await this.requestRelatedFilesAndTraits(e,r,r,n),this.traitCache.get(e)??[]}async requestRelatedFilesAndTraits(e,r,n,i){try{let o=await this.ctx.get(Mt).fetchTokenAndUpdateExPValuesAndAssignments({uri:e,languageId:n}),a={uri:e,clientLanguageId:r,detectedLanguageId:n},c=await UZ(this.ctx,a,o,i,!0);if(i?.isCancellationRequested)return;let l=c.traits.filter(f=>f.includeInPrompt).map(f=>f.promptTextOverride?{name:"OtherInformation",value:f.promptTextOverride}:f),u=new Set;for(let f of c.entries.values())for(let p of f.keys())u.add(p);this.traitCache.set(e,l),this.relatedFilesCache.set(e,Array.from(u))}catch(o){vx(this.ctx,o,"relatedFilesShim")}}};d();d();d();var xoe=class{constructor(e,r){this.ctx=e;this.workspaceFolder=r;this.emitter=new ys;this.onFileChange=this.emitter.event;this.status="created",this.startWatching()}static{s(this,"WorkspaceWatcher")}emitFilesCreated(e){this.emitter.fire({type:"create",documents:e,workspaceFolder:this.workspaceFolder})}emitFilesUpdated(e){this.emitter.fire({type:"update",documents:e,workspaceFolder:this.workspaceFolder})}emitFilesDeleted(e){this.emitter.fire({type:"delete",documents:e,workspaceFolder:this.workspaceFolder})}};var Jd=class{constructor(e){this.ctx=e;this.watchers=new Sr(25)}static{s(this,"WorkspaceWatcherProvider")}getWatcher(e){let r=this.watchers.get(e.uri);if(r)return r;let n=this.getParentFolder(e.uri);return n?this.watchers.get(n):void 0}getParentFolder(e){return[...this.watchers.keys()].find(n=>{let i=n.replace(/[#?].*/,"").replace(/\/?$/,"/");return e!==n&&e.startsWith(i)})}hasWatcher(e){return this.getParentFolder(e.uri)||this.getWatcher(e)!==void 0}startWatching(e){if(_r.debug(this.ctx,`WorkspaceWatcherProvider - Start watching workspace ${e.uri}`),this.hasWatcher(e)){this.getWatcher(e)?.startWatching();return}let r=this.createWatcher(e);this.watchers.set(e.uri,r)}stopWatching(e){this.getWatcher(e)?.stopWatching()}terminateSubfolderWatchers(e){let r=[];for(let o of this.watchers.values())r.push(o.workspaceFolder);let n=e.uri.replace(/[#?].*/,"").replace(/\/?$/,"/"),i=r.filter(o=>o.uri!==e.uri&&o.uri.startsWith(n));for(let o of i)this.terminateWatching(o);return i}terminateWatching(e){if(this.getWatcher(e)?.status!=="stopped")return this.stopWatching(e),this.watchers.delete(e.uri);this.watchers.delete(e.uri)}onFileChange(e,r,n,i){return this.getWatcher(e)?.onFileChange(Xl(this.ctx,r,"WorkspaceWatcherProvider.onFileChange"),n,i)}async getWatchedFiles(e){return await this.getWatcher(e)?.getWatchedFiles()??[]}getStatus(e){return this.getWatcher(e)?.status}};var H8=class{static{s(this,"WorkspaceLifecycleListener")}start(){}didAddWorkspace(e){}didRemoveWorkspace(e){}didTerminateWorkspaceSubfolders(e,r){}didChangeFiles(e){}},cgr="workspaceLifecycleManager",Xd=new dt(cgr),N1=class t{constructor(e){this.ctx=e;this.activeListeners=[];this.watchedWorkspaces=[];this.ctx=e;let r=_a(e,async()=>{r.dispose(),await this.start()})}static{s(this,"WorkspaceLifecycleManager")}async start(){for(let e of this.activeListeners)await e.isEnabled()?e.isStarted()?Xd.debug(this.ctx,`listener ${e.constructor.name} is already started`):(Xd.debug(this.ctx,`starting listener ${e.constructor.name}`),await e.start()):Xd.debug(this.ctx,`listener ${e.constructor.name} is not enabled`);Xd.debug(this.ctx,"WorkspaceLifecycleManager started"),this.ctx.get(dr).onDidChangeWorkspaceFolders(e=>{this.onWorkspacesAdded(e.added,this.ctx),this.onWorkspacesRemoved(e.removed,this.ctx)}),await this.onWorkspacesAdded(this.ctx.get(dr).getWorkspaceFolders(),this.ctx)}static isSubfolder(e,r){let n=e.uri,i=r.uri.replace(/[#?].*/,"").replace(/\/?$/,"/");return n!==i&&n.startsWith(i)}async onWorkspacesAdded(e,r){if(!e.length){Xd.debug(r,"No workspaces to add.");return}Xd.debug(r,`Adding workspaces: ${e.map(c=>c.uri).join(", ")}`);let n=[...this.watchedWorkspaces,...e];Xd.debug(r,`Combined workspaces: ${n.map(c=>c.uri).join(", ")}`);let i=n.filter((c,l,u)=>u.findIndex(f=>f.uri===c.uri)===l&&!u.some(f=>t.isSubfolder(c,f)));Xd.debug(r,`Filtered workspaces: ${i.map(c=>c.uri).join(", ")}`);let o=i.filter(c=>!this.watchedWorkspaces.some(l=>l.uri===c.uri));Xd.debug(r,`New workspaces: ${o.map(c=>c.uri).join(", ")}`);let a=this.watchedWorkspaces.filter(c=>!i.some(l=>l.uri===c.uri));Xd.debug(r,`Removed workspaces: ${a.map(c=>c.uri).join(", ")}`),this.watchedWorkspaces=i;for(let c of a){Xd.debug(r,`Terminating watching for removed workspace: ${c.uri}`),r.get(Jd).terminateWatching(c);for(let u of this.activeListeners)Xd.debug(r,`Notifying listener of removed workspace: ${c.uri}`),await u.didRemoveWorkspace(c)}for(let c of o){if(!c.uri)continue;Xd.debug(r,`Starting to watch new workspace: ${c.uri}`);let l=r.get(Jd);if(l.shouldStartWatching(c)){l.startWatching(c);let u=l.terminateSubfolderWatchers(c);if(u.length){Xd.debug(r,`Terminated subfolder watchers for workspace: ${c.uri}, Subfolders: ${u.map(f=>f.uri).join(", ")}`);for(let f of this.activeListeners)await f.didTerminateWorkspaceSubfolders(c,u)}for(let f of this.activeListeners)Xd.debug(r,`Adding file change listener for workspace: ${c.uri}`),l.onFileChange(c,f.didChangeFiles.bind(f))}}for(let c of this.activeListeners)for(let l of o)Xd.debug(r,`Notifying ${c.constructor.name} of added workspace: ${l.uri}`),await c.didAddWorkspace(l)}async onWorkspacesRemoved(e,r){if(e.length)for(let n of e){if(!n.uri)continue;r.get(Jd).terminateWatching(n),this.watchedWorkspaces=this.watchedWorkspaces.filter(o=>o.uri!==n.uri);for(let o of this.activeListeners)await o.didRemoveWorkspace(n)}}addListener(e){this.activeListeners.push(e)}removeListener(e){this.activeListeners=this.activeListeners.filter(r=>r!==e)}removeAllListeners(){this.activeListeners=[]}};function Eoe(t){t.set(N1,new N1(t))}s(Eoe,"setupWorkspaceLifecycleListener");d();var zpt=require("child_process");var boe=class extends rg{static{s(this,"GitCLIBranchLoader")}runCommand(e,r,n){return new Promise((i,o)=>{(0,zpt.execFile)(r,n,{cwd:e},(a,c)=>{a?o(a):i(c)})})}async tryRunCommand(e,r,n,i){try{return await this.runCommand(r,n,i)}catch(o){Kne.info(e,`Failed to run command '${n}' in ${r}:`,o);return}}async getBranchInfo(e,r){let n=ts(r);if(n===void 0)return;let i=await this.tryRunCommand(e,n,"git",["-c","safe.directory=*","branch","--show-current",...this.extraArgs()]);if(i!==void 0){let o=i.trim();return o?dE.branch(o):dE.detachedHead()}}extraArgs(){return[]}};d();var Ioe=class extends rg{static{s(this,"GitParsingBranchLoader")}async getBranchInfo(e,r){try{let n=e.get(Fi),i=Vi(r,".git","HEAD"),o=await n.readFileString(i);return this.parseHeadContent(o.trim())}catch(n){let i=typeof r=="string"?r:r.uri;Kne.info(e,`Failed to parse git HEAD file in ${i}:`,n);return}}parseHeadContent(e){if(e.startsWith("ref: refs/heads/")){let r=e.substring(16);return dE.branch(r)}else return this.isCommitSha(e)?dE.detachedHead():dE.detachedHead()}isCommitSha(e){return/^[a-f0-9]{40}$/i.test(e)}};d();d();var Toe=class{constructor(){this._tools=new Map}static{s(this,"ToolRegistry")}registerTool(e){this._tools.set(e.id,e)}unregisterTool(e){return this._tools.delete(e)}getTool(e){return this._tools.get(e)}listTools(){return Array.from(this._tools.values())}};d();d();d();d();var lgr=64;var aS={id:"copilot",displayName:"Copilot Language Server",description:"Copilot Language Server tool provider",isFirstPartyTool:!0},M1={id:"copilot-editor",displayName:"Editor",description:"Editor tool provider",isFirstPartyTool:!0},E2e=class{static{s(this,"LanguageModelTool")}constructor(e){this.type=e.type,this.toolProvider=e.toolProvider,this.name=e.name,this.displayName=e.displayName??this.name,this.description=e.description,this.displayDescription=e.displayDescription??this.description,this.inputSchema=e.inputSchema,this.annotations=e.annotations,this.id=`${this.toolProvider.id}.${this.name}`,this.nameForModel=(this.toolProvider.isFirstPartyTool?this.name:`${this.toolProvider.displayNamePrefix??this.toolProvider.id}_${this.name}`).slice(0,lgr)}},sS=class extends E2e{static{s(this,"BaseLanguageModelTool")}constructor(e){super(e)}},Oi=class{static{s(this,"LanguageModelTextPart")}constructor(e){this.value=e}},sP=class{static{s(this,"LanguageModelDataPart")}constructor(e){this.value=e}},aP=class{static{s(this,"LanguageModelPromptTsxPart")}constructor(e){this.value=e}};var Ao=class{static{s(this,"LanguageModelToolResult")}constructor(e,r){this.status=r,this.content=e}},Kpt=x.Object({content:x.Array(x.Union([x.Object({value:x.String()}),x.Object({value:x.Unknown()})])),status:x.Optional(x.Union([x.Literal("success"),x.Literal("error"),x.Literal("cancelled")]))}),woe=(r=>(r.Accept="accept",r.Dismiss="dismiss",r))(woe||{}),Ypt=x.Object({result:x.Enum(woe)});var sg=class extends sS{static{s(this,"ClsLanguageModelTool")}constructor(e){super({...e,toolProvider:aS,type:"shared"})}};d();var ugr=new Map([["copilot_semanticSearch","semantic_search"],["copilot_readFile","read_file"],["copilot_listDir","list_dir"],["copilot_getErrors","get_errors"],["copilot_runInTerminal","run_in_terminal"],["copilot_insertEdit","insert_edit_into_file"],["copilot_createFile","create_file"],["copilot_replaceString","replace_string_in_file"],["copilot_updateUserPreferences","update_user_preferences"],["copilot_fileSearch","file_search"],["copilot_findTextInFiles","grep_search"]]),dgr=new Map;for(let[t,e]of ugr)dgr.set(e,t);d();function $8(t){return`[${Pi(t)}](${t})`}s($8,"formatUriForFileWidget");function L1(t){let e=fgr(t);if(!e)throw new Error(`Invalid input path: ${t}. Be sure to use an absolute path.`);return e}s(L1,"resolvePathInput");function fgr(t){if(t.startsWith("/")||Jpt()&&mgr(t)||Jpt()&&t.startsWith("\\\\"))return kl(t)}s(fgr,"resolveFsUri");function Jpt(){return process.platform==="win32"}s(Jpt,"isWindows");function pgr(t){return t>=65&&t<=90||t>=97&&t<=122}s(pgr,"isWindowsDriveLetter");function mgr(t){return pgr(t.charCodeAt(0))&&t.charCodeAt(1)===58}s(mgr,"hasDriveLetter");function sq(t){let e="";return t.length>0&&(e=t.map(r=>r instanceof Oi?r.value:r instanceof aP?"":r instanceof sP?JSON.stringify(r.value):"").join(`
`)),e===""?"(empty)":e}s(sq,"parseToolResultToString");function _oe(t){let{content:e}=t;return{message:sq(e)}}s(_oe,"formatToolErrorResult");function Xpt(t){let{content:e}=t;return{data:e.map(r=>r instanceof Oi?{type:"text",value:r.value}:r instanceof aP?{type:"text",value:"<unsupported>"}:r instanceof sP?{type:"data",value:{mimeType:r.value.mimeType,data:r.value.data}}:{type:"text",value:""})}}s(Xpt,"formatToolSuccessResult");var Roe=class extends sg{static{s(this,"EditFileTool")}constructor(){super({name:"insert_edit_into_file",displayName:"Edit File",description:`Edit a file in the workspace. Use this tool once per file that needs to be modified, even if there are multiple changes for a file. Generate the "explanation" property first.
The system is very smart and can understand how to apply your edits to the files, you just need to provide minimal hints.
Avoid repeating existing code, instead use comments to represent regions of unchanged code. Be as concise as possible. For example:
// ...existing code...
{ changed code }
// ...existing code...
{ changed code }
// ...existing code...

Here is an example of how you should use format an edit to an existing Person class:
class Person {
	// ...existing code...
	age: number;
	// ...existing code...
	getAge() {
	return this.age;
	}
}`,displayDescription:"Edit a file in the workspace.",inputSchema:x.Object({filePath:x.String({description:"The absolute path of the file to edit."}),code:x.String({description:`The code change to apply to the file.
The system is very smart and can understand how to apply your edits to the files, you just need to provide minimal hints.
Avoid repeating existing code, instead use comments to represent regions of unchanged code. Be as concise as possible. For example:
// ...existing code...
{ changed code }
// ...existing code...
{ changed code }
// ...existing code...

Here is an example of how you should use format an edit to an existing Person class:
class Person {
	// ...existing code...
	age: number;
	// ...existing code...
	getAge() {
		return this.age;
	}
}`}),explanation:x.String({description:"A short explanation of the edit being made."})})})}async invoke(e,r,n){try{let i=await this.mapCode(r.input,e,n),o=i.code,a=await this.invokeClientEditFileTool(e,r,o,n);return await this.getFinalEditFileResult(e,r,a,i.editSurvivalTrackingSession,i.telemetry)}catch(i){let o=i instanceof Error?i.message:"An unknown error occurred";return new Ao([new Oi(o)],"error")}}async mapCode(e,r,n){let{filePath:i}=e,o=L1(i);if(!o)throw new Error(`Invalid file path: ${i}`);return await new A8(r.ctx).mapCode({code:e.code,resource:o,markdownBeforeBlock:e.explanation},r.toLlmInteraction(),{chatRequestSource:r.conversation.source,chatRequestModel:r.turn.resolvedModelConfiguration?.modelFamily??r.turn.userRequestedModel},n,void 0,!0,r.copilotEditsSessionHeader)}async invokeClientEditFileTool(e,r,n,i){let o=e.ctx.get(bu).getToolByNameAndProvider("insert_edit_into_file",M1);if(!o)throw new Error("Client tool insert_edit_into_file is not registered");return e.ctx.get(bu).invokeTool(e,o.id,{toolInvocationToken:r.toolInvocationToken,input:{filePath:r.input.filePath,code:n,explanation:r.input.explanation},roundId:r.roundId,toolCallId:r.toolCallId},i)}async getFinalEditFileResult(e,r,n,i,o){if(n.status!=="success")return n;let a=TT({uri:L1(r.input.filePath),languageId:"UNKNOWN"});if(i){let f=await Za(e.ctx,e,void 0);i.startReporter(p=>{this.handleEditSurvivalTelemetry(e,p,f,a,o)})}let c=sq(n.content),l=[];l.push(`<file_after_edit path="${r.input.filePath}">`),l.push("This is the new state of the file after the edit. Base future edits off of this file, no need to read it again, unless a terminal command may have changed it.");let u=new cm({code:c,languageId:a,noFilePath:!0});return l.push(...u.renderAsArray()),l.push("</file_after_edit>"),new Ao([new Oi(l.join(`
`))],"success")}handleEditSurvivalTelemetry(e,r,n,i,o){FX(e.ctx,"agentPanel",{requestSource:o?.requestSource??"",chatRequestModel:o?.chatRequestModel??"",mapper:o?.mapper??"",headerRequestId:o?.headerRequestId??"",mode:(e.turn.getChatModeWithDefault()??"unknown").toLowerCase(),modelId:e.turn.getResolvedModelId()??"unknown",languageId:i},{survivalRateFourGram:r.fourGram,survivalRateNoRevert:r.noRevert,timeDelayMs:r.timeDelayMs,didBranchChange:r.didBranchChange,readDocumentTimeMs:r.readDocumentTimeMs??-1,diffComputationTimeMs:r.diffComputationTimeMs??-1,arc:r.arc??-1,originalCharCount:r.originalCharCount??-1,currentLineCount:r.currentLineCount??-1,currentDeletedLineCount:r.currentDeletedLineCount??-1,originalLineCount:r.originalLineCount??-1,originalDeletedLineCount:r.originalDeletedLineCount??-1},{currentFileContent:r.currentFileContent},n,"codeMapper.trackEditSurvival")}prepareInvocation(e,r){let{input:n}=e;if(!n.filePath.length)return{progressMessage:"Running insert_edit_into_file tool"};let i=L1(n.filePath);return{progressMessage:`Editing ${$8(i)}`}}static toEditFileParams(e){if(typeof e.filePath!="string")throw new Error("filePath must be a string");if(typeof e.code!="string")throw new Error("code must be a string");if(typeof e.explanation!="string")throw new Error("explanation must be a string");return{filePath:e.filePath,code:e.code,explanation:e.explanation}}};d();var Zpt=new dt("findFilesTool"),koe=class t extends sg{static{s(this,"FindFilesTool")}static{this.timeOutInSeconds=15}constructor(){super({name:"file_search",displayName:"Find Files",description:`Search for files in the workspace by glob pattern. This only returns the paths of matching files. Use this tool when you know the exact filename pattern of the files you're searching for. Glob patterns match from the root of the workspace folder. Examples:
- **/*.{js,ts} to match all js/ts files in the workspace.
- src/** to match all files under the top-level src folder.
- **/foo/**/*.js to match all js files under any foo folder in the workspace.`,displayDescription:"Search for files in the workspace by glob pattern.",inputSchema:x.Object({query:x.String({description:"Search for files with names or paths matching this glob pattern."}),maxResults:x.Optional(x.Number({description:"The maximum number of results to return. Do not use this unless necessary, it can slow things down. By default, only some matches are returned. If you use this and don't see what you're looking for, you can try again with a more specific query or a larger maxResults."}))})})}async invoke(e,r,n){try{let i;try{if(n.isCancellationRequested)return new Ao([new Oi("Cancelled")],"cancelled");i=await e.ctx.get(EE).resolvePath()}catch(g){throw new Error(`Failed to run file_search since failed to get ripgrep path: ${String(g)}`)}let{query:o,maxResults:a=20}=r.input,c=e.turn.workspaceFolders;if(!c?.length)return new Ao([new Oi("Failed to invoke tool file_search since no workspace folders found")],"error");let l=e.ctx.get(hy),u={},f=c.map(async g=>{if(n.isCancellationRequested)throw new Error("Canceled");try{Zpt.debug(e.ctx,`Start searching for query ${o} in workspace folder: ${g.uri.toString()}`);let A=await l.execute(i,["--files","-g",o],n,{cwd:sc(g.uri)},t.timeOutInSeconds*1e3);Zpt.debug(e.ctx,`Finished searching for query ${o} in workspace folder: ${g.uri.toString()} with results: ${A}`),u[g.uri.toString()]=A.split(`
`).map(y=>y.trim()).filter(y=>y.length>0).map(y=>`${sc(Vi(g.uri,y))}`)}catch(A){let y=A instanceof Error?A.message:"An unknown error occurred";throw new Error(`Error processing workspace folder ${g.uri.toString()}: ${y}`)}});try{await Promise.all(f)}catch(g){let A=g instanceof Error?g.message:"An unknown error occurred";return new Ao([new Oi(A)],"error")}let p=[],m=a;for(;m>0;){let g=!1;for(let A in u)u[A].length>0&&m>0&&(p.push(u[A].shift()),m--,g=!0);if(!g)break}let h=p.length===0?`No files found matching query: ${o}`:p.length===1?`Found 1 file matching query: ${o}
${p[0]}`:`Found ${p.length} files matching query: ${o}
${p.join(`
`)}`;return new Ao([new Oi(h)],"success")}catch(i){let o=i instanceof Error?i.message:"An unknown error occurred";return new Ao([new Oi(o)],"error")}}prepareInvocation(e,r){let{input:n}=e;return n.query.length?{progressMessage:`Searching for files matching query: ${n.query}`}:{progressMessage:"Running file_search tool"}}static toFindFilesParams(e){if(typeof e.query!="string")throw new Error("query must be a string");if(e.maxResults!=null&&(typeof e.maxResults!="number"||e.maxResults<0))throw new Error("maxResults must be a positive number or undefined");return{query:e.query,maxResults:typeof e.maxResults=="number"?e.maxResults:void 0}}};d();var e0t=new dt("findTextInFilesTool"),Poe=class t extends sg{static{s(this,"FindTextInFilesTool")}static{this.timeOutInSeconds=15}constructor(){super({name:"grep_search",displayName:"Find Text In Files",description:"Do a text search in the workspace. Use this tool when you know the exact string you're searching for.",displayDescription:"Do a text search in the workspace.",inputSchema:x.Object({query:x.String({description:"The pattern to search for in files in the workspace. Can be a regex or plain text pattern"}),isRegexp:x.Optional(x.Boolean({description:"Whether the pattern is a regex. False by default."})),includePattern:x.Optional(x.String({description:"Search files matching this glob pattern. Will be applied to the relative path of files within the workspace."}))})})}async invoke(e,r,n){try{let i;try{if(n.isCancellationRequested)return new Ao([new Oi("Cancelled")],"cancelled");i=await e.ctx.get(EE).resolvePath()}catch(y){throw new Error(`Failed to run grep_search since failed to get ripgrep path: ${String(y)}`)}let{query:o,isRegexp:a=!1,includePattern:c}=r.input,l=20,u=e.turn.workspaceFolders;if(!u?.length)return new Ao([new Oi("Failed to invoke tool grep_search since no workspace folders found")],"error");let f=e.ctx.get(hy),p={},m=u.map(async y=>{if(n.isCancellationRequested)throw new Error("Canceled");try{e0t.debug(e.ctx,`Start searching for query ${o} in workspace folder: ${y.uri.toString()}`);let E=[a?"--regexp":"--fixed-strings",o,...c?["-g",c]:[],"--no-heading","--line-number","--color","never",sc(y.uri)],b=await f.execute(i,E,n,{cwd:sc(y.uri)},t.timeOutInSeconds*1e3);e0t.debug(e.ctx,`Finished searching for query ${o} in workspace folder: ${y.uri.toString()} with results: ${b}`),p[y.uri.toString()]=b.split(`
`).map(S=>S.trim()).filter(S=>S.length>0)}catch(E){let b=E instanceof Error?E.message:"An unknown error occurred";throw new Error(`Error processing workspace folder ${y.uri.toString()}: ${b}`)}});try{await Promise.all(m)}catch(y){let E=y instanceof Error?y.message:"An unknown error occurred";return new Ao([new Oi(E)],"error")}let h=[],g=l;for(;g>0;){let y=!1;for(let E in p)p[E].length>0&&g>0&&(h.push(p[E].shift()),g--,y=!0);if(!y)break}let A=h.length===0?`Searched text for ${o}, no results`:h.length===1?`Searched text for: ${o}, 1 result
${h[0]}`:`Searched text for: ${o}, ${h.length} results
${h.join(`
`)}`;return new Ao([new Oi(A)],"success")}catch(i){let o=i instanceof Error?i.message:"An unknown error occurred";return new Ao([new Oi(o)],"error")}}prepareInvocation(e,r){let{input:n}=e;return n.query.length?{progressMessage:`Searching for text in files matching query: ${n.query}`}:{progressMessage:"Running grep_search tool"}}static toFindTextInFilesParams(e){if(typeof e.query!="string")throw new Error("query must be a string");if(e.isRegexp!==void 0&&typeof e.isRegexp!="boolean")throw new Error("isRegexp must be a boolean");if(e.includePattern!==void 0&&typeof e.includePattern!="string")throw new Error("includePattern must be a string");return{query:e.query,isRegexp:e.isRegexp??!1,includePattern:e.includePattern}}};d();var Boe=Be(require("path"));var Doe=class extends sg{static{s(this,"ListDirTool")}constructor(){super({name:"list_dir",displayName:"List Directory",description:"List the contents of a directory. Result will have the name of the child. If the name ends in /, it's a folder, otherwise a file",displayDescription:"List the contents of a directory",inputSchema:x.Object({path:x.String({description:"The absolute path to the directory to list."})})})}async invoke(e,r,n){let{path:i}=r.input,o=e.turn.workspaceFolders,a=e.turn.workspaceFolder,c=L1(i);if(!this.isPathWithinWorkspace(c,o,a))return new Ao([new Oi("Error: Path is outside of workspace folders")],"error");let u=await e.ctx.get(Fi).readDirectory(c.toString());return u.length===0?new Ao([new Oi("Folder is empty")],"success"):new Ao([new Oi(u.map(([f,p])=>`${f}${p&2?"/":""}`).join(`
`))],"success")}prepareInvocation(e,r){let n=L1(e.input.path);return{progressMessage:`Reading directory ${$8(n)}`}}isPathWithinWorkspace(e,r,n){return!r&&!n?!0:r&&r.length>0?r.some(i=>this.isUriWithinDirectory(e,i.uri)):n?this.isUriWithinDirectory(e,n.uri):!1}isUriWithinDirectory(e,r){let n=ts(e),i=ts(r);if(!n||!i)return!1;let o=Boe.relative(i,n);return o===""?!0:!o.startsWith("..")&&!Boe.isAbsolute(o)}static toListDirParams(e){if(typeof e.path!="string")throw new Error("path must be a string");return{path:e.path}}};d();var Noe=class extends sg{static{s(this,"ReadFileTool")}constructor(){super({name:"read_file",displayName:"Read File",description:`Read the contents of a file.

You must specify the line range you're interested in, and if the file is larger, you will be given an outline of the rest of the file. If the file contents returned are insufficient for your task, you may call this tool again to retrieve more content.`,displayDescription:"Read a file in the workspace.",inputSchema:x.Object({filePath:x.String({description:"The absolute path of the file to read."}),startLineNumberBaseZero:x.Number({description:"The line number to start reading from, 0-based."}),endLineNumberBaseZero:x.Number({description:"The inclusive line number to end reading at, 0-based."})})})}async invoke(e,r,n){try{let{filePath:i,startLineNumberBaseZero:o,endLineNumberBaseZero:a}=r.input,c=L1(i);if(!c)throw new Error(`Invalid file path: ${i}`);let u=await e.ctx.get(En).getOrReadTextDocument({uri:c});if(u.status==="valid"){let f=new cm({code:u.document.getText({start:{line:o,character:0},end:{line:a+1,character:0}}),languageId:u.document.detectedLanguageId,uri:c});return new Ao([new Oi(f.renderAsString(`
`))],"success")}else return new Ao([new Oi(`Failed to read file ${i} with result ${JSON.stringify(u)}`)],"error")}catch(i){let o=i instanceof Error?i.message:"An unknown error occurred";return new Ao([new Oi(o)],"error")}}prepareInvocation(e,r){let{input:n}=e;if(!n.filePath.length)return{progressMessage:"Running read_file tool"};let i=L1(n.filePath);return{progressMessage:`Reading file ${$8(i)}`}}static toReadFileParams(e){if(typeof e.filePath!="string")throw new Error("filePath must be a string");if(typeof e.startLineNumberBaseZero!="number")throw new Error("startLineNumberBaseZero must be a number");if(typeof e.endLineNumberBaseZero!="number")throw new Error("endLineNumberBaseZero must be a number");return{filePath:e.filePath,startLineNumberBaseZero:e.startLineNumberBaseZero,endLineNumberBaseZero:e.endLineNumberBaseZero}}};function t0t(){return[new Doe,new Noe,new Roe,new koe,new Poe]}s(t0t,"getAllClsTools");var bu=class{constructor(e){this.ctx=e;this._toolRegistry=new Toe;for(let r of t0t())this._toolRegistry.registerTool(r)}static{s(this,"ToolsService")}registerTool(e){this._toolRegistry.registerTool(e)}unregisterTool(e){return typeof e=="string"?this._toolRegistry.unregisterTool(e):this._toolRegistry.unregisterTool(e.id)}prepareInvocation(e,r,n){let i=this._toolRegistry.getTool(e);if(!i)throw new Error(`Tool with id '${e}' is undefined`);return i.prepareInvocation?.(r,n)??{}}async invokeTool(e,r,n,i){if(i.isCancellationRequested)throw new ic;let o=this._toolRegistry.getTool(r);if(!o)throw new Error(`Tool with id '${r}' is undefined`);return await o.invoke?.(e,n,i)??new Ao([],"success")}async invokeToolConfirmation(e,r,n,i){if(i.isCancellationRequested)throw new ic;let o=this._toolRegistry.getTool(r);if(!o)throw new Error(`Tool with id '${r}' is undefined`);return await o.invokeConfirmation?.(e,n,i)??{result:"dismiss"}}getToolById(e){return this._toolRegistry.getTool(e)}getToolByNameAndProvider(e,r){return this._toolRegistry.listTools().find(n=>n.name===e&&n.toolProvider.id===r.id)}getToolsForModel(){return Array.from(this.getToolMapForModel().values())}getToolMapForModel(){let e=new Map;for(let l of this._toolRegistry.listTools())e.has(l.toolProvider.id)||e.set(l.toolProvider.id,[]),e.get(l.toolProvider.id)?.push(l);let r=e.get(aS.id)?.find(l=>l.name==="insert_edit_into_file");r&&e.get(aS.id)?.splice(e.get(aS.id)?.indexOf(r)??0,1);let n=e.get(M1.id)?.find(l=>l.name==="insert_edit_into_file");n&&e.get(M1.id)?.splice(e.get(M1.id)?.indexOf(n)??0,1);let i=new Map;r&&n&&i.set(r.nameForModel,r);let o=e.get(M1.id)??[],a=e.get(aS.id)??[],c=Array.from(e.entries()).filter(([l])=>l!==aS.id&&l!==M1.id).flatMap(([,l])=>l);return o.forEach(l=>{i.has(l.nameForModel)||i.set(l.nameForModel,l)}),a.forEach(l=>{i.has(l.nameForModel)||i.set(l.nameForModel,l)}),c.forEach(l=>{i.has(l.nameForModel)||i.set(l.nameForModel,l)}),i}};d();d();var lP=class{static{s(this,"MultiLanguageContextProviderFeatureLifecycle")}async dispose(){}};d();var i0t=require("crypto"),b2e=require("fs"),I2e=Be(require("path"));var r0t="symbolDatabaseLookup",n0t="multiLanguageContextProviderDocumentSymbols",uP=class{constructor(e){this.persistenceManager=e}static{s(this,"WorkspaceDatabasePersistenceManager")}async getDBFilePath(e){await this.init();let r=await this.persistenceManager.read(r0t,e);return r||(r=await this.createDBFile(e)),I2e.default.join(this.persistenceManager.directory,n0t,r)}async init(){let e=I2e.default.join(this.persistenceManager.directory,n0t);await this.createIfNotExists(e)}async dirExists(e){try{return await b2e.promises.access(e),!0}catch{return!1}}async createIfNotExists(e){try{await this.dirExists(e)||await b2e.promises.mkdir(e,{recursive:!0})}catch{throw new Error(`Failed to create directory: ${e}`)}}async createDBFile(e){let r=`${(0,i0t.randomUUID)()}.db`;return await this.persistenceManager.update(r0t,e,r),r}async deleteDBFile(e){}};d();d();var aq=class{constructor(e,r){this.workspaceUris=e;this.params=r}static{s(this,"FileWatcher")}};d();d();d();var Moe=Be(require("path")),o0t=require("worker_threads");function s0t(t,e){return new o0t.Worker(Moe.default.resolve(Moe.default.extname(__filename)!==".ts"?__dirname:Moe.default.resolve(__dirname,"../../dist"),t),{workerData:e})}s(s0t,"createWorker");d();var Loe=class{constructor(e){this.maxDegreeOfParalellism=e;this.outstandingPromises=[],this.runningPromises=0}static{s(this,"PriorityLimiter")}queue(e,r=!1){return new Promise((n,i)=>{r?this.outstandingPromises.unshift({factory:e,c:n,e:i}):this.outstandingPromises.push({factory:e,c:n,e:i}),this.consume()})}consume(){for(;this.outstandingPromises.length&&this.runningPromises<this.maxDegreeOfParalellism;){let e=this.outstandingPromises.shift();this.runningPromises++;let r=e.factory();r.then(e.c,e.e),r.then(()=>this.consumed(),()=>this.consumed())}}consumed(){this.runningPromises--,this.outstandingPromises.length>0&&this.consume()}};var a0t=Be(hi());var Foe="main.js",Ooe=class{constructor(e,r,n=3){this.promiseResolvers=new Map;this.id=0;try{let i={cwd:process.cwd(),indexWorkspaceRoots:e,params:r};this.worker=s0t(Foe,i),this.worker.on("message",this.handleWorkerMessage.bind(this)),this.worker.on("error",o=>{this.handleUnexpectedError(o)}),this.postMessageQueue=new Loe(n)}catch(i){throw console.error(`Failed to create worker: ${i.message}`),i}}static{s(this,"IndexClient")}dispose(){return this.postMessageInQueue(new cJ(this.id++),a0t.CancellationToken.None,!0)}async indexFile(e,r,n){return await this.postMessageInQueue(new oJ(this.id++,e,r),n)}async getAllFileNames(e,r){return this.postMessageInQueue(new sJ(this.id++,e),r)}getContext(e,r,n,i,o,a){return this.postMessageInQueue(new aJ(this.id++,e,r,n,i,o),a,!0)}tryCreateIndex(e,r,n){return this.postMessageInQueue(new nJ(this.id++,e,r),n)}async postMessageInQueue(e,r,n=!1){return this.postMessageQueue.queue(()=>this.postMessageAndWait(e,r),n)}tryRemoveIndex(e,r){return this.postMessageAndWait(new iJ(this.id++,e),r)}async postMessageAndWait(e,r){if(this.fatalError)return Promise.reject(this.fatalError);let n=new Promise((o,a)=>{this.promiseResolvers.set(e.id,{resolve:o,reject:a})});this.worker.postMessage(e);let i=r.onCancellationRequested(()=>{this.worker.postMessage(new rJ(e.id))});try{return await n}finally{i.dispose()}}handleWorkerMessage(e){if(e.operation!=="response")throw new Error("Unexpected message operation");let r=this.promiseResolvers.get(e.id);if(!r)throw new Error(`Received response for message that isn't in progress: ${e.id}`);this.promiseResolvers.delete(e.id),e.error?(e.error.code=e.code,r.reject(e.error)):r.resolve(e.data)}handleUnexpectedError(e){let r;if(e instanceof Error){r=e,r.code==="MODULE_NOT_FOUND"&&r.message?.endsWith(Foe+"'")&&(r=new Error(`Failed to load ${Foe}`),r.code="CopilotPromptLoadFailure");let n=new Error().stack;r.stack&&n?.match(/^Error\n/)&&(r.stack+=n.replace(/^Error/,""))}else e&&typeof e=="object"&&"name"in e&&"status"in e&&e.name==="ExitStatus"&&typeof e.status=="number"?(r=new Error(`${Foe} exited with status ${e.status}`),r.code=`CopilotPromptWorkerExit${e.status}`):r=new Error(`Non-error thrown: ${JSON.stringify(e)}`);for(let n of this.promiseResolvers.values())n.reject(r);this.promiseResolvers.clear(),this.fatalError=r}};var cq=Be(hi());var pm=new dt(jT),dP=class{constructor(e,r,n,i,o){this.ctx=e;this.watcher=r;this.workspaceDatabasePersistenceManager=n;this.workspaceInit=new Map;this.watcher.onFileChange(async(a,c)=>{await this.indexFile(c,this.languageId(c)??"plaintext")}),this.watcher.onWorkspaceChange(async(a,c)=>{if(a===1){pm.debug(this.ctx,`workspace removed: ${c}`),await this.indexClient.tryRemoveIndex(c,cq.CancellationToken.None);return}pm.debug(this.ctx,`workspace added: ${c}`),await this.indexAddedWorkspace(c)}),this.indexClient=new Ooe(i,o);for(let a of i){let c=a.rootPath;this.workspaceInit.set(c,this.doWorkspaceIndex(c).then(()=>{pm.debug(this.ctx,`workspace ${c} indexed`),this.workspaceInit.delete(c)}))}}static{s(this,"MultiLanguageContextIndexWatcher")}isInitializing(e){for(let[r]of this.workspaceInit)if(e.startsWith(r))return!0;return!1}dispose(){return this.indexClient.dispose()}async indexAddedWorkspace(e){let r=await ggr(e,this.workspaceDatabasePersistenceManager);await this.indexClient.tryCreateIndex(r.rootPath,r.databaseFilePath,cq.CancellationToken.None),this.workspaceInit.has(e)&&await this.workspaceInit.get(e);let n=this.doWorkspaceIndex(e).then(()=>{pm.debug(this.ctx,`workspace ${e} indexed`),this.workspaceInit.delete(e)});this.workspaceInit.set(e,n)}async doWorkspaceIndex(e){pm.debug(this.ctx,`indexing workspace ${e}`);let r=HCe.map(f=>`*${f}`);if(r.length===0)return;let i=`**/${HCe.length===1?r[0]:`{${r.join(",")}}`}`,o=this.ctx.get(Y0),a=await Promise.all([o.findFiles(i,{uri:e},{excludeGitignoredFiles:!0,excludeIDEIgnoredFiles:!0,excludeIDESearchIgnoredFiles:!0}),this.indexClient.getAllFileNames(e,cq.CancellationToken.None)]),c=a[0],l=a[1],u=Array.from(new Set([...c,...l]));pm.debug(this.ctx,`found ${u.length} files to index in ${e}`),await Promise.all(u.map(async f=>{let p=this.languageId(f);p&&await this.indexFile(f.replace(/\/+$/,""),p)})),pm.debug(this.ctx,`finished indexing workspace ${e}`)}async indexFile(e,r){try{pm.debug(this.ctx,`index triggered for ${e}`),await this.indexClient.indexFile(e,r,cq.CancellationToken.None)}catch(n){pm.debug(this.ctx,`failed to index ${e} with ${n}`)}}languageId(e){return Uje(e)}};async function ggr(t,e){return{databaseFilePath:await e.getDBFilePath(t),rootPath:t}}s(ggr,"createIndexableWorkspaceFolder");d();d();var c0t=100,Agr=5e3,Qoe=class{static{s(this,"CachedContextFetcher")}constructor(){}runWithCache(e,r,n,i,o,a,c,l){let u=Date.now(),f=this.get(n,i,r,u);if(f)return this.incrementRefCount(f),l.onCancellationRequested(()=>this.decrementRefCount(f)),f.value;if(!a)return e(r,n,i,o,c,l);let p=new hn.CancellationTokenSource,m=s(()=>p.cancel(),"cancel"),h=e(r,n,i,o,c,p.token);return f=this.setBasedOnLastDelimiter(n,i,r,u,h,m),this.incrementRefCount(f),l.onCancellationRequested(()=>this.decrementRefCount(f)),h}get(e,r,n,i){if(this.cachedValue&&this.cachedValue.uri===n&&!(Math.abs(this.cachedValue.cursorPosition-r)>c0t)){if(r>this.cachedValue.cursorPosition){if(e.substring(this.cachedValue.cursorPosition,r).match(/[^A-Za-z0-9]/))return}else if(r<this.cachedValue.cursorPosition)return;if(!(i-this.cachedValue.timestamp>Agr))return this.cachedValue}}setBasedOnLastDelimiter(e,r,n,i,o,a){let c=e.substring(0,r),l=/[A-Za-z0-9]+$/.exec(c),u=r;l&&(u=l.index),r-u>c0t&&(u=r);let f={cursorPosition:u,uri:n,timestamp:i,fullText:e,value:o.finally(()=>{f.complete=!0}),refCount:0,cancel:a,uuid:br(),complete:!1};return this.cachedValue=f}incrementRefCount(e){e&&e.refCount++}decrementRefCount(e){e&&!e.complete&&(e.refCount--,e.refCount<=0&&e.cancel())}};var Uoe=class{constructor(e){this.id=jT;this.selector=Array.from(HY.keys()).map(e=>({language:e}));try{this.documentManager=e.get(dr),this.resolver=new T2e(this.documentManager,e)}catch(r){throw pm.error(e,"Failed to create multi-language context provider",r),r}}static{s(this,"MultiLanguageContextProvider")}},T2e=class{constructor(e,r){this.ctx=r;this.documentManager=e,this.cachedContextFetcher=new Qoe}static{s(this,"MultiLanguageContextResolver")}resolve(e,r){return this.resolveImpl(e,r)}async resolveImpl(e,r){let n=this.ctx.get(lP).indexWatcher;if(!n)return[];if(n.isInitializing(e.documentContext.uri))return[];let i=n.indexClient;try{let o=await this.documentManager.getTextDocument({uri:e.documentContext.uri});if(o===void 0||o?.version!==e.documentContext.version)return[];let a=e.documentContext.position,c=e.documentContext.proposedEdits??[],l=YC(o,a);l=l.applyEdits(c);let u=pJe(e.activeExperiments),f=await this.cachedContextFetcher.runWithCache(i.getContext.bind(i),e.documentContext.uri,l.textDocument.getText(),l.textDocument.offsetAt(l.position),e.documentContext.languageId,l.editsWithPosition.length===0,u,r);return pm.debug(this.ctx,`Context items found for ${e.documentContext.uri}: ${f.map(p=>JSON.stringify(p)).join(", ")}`),f}catch(o){if(SY(o))return[];throw pm.error(this.ctx,"Failed to get context",o),o}}};var lq=class extends H8{constructor(r){super();this.started=!1;this.ctx=r,this.ctx.get(N1).addListener(this)}static{s(this,"AgentMultiLanguageContextProvider")}async start(){if(!this.started&&await this.isEnabled()&&!this.ctx.get(Hc).providers.some(r=>r.id===jT)){let r=this.ctx.get(uP);this.fileWatcher=new w2e([],{excludeGitignoredFiles:!0,excludeIDEIgnoredFiles:!1,excludeIDESearchIgnoredFiles:!1}),this.multiLanguageContextIndexWatcher=new dP(this.ctx,this.fileWatcher,r,[]),this.fileSearch=new S2e(this.ctx),this.ctx.set(aq,this.fileWatcher),this.ctx.set(Y0,this.fileSearch),this.ctx.set(dP,this.multiLanguageContextIndexWatcher),this.ctx.get(Hc).registerContextProvider(new Uoe(this.ctx)),this.started=!0}}isStarted(){return this.started}async isEnabled(){let r=await this.ctx.get(Mt).fetchTokenAndUpdateExPValuesAndAssignments(),n=tZ(this.ctx,r);return n.includes(jT)||n.length===1&&n[0]==="*"}async didAddWorkspace(r){await this.isEnabled()&&await this.fileWatcher?.triggerWorkspaceChange(0,r.uri)}async didRemoveWorkspace(r){await this.isEnabled()&&await this.fileWatcher?.triggerWorkspaceChange(1,r.uri)}async didTerminateWorkspaceSubfolders(r,n){if(await this.isEnabled())return super.didTerminateWorkspaceSubfolders(r,n)}async didChangeFiles(r){if(await this.isEnabled())for(let n of r.documents)await this.fileWatcher?.triggerFileChange(this.toFileWatcherType(r.type),n.uri)}toFileWatcherType(r){switch(r){case"create":return 2;case"delete":return 1;case"update":return 0;default:throw new Error("Unknown file watcher event type")}}},w2e=class extends aq{constructor(r,n){super(r,n);this.fileChangeListeners=[];this.workspaceChangeListeners=[]}static{s(this,"MultiLanguageFileWatcher")}onFileChange(r){this.fileChangeListeners.push(r)}onWorkspaceChange(r){this.workspaceChangeListeners.push(r)}dispose(){}async triggerFileChange(r,n){for(let i of this.fileChangeListeners)await i(r,n)}async triggerWorkspaceChange(r,n){for(let i of this.workspaceChangeListeners)await i(r,n)}},S2e=class extends Y0{constructor(r){super();this.ctx=r}static{s(this,"LspFileSearch")}async findFiles(r,n,i){return(await this.ctx.get(Jd).getWatchedFiles(n)).map(a=>this.ctx.get(dr).getTextDocumentUnsafe(a)?.clientUri??a.uri)}};var _2e=class extends lP{static{s(this,"AgentMultiLanguageContextProviderFeatureLifecycle")}constructor(e){super(),this.agentMultiLanguageContextProvider=new lq(e),e.set(lq,this.agentMultiLanguageContextProvider)}get indexWatcher(){return this.agentMultiLanguageContextProvider?.multiLanguageContextIndexWatcher}async tryStart(){}async dispose(){return super.dispose()}};function l0t(t){let e=t.get(yi),r=new uP(e);t.set(uP,r),t.set(lP,new _2e(t))}s(l0t,"setupMultiLanguageContextProviderFeature");d();d();d();var F1=new Map;F1.set("copilot",{app:"copilot-client",catalog_service:"CopilotCompletionsVSCode"});F1.set("copilot-intellij",{app:"copilot-intellij",catalog_service:"CopilotIntelliJ"});F1.set("copilot-xcode",{app:"copilot-xcode",catalog_service:"CopilotXcode"});F1.set("copilot-eclipse",{app:"copilot-eclipse",catalog_service:"CopilotEclipse"});F1.set("copilot.vim",{app:"copilot-vim",catalog_service:"CopilotVim"});F1.set("copilot-vs",{app:"copilot-vs",catalog_service:"CopilotVS"});var Cgr=new dt("sdk");function qoe(t,e){F1.has(t.get(cn).getEditorPluginInfo().name)||Cgr.warn(t,...e)}s(qoe,"deprecationWarning");var f1t=Be(lB()),Cm=Be(wA());d();d();d();var tr={ParseError:-32700,InvalidRequest:-32600,MethodNotFound:-32601,InvalidParams:-32602,InternalError:-32603,ServerNotInitialized:-32002,RequestCancelled:-32800,ContentModified:-32801,ServerCancelled:-32802,NoCopilotToken:1e3,DeviceFlowFailed:1001,CopilotNotAvailable:1002};var ud=class extends Error{static{s(this,"SchemaValidationError")}constructor(e){super(u0t(e))}};function Ze(t,e){let r=ta.Compile(t);return async(n,i,o)=>{if(!r.Check(o)){let a=u0t(r.Errors(o));return[null,{code:tr.InvalidParams,message:a}]}return e(n,i,o)}}s(Ze,"addMethodHandlerValidation");function u0t(t){return`Schema validation failed with the following errors:
${Array.from(t).map(r=>`- ${r.path}: ${r.message}`).join(`
`)}`}s(u0t,"createErrorMessage");d();var R2e=Be(hi());d();var O1=class{constructor(e){this.ctx=e}static{s(this,"AbstractCommand")}};var Hoe="github.copilot.finishDeviceFlow",k2e=class extends O1{constructor(){super(...arguments);this.name=Hoe;this.arguments=x.Tuple([])}static{s(this,"FinishDeviceFlowCommand")}async handle(r,n){let i=this.ctx.get(Rf),o=i.pendingSignIn;if(!o)throw new R2e.ResponseError(tr.InvalidRequest,"No pending sign in");try{await this.ctx.get(ju).open(o.verificationUri)}catch(a){I0.warn(this.ctx,"Failed to open",o.verificationUri),I0.exception(this.ctx,a,Hoe)}try{return await o.status}catch(a){throw new R2e.ResponseError(tr.DeviceFlowFailed,String(a))}finally{i.pendingSignIn=void 0}}},d0t=[k2e];d();d();var Gs=class extends Sr{static{s(this,"CopilotCompletionCache")}constructor(e=100){super(e)}};var uq="github.copilot.didAcceptCompletionItem",P2e=class extends O1{constructor(){super(...arguments);this.name=uq;this.arguments=x.Tuple([x.String({minLength:1})])}static{s(this,"DidAcceptCommand")}handle(r,[n]){let o=this.ctx.get(Gs).get(n);return o?(j3(this.ctx,o),!0):!1}},f0t=[P2e];d();var vgr="github.copilot.didAcceptNextEditSuggestionItem",D2e=class extends O1{constructor(){super(...arguments);this.name=vgr;this.arguments=x.Tuple([x.String({minLength:1})])}static{s(this,"DidAcceptCommand")}async handle(r,[n]){return await this.ctx.get(py).handleAcceptance(n),!0}},p0t=[D2e];d();var N2e="github.copilot.didAcceptPanelCompletionItem",B2e=class extends O1{constructor(){super(...arguments);this.name=N2e;this.arguments=x.Tuple([x.String({minLength:1})])}static{s(this,"DidAcceptPanelCompletionItemCommand")}handle(r,n){let[i]=n,a=this.ctx.get(Gs).get(i);return a?(Q7(this.ctx,a.triggerCategory,a.displayText,a.offset,a.uri,a.telemetry,{compType:"full",acceptedLength:a.displayText.length,acceptedLines:ek(a.displayText).length},a.copilotAnnotations),!0):!1}},m0t=[B2e];var xgr=[...d0t,...f0t,...p0t,...m0t];function h0t(t,e){let r=new Map;for(let n of xgr){let i=new n(t),o=ta.Compile(i.arguments);r.set(i.name,{typeCheck:o,command:i})}return e.onExecuteCommand((n,i)=>{let o=r.get(n.command);if(!o)throw new Error(`Unknown command: ${n.command}`);let a=IE(n.arguments??[]);if(a.length<o.command.arguments.minItems&&(a.length=o.command.arguments.minItems),o.typeCheck.Check(n.arguments))return o.command.handle(i,a);throw new ud(o.typeCheck.Errors(n.arguments))}),[...r.keys()]}s(h0t,"registerCommands");d();var ag=class extends uR{constructor(r){super(new qB,new Map);this.envSettings=new Map;this.env={...r};let n;this.#e=new Promise(o=>{n=o}),this.markReady=n,["DebugOverrideEngine","DebugOverrideProxyUrl","DebugOverrideCapiUrl","DebugUseEditorFetcher","UseSubsetMatching"].forEach(o=>{for(let a of["AGENT_DEBUG_","GITHUB_COPILOT_","GH_COPILOT_"]){let c=`${a}${Egr(o.replace(/^Debug/,""))}`;c in this.env&&this.envSettings.set(Ht[o],this.env[c])}})}static{s(this,"AgentConfigProvider")}#e;async requireReady(){await this.#e}getOptionalOverride(r){return super.getOptionalOverride(r)??this.envSettings.get(r)}};function Egr(t){return t.replace(/([a-z])([A-Z]+)/g,"$1_$2").toUpperCase()}s(Egr,"camelCaseToSnakeCaseAllCaps");var bgr="unknown-editor",g0t="unknown-editor-plugin",$oe=class extends cn{static{s(this,"AgentEditorInfo")}setEditorAndPluginInfo(e,r,n=[]){this._editorInfo=r,this._editorPluginInfo=e,this._relatedPluginInfo=n}setCopilotIntegrationId(e){this._copilotIntegrationId=e}getEditorInfo(){return this._editorInfo?this._editorInfo:{name:bgr,version:"0"}}getEditorPluginInfo(){return this._editorPluginInfo?this._editorPluginInfo:{name:g0t,version:"0"}}getRelatedPluginInfo(){return this._relatedPluginInfo??[]}getCopilotIntegrationId(){return this._copilotIntegrationId}};function A0t(t){return t.getEditorPluginInfo().name!==g0t}s(A0t,"hasValidInfo");d();var TE=Be(wA());var Igr=new Map([[4,TE.MessageType.Log],[3,TE.MessageType.Info],[2,TE.MessageType.Warning],[1,TE.MessageType.Error]]),Woe=class extends Xc{static{s(this,"NotificationLogger")}logIt(e,r,n,...i){if(r==4&&!See(e)&&n!=="console")return;let o={type:Igr.get(r),message:NZe(n,...i)},a=e.get(Nr).connection;try{a.sendNotification(new TE.NotificationType("window/logMessage"),o)}catch(c){if(c instanceof TE.ConnectionError)return;throw c}}};d();var y0t=Be(ul());var joe=class{constructor(e,r=!1){this.ctx=e;this.codeSnippets=r}static{s(this,"RedirectTelemetryReporter")}get notificationName(){return this.codeSnippets?"codeSnippetTelemetry":"uedTelemetry"}sendTelemetryEvent(e,r,n){this.ctx.get(Nr).connection.sendNotification(new y0t.NotificationType(this.notificationName),{type:"event",name:e,properties:r||{},measurements:n||{}})}sendTelemetryErrorEvent(e,r,n){this.sendTelemetryEvent(e,r,n)}dispose(){return Promise.resolve()}};function C0t(t){t.get(Md).setCustomReporters(new joe(t),new joe(t,!0))}s(C0t,"setupRedirectingTelemetryReporters");d();d();var Goe=class{static{s(this,"InstallationManager")}async startup(e){await this.isNewInstall(e)?(await this.markInstalled(e),this.handleInstall(e,await this.wasPreviouslyInstalled(e))):await this.isNewUpgrade(e)&&(await this.markUpgraded(e),this.handleUpgrade(e))}uninstall(e){return this.handleUninstall(e)}handleInstall(e,r){r?Bt(e,"installed.reinstall"):Bt(e,"installed.new")}handleUpgrade(e){Bt(e,"installed.upgrade")}handleUninstall(e){Bt(e,"uninstalled")}};var dq=Be(lB());var W8=class extends Goe{static{s(this,"AgentInstallationManager")}async isNewInstall(e){let r=e.get(cn).getEditorPluginInfo();return await e.get(yi).read("versions",r.name)===void 0&&!await this.hasPersistedSettings(e)}async hasPersistedSettings(e){return(await e.get(yi).listSettings()).length>0}async markInstalled(e){let r=e.get(cn).getEditorPluginInfo();await e.get(yi).update("versions",r.name,r.version)}wasPreviouslyInstalled(e){return Promise.resolve(!1)}async isNewUpgrade(e){try{let r=e.get(cn).getEditorPluginInfo(),n=await e.get(yi).read("versions",r.name);return n===void 0&&await this.hasPersistedSettings(e)?!0:(0,dq.gt)((0,dq.coerce)(r.version),(0,dq.coerce)(n))}catch{return!1}}async markUpgraded(e){await this.markInstalled(e)}async uninstall(e){await super.uninstall(e);let r=e.get(cn).getEditorPluginInfo();await e.get(yi).delete("versions",r.name),(await e.get(yi).listKeys("versions")).length===0&&await e.get(yi).deleteSetting("versions")}};d();var M2e=Be(require("path")),Voe=Be(ul());var Tgr={watchedFiles:[],contentRestrictedFiles:[],unknownFileExtensions:[]},Q1=class t{constructor(e){this.ctx=e;this.#e=new ys;this.onDidChangeWatchedFiles=this.#e.event}static{s(this,"LspFileWatcher")}#e;static{this.requestType=new Voe.ProtocolRequestType("copilot/watchedFiles")}get connection(){return this.ctx.get(Nr).connection}init(){this.ctx.get(xs).getCapabilities().watchedFiles&&this.connection.onNotification(Voe.DidChangeWatchedFilesNotification.type,r=>{"workspaceUri"in r&&typeof r.workspaceUri=="string"&&this.didChangeWatchedFilesHandler(r)})}async getWatchedFiles(e){if(!this.ctx.get(xs).getCapabilities().watchedFiles)return Tgr;let i=(await this.connection.sendRequest(t.requestType,e)).files,o=[],a=[],c=[];for(let l of i){typeof l=="object"&&(l=l.uri);let u=M2e.extname(l).toLowerCase();if(!dR.includes(u)){c.push({uri:l});continue}let f=await this.getValidDocument(l);if(f===void 0){a.push({uri:l});continue}o.push(f)}return{watchedFiles:o,contentRestrictedFiles:a,unknownFileExtensions:c}}async didChangeWatchedFilesHandler(e){let r=[],n=[],i=[];for(let o of e.changes){let a=o.uri,c={uri:a,isRestricted:!1,isUnknownFileExtension:!1},l=M2e.extname(o.uri).toLowerCase();if(!dR.includes(l))c.isUnknownFileExtension=!0;else{let u=await this.getValidDocument(a);u===void 0?c.isRestricted=!0:c.document=u}switch(o.type){case 1:n.push(c);break;case 2:r.push(c);break;case 3:i.push(c);break}}this.#e.fire({workspaceFolder:{uri:e.workspaceUri},created:n,changed:r,deleted:i})}async getValidDocument(e){let n=await this.ctx.get(En).getOrReadTextDocument({uri:e});return n.status==="valid"?n.document:void 0}};d();d();var wgr=x.Object({providerName:x.String()});async function Sgr(t,e,r){try{let{providerName:n}=r,i=Pw(n);if(i!==0)return[null,{code:tr.InvalidParams,message:`deleteApiKey is only supported for providers with GlobalApiKey auth type. Provider ${n} has auth type: ${i}`}];let o=new nc(t.get(yi));return await o.removeAllModelConfigs(n),await o.deleteAPIKey(n,i),[{success:!0,message:`API key and all model configurations deleted successfully for provider ${n}`},null]}catch(n){return[null,{code:tr.InternalError,message:`Failed to delete API key: ${n instanceof Error?n.message:String(n)}`}]}}s(Sgr,"handleBYOKDeleteApiKeyChecked");var v0t=Ze(wgr,Sgr);d();var _gr=x.Object({providerName:x.String(),modelId:x.String()});async function Rgr(t,e,r){try{let n=new nc(t.get(yi)),{providerName:i,modelId:o}=r,a=Pw(i);return await n.removeModelConfig(i,o),a===1&&await n.deleteAPIKey(i,a,o),[{success:!0,message:`Model ${o} deleted successfully for provider ${i}`},null]}catch(n){return[null,{code:tr.InternalError,message:`Failed to delete model: ${n instanceof Error?n.message:String(n)}`}]}}s(Rgr,"handleBYOKDeleteModelChecked");var x0t=Ze(_gr,Rgr);d();var kgr=x.Object({providerName:x.Optional(x.String()),modelId:x.Optional(x.String())});async function Pgr(t,e,r){try{let n=new nc(t.get(yi)),{providerName:i,modelId:o}=r;if(!i){let c=t.get(yi),l=await c.listKeys("byok"),u=[];for(let f of l)if(f.endsWith("-api-key")){let p=await c.read("byok",f);if(p){let h=f.replace("-api-key","").split("-");if(h.length===1)u.push({providerName:h[0],apiKey:p});else if(h.length>=2){let g=h[0],A=h.slice(1).join("-");u.push({providerName:g,modelId:A,apiKey:p})}}}return[{apiKeys:u},null]}return[{apiKeys:[{apiKey:await n.getAPIKey(i,o)||void 0,providerName:i,modelId:o}]},null]}catch(n){return[null,{code:tr.InternalError,message:`Failed to get API key: ${n instanceof Error?n.message:String(n)}`}]}}s(Pgr,"handleBYOKListApiKeysChecked");var E0t=Ze(kgr,Pgr);d();d();d();d();d();d();function Sn(t,e,r,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!i:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(t,r):i?i.value=r:e.set(t,r),r}s(Sn,"__classPrivateFieldSet");function Rt(t,e,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(t):n?n.value:e.get(t)}s(Rt,"__classPrivateFieldGet");d();var L2e=s(function(){let{crypto:t}=globalThis;if(t?.randomUUID)return L2e=t.randomUUID.bind(t),t.randomUUID();let e=new Uint8Array(1),r=t?()=>t.getRandomValues(e)[0]:()=>Math.random()*255&255;return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,n=>(+n^r()&15>>+n/4).toString(16))},"uuid4");d();d();d();function wE(t){return typeof t=="object"&&t!==null&&("name"in t&&t.name==="AbortError"||"message"in t&&String(t.message).includes("FetchRequestCanceledException"))}s(wE,"isAbortError");var fq=s(t=>{if(t instanceof Error)return t;if(typeof t=="object"&&t!==null){try{if(Object.prototype.toString.call(t)==="[object Error]"){let e=new Error(t.message,t.cause?{cause:t.cause}:{});return t.stack&&(e.stack=t.stack),t.cause&&!e.cause&&(e.cause=t.cause),t.name&&(e.name=t.name),e}}catch{}try{return new Error(JSON.stringify(t))}catch{}}return new Error(t)},"castToError");var In=class extends Error{static{s(this,"AnthropicError")}},Iu=class t extends In{static{s(this,"APIError")}constructor(e,r,n,i){super(`${t.makeMessage(e,r,n)}`),this.status=e,this.headers=i,this.requestID=i?.get("request-id"),this.error=r}static makeMessage(e,r,n){let i=r?.message?typeof r.message=="string"?r.message:JSON.stringify(r.message):r?JSON.stringify(r):n;return e&&i?`${e} ${i}`:e?`${e} status code (no body)`:i||"(no status code or body)"}static generate(e,r,n,i){if(!e||!i)return new lS({message:n,cause:fq(r)});let o=r;return e===400?new G8(e,o,n,i):e===401?new V8(e,o,n,i):e===403?new z8(e,o,n,i):e===404?new K8(e,o,n,i):e===409?new Y8(e,o,n,i):e===422?new J8(e,o,n,i):e===429?new X8(e,o,n,i):e>=500?new Z8(e,o,n,i):new t(e,o,n,i)}},dd=class extends Iu{static{s(this,"APIUserAbortError")}constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0)}},lS=class extends Iu{static{s(this,"APIConnectionError")}constructor({message:e,cause:r}){super(void 0,void 0,e||"Connection error.",void 0),r&&(this.cause=r)}},j8=class extends lS{static{s(this,"APIConnectionTimeoutError")}constructor({message:e}={}){super({message:e??"Request timed out."})}},G8=class extends Iu{static{s(this,"BadRequestError")}},V8=class extends Iu{static{s(this,"AuthenticationError")}},z8=class extends Iu{static{s(this,"PermissionDeniedError")}},K8=class extends Iu{static{s(this,"NotFoundError")}},Y8=class extends Iu{static{s(this,"ConflictError")}},J8=class extends Iu{static{s(this,"UnprocessableEntityError")}},X8=class extends Iu{static{s(this,"RateLimitError")}},Z8=class extends Iu{static{s(this,"InternalServerError")}};var Bgr=/^[a-z][a-z0-9+.-]*:/i,b0t=s(t=>Bgr.test(t),"isAbsoluteURL"),F2e=s(t=>(F2e=Array.isArray,F2e(t)),"isArray"),O2e=F2e;function Q2e(t){return typeof t!="object"?{}:t??{}}s(Q2e,"maybeObj");function I0t(t){if(!t)return!0;for(let e in t)return!1;return!0}s(I0t,"isEmptyObj");function T0t(t,e){return Object.prototype.hasOwnProperty.call(t,e)}s(T0t,"hasOwn");var w0t=s((t,e)=>{if(typeof e!="number"||!Number.isInteger(e))throw new In(`${t} must be an integer`);if(e<0)throw new In(`${t} must be a positive integer`);return e},"validatePositiveInteger");var zoe=s(t=>{try{return JSON.parse(t)}catch{return}},"safeJSON");d();var S0t=s(t=>new Promise(e=>setTimeout(e,t)),"sleep");d();d();var uS="0.56.0";var P0t=s(()=>typeof window<"u"&&typeof window.document<"u"&&typeof navigator<"u","isRunningInBrowser");function Ngr(){return typeof Deno<"u"&&Deno.build!=null?"deno":typeof EdgeRuntime<"u"?"edge":Object.prototype.toString.call(typeof globalThis.process<"u"?globalThis.process:0)==="[object process]"?"node":"unknown"}s(Ngr,"getDetectedPlatform");var Mgr=s(()=>{let t=Ngr();if(t==="deno")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":uS,"X-Stainless-OS":R0t(Deno.build.os),"X-Stainless-Arch":_0t(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:Deno.version?.deno??"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":uS,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":globalThis.process.version};if(t==="node")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":uS,"X-Stainless-OS":R0t(globalThis.process.platform??"unknown"),"X-Stainless-Arch":_0t(globalThis.process.arch??"unknown"),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":globalThis.process.version??"unknown"};let e=Lgr();return e?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":uS,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${e.browser}`,"X-Stainless-Runtime-Version":e.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":uS,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}},"getPlatformProperties");function Lgr(){if(typeof navigator>"u"||!navigator)return null;let t=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(let{key:e,pattern:r}of t){let n=r.exec(navigator.userAgent);if(n){let i=n[1]||0,o=n[2]||0,a=n[3]||0;return{browser:e,version:`${i}.${o}.${a}`}}}return null}s(Lgr,"getBrowserInfo");var _0t=s(t=>t==="x32"?"x32":t==="x86_64"||t==="x64"?"x64":t==="arm"?"arm":t==="aarch64"||t==="arm64"?"arm64":t?`other:${t}`:"unknown","normalizeArch"),R0t=s(t=>(t=t.toLowerCase(),t.includes("ios")?"iOS":t==="android"?"Android":t==="darwin"?"MacOS":t==="win32"?"Windows":t==="freebsd"?"FreeBSD":t==="openbsd"?"OpenBSD":t==="linux"?"Linux":t?`Other:${t}`:"Unknown"),"normalizePlatform"),k0t,D0t=s(()=>k0t??(k0t=Mgr()),"getPlatformHeaders");d();function B0t(){if(typeof fetch<"u")return fetch;throw new Error("`fetch` is not defined as a global; Either pass `fetch` to the client, `new Anthropic({ fetch })` or polyfill the global, `globalThis.fetch = fetch`")}s(B0t,"getDefaultFetch");function U2e(...t){let e=globalThis.ReadableStream;if(typeof e>"u")throw new Error("`ReadableStream` is not defined as a global; You will need to polyfill it, `globalThis.ReadableStream = ReadableStream`");return new e(...t)}s(U2e,"makeReadableStream");function Koe(t){let e=Symbol.asyncIterator in t?t[Symbol.asyncIterator]():t[Symbol.iterator]();return U2e({start(){},async pull(r){let{done:n,value:i}=await e.next();n?r.close():r.enqueue(i)},async cancel(){await e.return?.()}})}s(Koe,"ReadableStreamFrom");function pq(t){if(t[Symbol.asyncIterator])return t;let e=t.getReader();return{async next(){try{let r=await e.read();return r?.done&&e.releaseLock(),r}catch(r){throw e.releaseLock(),r}},async return(){let r=e.cancel();return e.releaseLock(),await r,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}s(pq,"ReadableStreamToAsyncIterable");async function N0t(t){if(t===null||typeof t!="object")return;if(t[Symbol.asyncIterator]){await t[Symbol.asyncIterator]().return?.();return}let e=t.getReader(),r=e.cancel();e.releaseLock(),await r}s(N0t,"CancelReadableStream");d();var M0t=s(({headers:t,body:e})=>({bodyHeaders:{"content-type":"application/json"},body:JSON.stringify(e)}),"FallbackEncoder");d();d();d();d();d();function O0t(t){let e=0;for(let i of t)e+=i.length;let r=new Uint8Array(e),n=0;for(let i of t)r.set(i,n),n+=i.length;return r}s(O0t,"concatBytes");var L0t;function mq(t){let e;return(L0t??(e=new globalThis.TextEncoder,L0t=e.encode.bind(e)))(t)}s(mq,"encodeUTF8");var F0t;function q2e(t){let e;return(F0t??(e=new globalThis.TextDecoder,F0t=e.decode.bind(e)))(t)}s(q2e,"decodeUTF8");var mm,hm,SE=class{static{s(this,"LineDecoder")}constructor(){mm.set(this,void 0),hm.set(this,void 0),Sn(this,mm,new Uint8Array,"f"),Sn(this,hm,null,"f")}decode(e){if(e==null)return[];let r=e instanceof ArrayBuffer?new Uint8Array(e):typeof e=="string"?mq(e):e;Sn(this,mm,O0t([Rt(this,mm,"f"),r]),"f");let n=[],i;for(;(i=Qgr(Rt(this,mm,"f"),Rt(this,hm,"f")))!=null;){if(i.carriage&&Rt(this,hm,"f")==null){Sn(this,hm,i.index,"f");continue}if(Rt(this,hm,"f")!=null&&(i.index!==Rt(this,hm,"f")+1||i.carriage)){n.push(q2e(Rt(this,mm,"f").subarray(0,Rt(this,hm,"f")-1))),Sn(this,mm,Rt(this,mm,"f").subarray(Rt(this,hm,"f")),"f"),Sn(this,hm,null,"f");continue}let o=Rt(this,hm,"f")!==null?i.preceding-1:i.preceding,a=q2e(Rt(this,mm,"f").subarray(0,o));n.push(a),Sn(this,mm,Rt(this,mm,"f").subarray(i.index),"f"),Sn(this,hm,null,"f")}return n}flush(){return Rt(this,mm,"f").length?this.decode(`
`):[]}};mm=new WeakMap,hm=new WeakMap;SE.NEWLINE_CHARS=new Set([`
`,"\r"]);SE.NEWLINE_REGEXP=/\r\n|[\n\r]/g;function Qgr(t,e){for(let i=e??0;i<t.length;i++){if(t[i]===10)return{preceding:i,index:i+1,carriage:!1};if(t[i]===13)return{preceding:i,index:i+1,carriage:!0}}return null}s(Qgr,"findNewlineIndex");function Q0t(t){for(let n=0;n<t.length-1;n++){if(t[n]===10&&t[n+1]===10||t[n]===13&&t[n+1]===13)return n+2;if(t[n]===13&&t[n+1]===10&&n+3<t.length&&t[n+2]===13&&t[n+3]===10)return n+4}return-1}s(Q0t,"findDoubleNewlineIndex");d();var Joe={off:0,error:200,warn:300,info:400,debug:500},H2e=s((t,e,r)=>{if(t){if(T0t(Joe,t))return t;Tu(r).warn(`${e} was set to ${JSON.stringify(t)}, expected one of ${JSON.stringify(Object.keys(Joe))}`)}},"parseLogLevel");function hq(){}s(hq,"noop");function Yoe(t,e,r){return!e||Joe[t]>Joe[r]?hq:e[t].bind(e)}s(Yoe,"makeLogFn");var Ugr={error:hq,warn:hq,info:hq,debug:hq},U0t=new WeakMap;function Tu(t){let e=t.logger,r=t.logLevel??"off";if(!e)return Ugr;let n=U0t.get(e);if(n&&n[0]===r)return n[1];let i={error:Yoe("error",e,r),warn:Yoe("warn",e,r),info:Yoe("info",e,r),debug:Yoe("debug",e,r)};return U0t.set(e,[r,i]),i}s(Tu,"loggerFor");var _E=s(t=>(t.options&&(t.options={...t.options},delete t.options.headers),t.headers&&(t.headers=Object.fromEntries((t.headers instanceof Headers?[...t.headers]:Object.entries(t.headers)).map(([e,r])=>[e,e.toLowerCase()==="x-api-key"||e.toLowerCase()==="authorization"||e.toLowerCase()==="cookie"||e.toLowerCase()==="set-cookie"?"***":r]))),"retryOfRequestLogID"in t&&(t.retryOfRequestLogID&&(t.retryOf=t.retryOfRequestLogID),delete t.retryOfRequestLogID),t),"formatRequestDetails");var gq,U1=class t{static{s(this,"Stream")}constructor(e,r,n){this.iterator=e,gq.set(this,void 0),this.controller=r,Sn(this,gq,n,"f")}static fromSSEResponse(e,r,n){let i=!1,o=n?Tu(n):console;async function*a(){if(i)throw new In("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");i=!0;let c=!1;try{for await(let l of qgr(e,r)){if(l.event==="completion")try{yield JSON.parse(l.data)}catch(u){throw o.error("Could not parse message into JSON:",l.data),o.error("From chunk:",l.raw),u}if(l.event==="message_start"||l.event==="message_delta"||l.event==="message_stop"||l.event==="content_block_start"||l.event==="content_block_delta"||l.event==="content_block_stop")try{yield JSON.parse(l.data)}catch(u){throw o.error("Could not parse message into JSON:",l.data),o.error("From chunk:",l.raw),u}if(l.event!=="ping"&&l.event==="error")throw new Iu(void 0,zoe(l.data)??l.data,void 0,e.headers)}c=!0}catch(l){if(wE(l))return;throw l}finally{c||r.abort()}}return s(a,"iterator"),new t(a,r,n)}static fromReadableStream(e,r,n){let i=!1;async function*o(){let c=new SE,l=pq(e);for await(let u of l)for(let f of c.decode(u))yield f;for(let u of c.flush())yield u}s(o,"iterLines");async function*a(){if(i)throw new In("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");i=!0;let c=!1;try{for await(let l of o())c||l&&(yield JSON.parse(l));c=!0}catch(l){if(wE(l))return;throw l}finally{c||r.abort()}}return s(a,"iterator"),new t(a,r,n)}[(gq=new WeakMap,Symbol.asyncIterator)](){return this.iterator()}tee(){let e=[],r=[],n=this.iterator(),i=s(o=>({next:s(()=>{if(o.length===0){let a=n.next();e.push(a),r.push(a)}return o.shift()},"next")}),"teeIterator");return[new t(()=>i(e),this.controller,Rt(this,gq,"f")),new t(()=>i(r),this.controller,Rt(this,gq,"f"))]}toReadableStream(){let e=this,r;return U2e({async start(){r=e[Symbol.asyncIterator]()},async pull(n){try{let{value:i,done:o}=await r.next();if(o)return n.close();let a=mq(JSON.stringify(i)+`
`);n.enqueue(a)}catch(i){n.error(i)}},async cancel(){await r.return?.()}})}};async function*qgr(t,e){if(!t.body)throw e.abort(),typeof globalThis.navigator<"u"&&globalThis.navigator.product==="ReactNative"?new In("The default react-native fetch implementation does not support streaming. Please use expo/fetch: https://docs.expo.dev/versions/latest/sdk/expo/#expofetch-api"):new In("Attempted to iterate over a response with no body");let r=new $2e,n=new SE,i=pq(t.body);for await(let o of Hgr(i))for(let a of n.decode(o)){let c=r.decode(a);c&&(yield c)}for(let o of n.flush()){let a=r.decode(o);a&&(yield a)}}s(qgr,"_iterSSEMessages");async function*Hgr(t){let e=new Uint8Array;for await(let r of t){if(r==null)continue;let n=r instanceof ArrayBuffer?new Uint8Array(r):typeof r=="string"?mq(r):r,i=new Uint8Array(e.length+n.length);i.set(e),i.set(n,e.length),e=i;let o;for(;(o=Q0t(e))!==-1;)yield e.slice(0,o),e=e.slice(o)}e.length>0&&(yield e)}s(Hgr,"iterSSEChunks");var $2e=class{static{s(this,"SSEDecoder")}constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;let o={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],o}if(this.chunks.push(e),e.startsWith(":"))return null;let[r,n,i]=$gr(e,":");return i.startsWith(" ")&&(i=i.substring(1)),r==="event"?this.event=i:r==="data"&&this.data.push(i),null}};function $gr(t,e){let r=t.indexOf(e);return r!==-1?[t.substring(0,r),e,t.substring(r+e.length)]:[t,"",""]}s($gr,"partition");async function Xoe(t,e){let{response:r,requestLogID:n,retryOfRequestLogID:i,startTime:o}=e,a=await(async()=>{if(e.options.stream)return Tu(t).debug("response",r.status,r.url,r.headers,r.body),e.options.__streamClass?e.options.__streamClass.fromSSEResponse(r,e.controller,t):U1.fromSSEResponse(r,e.controller,t);if(r.status===204)return null;if(e.options.__binaryResponse)return r;let l=r.headers.get("content-type")?.split(";")[0]?.trim();if(l?.includes("application/json")||l?.endsWith("+json")){let p=await r.json();return W2e(p,r)}return await r.text()})();return Tu(t).debug(`[${n}] response parsed`,_E({retryOfRequestLogID:i,url:r.url,status:r.status,body:a,durationMs:Date.now()-o})),a}s(Xoe,"defaultParseResponse");function W2e(t,e){return!t||typeof t!="object"||Array.isArray(t)?t:Object.defineProperty(t,"_request_id",{value:e.headers.get("request-id"),enumerable:!1})}s(W2e,"addRequestID");d();var Aq,fP=class t extends Promise{static{s(this,"APIPromise")}constructor(e,r,n=Xoe){super(i=>{i(null)}),this.responsePromise=r,this.parseResponse=n,Aq.set(this,void 0),Sn(this,Aq,e,"f")}_thenUnwrap(e){return new t(Rt(this,Aq,"f"),this.responsePromise,async(r,n)=>W2e(e(await this.parseResponse(r,n),n),n.response))}asResponse(){return this.responsePromise.then(e=>e.response)}async withResponse(){let[e,r]=await Promise.all([this.parse(),this.asResponse()]);return{data:e,response:r,request_id:r.headers.get("request-id")}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(e=>this.parseResponse(Rt(this,Aq,"f"),e))),this.parsedPromise}then(e,r){return this.parse().then(e,r)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}};Aq=new WeakMap;var Zoe,j2e=class{static{s(this,"AbstractPage")}constructor(e,r,n,i){Zoe.set(this,void 0),Sn(this,Zoe,e,"f"),this.options=i,this.response=r,this.body=n}hasNextPage(){return this.getPaginatedItems().length?this.nextPageRequestOptions()!=null:!1}async getNextPage(){let e=this.nextPageRequestOptions();if(!e)throw new In("No next page expected; please check `.hasNextPage()` before calling `.getNextPage()`.");return await Rt(this,Zoe,"f").requestAPIList(this.constructor,e)}async*iterPages(){let e=this;for(yield e;e.hasNextPage();)e=await e.getNextPage(),yield e}async*[(Zoe=new WeakMap,Symbol.asyncIterator)](){for await(let e of this.iterPages())for(let r of e.getPaginatedItems())yield r}},yq=class extends fP{static{s(this,"PagePromise")}constructor(e,r,n){super(e,r,async(i,o)=>new n(i,o.response,await Xoe(i,o),o.options))}async*[Symbol.asyncIterator](){let e=await this;for await(let r of e)yield r}},cg=class extends j2e{static{s(this,"Page")}constructor(e,r,n,i){super(e,r,n,i),this.data=n.data||[],this.has_more=n.has_more||!1,this.first_id=n.first_id||null,this.last_id=n.last_id||null}getPaginatedItems(){return this.data??[]}hasNextPage(){return this.has_more===!1?!1:super.hasNextPage()}nextPageRequestOptions(){if(this.options.query?.before_id){let r=this.first_id;return r?{...this.options,query:{...Q2e(this.options.query),before_id:r}}:null}let e=this.last_id;return e?{...this.options,query:{...Q2e(this.options.query),after_id:e}}:null}};d();d();d();var V2e=s(()=>{if(typeof File>"u"){let{process:t}=globalThis,e=typeof t?.versions?.node=="string"&&parseInt(t.versions.node.split("."))<20;throw new Error("`File` is not defined as a global, which is required for file uploads."+(e?" Update to Node 20 LTS or newer, or set `globalThis.File` to `import('node:buffer').File`.":""))}},"checkFileSupport");function pP(t,e,r){return V2e(),new File(t,e??"unknown_file",r)}s(pP,"makeFile");function Cq(t){return(typeof t=="object"&&t!==null&&("name"in t&&t.name&&String(t.name)||"url"in t&&t.url&&String(t.url)||"filename"in t&&t.filename&&String(t.filename)||"path"in t&&t.path&&String(t.path))||"").split(/[\\/]/).pop()||void 0}s(Cq,"getName");var z2e=s(t=>t!=null&&typeof t=="object"&&typeof t[Symbol.asyncIterator]=="function","isAsyncIterable");var H0t=s(async(t,e)=>({...t,body:await Ggr(t.body,e)}),"multipartFormRequestOptions"),q0t=new WeakMap;function jgr(t){let e=typeof t=="function"?t:t.fetch,r=q0t.get(e);if(r)return r;let n=(async()=>{try{let i="Response"in e?e.Response:(await e("data:,")).constructor,o=new FormData;return o.toString()!==await new i(o).text()}catch{return!0}})();return q0t.set(e,n),n}s(jgr,"supportsFormData");var Ggr=s(async(t,e)=>{if(!await jgr(e))throw new TypeError("The provided fetch function does not support file uploads with the current global FormData class.");let r=new FormData;return await Promise.all(Object.entries(t||{}).map(([n,i])=>G2e(r,n,i))),r},"createForm"),Vgr=s(t=>t instanceof Blob&&"name"in t,"isNamedBlob");var G2e=s(async(t,e,r)=>{if(r!==void 0){if(r==null)throw new TypeError(`Received null for "${e}"; to pass null in FormData, you must use the string 'null'`);if(typeof r=="string"||typeof r=="number"||typeof r=="boolean")t.append(e,String(r));else if(r instanceof Response){let n={},i=r.headers.get("Content-Type");i&&(n={type:i}),t.append(e,pP([await r.blob()],Cq(r),n))}else if(z2e(r))t.append(e,pP([await new Response(Koe(r)).blob()],Cq(r)));else if(Vgr(r))t.append(e,pP([r],Cq(r),{type:r.type}));else if(Array.isArray(r))await Promise.all(r.map(n=>G2e(t,e+"[]",n)));else if(typeof r=="object")await Promise.all(Object.entries(r).map(([n,i])=>G2e(t,`${e}[${n}]`,i)));else throw new TypeError(`Invalid value given to form, expected a string, number, boolean, object, Array, File or Blob but got ${r} instead`)}},"addFormValue");var $0t=s(t=>t!=null&&typeof t=="object"&&typeof t.size=="number"&&typeof t.type=="string"&&typeof t.text=="function"&&typeof t.slice=="function"&&typeof t.arrayBuffer=="function","isBlobLike"),zgr=s(t=>t!=null&&typeof t=="object"&&typeof t.name=="string"&&typeof t.lastModified=="number"&&$0t(t),"isFileLike"),Kgr=s(t=>t!=null&&typeof t=="object"&&typeof t.url=="string"&&typeof t.blob=="function","isResponseLike");async function ese(t,e,r){if(V2e(),t=await t,e||(e=Cq(t)),zgr(t))return t instanceof File&&e==null&&r==null?t:pP([await t.arrayBuffer()],e??t.name,{type:t.type,lastModified:t.lastModified,...r});if(Kgr(t)){let i=await t.blob();return e||(e=new URL(t.url).pathname.split(/[\\/]/).pop()),pP(await K2e(i),e,r)}let n=await K2e(t);if(!r?.type){let i=n.find(o=>typeof o=="object"&&"type"in o&&o.type);typeof i=="string"&&(r={...r,type:i})}return pP(n,e,r)}s(ese,"toFile");async function K2e(t){let e=[];if(typeof t=="string"||ArrayBuffer.isView(t)||t instanceof ArrayBuffer)e.push(t);else if($0t(t))e.push(t instanceof Blob?t:await t.arrayBuffer());else if(z2e(t))for await(let r of t)e.push(...await K2e(r));else{let r=t?.constructor?.name;throw new Error(`Unexpected data type: ${typeof t}${r?`; constructor: ${r}`:""}${Ygr(t)}`)}return e}s(K2e,"getBytes");function Ygr(t){return typeof t!="object"||t===null?"":`; props: [${Object.getOwnPropertyNames(t).map(r=>`"${r}"`).join(", ")}]`}s(Ygr,"propsForError");d();d();d();d();var vl=class{static{s(this,"APIResource")}constructor(e){this._client=e}};d();d();var W0t=Symbol.for("brand.privateNullableHeaders");function*Xgr(t){if(!t)return;if(W0t in t){let{values:n,nulls:i}=t;yield*n.entries();for(let o of i)yield[o,null];return}let e=!1,r;t instanceof Headers?r=t.entries():O2e(t)?r=t:(e=!0,r=Object.entries(t??{}));for(let n of r){let i=n[0];if(typeof i!="string")throw new TypeError("expected header name to be a string");let o=O2e(n[1])?n[1]:[n[1]],a=!1;for(let c of o)c!==void 0&&(e&&!a&&(a=!0,yield[i,null]),yield[i,c])}}s(Xgr,"iterateHeaders");var Vo=s(t=>{let e=new Headers,r=new Set;for(let n of t){let i=new Set;for(let[o,a]of Xgr(n)){let c=o.toLowerCase();i.has(c)||(e.delete(o),i.add(c)),a===null?(e.delete(o),r.add(c)):(e.append(o,a),r.delete(c))}}return{[W0t]:!0,values:e,nulls:r}},"buildHeaders");d();function G0t(t){return t.replace(/[^A-Za-z0-9\-._~!$&'()*+,;=:@]+/g,encodeURIComponent)}s(G0t,"encodeURIPath");var j0t=Object.freeze(Object.create(null)),Zgr=s((t=G0t)=>s(function(r,...n){if(r.length===1)return r[0];let i=!1,o=[],a=r.reduce((f,p,m)=>{/[?#]/.test(p)&&(i=!0);let h=n[m],g=(i?encodeURIComponent:t)(""+h);return m!==n.length&&(h==null||typeof h=="object"&&h.toString===Object.getPrototypeOf(Object.getPrototypeOf(h.hasOwnProperty??j0t)??j0t)?.toString)&&(g=h+"",o.push({start:f.length+p.length,length:g.length,error:`Value of type ${Object.prototype.toString.call(h).slice(8,-1)} is not a valid path parameter`})),f+p+(m===n.length?"":g)},""),c=a.split(/[?#]/,1)[0],l=/(?<=^|\/)(?:\.|%2e){1,2}(?=\/|$)/gi,u;for(;(u=l.exec(c))!==null;)o.push({start:u.index,length:u[0].length,error:`Value "${u[0]}" can't be safely passed as a path parameter`});if(o.sort((f,p)=>f.start-p.start),o.length>0){let f=0,p=o.reduce((m,h)=>{let g=" ".repeat(h.start-f),A="^".repeat(h.length);return f=h.start+h.length,m+g+A},"");throw new In(`Path parameters result in path with invalid segments:
${o.map(m=>m.error).join(`
`)}
${a}
${p}`)}return a},"path"),"createPathTagFunction"),Zd=Zgr(G0t);var eM=class extends vl{static{s(this,"Files")}list(e={},r){let{betas:n,...i}=e??{};return this._client.getAPIList("/v1/files",cg,{query:i,...r,headers:Vo([{"anthropic-beta":[...n??[],"files-api-2025-04-14"].toString()},r?.headers])})}delete(e,r={},n){let{betas:i}=r??{};return this._client.delete(Zd`/v1/files/${e}`,{...n,headers:Vo([{"anthropic-beta":[...i??[],"files-api-2025-04-14"].toString()},n?.headers])})}download(e,r={},n){let{betas:i}=r??{};return this._client.get(Zd`/v1/files/${e}/content`,{...n,headers:Vo([{"anthropic-beta":[...i??[],"files-api-2025-04-14"].toString(),Accept:"application/binary"},n?.headers]),__binaryResponse:!0})}retrieveMetadata(e,r={},n){let{betas:i}=r??{};return this._client.get(Zd`/v1/files/${e}`,{...n,headers:Vo([{"anthropic-beta":[...i??[],"files-api-2025-04-14"].toString()},n?.headers])})}upload(e,r){let{betas:n,...i}=e;return this._client.post("/v1/files",H0t({body:i,...r,headers:Vo([{"anthropic-beta":[...n??[],"files-api-2025-04-14"].toString()},r?.headers])},this._client))}};d();var tM=class extends vl{static{s(this,"Models")}retrieve(e,r={},n){let{betas:i}=r??{};return this._client.get(Zd`/v1/models/${e}?beta=true`,{...n,headers:Vo([{...i?.toString()!=null?{"anthropic-beta":i?.toString()}:void 0},n?.headers])})}list(e={},r){let{betas:n,...i}=e??{};return this._client.getAPIList("/v1/models?beta=true",cg,{query:i,...r,headers:Vo([{...n?.toString()!=null?{"anthropic-beta":n?.toString()}:void 0},r?.headers])})}};d();d();d();var rM=class t{static{s(this,"JSONLDecoder")}constructor(e,r){this.iterator=e,this.controller=r}async*decoder(){let e=new SE;for await(let r of this.iterator)for(let n of e.decode(r))yield JSON.parse(n);for(let r of e.flush())yield JSON.parse(r)}[Symbol.asyncIterator](){return this.decoder()}static fromResponse(e,r){if(!e.body)throw r.abort(),typeof globalThis.navigator<"u"&&globalThis.navigator.product==="ReactNative"?new In("The default react-native fetch implementation does not support streaming. Please use expo/fetch: https://docs.expo.dev/versions/latest/sdk/expo/#expofetch-api"):new In("Attempted to iterate over a response with no body");return new t(pq(e.body),r)}};d();var nM=class extends vl{static{s(this,"Batches")}create(e,r){let{betas:n,...i}=e;return this._client.post("/v1/messages/batches?beta=true",{body:i,...r,headers:Vo([{"anthropic-beta":[...n??[],"message-batches-2024-09-24"].toString()},r?.headers])})}retrieve(e,r={},n){let{betas:i}=r??{};return this._client.get(Zd`/v1/messages/batches/${e}?beta=true`,{...n,headers:Vo([{"anthropic-beta":[...i??[],"message-batches-2024-09-24"].toString()},n?.headers])})}list(e={},r){let{betas:n,...i}=e??{};return this._client.getAPIList("/v1/messages/batches?beta=true",cg,{query:i,...r,headers:Vo([{"anthropic-beta":[...n??[],"message-batches-2024-09-24"].toString()},r?.headers])})}delete(e,r={},n){let{betas:i}=r??{};return this._client.delete(Zd`/v1/messages/batches/${e}?beta=true`,{...n,headers:Vo([{"anthropic-beta":[...i??[],"message-batches-2024-09-24"].toString()},n?.headers])})}cancel(e,r={},n){let{betas:i}=r??{};return this._client.post(Zd`/v1/messages/batches/${e}/cancel?beta=true`,{...n,headers:Vo([{"anthropic-beta":[...i??[],"message-batches-2024-09-24"].toString()},n?.headers])})}async results(e,r={},n){let i=await this.retrieve(e);if(!i.results_url)throw new In(`No batch \`results_url\`; Has it finished processing? ${i.processing_status} - ${i.id}`);let{betas:o}=r??{};return this._client.get(i.results_url,{...n,headers:Vo([{"anthropic-beta":[...o??[],"message-batches-2024-09-24"].toString(),Accept:"application/binary"},n?.headers]),stream:!0,__binaryResponse:!0})._thenUnwrap((a,c)=>rM.fromResponse(c.response,c.controller))}};d();d();d();var nAr=s(t=>{let e=0,r=[];for(;e<t.length;){let n=t[e];if(n==="\\"){e++;continue}if(n==="{"){r.push({type:"brace",value:"{"}),e++;continue}if(n==="}"){r.push({type:"brace",value:"}"}),e++;continue}if(n==="["){r.push({type:"paren",value:"["}),e++;continue}if(n==="]"){r.push({type:"paren",value:"]"}),e++;continue}if(n===":"){r.push({type:"separator",value:":"}),e++;continue}if(n===","){r.push({type:"delimiter",value:","}),e++;continue}if(n==='"'){let c="",l=!1;for(n=t[++e];n!=='"';){if(e===t.length){l=!0;break}if(n==="\\"){if(e++,e===t.length){l=!0;break}c+=n+t[e],n=t[++e]}else c+=n,n=t[++e]}n=t[++e],l||r.push({type:"string",value:c});continue}if(n&&/\s/.test(n)){e++;continue}let o=/[0-9]/;if(n&&o.test(n)||n==="-"||n==="."){let c="";for(n==="-"&&(c+=n,n=t[++e]);n&&o.test(n)||n===".";)c+=n,n=t[++e];r.push({type:"number",value:c});continue}let a=/[a-z]/i;if(n&&a.test(n)){let c="";for(;n&&a.test(n)&&e!==t.length;)c+=n,n=t[++e];if(c=="true"||c=="false"||c==="null")r.push({type:"name",value:c});else{e++;continue}continue}e++}return r},"tokenize"),iM=s(t=>{if(t.length===0)return t;let e=t[t.length-1];switch(e.type){case"separator":return t=t.slice(0,t.length-1),iM(t);break;case"number":let r=e.value[e.value.length-1];if(r==="."||r==="-")return t=t.slice(0,t.length-1),iM(t);case"string":let n=t[t.length-2];if(n?.type==="delimiter")return t=t.slice(0,t.length-1),iM(t);if(n?.type==="brace"&&n.value==="{")return t=t.slice(0,t.length-1),iM(t);break;case"delimiter":return t=t.slice(0,t.length-1),iM(t);break}return t},"strip"),iAr=s(t=>{let e=[];return t.map(r=>{r.type==="brace"&&(r.value==="{"?e.push("}"):e.splice(e.lastIndexOf("}"),1)),r.type==="paren"&&(r.value==="["?e.push("]"):e.splice(e.lastIndexOf("]"),1))}),e.length>0&&e.reverse().map(r=>{r==="}"?t.push({type:"brace",value:"}"}):r==="]"&&t.push({type:"paren",value:"]"})}),t},"unstrip"),oAr=s(t=>{let e="";return t.map(r=>{switch(r.type){case"string":e+='"'+r.value+'"';break;default:e+=r.value;break}}),e},"generate"),tse=s(t=>JSON.parse(oAr(iAr(iM(nAr(t))))),"partialParse");var lg,dS,vq,rse,xq,Eq,nse,bq,RE,Iq,ise,ose,oM,sse,ase,Y2e,V0t,cse,J2e,X2e,Z2e,z0t,K0t="__json_buf";function Y0t(t){return t.type==="tool_use"||t.type==="server_tool_use"||t.type==="mcp_tool_use"}s(Y0t,"tracksToolInput");var lse=class t{static{s(this,"BetaMessageStream")}constructor(){lg.add(this),this.messages=[],this.receivedMessages=[],dS.set(this,void 0),this.controller=new AbortController,vq.set(this,void 0),rse.set(this,()=>{}),xq.set(this,()=>{}),Eq.set(this,void 0),nse.set(this,()=>{}),bq.set(this,()=>{}),RE.set(this,{}),Iq.set(this,!1),ise.set(this,!1),ose.set(this,!1),oM.set(this,!1),sse.set(this,void 0),ase.set(this,void 0),cse.set(this,e=>{if(Sn(this,ise,!0,"f"),wE(e)&&(e=new dd),e instanceof dd)return Sn(this,ose,!0,"f"),this._emit("abort",e);if(e instanceof In)return this._emit("error",e);if(e instanceof Error){let r=new In(e.message);return r.cause=e,this._emit("error",r)}return this._emit("error",new In(String(e)))}),Sn(this,vq,new Promise((e,r)=>{Sn(this,rse,e,"f"),Sn(this,xq,r,"f")}),"f"),Sn(this,Eq,new Promise((e,r)=>{Sn(this,nse,e,"f"),Sn(this,bq,r,"f")}),"f"),Rt(this,vq,"f").catch(()=>{}),Rt(this,Eq,"f").catch(()=>{})}get response(){return Rt(this,sse,"f")}get request_id(){return Rt(this,ase,"f")}async withResponse(){let e=await Rt(this,vq,"f");if(!e)throw new Error("Could not resolve a `Response` object");return{data:this,response:e,request_id:e.headers.get("request-id")}}static fromReadableStream(e){let r=new t;return r._run(()=>r._fromReadableStream(e)),r}static createMessage(e,r,n){let i=new t;for(let o of r.messages)i._addMessageParam(o);return i._run(()=>i._createMessage(e,{...r,stream:!0},{...n,headers:{...n?.headers,"X-Stainless-Helper-Method":"stream"}})),i}_run(e){e().then(()=>{this._emitFinal(),this._emit("end")},Rt(this,cse,"f"))}_addMessageParam(e){this.messages.push(e)}_addMessage(e,r=!0){this.receivedMessages.push(e),r&&this._emit("message",e)}async _createMessage(e,r,n){let i=n?.signal,o;i&&(i.aborted&&this.controller.abort(),o=this.controller.abort.bind(this.controller),i.addEventListener("abort",o));try{Rt(this,lg,"m",J2e).call(this);let{response:a,data:c}=await e.create({...r,stream:!0},{...n,signal:this.controller.signal}).withResponse();this._connected(a);for await(let l of c)Rt(this,lg,"m",X2e).call(this,l);if(c.controller.signal?.aborted)throw new dd;Rt(this,lg,"m",Z2e).call(this)}finally{i&&o&&i.removeEventListener("abort",o)}}_connected(e){this.ended||(Sn(this,sse,e,"f"),Sn(this,ase,e?.headers.get("request-id"),"f"),Rt(this,rse,"f").call(this,e),this._emit("connect"))}get ended(){return Rt(this,Iq,"f")}get errored(){return Rt(this,ise,"f")}get aborted(){return Rt(this,ose,"f")}abort(){this.controller.abort()}on(e,r){return(Rt(this,RE,"f")[e]||(Rt(this,RE,"f")[e]=[])).push({listener:r}),this}off(e,r){let n=Rt(this,RE,"f")[e];if(!n)return this;let i=n.findIndex(o=>o.listener===r);return i>=0&&n.splice(i,1),this}once(e,r){return(Rt(this,RE,"f")[e]||(Rt(this,RE,"f")[e]=[])).push({listener:r,once:!0}),this}emitted(e){return new Promise((r,n)=>{Sn(this,oM,!0,"f"),e!=="error"&&this.once("error",n),this.once(e,r)})}async done(){Sn(this,oM,!0,"f"),await Rt(this,Eq,"f")}get currentMessage(){return Rt(this,dS,"f")}async finalMessage(){return await this.done(),Rt(this,lg,"m",Y2e).call(this)}async finalText(){return await this.done(),Rt(this,lg,"m",V0t).call(this)}_emit(e,...r){if(Rt(this,Iq,"f"))return;e==="end"&&(Sn(this,Iq,!0,"f"),Rt(this,nse,"f").call(this));let n=Rt(this,RE,"f")[e];if(n&&(Rt(this,RE,"f")[e]=n.filter(i=>!i.once),n.forEach(({listener:i})=>i(...r))),e==="abort"){let i=r[0];!Rt(this,oM,"f")&&!n?.length&&Promise.reject(i),Rt(this,xq,"f").call(this,i),Rt(this,bq,"f").call(this,i),this._emit("end");return}if(e==="error"){let i=r[0];!Rt(this,oM,"f")&&!n?.length&&Promise.reject(i),Rt(this,xq,"f").call(this,i),Rt(this,bq,"f").call(this,i),this._emit("end")}}_emitFinal(){this.receivedMessages.at(-1)&&this._emit("finalMessage",Rt(this,lg,"m",Y2e).call(this))}async _fromReadableStream(e,r){let n=r?.signal,i;n&&(n.aborted&&this.controller.abort(),i=this.controller.abort.bind(this.controller),n.addEventListener("abort",i));try{Rt(this,lg,"m",J2e).call(this),this._connected(null);let o=U1.fromReadableStream(e,this.controller);for await(let a of o)Rt(this,lg,"m",X2e).call(this,a);if(o.controller.signal?.aborted)throw new dd;Rt(this,lg,"m",Z2e).call(this)}finally{n&&i&&n.removeEventListener("abort",i)}}[(dS=new WeakMap,vq=new WeakMap,rse=new WeakMap,xq=new WeakMap,Eq=new WeakMap,nse=new WeakMap,bq=new WeakMap,RE=new WeakMap,Iq=new WeakMap,ise=new WeakMap,ose=new WeakMap,oM=new WeakMap,sse=new WeakMap,ase=new WeakMap,cse=new WeakMap,lg=new WeakSet,Y2e=s(function(){if(this.receivedMessages.length===0)throw new In("stream ended without producing a Message with role=assistant");return this.receivedMessages.at(-1)},"_BetaMessageStream_getFinalMessage"),V0t=s(function(){if(this.receivedMessages.length===0)throw new In("stream ended without producing a Message with role=assistant");let r=this.receivedMessages.at(-1).content.filter(n=>n.type==="text").map(n=>n.text);if(r.length===0)throw new In("stream ended without producing a content block with type=text");return r.join(" ")},"_BetaMessageStream_getFinalText"),J2e=s(function(){this.ended||Sn(this,dS,void 0,"f")},"_BetaMessageStream_beginRequest"),X2e=s(function(r){if(this.ended)return;let n=Rt(this,lg,"m",z0t).call(this,r);switch(this._emit("streamEvent",r,n),r.type){case"content_block_delta":{let i=n.content.at(-1);switch(r.delta.type){case"text_delta":{i.type==="text"&&this._emit("text",r.delta.text,i.text||"");break}case"citations_delta":{i.type==="text"&&this._emit("citation",r.delta.citation,i.citations??[]);break}case"input_json_delta":{Y0t(i)&&i.input&&this._emit("inputJson",r.delta.partial_json,i.input);break}case"thinking_delta":{i.type==="thinking"&&this._emit("thinking",r.delta.thinking,i.thinking);break}case"signature_delta":{i.type==="thinking"&&this._emit("signature",i.signature);break}default:r.delta}break}case"message_stop":{this._addMessageParam(n),this._addMessage(n,!0);break}case"content_block_stop":{this._emit("contentBlock",n.content.at(-1));break}case"message_start":{Sn(this,dS,n,"f");break}case"content_block_start":case"message_delta":break}},"_BetaMessageStream_addStreamEvent"),Z2e=s(function(){if(this.ended)throw new In("stream has ended, this shouldn't happen");let r=Rt(this,dS,"f");if(!r)throw new In("request ended without sending any chunks");return Sn(this,dS,void 0,"f"),r},"_BetaMessageStream_endRequest"),z0t=s(function(r){let n=Rt(this,dS,"f");if(r.type==="message_start"){if(n)throw new In(`Unexpected event order, got ${r.type} before receiving "message_stop"`);return r.message}if(!n)throw new In(`Unexpected event order, got ${r.type} before "message_start"`);switch(r.type){case"message_stop":return n;case"message_delta":return n.container=r.delta.container,n.stop_reason=r.delta.stop_reason,n.stop_sequence=r.delta.stop_sequence,n.usage.output_tokens=r.usage.output_tokens,r.usage.input_tokens!=null&&(n.usage.input_tokens=r.usage.input_tokens),r.usage.cache_creation_input_tokens!=null&&(n.usage.cache_creation_input_tokens=r.usage.cache_creation_input_tokens),r.usage.cache_read_input_tokens!=null&&(n.usage.cache_read_input_tokens=r.usage.cache_read_input_tokens),r.usage.server_tool_use!=null&&(n.usage.server_tool_use=r.usage.server_tool_use),n;case"content_block_start":return n.content.push(r.content_block),n;case"content_block_delta":{let i=n.content.at(r.index);switch(r.delta.type){case"text_delta":{i?.type==="text"&&(n.content[r.index]={...i,text:(i.text||"")+r.delta.text});break}case"citations_delta":{i?.type==="text"&&(n.content[r.index]={...i,citations:[...i.citations??[],r.delta.citation]});break}case"input_json_delta":{if(i&&Y0t(i)){let o=i[K0t]||"";o+=r.delta.partial_json;let a={...i};if(Object.defineProperty(a,K0t,{value:o,enumerable:!1,writable:!0}),o)try{a.input=tse(o)}catch(c){let l=new In(`Unable to parse tool parameter JSON from model. Please retry your request or adjust your prompt. Error: ${c}. JSON: ${o}`);Rt(this,cse,"f").call(this,l)}n.content[r.index]=a}break}case"thinking_delta":{i?.type==="thinking"&&(n.content[r.index]={...i,thinking:i.thinking+r.delta.thinking});break}case"signature_delta":{i?.type==="thinking"&&(n.content[r.index]={...i,signature:r.delta.signature});break}default:r.delta}return n}case"content_block_stop":return n}},"_BetaMessageStream_accumulateMessage"),Symbol.asyncIterator)](){let e=[],r=[],n=!1;return this.on("streamEvent",i=>{let o=r.shift();o?o.resolve(i):e.push(i)}),this.on("end",()=>{n=!0;for(let i of r)i.resolve(void 0);r.length=0}),this.on("abort",i=>{n=!0;for(let o of r)o.reject(i);r.length=0}),this.on("error",i=>{n=!0;for(let o of r)o.reject(i);r.length=0}),{next:s(async()=>e.length?{value:e.shift(),done:!1}:n?{value:void 0,done:!0}:new Promise((o,a)=>r.push({resolve:o,reject:a})).then(o=>o?{value:o,done:!1}:{value:void 0,done:!0}),"next"),return:s(async()=>(this.abort(),{value:void 0,done:!0}),"return")}}toReadableStream(){return new U1(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}};d();var use={"claude-opus-4-20250514":8192,"claude-opus-4-0":8192,"claude-4-opus-20250514":8192,"anthropic.claude-opus-4-20250514-v1:0":8192,"claude-opus-4@20250514":8192};var J0t={"claude-1.3":"November 6th, 2024","claude-1.3-100k":"November 6th, 2024","claude-instant-1.1":"November 6th, 2024","claude-instant-1.1-100k":"November 6th, 2024","claude-instant-1.2":"November 6th, 2024","claude-3-sonnet-20240229":"July 21st, 2025","claude-3-opus-20240229":"January 5th, 2026","claude-2.1":"July 21st, 2025","claude-2.0":"July 21st, 2025"},mP=class extends vl{static{s(this,"Messages")}constructor(){super(...arguments),this.batches=new nM(this._client)}create(e,r){let{betas:n,...i}=e;i.model in J0t&&console.warn(`The model '${i.model}' is deprecated and will reach end-of-life on ${J0t[i.model]}
Please migrate to a newer model. Visit https://docs.anthropic.com/en/docs/resources/model-deprecations for more information.`);let o=this._client._options.timeout;if(!i.stream&&o==null){let a=use[i.model]??void 0;o=this._client.calculateNonstreamingTimeout(i.max_tokens,a)}return this._client.post("/v1/messages?beta=true",{body:i,timeout:o??6e5,...r,headers:Vo([{...n?.toString()!=null?{"anthropic-beta":n?.toString()}:void 0},r?.headers]),stream:e.stream??!1})}stream(e,r){return lse.createMessage(this,e,r)}countTokens(e,r){let{betas:n,...i}=e;return this._client.post("/v1/messages/count_tokens?beta=true",{body:i,...r,headers:Vo([{"anthropic-beta":[...n??[],"token-counting-2024-11-01"].toString()},r?.headers])})}};mP.Batches=nM;var q1=class extends vl{static{s(this,"Beta")}constructor(){super(...arguments),this.models=new tM(this._client),this.messages=new mP(this._client),this.files=new eM(this._client)}};q1.Models=tM;q1.Messages=mP;q1.Files=eM;d();var hP=class extends vl{static{s(this,"Completions")}create(e,r){let{betas:n,...i}=e;return this._client.post("/v1/complete",{body:i,timeout:this._client._options.timeout??6e5,...r,headers:Vo([{...n?.toString()!=null?{"anthropic-beta":n?.toString()}:void 0},r?.headers]),stream:e.stream??!1})}};d();d();var ug,fS,Tq,dse,wq,Sq,fse,_q,kE,Rq,pse,mse,sM,hse,gse,eRe,X0t,tRe,rRe,nRe,iRe,Z0t,emt="__json_buf";function tmt(t){return t.type==="tool_use"||t.type==="server_tool_use"}s(tmt,"tracksToolInput");var Ase=class t{static{s(this,"MessageStream")}constructor(){ug.add(this),this.messages=[],this.receivedMessages=[],fS.set(this,void 0),this.controller=new AbortController,Tq.set(this,void 0),dse.set(this,()=>{}),wq.set(this,()=>{}),Sq.set(this,void 0),fse.set(this,()=>{}),_q.set(this,()=>{}),kE.set(this,{}),Rq.set(this,!1),pse.set(this,!1),mse.set(this,!1),sM.set(this,!1),hse.set(this,void 0),gse.set(this,void 0),tRe.set(this,e=>{if(Sn(this,pse,!0,"f"),wE(e)&&(e=new dd),e instanceof dd)return Sn(this,mse,!0,"f"),this._emit("abort",e);if(e instanceof In)return this._emit("error",e);if(e instanceof Error){let r=new In(e.message);return r.cause=e,this._emit("error",r)}return this._emit("error",new In(String(e)))}),Sn(this,Tq,new Promise((e,r)=>{Sn(this,dse,e,"f"),Sn(this,wq,r,"f")}),"f"),Sn(this,Sq,new Promise((e,r)=>{Sn(this,fse,e,"f"),Sn(this,_q,r,"f")}),"f"),Rt(this,Tq,"f").catch(()=>{}),Rt(this,Sq,"f").catch(()=>{})}get response(){return Rt(this,hse,"f")}get request_id(){return Rt(this,gse,"f")}async withResponse(){let e=await Rt(this,Tq,"f");if(!e)throw new Error("Could not resolve a `Response` object");return{data:this,response:e,request_id:e.headers.get("request-id")}}static fromReadableStream(e){let r=new t;return r._run(()=>r._fromReadableStream(e)),r}static createMessage(e,r,n){let i=new t;for(let o of r.messages)i._addMessageParam(o);return i._run(()=>i._createMessage(e,{...r,stream:!0},{...n,headers:{...n?.headers,"X-Stainless-Helper-Method":"stream"}})),i}_run(e){e().then(()=>{this._emitFinal(),this._emit("end")},Rt(this,tRe,"f"))}_addMessageParam(e){this.messages.push(e)}_addMessage(e,r=!0){this.receivedMessages.push(e),r&&this._emit("message",e)}async _createMessage(e,r,n){let i=n?.signal,o;i&&(i.aborted&&this.controller.abort(),o=this.controller.abort.bind(this.controller),i.addEventListener("abort",o));try{Rt(this,ug,"m",rRe).call(this);let{response:a,data:c}=await e.create({...r,stream:!0},{...n,signal:this.controller.signal}).withResponse();this._connected(a);for await(let l of c)Rt(this,ug,"m",nRe).call(this,l);if(c.controller.signal?.aborted)throw new dd;Rt(this,ug,"m",iRe).call(this)}finally{i&&o&&i.removeEventListener("abort",o)}}_connected(e){this.ended||(Sn(this,hse,e,"f"),Sn(this,gse,e?.headers.get("request-id"),"f"),Rt(this,dse,"f").call(this,e),this._emit("connect"))}get ended(){return Rt(this,Rq,"f")}get errored(){return Rt(this,pse,"f")}get aborted(){return Rt(this,mse,"f")}abort(){this.controller.abort()}on(e,r){return(Rt(this,kE,"f")[e]||(Rt(this,kE,"f")[e]=[])).push({listener:r}),this}off(e,r){let n=Rt(this,kE,"f")[e];if(!n)return this;let i=n.findIndex(o=>o.listener===r);return i>=0&&n.splice(i,1),this}once(e,r){return(Rt(this,kE,"f")[e]||(Rt(this,kE,"f")[e]=[])).push({listener:r,once:!0}),this}emitted(e){return new Promise((r,n)=>{Sn(this,sM,!0,"f"),e!=="error"&&this.once("error",n),this.once(e,r)})}async done(){Sn(this,sM,!0,"f"),await Rt(this,Sq,"f")}get currentMessage(){return Rt(this,fS,"f")}async finalMessage(){return await this.done(),Rt(this,ug,"m",eRe).call(this)}async finalText(){return await this.done(),Rt(this,ug,"m",X0t).call(this)}_emit(e,...r){if(Rt(this,Rq,"f"))return;e==="end"&&(Sn(this,Rq,!0,"f"),Rt(this,fse,"f").call(this));let n=Rt(this,kE,"f")[e];if(n&&(Rt(this,kE,"f")[e]=n.filter(i=>!i.once),n.forEach(({listener:i})=>i(...r))),e==="abort"){let i=r[0];!Rt(this,sM,"f")&&!n?.length&&Promise.reject(i),Rt(this,wq,"f").call(this,i),Rt(this,_q,"f").call(this,i),this._emit("end");return}if(e==="error"){let i=r[0];!Rt(this,sM,"f")&&!n?.length&&Promise.reject(i),Rt(this,wq,"f").call(this,i),Rt(this,_q,"f").call(this,i),this._emit("end")}}_emitFinal(){this.receivedMessages.at(-1)&&this._emit("finalMessage",Rt(this,ug,"m",eRe).call(this))}async _fromReadableStream(e,r){let n=r?.signal,i;n&&(n.aborted&&this.controller.abort(),i=this.controller.abort.bind(this.controller),n.addEventListener("abort",i));try{Rt(this,ug,"m",rRe).call(this),this._connected(null);let o=U1.fromReadableStream(e,this.controller);for await(let a of o)Rt(this,ug,"m",nRe).call(this,a);if(o.controller.signal?.aborted)throw new dd;Rt(this,ug,"m",iRe).call(this)}finally{n&&i&&n.removeEventListener("abort",i)}}[(fS=new WeakMap,Tq=new WeakMap,dse=new WeakMap,wq=new WeakMap,Sq=new WeakMap,fse=new WeakMap,_q=new WeakMap,kE=new WeakMap,Rq=new WeakMap,pse=new WeakMap,mse=new WeakMap,sM=new WeakMap,hse=new WeakMap,gse=new WeakMap,tRe=new WeakMap,ug=new WeakSet,eRe=s(function(){if(this.receivedMessages.length===0)throw new In("stream ended without producing a Message with role=assistant");return this.receivedMessages.at(-1)},"_MessageStream_getFinalMessage"),X0t=s(function(){if(this.receivedMessages.length===0)throw new In("stream ended without producing a Message with role=assistant");let r=this.receivedMessages.at(-1).content.filter(n=>n.type==="text").map(n=>n.text);if(r.length===0)throw new In("stream ended without producing a content block with type=text");return r.join(" ")},"_MessageStream_getFinalText"),rRe=s(function(){this.ended||Sn(this,fS,void 0,"f")},"_MessageStream_beginRequest"),nRe=s(function(r){if(this.ended)return;let n=Rt(this,ug,"m",Z0t).call(this,r);switch(this._emit("streamEvent",r,n),r.type){case"content_block_delta":{let i=n.content.at(-1);switch(r.delta.type){case"text_delta":{i.type==="text"&&this._emit("text",r.delta.text,i.text||"");break}case"citations_delta":{i.type==="text"&&this._emit("citation",r.delta.citation,i.citations??[]);break}case"input_json_delta":{tmt(i)&&i.input&&this._emit("inputJson",r.delta.partial_json,i.input);break}case"thinking_delta":{i.type==="thinking"&&this._emit("thinking",r.delta.thinking,i.thinking);break}case"signature_delta":{i.type==="thinking"&&this._emit("signature",i.signature);break}default:r.delta}break}case"message_stop":{this._addMessageParam(n),this._addMessage(n,!0);break}case"content_block_stop":{this._emit("contentBlock",n.content.at(-1));break}case"message_start":{Sn(this,fS,n,"f");break}case"content_block_start":case"message_delta":break}},"_MessageStream_addStreamEvent"),iRe=s(function(){if(this.ended)throw new In("stream has ended, this shouldn't happen");let r=Rt(this,fS,"f");if(!r)throw new In("request ended without sending any chunks");return Sn(this,fS,void 0,"f"),r},"_MessageStream_endRequest"),Z0t=s(function(r){let n=Rt(this,fS,"f");if(r.type==="message_start"){if(n)throw new In(`Unexpected event order, got ${r.type} before receiving "message_stop"`);return r.message}if(!n)throw new In(`Unexpected event order, got ${r.type} before "message_start"`);switch(r.type){case"message_stop":return n;case"message_delta":return n.stop_reason=r.delta.stop_reason,n.stop_sequence=r.delta.stop_sequence,n.usage.output_tokens=r.usage.output_tokens,r.usage.input_tokens!=null&&(n.usage.input_tokens=r.usage.input_tokens),r.usage.cache_creation_input_tokens!=null&&(n.usage.cache_creation_input_tokens=r.usage.cache_creation_input_tokens),r.usage.cache_read_input_tokens!=null&&(n.usage.cache_read_input_tokens=r.usage.cache_read_input_tokens),r.usage.server_tool_use!=null&&(n.usage.server_tool_use=r.usage.server_tool_use),n;case"content_block_start":return n.content.push({...r.content_block}),n;case"content_block_delta":{let i=n.content.at(r.index);switch(r.delta.type){case"text_delta":{i?.type==="text"&&(n.content[r.index]={...i,text:(i.text||"")+r.delta.text});break}case"citations_delta":{i?.type==="text"&&(n.content[r.index]={...i,citations:[...i.citations??[],r.delta.citation]});break}case"input_json_delta":{if(i&&tmt(i)){let o=i[emt]||"";o+=r.delta.partial_json;let a={...i};Object.defineProperty(a,emt,{value:o,enumerable:!1,writable:!0}),o&&(a.input=tse(o)),n.content[r.index]=a}break}case"thinking_delta":{i?.type==="thinking"&&(n.content[r.index]={...i,thinking:i.thinking+r.delta.thinking});break}case"signature_delta":{i?.type==="thinking"&&(n.content[r.index]={...i,signature:r.delta.signature});break}default:r.delta}return n}case"content_block_stop":return n}},"_MessageStream_accumulateMessage"),Symbol.asyncIterator)](){let e=[],r=[],n=!1;return this.on("streamEvent",i=>{let o=r.shift();o?o.resolve(i):e.push(i)}),this.on("end",()=>{n=!0;for(let i of r)i.resolve(void 0);r.length=0}),this.on("abort",i=>{n=!0;for(let o of r)o.reject(i);r.length=0}),this.on("error",i=>{n=!0;for(let o of r)o.reject(i);r.length=0}),{next:s(async()=>e.length?{value:e.shift(),done:!1}:n?{value:void 0,done:!0}:new Promise((o,a)=>r.push({resolve:o,reject:a})).then(o=>o?{value:o,done:!1}:{value:void 0,done:!0}),"next"),return:s(async()=>(this.abort(),{value:void 0,done:!0}),"return")}}toReadableStream(){return new U1(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}};d();var aM=class extends vl{static{s(this,"Batches")}create(e,r){return this._client.post("/v1/messages/batches",{body:e,...r})}retrieve(e,r){return this._client.get(Zd`/v1/messages/batches/${e}`,r)}list(e={},r){return this._client.getAPIList("/v1/messages/batches",cg,{query:e,...r})}delete(e,r){return this._client.delete(Zd`/v1/messages/batches/${e}`,r)}cancel(e,r){return this._client.post(Zd`/v1/messages/batches/${e}/cancel`,r)}async results(e,r){let n=await this.retrieve(e);if(!n.results_url)throw new In(`No batch \`results_url\`; Has it finished processing? ${n.processing_status} - ${n.id}`);return this._client.get(n.results_url,{...r,headers:Vo([{Accept:"application/binary"},r?.headers]),stream:!0,__binaryResponse:!0})._thenUnwrap((i,o)=>rM.fromResponse(o.response,o.controller))}};var pS=class extends vl{static{s(this,"Messages")}constructor(){super(...arguments),this.batches=new aM(this._client)}create(e,r){e.model in rmt&&console.warn(`The model '${e.model}' is deprecated and will reach end-of-life on ${rmt[e.model]}
Please migrate to a newer model. Visit https://docs.anthropic.com/en/docs/resources/model-deprecations for more information.`);let n=this._client._options.timeout;if(!e.stream&&n==null){let i=use[e.model]??void 0;n=this._client.calculateNonstreamingTimeout(e.max_tokens,i)}return this._client.post("/v1/messages",{body:e,timeout:n??6e5,...r,stream:e.stream??!1})}stream(e,r){return Ase.createMessage(this,e,r)}countTokens(e,r){return this._client.post("/v1/messages/count_tokens",{body:e,...r})}},rmt={"claude-1.3":"November 6th, 2024","claude-1.3-100k":"November 6th, 2024","claude-instant-1.1":"November 6th, 2024","claude-instant-1.1-100k":"November 6th, 2024","claude-instant-1.2":"November 6th, 2024","claude-3-sonnet-20240229":"July 21st, 2025","claude-3-opus-20240229":"January 5th, 2026","claude-2.1":"July 21st, 2025","claude-2.0":"July 21st, 2025"};pS.Batches=aM;d();var gP=class extends vl{static{s(this,"Models")}retrieve(e,r={},n){let{betas:i}=r??{};return this._client.get(Zd`/v1/models/${e}`,{...n,headers:Vo([{...i?.toString()!=null?{"anthropic-beta":i?.toString()}:void 0},n?.headers])})}list(e={},r){let{betas:n,...i}=e??{};return this._client.getAPIList("/v1/models",cg,{query:i,...r,headers:Vo([{...n?.toString()!=null?{"anthropic-beta":n?.toString()}:void 0},r?.headers])})}};d();var kq=s(t=>{if(typeof globalThis.process<"u")return globalThis.process.env?.[t]?.trim()??void 0;if(typeof globalThis.Deno<"u")return globalThis.Deno.env?.get?.(t)?.trim()},"readEnv");var oRe,sRe,yse,nmt,oc=class{static{s(this,"BaseAnthropic")}constructor({baseURL:e=kq("ANTHROPIC_BASE_URL"),apiKey:r=kq("ANTHROPIC_API_KEY")??null,authToken:n=kq("ANTHROPIC_AUTH_TOKEN")??null,...i}={}){oRe.add(this),yse.set(this,void 0);let o={apiKey:r,authToken:n,...i,baseURL:e||"https://api.anthropic.com"};if(!o.dangerouslyAllowBrowser&&P0t())throw new In(`It looks like you're running in a browser-like environment.

This is disabled by default, as it risks exposing your secret API credentials to attackers.
If you understand the risks and have appropriate mitigations in place,
you can set the \`dangerouslyAllowBrowser\` option to \`true\`, e.g.,

new Anthropic({ apiKey, dangerouslyAllowBrowser: true });
`);this.baseURL=o.baseURL,this.timeout=o.timeout??sRe.DEFAULT_TIMEOUT,this.logger=o.logger??console;let a="warn";this.logLevel=a,this.logLevel=H2e(o.logLevel,"ClientOptions.logLevel",this)??H2e(kq("ANTHROPIC_LOG"),"process.env['ANTHROPIC_LOG']",this)??a,this.fetchOptions=o.fetchOptions,this.maxRetries=o.maxRetries??2,this.fetch=o.fetch??B0t(),Sn(this,yse,M0t,"f"),this._options=o,this.apiKey=r,this.authToken=n}withOptions(e){return new this.constructor({...this._options,baseURL:this.baseURL,maxRetries:this.maxRetries,timeout:this.timeout,logger:this.logger,logLevel:this.logLevel,fetch:this.fetch,fetchOptions:this.fetchOptions,apiKey:this.apiKey,authToken:this.authToken,...e})}defaultQuery(){return this._options.defaultQuery}validateHeaders({values:e,nulls:r}){if(!(this.apiKey&&e.get("x-api-key"))&&!r.has("x-api-key")&&!(this.authToken&&e.get("authorization"))&&!r.has("authorization"))throw new Error('Could not resolve authentication method. Expected either apiKey or authToken to be set. Or for one of the "X-Api-Key" or "Authorization" headers to be explicitly omitted')}authHeaders(e){return Vo([this.apiKeyAuth(e),this.bearerAuth(e)])}apiKeyAuth(e){if(this.apiKey!=null)return Vo([{"X-Api-Key":this.apiKey}])}bearerAuth(e){if(this.authToken!=null)return Vo([{Authorization:`Bearer ${this.authToken}`}])}stringifyQuery(e){return Object.entries(e).filter(([r,n])=>typeof n<"u").map(([r,n])=>{if(typeof n=="string"||typeof n=="number"||typeof n=="boolean")return`${encodeURIComponent(r)}=${encodeURIComponent(n)}`;if(n===null)return`${encodeURIComponent(r)}=`;throw new In(`Cannot stringify type ${typeof n}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}getUserAgent(){return`${this.constructor.name}/JS ${uS}`}defaultIdempotencyKey(){return`stainless-node-retry-${L2e()}`}makeStatusError(e,r,n,i){return Iu.generate(e,r,n,i)}buildURL(e,r,n){let i=!Rt(this,oRe,"m",nmt).call(this)&&n||this.baseURL,o=b0t(e)?new URL(e):new URL(i+(i.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),a=this.defaultQuery();return I0t(a)||(r={...a,...r}),typeof r=="object"&&r&&!Array.isArray(r)&&(o.search=this.stringifyQuery(r)),o.toString()}_calculateNonstreamingTimeout(e){if(3600*e/128e3>600)throw new In("Streaming is strongly recommended for operations that may take longer than 10 minutes. See https://github.com/anthropics/anthropic-sdk-typescript#streaming-responses for more details");return 600*1e3}async prepareOptions(e){}async prepareRequest(e,{url:r,options:n}){}get(e,r){return this.methodRequest("get",e,r)}post(e,r){return this.methodRequest("post",e,r)}patch(e,r){return this.methodRequest("patch",e,r)}put(e,r){return this.methodRequest("put",e,r)}delete(e,r){return this.methodRequest("delete",e,r)}methodRequest(e,r,n){return this.request(Promise.resolve(n).then(i=>({method:e,path:r,...i})))}request(e,r=null){return new fP(this,this.makeRequest(e,r,void 0))}async makeRequest(e,r,n){let i=await e,o=i.maxRetries??this.maxRetries;r==null&&(r=o),await this.prepareOptions(i);let{req:a,url:c,timeout:l}=this.buildRequest(i,{retryCount:o-r});await this.prepareRequest(a,{url:c,options:i});let u="log_"+(Math.random()*(1<<24)|0).toString(16).padStart(6,"0"),f=n===void 0?"":`, retryOf: ${n}`,p=Date.now();if(Tu(this).debug(`[${u}] sending request`,_E({retryOfRequestLogID:n,method:i.method,url:c,options:i,headers:a.headers})),i.signal?.aborted)throw new dd;let m=new AbortController,h=await this.fetchWithTimeout(c,a,l,m).catch(fq),g=Date.now();if(h instanceof Error){let E=`retrying, ${r} attempts remaining`;if(i.signal?.aborted)throw new dd;let b=wE(h)||/timed? ?out/i.test(String(h)+("cause"in h?String(h.cause):""));if(r)return Tu(this).info(`[${u}] connection ${b?"timed out":"failed"} - ${E}`),Tu(this).debug(`[${u}] connection ${b?"timed out":"failed"} (${E})`,_E({retryOfRequestLogID:n,url:c,durationMs:g-p,message:h.message})),this.retryRequest(i,r,n??u);throw Tu(this).info(`[${u}] connection ${b?"timed out":"failed"} - error; no more retries left`),Tu(this).debug(`[${u}] connection ${b?"timed out":"failed"} (error; no more retries left)`,_E({retryOfRequestLogID:n,url:c,durationMs:g-p,message:h.message})),b?new j8:new lS({cause:h})}let A=[...h.headers.entries()].filter(([E])=>E==="request-id").map(([E,b])=>", "+E+": "+JSON.stringify(b)).join(""),y=`[${u}${f}${A}] ${a.method} ${c} ${h.ok?"succeeded":"failed"} with status ${h.status} in ${g-p}ms`;if(!h.ok){let E=this.shouldRetry(h);if(r&&E){let O=`retrying, ${r} attempts remaining`;return await N0t(h.body),Tu(this).info(`${y} - ${O}`),Tu(this).debug(`[${u}] response error (${O})`,_E({retryOfRequestLogID:n,url:h.url,status:h.status,headers:h.headers,durationMs:g-p})),this.retryRequest(i,r,n??u,h.headers)}let b=E?"error; no more retries left":"error; not retryable";Tu(this).info(`${y} - ${b}`);let S=await h.text().catch(O=>fq(O).message),R=zoe(S),B=R?void 0:S;throw Tu(this).debug(`[${u}] response error (${b})`,_E({retryOfRequestLogID:n,url:h.url,status:h.status,headers:h.headers,message:B,durationMs:Date.now()-p})),this.makeStatusError(h.status,R,B,h.headers)}return Tu(this).info(y),Tu(this).debug(`[${u}] response start`,_E({retryOfRequestLogID:n,url:h.url,status:h.status,headers:h.headers,durationMs:g-p})),{response:h,options:i,controller:m,requestLogID:u,retryOfRequestLogID:n,startTime:p}}getAPIList(e,r,n){return this.requestAPIList(r,{method:"get",path:e,...n})}requestAPIList(e,r){let n=this.makeRequest(r,null,void 0);return new yq(this,n,e)}async fetchWithTimeout(e,r,n,i){let{signal:o,method:a,...c}=r||{};o&&o.addEventListener("abort",()=>i.abort());let l=setTimeout(()=>i.abort(),n),u=globalThis.ReadableStream&&c.body instanceof globalThis.ReadableStream||typeof c.body=="object"&&c.body!==null&&Symbol.asyncIterator in c.body,f={signal:i.signal,...u?{duplex:"half"}:{},method:"GET",...c};a&&(f.method=a.toUpperCase());try{return await this.fetch.call(void 0,e,f)}finally{clearTimeout(l)}}shouldRetry(e){let r=e.headers.get("x-should-retry");return r==="true"?!0:r==="false"?!1:e.status===408||e.status===409||e.status===429||e.status>=500}async retryRequest(e,r,n,i){let o,a=i?.get("retry-after-ms");if(a){let l=parseFloat(a);Number.isNaN(l)||(o=l)}let c=i?.get("retry-after");if(c&&!o){let l=parseFloat(c);Number.isNaN(l)?o=Date.parse(c)-Date.now():o=l*1e3}if(!(o&&0<=o&&o<60*1e3)){let l=e.maxRetries??this.maxRetries;o=this.calculateDefaultRetryTimeoutMillis(r,l)}return await S0t(o),this.makeRequest(e,r-1,n)}calculateDefaultRetryTimeoutMillis(e,r){let o=r-e,a=Math.min(.5*Math.pow(2,o),8),c=1-Math.random()*.25;return a*c*1e3}calculateNonstreamingTimeout(e,r){if(36e5*e/128e3>6e5||r!=null&&e>r)throw new In("Streaming is strongly recommended for operations that may token longer than 10 minutes. See https://github.com/anthropics/anthropic-sdk-typescript#long-requests for more details");return 6e5}buildRequest(e,{retryCount:r=0}={}){let n={...e},{method:i,path:o,query:a,defaultBaseURL:c}=n,l=this.buildURL(o,a,c);"timeout"in n&&w0t("timeout",n.timeout),n.timeout=n.timeout??this.timeout;let{bodyHeaders:u,body:f}=this.buildBody({options:n}),p=this.buildHeaders({options:e,method:i,bodyHeaders:u,retryCount:r});return{req:{method:i,headers:p,...n.signal&&{signal:n.signal},...globalThis.ReadableStream&&f instanceof globalThis.ReadableStream&&{duplex:"half"},...f&&{body:f},...this.fetchOptions??{},...n.fetchOptions??{}},url:l,timeout:n.timeout}}buildHeaders({options:e,method:r,bodyHeaders:n,retryCount:i}){let o={};this.idempotencyHeader&&r!=="get"&&(e.idempotencyKey||(e.idempotencyKey=this.defaultIdempotencyKey()),o[this.idempotencyHeader]=e.idempotencyKey);let a=Vo([o,{Accept:"application/json","User-Agent":this.getUserAgent(),"X-Stainless-Retry-Count":String(i),...e.timeout?{"X-Stainless-Timeout":String(Math.trunc(e.timeout/1e3))}:{},...D0t(),...this._options.dangerouslyAllowBrowser?{"anthropic-dangerous-direct-browser-access":"true"}:void 0,"anthropic-version":"2023-06-01"},this.authHeaders(e),this._options.defaultHeaders,n,e.headers]);return this.validateHeaders(a),a.values}buildBody({options:{body:e,headers:r}}){if(!e)return{bodyHeaders:void 0,body:void 0};let n=Vo([r]);return ArrayBuffer.isView(e)||e instanceof ArrayBuffer||e instanceof DataView||typeof e=="string"&&n.values.has("content-type")||e instanceof Blob||e instanceof FormData||e instanceof URLSearchParams||globalThis.ReadableStream&&e instanceof globalThis.ReadableStream?{bodyHeaders:void 0,body:e}:typeof e=="object"&&(Symbol.asyncIterator in e||Symbol.iterator in e&&"next"in e&&typeof e.next=="function")?{bodyHeaders:void 0,body:Koe(e)}:Rt(this,yse,"f").call(this,{body:e,headers:n})}};sRe=oc,yse=new WeakMap,oRe=new WeakSet,nmt=s(function(){return this.baseURL!=="https://api.anthropic.com"},"_BaseAnthropic_baseURLOverridden");oc.Anthropic=sRe;oc.HUMAN_PROMPT=`

Human:`;oc.AI_PROMPT=`

Assistant:`;oc.DEFAULT_TIMEOUT=6e5;oc.AnthropicError=In;oc.APIError=Iu;oc.APIConnectionError=lS;oc.APIConnectionTimeoutError=j8;oc.APIUserAbortError=dd;oc.NotFoundError=K8;oc.ConflictError=Y8;oc.RateLimitError=X8;oc.BadRequestError=G8;oc.AuthenticationError=V8;oc.InternalServerError=Z8;oc.PermissionDeniedError=z8;oc.UnprocessableEntityError=J8;oc.toFile=ese;var gy=class extends oc{static{s(this,"Anthropic")}constructor(){super(...arguments),this.completions=new hP(this),this.messages=new pS(this),this.models=new gP(this),this.beta=new q1(this)}};gy.Completions=hP;gy.Messages=pS;gy.Models=gP;gy.Beta=q1;var{HUMAN_PROMPT:lAr,AI_PROMPT:uAr}=gy;var Cse=class extends Xh{static{s(this,"AnthropicProvider")}constructor(e){super(Go.Anthropic,e)}async getAllModels(){await this.ensureKnownModelsCache();let e=await new nc(this.ctx.get(yi)).getAPIKey(this.providerName);if(!e)throw new Error(`API key not found for provider: ${this.providerName}`);let r=new gy({apiKey:e,fetch:dAr(this.ctx.get(Or))});try{let n=await r.models.list(),i=[];for(let o of n.data){let a=this._knownModels?.[o.id];a&&i.push({providerName:this.providerName,modelId:o.id,isRegistered:!1,isCustomModel:!1,modelCapabilities:a})}return i}catch(n){throw sU.error(this.ctx,`Error fetching models from ${this.providerName} provider:`,n),n}}};function dAr(t){return async(e,r)=>{let n=fAr(e,r),i=mAr(r),o=await t.fetch(n,i);return gAr(o)}}s(dAr,"createAnthropicFetchAdapter");function fAr(t,e){return t instanceof Request?(pAr(t,e),t.url):t instanceof URL?t.toString():t}s(fAr,"convertInputToString");function pAr(t,e){e&&(e.headers??=t.headers,e.method??=t.method,!e.body&&!t.bodyUsed&&(e.body=t.body))}s(pAr,"mergeRequestInit");function mAr(t){let e;return t?.headers&&(e=hAr(t.headers)),{method:t?.method||"GET",headers:e,body:t?.body,signal:t?.signal||void 0}}s(mAr,"convertToFetchOptions");function hAr(t){let e={};if(t instanceof Headers)for(let[r,n]of t.entries())e[r]=n;else if(Array.isArray(t))for(let[r,n]of t)e[r]=n;else return t;return e}s(hAr,"convertHeaders");async function gAr(t){let e=t.body(),r=null;if(e)r=AAr(e);else{let n=await t.text();r=CAr(n)}return new globalThis.Response(r,{status:t.status,statusText:t.statusText,headers:new Headers(t.headers)})}s(gAr,"convertToWebResponse");function AAr(t){return new ReadableStream({start(e){let r=yAr(t,e);return()=>r()},cancel(){"destroy"in t&&typeof t.destroy=="function"&&t.destroy()}})}s(AAr,"createReadableStreamFromNodeStream");function yAr(t,e){let r=s(a=>{e.enqueue(new Uint8Array(a))},"onData"),n=s(()=>{e.close(),o()},"onEnd"),i=s(a=>{e.error(a),o()},"onError"),o=s(()=>{t.off("data",r),t.off("end",n),t.off("error",i)},"cleanup");return t.on("data",r),t.on("end",n),t.on("error",i),o}s(yAr,"setupStreamHandlers");function CAr(t){return new ReadableStream({start(e){e.enqueue(new TextEncoder().encode(t)),e.close()}})}s(CAr,"createReadableStreamFromText");d();var vse=class extends Xh{static{s(this,"GeminiProvider")}constructor(e){super(Go.Gemini,e)}};d();var xse=class extends Xh{static{s(this,"GroqProvider")}constructor(e){super(Go.Groq,e)}};d();var Ese=class extends Xh{static{s(this,"OpenAIProvider")}constructor(e){super(Go.OpenAI,e)}};d();var imt=16e3,bse=class extends Xh{static{s(this,"OpenRouterProvider")}constructor(e){super(Go.OpenRouter,e)}async getAllModels(){try{let e=this.getFetchModelUrl(),r={"Content-Type":"application/json"},n=await new nc(this.ctx.get(yi)).getAPIKey(this.providerName);n&&(r.Authorization=`Bearer ${n}`);let i=await this.ctx.get(Or).fetch(e,{method:"GET",headers:r});if(!i.ok)throw new Error(`Failed to fetch models: ${i.status} ${i.statusText}`);let o=await i.json();if(o.error)throw new Error(`API Error: ${JSON.stringify(o.error)}`);let a=[];for(let c of o.data)a.push({providerName:this.providerName,modelId:c.id,isRegistered:!1,isCustomModel:!1,modelCapabilities:{name:c.name,maxInputTokens:Math.max(0,c.top_provider.context_length-imt),maxOutputTokens:imt,toolCalling:c.supported_parameters?.includes("tools")??!1,vision:c.architecture?.input_modalities?.includes("image")??!1}});return a}catch(e){throw sU.error(this.ctx,`Error fetching models from ${this.providerName} provider:`,e),e}}getFetchModelUrl(){return`${this.getBaseUrl()}/models?supported_parameters=tools`}};var AP=class{static{s(this,"BYOKProviderFactory")}constructor(e){this.providers=new Map([[Go.OpenAI,new Ese(e)],[Go.Gemini,new vse(e)],[Go.Groq,new xse(e)],[Go.OpenRouter,new bse(e)],[Go.Anthropic,new Cse(e)]])}getBYOKProvider(e){return this.providers.get(e)}};var vAr=x.Object({providerName:x.Optional(x.String()),enableFetchUrl:x.Optional(x.Boolean())});async function xAr(t,e,r){try{let{providerName:n,enableFetchUrl:i}=r,o=new nc(t.get(yi)),a=[];if(n)if(i){if(!fne(n))return[null,{code:tr.InvalidRequest,message:`enableFetchUrl is not supported for the ${n} provider`}];if(!await o.getAPIKey(n))return[null,{code:tr.InvalidRequest,message:`API key is required to fetch models from ${n}`}];let l=t.get(AP).getBYOKProvider(n);if(l){let u=await l.getAllModels(),f=new Map;u.forEach(h=>{let g=`${h.providerName}_${h.modelId}`;f.set(g,h)});let p=await o.getStoredModelConfigs(n),m=[];Object.entries(p).forEach(([h,g])=>{m.push({providerName:n,modelId:h,deploymentUrl:g.deploymentUrl,isRegistered:g.isRegistered,isCustomModel:g.isCustomModel,modelCapabilities:g.modelCapabilities})}),m.forEach(h=>{let g=`${h.providerName}_${h.modelId}`;f.set(g,h)}),a.push(...f.values())}}else{let c=await o.getStoredModelConfigs(n);Object.entries(c).forEach(([l,u])=>{a.push({providerName:n,modelId:l,deploymentUrl:u.deploymentUrl,isRegistered:u.isRegistered,isCustomModel:u.isCustomModel,modelCapabilities:u.modelCapabilities})})}else{let c=Object.values(Go);for(let l of c){let u=await o.getStoredModelConfigs(l);Object.entries(u).forEach(([f,p])=>{a.push({providerName:l,modelId:f,deploymentUrl:p.deploymentUrl,isRegistered:p.isRegistered,isCustomModel:p.isCustomModel,modelCapabilities:p.modelCapabilities})})}}return[{models:a},null]}catch(n){return[null,{code:tr.InternalError,message:`Failed to get models: ${n instanceof Error?n.message:String(n)}`}]}}s(xAr,"handleBYOKListModelsChecked");var omt=Ze(vAr,xAr);d();var EAr=x.Object({providerName:x.String(),apiKey:x.String(),modelId:x.Optional(x.String())});async function bAr(t,e,r){try{let n=new nc(t.get(yi)),{providerName:i,apiKey:o,modelId:a}=r,c=Pw(i);if(c===1&&!a)return[null,{code:tr.InvalidRequest,message:"modelId is required for PerModelDeployment auth type"}];await n.storeAPIKey(i,o,c,a);let l=`API key saved successfully for provider ${i}`;return[{success:!0,message:a?`${l} and model ${a}`:l},null]}catch(n){return[null,{code:tr.InternalError,message:`Failed to save API key: ${n instanceof Error?n.message:String(n)}`}]}}s(bAr,"handleBYOKSaveApiKeyChecked");var smt=Ze(EAr,bAr);d();var IAr=x.Object({providerName:x.String(),modelId:x.String(),isRegistered:x.Boolean(),isCustomModel:x.Boolean(),deploymentUrl:x.Optional(x.String()),apiKey:x.Optional(x.String()),modelCapabilities:x.Optional(x.Object({name:x.String(),maxInputTokens:x.Optional(x.Number()),maxOutputTokens:x.Optional(x.Number()),toolCalling:x.Boolean(),vision:x.Boolean()}))});async function TAr(t,e,r){try{let{providerName:n,modelId:i,isRegistered:o,isCustomModel:a,deploymentUrl:c,apiKey:l,modelCapabilities:u}=r,f=new nc(t.get(yi)),p=Pw(n);if(p===1&&!c)return[null,{code:tr.InvalidRequest,message:`deploymentUrl is required for the ${n} provider`}];if(c||u){let m={deploymentUrl:c,isRegistered:o,isCustomModel:a,modelCapabilities:u};await f.saveModelConfig(n,i,m,l,p)}else l!==void 0&&await f.storeAPIKey(n,l,p,i);return[{success:!0,message:`Model ${i} saved successfully for provider ${n}`},null]}catch(n){return[null,{code:tr.InternalError,message:`Failed to save model: ${n instanceof Error?n.message:String(n)}`}]}}s(TAr,"handleBYOKSaveModelChecked");var amt=Ze(IAr,TAr);d();var wAr=x.Object({uri:x.String({minLength:1})});async function SAr(t,e,r){let n=await t.get(En).getOrReadTextDocument(r);return[{status:ca(n),...n.status==="invalid"&&{reason:n.reason},...n.status==="notfound"&&{reason:n.message}},null]}s(SAr,"handleCheckFileStatusChecked");var cmt=Ze(wAr,SAr);d();var _Ar=x.Object({});function lmt(t,e){return typeof t!="number"||typeof e!="number"||e===0?0:Math.max(0,Math.min(100,t/e*100))}s(lmt,"calculatePercentRemaining");async function RAr(t,e,r){let n=await t.get(Bi).getSession();if(n){let i=await kme(t,n);if(i.ok){let o=await i.json();return o.access_type_sku==="free_limited_copilot"?[{chat:{percentRemaining:lmt(o.limited_user_quotas?.chat,o.monthly_quotas?.chat),unlimited:!1,overagePermitted:!1},completions:{percentRemaining:lmt(o.limited_user_quotas?.completions,o.monthly_quotas?.completions),unlimited:!1,overagePermitted:!1},premiumInteractions:{percentRemaining:0,unlimited:!1,overagePermitted:!1},resetDate:o.limited_user_reset_date??"",copilotPlan:"free"},null]:[{chat:{percentRemaining:o.quota_snapshots?.chat?.percent_remaining??100,unlimited:o.quota_snapshots?.chat?.unlimited??!1,overagePermitted:o.quota_snapshots?.chat?.overage_permitted??!1},completions:{percentRemaining:o.quota_snapshots?.completions?.percent_remaining??100,unlimited:o.quota_snapshots?.completions?.unlimited??!1,overagePermitted:o.quota_snapshots?.completions?.overage_permitted??!1},premiumInteractions:{percentRemaining:o.quota_snapshots?.premium_interactions?.percent_remaining??100,unlimited:o.quota_snapshots?.premium_interactions?.unlimited??!1,overagePermitted:o.quota_snapshots?.premium_interactions?.overage_permitted??!1},resetDate:o.quota_reset_date??"",copilotPlan:o.copilot_plan},null]}return[null,{code:tr.InternalError,message:"Failed to fetch quota info"}]}else return[null,{code:tr.InternalError,message:"Not signed in"}]}s(RAr,"handleCheckQuotaChecked");var umt=Ze(_Ar,RAr);d();var kAr=x.Object({options:x.Optional(x.Object({localChecksOnly:x.Optional(x.Boolean()),forceRefresh:x.Optional(x.Boolean())}))});async function PAr(t,e,r){return[await t.get(Bi).checkAndUpdateStatus(r.options),null]}s(PAr,"handleCheckStatusChecked");var dmt=Ze(kAr,PAr);d();d();d();d();d();var yP={Unknown:-1,Default:0,ToolRoundExceedError:1e4};var Ns=class{constructor(e){this.ctx=e;this.progressEntries=new Sr(250)}static{s(this,"ConversationProgress")}async begin(e,r,n){let i={status:"open",handler:n};this.progressEntries.set(e.id,i),await i.handler.begin(this.ctx,e,r)}async report(e,r,n){let i=this.getProgressEntry(e);i.status==="open"&&await i.handler.report(this.ctx,e,r,n)}async end(e,r,n){let i=this.getProgressEntry(e);i.status==="open"&&(this.progressEntries.set(e.id,{...i,status:"done",updatedAt:Date.now()}),await i.handler.end(this.ctx,e,r,n))}async cancel(e,r,n){let i=this.getProgressEntry(e);i.status==="open"&&(this.progressEntries.set(e.id,{...i,status:"cancelled",updatedAt:Date.now()}),await i.handler.cancel(this.ctx,e,r,n))}getProgressEntry(e){let r=this.progressEntries.get(e.id);if(r===void 0)throw new Error(`No work done token for conversation ${e.id}`);return r.status!=="open"&&_r.error(this.ctx,`Work done token for conversation ${e.id} is already ${r.status}, last updated at ${r.updatedAt}`),r}};d();d();d();var xl=class{static{s(this,"ConversationInspector")}};d();d();d();function Tse(t){switch(t){case"Agent":return"Agent";case"Ask":default:return"Ask"}}s(Tse,"toChatModeEnum");var mS=class{constructor(e,r){this.request=e;this.telemetryId=br();this.timestamp=Date.now();this.status="in-progress";this.skills=[];this.ignoredSkills=[];this.annotations=[];this._metadata=new Map;this.id=r??this.telemetryId}static{s(this,"Turn")}getResolvedModelId(){return this.resolvedModelConfiguration?.modelId}getChatModeWithDefault(){return this.chatMode??"Ask"}extractContextFilesUri(){let e=[...(this.request.references??[]).filter(r=>r.type==="file").map(r=>r.uri).filter(Boolean),...this.request.activeEditor?.uri?[this.request.activeEditor.uri]:[]];return Array.from(new Set(e))}getMetadata(e){return this._metadata.get(e)?.at(-1)}getAllMetadata(e){return this._metadata.get(e)}setMetadata(e){let r=e.constructor,n=this._metadata.get(r)??[];n.push(e),this._metadata.set(r,n)}hasMetadata(e){let r=this._metadata.get(e);return r!==void 0&&r.length>0}},Ise=class t{constructor(e=[],r="panel",n="en",i){this.turns=e;this.source=r;this.userLanguage=n;this._telemetryId=br();this._timestamp=Date.now();this.id=i??this.telemetryId}static{s(this,"Conversation")}copy(){let e=JSON.parse(JSON.stringify(this.turns)),r=new t(e,this.source,this.userLanguage,this.id);return r._telemetryId=this.telemetryId,r._timestamp=this.timestamp,r}get telemetryId(){return this._telemetryId}get timestamp(){return this._timestamp}addTurn(e){this.turns.push(e)}deleteTurn(e){this.turns=this.turns.filter(r=>r.id!==e)}getLastTurn(){return this.turns[this.turns.length-1]}findTurn(e){return this.turns.find(r=>r.id===e)}};d();var ql=class{constructor(){this.skills=[]}static{s(this,"ConversationSkillRegistry")}registerSkill(e){if(this.getSkill(e.id))throw new Error(`Skill with id '${e.id}' already registered`);this.skills.push(e)}getSkill(e){return this.skills.find(r=>r.id===e)}getDescriptors(){return[...this.skills]}},aRe=class{constructor(e,r,n){this.delegate=e;this.stepId=r;this.stepTitle=n}static{s(this,"StepReportingSkillResolver")}async resolveSkill(e){await e.steps.start(this.stepId,this.stepTitle);try{let r=await this.delegate.resolveSkill(e);return r||await e.steps.finish(this.stepId),r}catch(r){throw await e.steps.error(this.stepId,r instanceof Error?r.message:`Error resolving ${this.stepTitle}`),r}}},cRe=class{constructor(e,r){this.delegate=e;this.stepId=r}static{s(this,"StepReportingSkillProcessor")}value(){return this.delegate.value()}async processSkill(e,r){try{let n=await this.delegate.processSkill(e,r);return await r.steps.finish(this.stepId),n}catch(n){throw await r.steps.error(this.stepId,n instanceof Error?n.message:`Error processing ${this.stepId}`),n}}},wu=class{constructor(e,r,n,i,o,a="explicit",c=[],l=()=>!0){this.id=e;this._description=r;this.stepTitle=n;this._resolver=i;this._processor=o;this.type=a;this._examples=c;this._isAvailable=l}static{s(this,"SingleStepReportingSkill")}description(){return this._description}examples(){return this._examples}isAvailable(e){return this._isAvailable(e)}resolver(e){return new aRe(this._resolver(e),this.id,this.stepTitle)}processor(e){return new cRe(this._processor(e),this.id)}};d();d();d();var fmt={id:0,start_offset:0,stop_offset:0,type:"ip_code_citations",details:{},citations:{snippet:`html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Canvas Example</title>
<`,url:"https://github.com/duonghle285/gnoud9x.github.io/tree/c95127bc5b7a491d9223f21ac3b8c5100996e754/26062020-vehinhchunhat%2Findex.html",ip_type:"LICENSE",license:"NOASSERTION"}},pmt="Alright, This response contains a code citation.";d();var mmt=`
# Should render

## Links
Links should render. However, if a user clicks on the link, it should open a confirmation dialog before navigating to the link. 

markdown:

[GitHub Copilot](https://copilot.github.com)

html:

<a href="https://copilot.github.com">GitHub Copilot</a>

## Images
The following images do come from one of these sources and should render:

- \`raw.githubusercontent.com/\`
- \`private-user-images.githubusercontent.com/\`
- \`avatars.githubusercontent.com\`
- \`gist.github.com/assets/\`


markdown:

![logo](https://avatars.githubusercontent.com/u/147005046?v=4)

html:

<img src="https://avatars.githubusercontent.com/u/147005046?v=4" alt="logo"/>

## Headers

markdown:

# Header 1
## Header 2
### Header 3
#### Header 4
##### Header 5
###### Header 6

html:

<h1>Header 1</h1>
<h2>Header 2</h2>
<h3>Header 3</h3>
<h4>Header 4</h4>
<h5>Header 5</h5>
<h6>Header 6</h6>

## Paragraphs

html:

<p>This is a paragraph.</p>

## Bold

markdown:

**bold text**

html:

<strong>bold text</strong>

## Italic

markdown:

_italic text_

html:

<i>italic text</i>

## Codeblock

markdown:

\`\`\`javascript
console.log('Hello, World!');
\`\`\`

html:

<code>console.log('Hello, World!');</code>

## Unordered List

markdown:

- item 1
- item 2
- item 3

html:

<ul>
  <li>item 1</li>
  <li>item 2</li>
  <li>item 3</li>
</ul>

## Ordered List

markdown:

1. item 1
2. item 2
3. item 3

html:

<ol>
  <li>item 1</li>
  <li>item 2</li>
  <li>item 3</li>
</ol>

## Table

markdown:

| Header 1 | Header 2 | Header 3 |
|----------|----------|----------|
| cell 1   | cell 2   | cell 3   |
| cell 4   | cell 5   | cell 6   |

html:

<table>
    <thead>
        <tr>
            <th>Header 1</th>
            <th>Header 2</th>
            <th>Header 3</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>cell 1</td>
            <td>cell 2</td>
            <td>cell 3</td>
        </tr>
        <tr>
            <td>cell 4</td>
            <td>cell 5</td>
            <td>cell 6</td>
        </tr>
    </tbody>
</table>

## Blockquote

markdown:

> This is a blockquote.

html:

<blockquote>This is a blockquote.</blockquote>


# Should not render

## html tags
Unsupported tags like \`<div>\` should not render but should be escaped. This code:

\`\`\`html
<div><ul><li>Foo</li></ul><img src="https://github.com/images/modules/site/copilot/productivity-bg-head.png" alt="productivity" width="20"/>
\`\`\`

should be rendered as:

\`\`\`html
<div>
* Foo
<img src="https://github.com/images/modules/site/copilot/productivity-bg-head.png" alt="productivity" width="20"/>
\`\`\`

code:

<div><ul><li>Foo</li></ul><img src="https://github.com/images/modules/site/copilot/productivity-bg-head.png" alt="productivity" width="20"/></div>

## images
The following images do *not* come from one of the trusted domains and should not render.

markdown:

![productivity](https://github.com/images/modules/site/copilot/productivity-bg-head.png)

html:

<img src="https://github.com/images/modules/site/copilot/productivity-bg-head.png" alt="productivity" width="100"/>

## Invisible characters

### Inline styles
Styled elements should not be rendered styled. This may trick the user to think elements are actually IDE controls

<p style="color: red;">This is an <span style="display: none;">harmfully</span> styled text!</p>

### html attributes
Only img src/alt and a href attributes should make it to the dom. 

The following paragraph should not render the \`id\` attribute in the dom.

<p id="foo">This is a paragraph with an id</p>
`;d();d();var gmt=Be(gm());var H1=class{constructor(e,r,n){this.doc=e;this.selection=r;this.visibleRange=n}static{s(this,"ElidableDocument")}fromSelectedCode(e){let r=this.getExpandedSelection(),n=r;if(e.trimNewLines){let o=this.doc.getText(r),a=o.match(/^\n*/)?.[0].length??0,c=o.match(/\n*$/)?.[0].length??0;n={start:this.getLineStart(r.start.line+a),end:this.expandLineToEnd(r.end.line-c)}}let i=new Ut([(0,gmt.default)(this.doc.getText(n)).trim()]);return[this.wrapInTicks(i),n]}fromAllCode(e){let r=this.getDocumentRange(),n=this.getExpandedSelection(),i;!this.visibleRange||!this.rangeContainedIn(this.visibleRange,n)?i=n:i={start:this.getLineStart(this.visibleRange.start.line),end:this.expandLineToEnd(this.visibleRange.end.line)};let o={start:r.start,end:i.start.line>0?this.expandLineToEnd(i.start.line-1):r.start},a={start:i.start,end:n.start.line>0&&n.start.line>i.start.line?this.expandLineToEnd(n.start.line-1):i.start},c={start:n.end.line<this.doc.lineCount-1&&n.end.line<i.end.line?this.getLineStart(n.end.line+1):i.end,end:i.end},l={start:i.end.line<this.doc.lineCount-1?this.getLineStart(i.end.line+1):r.end,end:r.end},u=[[o,.6],[a,.8],[n,1],[c,.4],[l,.2]],f=new Ut(u.filter(([p,m])=>!cM(p)||m===1).map(([p,m])=>{let h;return e.addLineNumbers?h=this.addLineNumbers(p):h=this.doc.getText(p),[m==1?h:q0(h),m]}));return this.wrapInTicks(f)}selectionIsDocument(){return this.rangeEquals(this.getExpandedSelection(),this.getDocumentRange())}selectionIsEmpty(){return this.selection==null||cM(this.selection)}getExpandedSelection(){return this.selection!==void 0?{start:this.getLineStart(this.selection.start.line),end:this.expandLineToEnd(this.selection.end.line)}:this.getDocumentRange()}getDocumentRange(){return{start:this.getLineStart(0),end:this.expandLineToEnd(this.doc.lineCount-1)}}getLineStart(e){return{line:e,character:0}}expandLineToEnd(e){return e>this.doc.lineCount-1&&(e=this.doc.lineCount-1),{line:e,character:this.doc.lineAt({line:e,character:0}).text.length}}rangeContainedIn(e,r){return e.start.line<=r.start.line&&e.end.line>=r.end.line}rangeEquals(e,r){return e.start.line==r.start.line&&e.end.line==r.end.line}wrapInTicks(e,r){return new Ut([["```"+this.doc.detectedLanguageId,1],[e,r??1],["```",1]])}addLineNumbers(e){let r=this.doc.getText(e).split(`
`),n=this.doc.lineCount.toString().length;return r.map((o,a)=>`${(e.start.line+a+1).toString().padEnd(n," ")}:${o}`).join(`
`)}};function cM(t){return t.start.line==t.end.line&&t.start.character==t.end.character}s(cM,"isEmptyRange");var Amt=Be(require("path"));var ymt=x.Object({uri:x.String(),visibleRange:x.Optional(Uc),selection:x.Optional(Uc)}),lRe=class{constructor(e){this.turnContext=e}static{s(this,"CurrentEditorSkillProcessor")}value(){return 1}async processSkill(e){let r=this.turnContext.ctx.get(En),n=await r.getOrReadTextDocument(e),i=ca(n);if(await this.turnContext.collectFile(ef,e.uri,i),n.status==="valid"){let o=this.turnContext.conversation.source==="inline",a=new H1(n.document,e.selection,e.visibleRange),c=r.getRelativePath(n.document);if(i==="empty")return new Ut([`The currently open file \`${c}\` is empty.`]);let l=[[`Code excerpt from the currently open file \`${c}\`:`,1],[a.fromAllCode({addLineNumbers:o}),1]],u=[];if(a.selectionIsDocument())u=[["The user is selecting the entire file.",1]];else if(o){let[f,p]=a.fromSelectedCode({trimNewLines:!0}),m=p.start.line+1;if(cM(p))u=[[`The user is selecting line ${m}, which is empty.`,1]];else{let h=p.end.line+1;u=[["The user is selecting"+(m==h?` line ${m}:`:` lines ${m} to ${h} (inclusive):`),1],[f,1]]}}else a.selectionIsEmpty()||(u=[["The user is selecting this code:",1],[a.fromSelectedCode({trimNewLines:!1})[0],1]]);return new Ut([...l,...u])}else if(n.status==="invalid")return new Ut([`The currently open file \`${Amt.basename(e.uri)}\` is content excluded.`])}},ef="current-editor",wse=class{constructor(e){this._resolver=e;this.id=ef;this.type="explicit"}static{s(this,"CurrentEditorSkill")}description(){return"The code from the user's currently open file"}resolver(){return this._resolver}processor(e){return new lRe(e)}};d();d();var Cmt=Be(require("fs")),qf=Be(require("path"));var uRe=[".test",".spec","_test","Test","_spec","_test","Tests",".Tests","Spec"],dRe="test_",Dq={js:{suffix:[".test",".spec"],location:"sameFolder"},ts:{suffix:[".test",".spec"],location:"sameFolder"},go:{suffix:["_test"],location:"sameFolder"},java:{suffix:["Test"],location:"testFolder"},php:{suffix:["Test"],location:"testFolder"},dart:{suffix:["_test"],location:"testFolder"},cs:{suffix:["Test"],location:"testFolder"},rb:{suffix:["_test","_spec"],location:"testFolder"},py:{prefix:"test_",location:"testFolder"},ps1:{suffix:[".Tests"],location:"testFolder"},kt:{suffix:["Test"],location:"testFolder"}},Bq=class{constructor(e,r,n=void 0){this.ctx=e;this.fileExists=r;this.baseUri=n}static{s(this,"TestFileFinder")}async findTestFileForSourceFile(e){let r=Pi(e),n=qf.extname(r).replace(".",""),i=Dq[n]??{location:"sameFolder",prefix:dRe,suffix:uRe},o=[];if(i.prefix&&o.push(i.prefix+r),i.suffix)for(let u of i.suffix??[]){let f=r.replace(`.${n}`,u+"."+n);o.push(f)}let a=i.location??"sameFolder",c;if(a==="sameFolder"){if(c=ts(wd(e)),c===void 0)return}else{let u=ts(e);if(u===void 0)return;c=this.determineTestFolder(u,a)}for(let u of o){let f=qf.join(c,u),p=this.parseTestFilePath(f);if(p&&await this.fileExists(p))return p}let l=kl(c);if(await this.fileExists(l))return Vi(l,o[0])}parseTestFilePath(e){try{return kl(e)}catch(r){dn.error(this.ctx,`Failed to parse test file path: ${e}`,r);return}}async findImplFileForTestFile(e){let r=Pi(e),n=qf.extname(r).replace(".",""),i=Dq[n]??{location:"sameFolder",prefix:dRe,suffix:uRe},o=[];if(i.prefix&&o.push(r.substring(i.prefix.length)),i.suffix)for(let l of i.suffix??[]){let f=r.substring(0,r.length-l.length-1-n.length)+"."+n;o.push(f)}let a=i.location??"sameFolder",c;a==="sameFolder"?c=wd(e):c=this.determineImplFolder(e);for(let l of o){let u=Vi(c,l);if(await this.fileExists(u))return u}}findExampleTestFile(e){let r=ts(e);if(r===void 0)return;let n=qf.extname(Pi(e)).replace(".",""),i,o=Dq[n]?.location??"sameFolder";o==="sameFolder"?i=qf.dirname(r):i=this.determineTestFolder(r,o);let a=this.findFiles(i,`.${n}`,Dq[n]);if(a.length>0)return kl(a[0])}findFiles(e,r,n){let i=this._readdir(e),o=[];for(let a of i){let c=`${e}${qf.sep}${a}`;n?.prefix&&a.startsWith(n.prefix)&&o.push(c),n?.suffix&&n?.suffix.some(l=>a.endsWith(l+r))&&o.push(c)}return o}_readdir(e){return Cmt.readdirSync(e,{withFileTypes:!0}).filter(r=>r.isFile()).map(r=>r.name)}determineTestFolder(e,r){let n=(this.baseUri&&ts(this.baseUri))??"",i=qf.extname(e).replace(".",""),o=this.getRelativeTestFolder(e,n,i,r);return[n,...o].filter(a=>a).join(qf.sep)}getRelativeTestFolder(e,r,n,i){let o=qf.dirname(e).replace(r,"");switch(n){case"php":case"dart":case"py":return["tests"];case"ps1":return["Tests"];case"rb":return["test",o];case"cs":return[o.replace("src","src/tests")];case"java":case"scala":case"kt":return[o.replace(/src[\\/]main/,"src/test")];default:return i==="testFolder"?[o.replace("src","test")]:[o]}}determineImplFolder(e){let r=qf.extname(Pi(e)).replace(".",""),n=wd(e);switch(r){case"php":case"dart":case"py":return n.replace("tests","src");case"ps1":return n.replace("Tests","src");case"rb":return n.replace("/test","");case"cs":return n.replace("src/tests","src");case"java":case"scala":case"kt":return n.replace("src/test","src/main");default:return n.replace("test/","src/")}}};function Nq(t){let e=Pi(t),r=qf.extname(e),n=Dq[r.replace(".","")];return n?!(n.suffix&&!n.suffix.some(o=>e.endsWith(o+r))||n.prefix&&!e.startsWith(n.prefix)):!!(uRe.some(o=>e.endsWith(o+r))||e.startsWith(dRe))}s(Nq,"isTestFile");d();var vmt=["indexed","indexing","not_indexed"],hS=class{constructor(){this._cache=new Sr(100)}static{s(this,"BlackbirdIndexingStatus")}async queryIndexingStatus(e,r,n){let i=e.ctx;if(!n)return!1;let o=`repos/${r}/copilot_internal/embeddings_index`,a=await Qm(i,n,o);return a.ok?(await a.json()).semantic_code_search_ok:!1}isValid(e){return e!==void 0&&Date.now()-e.timestamp<1800*1e3}async isRepoIndexed(e,r,n,i=!1){let o=Ax(r);if(!o)return!1;let a=this._cache.get(o);if(!i&&this.isValid(a))return a.status;let c=await this.queryIndexingStatus(e,o,n);return this._cache.set(o,{status:c,timestamp:Date.now()}),c}get cache(){return this._cache}};d();d();var Sse=Be(yI()),$1=Be(require("fs")),xmt=require("os"),dg=Be(require("path")),lM=require("process");var fRe=5e4,DAr=new dt("workspaceChunks"),_se=class t{constructor(e,r){this.ctx=e;this.pathHashLength=8;this.chunksCountCache=new Map;let n=Pi(r.uri),i=(0,Sse.SHA256)(r.uri).toString().substring(0,this.pathHashLength);this.cacheRootPath=dg.join(BAr(),"project-context",`${n}.${i}`)}static{s(this,"WorkspaceChunks")}static{this.CACHE_VERSION="1.0.0"}getChunksCacheFile(e){let r=(0,Sse.SHA256)(e).toString().substring(0,this.pathHashLength),n=dg.basename(e);return dg.join(this.cacheRootPath,`${n}.${r}.json`)}async getChunksCacheFromCacheFile(e){let r=await $1.promises.readFile(e,{encoding:"utf8"}).catch(()=>{});if(r)try{return JSON.parse(r)}catch{}}async getChunksCache(e){let r=this.getChunksCacheFile(e);return await this.getChunksCacheFromCacheFile(r)}async setChunksCache(e,r){let n=this.getChunksCacheFile(e);try{await $1.promises.mkdir(dg.dirname(n),{recursive:!0}),await $1.promises.writeFile(n,JSON.stringify(r),{encoding:"utf8"})}catch(i){DAr.debug(this.ctx,"Failed to set chunks cache:",i)}}async removeChunksCache(e){let r=this.getChunksCacheFile(e);await $1.promises.rm(r).catch(()=>{})}async enumerateChunksCacheFileNames(){return await $1.promises.readdir(this.cacheRootPath).catch(()=>[])}async getFilesCount(){return(await this.enumerateChunksCacheFileNames()).length}async getChunksCount(){let e=0;for(let r of await this.enumerateChunksCacheFileNames()){let n=dg.join(this.cacheRootPath,r);if(!this.chunksCountCache.has(n)){let i=await this.getChunksCacheFromCacheFile(n);this.chunksCountCache.set(n,i?.documentChunks?.length??0)}e+=this.chunksCountCache.get(n)||0}return e}async*getChunksForFile({uri:e}){let r=await this.getChunksCache(e);r!==void 0&&(yield*r.documentChunks)}async*getChunksFromCacheFile(e){let r=await this.getChunksCacheFromCacheFile(e);yield*r?r.documentChunks:[]}async*getChunks(e){if(e!==void 0)yield*this.getChunksForFile(e);else{let r=await this.enumerateChunksCacheFileNames();for(let n of r)yield*this.getChunksFromCacheFile(dg.join(this.cacheRootPath,n))}}async getFileHash(e){let r=ts(e),n="";return r&&(n=await $1.promises.readFile(r,{encoding:"utf8"}).catch(()=>"")),(0,Sse.SHA256)(n).toString()}async addChunks({uri:e},r){let n=Array.isArray(r)?()=>Promise.resolve(r):r,i=ts(e);if(!i)return;async function o(p){try{return(await $1.promises.stat(p)).mtimeMs}catch{return}}s(o,"getLastModified");let a=await o(i),c=await this.getChunksCache(e);if(c!==void 0&&c.version===t.CACHE_VERSION&&a!==void 0&&c.lastModified===a){this.chunksCountCache.set(i,c.documentChunks.length);return}let l=await this.getFileHash(e),u=await n();this.chunksCountCache.set(i,u.length);let f={version:t.CACHE_VERSION,filePath:e,hash:l,lastModified:a,documentChunks:u};await this.setChunksCache(e,f)}async deleteChunksForSource(e){let r=kl(e),n=await this.getChunksCache(r);return n===void 0?[]:(await this.removeChunksCache(r),n.documentChunks)}async deleteChunks({uri:e}){let r=ts(e);if(!r)return[];let n;try{n=await $1.promises.readdir(r)}catch{return await this.deleteChunksForSource(r)}let i=[];for(let o of n){let a=kl(dg.join(r,o));i.push(...await this.deleteChunks({uri:a}))}return i}async clear(){await $1.promises.rm(this.cacheRootPath,{recursive:!0}).catch(()=>{})}};function BAr(){return lM.env.XDG_CACHE_HOME&&dg.isAbsolute(lM.env.XDG_CACHE_HOME)?lM.env.XDG_CACHE_HOME+"/github-copilot":(0,xmt.platform)()==="win32"?lM.env.USERPROFILE+"\\AppData\\Local\\Temp\\github-copilot":lM.env.HOME+"/.cache/github-copilot"}s(BAr,"getXdgCachePath");var pRe=1e4;var Rse=class{constructor(e,r,n){this.workspaceFolder=r;this.implementation=n;this._chunkLimiter=new hRe;this.status="notStarted",this.workspaceChunks=new _se(e,r),this.cancellationToken=new mRe,this._chunkingTimeMs=0,this._fileCountExceeded=!1,this._chunkCountExceeded=!1,this._totalFileCount=0,this._filesUpdated=new Set}static{s(this,"ChunkingHandler")}async chunk(e,r){return r?await this.chunkFiles(e,r):await this.chunkWorkspace(e)}async chunkWorkspace(e){let r=performance.now();if(this.status="started",this.cancellationToken.isCancelled())return this.status="cancelled",this.updateChunkingTime(r,performance.now()),this.workspaceChunks.getChunks();await this.updateModelConfig(e);let n=await e.get(Jd).getWatchedFiles(this.workspaceFolder);this._totalFileCount=n.length,n.length>pRe&&(this._fileCountExceeded=!0,n=n.slice(0,pRe));let i=n.map(async o=>{this.cancellationToken.isCancelled()||await this._chunkLimiter.queue(()=>this._chunk(e,o))});try{await Promise.all(i)}catch(o){Ka(e,o,"ChunkingProvider.chunk"),this.terminateChunking()}return this.status=this.cancellationToken.isCancelled()?"cancelled":"completed",this.updateChunkingTime(r,performance.now()),await this.workspaceChunks.getChunksCount()>fRe&&(this._chunkCountExceeded=!0),this.workspaceChunks.getChunks()}async chunkFiles(e,r){await this.updateModelConfig(e);let n=r.map(async i=>{this.cancellationToken.isCancelled()||(this._filesUpdated.add(i.uri),await this._chunkLimiter.queue(()=>this._chunk(e,i)))});try{await Promise.all(n)}catch(i){Ka(e,i,"ChunkingProvider.chunkFiles"),this.terminateChunking()}return await this.workspaceChunks.getChunksCount()>fRe&&(this._chunkCountExceeded=!0),await this.workspaceChunks.getFilesCount()>pRe&&(this._fileCountExceeded=!0),UYe(...r.map(i=>this.workspaceChunks.getChunks(i)))}async _chunk(e,r){this.cancellationToken.isCancelled()||await this.workspaceChunks.addChunks(r,()=>this.implementation.chunk(r,this.modelConfig))}async updateModelConfig(e){this.modelConfig||(this.modelConfig=await Wo.getModelConfiguration(e,"user"))}terminateChunking(){this.cancellationToken.cancel()}async clearChunks(){await this.workspaceChunks.clear()}updateChunkingTime(e,r){this._chunkingTimeMs=r-e}get chunkingTimeMs(){return Math.floor(this._chunkingTimeMs)}get fileCountExceeded(){return this._fileCountExceeded}get totalFileCount(){return this._totalFileCount}get chunkCountExceeded(){return this._chunkCountExceeded}get filesUpdatedCount(){return this._filesUpdated.size}async getFilesCount(){return this.workspaceChunks.getFilesCount()}getChunks(){return this.workspaceChunks.getChunks()}async getChunksCount(){return this.workspaceChunks.getChunksCount()}deleteSubfolderChunks(e){return this.workspaceChunks.deleteChunks({uri:e})}deleteFileChunks(e){return this._filesUpdated.add(e),this.workspaceChunks.deleteChunks({uri:e})}},mRe=class{constructor(){this.cancelled=!1}static{s(this,"ChunkingCancellationToken")}cancel(){this.cancelled=!0}isCancelled(){return this.cancelled}},hRe=class{constructor(e=20){this.maxCount=e;this.tasks=[];this.runningTasks=0}static{s(this,"Limiter")}async queue(e){return new Promise((r,n)=>{this.tasks.push({factory:e,resolve:r,reject:n}),this.consume()})}consume(){for(;this.tasks.length>0&&this.runningTasks<=this.maxCount;){let{factory:e,resolve:r,reject:n}=this.tasks.shift();this.runningTasks++;let i=e();i.then(r,n),i.then(()=>this.consumed(),()=>this.consumed())}}consumed(){this.runningTasks--,this.consume()}};d();d();d();var Rmt=Be(Dse()),CRe=Be(require("path"));var kmt=500,$Ar=Math.floor(.25*kmt),Bse=class{static{s(this,"FixedSizeChunking")}async chunk(e,r){let n=[],i=CRe.default.extname(__filename)===".ts"?CRe.default.resolve(__dirname,"../../../../../../dist/main.js"):__filename;return n=await Rmt.job(async({text:o,uri:a,tokenizerName:c,directory:l,chunkSize:u,overlap:f})=>{let m=await require(l).getTokenizerAsync(c),h=m.tokenize(o),g=h.length,A=[],y=0;for(;y<g;){let E=y+u>=g,b=E?g:y+u,S=h.slice(y,b),R=m.detokenize(S),B=o.indexOf(R);A.push({id:`${a.toString()}#${y}`,chunk:R,tokenCount:S.length,range:{start:B,end:B+R.length}}),y=E?b:b-f}return A},{data:{text:e.getText(),uri:e.uri.toString(),tokenizerName:r.tokenizer,directory:i,chunkSize:kmt,overlap:$Ar}}),n}};var WAr="fixedSize",jAr=new Map([["fixedSize",Bse]]);function Pmt(t){let e=t==="default"?WAr:t,r=jAr.get(e);if(!r)throw new Error(`Chunking constructor for type ${t} not found`);return r}s(Pmt,"getChunkingAlgorithm");var Ec=class{constructor(e){this.ctx=e;this.workspaceChunkingProviders=new Map}static{s(this,"ChunkingProvider")}get workspaceCount(){return this.workspaceChunkingProviders.size}createImplementation(e,r){let n=Pmt(r),i=new n;return new Rse(this.ctx,e,i)}getImplementation(e,r="default"){let n=this.getParentFolder(e);if(n)return this.workspaceChunkingProviders.get(n.uri);let i=this.workspaceChunkingProviders.get(e.uri);return i||(i=this.createImplementation(e,r),this.workspaceChunkingProviders.set(e.uri,i)),i}getParentFolder(e){let r=[];for(let n of this.workspaceChunkingProviders.values())r.push(n.workspaceFolder);return r.find(n=>{let i=n.uri.replace(/[#?].*/,"").replace(/\/?$/,"/");return e.uri!==n.uri&&e.uri.startsWith(i)})}status(e){return this.getImplementation(e).status}checkLimits(e){let r=this.getImplementation(e);return{fileCountExceeded:r.fileCountExceeded,chunkCountExceeded:r.chunkCountExceeded}}fileCount(e){return this.getImplementation(e).getFilesCount()}chunkCount(e){return this.getImplementation(e).getChunksCount()}chunkingTimeMs(e){return this.getImplementation(e).chunkingTimeMs}getChunks(e){return this.getImplementation(e).getChunks()}terminateChunking(e,r){let n=this.getImplementation(r);n.terminateChunking();let o=Vr.createAndMarkAsIssued().extendedBy(void 0,{fileCount:n.filesUpdatedCount});Bt(e,"index.terminate",o),this.workspaceChunkingProviders.delete(r.uri)}async clearChunks(e,r){this.terminateChunking(e,r),await this.getImplementation(r).clearChunks()}async deleteSubfolderChunks(e,r){return await this.getImplementation(e).deleteSubfolderChunks(r.uri)}async deleteFileChunks(e,r){let n=this.getImplementation(e),i=[];Array.isArray(r)||(r=[r]);for(let o of r)i.push(...await n.deleteFileChunks(o));return i}async chunk(e,r,n,i){let o;return n&&(Array.isArray(n)?o=n:i=n),i||(i="default"),o?await this.chunkFiles(e,r,o,i):await this.chunkFolder(e,r,i)}async chunkFolder(e,r,n="default"){let i=this.getImplementation(r,n),o=await i.chunk(e),c=Vr.createAndMarkAsIssued().extendedBy(void 0,{fileCount:i.totalFileCount,chunkCount:await i.getChunksCount(),timeTakenMs:i.chunkingTimeMs,workspaceCount:this.workspaceCount});return Bt(e,"index.chunk",c),o}async chunkFiles(e,r,n,i="default"){return await this.getImplementation(r,i).chunk(e,n)}};d();d();d();async function Dmt(t,e,r,n){let i=Li(e.tokenizer),o=r.filter(p=>i.tokenLength(p.text)<e.maxTokens);if(o.length===0)return;let a=[],c=await t.get(ar).getToken(),l=VK(t,c,"embeddings"),u=c.token,f=0;for(;f<o.length&&!n.isCancellationRequested;){let p=o.slice(f,f+e.maxBatchSize),m=await GAr(t,l,u,e.modelId,p,n);a.push(...m||[]),f+=e.maxBatchSize}return a.length?a:void 0}s(Dmt,"fetchEmbeddings");async function GAr(t,e,r,n,i,o){let a=br(),c=i.map(f=>f.text),l=dh(t);Pv()&&(l=await BB(t,l));let u=await Cx(t,e,r,void 0,a,{input:c,model:n,dimensions:1024},o,l);if(u.status!==200||o.isCancellationRequested){Ka(t,new PE(`Failed to request dense embeddings, status: ${u.status}`),"LocalSnippetProvider.fetchEmbeddings");return}try{return(await u.json()).data.map(p=>({id:i[p.index].id,embedding:p.embedding}))}catch{return}}s(GAr,"sendEmbeddingsRequest");d();d();var Nse=class{static{s(this,"CosineSimilarityScoring")}score(e,r){let n=Math.sqrt(e.reduce((a,c)=>a+c*c,0)),i=Math.sqrt(r.reduce((a,c)=>a+c*c,0));return e.reduce((a,c,l)=>a+c*r[l],0)/(n*i)}terminateScoring(){}};var VAr="cosine",zAr=new Map([["cosine",Nse]]);function Bmt(t){let e=t==="default"?VAr:t,r=zAr.get(e);if(!r)throw new Error(`Scoring constructor for type ${t} not found`);return r}s(Bmt,"getScoringAlgorithm");d();var Am=class{constructor(){this.workspaceScoringProviders=new Sr(25)}static{s(this,"ScoringProvider")}createImplementation(e,r){let n=Bmt(r);return new n}getImplementation(e,r,n="default"){let i=this.workspaceScoringProviders.get(r.uri);return i||(i=this.createImplementation(e,n),this.workspaceScoringProviders.set(r.uri,i)),i}score(e,r,n,i,o){return this.getImplementation(e,r,o).score(n,i)}terminateScoring(e,r,n){this.getImplementation(e,r,n).terminateScoring(),this.workspaceScoringProviders.delete(r.uri)}};var Nmt={modelFamily:YK.textEmbedding3Small,scoringType:"default",dimensions:null};async function Mmt(t,e,r,n,i,o,a,c=Nmt){let l={...Nmt,...c},u=YAr(t,e,r,n);_r.debug(t,`EmbeddingsReranker: Reranking ${u.length} snippets (includes the user query)`);let f=await t.get(ha).getFirstMatchingEmbeddingModelConfiguration(l.modelFamily);if(f===void 0)throw new Error(`EmbeddingsReranker: Model configuration not found for ${l.modelFamily}`);let p=performance.now(),m=await Dmt(t,f,u,o),h=performance.now();if(a.embeddingsTimeMs=Math.floor(h-p),m===void 0||m.length===0)return[];let g=m.findIndex(B=>B.id==="userQuery");if(g===void 0)return[];let A=m.splice(g,1)[0];if(o.isCancellationRequested)return[];let y=performance.now(),E=JAr(t,e,m,A,l.scoringType),b=performance.now();a.rerankingTimeMs=Math.floor(b-y);let S=E.slice(0,i);return _r.debug(t,`EmbeddingsReranker: Returning ${S.length} snippets`),S.map(B=>u.find(L=>L.id===B.id).id)}s(Mmt,"rerankSnippets");function YAr(t,e,r,n){let i=n.map(o=>({id:o.id,text:o.chunk.toLowerCase()}));return i.push({id:"userQuery",text:r.toLowerCase()}),i}s(YAr,"formatEmbeddingsInput");function JAr(t,e,r,n,i){let o=t.get(Am);return r.map(c=>({id:c.id,score:o.score(t,e,n.embedding,c.embedding,i)})).sort((c,l)=>l.score-c.score)}s(JAr,"scoreEmbeddings");d();d();d();var xRe=Be(Dse());var XAr=.75,ZAr=1.2,eyr=47,Mse=class{constructor(e,r){this.ctx=e;this.workspaceFolder=r;this.chunksCount=0;this.sumTokenCount=0;this.status="notStarted"}static{s(this,"BM25Ranking")}get avgTokenCount(){return this.sumTokenCount/this.chunksCount}async initialize(e){this.sumTokenCount=0,this.chunksCount=0;for await(let r of e)this.sumTokenCount+=r.tokenCount,this.chunksCount++;this.status="completed"}async addChunks(e){for await(let r of e)this.sumTokenCount+=r.tokenCount,this.chunksCount++}async query(e){let r=await Lse();try{return await this.doQuery(e)}finally{await r.stopWorkerPool()}}async doQuery(e){let r=e.map(c=>c.toLowerCase()),n=await this.calculateIDFValues(r),i=Math.min(10*e.length,eyr),o=Math.min(i,this.chunksCount);return await this.calculateBM25Scores(r,this.avgTokenCount,n,o)}async calculateIDFValues(e){let r=this.ctx.get(Ec).getChunks(this.workspaceFolder),n=_x(r,o=>({...o,chunk:o.chunk.toLowerCase()})),i=_x(n,o=>o.chunk);return await tyr(e,i)}async calculateBM25Scores(e,r,n,i){let o=this.ctx.get(Ec).getChunks(this.workspaceFolder),a=new vRe(i);for await(let c of o){let l=await ryr({...c,chunk:c.chunk.toLowerCase()},e,r,n);a.add({...l,chunk:c.chunk})}return a.toArray(.75)}deleteEmbeddings(e){this.chunksCount-=e.length,this.sumTokenCount-=e.reduce((r,n)=>r+n.tokenCount,0)}terminateRanking(){}};async function tyr(t,e){let r=new SharedArrayBuffer(t.length*Int32Array.BYTES_PER_ELEMENT),n=new Int32Array(r),i=[],o=0;for await(let l of e){o++;let u=xRe.job(({snippet:f,keywords:p})=>p.map(h=>f.includes(h)?1:0),{data:{snippet:l,keywords:t}}).then(f=>{for(let p=0;p<t.length;p++)Atomics.add(n,p,f[p])});i.push(u)}await Promise.all(i);let a=new Int32Array(r),c={};for(let l=0;l<t.length;l++)c[t[l]]=Math.log((o-a[l]+.5)/(a[l]+.5)+1);return c}s(tyr,"calculateIDFValues");async function ryr(t,e,r,n){return{score:await xRe.job(({keywords:o,document:a,docLength:c,avgTokenCount:l,idfValues:u,k1:f,b:p})=>{let m=0;for(let h of o){let g=u[h],A=(a.match(new RegExp(h,"g"))||[]).length,y=g*(A*(f+1)),E=A+f*(1-p+p*c/l);m+=y/E}return m},{data:{document:t.chunk,docLength:t.tokenCount,keywords:e,avgTokenCount:r,idfValues:n,k1:ZAr,b:XAr}}),...t}}s(ryr,"calculateBM25Score");var vRe=class{constructor(e,r=-1/0){this.maxSize=e;this.minScore=r;this.store=[]}static{s(this,"SimpleHeap")}toArray(e){if(this.store.length&&typeof e=="number"){let r=this.store.at(0).score*(1-e);return this.store.filter(n=>n.score>=r)}return this.store}add(e){if(e.score<=this.minScore)return;let r=this.store.findIndex(n=>n.score<e.score);for(this.store.splice(r>=0?r:this.store.length,0,e);this.store.length>this.maxSize;)this.store.pop();this.store.length===this.maxSize&&(this.minScore=this.store.at(-1)?.score??this.minScore)}};var iyr="bm25",oyr=new Map([["bm25",Mse]]);function Lmt(t){let e=t==="default"?iyr:t,r=oyr.get(e);if(!r)throw new Error(`Ranking constructor for type ${t} not found`);return r}s(Lmt,"getRankingAlgorithm");var fd=class{constructor(){this.workspaceRankingProviders=new Sr(25)}static{s(this,"RankingProvider")}createImplementation(e,r,n){let i=Lmt(n);return new i(e,r)}getImplementation(e,r,n="default"){let i=this.workspaceRankingProviders.get(r.uri);return i||(i=this.createImplementation(e,r,n),this.workspaceRankingProviders.set(r.uri,i)),i}status(e,r,n){return this.getImplementation(e,r,n).status}async initialize(e,r,n,i="default"){await this.getImplementation(e,r,i).initialize(n)}async addChunks(e,r,n,i="default"){await this.getImplementation(e,r,i).addChunks(n)}async query(e,r,n,i){return this.getImplementation(e,r,i).query(n)}async terminateRanking(e,r,n){await this.getImplementation(e,r,n).terminateRanking(),this.workspaceRankingProviders.delete(r.uri)}deleteEmbeddings(e,r,n,i){return this.getImplementation(e,r,i).deleteEmbeddings(n)}};d();async function Fmt(t,e){let r=t.ctx,n=await Wo.getModelConfiguration(r,"synonyms",void 0,{tool_calls:!0}),i={promptType:"synonyms",modelConfiguration:n},o=await r.get(pd).toPrompt(t,i);if(!o.toolConfig)return;let a={modelConfiguration:n,uiKind:"conversationPanel",messages:o.messages,tools:o.toolConfig?.tools,tool_choice:o.toolConfig?.tool_choice,llmInteraction:t.toLlmInteraction()},c=new Ps(r),l=await Za(r,t),u=await c.fetchResponse(a,e,l.extendedBy({messageSource:"chat.synonyms"}));if(u.type==="success"&&u.toolCalls&&u.toolCalls.length>0){let f=u.toolCalls[0],p=o.toolConfig?.extractArguments(f).keywords;return!p||!Array.isArray(p)?void 0:(_r.debug(r,`UserQueryParser: Parsed ${p.length} keywords from the original user query: ${p.join(", ")}`),p.length?p:void 0)}else{let f="reason"in u?u.reason:"";Ka(r,new PE(`Failed to request user query synonyms, result type: ${u.type}, reason: ${f}`),"LocalSnippetProvider.parseUserQuery")}}s(Fmt,"parseUserQuery");var Omt=Be(gm());var PE=class extends Error{static{s(this,"LocalSnippetProviderError")}constructor(e){super(String(e),{cause:e}),this.name="LocalSnippetProviderError"}},Fse=class{constructor(){this.providerType="local"}static{s(this,"LocalSnippetProvider")}snippetProviderStatus(e,r){if(!e.turn.workspaceFolder)return Promise.resolve("not_indexed");r===void 0&&(r=!0);let n=e.ctx,i=n.get(Ec),o=i.status(e.turn.workspaceFolder),a=n.get(fd),c=a.status(n,e.turn.workspaceFolder);if(o==="completed"&&c==="completed")return Promise.resolve("indexed");if(o==="started"||c==="started")return Promise.resolve("indexing");if(r){let l=e.turn.workspaceFolder;if(o==="notStarted")return Promise.race([i.chunk(n,l).then(u=>{if(i.status(l)==="completed")return a.initialize(n,l,u)}).then(()=>this.snippetProviderStatus(e,!1)),new Promise(u=>setTimeout(()=>u("not_indexed"),1e3))]);if(c==="notStarted"){let u=i.getChunks(l);return Promise.race([a.initialize(n,l,u).then(()=>this.snippetProviderStatus(e,!1)),new Promise(f=>setTimeout(()=>f("not_indexed"),1e3))])}}return Promise.resolve("not_indexed")}async collectLocalSnippets(e,r){let n=e.turn.workspaceFolder;if(!n)return[];let i=e.ctx,a=await i.get(Ec).chunkCount(n);if(a===0)return[];r.chunkCount=a;let c,l=performance.now();try{c=await Fmt(e,e.cancelationToken)}catch(g){let A=new PE(g);Ka(i,A,"LocalSnippetProvider.parseUserQuery")}let u=performance.now();if(r.synonymTimeMs=Math.floor(u-l),c===void 0)return[];let f=i.get(fd),p=[],m=performance.now();try{let g=await f.query(i,n,c);r.localSnippetCount=g.length,p=g}catch(g){let A=new PE(g);Ka(i,A,"LocalSnippetProvider.rankingQuery")}let h=performance.now();return r.rankingTimeMs=Math.floor(h-m),p}async rerankLocalSnippets(e,r,n){let i=e.turn.workspaceFolder;if(!i)return[];let o=e.ctx,a=en(e.turn.request.message),c=[];try{c=await Mmt(o,i,a,r,5,e.cancelationToken,n)}catch(f){let p=new PE(f);Ka(o,p,"LocalSnippetProvider.rerankSnippets")}let l=[],u=o.get(En);for(let f of c){let p=f.split("#")[0],m=await u.getOrReadTextDocument({uri:p}),h=r.find(g=>g.id===f);if(m.status==="valid"){let g=m.document.positionAt(h.range.start),A=m.document.positionAt(h.range.end),y=Es.range(g,A);l.push({uri:m.document.uri,range:y,snippet:h.chunk})}}return l}async provideSnippets(e){let r=this.collectInfoMessage(e);r&&await e.info(r);let n={...jYe},i=await this.collectLocalSnippets(e,n);if(i.length===0)return{snippets:[],measurements:n};let o=e.ctx;return _r.debug(o,`LocalSnippetProvider: First pass: Found ${i.length} snippets.`),{snippets:await this.rerankLocalSnippets(e,i,n),measurements:n}}collectInfoMessage(e){let r=e.turn.workspaceFolder;if(!r)return;let o=e.ctx.get(Ec).checkLimits(r);if(o.fileCountExceeded||o.chunkCountExceeded)return Omt.default`
Copilot has partially indexed this project as it exceeds the file limit. As a result, responses may have incomplete context. Consider excluding large, less relevant files or folders (e.g., large CSV files) to improve accuracy.
`}};var Umt=Be(Qmt()),Use=Be(Dse()),qmt=Be(require("os")),Hmt=Be(gm());var cyr=Math.min(Math.max(Math.ceil(qmt.cpus().length/2),1),10),Lq=class t{constructor(){this.isActive=!0}static{s(this,"WorkerPoolToken")}static{this.workerPoolStarted=!1}static{this.activeProcessCount=0}static{this.allTokens=[]}static{this.lock=new Umt.default}static async startWorkerPool(){await t.lock.acquireAsync();try{t.workerPoolStarted||(t.workerPoolStarted=!0,await Use.start({maxWorkers:cyr})),t.activeProcessCount++;let e=new t;return t.allTokens.push(e),e}finally{t.lock.release()}}async stopWorkerPool(){if(this.isActive){await t.lock.acquireAsync();try{this.isActive&&(this.isActive=!1,t.activeProcessCount--,t.activeProcessCount==0&&(await Use.stop(),t.workerPoolStarted=!1),t.allTokens.includes(this)&&t.allTokens.splice(t.allTokens.indexOf(this),1))}finally{t.lock.release()}}}static async forceStopWorkerPool(){let e=t.allTokens[Symbol.iterator]();for(let r of e)await r.stopWorkerPool();t.workerPoolStarted=!1,t.activeProcessCount=0}},Lse=Lq.startWorkerPool.bind(Lq);var YKi=x.Object({uri:x.String(),snippet:x.String(),range:x.Object({start:x.Object({line:x.Number(),character:x.Number()}),end:x.Object({line:x.Number(),character:x.Number()})})}),IRe=class{constructor(e){this.turnContext=e}static{s(this,"ProjectContextSkillProcessor")}value(){return 1}async processSkill(e){if(this.turnContext.cancelationToken.isCancellationRequested){await this.turnContext.steps.cancel(uM);return}let r=[],n=this.turnContext.ctx.get(En),i=this.removeDuplicateSnippets(e);for(let o of i){let{uri:a,snippet:c,range:l}=o,u=await n.getOrReadTextDocument(o);if(u.status==="valid"){let f=new H1(u.document,l,l),p=new Ut([c]),h=Nq(a)?.5:.8;r.push([`Code excerpt from file \`${ts(a)}\`:`,1],[f.wrapInTicks(p,h),1]),await this.turnContext.collectFile(dM,a,ca(u),l)}}if(r.length>0)return r.unshift([new Ut(["The user wants you to consider the following snippets when computing your answer."]),1]),new Ut(r)}removeDuplicateSnippets(e){let r={};return e.forEach(n=>{let i=`${n.uri}#[${n.range.start.line},${n.range.start.character}]-[${n.range.end.line},${n.range.end.character}]`;r[i]||(r[i]=n)}),Object.values(r)}},uM="collect-project-context",Ose=class extends H8{constructor(r,n=[new Fse]){super();this.ctx=r;this.snippetProviders=n;this.ready=!1;this.ctx.get(N1).addListener(this)}static{s(this,"ProjectContextSkillResolver")}start(){this.ready=!0}async didAddWorkspace(r){if(!await this.isEnabled()||(this.workerPoolToken=await Lse(),!r.uri))return;let n=this.ctx.get(Ec),i=this.ctx.get(Jd),o=this.ctx.get(fd),a=await n.chunk(this.ctx,r);n.status(r)!=="completed"&&i.terminateWatching(r),await o.initialize(this.ctx,r,a),await this.workerPoolToken.stopWorkerPool()}async didRemoveWorkspace(r){if(!await this.isEnabled())return;let n=this.ctx.get(Ec);if(!r)return;let i=n.getParentFolder(r);if(i){let c=await n.deleteSubfolderChunks(i,r);await this.ctx.get(fd).deleteEmbeddings(this.ctx,i,c);return}n.terminateChunking(this.ctx,r),await this.ctx.get(fd).terminateRanking(this.ctx,r),this.ctx.get(Am).terminateScoring(this.ctx,r),n.workspaceCount===0&&await Lq.forceStopWorkerPool()}async didTerminateWorkspaceSubfolders(r,n){let i=this.ctx.get(Ec),o=this.ctx.get(fd),a=this.ctx.get(Am);for(let c of n)i.terminateChunking(this.ctx,c),await o.terminateRanking(this.ctx,c),a.terminateScoring(this.ctx,r)}async didChangeFiles(r){if(!await this.isEnabled())return;let n=await Lse();try{let i=r.documents.map(l=>l.uri),o=r.workspaceFolder;if(!o)return;let a=this.ctx.get(Ec),c=this.ctx.get(fd);if(r.type==="delete"||r.type==="update"){let l=await a.deleteFileChunks(o,i);await c.deleteEmbeddings(this.ctx,o,l)}if(r.type==="create"||r.type==="update"){let l=await a.chunk(this.ctx,o,r.documents);await c.addChunks(this.ctx,o,l)}}finally{await n.stopWorkerPool()}}isStarted(){return this.ready}isEnabled(){return Promise.resolve(!0)}async resolveSkill(r){await r.steps.start(uM,"Collecting relevant project context"),await r.info(Hmt.default`Project context is applied to this response, which may lead to slightly longer load times. For faster and more general Copilot responses, remove the project context option from your prompt.`);let n=this.snippetProviders.map(async c=>c.snippetProviderStatus(r)),i=await Promise.all(n),o="not_indexed",a;for(let c of vmt){let l=i.findIndex(u=>u===c);if(l!==-1){o=c,a=this.snippetProviders[l];break}}switch(o){case"indexed":{let{snippets:c,measurements:l}=await a.provideSnippets(r);if(await GYe(r,a.providerType,l),c.length===0){await r.steps.error(uM,"No project context found");return}return await r.steps.finish(uM),c}case"indexing":{await r.steps.error(uM,"Indexing repository, please try again later");return}case"not_indexed":{await r.steps.error(uM,"No project context available");return}}}},dM="project-context",Qse=class extends wu{static{s(this,"ProjectContextSkill")}constructor(e){super(dM,"Code snippets and documentation from the open project. This skill is useful when the user question is specific to the open project and its context. Do not include this skill for general programming questions.","Performing code search",()=>e,r=>new IRe(r),"implicit",["Relevant: How do I add a custom server route?","Relevant: Where is the code that processes the response from CopyableThreadElement?","Relevant: Where do I add tests for the InputValidation class?","Relevant: How to implement a shared buffer component","Not relevant: What does numpy do?"],()=>!0)}};d();var $mt=x.Object({labels:x.Array(x.String())}),TRe=class{constructor(e){this.turnContext=e}static{s(this,"ProjectLabelsSkillProcessor")}value(){return 1}processSkill(e){let r=[];return r.push([new Ut(["The developer is working on a project with the following characteristics (languages, frameworks):"]),1]),e.labels.forEach(n=>{r.push([new Ut([`- ${n}`]),.9]),this.turnContext.collectLabel(Ay,n)}),new Ut(r)}},Ay="project-labels",qse=class{constructor(e){this._resolver=e;this.id=Ay;this.type="explicit"}static{s(this,"ProjectLabelsSkill")}description(){return"The characteristics of the project the developer is working on (languages, frameworks)"}resolver(){return this._resolver}processor(e){return new TRe(e)}};d();var Hse=Be(gm());var jmt={id:0,start_offset:0,stop_offset:0,type:"code_vulnerability",details:{type:"server-side-unvalidated-url-redirection",description:"Allows a URL to be redirected to a different URL that is specified by an external user.",ui_type:"test",ui_description:"test"}},Gmt=Hse.dedent`
    Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna 
    aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.
`,Vmt=Hse.dedent`
    \`\`\`kotlin
    fun main() {
        println("Hello, World!")
    }
    \`\`\`
`,lyr=Hse.dedent`
    ### Inputs
    
    \`p\` - paragraph message
    
    \`c\` - code block
    
    \`<number>\` - number of vulnerabilities, must be at the end of the string (applies to all code blocks)
    
    ### Examples
    
    \`/debug.vulnerability\` - 1 paragraph followed by 1 code block with 1 vulnerability
    
    \`/debug.vulnerability pcc2\` - 1 paragraph followed by 2 code blocks with 2 vulnerabilities each
    
    \`/debug.vulnerability cpc3\` - 1 code block followed by 1 paragraph followed by 1 code block--each code block has 3 vulnerabilities
`,wRe=`

`,Wmt=Gmt+wRe+Vmt;function zmt(t){let e=1;if(t.length===0)return{reply:Wmt,vulnerabilities:e};if(t==="0")return{reply:Wmt,vulnerabilities:0};if(t==="help")return{reply:lyr,vulnerabilities:e};let r=t.slice(-1);isNaN(Number(r))||(e=Number(r),t=t.slice(0,-1));let n="";for(let i of t)i==="p"?n+=Gmt+wRe:i==="c"&&(n+=Vmt+wRe);return{reply:n.trimEnd(),vulnerabilities:e}}s(zmt,"parseVulnerabilitiesInstructions");var Kmt=Be(gm());var uyr="Oops, your response got filtered. Vote down if you think this shouldn't have happened",dyr="You've reached your monthly chat messages limit. Upgrade to Copilot Pro (30-day free trial) or wait for your limit to reset.",SRe=class{constructor(){this.id="debug.fail";this.description="Fail for debugging purposes";this.shortDescription="Fail";this.scopes=["chat-panel"]}static{s(this,"DebugFailPromptTemplate")}response(e,r){throw new Error(r.length>0?r:"Debug Fail")}},fyr=new SRe,_Re=class{constructor(){this.id="debug.upgrade";this.description="upgrade for debugging purposes";this.shortDescription="upgrade";this.scopes=["chat-panel"]}static{s(this,"DebugUpgradePromptTemplate")}response(e){return new Su(dyr,{message:"",code:402,responseIsIncomplete:!0,responseIsFiltered:!1})}},pyr=new _Re,RRe=class{constructor(){this.id="debug.notify";this.description="Notify for debugging purposes";this.shortDescription="Notify";this.scopes=["chat-panel","inline"]}static{s(this,"DebugNotificationPromptTemplate")}response(e,r){let n="warning";r.includes("info")&&(n="info");let i=r.replace("info","").replace("warning","").trim(),o=[{severity:n,message:i.length>0?i:"Debug Notification"}];return new Su("Alright, I'm producing a notification",void 0,[],o)}},myr=new RRe,kRe=class{constructor(){this.id="debug.filter";this.description="Make the RAI filter kick in";this.shortDescription="RAI Filter";this.scopes=["chat-panel"]}static{s(this,"DebugFilterPromptTemplate")}response(e){return e.turn.status="filtered",new Su(uyr,{message:"",responseIsFiltered:!0,responseIsIncomplete:!1})}},hyr=new kRe,PRe=class{constructor(){this.id="debug.dump";this.description="Dump the conversation";this.shortDescription="Dump";this.scopes=["chat-panel"]}static{s(this,"DebugDumpPromptTemplate")}async response(e){return new Su(await Jmt(e))}},gyr=new PRe,DRe=class{constructor(){this.id="debug.tree";this.description="Jingle bells, jingle bells, jingle all the way";this.shortDescription="Christmas Tree";this.scopes=["chat-panel"]}static{s(this,"DebugChristmasTreePromptTemplate")}requiredSkills(){return[Ay,ef]}instructions(e,r){return"Create a function that prints a christmas tree"}},Ayr=new DRe,BRe=class{constructor(){this.id="debug.echo";this.description="Echo the user message back to the user";this.shortDescription="Echo";this.scopes=["chat-panel"]}static{s(this,"DebugEchoPromptTemplate")}response(e){return new Su(en(e.turn.request.message))}},yyr=new BRe,NRe=class{constructor(){this.id="debug.prompt";this.description="Show the prompt for the last response or generate a new one";this.shortDescription="Prompt";this.scopes=["chat-panel"]}static{s(this,"DebugPromptPromptTemplate")}response(e,r){let n=e.ctx.get(_u).getLastTurnPrompts();if(n!==void 0&&n.size>0){let i="Here are the prompts used in the last turn:";return n.forEach((o,a)=>{i+=Kmt.default`

                        ### ${a} prompt
                        
                        \`\`\`\`
                        ${o}
                        \`\`\`\`
                    `}),new Su(i)}return new Su("No prompt available")}},Cyr=new NRe,MRe=class{constructor(){this.id="debug.skills";this.description="Resolves and displays all available skills or a single skill (id) if provided";this.shortDescription="Skills";this.scopes=["chat-panel"]}static{s(this,"DebugSkillsPromptTemplate")}async response(e,r,n){let i,o;if(r.length>0){let a=r.split(" ");i=a[0],o=a.slice(1).join(" ")}return e.turn.request.message=o??"",new Su(await Xmt(e,n,i))}},vyr=new MRe,LRe=class{constructor(){this.id="debug.vulnerability";this.description="Create a message with a vulnerability annotation";this.shortDescription="Vulnerability";this.scopes=["chat-panel"]}static{s(this,"DebugVulnerabilityPromptTemplate")}response(e,r){let{reply:n,vulnerabilities:i}=zmt(r);for(let o=0;o<i;o++)e.turn.annotations.push(jmt);return new Su(n,void 0,e.turn.annotations)}},xyr=new LRe,FRe=class{constructor(){this.id="debug.citation";this.description="Create a message with a code citation annotation";this.shortDescription="CodeCitation";this.scopes=["chat-panel"]}static{s(this,"DebugCodeCitationPromptTemplate")}response(e){return e.turn.annotations.push(fmt),new Su(pmt,void 0,e.turn.annotations)}},Eyr=new FRe,ORe=class{constructor(){this.id="debug.markdown";this.description="Markdown rendering specification by example";this.shortDescription="Markdown";this.scopes=["chat-panel","inline"]}static{s(this,"DebugMarkdownRenderingPromptTemplate")}response(){return new Su(mmt)}},byr=new ORe,QRe=class{constructor(){this.id="debug.long";this.description="Generate a long response";this.shortDescription="Long";this.scopes=["chat-panel"]}static{s(this,"DebugLongPromptTemplate")}instructions(e,r){return"Write out the OWASP top 10 with code examples in java"}},Iyr=new QRe,URe=class{constructor(){this.id="debug.project";this.description="Generate a response using the project context skill";this.shortDescription="Project";this.scopes=["chat-panel","inline"]}static{s(this,"DebugProjectContextPromptTemplate")}requiredSkills(){return[dM]}},Tyr=new URe,qRe=class{constructor(){this.id="debug.confirmation";this.description="Generate a response with a confirmation";this.shortDescription="Confirmation";this.scopes=["chat-panel","inline"]}static{s(this,"DebugConfirmationPromptTemplate")}response(){let e={type:"action",title:"Confirmation that you want to proceed",message:"Do you want to proceed?",agentSlug:"debug.confirmation",confirmation:{answer:"yes"}};return new Su("Alright, I'm producing a notification",void 0,[],[],[],e)}},wyr=new qRe;function Ymt(){return[fyr,pyr,myr,hyr,Ayr,gyr,yyr,Cyr,vyr,xyr,Eyr,wyr,byr,Iyr,Tyr]}s(Ymt,"getDebugTemplates");d();d();function AS(t,e){if(t.length==0)return new Ut([]);let r=t.map((n,i)=>{let o;switch(e){case"linear":o=1-i/t.length;break;case"inverseLinear":o=(i+1)/t.length;break;case"positional":o=1/(i+1);break;case"inversePositional":o=1/(t.length-i);break}return Array.isArray(n)&&n.length==2&&(o*=n[1],n=n[0]),[n,o]});return new Ut(r)}s(AS,"weighElidableList");var Zmt=x.Object({uri:x.String(),problems:x.Array(x.Object({message:x.String(),range:Uc}))}),HRe=class{constructor(e){this.turnContext=e}static{s(this,"ProblemsInActiveDocumentSkillProcessor")}value(){return 1}async processSkill(e){let r=this.turnContext.ctx.get(En),n=await r.getOrReadTextDocument(e);if(await this.turnContext.collectFile(yS,e.uri,ca(n)),n.status==="valid"){let i=r.getRelativePath(n.document);this.turnContext.collectLabel(yS,`problems in ${i}`);let o=this.getElidableProblems(e,n,i);return await this.preElideDocuments(o)}else this.turnContext.collectLabel(yS,"problem markers")}getElidableProblems(e,r,n){let i=[];return i.push(new Ut([`Problems and errors in the active document (\`${n}\`):`])),i.push(...this.createElidableProblems(e,r)),AS(i,"linear")}createElidableProblems(e,r){return e.problems.map(n=>{let i=[];i.push(new Ut([`- "${n.message}" at line ${n.range.start.line}.`+(r.document?" Excerpt from the code:":"")]));let o=n.range,a;if(o&&(this.isEmpty(o)?a=r.document.lineAt(o.start).text:a=r.document.getText(o),a)){let c=r.document.detectedLanguageId;i.push(new Ut([["```"+c,1],[q0(a),.8],["```",1]]))}return new Ut(i)})}isEmpty(e){return e.start.line===e.end.line&&e.start.character===e.end.character}async preElideDocuments(e){let r=(await Wo.getModelConfiguration(this.turnContext.ctx,"user")).maxRequestTokens,n=e.elide(Math.floor(r*.1)).getText();return new Ut([n])}},yS="problems-in-active-document",$se=class extends wu{static{s(this,"ProblemsInActiveDocumentSkill")}constructor(e){super(yS,"List of problems and errors in the active document, useful when the user question is about finding and fixing errors, non-functioning code, compilation issues, etc.","Analyzing problems and errors",()=>e,r=>new HRe(r),"explicit",["How can I fix the errors?","Why is my app not working?","Why am I getting compilation errors?","Raw error messages or stack traces"])}};d();d();var Wse=class{constructor(e){this.turnContext=e}static{s(this,"PromptForTestGeneration")}async fromImplementationFile(e){let r=this.turnContext.ctx.get(dr).getWorkspaceFolder(e),n=this.fileExistFn(),i=new Bq(this.turnContext.ctx,n,r?.uri),o=await i.findTestFileForSourceFile(e.uri),a=Nq(e.uri);if(o&&!a){let c=e.detectedLanguageId;if(await n(o))return await this.asTestFilePrompt(c,o);{let l=i.findExampleTestFile(e.uri);if(l)return await this.asExampleFilePrompt(c,l)}}}async fromTestFile(e){if(!Nq(e))return;let n=this.turnContext.ctx.get(dr).getWorkspaceFolder(e),i=this.fileExistFn(),a=await new Bq(this.turnContext.ctx,i,n?.uri).findImplFileForTestFile(e.uri);if(a){let c=e.detectedLanguageId;if(await i(a))return await this.asImplFilePrompt(c,a)}}async asImplFilePrompt(e,r){let n=await this.fileInfoForPrompt(r);if(n){let[i,o]=n;return new Ut([[`${Syr} \`${o}\`:`,1],["```"+e,1],[i,.9],["```",1]])}return new Ut([])}async asTestFilePrompt(e,r){let n=await this.fileInfoForPrompt(r);if(n){let[i,o]=n;return new Ut([[`${_yr} \`${o}\`:`,1],["```"+e,1],[i,.9],["```",1]])}return new Ut([])}async asExampleFilePrompt(e,r){let n=await this.fileInfoForPrompt(r);if(n){let[i,o]=n;return new Ut([[`${Ryr} \`${o}\`:`,1],["```"+e,1],[i,.9],["```",1]])}return new Ut([])}async fileInfoForPrompt(e){if(!this.turnContext.isFileIncluded(e)){let r=this.turnContext.ctx.get(En),n=await r.getOrReadTextDocument({uri:e});if(await this.turnContext.collectFile(yy,e,ca(n)),n.status==="valid"){let i=r.getRelativePath(n.document);return[q0(n.document.getText()),i]}}}fileExistFn(){return async e=>{try{return await this.turnContext.ctx.get(Fi).stat(e),!0}catch{return!1}}}},Syr="Code excerpt from the implementation source file",_yr="Code excerpt from the test file",Ryr="Code excerpt from an example test file";var eht=x.Object({currentFileUri:x.String(),sourceFileUri:x.Optional(x.String()),testFileUri:x.Optional(x.String())}),WRe=class{constructor(e){this.turnContext=e}static{s(this,"TestContextSkillProcessor")}value(){return .9}async processSkill(e){let r=this.turnContext.ctx.get(En),n=new Wse(this.turnContext);if(e.sourceFileUri&&e.testFileUri){if(e.sourceFileUri!==e.currentFileUri&&e.testFileUri!==e.currentFileUri)return;if(e.testFileUri===e.currentFileUri){let i=await r.getOrReadTextDocument({uri:e.testFileUri});if(await this.turnContext.collectFile(yy,e.testFileUri,ca(i)),i.status==="valid")return await n.asImplFilePrompt(i.document.detectedLanguageId,e.sourceFileUri)}else if(e.sourceFileUri===e.currentFileUri){let i=await r.getOrReadTextDocument({uri:e.sourceFileUri});if(await this.turnContext.collectFile(yy,e.sourceFileUri,ca(i)),i.status==="valid")return await n.asTestFilePrompt(i.document.detectedLanguageId,e.testFileUri)}}else if(e.sourceFileUri&&e.sourceFileUri===e.currentFileUri){let i=await r.getOrReadTextDocument({uri:e.sourceFileUri});if(await this.turnContext.collectFile(yy,e.sourceFileUri,ca(i)),i.status==="valid")return await n.fromImplementationFile(i.document)}else if(e.testFileUri&&e.testFileUri===e.currentFileUri){let i=await r.getOrReadTextDocument({uri:e.testFileUri});if(await this.turnContext.collectFile(yy,e.testFileUri,ca(i)),i.status==="valid")return await n.fromTestFile(i.document)}}},yy="test-context",jse=class extends wu{static{s(this,"TestContextSkill")}constructor(e){super(yy,"Example tests useful for creating, adding and fixing tests, to detect available test frameworks as well as finding the corresponding implementation to existing tests","Searching test examples",()=>e,r=>new WRe(r))}};d();var tht=Be(gm());var rht=x.Object({failures:x.Array(x.Object({testName:x.String(),testSuite:x.Optional(x.String()),testFileUri:x.String(),failureReason:x.Optional(x.String()),testLocation:Uc}))}),jRe=class{constructor(e){this.turnContext=e}static{s(this,"TestFailuresSkillProcessor")}value(){return .9}async processSkill(e){if(e.failures.length>0){this.turnContext.collectLabel(xP,"test failures");let r=await this.createElidableFailures(e.failures);if(r){let n=new Ut(["The latest test run produced the following failures and errors:"]);return new Ut([[n,1],[r,1]])}}}async createElidableFailures(e){let r=this.turnContext.ctx.get(En),n=[],i=this.groupFailuresByFile(e);for(let[o,a]of i.entries()){let c=await r.getOrReadTextDocument({uri:o});if(await this.turnContext.collectFile(xP,o,ca(c)),c.status==="valid"){let l=r.getRelativePath(c.document),u=this.createElidableFailuresOfDoc(a,l),f=this.appendCode(u,l,c.document);n.push([f,1])}}if(n.length>0)return new Ut(n)}groupFailuresByFile(e){let r=new Map;for(let n of e){let i=r.get(n.testFileUri)||[];i.push(n),r.set(n.testFileUri,i)}return r}createElidableFailuresOfDoc(e,r){let n=e.map(i=>{let o=`\`${i.testName}\``,a=`${i.testSuite?` in suite \`${i.testSuite}\``:""}`,c=` in file \`${r}\` `,l=". ";i.failureReason&&(l=" with the following error:",i.failureReason.includes(`
`)?l+="\n```\n"+i.failureReason+"\n```\n":l+=` \`${i.failureReason}\`. `);let u=`${i.testLocation.start.line==i.testLocation.end.line?"on line "+i.testLocation.start.line:"between lines "+i.testLocation.start.line+" and "+i.testLocation.end.line}`;return[new Ut([tht.default`\n\n- Test ${o}${a}${c}failed${l}The failed test is ${u}.\n`]),1]});return new Ut(n)}appendCode(e,r,n){let i=[new Ut([`
The code of file \`${r}\` is:
`]),.6],o=[new Ut([["```"+n.detectedLanguageId,1],[q0(n.getText()),.9],["```",1]]),.7];return new Ut([[e,1],i,o])}},xP="test-failures",Gse=class extends wu{static{s(this,"TestFailuresSkill")}constructor(e){super(xP,"Test failures and errors of the latest test run","Collecting test failures",()=>e,r=>new jRe(r))}};var fg=Be(gm());var Su=class{constructor(e,r,n=[],i=[],o=[],a){this.message=e;this.error=r;this.annotations=n;this.notifications=i;this.references=o;this.confirmationRequest=a}static{s(this,"PromptTemplateResponse")}},EP=class{constructor(e,r,n,i,o=[],a=[],c,l=!1){this.id=e;this.description=r;this.shortDescription=n;this.prompt=i;this.skills=o;this.scopes=a;this.inlinePrompt=c;this.producesCodeEdits=l}static{s(this,"StaticPromptTemplate")}instructions(e,r,n="panel"){let i;return n==="inline"?i=this.inlinePrompt??this.prompt:i=this.prompt,i+`
`+r}requiredSkills(){return this.skills}},kyr=new EP("tests","Generate unit tests","Generate Tests",fg.default`
        Write a set of unit tests for the code above, or for the selected code if provided.
        Provide tests for the functionality of the code and not the implementation details.
        The tests should test the happy path as well as the edge cases.
        Choose self explanatory names for the tests that describe the tested behavior. Do not start the test names with "test".
        Think about the different scenarios that could happen and test them.
        Do reply with the tests only and do not explain them further.
        Do reply with new or modified tests only and not with the complete test class or suite.
        Follow the same test style as in existing tests if they exist.
        You must not create inline comments like "Arrange, Act, Assert", unless existing tests use inline comments as well.
        If existing tests use any mocking or stubbing libraries, use the same libraries before writing your own test doubles.
        `,[yy,xP],["chat-panel","agent-panel","editor"]),Pyr=new EP("simplify","Simplify the code","Simplify This",fg.default`
        Provide a simplified version of the selected code above.
        Do not change the behavior of the code. 
        The code should still be readable and easy to understand. 
        Do not reply with the original code but only a simplified version. 
        Do only reply with one code snippet that contains the complete simplified code and explain what you have simplified after.`,[],["editor","chat-panel","agent-panel","inline"],fg.default`
        Provide a simplified version of the selected code.
        Modify the selected code to make it simpler and easier to understand.
        Do not change the behavior of the code. 
        Removing empty lines is not a simplification.
        You must not omit any code that is necessary for the code to compile and run, for example by replacing lines with ... or similar.
        Do not reply with the original code but only a simplified version.`,!0),Dyr=new EP("fix","Fix problems and compile errors","Fix This",fg.default`
        Fix the provided errors and problems. 
        Do not invent new problems.
        The fixed code should still be readable and easy to understand.
        If there are no problems provided do reply that you can't detect any problems and the user should describe more precisely what they want to be fixed. 
        Group problems if they are related and can be fixed by the same change. 
        Present a group as a single problem with a simple description that does not repeat the single problems but explains the whole group of problems in a few words.
        Explain each group of problems without repeating the detailed error message. 
        Show how the error can be fixed by providing a code snippet that displays the code before and after it has been fixed after each group. 
        Shorten fully qualified class names to the simple class name and full file paths to the file names only.
        When enumerating the groups, start with the word "Problem" followed by the number and a quick summary of the problem. Format this headline bold.
        At last provide a completely fixed version of the code if the fixes required multiple code changes.`,[yS],["editor","chat-panel","agent-panel","inline"],fg.default`
        Fix the provided errors and problems. 
        Do not invent new problems.
        The fixed code should still be readable and easy to understand.
        If there are no problems provided do reply that you can't detect any problems and the user should describe more precisely what they want to be fixed.
        Do not attempt to fix problems that are not provided, like unbalanced brackets or parentheses that are not causing errors.
        Briefly explain the problems without repeating the detailed error message.`,!0),Byr=new EP("explain","Explain how the code works","Explain This",fg.default`
        Write an explanation for the selected code above as paragraphs of text. 
        Include excerpts of code snippets to underline your explanation. 
        Do not repeat the complete code.
        The explanation should be easy to understand for a developer who is familiar with the programming language used but not familiar with the code.`,[],["editor","chat-panel","agent-panel","inline"],fg.default`
        Write an explanation for the code the user is selecting.
        Include excerpts of code snippets to underline your explanation. 
        Do not repeat the complete code.
        Keep the explanation brief and easy to understand for a developer who is familiar with the programming language used but not familiar with the code.`,!1),Nyr=new EP("doc","Document the current selection of code","Generate Docs",fg.default`
        Write documentation for the selected code.
        The reply should be a codeblock containing the original selection with the documentation added as comments.
        Use the most appropriate documentation style for the programming language used (e.g. JSDoc for JavaScript, docstrings for Python etc.)`,[],["editor","chat-panel","agent-panel","inline"],fg.default`
        Add documentation to the selected code.
        Modify the selected code by adding documentation as comments.
        You must only modify the selected code and nothing else.
        Use the most appropriate documentation style for the programming language used (e.g. JSDoc for JavaScript, docstrings for Python etc.).
        Place the comments before functions and methods, unless the language has a different convention (for example Python's docstring).`,!0),GRe=class{constructor(){this.id="feedback";this.description="Steps to provide feedback";this.shortDescription="Feedback";this.scopes=["chat-panel","agent-panel"]}static{s(this,"FeedbackPromptTemplate")}response(e){let r=KRe(e.conversation),n=fg.default`
            You can provide direct feedback by pressing the thumbs up/down buttons on a single message. 
            In case you want to share more details, please click [here](https://aka.ms/copilot-jetbrains-feedback) to share your feedback.
            `;return r?new Su(n+`

In order to help us understand your feedback better, you can include the following identifier in your feedback: by doing so, you are granting us permission to access the telemetry data associated with your feedback.
\`\`\`yaml
${e.conversation.id}/${r}
\`\`\``):new Su(n)}},Myr=new GRe,VRe=class{constructor(){this.id="help";this.description="Get help on how to use Copilot chat";this.shortDescription="Help";this.scopes=["chat-panel","agent-panel"]}static{s(this,"HelpPromptTemplate")}response(e){let r=zRe(e.ctx).filter(i=>i!=this),n=fg.default`
            You can ask me general programming questions, or use one of the following commands to get help with a specific task:

            ${r.map(i=>`- \`/${i.id}\` - ${i.description}`).join(`
`)}

            To have a great conversation, ask me questions as if I was a real programmer:
            
            - **Show me the code** you want to talk about by having the files open and selecting the most important lines.
            - On top of files, **I take different parts of your IDE into consideration** when answering questions. This includes, but is not limited to, test results and failures, build and runtime logs, active Git repository as well as details of the open project.
            - **Make refinements** by asking me follow-up questions, adding clarifications, providing errors, etc.
            - **Review my suggested code** and tell me about issues or improvements, so I can iterate on it.
        `;return new Su(n)}},Lyr=new VRe;function bP(){return[kyr,Pyr,Dyr,Byr,Nyr,Myr,Lyr,...Ymt()]}s(bP,"getPromptTemplates");function zRe(t){let e=bP();return!UF(t)&&!Kg(t)&&(e=e.filter(r=>!r.id.startsWith("debug."))),e}s(zRe,"getUserFacingPromptTemplates");var YRe=class{constructor(e,r){this.conversation=e;this.capabilities=r}static{s(this,"ConversationHolder")}},to=class{constructor(e){this.ctx=e;this.conversations=new Sr(100)}static{s(this,"Conversations")}create({capabilities:e,source:r,userLanguage:n,conversationId:i}={}){let o=new Ise([],r??"panel",n,i),a=e?.skills??[];return e?.allSkills&&(a=this.ctx.get(ql).getDescriptors().map(c=>c.id)),this.conversations.set(o.id,new YRe(o,{skills:a})),o}destroy(e){this.conversations.delete(e)}async addTurn(e,r,n,i,o,a,c,l){let u=this.get(e);return r.request.references=n&&n.length>0?n:[],i&&(r.request.activeEditor=i),o&&(r.workspaceFolder=o),a&&a.length>0&&(r.workspaceFolders=a),c&&c.length>0&&(r.ignoredSkills=c.map(f=>({skillId:f}))),l&&(r.agent={agentSlug:l.agentSlug},r.confirmationResponse=l),await this.determineAndApplyAgent(u,r),await this.determineAndApplyTemplate(u,r),this.determineAndApplyPromptTemplate(this.ctx,u,r),u.addTurn(r),r}async determineAndApplyAgent(e,r){if(e.source==="panel"&&en(r.request.message).trim().startsWith("@")){let[n,i]=this.extractKeywordAndQuestionFromRequest(en(r.request.message),"@");(await j1(this.ctx)).find(c=>c.slug===n)&&(r.request.message=i,r.request.type="user",r.agent={agentSlug:n})}}async determineAndApplyTemplate(e,r){if(en(r.request.message).trim().startsWith("/")){let[n,i]=this.extractKeywordAndQuestionFromRequest(en(r.request.message),"/"),o=bP().find(a=>a.id===n);if(o){r.request.message=i,r.request.type="user",await this.determineAndApplyAgent(e,r);let a=o.instructions?o.instructions(this.ctx,r.request.message,e.source):i;r.template={templateId:n,userQuestion:r.request.message},r.request.message=a,r.request.type="template"}}}determineAndApplyPromptTemplate(e,r,n){if(en(n.request.message).trim().startsWith("/")){let[i,o]=this.extractKeywordAndQuestionFromRequest(en(n.request.message),"/"),c=e.get(ZA).getPromptTemplate(i);c&&(n.request.message=`Follow instructions in [${c.name}](${c.uri}). ${o}`,n.request.references=[...n.request.references||[],{type:"file",uri:c.uri}])}}extractKeywordAndQuestionFromRequest(e,r){let[n,...i]=e.trim().split(" "),o=i.join(" ");return[n.replace(r,""),o]}deleteTurn(e,r){this.get(e).deleteTurn(r)}get(e){return this.getHolder(e).conversation}getCapabilities(e){return this.getHolder(e).capabilities}getSupportedSkills(e){let r=this.ctx.get(ql).getDescriptors().filter(i=>i.type==="implicit").map(i=>i.id),n=this.getCapabilities(e).skills;return[...r,...n]}filterSupportedSkills(e,r){let n=this.getSupportedSkills(e);return r.filter(i=>n.includes(i))}getHolder(e){let r=this.conversations.get(e);if(!r)throw new Error(`Conversation with id ${e} does not exist`);return r}getAll(){let e=this.conversations.values();return Array.from(e).map(r=>r.conversation)}findByTurnId(e){for(let r of this.getAll()){let n=r.findTurn(e);if(n)return{conversation:r,turn:n}}}};d();function yht(t){return typeof t>"u"||t===null}s(yht,"isNothing");function Fyr(t){return typeof t=="object"&&t!==null}s(Fyr,"isObject");function Oyr(t){return Array.isArray(t)?t:yht(t)?[]:[t]}s(Oyr,"toArray");function Qyr(t,e){var r,n,i,o;if(e)for(o=Object.keys(e),r=0,n=o.length;r<n;r+=1)i=o[r],t[i]=e[i];return t}s(Qyr,"extend");function Uyr(t,e){var r="",n;for(n=0;n<e;n+=1)r+=t;return r}s(Uyr,"repeat");function qyr(t){return t===0&&Number.NEGATIVE_INFINITY===1/t}s(qyr,"isNegativeZero");var Hyr=yht,$yr=Fyr,Wyr=Oyr,jyr=Uyr,Gyr=qyr,Vyr=Qyr,Hl={isNothing:Hyr,isObject:$yr,toArray:Wyr,repeat:jyr,isNegativeZero:Gyr,extend:Vyr};function Cht(t,e){var r="",n=t.reason||"(unknown reason)";return t.mark?(t.mark.name&&(r+='in "'+t.mark.name+'" '),r+="("+(t.mark.line+1)+":"+(t.mark.column+1)+")",!e&&t.mark.snippet&&(r+=`

`+t.mark.snippet),n+" "+r):n}s(Cht,"formatError");function Oq(t,e){Error.call(this),this.name="YAMLException",this.reason=t,this.mark=e,this.message=Cht(this,!1),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack||""}s(Oq,"YAMLException$1");Oq.prototype=Object.create(Error.prototype);Oq.prototype.constructor=Oq;Oq.prototype.toString=s(function(e){return this.name+": "+Cht(this,e)},"toString");var Jp=Oq;function JRe(t,e,r,n,i){var o="",a="",c=Math.floor(i/2)-1;return n-e>c&&(o=" ... ",e=n-c+o.length),r-n>c&&(a=" ...",r=n+c-a.length),{str:o+t.slice(e,r).replace(/\t/g,"\u2192")+a,pos:n-e+o.length}}s(JRe,"getLine");function XRe(t,e){return Hl.repeat(" ",e-t.length)+t}s(XRe,"padStart");function zyr(t,e){if(e=Object.create(e||null),!t.buffer)return null;e.maxLength||(e.maxLength=79),typeof e.indent!="number"&&(e.indent=1),typeof e.linesBefore!="number"&&(e.linesBefore=3),typeof e.linesAfter!="number"&&(e.linesAfter=2);for(var r=/\r?\n|\r|\0/g,n=[0],i=[],o,a=-1;o=r.exec(t.buffer);)i.push(o.index),n.push(o.index+o[0].length),t.position<=o.index&&a<0&&(a=n.length-2);a<0&&(a=n.length-1);var c="",l,u,f=Math.min(t.line+e.linesAfter,i.length).toString().length,p=e.maxLength-(e.indent+f+3);for(l=1;l<=e.linesBefore&&!(a-l<0);l++)u=JRe(t.buffer,n[a-l],i[a-l],t.position-(n[a]-n[a-l]),p),c=Hl.repeat(" ",e.indent)+XRe((t.line-l+1).toString(),f)+" | "+u.str+`
`+c;for(u=JRe(t.buffer,n[a],i[a],t.position,p),c+=Hl.repeat(" ",e.indent)+XRe((t.line+1).toString(),f)+" | "+u.str+`
`,c+=Hl.repeat("-",e.indent+f+3+u.pos)+`^
`,l=1;l<=e.linesAfter&&!(a+l>=i.length);l++)u=JRe(t.buffer,n[a+l],i[a+l],t.position-(n[a]-n[a+l]),p),c+=Hl.repeat(" ",e.indent)+XRe((t.line+l+1).toString(),f)+" | "+u.str+`
`;return c.replace(/\n$/,"")}s(zyr,"makeSnippet");var Kyr=zyr,Yyr=["kind","multi","resolve","construct","instanceOf","predicate","represent","representName","defaultStyle","styleAliases"],Jyr=["scalar","sequence","mapping"];function Xyr(t){var e={};return t!==null&&Object.keys(t).forEach(function(r){t[r].forEach(function(n){e[String(n)]=r})}),e}s(Xyr,"compileStyleAliases");function Zyr(t,e){if(e=e||{},Object.keys(e).forEach(function(r){if(Yyr.indexOf(r)===-1)throw new Jp('Unknown option "'+r+'" is met in definition of "'+t+'" YAML type.')}),this.options=e,this.tag=t,this.kind=e.kind||null,this.resolve=e.resolve||function(){return!0},this.construct=e.construct||function(r){return r},this.instanceOf=e.instanceOf||null,this.predicate=e.predicate||null,this.represent=e.represent||null,this.representName=e.representName||null,this.defaultStyle=e.defaultStyle||null,this.multi=e.multi||!1,this.styleAliases=Xyr(e.styleAliases||null),Jyr.indexOf(this.kind)===-1)throw new Jp('Unknown kind "'+this.kind+'" is specified for "'+t+'" YAML type.')}s(Zyr,"Type$1");var tf=Zyr;function nht(t,e){var r=[];return t[e].forEach(function(n){var i=r.length;r.forEach(function(o,a){o.tag===n.tag&&o.kind===n.kind&&o.multi===n.multi&&(i=a)}),r[i]=n}),r}s(nht,"compileList");function eCr(){var t={scalar:{},sequence:{},mapping:{},fallback:{},multi:{scalar:[],sequence:[],mapping:[],fallback:[]}},e,r;function n(i){i.multi?(t.multi[i.kind].push(i),t.multi.fallback.push(i)):t[i.kind][i.tag]=t.fallback[i.tag]=i}for(s(n,"collectType"),e=0,r=arguments.length;e<r;e+=1)arguments[e].forEach(n);return t}s(eCr,"compileMap");function eke(t){return this.extend(t)}s(eke,"Schema$1");eke.prototype.extend=s(function(e){var r=[],n=[];if(e instanceof tf)n.push(e);else if(Array.isArray(e))n=n.concat(e);else if(e&&(Array.isArray(e.implicit)||Array.isArray(e.explicit)))e.implicit&&(r=r.concat(e.implicit)),e.explicit&&(n=n.concat(e.explicit));else throw new Jp("Schema.extend argument should be a Type, [ Type ], or a schema definition ({ implicit: [...], explicit: [...] })");r.forEach(function(o){if(!(o instanceof tf))throw new Jp("Specified list of YAML types (or a single Type object) contains a non-Type object.");if(o.loadKind&&o.loadKind!=="scalar")throw new Jp("There is a non-scalar type in the implicit list of a schema. Implicit resolving of such types is not supported.");if(o.multi)throw new Jp("There is a multi type in the implicit list of a schema. Multi tags can only be listed as explicit.")}),n.forEach(function(o){if(!(o instanceof tf))throw new Jp("Specified list of YAML types (or a single Type object) contains a non-Type object.")});var i=Object.create(eke.prototype);return i.implicit=(this.implicit||[]).concat(r),i.explicit=(this.explicit||[]).concat(n),i.compiledImplicit=nht(i,"implicit"),i.compiledExplicit=nht(i,"explicit"),i.compiledTypeMap=eCr(i.compiledImplicit,i.compiledExplicit),i},"extend");var tCr=eke,rCr=new tf("tag:yaml.org,2002:str",{kind:"scalar",construct:s(function(t){return t!==null?t:""},"construct")}),nCr=new tf("tag:yaml.org,2002:seq",{kind:"sequence",construct:s(function(t){return t!==null?t:[]},"construct")}),iCr=new tf("tag:yaml.org,2002:map",{kind:"mapping",construct:s(function(t){return t!==null?t:{}},"construct")}),oCr=new tCr({explicit:[rCr,nCr,iCr]});function sCr(t){if(t===null)return!0;var e=t.length;return e===1&&t==="~"||e===4&&(t==="null"||t==="Null"||t==="NULL")}s(sCr,"resolveYamlNull");function aCr(){return null}s(aCr,"constructYamlNull");function cCr(t){return t===null}s(cCr,"isNull");var lCr=new tf("tag:yaml.org,2002:null",{kind:"scalar",resolve:sCr,construct:aCr,predicate:cCr,represent:{canonical:s(function(){return"~"},"canonical"),lowercase:s(function(){return"null"},"lowercase"),uppercase:s(function(){return"NULL"},"uppercase"),camelcase:s(function(){return"Null"},"camelcase"),empty:s(function(){return""},"empty")},defaultStyle:"lowercase"});function uCr(t){if(t===null)return!1;var e=t.length;return e===4&&(t==="true"||t==="True"||t==="TRUE")||e===5&&(t==="false"||t==="False"||t==="FALSE")}s(uCr,"resolveYamlBoolean");function dCr(t){return t==="true"||t==="True"||t==="TRUE"}s(dCr,"constructYamlBoolean");function fCr(t){return Object.prototype.toString.call(t)==="[object Boolean]"}s(fCr,"isBoolean");var pCr=new tf("tag:yaml.org,2002:bool",{kind:"scalar",resolve:uCr,construct:dCr,predicate:fCr,represent:{lowercase:s(function(t){return t?"true":"false"},"lowercase"),uppercase:s(function(t){return t?"TRUE":"FALSE"},"uppercase"),camelcase:s(function(t){return t?"True":"False"},"camelcase")},defaultStyle:"lowercase"});function mCr(t){return 48<=t&&t<=57||65<=t&&t<=70||97<=t&&t<=102}s(mCr,"isHexCode");function hCr(t){return 48<=t&&t<=55}s(hCr,"isOctCode");function gCr(t){return 48<=t&&t<=57}s(gCr,"isDecCode");function ACr(t){if(t===null)return!1;var e=t.length,r=0,n=!1,i;if(!e)return!1;if(i=t[r],(i==="-"||i==="+")&&(i=t[++r]),i==="0"){if(r+1===e)return!0;if(i=t[++r],i==="b"){for(r++;r<e;r++)if(i=t[r],i!=="_"){if(i!=="0"&&i!=="1")return!1;n=!0}return n&&i!=="_"}if(i==="x"){for(r++;r<e;r++)if(i=t[r],i!=="_"){if(!mCr(t.charCodeAt(r)))return!1;n=!0}return n&&i!=="_"}if(i==="o"){for(r++;r<e;r++)if(i=t[r],i!=="_"){if(!hCr(t.charCodeAt(r)))return!1;n=!0}return n&&i!=="_"}}if(i==="_")return!1;for(;r<e;r++)if(i=t[r],i!=="_"){if(!gCr(t.charCodeAt(r)))return!1;n=!0}return!(!n||i==="_")}s(ACr,"resolveYamlInteger");function yCr(t){var e=t,r=1,n;if(e.indexOf("_")!==-1&&(e=e.replace(/_/g,"")),n=e[0],(n==="-"||n==="+")&&(n==="-"&&(r=-1),e=e.slice(1),n=e[0]),e==="0")return 0;if(n==="0"){if(e[1]==="b")return r*parseInt(e.slice(2),2);if(e[1]==="x")return r*parseInt(e.slice(2),16);if(e[1]==="o")return r*parseInt(e.slice(2),8)}return r*parseInt(e,10)}s(yCr,"constructYamlInteger");function CCr(t){return Object.prototype.toString.call(t)==="[object Number]"&&t%1===0&&!Hl.isNegativeZero(t)}s(CCr,"isInteger");var vCr=new tf("tag:yaml.org,2002:int",{kind:"scalar",resolve:ACr,construct:yCr,predicate:CCr,represent:{binary:s(function(t){return t>=0?"0b"+t.toString(2):"-0b"+t.toString(2).slice(1)},"binary"),octal:s(function(t){return t>=0?"0o"+t.toString(8):"-0o"+t.toString(8).slice(1)},"octal"),decimal:s(function(t){return t.toString(10)},"decimal"),hexadecimal:s(function(t){return t>=0?"0x"+t.toString(16).toUpperCase():"-0x"+t.toString(16).toUpperCase().slice(1)},"hexadecimal")},defaultStyle:"decimal",styleAliases:{binary:[2,"bin"],octal:[8,"oct"],decimal:[10,"dec"],hexadecimal:[16,"hex"]}}),xCr=new RegExp("^(?:[-+]?(?:[0-9][0-9_]*)(?:\\.[0-9_]*)?(?:[eE][-+]?[0-9]+)?|\\.[0-9_]+(?:[eE][-+]?[0-9]+)?|[-+]?\\.(?:inf|Inf|INF)|\\.(?:nan|NaN|NAN))$");function ECr(t){return!(t===null||!xCr.test(t)||t[t.length-1]==="_")}s(ECr,"resolveYamlFloat");function bCr(t){var e,r;return e=t.replace(/_/g,"").toLowerCase(),r=e[0]==="-"?-1:1,"+-".indexOf(e[0])>=0&&(e=e.slice(1)),e===".inf"?r===1?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:e===".nan"?NaN:r*parseFloat(e,10)}s(bCr,"constructYamlFloat");var ICr=/^[-+]?[0-9]+e/;function TCr(t,e){var r;if(isNaN(t))switch(e){case"lowercase":return".nan";case"uppercase":return".NAN";case"camelcase":return".NaN"}else if(Number.POSITIVE_INFINITY===t)switch(e){case"lowercase":return".inf";case"uppercase":return".INF";case"camelcase":return".Inf"}else if(Number.NEGATIVE_INFINITY===t)switch(e){case"lowercase":return"-.inf";case"uppercase":return"-.INF";case"camelcase":return"-.Inf"}else if(Hl.isNegativeZero(t))return"-0.0";return r=t.toString(10),ICr.test(r)?r.replace("e",".e"):r}s(TCr,"representYamlFloat");function wCr(t){return Object.prototype.toString.call(t)==="[object Number]"&&(t%1!==0||Hl.isNegativeZero(t))}s(wCr,"isFloat");var SCr=new tf("tag:yaml.org,2002:float",{kind:"scalar",resolve:ECr,construct:bCr,predicate:wCr,represent:TCr,defaultStyle:"lowercase"}),_Cr=oCr.extend({implicit:[lCr,pCr,vCr,SCr]}),RCr=_Cr,vht=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9])-([0-9][0-9])$"),xht=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9]?)-([0-9][0-9]?)(?:[Tt]|[ \\t]+)([0-9][0-9]?):([0-9][0-9]):([0-9][0-9])(?:\\.([0-9]*))?(?:[ \\t]*(Z|([-+])([0-9][0-9]?)(?::([0-9][0-9]))?))?$");function kCr(t){return t===null?!1:vht.exec(t)!==null||xht.exec(t)!==null}s(kCr,"resolveYamlTimestamp");function PCr(t){var e,r,n,i,o,a,c,l=0,u=null,f,p,m;if(e=vht.exec(t),e===null&&(e=xht.exec(t)),e===null)throw new Error("Date resolve error");if(r=+e[1],n=+e[2]-1,i=+e[3],!e[4])return new Date(Date.UTC(r,n,i));if(o=+e[4],a=+e[5],c=+e[6],e[7]){for(l=e[7].slice(0,3);l.length<3;)l+="0";l=+l}return e[9]&&(f=+e[10],p=+(e[11]||0),u=(f*60+p)*6e4,e[9]==="-"&&(u=-u)),m=new Date(Date.UTC(r,n,i,o,a,c,l)),u&&m.setTime(m.getTime()-u),m}s(PCr,"constructYamlTimestamp");function DCr(t){return t.toISOString()}s(DCr,"representYamlTimestamp");var BCr=new tf("tag:yaml.org,2002:timestamp",{kind:"scalar",resolve:kCr,construct:PCr,instanceOf:Date,represent:DCr});function NCr(t){return t==="<<"||t===null}s(NCr,"resolveYamlMerge");var MCr=new tf("tag:yaml.org,2002:merge",{kind:"scalar",resolve:NCr}),oke=`ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=
\r`;function LCr(t){if(t===null)return!1;var e,r,n=0,i=t.length,o=oke;for(r=0;r<i;r++)if(e=o.indexOf(t.charAt(r)),!(e>64)){if(e<0)return!1;n+=6}return n%8===0}s(LCr,"resolveYamlBinary");function FCr(t){var e,r,n=t.replace(/[\r\n=]/g,""),i=n.length,o=oke,a=0,c=[];for(e=0;e<i;e++)e%4===0&&e&&(c.push(a>>16&255),c.push(a>>8&255),c.push(a&255)),a=a<<6|o.indexOf(n.charAt(e));return r=i%4*6,r===0?(c.push(a>>16&255),c.push(a>>8&255),c.push(a&255)):r===18?(c.push(a>>10&255),c.push(a>>2&255)):r===12&&c.push(a>>4&255),new Uint8Array(c)}s(FCr,"constructYamlBinary");function OCr(t){var e="",r=0,n,i,o=t.length,a=oke;for(n=0;n<o;n++)n%3===0&&n&&(e+=a[r>>18&63],e+=a[r>>12&63],e+=a[r>>6&63],e+=a[r&63]),r=(r<<8)+t[n];return i=o%3,i===0?(e+=a[r>>18&63],e+=a[r>>12&63],e+=a[r>>6&63],e+=a[r&63]):i===2?(e+=a[r>>10&63],e+=a[r>>4&63],e+=a[r<<2&63],e+=a[64]):i===1&&(e+=a[r>>2&63],e+=a[r<<4&63],e+=a[64],e+=a[64]),e}s(OCr,"representYamlBinary");function QCr(t){return Object.prototype.toString.call(t)==="[object Uint8Array]"}s(QCr,"isBinary");var UCr=new tf("tag:yaml.org,2002:binary",{kind:"scalar",resolve:LCr,construct:FCr,predicate:QCr,represent:OCr}),qCr=Object.prototype.hasOwnProperty,HCr=Object.prototype.toString;function $Cr(t){if(t===null)return!0;var e=[],r,n,i,o,a,c=t;for(r=0,n=c.length;r<n;r+=1){if(i=c[r],a=!1,HCr.call(i)!=="[object Object]")return!1;for(o in i)if(qCr.call(i,o))if(!a)a=!0;else return!1;if(!a)return!1;if(e.indexOf(o)===-1)e.push(o);else return!1}return!0}s($Cr,"resolveYamlOmap");function WCr(t){return t!==null?t:[]}s(WCr,"constructYamlOmap");var jCr=new tf("tag:yaml.org,2002:omap",{kind:"sequence",resolve:$Cr,construct:WCr}),GCr=Object.prototype.toString;function VCr(t){if(t===null)return!0;var e,r,n,i,o,a=t;for(o=new Array(a.length),e=0,r=a.length;e<r;e+=1){if(n=a[e],GCr.call(n)!=="[object Object]"||(i=Object.keys(n),i.length!==1))return!1;o[e]=[i[0],n[i[0]]]}return!0}s(VCr,"resolveYamlPairs");function zCr(t){if(t===null)return[];var e,r,n,i,o,a=t;for(o=new Array(a.length),e=0,r=a.length;e<r;e+=1)n=a[e],i=Object.keys(n),o[e]=[i[0],n[i[0]]];return o}s(zCr,"constructYamlPairs");var KCr=new tf("tag:yaml.org,2002:pairs",{kind:"sequence",resolve:VCr,construct:zCr}),YCr=Object.prototype.hasOwnProperty;function JCr(t){if(t===null)return!0;var e,r=t;for(e in r)if(YCr.call(r,e)&&r[e]!==null)return!1;return!0}s(JCr,"resolveYamlSet");function XCr(t){return t!==null?t:{}}s(XCr,"constructYamlSet");var ZCr=new tf("tag:yaml.org,2002:set",{kind:"mapping",resolve:JCr,construct:XCr}),Eht=RCr.extend({implicit:[BCr,MCr],explicit:[UCr,jCr,KCr,ZCr]}),vS=Object.prototype.hasOwnProperty,Vse=1,bht=2,Iht=3,zse=4,ZRe=1,e1r=2,iht=3,t1r=/[\x00-\x08\x0B\x0C\x0E-\x1F\x7F-\x84\x86-\x9F\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,r1r=/[\x85\u2028\u2029]/,n1r=/[,\[\]\{\}]/,Tht=/^(?:!|!!|![a-z\-]+!)$/i,wht=/^(?:!|[^,\[\]\{\}])(?:%[0-9a-f]{2}|[0-9a-z\-#;\/\?:@&=\+\$,_\.!~\*'\(\)\[\]])*$/i;function oht(t){return Object.prototype.toString.call(t)}s(oht,"_class");function G1(t){return t===10||t===13}s(G1,"is_EOL");function TP(t){return t===9||t===32}s(TP,"is_WHITE_SPACE");function Xp(t){return t===9||t===32||t===10||t===13}s(Xp,"is_WS_OR_EOL");function pM(t){return t===44||t===91||t===93||t===123||t===125}s(pM,"is_FLOW_INDICATOR");function i1r(t){var e;return 48<=t&&t<=57?t-48:(e=t|32,97<=e&&e<=102?e-97+10:-1)}s(i1r,"fromHexCode");function o1r(t){return t===120?2:t===117?4:t===85?8:0}s(o1r,"escapedHexLen");function s1r(t){return 48<=t&&t<=57?t-48:-1}s(s1r,"fromDecimalCode");function sht(t){return t===48?"\0":t===97?"\x07":t===98?"\b":t===116||t===9?"	":t===110?`
`:t===118?"\v":t===102?"\f":t===114?"\r":t===101?"\x1B":t===32?" ":t===34?'"':t===47?"/":t===92?"\\":t===78?"\x85":t===95?"\xA0":t===76?"\u2028":t===80?"\u2029":""}s(sht,"simpleEscapeSequence");function a1r(t){return t<=65535?String.fromCharCode(t):String.fromCharCode((t-65536>>10)+55296,(t-65536&1023)+56320)}s(a1r,"charFromCodepoint");var Sht=new Array(256),_ht=new Array(256);for(IP=0;IP<256;IP++)Sht[IP]=sht(IP)?1:0,_ht[IP]=sht(IP);var IP;function c1r(t,e){this.input=t,this.filename=e.filename||null,this.schema=e.schema||Eht,this.onWarning=e.onWarning||null,this.legacy=e.legacy||!1,this.json=e.json||!1,this.listener=e.listener||null,this.implicitTypes=this.schema.compiledImplicit,this.typeMap=this.schema.compiledTypeMap,this.length=t.length,this.position=0,this.line=0,this.lineStart=0,this.lineIndent=0,this.firstTabInLine=-1,this.documents=[]}s(c1r,"State$1");function Rht(t,e){var r={name:t.filename,buffer:t.input.slice(0,-1),position:t.position,line:t.line,column:t.position-t.lineStart};return r.snippet=Kyr(r),new Jp(e,r)}s(Rht,"generateError");function mn(t,e){throw Rht(t,e)}s(mn,"throwError");function Kse(t,e){t.onWarning&&t.onWarning.call(null,Rht(t,e))}s(Kse,"throwWarning");var aht={YAML:s(function(e,r,n){var i,o,a;e.version!==null&&mn(e,"duplication of %YAML directive"),n.length!==1&&mn(e,"YAML directive accepts exactly one argument"),i=/^([0-9]+)\.([0-9]+)$/.exec(n[0]),i===null&&mn(e,"ill-formed argument of the YAML directive"),o=parseInt(i[1],10),a=parseInt(i[2],10),o!==1&&mn(e,"unacceptable YAML version of the document"),e.version=n[0],e.checkLineBreaks=a<2,a!==1&&a!==2&&Kse(e,"unsupported YAML version of the document")},"handleYamlDirective"),TAG:s(function(e,r,n){var i,o;n.length!==2&&mn(e,"TAG directive accepts exactly two arguments"),i=n[0],o=n[1],Tht.test(i)||mn(e,"ill-formed tag handle (first argument) of the TAG directive"),vS.call(e.tagMap,i)&&mn(e,'there is a previously declared suffix for "'+i+'" tag handle'),wht.test(o)||mn(e,"ill-formed tag prefix (second argument) of the TAG directive");try{o=decodeURIComponent(o)}catch{mn(e,"tag prefix is malformed: "+o)}e.tagMap[i]=o},"handleTagDirective")};function CS(t,e,r,n){var i,o,a,c;if(e<r){if(c=t.input.slice(e,r),n)for(i=0,o=c.length;i<o;i+=1)a=c.charCodeAt(i),a===9||32<=a&&a<=1114111||mn(t,"expected valid JSON character");else t1r.test(c)&&mn(t,"the stream contains non-printable characters");t.result+=c}}s(CS,"captureSegment");function cht(t,e,r,n){var i,o,a,c;for(Hl.isObject(r)||mn(t,"cannot merge mappings; the provided source object is unacceptable"),i=Object.keys(r),a=0,c=i.length;a<c;a+=1)o=i[a],vS.call(e,o)||(e[o]=r[o],n[o]=!0)}s(cht,"mergeMappings");function mM(t,e,r,n,i,o,a,c,l){var u,f;if(Array.isArray(i))for(i=Array.prototype.slice.call(i),u=0,f=i.length;u<f;u+=1)Array.isArray(i[u])&&mn(t,"nested arrays are not supported inside keys"),typeof i=="object"&&oht(i[u])==="[object Object]"&&(i[u]="[object Object]");if(typeof i=="object"&&oht(i)==="[object Object]"&&(i="[object Object]"),i=String(i),e===null&&(e={}),n==="tag:yaml.org,2002:merge")if(Array.isArray(o))for(u=0,f=o.length;u<f;u+=1)cht(t,e,o[u],r);else cht(t,e,o,r);else!t.json&&!vS.call(r,i)&&vS.call(e,i)&&(t.line=a||t.line,t.lineStart=c||t.lineStart,t.position=l||t.position,mn(t,"duplicated mapping key")),i==="__proto__"?Object.defineProperty(e,i,{configurable:!0,enumerable:!0,writable:!0,value:o}):e[i]=o,delete r[i];return e}s(mM,"storeMappingPair");function ske(t){var e;e=t.input.charCodeAt(t.position),e===10?t.position++:e===13?(t.position++,t.input.charCodeAt(t.position)===10&&t.position++):mn(t,"a line break is expected"),t.line+=1,t.lineStart=t.position,t.firstTabInLine=-1}s(ske,"readLineBreak");function El(t,e,r){for(var n=0,i=t.input.charCodeAt(t.position);i!==0;){for(;TP(i);)i===9&&t.firstTabInLine===-1&&(t.firstTabInLine=t.position),i=t.input.charCodeAt(++t.position);if(e&&i===35)do i=t.input.charCodeAt(++t.position);while(i!==10&&i!==13&&i!==0);if(G1(i))for(ske(t),i=t.input.charCodeAt(t.position),n++,t.lineIndent=0;i===32;)t.lineIndent++,i=t.input.charCodeAt(++t.position);else break}return r!==-1&&n!==0&&t.lineIndent<r&&Kse(t,"deficient indentation"),n}s(El,"skipSeparationSpace");function Xse(t){var e=t.position,r;return r=t.input.charCodeAt(e),!!((r===45||r===46)&&r===t.input.charCodeAt(e+1)&&r===t.input.charCodeAt(e+2)&&(e+=3,r=t.input.charCodeAt(e),r===0||Xp(r)))}s(Xse,"testDocumentSeparator");function ake(t,e){e===1?t.result+=" ":e>1&&(t.result+=Hl.repeat(`
`,e-1))}s(ake,"writeFoldedLines");function l1r(t,e,r){var n,i,o,a,c,l,u,f,p=t.kind,m=t.result,h;if(h=t.input.charCodeAt(t.position),Xp(h)||pM(h)||h===35||h===38||h===42||h===33||h===124||h===62||h===39||h===34||h===37||h===64||h===96||(h===63||h===45)&&(i=t.input.charCodeAt(t.position+1),Xp(i)||r&&pM(i)))return!1;for(t.kind="scalar",t.result="",o=a=t.position,c=!1;h!==0;){if(h===58){if(i=t.input.charCodeAt(t.position+1),Xp(i)||r&&pM(i))break}else if(h===35){if(n=t.input.charCodeAt(t.position-1),Xp(n))break}else{if(t.position===t.lineStart&&Xse(t)||r&&pM(h))break;if(G1(h))if(l=t.line,u=t.lineStart,f=t.lineIndent,El(t,!1,-1),t.lineIndent>=e){c=!0,h=t.input.charCodeAt(t.position);continue}else{t.position=a,t.line=l,t.lineStart=u,t.lineIndent=f;break}}c&&(CS(t,o,a,!1),ake(t,t.line-l),o=a=t.position,c=!1),TP(h)||(a=t.position+1),h=t.input.charCodeAt(++t.position)}return CS(t,o,a,!1),t.result?!0:(t.kind=p,t.result=m,!1)}s(l1r,"readPlainScalar");function u1r(t,e){var r,n,i;if(r=t.input.charCodeAt(t.position),r!==39)return!1;for(t.kind="scalar",t.result="",t.position++,n=i=t.position;(r=t.input.charCodeAt(t.position))!==0;)if(r===39)if(CS(t,n,t.position,!0),r=t.input.charCodeAt(++t.position),r===39)n=t.position,t.position++,i=t.position;else return!0;else G1(r)?(CS(t,n,i,!0),ake(t,El(t,!1,e)),n=i=t.position):t.position===t.lineStart&&Xse(t)?mn(t,"unexpected end of the document within a single quoted scalar"):(t.position++,i=t.position);mn(t,"unexpected end of the stream within a single quoted scalar")}s(u1r,"readSingleQuotedScalar");function d1r(t,e){var r,n,i,o,a,c;if(c=t.input.charCodeAt(t.position),c!==34)return!1;for(t.kind="scalar",t.result="",t.position++,r=n=t.position;(c=t.input.charCodeAt(t.position))!==0;){if(c===34)return CS(t,r,t.position,!0),t.position++,!0;if(c===92){if(CS(t,r,t.position,!0),c=t.input.charCodeAt(++t.position),G1(c))El(t,!1,e);else if(c<256&&Sht[c])t.result+=_ht[c],t.position++;else if((a=o1r(c))>0){for(i=a,o=0;i>0;i--)c=t.input.charCodeAt(++t.position),(a=i1r(c))>=0?o=(o<<4)+a:mn(t,"expected hexadecimal character");t.result+=a1r(o),t.position++}else mn(t,"unknown escape sequence");r=n=t.position}else G1(c)?(CS(t,r,n,!0),ake(t,El(t,!1,e)),r=n=t.position):t.position===t.lineStart&&Xse(t)?mn(t,"unexpected end of the document within a double quoted scalar"):(t.position++,n=t.position)}mn(t,"unexpected end of the stream within a double quoted scalar")}s(d1r,"readDoubleQuotedScalar");function f1r(t,e){var r=!0,n,i,o,a=t.tag,c,l=t.anchor,u,f,p,m,h,g=Object.create(null),A,y,E,b;if(b=t.input.charCodeAt(t.position),b===91)f=93,h=!1,c=[];else if(b===123)f=125,h=!0,c={};else return!1;for(t.anchor!==null&&(t.anchorMap[t.anchor]=c),b=t.input.charCodeAt(++t.position);b!==0;){if(El(t,!0,e),b=t.input.charCodeAt(t.position),b===f)return t.position++,t.tag=a,t.anchor=l,t.kind=h?"mapping":"sequence",t.result=c,!0;r?b===44&&mn(t,"expected the node content, but found ','"):mn(t,"missed comma between flow collection entries"),y=A=E=null,p=m=!1,b===63&&(u=t.input.charCodeAt(t.position+1),Xp(u)&&(p=m=!0,t.position++,El(t,!0,e))),n=t.line,i=t.lineStart,o=t.position,hM(t,e,Vse,!1,!0),y=t.tag,A=t.result,El(t,!0,e),b=t.input.charCodeAt(t.position),(m||t.line===n)&&b===58&&(p=!0,b=t.input.charCodeAt(++t.position),El(t,!0,e),hM(t,e,Vse,!1,!0),E=t.result),h?mM(t,c,g,y,A,E,n,i,o):p?c.push(mM(t,null,g,y,A,E,n,i,o)):c.push(A),El(t,!0,e),b=t.input.charCodeAt(t.position),b===44?(r=!0,b=t.input.charCodeAt(++t.position)):r=!1}mn(t,"unexpected end of the stream within a flow collection")}s(f1r,"readFlowCollection");function p1r(t,e){var r,n,i=ZRe,o=!1,a=!1,c=e,l=0,u=!1,f,p;if(p=t.input.charCodeAt(t.position),p===124)n=!1;else if(p===62)n=!0;else return!1;for(t.kind="scalar",t.result="";p!==0;)if(p=t.input.charCodeAt(++t.position),p===43||p===45)ZRe===i?i=p===43?iht:e1r:mn(t,"repeat of a chomping mode identifier");else if((f=s1r(p))>=0)f===0?mn(t,"bad explicit indentation width of a block scalar; it cannot be less than one"):a?mn(t,"repeat of an indentation width identifier"):(c=e+f-1,a=!0);else break;if(TP(p)){do p=t.input.charCodeAt(++t.position);while(TP(p));if(p===35)do p=t.input.charCodeAt(++t.position);while(!G1(p)&&p!==0)}for(;p!==0;){for(ske(t),t.lineIndent=0,p=t.input.charCodeAt(t.position);(!a||t.lineIndent<c)&&p===32;)t.lineIndent++,p=t.input.charCodeAt(++t.position);if(!a&&t.lineIndent>c&&(c=t.lineIndent),G1(p)){l++;continue}if(t.lineIndent<c){i===iht?t.result+=Hl.repeat(`
`,o?1+l:l):i===ZRe&&o&&(t.result+=`
`);break}for(n?TP(p)?(u=!0,t.result+=Hl.repeat(`
`,o?1+l:l)):u?(u=!1,t.result+=Hl.repeat(`
`,l+1)):l===0?o&&(t.result+=" "):t.result+=Hl.repeat(`
`,l):t.result+=Hl.repeat(`
`,o?1+l:l),o=!0,a=!0,l=0,r=t.position;!G1(p)&&p!==0;)p=t.input.charCodeAt(++t.position);CS(t,r,t.position,!1)}return!0}s(p1r,"readBlockScalar");function lht(t,e){var r,n=t.tag,i=t.anchor,o=[],a,c=!1,l;if(t.firstTabInLine!==-1)return!1;for(t.anchor!==null&&(t.anchorMap[t.anchor]=o),l=t.input.charCodeAt(t.position);l!==0&&(t.firstTabInLine!==-1&&(t.position=t.firstTabInLine,mn(t,"tab characters must not be used in indentation")),!(l!==45||(a=t.input.charCodeAt(t.position+1),!Xp(a))));){if(c=!0,t.position++,El(t,!0,-1)&&t.lineIndent<=e){o.push(null),l=t.input.charCodeAt(t.position);continue}if(r=t.line,hM(t,e,Iht,!1,!0),o.push(t.result),El(t,!0,-1),l=t.input.charCodeAt(t.position),(t.line===r||t.lineIndent>e)&&l!==0)mn(t,"bad indentation of a sequence entry");else if(t.lineIndent<e)break}return c?(t.tag=n,t.anchor=i,t.kind="sequence",t.result=o,!0):!1}s(lht,"readBlockSequence");function m1r(t,e,r){var n,i,o,a,c,l,u=t.tag,f=t.anchor,p={},m=Object.create(null),h=null,g=null,A=null,y=!1,E=!1,b;if(t.firstTabInLine!==-1)return!1;for(t.anchor!==null&&(t.anchorMap[t.anchor]=p),b=t.input.charCodeAt(t.position);b!==0;){if(!y&&t.firstTabInLine!==-1&&(t.position=t.firstTabInLine,mn(t,"tab characters must not be used in indentation")),n=t.input.charCodeAt(t.position+1),o=t.line,(b===63||b===58)&&Xp(n))b===63?(y&&(mM(t,p,m,h,g,null,a,c,l),h=g=A=null),E=!0,y=!0,i=!0):y?(y=!1,i=!0):mn(t,"incomplete explicit mapping pair; a key node is missed; or followed by a non-tabulated empty line"),t.position+=1,b=n;else{if(a=t.line,c=t.lineStart,l=t.position,!hM(t,r,bht,!1,!0))break;if(t.line===o){for(b=t.input.charCodeAt(t.position);TP(b);)b=t.input.charCodeAt(++t.position);if(b===58)b=t.input.charCodeAt(++t.position),Xp(b)||mn(t,"a whitespace character is expected after the key-value separator within a block mapping"),y&&(mM(t,p,m,h,g,null,a,c,l),h=g=A=null),E=!0,y=!1,i=!1,h=t.tag,g=t.result;else if(E)mn(t,"can not read an implicit mapping pair; a colon is missed");else return t.tag=u,t.anchor=f,!0}else if(E)mn(t,"can not read a block mapping entry; a multiline key may not be an implicit key");else return t.tag=u,t.anchor=f,!0}if((t.line===o||t.lineIndent>e)&&(y&&(a=t.line,c=t.lineStart,l=t.position),hM(t,e,zse,!0,i)&&(y?g=t.result:A=t.result),y||(mM(t,p,m,h,g,A,a,c,l),h=g=A=null),El(t,!0,-1),b=t.input.charCodeAt(t.position)),(t.line===o||t.lineIndent>e)&&b!==0)mn(t,"bad indentation of a mapping entry");else if(t.lineIndent<e)break}return y&&mM(t,p,m,h,g,null,a,c,l),E&&(t.tag=u,t.anchor=f,t.kind="mapping",t.result=p),E}s(m1r,"readBlockMapping");function h1r(t){var e,r=!1,n=!1,i,o,a;if(a=t.input.charCodeAt(t.position),a!==33)return!1;if(t.tag!==null&&mn(t,"duplication of a tag property"),a=t.input.charCodeAt(++t.position),a===60?(r=!0,a=t.input.charCodeAt(++t.position)):a===33?(n=!0,i="!!",a=t.input.charCodeAt(++t.position)):i="!",e=t.position,r){do a=t.input.charCodeAt(++t.position);while(a!==0&&a!==62);t.position<t.length?(o=t.input.slice(e,t.position),a=t.input.charCodeAt(++t.position)):mn(t,"unexpected end of the stream within a verbatim tag")}else{for(;a!==0&&!Xp(a);)a===33&&(n?mn(t,"tag suffix cannot contain exclamation marks"):(i=t.input.slice(e-1,t.position+1),Tht.test(i)||mn(t,"named tag handle cannot contain such characters"),n=!0,e=t.position+1)),a=t.input.charCodeAt(++t.position);o=t.input.slice(e,t.position),n1r.test(o)&&mn(t,"tag suffix cannot contain flow indicator characters")}o&&!wht.test(o)&&mn(t,"tag name cannot contain such characters: "+o);try{o=decodeURIComponent(o)}catch{mn(t,"tag name is malformed: "+o)}return r?t.tag=o:vS.call(t.tagMap,i)?t.tag=t.tagMap[i]+o:i==="!"?t.tag="!"+o:i==="!!"?t.tag="tag:yaml.org,2002:"+o:mn(t,'undeclared tag handle "'+i+'"'),!0}s(h1r,"readTagProperty");function g1r(t){var e,r;if(r=t.input.charCodeAt(t.position),r!==38)return!1;for(t.anchor!==null&&mn(t,"duplication of an anchor property"),r=t.input.charCodeAt(++t.position),e=t.position;r!==0&&!Xp(r)&&!pM(r);)r=t.input.charCodeAt(++t.position);return t.position===e&&mn(t,"name of an anchor node must contain at least one character"),t.anchor=t.input.slice(e,t.position),!0}s(g1r,"readAnchorProperty");function A1r(t){var e,r,n;if(n=t.input.charCodeAt(t.position),n!==42)return!1;for(n=t.input.charCodeAt(++t.position),e=t.position;n!==0&&!Xp(n)&&!pM(n);)n=t.input.charCodeAt(++t.position);return t.position===e&&mn(t,"name of an alias node must contain at least one character"),r=t.input.slice(e,t.position),vS.call(t.anchorMap,r)||mn(t,'unidentified alias "'+r+'"'),t.result=t.anchorMap[r],El(t,!0,-1),!0}s(A1r,"readAlias");function hM(t,e,r,n,i){var o,a,c,l=1,u=!1,f=!1,p,m,h,g,A,y;if(t.listener!==null&&t.listener("open",t),t.tag=null,t.anchor=null,t.kind=null,t.result=null,o=a=c=zse===r||Iht===r,n&&El(t,!0,-1)&&(u=!0,t.lineIndent>e?l=1:t.lineIndent===e?l=0:t.lineIndent<e&&(l=-1)),l===1)for(;h1r(t)||g1r(t);)El(t,!0,-1)?(u=!0,c=o,t.lineIndent>e?l=1:t.lineIndent===e?l=0:t.lineIndent<e&&(l=-1)):c=!1;if(c&&(c=u||i),(l===1||zse===r)&&(Vse===r||bht===r?A=e:A=e+1,y=t.position-t.lineStart,l===1?c&&(lht(t,y)||m1r(t,y,A))||f1r(t,A)?f=!0:(a&&p1r(t,A)||u1r(t,A)||d1r(t,A)?f=!0:A1r(t)?(f=!0,(t.tag!==null||t.anchor!==null)&&mn(t,"alias node should not have any properties")):l1r(t,A,Vse===r)&&(f=!0,t.tag===null&&(t.tag="?")),t.anchor!==null&&(t.anchorMap[t.anchor]=t.result)):l===0&&(f=c&&lht(t,y))),t.tag===null)t.anchor!==null&&(t.anchorMap[t.anchor]=t.result);else if(t.tag==="?"){for(t.result!==null&&t.kind!=="scalar"&&mn(t,'unacceptable node kind for !<?> tag; it should be "scalar", not "'+t.kind+'"'),p=0,m=t.implicitTypes.length;p<m;p+=1)if(g=t.implicitTypes[p],g.resolve(t.result)){t.result=g.construct(t.result),t.tag=g.tag,t.anchor!==null&&(t.anchorMap[t.anchor]=t.result);break}}else if(t.tag!=="!"){if(vS.call(t.typeMap[t.kind||"fallback"],t.tag))g=t.typeMap[t.kind||"fallback"][t.tag];else for(g=null,h=t.typeMap.multi[t.kind||"fallback"],p=0,m=h.length;p<m;p+=1)if(t.tag.slice(0,h[p].tag.length)===h[p].tag){g=h[p];break}g||mn(t,"unknown tag !<"+t.tag+">"),t.result!==null&&g.kind!==t.kind&&mn(t,"unacceptable node kind for !<"+t.tag+'> tag; it should be "'+g.kind+'", not "'+t.kind+'"'),g.resolve(t.result,t.tag)?(t.result=g.construct(t.result,t.tag),t.anchor!==null&&(t.anchorMap[t.anchor]=t.result)):mn(t,"cannot resolve a node with !<"+t.tag+"> explicit tag")}return t.listener!==null&&t.listener("close",t),t.tag!==null||t.anchor!==null||f}s(hM,"composeNode");function y1r(t){var e=t.position,r,n,i,o=!1,a;for(t.version=null,t.checkLineBreaks=t.legacy,t.tagMap=Object.create(null),t.anchorMap=Object.create(null);(a=t.input.charCodeAt(t.position))!==0&&(El(t,!0,-1),a=t.input.charCodeAt(t.position),!(t.lineIndent>0||a!==37));){for(o=!0,a=t.input.charCodeAt(++t.position),r=t.position;a!==0&&!Xp(a);)a=t.input.charCodeAt(++t.position);for(n=t.input.slice(r,t.position),i=[],n.length<1&&mn(t,"directive name must not be less than one character in length");a!==0;){for(;TP(a);)a=t.input.charCodeAt(++t.position);if(a===35){do a=t.input.charCodeAt(++t.position);while(a!==0&&!G1(a));break}if(G1(a))break;for(r=t.position;a!==0&&!Xp(a);)a=t.input.charCodeAt(++t.position);i.push(t.input.slice(r,t.position))}a!==0&&ske(t),vS.call(aht,n)?aht[n](t,n,i):Kse(t,'unknown document directive "'+n+'"')}if(El(t,!0,-1),t.lineIndent===0&&t.input.charCodeAt(t.position)===45&&t.input.charCodeAt(t.position+1)===45&&t.input.charCodeAt(t.position+2)===45?(t.position+=3,El(t,!0,-1)):o&&mn(t,"directives end mark is expected"),hM(t,t.lineIndent-1,zse,!1,!0),El(t,!0,-1),t.checkLineBreaks&&r1r.test(t.input.slice(e,t.position))&&Kse(t,"non-ASCII line breaks are interpreted as content"),t.documents.push(t.result),t.position===t.lineStart&&Xse(t)){t.input.charCodeAt(t.position)===46&&(t.position+=3,El(t,!0,-1));return}if(t.position<t.length-1)mn(t,"end of the stream or a document separator is expected");else return}s(y1r,"readDocument");function kht(t,e){t=String(t),e=e||{},t.length!==0&&(t.charCodeAt(t.length-1)!==10&&t.charCodeAt(t.length-1)!==13&&(t+=`
`),t.charCodeAt(0)===65279&&(t=t.slice(1)));var r=new c1r(t,e),n=t.indexOf("\0");for(n!==-1&&(r.position=n,mn(r,"null byte is not allowed in input")),r.input+="\0";r.input.charCodeAt(r.position)===32;)r.lineIndent+=1,r.position+=1;for(;r.position<r.length-1;)y1r(r);return r.documents}s(kht,"loadDocuments");function C1r(t,e,r){e!==null&&typeof e=="object"&&typeof r>"u"&&(r=e,e=null);var n=kht(t,r);if(typeof e!="function")return n;for(var i=0,o=n.length;i<o;i+=1)e(n[i])}s(C1r,"loadAll$1");function v1r(t,e){var r=kht(t,e);if(r.length!==0){if(r.length===1)return r[0];throw new Jp("expected a single document in the stream, but found more")}}s(v1r,"load$1");var x1r=C1r,E1r=v1r,Pht={loadAll:x1r,load:E1r},Dht=Object.prototype.toString,Bht=Object.prototype.hasOwnProperty,cke=65279,b1r=9,Qq=10,I1r=13,T1r=32,w1r=33,S1r=34,tke=35,_1r=37,R1r=38,k1r=39,P1r=42,Nht=44,D1r=45,Yse=58,B1r=61,N1r=62,M1r=63,L1r=64,Mht=91,Lht=93,F1r=96,Fht=123,O1r=124,Oht=125,rf={};rf[0]="\\0";rf[7]="\\a";rf[8]="\\b";rf[9]="\\t";rf[10]="\\n";rf[11]="\\v";rf[12]="\\f";rf[13]="\\r";rf[27]="\\e";rf[34]='\\"';rf[92]="\\\\";rf[133]="\\N";rf[160]="\\_";rf[8232]="\\L";rf[8233]="\\P";var Q1r=["y","Y","yes","Yes","YES","on","On","ON","n","N","no","No","NO","off","Off","OFF"],U1r=/^[-+]?[0-9_]+(?::[0-9_]+)+(?:\.[0-9_]*)?$/;function q1r(t,e){var r,n,i,o,a,c,l;if(e===null)return{};for(r={},n=Object.keys(e),i=0,o=n.length;i<o;i+=1)a=n[i],c=String(e[a]),a.slice(0,2)==="!!"&&(a="tag:yaml.org,2002:"+a.slice(2)),l=t.compiledTypeMap.fallback[a],l&&Bht.call(l.styleAliases,c)&&(c=l.styleAliases[c]),r[a]=c;return r}s(q1r,"compileStyleMap");function H1r(t){var e,r,n;if(e=t.toString(16).toUpperCase(),t<=255)r="x",n=2;else if(t<=65535)r="u",n=4;else if(t<=4294967295)r="U",n=8;else throw new Jp("code point within a string may not be greater than 0xFFFFFFFF");return"\\"+r+Hl.repeat("0",n-e.length)+e}s(H1r,"encodeHex");var $1r=1,Uq=2;function W1r(t){this.schema=t.schema||Eht,this.indent=Math.max(1,t.indent||2),this.noArrayIndent=t.noArrayIndent||!1,this.skipInvalid=t.skipInvalid||!1,this.flowLevel=Hl.isNothing(t.flowLevel)?-1:t.flowLevel,this.styleMap=q1r(this.schema,t.styles||null),this.sortKeys=t.sortKeys||!1,this.lineWidth=t.lineWidth||80,this.noRefs=t.noRefs||!1,this.noCompatMode=t.noCompatMode||!1,this.condenseFlow=t.condenseFlow||!1,this.quotingType=t.quotingType==='"'?Uq:$1r,this.forceQuotes=t.forceQuotes||!1,this.replacer=typeof t.replacer=="function"?t.replacer:null,this.implicitTypes=this.schema.compiledImplicit,this.explicitTypes=this.schema.compiledExplicit,this.tag=null,this.result="",this.duplicates=[],this.usedDuplicates=null}s(W1r,"State");function uht(t,e){for(var r=Hl.repeat(" ",e),n=0,i=-1,o="",a,c=t.length;n<c;)i=t.indexOf(`
`,n),i===-1?(a=t.slice(n),n=c):(a=t.slice(n,i+1),n=i+1),a.length&&a!==`
`&&(o+=r),o+=a;return o}s(uht,"indentString");function rke(t,e){return`
`+Hl.repeat(" ",t.indent*e)}s(rke,"generateNextLine");function j1r(t,e){var r,n,i;for(r=0,n=t.implicitTypes.length;r<n;r+=1)if(i=t.implicitTypes[r],i.resolve(e))return!0;return!1}s(j1r,"testImplicitResolving");function Jse(t){return t===T1r||t===b1r}s(Jse,"isWhitespace");function qq(t){return 32<=t&&t<=126||161<=t&&t<=55295&&t!==8232&&t!==8233||57344<=t&&t<=65533&&t!==cke||65536<=t&&t<=1114111}s(qq,"isPrintable");function dht(t){return qq(t)&&t!==cke&&t!==I1r&&t!==Qq}s(dht,"isNsCharOrWhitespace");function fht(t,e,r){var n=dht(t),i=n&&!Jse(t);return(r?n:n&&t!==Nht&&t!==Mht&&t!==Lht&&t!==Fht&&t!==Oht)&&t!==tke&&!(e===Yse&&!i)||dht(e)&&!Jse(e)&&t===tke||e===Yse&&i}s(fht,"isPlainSafe");function G1r(t){return qq(t)&&t!==cke&&!Jse(t)&&t!==D1r&&t!==M1r&&t!==Yse&&t!==Nht&&t!==Mht&&t!==Lht&&t!==Fht&&t!==Oht&&t!==tke&&t!==R1r&&t!==P1r&&t!==w1r&&t!==O1r&&t!==B1r&&t!==N1r&&t!==k1r&&t!==S1r&&t!==_1r&&t!==L1r&&t!==F1r}s(G1r,"isPlainSafeFirst");function V1r(t){return!Jse(t)&&t!==Yse}s(V1r,"isPlainSafeLast");function Fq(t,e){var r=t.charCodeAt(e),n;return r>=55296&&r<=56319&&e+1<t.length&&(n=t.charCodeAt(e+1),n>=56320&&n<=57343)?(r-55296)*1024+n-56320+65536:r}s(Fq,"codePointAt");function Qht(t){var e=/^\n* /;return e.test(t)}s(Qht,"needIndentIndicator");var Uht=1,nke=2,qht=3,Hht=4,fM=5;function z1r(t,e,r,n,i,o,a,c){var l,u=0,f=null,p=!1,m=!1,h=n!==-1,g=-1,A=G1r(Fq(t,0))&&V1r(Fq(t,t.length-1));if(e||a)for(l=0;l<t.length;u>=65536?l+=2:l++){if(u=Fq(t,l),!qq(u))return fM;A=A&&fht(u,f,c),f=u}else{for(l=0;l<t.length;u>=65536?l+=2:l++){if(u=Fq(t,l),u===Qq)p=!0,h&&(m=m||l-g-1>n&&t[g+1]!==" ",g=l);else if(!qq(u))return fM;A=A&&fht(u,f,c),f=u}m=m||h&&l-g-1>n&&t[g+1]!==" "}return!p&&!m?A&&!a&&!i(t)?Uht:o===Uq?fM:nke:r>9&&Qht(t)?fM:a?o===Uq?fM:nke:m?Hht:qht}s(z1r,"chooseScalarStyle");function K1r(t,e,r,n,i){t.dump=function(){if(e.length===0)return t.quotingType===Uq?'""':"''";if(!t.noCompatMode&&(Q1r.indexOf(e)!==-1||U1r.test(e)))return t.quotingType===Uq?'"'+e+'"':"'"+e+"'";var o=t.indent*Math.max(1,r),a=t.lineWidth===-1?-1:Math.max(Math.min(t.lineWidth,40),t.lineWidth-o),c=n||t.flowLevel>-1&&r>=t.flowLevel;function l(u){return j1r(t,u)}switch(s(l,"testAmbiguity"),z1r(e,c,t.indent,a,l,t.quotingType,t.forceQuotes&&!n,i)){case Uht:return e;case nke:return"'"+e.replace(/'/g,"''")+"'";case qht:return"|"+pht(e,t.indent)+mht(uht(e,o));case Hht:return">"+pht(e,t.indent)+mht(uht(Y1r(e,a),o));case fM:return'"'+J1r(e)+'"';default:throw new Jp("impossible error: invalid scalar style")}}()}s(K1r,"writeScalar");function pht(t,e){var r=Qht(t)?String(e):"",n=t[t.length-1]===`
`,i=n&&(t[t.length-2]===`
`||t===`
`),o=i?"+":n?"":"-";return r+o+`
`}s(pht,"blockHeader");function mht(t){return t[t.length-1]===`
`?t.slice(0,-1):t}s(mht,"dropEndingNewline");function Y1r(t,e){for(var r=/(\n+)([^\n]*)/g,n=function(){var u=t.indexOf(`
`);return u=u!==-1?u:t.length,r.lastIndex=u,hht(t.slice(0,u),e)}(),i=t[0]===`
`||t[0]===" ",o,a;a=r.exec(t);){var c=a[1],l=a[2];o=l[0]===" ",n+=c+(!i&&!o&&l!==""?`
`:"")+hht(l,e),i=o}return n}s(Y1r,"foldString");function hht(t,e){if(t===""||t[0]===" ")return t;for(var r=/ [^ ]/g,n,i=0,o,a=0,c=0,l="";n=r.exec(t);)c=n.index,c-i>e&&(o=a>i?a:c,l+=`
`+t.slice(i,o),i=o+1),a=c;return l+=`
`,t.length-i>e&&a>i?l+=t.slice(i,a)+`
`+t.slice(a+1):l+=t.slice(i),l.slice(1)}s(hht,"foldLine");function J1r(t){for(var e="",r=0,n,i=0;i<t.length;r>=65536?i+=2:i++)r=Fq(t,i),n=rf[r],!n&&qq(r)?(e+=t[i],r>=65536&&(e+=t[i+1])):e+=n||H1r(r);return e}s(J1r,"escapeString");function X1r(t,e,r){var n="",i=t.tag,o,a,c;for(o=0,a=r.length;o<a;o+=1)c=r[o],t.replacer&&(c=t.replacer.call(r,String(o),c)),(BE(t,e,c,!1,!1)||typeof c>"u"&&BE(t,e,null,!1,!1))&&(n!==""&&(n+=","+(t.condenseFlow?"":" ")),n+=t.dump);t.tag=i,t.dump="["+n+"]"}s(X1r,"writeFlowSequence");function ght(t,e,r,n){var i="",o=t.tag,a,c,l;for(a=0,c=r.length;a<c;a+=1)l=r[a],t.replacer&&(l=t.replacer.call(r,String(a),l)),(BE(t,e+1,l,!0,!0,!1,!0)||typeof l>"u"&&BE(t,e+1,null,!0,!0,!1,!0))&&((!n||i!=="")&&(i+=rke(t,e)),t.dump&&Qq===t.dump.charCodeAt(0)?i+="-":i+="- ",i+=t.dump);t.tag=o,t.dump=i||"[]"}s(ght,"writeBlockSequence");function Z1r(t,e,r){var n="",i=t.tag,o=Object.keys(r),a,c,l,u,f;for(a=0,c=o.length;a<c;a+=1)f="",n!==""&&(f+=", "),t.condenseFlow&&(f+='"'),l=o[a],u=r[l],t.replacer&&(u=t.replacer.call(r,l,u)),BE(t,e,l,!1,!1)&&(t.dump.length>1024&&(f+="? "),f+=t.dump+(t.condenseFlow?'"':"")+":"+(t.condenseFlow?"":" "),BE(t,e,u,!1,!1)&&(f+=t.dump,n+=f));t.tag=i,t.dump="{"+n+"}"}s(Z1r,"writeFlowMapping");function evr(t,e,r,n){var i="",o=t.tag,a=Object.keys(r),c,l,u,f,p,m;if(t.sortKeys===!0)a.sort();else if(typeof t.sortKeys=="function")a.sort(t.sortKeys);else if(t.sortKeys)throw new Jp("sortKeys must be a boolean or a function");for(c=0,l=a.length;c<l;c+=1)m="",(!n||i!=="")&&(m+=rke(t,e)),u=a[c],f=r[u],t.replacer&&(f=t.replacer.call(r,u,f)),BE(t,e+1,u,!0,!0,!0)&&(p=t.tag!==null&&t.tag!=="?"||t.dump&&t.dump.length>1024,p&&(t.dump&&Qq===t.dump.charCodeAt(0)?m+="?":m+="? "),m+=t.dump,p&&(m+=rke(t,e)),BE(t,e+1,f,!0,p)&&(t.dump&&Qq===t.dump.charCodeAt(0)?m+=":":m+=": ",m+=t.dump,i+=m));t.tag=o,t.dump=i||"{}"}s(evr,"writeBlockMapping");function Aht(t,e,r){var n,i,o,a,c,l;for(i=r?t.explicitTypes:t.implicitTypes,o=0,a=i.length;o<a;o+=1)if(c=i[o],(c.instanceOf||c.predicate)&&(!c.instanceOf||typeof e=="object"&&e instanceof c.instanceOf)&&(!c.predicate||c.predicate(e))){if(r?c.multi&&c.representName?t.tag=c.representName(e):t.tag=c.tag:t.tag="?",c.represent){if(l=t.styleMap[c.tag]||c.defaultStyle,Dht.call(c.represent)==="[object Function]")n=c.represent(e,l);else if(Bht.call(c.represent,l))n=c.represent[l](e,l);else throw new Jp("!<"+c.tag+'> tag resolver accepts not "'+l+'" style');t.dump=n}return!0}return!1}s(Aht,"detectType");function BE(t,e,r,n,i,o,a){t.tag=null,t.dump=r,Aht(t,r,!1)||Aht(t,r,!0);var c=Dht.call(t.dump),l=n,u;n&&(n=t.flowLevel<0||t.flowLevel>e);var f=c==="[object Object]"||c==="[object Array]",p,m;if(f&&(p=t.duplicates.indexOf(r),m=p!==-1),(t.tag!==null&&t.tag!=="?"||m||t.indent!==2&&e>0)&&(i=!1),m&&t.usedDuplicates[p])t.dump="*ref_"+p;else{if(f&&m&&!t.usedDuplicates[p]&&(t.usedDuplicates[p]=!0),c==="[object Object]")n&&Object.keys(t.dump).length!==0?(evr(t,e,t.dump,i),m&&(t.dump="&ref_"+p+t.dump)):(Z1r(t,e,t.dump),m&&(t.dump="&ref_"+p+" "+t.dump));else if(c==="[object Array]")n&&t.dump.length!==0?(t.noArrayIndent&&!a&&e>0?ght(t,e-1,t.dump,i):ght(t,e,t.dump,i),m&&(t.dump="&ref_"+p+t.dump)):(X1r(t,e,t.dump),m&&(t.dump="&ref_"+p+" "+t.dump));else if(c==="[object String]")t.tag!=="?"&&K1r(t,t.dump,e,o,l);else{if(c==="[object Undefined]")return!1;if(t.skipInvalid)return!1;throw new Jp("unacceptable kind of an object to dump "+c)}t.tag!==null&&t.tag!=="?"&&(u=encodeURI(t.tag[0]==="!"?t.tag.slice(1):t.tag).replace(/!/g,"%21"),t.tag[0]==="!"?u="!"+u:u.slice(0,18)==="tag:yaml.org,2002:"?u="!!"+u.slice(18):u="!<"+u+">",t.dump=u+" "+t.dump)}return!0}s(BE,"writeNode");function tvr(t,e){var r=[],n=[],i,o;for(ike(t,r,n),i=0,o=n.length;i<o;i+=1)e.duplicates.push(r[n[i]]);e.usedDuplicates=new Array(o)}s(tvr,"getDuplicateReferences");function ike(t,e,r){var n,i,o;if(t!==null&&typeof t=="object")if(i=e.indexOf(t),i!==-1)r.indexOf(i)===-1&&r.push(i);else if(e.push(t),Array.isArray(t))for(i=0,o=t.length;i<o;i+=1)ike(t[i],e,r);else for(n=Object.keys(t),i=0,o=n.length;i<o;i+=1)ike(t[n[i]],e,r)}s(ike,"inspectNode");function rvr(t,e){e=e||{};var r=new W1r(e);r.noRefs||tvr(t,r);var n=t;return r.replacer&&(n=r.replacer.call({"":n},"",n)),BE(r,0,n,!0,!0)?r.dump+`
`:""}s(rvr,"dump$1");var nvr=rvr,ivr={dump:nvr};function lke(t,e){return function(){throw new Error("Function yaml."+t+" is removed in js-yaml 4. Use yaml."+e+" instead, which is now safe by default.")}}s(lke,"renamed");var WJi=Pht.load,jJi=Pht.loadAll,uke=ivr.dump;var GJi=lke("safeLoad","load"),VJi=lke("safeLoadAll","loadAll"),zJi=lke("safeDump","dump");var wP=Be(gm());var dke=class{constructor(){this.resolvedSkills={};this.resolutions=[]}static{s(this,"SkillDump")}},_u=class{constructor(){this.dump=new Sr(25);this.promptsDump=new Sr(1)}static{s(this,"ConversationDumper")}addResolvedSkill(e,r,n){let i=this.getDump(e);i.resolvedSkills[r]=n}getResolvedSkill(e,r){return this.getDump(e).resolvedSkills[r]}addResolution(e,r){this.getDump(e).resolutions.push(r)}getDump(e){let r=this.dump.get(e);return r||(r=new dke,this.dump.set(e,r)),r}addPrompt(e,r,n){let i=this.promptsDump.get(e);i===void 0&&(i=new Map,this.promptsDump.set(e,i)),i.set(n,r)}getLastTurnPrompts(){if(this.promptsDump===void 0)return;let e=this.promptsDump.values().next();if(!e.done)return e.value}};function $ht(t){let e=t.copy();return e.turns=e.turns.filter(r=>r.status!=="in-progress"&&(r.response===void 0||r.response?.type==="model")),e}s($ht,"filterConversationTurns");function KRe(t){return $ht(t).getLastTurn()?.id}s(KRe,"getLastTurnId");async function Jmt(t){let e=$ht(t.conversation),r=KRe(t.conversation);if(!r)return"Nothing to dump because no request has been sent to the model yet.";let i=t.ctx.get(_u).getDump(r),o=avr(i,e.turns);dn.debug(t.ctx,`conversation.dump
`,`
`+o);let a=await cvr(i,t.ctx);return wP.default`
        ${svr(t.conversation,r)}
        ${ovr(t.ctx)}

        The following code can be copied into a chat simulation \`yml\` file. This response has not polluted the conversation history and did not cause any model roundtrip.
        \`\`\`yaml
        ${o}
        \`\`\`${a?`
${a}`:""}
        `}s(Jmt,"getConversationDump");function ovr(t){let e=t.get(cn);return wP.default`
        - IDE: \`${e.getEditorInfo().name} (${e.getEditorInfo().version})\`
        - Plugin: \`${e.getEditorPluginInfo().version}\`
    `}s(ovr,"getEditorInfoDumpMessage");function svr(t,e){return wP.default`
        Debug information for the last turn of the conversation.

        - ConversationId: \`${t.id}\`
        - MessageId: \`${e}\`
    `}s(svr,"getInfoDumpMessage");async function Xmt(t,e,r){let n=t.ctx.get(ql),i="# Available skills",o=n.getDescriptors().filter(a=>t.ctx.get(to).getSupportedSkills(t.conversation.id).includes(a.id));if(r&&(o=o.filter(a=>a.id===r)),o.length===0)return`No skill with id ${r} available`;for(let a of o)i+=`
- ${a.id}`;t.turn.request.message&&en(t.turn.request.message).trim().length>0&&(i+=`

**User message**: ${en(t.turn.request.message)}`);for(let a of o){i+=`
## ${a.id}`,i+=wP.default`
            \n\n
            **Description**
            
            ${a.description()}`;let c=n.getSkill(a.id),l=await c?.resolver(t).resolveSkill(t);if(l){i+=wP.default`
                \n\n
                **Resolution**
                
                \`\`\`yaml
                ${uke(l)}
                \`\`\``;let u=await c?.processor(t).processSkill(l,t);if(u){let f=typeof u=="string"?u:u.elide(1e3).getText();i+=wP.default`
                    \n\n
                    **Processed value**
                    
                    ${f}`}else i+=`

**Unprocessable**`}else i+=`

**Unresolvable**`}return i}s(Xmt,"getSkillsDump");function avr(t,e){let r={state:{skills:t.resolvedSkills},turns:e.map((n,i)=>{let o={request:en(n.request.message)};return n.response&&(o.response=en(n.response.message)),o})};return uke(r)}s(avr,"toSimulationFormat");async function cvr(t,e){let r=t.resolutions.map(o=>o.files).flat(),n=r.filter((o,a)=>o&&r.indexOf(o)===a),i;for(let o of n)if(o&&o.status==="included"){i||(i=`The following files have been used:
`);let a=await e.get(En).getOrReadTextDocument(o),c;a.status==="valid"&&(c=a.document);let l=c?.getText();dn.debug(e,`conversation.dump.file
`,l),i+=`
**${o.uri}**

\`\`\`${c?.detectedLanguageId}
${l}
\`\`\``}return i}s(cvr,"fileDump");d();function fke(t,e){let r=Li(e.tokenizer),n=0;for(let i of t)n+=e.baseTokensPerMessage,i.role&&(n+=r.tokenize(i.role).length),i.name&&(n+=r.tokenize(i.name).length+e.baseTokensPerName),i.content&&(n+=r.tokenize(en(i.content)).length);return n+=e.baseTokensPerCompletion,n}s(fke,"countMessagesTokens");d();function Wht(t,e,r,n,i){let o=["You are an AI programming assistant.",'When asked for your name, you must respond with "GitHub Copilot".',"Follow the user's requirements carefully & to the letter.","Follow Microsoft content policies.","Avoid content that violates copyrights.",`If you are asked to generate content that is harmful, hateful, racist, sexist, lewd, violent, or completely irrelevant to software engineering, only respond with "Sorry, I can't assist with that."`,"Keep your answers short and impersonal.","You can answer general programming questions and perform the following tasks:","* Ask a question about the files in your current workspace","* Explain how the code in your active editor works","* Make changes to existing code","* Review the selected code in your active editor","* Generate unit tests for the selected code","* Propose a fix for the problems in the selected code","* Scaffold code for a new file or project in a workspace","* Create a new Jupyter Notebook","* Ask questions about VS Code","* Generate query parameters for workspace search","* Ask how to do something in the terminal","* Explain what just happened in the terminal"].join(`
`),a=["The active document is the source code the user is looking at right now.","You have read access to the code in the active document, files the user has recently worked with and open tabs. You are able to retrieve, read and use this code to answer questions.","You cannot retrieve code that is outside of the current project.","You can only give one reply for each conversation turn."].join(`
`),c=e?`The user works in an IDE called ${e} which can be used to edit code, run and debug the user's application as well as executing tests.`:"",l=n?`The user is using ${n} as their operating system.`:"",u=i?`You use the ${i} large language model.`:"",f=r?`The user is logged in as ${r} on GitHub.`:"";return[o,l,u,f,c,a].filter(p=>p&&p!="").join(`
`)}s(Wht,"chatBasePrompt");d();d();d();d();d();function jht(t){let e=t.split(`
`),r=[],n=!1,i=[];for(let o of e)o.startsWith("```")?(n?(r.push([q0(i.join(`
`)),1]),i=[],r.push([new Ut([o]),1])):r.push([new Ut([o]),1]),n=!n):n?i.push(o):r.push([new Ut([o]),.8]);return n&&(r.push([q0(i.join(`
`)),1]),r.push([new Ut(["```"]),1])),new Ut(r)}s(jht,"fromMessage");function gM(t){let e=pke(t),r=[];for(let n=0;n<e.length;n++){let i=e[n],o=Ght(i.request,n+1),a=i.response&&i.response?.type!=="meta"?Ght(i.response):"",c=o;a!==""&&(c+=`
`+a+(e.length>1&&n!==e.length-1?`
`:"")),r.push(jht(c))}return r.length>0?new Ut([[new Ut(["Consider the following conversation history:"]),1],[AS(r,"inverseLinear"),1]]):null}s(gM,"fromHistory");var lvr=5;function pke(t,e){return t.filter(n=>(n.status==="success"||n.status==="in-progress")&&en(n.request.message)!=""&&n.agent?.agentSlug===e).reverse().slice(0,lvr).reverse()}s(pke,"filterTurns");function Ght(t,e=0){let r;switch(t.type){case"user":case"template":r="User";break;case"model":r="GitHub Copilot";break;default:r=t.type}let n=en(t.message).startsWith("```")?`
`:" ";return`${e>0?`${e}) `:""}${r}:${n}${en(t.message)}`}s(Ght,"formatTurnMessage");d();d();d();var uvr=4,mke={skillIds:[]},Zse=class{constructor(e,r){this.ctx=e;this.chatFetcher=r}static{s(this,"MetaPromptFetcher")}async fetchPromptContext(e,r,n,i,o){let a=e.conversation.getLastTurn().request.message;if(r.length>0){let c=await Wo.getModelConfiguration(e.ctx,"meta",void 0,{tool_calls:!0}),l={promptType:"meta",supportedSkillDescriptors:r,modelConfiguration:c},u=await this.ctx.get(pd).toPrompt(e,l),f=i.extendedBy({messageSource:"chat.metaprompt"},{promptTokenLen:u.tokens}),p={modelConfiguration:c,messages:u.messages,uiKind:o,llmInteraction:e.toLlmInteraction()};if(u.toolConfig===void 0)throw new Error("No tool call configuration found in meta prompt.");p.tool_choice=u.toolConfig.tool_choice,p.tools=u.toolConfig.tools;let m=await this.chatFetcher.fetchResponse(p,n,f);return m.type!=="success"&&(_r.error(this.ctx,"Failed to fetch prompt context, trying again..."),m=await this.chatFetcher.fetchResponse(p,n,f)),await e.ctx.get(xl).inspectFetchResult(m),this.handleResult(m,f,en(a),o,u.toolConfig)}else return mke}handleResult(e,r,n,i,o){if(e.type!=="success")return this.telemetryError(r,e),mke;let c;if(e.toolCalls&&e.toolCalls.length>0)c=o.extractArguments(e.toolCalls[0]).skillIds?.slice(0,uvr);else return _r.error(this.ctx,"Missing tool call in meta prompt response"),mke;let l=r.extendedBy({uiKind:i,skillIds:c?.join(",")??""},{numTokens:e.numTokens+e.toolCalls[0].approxNumTokens}),u=l.extendedBy({messageText:n});return Bt(this.ctx,`${uu(i)}.metaPrompt`,l,0),Bt(this.ctx,`${uu(i)}.promptContext`,u,1),{skillIds:c??[]}}telemetryError(e,r){let n=e.extendedBy({resultType:r.type,reason:r.reason??""});Bt(this.ctx,"conversation.promptContextError",n,1)}};d();d();d();var eae=class{constructor(){this.languageId=["java","kotlin","scala","groovy"]}static{s(this,"JavaProjectMetadataLookup")}determineBuildTools(e){return[...e.buildTools]}determineApplicationFrameworks(e){let r=[];return me(e,r,"org.springframework.boot","Spring Boot"),me(e,r,"jakarta.jakartaee-api","Jakarta EE"),me(e,r,"javax:javaee-api","Java EE"),me(e,r,"org.apache.struts:struts2-core","Apache Struts"),me(e,r,"org.hibernate:hibernate-core","Hibernate"),me(e,r,"org.apache.wicket:wicket-core","Apache Wicket"),me(e,r,"javax.faces:jsf-api","JSF"),me(e,r,"org.grails:grails-core","Grails"),r}determineCoreLibraries(e){let r=[];return me(e,r,"com.google.guava","Google Guava"),me(e,r,"org.apache.commons:commons-lang3","Apache Commons Lang"),me(e,r,"org.apache.commons:commons-io","Apache Commons IO"),me(e,r,"joda-time:joda-time","Joda-Time"),me(e,r,"com.google.code.gson:gson","Google Gson"),me(e,r,"org.apache.commons:commons-math3","Apache Commons Math"),me(e,r,"org.apache.commons:commons-collections4","Apache Commons Collections"),me(e,r,"org.apache.commons:commons-net","Apache Commons Net"),me(e,r,"org.apache.poi:poi","Apache POI"),me(e,r,"com.fasterxml.jackson.core:jackson-databind","Jackson"),r}determineTestingFrameworks(e){let r=[];return me(e,r,"org.junit.jupiter:junit-jupiter","JUnit"),me(e,r,"junit:junit","JUnit"),me(e,r,"org.testng:testng","TestNG"),me(e,r,"org.spockframework:spock-core","Spock"),me(e,r,"io.cucumber:cucumber-java","Cucumber"),me(e,r,"org.jboss.arquillian.junit:arquillian-junit-container","Arquillian"),r}determineTestingLibraries(e){let r=[];return me(e,r,"org.mockito","Mockito"),me(e,r,"org.assertj","AssertJ"),me(e,r,"org.hamcrest","Hamcrest"),me(e,r,"org.powermock","PowerMock"),me(e,r,"org.jmock","JMock"),me(e,r,"org.easymock","EasyMock"),me(e,r,"org.jmockit:jmockit","JMockit"),me(e,r,"com.github.tomakehurst:wiremock","WireMock"),me(e,r,"org.dbunit:dbunit","DBUnit"),me(e,r,"com.icegreen:greenmail","GreenMail"),me(e,r,"net.sourceforge.htmlunit:htmlunit","HtmlUnit"),me(e,r,"org.seleniumhq.selenium:selenium-java","Selenium"),me(e,r,"io.rest-assured:rest-assured","Rest-Assured"),me(e,r,"io.gatling.highcharts:gatling-charts-highcharts","Gatling"),me(e,r,"org.apache.jmeter:ApacheJMeter","JMeter"),r}},tae=class{constructor(){this.languageId=["javascript","javascriptreact","typescript","typescriptreact","vue"]}static{s(this,"JavaScriptProjectMetadataLookup")}determineBuildTools(e){return e.buildTools}determineApplicationFrameworks(e){let r=[];return me(e,r,"@types/node","Node.js"),me(e,r,"react-native","React Native"),r.find(n=>n.name==="React Native")||me(e,r,"react","React"),me(e,r,"angular","Angular"),me(e,r,"vue","Vue.js"),me(e,r,"ember","Ember.js"),me(e,r,"backbone","Backbone.js"),me(e,r,"meteor","Meteor"),me(e,r,"polymer","Polymer"),me(e,r,"aurelia","Aurelia"),me(e,r,"knockout","Knockout.js"),me(e,r,"dojo","Dojo Toolkit"),me(e,r,"mithril","Mithril.js"),me(e,r,"marionette","Marionette.js"),me(e,r,"marko","Marko.js"),me(e,r,"svelte","Svelte"),me(e,r,"hyperapp","Hyperapp"),me(e,r,"inferno","Inferno.js"),me(e,r,"preact","Preact"),me(e,r,"riot","Riot.js"),me(e,r,"moon","Moon.js"),me(e,r,"stencil","Stencil.js"),r}determineCoreLibraries(e){let r=[];return me(e,r,"lodash","Lodash"),me(e,r,"moment","Moment.js"),me(e,r,"axios","Axios"),me(e,r,"redux","Redux"),me(e,r,"recoil","Recoil"),me(e,r,"jquery","jQuery"),me(e,r,"d3","D3.js"),me(e,r,"underscore","Underscore.js"),me(e,r,"ramda","Ramda"),me(e,r,"immutable","Immutable.js"),me(e,r,"rxjs","RxJS"),me(e,r,"three","Three.js"),me(e,r,"socket.io","Socket.IO"),me(e,r,"express","Express.js"),me(e,r,"next","Next.js"),me(e,r,"puppeteer","Puppeteer"),me(e,r,"cheerio","Cheerio"),me(e,r,"nodemailer","Nodemailer"),r}determineTestingFrameworks(e){let r=[];return me(e,r,"jest","Jest"),me(e,r,"mocha","Mocha"),me(e,r,"jasmine","Jasmine"),me(e,r,"ava","AVA"),me(e,r,"qunit","QUnit"),me(e,r,"tape","Tape"),r}determineTestingLibraries(e){let r=[];return me(e,r,"chai","Chai"),me(e,r,"sinon","Sinon"),me(e,r,"enzyme","Enzyme"),me(e,r,"protractor","Protractor"),me(e,r,"supertest","Supertest"),me(e,r,"nock","Nock"),me(e,r,"cypress","Cypress"),me(e,r,"@testing-library/react","React Testing Library"),r}},rae=class{constructor(){this.languageId="go"}static{s(this,"GoProjectMetadataLookup")}determineBuildTools(e){return e.buildTools}determineApplicationFrameworks(e){let r=[];return me(e,r,"github.com/gorilla/mux","Gorilla Mux"),me(e,r,"github.com/go-chi/chi","Chi"),me(e,r,"github.com/gin-gonic/gin","Gin"),me(e,r,"github.com/labstack/echo","Echo"),me(e,r,"github.com/revel/revel","Revel"),me(e,r,"github.com/astaxie/beego","Beego"),me(e,r,"github.com/go-martini/martini","Martini"),me(e,r,"github.com/gobuffalo/buffalo","Buffalo"),me(e,r,"github.com/goji/goji","Goji"),me(e,r,"github.com/hoisie/web","Web.go"),r}determineCoreLibraries(e){let r=[];return me(e,r,"net/http","net/http"),me(e,r,"fmt","fmt"),me(e,r,"io","io"),me(e,r,"time","time"),me(e,r,"math","math"),me(e,r,"strconv","strconv"),me(e,r,"strings","strings"),me(e,r,"sort","sort"),me(e,r,"encoding/json","encoding/json"),r}determineTestingFrameworks(e){let r=[];return me(e,r,"github.com/onsi/ginkgo","ginkgo"),me(e,r,"github.com/onsi/gomega","gomega"),me(e,r,"github.com/stretchr/testify","testify"),me(e,r,"gopkg.in/check.v1","gocheck"),me(e,r,"github.com/franela/goblin","goblin"),me(e,r,"github.com/DATA-DOG/godog","godog"),me(e,r,"github.com/stesla/gospec","gospec"),me(e,r,"github.com/rjeczalik/gotest","gotest"),me(e,r,"github.com/smartystreets/goconvey","goconvey"),r}determineTestingLibraries(e){let r=[];return me(e,r,"github.com/stretchr/testify","Testify"),me(e,r,"github.com/smartystreets/goconvey","GoConvey"),me(e,r,"github.com/onsi/ginkgo","Ginkgo"),me(e,r,"github.com/golang/mock","GoMock"),me(e,r,"gopkg.in/check.v1","GoCheck"),me(e,r,"github.com/franela/goblin","Goblin"),me(e,r,"github.com/DATA-DOG/godog","GoDog"),me(e,r,"github.com/onsi/gomega","Gomega"),me(e,r,"github.com/stesla/gospec","GoSpec"),me(e,r,"github.com/rjeczalik/gotest","GoTest"),r}},nae=class{constructor(){this.languageId=["python","jupyter"]}static{s(this,"PythonProjectMetadataLookup")}determineBuildTools(e){return e.buildTools}determineApplicationFrameworks(e){let r=[];return me(e,r,"flask","Flask"),me(e,r,"django","Django"),me(e,r,"pyramid","Pyramid"),me(e,r,"tornado","Tornado"),me(e,r,"fastapi","FastAPI"),r}determineCoreLibraries(e){let r=[];return me(e,r,"requests","requests"),me(e,r,"numpy","numpy"),me(e,r,"pandas","pandas"),me(e,r,"scipy","scipy"),me(e,r,"matplotlib","matplotlib"),r}determineTestingFrameworks(e){let r=[];return me(e,r,"pytest","Pytest"),me(e,r,"unittest","Unittest"),me(e,r,"doctest","Doctest"),me(e,r,"nose","Nose"),r}determineTestingLibraries(e){let r=[];return me(e,r,"mock","Mock"),me(e,r,"hypothesis","Hypothesis"),me(e,r,"behave","Behave"),me(e,r,"lettuce","Lettuce"),me(e,r,"testify","Testify"),me(e,r,"pyhamcrest","PyHamcrest"),r}},iae=class{constructor(){this.languageId=["php","blade"]}static{s(this,"PhpProjectMetadataLookup")}determineBuildTools(e){return e.buildTools}determineApplicationFrameworks(e){let r=[];return me(e,r,"laravel/framework","Laravel"),me(e,r,"symfony/symfony","Symfony"),me(e,r,"slim/slim","Slim"),me(e,r,"cakephp/cakephp","CakePHP"),me(e,r,"yiisoft/yii2","Yii"),me(e,r,"zendframework/zendframework","Zend Framework"),me(e,r,"phalcon/cphalcon","Phalcon"),me(e,r,"bcosca/fatfree","Fat-Free"),me(e,r,"fuel/fuel","FuelPHP"),me(e,r,"phpixie/framework","PHPixie"),r}determineCoreLibraries(e){let r=[];return me(e,r,"monolog/monolog","Monolog"),me(e,r,"vlucas/phpdotenv","PHP dotenv"),me(e,r,"symfony/console","Symfony Console"),me(e,r,"guzzlehttp/guzzle","GuzzleHttp"),me(e,r,"ramsey/uuid","Ramsey UUID"),me(e,r,"doctrine/orm","Doctrine ORM"),me(e,r,"php-di/php-di","PHP-DI"),me(e,r,"phpunit/php-timer","PHPUnit Timer"),me(e,r,"symfony/finder","Symfony Finder"),me(e,r,"symfony/yaml","Symfony Yaml"),r}determineTestingFrameworks(e){let r=[];return me(e,r,"phpunit/phpunit","PHPUnit"),me(e,r,"behat/behat","Behat"),me(e,r,"phpspec/phpspec","PHPSpec"),me(e,r,"codeception/codeception","Codeception"),me(e,r,"atoum/atoum","Atoum"),me(e,r,"pestphp/pest","PestPHP"),me(e,r,"kahlan/kahlan","Kahlan"),me(e,r,"peridot-php/peridot","Peridot"),me(e,r,"phake/phake","Phake"),r}determineTestingLibraries(e){let r=[];return me(e,r,"mockery/mockery","Mockery"),me(e,r,"php-mock/php-mock","PHP-Mock"),me(e,r,"php-mock/php-mock-phpunit","PHP-Mock PHPUnit"),me(e,r,"padraic/mockery","Padraic Mockery"),me(e,r,"phpspec/prophecy","PHPSpec Prophecy"),me(e,r,"phpunit/php-invoker","PHPUnit Invoker"),me(e,r,"phpunit/php-token-stream","PHPUnit Token Stream"),me(e,r,"phpunit/php-code-coverage","PHPUnit Code Coverage"),me(e,r,"phpunit/php-timer","PHPUnit Timer"),me(e,r,"phpunit/php-text-template","PHPUnit Text Template"),r}},oae=class{constructor(){this.languageId="csharp"}static{s(this,"CSharpProjectMetadataLookup")}determineBuildTools(e){return e.buildTools}determineApplicationFrameworks(e){let r=[];return me(e,r,"Microsoft.NETCore.App",".NET Core"),me(e,r,"Microsoft.AspNetCore.App","ASP.NET Core"),r}determineCoreLibraries(e){let r=[];return me(e,r,"EntityFramework","Entity Framework"),me(e,r,"Newtonsoft.Json","Newtonsoft.Json"),me(e,r,"AutoMapper","AutoMapper"),me(e,r,"Serilog","Serilog"),me(e,r,"Dapper","Dapper"),me(e,r,"Polly","Polly"),me(e,r,"FluentValidation","FluentValidation"),me(e,r,"MediatR","MediatR"),me(e,r,"Hangfire","Hangfire"),me(e,r,"RabbitMQ.Client","RabbitMQ.Client"),me(e,r,"MassTransit","MassTransit"),me(e,r,"Microsoft.Extensions.Logging","Microsoft.Extensions.Logging"),me(e,r,"Microsoft.Extensions.DependencyInjection","Microsoft.Extensions.DependencyInjection"),me(e,r,"Microsoft.Extensions.Configuration","Microsoft.Extensions.Configuration"),me(e,r,"Microsoft.Extensions.Http","Microsoft.Extensions.Http"),r}determineTestingFrameworks(e){let r=[];return me(e,r,"xunit","xUnit"),me(e,r,"NUnit","NUnit"),me(e,r,"SpecFlow","SpecFlow"),r}determineTestingLibraries(e){let r=[];return me(e,r,"Moq","Moq"),me(e,r,"FluentAssertions","FluentAssertions"),me(e,r,"Bogus","Bogus"),me(e,r,"RestSharp","RestSharp"),me(e,r,"Swashbuckle.AspNetCore","Swashbuckle.AspNetCore"),r}},sae=class{constructor(){this.languageId="dart"}static{s(this,"DartProjectMetadataLookup")}determineBuildTools(e){return e.buildTools}determineApplicationFrameworks(e){let r=[];return me(e,r,"flutter","Flutter"),me(e,r,"angular","AngularDart"),r}determineCoreLibraries(e){let r=[];return me(e,r,"dartx","dartx"),me(e,r,"provider","Provider"),me(e,r,"rxdart","RxDart"),me(e,r,"dio","Dio"),me(e,r,"json_serializable","json_serializable"),me(e,r,"freezed","Freezed"),me(e,r,"moor","Moor"),me(e,r,"hive","Hive"),me(e,r,"http","http"),me(e,r,"path","path"),me(e,r,"intl","intl"),me(e,r,"equatable","equatable"),me(e,r,"get_it","get_it"),r}determineTestingFrameworks(e){let r=[];return me(e,r,"test","test"),me(e,r,"flutter_test","flutter_test"),r}determineTestingLibraries(e){let r=[];return me(e,r,"mockito","mockito"),me(e,r,"bloc_test","bloc_test"),r}},aae=class{constructor(){this.languageId="ruby"}static{s(this,"RubyProjectMetadataLookup")}determineBuildTools(e){return e.buildTools}determineApplicationFrameworks(e){let r=[];return me(e,r,"rails","Rails"),me(e,r,"sinatra","Sinatra"),me(e,r,"hanami","Hanami"),me(e,r,"grape","Grape"),me(e,r,"roda","Roda"),me(e,r,"padrino","Padrino"),me(e,r,"cuba","Cuba"),me(e,r,"ramaze","Ramaze"),me(e,r,"nyara","Nyara"),me(e,r,"rack","Rack"),r}determineCoreLibraries(e){let r=[];return me(e,r,"active_record","ActiveRecord"),me(e,r,"sequel","Sequel"),me(e,r,"rom","ROM"),me(e,r,"datamapper","DataMapper"),me(e,r,"mongoid","Mongoid"),me(e,r,"neo4j","Neo4j"),me(e,r,"redis","Redis"),me(e,r,"cassandra","Cassandra"),me(e,r,"couchrest","CouchRest"),me(e,r,"riak","Riak"),r}determineTestingFrameworks(e){let r=[];return me(e,r,"rspec","RSpec"),me(e,r,"minitest","Minitest"),me(e,r,"cucumber","Cucumber"),me(e,r,"spinach","Spinach"),me(e,r,"turnip","Turnip"),me(e,r,"bacon","Bacon"),me(e,r,"shoulda","Shoulda"),me(e,r,"test-unit","Test::Unit"),me(e,r,"wrong","Wrong"),me(e,r,"contest","Contest"),r}determineTestingLibraries(e){let r=[];return me(e,r,"factory_bot","FactoryBot"),me(e,r,"faker","Faker"),me(e,r,"ffaker","FFaker"),me(e,r,"fabrication","Fabrication"),me(e,r,"machinist","Machinist"),me(e,r,"mocha","Mocha"),me(e,r,"flexmock","FlexMock"),me(e,r,"rr","RR"),me(e,r,"bourne","Bourne"),me(e,r,"not_a_mock","NotAMock"),r}},cae=class{constructor(){this.languageId="rust"}static{s(this,"RustProjectMetadataLookup")}determineBuildTools(e){return e.buildTools}determineApplicationFrameworks(e){let r=[];return me(e,r,"tokio","tokio"),me(e,r,"async-std","async-std"),me(e,r,"hyper","hyper"),me(e,r,"actix-web","actix-web"),me(e,r,"rocket","rocket"),r}determineCoreLibraries(e){let r=[];return me(e,r,"serde","serde"),me(e,r,"regex","regex"),me(e,r,"rand","rand"),me(e,r,"log","log"),me(e,r,"lazy_static","lazy_static"),me(e,r,"libc","libc"),me(e,r,"futures","futures"),me(e,r,"rayon","rayon"),me(e,r,"reqwest","reqwest"),me(e,r,"warp","warp"),r}determineTestingFrameworks(e){let r=[];return me(e,r,"test-case","test-case"),me(e,r,"proptest","proptest"),me(e,r,"quickcheck","quickcheck"),r}determineTestingLibraries(e){let r=[];return me(e,r,"mockall","mockall"),me(e,r,"double","double"),me(e,r,"rstest","rstest"),me(e,r,"mockiato","mockiato"),me(e,r,"mock_derive","mock_derive"),me(e,r,"mocktopus","mocktopus"),me(e,r,"mockers","mockers"),me(e,r,"mock_it","mock_it"),r}},lae=class{constructor(){this.languageId=["c","cpp"]}static{s(this,"CProjectMetadataLookup")}determineBuildTools(e){return e.buildTools.filter(r=>["gcc","clang","make","cmake","autotools","ninja","meson"].includes(r.name))}determineApplicationFrameworks(e){return e.libraries.filter(r=>["libc","libuv","openssl","zlib","libevent","libcurl"].includes(r.name))}determineCoreLibraries(e){return e.libraries.filter(r=>["libpng","libjpeg","libxml2","sqlite","postgres","mysql"].includes(r.name))}determineTestingFrameworks(e){return e.libraries.filter(r=>["unity","criterion","cmocka","check","ctest","minunit"].includes(r.name))}determineTestingLibraries(e){return e.libraries.filter(r=>["cmock","fff","trompeloeil","fakeit"].includes(r.name))}};function me(t,e,r,n){let i=t.libraries.find(o=>o.name.toLowerCase().indexOf(r.toLowerCase())>-1);i&&e.push({name:n,version:i.version})}s(me,"addFromLibraries");var uae=class{constructor(e,r){this.languageId=e;this.delegates=r}static{s(this,"CompositeProjectMetadataLookup")}determineBuildTools(e){return this.delegates.map(r=>r.determineBuildTools(e)).flat()}determineApplicationFrameworks(e){return this.delegates.map(r=>r.determineApplicationFrameworks(e)).flat()}determineCoreLibraries(e){return this.delegates.map(r=>r.determineCoreLibraries(e)).flat()}determineTestingFrameworks(e){return this.delegates.map(r=>r.determineTestingFrameworks(e)).flat()}determineTestingLibraries(e){return this.delegates.map(r=>r.determineTestingLibraries(e)).flat()}};function zht(t){return t.language.version?t.language.name+" "+t.language.version:t.language.name}s(zht,"determineProgrammingLanguage");var Vht=[new eae,new tae,new rae,new nae,new iae,new oae,new sae,new aae,new cae,new lae];function Kht(t){let e=Vht.find(r=>typeof r.languageId=="string"?r.languageId===t:Array.isArray(r.languageId)?r.languageId.includes(t):!1)??new uae(t,Vht);return new hke(e)}s(Kht,"getMetadataLookup");var hke=class{constructor(e){this.delegate=e;this.languageId=e.languageId}static{s(this,"DistinctProjectMetadataLookup")}determineBuildTools(e){return this.deduplicateDependencies(this.delegate.determineBuildTools(e))}determineApplicationFrameworks(e){return this.deduplicateDependencies(this.delegate.determineApplicationFrameworks(e))}determineCoreLibraries(e){return this.deduplicateDependencies(this.delegate.determineCoreLibraries(e))}determineTestingFrameworks(e){return this.deduplicateDependencies(this.delegate.determineTestingFrameworks(e))}determineTestingLibraries(e){return this.deduplicateDependencies(this.delegate.determineTestingLibraries(e))}deduplicateDependencies(e){let r=[];return e.forEach(n=>{r.find(i=>i.name===n.name)||r.push(n)}),r}};var Yht=x.Object({name:x.String(),version:x.Optional(x.String())}),Jht=x.Object({language:x.Object({id:x.String(),name:x.String(),version:x.Optional(x.String())}),libraries:x.Array(Yht),buildTools:x.Array(Yht)}),gke=class{constructor(e){this.turnContext=e}static{s(this,"ProjectMetadataSkillProcessor")}value(){return 1}processSkill(e){let r=[];r.push([new Ut([`The user is working on a project with the following characteristics:
`]),1]);let n=Kht(e.language.id);return this.addProgrammingLanguage(e,r),this.addBuildTools(e,r,n),this.addApplicationFramework(e,r,n),this.addCoreLibraries(e,r,n),this.addTestingFrameworks(e,r,n),this.addTestingLibraries(e,r,n),new Ut(r)}addProgrammingLanguage(e,r){let n=zht(e);this.turnContext.collectLabel(V1,n),r.push([new Ut([`- programming language: ${n}`]),1])}addBuildTools(e,r,n){this.addToPrompt(r,"- build tools:",n.determineBuildTools(e))}addApplicationFramework(e,r,n){this.addToPrompt(r,"- application frameworks:",n.determineApplicationFrameworks(e))}addCoreLibraries(e,r,n){this.addToPrompt(r,"- core libraries:",n.determineCoreLibraries(e))}addTestingFrameworks(e,r,n){this.addToPrompt(r,"- testing frameworks:",n.determineTestingFrameworks(e))}addTestingLibraries(e,r,n){this.addToPrompt(r,"- testing libraries:",n.determineTestingLibraries(e))}addToPrompt(e,r,n){if(n.length>0){n.forEach(o=>{this.turnContext.collectLabel(V1,`${o.name}${o.version?" "+o.version:""}`)});let i=n.map(o=>`  - ${o.name}${o.version?" "+o.version:""}`).join(`
`);e.push([new Ut([`${r}
${i}`]),1])}}},V1="project-metadata",dae=class{constructor(e){this._resolver=e;this.id=V1;this.type="explicit"}static{s(this,"ProjectMetadataSkill")}description(){return"The characteristics of the project the developer is working on (languages, frameworks)"}resolver(){return this._resolver}processor(e){return new gke(e)}};d();var Xht=Be(require("path"));var Ake=class{constructor(e){this.turnContext=e}static{s(this,"ReferencesSkillProcessor")}value(){return 1}async processSkill(e){let r=this.turnContext.ctx.get(En),n=[],i=this.filterIncludedFiles(e),o=(await this.toFileChunks(i,r)).filter(a=>a!==void 0).flat();if(o.length>0)return n.push([new Ut(["The user wants you to consider the following referenced files when computing your answer."]),1]),n.push(...o),new Ut(n)}filterIncludedFiles(e){return e.filter(r=>r.type==="file"&&!this.turnContext.isFileIncluded(r.uri))}async toFileChunks(e,r){return await Promise.all(e.map(async n=>{if(n.type==="file"&&n.uri)return await this.elideReferencedFiles(r,n)}))}async elideReferencedFiles(e,r){let n=await e.getOrReadTextDocument(r),i=ca(n);if(await this.turnContext.collectFile(pae,r.uri,i),n.status==="valid"){let o=e.getRelativePath(n.document);if(i==="included"){let a=new H1(n.document,r.selection,r.visibleRange);return[[`Code excerpt from referenced file \`${o}\`:`,1],[a.fromAllCode({addLineNumbers:!1}),1]]}else if(i==="empty")return[[new Ut([`The referenced file \`${o}\` is empty.`]),1]]}else if(n.status==="invalid")return[[new Ut([`The referenced file \`${Xht.basename(r.uri)}\` is content excluded.`]),1]]}},yke=class{static{s(this,"ReferencesSkillResolver")}resolveSkill(e){if(e.turn.request.references&&e.turn.request.references.length>0)return e.turn.request.references}},pae="references",fae=class{constructor(){this.id=pae;this.type="implicit"}static{s(this,"ReferencesSkill")}description(){return"The code from the user's referenced files"}resolver(){return new yke}processor(e){return new Ake(e)}};var SP=s(()=>[V1,Ay,pae,ef],"mandatorySkills"),mae=class{constructor(e,r){this.chatFetcher=r;this.metaPromptFetcher=new Zse(e,this.chatFetcher)}static{s(this,"ConversationContextCollector")}async collectContext(e,r,n,i,o,a){let c=[];if(o){let l=o.requiredSkills?await o.requiredSkills(e.ctx):[];c.push(...l.filter(u=>!SP().includes(u)))}else(await this.metaPromptFetcher.fetchPromptContext(e,await this.selectableSkillDescriptors(e.ctx,e.conversation,e.turn),r,n,i)).skillIds.reverse().forEach(u=>{!c.includes(u)&&!SP().includes(u)&&c.push(u)});if(a){let l=await a.additionalSkills(e.ctx);c.push(...l.filter(u=>!SP().includes(u)))}return c.push(...SP()),c=c.filter(l=>!this.isIgnoredSkill(l,e.turn)),{skillIds:e.ctx.get(to).filterSupportedSkills(e.conversation.id,c)}}async selectableSkillDescriptors(e,r,n){let i=await this.getNonSelectableSkills(e),o=e.get(to).getSupportedSkills(r.id),a=e.get(ql).getDescriptors(),c=[];for(let l of a){if(i.includes(l.id)||!o.includes(l.id))continue;(l.isAvailable?await l.isAvailable(e):!0)&&!this.isIgnoredSkill(l.id,n)&&c.push(l)}return c}async getNonSelectableSkills(e){let r=await j1(e),n=(await Promise.all(r.map(i=>i.additionalSkills(e)))).flat();return[...SP(),...n]}isIgnoredSkill(e,r){return r.ignoredSkills?.some(n=>n.skillId===e)}};d();d();var hae=class{constructor(e,r,n,i){this.ctx=e;this.conversation=r;this.turn=n;this.progress=i;this.rounds=[]}static{s(this,"AgentToolCalls")}getRound(e){return this.rounds.find(r=>r.roundId===e)}async start(e,r,n,i){let o=this.getRound(e);if(o||(o={roundId:e,reply:""},this.rounds.push(o)),o.toolCalls?.find(c=>c.id===r))_r.error(this.ctx,`Tool call ${r} already exists for the round ${e} in conversation ${this.conversation.id} and turn ${this.turn.id}`);else{let c={id:r,name:n,progressMessage:i,status:"running"};o.toolCalls=[c],await this.progress.report(this.conversation,this.turn,{editAgentRounds:[o]})}}async finish(e,r){await this.update(e,r,n=>{n.status="completed"})}async result(e,r,n){await this.update(e,r,i=>{i.status="completed",i.result=n.data})}async cancel(e,r){await this.update(e,r,n=>{n.status="cancelled"})}async finishAll(e="completed"){let r=this.rounds.filter(n=>{let i=n.toolCalls?.filter(o=>o.status==="running").map(o=>(o.status=e,o));if(i&&i.length>0)return n.toolCalls=i,!0});r.length>0&&await this.progress.report(this.conversation,this.turn,{editAgentRounds:r})}async error(e,r,n){await this.update(e,r,i=>{i.status="error",i.error=n||"Unknown error"})}async update(e,r,n){let i=this.rounds.find(a=>a.roundId===e);i||(i={roundId:e,reply:""},this.rounds.push(i));let o=i.toolCalls?.find(a=>a.id===r);o?(n(o),await this.progress.report(this.conversation,this.turn,{editAgentRounds:[i]})):_r.error(this.ctx,`Tool call ${r} not found for the agent round ${e} in conversation ${this.conversation.id} and turn ${this.turn.id}`)}};d();var gae=class{constructor(e,r,n,i){this.ctx=e;this.conversation=r;this.turn=n;this.progress=i;this.steps=[]}static{s(this,"Steps")}async start(e,r,n){let i=this.steps.find(o=>o.id===e);if(!i)i={id:e,title:r,description:n,status:"running"},this.steps.push(i),await this.progress.report(this.conversation,this.turn,{steps:[i]});else throw new Error(`Step with id "${e}" already started`)}async finish(e){await this.updateStep(e,r=>{r.status="completed"})}async cancel(e){await this.updateStep(e,r=>{r.status="cancelled"})}async finishAll(e="completed"){let r=this.steps.filter(n=>n.status==="running").map(n=>(n.status=e,n));r.length>0&&await this.progress.report(this.conversation,this.turn,{steps:r})}async error(e,r){return this.updateStep(e,n=>{n.status="failed",n.error={message:r||"Unknown error"}})}async updateStep(e,r){let n=this.steps.find(i=>i.id===e);n?(r(n),await this.progress.report(this.conversation,this.turn,{steps:[n]})):_r.error(this.ctx,`Step ${e} not found for conversation ${this.conversation.id} and turn ${this.turn.id}`)}};var xS=class{constructor(e,r,n,i){this.ctx=e;this.conversation=r;this.turn=n;this.cancelationToken=i;this.skillResolver=new Cke(this),this.steps=new gae(e,r,n,e.get(Ns)),this.collector=new vke(r,n,e.get(Ns)),this.agentToolCalls=new hae(e,r,n,e.get(Ns))}static{s(this,"TurnContext")}setResolvedModelConfiguration(e){this.turn.resolvedModelConfiguration=e}toLlmInteraction(){if(this.conversation.source==="inline")return Gd.user("conversation-inline",this.turn.telemetryId);{let e=this.turn.chatMode==="Agent"?"conversation-agent":"conversation-panel";return this.agentToolCalls.rounds.length?Gd.agent(e,this.turn.telemetryId):Gd.user(e,this.turn.telemetryId)}}async collectFile(e,r,n,i){let o={type:"file",collector:e,uri:r,status:n};i&&(o.range=i),await this.collector.collect(o)}collectLabel(e,r){this.collector.collect({type:"label",collector:e,label:r})}isFileIncluded(e){return this.collector.collectibles.some(r=>r.type==="file"&&r.status==="included"&&r.uri===e)}async info(e){await this.sendChatNotification(e,"info")}async warn(e){await this.sendChatNotification(e,"warning")}async sendChatNotification(e,r){await this.ctx.get(Ns).report(this.conversation,this.turn,{notifications:[{severity:r,message:e}]})}clearCopilotEditsSessionHeader(){this.copilotEditsSessionHeader=void 0}setCopilotEditsSessionHeader(e){this.copilotEditsSessionHeader=e}},Aae=class extends Error{constructor(r,n){super(`Cycle detected while resolving skills: ${n.join(" -> ")} -> ${r}`);this.skillId=r;this.skillStack=n}static{s(this,"CycleError")}},Hq=class extends Error{static{s(this,"ConversationAbortError")}constructor(e){super(e)}},Cke=class{constructor(e){this.turnContext=e;this.resolveStack=[]}static{s(this,"SkillResolver")}async resolve(e){if(this.turnContext.ctx.get(to).getSupportedSkills(this.turnContext.conversation.id).includes(e)){this.ensureNoCycle(e);let n=this.turnContext.ctx.get(_u).getResolvedSkill(this.turnContext.turn.id,e);if(n)return this.resolveStack.pop(),n;let i=await this.newlyResolve(e);return this.resolveStack.pop(),i}}ensureNoCycle(e){if(this.resolveStack.includes(e))throw new Aae(e,this.resolveStack);this.resolveStack.push(e)}async newlyResolve(e){let n=this.turnContext.ctx.get(ql).getSkill(e);try{let i=await n?.resolver(this.turnContext).resolveSkill(this.turnContext);if(i)return this.turnContext.ctx.get(_u).addResolvedSkill(this.turnContext.turn.id,e,i),i}catch(i){if(i instanceof Aae||i instanceof Hq)throw i;_r.exception(this.turnContext.ctx,i,`Error while resolving skill ${e}`)}}},vke=class{constructor(e,r,n){this.conversation=e;this.turn=r;this.conversationProgress=n;this.collectibles=[]}static{s(this,"Collector")}async collect(e){this.collectibles.push(e),await this.reportCollectedFile(e)}async reportCollectedFile(e){e.type==="file"&&await this.conversationProgress.report(this.conversation,this.turn,{references:[{type:"file",uri:e.uri,status:e.status,range:e.range}]})}collectiblesForCollector(e){return this.collectibles.filter(r=>r.collector===e)}};async function Zht(t,e){let[r,n,i]=await fvr(t,e);return i.push(...hvr(t)),r.length>0||n.length>0?[new Ut([[new Ut(["Consider the additional context:"]),1],[AS(r,"inverseLinear"),.9],...n]),i]:[null,i]}s(Zht,"fromSkills");async function fvr(t,e){let r=[],n=[],i=[],o=[...t.turn.skills].reverse();for(let a of o){if(!await gvr(t,a.skillId,e?.languageId??""))continue;let[c,l]=await pvr(t,a.skillId);c&&(SP().indexOf(a.skillId)===-1?n.push(c):i.push(c)),r.push(l)}return n.reverse(),i.reverse(),r.reverse(),[n,i,r]}s(fvr,"handleSkillsInReverse");async function pvr(t,e){let n=t.ctx.get(ql).getSkill(e);try{let i=Date.now(),o=await t.skillResolver.resolve(e),a=Date.now()-i;if(o){let c=n?.processor(t),l=Date.now(),u=await c?.processSkill(o,t),f=Date.now()-l;return u?await mvr(t,n,c,u,a,f):[void 0,await yae(t,n,"unprocessable",void 0,a,f)]}else return[void 0,await yae(t,n,"unresolvable",void 0,a)]}catch(i){if(_r.exception(t.ctx,i,`Error while resolving skill ${e}`),i instanceof Hq)throw i;return[void 0,await yae(t,n,"failed")]}}s(pvr,"safelyProcessSkill");async function mvr(t,e,r,n,i,o){let a;return typeof n=="string"?a=new Ut([[n,1]]):a=n,[[a,r?.value()||0],await yae(t,e,"resolved",a,i,o)]}s(mvr,"handleProcessedSkill");async function yae(t,e,r,n,i,o){let c=t.collector.collectiblesForCollector(e?.id??"unknown").filter(u=>u.type==="file"),l={skillId:e?.id??"unknown",resolution:r,files:c,resolutionTimeMs:i,processingTimeMs:o};if(n){let u=await t.ctx.get(ha).getBestChatModelConfig(Ep("user")),f=n.elide(u.maxRequestTokens).getText();l.tokensPreEliding=Li(u.tokenizer).tokenLength(f)}return t.ctx.get(_u).addResolution(t.turn.id,l),l}s(yae,"determineResolution");function hvr(t){return t.turn.ignoredSkills.map(e=>({skillId:e.skillId,resolution:"ignored"}))}s(hvr,"handleIgnoredSkills");async function gvr(t,e,r){if(e!==V1&&e!==Ay)return!0;let n=t.ctx.get(Mt),i=await n.fetchTokenAndUpdateExPValuesAndAssignments({languageId:r});return n.ideChatEnableProjectMetadata(i)?e===V1:e===Ay}s(gvr,"includeSkill");var egt=Be(gm());var _P=class{static{s(this,"AbstractUserPromptStrategy")}async elidableContent(e,r){let n=[],i=gM(e.conversation.turns.slice(0,-1));i!==null&&n.push([i,.6]);let[o,a]=await this.elidableSkills(e,r);return o!==null&&(i!==null&&n.push(["",.1]),n.push([o,.8])),[new Ut(n),a]}async elidableSkills(e,r){return await Zht(e,r)}async promptContent(e,r,n){let i,o={includeCodeGenerationInstructions:!0,includeCommitMessageGenerationInstructions:!1},a=e.turn.extractContextFilesUri();e.turn.workspaceFolders&&e.turn.workspaceFolders.length>0?i=await ey.getInstructions(e.ctx,e.turn.workspaceFolders,o,a):e.turn.workspaceFolder&&(i=await ey.getInstructions(e.ctx,[e.turn.workspaceFolder],o,a));let c=am(e.conversation.getLastTurn().request.message),l;i?typeof c=="string"?l=i+`

`+c:l=[{type:"text",text:i},...c]:l=c;let[u,f]=await this.elidableContent(e,n);return[[{role:"system",content:r},{role:"user",content:u},{role:"system",content:this.suffix(e)},{role:"user",content:l}],f]}},Cae=class extends _P{static{s(this,"PanelUserPromptStrategy")}suffix(e){return egt.default` 
            Use the above information, including the additional context and conversation history (if available) to answer the user's question below.
            Prioritize the context given in the user's question.
            When generating code, think step-by-step. Briefly explain the code and then output it in a single code block.
            When fixing problems and errors, provide a brief description first.
            When generating classes, use a separate code block for each class.
            Keep your answers short and impersonal.
            Use Markdown formatting in your answers.
            Escape special Markdown characters (like *, ~, -, _, etc.) with a backslash or backticks when using them in your answers.
            You must enclose file names and paths in single backticks. Never use single or double quotes for file names or paths.
            Make sure to include the programming language name at the start of every code block.
            Avoid wrapping the whole response in triple backticks.
            Only use triple backticks codeblocks for code.
            Do not repeat the user's code excerpt when answering.
            Do not prefix your answer with "GitHub Copilot".
            Do not start your answer with a programming language name.
            Do not include follow up questions or suggestions for next turns.
            Respond in the following locale: ${e.conversation.userLanguage}.
        `.trim()}};var tgt=Be(gm());var vae=class extends _P{static{s(this,"InlineUserPromptStrategy")}suffix(e){return tgt.default`
            Use the above information, including the additional context and conversation history (if available) to answer the user's question below.
            Prioritize the context given in the user's question.
            Keep your answers short and impersonal.
            Use Markdown formatting in your answers. 
            Escape special Markdown characters (like *, ~, -, _, etc.) with a backslash or backticks when using them in your answers.
            You must enclose file names and paths in single backticks. Never use single or double quotes for file names or paths.
            Make sure to include the programming language name at the start of every code block.
            Only use triple backticks codeblocks for code.
            Do not repeat the user's code excerpt when answering.
            Do not prefix your answer with "GitHub Copilot".
            Do not start your answer with a programming language name.
            Do not include follow up questions or suggestions for next turns.
            Respond in the following locale: ${e.conversation.userLanguage}.

            The user is editing an open file in their editor.
            The user's code is provided with line numbers prepended, for example: '1:code', starting at 1.
            The selected code line numbers are provided and are inclusive.

            If the user's question is about modifying the code in the editor, adhere to the following rules:

            To edit a range of the user's code, use the following format:
            - Generate a codeblock with the new code.
            - Prefix the codeblock with a markdown comment of the form <!-- replace lines start to end -->
            - Start and end are line numbers in the user's original code.
            - Start and end are inclusive.
            - Single line edits can be done by setting start and end to the same line number: <!-- replace lines X to X -->
            - The original code between the start and end will be replaced with the new code.
            - This format can be used to replace as well as add new code to the user's code.

            For example, to replace lines X to Y of the user's code, use the following format:
            <!-- replace lines X to Y -->
            \`\`\`language
            new code
            \`\`\`

            To delete a range of the user's code, use the following format:
            - Generate a codeblock with the original code.
            - Prefix the codeblock with a markdown comment of the form <!-- delete lines start to end -->
            - Start and end are line numbers in the user's original code.
            - Start and end are inclusive.
            - Single line deletions can be done by setting start and end to the same line number: <!-- delete lines X to X -->
            - The original code in the range will be deleted from the user's code.

            For example, to delete lines X to Y of the user's code, use the following format:
            <!-- delete lines X to Y -->
            \`\`\`language
            original code
            \`\`\`

            Remember:
            - Prefix comments must be placed directly above/after the code block respectively.
            - The first row of a codeblock must never be indented.
            - Code in codeblocks must not contain line numbers.
            - You must not return a codeblock containing the final code, but only individual codeblocks for each change.
        `.trim()}};d();var xke=Be(gm());var xae=class{static{s(this,"MetaPromptStrategy")}elidableContent(e){let r=gM(e.turns.slice(0,-1)),n=[];return r!==null&&n.push([r,.6]),new Ut(n)}suffix(e){if(e.promptType!=="meta")throw new Error("Invalid prompt options for strategy");if(!e.supportedSkillDescriptors)throw new Error("Supported skills must be provided for meta prompts");return this.buildMetaPrompt(e.supportedSkillDescriptors)}buildMetaPrompt(e){return xke.default`
            Your task is to provide a helpful answer to the user's question.
            To help you create that answer, you can resolve skills that give you more context.
            Each skill has a description and some example user questions to help you understand when the skill may be useful. 
            
            List of available skills:
            ${e.map(r=>`${this.skillToPrompt(r)}
`).join(`
`)}
        `.trim()}createFunctionArgumentSchema(e){let r=Sut(e.map(n=>n.id));return x.Object({skillIds:x.Array(r,{description:"The skill ids to resolve ranked from most to least useful"})})}toolConfig(e){if(e.promptType!=="meta")throw new Error("Invalid prompt options for strategy");return{tool_choice:{type:"function",function:{name:"resolveSkills"}},tools:[{type:"function",function:{name:"resolveSkills",description:"Resolves the skills by id to help answer the user question.",parameters:this.createFunctionArgumentSchema(e.supportedSkillDescriptors)}}],extractArguments(r){return{skillIds:Bw(r).skillIds}}}}skillToPrompt(e){let r=e.description?e.description():e.id,n=`Skill Id: ${e.id}
Skill Description: ${r}`,i=e.examples?e.examples():[];return i.length>0&&(n+=`
Skill Examples:
${i.map(o=>`  - ${o}`).join(`
`)}`),n}promptContent(e,r,n){let i=e.conversation.getLastTurn().request.message,o=this.elidableContent(e.conversation);return[[{role:"system",content:r},{role:"user",content:o},{role:"system",content:this.suffix(n)},{role:"user",content:xke.default`
                    This is the user's question: 
                    ${en(i).trim()} 
                `.trim()}],[]]}};d();var rgt=Be(gm());var Eae=class{static{s(this,"SuggestionsPromptStrategy")}toolConfig(){return{tool_choice:{type:"function",function:{name:"showSuggestions"}},tools:[{type:"function",function:{name:"showSuggestions",description:"Show the computed suggestions to the user",parameters:x.Object({suggestedTitle:x.String({description:"The suggested title for the conversation"}),followUp:x.String({description:"The suggested follow-up question for the conversation"})})}}],extractArguments(e){let r=Bw(e);return{suggestedTitle:r.suggestedTitle,followUp:r.followUp}}}}suffix(e){return rgt.default`
            Your task is to come up with two suggestions:

            1) Suggest a title for the current conversation based on the history of the conversation so far.
                - The title must be a short phrase that captures the essence of the conversation.
                - The title must be relevant to the conversation context.
                - The title must not be offensive or inappropriate.
                - The title must be in the following locale: ${e.conversation.userLanguage}.

            2) Write a short one-sentence question that the user can ask as a follow up to continue the current conversation.
                - The question must be phrased as a question asked by the user, not by Copilot.
                - The question must be relevant to the conversation context.
                - The question must not be offensive or inappropriate.
                - The question must not appear in the conversation history.
                - The question must not have already been answered.
                - The question must be in the following locale: ${e.conversation.userLanguage}.
        `.trim()}elidableContent(e){let r=gM(e.turns.slice()),n=[];return r!==null&&n.push([r,.6]),new Ut(n)}promptContent(e,r,n){return[[{role:"system",content:r},{role:"user",content:this.elidableContent(e.conversation)},{role:"system",content:this.suffix(e)}],[]]}};d();var Avr=[{type:"function",function:{name:"queryWithKeywords",description:"Searches the workspace for synonyms and relevant keywords related to the original user query. These keywords could be used as file names, symbol names, abbreviations, or comments in the relevant code.",parameters:x.Object({keywords:x.Array(x.Object({keyword:x.String({description:"A keyword or phrase relevant to the original user query that a user could search to answer their question. Keywords are not generic and do not repeat."}),variations:x.Array(x.String(),{description:"An array of relevant variations of the keyword. Variations include synonyms and plural forms. Variations are not generic and do not repeat."})}))})}}],bae=class extends _P{static{s(this,"UserQuerySynonymsPromptStrategy")}suffix(){return`
You are a coding assistant that helps developers find relevant code in their workspace by providing a list of relevant keywords they can search for.
The user will provide you with potentially relevant information from the workspace. This information may be incomplete.

# Additional Rules

Think step by step:
1. Read the user's question to understand what they are asking about their workspace.
2. If there are pronouns in the question, such as 'it', 'that', 'this', try to understand what they refer to by looking at the rest of the question and the conversation history.
3. Output a list of up to 8 relevant keywords that the user could search to answer their question. These keywords could be used as file names, symbol names, abbreviations, or comments in the relevant code. Put the keywords most relevant to the question first. Do not include overly generic keywords. Do not repeat keywords.
4. For each keyword in the list of relevant keywords, output a list of relevant variations of the keyword if applicable. Consider synonyms and plural forms. Do not include overly generic variations. Do not repeat variations.

# Example

User: Where is the code for base64 encoding?

Response:

queryWithKeywords([
    { "keyword": "base64 encoding", "variations": ["base64 encoder", "base64 encode"] },
    { "keyword": "base64", "variations": ["base 64"] },
    { "keyword": "encode", "variations": ["encoding", "encoded", "encoder", "encoders"] }
]);
`.trim()}promptContent(e,r,n){if(n.promptType!=="synonyms")throw new Error("Invalid prompt options for user query strategy");let i=am(e.conversation.getLastTurn().request.message),o=[{role:"system",content:r},{role:"system",content:this.suffix()},{role:"user",content:i}];return Promise.resolve([o,[]])}toolConfig(e){if(e.promptType!=="synonyms")throw new Error("Invalid prompt options for user query strategy");return{tools:Avr,tool_choice:{type:"function",function:{name:"queryWithKeywords"}},extractArguments(r){let n=Bw(r).keywords;if(!n||!Array.isArray(n))return{keywords:[]};let i=new Set;for(let o of n)if(!(!UX(o,"keyword")||!o.keyword||typeof o.keyword!="string")&&(i.add(o.keyword.toLowerCase()),!(!UX(o,"variations")||!o.variations||!Array.isArray(o.variations))))for(let a of o.variations)typeof a=="string"&&i.add(a.toLowerCase());return{keywords:Array.from(i)??[]}}}}};var Eke=class{constructor(e,r,n){this.promptType=e;this.strategy=n;this.modelFamilies=Array.isArray(r)?r:[r]}static{s(this,"PromptStrategyDescriptor")}};function $q(t,e,r){return new Eke(t,e,r)}s($q,"descriptor");var ngt=[$q("user",Ep("user"),()=>new Cae),$q("inline",Ep("inline"),()=>new vae),$q("meta",Ep("meta"),()=>new xae),$q("suggestions",Ep("suggestions"),()=>new Eae),$q("synonyms",Ep("synonyms"),()=>new bae)],Iae=class{static{s(this,"DefaultPromptStrategyFactory")}async createPromptStrategy(e,r,n){let i=ngt.find(o=>o.promptType===r&&o.modelFamilies.includes(n));if(!i)throw new Error(`No prompt strategy found for promptType: ${r} and modelFamily: ${n}`);return i.strategy(e)}get descriptors(){return ngt}};var ogt=require("console");var pd=class{constructor(e,r=new Iae){this.ctx=e;this.promptStrategyFactory=r}static{s(this,"ConversationPromptEngine")}async toPrompt(e,r){let n=await this.promptStrategyFactory.createPromptStrategy(this.ctx,r.promptType,r.modelConfiguration.modelFamily),i=await this.ctx.get(Bi).getSession(),[o,a]=await n.promptContent(e,this.safetyPrompt(r.userSelectedModelName??r.modelConfiguration.uiName,i),r),[c,l]=this.elideChatMessages(o,r.modelConfiguration);return await this.ctx.get(xl).inspectPrompt({type:r.promptType,prompt:igt(c),tokens:l}),this.ctx.get(_u).addPrompt(e.turn.id,igt(c),r.promptType),{messages:c,tokens:l,skillResolutions:a,toolConfig:n.toolConfig?.(r)}}elideChatMessages(e,r){let n=e.filter(c=>!(typeof c.content=="string"||Array.isArray(c.content)));(0,ogt.assert)(n.length==1,"Only one elidable message is supported right now.");let i=this.computeNonElidableTokens(e,r),o=r.maxRequestTokens-i,a=e.map(c=>typeof c.content=="string"||Array.isArray(c.content)?c:{role:c.role,content:yvr(c.content.elide(o).getText())}).filter(c=>c.content.length>0);return[a,fke(a,r)]}computeNonElidableTokens(e,r){let n=e.filter(i=>typeof i.content=="string");return n.push({role:"user",content:""}),fke(n,r)}safetyPrompt(e,r){let n=this.ctx.get(cn).getEditorInfo().readableName??this.ctx.get(cn).getEditorInfo().name,i=Cvr(process.platform);return Wht(this.ctx,n,r?.login,i,e)}};function yvr(t){return t.trimStart().replace(/^\[\.\.\.\]\n?/,"")}s(yvr,"processResultOfElidableText");function igt(t){return t.map(e=>en(e.content)).join(`

`)}s(igt,"debugChatMessages");function Cvr(t){switch(t){case"darwin":return"macOS";case"win32":return"Windows";case"linux":return"Linux";case"freebsd":return"FreeBSD";case"openbsd":return"OpenBSD";case"sunos":return"SunOS";case"aix":return"AIX";default:return}}s(Cvr,"mapPlatformToOs");var ES=class{constructor(e,r){this.ctx=e;this.chatFetcher=r}static{s(this,"TurnSuggestions")}async fetchRawSuggestions(e,r,n,i){let o=await Wo.getModelConfiguration(e.ctx,"suggestions",void 0,{tool_calls:!0}),a={promptType:"suggestions",modelConfiguration:o},c=await this.ctx.get(pd).toPrompt(e,a),l=i.extendedBy({messageSource:"chat.suggestions"},{promptTokenLen:c.tokens}),u={modelConfiguration:o,messages:c.messages,uiKind:n,llmInteraction:e.toLlmInteraction()};if(c.toolConfig===void 0)throw new Error("No tool call configuration found in suggestions prompt.");u.tool_choice=c.toolConfig.tool_choice,u.tools=c.toolConfig.tools;let f=await this.chatFetcher.fetchResponse(u,r,l);if(f.type!=="success"&&(_r.error(this.ctx,"Failed to fetch suggestions, trying again..."),f=await this.chatFetcher.fetchResponse(u,r,l)),f.type==="success"){if(!f.toolCalls||f.toolCalls.length===0){_r.error(this.ctx,"Missing tool call in suggestions response");return}let p=f.toolCalls[0],{followUp:m,suggestedTitle:h}=c.toolConfig.extractArguments(p);if(!m||!h){_r.error(this.ctx,"Missing follow-up or suggested title in suggestions response");return}return{followUp:m.trim(),suggestedTitle:h.trim(),promptTokenLen:c.tokens,numTokens:f.numTokens+p.approxNumTokens}}else if(f.type==="successMultiple"){_r.error(this.ctx,"successMultiple response is unexpected for suggestions");return}else if(f.type==="tool_calls"){_r.error(this.ctx,"tool_calls response is unexpected for suggestions");return}else{_r.error(this.ctx,`Failed to fetch suggestions due to reason: ${f.reason}`);return}}};d();d();var RP=class extends Error{static{s(this,"CodingAgentError")}constructor(e){super(e),this.name=this.constructor.name}},Tae=class extends RP{static{s(this,"CodingAgentAuthenticationError")}constructor(e){super(e)}},kP=class extends RP{static{s(this,"CodingAgentApiError")}constructor(e){super(e)}},AM=class extends kP{static{s(this,"CodingAgentUnauthorizedError")}constructor(e){super(e)}},Cy=class extends RP{static{s(this,"CodingAgentValidationError")}constructor(e){super(e)}};var sgt=new dt("CodingAgentClient"),wae=class{constructor(e,r){this.ctx=e;this.timeout=r??3e4}static{s(this,"CodingAgentClient")}getBaseUrl(){return"https://api.githubcopilot.com"}async createCodingTask(e,r,n,i,o){this.validateCreateTaskParams(e,r,n,i);let a=await this.getAccessToken(),l=`${this.getBaseUrl()}/agents/swe/v0/jobs/${n}/${i}`,u={problem_statement:`${e}

${r}`,event_type:"manual"},f={Authorization:`Bearer ${a}`,"Content-Type":"application/json",Accept:"application/json",...dh(this.ctx)};if(o?.isCancellationRequested)throw new V0;sgt.debug(this.ctx,`Creating coding agent task for ${n}/${i} with title: ${e}`);let m=await this.ctx.get(Or).fetch(l,{method:"POST",headers:f,body:JSON.stringify(u),timeout:this.timeout});if(o?.isCancellationRequested)throw new V0;return await this.handleCreateTaskResponse(m)}validateCreateTaskParams(e,r,n,i){if(!e?.trim())throw new Cy("Title is required and cannot be empty");if(!r?.trim())throw new Cy("Body is required and cannot be empty");if(!n?.trim())throw new Cy("Owner is required and cannot be empty");if(!i?.trim())throw new Cy("Repository name is required and cannot be empty")}async getAccessToken(){let r=await this.ctx.get(Bi).getSession();if(!r?.accessToken)throw new Tae("Failed to create coding task: Not authenticated with GitHub");return r.accessToken}async handleCreateTaskResponse(e){if(!e.ok){let i=await e.text().catch(()=>e.statusText);throw e.status===401?new AM("User does not have access to create PRs or push to the specified repository."):new kP(`API request failed: HTTP ${e.status} - ${i}`)}let r;try{r=await e.json()}catch(i){let o=i instanceof Error?i.message:JSON.stringify(i);throw new kP(`Failed to parse API response as JSON: ${o}`)}let n=r.pull_request?.html_url;if(!n)throw new kP("No pull request URL returned from API");return sgt.debug(this.ctx,`Coding task created successfully: ${n}`),n}};d();d();d();d();var z1=Be(Aa());function bke(t){return{isCancellationRequested:t.isCancellationRequested,onCancellationRequested:s(e=>{let r=t.onCancellationRequested(e);return{dispose:s(()=>r.dispose(),"dispose")}},"onCancellationRequested")}}s(bke,"adaptCancellationToken");function agt(t){return{report:s(e=>{"value"in e&&typeof e.value=="string"?t({text:e.value}):t({})},"report")}}s(agt,"adaptProgressCallback");function cgt(t){return{modelMaxPromptTokens:t.maxRequestTokens}}s(cgt,"createEndpointInfo");function lgt(t){let e={role:vvr(t.role),content:xvr(t.content)};return t.role===z1.Raw.ChatRole.Assistant&&"toolCalls"in t&&t.toolCalls&&(e.tool_calls=t.toolCalls.map(r=>({id:r.id,type:r.type,function:r.function,approxNumTokens:0}))),t.role===z1.Raw.ChatRole.Tool&&"toolCallId"in t&&t.toolCallId&&(e.tool_call_id=t.toolCallId),Object.entries(t).forEach(([r,n])=>{["role","content","toolCalls","toolCallId"].includes(r)||(e[r]=n)}),e}s(lgt,"convertToCopilotChatMessage");function vvr(t){switch(t){case z1.Raw.ChatRole.System:return"system";case z1.Raw.ChatRole.User:return"user";case z1.Raw.ChatRole.Assistant:return"assistant";case z1.Raw.ChatRole.Tool:return"tool";default:return"user"}}s(vvr,"convertRole");function xvr(t){return typeof t=="string"?t:Array.isArray(t)?t.length===1&&t[0].type===z1.Raw.ChatCompletionContentPartKind.Text?t[0].text:t.map(e=>e.type===z1.Raw.ChatCompletionContentPartKind.Text?{type:"text",text:e.text}:e.type===z1.Raw.ChatCompletionContentPartKind.Image?{type:"image_url",image_url:e.imageUrl}:{type:"text",text:String(e.type)}):String(t)}s(xvr,"convertContent");d();var NE=Be(Aa());var Sae=class extends NE.PromptRenderer{constructor(r,n,i,o,a){super(i,r,n,o);this.options=a}static{s(this,"InternalPromptRenderer")}async renderWithOptions(r,n,i){let o=await super.render(r,n);return{...this.options,...i}.collapseSystemMessages&&this.collapseConsecutiveSystemMessages(o.messages),o}collapseConsecutiveSystemMessages(r){let n=[],i=null;for(let o of r)if(o.role===NE.Raw.ChatRole.System&&i?.role===NE.Raw.ChatRole.System){let a=i.content.at(-1),c=o.content.at(0);a&&c&&a.type===NE.Raw.ChatCompletionContentPartKind.Text&&c.type===NE.Raw.ChatCompletionContentPartKind.Text?(a.text=a.text.trimEnd()+`
`+c.text,i.content=i.content.concat(o.content.slice(1))):(i.content.push({type:NE.Raw.ChatCompletionContentPartKind.Text,text:`
`}),i.content=i.content.concat(o.content))}else n.push(o),i=o.role===NE.Raw.ChatRole.System?o:null;r.length=0,r.push(...n)}};d();d();function ugt(t){if(!t.startsWith("data:image/"))throw new Error("Could not read image: invalid base64 image string");let e=t.split(",")[1];switch(wvr(e)){case"image/png":return Evr(e);case"image/gif":return bvr(e);case"image/jpeg":case"image/jpg":return Ivr(e);case"image/webp":return Tvr(e);default:throw new Error("Unsupported image format")}}s(ugt,"getImageDimensions");function Evr(t){let e=atob(t.slice(0,50)).slice(16,24),r=Uint8Array.from(e,i=>i.charCodeAt(0)),n=new DataView(r.buffer);return{width:n.getUint32(0,!1),height:n.getUint32(4,!1)}}s(Evr,"getPngDimensions");function bvr(t){let e=atob(t.slice(0,50)),r=Uint8Array.from(e,i=>i.charCodeAt(0)),n=new DataView(r.buffer);return{width:n.getUint16(6,!0),height:n.getUint16(8,!0)}}s(bvr,"getGifDimensions");function Ivr(t){let e=atob(t),r=Uint8Array.from(e,o=>o.charCodeAt(0)),n=r.length,i=2;for(;i<n;){let o=r[i]<<8|r[i+1],a=r[i+2]<<8|r[i+3];if(o>=65472&&o<=65474){let c=new DataView(r.buffer,i+5,4);return{height:c.getUint16(0,!1),width:c.getUint16(2,!1)}}i+=2+a}throw new Error("JPEG dimensions not found")}s(Ivr,"getJpegDimensions");function Tvr(t){let e=atob(t),r=new Uint8Array(e.length);for(let i=0;i<e.length;i++)r[i]=e.charCodeAt(i);if(e.slice(0,4)!=="RIFF"||e.slice(8,12)!=="WEBP")throw new Error("Not a valid WebP image.");let n=e.slice(12,16);if(n==="VP8 "){let i=(r[26]|r[27]<<8)&16383,o=(r[28]|r[29]<<8)&16383;return{width:i,height:o}}else if(n==="VP8L"){let i=(r[21]|r[22]<<8)&16383,o=(r[23]|r[24]<<8)&16383;return{width:i,height:o}}else if(n==="VP8X"){let i=((r[24]|r[25]<<8|r[26]<<16)&16777215)+1,o=((r[27]|r[28]<<8|r[29]<<16)&16777215)+1;return{width:i,height:o}}else throw new Error("Unsupported WebP format.")}s(Tvr,"getWebPDimensions");function wvr(t){if(!t||t.length<4)return;let e={"/9j/":"image/jpeg",iVBOR:"image/png",R0lGOD:"image/gif",UklGR:"image/webp"};for(let r of Object.keys(e))if(t.startsWith(r))return e[r]}s(wvr,"getMimeType");var PP=Be(Aa());var Svr=3,_vr=1,Ike=class{constructor(e,r){this.tokenizer=e;this.mode=PP.OutputMode.Raw;this._cache=new Sr(5e3);this.baseTokensPerMessage=r.baseTokensPerMessage||Svr,this.baseTokensPerName=r.baseTokensPerName||_vr}static{s(this,"PromptTsxTokenizer")}tokenLength(e){if(typeof e=="string")return this._textTokenLength(e);switch(e.type){case PP.Raw.ChatCompletionContentPartKind.Text:return this._textTokenLength(e.text);case PP.Raw.ChatCompletionContentPartKind.Opaque:return e.tokenUsage||0;case PP.Raw.ChatCompletionContentPartKind.Image:return this.calculateImageTokenCost(e.imageUrl.url,e.imageUrl.detail);case PP.Raw.ChatCompletionContentPartKind.CacheBreakpoint:return 0}}_textTokenLength(e){if(!e)return 0;let r=this._cache.get(e);return r===void 0&&(r=this.tokenizer.tokenLength(e),this._cache.set(e,r)),r}countMessageTokens(e){let r=this.baseTokensPerMessage;typeof e.content=="string"?r+=this.tokenLength(e.content):Array.isArray(e.content)&&(r+=e.content.reduce((o,a)=>o+this.tokenLength(a),0));let n=e;n.name&&(r+=this.baseTokensPerName,r+=this.tokenLength(n.name));let i=e;if(i.tool_calls){let o=i.tool_calls,a=0;for(let c of o)a+=this.countObjectTokens({id:c.id,type:c.type,function:c.function});r+=Math.floor(a*1.5)}return r}countMessagesTokens(e){let r=this.baseTokensPerMessage;for(let n of e)r+=this.countMessageTokens(n);return r}countToolTokens(e){if(!e||e.length===0)return 0;let n=16,i=8;for(let o of e)n+=i,n+=this.countObjectTokens({name:o.name,description:o.description,parameters:o.inputSchema});return Math.floor(n*1.1)}countObjectTokens(e){let r=0;for(let[n,i]of Object.entries(e||{}))if(i){if(r+=this.tokenLength(n),typeof i=="string")r+=this.tokenLength(i);else if(i&&typeof i=="object"){let o=i;if("type"in o&&o.type==="text"&&"text"in o&&typeof o.text=="string")r+=this.tokenLength(o.text);else if("type"in o&&o.type==="image_url"&&"image_url"in o){let a=o.image_url;a.url&&a.url.startsWith("data")&&(r+=this.calculateImageTokenCost(a.url,a.detail))}else r+=this.countObjectTokens(o)}}return r}calculateImageTokenCost(e,r){let{width:n,height:i}=ugt(e);if(r==="low")return 85;if(n>2048||i>2048){let c=2048/Math.max(n,i);n=Math.round(n*c),i=Math.round(i*c)}let o=768/Math.min(n,i);return n=Math.round(n*o),i=Math.round(i*o),Math.ceil(n/512)*Math.ceil(i/512)*170+85}};function dgt(t){let e=Li(t.tokenizer);return new Ike(e,t)}s(dgt,"createPromptTsxTokenizer");var bS=class t{static{s(this,"TsxPromptRenderer")}constructor(e,r,n,i={}){let o=cgt(n),a=dgt(n);this._internalRenderer=new Sae(e,r,o,a,i)}static create(e,r,n,i={}){return new t(e,r,n,i)}async renderPrompt(e,r,n){let i=e?agt(e):void 0,o=r?bke(r):void 0,a=await this._internalRenderer.renderWithOptions(i,o,n);return{messages:a.messages.map(lgt),tokenCount:a.tokenCount,hasIgnoredFiles:a.hasIgnoredFiles}}async countTokens(e){let r=e?bke(e):void 0;return(await this._internalRenderer.renderWithOptions(void 0,r)).tokenCount}};async function Tke(t,e,r,n,i,o){return await bS.create(t,e,r,o).renderPrompt(n,i,o)}s(Tke,"renderTsxPrompt");d();var mgt=Be(Aa());var Kn=class extends mgt.PromptElement{static{s(this,"CopilotPromptElement")}constructor(e){super(e)}async prepare(e,r,n){if(!this.prepareCopilot)return;let i=r?fgt(r):void 0,o=n?pgt(n):void 0;return await this.prepareCopilot(e,i,o)}render(e,r,n,i){let o=n?fgt(n):void 0,a=i?pgt(i):void 0;return this.renderCopilot(e,r,o,a)}};function fgt(t){return e=>{let r=e.text||"";if(t?.report&&r){let n={value:r};t.report(n)}}}s(fgt,"adaptProgressCallbackFromVSCode");function pgt(t){return{get isCancellationRequested(){return t?.isCancellationRequested??!1},onCancellationRequested:s((e,r)=>{let n=t?.onCancellationRequested(e,r);return{dispose:s(()=>{n?.dispose()},"dispose")}},"onCancellationRequested")}}s(pgt,"adaptCancellationTokenFromVSCode");d();d();d();var bl=Be(Aa());function Rvr(t){let e=t.filter(n=>n.type==="image_url"),r=t.filter(n=>n.type==="text").map(n=>n.text).join("");return{imageUrls:e,textContent:r}}s(Rvr,"separateTextAndImages");function kvr(t){return t.map(e=>vscpp(bl.Image,{src:e.image_url.url,detail:e.image_url.detail}))}s(kvr,"createImageElements");function _ae(t){let{imageUrls:e,textContent:r}=Rvr(t);return e.length===0?[vscpp(vscppf,null,r)]:[vscpp(bl.TextChunk,null,vscpp(vscppf,null,r)),...kvr(e)]}s(_ae,"renderMixedContent");function wke(t){return t==null?[]:t.map(r=>({id:r.id||"",type:"function",function:{name:r.function.name,arguments:typeof r.function.arguments=="string"?r.function.arguments:JSON.stringify(r.function.arguments)},approxNumTokens:r.approxNumTokens}))}s(wke,"convertToPromptTsxToolCall");function Rae(t){switch(t.role){case"assistant":return Pvr(t);case"tool":return Dvr(t);case"user":return Bvr(t);case"system":return Nvr(t);case"function":throw new Error("ChatRole.Function is not supported in prompt-tsx conversion. Use ChatRole.Tool instead.");default:throw new Error(`Unsupported chat role: ${String(t.role)}`)}}s(Rae,"convertChatMessageToPromptTsx");function Pvr(t){return typeof t.content=="string"?vscpp(bl.AssistantMessage,{toolCalls:wke(t.tool_calls)},vscpp(vscppf,null,t.content)):Array.isArray(t.content)?vscpp(bl.AssistantMessage,{toolCalls:wke(t.tool_calls)},_ae(t.content)):vscpp(bl.AssistantMessage,{toolCalls:wke(t.tool_calls)},vscpp(vscppf,null,JSON.stringify(t.content)))}s(Pvr,"renderAssistantMessage");function Dvr(t){return typeof t.content=="string"?vscpp(bl.ToolMessage,{toolCallId:t.tool_call_id||""},vscpp(vscppf,null,t.content)):Array.isArray(t.content)?vscpp(bl.ToolMessage,{toolCallId:t.tool_call_id||""},_ae(t.content)):vscpp(bl.ToolMessage,{toolCallId:t.tool_call_id||""},vscpp(vscppf,null,JSON.stringify(t.content)))}s(Dvr,"renderToolMessage");function Bvr(t){return typeof t.content=="string"?vscpp(bl.UserMessage,null,vscpp(vscppf,null,t.content)):Array.isArray(t.content)?vscpp(bl.UserMessage,null,_ae(t.content)):vscpp(bl.UserMessage,null,vscpp(vscppf,null,JSON.stringify(t.content)))}s(Bvr,"renderUserMessage");function Nvr(t){return typeof t.content=="string"?vscpp(bl.SystemMessage,null,vscpp(vscppf,null,t.content)):Array.isArray(t.content)?vscpp(bl.SystemMessage,null,_ae(t.content)):vscpp(bl.SystemMessage,null,vscpp(vscppf,null,JSON.stringify(t.content)))}s(Nvr,"renderSystemMessage");var Mvr=new dt("conversationHistoryPrompt"),yM=class extends Kn{static{s(this,"ConversationHistoryPrompt")}createChatMessagesFromHistory(e){let r=[];for(let n of e)if(n.request&&r.push({role:"user",content:am(n.request.message)}),n.response){let i=mne(n.response.message,!0);i.forEach(o=>r.push(this.fixToolCallsInResponse(o,i)))}return r}fixToolCallsInResponse(e,r){if(e.tool_calls&&e.tool_calls.length){let n=e.tool_calls,i=[];for(let o of n)r.some(c=>c.role==="tool"&&c.tool_call_id===o.id)?i.push(o):Mvr.warn(this.props.ctx,`Tool call ${o.id} does not have a result in the response. Removing it from the tool calls history.`);return{...e,tool_calls:i}}return e}renderCopilot(){let e=this.createChatMessagesFromHistory(this.props.historyTurns);return vscpp(vscppf,null,e.map((r,n)=>Rae(r)))}};var Pae=Be(Aa());var kae=class extends Kn{static{s(this,"SummaryPrompt")}renderCopilot(){return vscpp(vscppf,null,vscpp(Pae.SystemMessage,null,"You are an expert at summarizing chat conversations.",vscpp("br",null),vscpp("br",null),"You will be provided:",vscpp("br",null),vscpp("br",null),"- A series of user/assistant message pairs in chronological order",vscpp("br",null),"- A final user message indicating the user's intent.",vscpp("br",null),vscpp("br",null),"Your task is to:",vscpp("br",null),vscpp("br",null),"- Create a detailed summary of the conversation that captures the user's intent and key information.",vscpp("br",null),vscpp("br",null),"Keep in mind:",vscpp("br",null),vscpp("br",null),"- The user is iterating on a feature specification, bug fix, or other common programming task.",vscpp("br",null),"- There may be relevant code snippets or files referenced in the conversation.",vscpp("br",null),"- The user is collaborating with the assistant to refine their ideas and solutions, course-correcting the assistant as needed.",vscpp("br",null),"- The user will provide feedback on the assistant's suggestions and may request changes or improvements.",vscpp("br",null),"- Disregard messages that the user has indicated are incorrect, irrelevant, or unhelpful.",vscpp("br",null),"- Preserve relevant and actionable context and key information.",vscpp("br",null),"- If the conversation is long or discusses several tasks, keep the summary focused on the task indicated by the user's intent.",vscpp("br",null),"- Always prefer decisions in later messages over earlier ones.",vscpp("br",null),vscpp("br",null),"Structure your summary using the following format:",vscpp("br",null),vscpp("br",null),"TITLE: A brief title for the summary",vscpp("br",null),"USER INTENT: The user's goal or intent for the conversation",vscpp("br",null),"TASK DESCRIPTION: Main technical goals and user requirements",vscpp("br",null),"EXISTING: What has already been accomplished. Include file paths and other direct references.",vscpp("br",null),"PENDING: What still needs to be done. Include file paths and other direct references.",vscpp("br",null),"CODE STATE: A list of all files discussed or modified. Provide code snippets or diffs that illustrate important context.",vscpp("br",null),"RELEVANT CODE/DOCUMENTATION SNIPPETS: Key code or documentation snippets from referenced files or discussions.",vscpp("br",null),"OTHER NOTES: Any additional context or information that may be relevant."),vscpp(yM,{priority:1,ctx:this.props.ctx,historyTurns:this.props.conversationTurns}),vscpp(Pae.UserMessage,null,vscpp(vscppf,null,"Here is the conversation to summarize above. Please provide a detailed summary following the specified format.")))}};function hgt(t){let e={title:"",userIntent:""},r=t.match(/TITLE:\s*(.+)/);r&&(e.title=r[1].trim());let n=t.match(/USER INTENT:\s*(.+)/);return n&&(e.userIntent=n[1].trim()),e}s(hgt,"parseStructuredSummary");var Dae=class{constructor(e,r){this.ctx=e;this.chatFetcher=r}static{s(this,"ChatMLConversationSummarizer")}async provideSummary(e,r,n){try{let i=e.turns.filter(m=>m.status==="success"&&m.request?.message&&m.response?.message),o=e.turns.length>0?e.turns[e.turns.length-1]:null,a=o&&o.request?.message?[...i,o]:i;if(a.length===0)return _r.debug(this.ctx,"No turns to summarize"),"";let c=n.modelProviderName&&n.userRequestedModel?await Dw(this.ctx,n.modelProviderName,n.userRequestedModel):await Wo.getModelConfiguration(this.ctx,"user",n.userRequestedModel),f={messages:(await bS.create(kae,{ctx:this.ctx,conversationTurns:a},c).renderPrompt(void 0,r)).messages,uiKind:n.uiKind,llmInteraction:n.llmInteraction,modelConfiguration:c},p=await this.chatFetcher.fetchResponse(f,r,n.telemetryWithExp,void 0);if(r.isCancellationRequested)return _r.debug(this.ctx,"Summarization cancelled"),"";if(p.type==="success"){let m=p.value.trim();return m.match(/^".*"$/)&&(m=m.slice(1,-1)),_r.debug(this.ctx,`Successfully generated conversation summary of length ${m.length}`),m}else{let m="reason"in p?p.reason:"unknown";return _r.error(this.ctx,`Failed to fetch conversation summary because of response type (${p.type}) and reason (${m})`),""}}catch(i){return _r.exception(this.ctx,i,"Error generating conversation summary"),""}}};var Bae=new dt("codingAgentTurnProcessor"),Nae=class{constructor(e,r,n){this.turnContext=e;this.strategy=r;this.chatFetcher=n;this.conversationProgress=e.ctx.get(Ns),this.chatFetcher=this.chatFetcher??new Ps(e.ctx),this.turnSuggestions=new ES(e.ctx,this.chatFetcher),this.codingAgentClient=new wae(e.ctx),this.conversationSummarizer=new Dae(e.ctx,this.chatFetcher),this.conversation=e.conversation,this.turn=e.turn}static{s(this,"CodingAgentTurnProcessor")}async process(e,r,n,i,o,a){try{await this.processWithCodingAgent(e,r,this.turnContext,n,i,o,a)}catch(c){_r.error(this.turnContext.ctx,`Error processing turn ${this.turn.id}`,c);let l=c instanceof Error?c.message:JSON.stringify(c);this.turn.status="error",this.updateTurnResponseWithError(l),await this.endProgress({error:{message:l,code:yP.Unknown,responseIsIncomplete:!0}})}}async processWithCodingAgent(e,r,n,i,o,a,c){await this.conversationProgress.begin(this.conversation,this.turn,e);let l=await Za(this.turnContext.ctx,this.turnContext,{languageId:o?.detectedLanguageId??""});r.onCancellationRequested(async()=>{Bae.info(this.turnContext.ctx,`Cancellation requested for turn ${this.turn.id}`),this.turn.status="cancelled",await this.cancelProgress()});try{let u;if(this.turnContext.turn.workspaceFolders&&this.turnContext.turn.workspaceFolders.length>0?u=this.turnContext.turn.workspaceFolders[0]:u=this.turnContext.turn.workspaceFolder,!u)throw new Cy("No workspace folder available for git repository detection");let p=await new PA(this.turnContext.ctx).getRepo(u);if(!p||!p.isGitHub())throw new Cy("No GitHub repository found in the workspace folder");if(!p.owner||!p.name)throw new Cy("Could not determine repository owner and name");let m={owner:p.owner,name:p.name};await this.conversationProgress.report(this.conversation,this.turn,{reply:`Analyzing conversation to understand requirements...

`});let h=await this.summarizeConversation(r,l,a,c);if(r.isCancellationRequested)return;let g=en(this.turn.request.message),A=g,y=g;h&&h.title&&(A=h.title),h&&h.userIntent&&(y=h.userIntent),await this.conversationProgress.report(this.conversation,this.turn,{reply:`Creating coding task in ${m.owner}/${m.name}: ${A}

`});let E=await this.codingAgentClient.createCodingTask(A,y,m.owner,m.name,r);if(r.isCancellationRequested)return;let b="Successfully created coding task!";b+=`

Pull Request: ${E}

`,await this.conversationProgress.report(this.conversation,this.turn,{reply:b}),this.turn.response={message:b,type:"model"},this.turn.status="success";let S={suggestedTitle:void 0};if(this.strategy.computeSuggestions){let R=await this.fetchSuggestedTitle(r,l.extendedBy({messageSource:"chat.user"},{}));typeof R=="string"&&R!==""&&(S.suggestedTitle=R)}await this.endProgress(S)}catch(u){if(u instanceof ic)Bae.info(this.turnContext.ctx,`Turn ${this.turn.id} was cancelled`,u),this.turn.status="cancelled",this.updateTurnResponseWithError("Cancelled by user"),await this.cancelProgress();else if(u instanceof AM)Bae.warn(this.turnContext.ctx,`Unauthorized error in turn ${this.turn.id}`,u),this.turn.status="error",await this.conversationProgress.report(this.conversation,this.turn,{reply:"We are not able to create a coding task for you due to lack of permission. Please ensure you have permission to create PRs and push to the target repository. You also need to install GitHub App `GitHub Copilot IDE Plugin` to the target repository by following below steps to gain access:\n\n1. Visit https://github.com/apps/github-copilot-ide-plugin\n2. Click `Install` or `Configure` button to install the app to the owner account or organization of your target repository\n\nSend your request again after you have completed these steps."}),this.updateTurnResponseWithError(u.message),await this.endProgress({error:{message:u.message,code:yP.Default,responseIsIncomplete:!0}});else if(u instanceof RP)this.turn.status="error",this.updateTurnResponseWithError(u.message),await this.endProgress({error:{message:u.message,code:yP.Unknown,responseIsIncomplete:!0}});else throw Bae.error(this.turnContext.ctx,`Error in processing turn ${this.turn.id}`,u),u}}async summarizeConversation(e,r,n,i){let o=await this.conversationSummarizer.provideSummary(this.conversation,e,{userRequestedModel:n||"",modelProviderName:i||"",llmInteraction:this.turnContext.toLlmInteraction(),uiKind:this.strategy.uiKind,telemetryWithExp:r});if(!o)return null;let a=hgt(o);return _r.debug(this.turnContext.ctx,`Generated conversation summary - Title: ${a.title}, Intent: ${a.userIntent}`),a}async fetchSuggestedTitle(e,r){let n=await this.turnSuggestions.fetchRawSuggestions(this.turnContext,e,this.strategy.uiKind,r);if(n)return _r.debug(this.turnContext.ctx,"Computed suggested title",n.suggestedTitle),n.suggestedTitle}updateTurnResponseWithError(e){this.turn.response?.message?this.turn.response.message=Mk(this.turn.response?.message,{role:"assistant",content:e}):this.turn.response={message:e,type:"meta"}}async endProgress(e){await this.turnContext.steps.finishAll(),await this.conversationProgress.end(this.conversation,this.turn,e)}async cancelProgress(){await this.turnContext.steps.finishAll("cancelled"),await this.conversationProgress.cancel(this.conversation,this.turn)}};d();d();var ggt="```",Wq=String.raw`<!-- (?<mode>[\w-]+) lines? (?<start>\d+)(?: to (?<end>\d+))? -->`,Lvr=String.raw`${ggt}[\w]*?\n(?<codeblock>[\s\S]*?)\n${ggt}`,Fvr=new RegExp(Wq+`
`+Lvr,"gs"),Ske=["replace","delete"];function _ke(t,e){let r=t.matchAll(Fvr),n=Array.from(r),i=[];for(let o of n){let a=o.groups;if(!a||!Ske.includes(a.mode))continue;let c=a.start?parseInt(a.start)-1:-1,l=a.end?parseInt(a.end)-1:c,f=a.codeblock.split(`
`),p=f[0].match(/^\s*/)?.[0]??"";f.forEach((A,y)=>{f[y]=A.slice(p.length)});let m={mode:a.mode,codeblock:f.join(`
`),start:c,end:l},h=Rke([m],e);if(!h)continue;let g={text:h,uri:e.uri};i.push({...m,updatedDocument:g})}return i}s(_ke,"extractEditsFromTaggedCodeblocks");function Rke(t,e){if(t.length===0)return;t.sort((n,i)=>n.start!==i.start?i.start-n.start:i.end-n.end);let r=e.getText().split(`
`);for(let n of t){let i=n.start,o=n.end,a=n.mode,c=n.codeblock.split(`
`);if(!(i<0||o<0||o<i)&&!(i>=r.length||o>=r.length)){if(a==="delete")r.splice(i,o-i+1);else if(a==="replace"){let l=r[i].match(/^\s*/)?.[0]??"";c.forEach((u,f)=>{c[f]=l+u}),r.splice(i,o-i+1,...c)}}}return r.join(`
`)}s(Rke,"applyEditsToDocument");var CM=class{constructor(e){this.ctx=e;this.earlyReturnResponse="Oops, an error has occurred. Please try again";this.uiKind="conversationPanel";this.computeSuggestions=!0}static{s(this,"PanelTurnProcessorStrategy")}processResponse(){return[]}async buildConversationPrompt(e,r,n,i){let o="user",a=await Wo.getModelConfiguration(e.ctx,o),c={promptType:o,modelConfiguration:a,languageId:r,userSelectedModelName:i};return await this.ctx.get(pd).toPrompt(e,c)}extractEditsFromResponse(e,r){return[]}},Mae=class{constructor(e){this.ctx=e;this.earlyReturnResponse="Please open a file and select code for the inline chat to be available";this.uiKind="conversationInline";this.computeSuggestions=!1}static{s(this,"InlineTurnProcessorStrategy")}async buildConversationPrompt(e,r,n){let i=await this.getCurrentEditorSkill(e);if(!i)return;let o=await this.getDocumentIfValid(i.uri);if(!o)return;let a=n?.producesCodeEdits===!1?"user":"inline",c=await e.ctx.get(ha).getBestChatModelConfig(Ep(a)),l={promptType:a,modelConfiguration:c,languageId:r};return l.promptType==="inline"&&(this.currentDocument=o),await this.ctx.get(pd).toPrompt(e,l)}async processResponse(e){let r=[],n=en(e.response?.message??"");if(n&&e.status==="success"&&this.currentDocument){let i=await this.processInlineResponse(n,this.currentDocument);i&&r.push(i)}return r}async getCurrentEditorSkill(e){let r=await e.skillResolver.resolve(ef);if(r)return r}async getDocumentIfValid(e){let r=await this.ctx.get(En).getOrReadTextDocument({uri:e});if(r.status==="valid")return r.document}async processInlineResponse(e,r){let i=_ke(e,r).filter(a=>Ske.includes(a.mode)),o=Rke(i,r);if(o)return await this.ctx.get(xl).documentDiff({original:r.getText(),updated:o}),{uri:r.uri,text:o}}extractEditsFromResponse(e,r){return _ke(e,r)}};var Lae=class{constructor(){this.slug="github-copilot-coding-agent";this.name="GitHub Copilot Coding Agent";this.description="Create coding tasks that are executed by GitHub Copilot Coding Agent";this.avatarUrl=void 0}static{s(this,"BackendCodingAgent")}additionalSkills(e){return[]}turnProcessor(e){let r=new CM(e.ctx);return new Nae(e,r)}};d();d();d();d();function Agt(t){return t?t.filter(e=>e.type==="github.web-search").map(e=>e):[]}s(Agt,"filterUnsupportedReferences");function ygt(t){return t?t.filter(e=>e.type==="github.web-search"):[]}s(ygt,"convertToCopilotReferences");var Cgt=x.Object({type:x.Literal("github.web-search"),id:x.String(),data:x.Object({query:x.String(),type:x.String(),results:x.Optional(x.Array(x.Object({title:x.String(),excerpt:x.String(),url:x.String()})))}),metadata:x.Optional(x.Object({display_name:x.Optional(x.String()),display_icon:x.Optional(x.String())}))});var IS=class{constructor(e){this.deltaApplier=e;this.appliedLength=0;this.appliedText="";this.appliedAnnotations=[]}static{s(this,"ConversationFinishCallback")}isFinishedAfter(e,r){let n=e.substring(this.appliedLength,e.length),o=this.mapAnnotations(r.annotations).filter(a=>!this.appliedAnnotations.includes(a.id));this.append(n,o,Agt(r.copilotReferences),r.copilotErrors??[],r.copilotConfirmation)}append(e,r,n,i,o){this.deltaApplier(e,r,n,i,o),this.appliedLength+=e.length,this.appliedText+=e,this.appliedAnnotations.push(...r.map(a=>a.id))}mapAnnotations(e){if(!e)return[];let r=[],n=e.for("CodeVulnerability").map(o=>({...o,type:"code_vulnerability"})),i=e.for("IPCodeCitations").map(o=>({...o,type:"ip_code_citations"}));return r.push(...n),r.push(...i),r}};d();d();var K1=class{constructor(e){this.ctx=e;this.githubRepositoryInfoCache=new Map}static{s(this,"GitHubRepositoryApi")}async getRepositoryInfo(e){let r=`${e.hostname}/${e.owner}/${e.repo}`,n=this.githubRepositoryInfoCache.get(r);if(n)return n;let i=await this._doGetRepositoryInfo(e);if(i?.ok){let o=await i.json();return this.githubRepositoryInfoCache.set(r,o),o}}async _doGetRepositoryInfo({owner:e,repo:r,hostname:n}){let i=await this.ctx.get(Bi).getSession(),o;if(i&&new URL(i.serverUrl).hostname===n)o=i;else{let l=await this.ctx.get(fA).getAuthRecord({authAuthority:n});l&&(o={accessToken:l.oauth_token,apiUrl:`https://api.${n}/`})}if(!o&&!(n==="github.com"||n.endsWith(".ghe.com")))return;let a={Accept:"application/vnd.github+json","X-GitHub-Api-Version":"2022-11-28"};o&&(a.Authorization=`Bearer ${o.accessToken}`);let c=new URL(`repos/${e}/${r}`,o?.apiUrl||`https://api.${n}`).href;return this.ctx.get(Or).fetch(c,{method:"GET",headers:a})}};d();d();var vgt=x.Object({name:x.String(),url:x.String()}),xgt=x.Object({path:x.String(),head:x.Optional(x.Object({name:x.String(),upstream:x.Optional(vgt)})),remotes:x.Optional(x.Array(vgt))}),kke=class{constructor(e){this.turnContext=e}static{s(this,"GitMetadataSkillProcessor")}value(){return .8}processSkill(e){this.turnContext.collectLabel(Y1,"git repository information");let r=[];return r.push([new Ut(["Metadata about the current git repository:"]),1]),e.head&&e.head.name?(r.push([new Ut([`- Current branch name: ${e.head.name}`]),1]),e.head.upstream&&r.push([new Ut([`- Upstream name and url: ${e.head.upstream.name} - ${e.head.upstream.url}`]),1])):r.push([new Ut(["- Detached HEAD: yes"]),1]),e.remotes&&e.remotes.length>0&&r.push([new Ut([`- Remotes: ${e.remotes.map(n=>n.name).join(", ")}`]),1]),new Ut(r)}},Y1="git-metadata",Fae=class extends wu{static{s(this,"GitMetadataSkill")}constructor(e){super(Y1,"Metadata about the current git repository, useful for questions about branch management and git related commands","Reading git information",()=>e,r=>new kke(r))}};async function Egt(t){let e=await t.skillResolver.resolve(ef);if(e){let a=e.uri,c=bT(t.ctx,a);if(Aje(c))return{repoInfo:c,skillUsed:ef}}let r=await t.skillResolver.resolve(Y1);if(!r||!r.remotes||r.remotes.length===0){_r.debug(t.ctx,"Git metadata skill is not available or no remotes available.");return}let i=r.remotes.find(a=>a.name==="origin")??r.remotes[0],o=ACe(i.url);if(o)return{repoInfo:{baseFolder:{uri:r.path},url:i.url,...o},skillUsed:Y1}}s(Egt,"extractRepoInfo");async function bgt(t){let e=[];return await Ovr(t,e),await Qvr(t,e),await Uvr(t,e),e}s(bgt,"skillsToReference");async function Ovr(t,e){let r=await qvr(t);r&&e.push(r)}s(Ovr,"addRepositoryReference");async function Qvr(t,e){let r=await Hvr(t);r&&e.push(r)}s(Qvr,"addSelectionReference");async function Uvr(t,e){let r=[],n=await Wvr(t);n&&r.push(n),r.push(...await jvr(t)),r.length>0&&e.push(...r)}s(Uvr,"addFileReferences");async function qvr(t){let e=await Egt(t);if(e){let r=t.ctx.get(K1),n=e.repoInfo.owner,i=e.repoInfo.repo,o=await r.getRepositoryInfo(e.repoInfo);if(o)return{type:"github.repository",id:`${n}/${i}`,data:{type:"repository",name:i,ownerLogin:n,id:o.id}}}}s(qvr,"gitMetadataToReference");async function Hvr(t){let e=await t.skillResolver.resolve(ef);if(e&&e.selection){let n=await t.ctx.get(En).getOrReadTextDocument(e),i=ca(n);if(await t.collectFile(t.turn.agent.agentSlug,e.uri,i,e.selection),n.status==="valid")return $vr(e,n.document)}}s(Hvr,"currentEditorToSelectionReference");function $vr(t,e){if(t.selection&&!cM(t.selection)){let r=e.getText(t.selection);return{type:"client.selection",id:t.uri,data:{start:{line:t.selection.start.line,col:t.selection.start.character},end:{line:t.selection.end.line,col:t.selection.end.character},content:r}}}}s($vr,"extractSelection");async function Wvr(t){let e=await t.skillResolver.resolve(ef);if(e){let n=await t.ctx.get(En).getOrReadTextDocument(e),i=ca(n);if(await t.collectFile(t.turn.agent.agentSlug,e.uri,i),n.status==="valid")return{type:"client.file",id:n.document.uri,data:{content:n.document.getText(),language:n.document.detectedLanguageId}}}}s(Wvr,"currentEditorToFileReference");async function jvr(t){let e=[],r=t.turn.request.references;if(r&&r.length>0){let n=t.ctx.get(En);for(let i of r)if(i.type==="file"){let o=await n.getOrReadTextDocument(i),a=ca(o);if(await t.collectFile(t.turn.agent.agentSlug,i.uri,a,i.selection),o.status==="valid"){let c=o.document.getText();e.push({type:"client.file",id:i.uri,data:{content:c,language:o.document.detectedLanguageId}})}}}return e}s(jvr,"fileReferenceToPlatformFileReference");d();var vM=class{constructor(e,r,n){this.turnContext=e;this.chatFetcher=r;this.computeSuggestions=n}static{s(this,"ChatFetchResultPostProcessor")}async postProcess(e,r,n,i,o,a,c,l){switch(qYe(this.turnContext.ctx,c,a,e.type=="offTopic",e.requestId,l,o.extendedBy({},{fileCount:this.turnContext.ctx.get(Ec).workspaceCount})),await this.turnContext.ctx.get(xl).inspectFetchResult(e),e.type){case"success":return await this.processSuccessfulFetchResult(n,e.numTokens,e.requestId,r,c,i,o,l);case"offTopic":return this.processOffTopicFetchResult(o,c,l);case"canceled":return this.turnContext.turn.status="cancelled",this.turnContext.turn.response={message:"Cancelled",type:"user"},{error:{message:en(this.turnContext.turn.response?.message??""),type:this.turnContext.turn.response?.type}};case"failed":return this.turnContext.turn.status="error",this.turnContext.turn.response={message:e.reason,type:"server"},{error:{message:Uw.translateErrorMessage(e.code,e.reason),code:e.code}};case"filtered":return this.turnContext.turn.status="filtered",{error:{message:"Oops, your response got filtered. Vote down if you think this shouldn't have happened.",responseIsFiltered:!0}};case"length":return this.turnContext.turn.status="error",{error:{message:"Oops, the response got too long. Try to reformulate your question.",responseIsIncomplete:!0}};case"agentAuthRequired":return this.turnContext.turn.status="error",this.turnContext.turn.response={message:"Authorization required",type:"server"},{error:{message:"Authorization required",responseIsFiltered:!1}};case"no_choices":return this.turnContext.turn.status="error",this.turnContext.turn.response={message:"No choices returned",type:"server"},{error:{message:"Oops, no choices received from the server. Please try again.",responseIsFiltered:!1,responseIsIncomplete:!0}};case"no_finish_reason":return this.turnContext.turn.status="error",n&&n.length>0?this.turnContext.turn.response={message:n,type:"model",references:this.turnContext.turn.response?.references}:this.turnContext.turn.response={message:"No finish reason",type:"server"},{error:{message:"Oops, unexpected end of stream. Please try again.",responseIsFiltered:!1,responseIsIncomplete:!0}};case"model_not_supported":return this.turnContext.turn.status="error",this.turnContext.turn.response={message:"Model not supported",type:"server"},{error:{message:"Oops, the model is not supported. Please try again.",code:400,reason:"model_not_supported",responseIsFiltered:!1}};case"model_max_prompt_tokens_exceeded":return this.turnContext.turn.status="error",this.turnContext.turn.response={message:"Model max prompt tokens exceeded",type:"server"},{error:{message:"Oops, the token limit exceeded. Try to shorten your prompt or start a new conversation.",code:400,reason:"model_max_prompt_tokens_exceeded",responseIsFiltered:!1}};case"successMultiple":case"tool_calls":case"unknown":return this.turnContext.turn.status="error",{error:{message:"Unknown server side error occurred. Please try again.",responseIsFiltered:!1}}}}async processSuccessfulFetchResult(e,r,n,i,o,a,c,l){if(e&&e.length>0){a.markAsDisplayed(),c.markAsDisplayed(),this.turnContext.turn.status="success",this.turnContext.turn.response={message:e,type:"model",references:this.turnContext.turn.response?.references},HYe(this.turnContext,o,e,r,n,l,c);let u=this.computeSuggestions?await this.fetchSuggestions(i,o,a,l):void 0;if(u){let{followUp:f,suggestedTitle:p}=u;return{followup:f.message!==""?f:void 0,suggestedTitle:p!==""?p:void 0}}return{}}return this.turnContext.turn.status="error",this.turnContext.turn.response={message:"The model returned successful but did not contain any response text.",type:"meta"},{error:{message:en(this.turnContext.turn.response?.message??""),type:this.turnContext.turn.response?.type}}}async fetchSuggestions(e,r,n,i){let a=await new ES(this.turnContext.ctx,this.chatFetcher).fetchRawSuggestions(this.turnContext,e,r,n);if(a===void 0)return;let c=this.enrichFollowup(a,r,n,i);return _r.debug(this.turnContext.ctx,"Computed followup",c),_r.debug(this.turnContext.ctx,"Computed suggested title",a.suggestedTitle),{followUp:c,suggestedTitle:a.suggestedTitle}}enrichFollowup(e,r,n,i){let o=n.extendedBy({messageSource:"chat.suggestions",suggestionId:br(),suggestion:"Follow-up from model"},{promptTokenLen:e.promptTokenLen,numTokens:e.numTokens});return VYe(this.turnContext.ctx,r,o,i),{message:e.followUp,id:o.properties.suggestionId,type:o.properties.suggestion}}processOffTopicFetchResult(e,r,n){let i="Sorry, but I can only assist with programming related questions.";return this.turnContext.turn.response={message:i,type:"offtopic-detection"},this.turnContext.turn.status="off-topic",$Ye(this.turnContext.ctx,this.turnContext.conversation,r,i,e.properties.messageId,n,e),{error:{message:i,responseIsFiltered:!0}}}};d();var Oae=x.Union([x.String(),x.Number()]),DP=x.Union([x.String(),x.Number()]),Gvr=x.Union([x.Literal("included"),x.Literal("blocked"),x.Literal("notfound"),x.Literal("empty")]),Qae=x.Object({uri:x.String(),position:x.Optional(lu)}),jq=x.Object({type:x.Literal("file"),uri:x.String(),visibleRange:x.Optional(Uc),selection:x.Optional(Uc),status:x.Optional(Gvr),range:x.Optional(Uc)}),Vvr=x.Object({type:x.Literal("directory"),uri:x.String()}),xM=x.Union([jq,Vvr,Cgt]),pg=x.Union([x.Literal("panel"),x.Literal("inline")]),zvr=x.Union([x.Object({type:x.Literal("text"),text:x.String()}),x.Object({type:x.Literal("image_url"),imageUrl:x.Object({url:x.String(),detail:x.Optional(x.Union([x.Literal("low"),x.Literal("high")]))})})]),Pke=x.Union([x.String(),x.Array(zvr)]),Igt=x.Object({request:Pke,response:x.Optional(x.String()),agentSlug:x.Optional(x.String()),turnId:x.Optional(DP),model:x.Optional(x.String())});function Uae(t){return typeof t=="string"?t:t.map(e=>e.type==="image_url"?{type:"image_url",image_url:{url:e.imageUrl.url,detail:e.imageUrl.detail}}:{type:"text",text:e.text})}s(Uae,"convertToMessageContent");function qae(t,e){if(t=am(t),typeof t=="string")return t+e;let r=t.map(n=>n.type==="text").lastIndexOf(!0);if(r>=0){let n=[...t],i=n[r];return n[r]={type:"text",text:i.text+e},n}return[...t,{type:"text",text:e}]}s(qae,"appendToMessage");var Hae=x.Union([x.Literal("Ask"),x.Literal("Agent")]),Kvr=x.Object({type:x.String(),description:x.String()}),Tgt=x.Object({name:x.String(),description:x.String(),inputSchema:x.Optional(x.Object({type:x.String(),properties:x.Record(x.String(),Kvr),required:x.Array(x.String())})),confirmationMessages:x.Optional(x.Object({title:x.String(),message:x.String()}))}),EM=x.Object({uri:x.String(),name:x.String()});var Dke="generate-response",$ae=class extends Error{constructor(r,n,i,o){super(r);this.authorizationUri=n;this.agentSlug=i;this.agentName=o}static{s(this,"RemoteAgentAuthorizationError")}},Gq=class{constructor(e,r,n){this.agent=e;this.turnContext=r;this.chatFetcher=n;this.conversationProgress=r.ctx.get(Ns),this.chatFetcher=this.chatFetcher??new Ps(r.ctx),this.postProcessor=new vM(r,this.chatFetcher,!1),this.conversation=r.conversation,this.turn=r.turn}static{s(this,"RemoteAgentTurnProcessor")}async process(e,r,n,i){try{await this.processWithAgent(e,r,this.turnContext,i)}catch(o){_r.error(this.turnContext.ctx,`Error processing turn ${this.turn.id}`,o);let a=o instanceof Error?o.message:String(o);this.turn.status="error",this.turn.response={message:a,type:"meta"},o instanceof $ae?await this.endProgress({unauthorized:{authorizationUri:o.authorizationUri,agentSlug:o.agentSlug,agentName:o.agentName}}):await this.endProgress({error:{message:a,responseIsIncomplete:!0}})}}async processWithAgent(e,r,n,i){await this.conversationProgress.begin(this.conversation,this.turn,e);let o=await Za(this.turnContext.ctx,this.turnContext,{languageId:i?.detectedLanguageId??""});if(r.isCancellationRequested){this.turn.status="cancelled",await this.cancelProgress();return}let a=await this.buildAgentPrompt(n);if(!a)await this.endTurnWithResponse(`No prompt created for agent ${this.agent.id}`,"error");else{let c={type:"user",prompt:JSON.stringify(a.messages,null,2),tokens:a.tokens};await n.ctx.get(xl).inspectPrompt(c),await n.steps.start(Dke,"Generating response");let l=this.augmentTelemetry(a,o,this.turn.template,i);if(r.isCancellationRequested){this.turn.status="cancelled",await this.cancelProgress();return}let u=await this.fetchConversationResponse(n,a.messages,r,o.extendedBy({messageSource:"chat.user"},{promptTokenLen:a.tokens}),l,i);this.turn.status==="cancelled"&&this.turn.response?.type==="user"?await this.cancelProgress():(await this.finishGenerateResponseStep(u,n),await this.endProgress({error:u.error,followUp:u.followup,suggestedTitle:u.suggestedTitle,skillResolutions:a.skillResolutions}))}}async buildAgentPrompt(e){let r=this.createMessagesFromHistory(e),n=await this.computeCopilotReferences(e),i=this.getOrCreateAgentSessionId(e);return this.turn.agent&&(this.turn.agent.sessionId=i),this.turn.confirmationResponse?this.addConfirmationResponse(this.turn.confirmationResponse,r):r.push({role:"user",content:am(e.turn.request.message),copilot_references:n.length>0?n:void 0}),{messages:r,tokens:-1,skillResolutions:[]}}getOrCreateAgentSessionId(e){let r=this.turn.agent?.agentSlug;if(r){for(let n of e.conversation.turns)if(n.agent?.agentSlug===r&&n.agent.sessionId)return n.agent.sessionId}return br()}addConfirmationResponse(e,r){r.push({role:"user",content:"",copilot_confirmations:[e]})}createMessagesFromHistory(e){return pke(e.conversation.turns.slice(0,-1),this.agent.slug).flatMap(r=>{let n=[];if(r.request&&n.push({role:"user",content:am(r.request.message)}),r.response&&r.response.type==="model"){let i=ygt(r.response.references);n.push({role:"assistant",content:am(r.response.message),copilot_references:i.length>0?i:void 0})}return n})}async computeCopilotReferences(e){return await bgt(e)}async endTurnWithResponse(e,r){this.turn.response={type:"meta",message:e},this.turn.status=r,await this.conversationProgress.report(this.conversation,this.turn,{reply:e}),await this.endProgress()}async fetchConversationResponse(e,r,n,i,o,a){n.onCancellationRequested(async()=>{await this.cancelProgress()});let c=new IS((p,m,h,g,A)=>{let y=A?{...A,agentSlug:this.agent.slug}:void 0;this.conversationProgress.report(this.conversation,this.turn,{reply:p,annotations:m,references:h,notifications:g.map(E=>({message:E.message,severity:"warning"})),confirmationRequest:y}),this.turn.response?(this.turn.response.message=qae(this.turn.response.message,p),this.turn.response.references.push(...h)):this.turn.response={message:p,type:"model",references:h},this.turn.annotations.push(...m??[]),y&&(this.turn.confirmationRequest=y)}),l=await this.turnContext.ctx.get(ar).getGitHubSession(),u={engineName:"agents",endpoint:this.agent.endpoint??this.agent.slug,messages:r,uiKind:"conversationPanel",intentParams:{intent:!0,intent_threshold:.7,intent_content:en(this.turn.request.message)},authToken:l?.accessToken,copilot_thread_id:this.turn.agent?.sessionId,llmInteraction:e.toLlmInteraction()},f=await this.chatFetcher.fetchResponse(u,n,i,(p,m)=>c.isFinishedAfter(p,m));return this.ensureAgentIsAuthorized(f),await this.postProcessor.postProcess(f,n,c.appliedText,i,o.extendedBy(this.addExtensibilityInfoTelemetry()),en(this.turn.request.message),"conversationPanel",a)}ensureAgentIsAuthorized(e){if(e.type==="agentAuthRequired")throw this.turnContext.turn.status="error",this.turnContext.turn.response={message:"Authorization required",type:"server"},new $ae("Authorization required",e.authUrl,this.agent.slug,this.agent.name)}augmentTelemetry(e,r,n,i){return g7(this.conversation,"conversationPanel",en(this.turn.request.message).length,e.tokens,n?.templateId,void 0,r,e.skillResolutions)}addExtensibilityInfoTelemetry(){return{extensibilityInfoJson:JSON.stringify({agent:this.agent.slug,outgoingReferences:this.turn.request.references?.map(e=>e.type)??[],incomingReferences:this.turn.response?.references?.map(e=>e.type)??[]})}}async finishGenerateResponseStep(e,r){e.error?await r.steps.error(Dke,e.error.message):await r.steps.finish(Dke)}async endProgress(e){await this.turnContext.steps.finishAll(),await this.conversationProgress.end(this.conversation,this.turn,e)}async cancelProgress(){await this.turnContext.steps.finishAll("cancelled"),await this.conversationProgress.cancel(this.conversation,this.turn)}};var Vq=class{constructor(e,r,n,i,o,a){this.id=e;this.slug=r;this.name=n;this.description=i;this.avatarUrl=o;this.endpoint=a}static{s(this,"RemoteAgent")}additionalSkills(){return[]}turnProcessor(e){return new Gq(this,e)}},Wae=class extends Vq{static{s(this,"ExtensibilityPlatformAgent")}constructor(){super(0,"github","GitHub","Get answers grounded in web search, code search, and your enterprise's knowledge bases.","https://avatars.githubusercontent.com/u/9919?s=200&v=4","chat")}turnProcessor(e){return new Gq(this,e)}};d();var Yvr="github",vy=class{static{s(this,"RemoteAgentRegistry")}},jae=class extends vy{constructor(r){super();this.ctx=r;this._agents=void 0;this._lastFetchTime=0}static{s(this,"CapiRemoteAgentRegistry")}async agents(){return this.shouldRefreshAgents()&&(this._agents=await this.fetchAgents()),this._agents!=null?this._agents.slice():[]}shouldRefreshAgents(){return!this._agents||!this._lastFetchTime?!0:this.isLastFetchOlderOneHour()}isLastFetchOlderOneHour(){return Date.now()-this._lastFetchTime>36e5}async fetchAgents(){let r=await aR(this.ctx,"/agents");return r.ok?(this._lastFetchTime=Date.now(),this.parseAgents(await r.text())):(dn.error(this.ctx,"Failed to fetch agents from CAPI",{status:r.status,statusText:r.statusText}),[])}parseAgents(r){let n;try{n=JSON.parse(r).agents,Array.isArray(n)||dn.error(this.ctx,"Expected 'agents' to be an array")}catch(i){return r.includes("access denied")||dn.warn(this.ctx,"Invalid remote agent response:",r,i),[]}return n.filter(i=>i.slug!==Yvr).map(i=>new Vq(i.id,i.slug,i.name,i.description,i.avatar_url))}};var Bke=class{constructor(){this.slug="project";this.name="Project";this.description="Ask about your project"}static{s(this,"ProjectAgent")}additionalSkills(){return[dM]}};async function j1(t){let e=[];return e.push(new Wae),e.push(...await t.get(vy).agents()),e.push(new Bke),e.push(new Lae),e}s(j1,"getAgents");var Jvr=x.Object({});async function Xvr(t,e,r){return[(await j1(t)).map(o=>({slug:o.slug,name:o.name,description:o.description,avatarUrl:o.avatarUrl})),null]}s(Xvr,"handleConversationAgentsChecked");var wgt=Ze(Jvr,Xvr);d();d();var zq=Be(ul());function Zvr(t,e,r){let n=Vr.createAndMarkAsIssued({languageId:String(e.detectedLanguageId),requestedDocumentVersion:String(r),actualDocumentVersion:String(e.version)});return Bt(t,"getCompletions.docVersionMismatch",n)}s(Zvr,"telemetryVersionMismatch");async function xy(t,e,r){let i=t.get(dr).getTextDocumentUnsafe(e);if(!i)throw new zq.ResponseError(tr.InvalidParams,`Document for URI could not be found: ${e.uri}`);let o=await wx(t,e,i.getText());if(o.status==="invalid")throw t.get(qo).setInactive(o.reason),new zq.ResponseError(tr.CopilotNotAvailable,o.reason);if(e.version!==void 0&&i.version!==e.version)throw r?.isCancellationRequested||(Zvr(t,i,e.version),Ru.debug(t,`Requested document version was ${e.version} but actual document version was ${i.version}.`)),new zq.ResponseError(tr.ContentModified,"Document Version Mismatch");return i}s(xy,"getTextDocument");async function J1(t,e,r){let n=e.textDocument??e.doc;if(n)try{return await xy(t,n,r)}catch(i){if(i instanceof zq.ResponseError&&i.code===tr.CopilotNotAvailable)return;throw i}}s(J1,"getTextDocumentIfAvailable");var exr=x.Union([x.Literal("keyboard"),x.Literal("toolbar")]),txr=x.Object({turnId:DP,codeBlockIndex:x.Number(),source:exr,copiedCharacters:x.Number(),totalCharacters:x.Number(),copiedText:x.String(),doc:x.Optional(Qae),textDocument:x.Optional(Sp),position:x.Optional(lu),conversationSource:x.Optional(pg)});async function rxr(t,e,r){let n=await J1(t,r,e),i={totalCharacters:r.totalCharacters,copiedCharacters:r.copiedCharacters},o=r.position??r.doc?.position;n&&o&&(i={...i,currentLine:o.line});let a=HT(r.conversationSource),c=t.get(to).findByTurnId(r.turnId),l=await Za(t,c,{languageId:n?.detectedLanguageId??""});return Pf(t,n,{codeBlockIndex:r.codeBlockIndex.toString(),source:r.source,uiKind:a,mode:c?.turn.getChatModeWithDefault()?.toLowerCase()??"unknown",modelId:c?.turn.getResolvedModelId()??"unknown"},i,`${uu(a)}.acceptedCopy`,l),["OK",null]}s(rxr,"handleConversationCodeCopyChecked");var Sgt=Ze(txr,rxr);d();var nxr=x.Union([x.Literal("keyboard"),x.Literal("toolbar"),x.Literal("diff")]),ixr=x.Object({turnId:DP,source:nxr,codeBlockIndex:x.Number(),acceptedLength:x.Optional(x.Number()),totalCharacters:x.Number(),newFile:x.Optional(x.Boolean()),doc:x.Optional(Qae),textDocument:x.Optional(Sp),position:x.Optional(lu),conversationSource:x.Optional(pg)});async function oxr(t,e,r){let n=await J1(t,r,e),i={totalCharacters:r.totalCharacters,acceptedLength:r.acceptedLength??r.totalCharacters},o=r.position??r.doc?.position;n&&o&&(i={...i,insertionOffset:n.offsetAt(o),currentLine:o.line});let a=HT(r.conversationSource),c=t.get(to).findByTurnId(r.turnId),l=await Za(t,c,{languageId:n?.detectedLanguageId??""});return Pf(t,n,{codeBlockIndex:r.codeBlockIndex.toString(),source:r.source,uiKind:a,compType:r.acceptedLength&&r.acceptedLength<r.totalCharacters?"partial":"full",mode:c?.turn.getChatModeWithDefault()?.toLowerCase()??"unknown",modelId:c?.turn.getResolvedModelId()??"unknown"},i,`${uu(a)}.acceptedInsert`,l),["OK",null]}s(oxr,"handleConversationCodeInsertChecked");var _gt=Ze(ixr,oxr);d();d();var Gae=x.Array(Uc);function Vae(t){if(t.textDocument?.uri)return{uri:t.textDocument.uri,selection:t.selection,visibleRange:t.visibleRanges?.[0]}}s(Vae,"resolveAsActiveEditor");d();var Rgt=Be(ul());var zae=new Rgt.ProgressType,Nke=class{constructor(e){this.progressToken=e}static{s(this,"WorkDoneProgressHandler")}async begin(e,r,n){await e.get(Nr).connection.sendProgress(zae,this.progressToken,{kind:"begin",title:`Conversation ${r.id} Turn ${n.id}`,conversationId:r.id,turnId:n.id,agentSlug:n.agent?.agentSlug})}async report(e,r,n,i){await e.get(Nr).connection.sendProgress(zae,this.progressToken,{kind:"report",conversationId:r.id,turnId:n.id,...i})}async end(e,r,n,i){await e.get(Nr).connection.sendProgress(zae,this.progressToken,{kind:"end",conversationId:r.id,turnId:n.id,...i})}async cancel(e,r,n,i){await e.get(Nr).connection.sendProgress(zae,this.progressToken,{kind:"end",conversationId:r.id,turnId:n.id,cancellationReason:"CancelledByUser",error:i})}};function bM(t){return new Nke(t.workDoneToken)}s(bM,"createProgressHandler");d();d();d();var md=class extends Error{constructor(r){super(r.message);this.conversationError=r;this.name="AgentConversationError"}static{s(this,"AgentConversationError")}};d();var ME=class extends Error{static{s(this,"ToolCallCanceledError")}constructor(e){super(e),this.name="Canceled"}};d();var IM=class extends Error{static{s(this,"ToolRoundExceedError")}constructor(){super('Oops, maximum tool attempts reached. You can type "continue" to proceed or rephrase your request.'),this.name="ToolRoundExceedError"}};d();d();d();var Mke=class{static{s(this,"TurnMetadata")}toString(){return this.constructor.name}},Kq=class extends Mke{constructor(r){super();this.renderedGlobalContext=r}static{s(this,"GlobalContextMessageMetadata")}};d();d();var Kae=class extends Kn{static{s(this,"UserOSPrompt")}renderCopilot(e,r,n,i){let o=process.platform;return vscpp(vscppf,null,"The user's current OS is: ",o==="win32"?"Windows":o==="darwin"?"macOS":o==="linux"?"Linux":"Unknown")}};d();var Yae=class extends Kn{static{s(this,"UserPreferences")}renderCopilot(e,r,n,i){return vscpp(vscppf,null)}};d();var kgt=require("path");var Jae=class extends Kn{static{s(this,"UserShellPrompt")}renderCopilot(e,r,n,i){let o=this.getUserShell(),a=(0,kgt.basename)(o),c=a==="powershell.exe"?" (Windows PowerShell v5.1)":"",l="";return a==="powershell.exe"&&(l=" Use the `;` character if joining commands on a single line is needed."),vscpp(vscppf,null,`The user's default shell is: "`,a,'"',c,". When you generate terminal commands, please generate them correctly for this shell.",l)}getUserShell(){if(process.env.SHELL)return process.env.SHELL;switch(process.platform){case"win32":return process.env.ComSpec||"cmd.exe";case"darwin":case"linux":return"/bin/bash";default:return"sh"}}};d();var Xae=class extends Kn{static{s(this,"WorkspaceFoldersHint")}renderCopilot(e,r,n,i){if(this.props.workspaceFolders&&this.props.workspaceFolders.length>0){let o=this.props.workspaceFolders.map(a=>` - ${ts(a.uri)}`).join(`
`);return vscpp(vscppf,null,"I am working in a workspace with the following folders:",vscpp("br",null),o)}else return vscpp(vscppf,null,"There is no workspace currently open.")}};d();d();d();function Pgt(t){return t.reduce((r,n)=>r+n.value.length,0)+Math.max(0,t.length-1)}s(Pgt,"partsLength");async function Bgt(t,e=1/0,r){let n=Dgt(0,t,e),i=e-Pgt(n);for(;;){let o=!1,a=[];for(let c of n)if(c.type==="text")a.push(c);else if(c.type==="dir"){a.push({type:"text",uri:c.uri,value:c.value});let l=await c.getChildren();if(r?.isCancellationRequested)return sxr();let u=Dgt(c.level+1,l,i-1);u.length&&(o=!0,i-=Pgt(u)+1,a.push(...u))}if(n=a,!o)break}return{files:n.map(o=>o.uri).filter(o=>o!==void 0),tree:n.map(o=>o.value).join(`
`)}}s(Bgt,"visualFileTree");function Dgt(t,e,r){let n="	".repeat(t),i=[],o=r;for(let a=0;a<e.length;++a){let c=e[a],l=n+c.name+(c.type===2?"/":"");if(l.length>o){let u=n+"...";for(;u.length>o&&i.length>0;)o+=i.pop().value.length+1;u.length<=o&&i.push({type:"text",uri:void 0,value:u});break}c.type===2?i.push({type:"dir",uri:c.uri,level:t,value:l,getChildren:c.getChildren}):i.push({type:"text",uri:c.uri,value:l}),o-=l.length,a!==e.length-1&&(o-=1)}return i}s(Dgt,"toParts");var sxr=s(()=>({tree:"",files:[]}),"emptyTree");var axr=new dt("fileReferencesPrompt");async function Ngt(t,e,r,n){let i=await Mgt(t,e,r,n);if(!i.length)return"";let o;if(i.length===1)o=i[0].tree.tree;else{o="";for(let{label:c,tree:l}of i){o+=`${c}/
`;for(let u of l.tree.split(`
`))o+=`	${u}
`}}let a=a8(o);return["I am working in a workspace that has the following structure:",a,o,a,"This view of the workspace structure may be truncated. You can use tools to collect more context if needed."].join(`
`)}s(Ngt,"generateWorkspaceStructurePrompt");async function Mgt(t,e,r,n){return e.length?Promise.all(e.map(async i=>{let o=i.name,a=i.uri,c=await Bgt(await Lgt(t,i.uri,r,n),r.maxLength/e.length,n);return{label:o,uri:a,tree:c}})):[]}s(Mgt,"generateWorkspaceStructure");async function Lgt(t,e,r,n){if(n.isCancellationRequested)return[];let i;try{i=await t.get(Fi).readDirectory(e)}catch{return[]}return n.isCancellationRequested?[]:(i.sort((o,a)=>o[1]===a[1]?o[0].localeCompare(a[0]):o[1]&2?1:-1),Promise.all(i.map(([o,a])=>{let c=Vi(e,o);return r.excludeDotFiles&&o.startsWith(".")||uxr(c)?null:a&2?{type:2,uri:c,name:o,getChildren:s(()=>Lgt(t,c,r,n),"getChildren")}:{type:1,uri:c,name:o}})).then(o=>o.filter(a=>a!=null)))}s(Lgt,"buildFileList");var cxr=["node_modules","venv","out","dist",".git",".yarn",".npm",".venv","foo.asar",".vscode-test"],lxr=[".ds_store","thumbs.db","package-lock.json","yarn.lock",".cache"];function uxr(t){return!!(lxr.includes(Pi(t).toLowerCase())||ts(t)?.toLowerCase()?.split(/[/\\]/g)?.some(r=>cxr.includes(r)))}s(uxr,"shouldAlwaysIgnoreFile");async function Zae(t,e,r){if(r.length===0)return[];try{let n=r.map(a=>({uri:a.uri,name:Pi(a.uri)})),i=await Mgt(t,n,{maxLength:2e3,excludeDotFiles:!0},e),o=[];for(let{label:a,uri:c,tree:l}of i)o.push("<attachment>"),o.push(`Directory: ${a} (${sc(c)})`),o.push(l.tree),o.push("</attachment>");return o}catch(n){return axr.warn(t,`Failed to generate directory structure: ${String(n)}`),[]}}s(Zae,"processDirectoryReferences");var ece=class extends Kn{static{s(this,"WorkspaceStructure")}async renderCopilot(e,r,n,i){if(!this.props.workspaceFolders)return vscpp(vscppf,null);let o=await Ngt(this.props.ctx,this.props.workspaceFolders,{maxLength:this.props.maxSize||2e3,excludeDotFiles:this.props.excludeDotFiles??!0},i||hn.CancellationToken.None);return o?vscpp(vscppf,null,o):vscpp(vscppf,null)}};d();var BP=Be(Aa());var $l=class t extends BP.PromptElement{static{s(this,"Tag")}static{this._regex=/^[a-zA-Z_][\w.-]*$/}render(){let{name:e,children:r,attrs:n={}}=this.props;if(!t._regex.test(e))throw new Error(`Invalid tag name: ${this.props.name}. Tag names must start with a letter or underscore, and can contain letters, digits, underscores, hyphens, or periods.`);let i="";for(let[a,c]of Object.entries(n))c!==void 0&&(i+=` ${a}=${JSON.stringify(c)}`);if(r?.length===0)return i?vscpp(BP.TextChunk,null,vscpp(vscppf,null,`<${e}${i} />`)):void 0;let o=(0,BP.useKeepWith)();return vscpp(vscppf,null,vscpp(o,null,vscpp(vscppf,null,`<${e}${i}>
`)),vscpp(Lke,{priority:1,flexGrow:1},r,vscpp("br",null)),vscpp(o,null,vscpp(vscppf,null,`</${e}>`)),vscpp("br",null))}},Lke=class extends BP.PromptElement{static{s(this,"TagInner")}render(){return vscpp(vscppf,null,this.props.children)}};var Fgt=Be(Aa());var Yq=class extends Kn{static{s(this,"GlobalAgentContext")}renderCopilot(e,r,n,i){return vscpp(Fgt.UserMessage,null,vscpp($l,{name:"environment_info"},vscpp(Kae,{ctx:this.props.ctx}),vscpp(Jae,{ctx:this.props.ctx})),vscpp($l,{name:"workspace_info"},vscpp(Xae,{ctx:this.props.ctx,workspaceFolders:this.props.workspaceFolders}),vscpp(ece,{ctx:this.props.ctx,workspaceFolders:this.props.workspaceFolders,maxSize:2e3,excludeDotFiles:!0})),vscpp(Yae,{ctx:this.props.ctx,flexGrow:7,priority:800}))}};d();d();d();var TM=class extends Kn{static{s(this,"KeepGoingReminder")}renderCopilot(){return this.props.modelConfiguration.modelFamily===$r.Gpt41||this.props.modelConfiguration.modelFamily.startsWith($r.Gpt5)?vscpp(vscppf,null,"You are an agent - you must keep going until the user's query is completely resolved, before ending your turn and yielding back to the user.",vscpp("br",null),"Your thinking should be thorough and so it's fine if it's very long. However, avoid unnecessary repetition and verbosity. You should be concise, but thorough.",vscpp("br",null),"You MUST iterate and keep going until the problem is solved.",vscpp("br",null),"You have everything you need to resolve this problem. I want you to fully solve this autonomously before coming back to me.",vscpp("br",null),"Only terminate your turn when you are sure that the problem is solved and all items have been checked off. Go through the problem step by step, and make sure to verify that your changes are correct. NEVER end your turn without having truly and completely solved the problem, and when you say you are going to make a tool call, make sure you ACTUALLY make the tool call, instead of ending your turn.",vscpp("br",null),"Take your time and think through every step - remember to check your solution rigorously and watch out for boundary cases, especially with the changes you made. Your solution must be perfect. If not, continue working on it. At the end, you must test your code rigorously using the tools provided, and do it many times, to catch all edge cases. If it is not robust, iterate more and make it perfect. Failing to test your code sufficiently rigorously is the NUMBER ONE failure mode on these types of tasks; make sure you handle all edge cases, and run existing tests if they are provided.",vscpp("br",null),"You MUST plan extensively before each function call, and reflect extensively on the outcomes of the previous function calls. DO NOT do this entire process by making function calls only, as this can impair your ability to solve the problem and think insightfully.",vscpp("br",null),"You are a highly capable and autonomous agent, and you can definitely solve this problem without needing to ask the user for further input.",vscpp("br",null)):vscpp(vscppf,null,"You are an agent - you must keep going until the user's query is completely resolved, before ending your turn and yielding back to the user. ONLY terminate your turn when you are sure that the problem is solved, or you absolutely cannot continue.",vscpp("br",null),"You take action when possible- the user is expecting YOU to take action and go to work for them. Don't ask unnecessary questions about the details if you can simply DO something useful instead.",vscpp("br",null))}};d();var dxr=["en","fr","it","de","es","ru","zh-CN","zh-TW","ja","ko","cs","pt-br","tr","pl"],tce=class extends Kn{static{s(this,"ResponseTranslationRules")}renderCopilot(){if(this.props.languageOverride&&dxr.find(e=>this.props.languageOverride===e)&&this.props.languageOverride!=="en")return vscpp(vscppf,null,"Respond in the following locale: ",this.props.languageOverride)}};var Ogt=Be(Aa());var rce=class extends Kn{static{s(this,"DefaultAgentPrompt")}renderCopilot(){let e=this.props.modelConfiguration.modelFamily.startsWith($r.Gpt5),r=this.props.toolsService.getToolMapForModel().get("semantic_search")!==void 0,n=this.props.toolsService.getToolMapForModel().get("get_errors")!==void 0,i=this.props.toolsService.getToolMapForModel().get("read_file")!==void 0,o=this.props.toolsService.getToolMapForModel().get("run_in_terminal")!==void 0,a=this.props.toolsService.getToolMapForModel().get("replace_string_in_file")!==void 0,c=this.props.toolsService.getToolMapForModel().get("update_user_preferences")!==void 0;return vscpp(Ogt.SystemMessage,null,vscpp($l,{name:"instructions"},"You are a highly sophisticated automated coding agent with expert-level knowledge across many different programming languages and frameworks.",vscpp("br",null),"The user will ask a question, or ask you to perform a task, and it may require lots of research to answer correctly. There is a selection of tools that let you perform actions or retrieve helpful context to answer the user's question.",vscpp("br",null),vscpp(TM,{modelConfiguration:this.props.modelConfiguration}),e&&vscpp(vscppf,null,`Communication style: Use a friendly, confident, and conversational tone. Prefer short sentences, contractions, and concrete language. Keep it skimmable and encouraging, not formal or robotic. A tiny touch of personality is okay; avoid overusing exclamations or emoji. Avoid empty filler like "Sounds good!", "Great!", "Okay, I will\u2026", or apologies when not needed\u2014open with a purposeful preamble about what you're doing next.`,vscpp("br",null)),"If you can infer the project type (languages, frameworks, and libraries) from the user's query or the context that you have, make sure to keep them in mind when making changes.",vscpp("br",null),"If the user wants you to implement a feature and they have not specified the files to edit, first break down the user's request into smaller concepts and think about the kinds of files you need to grasp each concept.",vscpp("br",null),"If you aren't sure which tool is relevant, you can call multiple tools. You can call tools repeatedly to take actions or gather as much context as needed until you have completed the task fully. Don't give up unless you are sure the request cannot be fulfilled with the tools you have. It's YOUR RESPONSIBILITY to make sure that you have done all you can to collect necessary context.",vscpp("br",null),e&&vscpp(vscppf,null,"Mission and stop criteria: You are responsible for completing the user's task end-to-end. Continue working until the goal is satisfied or you are truly blocked by missing information. Do not defer actions back to the user if you can execute them yourself with available tools. Only ask a clarifying question when essential to proceed.",vscpp("br",null),"Preamble and progress: Start with a brief, friendly preamble that explicitly acknowledges the user's task and states what you're about to do next. Make it engaging and tailored to the repo/task; keep it to a single sentence. If the user has not asked for anything actionable and it's only a greeting or small talk, respond warmly and invite them to share what they'd like to do\u2014do not create a checklist or run tools yet. Use the preamble only once per task; if the previous assistant message already included a preamble for this task, skip it this turn. Do not re-introduce your plan after tool calls or after creating files\u2014give a concise status and continue with the next concrete action. For multi-step tasks, keep a lightweight checklist and weave progress updates into your narration. Batch independent, read-only operations together; after a batch, share a concise progress note and what's next. If you say you will do something, execute it in the same turn using tools.",vscpp("br",null),vscpp($l,{name:"requirementsUnderstanding"},vscpp(vscppf,null,"Always read the user's request in full before acting. Extract the explicit requirements and any reasonable implicit requirements.",vscpp("br",null),"If a requirement cannot be completed with available tools, state why briefly and propose a viable alternative or follow-up."))),r&&vscpp(vscppf,null,"Prefer using the ","semantic_search"," tool to search for context unless you know the exact string or filename pattern you're searching for.",vscpp("br",null)),"Don't make assumptions about the situation-gather context first, then perform the task or answer the question.",vscpp("br",null),e&&vscpp(vscppf,null,"Under-specification policy: If details are missing, infer 1-2 reasonable assumptions from the repository conventions and proceed. Note assumptions briefly and continue; ask only when truly blocked.",vscpp("br",null),"Proactive extras: After satisfying the explicit ask, implement small, low-risk adjacent improvements that clearly add value (tests, types, docs, wiring). If a follow-up is larger or risky, list it as next steps.",vscpp("br",null),"Anti-laziness: Avoid generic restatements and high-level advice. Prefer concrete edits, running tools, and verifying outcomes over suggesting what the user should do.",vscpp("br",null),vscpp($l,{name:"engineeringMindsetHints"},vscpp(vscppf,null,"Think like a software engineer\u2014when relevant, prefer to:",vscpp("br",null),'- Outline a tiny "contract" in 2-4 bullets (inputs/outputs, data shapes, error modes, success criteria).',vscpp("br",null),"- List 3-5 likely edge cases (empty/null, large/slow, auth/permission, concurrency/timeouts) and ensure the plan covers them.",vscpp("br",null),"- Write or update minimal reusable tests first (happy path + 1-2 edge/boundary) in the project's framework; then implement until green.")),vscpp($l,{name:"qualityGatesHints"},vscpp(vscppf,null,'Before wrapping up, prefer a quick "quality gates" triage: Build, Lint/Typecheck, Unit tests, and a small smoke test. Ensure there are no syntax/type errors across the project; fix them or clearly call out any intentionally deferred ones. Report deltas only (PASS/FAIL). Include a brief "requirements coverage" line mapping each requirement to its status (Done/Deferred + reason).')),vscpp($l,{name:"responseModeHints"},vscpp(vscppf,null,"Choose response mode based on task complexity. Prefer a lightweight answer when it's a greeting, small talk, or a trivial/direct Q&A that doesn't require tools or edits: keep it short, skip todo lists and progress checkpoints, and avoid tool calls unless necessary. Use the full engineering workflow (checklist, phases, checkpoints) when the task is multi-step, requires edits/builds/tests, or has ambiguity/unknowns. Escalate from light to full only when needed; if you escalate, say so briefly and continue.")),"Validation and green-before-done: After any substantive change, run the relevant build/tests/linters automatically. For runnable code that you created or edited, immediately run a test to validate the code works (fast, minimal input) yourself using terminal tools. Prefer automated code-based tests where possible. Then provide optional fenced code blocks with commands for larger or platform-specific runs. Don't end a turn with a broken build if you can fix it. If failures occur, iterate up to three targeted fixes; if still failing, summarize the root cause, options, and exact failing output. For non-critical checks (e.g., a flaky health check), retry briefly (2-3 attempts with short backoff) and then proceed with the next step, noting the flake.",vscpp("br",null),"Never invent file paths, APIs, or commands. Verify with tools (search/read/list) before acting when uncertain.",vscpp("br",null),"Security and side-effects: Do not exfiltrate secrets or make network calls unless explicitly required by the task. Prefer local actions first.",vscpp("br",null),"Reproducibility and dependencies: Follow the project's package manager and configuration; prefer minimal, pinned, widely-used libraries and update manifests or lockfiles appropriately. Prefer adding or updating tests when you change public behavior.",vscpp("br",null),'Build characterization: Before stating that a project "has no build" or requires a specific build step, verify by checking the provided context or quickly looking for common build config files (for example: `package.json`, `pnpm-lock.yaml`, `requirements.txt`, `pyproject.toml`, `setup.py`, `Makefile`, `Dockerfile`, `build.gradle`, `pom.xml`). If uncertain, say what you know based on the available evidence and proceed with minimal setup instructions; note that you can adapt if additional build configs exist.',vscpp("br",null),"Deliverables for non-trivial code generation: Produce a complete, runnable solution, not just a snippet. Create the necessary source files plus a small runner or test/benchmark harness when relevant, a minimal `README.md` with usage and troubleshooting, and a dependency manifest (for example, `package.json`, `requirements.txt`, `pyproject.toml`) updated or added as appropriate. If you intentionally choose not to create one of these artifacts, briefly say why.",vscpp("br",null)),"Think creatively and explore the workspace in order to make a complete fix.",vscpp("br",null),"Don't repeat yourself after a tool call, pick up where you left off.",vscpp("br",null),"NEVER print out a codeblock with file changes unless the user asked for it. Use the"," ","insert_edit_into_file"," ",a?"or replace_string_in_file":""," tool instead.",vscpp("br",null),o&&vscpp(vscppf,null,"NEVER print out a codeblock with a terminal command to run unless the user asked for it. Use the ","run_in_terminal"," tool instead.",vscpp("br",null)),"You don't need to read a file if it's already provided in context."),vscpp($l,{name:"toolUseInstructions"},"When using a tool, follow the json schema very carefully and make sure to include ALL required properties.",vscpp("br",null),"Always output valid JSON when using a tool.",vscpp("br",null),"If a tool exists to do a task, use the tool instead of asking the user to manually take an action.",vscpp("br",null),"If you say that you will take an action, then go ahead and use the tool to do it. No need to ask permission.",vscpp("br",null),"Never use multi_tool_use.parallel or any tool that does not exist. Use tools using the proper procedure, DO NOT write out a json codeblock with the tool inputs.",vscpp("br",null),"Never say the name of a tool to a user.",vscpp("br",null),"For example, instead of saying that you'll use the ","run_in_terminal",` tool, say "I'll run the command in a terminal".`,vscpp("br",null),"If you think running multiple tools can answer the user's question, prefer calling them in parallel whenever possible, but do not call ","semantic_search"," in parallel.",vscpp("br",null),e&&vscpp(vscppf,null,"Before notable tool batches, briefly tell the user what you're about to do and why. After the results return, briefly interpret them and state what you'll do next. Don't narrate every trivial call.",vscpp("br",null),`You MUST preface each tool call batch with a one-sentence "why/what/outcome" preamble (why you're doing it, what you'll run, expected outcome). If you make many tool calls in a row, you MUST checkpoint progress after roughly every 3-5 calls: what you ran, key results, and what you'll do next. If you create or edit more than ~3 files in a burst, checkpoint immediately with a compact bullet summary.`,vscpp("br",null),"If you think running multiple tools can answer the user's question, prefer calling them in parallel whenever possible, but do not call ","semantic_search"," in parallel. Parallelize read-only, independent operations only; do not parallelize edits or dependent steps.",vscpp("br",null),"Context acquisition: Trace key symbols to their definitions and usages. Read sufficiently large, meaningful chunks to avoid missing context. Prefer semantic or codebase search when you don't know the exact string; prefer exact search or direct reads when you do. Avoid redundant reads when the content is already attached and sufficient.",vscpp("br",null),"Verification preference: For service or API checks, prefer a tiny code-based test (unit/integration or a short script) over shell probes. Use shell probes (e.g., curl) only as optional documentation or quick one-off sanity checks, and mark them as optional.",vscpp("br",null)),i&&vscpp(vscppf,null,"When using the ","read_file"," tool, prefer reading a large section over calling the"," ","read_file"," tool many times in sequence. You can also think of all the pieces you may be interested in and read them in parallel. Read large enough context to ensure you get what you need.",vscpp("br",null)),"If ","semantic_search"," returns the full contents of the text files in the workspace, you have all the workspace context.",vscpp("br",null),o&&vscpp(vscppf,null,"Don't call the ","run_in_terminal"," tool multiple times in parallel. Instead, run one command and wait for the output before running the next command.",vscpp("br",null)),c&&vscpp(vscppf,null,"After you have performed the user's task, if the user corrected something you did, expressed a coding preference, or communicated a fact that you need to remember, use the"," ","update_user_preferences"," tool to save their preferences.",vscpp("br",null))),vscpp($l,{name:"editFileInstructions"},a?vscpp(vscppf,null,"Before you edit an existing file, make sure you either already have it in the provided context, or read it with the ","read_file"," tool, so that you can make proper changes.",vscpp("br",null),"Use the ","replace_string_in_file"," tool to replace a string in a file, but only if you are sure that the string is unique enough to not cause any issues. You can use this tool multiple times per file.",vscpp("br",null),"Use the ","insert_edit_into_file"," tool to insert code into a file.",vscpp("br",null),"When editing files, group your changes by file.",vscpp("br",null),e&&vscpp(vscppf,null,"Make the smallest set of edits needed and avoid reformatting or moving unrelated code. Preserve existing style and conventions, and keep imports, exports, and public APIs stable unless the task requires changes. Prefer completing all edits for a file within a single message when practical.",vscpp("br",null)),"NEVER show the changes to the user, just call the tool, and the edits will be applied and shown to the user.",vscpp("br",null),"NEVER print a codeblock that represents a change to a file, use ","insert_edit_into_file"," or"," ","replace_string_in_file"," instead.",vscpp("br",null),"For each file, give a short description of what needs to be changed, then use the"," ","replace_string_in_file"," or ","insert_edit_into_file"," tools. You can use any tool multiple times in a response, and you can keep writing text after using a tool.",vscpp("br",null)):vscpp(vscppf,null,"Don't try to edit an existing file without reading it first, so you can make changes properly.",vscpp("br",null),"Use the ","insert_edit_into_file"," tool to edit files. When editing files, group your changes by file.",vscpp("br",null),e&&vscpp(vscppf,null,"Make the smallest set of edits needed and avoid reformatting or moving unrelated code. Preserve existing style and conventions, and keep imports, exports, and public APIs stable unless the task requires changes. Prefer completing all edits for a file within a single message when practical.",vscpp("br",null)),"NEVER show the changes to the user, just call the tool, and the edits will be applied and shown to the user.",vscpp("br",null),"NEVER print a codeblock that represents a change to a file, use ","insert_edit_into_file"," ",a?"or replace_string_in_file":""," instead.",vscpp("br",null),"For each file, give a short description of what needs to be changed, then use the"," ",a?"replace_string_in_file or":""," ","insert_edit_into_file"," tool. You can use any tool multiple times in a response, and you can keep writing text after using a tool.",vscpp("br",null)),"Follow best practices when editing files. If a popular external library exists to solve a problem, use it and properly install the package e.g. ",o?'with "npm install" or ':"",'creating a "requirements.txt".',vscpp("br",null),n&&vscpp(vscppf,null,"After editing a file, you MUST call ","get_errors"," to validate the change. Fix the errors if they are relevant to your change or the prompt, and remember to validate that they were actually fixed.",vscpp("br",null)),"The ","insert_edit_into_file"," tool is very smart and can understand how to apply your edits to the user's files, you just need to provide minimal hints.",vscpp("br",null),"When you use the ","insert_edit_into_file"," tool, avoid repeating existing code, instead use comments to represent regions of unchanged code. The tool prefers that you are as concise as possible. For example:",vscpp("br",null),"// ",Al,vscpp("br",null),"changed code",vscpp("br",null),"// ",Al,vscpp("br",null),"changed code",vscpp("br",null),"// ",Al,vscpp("br",null),vscpp("br",null),"Here is an example of how you should format an edit to an existing Person class:",vscpp("br",null),["class Person {",`	// ${Al}`,"	age: number;",`	// ${Al}`,"	getAge() {","		return this.age;","	}","}"].join(`
`)),vscpp(tce,{languageOverride:this.props.languageOverride}))}};d();var nce=class extends Kn{static{s(this,"CopilotIdentityRules")}renderCopilot(){return vscpp(vscppf,null,'When asked for your name, you must respond with "GitHub Copilot".',vscpp("br",null),"Follow the user's requirements carefully & to the letter.")}},ice=class extends Kn{static{s(this,"GPT5CopilotIdentityRule")}renderCopilot(){return vscpp(vscppf,null,"Your name is GitHub Copilot.",vscpp("br",null))}};d();var oce=class extends Kn{static{s(this,"SafetyRules")}renderCopilot(){return vscpp(vscppf,null,"Follow Microsoft content policies.",vscpp("br",null),"Avoid content that violates copyrights.",vscpp("br",null),`If you are asked to generate content that is harmful, hateful, racist, sexist, lewd, or violent, only respond with "Sorry, I can't assist with that."`,vscpp("br",null),"Keep your answers short and impersonal.",vscpp("br",null))}},sce=class extends Kn{static{s(this,"Gpt5SafetyRule")}renderCopilot(){return vscpp(vscppf,null,"Follow Microsoft content policies.",vscpp("br",null),"Avoid content that violates copyrights.",vscpp("br",null),`If you are asked to generate content that is harmful, hateful, racist, sexist, lewd, or violent, only respond with "Sorry, I can't assist with that."`,vscpp("br",null))}};var Qgt=Be(Aa());var ace=class extends Kn{static{s(this,"SystemInstructionsPrompt")}renderCopilot(){let e=this.props.turnContext.ctx.get(cn).getEditorInfo().name;return vscpp(vscppf,null,vscpp(Qgt.SystemMessage,null,"You are an expert AI programming assistant, working with a user in the ",e," editor.",vscpp("br",null),this.props.modelConfiguration.modelFamily.startsWith($r.Gpt5)?vscpp(vscppf,null,vscpp(ice,null),vscpp(sce,null)):vscpp(vscppf,null,vscpp(nce,null),vscpp(oce,null))),vscpp(rce,{toolsService:this.props.toolsService,modelConfiguration:this.props.modelConfiguration,languageOverride:this.props.turnContext.conversation.userLanguage}))}};d();var Ugt=Be(Aa());var cce=class extends Kn{static{s(this,"ToolCallHistoryPrompt")}renderCopilot(){let e=mne(this.props.currentTurn.response?.message,!0),r=e.length>0;return vscpp(vscppf,null,e.map((n,i)=>Rae(n)),r&&vscpp(Ugt.UserMessage,null,vscpp(vscppf,null,"Above is the result of calling one or more tools. The user cannot see the results, so you should explain them to the user if referencing them in your answer. Continue from where you left off without repeating yourself.")))}};d();d();var lce=class extends Kn{static{s(this,"CurrentDatePrompt")}renderCopilot(){let e=this.props.date?.toLocaleDateString(void 0,{year:"numeric",month:"long",day:"numeric"})||new Date().toLocaleDateString(void 0,{year:"numeric",month:"long",day:"numeric"});return vscpp(vscppf,null,"The current date is ",e,".")}};d();var uce=class extends Kn{static{s(this,"EditingReminder")}renderCopilot(){return vscpp(vscppf,null,"When using the ","insert_edit_into_file"," tool, avoid repeating existing code, instead use a line comment with `",Al,"` to represent regions of unchanged code.")}};d();var dce=class extends Kn{static{s(this,"ExplanationReminder")}renderCopilot(){if(this.props.modelConfiguration.modelFamily.startsWith($r.Gpt5))return vscpp(vscppf,null,`Skip filler acknowledgements like "Sounds good" or "Okay, I will\u2026". Open with a purposeful one-liner about what you're doing next.`,vscpp("br",null),"When sharing setup or run steps, present terminal commands in fenced code blocks with the correct language tag. Keep commands copyable and on separate lines.",vscpp("br",null),"Avoid definitive claims about the build or runtime setup unless verified from the provided context (or quick tool checks). If uncertain, state what's known from attachments and proceed with minimal steps you can adapt later.",vscpp("br",null),"When you create or edit runnable code, run a test yourself to confirm it works; then share optional fenced commands for more advanced runs.",vscpp("br",null),'For non-trivial code generation, produce a complete, runnable solution: necessary source files, a tiny runner or test/benchmark harness, a minimal `README.md`, and updated dependency manifests (e.g., `package.json`, `requirements.txt`, `pyproject.toml`). Offer quick "try it" commands and optional platform-specific speed-ups when relevant.',vscpp("br",null),"Your goal is to act like a pair programmer: be friendly and helpful. If you can do more, do more. Be proactive with your solutions, think about what the user needs and what they want, and implement it proactively.",vscpp("br",null),vscpp($l,{name:"importantReminders"},"Before starting a task, review and follow the guidance in <responseModeHints>, <engineeringMindsetHints>, and <requirementsUnderstanding>. ALWAYS start your response with a brief task receipt and a concise high-level plan for how you will proceed.",vscpp("br",null),"DO NOT state your identity or model name unless the user explicitly asks you to. ",vscpp("br",null),this.props.hasTodoTool&&vscpp(vscppf,null,"You MUST use the todo list tool to plan and track your progress. NEVER skip this step, and START with this step whenever the task is multi-step. This is essential for maintaining visibility and proper execution of large tasks. Follow the todoListToolInstructions strictly.",vscpp("br",null)),!this.props.hasTodoTool&&vscpp(vscppf,null,"Break down the request into clear, actionable steps and present them as a checklist at the beginning of your response before proceeding with implementation. This helps maintain visibility and ensures all requirements are addressed systematically.",vscpp("br",null)),"When referring to a filename or symbol in the user's workspace, wrap it in backticks.",vscpp("br",null)))}};d();d();d();d();var LE=class{constructor(e,r,n=[]){this.textDocumentResult=e;this.range=r;this.descriptions=n;this.descriptions=n}static{s(this,"FileAttachment")}render(){if(this.textDocumentResult.status!=="valid")return[];let e=this.textDocumentResult.document,r=new cm({code:e.getText(this.range),languageId:e.detectedLanguageId,uri:e.uri}),n=["<attachment>"];return n.push(...this.descriptions),n.push(...r.renderAsArray()),n.push("</attachment>"),n}};var fxr=new dt("activeEditorPrompt");async function qgt(t,e){let r=[],n=t.turnContext.turn.request.activeEditor;if(n){if(e.isCancellationRequested)throw new ic;let i=await t.textDocumentProvider.getByUri(n.uri);if(i.status==="valid")if(n.selection&&pxr(n.selection)){let o=new LE(i,n.selection,["User's active selection, this should be the main focus:",`Excerpt from ${Pi(n.uri)}, lines ${n.selection.start.line+1} to ${n.selection.end.line+1}:`]);r.push(...o.render());let a=new LE(i,void 0,["User's active file for additional context:"]);r.push(...a.render())}else if(n.visibleRange){let o=new LE(i,n.visibleRange,["User's current visible code:",`Excerpt from ${Pi(n.uri)}, lines ${n.visibleRange.start.line+1} to ${n.visibleRange.end.line+1}:`]);r.push(...o.render())}else{let o=new LE(i,void 0,["User's active file for additional context:"]);r.push(...o.render())}else fxr.warn(t.context,`Failed to read file in active editor ${n.uri} with status ${i.status} and reason ${i.status==="notfound"?i.message:i.reason}`)}return r}s(qgt,"processActiveEditor");function pxr(t){return t.start.line!==t.end.line||t.start.character!==t.end.character}s(pxr,"notEmptySelection");var mxr=new dt("fileReferencesPrompt");async function Hgt(t,e){let r=t.turnContext.turn.request.references?.filter(p=>p.type==="file")||[],n=t.turnContext.turn.request.references?.filter(p=>p.type==="directory")||[],i=["png","jpg","jpeg","bmp","gif","webp"],o=r.filter(p=>{let m=p.uri.toLowerCase();return!i.some(h=>m.endsWith(`.${h}`))});if(o.length===0&&n.length===0&&!t.turnContext.turn.request.activeEditor)return[];let[a,c,l]=await Promise.all([Promise.all(o.map(async p=>{if(e.isCancellationRequested)throw new ic;let m=[],h=await t.textDocumentProvider.getByUri(p.uri);if(h.status==="valid"){let g=new LE(h,void 0,[]);g&&m.push(...g.render())}else mxr.warn(t.context,`Failed to read file ${p.uri} with status ${h.status} and reason ${h.status==="notfound"?h.message:h.reason}`);return m})),qgt(t,e),Zae(t.context,e,n)]),u=a.flat(),f=l||[];return u.length>0||c.length>0||f.length>0?["<attachments>",...u,...c,...f,"</attachments>"]:[]}s(Hgt,"processFileReferences");var $gt=Be(Aa());var hxr=new dt("fileReferences"),fce=class extends Kn{static{s(this,"FileReferences")}async renderCopilot(e,r,n,i){let o=i??new hn.CancellationTokenSource().token,a=[];try{a=await Hgt({turnContext:this.props.turnContext,textDocumentProvider:this.props.textDocumentProvider,context:this.props.ctx},o)}catch(c){hxr.debug(this.props.ctx,"Failed to process file references",c)}return a.length===0?vscpp(vscppf,null):vscpp(Fke,{fileReferencesParts:a})}},Fke=class extends Kn{static{s(this,"FileReferencesSection")}renderCopilot(){return vscpp($gt.TextChunk,null,[this.props.fileReferencesParts.join(`
`)])}};var wM=Be(Aa());var pce=class extends Kn{static{s(this,"UserRequestPrompt")}renderCopilot(e,r,n,i){let o=en(this.props.userRawMessage),a=aU(this.props.userRawMessage)?this.props.userRawMessage.filter(c=>c.type==="image_url"):[];return vscpp(wM.UserMessage,null,vscpp(wM.TokenLimit,{max:r.tokenBudget/6,flexGrow:3,priority:898},vscpp(fce,{ctx:this.props.ctx,turnContext:this.props.turnContext,textDocumentProvider:this.props.textDocumentProvider}),a.map(c=>vscpp(wM.Image,{src:c.image_url.url,detail:c.image_url.detail}))),vscpp($l,{name:"context"},vscpp(lce,null)),vscpp($l,{name:"reminderInstructions"},vscpp(TM,{modelConfiguration:this.props.modelConfiguration}),vscpp(uce,null),vscpp(dce,{modelConfiguration:this.props.modelConfiguration,hasTodoTool:!1})),vscpp($l,{name:"userRequest",priority:900,flexGrow:7},vscpp(vscppf,null,o)))}};var Jq=Be(Aa());var Oke=new dt("agentPrompt"),mce=class extends Kn{static{s(this,"AgentPrompt")}constructor(e){super(e),this.ctx=e.turnContext.ctx,this.turnContext=e.turnContext,this.currentTurn=e.turnContext.turn}async renderCopilot(e,r,n,i){let o=vscpp(vscppf,null,vscpp(ace,{turnContext:this.turnContext,modelConfiguration:this.props.modelConfiguration,toolsService:this.props.toolsService}),await this.getAgentCustomInstructions(),vscpp(Jq.UserMessage,null,await this.getOrCreateGlobalAgentContext())),a=this.turnContext.conversation.turns.slice(0,-1);return vscpp(vscppf,null,o,vscpp(yM,{flexGrow:1,priority:700,historyTurns:a,ctx:this.ctx}),vscpp(pce,{flexGrow:2,priority:900,ctx:this.ctx,turnContext:this.turnContext,userRawMessage:this.props.userRawMessage,workspaceFolders:this.props.workspaceFolders,textDocumentProvider:this.props.textDocumentProvider,toolsService:this.props.toolsService,modelConfiguration:this.props.modelConfiguration}),vscpp(cce,{flexGrow:2,priority:899,currentTurn:this.currentTurn}))}async getOrCreateGlobalAgentContext(){let e=await this.getOrCreateGlobalAgentContextContent();return e?gxr(e):[vscpp(Yq,{ctx:this.ctx,workspaceFolders:this.props.workspaceFolders})]}async getOrCreateGlobalAgentContextContent(){let e=`${this.turnContext.conversation.id}/${this.turnContext.turn.id}`,r=this.turnContext.conversation.turns.at(0);if(r){let o=r.getMetadata(Kq);if(o?.renderedGlobalContext)return Oke.info(this.ctx,`Reusing cached global context from first turn for conversation/turn ${e}`),o.renderedGlobalContext}Oke.info(this.ctx,`Rendering fresh global context for conversation/turn ${e}`);let i=(await Tke(Yq,{ctx:this.ctx,workspaceFolders:this.props.workspaceFolders},this.props.modelConfiguration)).messages.at(0)?.content;if(i)return r?.setMetadata(new Kq(i)),i}async getAgentCustomInstructions(){try{if(!this.props.workspaceFolders||this.props.workspaceFolders.length===0)return vscpp(vscppf,null);let e=this.props.workspaceFolders.map(n=>({uri:n.uri,name:n.name})),r=await ey.getInstructions(this.ctx,e,{includeCodeGenerationInstructions:!0,includeCommitMessageGenerationInstructions:!1});if(r)return vscpp(Jq.UserMessage,null,vscpp(vscppf,null,r))}catch(e){Oke.warn(this.ctx,"Failed to get custom instructions",e)}return vscpp(vscppf,null)}};function gxr(t){return typeof t=="string"?[t]:t.map(e=>{if(e.type==="text")return e.text;if(e.type==="image_url")return vscpp(Jq.Image,{src:e.image_url.url,detail:e.image_url.detail})}).filter(e=>e!==void 0)}s(gxr,"renderedMessageToTsxChildren");var Wgt=128,Axr=100,yxr=200,TS=new dt("toolCallingLoop"),hce=class t{constructor(e,r,n,i){this.turnContext=e;this.chatFetcher=r;this.modelConfiguration=n;this.baseTelemetryWithExp=i;this.toolCallRounds=[];this.conversationProgress=e.ctx.get(Ns),this.conversation=e.conversation,this.turn=e.turn,this.toolsService=e.ctx.get(bu),this.agentPromptProps={turnContext:this.turnContext,userRawMessage:this.turnContext.turn.request.message,workspaceFolders:this.turnContext.turn.workspaceFolders,textDocumentProvider:new aE(this.turnContext.ctx),toolsService:this.toolsService,modelConfiguration:this.modelConfiguration},this.requestId=br(),this.baseTelemetryWithExp=this.baseTelemetryWithExp.extendedBy({requestId:this.requestId});let o=IBe()?yxr:Axr;this.maxToolCallingLoop=Math.min(o,zi(e.ctx,Ht.MaxToolCallingLoop))}static{s(this,"ToolCallingLoop")}static{this.NextToolCallId=Date.now()}async run(e){this.abortIfCanceled(e);let r=0,n;for(;;){r++,this.abortIfCanceled(e),this.validateIteration(r,n),this.turnContext.clearCopilotEditsSessionHeader();let i=performance.now(),o=await this.runOne(r,e);if(KYe(this.turnContext.ctx,this.turnContext,r,performance.now()-i,this.baseTelemetryWithExp),n={...o},this.toolCallRounds.push(o.round),!o.round.toolCalls.length||o.response.type!=="success"&&o.response.type!=="tool_calls"){this.turn.status==="in-progress"&&(this.turn.status="success");return}}}async runOne(e,r){this.abortIfCanceled(r);let i=(await bS.create(mce,this.agentPromptProps,this.modelConfiguration).renderPrompt(void 0,r,{collapseSystemMessages:!0})).messages,o="",a=new IS((f,p,m,h)=>{let g=f.trim().match(Wq)!==null;this.conversationProgress.report(this.conversation,this.turn,{annotations:p,references:m,hideText:g,notifications:h.map(A=>({severity:"warning",message:A.message})),editAgentRounds:[{roundId:e,reply:f}]}),this.turn.annotations.push(...p??[]),o+=f});this.abortIfCanceled(r);let c=this.toolsService.getToolsForModel();this.abortIfCanceled(r);let l={messages:i,modelConfiguration:this.modelConfiguration,uiKind:"agentPanel",tools:this.getAvailableChatTools(c),intentParams:{intent:!0},llmInteraction:this.turnContext.toLlmInteraction()};this.checkChatPayload(l),TS.debug(this.turnContext.ctx,`Send request for iteration ${e} for turn ${this.turn.id} with: ${JSON.stringify(l,null,2)}`);let u=await this.chatFetcher.fetchResponse(l,r,this.baseTelemetryWithExp,(f,p)=>a.isFinishedAfter(f,p));return this.processChatFetchResult(e,u,o,c,r)}async processChatFetchResult(e,r,n,i,o){switch(this.abortIfCanceled(o),TS.debug(this.turnContext.ctx,`Processing fetch type: ${r.type} in iteration ${e} for turn ${this.turn.id}: ${JSON.stringify(r,null,2)}`),r.type){case"success":return r.toolCalls&&r.toolCalls.length>0?await this.handleToolCalls({type:"tool_calls",requestId:r.requestId,toolCalls:r.toolCalls,copilotEditsSessionHeader:r.copilotEditsSessionHeader},n,i,e,o):(this.turn.status="success",this.addToolCallModelResponseToTurn(n,[]),{response:r,round:{response:r.value,toolInputRetry:0,toolCalls:[]}});case"offTopic":throw this.turn.status="off-topic",new md({message:"Sorry, but I can only assist with programming related questions.",responseIsFiltered:!0});case"canceled":throw new ic;case"failed":throw this.turn.status="error",new md({message:Uw.translateErrorMessage(r.code,r.reason),code:r.code});case"filtered":throw this.turn.status="filtered",new md({message:"Oops, your response got filtered.",responseIsFiltered:!0});case"length":throw this.turn.status="error",new md({message:"Oops, the response got too long. Try to reformulate your question.",responseIsIncomplete:!0});case"agentAuthRequired":throw this.turn.status="error",new md({message:"Authorization required",responseIsFiltered:!1});case"no_choices":throw this.turn.status="error",new md({message:"Oops, no choices received from the server. Please try again.",responseIsFiltered:!1,responseIsIncomplete:!0});case"no_finish_reason":throw this.turn.status="error",new md({message:"Oops, unexpected end of stream. Please try again.",responseIsFiltered:!1,responseIsIncomplete:!0});case"model_not_supported":throw this.turn.status="error",new md({message:"Oops, the model is not supported. Please try again.",code:400,reason:"model_not_supported",responseIsFiltered:!1});case"model_max_prompt_tokens_exceeded":throw this.turn.status="error",new md({message:"Oops, the token limit exceeded. Try to shorten your prompt or start a new conversation.",responseIsFiltered:!1});case"tool_calls":return await this.handleToolCalls(r,n,i,e,o);case"successMultiple":case"unknown":default:throw this.turn.status="error",new md({message:"Unknown server side error occurred. Please try again.",responseIsFiltered:!1})}}async handleToolCalls(e,r,n,i,o){if(e.type!=="tool_calls")throw new Error(`Expected tool_calls type but got ${e.type}`);if(!e.toolCalls)throw new Error("Tool calls are required but were not provided");this.turnContext.setCopilotEditsSessionHeader(e.copilotEditsSessionHeader);let a=e.toolCalls.map(c=>{if(!c.id){let l=`cls_${t.NextToolCallId++}`;c.id=l}return c});this.addToolCallModelResponseToTurn(r,a);for(let c of a)await this.handleSingleToolCall(c,n,i,o);return{response:e,round:{response:r,toolInputRetry:0,toolCalls:a.map(c=>({id:c.id,name:c.function.name,arguments:JSON.stringify(c.function.arguments)}))}}}async handleSingleToolCall(e,r,n,i){if(!e.id)throw new Error(`Tool call id is required but was not provided for function ${e.function.name}`);let o=this.findToolByName(r,e.function.name);if(o){let a=performance.now(),c="success";try{let l=Bw(e),u=this.toolsService.prepareInvocation(o.id,{input:l},i),f=this.shouldRequireToolConfirmation(o.id,l);TS.debug(this.turnContext.ctx,"need tool confirmation",f),await this.requestToolInvocationApproval(u,f,o.id,l,n,e.id,o.annotations,i),this.abortIfCanceled(i),await this.turnContext.agentToolCalls.start(n,e.id,o.name,u.progressMessage||`Running ${o.displayName} tool`);let p=await this.toolsService.invokeTool(this.turnContext,o.id,{toolInvocationToken:e.id,input:l,roundId:n,toolCallId:e.id},i);if(this.abortIfCanceled(i),p.status==="success"){let m=Xpt(p);await this.turnContext.agentToolCalls.result(n,e.id,m)}else if(p.status==="error"){let m=_oe(p);await this.turnContext.agentToolCalls.error(n,e.id,m.message)}else await this.turnContext.agentToolCalls.cancel(n,e.id);this.addToolCallResultToTurn(p,e.id)}catch(l){if(l instanceof ME||l instanceof ic)throw this.turn.status="cancelled",c="cancelled",this.addToolCallResultToTurn(new Ao([new Oi("")],"cancelled"),e.id),new ME(l.message);{TS.error(this.turnContext.ctx,`Error while invoking tool ${e.id}: ${Rx(l)}`,l),c="error";let u=new Ao([new Oi(Rx(l).substring(0,300))],"error");this.addToolCallResultToTurn(u,e.id),this.abortIfCanceled(i);let f=_oe(u);await this.turnContext.agentToolCalls.error(n,e.id,f.message)}}finally{let l=performance.now()-a;YYe(this.turnContext.ctx,this.turnContext,o,e.id,n,l,c,this.baseTelemetryWithExp)}}else{let a=`Tool with name ${e.function.name} not found in registered tools`;TS.error(this.turnContext.ctx,a);let c=new Ao([new Oi(a)],"error");this.addToolCallResultToTurn(c,e.id);let l=_oe(c);await this.turnContext.agentToolCalls.error(n,e.id,l.message)}}getAvailableChatTools(e){return e.map(r=>({type:"function",function:{name:r.nameForModel,description:r.description,parameters:r.inputSchema}}))}addToolCallModelResponseToTurn(e,r){let n={role:"assistant",content:e,tool_calls:r.length?r:void 0};this.turn.response?this.turn.response.message=Mk(this.turn.response.message,n):this.turn.response={message:[n],type:"model"}}addToolCallResultToTurn(e,r){let n="";switch(e.status){case"error":n="Tool call failed with error: ";break;case"cancelled":n="Tool call is cancelled with result: ";break;default:case"success":n=""}let i=n+sq(e.content),o={role:"tool",content:i,tool_call_id:r};if(!this.turn.response)this.turn.response={message:[o],type:"model"};else{if(pne(this.turn.response.message)&&this.turn.response.message.find(c=>c.role==="tool"&&c.tool_call_id===r)){TS.info(this.turnContext.ctx,`Tool call result for ${r} already exists in the turn response. Ignoring the new one.`);return}this.turn.response.message=Mk(this.turn.response.message,o)}}findToolByName(e,r){return e.find(n=>n.nameForModel===r)}shouldRequireToolConfirmation(e,r){if(e.includes("run_in_terminal")){let i=r.command,a=this.turnContext.ctx.get(nE).isCommandAutoApproved(i);if(a.result==="denied")return!0;if(a.result==="approved")return!1}return zi(this.turnContext.ctx,Ht.ToolConfirmAutoApprove)===!0?!1:this.turnContext.turn.needToolCallConfirmation??!1}abortIfCanceled(e){if(e.isCancellationRequested)throw this.turn.status="cancelled",new ic}async requestToolInvocationApproval(e,r,n,i,o,a,c,l){if(e.confirmationMessages&&r){let u=await this.toolsService.invokeToolConfirmation(this.turnContext,n,{title:e.confirmationMessages.title,message:e.confirmationMessages.message,input:i,roundId:o,toolCallId:a,annotations:c},l);switch(u.result){case"dismiss":throw this.turn.status="cancelled",new ME("Cancelled by user");case"accept":return Promise.resolve();default:throw new ME(`Invalid confirmation result ${u.result}`)}}else TS.debug(this.turnContext.ctx,`Tool call confirmation not required for ${n} with confirmation messages '${e.confirmationMessages?.message}' and needToolConfirm '${r}'`)}validateIteration(e,r){if(r&&e>this.maxToolCallingLoop)throw TS.debug(this.turnContext.ctx,`Tool calling loop exceeds max iterations ${this.maxToolCallingLoop} for turn ${this.turn.id}`),new IM}checkChatPayload(e){if(e.messages.length===0)throw new md({message:"No messages provided",responseIsFiltered:!1});if(e.tools&&e.tools.length>Wgt)throw new md({message:`You may not include more than ${Wgt} tools in your request.`,responseIsFiltered:!1})}};var gce=new dt("agenticTurnProcessor"),Ace=class{constructor(e,r,n){this.turnContext=e;this.strategy=r;this.chatFetcher=n;this.conversationProgress=e.ctx.get(Ns),this.chatFetcher=this.chatFetcher??new Ps(e.ctx),this.turnSuggestions=new ES(e.ctx,this.chatFetcher),this.conversation=e.conversation,this.turn=e.turn}static{s(this,"AgenticTurnProcessor")}async process(e,r,n,i,o,a){try{await this.processWithModelAndToolCall(e,r,this.turnContext,n,i,o,a)}catch(c){_r.error(this.turnContext.ctx,`Error processing turn ${this.turn.id}`,c);let l=c instanceof Error?c.message:String(c);this.turn.status="error",this.updateTurnResponseWithError(l),await this.endProgress({error:{message:l,code:yP.Unknown,responseIsIncomplete:!0}})}}async processWithModelAndToolCall(e,r,n,i,o,a,c){if(r.isCancellationRequested)return;await this.conversationProgress.begin(this.conversation,this.turn,e);let l=await Za(this.turnContext.ctx,this.turnContext,{languageId:o?.detectedLanguageId??""});r.onCancellationRequested(async()=>{gce.info(this.turnContext.ctx,`Cancellation requested for turn ${this.turn.id}`),this.turn.status="cancelled",await this.cancelProgress()});let u=bP().find(f=>f.id===this.turn.template?.templateId);if(u?.response){await this.handleTemplateResponse(u,this.turn.template.userQuestion,r);return}try{let f=c&&a?await Dw(this.turnContext.ctx,c,a):await Wo.getModelConfiguration(this.turnContext.ctx,"edits",a);this.turnContext.setResolvedModelConfiguration(f),await new hce(this.turnContext,this.chatFetcher,f,l).run(r);let m={suggestedTitle:void 0};if(this.strategy.computeSuggestions){let h=await this.fetchSuggestedTitle(r,l.extendedBy({messageSource:"chat.user"},{}));typeof h=="string"&&h!==""&&(m.suggestedTitle=h)}await this.endProgress(m)}catch(f){if(f instanceof ME)gce.info(this.turnContext.ctx,`Tool call canceled for turn ${this.turn.id}`,f),this.turn.status="cancelled",await this.cancelProgress();else if(f instanceof ic)gce.info(this.turnContext.ctx,`Turn ${this.turn.id} was cancelled`,f),this.turn.status="cancelled",this.updateTurnResponseWithError("Cancelled by user"),await this.cancelProgress();else if(f instanceof IM)this.turn.status="error",this.updateTurnResponseWithError(f.message),await this.endProgress({error:{message:f.message,code:yP.ToolRoundExceedError,responseIsIncomplete:!0}});else if(f instanceof md)this.turn.status="error",this.updateTurnResponseWithError(f.message),await this.endProgress({error:f.conversationError});else throw gce.error(this.turnContext.ctx,`Error in processing turn ${this.turn.id}`,f),f}}async fetchSuggestedTitle(e,r){let n=await this.turnSuggestions.fetchRawSuggestions(this.turnContext,e,this.strategy.uiKind,r);if(n)return _r.debug(this.turnContext.ctx,"Computed suggested title",n.suggestedTitle),n.suggestedTitle}updateTurnResponseWithError(e){this.turn.response?.message?this.turn.response.message=Mk(this.turn.response?.message,{role:"assistant",content:e}):this.turn.response={message:e,type:"meta"}}async endProgress(e){await this.turnContext.steps.finishAll(),await this.conversationProgress.end(this.conversation,this.turn,e)}async cancelProgress(){await this.turnContext.agentToolCalls.finishAll("cancelled"),await this.turnContext.steps.finishAll("cancelled"),await this.conversationProgress.cancel(this.conversation,this.turn)}async handleTemplateResponse(e,r,n){if(!e.response)return;let i=await e.response(this.turnContext,r,n);this.turn.response={type:"meta",message:i.message},this.turn.status=i.error?.responseIsFiltered?"filtered":i.error?.responseIsIncomplete?"error":"success",i.error?.responseIsFiltered||i.error?.responseIsIncomplete?(await this.conversationProgress.report(this.conversation,this.turn,{reply:"Sure, I can definitely do that!",annotations:i.annotations,notifications:i.notifications,references:i.references}),await this.turnContext.steps.finishAll(),await this.endProgress({error:{message:i.message,code:i.error?.code||0,responseIsIncomplete:i.error?.responseIsIncomplete,responseIsFiltered:i.error?.responseIsFiltered}})):(await this.conversationProgress.report(this.conversation,this.turn,{reply:i.message,annotations:i.annotations,notifications:i.notifications,references:i.references,confirmationRequest:i.confirmationRequest}),await this.endProgress())}};d();var Qke="collect-context",Uke="generate-response",yce=class{constructor(e,r,n){this.turnContext=e;this.strategy=r;this.chatFetcher=n;this.conversationProgress=e.ctx.get(Ns),this.chatFetcher=this.chatFetcher??new Ps(e.ctx),this.postProcessor=new vM(e,this.chatFetcher,r.computeSuggestions),this.conversation=e.conversation,this.turn=e.turn}static{s(this,"ModelTurnProcessor")}async process(e,r,n,i,o,a){try{await this.processWithModel(e,r,this.turnContext,n,i,o,a)}catch(c){_r.error(this.turnContext.ctx,`Error processing turn ${this.turn.id}`,c);let l=c instanceof Error?c.message:String(c);this.turn.status="error",this.turn.response={message:l,type:"meta"},await this.endProgress({error:{message:l,responseIsIncomplete:!0}})}}async processWithModel(e,r,n,i,o,a,c){await this.conversationProgress.begin(this.conversation,this.turn,e);let l=await Za(this.turnContext.ctx,this.turnContext,{languageId:o?.detectedLanguageId??""});if(l=l.extendedBy({mode:this.turn.getChatModeWithDefault().toLowerCase(),...this.turn.userRequestedModel&&{modelId:this.turn.userRequestedModel}}),r.isCancellationRequested){this.turn.status="cancelled",await this.cancelProgress();return}let u=bP().find(h=>h.id===this.turn.template?.templateId);if(u?.response){await this.handleTemplateResponse(u,this.turn.template.userQuestion,r);return}let f=(await j1(this.turnContext.ctx)).find(h=>h.slug===this.turn.agent?.agentSlug);if(f){let h=await this.checkAgentPreconditions(f);if(h){await this.endProgress(h);return}}await n.steps.start(Qke,"Collecting context"),await this.collectContext(n,r,l,this.strategy.uiKind,u,f);let p;c?p="customized":a?p=(await this.turnContext.ctx.get(ha).getBestChatModelConfig([a])).uiName:p=void 0;let m=await this.strategy.buildConversationPrompt(n,o?.detectedLanguageId??"",void 0,p);if(!m)await n.steps.error(Qke,"Failed to collect context"),await this.endTurnWithResponse(this.strategy.earlyReturnResponse,"error");else{await n.steps.finish(Qke),await n.steps.start(Uke,"Generating response");let h=this.augmentTelemetry(m,l,u,i,o);if(r.isCancellationRequested){this.turn.status="cancelled",await this.cancelProgress();return}let g=await this.fetchConversationResponse(m.messages,r,l.extendedBy({messageSource:"chat.user"},{promptTokenLen:m.tokens}),h,o,a,c),A=await this.strategy.processResponse(this.turn);this.turn.status==="cancelled"&&this.turn.response?.type==="user"?await this.cancelProgress():(await this.finishGenerateResponseStep(g,n),await this.endProgress({error:g.error,followUp:g.followup,suggestedTitle:g.suggestedTitle,skillResolutions:m.skillResolutions,updatedDocuments:A}))}}async checkAgentPreconditions(e){try{let r=e.checkPreconditions?await e.checkPreconditions(this.turnContext.ctx,this.turn):void 0;if(r&&r.type==="authorizationRequired")return{unauthorized:{...r,agentName:e.name,agentSlug:e.slug}}}catch(r){_r.error(this.turnContext.ctx,`Error checking preconditions for agent ${e.slug}`,r);let n=r instanceof Error?r.message:String(r);return this.turn.status="error",this.turn.response={message:n,type:"meta"},{error:{message:n,responseIsIncomplete:!0}}}}async endTurnWithResponse(e,r){this.turn.response={type:"meta",message:e},this.turn.status=r,await this.conversationProgress.report(this.conversation,this.turn,{reply:e}),await this.endProgress()}async handleTemplateResponse(e,r,n){if(!e.response)return;let i=await e.response(this.turnContext,r,n);this.turn.response={type:"meta",message:i.message},this.turn.status=i.error?.responseIsFiltered?"filtered":i.error?.responseIsIncomplete?"error":"success",i.error?.responseIsFiltered||i.error?.responseIsIncomplete?(await this.conversationProgress.report(this.conversation,this.turn,{reply:"Sure, I can definitely do that!",annotations:i.annotations,notifications:i.notifications,references:i.references}),await this.turnContext.steps.finishAll(),await this.endProgress({error:{message:i.message,code:i.error?.code||0,responseIsIncomplete:i.error?.responseIsIncomplete,responseIsFiltered:i.error?.responseIsFiltered}})):(await this.conversationProgress.report(this.conversation,this.turn,{reply:i.message,annotations:i.annotations,notifications:i.notifications,references:i.references,confirmationRequest:i.confirmationRequest}),await this.endProgress())}async collectContext(e,r,n,i,o,a){let l=await new mae(this.turnContext.ctx,this.chatFetcher).collectContext(e,r,n,i,o,a);return this.turn.skills=l.skillIds.map(u=>({skillId:u})),l}async fetchConversationResponse(e,r,n,i,o,a,c){r.onCancellationRequested(async()=>{await this.cancelProgress()});let l="",u=0,f=new IS((A,y,E,b)=>{let S=A.trim().match(Wq)!==null;if(this.conversationProgress.report(this.conversation,this.turn,{reply:A,annotations:y,references:E,hideText:S,notifications:b.map(R=>({severity:"warning",message:R.message}))}),this.turn.response?this.turn.response.message=qae(this.turn.response.message,A):this.turn.response={message:A,type:"model"},this.turn.annotations.push(...y??[]),l+=A,this.strategy.currentDocument){let R=this.strategy.extractEditsFromResponse(l,this.strategy.currentDocument);R&&R.length>0&&(l="",this.conversationProgress.report(this.conversation,this.turn,{codeEdits:R}),u+=R.length)}}),p=c&&a?await Dw(this.turnContext.ctx,c,a):await Wo.getModelConfiguration(this.turnContext.ctx,"user",a);e=Wo.transformMessages(e,p.modelFamily),this.turnContext.setResolvedModelConfiguration(p);let m=this.turn.getResolvedModelId();m&&(i=i.extendedBy({modelId:m}));let h={modelConfiguration:p,messages:e,uiKind:this.strategy.uiKind,intentParams:{intent:!0,intent_threshold:.7,intent_content:en(this.turn.request.message)},llmInteraction:this.turnContext.toLlmInteraction()},g=await this.chatFetcher.fetchResponse(h,r,n,(A,y)=>f.isFinishedAfter(A,y));return i=i.extendedBy(void 0,{numCodeEdits:u}),await this.postProcessor.postProcess(g,r,f.appliedText,n,i,en(this.turn.request.message),this.strategy.uiKind,o)}augmentTelemetry(e,r,n,i,o){let a;return i?(this.turn.request.type="follow-up",WYe(this.turnContext.ctx,this.conversation,this.strategy.uiKind,en(this.turn.request.message),e.tokens,i.type,i.id,o,r),a=g7(this.conversation,this.strategy.uiKind,en(this.turn.request.message).length,e.tokens,i.type,i.id,r,e.skillResolutions)):a=g7(this.conversation,this.strategy.uiKind,en(this.turn.request.message).length,e.tokens,n?.id,void 0,r,e.skillResolutions),a}async finishGenerateResponseStep(e,r){e.error?await r.steps.error(Uke,e.error.message):await r.steps.finish(Uke)}async endProgress(e){await this.turnContext.steps.finishAll(),await this.conversationProgress.end(this.conversation,this.turn,e)}async cancelProgress(){await this.turnContext.steps.finishAll("cancelled"),await this.conversationProgress.cancel(this.conversation,this.turn)}};d();d();var jgt=Be(ul()),Ggt=Be(wA());var Hf=class{constructor(e,r,n){this.ctx=e;this.skillId=r;this.requestType=new jgt.ProtocolRequestType("conversation/context");this.typeCheck=ta.Compile(n)}static{s(this,"AgentSkillResolver")}async resolveSkill(e){let r=this.ctx.get(Nr).connection,n={conversationId:e.conversation.id,turnId:e.turn.id,skillId:this.skillId},i;try{let o=await r.sendRequest(this.requestType,n),[a,c]=o;if(c){let l=new Ggt.ResponseError(c.code,c.message,c.data);_r.error(this.ctx,`ResponseError while resolving skill ${this.skillId}`,l);return}i=a}catch(o){_r.error(this.ctx,`Error while resolving skill ${this.skillId}`,o);return}if(i!=null){if(!this.typeCheck.Check(i))throw new ud(this.typeCheck.Errors(i));return i}}};var qke=class{constructor(e,r,n="",i="",o=[],a=[]){this.progressToken=e;this.chunks=r;this.followUp=n;this.suggestedTitle=i;this.skills=o;this.references=a}static{s(this,"SyntheticTurn")}},FE=class{constructor(){this.turns=[]}static{s(this,"SyntheticTurns")}add(e,r,n="",i="",o=[],a=[]){let c=new qke(e,r,n,i,o,a);return this.turns.push(c),c}get(e){return this.turns.find(r=>r.progressToken===e)}},Cce=class{constructor(e,r){this.turnContext=e;this.syntheticTurn=r;this.conversationProgress=e.ctx.get(Ns)}static{s(this,"SyntheticTurnProcessor")}async process(e,r){try{await this.processWithSyntheticTurns(this.syntheticTurn,e,r)}catch(n){_r.error(this.turnContext.ctx,`Error processing turn ${this.turnContext.turn.id}`,n);let i=n.message;this.turnContext.turn.status="error",this.turnContext.turn.response={message:i,type:"meta"},await this.conversationProgress.end(this.turnContext.conversation,this.turnContext.turn,{error:{message:i,responseIsIncomplete:!0}})}}async processWithSyntheticTurns(e,r,n){await this.conversationProgress.begin(this.turnContext.conversation,this.turnContext.turn,r),await this.resolveSyntheticSkill(e,n),await this.processSyntheticChunks(e,n),await this.endSyntheticProgress(e,n),this.turnContext.turn.response={type:"model",message:e.chunks.join("")},this.turnContext.turn.status=n.isCancellationRequested?"cancelled":"success"}async resolveSyntheticSkill(e,r){let n=this.turnContext.ctx.get(to).getCapabilities(this.turnContext.conversation.id),i=e.skills.filter(o=>n.skills.includes(o));for(let o of i){let c=await new Hf(this.turnContext.ctx,o,x.Object({value:x.String()})).resolveSkill(this.turnContext);c&&!r.isCancellationRequested&&await this.conversationProgress.report(this.turnContext.conversation,this.turnContext.turn,{reply:c.value})}}async processSyntheticChunks(e,r){for(let n of e.chunks)r.isCancellationRequested||(await this.conversationProgress.report(this.turnContext.conversation,this.turnContext.turn,{reply:n}),await WC(1))}async endSyntheticProgress(e,r){r.isCancellationRequested?await this.conversationProgress.cancel(this.turnContext.conversation,this.turnContext.turn):await this.conversationProgress.end(this.turnContext.conversation,this.turnContext.turn,{followUp:{message:e.followUp,type:"followup",id:br()},suggestedTitle:e.suggestedTitle,updatedDocuments:this.turnContext.conversation.source==="inline"?[{uri:"fakeUpdatedDoc.ts",text:"fake"}]:void 0})}};var OE=class{static{s(this,"TurnProcessorFactory")}async createProcessor(e,r,n){let i=e.ctx.get(FE).get(r);if(i)return new Cce(e,i);let a=(await j1(e.ctx)).find(l=>l.slug===e.turn.agent?.agentSlug);if(a?.turnProcessor)return a.turnProcessor(e);let c;return e.conversation.source==="inline"?c=new Mae(e.ctx):c=new CM(e.ctx),n!==void 0&&(c.computeSuggestions=n),e.turn.chatMode==="Agent"?new Ace(e,c):new yce(e,c)}};d();var Vgt=Be(ul());var SM=class{static{s(this,"WorkspaceFoldersValidator")}static validate(e){if(!e)return;let r=new Set;for(let n of e){if(r.has(n.uri))throw new Vgt.ResponseError(tr.InvalidParams,`Duplicate workspace folder uri ${n.uri}`);r.add(n.uri)}}};d();function vce(t){if(t&&t.uri.length>0)return[{uri:t.uri,name:Pi(t.uri)}]}s(vce,"resolveAsWorkspaceFolders");d();d();var Cxr=Object.freeze(function(t,e){let r=setTimeout(t.bind(e),0);return{dispose(){clearTimeout(r)}}}),nf=class{constructor(e){this.tokens=[];this.handlers=[];this._isCancelled=!1;this.onCancellationRequested=s((e,r)=>this._isCancelled?Cxr(e,r):(this.handlers.push(e.bind(r)),{dispose:s(()=>{},"dispose")}),"onCancellationRequested");this.tokens=e,this._isCancelled=e.some(r=>r.isCancellationRequested),e.forEach(r=>{r.onCancellationRequested(n=>this.cancel(n))})}static{s(this,"MergedToken")}cancel(e){this._isCancelled||(this._isCancelled=!0,this.handlers.forEach(r=>r(e)))}get isCancellationRequested(){return this.tokens.some(e=>e.isCancellationRequested)}};var $f=class{constructor(){this.tokens=new Sr(250)}static{s(this,"ProgressTokens")}add(e,r){let n=new hn.CancellationTokenSource,i=new nf([r,n.token]);return this.tokens.set(e.toString(),n),i}cancel(e){let r=this.tokens.get(e.toString());r&&(r.cancel(),this.tokens.delete(e.toString()))}};var vxr=x.Object({conversationId:x.Optional(Oae),workDoneToken:x.Union([x.String(),x.Number()]),turns:x.Array(Igt,{minItems:1}),capabilities:x.Optional(x.Object({allSkills:x.Optional(x.Boolean()),skills:x.Optional(x.Array(x.String()))})),doc:x.Optional(Sp),textDocument:x.Optional(Sp),selection:x.Optional(Uc),visibleRanges:x.Optional(Gae),computeSuggestions:x.Optional(x.Boolean()),references:x.Optional(x.Array(xM)),source:x.Optional(pg),workspaceFolder:x.Optional(x.String()),workspaceFolders:x.Optional(x.Array(EM)),ignoredSkills:x.Optional(x.Array(x.String())),userLanguage:x.Optional(x.String()),model:x.Optional(x.String()),modelProviderName:x.Optional(x.String()),chatMode:x.Optional(Hae),needToolCallConfirmation:x.Optional(x.Boolean())});async function xxr(t,e,r){SM.validate(r.workspaceFolders);let n=await J1(t,r,e),i=t.get(to).create(r);await Exr(t,i,r,n);let o=i.turns[i.turns.length-1],a=bM(r),c=t.get($f).add(a.progressToken,e),l=new xS(t,i,o,c);return await(await t.get(OE).createProcessor(l,a.progressToken,r.computeSuggestions)).process(a,c,void 0,n,r.model,r.modelProviderName),[{conversationId:i.id,turnId:o.id,agentSlug:o.agent?.agentSlug,modelFamily:r.model,modelProviderName:r.modelProviderName},null]}s(xxr,"handleConversationCreateChecked");async function Exr(t,e,r,n){for(let i of r.turns){let o=Uae(i.request),a=new mS({message:o,type:"user"},i.turnId);i.response&&(a.response={message:i.response,type:"model"}),i.agentSlug&&(a.agent={agentSlug:i.agentSlug}),a.chatMode=Tse(r.chatMode),a.userRequestedModel=i.model??r.model,a.needToolCallConfirmation=r.needToolCallConfirmation;let c=r.workspaceFolder?{uri:r.workspaceFolder}:void 0,l=r.workspaceFolders&&r.workspaceFolders.length>0?r.workspaceFolders:vce(c),u=Vae({textDocument:n,selection:r.selection,visibleRanges:r.visibleRanges});await t.get(to).addTurn(e.id,a,r.references,u,c,l,r.ignoredSkills,void 0)}}s(Exr,"addTurns");var zgt=Ze(vxr,xxr);d();var bxr=x.Object({conversationId:x.String()});function Ixr(t,e,r){return t.get(to).destroy(r.conversationId),["OK",null]}s(Ixr,"handleConversationDestroyChecked");var Kgt=Ze(bxr,Ixr);d();var Txr=x.Object({turnId:x.String(),acceptedFileCount:x.Number({minimum:0}),totalFileCount:x.Number({minimum:1})}),wxr=new dt("conversationNotifyCodeAcceptance");async function Sxr(t,e,r){let n=t.get(to).findByTurnId(r.turnId);if(!n)return wxr.warn(t,`Turn with id ${r.turnId} not found`),["OK",null];let i=await Za(t,n,{languageId:""});return Pf(t,void 0,{mode:n?.turn.getChatModeWithDefault()?.toLowerCase()??"unknown",modelId:n?.turn.getResolvedModelId()??"unknown"},{acceptedFileCount:r.acceptedFileCount,totalFileCount:r.totalFileCount},`${uu("agentPanel")}.codeAcceptance`,i),["OK",null]}s(Sxr,"handleConversationNotifyCodeAcceptanceChecked");var Ygt=Ze(Txr,Sxr);d();var _xr=x.Object({});function Rxr(t,e,r){return[{path:t.get(yi).directory},null]}s(Rxr,"handleConversationPersistenceChecked");var Jgt=Ze(_xr,Rxr);d();d();var Hke=class{static{s(this,"TokenPreconditionCheck")}async check(e){let r=await e.get(Bi).getSession(),n=e.get(iu);return r&&r.githubAppId&&r.githubAppId!==w0?{type:"token",status:"ok"}:{type:"token",status:"failed",githubAppId:n.githubAppId}}},$ke=class{static{s(this,"ChatEnabledPreconditionCheck")}async check(e){return{type:"chat_enabled",status:(await e.get(ar).getToken()).envelope.chat_enabled?"ok":"failed"}}},kxr=[new Hke,new $ke],mg=class{constructor(e,r=kxr){this.ctx=e;this.checks=r;this.emitter=new ys;this.onChange=this.emitter.event;_a(e,async()=>{await this.check()})}static{s(this,"PreconditionsCheck")}check(e){return e&&(this.result=void 0),this.result===void 0&&(this.result=this.requestChecks()),this.result}async requestChecks(){let e=[];this.checks.length>0&&(e=await Promise.all(this.checks.map(i=>i.check(this.ctx))));let r=e.every(i=>i.status==="ok")?"ok":"failed",n={results:e,status:r};return this.emitter.fire(n),n}};var Pxr=x.Object({forceCheck:x.Optional(x.Boolean())});async function Dxr(t,e,r){let n=r.forceCheck??!1;return[await t.get(mg).check(n),null]}s(Dxr,"handleConversationPreconditionsChecked");var Xgt=Ze(Pxr,Dxr);d();var Bxr=x.Object({turnId:x.String(),rating:x.Number(),doc:x.Optional(Sp),textDocument:x.Optional(Sp),source:x.Optional(pg)});async function Nxr(t,e,r){let n=await J1(t,r,e),i=HT(r.source),o="unrated";r.rating>0?o="positive":r.rating<0&&(o="negative");let a=await Za(t,t.get(to).findByTurnId(r.turnId),{languageId:n?.detectedLanguageId??""});return Pf(t,n,{rating:o,uiKind:i},{},`${uu(i)}.messageRating`,a),["OK",null]}s(Nxr,"handleConversationRatingChecked");var Zgt=Ze(Bxr,Nxr);d();d();var xce=class extends sS{static{s(this,"ClientLanguageModelTool")}constructor(e){super({...e,toolProvider:M1,type:"client"}),this.confirmationMessages=e.confirmationMessages}prepareInvocation(e,r){return{progressMessage:`Running ${this.name} tool`,confirmationMessages:this.confirmationMessages}}async invoke(e,r,n){let i={name:this.name,input:r.input,conversationId:e.conversation.id,turnId:e.turn.id,roundId:r.roundId,toolCallId:r.toolCallId};try{return await e.ctx.get(Nw).invokeClientTool(e,i)}catch(o){throw new Error(`Failed to invoke client tool ${this.name}: ${String(o)}`)}}async invokeConfirmation(e,r,n){if(n.isCancellationRequested)throw new ic;let i={name:this.name,title:r.title,message:r.message,input:r.input,conversationId:e.conversation.id,turnId:e.turn.id,roundId:r.roundId,toolCallId:r.toolCallId,annotations:r.annotations};try{return await e.ctx.get(x1).invokeClientToolConfirmation(e,i)}catch(o){throw new Error(`Failed to invoke client tool confirmation ${this.name}: ${String(o)}`)}}};var Mxr=x.Object({tools:x.Array(Tgt)});function Lxr(t,e,r){let n=t.get(bu);return r.tools.forEach(o=>{n.registerTool(new xce({name:o.name,description:o.description,inputSchema:o.inputSchema,confirmationMessages:o.confirmationMessages}))}),[n.getToolsForModel().filter(o=>o.type!=="mcp"),null]}s(Lxr,"conversationRegisterToolsChecked");var eAt=Ze(Mxr,Lxr);d();var Fxr=x.Object({workspaceFolders:x.Optional(x.Array(EM))});async function Oxr(t,e,r){let n=zRe(t).map(o=>({id:o.id,description:o.description,shortDescription:o.shortDescription,scopes:o.scopes})),i=t.get(ZA);if(r.workspaceFolders&&r.workspaceFolders.length>0){let a=(await i.collectPromptFiles(t,r.workspaceFolders)).filter(c=>!n.some(l=>l.id===c.name)).map(c=>({id:c.name,description:c.description||"",shortDescription:"",scopes:["chat-panel","agent-panel"]}));n.push(...a)}return[n,null]}s(Oxr,"handleConversationTemplatesChecked");var tAt=Ze(Fxr,Oxr);d();var Qxr=x.Object({workDoneToken:x.Union([x.String(),x.Number()]),conversationId:Oae,turnId:x.Optional(DP),message:Pke,followUp:x.Optional(x.Object({id:x.String(),type:x.String()})),doc:x.Optional(Sp),textDocument:x.Optional(Sp),selection:x.Optional(Uc),visibleRanges:x.Optional(Gae),computeSuggestions:x.Optional(x.Boolean()),references:x.Optional(x.Array(xM)),workspaceFolder:x.Optional(x.String()),workspaceFolders:x.Optional(x.Array(EM)),ignoredSkills:x.Optional(x.Array(x.String())),confirmationResponse:_ut,model:x.Optional(x.String()),modelProviderName:x.Optional(x.String()),chatMode:x.Optional(Hae),needToolCallConfirmation:x.Optional(x.Boolean()),agentSlug:x.Optional(x.String())});async function Uxr(t,e,r){SM.validate(r.workspaceFolders);let n=await J1(t,r,e),i=t.get(to),o=i.get(r.conversationId),a=Uae(r.message),c=new mS({message:a,type:"user"},r.turnId);c.chatMode=Tse(r.chatMode),c.userRequestedModel=r.model,c.needToolCallConfirmation=r.needToolCallConfirmation,r.agentSlug&&(c.agent={agentSlug:r.agentSlug});let l=r.workspaceFolder?{uri:r.workspaceFolder}:void 0,u=r.workspaceFolders&&r.workspaceFolders.length>0?r.workspaceFolders:vce(l),f=Vae({textDocument:n,selection:r.selection,visibleRanges:r.visibleRanges});c=await i.addTurn(o.id,c,r.references,f,l,u,r.ignoredSkills,r.confirmationResponse);let p=bM(r),m=t.get($f).add(p.progressToken,e),h=new xS(t,o,c,m);return await(await t.get(OE).createProcessor(h,p.progressToken,r.computeSuggestions)).process(p,m,r.followUp,n,r.model,r.modelProviderName),[{conversationId:o.id,turnId:c.id,agentSlug:c.agent?.agentSlug,modelFamily:r.model,modelProviderName:r.modelProviderName},null]}s(Uxr,"handleConversationTurnChecked");var rAt=Ze(Qxr,Uxr);d();var qxr=x.Object({conversationId:x.String(),turnId:x.String(),source:x.Optional(pg)});async function Hxr(t,e,r){t.get(to).deleteTurn(r.conversationId,r.turnId);let i=HT(r.source),o=await Za(t,t.get(to).findByTurnId(r.turnId),{languageId:""});return Pf(t,void 0,{messageId:r.turnId,uiKind:i,conversationId:r.conversationId},{},`${uu(i)}.messageDelete`,o),["OK",null]}s(Hxr,"handleConversationTurnDeleteChecked");var nAt=Ze(qxr,Hxr);d();var $xr=x.Object({toolIds:x.Array(x.String())});function Wxr(t,e,r){let n=t.get(bu);return r.toolIds.forEach(o=>{n.unregisterTool(o)}),[n.getToolsForModel().filter(o=>o.type!=="mcp"),null]}s(Wxr,"conversationUnregisterToolsChecked");var iAt=Ze($xr,Wxr);d();var jxr=x.Object({document:x.Object({uri:x.String(),text:x.String(),languageId:x.String(),version:x.Number()}),selection:x.Object({start:x.Object({line:x.Number(),character:x.Number()}),end:x.Object({line:x.Number(),character:x.Number()})})});function Gxr(){return["You are a world-class software engineer and the author and maintainer of the discussed code. Your feedback prefectly combines detailed feedback and explanation of context.",'When asked for your name, you must respond with "GitHub Copilot".',"Follow the user's requirements carefully & to the letter.","Follow Microsoft content policies.","Avoid content that violates copyrights.",`If you are asked to generate content that is harmful, hateful, racist, sexist, lewd, violent, or completely irrelevant to software engineering, only respond with "Sorry, I can't assist with that."`,"Keep your answers short and impersonal.","Use Markdown formatting in your answers.","Make sure to include the programming language name at the start of the Markdown code blocks.","Avoid wrapping the whole response in triple backticks.","The user works in an IDE called Visual Studio Code which has a concept for editors with open files, integrated unit test support, an output pane that shows the output of running the code as well as an integrated terminal.","The active document is the source code the user is looking at right now.","You can only give one reply for each conversation turn.","","Additional Rules","Think step by step:","1. Examine the provided code and any other context like user question, related errors, project details, class definitions, etc.","2. Provide feedback on the current selection on where it can be improved or introduces a problem.","2a. Avoid commenting on correct code.","2b. Avoid commenting on commented out code.","2c. Keep scoping rules in mind.","3. Reply with an enumerated list of feedback with source line number, filepath, kind (bug, performance, consistency, documentation, naming, readability, style, other), severity (low, medium, high), and feedback text.","3a. E.g.: 1. Line 357 in src/flow.js, bug, high severity: `i` is not incremented.","3b. E.g.: 2. Line 361 in src/arrays.js, documentation, low severity: Function `binarySearch` is not documented.","3c. E.g.: 3. Line 176 in src/vs/platform/actionWidget/browser/actionWidget.ts, consistency, medium severity: The color id `'background.actionBar'` is not consistent with the other color ids used. Use `'actionBar.background'` instead.","3d. E.g.: 4. Line 410 in src/search.js, documentation, medium severity: Returning `-1` when the target is not found is a common convention, but it should be documented.","3e. E.g.: 5. Line 51 in src/account.py, bug, high severity: The deposit method is not thread-safe. You should use a lock to ensure that the balance update is an atomic operation.","3f. E.g.: 6. Line 220 in src/account.py, readability, low severity: The withdraw method is very long and combines multipe logical steps, consider splitting it into multiple methods.","4. Try to sort the feedback by file and line number.",'5. When there is no feedback to provide, reply with "No feedback to provide."',"","Focus on being clear, helpful, and thorough.","Use developer-friendly terms and analogies in your explanations.","Provide clear and relevant examples when helpful."].join(`
`)}s(Gxr,"buildSystemMessage");function Vxr(t){let r=t.document.text.split(`
`).slice(t.selection.start.line,t.selection.end.line+1),n=t.selection.start.line+1,i=t.selection.end.line+1,o=r.map((a,c)=>{let l=t.selection.start.line+c+1;return`/* ${l>n&&l<i?"Selected ":""}Line ${l} */${a}`}).join(`
`);return["<currentChange>","Current selection with the selected lines labeled as such:","",`From the file: ${t.document.uri}`,`\`\`\`${t.document.languageId}/${t.document.uri}: FROM_LINE: ${n} - TO_LINE: ${i}`,o,"```","","</currentChange>"].join(`
`)}s(Vxr,"buildUserMessage");function zxr(t,e){let r=[],n=t.text.split(`
`),i=/(\d+)\.\s*Line\s*(\d+)\s*in\s*([^,]+),\s*(\w+),\s*(\w+)\s*severity:\s*((?:[^`.\n]|`[^`]*`|\.(?=\s*[A-Z]))+)(?:\.|$)/gm,o;for(;(o=i.exec(e))!==null;){let[a,c,l,u,f,p,m]=o;if(!["bug","performance","consistency","documentation","naming","readability","style","other"].includes(f.toLowerCase()))continue;let h=parseInt(l)-1;if(h<0||h>=n.length)continue;let g=n[h],A=Math.max(g.search(/\S/),0),y=g.trimEnd().length,E={uri:t.uri,range:{start:{line:h,character:A},end:{line:h,character:y}},message:m.trim(),kind:f.toLowerCase(),severity:p.toLowerCase()};r.push(E)}return r}s(zxr,"parseReviewComments");async function Kxr(t,e,r){if(!r.document.text)return[null,{code:tr.InvalidRequest,message:"Document text is required"}];if(!r.document.uri)return[null,{code:tr.InvalidRequest,message:"Document URI is required"}];if(!r.document.languageId)return[null,{code:tr.InvalidRequest,message:"Document language ID is required"}];let n=r.document.text.split(`
`);if(r.selection.start.line<0||r.selection.end.line>=n.length)return[null,{code:tr.InvalidRequest,message:"Invalid selection range"}];if(r.selection.start.line>r.selection.end.line)return[null,{code:tr.InvalidRequest,message:"Selection start line must be before end line"}];let i=t.get(Ps),o=await Wo.getModelConfiguration(t,"codeReview"),a=[{role:"system",content:Gxr()},{role:"user",content:Vxr(r)}],c=await t.get(ar).getToken(),l=await t.get(Mt).updateExPValuesAndAssignments(c),u=await i.fetchResponse({modelConfiguration:o,messages:a,uiKind:"conversationPanel",intentParams:{intent:!0},llmInteraction:Gd.user("code-review",br())},e,l);if(u.type!=="success")return[null,{code:tr.InternalError,message:"Failed to generate code review"}];let f=zxr(r.document,u.value);return f.sort((p,m)=>p.range.start.line-m.range.start.line),[{comments:f},null]}s(Kxr,"handleCopilotCodeReviewChecked");var oAt=Ze(jxr,Kxr);d();d();var Xq=class t{constructor(e){this.ctx=e;this.name="ReviewChangesProvider"}static{s(this,"ReviewChangesProvider")}static{this.DEFAULT_TIMEOUT=120*1e3}async fetchCodeReview(e,r){let n=await this.ctx.get(ar).getToken(),i=qm(this.ctx,n,"api","agents/github-code-review"),a=dh(this.ctx)["Copilot-Integration-Id"];return Cx(this.ctx,i,n.token,void 0,ty(),e,r,{"X-Copilot-Code-Review-Mode":"ide","Copilot-Integration-Id":a},t.DEFAULT_TIMEOUT)}static changesToReference(e){return{type:"github.pull_request",id:"1",data:{type:"pull-request",headFileContents:e.map(r=>({path:r.path,content:r.headContent})),baseFileContents:e.map(r=>({path:r.path,content:r.baseContent}))}}}static createReviewRequest(e){return{messages:[{role:"user",copilot_references:[t.changesToReference(e)]}]}}};d();d();var Ece=/```suggestion(\u0020*(\r\n|\n))((?<suggestion>[\s\S]*?)(\r\n|\n))?```/g;var bce=class t{static{s(this,"ReviewChangesResponseParser")}static findFirstNonWhitespaceCharacterIndex(e){let r=e.match(/\S/);return r?r.index:e.length}static removeSuggestion(e){return e.replaceAll(Ece,"")}static extractSuggestionAndText(e){Ece.lastIndex=0;let n=Ece.exec(e)?.groups?.suggestion||null,i=t.removeSuggestion(e);return{suggestion:n,textWithoutSuggestion:i}}static ghCommentToReviewComment(e,r){let n=r.headContent.split(`
`)[e.data.line-1],i=n.trimEnd().length,o={start:{line:e.data.start_line?e.data.start_line-1:e.data.line-1,character:t.findFirstNonWhitespaceCharacterIndex(n)},end:{line:e.data.line-1,character:i}},a=e.data.body,{suggestion:c,textWithoutSuggestion:l}=t.extractSuggestionAndText(a);return{uri:r.uri,range:o,message:l,kind:e.data.problem_type,severity:"medium",suggestion:c}}static parseLine(e){if(e==="data: [DONE]")return[];if(e==="")return[];let r=JSON.parse(e.replace("data: ",""));return Array.isArray(r.copilot_references)&&r.copilot_references.length>0?r.copilot_references.filter(n=>n.type):[]}static parseReviewResponse(e,r){let n=e.split(`
`),i=[];for(let o of n){let a=t.parseLine(o);for(let c of a.filter(l=>l.type==="github.generated-pull-request-comment")){if(c.data.side!=="RIGHT")continue;let l=r.find(f=>f.path===c.data.path);if(!l)continue;let u=t.ghCommentToReviewComment(c,l);i.push(u)}}return i}};var Yxr=x.Object({uri:x.String(),path:x.String(),baseContent:x.String(),headContent:x.String()}),Jxr=x.Object({changes:x.Array(Yxr)}),Zq;async function Xxr(t,e,r){Zq&&(Zq.cancel(),Zq.dispose()),Zq=new hn.CancellationTokenSource;let n=new nf([e,Zq.token]),i=new Xq(t);if(!(await t.get(ar).getToken()).isCopilotCodeReviewEnabled)return[null,{code:tr.InternalError,message:"GitHub Copilot Code Review is not enabled."}];let a=Xq.createReviewRequest(r.changes),c=await i.fetchCodeReview(a,n);if(!c.ok)return c.status===402?[null,{code:c.status,message:"You have reached your GitHub Copilot Code Review quota limit."}]:[null,{code:tr.InternalError,message:"Failed to generate code review."}];let l=await c.text();return[{comments:bce.parseReviewResponse(l,r.changes)},null]}s(Xxr,"handleCopilotCodeReviewReviewChangesChecked");var sAt=Ze(Jxr,Xxr);d();d();var wS=class{constructor(e,r,n,i,o,a){this.ctx=e;this.editConversation=r;this.currentTurn=n;this.partialResultToken=i;this.userSelectedModel=o;this.userSelectedModelProviderName=a;this.workingSetUriToPathMap=new Map;for(let c of n.workingSet)this.workingSetUriToPathMap.set(c.uri,fE.uriToPath(c.uri))}static{s(this,"EditTurnContext")}get editTurnId(){return this.currentTurn.id}get editConversationId(){return this.editConversation.id}mapToUriInWorkingSet(e){for(let[r,n]of this.workingSetUriToPathMap)if(n===e)return r}toLlmInteraction(){return Gd.user("conversation-edits",this.editTurnId)}};d();async function Ice(t,e,r,n){let o=t.get(Cl).create("panel","en"),a=new qw({message:"",type:"user"},[]),c="file:///path/to/HelloWorld.java",l=new wS(t,o,a,n,$r.Gpt4o),u=t.get(cd);await u.reportTurn(l,{editConversationId:e,editTurnId:r,fileGenerationStatus:"edit-plan-generated",editDescription:`### [HelloWorld.java](${c})

Complete the \`main\` method to print "Hello, World!" to the console.`,uri:c}),await u.reportTurn(l,{editConversationId:e,editTurnId:r,fileGenerationStatus:"updated-code-generated",uri:c,partialText:`public class HelloWorld {
    public static void main(String[] args) {
        System.out.println("Hello, World!");
    }
}`,languageId:"java",markdownCodeFence:"```"});let f="file:///path/to/HelloWorld.py";await u.reportTurn(l,{editConversationId:e,editTurnId:r,fileGenerationStatus:"edit-plan-generated",editDescription:`### [HelloWorld.py](${f})

Complete the \`main\` method to print "Hello, World!" to the console.`,uri:f}),await u.reportTurn(l,{editConversationId:e,editTurnId:r,fileGenerationStatus:"updated-code-generating",uri:f,partialText:`def main():
`,languageId:"python",markdownCodeFence:"```"}),await u.reportTurn(l,{editConversationId:e,editTurnId:r,fileGenerationStatus:"updated-code-generating",uri:f,partialText:`    println("Hello, World!")
`,languageId:"python",markdownCodeFence:"```"}),await u.reportTurn(l,{editConversationId:e,editTurnId:r,fileGenerationStatus:"updated-code-generated",uri:f,partialText:"",languageId:"python",markdownCodeFence:"```"})}s(Ice,"streamMockedResult");d();var Zxr=x.Object({enableMock:x.Boolean()}),X1=class{constructor(){this.enableMock=!1}static{s(this,"CopilotEditsMockManager")}isMockEnabled(){return this.enableMock}setMockEnabled(e){this.enableMock=e}};function eEr(t,e,r){return t.get(X1).setMockEnabled(r.enableMock),["OK",null]}s(eEr,"handleTestingSetCopilotEditsResponseChecked");var aAt=Ze(Zxr,eEr);var tEr=x.Object({request:x.String(),response:x.Optional(x.String())}),rEr=x.Union([x.Literal("panel")]),nEr=x.Object({partialResultToken:x.Union([x.String(),x.Number()]),turns:x.Array(tEr,{minItems:1}),workingSet:x.Optional(x.Array(jq)),source:x.Optional(rEr),workspaceFolder:x.Optional(x.String()),userLanguage:x.Optional(x.String()),model:x.Optional(x.String()),modelProviderName:x.Optional(x.String())});function iEr(t,e){let r=t.create(e.source,e.userLanguage);for(let n of e.turns){let i=new qw({message:n.request,type:"user"},e.workingSet);n.response&&(i.response={message:n.response,type:"model"}),e.workspaceFolder&&(i.workspaceFolder=e.workspaceFolder),t.addTurn(r.id,i)}return r}s(iEr,"buildEditConversation");async function oEr(t,e,r){if(t.get(X1).isMockEnabled())return await Ice(t,br(),br(),r.partialResultToken),[[],null];let n=iEr(t.get(Cl),r),i=n.getLastTurn(),o=new wS(t,n,i,r.partialResultToken,r.model,r.modelProviderName),a=t.get($f).add(r.partialResultToken,e);return[await t.get(pE).createOrContinueEditConversation(o,a),null]}s(oEr,"handleEditConversationCreateChecked");var cAt=Ze(nEr,oEr);d();var sEr=x.Object({editConversationId:x.String()});function aEr(t,e,r){return t.get(Cl).destroy(r.editConversationId),["OK",null]}s(aEr,"handleEditConversationDestroyChecked");var lAt=Ze(sEr,aEr);d();var cEr=x.Object({partialResultToken:x.Union([x.String(),x.Number()]),editConversationId:x.String(),message:x.String(),workingSet:x.Optional(x.Array(jq)),workspaceFolder:x.Optional(x.String()),userLanguage:x.Optional(x.String()),model:x.Optional(x.String())});function lEr(t,e,r){let n=t.get(e),i=new qw({message:r.message,type:"user"},r.workingSet);return r.workspaceFolder&&(i.workspaceFolder=r.workspaceFolder),t.addTurn(n.id,i),n}s(lEr,"buildEditConversation");async function uEr(t,e,r){if(t.get(X1).isMockEnabled())return await Ice(t,r.editConversationId,br(),r.partialResultToken),[[],null];let n=t.get(Cl),i=lEr(n,r.editConversationId,r),o=i.getLastTurn(),a=new wS(t,i,o,r.partialResultToken,r.model),c=t.get($f).add(r.partialResultToken,e);return[await t.get(pE).createOrContinueEditConversation(a,c),null]}s(uEr,"handleEditConversationTurnChecked");var uAt=Ze(cEr,uEr);d();var dEr=x.Object({editConversationId:x.String(),editTurnId:x.String(),source:x.Optional(pg)});async function fEr(t,e,r){t.get(Cl).deleteTurn(r.editConversationId,r.editTurnId);let i=await qR(t,r.editTurnId,r.editConversationId,{languageId:""});return Pf(t,void 0,{messageId:r.editTurnId,uiKind:"editsPanel",conversationId:r.editConversationId},{},`${uu("editsPanel")}.copilotEditsMessageDelete`,i),["OK",null]}s(fEr,"handleEditConversationTurnDeleteChecked");var dAt=Ze(dEr,fEr);d();var pEr=x.Object({}),mEr=x.Object({servers:x.Array(x.Object({name:x.String(),tools:x.Array(x.Object({name:x.String(),status:x.Enum(_U)}))}))});function hEr(t,e,r){return[t.get(ng).getAllTools(),null]}s(hEr,"handleGetMCPToolsChecked");function gEr(t,e,r){for(let{name:i,tools:o}of r.servers)for(let{name:a,status:c}of o)t.get(ng).updateMCPToolStatus(i,a,c);return[t.get(ng).getAllTools(),null]}s(gEr,"handleUpdateMCPToolsStatusChecked");var fAt=Ze(pEr,hEr),pAt=Ze(mEr,gEr);d();var AEr=x.Object({});async function yEr(t,e,r){let n=await t.get(ar).getToken();return[CEr(await t.get(If).getMetadata(),n),null]}s(yEr,"handleCopilotModelsChecked");function CEr(t,e){let r=e.getTokenValue("editor_preview_features")=="0",n=ph.filterModelsWithEditorPreviewFeatures(t,r),i=[];return n.forEach(o=>{if(o.model_picker_enabled===!0){let a=[];o.capabilities.type==="chat"?(a.push("chat-panel"),a.push("edit-panel"),a.push("inline"),!pWe.has(o.capabilities.family)&&o.capabilities.supports?.tool_calls&&(o.capabilities.limits?.max_prompt_tokens??!1)&&a.push("agent-panel"),i.push({modelFamily:o.capabilities.family,modelName:o.name,modelPolicy:o.policy,scopes:a,id:o.id,preview:o.preview??!1,isChatDefault:o.is_chat_default??!1,isChatFallback:o.is_chat_fallback??!1,capabilities:{supports:{vision:o.capabilities.supports?.vision??!1}},billing:o.billing?{isPremium:o.billing?.is_premium??!0,multiplier:o.billing?.multiplier??0}:void 0})):o.capabilities.type==="completion"?i.push({modelFamily:o.capabilities.family,modelName:o.name,modelPolicy:o.policy,scopes:["completion"],id:o.id,preview:o.preview??!1,isChatDefault:o.is_chat_default??!1,isChatFallback:o.is_chat_fallback??!1,capabilities:{supports:{vision:o.capabilities.supports?.vision??!1}},billing:o.billing?{isPremium:o.billing?.is_premium??!0,multiplier:o.billing?.multiplier??0}:void 0}):i.push({modelFamily:o.capabilities.family,modelName:o.name,modelPolicy:o.policy,scopes:a,id:o.id,preview:o.preview??!1,isChatDefault:o.is_chat_default??!1,isChatFallback:o.is_chat_fallback??!1,capabilities:{supports:{vision:o.capabilities.supports?.vision??!1}},billing:o.billing?{isPremium:o.billing?.is_premium??!0,multiplier:o.billing?.multiplier??0}:void 0})}}),i}s(CEr,"filterModels");var mAt=Ze(AEr,yEr);d();var vEr=x.Object({model:x.Optional(x.String()),status:x.Optional(x.String())});async function xEr(t,e,r){return r.model&&r.status==="enabled"?await t.get(If).acceptModelPolicy(r.model)?["OK",null]:[null,{code:tr.InternalError,message:"Failed to accept model policy"}]:[null,{code:tr.InvalidRequest,message:"Invalid model or status"}]}s(xEr,"handleCopilotModelsPolicyChecked");var hAt=Ze(vEr,xEr);d();d();d();d();function EEr(t,e){let r=e,n=t.lineAt(e.line);return n.isEmptyOrWhitespace||(r=n.range.end),r}s(EEr,"panelPositionForDocument");async function*gAt(t){for await(let e of t){let r={...e};r.completionText=r.completionText.trimEnd(),yield r}}s(gAt,"trimChoices");var _M=class{constructor(e,r,n,i){this.textDocument=e;this.startPosition=r;this.cancellationToken=n;this.solutionCountTarget=i;this.targetPosition=EEr(this.textDocument,this.startPosition)}static{s(this,"SolutionManager")}get savedTelemetryData(){return this._savedTelemetryData}set savedTelemetryData(e){this._savedTelemetryData=e}};async function Wke(t,e){let r=await t;switch(r.status){case"Solution":await e.onSolution(r.solution),await Wke(r.next,e);break;case"FinishedNormally":await e.onFinishedNormally();break;case"FinishedWithError":await e.onFinishedWithError(r.error);break}}s(Wke,"reportSolutions");async function jke(t,e){if(t.isCancellationRequested)return{status:"FinishedWithError",error:"Cancelled"};let r=await e.next();return r.done===!0?{status:"FinishedNormally"}:{status:"Solution",solution:r.value,next:jke(t,e)}}s(jke,"generateSolutionsStream");function Tce(t){return t.replace(/\s+/g,"")}s(Tce,"normalizeCompletionText");async function AAt(t,e,r,n,i,o){let a=e.targetPosition,c=e.textDocument,l=bT(t,c.uri),u=br(),f=Vr.createAndMarkAsIssued({headerRequestId:u,languageId:c.detectedLanguageId,source:r},{});e.savedTelemetryData=await t.get(Mt).fetchTokenAndUpdateExPValuesAndAssignments({uri:c.uri,languageId:c.detectedLanguageId},f),i&&(e.savedTelemetryData=e.savedTelemetryData.extendedBy({engineName:i})),o&&(e.savedTelemetryData=e.savedTelemetryData.extendedBy({comparisonRequestId:o}));let p=await $3(t,u,YC(c,a),e.savedTelemetryData);if(p.type==="copilotContentExclusion")return{status:"FinishedNormally"};if(p.type==="contextTooShort")return{status:"FinishedWithError",error:"Context too short"};if(p.type==="promptCancelled")return{status:"FinishedWithError",error:"Prompt cancelled"};if(p.type==="promptTimeout")return{status:"FinishedWithError",error:"Prompt timeout"};if(p.type==="promptError")return{status:"FinishedWithError",error:"Prompt error"};let m=p.prompt,h=p.trailingWs;return h.length>0&&(e.startPosition=Es.position(e.startPosition.line,e.startPosition.character-h.length)),e.savedTelemetryData=e.savedTelemetryData.extendedBy({},{...PD(m),solutionCount:e.solutionCountTarget,promptEndPos:c.offsetAt(a)}),n.debug(t,"prompt:",m),Bt(t,"solution.requested",e.savedTelemetryData),{prompt:m,trailingWs:h,telemetryData:e.savedTelemetryData,repoInfo:l,ourRequestId:u}}s(AAt,"setupPromptAndTelemetry");function yAt(t,e,r,n,i,o){let a=t.get(bA).forLanguage(t,e.detectedLanguageId,o),c=U0(e.detectedLanguageId),l=sZ(e,r),u={language:e.detectedLanguageId,next_indent:l.next??0,prompt_tokens:n.prefixTokens??0,suffix_tokens:n.suffixTokens??0},f={};a==="parsing"&&!c&&(f.stop=[`

`,`\r
\r
`]);let p=ET(t,o),m;switch(a){case"server":m=s(()=>{},"finishedCb"),u.force_indent=l.prev??-1,u.trim_by_indentation=!0;break;case"parsingandserver":m=c?C7(t,e,i.startPosition):()=>{},u.force_indent=l.prev??-1,u.trim_by_indentation=!0;break;case"parsing":default:m=c?C7(t,e,i.startPosition):()=>{};break}return{extra:u,postOptions:f,finishedCb:m,engineInfo:p}}s(yAt,"setupCompletionParams");var Gke=new dt("solutions");async function bEr(t,e){let r=e.targetPosition,n=e.textDocument,i=await AAt(t,e,"open copilot",Gke);if("status"in i)return i;let{prompt:o,trailingWs:a,telemetryData:c,repoInfo:l,ourRequestId:u}=i,{extra:f,postOptions:p,finishedCb:m,engineInfo:h}=yAt(t,n,r,o,e,c),g=e.cancellationToken,A={prompt:o,languageId:n.detectedLanguageId,repoInfo:l,ourRequestId:u,engineModelId:h.modelId,count:e.solutionCountTarget,uiKind:"synthesize",postOptions:p,headers:h.headers,extra:f},y=await t.get(Rp).fetchAndStreamCompletions(t,A,c.extendedBy(),m,g);if(y.type==="failed"||y.type==="canceled")return{status:"FinishedWithError",error:`${y.type}: ${y.reason}`};let E=y.choices;E=gAt(E),E=h7(E,R=>B7(t,n,r,R,!1,Gke));let b=h7(E,async R=>{let B=R.completionText;Gke.info(t,`Open Copilot completion: [${R.completionText}]`);let L=await _Je(t,n,r,R.completionText)??Es.position(r.line,0),[O]=YT(n.getText(Es.range(L,r)));B=O+B;let Y=R.completionText;a.length>0&&Y.startsWith(a)&&(Y=Y.substring(a.length));let V=R.meanLogProb,z=V!==void 0?Math.exp(V):0,Q=c.extendedBy({choiceIndex:R.choiceIndex.toString()});return{completionText:Y,insertText:B,range:Es.range(L,r),meanProb:z,meanLogProb:V||0,requestId:R.requestId,choiceIndex:R.choiceIndex,telemetryData:Q,copilotAnnotations:R.copilotAnnotations}});return jke(g,b[Symbol.asyncIterator]())}s(bEr,"launchSolutions");async function wce(t,e,r){return t.get(qo).withProgress(async()=>{let i=bEr(t,e);return await Wke(i,r)})}s(wce,"runSolutions");var vAt=Be(yI()),tH=Be(ul());d();d();function Sce(t,e){let r=t.split(`
`),n=e,i=e,o=r[e.line],a=o.indexOf("%");a!==-1&&(o=o.substring(0,a)+o.substring(a+1),n={line:e.line,character:a});let c=o.indexOf("^");if(c!==-1){let l=o.indexOf("^",c+1);if(l===-1)throw new Error("Challenge document must contain zero or two ^ characters.");o=o.substring(0,c)+o.substring(c+1,l)+o.substring(l+1),n={line:e.line,character:e.character},i={line:e.line,character:e.character+l-c-1}}return{cursorLine:o,lines:r,start:n,end:i}}s(Sce,"parseChallengeDoc");var IEr=x.Object({text:x.String(),score:x.Number()}),TEr=x.Object({documents:x.Array(IEr),options:x.Optional(x.Object({}))});async function _ce(t,e,r){let n=br();for(let i=0;i<e.length&&i<10;i++){let{text:o,score:a}=e[i],{cursorLine:c,lines:l,start:u}=Sce(o,t),f=[c.slice(Math.min(u.character,t.character))].concat(l.slice(t.line+1)).join(`
`);r.offset=l.slice(0,t.line).reduce((p,m)=>p+m.length+1,0)+u.character,await r.onSolution({requestId:{headerRequestId:n,serverExperiments:"",deploymentId:""},completionText:f,insertText:f,range:{start:t,end:t},meanProb:a,meanLogProb:-1,choiceIndex:i,telemetryData:gC.createEmptyConfigForTesting()})}await r.onFinishedNormally()}s(_ce,"runTestSolutions");var Ey=class{constructor(e){this.documents=e}static{s(this,"ExternalTestingPanelCompletionDocuments")}};function wEr(t,e,r){return t.forceSet(Ey,new Ey(r.documents)),["OK",null]}s(wEr,"handleTestingSetPanelCompletionDocumentsChecked");var CAt=Ze(TEr,wEr);var xAt=gX.type;function SEr(t,e,r,n,i){let o=Tce(n.completionText),a=(0,vAt.SHA256)(o).toString();return t.get(Gs).set(a,{displayText:n.completionText,insertText:n.insertText,offset:r,uuid:a,range:n.range,uri:e.textDocument.uri,telemetry:n.telemetryData.extendedBy({},{rank:i-1}),index:n.choiceIndex,position:e.position,resultType:0,triggerCategory:"solution",copilotAnnotations:n.copilotAnnotations,clientCompletionId:a}),{range:n.range,insertText:n.insertText,command:{command:N2e,title:`Accept completion ${i}`,arguments:[a]}}}s(SEr,"makeCompletion");function zke(t,e){return`${t}/${e}`}s(zke,"progressMessage");var Vke=class{constructor(e,r,n){this.ctx=e;this.params=r;this.onCompletion=n;this.offset=0;this.count=0;this.items=new Map}static{s(this,"SolutionHandler")}get service(){return this.ctx.get(Nr)}async onSolution(e){this.count+=1;let r=SEr(this.ctx,this.params,this.offset,e,this.items.size+1);this.items.has(r.command.arguments[0])||(this.items.set(r.command.arguments[0],r),await this.onCompletion(r)),this.params.workDoneToken!==void 0&&await this.service.connection.sendProgress(tH.WorkDoneProgress.type,this.params.workDoneToken,{kind:"report",message:zke(this.count,10),percentage:Math.round(100*this.count/10)})}onFinishedNormally(){return _Er(this.params.workDoneToken,this.service,this.count)}async onFinishedWithError(e){if(this.error=e,this.params.workDoneToken!==void 0)return this.service.connection.sendProgress(tH.WorkDoneProgress.type,this.params.workDoneToken,{kind:"end",message:`Error: ${e}`})}};async function _Er(t,e,r=0){t!==void 0&&await e.connection.sendProgress(tH.WorkDoneProgress.type,t,{kind:"end",message:zke(r,10)})}s(_Er,"reportDone");var eH;async function REr(t,e,r){let n=await xy(t,r.textDocument,e),i=r.position;r.workDoneToken!==void 0&&await t.get(Nr).connection.sendProgress(tH.WorkDoneProgress.type,r.workDoneToken,{kind:"begin",title:"GitHub Copilot Completions Panel",cancellable:!0,message:zke(0,10),percentage:0});let o=[],a=s(f=>(o.push(f),Promise.resolve()),"onCompletion"),c=r.partialResultToken;c!==void 0&&(a=s(async f=>{await t.get(Nr).connection.sendProgress(gX.partialResult,c,{items:[f]})},"onCompletion"));let l=new Vke(t,r,a),u=t.get(Ey);if(u.documents){let f=u.documents;await _ce(i,f,l)}else{l.offset=n.offsetAt(i);let f=new _M(n,i,e,10);await wce(t,f,l)}return l.error!==void 0?[null,{code:tr.InternalError,message:l.error}]:[{items:o},null]}s(REr,"handleChecked");async function kEr(t,e,r){eH&&(eH.cancel(),eH.dispose()),eH=new hn.CancellationTokenSource;let n=eH.token,i=new nf([e,n]);try{return await REr(t,i,r)}catch(o){if(n.isCancellationRequested&&!e.isCancellationRequested)return[null,{code:tr.ServerCancelled,message:"Request was superseded by a new request"}];throw o}}s(kEr,"handleCheckedWithAbort");var EAt=Ze(Kze,kEr);d();d();d();function DEr(t,e,r){let{apiUrl:n,serverUrl:i}=r||t.get(df).getConfiguredUrls(),o=new URL("login/device",i).href,a=new URL("_ping",e.proxy).href,c=new URL("_ping",e.api).href,l=new URL("_ping",e.telemetry).href;function u(f){return new URL(f).host}return s(u,"label"),[{label:u(o),url:o},{label:u(n),url:n,session:r},{label:u(a),url:a},{label:u(c),url:c,session:r},{label:u(l),url:l}]}s(DEr,"urlsToCheck");async function bAt(t,e,r=L4(t),n,i){let o=DEr(t,r,n).map(async({label:a,url:c,session:l})=>{let{message:u,status:f}=await BEr(e,c,l,i);return{label:a,url:c,message:u,status:f}});return await Promise.all(o)}s(bAt,"checkReachability");async function BEr(t,e,r,n){try{let i=new AbortController;n?.onCancellationRequested(()=>i.abort());let o=await t.fetch(e,{headers:r?{Authorization:`Bearer ${r.accessToken}`}:{},signal:i.signal}),a=o.status>=200&&o.status<400?"reachable":"unreachable";return{message:`HTTP ${o.status}`+(o.statusText?` - ${o.statusText}`:""),status:a}}catch(i){return{message:String(i),status:"unreachable"}}}s(BEr,"determineReachability");var ym=Be(require("os")),RM=Be(require("tls"));async function TAt(t,e){let r=await t.get(Or).getImplementation(),n=await t.get(ar).getGitHubSession(),i=await t.get(ar).getToken().catch(()=>{});return{sections:[MEr(t),NEr(t,n),LEr(t,r),await FEr(t,r,i?.endpoints,n,e)]}}s(TAt,"collectDiagnostics");function wAt(t){return t.sections.map(OEr).join(ym.EOL+ym.EOL)+ym.EOL}s(wAt,"formatDiagnosticsAsMarkdown");function NEr(t,e){let r=e&&new URL(e.serverUrl).host,n;return e?r==="github.com"?n=e.login:n=`${e.login} (${r})`:n="not signed in",{name:"Copilot",items:{Version:s2(t),"GitHub Account":n,"Session ID":t.get(Ms).sessionId,"Send Restricted Telemetry":DD(t)?"enabled":"disabled","Content Exclusion":t.get(dl).enabled?"enabled":"unavailable"}}}s(NEr,"collectCopilotSection");function MEr(t){let e={Plugin:UEr(t),Editor:QEr(t),"Operating System":`${ym.type()} ${ym.release()} (${ym.arch()})`};return Z1(e,"NODE_OPTIONS"),{name:"Environment",items:e}}s(MEr,"collectEnvironmentSection");function LEr(t,e){let r=t.get(Mc).getHttpSettings(),n={Proxy:r.proxy||void 0,"Proxy Authorization":r.proxyAuthorization?"present":void 0,"Proxy Kerberos SPN":r.proxyKerberosServicePrincipal,"Proxy Strict SSL":r.proxyStrictSSL===!1?"disabled":"enabled",Fetcher:e.name.replace(/Fetcher$/,""),"Number of Root Certificates":RM.rootCertificates.length,"TLS Default Min Version":RM.DEFAULT_MIN_VERSION,"TLS Default Max Version":RM.DEFAULT_MAX_VERSION};return Z1(n,"http_proxy"),Z1(n,"https_proxy"),Z1(n,"no_proxy"),Z1(n,"SSL_CERT_FILE"),Z1(n,"SSL_CERT_DIR"),Z1(n,"OPENSSL_CONF"),Z1(n,"NODE_EXTRA_CA_CERTS"),Z1(n,"NODE_TLS_REJECT_UNAUTHORIZED"),{name:"Network Configuration",items:n}}s(LEr,"collectNetworkConfigSection");async function FEr(t,e,r,n,i){return{name:"Reachability",items:Object.fromEntries((await bAt(t,e,r,n,i)).map(({label:a,message:c})=>[a,c]))}}s(FEr,"collectReachabilitySection");function IAt(t){return t.includes("`")?`\`\` ${t} \`\``:`\`${t}\``}s(IAt,"quoteCode");function Z1(t,e){let r=process.env[e];r&&(t[IAt(e)]=IAt(r)),r!==process.env[e.toUpperCase()]&&Z1(t,e.toUpperCase())}s(Z1,"addEnvironmentVariable");function OEr(t){return`## ${t.name}`+ym.EOL+ym.EOL+Object.keys(t.items).filter(e=>e!=="name").map(e=>`- ${e}: ${t.items[e]??"N/A"}`).join(ym.EOL)}s(OEr,"formatSectionAsMarkdown");function QEr(t){let e=t.get(cn).getEditorInfo();return`${e.readableName||e.name} ${e.version}`}s(QEr,"getEditorDisplayVersion");function UEr(t){let e=t.get(cn).getEditorPluginInfo();return`${e.readableName||e.name} ${e.version}`}s(UEr,"getPluginDisplayVersion");var qEr=x.Object({});async function HEr(t,e){return[{report:wAt(await TAt(t,e))},null]}s(HEr,"handleDiagnosticsChecked");var SAt=Ze(qEr,HEr);d();d();d();d();function _At(t,e,r){function n(o,a,c){let l=new RegExp(`^(${a})+`,"g");return o.split(`
`).map(u=>{let f=u.replace(l,""),p=u.length-f.length;return c(p)+f}).join(`
`)}s(n,"replace");let i;if(t.tabSize===void 0||typeof t.tabSize=="string"?i=4:i=t.tabSize,t.insertSpaces===!1){let o=s(a=>n(a," ",c=>"	".repeat(Math.floor(c/i))+" ".repeat(c%i)),"r");e.displayText=o(e.displayText),e.completionText=o(e.completionText)}else if(t.insertSpaces===!0){let o=s(a=>n(a,"	",c=>" ".repeat(c*i)),"r");if(e.displayText=o(e.displayText),e.completionText=o(e.completionText),r){let a=s(c=>{if(c==="")return c;let l=c.split(`
`)[0],u=l.length-l.trimStart().length,f=u%i;if(f!==0&&u>0){let p=" ".repeat(f);return n(c,p,m=>" ".repeat((Math.floor(m/i)+1)*i))}else return c},"re");e.displayText=a(e.displayText),e.completionText=a(e.completionText)}}return e}s(_At,"normalizeIndentCharacter");function RAt(t,e,r,n,i,o,a){let c=n.lineAt(i),l=e.map(u=>{let f=Es.range(Es.position(i.line,0),Es.position(i.line,i.character+u.suffixCoverage)),p="";if(o&&(u.completion=_At(o,u.completion,c.isEmptyOrWhitespace)),c.isEmptyOrWhitespace&&(u.completion.displayNeedsWsOffset||u.completion.completionText.startsWith(c.text)))p=u.completion.completionText;else{let h=Es.range(f.start,i);p=n.getText(h)+u.completion.displayText}return{uuid:br(),insertText:p,range:f,uri:n.uri,index:u.completion.completionIndex,telemetry:u.telemetry,displayText:u.completion.displayText,position:i,offset:n.offsetAt(i),resultType:r,copilotAnnotations:u.copilotAnnotations,clientCompletionId:u.clientCompletionId}});if(r===2&&a!==void 0){let u=l.find(f=>f.index===a);if(u){let f=l.filter(p=>p.index!==a);l=[u,...f]}}return l}s(RAt,"completionsFromGhostTextResults");async function Kke(t,e,r,n={}){let i=0;n.selectedCompletionInfo?.text&&!n.selectedCompletionInfo.text.includes(")")&&(e=e.addSelectedCompletionInfo(n.selectedCompletionInfo),i=e.position.character-n.selectedCompletionInfo.range.end.character);let o=await lEe(t,e,r,n);if(o.type!=="success")return o;let[a,c]=o.value;if(r?.isCancellationRequested)return{type:"canceled",reason:"after getGhostText",telemetryData:{telemetryBlob:o.telemetryBlob}};let l=kZe(t,e.textDocument,e.position,c),u=RAt(t,a,c,e.textDocument,e.position,n.formattingOptions,l);if(u.length===0)return{type:"empty",reason:"no completions in final result",telemetryData:o.telemetryData};if(c!==2){e=e.applyEdits([{newText:u[0].insertText,range:u[0].range}]);let p={isSpeculative:!0,opportunityId:n.opportunityId},m=s(()=>lEe(t,e,void 0,p),"fn");t.get(Dh).set(u[0].clientCompletionId,m)}let f=u.map(p=>{let{start:m,end:h}=p.range,g=hn.Range.create(m,hn.Position.create(h.line,h.character-i));return{...p,range:g}});return{...o,value:f}}s(Kke,"getInlineCompletionsResult");async function Rce(t,e,r,n,i={}){$Er(t,e,r);let o=await Kke(t,YC(e,r),n,i);return oJe(t,o)}s(Rce,"getInlineCompletions");function $Er(t,e,r){let n=e.getText({start:{line:Math.max(r.line-1,0),character:0},end:r}),i=e.getText({start:r,end:{line:Math.min(r.line+2,e.lineCount-1),character:e.lineCount-1>r.line?0:r.character}});jX.debug(t,`Requesting for ${e.uri} at ${r.line}:${r.character}`,`between ${JSON.stringify(n)} and ${JSON.stringify(i)}.`)}s($Er,"logCompletionLocation");var MAt=Be(ul());d();var kAt=require("crypto");var kM=class{static{s(this,"LspClientContextProvider")}constructor(e,r,n){this.id=r,this.selector=n,this.resolver=new Jke(e,this.id)}},Jke=class{constructor(e,r){this.ctx=e;this.id=r;this.contextItems=[];this.update=!1}static{s(this,"LspClientContextResolver")}async resolve(e,r){let n=[];if(this.contextItems.length>0)n=this.contextItems;else if(this.update){let i=this.ctx.get(Nr),o=(0,kAt.randomUUID)(),a=i.connection.onProgress(pX.type,o,c=>{n.push(...c)});r.onCancellationRequested(()=>{a?.dispose()});try{let c=await i.connection.sendRequest(pX.type,{providerId:this.id,data:this.data,textDocument:{uri:e.documentContext.uri,languageId:e.documentContext.languageId,version:e.documentContext.version},position:e.documentContext.position,partialResultToken:o},r);n.push(...c)}finally{a?.dispose()}}return this.reset(),Promise.resolve(n)}setContextItems(e){this.contextItems=e}clearContextItems(){this.contextItems=[]}setUpdate(e){this.update=e}clearData(){this.data=void 0}reset(){this.clearContextItems(),this.clearData(),this.setUpdate(!1)}};function PM(t,e,r){try{let n=t.get(Hc),i=new Map;n.providers.forEach(o=>{i.set(o.id,o)}),e.providers.forEach(o=>{let a=i.get(o.id);a&&a instanceof kM&&a.resolver.setContextItems(o.contextItems)}),e.updating&&e.updating.length>0&&e.updating.forEach(o=>{let a=i.get(o);a&&a instanceof kM&&(a.resolver.setUpdate(!0),a.resolver.data=r)})}catch(n){dn.error(t,"Failed to set context items on context providers",n)}}s(PM,"setContextItems");var Yke={nocase:!0,matchBase:!0,nonegate:!0,dot:!0};function PAt(t,e,r){return e.map(i=>{try{if(typeof i=="string")return qc(r.uri,i,Yke);if(typeof i=="object"){let o=!0;return"language"in i&&(o&&=r.languageId==(i.language||"")),"scheme"in i&&(o&&=qc(r.uri,i.scheme||"",Yke)),"pattern"in i&&(o&&=qc(r.uri,i.pattern||"",Yke)),o}}catch{return!1}return!1}).some(Boolean)?10:0}s(PAt,"match");d();var WEr=x.Object({documents:x.Array(x.String()),basename:x.Optional(x.String()),options:x.Optional(x.Object({}))}),_S=class{constructor(e,r){this.documents=e;this.basename=r}static{s(this,"ExternalTestingCompletionDocuments")}};function jEr(t,e,r){return t.forceSet(_S,new _S(r.documents,r.basename||"")),["OK",null]}s(jEr,"handleTestingSetCompletionDocumentsChecked");var DAt=new dt("setCompletionDocuments"),NAt=Ze(WEr,jEr);function kce(t,e,r,n){let i=t.get(_S);if(i.documents){let o=n?3:1;if(r&&i.basename&&i.basename.trim().length>0){DAt.debug(t,`Returning filtered completions by basename ${i.basename}`);let a=GEr(i,r);return a&&a.length>0?BAt(a,o,e):void 0}else return DAt.debug(t,"Returning completions for all pre-set documents"),BAt(i.documents,o,e)}}s(kce,"getTestCompletions");function BAt(t,e,r){return t.slice(0,e).map(n=>{let{cursorLine:i,lines:o,start:a,end:c}=Sce(n,r);return{insertText:[i.slice(Math.min(a.character,r.character))].concat(o.slice(r.line+1)).join(`
`),range:{start:a,end:c}}})}s(BAt,"sliceAndMapCompletions");function GEr(t,e){return t.basename===Pi(e)?t.documents||[]:[]}s(GEr,"getFilteredDocs");var LAt=x.Object({doc:x.Object({position:lu,insertSpaces:x.Optional(x.Boolean()),tabSize:x.Optional(x.Number()),uri:o7,version:x.Number()}),contextItems:x.Optional(uxe)}),rH;async function FAt(t,e,r,n){rH&&(rH.cancel(),rH.dispose()),rH=new hn.CancellationTokenSource;let i=new nf([e,rH.token]);r.contextItems&&PM(t,r.contextItems);let o=kce(t,r.doc.position,r.doc.uri,n);if(o)return[{completions:o.map(m=>({uuid:br(),text:m.insertText,displayText:m.insertText,position:r.doc.position,range:m.range,docVersion:r.doc.version}))},null];let a;try{a=await xy(t,r.doc,i)}catch(p){if(!(p instanceof MAt.ResponseError))throw p;switch(p.code){case tr.CopilotNotAvailable:case tr.ContentModified:return[{completions:[]},null]}throw p}let c=r.doc.position,l=await Rce(t,a,c,i,{isCycling:n,formattingOptions:r.doc});if(!l)return[{completions:[]},null];let u=t.get(Gs);for(let p of l)u.set(p.uuid,{...p,triggerCategory:"ghostText"});return[{completions:l.map(p=>({uuid:p.uuid,text:p.insertText,range:p.range,displayText:p.displayText,position:p.position,docVersion:a.version}))},null]}s(FAt,"handleGetCompletionsHelper");var OAt=Ze(LAt,(t,e,r)=>FAt(t,e,r,!1)),QAt=Ze(LAt,(t,e,r)=>FAt(t,e,r,!0));d();var UAt=Be(yI()),DM=Be(ul());var VEr=x.Object({doc:x.Object({position:lu,uri:o7,version:x.Number()}),panelId:x.String()});function zEr(t,e,r,n,i){let o=Tce(i.completionText),a=(0,UAt.SHA256)(o).toString();return t.get(Gs).set(a,{displayText:i.insertText,insertText:i.completionText,offset:n,uuid:a,range:r,uri:e.doc.uri,telemetry:i.telemetryData,index:i.choiceIndex,position:r.end,resultType:0,triggerCategory:"solution",copilotAnnotations:i.copilotAnnotations,clientCompletionId:a}),{panelId:e.panelId,range:r,completionText:i.completionText,displayText:i.insertText,score:i.meanProb,solutionId:a}}s(zEr,"makeSolution");var Xke=class{constructor(e,r,n){this.ctx=e;this.params=r;this.range=n;this.offset=0}static{s(this,"SolutionHandler")}get service(){return this.ctx.get(Nr)}onSolution(e){return this.service.connection.sendNotification(new DM.NotificationType("PanelSolution"),zEr(this.ctx,this.params,this.range,this.offset,e))}onFinishedNormally(){return qAt(this.params.panelId,this.service)}onFinishedWithError(e){return this.service.connection.sendNotification(new DM.NotificationType("PanelSolutionsDone"),{status:"Error",message:e,panelId:this.params.panelId})}};async function qAt(t,e){return e.connection.sendNotification(new DM.NotificationType("PanelSolutionsDone"),{status:"OK",panelId:t})}s(qAt,"reportDone");var nH;async function KEr(t,e,r){nH&&(nH.cancel(),nH.dispose()),nH=new hn.CancellationTokenSource;let n=new nf([e,nH.token]),i=r.doc.position,o=Es.range(i,i),a=new Xke(t,r,o),c=t.get(Ey);if(c.documents){let l=c.documents;_ce(i,l,a)}else{let l;try{l=await xy(t,r.doc,n)}catch(f){if(!(f instanceof DM.ResponseError))throw f;switch(f.code){case tr.CopilotNotAvailable:case tr.ContentModified:return YEr(t,r)}throw f}a.offset=l.offsetAt(i);let u=new _M(l,i,n,10);wce(t,u,a)}return[{solutionCountTarget:10},null]}s(KEr,"handleGetPanelCompletionsChecked");async function YEr(t,e){return await qAt(e.panelId,t.get(Nr)),[{solutionCountTarget:0},null]}s(YEr,"produceEmptySolutions");var HAt=Ze(VEr,KEr);d();var JEr=x.Object({});function XEr(t,e,r){return[{version:t.get(To).getDisplayVersion(),buildType:AC(t),runtimeVersion:`node/${process.versions.node}`},null]}s(XEr,"handleGetVersionChecked");var $At=Ze(JEr,XEr);d();var ZEr=x.Object({changes:x.Array(x.String()),userCommits:x.Array(x.String()),recentCommits:x.Array(x.String()),workspaceFolder:x.Optional(x.String()),userLanguage:x.Optional(x.String())});async function ebr(t,e,r){if(r.changes.length===0)return[null,{code:tr.InvalidRequest,message:"No changes provided"}];let n=t.get(to),i=n.create({capabilities:{skills:[Y1]}}),o=new mS({message:"",type:"user"});await n.addTurn(i.id,o);let a=bM({workDoneToken:br()});await t.get(Ns).begin(i,o,a);let u=(await new xS(t,i,o,e).skillResolver.resolve(Y1))?.head?.name,p=await t.get(Qk).generateCommitMessage(t,e,r,u);return p==null?[null,{code:tr.InternalError,message:"Failed to generate commit message"}]:[{commitMessage:p},null]}s(ebr,"handleGitCommitGenerateChecked");var WAt=Ze(ZEr,ebr);d();var GAt=yve.type,iH;function jAt(t){return{title:"Completion Accepted",command:uq,arguments:[t]}}s(jAt,"makeCommand");async function tbr(t,e,r){iH&&(iH.cancel(),iH.dispose());let n=r.context.triggerKind===1;iH=new hn.CancellationTokenSource;let i=iH.token,o=new nf([e,i]);r.contextItems&&PM(t,r.contextItems,r.data);let a=kce(t,r.position,r.textDocument.uri,n);if(a)return[{items:a.map(h=>({command:jAt(br()),...h}))},null];let c=await xy(t,r.textDocument,o),l=r.position,u=await Rce(t,c,l,o,{isCycling:n,selectedCompletionInfo:r.context.selectedCompletionInfo,formattingOptions:r.formattingOptions,data:r.data});if(!u)return e.isCancellationRequested?[null,{code:tr.RequestCancelled,message:"Request was canceled"}]:i.isCancellationRequested?[null,{code:tr.ServerCancelled,message:"Request was superseded by a new request"}]:[{items:[]},null];let f=t.get(Gs);for(let m of u)f.set(m.uuid,{...m,triggerCategory:"ghostText"});return[{items:u.map(m=>({command:jAt(m.uuid),insertText:m.insertText,range:m.range}))},null]}s(tbr,"handleChecked");var VAt=Ze(KX,(t,e,r)=>tbr(t,e,r));d();var zAt=xve.type,oH;async function nbr(t,e,r){oH&&(oH.cancel(),oH.dispose());let n=r.context.triggerKind===1;oH=new hn.CancellationTokenSource;let i=oH.token,o=new nf([e,i]);r.contextItems&&PM(t,r.contextItems);let a=await xy(t,r.textDocument,o),c=await Kke(t,YC(a,r.position),o,{promptOnly:!0,isCycling:n,selectedCompletionInfo:r.context.selectedCompletionInfo,formattingOptions:r.formattingOptions,data:r.data});if(c.type!=="promptOnly")throw new Error(`Unexpected result type ${c.type}`);return[{prompt:c.prompt},null]}s(nbr,"handleChecked");var KAt=Ze(KX,(t,e,r)=>nbr(t,e,r));d();d();function Zke(t){let e=t.indexOf("-----BEGIN CERTIFICATE-----")+27,r=t.indexOf("-----END CERTIFICATE-----"),n=30,i=t.substring(e,e+n)+"..."+t.substring(r-n,r-1);return BM(i)}s(Zke,"asReadableCert");function BM(t){return t.replace(/\s/g,"")}s(BM,"normalizeNewlines");var obr=x.Object({});async function sbr(t){return[{certificates:(await t.get(gl).getAllRootCAs()).map(BM)},null]}s(sbr,"handleListCertificatesChecked");var YAt=Ze(obr,sbr);d();d();var XAt=x.Object({url:x.String(),source:x.String(),id:x.String()}),ZAt=x.Object({version:x.String(),release_date:x.String(),is_latest:x.Boolean()}),abr=x.Object({id:x.String(),name:x.String(),description:x.String(),status:x.Optional(x.Union([x.Literal("active"),x.Literal("deprecated")])),repository:x.Optional(XAt),version_detail:ZAt}),Ivo=x.Object({servers:x.Array(abr),next:x.Optional(x.String()),total_count:x.Number()}),JAt=x.Union([x.Object({type:x.Literal("positional"),description:x.Optional(x.String()),is_required:x.Optional(x.Boolean()),format:x.Optional(x.Union([x.Literal("string"),x.Literal("number"),x.Literal("boolean"),x.Literal("filepath")])),value:x.Optional(x.String()),is_secret:x.Optional(x.Boolean()),default:x.Optional(x.String()),choices:x.Optional(x.Array(x.String())),value_hint:x.Optional(x.String()),is_repeated:x.Optional(x.Boolean())}),x.Object({type:x.Literal("named"),name:x.String(),description:x.Optional(x.String()),is_required:x.Optional(x.Boolean()),format:x.Optional(x.Union([x.Literal("string"),x.Literal("number"),x.Literal("boolean"),x.Literal("filepath")])),value:x.Optional(x.String()),is_secret:x.Optional(x.Boolean()),default:x.Optional(x.String()),choices:x.Optional(x.Array(x.String())),is_repeated:x.Optional(x.Boolean())})]),eyt=x.Object({name:x.String(),description:x.Optional(x.String()),is_required:x.Optional(x.Boolean()),format:x.Optional(x.Union([x.Literal("string"),x.Literal("number"),x.Literal("boolean"),x.Literal("filepath")])),value:x.Optional(x.String()),is_secret:x.Optional(x.Boolean()),default:x.Optional(x.String()),choices:x.Optional(x.Array(x.String()))}),cbr=x.Object({registry_name:x.String(),name:x.String(),version:x.String(),runtime_hint:x.Optional(x.String()),runtime_arguments:x.Optional(x.Array(JAt)),package_arguments:x.Optional(x.Array(JAt)),environment_variables:x.Optional(x.Array(eyt))}),lbr=x.Object({transport_type:x.Union([x.Literal("streamable"),x.Literal("sse")]),url:x.String(),headers:x.Optional(x.Array(eyt))}),Tvo=x.Object({id:x.String(),name:x.String(),description:x.String(),status:x.Optional(x.Union([x.Literal("active"),x.Literal("deprecated")])),repository:x.Optional(XAt),version_detail:ZAt,packages:x.Optional(x.Array(cbr)),remotes:x.Optional(x.Array(lbr))}),tyt=x.Object({baseUrl:x.String(),limit:x.Optional(x.Number({minimum:1})),offset:x.Optional(x.Number({minimum:0,default:0}))}),ryt=x.Object({baseUrl:x.String(),id:x.String(),version:x.Optional(x.String())});async function ubr(t,e,r){if(!r.baseUrl)return[null,{code:tr.InvalidParams,message:"Base URL is required"}];let n=t.get(Or),i=new URLSearchParams;r.limit!==void 0&&i.append("limit",r.limit.toString()),r.offset!==void 0&&i.append("offset",r.offset.toString());let o=`${r.baseUrl}${i.toString()?`?${i.toString()}`:""}`;try{let a=await n.fetch(o,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}});if(!a.ok)return[null,{code:tr.InternalError,message:`MCP Registry API error: HTTP ${a.status}`}];let c=await a.text();return[JSON.parse(c),null]}catch(a){return[null,{code:tr.InternalError,message:`Failed to fetch servers from MCP Registry: ${a instanceof Error?a.message:String(a)}`}]}}s(ubr,"handleListServersChecked");async function dbr(t,e,r){if(!r.baseUrl)return[null,{code:tr.InvalidParams,message:"Base URL is required"}];if(!r.id)return[null,{code:tr.InvalidParams,message:"Server ID is required"}];let n=t.get(Or),i=new URLSearchParams;r.version!==void 0&&i.append("version",r.version);let o=`${r.baseUrl}/${r.id}${i.toString()?`?${i.toString()}`:""}`;try{let a=await n.fetch(o,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}});if(a.status===404)return[null,{code:tr.InternalError,message:"Server not found"}];if(!a.ok)return[null,{code:tr.InternalError,message:`MCP Registry API error: HTTP ${a.status}`}];let c=await a.text();return[JSON.parse(c),null]}catch(a){return[null,{code:tr.InternalError,message:`Failed to fetch server from MCP Registry: ${a instanceof Error?a.message:String(a)}`}]}}s(dbr,"handleGetServerChecked");var nyt=Ze(tyt,ubr),iyt=Ze(ryt,dbr);d();async function fbr(t,e,r){let n=t.get(py);if(r.textDocument.version===void 0)throw new Error("textDocument.version is undefined");let i=Pl(r.textDocument.uri);t.get(LA).onUserPositionChange(i,new Wr(r.position.line,r.position.character));let o=await n.handleNextEditRequest(i,r.textDocument.version,e);return o?[{edits:o.map(c=>({text:c.edit.text,textDocument:c.edit.textDocument,range:c.edit.range,command:{title:"Accept inline edit",command:uq,arguments:[c.id]}}))},null]:[{edits:[]},null]}s(fbr,"handleChecked");var oyt=Ze(Vze,fbr);d();var mbr=x.Object({uuid:x.String({minLength:1}),acceptedLength:x.Optional(x.Number({minimum:1}))});function hbr(t,e,r){let n=t.get(Gs),i=n.get(r.uuid);return i&&(gbr(r,i)==="full"?(n.delete(r.uuid),j3(t,i,i.triggerCategory)):Tee(t,i,r.acceptedLength,0,i.triggerCategory,"cumulative")),["OK",null]}s(hbr,"notifyAcceptedChecked");function gbr(t,e){return t.acceptedLength===void 0?"full":t.acceptedLength<e.insertText.length?"partial":"full"}s(gbr,"getCompletionType");var syt=Ze(mbr,hbr);d();var Abr=x.Object({uuids:x.Array(x.String())});function ybr(t,e,r){let n=t.get(Gs),i=r.uuids.flatMap(o=>n.get(o)??[]);if(i.length>0){let o=i[0];for(let c of r.uuids)n.delete(c);let a=i.map(c=>({completionText:c.displayText,completionTelemetryData:c.telemetry}));Iee(t,"ghostText",o.offset,o.uri,a),t.get(rd).resetState()}return["OK",null]}s(ybr,"notifyRejectedChecked");var ayt=Ze(Abr,ybr);d();var Cbr=x.Object({uuid:x.String({minLength:1})});function vbr(t,e,r){let i=t.get(Gs).get(r.uuid);return i&&GX(t,i.triggerCategory,i),["OK",null]}s(vbr,"notifyShownChecked");var cyt=Ze(Cbr,vbr);d();var xbr=yJe;function Ebr(t,e,r){let n=t.get(Hc),i={unregistered:[],registered:[]};return r.providers.forEach(o=>{try{let a=new kM(t,o.id,o.selector);n.registerContextProvider(a),i.registered.push(o.id)}catch{i.unregistered.push(o.id)}}),[i,null]}s(Ebr,"registerContextProviders");var lyt=Ze(xbr,Ebr);d();d();var bbr=x.Object({uri:x.Optional(x.String())}),Ibr=x.Object({showEditorCompletions:x.Optional(x.Boolean()),enableAutoCompletions:x.Optional(x.Boolean()),delayCompletions:x.Optional(x.Boolean()),filterCompletions:x.Optional(x.Boolean())}),dyt=x.Object({github:x.Optional(x.Object({copilot:x.Optional(x.Object({}))})),[EBe]:x.Optional(bbr),http:x.Optional(wje),telemetry:x.Optional(x.Object({telemetryLevel:x.Optional(x.String())}))}),sH=Object.keys(dyt.properties).filter(t=>t!=="github"),Tbr=x.Intersect([dyt,Ibr]),wbr=x.Object({settings:x.Optional(x.Union([x.Object({}),x.Array(x.Unknown(),{maxItems:0})])),authProvider:x.Optional(x.Never())}),uyt=ta.Compile(wbr),ePe=ta.Compile(Tbr);async function Dce(t,e){if(!uyt.Check(e))throw Pce(t),new ud(uyt.Errors(e));let r=Array.isArray(e.settings)?{}:e.settings;return r&&Sbr(t,r),Pce(t,r),Promise.resolve()}s(Dce,"notifyChangeConfiguration");function Sbr(t,e){for(let n of ePe.Errors(e)){let i=n.path.split("/")?.[1];Ru.warn(t,`Invalid ${n.path.slice(1).replace(/\//g,".")} setting:`,n.message),delete e[i]}if(!ePe.Check(e))throw new ud(ePe.Errors(e));e.http&&tPe(t,e.http);let r=e["github-enterprise"];r&&$3e(t,r.uri),e.github?.copilot&&_br(t,e.github.copilot)}s(Sbr,"applySettingsToConfiguration");function _br(t,e){let r=t.get(ag),n={};for(let i of Object.values(Ht)){let o=Rje(e,i);n[i]=o}r.setCopilotSettings(n),typeof e.mcp=="string"&&Pbr(t,e.mcp),e.agent&&typeof e.agent=="object"&&Dbr(t,e.agent),Rbr(t,e.globalCopilotInstructions||""),kbr(t,e.globalGitCommitInstructions||"")}s(_br,"applyCopilotConfiguration");function Rbr(t,e){try{t.get(E1).setGlobalCopilotInstructions(e)}catch(r){Ru.error(t,"Failed to apply global Copilot instructions configuration",r)}}s(Rbr,"applyGlobalCopilotInstructionsConfiguration");function kbr(t,e){try{t.get(E1).setGlobalGitCommitInstructions(e)}catch(r){Ru.error(t,"Failed to apply global Git commit instructions configuration",r)}}s(kbr,"applyGlobalGitCommitInstructionsConfiguration");function tPe(t,e){let r=t.get(ag);e.proxy===void 0&&(e=Sje(r.env));try{r.setHttpSettings(DO(e))}catch(n){if(!(n instanceof TypeError))throw n;Ru.warn(t,"Invalid proxy URL",e.proxy,n),r.setHttpSettings({proxy:""})}}s(tPe,"applyHttpConfiguration");async function Pbr(t,e){try{let r=JSON.parse(e||"{}");await t.get(ng).updateMCPServers(r)}catch(r){Ru.error(t,"Failed to apply MCP configuration",r)}}s(Pbr,"applyMCPConfiguration");function Dbr(t,e){try{let r=e;t.get(nE).updateConfiguration(r.tools?.terminal?.autoApprove)}catch(r){Ru.error(t,"Failed to apply settings configuration",r)}}s(Dbr,"applyTerminalAutoApproveConfiguration");function Pce(t,e){if(t.get(ag).markReady(),!t.get(xs).getCapabilities().redirectedTelemetry){let r=(e?.telemetry?.telemetryLevel??"all")==="all";t.get(Md).initialize(r)}}s(Pce,"initializePostConfigurationDependencies");var fyt=x.Object({name:x.String(),version:x.String(),readableName:x.Optional(x.String())}),Bbr=x.Object({editorInfo:fyt,editorPluginInfo:fyt,editorConfiguration:x.Optional(x.Object({}))});async function Nbr(t,e,r){t.get(cn).setEditorAndPluginInfo(r.editorPluginInfo,r.editorInfo),qoe(t,["setEditorInfo is deprecated. Use initializationOptions for editorInfo and editorPluginInfo","and workspace/didChangeConfiguration for editorConfiguration."]),await Dce(t,{settings:r.editorConfiguration}),Bt(t,"setEditorInfo");for(let n of["github",...sH])r.editorConfiguration&&n in r.editorConfiguration&&Bt(t,`setEditorInfo.editorConfiguration.${n}`);return["OK",null]}s(Nbr,"handleSetEditorInfoChecked");var pyt=Ze(Bbr,Nbr);d();var Mbr=x.Object({options:x.Optional(x.Object({}))});async function Lbr(t,e,r){let n=t.get(Rf),i=n.pendingSignIn?.status;if(i===void 0)return[null,{code:tr.InvalidRequest,message:"No pending sign in"}];let o;try{return o=await i,[o,null]}catch(a){return[null,{code:tr.DeviceFlowFailed,message:String(a)}]}finally{n.pendingSignIn=void 0}}s(Lbr,"handleSignInConfirmChecked");var myt=Ze(Mbr,Lbr);d();var Fbr=x.Object({options:x.Optional(x.Object({})),githubAppId:x.Optional(x.String())});async function Obr(t,e,r){try{let i=await t.get(Bi).checkAndUpdateStatus({githubAppId:r.githubAppId});if(i.status==="OK")return[{status:"AlreadySignedIn",user:i.user},null];let a=await t.get(Rf).initiate(r);return[{status:"PromptUserDeviceFlow",userCode:a.user_code,verificationUri:a.verification_uri,expiresIn:a.expires_in,interval:a.interval,command:{command:Hoe,title:"Sign in with GitHub",arguments:[]}},null]}catch(n){if(!(n instanceof Sa))throw n;return[null,{code:tr.DeviceFlowFailed,message:n.message}]}}s(Obr,"handleSignInInitiateChecked");var rPe=Ze(Fbr,Obr);d();var Qbr=x.Object({githubToken:x.String({minLength:1}),user:x.String({minLength:1}),githubAppId:x.Optional(x.String({minLength:1}))});async function Ubr(t,e,r){let n=r.githubToken,i=r.user,o=r.githubAppId,a=t.get(Bi);return[await t.get(Rf).save({...a.getConfiguredUrls(),accessToken:n,login:i,githubAppId:o}),null]}s(Ubr,"handleSignInWithGithubTokenChecked");var hyt=Ze(Qbr,Ubr);d();var qbr=x.Object({options:x.Optional(x.Object({}))});async function Hbr(t,e,r){return[await t.get(Rf).abandon(),null]}s(Hbr,"handleSignOutChecked");var gyt=Ze(qbr,Hbr);d();var $br=x.Object({transaction:x.Optional(x.String()),stacktrace:x.Optional(x.String()),properties:x.Optional(x.Record(x.String(),x.String())),platform:x.Optional(x.String()),exception_detail:x.Optional(x.Array(x.Object({type:x.Optional(x.String()),value:x.Optional(x.String()),stacktrace:x.Optional(x.Array(x.Object({filename:x.Optional(x.String()),lineno:x.Optional(x.Union([x.String(),x.Integer()])),colno:x.Optional(x.Union([x.String(),x.Integer()])),function:x.Optional(x.String()),in_app:x.Optional(x.Boolean())})))})))}),nPe=class extends Error{constructor(r,n){super(r);this.code=n;this.name="AgentEditorError"}static{s(this,"AgentEditorError")}};function Wbr(t,e,r){let n=t.get(To),i=t.get(cn).getEditorPluginInfo(),o=r.properties||{},a;r.platform&&r.exception_detail&&F1.has(i.name)&&(a=Object.assign({rollup_id:"auto",context:epe(t),sensitive_context:{},deployed_to:n.getBuildType(),platform:r.platform,exception_detail:r.exception_detail},F1.get(i.name)),r.transaction&&(a.transaction=r.transaction),n.getBuildType()!=="dev"&&(a.release=`${a.app}@${i.version}`));let c=new nPe(r.stacktrace??"N/A",i.name);return c.stack=void 0,Ka(t,c,void 0,o,a),["OK",null]}s(Wbr,"handleTelemetryExceptionChecked");var Ayt=Ze($br,Wbr);d();d();d();function iPe(t){let e=Date.now()+((t?.refresh_in??0)+eV)*1e3;return new a2({token:`test token ${br()}`,refresh_in:0,expires_at:e,...t},void 0,e)}s(iPe,"createTestCopilotToken");var NM=class extends nu{constructor(){super(...arguments);this.defaultToken=iPe({token:"tid=test;rt=1"})}static{s(this,"FakeCopilotTokenFetcherFromSession")}fetchTokenResult(r,n){switch(n.accessToken){case"":return{copilotToken:this.defaultToken};case"valid-github-token":return{copilotToken:iPe({token:"tid=valid-copilot-token"})};case void 0:return{failureKind:"NotSignedIn"};case"notauth-github-token":return{failureKind:"NotAuthorized",message:"notauth",canSignUpForLimited:!0};case"bogus-github-token":return{failureKind:"NotAuthorized",message:"bogus",canSignUpForLimited:!1};case"expired-github-token":return{failureKind:"HTTP401",message:"expired"};default:throw new Error("Don't have a valid GitHub token")}}};var Bce=class extends nu{constructor(r){super();this.envelopeFn=r}static{s(this,"StaticCopilotTokenFetcher")}async fetchTokenResult(){return{copilotToken:iPe(await this.envelopeFn())}}};var jbr=x.Object({options:x.Optional(x.Object({}))});async function Gbr(t,e,r){let n=new NM;return t.get(Bi).setTransientSession({accessToken:"valid-github-token",login:"always auth"}),t.forceSet(nu,n),t.get(qo).forceNormal(),await new Promise(i=>setTimeout(i,0)),["OK",null]}s(Gbr,"handleTestingAlwaysAuthChecked");var yyt=Ze(jbr,Gbr);d();var Vbr=x.Object({messages:x.Array(x.Object({role:x.Enum(pa),content:x.String(),name:x.Optional(x.String())})),modelFamily:x.Optional(x.Enum($r)),stop:x.Optional(x.Array(x.String())),conversationOptions:x.Optional(x.Object({maxResponseTokens:x.Optional(x.Number()),temperature:x.Optional(x.Number())}))});async function zbr(t,e,r){let n=new Ps(t),i=await t.get(ha).getBestChatModelConfig([r.modelFamily??$r.CopilotBase]),o=await qR(t,"","");return[await n.fetchResponse({modelConfiguration:i,messages:r.messages,uiKind:"conversationIntegrationTest",stop:r.stop,intentParams:{intent:!0},llmInteraction:Gd.user("test",br())},e,o),null]}s(zbr,"handleChatMLChecked");var Cyt=Ze(Vbr,zbr);d();d();d();var QM=Be(bCt(),1),jIo={ALPN_HTTP2:QM.default.ALPN_HTTP2,ALPN_HTTP2C:QM.default.ALPN_HTTP2C,ALPN_HTTP1_1:QM.default.ALPN_HTTP1_1,ALPN_HTTP1_0:QM.default.ALPN_HTTP1_0},{fetch:GIo,context:ICt,reset:VIo,noCache:zIo,h1:KIo,keepAlive:YIo,h1NoCache:JIo,keepAliveNoCache:XIo,cacheStats:ZIo,clearCache:eTo,offPush:tTo,onPush:rTo,createUrl:nTo,timeoutSignal:iTo,Body:oTo,Headers:TCt,Request:sTo,Response:aTo,AbortController:cTo,AbortError:Yce,AbortSignal:lTo,FetchBaseError:uTo,FetchError:dTo,ALPN_HTTP2:fTo,ALPN_HTTP2C:pTo,ALPN_HTTP1_1:mTo,ALPN_HTTP1_0:hTo}=QM.default;var SCt=require("crypto"),_Ct=require("http"),RCt=require("stream"),kCt=require("util"),qM=Be(wA());var gwr=9e4,Awr=new qM.ProtocolRequestType("copilot/fetch"),ywr=new qM.ProtocolRequestType("copilot/fetchCancel"),Cwr=new qM.ProgressType,vwr=new qM.ProtocolRequestType("copilot/fetchDisconnectAll"),ev=class extends Error{static{s(this,"EditorFetcherError")}constructor(e){super(e),this.name="EditorFetcherError"}},UM=class extends Or{constructor(r){super();this.ctx=r;this.name="EditorFetcher";this.userAgent=`GithubCopilot/${r.get(To).getVersion()}`}static{s(this,"EditorFetcher")}disconnectAll(){return this.ctx.get(Nr).connection.sendRequest(vwr,{})}async fetch(r,n){n.headers||={},n.headers["user-agent"]=this.userAgent;let{signal:i}=n,o=this.ctx.get(Nr).connection,a=(0,SCt.randomUUID)(),c=new hn.CancellationTokenSource,l=new RCt.PassThrough,u=s(()=>{o.sendRequest(ywr,{workDoneToken:a})},"sendCancelRequest"),f=s(()=>{l.emit("error",new Yce("EditorFetch request aborted")),l.end()},"destroyBodyStream");if(i){if(!(i instanceof AbortSignal))throw new ev("EditorFetcher received unexpected abort signal");if(i.aborted)throw new Yce("EditorFetcher signal aborted before fetch");i.addEventListener("abort",u)}o.onProgress(Cwr,a,m=>{m.kind==="end"?(i?.removeEventListener("abort",u),i?.removeEventListener("abort",f),m.error&&l.emit("error",new ev(m.error)),l.end()):m.kind==="report"&&l.write(m.chunk)});let p=await new Promise((m,h)=>{let g=setTimeout(()=>{h(new ev("Request timed out from lsp server"))},n.timeout??gwr),A=s(()=>{h(new Yce("EditorFetcher request aborted"))},"rejectIfAborted");i?.addEventListener("abort",A),o.sendRequest(Awr,Ewr(r,a,n),c.token).then(m).catch(y=>{let E="EditorFetcher request failed";y&&typeof y=="object"&&"message"in y&&(E+=`: ${String(y.message)}`),y&&typeof y=="object"&&"data"in y&&(E+=`: ${(0,kCt.inspect)(y.data)}`),h(new ev(E))}).finally(()=>{i?.removeEventListener("abort",A),clearTimeout(g)})});if(!p.status)throw new ev("EditorFetcher received invalid response");return i?.addEventListener("abort",f),new hI(p.status,_Ct.STATUS_CODES[p.status]??"",new TCt(p.headers),()=>xwr(l),()=>l)}};function xwr(t){return new Promise((e,r)=>{let n="";t.on("error",r),t.on("end",()=>e(n)),t.on("data",i=>n+=String(i))})}s(xwr,"consumeStream");function Ewr(t,e,r){let{timeout:n,method:i}=r,o=r.headers??{},a=r.json?JSON.stringify(r.json):r.body;return r.json&&(o["content-type"]="application/json"),{url:t,headers:o,body:a,timeout:n,method:i,workDoneToken:e}}s(Ewr,"convertOptionsToParams");var bwr=x.Object({url:x.String(),headers:x.Optional(x.Record(x.String(),x.String())),body:x.Optional(x.String()),timeout:x.Optional(x.Number()),method:x.Optional(x.Union([x.Literal("GET"),x.Literal("POST"),x.Literal("DELETE")])),cancelBeforeRequest:x.Optional(x.Boolean()),cancelAfterRequest:x.Optional(x.Boolean()),cancelAfterFirstChunk:x.Optional(x.Boolean())});async function Iwr(t,e,r){let n=new UM(t),i=new AbortController,o=i.signal,{url:a,cancelBeforeRequest:c,cancelAfterRequest:l,cancelAfterFirstChunk:u,...f}=r;c&&i.abort();let p=n.fetch(a,{signal:o,...f});l&&i.abort();let m;try{m=await p}catch(A){return[{error:`Fetch stream error: ${A instanceof ev?A.message:String(A)}`},null]}let{status:h}=m,g=Object.fromEntries(Array.from(m.headers));try{if(u){let y=m.body();for await(let E of y){let b=E.toString();return i.abort(),[{status:h,headers:g,body:b},null]}}let A=await m.text();return[{status:h,headers:g,body:A},null]}catch(A){return[{error:`Fetch stream error: ${A instanceof ev?A.message:String(A)}`},null]}}s(Iwr,"handleTestingFetchChecked");var PCt=Ze(bwr,Iwr);d();var Twr=x.Object({});async function wwr(t,e,r){return await t.get(Zc).flush(),["OK",null]}s(wwr,"handleTestingFlushPromiseQueueChecked");var DCt=Ze(Twr,wwr);d();var Swr=x.Object({filePath:x.String(),code:x.String(),offset:x.Number(),languageId:x.String(),timeout:x.Optional(x.Number()),waitForContext:x.Optional(x.Boolean())});async function _wr(t,e,r){try{await t.get(N1).start();let n=t.get(dP),i=r.timeout??1e3,o=Date.now(),a=[],c=!0;for(;c;)try{a=await n.indexClient.getContext(r.filePath,r.code,r.offset,r.languageId,zX,e)}catch{}finally{c=(r.waitForContext??!1)&&a.length==0&&Date.now()-o<i}return[{initialized:!0,context:a},null]}catch{return[{initialized:!1,context:[]},null]}}s(_wr,"handleTestingGetContextChecked");var BCt=Ze(Swr,_wr);d();var Rwr=x.Object({uri:x.String()});async function kwr(t,e,r){let i=await t.get(dr).getTextDocument(r);return[{uri:r.uri,languageId:i?.clientLanguageId??"unknown",version:i?.version??-1,text:i?.getText()??""},null]}s(kwr,"handleGetDocumentChecked");var NCt=Ze(Rwr,kwr);d();var Pwr=x.Object({options:x.Optional(x.Object({}))});async function Dwr(t,e,r){t.get(Bi).setTransientSession({});try{await t.get(ar).getToken()}catch{}return await new Promise(n=>setTimeout(n,0)),["OK",null]}s(Dwr,"handleTestingNeverAuthChecked");var MCt=Ze(Pwr,Dwr);d();d();d();var BPe=class extends gl{constructor(r){super();this.certificates=r}static{s(this,"TestCertificateReader")}getAllRootCAs(){return this.certificates}},LCt=s(t=>new BPe(t),"createTestCertificateReader");function MPe(t,e,r){let n=new NPe;n.set("x-github-request-id","1");for(let[i,o]of Object.entries(r||{}))n.set(i,o);return new hI(t,"status text",n,()=>Promise.resolve(e??""),()=>null)}s(MPe,"createFakeResponse");function FCt(t,e,r){let n;return typeof e=="string"?n=e:n=JSON.stringify(e),MPe(t,n,Object.assign({"content-type":"application/json"},r))}s(FCt,"createFakeJsonResponse");var mH=class extends Or{constructor(){super(...arguments);this.name="FakeFetcher"}static{s(this,"FakeFetcher")}disconnectAll(){throw new Error("Method not implemented.")}};var Jce=class extends mH{static{s(this,"NoFetchFetcher")}fetch(e,r){throw new Error("NoFetchFetcher does not support fetching")}};var NPe=class{constructor(){this.headers=new Map}static{s(this,"FakeHeaders")}append(e,r){this.headers.set(e.toLowerCase(),r)}delete(e){this.headers.delete(e.toLowerCase())}get(e){return this.headers.get(e.toLowerCase())??null}has(e){return this.headers.has(e.toLowerCase())}set(e,r){this.headers.set(e.toLowerCase(),r)}entries(){return this.headers.entries()}keys(){return this.headers.keys()}values(){return this.headers.values()}[Symbol.iterator](){return this.headers.entries()}};var LPe=class extends mH{static{s(this,"ExpConfigFetcher")}constructor(e){super(),this.fullConfig={Features:[],Flights:{},Configs:[{Id:"vscode",Parameters:e.Parameters}],ParameterGroups:[],AssignmentContext:e.AssignmentContext}}fetch(e,r){return e.endsWith("telemetry")?Promise.resolve(FCt(200,this.fullConfig)):Promise.resolve(MPe(404,""))}},Xce=class extends LPe{constructor(r,n){super(r);this.delegate=n}static{s(this,"ExpConfigFetcherWithDelegate")}fetch(r,n){return r.endsWith("telemetry")?super.fetch(r,n):this.delegate.fetch(r,n)}};var Bwr=x.Object({expFlags:x.Record(x.String(),x.Union([x.String(),x.Number(),x.Boolean()]))});function Nwr(t,e,r){if(r.expFlags){let n={AssignmentContext:"assignmentcontext",Parameters:{...r.expFlags}};t.forceSet(Or,new Xce(n,t.get(Or)))}return["OK",null]}s(Nwr,"handleTestingOverrideExpFlagsChecked");var OCt=Ze(Bwr,Nwr);d();var Mwr=x.Object({rules:Kve});function Lwr(t,e,r){return t.get(dl).setTestingRules(r.rules),["OK",null]}s(Lwr,"handleTestingSetContentExclusionRulesChecked");var QCt=Ze(Mwr,Lwr);d();var Fwr=x.Object({workDoneToken:x.Union([x.String(),x.Number()]),chunks:x.Array(x.String()),followUp:x.Optional(x.String()),suggestedTitle:x.Optional(x.String()),skills:x.Optional(x.Array(x.String())),references:x.Optional(x.Array(xM)),options:x.Optional(x.Object({}))});function Owr(t,e,r){return t.get(FE).add(r.workDoneToken,r.chunks,r.followUp,r.suggestedTitle,r.skills,r.references),["OK",null]}s(Owr,"handleTestingSetSyntheticTurnsChecked");var UCt=Ze(Fwr,Owr);d();var Qwr=x.Object({});async function Uwr(t,e,r){let n=t.get(wa),i=t.get(Xc);return await n.showWarningMessage("This is a test message",{title:"Some Action"}).then(a=>o(3,"response from message request",a?.title)).catch(a=>o(1,"error sending show message request",a)),["OK",null];function o(a,c,l){return i.logIt(t,a,"triggerShowMessage",`${c} (${String(l)})`)}s(o,"sendNotification")}s(Uwr,"handleTriggerShowMessageChecked");var qCt=Ze(Qwr,Uwr);d();d();d();d();var HCt=Be(require("tls"));var Zce=class{static{s(this,"RootCertificateConfigurator")}#e;constructor(e){this._certificateReader=e.get(gl)}async getCertificates(){let e=await this._certificateReader.getAllRootCAs();if(e.length!==0)return e}async createSecureContext(){let e=await this._certificateReader.getAllRootCAs(),n=HCt.createSecureContext({_vscodeAdditionalCaCerts:e}),i=n.context;for(let o of e)i.addCACert(o);return{secureContext:n,certs:e}}async applyToRequestOptions(e){this.#e??=this.createSecureContext();let r=await this.#e;e.secureContext=r.secureContext,e.ca=r.certs,e.cert=r.certs}};var HM=class extends Or{constructor(r,n){super();this.name="HelixFetcher";this.certificateConfigurator=new Zce(r),this.proxySocketFactory=r.get(C1),this.proxySocketTimeoutForTesting=n?.proxySocketTimeoutForTesting,r.get(Mc).onDidChangeHttpSettings(i=>{this.fetchApi=this.createFetchApi(r,i)}),this.fetchApi=this.createFetchApi(r,r.get(Mc).getHttpSettings())}static{s(this,"HelixFetcher")}maybeCreateSocketFactory(r,n){if(!r?.proxy)return;let i=new URL(r.proxy);return async o=>(o.rejectUnauthorized=r.proxyStrictSSL,o.timeout=n,await this.certificateConfigurator.applyToRequestOptions(o),await this.proxySocketFactory.createSocket(o,{hostname:i.hostname,port:i.port,authorization:r.proxyAuthorization,kerberosServicePrincipal:r.proxyKerberosServicePrincipal}))}createFetchApi(r,n){let i=r.get(To),o=this.proxySocketTimeoutForTesting;return ICt({userAgent:`GithubCopilot/${i.getVersion()}`,socketFactory:this.maybeCreateSocketFactory(n,o),rejectUnauthorized:n.proxyStrictSSL})}async fetch(r,n){let i=n.signal,o=!1;if(n.timeout){let u=new AbortController;setTimeout(()=>{u.abort(),o=!0},n.timeout),n.signal?.addEventListener("abort",()=>u.abort()),n.signal?.aborted&&u.abort(),i=u.signal}let a={...n,body:n.body?n.body:n.json,signal:i};await this.certificateConfigurator.applyToRequestOptions(a);let c=await this.certificateConfigurator.getCertificates();this.fetchApi.setCA(c);let l=await this.fetchApi.fetch(r,a).catch(u=>{throw o?new FF(`Request to <${r}> timed out after ${n.timeout}ms`,u):u});return new hI(l.status,l.statusText,l.headers,()=>l.text(),()=>l.body)}disconnectAll(){return this.fetchApi.reset()}};d();d();var hH=require("fs"),$Ct=require("path");var $M=class extends Fi{static{s(this,"LocalFileSystem")}async readFileString(e){return(await hH.promises.readFile(sc(e))).toString()}async stat(e){let{targetStat:r,lstat:n,stat:i}=await this.statWithLink(sc(e));return{ctime:r.ctimeMs,mtime:r.mtimeMs,size:r.size,type:this.getFileType(r,n,i)}}async readDirectory(e){let r=sc(e),n=await hH.promises.readdir(r,{withFileTypes:!0}),i=[];for(let o of n){let{targetStat:a,lstat:c,stat:l}=await this.statWithLink((0,$Ct.join)(r,o.name));i.push([o.name,this.getFileType(a,c,l)])}return i}async statWithLink(e){let r=await hH.promises.lstat(e);if(r.isSymbolicLink())try{let n=await hH.promises.stat(e);return{lstat:r,stat:n,targetStat:n}}catch{}return{lstat:r,targetStat:r}}getFileType(e,r,n){let i=0;return e.isFile()&&(i=1),e.isDirectory()&&(i=2),r.isSymbolicLink()&&n&&(i|=64),i}};d();var ele=class extends vy{constructor(r=[]){super();this._agents=r}static{s(this,"TestRemoteAgentRegistry")}agents(){return this._agents}};d();var tle=class extends xl{constructor(){super(...arguments);this.prompts=[];this.fetchResults=[];this.diffs=[]}static{s(this,"TestConversationInspector")}shouldInspect(){return!0}inspectPrompt(r){this.shouldInspect()&&this.prompts.push(r)}inspectFetchResult(r){this.shouldInspect()&&this.fetchResults.push(r)}documentDiff(r){this.shouldInspect()&&this.diffs.push(r)}};d();var rle=class extends Y0{constructor(){super(...arguments);this.allowedFiles=[]}static{s(this,"TestingFileSearch")}addAllowedFiles(r){this.allowedFiles.push(...r)}findFiles(r,{uri:n},i){return Promise.resolve(this.allowedFiles)}};d();function qwr(t){return{modelId:"gpt-3.5-turbo",modelFamily:t,uiName:"Test GPT",maxRequestTokens:6144,maxResponseTokens:2048,baseTokensPerMessage:3,baseTokensPerName:1,baseTokensPerCompletion:3,tokenizer:"cl100k_base",isExperimental:!1,stream:!0,toolCalls:!0}}s(qwr,"fakeChatModelConfiguration");function Hwr(t){return{modelId:"embedding-test",modelFamily:t,maxBatchSize:1,maxTokens:50,tokenizer:"cl100k_base"}}s(Hwr,"fakeEmbeddingModelConfiguration");var nle=class extends ha{static{s(this,"TestModelConfigurationProvider")}getBestChatModelConfig(e){let r=e[0];return Promise.resolve(qwr(r))}getFirstMatchingEmbeddingModelConfiguration(e){return Promise.resolve(Hwr(e))}};d();var ile=class extends ju{constructor(){super(...arguments);this.openedUrls=[];this.opened=new Ph}static{s(this,"TestUrlOpener")}open(r){return this.openedUrls.push(r),this.opened.resolve(),Promise.resolve()}},ole=class extends wa{constructor(){super();this.sentMessages=[];this.warningPromises=[];this.informationPromises=[]}static{s(this,"TestNotificationSender")}performDismiss(){this.actionToPerform="DISMISS"}performAction(r){this.actionToPerform=r}showWarningMessage(r,...n){this.sentMessages.push(r);let i;if(this.actionToPerform)if(this.actionToPerform==="DISMISS")i=Promise.resolve(void 0);else{let o=n.find(a=>a.title===this.actionToPerform);i=o?Promise.resolve(o):Promise.resolve(void 0)}else i=n?Promise.resolve(n[0]):Promise.resolve(void 0);return this.warningPromises.push(i),i}showInformationMessage(r,...n){this.sentMessages.push(r);let i;if(this.actionToPerform)if(this.actionToPerform==="DISMISS")i=Promise.resolve(void 0);else{let o=n.find(a=>a.title===this.actionToPerform);i=o?Promise.resolve(o):Promise.resolve(void 0)}else i=n?Promise.resolve(n[0]):Promise.resolve(void 0);return this.informationPromises.push(i),i}async waitForMessages(){await Promise.all(this.warningPromises),await Promise.all(this.informationPromises)}};d();function WCt(t,e,r,n){return Tx.create(wj(t),e,r,n,e)}s(WCt,"createTextDocument");var FPe=class extends dr{constructor(r){super(r);this._openTextDocuments=[];this._notebookDocuments=new Map;this._workspaceFolders=[];this.didFocusTextDocumentEmitter=new ys;this.onDidFocusTextDocument=this.didFocusTextDocumentEmitter.event;this.didChangeTextDocumentEmitter=new ys;this.onDidChangeTextDocument=this.didChangeTextDocumentEmitter.event;this.didOpenTextDocumentEmitter=new ys;this.onDidOpenTextDocument=this.didOpenTextDocumentEmitter.event;this.didCloseTextDocumentEmitter=new ys;this.onDidCloseTextDocument=this.didCloseTextDocumentEmitter.event;this.didChangeWorkspaceFoldersEmitter=new ys;this.onDidChangeWorkspaceFolders=this.didChangeWorkspaceFoldersEmitter.event}static{s(this,"SimpleTestTextDocumentManager")}init(r){this._workspaceFolders=r.map(n=>({uri:n.uri,name:n.name??Pi(n.uri)}))}async readTextDocumentFromDisk(r){return super.readTextDocumentFromDisk(r)}getTextDocumentsUnsafe(){return this._openTextDocuments}setTextDocument(r,n,i){let o=WCt(r,n,0,i);return this._openTextDocuments.push(o),o}updateTextDocument(r,n){let i=this._openTextDocuments.findIndex(a=>a.uri===r.toString());if(i<0)throw new Error("Document not found");let o=this._openTextDocuments[i];this._openTextDocuments[i]=WCt(r,o.clientLanguageId,o.version+1,n)}setNotebookDocument(r,n){this._notebookDocuments.set(r.uri.replace(/#.*/,""),n)}findNotebook({uri:r}){return this._notebookDocuments.get(r.replace(/#.*/,""))}getWorkspaceFolders(){return this._workspaceFolders}},sle=class extends FPe{constructor(r){super(r);this.contents=new Map}static{s(this,"TestTextDocumentManager")}readTextDocumentFromDisk(r){return Promise.resolve(this.contents.get(r))}setDiskContents(r,n){this.contents.set(r,n)}};var OPe=class extends Xc{static{s(this,"NullLog")}logIt(...e){}},QPe=class extends Bi{static{s(this,"TestAuthManager")}constructor(e,r){super(e,{}),this.transientSession=r&&Promise.resolve(r)}getPersistedSession(){return Promise.resolve(void 0)}};function $wr(t){let e=new p3;e.set(Mc,t),e.set(uR,t);let r=new QPe(e,{accessToken:"",login:"user"});e.set(Bi,r),e.set(To,new To),e.set(Um,new Um({debug:!1,verboseLogging:!1,testMode:!0,simulation:!1})),e.set(gl,LCt([])),e.set(C1,cne(e)),e.set(yC,new yC),e.set(pA,new oV);let n=new NM;e.set(nu,n),e.set(ar,new ar(e,!0));let i=new Ou(e);return i.updateFromToken(n.defaultToken),e.set(Ou,i),e.set(Wu,new Wu),e.set(sC,new sC),e.set(wa,new ole),e.set(ju,new ile),e.set(nC,new V3),e.set(Xc,new OPe),e.set(fp,new fp),e.set(Ms,new Ms("test-session","test-machine")),e.set(df,new y8(e)),e.set(Md,new Md(e,"copilot-test")),e.set(Mt,new Mt(e)),e.set(DA,new DA),e.set(bA,new UB),e.set(qo,new iV),e.set(Zc,new Zc),e.set($C,new $C(e)),e.set(Y0,new rle),e.set(FA,new FA(e)),e.set(Fx,hee(e)),e.set(rd,new rd),e.set(Bp,new Bp),e.set(Ox,Ox.default),e.set(ph,new ph(e,!1)),e.set(iu,new iu),e.set(En,new En(e)),e.set(kf,new aX),e.set(fl,new fl),e.set(Hc,XX(e,(o,a,c)=>a.find(l=>l==="*")?1:a.find(l=>typeof l!="string"&&l.language===c.languageId)?10:0)),e.set(kp,new kp(e)),Wwr(e),e.set(_p,new _p(e)),e.set(xs,new xs),e.set(zC,new q8),e.set(Dh,new Dh),e.set(Gp,new Gp),e.set(_1,new _1(e)),e}s($wr,"_createBaselineContext");function Wwr(t){t.set(to,new to(t)),t.set(Ns,new Ns(t)),t.set(pd,new pd(t)),t.set(ql,new ql),t.set(_u,new _u),t.set(xl,new tle),t.set(mg,new mg(t,[])),t.set(ha,new nle),t.set(vy,new ele),t.set(K1,new K1(t)),t.set(hS,new hS),t.set(Ec,new Ec(t)),t.set(fd,new fd),t.set(Am,new Am)}s(Wwr,"registerConversation");function jCt(){let t=$wr(new uR(new qB,new Map));return t.set(Or,new Jce),t.set(cn,new UPe),t.set(dr,new sle(t)),t.set(Fi,new $M),t.set(dl,new dl(t)),t.set(Cl,new Cl(t)),t.set(cd,new Pne(t)),t.set(_h,new _h(t)),t.set(jC,new T3),t.set(ny,new oie),Eoe(t),t}s(jCt,"createLibTestingContext");var UPe=class extends cn{constructor(r={name:"lib-tests-plugin",version:"2"},n={name:"lib-tests-editor",version:"1"},i=[{name:"lib-tests-related-plugin",version:"3"}]){super();this.editorPluginInfo=r;this.editorInfo=n;this.relatedPluginInfo=i}static{s(this,"LibTestsEditorInfo")}getEditorInfo(){return this.editorInfo}getEditorPluginInfo(){return this.editorPluginInfo}getRelatedPluginInfo(){return this.relatedPluginInfo}};var VCt=Be(require("fs"));var GCt=`${process.env.HOME}/.copilot-testing-gh-token`,ale,cle;function zCt(t){let e=KCt(),r=new Bce(jwr);return t.forceSet(nu,r),t.get(Bi).setTransientSession(e),r}s(zCt,"setIntegrationTokenManager");var jwr=s(async()=>{if(cle)return cle;let t=await KCt(),e=jCt(),r=new HM(e);return e.forceSet(Or,r),cle=Rme(e,t).then(n=>{if(n.copilotToken)return{token:n.copilotToken.token,refresh_in:n.copilotToken.envelope.refresh_in};throw new Sa('Could not fetch testing Copilot token. Try running "npm run get_token" again?')}),cle},"getEnvelope");async function KCt(){let t=Nme(process.env);if(t)return t;try{ale??=(await VCt.promises.readFile(GCt)).toString().trim()}catch{ale??=process.env.GITHUB_TOKEN??""}if(!ale)throw new Error(`Tests: either GH_COPILOT_TOKEN, GITHUB_COPILOT_TOKEN, or GITHUB_TOKEN must be set, or there must be a GitHub token from an app with access to Copilot in ${GCt}. Run "npm run get_token" to get one.`);return{...T0({}),accessToken:ale,login:"copilot-client tests"}}s(KCt,"getTestingGitHubSession");var Gwr=x.Object({options:x.Optional(x.Object({})),githubAppId:x.Optional(x.String())});async function Vwr(t,e,r){return zCt(t),await t.get(ar).primeToken(),["OK",null]}s(Vwr,"handleTestingUseTestingTokenChecked");var YCt=Ze(Gwr,Vwr);d();var zwr=x.Object({});async function Kwr(t,e,r){return await new W8().uninstall(t),["OK",null]}s(Kwr,"handleUninstallChecked");var JCt=Ze(zwr,Kwr);d();var Ywr=CJe;function Jwr(t,e,r){let n=t.get(Hc),i={unregistered:[],notUnregistered:[]};return r.providers.forEach(o=>{try{n.unregisterContextProvider(o.id),i.unregistered.push(o.id)}catch{i.notUnregistered.push(o.id)}}),[i,null]}s(Jwr,"unregisterContextProviders");var XCt=Ze(Ywr,Jwr);d();var qPe=Be(require("os"));var Xwr=x.Object({expectedCertificate:x.String()});async function Zwr(t,e,r){let i=(await ane(t).getAllRootCAs()).map(BM),o=BM(r.expectedCertificate);return i.includes(o)?[{status:!0,message:"Certificate verified"},null]:[{status:!1,message:`expected certificate not found - Expected to find certificate ${Zke(o)}. Only found those installed on the system:${qPe.EOL}${i.map(a=>"- "+Zke(a)).join(qPe.EOL)}`},null]}s(Zwr,"handleVerifyCertificateChecked");var ZCt=Ze(Xwr,Zwr);d();var eSr=x.Object({});async function tSr(){return[{status:!!await new oU().load()},null]}s(tSr,"handleVerifyKerberosChecked");var e1t=Ze(eSr,tSr);d();var rSr=x.Object({source:x.String(),version:x.Number(),uri:x.String()});async function nSr(t,e,r){let i=await t.get(dr).getTextDocument(r);return i?i.getText()!==r.source?[{status:!1,message:`Source mismatch: [State] ${i.getText()} !== [Request] ${r.source}`},null]:i.version!==r.version?[{status:!1,message:`Version mismatch: [State] ${i.version} !== [Request] ${r.version}`},null]:[{status:!0,message:""},null]:[{status:!1,message:`Document not found: <${r.uri}>`},null]}s(nSr,"handleVerifyStateChecked");var t1t=Ze(rSr,nSr);d();var iSr=x.Object({});function oSr(t,e,r){return[t.get(dr).getWorkspaceFolders().map(i=>{let o=new URL(i.uri),a=decodeURIComponent(o.pathname);return{...i,path:a}}),null]}s(oSr,"handleVerifyWorkspaceStateChecked");var r1t=Ze(iSr,oSr);var OP=class{constructor(e){this.handlers=e}static{s(this,"MethodHandlers")}};function n1t(){let t=new Map;return t.set(GAt.method,VAt),t.set(zAt.method,KAt),t.set("getCompletions",OAt),t.set("getCompletionsCycling",QAt),t.set("getPanelCompletions",HAt),t.set(xAt.method,EAt),t.set("getVersion",$At),t.set("setEditorInfo",pyt),t.set("checkStatus",dmt),t.set("checkQuota",umt),t.set("checkFileStatus",cmt),t.set("signInInitiate",rPe),t.set("signIn",rPe),t.set("signInConfirm",myt),t.set("signInWithGithubToken",hyt),t.set("signOut",gyt),t.set("notifyShown",cyt),t.set("notifyAccepted",syt),t.set("notifyRejected",ayt),t.set("telemetry/exception",Ayt),t.set("textDocument/copilotInlineEdit",oyt),t.set("testing/overrideExpFlags",OCt),t.set("testing/alwaysAuth",yyt),t.set("testing/neverAuth",MCt),t.set("testing/useTestingToken",YCt),t.set("testing/setCompletionDocuments",NAt),t.set("testing/setPanelCompletionDocuments",CAt),t.set("testing/triggerShowMessageRequest",qCt),t.set("testing/flushPromiseQueue",DCt),t.set("testing/getDocument",NCt),t.set("testing/chatml",Cyt),t.set("testing/setSyntheticTurns",UCt),t.set("testing/fetch",PCt),t.set("testing/setContentExclusionRules",QCt),t.set("testing/setCopilotEditsResponse",aAt),t.set("testing/getContext",BCt),t.set("uninstall",JCt),t.set("debug/diagnostics",SAt),t.set("debug/listCertificates",YAt),t.set("debug/verifyState",t1t),t.set("debug/verifyCertificate",ZCt),t.set("debug/verifyKerberos",e1t),t.set("debug/verifyWorkspaceState",r1t),t.set("context/registerProviders",lyt),t.set("context/unregisterProviders",XCt),t.set("conversation/preconditions",Xgt),t.set("conversation/persistence",Jgt),t.set("conversation/create",zgt),t.set("conversation/turn",rAt),t.set("conversation/turnDelete",nAt),t.set("conversation/destroy",Kgt),t.set("conversation/rating",Zgt),t.set("conversation/copyCode",Sgt),t.set("conversation/insertCode",_gt),t.set("conversation/templates",tAt),t.set("conversation/agents",wgt),t.set("conversation/registerTools",eAt),t.set("conversation/unregisterTools",iAt),t.set("conversation/notifyCodeAcceptance",Ygt),t.set("copilot/models",mAt),t.set("copilot/byok/saveModel",amt),t.set("copilot/byok/deleteModel",x0t),t.set("copilot/byok/listModels",omt),t.set("copilot/byok/saveApiKey",smt),t.set("copilot/byok/deleteApiKey",v0t),t.set("copilot/byok/listApiKeys",E0t),t.set("copilot/setModelPolicy",hAt),t.set("copilot/codeReview",oAt),t.set("copilot/codeReview/reviewChanges",sAt),t.set("git/commitGenerate",WAt),t.set("editConversation/create",cAt),t.set("editConversation/turn",uAt),t.set("editConversation/turnDelete",dAt),t.set("editConversation/destroy",lAt),t.set("mcp/getTools",fAt),t.set("mcp/updateToolsStatus",pAt),t.set("mcp/registry/listServers",nyt),t.set("mcp/registry/getServer",iyt),new OP(t)}s(n1t,"getAllMethods");d();d();d();var i1t=Be(wA());var gg=class{constructor(e){this.ctx=e}static{s(this,"AbstractNotification")}get type(){return new i1t.NotificationType(this.name)}};var HPe=class extends gg{constructor(){super(...arguments);this.name="copilot/didChangeToken";this.params=x.Unknown()}static{s(this,"DidChangeTokenNotificationHandler")}handle(){this.ctx.get(ar).resetToken()}},o1t=[HPe];d();var sSr=new dt("agentCopilotTokenManager");function WPe(t){try{let e=new URL(t||"https://api.github.com");if(e.protocol==="https:"&&e.hostname.startsWith("api."))return`${e.origin}/`}catch{}}s(WPe,"tokenEndpointToApiUrl");function aSr(t,e){if(!e.tokenEndpoint)return T0(e);let r=WPe(e.tokenEndpoint);return r||sSr.warn(t,`Invalid token endpoint URL <${e.tokenEndpoint}>`),T0({apiUrl:r})}s(aSr,"getUrlsFromParams");var $Pe=class extends gg{constructor(){super(...arguments);this.name=mve.method;this.params=Mze}static{s(this,"DidChangeAuthNotificationHandler")}handle(r){let n=this.ctx.get(Bi),i=aSr(this.ctx,r);this.ctx.get(df).setConfiguredUrls(this.ctx,i);let o=r.handle||r.login;o&&r?.accessToken?n.setTransientSession({accessToken:r.accessToken,login:o,githubAppId:r.githubAppId,...i}):n.setTransientSession({githubAppId:r.githubAppId,...i})}},s1t=[$Pe];d();var jPe=class extends gg{constructor(){super(...arguments);this.name=Cve.method;this.params=$ze}static{s(this,"DidShowCompletionNotificationHandler")}handle(r){let n=r.item.command.arguments[0],o=this.ctx.get(Gs).get(n);o&&PZe(this.ctx,o)}},GPe=class extends gg{constructor(){super(...arguments);this.name=Eve.method;this.params=zze}static{s(this,"DidShowInlineEditNotificationHandler")}async handle(r){let n=r.item.command.arguments[0];await this.ctx.get(py).handleShown(n)}},VPe=class extends gg{constructor(){super(...arguments);this.name=vve.method;this.params=Wze}static{s(this,"DidPartiallyAcceptCompletionNotificationHandler")}handle(r){let n=r.item.command.arguments[0],i=r.acceptedLength,o=this.ctx.get(Gs),a=o.get(n);a&&(i>=a.insertText.length?(o.delete(n),j3(this.ctx,a)):Tee(this.ctx,a,i,void 0,void 0,"cumulative"))}},a1t=[jPe,GPe,VPe];d();var lle=class extends gg{constructor(){super(...arguments);this.name="window/workDoneProgress/cancel";this.params=x.Object({token:x.Union([x.String(),x.Number()])})}static{s(this,"WorkDoneProgressCancelNotification")}handle(r){this.ctx.get($f).cancel(r.token)}};var cSr=[...o1t,...s1t,...a1t,lle];function c1t(t,e){for(let r of cSr){let n=new r(t),i=ta.Compile(n.params);e.onNotification(n.type,Xl(t,async o=>{IE(o),i.Check(o)?await n.handle(o):Ru.error(t,`Notification ${n.name}:`,new ud(i.Errors(o)))},`Notification ${n.name}`))}}s(c1t,"registerNotifications");d();var ule=Be(ul());var l1t=new dt("AgentTextDocumentConfiguration"),zPe=class{constructor(e){this.ctx=e;this.#e=new ys;this.onDidChange=this.#e.event}static{s(this,"AgentTextDocumentsConfiguration")}#e;create(e,r,n,i){try{return Tx.create(e,r,n,i)}catch(o){throw l1t.exception(this.ctx,o,".create"),o}}update(e,r,n){try{let i=[];for(let a of r)if(ule.TextDocumentContentChangeEvent.isIncremental(a)){let c={range:a.range,rangeOffset:e.offsetAt(a.range.start),rangeLength:e.offsetAt(a.range.end)-e.offsetAt(a.range.start),text:a.text};i.push(c)}let o={document:{uri:e.uri,version:n},contentChanges:i};return this.#e.fire(o),Tx.withChanges(e,r,n)}catch(i){throw l1t.exception(this.ctx,i,".update"),i}}},PS=class extends dr{constructor(){super(...arguments);this.#e=new ys;this.onDidOpenTextDocument=this.#e.event;this.#t=new ys;this.onDidCloseTextDocument=this.#t.event;this.#i=new ys;this.onDidFocusTextDocument=this.#i.event;this._textDocumentConfiguration=new zPe(this.ctx);this.onDidChangeTextDocument=this._textDocumentConfiguration.onDidChange;this._documents=new Map;this._notebookDocuments=new ule.NotebookDocuments(this._textDocumentConfiguration);this.workspaceFolders=[];this.#n=new ys;this.onDidChangeWorkspaceFolders=this.#n.event}static{s(this,"AgentTextDocumentManager")}#e;#t;#i;#n;get connection(){return this.ctx.get(Nr).connection}init(r){this.connection.onDidOpenTextDocument(n=>{let i=n.textDocument,o=this._textDocumentConfiguration.create(i.uri,i.languageId,i.version,i.text);this._documents.set(Pl(i.uri),o),this.#e.fire({document:{...i,uri:o.uri}})}),this.connection.onDidChangeTextDocument(n=>{let i=n.textDocument,o=n.contentChanges,{version:a}=i;if(a==null)throw new Error(`Received document change event for ${i.uri} without valid version identifier`);let c=Pl(i.uri),l=this._documents.get(c);l!==void 0&&(l=this._textDocumentConfiguration.update(l,o,a),this._documents.set(c,l))}),this.connection.onDidCloseTextDocument(n=>{let i=Pl(n.textDocument.uri);this._documents.delete(i),this.#t.fire({document:{uri:i}})}),this.connection.onNotification(Ave.type,n=>{let i=("textDocument"in n?n.textDocument:n)??{};this.#i.fire("uri"in i?{document:i}:{})}),this._notebookDocuments.listen(this.connection),this.workspaceFolders.length=0,this.workspaceFolders.push(...r),r.length>0&&this.#n.fire({workspaceFolders:this.workspaceFolders,added:r,removed:[]})}didChangeWorkspaceFolders(r){r.added.forEach(n=>this.registerWorkspaceFolder(n)),r.removed.forEach(n=>this.unregisterWorkspaceFolder(n)),this.#n.fire({workspaceFolders:this.workspaceFolders,added:r.added,removed:r.removed})}unregisterWorkspaceFolder(r){let n=this.workspaceFolders.findIndex(i=>i.uri===r.uri);n>=0&&this.workspaceFolders.splice(n,1)}registerWorkspaceFolder(r){this.workspaceFolders.find(n=>n.uri===r.uri)||this.workspaceFolders.push(r)}getTextDocumentsUnsafe(){return[...this._documents.values()]}getTextDocumentUnsafe(r){return this._documents.get(Pl(r.uri))}getWorkspaceFolders(){return this.workspaceFolders}findNotebook(r){let n=this._notebookDocuments.findNotebookDocumentForCell(r.uri);if(n)return{getCells:s(()=>n.cells.map((i,o)=>this.wrapCell(i,o)).filter(i=>!!i),"getCells"),getCellFor:s(({uri:i})=>{let o=n.cells.findIndex(a=>a.document===i);return o!==-1?this.wrapCell(n.cells[o],o):void 0},"getCellFor")}}wrapCell(r,n){let i=this._notebookDocuments.getCellTextDocument(r);if(i)return{kind:r.kind,metadata:r.metadata??{},index:n,document:i}}};var u1t=ta.Compile(Uze);function IE(t){if(t!==null){if(Array.isArray(t))for(let e=0;e<t.length;e++)t[e]=IE(t[e]);else if(typeof t=="object"){let e=t;for(let r in e)e[r]===null?delete e[r]:e[r]=IE(e[r])}return t}}s(IE,"purgeNulls");var d1t=["github.copilot",...sH],Nr=class{constructor(e,r){this.ctx=e;this.connection=r;this.initialized=!1;this.deactivated=!1;this.handleDidChangeConfiguration=s(async e=>{try{if(this.#t?.workspace?.configuration&&e&&typeof e=="object"&&!("settings"in e)){let n=await this.connection.workspace.getConfiguration(d1t.map(o=>({section:o}))),i={github:{copilot:n.shift()}};for(let o of sH)i[o]=n.shift();e.settings=i}return Dce(this.ctx,IE(e))}catch(r){Ru.exception(this.ctx,r,"didChangeConfiguration")}},"handleDidChangeConfiguration");this.#i=this.ctx.get(Xc)}static{s(this,"Service")}#e;#t;#i;get clientCapabilities(){return this.#t}listen(){let e=this.ctx,r=this.connection;r.onRequest(this.messageHandler.bind(this)),c1t(e,r);let n={name:"GitHub Copilot Language Server",version:e.get(To).getDisplayVersion(),nodeVersion:process.versions.node};function i(a){try{e.get(PS).didChangeWorkspaceFolders(a)}catch(c){Ru.exception(e,c,"didChangeWorkspaceFolders")}}s(i,"didChangeWorkspaceFolders"),this.connection.onNotification("vs/didAddWorkspaceFolder",({name:a,uri:c})=>i({added:[{uri:c,name:a??c}],removed:[]})),this.connection.onNotification("vs/didRemoveWorkspaceFolder",({name:a,uri:c})=>i({added:[],removed:[{uri:c,name:a??c}]})),r.onInitialize(a=>{if(this.initialized)throw new Error("initialize request sent after initialized notification");this.#t=a.capabilities;let c=a.capabilities.copilot,l=IE(a.initializationOptions);if(l){if(!u1t.Check(l))throw new ud(u1t.Errors(l));let m=l,h=e.get(cn);m.editorPluginInfo?h.setEditorAndPluginInfo({version:"unknown",...m.editorPluginInfo},m.editorInfo&&{version:"unknown",...m.editorInfo},m.relatedPluginInfo??[]):Ru.warn(e,"editorInfo and editorPluginInfo will soon be required in initializationOptions. This will replace setEditorInfo."),m.copilotIntegrationId&&h.setCopilotIntegrationId(m.copilotIntegrationId),m.githubAppId&&(e.get(iu).githubAppId=m.githubAppId),m.copilotCapabilities&&(c=m.copilotCapabilities)}let u=a.capabilities.workspace?.workspaceFolders??!1;e.get(PS).init(a.workspaceFolders??[]),CXe(this.ctx),c&&(e.get(xs).setCapabilities(c),"openURL"in c&&qoe(e,["The openURL Copilot capability has been removed in favor of window/showDocument."]));let p=s(async()=>{this.initialized||(this.initialized=!0,Ru.info(e,`${n.name} ${n.version} initialized`),e.get(ar).primeToken(),u&&r.workspace.onDidChangeWorkspaceFolders(i),a.capabilities.workspace?.didChangeConfiguration?.dynamicRegistration&&await r.client.register(Cm.DidChangeConfigurationNotification.type,{section:d1t}),a.capabilities.workspace?.configuration?await this.handleDidChangeConfiguration({}):await Promise.race([this.ctx.get(ag).requireReady().then(()=>!0),new Promise(g=>setTimeout(()=>g(!1),200))])||Pce(e),!this.deactivated&&new W8().startup(e).catch(()=>{}))},"onInitialized");return r.onInitialized(Xl(e,p,"onInitialized")),e.get(Q1).init(),c?.token&&e.get(Bi).setTransientSession({}),c?.redirectedTelemetry&&C0t(e),f1t.lt(process.versions.node,"22.0.0")&&Ru.warn(e,`Node.js ${process.versions.node} support is deprecated. Please upgrade to Node.js 22 or newer.`),{capabilities:{textDocumentSync:{openClose:!0,change:Cm.TextDocumentSyncKind.Incremental},notebookDocumentSync:{notebookSelector:[{notebook:"*"}]},workspace:{workspaceFolders:{supported:u,changeNotifications:u}},executeCommandProvider:{commands:h0t(e,r)},inlineCompletionProvider:{}},serverInfo:n}}),r.onShutdown(async()=>{await(this.#e??=this.deactivate())}),r.onExit(()=>void this.onExit()),r.onDidChangeConfiguration(a=>void this.handleDidChangeConfiguration(a)),r.listen();let o=new Woe;this.ctx.forceSet(Xc,o)}async messageHandler(e,r,n){let i=this.ctx.get(OP).handlers.get(e);if(!i)return new Cm.ResponseError(tr.MethodNotFound,`Method not found: ${e}`);if(!this.initialized)return new Cm.ResponseError(tr.ServerNotInitialized,"Agent service not initialized.");if(this.#e)return new Cm.ResponseError(tr.InvalidRequest,"Agent service shut down.");if(e!=="setEditorInfo"&&!A0t(this.ctx.get(cn)))throw new Cm.ResponseError(tr.ServerNotInitialized,"editorInfo and editorPluginInfo not set in initializationOptions");Array.isArray(r)&&(r=r[0]),IE(r);try{let[o,a]=await i(this.ctx,n,r);return a?new Cm.ResponseError(a.code,a.message,a.data):o}catch(o){if(n.isCancellationRequested)return new Cm.ResponseError(tr.RequestCancelled,"Request was canceled");if(o instanceof Sa)return new Cm.ResponseError(tr.NoCopilotToken,`Not authenticated: ${o.message}`);throw o instanceof Cm.ResponseError||Ru.exception(this.ctx,o,`Request ${e}`),o}}async onExit(){try{this.ctx.get(hy).dispose()}catch(e){Ru.exception(this.ctx,e,"failed to dispose ripgrep process manager")}this.ctx.forceSet(Xc,this.#i),await(this.#e??=this.deactivate())}markDeactivated(){this.deactivated=!0,this.ctx.get(ag).markReady()}async deactivate(){let e=this.ctx;this.markDeactivated(),vEe(e),await Promise.race([new Promise(r=>setTimeout(r,100)),e.get(Zc).flush()]),await Promise.race([new Promise(r=>setTimeout(r,1800)),e.get(Wu).deactivate()])}dispose(){this.markDeactivated(),this.connection.dispose()}},Ru=new dt("lsp");var dle=class t extends JR{constructor(r){super(r);this.reportedUnknownProviders=new Set}static{s(this,"AgentRelatedFilesProvider")}get service(){return this.context.get(Nr)}static mapProviderNameToNeighboringFileType(r){let n="CSharpCopilotCompletionContextProvider",i="CSharpRoslynCompletionRelatedContextProvider",o="CppCopilotCompletionContextProvider",a="CppCopilotCompletionSemanticCodeContextProvider";switch(r){case n:return"related/csharp";case i:return"related/csharproslyn";case o:return"related/cpp";case a:return"related/cppsemanticcodecontext";default:return"related/other"}}convert(r){let n={entries:[],traits:r.traits};for(let i of r.entries){let o={type:t.mapProviderNameToNeighboringFileType(i.providerName),uris:i.uris};n.entries.push(o),o.type==="related/other"&&!this.reportedUnknownProviders.has(i.providerName)&&(this.reportedUnknownProviders.add(i.providerName),Ol.warn(this.context,`unknown providerName ${i.providerName}`))}return n}async getRelatedFilesResponse(r,n,i){Ol.debug(this.context,`Fetching related files for ${r.uri}`);let o=this.context.get(xs).getCapabilities().related??!1;if(t.relatedCapabilityTelemetry(this.context,n,o),!o)return Ol.debug(this.context,"`copilot/related` not supported"),xXe;try{let a=await this.service.connection.sendRequest(bve.type,{textDocument:{uri:r.uri},data:r.data,telemetry:{properties:n.properties,measurements:n.measurements}},i);return this.convert(a)}catch(a){Ol.exception(this.context,a,".copilotRelated");return}}static{this.telemetrySent=!1}static relatedCapabilityTelemetry(r,n,i){try{if(!i||t.telemetrySent)return;t.telemetrySent=!0,Bt(r,"copilotRelated.hasRelatedCapability",n)}catch(o){Ol.exception(r,o,"copilotRelated")}}};d();d();d();var fle=new dt("OAuth Code Flow");function KPe(t,e,r=(n,i)=>n===i){if(t===e)return!0;if(!t||!e||t.length!==e.length)return!1;for(let n=0,i=t.length;n<i;n++)if(!r(t[n],e[n]))return!1;return!0}s(KPe,"arrayEquals");function p1t(t){return t===QP.providerId?{client_id:w0,client_secret:kje}:null}s(p1t,"getClientInfoFromAuthServer");var YPe=`
<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>GitHub Copilot Authentication</title>
        <style>
            body {
                font-family: Arial, sans-serif;
                text-align: center;
                padding: 50px;
            }
            .container {
                display: flex;
                align-items: center;
                justify-content: center;
                text-align: center;
                padding-top: 50px;
            }
            .success {
                font-size: 28px;
                font-weight: 300;
                margin: 0 0 12px 0;
                color: #28a745;
            }
            .error {
                font-size: 28px;
                font-weight: 300;
                margin: 0 0 12px 0;
                color: #cccccc;
            }
            .message {
                font-size: 18px;
                margin: 20px 0;
            }
            .detail {
                font-size: 14px;
                color: #f85149;
                opacity: 0.7;
                margin: 0;
            }

            body.error .success-message {
                display: none;
            }

            body:not(.error) .error-message {
                display: none;
            }
        </style>
    </head>
    <body>
        <div class="container">
            <div class="success-message">
                <h1 class="success">\u2713</h1>
                <h1 class="success">Authentication Successful!</h1>
                <p class="message">You can now return to your IDE and continue using GitHub Copilot.</p>
            </div>
            <div class="error-message">
                <h1 class="error">An error occurred while signing in:</h1>
                <div class="detail"></div>
            </div>
        </div>
        <script>
            const urlParams = new URLSearchParams(window.location.search);

            const error = urlParams.get('error');
            if (error) {
                document.querySelector('.error-message > .detail').textContent = error;
                document.querySelector('body').classList.add('error');
            }
        </script>
    </body>
</html>`;var QP=class t{constructor(e){this.id=t.providerId;this.label="GitHub";this.supportsMultipleAccounts=!1;this.authorizationServers=[t.providerId];this.ctx=e,this._sessionsPromise=this.readSessions().then(r=>(setTimeout(()=>r.forEach(n=>void this.afterSessionLoad(n)),1e3),r))}static{s(this,"GitHubAuthenticationProvider")}static{this.providerId="https://github.com/login/oauth"}async getSessions(e,r){await this.checkSessionsExpiration();let n=await this._sessionsPromise,i=e?.sort()||[];return i.length?n.filter(a=>KPe([...a.scopes].sort(),i)):n}async afterSessionLoad(e){}async readSessions(){let e=await this.ctx.get(yi).read("oauth",this.id);return e||[]}async createSession(e,r){let n=[...e].sort(),i=await this._sessionsPromise,o=await this.tokenToSession(r,e);this.afterSessionLoad(o);let a=i.findIndex(l=>l.account.id===o.account.id&&KPe([...l.scopes].sort(),n)),c=new Array;return a>-1?c.push(...i.splice(a,1,o)):i.push(o),await this.storeSessions(i),o}async storeSessions(e){this._sessionsPromise=Promise.resolve(e),await this.ctx.get(yi).update("oauth",this.id,e)}async tokenToSession(e,r){let n=await this.getUserInfo(e);return{id:crypto.getRandomValues(new Uint32Array(2)).reduce((i,o)=>i+=o.toString(16),""),accessToken:e,account:{label:n.accountName,id:n.id},scopes:r}}async getUserInfo(e){let r="https://api.github.com/user",n;try{n=await this.ctx.get(Or).fetch(new URL(r).href,{method:"GET",headers:{Authorization:`token ${e}`}})}catch(i){return fle.error(this.ctx,"Failed to fetch user info: ",i),{id:"",accountName:""}}if(n.ok)try{let i=await n.json();return{id:`${i.id}`,accountName:i.login}}catch(i){return fle.error(this.ctx,"Failed to fetch user info: ",i),{id:"",accountName:""}}else{let i=n.statusText;try{let o=await n.json();o.message&&(i=o.message)}catch{}return fle.error(this.ctx,"Failed to fetch user info: ",i),{id:"",accountName:""}}}async removeSession(e){let r=await this._sessionsPromise,n=r.findIndex(i=>i.id===e);if(n>-1)r.splice(n,1),await this.storeSessions(r);else throw new Error(`No session with id '${e}' found.`)}async checkSessionsExpiration(){let e=await this._sessionsPromise;if(e.length!==0)for(let r of e)await this.isSessionExpired(r)&&await this.removeSession(r.id)}async isSessionExpired(e){let{accessToken:r}=e,{id:n,accountName:i}=await this.getUserInfo(r);return!n||!i}};var ple=class extends my{constructor(r){super();this._authenticationProviders=new Map;this.ctx=r}static{s(this,"CLSAuthenticationService")}registerAuthenticationProvider(r,n){this._authenticationProviders.set(r,n)}getOrActivateProviderIdForServer(r){for(let n of this._authenticationProviders.values())if(n.authorizationServers?.some(i=>i===r))return Promise.resolve(n.id);return Promise.resolve(void 0)}createAuthenticationProvider(r){if(r===QP.providerId){let n=new QP(this.ctx);return this.registerAuthenticationProvider(n.id,n),n}}getProvider(r){if(this._authenticationProviders.has(r))return this._authenticationProviders.get(r);throw new Error(`No authentication provider '${r}' is currently registered.`)}async getSessions(r,n,i,o=!1){let a=this._authenticationProviders.get(r);if(a){if(i?.authorizationServer){let c=i.authorizationServer;if(!a.authorizationServers?.some(l=>l===c))throw new Error(`The authorization server '${c}' is not supported by the authentication provider '${r}'.`)}return await a.getSessions(n,{...i})}else throw new Error(`No authentication provider '${r}' is currently registered.`)}};d();var m1t=Be(ul());var JPe=new dt("agentCopilotTokenManager"),lSr={type:new m1t.ProtocolRequestType("copilot/token")},mle=class extends nu{constructor(){super(...arguments);this.networkFetcher=new ZG}static{s(this,"AgentCopilotTokenFetcher")}async fetchTokenResult(r,n,i){if(!r.get(xs).getCapabilities().token)return this.networkFetcher.fetchTokenResult(r,n,i);let o=r.get(Nr).connection;try{let a=await o.sendRequest(lSr.type,{force:!1,session:n});if(!a?.envelope)return JPe.debug(r,"Envelope missing from copilot/token response"),{failureKind:"HTTP401",message:"Editor did not return a token"};let{envelope:c,tokenEndpoint:l}=a;if(JPe.debug(r,"Retrieved envelope from copilot/token"),c.expires_at*1e3<Date.now())throw new Sa("Expired token in copilot/token response");return l!==void 0&&WPe(l)!==n.apiUrl&&JPe.exception(r,new Error(`Token endpoint ${l} does not match API URL ${n.apiUrl}`),".fetchTokenResult"),{copilotToken:new a2(c,void 0,c.expires_at)}}catch(a){throw a instanceof Error?new Sa(a.message,a):a}}};d();var uSr=new dt("Public Code References"),hle=class extends kf{static{s(this,"CLSCitationManager")}async handleIPCodeCitation(e,r){let n=r.location?.start.line!==void 0?r.location.start.line+1:"-",i=r.location?.start.character!==void 0?r.location.start.character+1:"-",o=(r.matchingText??"").replace(/[\r\n]/g," ");uSr.info(e,`Text found matching public code in ${r.inDocumentUri} [Ln ${n}, Col ${i}] near ${o}...:`+r.details.map((a,c)=>`
  ${c+1}) [${a.license}] ${a.url}`).join("")),!(r.version===void 0||r.location===void 0)&&e.get(xs).getCapabilities().ipCodeCitation===!0&&await e.get(Nr).connection.sendNotification(hve.type,{uri:r.inDocumentUri,version:r.version,range:r.location,matchingText:r.matchingText??"",citations:r.details})}};d();d();function h1t(t){dSr(t)}s(h1t,"activateExtensibilityPlatformFeature");function dSr(t){t.set(vy,new jae(t)),t.set(K1,new K1(t))}s(dSr,"registerContextDependencies");d();var g1t=x.String(),XPe=class{constructor(e){this.turnContext=e}static{s(this,"BuildLogsSkillProcessor")}value(){return .9}processSkill(e){return this.turnContext.collectLabel(Ale,"build logs"),`The contents of the application build logs:
\`\`\`
${e}
\`\`\``}},Ale="build-logs",gle=class extends wu{static{s(this,"BuildLogsSkill")}constructor(e){super(Ale,"The application build logs, which can be used to fix build or compilation errors.","Reading build logs",()=>e,r=>new XPe(r))}};d();var ZPe=class{constructor(e){this.turnContext=e}static{s(this,"DirectoryReferencesSkillProcessor")}value(){return 1}async processSkill(e){let r=this.filterDirectoryReferences(e);if(r.length===0)return;let n=await Zae(this.turnContext.ctx,this.turnContext.cancelationToken,r);if(n.length>0){let i=[[new Ut(["The user wants you to consider the following directory structures when computing your answer."]),1]];for(let o of n)i.push([new Ut([o]),1]);return new Ut(i)}}filterDirectoryReferences(e){return e.filter(r=>r.type==="directory")}},e5e=class{static{s(this,"DirectoryReferencesSkillResolver")}resolveSkill(e){if(e.turn.request.references&&e.turn.request.references.length>0)return e.turn.request.references}},fSr="directory-references",yle=class{constructor(){this.id=fSr;this.type="implicit"}static{s(this,"DirectoryReferencesSkill")}description(){return"The directory structure from the user's referenced directories"}resolver(){return new e5e}processor(e){return new ZPe(e)}};d();var pSr=x.Object({uri:x.String(),visibleRange:x.Optional(Uc),openedAt:x.Optional(x.String()),activeAt:x.Optional(x.String())}),A1t=x.Object({files:x.Array(pSr)}),mSr=3,t5e=class{constructor(e){this.turnContext=e}static{s(this,"RecentFilesSkillProcessor")}value(){return .7}async processSkill(e){let r=await this.getDocuments(e);if(r.length>0){let n=this.toElidableDocs(r),i=AS(n,"inversePositional");return await this.preElideDocuments(i)}}async getDocuments(e){let r=this.sortFiles(e.files);r=this.filterIncludedDocs(r);let n=this.turnContext.ctx.get(En),i=[];for(let o of r){let a=await n.getOrReadTextDocument(o),c=ca(a);if(await this.turnContext.collectFile(vle,o.uri,c),a.status==="valid"&&c!=="empty"&&(i.push([a.document,o]),i.length===mSr))break}return i.reverse()}sortFiles(e){return e.sort((r,n)=>r.activeAt&&n.activeAt?new Date(r.activeAt).getTime()-new Date(n.activeAt).getTime():r.activeAt?-1:n.activeAt?1:0).reverse()}filterIncludedDocs(e){return e.filter(r=>!this.turnContext.isFileIncluded(r.uri))}toElidableDocs(e){return e.map(r=>{let[n,i]=r,o=this.turnContext.ctx.get(En).getRelativePath(n),a=new H1(n,void 0,i.visibleRange);return new Ut([[`Code excerpt from file \`${o}\`:`,1],[a.fromAllCode({addLineNumbers:!1}),.9]])})}async preElideDocuments(e){let r=(await Wo.getModelConfiguration(this.turnContext.ctx,"user")).maxRequestTokens,n=e.elide(Math.floor(r*.1)).getText();return new Ut([n])}},vle="recent-files",Cle=class extends wu{static{s(this,"RecentFilesSkill")}constructor(e){super(vle,"Provides code examples helpful for creating, explaining, refactoring, or fixing code. It's based on the files the user has worked on in the editor.","Resolving recent files",()=>e,r=>new t5e(r))}};d();var y1t=x.String(),r5e=class{constructor(e){this.turnContext=e}static{s(this,"RuntimeLogsSkillProcessor")}value(){return .9}processSkill(e){return this.turnContext.collectLabel(Ele,"runtime logs"),`The contents of the application runtime logs:
\`\`\`
${e}
\`\`\``}},Ele="runtime-logs",xle=class extends wu{static{s(this,"RuntimeLogsSkill")}constructor(e){super(Ele,"The application runtime or debug logs, which are used to view output logs from the console. This is useful for debugging and troubleshooting runtime issues.","Reading runtime logs",()=>e,r=>new r5e(r))}};d();var ble=Be(wA());var Ile=class extends xl{constructor(r){super();this.ctx=r}static{s(this,"AgentConversationInspector")}shouldInspect(){return Ij(this.ctx)}get connection(){if(this.shouldInspect())return this.ctx.get(Nr).connection}async inspectPrompt(r){return this.connection?.sendNotification(new ble.NotificationType("conversation/inspectPrompt"),r)}async inspectFetchResult(r){return this.connection?.sendNotification(new ble.NotificationType("conversation/inspectFetchResult"),r)}async documentDiff(r){return this.connection?.sendNotification(new ble.NotificationType("conversation/documentDiff"),r)}};d();var C1t=Be(ul());var gH=class{constructor(e){this.ctx=e;this.notificationEndpoint="conversation/preconditionsNotification";e.get(mg).onChange(r=>{this.sendNotification(r)})}static{s(this,"PreconditionsNotifier")}sendNotification(e){return this.ctx.get(Nr).connection.sendNotification(new C1t.NotificationType(this.notificationEndpoint),e)}};function v1t(t){hSr(t),gSr(t),h1t(t)}s(v1t,"activateConversationFeature");function hSr(t){t.set(to,new to(t)),t.set(_u,new _u),t.set(pd,new pd(t)),t.set(ha,new kne(t)),t.set(FE,new FE),t.set(Ns,new Ns(t)),t.set(mg,new mg(t)),t.set(gH,new gH(t)),t.set(If,new KK(t,new zK(t))),t.set(OE,new OE),t.set(hS,new hS),t.set(xl,new Ile(t)),t.set(Ec,new Ec(t)),t.set(fd,new fd),t.set(Am,new Am)}s(hSr,"registerContextDependencies");function gSr(t){let e=new ql;e.registerSkill(new Qse(new Ose(t))),e.registerSkill(new dae(new Hf(t,V1,Jht))),e.registerSkill(new qse(new Hf(t,Ay,$mt))),e.registerSkill(new wse(new Hf(t,ef,ymt))),e.registerSkill(new fae),e.registerSkill(new yle),e.registerSkill(new Cle(new Hf(t,vle,A1t))),e.registerSkill(new Fae(new Hf(t,Y1,xgt))),e.registerSkill(new $se(new Hf(t,yS,Zmt))),e.registerSkill(new xle(new Hf(t,Ele,y1t))),e.registerSkill(new gle(new Hf(t,Ale,g1t))),e.registerSkill(new jse(new Hf(t,yy,eht))),e.registerSkill(new Gse(new Hf(t,xP,rht))),t.set(ql,e)}s(gSr,"registerSkills");d();var x1t=Be(hi());var Tle=class extends cd{static{s(this,"AgentEditProgressReporter")}constructor(e){super(e)}async reportTurn(e,r){await this.ctx.get(Nr).connection.sendProgress(new x1t.ProgressType,e.partialResultToken,[{editConversationId:e.editConversationId,editTurnId:e.editTurnId,...r}])}};d();var E1t=Be(ul()),b1t=Be(wA());var wle=class extends x1{constructor(){super(...arguments);this.requestType=new E1t.ProtocolRequestType("conversation/invokeClientToolConfirmation");this.typeCheck=ta.Compile(Ypt)}static{s(this,"AgentClientToolConfirmationInvoker")}async invokeClientToolConfirmation(r,n){let i=this.ctx.get(Nr).connection,o;try{let a=await i.sendRequest(this.requestType,n),[c,l]=a;if(l){let u=new b1t.ResponseError(l.code,l.message,l.data);throw _r.error(this.ctx,`ResponseError while invoking client tool confirmation ${n.name}`,u),new Error(`Failed to invoke client tool confirmation ${n.name}: ${l.message}`)}o=c}catch(a){throw new Error(`Failed to invoke client tool confirmation ${n.name}: ${String(a)}`)}if(o==null)throw new Error(`Failed to invoke client tool confirmation ${n.name}: No result returned`);if(!this.typeCheck.Check(o))throw new ud(this.typeCheck.Errors(o));return o}};d();var I1t=Be(ul()),T1t=Be(wA());var Sle=class extends Nw{constructor(){super(...arguments);this.requestType=new I1t.ProtocolRequestType("conversation/invokeClientTool");this.typeCheck=ta.Compile(Kpt)}static{s(this,"AgentClientToolInvoker")}async invokeClientTool(r,n){let i=this.ctx.get(Nr).connection,o;try{let a=await i.sendRequest(this.requestType,n),[c,l]=a;if(l){let u=new T1t.ResponseError(l.code,l.message,l.data);throw _r.error(this.ctx,`ResponseError while invoking client tool ${n.name}`,u),new Error(`Failed to invoke client tool ${n.name}: ${l.message}`)}o=c}catch(a){throw new Error(`Failed to invoke client tool ${n.name}: ${String(a)}`)}if(o==null)throw new Error(`Failed to invoke client tool ${n.name}: No result returned`);if(!this.typeCheck.Check(o))throw new ud(this.typeCheck.Errors(o));return this.transformToToolResult(o)}transformToToolResult(r){let n=r.content.map(i=>typeof i.value=="string"?new Oi(i.value):new aP(i.value));return new Ao(n,r.status??"success")}};d();d();function w1t(t,e,r){try{let n=t.get(Mt).javaContextProviderParams(r);if(n){let i=JSON.parse(n);for(let[o,a]of Object.entries(i))e.set(o,a)}}catch(n){return dn.debug(t,"Failed to get the active Java experiments for the Context Provider API",n),!1}return!0}s(w1t,"fillInJavaActiveExperiments");var n5e=Be(wA());var ASr={type:new n5e.NotificationType("featureFlagsNotification")},ySr={type:new n5e.NotificationType("copilot/didChangeFeatureFlags")},AH=class{constructor(e){this.ctx=e;_a(e,r=>this.sendNotification(r))}static{s(this,"FeatureFlagsNotifier")}async sendNotification(e){let r=this.ctx,i=await r.get(Mt).updateExPValuesAndAssignments(e),o={};r.get(Mt).excludeRelatedFiles(i)&&(o.ExcludeRelatedFiles=!0);let a=mxe(r,i);a.length>0&&(o.ExpContextProviders=a);let c=new Map;lJe(r,a,c,i),VX(r,c,i),w1t(r,c,i);for(let[f,p]of c.entries())o[f]=p;let l=r.get(xs),u=r.get(Nr).connection;if(l.getCapabilities().didChangeFeatureFlags)await u.sendNotification(ySr.type,{envelope:{...e.envelope,token:void 0,expires_at:void 0,refresh_in:void 0,user_notification:void 0,limited_user_quotas:void 0,limited_user_reset_date:void 0,error_details:void 0,organization_list:void 0,enterprise_list:void 0,endpoints:void 0},token:e.getTokenValues(),activeExps:o});else{let f={rt:e.getTokenValue("rt")==="1",sn:e.getTokenValue("sn")==="1",chat:e.envelope.chat_enabled??!1,ic:e.envelope.chat_enabled??!1,pc:!0,ae:o};e.getTokenValue("agent_mode")==="0"&&(f.agent_mode=!1),e.getTokenValue("mcp")==="0"&&(f.mcp=!1),e.envelope.xcode_chat&&e.envelope.chat_enabled&&(f.xc=!0),await u.sendNotification(ASr.type,f)}}};d();var _le=class extends qo{constructor(r){super();this.ctx=r;this.notificationEndpoint="statusNotification"}static{s(this,"NotificationStatusReporter")}didChange(r){let n=r.kind;r.busy&&n!=="Error"&&(n="InProgress"),this.ctx.get(Nr).connection.sendNotification(Ive.type,{busy:r.busy,kind:r.kind,status:n,message:r.message??""}),this.ctx.get(Nr).connection.sendNotification("didChangeStatus",{busy:r.busy,kind:r.kind,message:r.message})}};d();var S1t=new $M;d();d();d();var _n=new dt("CopilotMCP");async function i5e(t,e){await t.get(ny).notifyLog(e)}s(i5e,"notifyMCPRuntimeLog");async function hd(t,e){await i5e(t,{...e,level:"error"})}s(hd,"notifyMCPRuntimeError");async function UP(t,e){await i5e(t,{...e,level:"warning"})}s(UP,"notifyMCPRuntimeWarning");async function Qa(t,e){await i5e(t,{...e,level:"info"})}s(Qa,"notifyMCPRuntimeInfo");d();d();var No;(function(t){t.assertEqual=i=>i;function e(i){}s(e,"assertIs"),t.assertIs=e;function r(i){throw new Error}s(r,"assertNever"),t.assertNever=r,t.arrayToEnum=i=>{let o={};for(let a of i)o[a]=a;return o},t.getValidEnumValues=i=>{let o=t.objectKeys(i).filter(c=>typeof i[i[c]]!="number"),a={};for(let c of o)a[c]=i[c];return t.objectValues(a)},t.objectValues=i=>t.objectKeys(i).map(function(o){return i[o]}),t.objectKeys=typeof Object.keys=="function"?i=>Object.keys(i):i=>{let o=[];for(let a in i)Object.prototype.hasOwnProperty.call(i,a)&&o.push(a);return o},t.find=(i,o)=>{for(let a of i)if(o(a))return a},t.isInteger=typeof Number.isInteger=="function"?i=>Number.isInteger(i):i=>typeof i=="number"&&isFinite(i)&&Math.floor(i)===i;function n(i,o=" | "){return i.map(a=>typeof a=="string"?`'${a}'`:a).join(o)}s(n,"joinValues"),t.joinValues=n,t.jsonStringifyReplacer=(i,o)=>typeof o=="bigint"?o.toString():o})(No||(No={}));var s5e;(function(t){t.mergeShapes=(e,r)=>({...e,...r})})(s5e||(s5e={}));var Rr=No.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),WE=s(t=>{switch(typeof t){case"undefined":return Rr.undefined;case"string":return Rr.string;case"number":return isNaN(t)?Rr.nan:Rr.number;case"boolean":return Rr.boolean;case"function":return Rr.function;case"bigint":return Rr.bigint;case"symbol":return Rr.symbol;case"object":return Array.isArray(t)?Rr.array:t===null?Rr.null:t.then&&typeof t.then=="function"&&t.catch&&typeof t.catch=="function"?Rr.promise:typeof Map<"u"&&t instanceof Map?Rr.map:typeof Set<"u"&&t instanceof Set?Rr.set:typeof Date<"u"&&t instanceof Date?Rr.date:Rr.object;default:return Rr.unknown}},"getParsedType"),Ot=No.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),CSr=s(t=>JSON.stringify(t,null,2).replace(/"([^"]+)":/g,"$1:"),"quotelessJson"),vm=class t extends Error{static{s(this,"ZodError")}get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=n=>{this.issues=[...this.issues,n]},this.addIssues=(n=[])=>{this.issues=[...this.issues,...n]};let r=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,r):this.__proto__=r,this.name="ZodError",this.issues=e}format(e){let r=e||function(o){return o.message},n={_errors:[]},i=s(o=>{for(let a of o.issues)if(a.code==="invalid_union")a.unionErrors.map(i);else if(a.code==="invalid_return_type")i(a.returnTypeError);else if(a.code==="invalid_arguments")i(a.argumentsError);else if(a.path.length===0)n._errors.push(r(a));else{let c=n,l=0;for(;l<a.path.length;){let u=a.path[l];l===a.path.length-1?(c[u]=c[u]||{_errors:[]},c[u]._errors.push(r(a))):c[u]=c[u]||{_errors:[]},c=c[u],l++}}},"processError");return i(this),n}static assert(e){if(!(e instanceof t))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,No.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=r=>r.message){let r={},n=[];for(let i of this.issues)i.path.length>0?(r[i.path[0]]=r[i.path[0]]||[],r[i.path[0]].push(e(i))):n.push(e(i));return{formErrors:n,fieldErrors:r}}get formErrors(){return this.flatten()}};vm.create=t=>new vm(t);var GM=s((t,e)=>{let r;switch(t.code){case Ot.invalid_type:t.received===Rr.undefined?r="Required":r=`Expected ${t.expected}, received ${t.received}`;break;case Ot.invalid_literal:r=`Invalid literal value, expected ${JSON.stringify(t.expected,No.jsonStringifyReplacer)}`;break;case Ot.unrecognized_keys:r=`Unrecognized key(s) in object: ${No.joinValues(t.keys,", ")}`;break;case Ot.invalid_union:r="Invalid input";break;case Ot.invalid_union_discriminator:r=`Invalid discriminator value. Expected ${No.joinValues(t.options)}`;break;case Ot.invalid_enum_value:r=`Invalid enum value. Expected ${No.joinValues(t.options)}, received '${t.received}'`;break;case Ot.invalid_arguments:r="Invalid function arguments";break;case Ot.invalid_return_type:r="Invalid function return type";break;case Ot.invalid_date:r="Invalid date";break;case Ot.invalid_string:typeof t.validation=="object"?"includes"in t.validation?(r=`Invalid input: must include "${t.validation.includes}"`,typeof t.validation.position=="number"&&(r=`${r} at one or more positions greater than or equal to ${t.validation.position}`)):"startsWith"in t.validation?r=`Invalid input: must start with "${t.validation.startsWith}"`:"endsWith"in t.validation?r=`Invalid input: must end with "${t.validation.endsWith}"`:No.assertNever(t.validation):t.validation!=="regex"?r=`Invalid ${t.validation}`:r="Invalid";break;case Ot.too_small:t.type==="array"?r=`Array must contain ${t.exact?"exactly":t.inclusive?"at least":"more than"} ${t.minimum} element(s)`:t.type==="string"?r=`String must contain ${t.exact?"exactly":t.inclusive?"at least":"over"} ${t.minimum} character(s)`:t.type==="number"?r=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="date"?r=`Date must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(t.minimum))}`:r="Invalid input";break;case Ot.too_big:t.type==="array"?r=`Array must contain ${t.exact?"exactly":t.inclusive?"at most":"less than"} ${t.maximum} element(s)`:t.type==="string"?r=`String must contain ${t.exact?"exactly":t.inclusive?"at most":"under"} ${t.maximum} character(s)`:t.type==="number"?r=`Number must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="bigint"?r=`BigInt must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="date"?r=`Date must be ${t.exact?"exactly":t.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(t.maximum))}`:r="Invalid input";break;case Ot.custom:r="Invalid input";break;case Ot.invalid_intersection_types:r="Intersection results could not be merged";break;case Ot.not_multiple_of:r=`Number must be a multiple of ${t.multipleOf}`;break;case Ot.not_finite:r="Number must be finite";break;default:r=e.defaultError,No.assertNever(t)}return{message:r}},"errorMap"),P1t=GM;function vSr(t){P1t=t}s(vSr,"setErrorMap");function Rle(){return P1t}s(Rle,"getErrorMap");var kle=s(t=>{let{data:e,path:r,errorMaps:n,issueData:i}=t,o=[...r,...i.path||[]],a={...i,path:o};if(i.message!==void 0)return{...i,path:o,message:i.message};let c="",l=n.filter(u=>!!u).slice().reverse();for(let u of l)c=u(a,{data:e,defaultError:c}).message;return{...i,path:o,message:c}},"makeIssue"),xSr=[];function gr(t,e){let r=Rle(),n=kle({issueData:e,data:t.data,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,r,r===GM?void 0:GM].filter(i=>!!i)});t.common.issues.push(n)}s(gr,"addIssueToContext");var of=class t{static{s(this,"ParseStatus")}constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,r){let n=[];for(let i of r){if(i.status==="aborted")return Yn;i.status==="dirty"&&e.dirty(),n.push(i.value)}return{status:e.value,value:n}}static async mergeObjectAsync(e,r){let n=[];for(let i of r){let o=await i.key,a=await i.value;n.push({key:o,value:a})}return t.mergeObjectSync(e,n)}static mergeObjectSync(e,r){let n={};for(let i of r){let{key:o,value:a}=i;if(o.status==="aborted"||a.status==="aborted")return Yn;o.status==="dirty"&&e.dirty(),a.status==="dirty"&&e.dirty(),o.value!=="__proto__"&&(typeof a.value<"u"||i.alwaysSet)&&(n[o.value]=a.value)}return{status:e.value,value:n}}},Yn=Object.freeze({status:"aborted"}),jM=s(t=>({status:"dirty",value:t}),"DIRTY"),Wf=s(t=>({status:"valid",value:t}),"OK"),a5e=s(t=>t.status==="aborted","isAborted"),c5e=s(t=>t.status==="dirty","isDirty"),qP=s(t=>t.status==="valid","isValid"),vH=s(t=>typeof Promise<"u"&&t instanceof Promise,"isAsync");function Ple(t,e,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(t):n?n.value:e.get(t)}s(Ple,"__classPrivateFieldGet");function D1t(t,e,r,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!i:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(t,r):i?i.value=r:e.set(t,r),r}s(D1t,"__classPrivateFieldSet");var tn;(function(t){t.errToObj=e=>typeof e=="string"?{message:e}:e||{},t.toString=e=>typeof e=="string"?e:e?.message})(tn||(tn={}));var yH,CH,yg=class{static{s(this,"ParseInputLazyPath")}constructor(e,r,n,i){this._cachedPath=[],this.parent=e,this.data=r,this._path=n,this._key=i}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}},_1t=s((t,e)=>{if(qP(e))return{success:!0,data:e.value};if(!t.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;let r=new vm(t.common.issues);return this._error=r,this._error}}},"handleResult");function Ci(t){if(!t)return{};let{errorMap:e,invalid_type_error:r,required_error:n,description:i}=t;if(e&&(r||n))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:i}:{errorMap:s((a,c)=>{var l,u;let{message:f}=t;return a.code==="invalid_enum_value"?{message:f??c.defaultError}:typeof c.data>"u"?{message:(l=f??n)!==null&&l!==void 0?l:c.defaultError}:a.code!=="invalid_type"?{message:c.defaultError}:{message:(u=f??r)!==null&&u!==void 0?u:c.defaultError}},"customMap"),description:i}}s(Ci,"processCreateParams");var vi=class{static{s(this,"ZodType")}get description(){return this._def.description}_getType(e){return WE(e.data)}_getOrReturnCtx(e,r){return r||{common:e.parent.common,data:e.data,parsedType:WE(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new of,ctx:{common:e.parent.common,data:e.data,parsedType:WE(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){let r=this._parse(e);if(vH(r))throw new Error("Synchronous parse encountered promise.");return r}_parseAsync(e){let r=this._parse(e);return Promise.resolve(r)}parse(e,r){let n=this.safeParse(e,r);if(n.success)return n.data;throw n.error}safeParse(e,r){var n;let i={common:{issues:[],async:(n=r?.async)!==null&&n!==void 0?n:!1,contextualErrorMap:r?.errorMap},path:r?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:WE(e)},o=this._parseSync({data:e,path:i.path,parent:i});return _1t(i,o)}"~validate"(e){var r,n;let i={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:WE(e)};if(!this["~standard"].async)try{let o=this._parseSync({data:e,path:[],parent:i});return qP(o)?{value:o.value}:{issues:i.common.issues}}catch(o){!((n=(r=o?.message)===null||r===void 0?void 0:r.toLowerCase())===null||n===void 0)&&n.includes("encountered")&&(this["~standard"].async=!0),i.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:i}).then(o=>qP(o)?{value:o.value}:{issues:i.common.issues})}async parseAsync(e,r){let n=await this.safeParseAsync(e,r);if(n.success)return n.data;throw n.error}async safeParseAsync(e,r){let n={common:{issues:[],contextualErrorMap:r?.errorMap,async:!0},path:r?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:WE(e)},i=this._parse({data:e,path:n.path,parent:n}),o=await(vH(i)?i:Promise.resolve(i));return _1t(n,o)}refine(e,r){let n=s(i=>typeof r=="string"||typeof r>"u"?{message:r}:typeof r=="function"?r(i):r,"getIssueProperties");return this._refinement((i,o)=>{let a=e(i),c=s(()=>o.addIssue({code:Ot.custom,...n(i)}),"setError");return typeof Promise<"u"&&a instanceof Promise?a.then(l=>l?!0:(c(),!1)):a?!0:(c(),!1)})}refinement(e,r){return this._refinement((n,i)=>e(n)?!0:(i.addIssue(typeof r=="function"?r(n,i):r),!1))}_refinement(e){return new xm({schema:this,typeName:Wn.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:s(r=>this["~validate"](r),"validate")}}optional(){return Ag.create(this,this._def)}nullable(){return rv.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return GE.create(this)}promise(){return NS.create(this,this._def)}or(e){return zP.create([this,e],this._def)}and(e){return KP.create(this,e,this._def)}transform(e){return new xm({...Ci(this._def),schema:this,typeName:Wn.ZodEffects,effect:{type:"transform",transform:e}})}default(e){let r=typeof e=="function"?e:()=>e;return new e5({...Ci(this._def),innerType:this,defaultValue:r,typeName:Wn.ZodDefault})}brand(){return new xH({typeName:Wn.ZodBranded,type:this,...Ci(this._def)})}catch(e){let r=typeof e=="function"?e:()=>e;return new t5({...Ci(this._def),innerType:this,catchValue:r,typeName:Wn.ZodCatch})}describe(e){let r=this.constructor;return new r({...this._def,description:e})}pipe(e){return EH.create(this,e)}readonly(){return r5.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}},ESr=/^c[^\s-]{8,}$/i,bSr=/^[0-9a-z]+$/,ISr=/^[0-9A-HJKMNP-TV-Z]{26}$/i,TSr=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,wSr=/^[a-z0-9_-]{21}$/i,SSr=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,_Sr=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,RSr=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,kSr="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$",o5e,PSr=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,DSr=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,BSr=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,NSr=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,MSr=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,LSr=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,B1t="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",FSr=new RegExp(`^${B1t}$`);function N1t(t){let e="([01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d";return t.precision?e=`${e}\\.\\d{${t.precision}}`:t.precision==null&&(e=`${e}(\\.\\d+)?`),e}s(N1t,"timeRegexSource");function OSr(t){return new RegExp(`^${N1t(t)}$`)}s(OSr,"timeRegex");function M1t(t){let e=`${B1t}T${N1t(t)}`,r=[];return r.push(t.local?"Z?":"Z"),t.offset&&r.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${r.join("|")})`,new RegExp(`^${e}$`)}s(M1t,"datetimeRegex");function QSr(t,e){return!!((e==="v4"||!e)&&PSr.test(t)||(e==="v6"||!e)&&BSr.test(t))}s(QSr,"isValidIP");function USr(t,e){if(!SSr.test(t))return!1;try{let[r]=t.split("."),n=r.replace(/-/g,"+").replace(/_/g,"/").padEnd(r.length+(4-r.length%4)%4,"="),i=JSON.parse(atob(n));return!(typeof i!="object"||i===null||!i.typ||!i.alg||e&&i.alg!==e)}catch{return!1}}s(USr,"isValidJWT");function qSr(t,e){return!!((e==="v4"||!e)&&DSr.test(t)||(e==="v6"||!e)&&NSr.test(t))}s(qSr,"isValidCidr");var DS=class t extends vi{static{s(this,"ZodString")}_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==Rr.string){let o=this._getOrReturnCtx(e);return gr(o,{code:Ot.invalid_type,expected:Rr.string,received:o.parsedType}),Yn}let n=new of,i;for(let o of this._def.checks)if(o.kind==="min")e.data.length<o.value&&(i=this._getOrReturnCtx(e,i),gr(i,{code:Ot.too_small,minimum:o.value,type:"string",inclusive:!0,exact:!1,message:o.message}),n.dirty());else if(o.kind==="max")e.data.length>o.value&&(i=this._getOrReturnCtx(e,i),gr(i,{code:Ot.too_big,maximum:o.value,type:"string",inclusive:!0,exact:!1,message:o.message}),n.dirty());else if(o.kind==="length"){let a=e.data.length>o.value,c=e.data.length<o.value;(a||c)&&(i=this._getOrReturnCtx(e,i),a?gr(i,{code:Ot.too_big,maximum:o.value,type:"string",inclusive:!0,exact:!0,message:o.message}):c&&gr(i,{code:Ot.too_small,minimum:o.value,type:"string",inclusive:!0,exact:!0,message:o.message}),n.dirty())}else if(o.kind==="email")RSr.test(e.data)||(i=this._getOrReturnCtx(e,i),gr(i,{validation:"email",code:Ot.invalid_string,message:o.message}),n.dirty());else if(o.kind==="emoji")o5e||(o5e=new RegExp(kSr,"u")),o5e.test(e.data)||(i=this._getOrReturnCtx(e,i),gr(i,{validation:"emoji",code:Ot.invalid_string,message:o.message}),n.dirty());else if(o.kind==="uuid")TSr.test(e.data)||(i=this._getOrReturnCtx(e,i),gr(i,{validation:"uuid",code:Ot.invalid_string,message:o.message}),n.dirty());else if(o.kind==="nanoid")wSr.test(e.data)||(i=this._getOrReturnCtx(e,i),gr(i,{validation:"nanoid",code:Ot.invalid_string,message:o.message}),n.dirty());else if(o.kind==="cuid")ESr.test(e.data)||(i=this._getOrReturnCtx(e,i),gr(i,{validation:"cuid",code:Ot.invalid_string,message:o.message}),n.dirty());else if(o.kind==="cuid2")bSr.test(e.data)||(i=this._getOrReturnCtx(e,i),gr(i,{validation:"cuid2",code:Ot.invalid_string,message:o.message}),n.dirty());else if(o.kind==="ulid")ISr.test(e.data)||(i=this._getOrReturnCtx(e,i),gr(i,{validation:"ulid",code:Ot.invalid_string,message:o.message}),n.dirty());else if(o.kind==="url")try{new URL(e.data)}catch{i=this._getOrReturnCtx(e,i),gr(i,{validation:"url",code:Ot.invalid_string,message:o.message}),n.dirty()}else o.kind==="regex"?(o.regex.lastIndex=0,o.regex.test(e.data)||(i=this._getOrReturnCtx(e,i),gr(i,{validation:"regex",code:Ot.invalid_string,message:o.message}),n.dirty())):o.kind==="trim"?e.data=e.data.trim():o.kind==="includes"?e.data.includes(o.value,o.position)||(i=this._getOrReturnCtx(e,i),gr(i,{code:Ot.invalid_string,validation:{includes:o.value,position:o.position},message:o.message}),n.dirty()):o.kind==="toLowerCase"?e.data=e.data.toLowerCase():o.kind==="toUpperCase"?e.data=e.data.toUpperCase():o.kind==="startsWith"?e.data.startsWith(o.value)||(i=this._getOrReturnCtx(e,i),gr(i,{code:Ot.invalid_string,validation:{startsWith:o.value},message:o.message}),n.dirty()):o.kind==="endsWith"?e.data.endsWith(o.value)||(i=this._getOrReturnCtx(e,i),gr(i,{code:Ot.invalid_string,validation:{endsWith:o.value},message:o.message}),n.dirty()):o.kind==="datetime"?M1t(o).test(e.data)||(i=this._getOrReturnCtx(e,i),gr(i,{code:Ot.invalid_string,validation:"datetime",message:o.message}),n.dirty()):o.kind==="date"?FSr.test(e.data)||(i=this._getOrReturnCtx(e,i),gr(i,{code:Ot.invalid_string,validation:"date",message:o.message}),n.dirty()):o.kind==="time"?OSr(o).test(e.data)||(i=this._getOrReturnCtx(e,i),gr(i,{code:Ot.invalid_string,validation:"time",message:o.message}),n.dirty()):o.kind==="duration"?_Sr.test(e.data)||(i=this._getOrReturnCtx(e,i),gr(i,{validation:"duration",code:Ot.invalid_string,message:o.message}),n.dirty()):o.kind==="ip"?QSr(e.data,o.version)||(i=this._getOrReturnCtx(e,i),gr(i,{validation:"ip",code:Ot.invalid_string,message:o.message}),n.dirty()):o.kind==="jwt"?USr(e.data,o.alg)||(i=this._getOrReturnCtx(e,i),gr(i,{validation:"jwt",code:Ot.invalid_string,message:o.message}),n.dirty()):o.kind==="cidr"?qSr(e.data,o.version)||(i=this._getOrReturnCtx(e,i),gr(i,{validation:"cidr",code:Ot.invalid_string,message:o.message}),n.dirty()):o.kind==="base64"?MSr.test(e.data)||(i=this._getOrReturnCtx(e,i),gr(i,{validation:"base64",code:Ot.invalid_string,message:o.message}),n.dirty()):o.kind==="base64url"?LSr.test(e.data)||(i=this._getOrReturnCtx(e,i),gr(i,{validation:"base64url",code:Ot.invalid_string,message:o.message}),n.dirty()):No.assertNever(o);return{status:n.value,value:e.data}}_regex(e,r,n){return this.refinement(i=>e.test(i),{validation:r,code:Ot.invalid_string,...tn.errToObj(n)})}_addCheck(e){return new t({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...tn.errToObj(e)})}url(e){return this._addCheck({kind:"url",...tn.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...tn.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...tn.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...tn.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...tn.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...tn.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...tn.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...tn.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...tn.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...tn.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...tn.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...tn.errToObj(e)})}datetime(e){var r,n;return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof e?.precision>"u"?null:e?.precision,offset:(r=e?.offset)!==null&&r!==void 0?r:!1,local:(n=e?.local)!==null&&n!==void 0?n:!1,...tn.errToObj(e?.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof e?.precision>"u"?null:e?.precision,...tn.errToObj(e?.message)})}duration(e){return this._addCheck({kind:"duration",...tn.errToObj(e)})}regex(e,r){return this._addCheck({kind:"regex",regex:e,...tn.errToObj(r)})}includes(e,r){return this._addCheck({kind:"includes",value:e,position:r?.position,...tn.errToObj(r?.message)})}startsWith(e,r){return this._addCheck({kind:"startsWith",value:e,...tn.errToObj(r)})}endsWith(e,r){return this._addCheck({kind:"endsWith",value:e,...tn.errToObj(r)})}min(e,r){return this._addCheck({kind:"min",value:e,...tn.errToObj(r)})}max(e,r){return this._addCheck({kind:"max",value:e,...tn.errToObj(r)})}length(e,r){return this._addCheck({kind:"length",value:e,...tn.errToObj(r)})}nonempty(e){return this.min(1,tn.errToObj(e))}trim(){return new t({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new t({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new t({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isCIDR(){return!!this._def.checks.find(e=>e.kind==="cidr")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get isBase64url(){return!!this._def.checks.find(e=>e.kind==="base64url")}get minLength(){let e=null;for(let r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e}get maxLength(){let e=null;for(let r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e}};DS.create=t=>{var e;return new DS({checks:[],typeName:Wn.ZodString,coerce:(e=t?.coerce)!==null&&e!==void 0?e:!1,...Ci(t)})};function HSr(t,e){let r=(t.toString().split(".")[1]||"").length,n=(e.toString().split(".")[1]||"").length,i=r>n?r:n,o=parseInt(t.toFixed(i).replace(".","")),a=parseInt(e.toFixed(i).replace(".",""));return o%a/Math.pow(10,i)}s(HSr,"floatSafeRemainder");var HP=class t extends vi{static{s(this,"ZodNumber")}constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==Rr.number){let o=this._getOrReturnCtx(e);return gr(o,{code:Ot.invalid_type,expected:Rr.number,received:o.parsedType}),Yn}let n,i=new of;for(let o of this._def.checks)o.kind==="int"?No.isInteger(e.data)||(n=this._getOrReturnCtx(e,n),gr(n,{code:Ot.invalid_type,expected:"integer",received:"float",message:o.message}),i.dirty()):o.kind==="min"?(o.inclusive?e.data<o.value:e.data<=o.value)&&(n=this._getOrReturnCtx(e,n),gr(n,{code:Ot.too_small,minimum:o.value,type:"number",inclusive:o.inclusive,exact:!1,message:o.message}),i.dirty()):o.kind==="max"?(o.inclusive?e.data>o.value:e.data>=o.value)&&(n=this._getOrReturnCtx(e,n),gr(n,{code:Ot.too_big,maximum:o.value,type:"number",inclusive:o.inclusive,exact:!1,message:o.message}),i.dirty()):o.kind==="multipleOf"?HSr(e.data,o.value)!==0&&(n=this._getOrReturnCtx(e,n),gr(n,{code:Ot.not_multiple_of,multipleOf:o.value,message:o.message}),i.dirty()):o.kind==="finite"?Number.isFinite(e.data)||(n=this._getOrReturnCtx(e,n),gr(n,{code:Ot.not_finite,message:o.message}),i.dirty()):No.assertNever(o);return{status:i.value,value:e.data}}gte(e,r){return this.setLimit("min",e,!0,tn.toString(r))}gt(e,r){return this.setLimit("min",e,!1,tn.toString(r))}lte(e,r){return this.setLimit("max",e,!0,tn.toString(r))}lt(e,r){return this.setLimit("max",e,!1,tn.toString(r))}setLimit(e,r,n,i){return new t({...this._def,checks:[...this._def.checks,{kind:e,value:r,inclusive:n,message:tn.toString(i)}]})}_addCheck(e){return new t({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:tn.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:tn.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:tn.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:tn.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:tn.toString(e)})}multipleOf(e,r){return this._addCheck({kind:"multipleOf",value:e,message:tn.toString(r)})}finite(e){return this._addCheck({kind:"finite",message:tn.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:tn.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:tn.toString(e)})}get minValue(){let e=null;for(let r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e}get maxValue(){let e=null;for(let r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&No.isInteger(e.value))}get isFinite(){let e=null,r=null;for(let n of this._def.checks){if(n.kind==="finite"||n.kind==="int"||n.kind==="multipleOf")return!0;n.kind==="min"?(r===null||n.value>r)&&(r=n.value):n.kind==="max"&&(e===null||n.value<e)&&(e=n.value)}return Number.isFinite(r)&&Number.isFinite(e)}};HP.create=t=>new HP({checks:[],typeName:Wn.ZodNumber,coerce:t?.coerce||!1,...Ci(t)});var $P=class t extends vi{static{s(this,"ZodBigInt")}constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce)try{e.data=BigInt(e.data)}catch{return this._getInvalidInput(e)}if(this._getType(e)!==Rr.bigint)return this._getInvalidInput(e);let n,i=new of;for(let o of this._def.checks)o.kind==="min"?(o.inclusive?e.data<o.value:e.data<=o.value)&&(n=this._getOrReturnCtx(e,n),gr(n,{code:Ot.too_small,type:"bigint",minimum:o.value,inclusive:o.inclusive,message:o.message}),i.dirty()):o.kind==="max"?(o.inclusive?e.data>o.value:e.data>=o.value)&&(n=this._getOrReturnCtx(e,n),gr(n,{code:Ot.too_big,type:"bigint",maximum:o.value,inclusive:o.inclusive,message:o.message}),i.dirty()):o.kind==="multipleOf"?e.data%o.value!==BigInt(0)&&(n=this._getOrReturnCtx(e,n),gr(n,{code:Ot.not_multiple_of,multipleOf:o.value,message:o.message}),i.dirty()):No.assertNever(o);return{status:i.value,value:e.data}}_getInvalidInput(e){let r=this._getOrReturnCtx(e);return gr(r,{code:Ot.invalid_type,expected:Rr.bigint,received:r.parsedType}),Yn}gte(e,r){return this.setLimit("min",e,!0,tn.toString(r))}gt(e,r){return this.setLimit("min",e,!1,tn.toString(r))}lte(e,r){return this.setLimit("max",e,!0,tn.toString(r))}lt(e,r){return this.setLimit("max",e,!1,tn.toString(r))}setLimit(e,r,n,i){return new t({...this._def,checks:[...this._def.checks,{kind:e,value:r,inclusive:n,message:tn.toString(i)}]})}_addCheck(e){return new t({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:tn.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:tn.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:tn.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:tn.toString(e)})}multipleOf(e,r){return this._addCheck({kind:"multipleOf",value:e,message:tn.toString(r)})}get minValue(){let e=null;for(let r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e}get maxValue(){let e=null;for(let r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e}};$P.create=t=>{var e;return new $P({checks:[],typeName:Wn.ZodBigInt,coerce:(e=t?.coerce)!==null&&e!==void 0?e:!1,...Ci(t)})};var WP=class extends vi{static{s(this,"ZodBoolean")}_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==Rr.boolean){let n=this._getOrReturnCtx(e);return gr(n,{code:Ot.invalid_type,expected:Rr.boolean,received:n.parsedType}),Yn}return Wf(e.data)}};WP.create=t=>new WP({typeName:Wn.ZodBoolean,coerce:t?.coerce||!1,...Ci(t)});var jP=class t extends vi{static{s(this,"ZodDate")}_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==Rr.date){let o=this._getOrReturnCtx(e);return gr(o,{code:Ot.invalid_type,expected:Rr.date,received:o.parsedType}),Yn}if(isNaN(e.data.getTime())){let o=this._getOrReturnCtx(e);return gr(o,{code:Ot.invalid_date}),Yn}let n=new of,i;for(let o of this._def.checks)o.kind==="min"?e.data.getTime()<o.value&&(i=this._getOrReturnCtx(e,i),gr(i,{code:Ot.too_small,message:o.message,inclusive:!0,exact:!1,minimum:o.value,type:"date"}),n.dirty()):o.kind==="max"?e.data.getTime()>o.value&&(i=this._getOrReturnCtx(e,i),gr(i,{code:Ot.too_big,message:o.message,inclusive:!0,exact:!1,maximum:o.value,type:"date"}),n.dirty()):No.assertNever(o);return{status:n.value,value:new Date(e.data.getTime())}}_addCheck(e){return new t({...this._def,checks:[...this._def.checks,e]})}min(e,r){return this._addCheck({kind:"min",value:e.getTime(),message:tn.toString(r)})}max(e,r){return this._addCheck({kind:"max",value:e.getTime(),message:tn.toString(r)})}get minDate(){let e=null;for(let r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(let r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e!=null?new Date(e):null}};jP.create=t=>new jP({checks:[],coerce:t?.coerce||!1,typeName:Wn.ZodDate,...Ci(t)});var VM=class extends vi{static{s(this,"ZodSymbol")}_parse(e){if(this._getType(e)!==Rr.symbol){let n=this._getOrReturnCtx(e);return gr(n,{code:Ot.invalid_type,expected:Rr.symbol,received:n.parsedType}),Yn}return Wf(e.data)}};VM.create=t=>new VM({typeName:Wn.ZodSymbol,...Ci(t)});var GP=class extends vi{static{s(this,"ZodUndefined")}_parse(e){if(this._getType(e)!==Rr.undefined){let n=this._getOrReturnCtx(e);return gr(n,{code:Ot.invalid_type,expected:Rr.undefined,received:n.parsedType}),Yn}return Wf(e.data)}};GP.create=t=>new GP({typeName:Wn.ZodUndefined,...Ci(t)});var VP=class extends vi{static{s(this,"ZodNull")}_parse(e){if(this._getType(e)!==Rr.null){let n=this._getOrReturnCtx(e);return gr(n,{code:Ot.invalid_type,expected:Rr.null,received:n.parsedType}),Yn}return Wf(e.data)}};VP.create=t=>new VP({typeName:Wn.ZodNull,...Ci(t)});var BS=class extends vi{static{s(this,"ZodAny")}constructor(){super(...arguments),this._any=!0}_parse(e){return Wf(e.data)}};BS.create=t=>new BS({typeName:Wn.ZodAny,...Ci(t)});var jE=class extends vi{static{s(this,"ZodUnknown")}constructor(){super(...arguments),this._unknown=!0}_parse(e){return Wf(e.data)}};jE.create=t=>new jE({typeName:Wn.ZodUnknown,...Ci(t)});var Ty=class extends vi{static{s(this,"ZodNever")}_parse(e){let r=this._getOrReturnCtx(e);return gr(r,{code:Ot.invalid_type,expected:Rr.never,received:r.parsedType}),Yn}};Ty.create=t=>new Ty({typeName:Wn.ZodNever,...Ci(t)});var zM=class extends vi{static{s(this,"ZodVoid")}_parse(e){if(this._getType(e)!==Rr.undefined){let n=this._getOrReturnCtx(e);return gr(n,{code:Ot.invalid_type,expected:Rr.void,received:n.parsedType}),Yn}return Wf(e.data)}};zM.create=t=>new zM({typeName:Wn.ZodVoid,...Ci(t)});var GE=class t extends vi{static{s(this,"ZodArray")}_parse(e){let{ctx:r,status:n}=this._processInputParams(e),i=this._def;if(r.parsedType!==Rr.array)return gr(r,{code:Ot.invalid_type,expected:Rr.array,received:r.parsedType}),Yn;if(i.exactLength!==null){let a=r.data.length>i.exactLength.value,c=r.data.length<i.exactLength.value;(a||c)&&(gr(r,{code:a?Ot.too_big:Ot.too_small,minimum:c?i.exactLength.value:void 0,maximum:a?i.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:i.exactLength.message}),n.dirty())}if(i.minLength!==null&&r.data.length<i.minLength.value&&(gr(r,{code:Ot.too_small,minimum:i.minLength.value,type:"array",inclusive:!0,exact:!1,message:i.minLength.message}),n.dirty()),i.maxLength!==null&&r.data.length>i.maxLength.value&&(gr(r,{code:Ot.too_big,maximum:i.maxLength.value,type:"array",inclusive:!0,exact:!1,message:i.maxLength.message}),n.dirty()),r.common.async)return Promise.all([...r.data].map((a,c)=>i.type._parseAsync(new yg(r,a,r.path,c)))).then(a=>of.mergeArray(n,a));let o=[...r.data].map((a,c)=>i.type._parseSync(new yg(r,a,r.path,c)));return of.mergeArray(n,o)}get element(){return this._def.type}min(e,r){return new t({...this._def,minLength:{value:e,message:tn.toString(r)}})}max(e,r){return new t({...this._def,maxLength:{value:e,message:tn.toString(r)}})}length(e,r){return new t({...this._def,exactLength:{value:e,message:tn.toString(r)}})}nonempty(e){return this.min(1,e)}};GE.create=(t,e)=>new GE({type:t,minLength:null,maxLength:null,exactLength:null,typeName:Wn.ZodArray,...Ci(e)});function WM(t){if(t instanceof Zp){let e={};for(let r in t.shape){let n=t.shape[r];e[r]=Ag.create(WM(n))}return new Zp({...t._def,shape:s(()=>e,"shape")})}else return t instanceof GE?new GE({...t._def,type:WM(t.element)}):t instanceof Ag?Ag.create(WM(t.unwrap())):t instanceof rv?rv.create(WM(t.unwrap())):t instanceof tv?tv.create(t.items.map(e=>WM(e))):t}s(WM,"deepPartialify");var Zp=class t extends vi{static{s(this,"ZodObject")}constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;let e=this._def.shape(),r=No.objectKeys(e);return this._cached={shape:e,keys:r}}_parse(e){if(this._getType(e)!==Rr.object){let u=this._getOrReturnCtx(e);return gr(u,{code:Ot.invalid_type,expected:Rr.object,received:u.parsedType}),Yn}let{status:n,ctx:i}=this._processInputParams(e),{shape:o,keys:a}=this._getCached(),c=[];if(!(this._def.catchall instanceof Ty&&this._def.unknownKeys==="strip"))for(let u in i.data)a.includes(u)||c.push(u);let l=[];for(let u of a){let f=o[u],p=i.data[u];l.push({key:{status:"valid",value:u},value:f._parse(new yg(i,p,i.path,u)),alwaysSet:u in i.data})}if(this._def.catchall instanceof Ty){let u=this._def.unknownKeys;if(u==="passthrough")for(let f of c)l.push({key:{status:"valid",value:f},value:{status:"valid",value:i.data[f]}});else if(u==="strict")c.length>0&&(gr(i,{code:Ot.unrecognized_keys,keys:c}),n.dirty());else if(u!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{let u=this._def.catchall;for(let f of c){let p=i.data[f];l.push({key:{status:"valid",value:f},value:u._parse(new yg(i,p,i.path,f)),alwaysSet:f in i.data})}}return i.common.async?Promise.resolve().then(async()=>{let u=[];for(let f of l){let p=await f.key,m=await f.value;u.push({key:p,value:m,alwaysSet:f.alwaysSet})}return u}).then(u=>of.mergeObjectSync(n,u)):of.mergeObjectSync(n,l)}get shape(){return this._def.shape()}strict(e){return tn.errToObj,new t({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:s((r,n)=>{var i,o,a,c;let l=(a=(o=(i=this._def).errorMap)===null||o===void 0?void 0:o.call(i,r,n).message)!==null&&a!==void 0?a:n.defaultError;return r.code==="unrecognized_keys"?{message:(c=tn.errToObj(e).message)!==null&&c!==void 0?c:l}:{message:l}},"errorMap")}:{}})}strip(){return new t({...this._def,unknownKeys:"strip"})}passthrough(){return new t({...this._def,unknownKeys:"passthrough"})}extend(e){return new t({...this._def,shape:s(()=>({...this._def.shape(),...e}),"shape")})}merge(e){return new t({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:s(()=>({...this._def.shape(),...e._def.shape()}),"shape"),typeName:Wn.ZodObject})}setKey(e,r){return this.augment({[e]:r})}catchall(e){return new t({...this._def,catchall:e})}pick(e){let r={};return No.objectKeys(e).forEach(n=>{e[n]&&this.shape[n]&&(r[n]=this.shape[n])}),new t({...this._def,shape:s(()=>r,"shape")})}omit(e){let r={};return No.objectKeys(this.shape).forEach(n=>{e[n]||(r[n]=this.shape[n])}),new t({...this._def,shape:s(()=>r,"shape")})}deepPartial(){return WM(this)}partial(e){let r={};return No.objectKeys(this.shape).forEach(n=>{let i=this.shape[n];e&&!e[n]?r[n]=i:r[n]=i.optional()}),new t({...this._def,shape:s(()=>r,"shape")})}required(e){let r={};return No.objectKeys(this.shape).forEach(n=>{if(e&&!e[n])r[n]=this.shape[n];else{let o=this.shape[n];for(;o instanceof Ag;)o=o._def.innerType;r[n]=o}}),new t({...this._def,shape:s(()=>r,"shape")})}keyof(){return L1t(No.objectKeys(this.shape))}};Zp.create=(t,e)=>new Zp({shape:s(()=>t,"shape"),unknownKeys:"strip",catchall:Ty.create(),typeName:Wn.ZodObject,...Ci(e)});Zp.strictCreate=(t,e)=>new Zp({shape:s(()=>t,"shape"),unknownKeys:"strict",catchall:Ty.create(),typeName:Wn.ZodObject,...Ci(e)});Zp.lazycreate=(t,e)=>new Zp({shape:t,unknownKeys:"strip",catchall:Ty.create(),typeName:Wn.ZodObject,...Ci(e)});var zP=class extends vi{static{s(this,"ZodUnion")}_parse(e){let{ctx:r}=this._processInputParams(e),n=this._def.options;function i(o){for(let c of o)if(c.result.status==="valid")return c.result;for(let c of o)if(c.result.status==="dirty")return r.common.issues.push(...c.ctx.common.issues),c.result;let a=o.map(c=>new vm(c.ctx.common.issues));return gr(r,{code:Ot.invalid_union,unionErrors:a}),Yn}if(s(i,"handleResults"),r.common.async)return Promise.all(n.map(async o=>{let a={...r,common:{...r.common,issues:[]},parent:null};return{result:await o._parseAsync({data:r.data,path:r.path,parent:a}),ctx:a}})).then(i);{let o,a=[];for(let l of n){let u={...r,common:{...r.common,issues:[]},parent:null},f=l._parseSync({data:r.data,path:r.path,parent:u});if(f.status==="valid")return f;f.status==="dirty"&&!o&&(o={result:f,ctx:u}),u.common.issues.length&&a.push(u.common.issues)}if(o)return r.common.issues.push(...o.ctx.common.issues),o.result;let c=a.map(l=>new vm(l));return gr(r,{code:Ot.invalid_union,unionErrors:c}),Yn}}get options(){return this._def.options}};zP.create=(t,e)=>new zP({options:t,typeName:Wn.ZodUnion,...Ci(e)});var $E=s(t=>t instanceof YP?$E(t.schema):t instanceof xm?$E(t.innerType()):t instanceof JP?[t.value]:t instanceof XP?t.options:t instanceof ZP?No.objectValues(t.enum):t instanceof e5?$E(t._def.innerType):t instanceof GP?[void 0]:t instanceof VP?[null]:t instanceof Ag?[void 0,...$E(t.unwrap())]:t instanceof rv?[null,...$E(t.unwrap())]:t instanceof xH||t instanceof r5?$E(t.unwrap()):t instanceof t5?$E(t._def.innerType):[],"getDiscriminator"),Dle=class t extends vi{static{s(this,"ZodDiscriminatedUnion")}_parse(e){let{ctx:r}=this._processInputParams(e);if(r.parsedType!==Rr.object)return gr(r,{code:Ot.invalid_type,expected:Rr.object,received:r.parsedType}),Yn;let n=this.discriminator,i=r.data[n],o=this.optionsMap.get(i);return o?r.common.async?o._parseAsync({data:r.data,path:r.path,parent:r}):o._parseSync({data:r.data,path:r.path,parent:r}):(gr(r,{code:Ot.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[n]}),Yn)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,r,n){let i=new Map;for(let o of r){let a=$E(o.shape[e]);if(!a.length)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(let c of a){if(i.has(c))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(c)}`);i.set(c,o)}}return new t({typeName:Wn.ZodDiscriminatedUnion,discriminator:e,options:r,optionsMap:i,...Ci(n)})}};function l5e(t,e){let r=WE(t),n=WE(e);if(t===e)return{valid:!0,data:t};if(r===Rr.object&&n===Rr.object){let i=No.objectKeys(e),o=No.objectKeys(t).filter(c=>i.indexOf(c)!==-1),a={...t,...e};for(let c of o){let l=l5e(t[c],e[c]);if(!l.valid)return{valid:!1};a[c]=l.data}return{valid:!0,data:a}}else if(r===Rr.array&&n===Rr.array){if(t.length!==e.length)return{valid:!1};let i=[];for(let o=0;o<t.length;o++){let a=t[o],c=e[o],l=l5e(a,c);if(!l.valid)return{valid:!1};i.push(l.data)}return{valid:!0,data:i}}else return r===Rr.date&&n===Rr.date&&+t==+e?{valid:!0,data:t}:{valid:!1}}s(l5e,"mergeValues");var KP=class extends vi{static{s(this,"ZodIntersection")}_parse(e){let{status:r,ctx:n}=this._processInputParams(e),i=s((o,a)=>{if(a5e(o)||a5e(a))return Yn;let c=l5e(o.value,a.value);return c.valid?((c5e(o)||c5e(a))&&r.dirty(),{status:r.value,value:c.data}):(gr(n,{code:Ot.invalid_intersection_types}),Yn)},"handleParsed");return n.common.async?Promise.all([this._def.left._parseAsync({data:n.data,path:n.path,parent:n}),this._def.right._parseAsync({data:n.data,path:n.path,parent:n})]).then(([o,a])=>i(o,a)):i(this._def.left._parseSync({data:n.data,path:n.path,parent:n}),this._def.right._parseSync({data:n.data,path:n.path,parent:n}))}};KP.create=(t,e,r)=>new KP({left:t,right:e,typeName:Wn.ZodIntersection,...Ci(r)});var tv=class t extends vi{static{s(this,"ZodTuple")}_parse(e){let{status:r,ctx:n}=this._processInputParams(e);if(n.parsedType!==Rr.array)return gr(n,{code:Ot.invalid_type,expected:Rr.array,received:n.parsedType}),Yn;if(n.data.length<this._def.items.length)return gr(n,{code:Ot.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),Yn;!this._def.rest&&n.data.length>this._def.items.length&&(gr(n,{code:Ot.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),r.dirty());let o=[...n.data].map((a,c)=>{let l=this._def.items[c]||this._def.rest;return l?l._parse(new yg(n,a,n.path,c)):null}).filter(a=>!!a);return n.common.async?Promise.all(o).then(a=>of.mergeArray(r,a)):of.mergeArray(r,o)}get items(){return this._def.items}rest(e){return new t({...this._def,rest:e})}};tv.create=(t,e)=>{if(!Array.isArray(t))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new tv({items:t,typeName:Wn.ZodTuple,rest:null,...Ci(e)})};var Ble=class t extends vi{static{s(this,"ZodRecord")}get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){let{status:r,ctx:n}=this._processInputParams(e);if(n.parsedType!==Rr.object)return gr(n,{code:Ot.invalid_type,expected:Rr.object,received:n.parsedType}),Yn;let i=[],o=this._def.keyType,a=this._def.valueType;for(let c in n.data)i.push({key:o._parse(new yg(n,c,n.path,c)),value:a._parse(new yg(n,n.data[c],n.path,c)),alwaysSet:c in n.data});return n.common.async?of.mergeObjectAsync(r,i):of.mergeObjectSync(r,i)}get element(){return this._def.valueType}static create(e,r,n){return r instanceof vi?new t({keyType:e,valueType:r,typeName:Wn.ZodRecord,...Ci(n)}):new t({keyType:DS.create(),valueType:e,typeName:Wn.ZodRecord,...Ci(r)})}},KM=class extends vi{static{s(this,"ZodMap")}get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){let{status:r,ctx:n}=this._processInputParams(e);if(n.parsedType!==Rr.map)return gr(n,{code:Ot.invalid_type,expected:Rr.map,received:n.parsedType}),Yn;let i=this._def.keyType,o=this._def.valueType,a=[...n.data.entries()].map(([c,l],u)=>({key:i._parse(new yg(n,c,n.path,[u,"key"])),value:o._parse(new yg(n,l,n.path,[u,"value"]))}));if(n.common.async){let c=new Map;return Promise.resolve().then(async()=>{for(let l of a){let u=await l.key,f=await l.value;if(u.status==="aborted"||f.status==="aborted")return Yn;(u.status==="dirty"||f.status==="dirty")&&r.dirty(),c.set(u.value,f.value)}return{status:r.value,value:c}})}else{let c=new Map;for(let l of a){let u=l.key,f=l.value;if(u.status==="aborted"||f.status==="aborted")return Yn;(u.status==="dirty"||f.status==="dirty")&&r.dirty(),c.set(u.value,f.value)}return{status:r.value,value:c}}}};KM.create=(t,e,r)=>new KM({valueType:e,keyType:t,typeName:Wn.ZodMap,...Ci(r)});var YM=class t extends vi{static{s(this,"ZodSet")}_parse(e){let{status:r,ctx:n}=this._processInputParams(e);if(n.parsedType!==Rr.set)return gr(n,{code:Ot.invalid_type,expected:Rr.set,received:n.parsedType}),Yn;let i=this._def;i.minSize!==null&&n.data.size<i.minSize.value&&(gr(n,{code:Ot.too_small,minimum:i.minSize.value,type:"set",inclusive:!0,exact:!1,message:i.minSize.message}),r.dirty()),i.maxSize!==null&&n.data.size>i.maxSize.value&&(gr(n,{code:Ot.too_big,maximum:i.maxSize.value,type:"set",inclusive:!0,exact:!1,message:i.maxSize.message}),r.dirty());let o=this._def.valueType;function a(l){let u=new Set;for(let f of l){if(f.status==="aborted")return Yn;f.status==="dirty"&&r.dirty(),u.add(f.value)}return{status:r.value,value:u}}s(a,"finalizeSet");let c=[...n.data.values()].map((l,u)=>o._parse(new yg(n,l,n.path,u)));return n.common.async?Promise.all(c).then(l=>a(l)):a(c)}min(e,r){return new t({...this._def,minSize:{value:e,message:tn.toString(r)}})}max(e,r){return new t({...this._def,maxSize:{value:e,message:tn.toString(r)}})}size(e,r){return this.min(e,r).max(e,r)}nonempty(e){return this.min(1,e)}};YM.create=(t,e)=>new YM({valueType:t,minSize:null,maxSize:null,typeName:Wn.ZodSet,...Ci(e)});var Nle=class t extends vi{static{s(this,"ZodFunction")}constructor(){super(...arguments),this.validate=this.implement}_parse(e){let{ctx:r}=this._processInputParams(e);if(r.parsedType!==Rr.function)return gr(r,{code:Ot.invalid_type,expected:Rr.function,received:r.parsedType}),Yn;function n(c,l){return kle({data:c,path:r.path,errorMaps:[r.common.contextualErrorMap,r.schemaErrorMap,Rle(),GM].filter(u=>!!u),issueData:{code:Ot.invalid_arguments,argumentsError:l}})}s(n,"makeArgsIssue");function i(c,l){return kle({data:c,path:r.path,errorMaps:[r.common.contextualErrorMap,r.schemaErrorMap,Rle(),GM].filter(u=>!!u),issueData:{code:Ot.invalid_return_type,returnTypeError:l}})}s(i,"makeReturnsIssue");let o={errorMap:r.common.contextualErrorMap},a=r.data;if(this._def.returns instanceof NS){let c=this;return Wf(async function(...l){let u=new vm([]),f=await c._def.args.parseAsync(l,o).catch(h=>{throw u.addIssue(n(l,h)),u}),p=await Reflect.apply(a,this,f);return await c._def.returns._def.type.parseAsync(p,o).catch(h=>{throw u.addIssue(i(p,h)),u})})}else{let c=this;return Wf(function(...l){let u=c._def.args.safeParse(l,o);if(!u.success)throw new vm([n(l,u.error)]);let f=Reflect.apply(a,this,u.data),p=c._def.returns.safeParse(f,o);if(!p.success)throw new vm([i(f,p.error)]);return p.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new t({...this._def,args:tv.create(e).rest(jE.create())})}returns(e){return new t({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,r,n){return new t({args:e||tv.create([]).rest(jE.create()),returns:r||jE.create(),typeName:Wn.ZodFunction,...Ci(n)})}},YP=class extends vi{static{s(this,"ZodLazy")}get schema(){return this._def.getter()}_parse(e){let{ctx:r}=this._processInputParams(e);return this._def.getter()._parse({data:r.data,path:r.path,parent:r})}};YP.create=(t,e)=>new YP({getter:t,typeName:Wn.ZodLazy,...Ci(e)});var JP=class extends vi{static{s(this,"ZodLiteral")}_parse(e){if(e.data!==this._def.value){let r=this._getOrReturnCtx(e);return gr(r,{received:r.data,code:Ot.invalid_literal,expected:this._def.value}),Yn}return{status:"valid",value:e.data}}get value(){return this._def.value}};JP.create=(t,e)=>new JP({value:t,typeName:Wn.ZodLiteral,...Ci(e)});function L1t(t,e){return new XP({values:t,typeName:Wn.ZodEnum,...Ci(e)})}s(L1t,"createZodEnum");var XP=class t extends vi{static{s(this,"ZodEnum")}constructor(){super(...arguments),yH.set(this,void 0)}_parse(e){if(typeof e.data!="string"){let r=this._getOrReturnCtx(e),n=this._def.values;return gr(r,{expected:No.joinValues(n),received:r.parsedType,code:Ot.invalid_type}),Yn}if(Ple(this,yH,"f")||D1t(this,yH,new Set(this._def.values),"f"),!Ple(this,yH,"f").has(e.data)){let r=this._getOrReturnCtx(e),n=this._def.values;return gr(r,{received:r.data,code:Ot.invalid_enum_value,options:n}),Yn}return Wf(e.data)}get options(){return this._def.values}get enum(){let e={};for(let r of this._def.values)e[r]=r;return e}get Values(){let e={};for(let r of this._def.values)e[r]=r;return e}get Enum(){let e={};for(let r of this._def.values)e[r]=r;return e}extract(e,r=this._def){return t.create(e,{...this._def,...r})}exclude(e,r=this._def){return t.create(this.options.filter(n=>!e.includes(n)),{...this._def,...r})}};yH=new WeakMap;XP.create=L1t;var ZP=class extends vi{static{s(this,"ZodNativeEnum")}constructor(){super(...arguments),CH.set(this,void 0)}_parse(e){let r=No.getValidEnumValues(this._def.values),n=this._getOrReturnCtx(e);if(n.parsedType!==Rr.string&&n.parsedType!==Rr.number){let i=No.objectValues(r);return gr(n,{expected:No.joinValues(i),received:n.parsedType,code:Ot.invalid_type}),Yn}if(Ple(this,CH,"f")||D1t(this,CH,new Set(No.getValidEnumValues(this._def.values)),"f"),!Ple(this,CH,"f").has(e.data)){let i=No.objectValues(r);return gr(n,{received:n.data,code:Ot.invalid_enum_value,options:i}),Yn}return Wf(e.data)}get enum(){return this._def.values}};CH=new WeakMap;ZP.create=(t,e)=>new ZP({values:t,typeName:Wn.ZodNativeEnum,...Ci(e)});var NS=class extends vi{static{s(this,"ZodPromise")}unwrap(){return this._def.type}_parse(e){let{ctx:r}=this._processInputParams(e);if(r.parsedType!==Rr.promise&&r.common.async===!1)return gr(r,{code:Ot.invalid_type,expected:Rr.promise,received:r.parsedType}),Yn;let n=r.parsedType===Rr.promise?r.data:Promise.resolve(r.data);return Wf(n.then(i=>this._def.type.parseAsync(i,{path:r.path,errorMap:r.common.contextualErrorMap})))}};NS.create=(t,e)=>new NS({type:t,typeName:Wn.ZodPromise,...Ci(e)});var xm=class extends vi{static{s(this,"ZodEffects")}innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===Wn.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){let{status:r,ctx:n}=this._processInputParams(e),i=this._def.effect||null,o={addIssue:s(a=>{gr(n,a),a.fatal?r.abort():r.dirty()},"addIssue"),get path(){return n.path}};if(o.addIssue=o.addIssue.bind(o),i.type==="preprocess"){let a=i.transform(n.data,o);if(n.common.async)return Promise.resolve(a).then(async c=>{if(r.value==="aborted")return Yn;let l=await this._def.schema._parseAsync({data:c,path:n.path,parent:n});return l.status==="aborted"?Yn:l.status==="dirty"||r.value==="dirty"?jM(l.value):l});{if(r.value==="aborted")return Yn;let c=this._def.schema._parseSync({data:a,path:n.path,parent:n});return c.status==="aborted"?Yn:c.status==="dirty"||r.value==="dirty"?jM(c.value):c}}if(i.type==="refinement"){let a=s(c=>{let l=i.refinement(c,o);if(n.common.async)return Promise.resolve(l);if(l instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return c},"executeRefinement");if(n.common.async===!1){let c=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});return c.status==="aborted"?Yn:(c.status==="dirty"&&r.dirty(),a(c.value),{status:r.value,value:c.value})}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(c=>c.status==="aborted"?Yn:(c.status==="dirty"&&r.dirty(),a(c.value).then(()=>({status:r.value,value:c.value}))))}if(i.type==="transform")if(n.common.async===!1){let a=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});if(!qP(a))return a;let c=i.transform(a.value,o);if(c instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:r.value,value:c}}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(a=>qP(a)?Promise.resolve(i.transform(a.value,o)).then(c=>({status:r.value,value:c})):a);No.assertNever(i)}};xm.create=(t,e,r)=>new xm({schema:t,typeName:Wn.ZodEffects,effect:e,...Ci(r)});xm.createWithPreprocess=(t,e,r)=>new xm({schema:e,effect:{type:"preprocess",transform:t},typeName:Wn.ZodEffects,...Ci(r)});var Ag=class extends vi{static{s(this,"ZodOptional")}_parse(e){return this._getType(e)===Rr.undefined?Wf(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}};Ag.create=(t,e)=>new Ag({innerType:t,typeName:Wn.ZodOptional,...Ci(e)});var rv=class extends vi{static{s(this,"ZodNullable")}_parse(e){return this._getType(e)===Rr.null?Wf(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}};rv.create=(t,e)=>new rv({innerType:t,typeName:Wn.ZodNullable,...Ci(e)});var e5=class extends vi{static{s(this,"ZodDefault")}_parse(e){let{ctx:r}=this._processInputParams(e),n=r.data;return r.parsedType===Rr.undefined&&(n=this._def.defaultValue()),this._def.innerType._parse({data:n,path:r.path,parent:r})}removeDefault(){return this._def.innerType}};e5.create=(t,e)=>new e5({innerType:t,typeName:Wn.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...Ci(e)});var t5=class extends vi{static{s(this,"ZodCatch")}_parse(e){let{ctx:r}=this._processInputParams(e),n={...r,common:{...r.common,issues:[]}},i=this._def.innerType._parse({data:n.data,path:n.path,parent:{...n}});return vH(i)?i.then(o=>({status:"valid",value:o.status==="valid"?o.value:this._def.catchValue({get error(){return new vm(n.common.issues)},input:n.data})})):{status:"valid",value:i.status==="valid"?i.value:this._def.catchValue({get error(){return new vm(n.common.issues)},input:n.data})}}removeCatch(){return this._def.innerType}};t5.create=(t,e)=>new t5({innerType:t,typeName:Wn.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...Ci(e)});var JM=class extends vi{static{s(this,"ZodNaN")}_parse(e){if(this._getType(e)!==Rr.nan){let n=this._getOrReturnCtx(e);return gr(n,{code:Ot.invalid_type,expected:Rr.nan,received:n.parsedType}),Yn}return{status:"valid",value:e.data}}};JM.create=t=>new JM({typeName:Wn.ZodNaN,...Ci(t)});var $Sr=Symbol("zod_brand"),xH=class extends vi{static{s(this,"ZodBranded")}_parse(e){let{ctx:r}=this._processInputParams(e),n=r.data;return this._def.type._parse({data:n,path:r.path,parent:r})}unwrap(){return this._def.type}},EH=class t extends vi{static{s(this,"ZodPipeline")}_parse(e){let{status:r,ctx:n}=this._processInputParams(e);if(n.common.async)return s(async()=>{let o=await this._def.in._parseAsync({data:n.data,path:n.path,parent:n});return o.status==="aborted"?Yn:o.status==="dirty"?(r.dirty(),jM(o.value)):this._def.out._parseAsync({data:o.value,path:n.path,parent:n})},"handleAsync")();{let i=this._def.in._parseSync({data:n.data,path:n.path,parent:n});return i.status==="aborted"?Yn:i.status==="dirty"?(r.dirty(),{status:"dirty",value:i.value}):this._def.out._parseSync({data:i.value,path:n.path,parent:n})}}static create(e,r){return new t({in:e,out:r,typeName:Wn.ZodPipeline})}},r5=class extends vi{static{s(this,"ZodReadonly")}_parse(e){let r=this._def.innerType._parse(e),n=s(i=>(qP(i)&&(i.value=Object.freeze(i.value)),i),"freeze");return vH(r)?r.then(i=>n(i)):n(r)}unwrap(){return this._def.innerType}};r5.create=(t,e)=>new r5({innerType:t,typeName:Wn.ZodReadonly,...Ci(e)});function R1t(t,e){let r=typeof t=="function"?t(e):typeof t=="string"?{message:t}:t;return typeof r=="string"?{message:r}:r}s(R1t,"cleanParams");function F1t(t,e={},r){return t?BS.create().superRefine((n,i)=>{var o,a;let c=t(n);if(c instanceof Promise)return c.then(l=>{var u,f;if(!l){let p=R1t(e,n),m=(f=(u=p.fatal)!==null&&u!==void 0?u:r)!==null&&f!==void 0?f:!0;i.addIssue({code:"custom",...p,fatal:m})}});if(!c){let l=R1t(e,n),u=(a=(o=l.fatal)!==null&&o!==void 0?o:r)!==null&&a!==void 0?a:!0;i.addIssue({code:"custom",...l,fatal:u})}}):BS.create()}s(F1t,"custom");var WSr={object:Zp.lazycreate},Wn;(function(t){t.ZodString="ZodString",t.ZodNumber="ZodNumber",t.ZodNaN="ZodNaN",t.ZodBigInt="ZodBigInt",t.ZodBoolean="ZodBoolean",t.ZodDate="ZodDate",t.ZodSymbol="ZodSymbol",t.ZodUndefined="ZodUndefined",t.ZodNull="ZodNull",t.ZodAny="ZodAny",t.ZodUnknown="ZodUnknown",t.ZodNever="ZodNever",t.ZodVoid="ZodVoid",t.ZodArray="ZodArray",t.ZodObject="ZodObject",t.ZodUnion="ZodUnion",t.ZodDiscriminatedUnion="ZodDiscriminatedUnion",t.ZodIntersection="ZodIntersection",t.ZodTuple="ZodTuple",t.ZodRecord="ZodRecord",t.ZodMap="ZodMap",t.ZodSet="ZodSet",t.ZodFunction="ZodFunction",t.ZodLazy="ZodLazy",t.ZodLiteral="ZodLiteral",t.ZodEnum="ZodEnum",t.ZodEffects="ZodEffects",t.ZodNativeEnum="ZodNativeEnum",t.ZodOptional="ZodOptional",t.ZodNullable="ZodNullable",t.ZodDefault="ZodDefault",t.ZodCatch="ZodCatch",t.ZodPromise="ZodPromise",t.ZodBranded="ZodBranded",t.ZodPipeline="ZodPipeline",t.ZodReadonly="ZodReadonly"})(Wn||(Wn={}));var jSr=s((t,e={message:`Input not instance of ${t.name}`})=>F1t(r=>r instanceof t,e),"instanceOfType"),O1t=DS.create,Q1t=HP.create,GSr=JM.create,VSr=$P.create,U1t=WP.create,zSr=jP.create,KSr=VM.create,YSr=GP.create,JSr=VP.create,XSr=BS.create,ZSr=jE.create,e_r=Ty.create,t_r=zM.create,r_r=GE.create,n_r=Zp.create,i_r=Zp.strictCreate,o_r=zP.create,s_r=Dle.create,a_r=KP.create,c_r=tv.create,l_r=Ble.create,u_r=KM.create,d_r=YM.create,f_r=Nle.create,p_r=YP.create,m_r=JP.create,h_r=XP.create,g_r=ZP.create,A_r=NS.create,k1t=xm.create,y_r=Ag.create,C_r=rv.create,v_r=xm.createWithPreprocess,x_r=EH.create,E_r=s(()=>O1t().optional(),"ostring"),b_r=s(()=>Q1t().optional(),"onumber"),I_r=s(()=>U1t().optional(),"oboolean"),T_r={string:s(t=>DS.create({...t,coerce:!0}),"string"),number:s(t=>HP.create({...t,coerce:!0}),"number"),boolean:s(t=>WP.create({...t,coerce:!0}),"boolean"),bigint:s(t=>$P.create({...t,coerce:!0}),"bigint"),date:s(t=>jP.create({...t,coerce:!0}),"date")},w_r=Yn,_=Object.freeze({__proto__:null,defaultErrorMap:GM,setErrorMap:vSr,getErrorMap:Rle,makeIssue:kle,EMPTY_PATH:xSr,addIssueToContext:gr,ParseStatus:of,INVALID:Yn,DIRTY:jM,OK:Wf,isAborted:a5e,isDirty:c5e,isValid:qP,isAsync:vH,get util(){return No},get objectUtil(){return s5e},ZodParsedType:Rr,getParsedType:WE,ZodType:vi,datetimeRegex:M1t,ZodString:DS,ZodNumber:HP,ZodBigInt:$P,ZodBoolean:WP,ZodDate:jP,ZodSymbol:VM,ZodUndefined:GP,ZodNull:VP,ZodAny:BS,ZodUnknown:jE,ZodNever:Ty,ZodVoid:zM,ZodArray:GE,ZodObject:Zp,ZodUnion:zP,ZodDiscriminatedUnion:Dle,ZodIntersection:KP,ZodTuple:tv,ZodRecord:Ble,ZodMap:KM,ZodSet:YM,ZodFunction:Nle,ZodLazy:YP,ZodLiteral:JP,ZodEnum:XP,ZodNativeEnum:ZP,ZodPromise:NS,ZodEffects:xm,ZodTransformer:xm,ZodOptional:Ag,ZodNullable:rv,ZodDefault:e5,ZodCatch:t5,ZodNaN:JM,BRAND:$Sr,ZodBranded:xH,ZodPipeline:EH,ZodReadonly:r5,custom:F1t,Schema:vi,ZodSchema:vi,late:WSr,get ZodFirstPartyTypeKind(){return Wn},coerce:T_r,any:XSr,array:r_r,bigint:VSr,boolean:U1t,date:zSr,discriminatedUnion:s_r,effect:k1t,enum:h_r,function:f_r,instanceof:jSr,intersection:a_r,lazy:p_r,literal:m_r,map:u_r,nan:GSr,nativeEnum:g_r,never:e_r,null:JSr,nullable:C_r,number:Q1t,object:n_r,oboolean:I_r,onumber:b_r,optional:y_r,ostring:E_r,pipeline:x_r,preprocess:v_r,promise:A_r,record:l_r,set:d_r,strictObject:i_r,string:O1t,symbol:KSr,transformer:k1t,tuple:c_r,undefined:YSr,union:o_r,unknown:ZSr,void:t_r,NEVER:w_r,ZodIssueCode:Ot,quotelessJson:CSr,ZodError:vm});var Mle="2025-06-18";var Lle="2.0",q1t=_.union([_.string(),_.number().int()]),H1t=_.string(),S_r=_.object({progressToken:_.optional(q1t)}).passthrough(),Cg=_.object({_meta:_.optional(S_r)}).passthrough(),e0=_.object({method:_.string(),params:_.optional(Cg)}),bH=_.object({_meta:_.optional(_.object({}).passthrough())}).passthrough(),nv=_.object({method:_.string(),params:_.optional(bH)}),vg=_.object({_meta:_.optional(_.object({}).passthrough())}).passthrough(),Fle=_.union([_.string(),_.number().int()]),__r=_.object({jsonrpc:_.literal(Lle),id:Fle}).merge(e0).strict();var R_r=_.object({jsonrpc:_.literal(Lle)}).merge(nv).strict();var k_r=_.object({jsonrpc:_.literal(Lle),id:Fle,result:vg}).strict();var P_r=_.object({jsonrpc:_.literal(Lle),id:Fle,error:_.object({code:_.number().int(),message:_.string(),data:_.optional(_.unknown())})}).strict();var oNo=_.union([__r,R_r,k_r,P_r]),$1t=vg.strict(),W1t=nv.extend({method:_.literal("notifications/cancelled"),params:bH.extend({requestId:Fle,reason:_.string().optional()})}),IH=_.object({name:_.string(),title:_.optional(_.string())}).passthrough(),j1t=IH.extend({version:_.string()}),D_r=_.object({experimental:_.optional(_.object({}).passthrough()),sampling:_.optional(_.object({}).passthrough()),elicitation:_.optional(_.object({}).passthrough()),roots:_.optional(_.object({listChanged:_.optional(_.boolean())}).passthrough())}).passthrough(),B_r=e0.extend({method:_.literal("initialize"),params:Cg.extend({protocolVersion:_.string(),capabilities:D_r,clientInfo:j1t})});var N_r=_.object({experimental:_.optional(_.object({}).passthrough()),logging:_.optional(_.object({}).passthrough()),completions:_.optional(_.object({}).passthrough()),prompts:_.optional(_.object({listChanged:_.optional(_.boolean())}).passthrough()),resources:_.optional(_.object({subscribe:_.optional(_.boolean()),listChanged:_.optional(_.boolean())}).passthrough()),tools:_.optional(_.object({listChanged:_.optional(_.boolean())}).passthrough())}).passthrough(),M_r=vg.extend({protocolVersion:_.string(),capabilities:N_r,serverInfo:j1t,instructions:_.optional(_.string())}),L_r=nv.extend({method:_.literal("notifications/initialized")});var G1t=e0.extend({method:_.literal("ping")}),F_r=_.object({progress:_.number(),total:_.optional(_.number()),message:_.optional(_.string())}).passthrough(),V1t=nv.extend({method:_.literal("notifications/progress"),params:bH.merge(F_r).extend({progressToken:q1t})}),Ole=e0.extend({params:Cg.extend({cursor:_.optional(H1t)}).optional()}),Qle=vg.extend({nextCursor:_.optional(H1t)}),z1t=_.object({uri:_.string(),mimeType:_.optional(_.string()),_meta:_.optional(_.object({}).passthrough())}).passthrough(),K1t=z1t.extend({text:_.string()}),Y1t=z1t.extend({blob:_.string().base64()}),J1t=IH.extend({uri:_.string(),description:_.optional(_.string()),mimeType:_.optional(_.string()),_meta:_.optional(_.object({}).passthrough())}),O_r=IH.extend({uriTemplate:_.string(),description:_.optional(_.string()),mimeType:_.optional(_.string()),_meta:_.optional(_.object({}).passthrough())}),Q_r=Ole.extend({method:_.literal("resources/list")}),U_r=Qle.extend({resources:_.array(J1t)}),q_r=Ole.extend({method:_.literal("resources/templates/list")}),H_r=Qle.extend({resourceTemplates:_.array(O_r)}),$_r=e0.extend({method:_.literal("resources/read"),params:Cg.extend({uri:_.string()})}),W_r=vg.extend({contents:_.array(_.union([K1t,Y1t]))}),j_r=nv.extend({method:_.literal("notifications/resources/list_changed")}),G_r=e0.extend({method:_.literal("resources/subscribe"),params:Cg.extend({uri:_.string()})}),V_r=e0.extend({method:_.literal("resources/unsubscribe"),params:Cg.extend({uri:_.string()})}),z_r=nv.extend({method:_.literal("notifications/resources/updated"),params:bH.extend({uri:_.string()})}),K_r=_.object({name:_.string(),description:_.optional(_.string()),required:_.optional(_.boolean())}).passthrough(),Y_r=IH.extend({description:_.optional(_.string()),arguments:_.optional(_.array(K_r)),_meta:_.optional(_.object({}).passthrough())}),J_r=Ole.extend({method:_.literal("prompts/list")}),X_r=Qle.extend({prompts:_.array(Y_r)}),Z_r=e0.extend({method:_.literal("prompts/get"),params:Cg.extend({name:_.string(),arguments:_.optional(_.record(_.string()))})}),u5e=_.object({type:_.literal("text"),text:_.string(),_meta:_.optional(_.object({}).passthrough())}).passthrough(),d5e=_.object({type:_.literal("image"),data:_.string().base64(),mimeType:_.string(),_meta:_.optional(_.object({}).passthrough())}).passthrough(),f5e=_.object({type:_.literal("audio"),data:_.string().base64(),mimeType:_.string(),_meta:_.optional(_.object({}).passthrough())}).passthrough(),e2r=_.object({type:_.literal("resource"),resource:_.union([K1t,Y1t]),_meta:_.optional(_.object({}).passthrough())}).passthrough(),t2r=J1t.extend({type:_.literal("resource_link")}),X1t=_.union([u5e,d5e,f5e,t2r,e2r]),r2r=_.object({role:_.enum(["user","assistant"]),content:X1t}).passthrough(),n2r=vg.extend({description:_.optional(_.string()),messages:_.array(r2r)}),i2r=nv.extend({method:_.literal("notifications/prompts/list_changed")}),o2r=_.object({title:_.optional(_.string()),readOnlyHint:_.optional(_.boolean()),destructiveHint:_.optional(_.boolean()),idempotentHint:_.optional(_.boolean()),openWorldHint:_.optional(_.boolean())}).passthrough(),s2r=IH.extend({description:_.optional(_.string()),inputSchema:_.object({type:_.literal("object"),properties:_.optional(_.object({}).passthrough()),required:_.optional(_.array(_.string()))}).passthrough(),outputSchema:_.optional(_.object({type:_.literal("object"),properties:_.optional(_.object({}).passthrough()),required:_.optional(_.array(_.string()))}).passthrough()),annotations:_.optional(o2r),_meta:_.optional(_.object({}).passthrough())}),a2r=Ole.extend({method:_.literal("tools/list")}),c2r=Qle.extend({tools:_.array(s2r)}),Z1t=vg.extend({content:_.array(X1t).default([]),structuredContent:_.object({}).passthrough().optional(),isError:_.optional(_.boolean())}),sNo=Z1t.or(vg.extend({toolResult:_.unknown()})),l2r=e0.extend({method:_.literal("tools/call"),params:Cg.extend({name:_.string(),arguments:_.optional(_.record(_.unknown()))})}),u2r=nv.extend({method:_.literal("notifications/tools/list_changed")}),evt=_.enum(["debug","info","notice","warning","error","critical","alert","emergency"]),d2r=e0.extend({method:_.literal("logging/setLevel"),params:Cg.extend({level:evt})}),f2r=nv.extend({method:_.literal("notifications/message"),params:bH.extend({level:evt,logger:_.optional(_.string()),data:_.unknown()})}),p2r=_.object({name:_.string().optional()}).passthrough(),m2r=_.object({hints:_.optional(_.array(p2r)),costPriority:_.optional(_.number().min(0).max(1)),speedPriority:_.optional(_.number().min(0).max(1)),intelligencePriority:_.optional(_.number().min(0).max(1))}).passthrough(),h2r=_.object({role:_.enum(["user","assistant"]),content:_.union([u5e,d5e,f5e])}).passthrough(),g2r=e0.extend({method:_.literal("sampling/createMessage"),params:Cg.extend({messages:_.array(h2r),systemPrompt:_.optional(_.string()),includeContext:_.optional(_.enum(["none","thisServer","allServers"])),temperature:_.optional(_.number()),maxTokens:_.number().int(),stopSequences:_.optional(_.array(_.string())),metadata:_.optional(_.object({}).passthrough()),modelPreferences:_.optional(m2r)})}),A2r=vg.extend({model:_.string(),stopReason:_.optional(_.enum(["endTurn","stopSequence","maxTokens"]).or(_.string())),role:_.enum(["user","assistant"]),content:_.discriminatedUnion("type",[u5e,d5e,f5e])}),y2r=_.object({type:_.literal("boolean"),title:_.optional(_.string()),description:_.optional(_.string()),default:_.optional(_.boolean())}).passthrough(),C2r=_.object({type:_.literal("string"),title:_.optional(_.string()),description:_.optional(_.string()),minLength:_.optional(_.number()),maxLength:_.optional(_.number()),format:_.optional(_.enum(["email","uri","date","date-time"]))}).passthrough(),v2r=_.object({type:_.enum(["number","integer"]),title:_.optional(_.string()),description:_.optional(_.string()),minimum:_.optional(_.number()),maximum:_.optional(_.number())}).passthrough(),x2r=_.object({type:_.literal("string"),title:_.optional(_.string()),description:_.optional(_.string()),enum:_.array(_.string()),enumNames:_.optional(_.array(_.string()))}).passthrough(),E2r=_.union([y2r,C2r,v2r,x2r]),b2r=e0.extend({method:_.literal("elicitation/create"),params:Cg.extend({message:_.string(),requestedSchema:_.object({type:_.literal("object"),properties:_.record(_.string(),E2r),required:_.optional(_.array(_.string()))}).passthrough()})}),I2r=vg.extend({action:_.enum(["accept","decline","cancel"]),content:_.optional(_.record(_.string(),_.unknown()))}),T2r=_.object({type:_.literal("ref/resource"),uri:_.string()}).passthrough();var w2r=_.object({type:_.literal("ref/prompt"),name:_.string()}).passthrough(),S2r=e0.extend({method:_.literal("completion/complete"),params:Cg.extend({ref:_.union([w2r,T2r]),argument:_.object({name:_.string(),value:_.string()}).passthrough(),context:_.optional(_.object({arguments:_.optional(_.record(_.string(),_.string()))}))})}),_2r=vg.extend({completion:_.object({values:_.array(_.string()).max(100),total:_.optional(_.number().int()),hasMore:_.optional(_.boolean())}).passthrough()}),R2r=_.object({uri:_.string().startsWith("file://"),name:_.optional(_.string()),_meta:_.optional(_.object({}).passthrough())}).passthrough(),k2r=e0.extend({method:_.literal("roots/list")}),P2r=vg.extend({roots:_.array(R2r)}),D2r=nv.extend({method:_.literal("notifications/roots/list_changed")}),aNo=_.union([G1t,B_r,S2r,d2r,Z_r,J_r,Q_r,q_r,$_r,G_r,V_r,l2r,a2r]),cNo=_.union([W1t,V1t,L_r,D2r]),lNo=_.union([$1t,A2r,I2r,P2r]),uNo=_.union([G1t,g2r,b2r,k2r]),dNo=_.union([W1t,V1t,f2r,z_r,j_r,u2r,i2r]),fNo=_.union([$1t,M_r,_2r,n2r,X_r,U_r,H_r,W_r,Z1t,c2r]);d();async function n5(t,e,r,n,i){return await t.get(Or).fetch(new URL(e).href,{method:r,headers:n,body:i})}s(n5,"fetchOauthServer");async function p5e(t){try{return await t.text()}catch{return t.statusText}}s(p5e,"getErrText");d();var tvt="/.well-known",m5e=`${tvt}/oauth-protected-resource`,rvt=`${tvt}/oauth-authorization-server`;function nvt(t){return typeof t!="object"||t===null?!1:t.resource!==void 0}s(nvt,"isAuthorizationProtectedResourceMetadata");function ivt(t){return typeof t!="object"||t===null?!1:t.issuer!==void 0}s(ivt,"isAuthorizationServerMetadata");function ovt(t){let e=t.split(" "),r=e[0],n={};return e.length>1&&e.slice(1).join(" ").split(",").forEach(o=>{let[a,c]=o.split("=").map(l=>l.trim().replace(/"/g,""));n[a]=c}),{scheme:r,params:n}}s(ovt,"parseWWWAuthenticateHeader");function svt(t){let e=new URL(t.issuer);return{...t,authorization_endpoint:t.authorization_endpoint??new URL("/authorize",e).toString(),token_endpoint:t.token_endpoint??new URL("/token",e).toString(),registration_endpoint:t.registration_endpoint??new URL("/register",e).toString()}}s(svt,"getMetadataWithDefaultValues");function avt(t){return{issuer:t.toString(),authorization_endpoint:new URL("/authorize",t).toString(),token_endpoint:new URL("/token",t).toString(),registration_endpoint:new URL("/register",t).toString(),response_types_supported:["code","id_token","id_token token"]}}s(avt,"getDefaultMetadataForUrl");function cvt(t){let e=new URL(t);if(!e.pathname.startsWith(m5e))throw new Error(`Invalid discovery URL: expected path to start with ${m5e}`);let r=e.pathname.substring(m5e.length),n=new URL(e.origin);return n.pathname=r||"/",n.toString()}s(cvt,"getResourceServerBaseUrlFromDiscoveryUrl");var h5e=class{static{s(this,"AuthMetadata")}},Ule=class extends h5e{static{s(this,"MCPAuthMetadata")}constructor(e){super(),this.ctx=e}async getMetadataFromOriginalUrl(e,r){let n=await this.getResourceMetadataChallenge(e),i,o,a,c=await this.getResourceMetadata(n,{url:e,headers:r??{}});c.resource&&(i=c.authorization_servers?.[0],o=c.scopes_supported,a=c);let l=new URL(e).origin,u={};i||(i=l,u=r??{});let f;try{let m=await this.getAuthorizationServerMetadata(i,u),h=svt(m);return f={authorizationServer:i,serverMetadata:h,resourceMetadata:a},_n.info(this.ctx,"authMetadata",f),f}catch(m){_n.warn(this.ctx,`Error populating auth metadata: ${String(m)}`)}let p=avt(new URL(l));return p.scopes_supported=o??p.scopes_supported??[],f={authorizationServer:i,serverMetadata:p,resourceMetadata:a},f}async getResourceMetadataChallenge(e){let r=await n5(this.ctx,e,"POST"),n;if(r.status===401&&r.headers.has("WWW-Authenticate")){let i=r.headers.get("WWW-Authenticate"),{scheme:o,params:a}=ovt(i);o==="Bearer"&&a.resource_metadata&&(n=a.resource_metadata)}return n}async getResourceMetadata(e,r){if(!e)return{resource:""};let n=new URL(e),i=new URL(r.url),o={};n.origin===i.origin&&(o=r.headers);let a=await n5(this.ctx,e,"GET",{...o,Accept:"application/json","MCP-Protocol-Version":Mle});if(a.status!==200)throw new Error(`Failed to fetch resource metadata: ${a.status} ${await p5e(a)}`);let c=await a.json();if(nvt(c)){let l=cvt(e);if(c.resource!==l)throw new Error(`Protected Resource Metadata resource "${c.resource}" does not match MCP server resolved resource "${l}". The MCP server must follow OAuth spec https://datatracker.ietf.org/doc/html/rfc9728#PRConfigurationValidation`);return c}else throw new Error(`Invalid resource metadata: ${JSON.stringify(c)}`)}async getAuthorizationServerMetadata(e,r){let n=new URL(e),i=n.pathname==="/"?"":n.pathname,o=new URL(rvt,e).toString()+i,a=await n5(this.ctx,o,"GET",{...r,Accept:"application/json","MCP-Protocol-Version":Mle});if(a.status!==200&&(a=await n5(this.ctx,Vi(e,".well-known","openid-configuration"),"GET",{...r,Accept:"application/json","MCP-Protocol-Version":Mle}),a.status!==200))throw new Error(`Failed to fetch authorization server metadata: ${a.status} ${await p5e(a)}`);let c=await a.json();if(ivt(c))return c;throw new Error(`Invalid authorization server metadata: ${JSON.stringify(c)}`)}};d();d();d();d();d();var MS=class{static{s(this,"MCPNotificationHandler")}constructor(e,r){this.ctx=e,this.serverName=r}};var TH=class extends MS{static{s(this,"LoggingMessageNotificationHandler")}constructor(e,r){super(e,r)}handle(e){let r=typeof e.params.data=="string"?e.params.data:JSON.stringify(e.params.data);switch(e.params.logger&&(r=`${e.params.logger}: ${r}`),e.params?.level){case"debug":case"info":case"notice":_n.info(this.ctx,`MCP server ${this.serverName} log:`,r),Qa(this.ctx,{message:`Notification message: ${r}`,server:this.serverName});break;case"warning":_n.warn(this.ctx,`MCP server ${this.serverName} log:`,r),UP(this.ctx,{message:`Notification message: ${r}`,server:this.serverName});break;case"error":case"critical":case"alert":case"emergency":_n.error(this.ctx,`MCP server ${this.serverName} log:`,r),hd(this.ctx,{message:`Notification message: ${r}`,server:this.serverName});break;default:_n.info(this.ctx,`MCP server ${this.serverName} log:`,r),Qa(this.ctx,{message:`Notification message: ${r}`,server:this.serverName});break}}};d();var wH=class extends MS{static{s(this,"PromptListChangedNotificationHandler")}constructor(e,r,n){super(e,r),this.emitter=n}handle(e){_n.info(this.ctx,"Prompts list changed, refreshing tools..."),Qa(this.ctx,{message:"Prompts list changed, refreshing tools...",server:this.serverName}),this.emitter.emit($k)}};d();var qle=class{static{s(this,"MCPRequestHandler")}constructor(e,r){this.ctx=e,this.serverName=r}},SH=class extends qle{static{s(this,"ListRootsRequestHandler")}constructor(e,r){super(e,r)}handle(e){_n.info(this.ctx,`MCP server ${this.serverName} requested roots list`);let r=[];try{(this.ctx.get(dr).getWorkspaceFolders()||[]).forEach(i=>{r.push(i)}),Qa(this.ctx,{message:`Requested roots list and found ${r.length} root(s).`,server:this.serverName})}catch(n){_n.error(this.ctx,`Error getting workspace folders for MCP server ${this.serverName}:`,n),hd(this.ctx,{message:`Error getting workspace folders for MCP server ${this.serverName}: ${n instanceof Error?n.message:String(n)}`,server:this.serverName})}return{roots:r}}};d();var _H=class extends MS{static{s(this,"ToolListChangedNotificationHandler")}constructor(e,r,n){super(e,r),this.emitter=n}handle(e){_n.info(this.ctx,"Tool list changed, refreshing tools..."),Qa(this.ctx,{message:"Tool list changed, refreshing tools...",server:this.serverName}),this.emitter.emit($k)}};d();d();var XM="2025-06-18";var lvt=[XM,"2025-03-26","2024-11-05","2024-10-07"],Hle="2.0",uvt=_.union([_.string(),_.number().int()]),dvt=_.string(),B2r=_.object({progressToken:_.optional(uvt)}).passthrough(),Eg=_.object({_meta:_.optional(B2r)}).passthrough(),r0=_.object({method:_.string(),params:_.optional(Eg)}),RH=_.object({_meta:_.optional(_.object({}).passthrough())}).passthrough(),iv=_.object({method:_.string(),params:_.optional(RH)}),bg=_.object({_meta:_.optional(_.object({}).passthrough())}).passthrough(),$le=_.union([_.string(),_.number().int()]),fvt=_.object({jsonrpc:_.literal(Hle),id:$le}).merge(r0).strict(),Wle=s(t=>fvt.safeParse(t).success,"isJSONRPCRequest"),pvt=_.object({jsonrpc:_.literal(Hle)}).merge(iv).strict(),mvt=s(t=>pvt.safeParse(t).success,"isJSONRPCNotification"),hvt=_.object({jsonrpc:_.literal(Hle),id:$le,result:bg}).strict(),kH=s(t=>hvt.safeParse(t).success,"isJSONRPCResponse"),xg;(function(t){t[t.ConnectionClosed=-32e3]="ConnectionClosed",t[t.RequestTimeout=-32001]="RequestTimeout",t[t.ParseError=-32700]="ParseError",t[t.InvalidRequest=-32600]="InvalidRequest",t[t.MethodNotFound=-32601]="MethodNotFound",t[t.InvalidParams=-32602]="InvalidParams",t[t.InternalError=-32603]="InternalError"})(xg||(xg={}));var gvt=_.object({jsonrpc:_.literal(Hle),id:$le,error:_.object({code:_.number().int(),message:_.string(),data:_.optional(_.unknown())})}).strict(),Avt=s(t=>gvt.safeParse(t).success,"isJSONRPCError"),LS=_.union([fvt,pvt,hvt,gvt]),i5=bg.strict(),jle=iv.extend({method:_.literal("notifications/cancelled"),params:RH.extend({requestId:$le,reason:_.string().optional()})}),PH=_.object({name:_.string(),title:_.optional(_.string())}).passthrough(),yvt=PH.extend({version:_.string()}),N2r=_.object({experimental:_.optional(_.object({}).passthrough()),sampling:_.optional(_.object({}).passthrough()),elicitation:_.optional(_.object({}).passthrough()),roots:_.optional(_.object({listChanged:_.optional(_.boolean())}).passthrough())}).passthrough(),M2r=r0.extend({method:_.literal("initialize"),params:Eg.extend({protocolVersion:_.string(),capabilities:N2r,clientInfo:yvt})});var L2r=_.object({experimental:_.optional(_.object({}).passthrough()),logging:_.optional(_.object({}).passthrough()),completions:_.optional(_.object({}).passthrough()),prompts:_.optional(_.object({listChanged:_.optional(_.boolean())}).passthrough()),resources:_.optional(_.object({subscribe:_.optional(_.boolean()),listChanged:_.optional(_.boolean())}).passthrough()),tools:_.optional(_.object({listChanged:_.optional(_.boolean())}).passthrough())}).passthrough(),g5e=bg.extend({protocolVersion:_.string(),capabilities:L2r,serverInfo:yvt,instructions:_.optional(_.string())}),Cvt=iv.extend({method:_.literal("notifications/initialized")}),vvt=s(t=>Cvt.safeParse(t).success,"isInitializedNotification"),Gle=r0.extend({method:_.literal("ping")}),F2r=_.object({progress:_.number(),total:_.optional(_.number()),message:_.optional(_.string())}).passthrough(),Vle=iv.extend({method:_.literal("notifications/progress"),params:RH.merge(F2r).extend({progressToken:uvt})}),zle=r0.extend({params:Eg.extend({cursor:_.optional(dvt)}).optional()}),Kle=bg.extend({nextCursor:_.optional(dvt)}),xvt=_.object({uri:_.string(),mimeType:_.optional(_.string()),_meta:_.optional(_.object({}).passthrough())}).passthrough(),Evt=xvt.extend({text:_.string()}),A5e=_.string().refine(t=>{try{return atob(t),!0}catch{return!1}},{message:"Invalid Base64 string"}),bvt=xvt.extend({blob:A5e}),Ivt=PH.extend({uri:_.string(),description:_.optional(_.string()),mimeType:_.optional(_.string()),_meta:_.optional(_.object({}).passthrough())}),O2r=PH.extend({uriTemplate:_.string(),description:_.optional(_.string()),mimeType:_.optional(_.string()),_meta:_.optional(_.object({}).passthrough())}),Q2r=zle.extend({method:_.literal("resources/list")}),y5e=Kle.extend({resources:_.array(Ivt)}),U2r=zle.extend({method:_.literal("resources/templates/list")}),C5e=Kle.extend({resourceTemplates:_.array(O2r)}),q2r=r0.extend({method:_.literal("resources/read"),params:Eg.extend({uri:_.string()})}),v5e=bg.extend({contents:_.array(_.union([Evt,bvt]))}),H2r=iv.extend({method:_.literal("notifications/resources/list_changed")}),$2r=r0.extend({method:_.literal("resources/subscribe"),params:Eg.extend({uri:_.string()})}),W2r=r0.extend({method:_.literal("resources/unsubscribe"),params:Eg.extend({uri:_.string()})}),j2r=iv.extend({method:_.literal("notifications/resources/updated"),params:RH.extend({uri:_.string()})}),G2r=_.object({name:_.string(),description:_.optional(_.string()),required:_.optional(_.boolean())}).passthrough(),V2r=PH.extend({description:_.optional(_.string()),arguments:_.optional(_.array(G2r)),_meta:_.optional(_.object({}).passthrough())}),z2r=zle.extend({method:_.literal("prompts/list")}),x5e=Kle.extend({prompts:_.array(V2r)}),K2r=r0.extend({method:_.literal("prompts/get"),params:Eg.extend({name:_.string(),arguments:_.optional(_.record(_.string()))})}),E5e=_.object({type:_.literal("text"),text:_.string(),_meta:_.optional(_.object({}).passthrough())}).passthrough(),b5e=_.object({type:_.literal("image"),data:A5e,mimeType:_.string(),_meta:_.optional(_.object({}).passthrough())}).passthrough(),I5e=_.object({type:_.literal("audio"),data:A5e,mimeType:_.string(),_meta:_.optional(_.object({}).passthrough())}).passthrough(),Y2r=_.object({type:_.literal("resource"),resource:_.union([Evt,bvt]),_meta:_.optional(_.object({}).passthrough())}).passthrough(),J2r=Ivt.extend({type:_.literal("resource_link")}),Tvt=_.union([E5e,b5e,I5e,J2r,Y2r]),X2r=_.object({role:_.enum(["user","assistant"]),content:Tvt}).passthrough(),T5e=bg.extend({description:_.optional(_.string()),messages:_.array(X2r)}),w5e=iv.extend({method:_.literal("notifications/prompts/list_changed")}),Z2r=_.object({title:_.optional(_.string()),readOnlyHint:_.optional(_.boolean()),destructiveHint:_.optional(_.boolean()),idempotentHint:_.optional(_.boolean()),openWorldHint:_.optional(_.boolean())}).passthrough(),eRr=PH.extend({description:_.optional(_.string()),inputSchema:_.object({type:_.literal("object"),properties:_.optional(_.object({}).passthrough()),required:_.optional(_.array(_.string()))}).passthrough(),outputSchema:_.optional(_.object({type:_.literal("object"),properties:_.optional(_.object({}).passthrough()),required:_.optional(_.array(_.string()))}).passthrough()),annotations:_.optional(Z2r),_meta:_.optional(_.object({}).passthrough())}),tRr=zle.extend({method:_.literal("tools/list")}),S5e=Kle.extend({tools:_.array(eRr)}),ZM=bg.extend({content:_.array(Tvt).default([]),structuredContent:_.object({}).passthrough().optional(),isError:_.optional(_.boolean())}),f8o=ZM.or(bg.extend({toolResult:_.unknown()})),rRr=r0.extend({method:_.literal("tools/call"),params:Eg.extend({name:_.string(),arguments:_.optional(_.record(_.unknown()))})}),_5e=iv.extend({method:_.literal("notifications/tools/list_changed")}),wvt=_.enum(["debug","info","notice","warning","error","critical","alert","emergency"]),nRr=r0.extend({method:_.literal("logging/setLevel"),params:Eg.extend({level:wvt})}),R5e=iv.extend({method:_.literal("notifications/message"),params:RH.extend({level:wvt,logger:_.optional(_.string()),data:_.unknown()})}),iRr=_.object({name:_.string().optional()}).passthrough(),oRr=_.object({hints:_.optional(_.array(iRr)),costPriority:_.optional(_.number().min(0).max(1)),speedPriority:_.optional(_.number().min(0).max(1)),intelligencePriority:_.optional(_.number().min(0).max(1))}).passthrough(),sRr=_.object({role:_.enum(["user","assistant"]),content:_.union([E5e,b5e,I5e])}).passthrough(),k5e=r0.extend({method:_.literal("sampling/createMessage"),params:Eg.extend({messages:_.array(sRr),systemPrompt:_.optional(_.string()),includeContext:_.optional(_.enum(["none","thisServer","allServers"])),temperature:_.optional(_.number()),maxTokens:_.number().int(),stopSequences:_.optional(_.array(_.string())),metadata:_.optional(_.object({}).passthrough()),modelPreferences:_.optional(oRr)})}),aRr=bg.extend({model:_.string(),stopReason:_.optional(_.enum(["endTurn","stopSequence","maxTokens"]).or(_.string())),role:_.enum(["user","assistant"]),content:_.discriminatedUnion("type",[E5e,b5e,I5e])}),cRr=_.object({type:_.literal("boolean"),title:_.optional(_.string()),description:_.optional(_.string()),default:_.optional(_.boolean())}).passthrough(),lRr=_.object({type:_.literal("string"),title:_.optional(_.string()),description:_.optional(_.string()),minLength:_.optional(_.number()),maxLength:_.optional(_.number()),format:_.optional(_.enum(["email","uri","date","date-time"]))}).passthrough(),uRr=_.object({type:_.enum(["number","integer"]),title:_.optional(_.string()),description:_.optional(_.string()),minimum:_.optional(_.number()),maximum:_.optional(_.number())}).passthrough(),dRr=_.object({type:_.literal("string"),title:_.optional(_.string()),description:_.optional(_.string()),enum:_.array(_.string()),enumNames:_.optional(_.array(_.string()))}).passthrough(),fRr=_.union([cRr,lRr,uRr,dRr]),pRr=r0.extend({method:_.literal("elicitation/create"),params:Eg.extend({message:_.string(),requestedSchema:_.object({type:_.literal("object"),properties:_.record(_.string(),fRr),required:_.optional(_.array(_.string()))}).passthrough()})}),mRr=bg.extend({action:_.enum(["accept","decline","cancel"]),content:_.optional(_.record(_.string(),_.unknown()))}),hRr=_.object({type:_.literal("ref/resource"),uri:_.string()}).passthrough();var gRr=_.object({type:_.literal("ref/prompt"),name:_.string()}).passthrough(),ARr=r0.extend({method:_.literal("completion/complete"),params:Eg.extend({ref:_.union([gRr,hRr]),argument:_.object({name:_.string(),value:_.string()}).passthrough(),context:_.optional(_.object({arguments:_.optional(_.record(_.string(),_.string()))}))})}),P5e=bg.extend({completion:_.object({values:_.array(_.string()).max(100),total:_.optional(_.number().int()),hasMore:_.optional(_.boolean())}).passthrough()}),yRr=_.object({uri:_.string().startsWith("file://"),name:_.optional(_.string()),_meta:_.optional(_.object({}).passthrough())}).passthrough(),D5e=r0.extend({method:_.literal("roots/list")}),CRr=bg.extend({roots:_.array(yRr)}),vRr=iv.extend({method:_.literal("notifications/roots/list_changed")}),p8o=_.union([Gle,M2r,ARr,nRr,K2r,z2r,Q2r,U2r,q2r,$2r,W2r,rRr,tRr]),m8o=_.union([jle,Vle,Cvt,vRr]),h8o=_.union([i5,aRr,mRr,CRr]),g8o=_.union([Gle,k5e,pRr,D5e]),A8o=_.union([jle,Vle,R5e,j2r,H2r,_5e,w5e]),y8o=_.union([i5,g5e,P5e,T5e,x5e,y5e,C5e,v5e,ZM,S5e]),t0=class extends Error{static{s(this,"McpError")}constructor(e,r,n){super(`MCP error ${e}: ${r}`),this.code=e,this.data=n,this.name="McpError"}};var xRr=.7;async function Svt(t,e,r,n){try{let i=ty();_n.info(t,`MCP server ${n} requested sampling:`,r.params),await Qa(t,{message:`Sampling request received from ${n}: ${JSON.stringify({messageCount:r.params.messages.length,systemPrompt:r.params.systemPrompt?"provided":"none",maxTokens:r.params.maxTokens,temperature:r.params.temperature})}`,server:n});let o=await IRr(t,r),a=new Promise(A=>{setTimeout(()=>A(null),3e4)}),l=[t.get(wa).showInformationMessage(`Sampling request from ${n}. Do you want to proceed?`,{title:"Confirm"}),a],u=await Promise.race(l);if(u?.title!=="Confirm"){let A=u===null?`Sampling request from ${n} timed out (no response within 30 seconds).`:`Sampling request from ${n} was cancelled by the user.`;throw await Qa(t,{message:A,server:n}),new Error("Sampling request was not confirmed by the user.")}let f=ERr(t,r.params.messages,r.params.systemPrompt),p=(await qR(t,i,ty())).extendedBy({messageSource:"mcp.sampling"}),h=new hn.CancellationTokenSource().token,g=await e.fetchResponse({modelConfiguration:o,messages:f,uiKind:"conversationPanel",llmInteraction:Gd.user("conversation-panel",i),temperature:r.params.temperature??xRr,stop:r.params.stopSequences},h,p);return bRr(g,o.uiName)}catch(i){let o=`Failed to process sampling request: ${i instanceof Error?i.message:String(i)}`;throw _n.error(t,o,i),await hd(t,{message:o,server:n}),new t0(-32603,o)}}s(Svt,"handleSamplingRequest");function ERr(t,e,r){let n=[];r&&n.push({role:"system",content:r});for(let i of e){let o;if(i.content.type==="text")o=i.content.text;else if(i.content.type==="image")o=[{type:"image_url",image_url:{url:atob(i.content.data)}}];else throw _n.warn(t,`Unknown MCP content type: ${i.content.type}, defaulting to empty array`),new Error(`Unknown MCP content type: ${i.content.type}`);let a;switch(i.role){case"user":a="user";break;case"assistant":a="assistant";break;default:a="user",_n.warn(t,`Unknown MCP role: ${i.role}, defaulting to user`)}n.push({role:a,content:o})}return n}s(ERr,"convertMCPMessagesToChatML");function bRr(t,e){if(t.type!=="success"){let r=`Unexpected fetch result type: ${t.type}.`;throw"reason"in t&&(r+=` Reason: ${t.reason}`),new Error(r)}return{model:e,role:"assistant",content:{type:"text",text:t.value}}}s(bRr,"processFetchResult");async function IRr(t,e){let r=Ep("user");if(!r)throw new Error("No available models found");let n=e.params.modelPreferences?.hints?.find(o=>o.name&&r.find(a=>a.toLowerCase().includes(o.name.toLowerCase())))?.name;return await t.get(ha).getBestChatModelConfig([n??r[0]])}s(IRr,"getModelConfiguration");d();var B5e=/[^a-z0-9_-]/gi;var TRr=process.platform==="win32"?["APPDATA","HOMEDRIVE","HOMEPATH","LOCALAPPDATA","PATH","PROCESSOR_ARCHITECTURE","SYSTEMDRIVE","SYSTEMROOT","TEMP","USERNAME","USERPROFILE"]:["HOME","LOGNAME","PATH","SHELL","TERM","USER"];function _vt(){let t={};for(let e of TRr){let r=process.env[e];r!==void 0&&(r.startsWith("()")||(t[e]=r))}return t}s(_vt,"getDefaultEnvironment");async function Rvt(t,e,r){if(!e.description){let n=`Tool ${e.name} does not have a description. Tools must be accurately described to be called.`;_n.warn(t,n),await UP(t,{message:n,server:r,tool:e.name}),e.description="<empty>"}if(B5e.lastIndex=0,B5e.test(e.name)){let n=`Tool ${e.name} is invalid. Tools names may only contain [a-zA-Z0-9_-]`;_n.warn(t,n),await UP(t,{message:n,server:r,tool:e.name}),e._nameForModel=e.name.replace(B5e,"_")}else e._nameForModel=e.name;return e}s(Rvt,"normalizeTool");var Yle=class{constructor(){this.seenPrefixes=new Set}static{s(this,"McpPrefixGenerator")}generate(e){let r="mcp_"+e.toLowerCase().replace(/[^a-z0-9_.-]+/g,"_").slice(0,13),n=r;for(let i=2;this.seenPrefixes.has(n);i++)n=r+i;return this.seenPrefixes.add(n),n}};d();d();var wRr=6e4,Jle=class{static{s(this,"Protocol")}constructor(e){this._options=e,this._requestMessageId=0,this._requestHandlers=new Map,this._requestHandlerAbortControllers=new Map,this._notificationHandlers=new Map,this._responseHandlers=new Map,this._progressHandlers=new Map,this._timeoutInfo=new Map,this._pendingDebouncedNotifications=new Set,this.setNotificationHandler(jle,r=>{let n=this._requestHandlerAbortControllers.get(r.params.requestId);n?.abort(r.params.reason)}),this.setNotificationHandler(Vle,r=>{this._onprogress(r)}),this.setRequestHandler(Gle,r=>({}))}_setupTimeout(e,r,n,i,o=!1){this._timeoutInfo.set(e,{timeoutId:setTimeout(i,r),startTime:Date.now(),timeout:r,maxTotalTimeout:n,resetTimeoutOnProgress:o,onTimeout:i})}_resetTimeout(e){let r=this._timeoutInfo.get(e);if(!r)return!1;let n=Date.now()-r.startTime;if(r.maxTotalTimeout&&n>=r.maxTotalTimeout)throw this._timeoutInfo.delete(e),new t0(xg.RequestTimeout,"Maximum total timeout exceeded",{maxTotalTimeout:r.maxTotalTimeout,totalElapsed:n});return clearTimeout(r.timeoutId),r.timeoutId=setTimeout(r.onTimeout,r.timeout),!0}_cleanupTimeout(e){let r=this._timeoutInfo.get(e);r&&(clearTimeout(r.timeoutId),this._timeoutInfo.delete(e))}async connect(e){var r,n,i;this._transport=e;let o=(r=this.transport)===null||r===void 0?void 0:r.onclose;this._transport.onclose=()=>{o?.(),this._onclose()};let a=(n=this.transport)===null||n===void 0?void 0:n.onerror;this._transport.onerror=l=>{a?.(l),this._onerror(l)};let c=(i=this._transport)===null||i===void 0?void 0:i.onmessage;this._transport.onmessage=(l,u)=>{c?.(l,u),kH(l)||Avt(l)?this._onresponse(l):Wle(l)?this._onrequest(l,u):mvt(l)?this._onnotification(l):this._onerror(new Error(`Unknown message type: ${JSON.stringify(l)}`))},await this._transport.start()}_onclose(){var e;let r=this._responseHandlers;this._responseHandlers=new Map,this._progressHandlers.clear(),this._pendingDebouncedNotifications.clear(),this._transport=void 0,(e=this.onclose)===null||e===void 0||e.call(this);let n=new t0(xg.ConnectionClosed,"Connection closed");for(let i of r.values())i(n)}_onerror(e){var r;(r=this.onerror)===null||r===void 0||r.call(this,e)}_onnotification(e){var r;let n=(r=this._notificationHandlers.get(e.method))!==null&&r!==void 0?r:this.fallbackNotificationHandler;n!==void 0&&Promise.resolve().then(()=>n(e)).catch(i=>this._onerror(new Error(`Uncaught error in notification handler: ${i}`)))}_onrequest(e,r){var n,i,o,a;let c=(n=this._requestHandlers.get(e.method))!==null&&n!==void 0?n:this.fallbackRequestHandler;if(c===void 0){(i=this._transport)===null||i===void 0||i.send({jsonrpc:"2.0",id:e.id,error:{code:xg.MethodNotFound,message:"Method not found"}}).catch(f=>this._onerror(new Error(`Failed to send an error response: ${f}`)));return}let l=new AbortController;this._requestHandlerAbortControllers.set(e.id,l);let u={signal:l.signal,sessionId:(o=this._transport)===null||o===void 0?void 0:o.sessionId,_meta:(a=e.params)===null||a===void 0?void 0:a._meta,sendNotification:s(f=>this.notification(f,{relatedRequestId:e.id}),"sendNotification"),sendRequest:s((f,p,m)=>this.request(f,p,{...m,relatedRequestId:e.id}),"sendRequest"),authInfo:r?.authInfo,requestId:e.id,requestInfo:r?.requestInfo};Promise.resolve().then(()=>c(e,u)).then(f=>{var p;if(!l.signal.aborted)return(p=this._transport)===null||p===void 0?void 0:p.send({result:f,jsonrpc:"2.0",id:e.id})},f=>{var p,m;if(!l.signal.aborted)return(p=this._transport)===null||p===void 0?void 0:p.send({jsonrpc:"2.0",id:e.id,error:{code:Number.isSafeInteger(f.code)?f.code:xg.InternalError,message:(m=f.message)!==null&&m!==void 0?m:"Internal error"}})}).catch(f=>this._onerror(new Error(`Failed to send response: ${f}`))).finally(()=>{this._requestHandlerAbortControllers.delete(e.id)})}_onprogress(e){let{progressToken:r,...n}=e.params,i=Number(r),o=this._progressHandlers.get(i);if(!o){this._onerror(new Error(`Received a progress notification for an unknown token: ${JSON.stringify(e)}`));return}let a=this._responseHandlers.get(i),c=this._timeoutInfo.get(i);if(c&&a&&c.resetTimeoutOnProgress)try{this._resetTimeout(i)}catch(l){a(l);return}o(n)}_onresponse(e){let r=Number(e.id),n=this._responseHandlers.get(r);if(n===void 0){this._onerror(new Error(`Received a response for an unknown message ID: ${JSON.stringify(e)}`));return}if(this._responseHandlers.delete(r),this._progressHandlers.delete(r),this._cleanupTimeout(r),kH(e))n(e);else{let i=new t0(e.error.code,e.error.message,e.error.data);n(i)}}get transport(){return this._transport}async close(){var e;await((e=this._transport)===null||e===void 0?void 0:e.close())}request(e,r,n){let{relatedRequestId:i,resumptionToken:o,onresumptiontoken:a}=n??{};return new Promise((c,l)=>{var u,f,p,m,h,g;if(!this._transport){l(new Error("Not connected"));return}((u=this._options)===null||u===void 0?void 0:u.enforceStrictCapabilities)===!0&&this.assertCapabilityForMethod(e.method),(f=n?.signal)===null||f===void 0||f.throwIfAborted();let A=this._requestMessageId++,y={...e,jsonrpc:"2.0",id:A};n?.onprogress&&(this._progressHandlers.set(A,n.onprogress),y.params={...e.params,_meta:{...((p=e.params)===null||p===void 0?void 0:p._meta)||{},progressToken:A}});let E=s(R=>{var B;this._responseHandlers.delete(A),this._progressHandlers.delete(A),this._cleanupTimeout(A),(B=this._transport)===null||B===void 0||B.send({jsonrpc:"2.0",method:"notifications/cancelled",params:{requestId:A,reason:String(R)}},{relatedRequestId:i,resumptionToken:o,onresumptiontoken:a}).catch(L=>this._onerror(new Error(`Failed to send cancellation: ${L}`))),l(R)},"cancel");this._responseHandlers.set(A,R=>{var B;if(!(!((B=n?.signal)===null||B===void 0)&&B.aborted)){if(R instanceof Error)return l(R);try{let L=r.parse(R.result);c(L)}catch(L){l(L)}}}),(m=n?.signal)===null||m===void 0||m.addEventListener("abort",()=>{var R;E((R=n?.signal)===null||R===void 0?void 0:R.reason)});let b=(h=n?.timeout)!==null&&h!==void 0?h:wRr,S=s(()=>E(new t0(xg.RequestTimeout,"Request timed out",{timeout:b})),"timeoutHandler");this._setupTimeout(A,b,n?.maxTotalTimeout,S,(g=n?.resetTimeoutOnProgress)!==null&&g!==void 0?g:!1),this._transport.send(y,{relatedRequestId:i,resumptionToken:o,onresumptiontoken:a}).catch(R=>{this._cleanupTimeout(A),l(R)})})}async notification(e,r){var n,i;if(!this._transport)throw new Error("Not connected");if(this.assertNotificationCapability(e.method),((i=(n=this._options)===null||n===void 0?void 0:n.debouncedNotificationMethods)!==null&&i!==void 0?i:[]).includes(e.method)&&!e.params&&!r?.relatedRequestId){if(this._pendingDebouncedNotifications.has(e.method))return;this._pendingDebouncedNotifications.add(e.method),Promise.resolve().then(()=>{var l;if(this._pendingDebouncedNotifications.delete(e.method),!this._transport)return;let u={...e,jsonrpc:"2.0"};(l=this._transport)===null||l===void 0||l.send(u,r).catch(f=>this._onerror(f))});return}let c={...e,jsonrpc:"2.0"};await this._transport.send(c,r)}setRequestHandler(e,r){let n=e.shape.method.value;this.assertRequestHandlerCapability(n),this._requestHandlers.set(n,(i,o)=>Promise.resolve(r(e.parse(i),o)))}removeRequestHandler(e){this._requestHandlers.delete(e)}assertCanSetRequestHandler(e){if(this._requestHandlers.has(e))throw new Error(`A request handler for ${e} already exists, which would be overridden`)}setNotificationHandler(e,r){this._notificationHandlers.set(e.shape.method.value,n=>Promise.resolve(r(e.parse(n))))}removeNotificationHandler(e){this._notificationHandlers.delete(e)}};function kvt(t,e){return Object.entries(e).reduce((r,[n,i])=>(i&&typeof i=="object"?r[n]=r[n]?{...r[n],...i}:i:r[n]=i,r),{...t})}s(kvt,"mergeCapabilities");var DEt=Be(PEt(),1);var gue=class extends Jle{static{s(this,"Client")}constructor(e,r){var n;super(r),this._clientInfo=e,this._cachedToolOutputValidators=new Map,this._capabilities=(n=r?.capabilities)!==null&&n!==void 0?n:{},this._ajv=new DEt.default}registerCapabilities(e){if(this.transport)throw new Error("Cannot register capabilities after connecting to transport");this._capabilities=kvt(this._capabilities,e)}assertCapability(e,r){var n;if(!(!((n=this._serverCapabilities)===null||n===void 0)&&n[e]))throw new Error(`Server does not support ${e} (required for ${r})`)}async connect(e,r){if(await super.connect(e),e.sessionId===void 0)try{let n=await this.request({method:"initialize",params:{protocolVersion:XM,capabilities:this._capabilities,clientInfo:this._clientInfo}},g5e,r);if(n===void 0)throw new Error(`Server sent invalid initialize result: ${n}`);if(!lvt.includes(n.protocolVersion))throw new Error(`Server's protocol version is not supported: ${n.protocolVersion}`);this._serverCapabilities=n.capabilities,this._serverVersion=n.serverInfo,e.setProtocolVersion&&e.setProtocolVersion(n.protocolVersion),this._instructions=n.instructions,await this.notification({method:"notifications/initialized"})}catch(n){throw this.close(),n}}getServerCapabilities(){return this._serverCapabilities}getServerVersion(){return this._serverVersion}getInstructions(){return this._instructions}assertCapabilityForMethod(e){var r,n,i,o,a;switch(e){case"logging/setLevel":if(!(!((r=this._serverCapabilities)===null||r===void 0)&&r.logging))throw new Error(`Server does not support logging (required for ${e})`);break;case"prompts/get":case"prompts/list":if(!(!((n=this._serverCapabilities)===null||n===void 0)&&n.prompts))throw new Error(`Server does not support prompts (required for ${e})`);break;case"resources/list":case"resources/templates/list":case"resources/read":case"resources/subscribe":case"resources/unsubscribe":if(!(!((i=this._serverCapabilities)===null||i===void 0)&&i.resources))throw new Error(`Server does not support resources (required for ${e})`);if(e==="resources/subscribe"&&!this._serverCapabilities.resources.subscribe)throw new Error(`Server does not support resource subscriptions (required for ${e})`);break;case"tools/call":case"tools/list":if(!(!((o=this._serverCapabilities)===null||o===void 0)&&o.tools))throw new Error(`Server does not support tools (required for ${e})`);break;case"completion/complete":if(!(!((a=this._serverCapabilities)===null||a===void 0)&&a.completions))throw new Error(`Server does not support completions (required for ${e})`);break;case"initialize":break;case"ping":break}}assertNotificationCapability(e){var r;switch(e){case"notifications/roots/list_changed":if(!(!((r=this._capabilities.roots)===null||r===void 0)&&r.listChanged))throw new Error(`Client does not support roots list changed notifications (required for ${e})`);break;case"notifications/initialized":break;case"notifications/cancelled":break;case"notifications/progress":break}}assertRequestHandlerCapability(e){switch(e){case"sampling/createMessage":if(!this._capabilities.sampling)throw new Error(`Client does not support sampling capability (required for ${e})`);break;case"elicitation/create":if(!this._capabilities.elicitation)throw new Error(`Client does not support elicitation capability (required for ${e})`);break;case"roots/list":if(!this._capabilities.roots)throw new Error(`Client does not support roots capability (required for ${e})`);break;case"ping":break}}async ping(e){return this.request({method:"ping"},i5,e)}async complete(e,r){return this.request({method:"completion/complete",params:e},P5e,r)}async setLoggingLevel(e,r){return this.request({method:"logging/setLevel",params:{level:e}},i5,r)}async getPrompt(e,r){return this.request({method:"prompts/get",params:e},T5e,r)}async listPrompts(e,r){return this.request({method:"prompts/list",params:e},x5e,r)}async listResources(e,r){return this.request({method:"resources/list",params:e},y5e,r)}async listResourceTemplates(e,r){return this.request({method:"resources/templates/list",params:e},C5e,r)}async readResource(e,r){return this.request({method:"resources/read",params:e},v5e,r)}async subscribeResource(e,r){return this.request({method:"resources/subscribe",params:e},i5,r)}async unsubscribeResource(e,r){return this.request({method:"resources/unsubscribe",params:e},i5,r)}async callTool(e,r=ZM,n){let i=await this.request({method:"tools/call",params:e},r,n),o=this.getToolOutputValidator(e.name);if(o){if(!i.structuredContent&&!i.isError)throw new t0(xg.InvalidRequest,`Tool ${e.name} has an output schema but did not return structured content`);if(i.structuredContent)try{if(!o(i.structuredContent))throw new t0(xg.InvalidParams,`Structured content does not match the tool's output schema: ${this._ajv.errorsText(o.errors)}`)}catch(a){throw a instanceof t0?a:new t0(xg.InvalidParams,`Failed to validate structured content: ${a instanceof Error?a.message:String(a)}`)}}return i}cacheToolOutputSchemas(e){this._cachedToolOutputValidators.clear();for(let r of e)if(r.outputSchema)try{let n=this._ajv.compile(r.outputSchema);this._cachedToolOutputValidators.set(r.name,n)}catch{}}getToolOutputValidator(e){return this._cachedToolOutputValidators.get(e)}async listTools(e,r){let n=await this.request({method:"tools/list",params:e},S5e,r);return this.cacheToolOutputSchemas(n.tools),n}async sendRootsListChanged(){return this.notification({method:"notifications/roots/list_changed"})}};var BEt=Be(require("events"));var qS=class{constructor(e,r,n){this.transport=null;this.emitter=new BEt.default;this.ctx=e,this.mcp=new gue({name:r,version:n},{capabilities:{roots:{listChanged:!0},sampling:{}}}),this.name=r}static{s(this,"MCPBaseServer")}async connect(e){if(this.transport=this.initTransport(e),!this.transport){let r=new Error("Failed to initialize transport");throw _n.error(this.ctx,"Transport initialization failed:",r),r}this.addListeners();try{await this.mcp.connect(this.transport)}catch(r){throw _n.error(this.ctx,"Connection failed:",r),await hd(this.ctx,{message:`Failed to connect to MCP server: ${r instanceof Error?r.message:String(r)}`,server:this.name}),r}}async getToolsList(){let e=Promise.resolve([]);if(this.transport){let r=await this.mcp.listTools();e=Promise.all(r.tools.map(async i=>{let o={name:i.name,description:i.description,inputSchema:{...i.inputSchema||{},properties:i.inputSchema?.properties||{},type:i.inputSchema?.type||"object"},_status:"enabled",_nameForModel:i.name,annotations:i.annotations};return await Rvt(this.ctx,o,this.name),o}));let n=`Discovered ${r.tools.length} tools`;Qa(this.ctx,{message:n,server:this.name})}return e}async callTool(e,r,n){let i=new Ao([],"error"),o=ty(),a=new AbortController;n.onCancellationRequested(()=>{a.abort()});try{let c=await this.mcp.callTool({name:e,arguments:r,_meta:{progressToken:o}},ZM,{onprogress:s(l=>{_n.info(this.ctx,`${e} calling progress`,l),Qa(this.ctx,{message:`${e} calling progress:`+JSON.stringify(l),server:this.name})},"onprogress"),resetTimeoutOnProgress:!0,signal:a.signal});if(c&&typeof c=="object"){if(c.content)return this.formatToolResult(c);{let l=`Error calling tool ${e}: `+JSON.stringify(c);_n.error(this.ctx,l),await hd(this.ctx,{message:l,server:this.name,tool:e}),i.content.push(new Oi(l))}}else{let l=`Error calling tool ${e}: `+JSON.stringify(c);_n.error(this.ctx,l),await hd(this.ctx,{message:l,server:this.name,tool:e}),i.content.push(new Oi(l))}}catch(c){let l=`Error calling tool ${e}: `+(c instanceof Error?c.message:String(c));_n.error(this.ctx,l),await hd(this.ctx,{message:l,server:this.name,tool:e}),i.content.push(new Oi(l))}return i}addListeners(){this.mcp.onclose=()=>{_n.info(this.ctx,`MCP server ${this.name} connection closed.`),Qa(this.ctx,{message:"Connection state: Stopped",server:this.name})},this.mcp.onerror=e=>{_n.error(this.ctx,`MCP server ${this.name} error:`,e),hd(this.ctx,{message:`Connection state: Error: ${e.message}`,server:this.name})},this.mcp.setNotificationHandler(R5e,e=>new TH(this.ctx,this.name).handle(e)),this.mcp.setNotificationHandler(_5e,e=>new _H(this.ctx,this.name,this.emitter).handle(e)),this.mcp.setNotificationHandler(w5e,e=>new wH(this.ctx,this.name,this.emitter).handle(e)),this.mcp.setRequestHandler(D5e,e=>(this.initRootsTracker(),new SH(this.ctx,this.name).handle(e))),this.mcp.setRequestHandler(k5e,async e=>await Svt(this.ctx,new Ps(this.ctx),e,this.name))}formatToolResult(e){let r=new Ao([],e.isError===!0?"error":"success");for(let n of e.content)n.type==="text"?r.content.push(new Oi(n.text)):(n.type==="image"||n.type==="audio")&&r.content.push(new sP({mimeType:n.mimeType,data:n.data}));return r}initRootsTracker(){let e=this.ctx.get(dr);this.rootsTracker=e.onDidChangeWorkspaceFolders(r=>{this.mcp.sendRootsListChanged().then(()=>{this.rootsTracker?.dispose()})})}getEmitter(){return this.emitter}async cleanup(){this.transport&&(await this.mcp.close(),this.rootsTracker?.dispose())}};d();function oPr(t){return s(async(r,n)=>{let i=r instanceof URL?r.toString():r,o;if(n?.headers)if(n.headers instanceof Headers){o={};for(let[f,p]of n.headers.entries())o[f]=p}else if(Array.isArray(n.headers)){o={};for(let[f,p]of n.headers)o[f]=p}else o=n.headers;let a={method:n?.method||"GET",headers:o,body:n?.body,signal:n?.signal||void 0},c=await t.fetch(i,a),l=c.body(),u=null;if(l)u=new ReadableStream({start(f){let p=s(A=>{f.enqueue(new Uint8Array(A))},"onData"),m=s(()=>{f.close(),g()},"onEnd"),h=s(A=>{f.error(A),g()},"onError"),g=s(()=>{l.off("data",p),l.off("end",m),l.off("error",h)},"cleanup");l.on("data",p),l.on("end",m),l.on("error",h)},cancel(){l&&"destroy"in l&&typeof l.destroy=="function"&&l.destroy()}});else{let f=await c.text();u=new ReadableStream({start(p){p.enqueue(new TextEncoder().encode(f)),p.close()}})}return new globalThis.Response(u,{status:c.status,statusText:c.statusText,headers:new Headers(c.headers)})},"fetchLike")}s(oPr,"createFetchAdapter");function Aue(t,e){let r=t.get(Or),n=oPr(r);return{...e,fetch:n}}s(Aue,"createConfigWithFetch");d();d();d();var yue=class extends Error{static{s(this,"ParseError")}constructor(e,r){super(e),this.name="ParseError",this.type=r.type,this.field=r.field,this.value=r.value,this.line=r.line}};function i4e(t){}s(i4e,"noop");function Cue(t){if(typeof t=="function")throw new TypeError("`callbacks` must be an object, got a function instead. Did you mean `{onEvent: fn}`?");let{onEvent:e=i4e,onError:r=i4e,onRetry:n=i4e,onComment:i}=t,o="",a=!0,c,l="",u="";function f(A){let y=a?A.replace(/^\xEF\xBB\xBF/,""):A,[E,b]=sPr(`${o}${y}`);for(let S of E)p(S);o=b,a=!1}s(f,"feed");function p(A){if(A===""){h();return}if(A.startsWith(":")){i&&i(A.slice(A.startsWith(": ")?2:1));return}let y=A.indexOf(":");if(y!==-1){let E=A.slice(0,y),b=A[y+1]===" "?2:1,S=A.slice(y+b);m(E,S,A);return}m(A,"",A)}s(p,"parseLine");function m(A,y,E){switch(A){case"event":u=y;break;case"data":l=`${l}${y}
`;break;case"id":c=y.includes("\0")?void 0:y;break;case"retry":/^\d+$/.test(y)?n(parseInt(y,10)):r(new yue(`Invalid \`retry\` value: "${y}"`,{type:"invalid-retry",value:y,line:E}));break;default:r(new yue(`Unknown field "${A.length>20?`${A.slice(0,20)}\u2026`:A}"`,{type:"unknown-field",field:A,value:y,line:E}));break}}s(m,"processField");function h(){l.length>0&&e({id:c,event:u||void 0,data:l.endsWith(`
`)?l.slice(0,-1):l}),c=void 0,l="",u=""}s(h,"dispatchEvent");function g(A={}){o&&A.consume&&p(o),a=!0,c=void 0,l="",u="",o=""}return s(g,"reset"),{feed:f,reset:g}}s(Cue,"createParser");function sPr(t){let e=[],r="",n=0;for(;n<t.length;){let i=t.indexOf("\r",n),o=t.indexOf(`
`,n),a=-1;if(i!==-1&&o!==-1?a=Math.min(i,o):i!==-1?a=i:o!==-1&&(a=o),a===-1){r=t.slice(n);break}else{let c=t.slice(n,a);e.push(c),n=a+1,t[n-1]==="\r"&&t[n]===`
`&&n++}}return[e,r]}s(sPr,"splitLines");var xue=class extends Event{static{s(this,"ErrorEvent")}constructor(e,r){var n,i;super(e),this.code=(n=r?.code)!=null?n:void 0,this.message=(i=r?.message)!=null?i:void 0}[Symbol.for("nodejs.util.inspect.custom")](e,r,n){return n(NEt(this),r)}[Symbol.for("Deno.customInspect")](e,r){return e(NEt(this),r)}};function aPr(t){let e=globalThis.DOMException;return typeof e=="function"?new e(t,"SyntaxError"):new SyntaxError(t)}s(aPr,"syntaxError");function o4e(t){return t instanceof Error?"errors"in t&&Array.isArray(t.errors)?t.errors.map(o4e).join(", "):"cause"in t&&t.cause instanceof Error?`${t}: ${o4e(t.cause)}`:t.message:`${t}`}s(o4e,"flattenError");function NEt(t){return{type:t.type,message:t.message,code:t.code,defaultPrevented:t.defaultPrevented,cancelable:t.cancelable,timeStamp:t.timeStamp}}s(NEt,"inspectableError");var LEt=s(t=>{throw TypeError(t)},"__typeError"),p4e=s((t,e,r)=>e.has(t)||LEt("Cannot "+r),"__accessCheck"),ro=s((t,e,r)=>(p4e(t,e,"read from private field"),r?r.call(t):e.get(t)),"__privateGet"),Wl=s((t,e,r)=>e.has(t)?LEt("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,r),"__privateAdd"),Ua=s((t,e,r,n)=>(p4e(t,e,"write to private field"),e.set(t,r),r),"__privateSet"),VE=s((t,e,r)=>(p4e(t,e,"access private method"),r),"__privateMethod"),n0,a5,eL,vue,Eue,MH,nL,LH,HS,tL,iL,rL,BH,wy,s4e,a4e,c4e,MEt,l4e,u4e,NH,d4e,f4e,c5=class extends EventTarget{static{s(this,"EventSource")}constructor(e,r){var n,i;super(),Wl(this,wy),this.CONNECTING=0,this.OPEN=1,this.CLOSED=2,Wl(this,n0),Wl(this,a5),Wl(this,eL),Wl(this,vue),Wl(this,Eue),Wl(this,MH),Wl(this,nL),Wl(this,LH,null),Wl(this,HS),Wl(this,tL),Wl(this,iL,null),Wl(this,rL,null),Wl(this,BH,null),Wl(this,a4e,async o=>{var a;ro(this,tL).reset();let{body:c,redirected:l,status:u,headers:f}=o;if(u===204){VE(this,wy,NH).call(this,"Server sent HTTP 204, not reconnecting",204),this.close();return}if(l?Ua(this,eL,new URL(o.url)):Ua(this,eL,void 0),u!==200){VE(this,wy,NH).call(this,`Non-200 status code (${u})`,u);return}if(!(f.get("content-type")||"").startsWith("text/event-stream")){VE(this,wy,NH).call(this,'Invalid content type, expected "text/event-stream"',u);return}if(ro(this,n0)===this.CLOSED)return;Ua(this,n0,this.OPEN);let p=new Event("open");if((a=ro(this,BH))==null||a.call(this,p),this.dispatchEvent(p),typeof c!="object"||!c||!("getReader"in c)){VE(this,wy,NH).call(this,"Invalid response body, expected a web ReadableStream",u),this.close();return}let m=new TextDecoder,h=c.getReader(),g=!0;do{let{done:A,value:y}=await h.read();y&&ro(this,tL).feed(m.decode(y,{stream:!A})),A&&(g=!1,ro(this,tL).reset(),VE(this,wy,d4e).call(this))}while(g)}),Wl(this,c4e,o=>{Ua(this,HS,void 0),!(o.name==="AbortError"||o.type==="aborted")&&VE(this,wy,d4e).call(this,o4e(o))}),Wl(this,l4e,o=>{typeof o.id=="string"&&Ua(this,LH,o.id);let a=new MessageEvent(o.event||"message",{data:o.data,origin:ro(this,eL)?ro(this,eL).origin:ro(this,a5).origin,lastEventId:o.id||""});ro(this,rL)&&(!o.event||o.event==="message")&&ro(this,rL).call(this,a),this.dispatchEvent(a)}),Wl(this,u4e,o=>{Ua(this,MH,o)}),Wl(this,f4e,()=>{Ua(this,nL,void 0),ro(this,n0)===this.CONNECTING&&VE(this,wy,s4e).call(this)});try{if(e instanceof URL)Ua(this,a5,e);else if(typeof e=="string")Ua(this,a5,new URL(e,cPr()));else throw new Error("Invalid URL")}catch{throw aPr("An invalid or illegal string was specified")}Ua(this,tL,Cue({onEvent:ro(this,l4e),onRetry:ro(this,u4e)})),Ua(this,n0,this.CONNECTING),Ua(this,MH,3e3),Ua(this,Eue,(n=r?.fetch)!=null?n:globalThis.fetch),Ua(this,vue,(i=r?.withCredentials)!=null?i:!1),VE(this,wy,s4e).call(this)}get readyState(){return ro(this,n0)}get url(){return ro(this,a5).href}get withCredentials(){return ro(this,vue)}get onerror(){return ro(this,iL)}set onerror(e){Ua(this,iL,e)}get onmessage(){return ro(this,rL)}set onmessage(e){Ua(this,rL,e)}get onopen(){return ro(this,BH)}set onopen(e){Ua(this,BH,e)}addEventListener(e,r,n){let i=r;super.addEventListener(e,i,n)}removeEventListener(e,r,n){let i=r;super.removeEventListener(e,i,n)}close(){ro(this,nL)&&clearTimeout(ro(this,nL)),ro(this,n0)!==this.CLOSED&&(ro(this,HS)&&ro(this,HS).abort(),Ua(this,n0,this.CLOSED),Ua(this,HS,void 0))}};n0=new WeakMap,a5=new WeakMap,eL=new WeakMap,vue=new WeakMap,Eue=new WeakMap,MH=new WeakMap,nL=new WeakMap,LH=new WeakMap,HS=new WeakMap,tL=new WeakMap,iL=new WeakMap,rL=new WeakMap,BH=new WeakMap,wy=new WeakSet,s4e=s(function(){Ua(this,n0,this.CONNECTING),Ua(this,HS,new AbortController),ro(this,Eue)(ro(this,a5),VE(this,wy,MEt).call(this)).then(ro(this,a4e)).catch(ro(this,c4e))},"connect_fn"),a4e=new WeakMap,c4e=new WeakMap,MEt=s(function(){var t;let e={mode:"cors",redirect:"follow",headers:{Accept:"text/event-stream",...ro(this,LH)?{"Last-Event-ID":ro(this,LH)}:void 0},cache:"no-store",signal:(t=ro(this,HS))==null?void 0:t.signal};return"window"in globalThis&&(e.credentials=this.withCredentials?"include":"same-origin"),e},"getRequestOptions_fn"),l4e=new WeakMap,u4e=new WeakMap,NH=s(function(t,e){var r;ro(this,n0)!==this.CLOSED&&Ua(this,n0,this.CLOSED);let n=new xue("error",{code:e,message:t});(r=ro(this,iL))==null||r.call(this,n),this.dispatchEvent(n)},"failConnection_fn"),d4e=s(function(t,e){var r;if(ro(this,n0)===this.CLOSED)return;Ua(this,n0,this.CONNECTING);let n=new xue("error",{code:e,message:t});(r=ro(this,iL))==null||r.call(this,n),this.dispatchEvent(n),Ua(this,nL,setTimeout(ro(this,f4e),ro(this,MH)))},"scheduleReconnect_fn"),f4e=new WeakMap,c5.CONNECTING=0,c5.OPEN=1,c5.CLOSED=2;function cPr(){let t="document"in globalThis?globalThis.document:void 0;return t&&typeof t=="object"&&"baseURI"in t&&typeof t.baseURI=="string"?t.baseURI:void 0}s(cPr,"getBaseURL");d();d();var m4e;m4e=globalThis.crypto?.webcrypto??globalThis.crypto??import("node:crypto").then(t=>t.webcrypto);async function lPr(t){return(await m4e).getRandomValues(new Uint8Array(t))}s(lPr,"getRandomValues");async function uPr(t){let e="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789-._~",r="",n=await lPr(t);for(let i=0;i<t;i++){let o=n[i]%e.length;r+=e[o]}return r}s(uPr,"random");async function dPr(t){return await uPr(t)}s(dPr,"generateVerifier");async function fPr(t){let e=await(await m4e).subtle.digest("SHA-256",new TextEncoder().encode(t));return btoa(String.fromCharCode(...new Uint8Array(e))).replace(/\//g,"_").replace(/\+/g,"-").replace(/=/g,"")}s(fPr,"generateChallenge");async function h4e(t){if(t||(t=43),t<43||t>128)throw`Expected a length between 43 and 128. Received ${t}.`;let e=await dPr(t),r=await fPr(e);return{code_verifier:e,code_challenge:r}}s(h4e,"pkceChallenge");d();var FEt=_.object({resource:_.string().url(),authorization_servers:_.array(_.string().url()).optional(),jwks_uri:_.string().url().optional(),scopes_supported:_.array(_.string()).optional(),bearer_methods_supported:_.array(_.string()).optional(),resource_signing_alg_values_supported:_.array(_.string()).optional(),resource_name:_.string().optional(),resource_documentation:_.string().optional(),resource_policy_uri:_.string().url().optional(),resource_tos_uri:_.string().url().optional(),tls_client_certificate_bound_access_tokens:_.boolean().optional(),authorization_details_types_supported:_.array(_.string()).optional(),dpop_signing_alg_values_supported:_.array(_.string()).optional(),dpop_bound_access_tokens_required:_.boolean().optional()}).passthrough(),g4e=_.object({issuer:_.string(),authorization_endpoint:_.string(),token_endpoint:_.string(),registration_endpoint:_.string().optional(),scopes_supported:_.array(_.string()).optional(),response_types_supported:_.array(_.string()),response_modes_supported:_.array(_.string()).optional(),grant_types_supported:_.array(_.string()).optional(),token_endpoint_auth_methods_supported:_.array(_.string()).optional(),token_endpoint_auth_signing_alg_values_supported:_.array(_.string()).optional(),service_documentation:_.string().optional(),revocation_endpoint:_.string().optional(),revocation_endpoint_auth_methods_supported:_.array(_.string()).optional(),revocation_endpoint_auth_signing_alg_values_supported:_.array(_.string()).optional(),introspection_endpoint:_.string().optional(),introspection_endpoint_auth_methods_supported:_.array(_.string()).optional(),introspection_endpoint_auth_signing_alg_values_supported:_.array(_.string()).optional(),code_challenge_methods_supported:_.array(_.string()).optional()}).passthrough(),pPr=_.object({issuer:_.string(),authorization_endpoint:_.string(),token_endpoint:_.string(),userinfo_endpoint:_.string().optional(),jwks_uri:_.string(),registration_endpoint:_.string().optional(),scopes_supported:_.array(_.string()).optional(),response_types_supported:_.array(_.string()),response_modes_supported:_.array(_.string()).optional(),grant_types_supported:_.array(_.string()).optional(),acr_values_supported:_.array(_.string()).optional(),subject_types_supported:_.array(_.string()),id_token_signing_alg_values_supported:_.array(_.string()),id_token_encryption_alg_values_supported:_.array(_.string()).optional(),id_token_encryption_enc_values_supported:_.array(_.string()).optional(),userinfo_signing_alg_values_supported:_.array(_.string()).optional(),userinfo_encryption_alg_values_supported:_.array(_.string()).optional(),userinfo_encryption_enc_values_supported:_.array(_.string()).optional(),request_object_signing_alg_values_supported:_.array(_.string()).optional(),request_object_encryption_alg_values_supported:_.array(_.string()).optional(),request_object_encryption_enc_values_supported:_.array(_.string()).optional(),token_endpoint_auth_methods_supported:_.array(_.string()).optional(),token_endpoint_auth_signing_alg_values_supported:_.array(_.string()).optional(),display_values_supported:_.array(_.string()).optional(),claim_types_supported:_.array(_.string()).optional(),claims_supported:_.array(_.string()).optional(),service_documentation:_.string().optional(),claims_locales_supported:_.array(_.string()).optional(),ui_locales_supported:_.array(_.string()).optional(),claims_parameter_supported:_.boolean().optional(),request_parameter_supported:_.boolean().optional(),request_uri_parameter_supported:_.boolean().optional(),require_request_uri_registration:_.boolean().optional(),op_policy_uri:_.string().optional(),op_tos_uri:_.string().optional()}).passthrough(),OEt=pPr.merge(g4e.pick({code_challenge_methods_supported:!0})),A4e=_.object({access_token:_.string(),id_token:_.string().optional(),token_type:_.string(),expires_in:_.number().optional(),scope:_.string().optional(),refresh_token:_.string().optional()}).strip(),QEt=_.object({error:_.string(),error_description:_.string().optional(),error_uri:_.string().optional()}),mPr=_.object({redirect_uris:_.array(_.string()).refine(t=>t.every(e=>URL.canParse(e)),{message:"redirect_uris must contain valid URLs"}),token_endpoint_auth_method:_.string().optional(),grant_types:_.array(_.string()).optional(),response_types:_.array(_.string()).optional(),client_name:_.string().optional(),client_uri:_.string().optional(),logo_uri:_.string().optional(),scope:_.string().optional(),contacts:_.array(_.string()).optional(),tos_uri:_.string().optional(),policy_uri:_.string().optional(),jwks_uri:_.string().optional(),jwks:_.any().optional(),software_id:_.string().optional(),software_version:_.string().optional(),software_statement:_.string().optional()}).strip(),hPr=_.object({client_id:_.string(),client_secret:_.string().optional(),client_id_issued_at:_.number().optional(),client_secret_expires_at:_.number().optional()}).strip(),UEt=mPr.merge(hPr),o9o=_.object({error:_.string(),error_description:_.string().optional()}).strip(),s9o=_.object({token:_.string(),token_type_hint:_.string().optional()}).strip();d();function qEt(t){let e=typeof t=="string"?new URL(t):new URL(t.href);return e.hash="",e}s(qEt,"resourceUrlFromServerUrl");function HEt({requestedResource:t,configuredResource:e}){let r=typeof t=="string"?new URL(t):new URL(t.href),n=typeof e=="string"?new URL(e):new URL(e.href);if(r.origin!==n.origin||r.pathname.length<n.pathname.length)return!1;let i=r.pathname.endsWith("/")?r.pathname:r.pathname+"/",o=n.pathname.endsWith("/")?n.pathname:n.pathname+"/";return i.startsWith(o)}s(HEt,"checkResourceAllowed");d();var Il=class extends Error{static{s(this,"OAuthError")}constructor(e,r){super(e),this.errorUri=r,this.name=this.constructor.name}toResponseObject(){let e={error:this.errorCode,error_description:this.message};return this.errorUri&&(e.error_uri=this.errorUri),e}get errorCode(){return this.constructor.errorCode}},FH=class extends Il{static{s(this,"InvalidRequestError")}};FH.errorCode="invalid_request";var l5=class extends Il{static{s(this,"InvalidClientError")}};l5.errorCode="invalid_client";var u5=class extends Il{static{s(this,"InvalidGrantError")}};u5.errorCode="invalid_grant";var d5=class extends Il{static{s(this,"UnauthorizedClientError")}};d5.errorCode="unauthorized_client";var OH=class extends Il{static{s(this,"UnsupportedGrantTypeError")}};OH.errorCode="unsupported_grant_type";var QH=class extends Il{static{s(this,"InvalidScopeError")}};QH.errorCode="invalid_scope";var UH=class extends Il{static{s(this,"AccessDeniedError")}};UH.errorCode="access_denied";var zE=class extends Il{static{s(this,"ServerError")}};zE.errorCode="server_error";var qH=class extends Il{static{s(this,"TemporarilyUnavailableError")}};qH.errorCode="temporarily_unavailable";var HH=class extends Il{static{s(this,"UnsupportedResponseTypeError")}};HH.errorCode="unsupported_response_type";var $H=class extends Il{static{s(this,"UnsupportedTokenTypeError")}};$H.errorCode="unsupported_token_type";var WH=class extends Il{static{s(this,"InvalidTokenError")}};WH.errorCode="invalid_token";var jH=class extends Il{static{s(this,"MethodNotAllowedError")}};jH.errorCode="method_not_allowed";var GH=class extends Il{static{s(this,"TooManyRequestsError")}};GH.errorCode="too_many_requests";var VH=class extends Il{static{s(this,"InvalidClientMetadataError")}};VH.errorCode="invalid_client_metadata";var zH=class extends Il{static{s(this,"InsufficientScopeError")}};zH.errorCode="insufficient_scope";var $Et={[FH.errorCode]:FH,[l5.errorCode]:l5,[u5.errorCode]:u5,[d5.errorCode]:d5,[OH.errorCode]:OH,[QH.errorCode]:QH,[UH.errorCode]:UH,[zE.errorCode]:zE,[qH.errorCode]:qH,[HH.errorCode]:HH,[$H.errorCode]:$H,[WH.errorCode]:WH,[jH.errorCode]:jH,[GH.errorCode]:GH,[VH.errorCode]:VH,[zH.errorCode]:zH};var i0=class extends Error{static{s(this,"UnauthorizedError")}constructor(e){super(e??"Unauthorized")}};function jEt(t,e){let r=t.client_secret!==void 0;return e.length===0?r?"client_secret_post":"none":r&&e.includes("client_secret_basic")?"client_secret_basic":r&&e.includes("client_secret_post")?"client_secret_post":e.includes("none")?"none":r?"client_secret_post":"none"}s(jEt,"selectClientAuthMethod");function GEt(t,e,r,n){let{client_id:i,client_secret:o}=e;switch(t){case"client_secret_basic":gPr(i,o,r);return;case"client_secret_post":APr(i,o,n);return;case"none":yPr(i,n);return;default:throw new Error(`Unsupported client authentication method: ${t}`)}}s(GEt,"applyClientAuthentication");function gPr(t,e,r){if(!e)throw new Error("client_secret_basic authentication requires a client_secret");let n=btoa(`${t}:${e}`);r.set("Authorization",`Basic ${n}`)}s(gPr,"applyBasicAuth");function APr(t,e,r){r.set("client_id",t),e&&r.set("client_secret",e)}s(APr,"applyPostAuth");function yPr(t,e){e.set("client_id",t)}s(yPr,"applyPublicAuth");async function C4e(t){let e=t instanceof Response?t.status:void 0,r=t instanceof Response?await t.text():t;try{let n=QEt.parse(JSON.parse(r)),{error:i,error_description:o,error_uri:a}=n,c=$Et[i]||zE;return new c(o||"",a)}catch(n){let i=`${e?`HTTP ${e}: `:""}Invalid OAuth error response: ${n}. Raw body: ${r}`;return new zE(i)}}s(C4e,"parseErrorResponse");async function $S(t,e){var r,n;try{return await y4e(t,e)}catch(i){if(i instanceof l5||i instanceof d5)return await((r=t.invalidateCredentials)===null||r===void 0?void 0:r.call(t,"all")),await y4e(t,e);if(i instanceof u5)return await((n=t.invalidateCredentials)===null||n===void 0?void 0:n.call(t,"tokens")),await y4e(t,e);throw i}}s($S,"auth");async function y4e(t,{serverUrl:e,authorizationCode:r,scope:n,resourceMetadataUrl:i,fetchFn:o}){let a,c;try{a=await vPr(e,{resourceMetadataUrl:i},o),a.authorization_servers&&a.authorization_servers.length>0&&(c=a.authorization_servers[0])}catch{}c||(c=e);let l=await CPr(e,t,a),u=await TPr(c,{fetchFn:o}),f=await Promise.resolve(t.clientInformation());if(!f){if(r!==void 0)throw new Error("Existing OAuth client information is required when exchanging an authorization code");if(!t.saveClientInformation)throw new Error("OAuth client information must be saveable for dynamic registration");let A=await RPr(c,{metadata:u,clientMetadata:t.clientMetadata});await t.saveClientInformation(A),f=A}if(r!==void 0){let A=await t.codeVerifier(),y=await SPr(c,{metadata:u,clientInformation:f,authorizationCode:r,codeVerifier:A,redirectUri:t.redirectUrl,resource:l,addClientAuthentication:t.addClientAuthentication,fetchFn:o});return await t.saveTokens(y),"AUTHORIZED"}let p=await t.tokens();if(p?.refresh_token)try{let A=await _Pr(c,{metadata:u,clientInformation:f,refreshToken:p.refresh_token,resource:l,addClientAuthentication:t.addClientAuthentication});return await t.saveTokens(A),"AUTHORIZED"}catch(A){if(!(!(A instanceof Il)||A instanceof zE))throw A}let m=t.state?await t.state():void 0,{authorizationUrl:h,codeVerifier:g}=await wPr(c,{metadata:u,clientInformation:f,state:m,redirectUrl:t.redirectUrl,scope:n||t.clientMetadata.scope,resource:l});return await t.saveCodeVerifier(g),await t.redirectToAuthorization(h),"REDIRECT"}s(y4e,"authInternal");async function CPr(t,e,r){let n=qEt(t);if(e.validateResourceURL)return await e.validateResourceURL(n,r?.resource);if(r){if(!HEt({requestedResource:n,configuredResource:r.resource}))throw new Error(`Protected resource ${r.resource} does not match expected ${n} (or origin)`);return new URL(r.resource)}}s(CPr,"selectResourceURL");function KH(t){let e=t.headers.get("WWW-Authenticate");if(!e)return;let[r,n]=e.split(" ");if(r.toLowerCase()!=="bearer"||!n)return;let o=/resource_metadata="([^"]*)"/.exec(e);if(o)try{return new URL(o[1])}catch{return}}s(KH,"extractResourceMetadataUrl");async function vPr(t,e,r=fetch){let n=await bPr(t,"oauth-protected-resource",r,{protocolVersion:e?.protocolVersion,metadataUrl:e?.resourceMetadataUrl});if(!n||n.status===404)throw new Error("Resource server does not implement OAuth 2.0 Protected Resource Metadata.");if(!n.ok)throw new Error(`HTTP ${n.status} trying to load well-known OAuth protected resource metadata.`);return FEt.parse(await n.json())}s(vPr,"discoverOAuthProtectedResourceMetadata");async function v4e(t,e,r=fetch){try{return await r(t,{headers:e})}catch(n){if(n instanceof TypeError)return e?v4e(t,void 0,r):void 0;throw n}}s(v4e,"fetchWithCorsRetry");function xPr(t,e="",r={}){return e.endsWith("/")&&(e=e.slice(0,-1)),r.prependPathname?`${e}/.well-known/${t}`:`/.well-known/${t}${e}`}s(xPr,"buildWellKnownPath");async function WEt(t,e,r=fetch){return await v4e(t,{"MCP-Protocol-Version":e},r)}s(WEt,"tryMetadataDiscovery");function EPr(t,e){return!t||t.status===404&&e!=="/"}s(EPr,"shouldAttemptFallback");async function bPr(t,e,r,n){var i,o;let a=new URL(t),c=(i=n?.protocolVersion)!==null&&i!==void 0?i:XM,l;if(n?.metadataUrl)l=new URL(n.metadataUrl);else{let f=xPr(e,a.pathname);l=new URL(f,(o=n?.metadataServerUrl)!==null&&o!==void 0?o:a),l.search=a.search}let u=await WEt(l,c,r);if(!n?.metadataUrl&&EPr(u,a.pathname)){let f=new URL(`/.well-known/${e}`,a);u=await WEt(f,c,r)}return u}s(bPr,"discoverMetadataWithFallback");function IPr(t){let e=typeof t=="string"?new URL(t):t,r=e.pathname!=="/",n=[];if(!r)return n.push({url:new URL("/.well-known/oauth-authorization-server",e.origin),type:"oauth"}),n.push({url:new URL("/.well-known/openid-configuration",e.origin),type:"oidc"}),n;let i=e.pathname;return i.endsWith("/")&&(i=i.slice(0,-1)),n.push({url:new URL(`/.well-known/oauth-authorization-server${i}`,e.origin),type:"oauth"}),n.push({url:new URL("/.well-known/oauth-authorization-server",e.origin),type:"oauth"}),n.push({url:new URL(`/.well-known/openid-configuration${i}`,e.origin),type:"oidc"}),n.push({url:new URL(`${i}/.well-known/openid-configuration`,e.origin),type:"oidc"}),n}s(IPr,"buildDiscoveryUrls");async function TPr(t,{fetchFn:e=fetch,protocolVersion:r=XM}={}){var n;let i={"MCP-Protocol-Version":r},o=IPr(t);for(let{url:a,type:c}of o){let l=await v4e(a,i,e);if(!l)throw new Error(`CORS error trying to load ${c==="oauth"?"OAuth":"OpenID provider"} metadata from ${a}`);if(!l.ok){if(l.status>=400&&l.status<500)continue;throw new Error(`HTTP ${l.status} trying to load ${c==="oauth"?"OAuth":"OpenID provider"} metadata from ${a}`)}if(c==="oauth")return g4e.parse(await l.json());{let u=OEt.parse(await l.json());if(!(!((n=u.code_challenge_methods_supported)===null||n===void 0)&&n.includes("S256")))throw new Error(`Incompatible OIDC provider at ${a}: does not support S256 code challenge method required by MCP specification`);return u}}}s(TPr,"discoverAuthorizationServerMetadata");async function wPr(t,{metadata:e,clientInformation:r,redirectUrl:n,scope:i,state:o,resource:a}){let c="code",l="S256",u;if(e){if(u=new URL(e.authorization_endpoint),!e.response_types_supported.includes(c))throw new Error(`Incompatible auth server: does not support response type ${c}`);if(!e.code_challenge_methods_supported||!e.code_challenge_methods_supported.includes(l))throw new Error(`Incompatible auth server: does not support code challenge method ${l}`)}else u=new URL("/authorize",t);let f=await h4e(),p=f.code_verifier,m=f.code_challenge;return u.searchParams.set("response_type",c),u.searchParams.set("client_id",r.client_id),u.searchParams.set("code_challenge",m),u.searchParams.set("code_challenge_method",l),u.searchParams.set("redirect_uri",String(n)),o&&u.searchParams.set("state",o),i&&u.searchParams.set("scope",i),i?.includes("offline_access")&&u.searchParams.append("prompt","consent"),a&&u.searchParams.set("resource",a.href),{authorizationUrl:u,codeVerifier:p}}s(wPr,"startAuthorization");async function SPr(t,{metadata:e,clientInformation:r,authorizationCode:n,codeVerifier:i,redirectUri:o,resource:a,addClientAuthentication:c,fetchFn:l}){var u;let f="authorization_code",p=e?.token_endpoint?new URL(e.token_endpoint):new URL("/token",t);if(e?.grant_types_supported&&!e.grant_types_supported.includes(f))throw new Error(`Incompatible auth server: does not support grant type ${f}`);let m=new Headers({"Content-Type":"application/x-www-form-urlencoded",Accept:"application/json"}),h=new URLSearchParams({grant_type:f,code:n,code_verifier:i,redirect_uri:String(o)});if(c)c(m,h,t,e);else{let A=(u=e?.token_endpoint_auth_methods_supported)!==null&&u!==void 0?u:[],y=jEt(r,A);GEt(y,r,m,h)}a&&h.set("resource",a.href);let g=await(l??fetch)(p,{method:"POST",headers:m,body:h});if(!g.ok)throw await C4e(g);return A4e.parse(await g.json())}s(SPr,"exchangeAuthorization");async function _Pr(t,{metadata:e,clientInformation:r,refreshToken:n,resource:i,addClientAuthentication:o,fetchFn:a}){var c;let l="refresh_token",u;if(e){if(u=new URL(e.token_endpoint),e.grant_types_supported&&!e.grant_types_supported.includes(l))throw new Error(`Incompatible auth server: does not support grant type ${l}`)}else u=new URL("/token",t);let f=new Headers({"Content-Type":"application/x-www-form-urlencoded"}),p=new URLSearchParams({grant_type:l,refresh_token:n});if(o)o(f,p,t,e);else{let h=(c=e?.token_endpoint_auth_methods_supported)!==null&&c!==void 0?c:[],g=jEt(r,h);GEt(g,r,f,p)}i&&p.set("resource",i.href);let m=await(a??fetch)(u,{method:"POST",headers:f,body:p});if(!m.ok)throw await C4e(m);return A4e.parse({refresh_token:n,...await m.json()})}s(_Pr,"refreshAuthorization");async function RPr(t,{metadata:e,clientMetadata:r,fetchFn:n}){let i;if(e){if(!e.registration_endpoint)throw new Error("Incompatible auth server: does not support dynamic client registration");i=new URL(e.registration_endpoint)}else i=new URL("/register",t);let o=await(n??fetch)(i,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});if(!o.ok)throw await C4e(o);return UEt.parse(await o.json())}s(RPr,"registerClient");var x4e=class extends Error{static{s(this,"SseError")}constructor(e,r,n){super(`SSE error: ${r}`),this.code=e,this.event=n}},bue=class{static{s(this,"SSEClientTransport")}constructor(e,r){this._url=e,this._resourceMetadataUrl=void 0,this._eventSourceInit=r?.eventSourceInit,this._requestInit=r?.requestInit,this._authProvider=r?.authProvider,this._fetch=r?.fetch}async _authThenStart(){var e;if(!this._authProvider)throw new i0("No auth provider");let r;try{r=await $S(this._authProvider,{serverUrl:this._url,resourceMetadataUrl:this._resourceMetadataUrl,fetchFn:this._fetch})}catch(n){throw(e=this.onerror)===null||e===void 0||e.call(this,n),n}if(r!=="AUTHORIZED")throw new i0;return await this._startOrAuth()}async _commonHeaders(){var e;let r={};if(this._authProvider){let n=await this._authProvider.tokens();n&&(r.Authorization=`Bearer ${n.access_token}`)}return this._protocolVersion&&(r["mcp-protocol-version"]=this._protocolVersion),new Headers({...r,...(e=this._requestInit)===null||e===void 0?void 0:e.headers})}_startOrAuth(){var e,r,n;let i=(n=(r=(e=this===null||this===void 0?void 0:this._eventSourceInit)===null||e===void 0?void 0:e.fetch)!==null&&r!==void 0?r:this._fetch)!==null&&n!==void 0?n:fetch;return new Promise((o,a)=>{this._eventSource=new c5(this._url.href,{...this._eventSourceInit,fetch:s(async(c,l)=>{let u=await this._commonHeaders();u.set("Accept","text/event-stream");let f=await i(c,{...l,headers:u});return f.status===401&&f.headers.has("www-authenticate")&&(this._resourceMetadataUrl=KH(f)),f},"fetch")}),this._abortController=new AbortController,this._eventSource.onerror=c=>{var l;if(c.code===401&&this._authProvider){this._authThenStart().then(o,a);return}let u=new x4e(c.code,c.message,c);a(u),(l=this.onerror)===null||l===void 0||l.call(this,u)},this._eventSource.onopen=()=>{},this._eventSource.addEventListener("endpoint",c=>{var l;let u=c;try{if(this._endpoint=new URL(u.data,this._url),this._endpoint.origin!==this._url.origin)throw new Error(`Endpoint origin does not match connection origin: ${this._endpoint.origin}`)}catch(f){a(f),(l=this.onerror)===null||l===void 0||l.call(this,f),this.close();return}o()}),this._eventSource.onmessage=c=>{var l,u;let f=c,p;try{p=LS.parse(JSON.parse(f.data))}catch(m){(l=this.onerror)===null||l===void 0||l.call(this,m);return}(u=this.onmessage)===null||u===void 0||u.call(this,p)}})}async start(){if(this._eventSource)throw new Error("SSEClientTransport already started! If using Client class, note that connect() calls start() automatically.");return await this._startOrAuth()}async finishAuth(e){if(!this._authProvider)throw new i0("No auth provider");if(await $S(this._authProvider,{serverUrl:this._url,authorizationCode:e,resourceMetadataUrl:this._resourceMetadataUrl,fetchFn:this._fetch})!=="AUTHORIZED")throw new i0("Failed to authorize")}async close(){var e,r,n;(e=this._abortController)===null||e===void 0||e.abort(),(r=this._eventSource)===null||r===void 0||r.close(),(n=this.onclose)===null||n===void 0||n.call(this)}async send(e){var r,n,i;if(!this._endpoint)throw new Error("Not connected");try{let o=await this._commonHeaders();o.set("content-type","application/json");let a={...this._requestInit,method:"POST",headers:o,body:JSON.stringify(e),signal:(r=this._abortController)===null||r===void 0?void 0:r.signal},c=await((n=this._fetch)!==null&&n!==void 0?n:fetch)(this._endpoint,a);if(!c.ok){if(c.status===401&&this._authProvider){if(this._resourceMetadataUrl=KH(c),await $S(this._authProvider,{serverUrl:this._url,resourceMetadataUrl:this._resourceMetadataUrl,fetchFn:this._fetch})!=="AUTHORIZED")throw new i0;return this.send(e)}let l=await c.text().catch(()=>null);throw new Error(`Error POSTing to endpoint (HTTP ${c.status}): ${l}`)}}catch(o){throw(i=this.onerror)===null||i===void 0||i.call(this,o),o}}setProtocolVersion(e){this._protocolVersion=e}};var Iue=class extends qS{constructor(r,n,i){super(r,n,i);this.transport=null}static{s(this,"MCPSSEServer")}initTransport(r){let n=Aue(this.ctx,r);return new bue(new URL(r.url),n)}};d();d();var Lbt=Be(Nbt(),1),YH=Be(require("node:process"),1),Fbt=require("node:stream");d();var wue=class{static{s(this,"ReadBuffer")}append(e){this._buffer=this._buffer?Buffer.concat([this._buffer,e]):e}readMessage(){if(!this._buffer)return null;let e=this._buffer.indexOf(`
`);if(e===-1)return null;let r=this._buffer.toString("utf8",0,e).replace(/\r$/,"");return this._buffer=this._buffer.subarray(e+1),r5r(r)}clear(){this._buffer=void 0}};function r5r(t){return LS.parse(JSON.parse(t))}s(r5r,"deserializeMessage");function Mbt(t){return JSON.stringify(t)+`
`}s(Mbt,"serializeMessage");var n5r=YH.default.platform==="win32"?["APPDATA","HOMEDRIVE","HOMEPATH","LOCALAPPDATA","PATH","PROCESSOR_ARCHITECTURE","SYSTEMDRIVE","SYSTEMROOT","TEMP","USERNAME","USERPROFILE","PROGRAMFILES"]:["HOME","LOGNAME","PATH","SHELL","TERM","USER"];function i5r(){let t={};for(let e of n5r){let r=YH.default.env[e];r!==void 0&&(r.startsWith("()")||(t[e]=r))}return t}s(i5r,"getDefaultEnvironment");var Sue=class{static{s(this,"StdioClientTransport")}constructor(e){this._abortController=new AbortController,this._readBuffer=new wue,this._stderrStream=null,this._serverParams=e,(e.stderr==="pipe"||e.stderr==="overlapped")&&(this._stderrStream=new Fbt.PassThrough)}async start(){if(this._process)throw new Error("StdioClientTransport already started! If using Client class, note that connect() calls start() automatically.");return new Promise((e,r)=>{var n,i,o,a,c;this._process=(0,Lbt.default)(this._serverParams.command,(n=this._serverParams.args)!==null&&n!==void 0?n:[],{env:{...i5r(),...this._serverParams.env},stdio:["pipe","pipe",(i=this._serverParams.stderr)!==null&&i!==void 0?i:"inherit"],shell:!1,signal:this._abortController.signal,windowsHide:YH.default.platform==="win32"&&o5r(),cwd:this._serverParams.cwd}),this._process.on("error",l=>{var u,f;if(l.name==="AbortError"){(u=this.onclose)===null||u===void 0||u.call(this);return}r(l),(f=this.onerror)===null||f===void 0||f.call(this,l)}),this._process.on("spawn",()=>{e()}),this._process.on("close",l=>{var u;this._process=void 0,(u=this.onclose)===null||u===void 0||u.call(this)}),(o=this._process.stdin)===null||o===void 0||o.on("error",l=>{var u;(u=this.onerror)===null||u===void 0||u.call(this,l)}),(a=this._process.stdout)===null||a===void 0||a.on("data",l=>{this._readBuffer.append(l),this.processReadBuffer()}),(c=this._process.stdout)===null||c===void 0||c.on("error",l=>{var u;(u=this.onerror)===null||u===void 0||u.call(this,l)}),this._stderrStream&&this._process.stderr&&this._process.stderr.pipe(this._stderrStream)})}get stderr(){var e,r;return this._stderrStream?this._stderrStream:(r=(e=this._process)===null||e===void 0?void 0:e.stderr)!==null&&r!==void 0?r:null}get pid(){var e,r;return(r=(e=this._process)===null||e===void 0?void 0:e.pid)!==null&&r!==void 0?r:null}processReadBuffer(){for(var e,r;;)try{let n=this._readBuffer.readMessage();if(n===null)break;(e=this.onmessage)===null||e===void 0||e.call(this,n)}catch(n){(r=this.onerror)===null||r===void 0||r.call(this,n)}}async close(){this._abortController.abort(),this._process=void 0,this._readBuffer.clear()}send(e){return new Promise(r=>{var n;if(!(!((n=this._process)===null||n===void 0)&&n.stdin))throw new Error("Not connected");let i=Mbt(e);this._process.stdin.write(i)?r():this._process.stdin.once("drain",r)})}};function o5r(){return"type"in YH.default}s(o5r,"isElectron");var P4e=require("child_process"),D4e=require("util");var _ue=class extends qS{constructor(r,n,i){super(r,n,i);this.transport=null}static{s(this,"MCPStdioServer")}initTransport(r){return r.env={..._vt(),...r.env||{}},r.stderr="pipe",new Sue(r)}addListeners(){super.addListeners(),this.transport&&this.transport.stderr&&this.transport.stderr.on("data",r=>{UP(this.ctx,{message:`[server stderr] ${r.toString().trimEnd()}`,server:this.name})})}async cleanup(){if(this.transport){if(process.platform==="win32"){let r=null;"pid"in this.transport&&typeof this.transport.pid=="number"&&(r=this.transport.pid),r&&await this.isUvProcess(r)&&await this.forceKillWindowsProcess(r)}await this.mcp.close()}}async isUvProcess(r){try{let o=(await(0,D4e.promisify)(P4e.exec)(`tasklist /fi "PID eq ${r}" /fo csv /nh`,{timeout:5e3})).stdout.trim().split(`
`);if(o.length>0){let c=o[0].split(",");if(c.length>0){let l=c[0].replace(/"/g,"").toLowerCase();return l==="uv.exe"||l==="uv"}}return!1}catch(n){return _n.debug(this.ctx,`Failed to get process info for PID ${r}:`,n),!1}}async forceKillWindowsProcess(r){try{let n=(0,D4e.promisify)(P4e.exec);_n.info(this.ctx,`Force killing Windows process with PID ${r} for MCP server ${this.name}`),Qa(this.ctx,{message:`Force killing Windows process with PID ${r}`,server:this.name}),await n(`taskkill /pid ${r} /t /f`,{timeout:1e4}),_n.info(this.ctx,`Successfully force killed process ${r}`)}catch(n){_n.debug(this.ctx,`Failed to kill process ${r} (process may not exist):`,n),hd(this.ctx,{message:`Failed to kill process ${r} (process may not exist): ${n instanceof Error?n.message:String(n)}`,server:this.name})}}};d();d();d();var Rue=class extends TransformStream{static{s(this,"EventSourceParserStream")}constructor({onError:e,onRetry:r,onComment:n}={}){let i;super({start(o){i=Cue({onEvent:s(a=>{o.enqueue(a)},"onEvent"),onError(a){e==="terminate"?o.error(a):typeof e=="function"&&e(a)},onRetry:r,onComment:n})},transform(o){i.feed(o)}})}};var s5r={initialReconnectionDelay:1e3,maxReconnectionDelay:3e4,reconnectionDelayGrowFactor:1.5,maxRetries:2},JH=class extends Error{static{s(this,"StreamableHTTPError")}constructor(e,r){super(`Streamable HTTP error: ${r}`),this.code=e}},kue=class{static{s(this,"StreamableHTTPClientTransport")}constructor(e,r){var n;this._url=e,this._resourceMetadataUrl=void 0,this._requestInit=r?.requestInit,this._authProvider=r?.authProvider,this._fetch=r?.fetch,this._sessionId=r?.sessionId,this._reconnectionOptions=(n=r?.reconnectionOptions)!==null&&n!==void 0?n:s5r}async _authThenStart(){var e;if(!this._authProvider)throw new i0("No auth provider");let r;try{r=await $S(this._authProvider,{serverUrl:this._url,resourceMetadataUrl:this._resourceMetadataUrl,fetchFn:this._fetch})}catch(n){throw(e=this.onerror)===null||e===void 0||e.call(this,n),n}if(r!=="AUTHORIZED")throw new i0;return await this._startOrAuthSse({resumptionToken:void 0})}async _commonHeaders(){var e;let r={};if(this._authProvider){let i=await this._authProvider.tokens();i&&(r.Authorization=`Bearer ${i.access_token}`)}this._sessionId&&(r["mcp-session-id"]=this._sessionId),this._protocolVersion&&(r["mcp-protocol-version"]=this._protocolVersion);let n=this._normalizeHeaders((e=this._requestInit)===null||e===void 0?void 0:e.headers);return new Headers({...r,...n})}async _startOrAuthSse(e){var r,n,i;let{resumptionToken:o}=e;try{let a=await this._commonHeaders();a.set("Accept","text/event-stream"),o&&a.set("last-event-id",o);let c=await((r=this._fetch)!==null&&r!==void 0?r:fetch)(this._url,{method:"GET",headers:a,signal:(n=this._abortController)===null||n===void 0?void 0:n.signal});if(!c.ok){if(c.status===401&&this._authProvider)return await this._authThenStart();if(c.status===405)return;throw new JH(c.status,`Failed to open SSE stream: ${c.statusText}`)}this._handleSseStream(c.body,e,!0)}catch(a){throw(i=this.onerror)===null||i===void 0||i.call(this,a),a}}_getNextReconnectionDelay(e){let r=this._reconnectionOptions.initialReconnectionDelay,n=this._reconnectionOptions.reconnectionDelayGrowFactor,i=this._reconnectionOptions.maxReconnectionDelay;return Math.min(r*Math.pow(n,e),i)}_normalizeHeaders(e){return e?e instanceof Headers?Object.fromEntries(e.entries()):Array.isArray(e)?Object.fromEntries(e):{...e}:{}}_scheduleReconnection(e,r=0){var n;let i=this._reconnectionOptions.maxRetries;if(i>0&&r>=i){(n=this.onerror)===null||n===void 0||n.call(this,new Error(`Maximum reconnection attempts (${i}) exceeded.`));return}let o=this._getNextReconnectionDelay(r);setTimeout(()=>{this._startOrAuthSse(e).catch(a=>{var c;(c=this.onerror)===null||c===void 0||c.call(this,new Error(`Failed to reconnect SSE stream: ${a instanceof Error?a.message:String(a)}`)),this._scheduleReconnection(e,r+1)})},o)}_handleSseStream(e,r,n){if(!e)return;let{onresumptiontoken:i,replayMessageId:o}=r,a;s(async()=>{var l,u,f,p;try{let m=e.pipeThrough(new TextDecoderStream).pipeThrough(new Rue).getReader();for(;;){let{value:h,done:g}=await m.read();if(g)break;if(h.id&&(a=h.id,i?.(h.id)),!h.event||h.event==="message")try{let A=LS.parse(JSON.parse(h.data));o!==void 0&&kH(A)&&(A.id=o),(l=this.onmessage)===null||l===void 0||l.call(this,A)}catch(A){(u=this.onerror)===null||u===void 0||u.call(this,A)}}}catch(m){if((f=this.onerror)===null||f===void 0||f.call(this,new Error(`SSE stream disconnected: ${m}`)),n&&this._abortController&&!this._abortController.signal.aborted)try{this._scheduleReconnection({resumptionToken:a,onresumptiontoken:i,replayMessageId:o},0)}catch(h){(p=this.onerror)===null||p===void 0||p.call(this,new Error(`Failed to reconnect: ${h instanceof Error?h.message:String(h)}`))}}},"processStream")()}async start(){if(this._abortController)throw new Error("StreamableHTTPClientTransport already started! If using Client class, note that connect() calls start() automatically.");this._abortController=new AbortController}async finishAuth(e){if(!this._authProvider)throw new i0("No auth provider");if(await $S(this._authProvider,{serverUrl:this._url,authorizationCode:e,resourceMetadataUrl:this._resourceMetadataUrl,fetchFn:this._fetch})!=="AUTHORIZED")throw new i0("Failed to authorize")}async close(){var e,r;(e=this._abortController)===null||e===void 0||e.abort(),(r=this.onclose)===null||r===void 0||r.call(this)}async send(e,r){var n,i,o,a;try{let{resumptionToken:c,onresumptiontoken:l}=r||{};if(c){this._startOrAuthSse({resumptionToken:c,replayMessageId:Wle(e)?e.id:void 0}).catch(y=>{var E;return(E=this.onerror)===null||E===void 0?void 0:E.call(this,y)});return}let u=await this._commonHeaders();u.set("content-type","application/json"),u.set("accept","application/json, text/event-stream");let f={...this._requestInit,method:"POST",headers:u,body:JSON.stringify(e),signal:(n=this._abortController)===null||n===void 0?void 0:n.signal},p=await((i=this._fetch)!==null&&i!==void 0?i:fetch)(this._url,f),m=p.headers.get("mcp-session-id");if(m&&(this._sessionId=m),!p.ok){if(p.status===401&&this._authProvider){if(this._resourceMetadataUrl=KH(p),await $S(this._authProvider,{serverUrl:this._url,resourceMetadataUrl:this._resourceMetadataUrl,fetchFn:this._fetch})!=="AUTHORIZED")throw new i0;return this.send(e)}let y=await p.text().catch(()=>null);throw new Error(`Error POSTing to endpoint (HTTP ${p.status}): ${y}`)}if(p.status===202){vvt(e)&&this._startOrAuthSse({resumptionToken:void 0}).catch(y=>{var E;return(E=this.onerror)===null||E===void 0?void 0:E.call(this,y)});return}let g=(Array.isArray(e)?e:[e]).filter(y=>"method"in y&&"id"in y&&y.id!==void 0).length>0,A=p.headers.get("content-type");if(g)if(A?.includes("text/event-stream"))this._handleSseStream(p.body,{onresumptiontoken:l},!1);else if(A?.includes("application/json")){let y=await p.json(),E=Array.isArray(y)?y.map(b=>LS.parse(b)):[LS.parse(y)];for(let b of E)(o=this.onmessage)===null||o===void 0||o.call(this,b)}else throw new JH(-1,`Unexpected content type: ${A}`)}catch(c){throw(a=this.onerror)===null||a===void 0||a.call(this,c),c}}get sessionId(){return this._sessionId}async terminateSession(){var e,r,n;if(this._sessionId)try{let i=await this._commonHeaders(),o={...this._requestInit,method:"DELETE",headers:i,signal:(e=this._abortController)===null||e===void 0?void 0:e.signal},a=await((r=this._fetch)!==null&&r!==void 0?r:fetch)(this._url,o);if(!a.ok&&a.status!==405)throw new JH(a.status,`Failed to terminate session: ${a.statusText}`);this._sessionId=void 0}catch(i){throw(n=this.onerror)===null||n===void 0||n.call(this,i),i}}setProtocolVersion(e){this._protocolVersion=e}get protocolVersion(){return this._protocolVersion}};var Pue=class extends qS{constructor(r,n,i){super(r,n,i);this.transport=null}static{s(this,"MCPStreamableServer")}initTransport(r){let n=Aue(this.ctx,r);return new kue(new URL(r.url),n)}};d();var Due=class extends sS{static{s(this,"McpLanguageModelTool")}constructor(e,r){super({...e,toolProvider:{id:e.serverName,displayNamePrefix:e.serverNamePrefix,displayName:e.serverName,description:e.serverName,isFirstPartyTool:!1},type:"mcp"}),this.invoker=r}prepareInvocation(e,r){let n={title:`Confirm MCP Tool: ${this.displayName} - ${this.toolProvider.displayName}(MCP Server)`,message:`Do you want to allow the external MCP tool "${this.toolProvider.displayName}/${this.displayName}" to run?`};return{progressMessage:`Running MCP tool: ${this.displayName} - ${this.toolProvider.displayName}(MCP Server)`,confirmationMessages:n}}async invoke(e,r,n){return await this.invoker(r.input,n)}async invokeConfirmation(e,r,n){if(n.isCancellationRequested)throw new ic;let i={name:this.name,title:r.title,message:r.message,input:r.input,conversationId:e.conversation.id,turnId:e.turn.id,roundId:r.roundId,toolCallId:r.toolCallId,annotations:r.annotations};try{return await e.ctx.get(x1).invokeClientToolConfirmation(e,i)}catch(o){throw new Error(`Failed to invoke client tool confirmation ${this.name}: ${String(o)}`)}}};var Lue=Be(ul());d();d();HK();var aL=class extends ju{constructor(r,n=new B4e){super();this.ctx=r;this.fallback=n}static{s(this,"AgentUrlOpener")}async open(r){let n=this.ctx.get(Nr);if(!(n.clientCapabilities?.window?.showDocument?.support&&(await n.connection.window.showDocument({uri:r,external:!0})).success))return this.fallback.open(r)}},B4e=class extends ju{static{s(this,"SpawnUrlOpener")}async open(e){await oO(e)}};d();var Obt=require("crypto"),Qbt=Be(require("http"));var Bue=class{constructor(e){this.nonce=(0,Obt.randomBytes)(16).toString("base64");if(!e)throw new Error("startingRedirect must be defined");this._startingRedirect=new URL(e);let r;this._resultPromise=new Promise((i,o)=>r={resolve:i,reject:o});let n=`&app_name=${encodeURIComponent("GitHub Copilot")}`;this._server=Qbt.createServer((i,o)=>{let a=new URL(i.url,`http://${i.headers.host}`);switch(a.pathname){case"/signin":{(a.searchParams.get("nonce")??"").replace(/ /g,"+")!==this.nonce&&(o.writeHead(302,{location:`/?error=${encodeURIComponent("Nonce does not match.")}${n}`}),o.end()),this._startingRedirect.searchParams.set("redirect_uri",`http://127.0.0.1:${this.port}/callback`),o.writeHead(302,{location:this._startingRedirect.toString()}),o.end();break}case"/callback":{let c=a.searchParams.get("code")??void 0,l=a.searchParams.get("state")??void 0,u=new URL(l||"").searchParams.get("nonce")??void 0;if(!c||!l||!u){o.writeHead(400),o.end();return}if(this.state!==l)throw o.writeHead(302,{location:`/?error=${encodeURIComponent("State does not match.")}${n}`}),o.end(),new Error("State does not match.");if(this.nonce!==u)throw o.writeHead(302,{location:`/?error=${encodeURIComponent("Nonce does not match.")}${n}`}),o.end(),new Error("Nonce does not match.");r.resolve({code:c,state:l}),o.writeHead(200,{"Content-Type":"text/html; charset=utf-8"}),o.end(YPe);break}default:o.writeHead(200,{"Content-Type":"text/html; charset=utf-8"}),o.end(YPe)}})}static{s(this,"LoopbackAuthServer")}set state(e){e?this._startingRedirect.searchParams.set("state",e):this._startingRedirect.searchParams.delete("state")}get state(){return this._startingRedirect.searchParams.get("state")??void 0}start(){return new Promise((e,r)=>{if(this._server.listening)throw new Error("Server is already started");let n=setTimeout(()=>{r(new Error("Timeout waiting for port"))},5e3);this._server.on("listening",()=>{let i=this._server.address();if(typeof i=="string")this.port=parseInt(i);else if(i instanceof Object)this.port=i.port;else throw new Error("Unable to determine port");clearTimeout(n),this.state=`http://127.0.0.1:${this.port}/callback?nonce=${encodeURIComponent(this.nonce)}`,e(this.port)}),this._server.on("error",i=>{r(new Error(`Error listening to server: ${i}`))}),this._server.on("close",()=>{r(new Error("Closed"))}),this._server.listen(0,"127.0.0.1")})}stop(){return new Promise((e,r)=>{if(!this._server.listening)throw new Error("Server is not started");this._server.close(n=>{n?r(n):e()})})}waitForOAuthResponse(){return this._resultPromise}};var a5r="Timed out",N4e=class{static{s(this,"CodeFlow")}},Nue=class extends N4e{static{s(this,"CLSCodeFlow")}constructor(e){super(),this.ctx=e}async auth(e,r,n){let i=p1t(e);if(!i)return"";let{client_id:o,client_secret:a}=i,c=new URLSearchParams([["client_id",o],["scope",(n?.scopes_supported??[]).join(" ")],["prompt","select_account"]]),l=r.authorization_endpoint+"?"+c.toString(),u=new Bue(l),f=await u.start(),p=`http://127.0.0.1:${f}/signin?nonce=${encodeURIComponent(u.nonce)}`;dn.info(this.ctx,"auth url: ",p),await new aL(this.ctx).open(p);let m;try{m=(await Promise.race([u.waitForOAuthResponse(),new Promise((A,y)=>setTimeout(()=>y(new Error(a5r)),3e5))])).code}finally{setTimeout(()=>{u.stop()},5e3)}return await this.exchangeCodeForToken({endpointUri:r.token_endpoint,redirectUri:`http://127.0.0.1:${f}/callback`,code:m,client_id:o,client_secret:a})}async exchangeCodeForToken({endpointUri:e,redirectUri:r,code:n,client_id:i,client_secret:o}){let a=new URLSearchParams([["code",n],["client_id",i],["redirect_uri",r],["client_secret",o]]),c=await n5(this.ctx,e,"POST",{Accept:"application/json","Content-Type":"application/x-www-form-urlencoded"},a.toString());if(c.ok)return(await c.json()).access_token;{let l=await c.text(),u=new Error(l);throw u.name="GitHubTokenExchangeError",u}}};var Mue=class t extends ng{constructor(r){super();this.MCPServersMap=new Map;this.cachedMCPServerTools=[];this.updateToolsQueue=Promise.resolve();this.prefixGenerator=new Yle;this.isMcpEnabled=!1;this.storedMCPServersConfig={};this.ctx=r,_a(this.ctx,async n=>{this.isMcpEnabled=this.isTokenMcpEnabled(n),this.isMcpEnabled?await this.updateMCPServers(this.storedMCPServersConfig):(_n.info(this.ctx,"MCP is disabled, clearing all servers and tools"),this.clearAllServers())})}static{s(this,"CLSMCPManager")}static{this.toolsNotificationType=new Lue.ProtocolNotificationType("copilot/mcpTools")}static{this.oauthRequestType=new Lue.ProtocolRequestType("copilot/mcpOAuth")}isTokenMcpEnabled(r){if(!r)return!0;try{return r.getTokenValue("mcp")!=="0"}catch(n){return _n.warn(this.ctx,`Error reading MCP value from token: ${n instanceof Error?n.message:String(n)}`),!0}}async updateMCPServers(r){if(this.storedMCPServersConfig=r,!!this.isMcpEnabled){await this.clearAllServers();for(let n of Object.keys(r))await this.addServer({name:n,...r[n]});await this.updateToolsList()}}getAllTools(){return this.isMcpEnabled?this.cachedMCPServerTools:[]}updateMCPToolStatus(r,n,i){if(!this.isMcpEnabled){_n.warn(this.ctx,`MCP is disabled, cannot update tool status for ${r}.${n}`);return}let o=this.getTool(r,n),a=this.getServerPrefix(r);if(!o){_n.error(this.ctx,`Not found MCP ${r} server ${n} tool`);return}o._status=i,i==="enabled"?this.ctx.get(bu).getToolById(`${r}.${n}`)||this.registerTool(r,a,o):this.unregisterTool(r,n)}async callTool(r,n,i,o){if(!this.isMcpEnabled)throw new Error(`MCP is disabled, cannot call tool ${r}.${n}`);let a=this.MCPServersMap.get(r);if(a){let{status:c,server:l}=a;if(c==="running"&&l)return await l.callTool(n,i,o)}throw new Error(`MCP server ${r} is not running`)}async updateToolsList(){return this.updateToolsQueue=this.updateToolsQueue.then(async()=>{await this.getAndCacheAllTools(),this.registerTools(),await this.notifyClient()}),this.updateToolsQueue}getTool(r,n){let o=this.getAllTools().find(a=>a.name===r)?.tools;return!o||o.length===0?null:o.find(a=>a.name===n)||null}async getAndCacheAllTools(){let r=[];for(let n of this.MCPServersMap.keys()){let i=this.MCPServersMap.get(n);try{if(i.status==="running"&&i.server){let o=await i.server.getToolsList();o.forEach(a=>{let c=a.name,l=this.getToolStatus(n,c);l&&(a._status=l)}),r.push({name:n,prefix:this.getServerPrefix(n),status:i.status,tools:o})}else i.status==="error"?r.push({name:n,prefix:this.getServerPrefix(n),status:i.status,tools:[],error:i.error}):r.push({name:n,prefix:this.getServerPrefix(n),status:i.status,tools:[]})}catch(o){let a=`Failed to get tools list for MCP server ${n}.`+(o instanceof Error?` message: ${o.message} stack: ${o.stack}`:String(o));_n.error(this.ctx,a),await hd(this.ctx,{message:a,server:n}),r.push({name:n,prefix:this.getServerPrefix(n),status:i.status,tools:[],error:a})}}this.cachedMCPServerTools=r}getToolStatus(r,n){let i=this.getTool(r,n);return i?i._status:null}getServerPrefix(r){let i=this.getAllTools().find(o=>o.name===r);return i?i.prefix:this.prefixGenerator.generate(r)}async addServer(r){try{await Qa(this.ctx,{message:`Starting server ${r.name}`,server:r.name}),this.MCPServersMap.set(r.name,{status:"stopped",server:null});let n;r.type==="sse"?(n=new Iue(this.ctx,r.name,r.version||"1.0.0"),await n.connect(r)):"url"in r?(n=new Pue(this.ctx,r.name,r.version||"1.0.0"),await n.connect(r)):(n=new _ue(this.ctx,r.name,r.version||"1.0.0"),await n.connect(r)),n.getEmitter().on($k,()=>{this.updateToolsList()}),this.MCPServersMap.set(r.name,{status:"running",server:n}),await Qa(this.ctx,{message:"Connection state: Running",server:r.name})}catch(n){if(_n.error(this.ctx,`Error initializing MCP server ${r.name}:`,n),n instanceof Error){let o=/Error POSTing to endpoint \(HTTP (\d+)\):/,a=n.message.match(o);if(a&&"url"in r&&r.type!=="sse"&&a[1]!=="401"&&Number(a[1])>=400&&Number(a[1])<500){let c=`${a[1]} status sending message to ${r.url}, will attempt to fall back to legacy SSE`;_n.info(this.ctx,c),Qa(this.ctx,{message:c,server:r.name});let l={...r,type:"sse"};return await this.addServer(l)}else if(a&&"url"in r&&r.type!=="sse"&&a[1]==="401"){let c=await this.getAuthMetadata(r),l=await this.getToken(r.url,c.authorizationServer,c.serverMetadata,c.resourceMetadata);if(!l){_n.error(this.ctx,`Failed to get token for server: ${r.name}`);return}let u={...r,requestInit:{...r.requestInit??{},headers:{...r.requestInit?.headers??{},Authorization:`Bearer ${l}`}}};return await this.addServer(u)}}let i=n instanceof Error?`message: ${n.message} stack: ${n.stack}`:String(n);await hd(this.ctx,{message:i,server:r.name}),this.MCPServersMap.set(r.name,{status:"error",server:null,error:i}),this.ctx.get(wa).showWarningMessageOnlyOnce(`${r.name}.initialize`,`Failed to initialize MCP server '${r.name}'. Please check the logs for more details.`)}}async notifyClient(){let r=this.getAllTools();await this.ctx.get(Nr).connection.sendNotification(t.toolsNotificationType,{servers:r})}registerTools(){for(let r of this.cachedMCPServerTools){let{name:n,prefix:i,tools:o}=r;for(let a of o)this.registerTool(n,i,a)}}registerTool(r,n,i){let{name:o,description:a,inputSchema:c,_status:l,_nameForModel:u,annotations:f}=i;_n.debug(this.ctx,"register MCP Tool:",{...i}),l!=="disabled"&&this.ctx.get(bu).registerTool(new Due({serverName:r,serverNamePrefix:n,name:u,displayName:o,description:a||"",displayDescription:a||"",inputSchema:c,annotations:f},(p,m)=>(_n.debug(this.ctx,"copilot MCP Invoker:",r,o,p),this.callTool(r,o,p,m))))}unregisterAllTools(){for(let r of this.cachedMCPServerTools){let{name:n,tools:i}=r;for(let o of i){let{name:a}=o;this.unregisterTool(n,a)}}}unregisterTool(r,n){this.ctx.get(bu).unregisterTool(`${r}.${n}`)}async clearAllServers(){this.unregisterAllTools();for(let r of this.MCPServersMap.keys()){let{status:n,server:i}=this.MCPServersMap.get(r);n==="running"&&i&&(await Qa(this.ctx,{message:`Stopping server ${r}`,server:r}),i.getEmitter().removeAllListeners($k),await i.cleanup())}this.MCPServersMap.clear()}async getAuthMetadata(r){return await new Ule(this.ctx).getMetadataFromOriginalUrl(r.url,r.requestInit?.headers)}async getToken(r,n,i,o){let a=await this.ctx.get(my).getOrActivateProviderIdForServer(n);if(!a){let f=this.ctx.get(my).createAuthenticationProvider(n);if(!f){_n.error(this.ctx,`No authentication provider found for server: ${n}`),await Qa(this.ctx,{message:`No authentication provider found for authserver: ${n}`,server:r});return}a=f.id}let c=o?.scopes_supported||i.scopes_supported||[],l=await this.ctx.get(my).getSessions(a,c,{authorizationServer:n},!0);if(l.length)return l[0].accessToken;let u=this.ctx.get(my).getProvider(a);try{let{confirm:f}=await this.ctx.get(Nr).connection.sendRequest(t.oauthRequestType,{mcpServer:r,authLabel:u.label});if(!f){_n.warn(this.ctx,"no confirmation for OAuth request");return}}catch(f){_n.warn(this.ctx,"no confirmation for OAuth request",f);return}try{let f=await new Nue(this.ctx).auth(n,i,o),p=await u.createSession(c,f);return this.ctx.get(wa).showInformationMessageOnlyOnce("Authentication successful",`You have already authenticated with ${u.label}.`,{title:"OK"}),p.accessToken}catch(f){this.ctx.get(wa).showWarningMessageOnlyOnce("Authentication failed",`You need to restart the IDE to authenticate the MCP server again. ${f instanceof Error?f.message:String(f)}`);return}}};d();var Ubt=Be(ul());var Fue=class t extends ny{static{s(this,"CLSMCPRuntimeNotifier")}static{this.notificationType=new Ubt.ProtocolNotificationType("copilot/mcpRuntimeLogs")}constructor(e){super(),this.ctx=e}async notifyLog(e){await this.ctx.get(Nr).connection.sendNotification(t.notificationType,{...e,time:Date.now()})}};d();var Que=Be(ul());var c5r=new Que.ProtocolRequestType("copilot/showPanelMessageRequest"),l5r=new Que.ProtocolNotificationType("copilot/showPanelMessage"),Oue=class extends C8{constructor(r){super();this.ctx=r}static{s(this,"CopilotMessageSender")}async sendPanelMessageNotification(r){return this.ctx.get(Nr).connection.sendNotification(l5r,r)}async sendPanelMessageRequest(r){let n=this.ctx.get(Nr).connection,i;try{i=await n.sendRequest(c5r,r)}catch(c){throw new Error(`Request copilot/showPanelMessageRequest failed with message: ${Rx(c)}`)}let[o,a]=i;if(a)throw new Error(`Request copilot/showPanelMessageRequest failed with code: ${a.code}, message: ${a.message}`);return o}};d();d();var u5r=new dt("fetcher"),d5r="https://default.exp-tas.com/",Uue=class extends Or{constructor(r,n,i,o){super();this.ctx=r;this.defaultFetcher=n;this.fallbackFetcher=i;this.onFallbackSuccess=o}static{s(this,"FallbackFetcher")}async fetch(r,n){try{return await this.defaultFetcher.fetch(r,n)}catch(i){if(Td(i)||`${r}/`.startsWith(d5r))throw i;u5r.info(this.ctx,`Request to <${r}> failed, attempting fallback.`,i);let o=await this.fallbackFetcher.fetch(r,n);return this.onFallbackSuccess(),o}}getImplementation(){return this.defaultFetcher.getImplementation()}get name(){return this.defaultFetcher.name}async disconnectAll(){return this.defaultFetcher.disconnectAll()}};var qbt=new dt("fetcher"),que=class extends Or{constructor(r,n=new HM(r),i=new UM(r)){super();this.ctx=r;this.helixFetcher=n;this.editorFetcher=i;this.updateFetcher=s(()=>{let r,n;if(!this.editorFetcherCapability)n="Using Helix fetcher, editor does not have fetch capability.",r=this.helixFetcher;else if(this.fetchStrategy==="client")n="Using editor fetcher, fetch strategy set to client.",r=this.editorFetcher;else if(this.fetchStrategy==="native")n="Using Helix fetcher, fetch strategy set to native.",r=this.helixFetcher;else{let i=zi(this.ctx,Ht.DebugUseEditorFetcher);i?.toString()==="true"?(n="Using editor fetcher, debug flag is enabled.",r=this.editorFetcher):i?.toString()==="false"?(n="Using Helix fetcher, debug flag is disabled.",r=this.helixFetcher):(n="Editor fetcher capability available, will fallback if needed.",r=this.fallbackFetcher)}this.currentFetcher!=r&&(qbt.debug(this.ctx,n),this.currentFetcher=r)},"updateFetcher");this.currentFetcher=this.helixFetcher,this.fallbackFetcher=new Uue(r,n,i,()=>{qbt.info(this.ctx,"Fallback fetch succeeded, switching to editor fetcher."),this.currentFetcher=this.editorFetcher}),r.get(xs).onDidSetCapabilities(this.updateFetcher),r.get(Mc).onDidChangeCopilotSettings(this.updateFetcher)}static{s(this,"AgentDelegatingFetcher")}get fetchStrategy(){return zi(this.ctx,Ht.FetchStrategy)}get editorFetcherCapability(){return this.ctx.get(xs).getCapabilities().fetch??!1}getImplementation(){return this.currentFetcher.getImplementation()}get name(){return this.currentFetcher.name}fetch(r,n){return this.currentFetcher.fetch(r,n)}async disconnectAll(){await Promise.all([this.helixFetcher.disconnectAll(),this.fallbackFetcher.disconnectAll()])}};d();var Hue=class extends wa{constructor(r){super();this.ctx=r}static{s(this,"ConnectionNotificationSender")}get connection(){return this.ctx.get(Nr).connection}showWarningMessage(r,...n){return this.connection.window.showWarningMessage(r,...n)}showInformationMessage(r,...n){return this.connection.window.showInformationMessage(r,...n)}};d();d();var Hbt=Be(require("crypto")),$bt=require("os");var f5r=new Set(["00:00:00:00:00:00","ff:ff:ff:ff:ff:ff","ac:de:48:00:11:22"]);function p5r(t){let e=t.replace(/-/g,":").toLowerCase();return!f5r.has(e)}s(p5r,"validateMacAddress");function m5r(){let t=(0,$bt.networkInterfaces)();for(let e in t){let r=t[e];if(r){for(let{mac:n}of r)if(p5r(n))return n}}throw new Error("Unable to retrieve mac address (unexpected format)")}s(m5r,"getMac");var M4e;function h5r(){try{let t=m5r();return Hbt.createHash("sha256").update(t,"utf8").digest("hex")}catch{return}}s(h5r,"getMacMachineId");function Wbt(){return M4e||(M4e=h5r()||br()),M4e}s(Wbt,"getMachineId");var g5r=br()+Date.now(),jbt=new Ms(g5r,Wbt());d();d();var $ue=class extends xoe{static{s(this,"AgentWorkspaceWatcher")}async getWatchedFiles(){return(await this.ctx.get(Q1).getWatchedFiles({workspaceUri:this.workspaceFolder.uri,workspaceFolder:this.workspaceFolder,excludeGitignoredFiles:!0,excludeIDEIgnoredFiles:!0})).watchedFiles}startWatching(){if(this.status==="ready")return;let e=this.ctx.get(Q1);this._watcher=e.onDidChangeWatchedFiles(this.onDidChangeWatchedFilesHandler.bind(this)),this.status="ready"}stopWatching(){this.status="stopped",this._watcher?.dispose(),this._watcher=void 0}onDidChangeWatchedFilesHandler(e){if(e.workspaceFolder.uri!==this.workspaceFolder.uri)return;let n=e.created.filter(a=>!a.isRestricted&&!a.isUnknownFileExtension);if(n.length){let a=n.map(c=>c.document).filter(c=>c!==void 0);this.emitFilesCreated(a)}let i=e.changed.filter(a=>!a.isRestricted&&!a.isUnknownFileExtension);if(i.length){let a=i.map(c=>c.document).filter(c=>c!==void 0);this.emitFilesUpdated(a)}let o=e.deleted.filter(a=>!a.isRestricted&&!a.isUnknownFileExtension);o.length&&this.emitFilesDeleted(o.map(a=>({uri:a.uri})))}};var Wue=class extends Jd{static{s(this,"AgentWorkspaceWatcherProvider")}createWatcher(e){return new $ue(this.ctx,e)}shouldStartWatching(e){return!!this.ctx.get(xs).getCapabilities().watchedFiles&&(!this.hasWatcher(e)||this.getStatus(e)==="stopped")}};function Gbt(t){let e=new ag(process.env),r=Iut(e);r.set(ag,e),r.set(Or,new que(r)),r.set(Ps,new Ps(r)),tPe(r,{});let n=Mje();r.set(yi,n);let i=new mle;r.set(nu,i);let o=new fA(r,n);r.set(fA,o),r.set(Bi,new nV(r,process.env)),r.set(Rf,new Rf(r)),r.set(Md,new Md(r,"agent")),r.set(Ms,jbt),r.set(cn,new $oe),r.set(OP,n1t()),r.set(Gs,new Gs),r.set(Fi,S1t),r.set(JR,new dle(r)),r.set(Jd,new Wue(r)),r.set(Q1,new Q1(r)),r.set(fl,new fl),r.set(Hc,XX(r,PAt)),r.set(kp,new kp(r)),r.set(jC,new T3),Gpt(r),Eoe(r),l0t(r),Pje(r),r.set(Nr,new Nr(r,t)),r.set(wa,new Hue(r)),r.set(C8,new Oue(r)),r.set(ju,new aL(r)),r.set(qo,new _le(r)),r.set(AH,new AH(r));let a=new PS(r);return r.set(dr,a),r.set(PS,a),r.set(df,new y8(r,process.env)),r.set(dl,new dl(r)),v1t(r),bdt(r),r.set($f,new $f),r.set(_S,new _S),r.set(Ey,new Ey),r.set(kf,new hle),r.set(X1,new X1),r.set(LA,new voe(r)),r.set(zC,new q8),r.set(py,new py(r)),r.set(pE,new pE(r)),r.set(Cl,new Cl(r)),r.set(cd,new Tle(r)),r.set(Nw,new Sle(r)),r.set(x1,new wle(r)),r.set(bu,new bu(r)),r.set(EE,new EE(r)),r.set(hy,new hy(r)),r.set(nE,new nE(r)),r.set(ng,new Mue(r)),r.set(ny,new Fue(r)),r.set(Qk,new Qk),r.set(my,new ple(r)),r.set(E1,new E1),r.set(Ok,new Ok),r.set(ZA,new ZA),r.set(Gp,new Gp),r.set(_1,new _1(r)),r.set(rg,new zne([new boe,new Ioe])),r.set(AP,new AP(r)),r}s(Gbt,"createLanguageServerContext");d();var L4e=require("events"),XH=Be(require("fs"));HK();var Gue=Be(ul());d();var zbt=Be(require("fs")),Kbt=Be(require("http")),cL=Be(require("path"));var jue=class{constructor(e,r){this.port=e;let n;this.server=Kbt.createServer((i,o)=>{if(i.headers.accept&&i.headers.accept=="text/event-stream")switch(o.writeHead(200,{"Content-Type":"text/event-stream","Cache-Control":"no-cache",Connection:"keep-alive"}),i.url){case"/stdin":r.on("read",c=>{Vbt(o,JSON.stringify(c))});return;case"/stdout":r.on("write",c=>{Vbt(o,JSON.stringify(c))});return;default:o.writeHead(404),o.end();return}o.writeHead(200,{"Content-Type":"text/html"});let a=__dirname;cL.basename(__dirname)!=="debug"&&(a=cL.dirname(__dirname)),n??=zbt.readFileSync(cL.join(a,"dist","debugServer.html")).toString(),o.write(n),o.end()}),this.server.on("error",i=>{console.error(i)})}static{s(this,"DebugServer")}listen(){return this.server.listen(this.port),this}getPort(){return this.server.address().port}};function Vbt(t,e){t.write("data: "+e.toString().replace(/\n/g,`
data: `)+`

`)}s(Vbt,"writeData");var F4e=class extends Gue.AbstractMessageWriter{constructor(r,n){super();this.delegate=r;this.ev=n}static{s(this,"DebugMessageWriter")}async write(r){return this.ev.emit("write",r),this.delegate.write(r)}end(){this.ev.emit("end"),this.delegate.end()}},O4e=class extends Gue.AbstractMessageReader{constructor(r,n){super();this.delegate=r;this.ev=n}static{s(this,"DebugMessageReader")}listen(r){return this.delegate.listen(n=>{this.ev.emit("read",n),r(n)})}};async function Ybt(t,e,r){let n,i=parseInt(t.GH_COPILOT_DEBUG_UI_PORT??t.GITHUB_COPILOT_DEBUG_UI_PORT);if(!isNaN(i)){n??=new L4e.EventEmitter;let c=new jue(i,n).listen();i===0&&await oO(`http://localhost:${c.getPort()}`)}let o=t.GITHUB_COPILOT_RECORD??"",a;try{let c=Date.now().toString();o==="1"||o==="true"?a=XH.openSync(`stdio${c}.log`,"w"):o&&o!=="0"&&o!=="false"&&(a=XH.openSync(o.replaceAll("%s",c),"w"))}catch(c){console.error(c)}if(a){let c=s(l=>{a&&XH.appendFile(a,l,u=>{u&&(a=void 0,console.error(u))})},"log");n??=new L4e.EventEmitter,n.on("read",l=>c(`<-- ${JSON.stringify(l)}
`)),n.on("write",l=>c(`--> ${JSON.stringify(l)}
`))}return n&&(e=new O4e(e,n),r=new F4e(r,n)),[e,r]}s(Ybt,"wrapTransports");async function Zbt(){let t=pze(process.argv.slice(2)).version(new To().getDisplayVersion()).strict().option("debug",{type:"boolean",hidden:!0}).option("clientProcessId",{type:"string",hidden:!0}).option("stdio",{type:"boolean",describe:"Use stdio"});"pkg"in process||t.option("node-ipc",{type:"boolean",describe:"Use node IPC",conflicts:"stdio"});let e=await t.parse(),r,n;e["node-ipc"]?(r=new Ig.IPCMessageReader(process),n=new Ig.IPCMessageWriter(process)):e.stdio?(r=new Ig.StreamMessageReader(process.stdin),n=new Ig.StreamMessageWriter(process.stdout)):(console.error("error: required option '--stdio' not specified"),process.exit(1)),"pkg"in process&&process.platform!=="win32"&&(process.env.TMPDIR=await KE.mkdtemp(Jbt.default.tmpdir()+"/github-copilot-"));try{let c=MCe(),l=JSON.parse(await KE.readFile(ZH.join(c,"hosts.json"),"utf8")),u={};try{u=JSON.parse(await KE.readFile(ZH.join(c,"apps.json"),"utf8"))}catch{}let f=!1;for(let p of Object.keys(l)){let m=`${p}:${w0}`;u[m]||!l[p].user||!l[p].oauth_token||(u[m]={user:l[p].user,oauth_token:l[p].oauth_token,githubAppId:w0},f=!0)}f&&await KE.writeFile(ZH.join(c,"apps.json"),JSON.stringify(u)+`
`,"utf8"),await KE.rm(ZH.join(c,"hosts.json"),{force:!0})}catch{}let i=(0,Ig.createConnection)(Ig.ProposedFeatures.all,...await Ybt(process.env,r,n)),o=Gbt(i);console=hGe(o);let a=o.get(Nr);r.onClose(()=>a.onExit()),process.on("SIGINT",()=>{a.onExit().finally(()=>process.exit(130)).catch(()=>{})}),process.on("SIGTERM",()=>{a.onExit().finally(()=>process.exit(143)).catch(()=>{})}),Dje(o),a.listen()}s(Zbt,"main");Xbt.isMainThread?require.main===module&&Zbt():pGe()&&mGe();0&&(module.exports={getTokenizer,getTokenizerAsync,main});
//!!! DO NOT modify, this file was COPIED from 'microsoft/vscode'
/*! Bundled license information:

crypto-js/ripemd160.js:
  (** @preserve
  	(c) 2012 by Cdric Mesnil. All rights reserved.
  
  	Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:
  
  	    - Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.
  	    - Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.
  
  	THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
  	*)

crypto-js/mode-ctr-gladman.js:
  (** @preserve
   * Counter block mode compatible with  Dr Brian Gladman fileenc.c
   * derived from CryptoJS.mode.CTR
   * Jan Hruby jhruby.web@gmail.com
   *)

@microsoft/applicationinsights-common/dist/es5/applicationinsights-common.js:
  (*!
   * Application Insights JavaScript SDK - Common, 3.3.6
   * Copyright (c) Microsoft and contributors. All rights reserved.
   *)
  (*! https://github.com/nevware21/ts-utils v0.11.8 *)

@microsoft/applicationinsights-web-basic/dist/es5/applicationinsights-web-basic.js:
  (*!
   * Application Insights JavaScript Web SDK - Basic, 3.3.6
   * Copyright (c) Microsoft and contributors. All rights reserved.
   *)
  (*! https://github.com/nevware21/ts-utils v0.11.8 *)
  (*!
   * NevWare21 Solutions LLC - ts-async, 0.5.4
   * https://github.com/nevware21/ts-async
   * Copyright (c) NevWare21 Solutions LLC and contributors. All rights reserved.
   * Licensed under the MIT license.
   *)

safe-buffer/index.js:
  (*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> *)

git-url-parse/lib/index.js:
  (*!
   * buildToken
   * Builds OAuth token prefix (helper function)
   *
   * @name buildToken
   * @function
   * @param {GitUrl} obj The parsed Git url object.
   * @return {String} token prefix
   *)

undici/lib/web/fetch/body.js:
  (*! formdata-polyfill. MIT License. Jimmy Wrting <https://jimmy.warting.se/opensource> *)

undici/lib/web/websocket/frame.js:
  (*! ws. MIT License. Einar Otto Stangvik <einaros@gmail.com> *)

@vscode/prompt-tsx/dist/base/util/vs/nls.js:
@vscode/prompt-tsx/dist/base/util/vs/common/platform.js:
@vscode/prompt-tsx/dist/base/util/vs/common/process.js:
@vscode/prompt-tsx/dist/base/util/vs/common/path.js:
@vscode/prompt-tsx/dist/base/util/vs/common/uri.js:
  (*!!! DO NOT modify, this file was COPIED from 'microsoft/vscode' *)

uri-js/dist/es5/uri.all.js:
  (** @license URI.js v4.4.1 (c) 2011 Gary Court. License: http://github.com/garycourt/uri-js *)

@azure/msal-node/dist/cache/serializer/Serializer.mjs:
@azure/msal-node/dist/cache/serializer/Deserializer.mjs:
@azure/msal-node/dist/internals.mjs:
@azure/msal-node/dist/utils/Constants.mjs:
@azure/msal-node/dist/utils/NetworkUtils.mjs:
@azure/msal-node/dist/network/HttpClient.mjs:
@azure/msal-node/dist/error/ManagedIdentityErrorCodes.mjs:
@azure/msal-node/dist/error/ManagedIdentityError.mjs:
@azure/msal-node/dist/config/ManagedIdentityId.mjs:
@azure/msal-node/dist/error/NodeAuthError.mjs:
@azure/msal-node/dist/config/Configuration.mjs:
@azure/msal-node/dist/crypto/GuidGenerator.mjs:
@azure/msal-node/dist/utils/EncodingUtils.mjs:
@azure/msal-node/dist/crypto/HashUtils.mjs:
@azure/msal-node/dist/crypto/PkceGenerator.mjs:
@azure/msal-node/dist/crypto/CryptoProvider.mjs:
@azure/msal-node/dist/cache/NodeStorage.mjs:
@azure/msal-node/dist/cache/TokenCache.mjs:
@azure/msal-node/dist/client/ClientAssertion.mjs:
@azure/msal-node/dist/packageMetadata.mjs:
@azure/msal-node/dist/client/UsernamePasswordClient.mjs:
@azure/msal-node/dist/protocol/Authorize.mjs:
@azure/msal-node/dist/client/ClientApplication.mjs:
@azure/msal-node/dist/network/LoopbackClient.mjs:
@azure/msal-node/dist/client/DeviceCodeClient.mjs:
@azure/msal-node/dist/client/PublicClientApplication.mjs:
@azure/msal-node/dist/client/ClientCredentialClient.mjs:
@azure/msal-node/dist/client/OnBehalfOfClient.mjs:
@azure/msal-node/dist/client/ConfidentialClientApplication.mjs:
@azure/msal-node/dist/utils/TimeUtils.mjs:
@azure/msal-node/dist/network/HttpClientWithRetries.mjs:
@azure/msal-node/dist/client/ManagedIdentitySources/BaseManagedIdentitySource.mjs:
@azure/msal-node/dist/retry/LinearRetryStrategy.mjs:
@azure/msal-node/dist/retry/DefaultManagedIdentityRetryPolicy.mjs:
@azure/msal-node/dist/config/ManagedIdentityRequestParameters.mjs:
@azure/msal-node/dist/client/ManagedIdentitySources/AppService.mjs:
@azure/msal-node/dist/client/ManagedIdentitySources/AzureArc.mjs:
@azure/msal-node/dist/client/ManagedIdentitySources/CloudShell.mjs:
@azure/msal-node/dist/retry/ExponentialRetryStrategy.mjs:
@azure/msal-node/dist/retry/ImdsRetryPolicy.mjs:
@azure/msal-node/dist/client/ManagedIdentitySources/Imds.mjs:
@azure/msal-node/dist/client/ManagedIdentitySources/ServiceFabric.mjs:
@azure/msal-node/dist/client/ManagedIdentitySources/MachineLearning.mjs:
@azure/msal-node/dist/client/ManagedIdentityClient.mjs:
@azure/msal-node/dist/client/ManagedIdentityApplication.mjs:
@azure/msal-node/dist/cache/distributed/DistributedCachePlugin.mjs:
@azure/msal-node/dist/index.mjs:
  (*! @azure/msal-node v3.6.3 2025-07-08 *)

@azure/msal-common/dist/utils/Constants.mjs:
@azure/msal-common/dist/error/AuthErrorCodes.mjs:
@azure/msal-common/dist/error/AuthError.mjs:
@azure/msal-common/dist/error/ClientAuthErrorCodes.mjs:
@azure/msal-common/dist/error/ClientAuthError.mjs:
@azure/msal-common/dist/crypto/ICrypto.mjs:
@azure/msal-common/dist/logger/Logger.mjs:
@azure/msal-common/dist/packageMetadata.mjs:
@azure/msal-common/dist/authority/AuthorityOptions.mjs:
@azure/msal-common/dist/account/AuthToken.mjs:
@azure/msal-common/dist/utils/TimeUtils.mjs:
@azure/msal-common/dist/cache/utils/CacheHelpers.mjs:
@azure/msal-common/dist/error/ClientConfigurationErrorCodes.mjs:
@azure/msal-common/dist/error/ClientConfigurationError.mjs:
@azure/msal-common/dist/utils/StringUtils.mjs:
@azure/msal-common/dist/request/ScopeSet.mjs:
@azure/msal-common/dist/account/ClientInfo.mjs:
@azure/msal-common/dist/account/AccountInfo.mjs:
@azure/msal-common/dist/authority/AuthorityType.mjs:
@azure/msal-common/dist/account/TokenClaims.mjs:
@azure/msal-common/dist/authority/ProtocolMode.mjs:
@azure/msal-common/dist/cache/entities/AccountEntity.mjs:
@azure/msal-common/dist/utils/UrlUtils.mjs:
@azure/msal-common/dist/url/UrlString.mjs:
@azure/msal-common/dist/authority/AuthorityMetadata.mjs:
@azure/msal-common/dist/error/CacheErrorCodes.mjs:
@azure/msal-common/dist/error/CacheError.mjs:
@azure/msal-common/dist/cache/CacheManager.mjs:
@azure/msal-common/dist/telemetry/performance/PerformanceEvent.mjs:
@azure/msal-common/dist/telemetry/performance/StubPerformanceClient.mjs:
@azure/msal-common/dist/config/ClientConfiguration.mjs:
@azure/msal-common/dist/account/CcsCredential.mjs:
@azure/msal-common/dist/constants/AADServerParamKeys.mjs:
@azure/msal-common/dist/request/RequestParameterBuilder.mjs:
@azure/msal-common/dist/authority/OpenIdConfigResponse.mjs:
@azure/msal-common/dist/authority/CloudInstanceDiscoveryResponse.mjs:
@azure/msal-common/dist/authority/CloudInstanceDiscoveryErrorResponse.mjs:
@azure/msal-common/dist/utils/FunctionWrappers.mjs:
@azure/msal-common/dist/authority/RegionDiscovery.mjs:
@azure/msal-common/dist/authority/Authority.mjs:
@azure/msal-common/dist/authority/AuthorityFactory.mjs:
@azure/msal-common/dist/error/ServerError.mjs:
@azure/msal-common/dist/network/RequestThumbprint.mjs:
@azure/msal-common/dist/network/ThrottlingUtils.mjs:
@azure/msal-common/dist/error/NetworkError.mjs:
@azure/msal-common/dist/client/BaseClient.mjs:
@azure/msal-common/dist/error/InteractionRequiredAuthErrorCodes.mjs:
@azure/msal-common/dist/error/InteractionRequiredAuthError.mjs:
@azure/msal-common/dist/utils/ProtocolUtils.mjs:
@azure/msal-common/dist/crypto/PopTokenGenerator.mjs:
@azure/msal-common/dist/cache/persistence/TokenCacheContext.mjs:
@azure/msal-common/dist/response/ResponseHandler.mjs:
@azure/msal-common/dist/utils/ClientAssertionUtils.mjs:
@azure/msal-common/dist/client/AuthorizationCodeClient.mjs:
@azure/msal-common/dist/client/RefreshTokenClient.mjs:
@azure/msal-common/dist/client/SilentFlowClient.mjs:
@azure/msal-common/dist/protocol/Authorize.mjs:
@azure/msal-common/dist/telemetry/server/ServerTelemetryManager.mjs:
@azure/msal-common/dist/index-node.mjs:
@azure/msal-common/dist/index.mjs:
  (*! @azure/msal-common v15.8.1 2025-07-08 *)

yargs-parser/build/lib/string-utils.js:
yargs-parser/build/lib/tokenize-arg-string.js:
yargs-parser/build/lib/yargs-parser-types.js:
yargs-parser/build/lib/yargs-parser.js:
  (**
   * @license
   * Copyright (c) 2016, Contributors
   * SPDX-License-Identifier: ISC
   *)

yargs-parser/build/lib/index.js:
  (**
   * @fileoverview Main entrypoint for libraries using yargs-parser in Node.js
   * CJS and ESM environments.
   *
   * @license
   * Copyright (c) 2016, Contributors
   * SPDX-License-Identifier: ISC
   *)

js-yaml/dist/js-yaml.mjs:
  (*! js-yaml 4.1.0 https://github.com/nodeca/js-yaml @license MIT *)
*/
//# sourceMappingURL=main.js.map
